var gm=(tt,_e)=>()=>(_e||tt((_e={exports:{}}).exports,_e),_e.exports);var vm=gm((exports,module)=>{function _mergeNamespaces(tt,_e){for(var rt=0;rt<_e.length;rt++){const nt=_e[rt];if(typeof nt!="string"&&!Array.isArray(nt)){for(const it in nt)if(it!=="default"&&!(it in tt)){const st=Object.getOwnPropertyDescriptor(nt,it);st&&Object.defineProperty(tt,it,st.get?st:{enumerable:!0,get:()=>nt[it]})}}}return Object.freeze(Object.defineProperty(tt,Symbol.toStringTag,{value:"Module"}))}(function(){const _e=document.createElement("link").relList;if(_e&&_e.supports&&_e.supports("modulepreload"))return;for(const it of document.querySelectorAll('link[rel="modulepreload"]'))nt(it);new MutationObserver(it=>{for(const st of it)if(st.type==="childList")for(const ot of st.addedNodes)ot.tagName==="LINK"&&ot.rel==="modulepreload"&&nt(ot)}).observe(document,{childList:!0,subtree:!0});function rt(it){const st={};return it.integrity&&(st.integrity=it.integrity),it.referrerPolicy&&(st.referrerPolicy=it.referrerPolicy),it.crossOrigin==="use-credentials"?st.credentials="include":it.crossOrigin==="anonymous"?st.credentials="omit":st.credentials="same-origin",st}function nt(it){if(it.ep)return;it.ep=!0;const st=rt(it);fetch(it.href,st)}})();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(tt){return tt&&tt.__esModule&&Object.prototype.hasOwnProperty.call(tt,"default")?tt.default:tt}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$6=Symbol.for("react.element"),n$6=Symbol.for("react.portal"),p$6=Symbol.for("react.fragment"),q$3=Symbol.for("react.strict_mode"),r$5=Symbol.for("react.profiler"),t$6=Symbol.for("react.provider"),u$4=Symbol.for("react.context"),v$5=Symbol.for("react.forward_ref"),w$3=Symbol.for("react.suspense"),x$4=Symbol.for("react.memo"),y$4=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$3(tt){return tt===null||typeof tt!="object"?null:(tt=z$2&&tt[z$2]||tt["@@iterator"],typeof tt=="function"?tt:null)}var B$3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$3=Object.assign,D$2={};function E$3(tt,_e,rt){this.props=tt,this.context=_e,this.refs=D$2,this.updater=rt||B$3}E$3.prototype.isReactComponent={};E$3.prototype.setState=function(tt,_e){if(typeof tt!="object"&&typeof tt!="function"&&tt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,tt,_e,"setState")};E$3.prototype.forceUpdate=function(tt){this.updater.enqueueForceUpdate(this,tt,"forceUpdate")};function F$2(){}F$2.prototype=E$3.prototype;function G$2(tt,_e,rt){this.props=tt,this.context=_e,this.refs=D$2,this.updater=rt||B$3}var H$3=G$2.prototype=new F$2;H$3.constructor=G$2;C$3(H$3,E$3.prototype);H$3.isPureReactComponent=!0;var I$5=Array.isArray,J$2=Object.prototype.hasOwnProperty,K$1={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$3(tt,_e,rt){var nt,it={},st=null,ot=null;if(_e!=null)for(nt in _e.ref!==void 0&&(ot=_e.ref),_e.key!==void 0&&(st=""+_e.key),_e)J$2.call(_e,nt)&&!L$3.hasOwnProperty(nt)&&(it[nt]=_e[nt]);var lt=arguments.length-2;if(lt===1)it.children=rt;else if(1<lt){for(var at=Array(lt),ct=0;ct<lt;ct++)at[ct]=arguments[ct+2];it.children=at}if(tt&&tt.defaultProps)for(nt in lt=tt.defaultProps,lt)it[nt]===void 0&&(it[nt]=lt[nt]);return{$$typeof:l$6,type:tt,key:st,ref:ot,props:it,_owner:K$1.current}}function N$3(tt,_e){return{$$typeof:l$6,type:tt.type,key:_e,ref:tt.ref,props:tt.props,_owner:tt._owner}}function O$2(tt){return typeof tt=="object"&&tt!==null&&tt.$$typeof===l$6}function escape$1(tt){var _e={"=":"=0",":":"=2"};return"$"+tt.replace(/[=:]/g,function(rt){return _e[rt]})}var P$2=/\/+/g;function Q$3(tt,_e){return typeof tt=="object"&&tt!==null&&tt.key!=null?escape$1(""+tt.key):_e.toString(36)}function R$2(tt,_e,rt,nt,it){var st=typeof tt;(st==="undefined"||st==="boolean")&&(tt=null);var ot=!1;if(tt===null)ot=!0;else switch(st){case"string":case"number":ot=!0;break;case"object":switch(tt.$$typeof){case l$6:case n$6:ot=!0}}if(ot)return ot=tt,it=it(ot),tt=nt===""?"."+Q$3(ot,0):nt,I$5(it)?(rt="",tt!=null&&(rt=tt.replace(P$2,"$&/")+"/"),R$2(it,_e,rt,"",function(ct){return ct})):it!=null&&(O$2(it)&&(it=N$3(it,rt+(!it.key||ot&&ot.key===it.key?"":(""+it.key).replace(P$2,"$&/")+"/")+tt)),_e.push(it)),1;if(ot=0,nt=nt===""?".":nt+":",I$5(tt))for(var lt=0;lt<tt.length;lt++){st=tt[lt];var at=nt+Q$3(st,lt);ot+=R$2(st,_e,rt,at,it)}else if(at=A$3(tt),typeof at=="function")for(tt=at.call(tt),lt=0;!(st=tt.next()).done;)st=st.value,at=nt+Q$3(st,lt++),ot+=R$2(st,_e,rt,at,it);else if(st==="object")throw _e=String(tt),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(tt).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.");return ot}function S$4(tt,_e,rt){if(tt==null)return tt;var nt=[],it=0;return R$2(tt,nt,"","",function(st){return _e.call(rt,st,it++)}),nt}function T$3(tt){if(tt._status===-1){var _e=tt._result;_e=_e(),_e.then(function(rt){(tt._status===0||tt._status===-1)&&(tt._status=1,tt._result=rt)},function(rt){(tt._status===0||tt._status===-1)&&(tt._status=2,tt._result=rt)}),tt._status===-1&&(tt._status=0,tt._result=_e)}if(tt._status===1)return tt._result.default;throw tt._result}var U$3={current:null},V$4={transition:null},W$2={ReactCurrentDispatcher:U$3,ReactCurrentBatchConfig:V$4,ReactCurrentOwner:K$1};react_production_min.Children={map:S$4,forEach:function(tt,_e,rt){S$4(tt,function(){_e.apply(this,arguments)},rt)},count:function(tt){var _e=0;return S$4(tt,function(){_e++}),_e},toArray:function(tt){return S$4(tt,function(_e){return _e})||[]},only:function(tt){if(!O$2(tt))throw Error("React.Children.only expected to receive a single React element child.");return tt}};react_production_min.Component=E$3;react_production_min.Fragment=p$6;react_production_min.Profiler=r$5;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$3;react_production_min.Suspense=w$3;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.cloneElement=function(tt,_e,rt){if(tt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+tt+".");var nt=C$3({},tt.props),it=tt.key,st=tt.ref,ot=tt._owner;if(_e!=null){if(_e.ref!==void 0&&(st=_e.ref,ot=K$1.current),_e.key!==void 0&&(it=""+_e.key),tt.type&&tt.type.defaultProps)var lt=tt.type.defaultProps;for(at in _e)J$2.call(_e,at)&&!L$3.hasOwnProperty(at)&&(nt[at]=_e[at]===void 0&&lt!==void 0?lt[at]:_e[at])}var at=arguments.length-2;if(at===1)nt.children=rt;else if(1<at){lt=Array(at);for(var ct=0;ct<at;ct++)lt[ct]=arguments[ct+2];nt.children=lt}return{$$typeof:l$6,type:tt.type,key:it,ref:st,props:nt,_owner:ot}};react_production_min.createContext=function(tt){return tt={$$typeof:u$4,_currentValue:tt,_currentValue2:tt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},tt.Provider={$$typeof:t$6,_context:tt},tt.Consumer=tt};react_production_min.createElement=M$3;react_production_min.createFactory=function(tt){var _e=M$3.bind(null,tt);return _e.type=tt,_e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(tt){return{$$typeof:v$5,render:tt}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(tt){return{$$typeof:y$4,_payload:{_status:-1,_result:tt},_init:T$3}};react_production_min.memo=function(tt,_e){return{$$typeof:x$4,type:tt,compare:_e===void 0?null:_e}};react_production_min.startTransition=function(tt){var _e=V$4.transition;V$4.transition={};try{tt()}finally{V$4.transition=_e}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(tt,_e){return U$3.current.useCallback(tt,_e)};react_production_min.useContext=function(tt){return U$3.current.useContext(tt)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(tt){return U$3.current.useDeferredValue(tt)};react_production_min.useEffect=function(tt,_e){return U$3.current.useEffect(tt,_e)};react_production_min.useId=function(){return U$3.current.useId()};react_production_min.useImperativeHandle=function(tt,_e,rt){return U$3.current.useImperativeHandle(tt,_e,rt)};react_production_min.useInsertionEffect=function(tt,_e){return U$3.current.useInsertionEffect(tt,_e)};react_production_min.useLayoutEffect=function(tt,_e){return U$3.current.useLayoutEffect(tt,_e)};react_production_min.useMemo=function(tt,_e){return U$3.current.useMemo(tt,_e)};react_production_min.useReducer=function(tt,_e,rt){return U$3.current.useReducer(tt,_e,rt)};react_production_min.useRef=function(tt){return U$3.current.useRef(tt)};react_production_min.useState=function(tt){return U$3.current.useState(tt)};react_production_min.useSyncExternalStore=function(tt,_e,rt){return U$3.current.useSyncExternalStore(tt,_e,rt)};react_production_min.useTransition=function(){return U$3.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),t$5=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$4=reactExports,k$4=Symbol.for("react.element"),l$5=Symbol.for("react.fragment"),m$5=Object.prototype.hasOwnProperty,n$5=f$4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$5={key:!0,ref:!0,__self:!0,__source:!0};function q$2(tt,_e,rt){var nt,it={},st=null,ot=null;rt!==void 0&&(st=""+rt),_e.key!==void 0&&(st=""+_e.key),_e.ref!==void 0&&(ot=_e.ref);for(nt in _e)m$5.call(_e,nt)&&!p$5.hasOwnProperty(nt)&&(it[nt]=_e[nt]);if(tt&&tt.defaultProps)for(nt in _e=tt.defaultProps,_e)it[nt]===void 0&&(it[nt]=_e[nt]);return{$$typeof:k$4,type:tt,key:st,ref:ot,props:it,_owner:n$5.current}}reactJsxRuntime_production_min.Fragment=l$5;reactJsxRuntime_production_min.jsx=q$2;reactJsxRuntime_production_min.jsxs=q$2;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler$2={exports:{}},scheduler_production_min$2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(tt){function _e(Dt,Gt){var zt=Dt.length;Dt.push(Gt);e:for(;0<zt;){var $t=zt-1>>>1,Ht=Dt[$t];if(0<it(Ht,Gt))Dt[$t]=Gt,Dt[zt]=Ht,zt=$t;else break e}}function rt(Dt){return Dt.length===0?null:Dt[0]}function nt(Dt){if(Dt.length===0)return null;var Gt=Dt[0],zt=Dt.pop();if(zt!==Gt){Dt[0]=zt;e:for(var $t=0,Ht=Dt.length,er=Ht>>>1;$t<er;){var Zt=2*($t+1)-1,or=Dt[Zt],Kt=Zt+1,rr=Dt[Kt];if(0>it(or,zt))Kt<Ht&&0>it(rr,or)?(Dt[$t]=rr,Dt[Kt]=zt,$t=Kt):(Dt[$t]=or,Dt[Zt]=zt,$t=Zt);else if(Kt<Ht&&0>it(rr,zt))Dt[$t]=rr,Dt[Kt]=zt,$t=Kt;else break e}}return Gt}function it(Dt,Gt){var zt=Dt.sortIndex-Gt.sortIndex;return zt!==0?zt:Dt.id-Gt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;tt.unstable_now=function(){return st.now()}}else{var ot=Date,lt=ot.now();tt.unstable_now=function(){return ot.now()-lt}}var at=[],ct=[],ut=1,ht=null,dt=3,ft=!1,pt=!1,mt=!1,gt=typeof setTimeout=="function"?setTimeout:null,vt=typeof clearTimeout=="function"?clearTimeout:null,At=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function yt(Dt){for(var Gt=rt(ct);Gt!==null;){if(Gt.callback===null)nt(ct);else if(Gt.startTime<=Dt)nt(ct),Gt.sortIndex=Gt.expirationTime,_e(at,Gt);else break;Gt=rt(ct)}}function xt(Dt){if(mt=!1,yt(Dt),!pt)if(rt(at)!==null)pt=!0,Ft(_t);else{var Gt=rt(ct);Gt!==null&&jt(xt,Gt.startTime-Dt)}}function _t(Dt,Gt){pt=!1,mt&&(mt=!1,vt(wt),wt=-1),ft=!0;var zt=dt;try{for(yt(Gt),ht=rt(at);ht!==null&&(!(ht.expirationTime>Gt)||Dt&&!Pt());){var $t=ht.callback;if(typeof $t=="function"){ht.callback=null,dt=ht.priorityLevel;var Ht=$t(ht.expirationTime<=Gt);Gt=tt.unstable_now(),typeof Ht=="function"?ht.callback=Ht:ht===rt(at)&&nt(at),yt(Gt)}else nt(at);ht=rt(at)}if(ht!==null)var er=!0;else{var Zt=rt(ct);Zt!==null&&jt(xt,Zt.startTime-Gt),er=!1}return er}finally{ht=null,dt=zt,ft=!1}}var Et=!1,bt=null,wt=-1,Tt=5,Mt=-1;function Pt(){return!(tt.unstable_now()-Mt<Tt)}function It(){if(bt!==null){var Dt=tt.unstable_now();Mt=Dt;var Gt=!0;try{Gt=bt(!0,Dt)}finally{Gt?Ot():(Et=!1,bt=null)}}else Et=!1}var Ot;if(typeof At=="function")Ot=function(){At(It)};else if(typeof MessageChannel<"u"){var Bt=new MessageChannel,Ut=Bt.port2;Bt.port1.onmessage=It,Ot=function(){Ut.postMessage(null)}}else Ot=function(){gt(It,0)};function Ft(Dt){bt=Dt,Et||(Et=!0,Ot())}function jt(Dt,Gt){wt=gt(function(){Dt(tt.unstable_now())},Gt)}tt.unstable_IdlePriority=5,tt.unstable_ImmediatePriority=1,tt.unstable_LowPriority=4,tt.unstable_NormalPriority=3,tt.unstable_Profiling=null,tt.unstable_UserBlockingPriority=2,tt.unstable_cancelCallback=function(Dt){Dt.callback=null},tt.unstable_continueExecution=function(){pt||ft||(pt=!0,Ft(_t))},tt.unstable_forceFrameRate=function(Dt){0>Dt||125<Dt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Tt=0<Dt?Math.floor(1e3/Dt):5},tt.unstable_getCurrentPriorityLevel=function(){return dt},tt.unstable_getFirstCallbackNode=function(){return rt(at)},tt.unstable_next=function(Dt){switch(dt){case 1:case 2:case 3:var Gt=3;break;default:Gt=dt}var zt=dt;dt=Gt;try{return Dt()}finally{dt=zt}},tt.unstable_pauseExecution=function(){},tt.unstable_requestPaint=function(){},tt.unstable_runWithPriority=function(Dt,Gt){switch(Dt){case 1:case 2:case 3:case 4:case 5:break;default:Dt=3}var zt=dt;dt=Dt;try{return Gt()}finally{dt=zt}},tt.unstable_scheduleCallback=function(Dt,Gt,zt){var $t=tt.unstable_now();switch(typeof zt=="object"&&zt!==null?(zt=zt.delay,zt=typeof zt=="number"&&0<zt?$t+zt:$t):zt=$t,Dt){case 1:var Ht=-1;break;case 2:Ht=250;break;case 5:Ht=1073741823;break;case 4:Ht=1e4;break;default:Ht=5e3}return Ht=zt+Ht,Dt={id:ut++,callback:Gt,priorityLevel:Dt,startTime:zt,expirationTime:Ht,sortIndex:-1},zt>$t?(Dt.sortIndex=zt,_e(ct,Dt),rt(at)===null&&Dt===rt(ct)&&(mt?(vt(wt),wt=-1):mt=!0,jt(xt,zt-$t))):(Dt.sortIndex=Ht,_e(at,Dt),pt||ft||(pt=!0,Ft(_t))),Dt},tt.unstable_shouldYield=Pt,tt.unstable_wrapCallback=function(Dt){var Gt=dt;return function(){var zt=dt;dt=Gt;try{return Dt.apply(this,arguments)}finally{dt=zt}}}})(scheduler_production_min$2);scheduler$2.exports=scheduler_production_min$2;var schedulerExports$1=scheduler$2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports$1;function p$4(tt){for(var _e="https://reactjs.org/docs/error-decoder.html?invariant="+tt,rt=1;rt<arguments.length;rt++)_e+="&args[]="+encodeURIComponent(arguments[rt]);return"Minified React error #"+tt+"; visit "+_e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(tt,_e){ha(tt,_e),ha(tt+"Capture",_e)}function ha(tt,_e){for(ea[tt]=_e,tt=0;tt<_e.length;tt++)da.add(_e[tt])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(tt){return ja.call(ma,tt)?!0:ja.call(la,tt)?!1:ka.test(tt)?ma[tt]=!0:(la[tt]=!0,!1)}function pa(tt,_e,rt,nt){if(rt!==null&&rt.type===0)return!1;switch(typeof _e){case"function":case"symbol":return!0;case"boolean":return nt?!1:rt!==null?!rt.acceptsBooleans:(tt=tt.toLowerCase().slice(0,5),tt!=="data-"&&tt!=="aria-");default:return!1}}function qa(tt,_e,rt,nt){if(_e===null||typeof _e>"u"||pa(tt,_e,rt,nt))return!0;if(nt)return!1;if(rt!==null)switch(rt.type){case 3:return!_e;case 4:return _e===!1;case 5:return isNaN(_e);case 6:return isNaN(_e)||1>_e}return!1}function v$4(tt,_e,rt,nt,it,st,ot){this.acceptsBooleans=_e===2||_e===3||_e===4,this.attributeName=nt,this.attributeNamespace=it,this.mustUseProperty=rt,this.propertyName=tt,this.type=_e,this.sanitizeURL=st,this.removeEmptyString=ot}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(tt){z$1[tt]=new v$4(tt,0,!1,tt,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(tt){var _e=tt[0];z$1[_e]=new v$4(_e,1,!1,tt[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(tt){z$1[tt]=new v$4(tt,2,!1,tt.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(tt){z$1[tt]=new v$4(tt,2,!1,tt,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(tt){z$1[tt]=new v$4(tt,3,!1,tt.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(tt){z$1[tt]=new v$4(tt,3,!0,tt,null,!1,!1)});["capture","download"].forEach(function(tt){z$1[tt]=new v$4(tt,4,!1,tt,null,!1,!1)});["cols","rows","size","span"].forEach(function(tt){z$1[tt]=new v$4(tt,6,!1,tt,null,!1,!1)});["rowSpan","start"].forEach(function(tt){z$1[tt]=new v$4(tt,5,!1,tt.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(tt){return tt[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(tt){var _e=tt.replace(ra,sa);z$1[_e]=new v$4(_e,1,!1,tt,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(tt){var _e=tt.replace(ra,sa);z$1[_e]=new v$4(_e,1,!1,tt,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(tt){var _e=tt.replace(ra,sa);z$1[_e]=new v$4(_e,1,!1,tt,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(tt){z$1[tt]=new v$4(tt,1,!1,tt.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$4("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(tt){z$1[tt]=new v$4(tt,1,!1,tt.toLowerCase(),null,!0,!0)});function ta(tt,_e,rt,nt){var it=z$1.hasOwnProperty(_e)?z$1[_e]:null;(it!==null?it.type!==0:nt||!(2<_e.length)||_e[0]!=="o"&&_e[0]!=="O"||_e[1]!=="n"&&_e[1]!=="N")&&(qa(_e,rt,it,nt)&&(rt=null),nt||it===null?oa(_e)&&(rt===null?tt.removeAttribute(_e):tt.setAttribute(_e,""+rt)):it.mustUseProperty?tt[it.propertyName]=rt===null?it.type===3?!1:"":rt:(_e=it.attributeName,nt=it.attributeNamespace,rt===null?tt.removeAttribute(_e):(it=it.type,rt=it===3||it===4&&rt===!0?"":""+rt,nt?tt.setAttributeNS(nt,_e,rt):tt.setAttribute(_e,rt))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(tt){return tt===null||typeof tt!="object"?null:(tt=Ja&&tt[Ja]||tt["@@iterator"],typeof tt=="function"?tt:null)}var A$2=Object.assign,La;function Ma(tt){if(La===void 0)try{throw Error()}catch(rt){var _e=rt.stack.trim().match(/\n( *(at )?)/);La=_e&&_e[1]||""}return`
`+La+tt}var Na=!1;function Oa(tt,_e){if(!tt||Na)return"";Na=!0;var rt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_e)if(_e=function(){throw Error()},Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(ct){var nt=ct}Reflect.construct(tt,[],_e)}else{try{_e.call()}catch(ct){nt=ct}tt.call(_e.prototype)}else{try{throw Error()}catch(ct){nt=ct}tt()}}catch(ct){if(ct&&nt&&typeof ct.stack=="string"){for(var it=ct.stack.split(`
`),st=nt.stack.split(`
`),ot=it.length-1,lt=st.length-1;1<=ot&&0<=lt&&it[ot]!==st[lt];)lt--;for(;1<=ot&&0<=lt;ot--,lt--)if(it[ot]!==st[lt]){if(ot!==1||lt!==1)do if(ot--,lt--,0>lt||it[ot]!==st[lt]){var at=`
`+it[ot].replace(" at new "," at ");return tt.displayName&&at.includes("<anonymous>")&&(at=at.replace("<anonymous>",tt.displayName)),at}while(1<=ot&&0<=lt);break}}}finally{Na=!1,Error.prepareStackTrace=rt}return(tt=tt?tt.displayName||tt.name:"")?Ma(tt):""}function Pa(tt){switch(tt.tag){case 5:return Ma(tt.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return tt=Oa(tt.type,!1),tt;case 11:return tt=Oa(tt.type.render,!1),tt;case 1:return tt=Oa(tt.type,!0),tt;default:return""}}function Qa(tt){if(tt==null)return null;if(typeof tt=="function")return tt.displayName||tt.name||null;if(typeof tt=="string")return tt;switch(tt){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof tt=="object")switch(tt.$$typeof){case Ca:return(tt.displayName||"Context")+".Consumer";case Ba:return(tt._context.displayName||"Context")+".Provider";case Da:var _e=tt.render;return tt=tt.displayName,tt||(tt=_e.displayName||_e.name||"",tt=tt!==""?"ForwardRef("+tt+")":"ForwardRef"),tt;case Ga:return _e=tt.displayName||null,_e!==null?_e:Qa(tt.type)||"Memo";case Ha:_e=tt._payload,tt=tt._init;try{return Qa(tt(_e))}catch{}}return null}function Ra(tt){var _e=tt.type;switch(tt.tag){case 24:return"Cache";case 9:return(_e.displayName||"Context")+".Consumer";case 10:return(_e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return tt=_e.render,tt=tt.displayName||tt.name||"",_e.displayName||(tt!==""?"ForwardRef("+tt+")":"ForwardRef");case 7:return"Fragment";case 5:return _e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(_e);case 8:return _e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _e=="function")return _e.displayName||_e.name||null;if(typeof _e=="string")return _e}return null}function Sa(tt){switch(typeof tt){case"boolean":case"number":case"string":case"undefined":return tt;case"object":return tt;default:return""}}function Ta(tt){var _e=tt.type;return(tt=tt.nodeName)&&tt.toLowerCase()==="input"&&(_e==="checkbox"||_e==="radio")}function Ua(tt){var _e=Ta(tt)?"checked":"value",rt=Object.getOwnPropertyDescriptor(tt.constructor.prototype,_e),nt=""+tt[_e];if(!tt.hasOwnProperty(_e)&&typeof rt<"u"&&typeof rt.get=="function"&&typeof rt.set=="function"){var it=rt.get,st=rt.set;return Object.defineProperty(tt,_e,{configurable:!0,get:function(){return it.call(this)},set:function(ot){nt=""+ot,st.call(this,ot)}}),Object.defineProperty(tt,_e,{enumerable:rt.enumerable}),{getValue:function(){return nt},setValue:function(ot){nt=""+ot},stopTracking:function(){tt._valueTracker=null,delete tt[_e]}}}}function Va(tt){tt._valueTracker||(tt._valueTracker=Ua(tt))}function Wa(tt){if(!tt)return!1;var _e=tt._valueTracker;if(!_e)return!0;var rt=_e.getValue(),nt="";return tt&&(nt=Ta(tt)?tt.checked?"true":"false":tt.value),tt=nt,tt!==rt?(_e.setValue(tt),!0):!1}function Xa(tt){if(tt=tt||(typeof document<"u"?document:void 0),typeof tt>"u")return null;try{return tt.activeElement||tt.body}catch{return tt.body}}function Ya(tt,_e){var rt=_e.checked;return A$2({},_e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:rt??tt._wrapperState.initialChecked})}function Za(tt,_e){var rt=_e.defaultValue==null?"":_e.defaultValue,nt=_e.checked!=null?_e.checked:_e.defaultChecked;rt=Sa(_e.value!=null?_e.value:rt),tt._wrapperState={initialChecked:nt,initialValue:rt,controlled:_e.type==="checkbox"||_e.type==="radio"?_e.checked!=null:_e.value!=null}}function ab(tt,_e){_e=_e.checked,_e!=null&&ta(tt,"checked",_e,!1)}function bb(tt,_e){ab(tt,_e);var rt=Sa(_e.value),nt=_e.type;if(rt!=null)nt==="number"?(rt===0&&tt.value===""||tt.value!=rt)&&(tt.value=""+rt):tt.value!==""+rt&&(tt.value=""+rt);else if(nt==="submit"||nt==="reset"){tt.removeAttribute("value");return}_e.hasOwnProperty("value")?cb(tt,_e.type,rt):_e.hasOwnProperty("defaultValue")&&cb(tt,_e.type,Sa(_e.defaultValue)),_e.checked==null&&_e.defaultChecked!=null&&(tt.defaultChecked=!!_e.defaultChecked)}function db(tt,_e,rt){if(_e.hasOwnProperty("value")||_e.hasOwnProperty("defaultValue")){var nt=_e.type;if(!(nt!=="submit"&&nt!=="reset"||_e.value!==void 0&&_e.value!==null))return;_e=""+tt._wrapperState.initialValue,rt||_e===tt.value||(tt.value=_e),tt.defaultValue=_e}rt=tt.name,rt!==""&&(tt.name=""),tt.defaultChecked=!!tt._wrapperState.initialChecked,rt!==""&&(tt.name=rt)}function cb(tt,_e,rt){(_e!=="number"||Xa(tt.ownerDocument)!==tt)&&(rt==null?tt.defaultValue=""+tt._wrapperState.initialValue:tt.defaultValue!==""+rt&&(tt.defaultValue=""+rt))}var eb=Array.isArray;function fb(tt,_e,rt,nt){if(tt=tt.options,_e){_e={};for(var it=0;it<rt.length;it++)_e["$"+rt[it]]=!0;for(rt=0;rt<tt.length;rt++)it=_e.hasOwnProperty("$"+tt[rt].value),tt[rt].selected!==it&&(tt[rt].selected=it),it&&nt&&(tt[rt].defaultSelected=!0)}else{for(rt=""+Sa(rt),_e=null,it=0;it<tt.length;it++){if(tt[it].value===rt){tt[it].selected=!0,nt&&(tt[it].defaultSelected=!0);return}_e!==null||tt[it].disabled||(_e=tt[it])}_e!==null&&(_e.selected=!0)}}function gb(tt,_e){if(_e.dangerouslySetInnerHTML!=null)throw Error(p$4(91));return A$2({},_e,{value:void 0,defaultValue:void 0,children:""+tt._wrapperState.initialValue})}function hb(tt,_e){var rt=_e.value;if(rt==null){if(rt=_e.children,_e=_e.defaultValue,rt!=null){if(_e!=null)throw Error(p$4(92));if(eb(rt)){if(1<rt.length)throw Error(p$4(93));rt=rt[0]}_e=rt}_e==null&&(_e=""),rt=_e}tt._wrapperState={initialValue:Sa(rt)}}function ib(tt,_e){var rt=Sa(_e.value),nt=Sa(_e.defaultValue);rt!=null&&(rt=""+rt,rt!==tt.value&&(tt.value=rt),_e.defaultValue==null&&tt.defaultValue!==rt&&(tt.defaultValue=rt)),nt!=null&&(tt.defaultValue=""+nt)}function jb(tt){var _e=tt.textContent;_e===tt._wrapperState.initialValue&&_e!==""&&_e!==null&&(tt.value=_e)}function kb(tt){switch(tt){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(tt,_e){return tt==null||tt==="http://www.w3.org/1999/xhtml"?kb(_e):tt==="http://www.w3.org/2000/svg"&&_e==="foreignObject"?"http://www.w3.org/1999/xhtml":tt}var mb,nb=function(tt){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(_e,rt,nt,it){MSApp.execUnsafeLocalFunction(function(){return tt(_e,rt,nt,it)})}:tt}(function(tt,_e){if(tt.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in tt)tt.innerHTML=_e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+_e.valueOf().toString()+"</svg>",_e=mb.firstChild;tt.firstChild;)tt.removeChild(tt.firstChild);for(;_e.firstChild;)tt.appendChild(_e.firstChild)}});function ob(tt,_e){if(_e){var rt=tt.firstChild;if(rt&&rt===tt.lastChild&&rt.nodeType===3){rt.nodeValue=_e;return}}tt.textContent=_e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(tt){qb.forEach(function(_e){_e=_e+tt.charAt(0).toUpperCase()+tt.substring(1),pb[_e]=pb[tt]})});function rb(tt,_e,rt){return _e==null||typeof _e=="boolean"||_e===""?"":rt||typeof _e!="number"||_e===0||pb.hasOwnProperty(tt)&&pb[tt]?(""+_e).trim():_e+"px"}function sb(tt,_e){tt=tt.style;for(var rt in _e)if(_e.hasOwnProperty(rt)){var nt=rt.indexOf("--")===0,it=rb(rt,_e[rt],nt);rt==="float"&&(rt="cssFloat"),nt?tt.setProperty(rt,it):tt[rt]=it}}var tb=A$2({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(tt,_e){if(_e){if(tb[tt]&&(_e.children!=null||_e.dangerouslySetInnerHTML!=null))throw Error(p$4(137,tt));if(_e.dangerouslySetInnerHTML!=null){if(_e.children!=null)throw Error(p$4(60));if(typeof _e.dangerouslySetInnerHTML!="object"||!("__html"in _e.dangerouslySetInnerHTML))throw Error(p$4(61))}if(_e.style!=null&&typeof _e.style!="object")throw Error(p$4(62))}}function vb(tt,_e){if(tt.indexOf("-")===-1)return typeof _e.is=="string";switch(tt){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(tt){return tt=tt.target||tt.srcElement||window,tt.correspondingUseElement&&(tt=tt.correspondingUseElement),tt.nodeType===3?tt.parentNode:tt}var yb=null,zb=null,Ab=null;function Bb(tt){if(tt=Cb(tt)){if(typeof yb!="function")throw Error(p$4(280));var _e=tt.stateNode;_e&&(_e=Db(_e),yb(tt.stateNode,tt.type,_e))}}function Eb(tt){zb?Ab?Ab.push(tt):Ab=[tt]:zb=tt}function Fb(){if(zb){var tt=zb,_e=Ab;if(Ab=zb=null,Bb(tt),_e)for(tt=0;tt<_e.length;tt++)Bb(_e[tt])}}function Gb(tt,_e){return tt(_e)}function Hb(){}var Ib=!1;function Jb(tt,_e,rt){if(Ib)return tt(_e,rt);Ib=!0;try{return Gb(tt,_e,rt)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(tt,_e){var rt=tt.stateNode;if(rt===null)return null;var nt=Db(rt);if(nt===null)return null;rt=nt[_e];e:switch(_e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(nt=!nt.disabled)||(tt=tt.type,nt=!(tt==="button"||tt==="input"||tt==="select"||tt==="textarea")),tt=!nt;break e;default:tt=!1}if(tt)return null;if(rt&&typeof rt!="function")throw Error(p$4(231,_e,typeof rt));return rt}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(tt,_e,rt,nt,it,st,ot,lt,at){var ct=Array.prototype.slice.call(arguments,3);try{_e.apply(rt,ct)}catch(ut){this.onError(ut)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(tt){Ob=!0,Pb=tt}};function Tb(tt,_e,rt,nt,it,st,ot,lt,at){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(tt,_e,rt,nt,it,st,ot,lt,at){if(Tb.apply(this,arguments),Ob){if(Ob){var ct=Pb;Ob=!1,Pb=null}else throw Error(p$4(198));Qb||(Qb=!0,Rb=ct)}}function Vb(tt){var _e=tt,rt=tt;if(tt.alternate)for(;_e.return;)_e=_e.return;else{tt=_e;do _e=tt,_e.flags&4098&&(rt=_e.return),tt=_e.return;while(tt)}return _e.tag===3?rt:null}function Wb(tt){if(tt.tag===13){var _e=tt.memoizedState;if(_e===null&&(tt=tt.alternate,tt!==null&&(_e=tt.memoizedState)),_e!==null)return _e.dehydrated}return null}function Xb(tt){if(Vb(tt)!==tt)throw Error(p$4(188))}function Yb(tt){var _e=tt.alternate;if(!_e){if(_e=Vb(tt),_e===null)throw Error(p$4(188));return _e!==tt?null:tt}for(var rt=tt,nt=_e;;){var it=rt.return;if(it===null)break;var st=it.alternate;if(st===null){if(nt=it.return,nt!==null){rt=nt;continue}break}if(it.child===st.child){for(st=it.child;st;){if(st===rt)return Xb(it),tt;if(st===nt)return Xb(it),_e;st=st.sibling}throw Error(p$4(188))}if(rt.return!==nt.return)rt=it,nt=st;else{for(var ot=!1,lt=it.child;lt;){if(lt===rt){ot=!0,rt=it,nt=st;break}if(lt===nt){ot=!0,nt=it,rt=st;break}lt=lt.sibling}if(!ot){for(lt=st.child;lt;){if(lt===rt){ot=!0,rt=st,nt=it;break}if(lt===nt){ot=!0,nt=st,rt=it;break}lt=lt.sibling}if(!ot)throw Error(p$4(189))}}if(rt.alternate!==nt)throw Error(p$4(190))}if(rt.tag!==3)throw Error(p$4(188));return rt.stateNode.current===rt?tt:_e}function Zb(tt){return tt=Yb(tt),tt!==null?$b(tt):null}function $b(tt){if(tt.tag===5||tt.tag===6)return tt;for(tt=tt.child;tt!==null;){var _e=$b(tt);if(_e!==null)return _e;tt=tt.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc$1=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$2=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(tt){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,tt,void 0,(tt.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(tt){return tt>>>=0,tt===0?32:31-(pc(tt)/qc|0)|0}var rc=64,sc=4194304;function tc(tt){switch(tt&-tt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return tt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return tt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return tt}}function uc(tt,_e){var rt=tt.pendingLanes;if(rt===0)return 0;var nt=0,it=tt.suspendedLanes,st=tt.pingedLanes,ot=rt&268435455;if(ot!==0){var lt=ot&~it;lt!==0?nt=tc(lt):(st&=ot,st!==0&&(nt=tc(st)))}else ot=rt&~it,ot!==0?nt=tc(ot):st!==0&&(nt=tc(st));if(nt===0)return 0;if(_e!==0&&_e!==nt&&!(_e&it)&&(it=nt&-nt,st=_e&-_e,it>=st||it===16&&(st&4194240)!==0))return _e;if(nt&4&&(nt|=rt&16),_e=tt.entangledLanes,_e!==0)for(tt=tt.entanglements,_e&=nt;0<_e;)rt=31-oc(_e),it=1<<rt,nt|=tt[rt],_e&=~it;return nt}function vc(tt,_e){switch(tt){case 1:case 2:case 4:return _e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(tt,_e){for(var rt=tt.suspendedLanes,nt=tt.pingedLanes,it=tt.expirationTimes,st=tt.pendingLanes;0<st;){var ot=31-oc(st),lt=1<<ot,at=it[ot];at===-1?(!(lt&rt)||lt&nt)&&(it[ot]=vc(lt,_e)):at<=_e&&(tt.expiredLanes|=lt),st&=~lt}}function xc(tt){return tt=tt.pendingLanes&-1073741825,tt!==0?tt:tt&1073741824?1073741824:0}function yc(){var tt=rc;return rc<<=1,!(rc&4194240)&&(rc=64),tt}function zc(tt){for(var _e=[],rt=0;31>rt;rt++)_e.push(tt);return _e}function Ac(tt,_e,rt){tt.pendingLanes|=_e,_e!==536870912&&(tt.suspendedLanes=0,tt.pingedLanes=0),tt=tt.eventTimes,_e=31-oc(_e),tt[_e]=rt}function Bc(tt,_e){var rt=tt.pendingLanes&~_e;tt.pendingLanes=_e,tt.suspendedLanes=0,tt.pingedLanes=0,tt.expiredLanes&=_e,tt.mutableReadLanes&=_e,tt.entangledLanes&=_e,_e=tt.entanglements;var nt=tt.eventTimes;for(tt=tt.expirationTimes;0<rt;){var it=31-oc(rt),st=1<<it;_e[it]=0,nt[it]=-1,tt[it]=-1,rt&=~st}}function Cc(tt,_e){var rt=tt.entangledLanes|=_e;for(tt=tt.entanglements;rt;){var nt=31-oc(rt),it=1<<nt;it&_e|tt[nt]&_e&&(tt[nt]|=_e),rt&=~it}}var C$2=0;function Dc(tt){return tt&=-tt,1<tt?4<tt?tt&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(tt,_e){switch(tt){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(_e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(_e.pointerId)}}function Tc(tt,_e,rt,nt,it,st){return tt===null||tt.nativeEvent!==st?(tt={blockedOn:_e,domEventName:rt,eventSystemFlags:nt,nativeEvent:st,targetContainers:[it]},_e!==null&&(_e=Cb(_e),_e!==null&&Fc(_e)),tt):(tt.eventSystemFlags|=nt,_e=tt.targetContainers,it!==null&&_e.indexOf(it)===-1&&_e.push(it),tt)}function Uc(tt,_e,rt,nt,it){switch(_e){case"focusin":return Lc=Tc(Lc,tt,_e,rt,nt,it),!0;case"dragenter":return Mc=Tc(Mc,tt,_e,rt,nt,it),!0;case"mouseover":return Nc=Tc(Nc,tt,_e,rt,nt,it),!0;case"pointerover":var st=it.pointerId;return Oc.set(st,Tc(Oc.get(st)||null,tt,_e,rt,nt,it)),!0;case"gotpointercapture":return st=it.pointerId,Pc.set(st,Tc(Pc.get(st)||null,tt,_e,rt,nt,it)),!0}return!1}function Vc(tt){var _e=Wc(tt.target);if(_e!==null){var rt=Vb(_e);if(rt!==null){if(_e=rt.tag,_e===13){if(_e=Wb(rt),_e!==null){tt.blockedOn=_e,Ic(tt.priority,function(){Gc(rt)});return}}else if(_e===3&&rt.stateNode.current.memoizedState.isDehydrated){tt.blockedOn=rt.tag===3?rt.stateNode.containerInfo:null;return}}}tt.blockedOn=null}function Xc(tt){if(tt.blockedOn!==null)return!1;for(var _e=tt.targetContainers;0<_e.length;){var rt=Yc(tt.domEventName,tt.eventSystemFlags,_e[0],tt.nativeEvent);if(rt===null){rt=tt.nativeEvent;var nt=new rt.constructor(rt.type,rt);wb=nt,rt.target.dispatchEvent(nt),wb=null}else return _e=Cb(rt),_e!==null&&Fc(_e),tt.blockedOn=rt,!1;_e.shift()}return!0}function Zc(tt,_e,rt){Xc(tt)&&rt.delete(_e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(tt,_e){tt.blockedOn===_e&&(tt.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(tt){function _e(it){return ad(it,tt)}if(0<Kc.length){ad(Kc[0],tt);for(var rt=1;rt<Kc.length;rt++){var nt=Kc[rt];nt.blockedOn===tt&&(nt.blockedOn=null)}}for(Lc!==null&&ad(Lc,tt),Mc!==null&&ad(Mc,tt),Nc!==null&&ad(Nc,tt),Oc.forEach(_e),Pc.forEach(_e),rt=0;rt<Qc.length;rt++)nt=Qc[rt],nt.blockedOn===tt&&(nt.blockedOn=null);for(;0<Qc.length&&(rt=Qc[0],rt.blockedOn===null);)Vc(rt),rt.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(tt,_e,rt,nt){var it=C$2,st=cd.transition;cd.transition=null;try{C$2=1,fd$1(tt,_e,rt,nt)}finally{C$2=it,cd.transition=st}}function gd(tt,_e,rt,nt){var it=C$2,st=cd.transition;cd.transition=null;try{C$2=4,fd$1(tt,_e,rt,nt)}finally{C$2=it,cd.transition=st}}function fd$1(tt,_e,rt,nt){if(dd){var it=Yc(tt,_e,rt,nt);if(it===null)hd(tt,_e,nt,id$1,rt),Sc(tt,nt);else if(Uc(it,tt,_e,rt,nt))nt.stopPropagation();else if(Sc(tt,nt),_e&4&&-1<Rc.indexOf(tt)){for(;it!==null;){var st=Cb(it);if(st!==null&&Ec(st),st=Yc(tt,_e,rt,nt),st===null&&hd(tt,_e,nt,id$1,rt),st===it)break;it=st}it!==null&&nt.stopPropagation()}else hd(tt,_e,nt,null,rt)}}var id$1=null;function Yc(tt,_e,rt,nt){if(id$1=null,tt=xb(nt),tt=Wc(tt),tt!==null)if(_e=Vb(tt),_e===null)tt=null;else if(rt=_e.tag,rt===13){if(tt=Wb(_e),tt!==null)return tt;tt=null}else if(rt===3){if(_e.stateNode.current.memoizedState.isDehydrated)return _e.tag===3?_e.stateNode.containerInfo:null;tt=null}else _e!==tt&&(tt=null);return id$1=tt,null}function jd(tt){switch(tt){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var tt,_e=ld,rt=_e.length,nt,it="value"in kd?kd.value:kd.textContent,st=it.length;for(tt=0;tt<rt&&_e[tt]===it[tt];tt++);var ot=rt-tt;for(nt=1;nt<=ot&&_e[rt-nt]===it[st-nt];nt++);return md=it.slice(tt,1<nt?1-nt:void 0)}function od(tt){var _e=tt.keyCode;return"charCode"in tt?(tt=tt.charCode,tt===0&&_e===13&&(tt=13)):tt=_e,tt===10&&(tt=13),32<=tt||tt===13?tt:0}function pd(){return!0}function qd(){return!1}function rd(tt){function _e(rt,nt,it,st,ot){this._reactName=rt,this._targetInst=it,this.type=nt,this.nativeEvent=st,this.target=ot,this.currentTarget=null;for(var lt in tt)tt.hasOwnProperty(lt)&&(rt=tt[lt],this[lt]=rt?rt(st):st[lt]);return this.isDefaultPrevented=(st.defaultPrevented!=null?st.defaultPrevented:st.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$2(_e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var rt=this.nativeEvent;rt&&(rt.preventDefault?rt.preventDefault():typeof rt.returnValue!="unknown"&&(rt.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var rt=this.nativeEvent;rt&&(rt.stopPropagation?rt.stopPropagation():typeof rt.cancelBubble!="unknown"&&(rt.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),_e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(tt){return tt.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd(sd),ud=A$2({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$2({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(tt){return tt.relatedTarget===void 0?tt.fromElement===tt.srcElement?tt.toElement:tt.fromElement:tt.relatedTarget},movementX:function(tt){return"movementX"in tt?tt.movementX:(tt!==yd&&(yd&&tt.type==="mousemove"?(wd=tt.screenX-yd.screenX,xd=tt.screenY-yd.screenY):xd=wd=0,yd=tt),wd)},movementY:function(tt){return"movementY"in tt?tt.movementY:xd}}),Bd=rd(Ad),Cd=A$2({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$2({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$2({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$2({},sd,{clipboardData:function(tt){return"clipboardData"in tt?tt.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$2({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(tt){var _e=this.nativeEvent;return _e.getModifierState?_e.getModifierState(tt):(tt=Od[tt])?!!_e[tt]:!1}function zd(){return Pd}var Qd=A$2({},ud,{key:function(tt){if(tt.key){var _e=Md[tt.key]||tt.key;if(_e!=="Unidentified")return _e}return tt.type==="keypress"?(tt=od(tt),tt===13?"Enter":String.fromCharCode(tt)):tt.type==="keydown"||tt.type==="keyup"?Nd[tt.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(tt){return tt.type==="keypress"?od(tt):0},keyCode:function(tt){return tt.type==="keydown"||tt.type==="keyup"?tt.keyCode:0},which:function(tt){return tt.type==="keypress"?od(tt):tt.type==="keydown"||tt.type==="keyup"?tt.keyCode:0}}),Rd=rd(Qd),Sd=A$2({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$2({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$2({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$2({},Ad,{deltaX:function(tt){return"deltaX"in tt?tt.deltaX:"wheelDeltaX"in tt?-tt.wheelDeltaX:0},deltaY:function(tt){return"deltaY"in tt?tt.deltaY:"wheelDeltaY"in tt?-tt.wheelDeltaY:"wheelDelta"in tt?-tt.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee$1=String.fromCharCode(32),fe=!1;function ge(tt,_e){switch(tt){case"keyup":return $d.indexOf(_e.keyCode)!==-1;case"keydown":return _e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(tt){return tt=tt.detail,typeof tt=="object"&&"data"in tt?tt.data:null}var ie=!1;function je(tt,_e){switch(tt){case"compositionend":return he(_e);case"keypress":return _e.which!==32?null:(fe=!0,ee$1);case"textInput":return tt=_e.data,tt===ee$1&&fe?null:tt;default:return null}}function ke(tt,_e){if(ie)return tt==="compositionend"||!ae&&ge(tt,_e)?(tt=nd(),md=ld=kd=null,ie=!1,tt):null;switch(tt){case"paste":return null;case"keypress":if(!(_e.ctrlKey||_e.altKey||_e.metaKey)||_e.ctrlKey&&_e.altKey){if(_e.char&&1<_e.char.length)return _e.char;if(_e.which)return String.fromCharCode(_e.which)}return null;case"compositionend":return de&&_e.locale!=="ko"?null:_e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(tt){var _e=tt&&tt.nodeName&&tt.nodeName.toLowerCase();return _e==="input"?!!le[tt.type]:_e==="textarea"}function ne(tt,_e,rt,nt){Eb(nt),_e=oe(_e,"onChange"),0<_e.length&&(rt=new td$1("onChange","change",null,rt,nt),tt.push({event:rt,listeners:_e}))}var pe=null,qe=null;function re$1(tt){se(tt,0)}function te(tt){var _e=ue(tt);if(Wa(_e))return tt}function ve(tt,_e){if(tt==="change")return _e}var we=!1;if(ia){var xe$1;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe$1=ye}else xe$1=!1;we=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(tt){if(tt.propertyName==="value"&&te(qe)){var _e=[];ne(_e,qe,tt,xb(tt)),Jb(re$1,_e)}}function Ce$1(tt,_e,rt){tt==="focusin"?(Ae(),pe=_e,qe=rt,pe.attachEvent("onpropertychange",Be)):tt==="focusout"&&Ae()}function De(tt){if(tt==="selectionchange"||tt==="keyup"||tt==="keydown")return te(qe)}function Ee(tt,_e){if(tt==="click")return te(_e)}function Fe(tt,_e){if(tt==="input"||tt==="change")return te(_e)}function Ge(tt,_e){return tt===_e&&(tt!==0||1/tt===1/_e)||tt!==tt&&_e!==_e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(tt,_e){if(He(tt,_e))return!0;if(typeof tt!="object"||tt===null||typeof _e!="object"||_e===null)return!1;var rt=Object.keys(tt),nt=Object.keys(_e);if(rt.length!==nt.length)return!1;for(nt=0;nt<rt.length;nt++){var it=rt[nt];if(!ja.call(_e,it)||!He(tt[it],_e[it]))return!1}return!0}function Je(tt){for(;tt&&tt.firstChild;)tt=tt.firstChild;return tt}function Ke(tt,_e){var rt=Je(tt);tt=0;for(var nt;rt;){if(rt.nodeType===3){if(nt=tt+rt.textContent.length,tt<=_e&&nt>=_e)return{node:rt,offset:_e-tt};tt=nt}e:{for(;rt;){if(rt.nextSibling){rt=rt.nextSibling;break e}rt=rt.parentNode}rt=void 0}rt=Je(rt)}}function Le(tt,_e){return tt&&_e?tt===_e?!0:tt&&tt.nodeType===3?!1:_e&&_e.nodeType===3?Le(tt,_e.parentNode):"contains"in tt?tt.contains(_e):tt.compareDocumentPosition?!!(tt.compareDocumentPosition(_e)&16):!1:!1}function Me$1(){for(var tt=window,_e=Xa();_e instanceof tt.HTMLIFrameElement;){try{var rt=typeof _e.contentWindow.location.href=="string"}catch{rt=!1}if(rt)tt=_e.contentWindow;else break;_e=Xa(tt.document)}return _e}function Ne$1(tt){var _e=tt&&tt.nodeName&&tt.nodeName.toLowerCase();return _e&&(_e==="input"&&(tt.type==="text"||tt.type==="search"||tt.type==="tel"||tt.type==="url"||tt.type==="password")||_e==="textarea"||tt.contentEditable==="true")}function Oe(tt){var _e=Me$1(),rt=tt.focusedElem,nt=tt.selectionRange;if(_e!==rt&&rt&&rt.ownerDocument&&Le(rt.ownerDocument.documentElement,rt)){if(nt!==null&&Ne$1(rt)){if(_e=nt.start,tt=nt.end,tt===void 0&&(tt=_e),"selectionStart"in rt)rt.selectionStart=_e,rt.selectionEnd=Math.min(tt,rt.value.length);else if(tt=(_e=rt.ownerDocument||document)&&_e.defaultView||window,tt.getSelection){tt=tt.getSelection();var it=rt.textContent.length,st=Math.min(nt.start,it);nt=nt.end===void 0?st:Math.min(nt.end,it),!tt.extend&&st>nt&&(it=nt,nt=st,st=it),it=Ke(rt,st);var ot=Ke(rt,nt);it&&ot&&(tt.rangeCount!==1||tt.anchorNode!==it.node||tt.anchorOffset!==it.offset||tt.focusNode!==ot.node||tt.focusOffset!==ot.offset)&&(_e=_e.createRange(),_e.setStart(it.node,it.offset),tt.removeAllRanges(),st>nt?(tt.addRange(_e),tt.extend(ot.node,ot.offset)):(_e.setEnd(ot.node,ot.offset),tt.addRange(_e)))}}for(_e=[],tt=rt;tt=tt.parentNode;)tt.nodeType===1&&_e.push({element:tt,left:tt.scrollLeft,top:tt.scrollTop});for(typeof rt.focus=="function"&&rt.focus(),rt=0;rt<_e.length;rt++)tt=_e[rt],tt.element.scrollLeft=tt.left,tt.element.scrollTop=tt.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(tt,_e,rt){var nt=rt.window===rt?rt.document:rt.nodeType===9?rt:rt.ownerDocument;Te||Qe==null||Qe!==Xa(nt)||(nt=Qe,"selectionStart"in nt&&Ne$1(nt)?nt={start:nt.selectionStart,end:nt.selectionEnd}:(nt=(nt.ownerDocument&&nt.ownerDocument.defaultView||window).getSelection(),nt={anchorNode:nt.anchorNode,anchorOffset:nt.anchorOffset,focusNode:nt.focusNode,focusOffset:nt.focusOffset}),Se&&Ie(Se,nt)||(Se=nt,nt=oe(Re,"onSelect"),0<nt.length&&(_e=new td$1("onSelect","select",null,_e,rt),tt.push({event:_e,listeners:nt}),_e.target=Qe)))}function Ve(tt,_e){var rt={};return rt[tt.toLowerCase()]=_e.toLowerCase(),rt["Webkit"+tt]="webkit"+_e,rt["Moz"+tt]="moz"+_e,rt}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(tt){if(Xe[tt])return Xe[tt];if(!We[tt])return tt;var _e=We[tt],rt;for(rt in _e)if(_e.hasOwnProperty(rt)&&rt in Ye)return Xe[tt]=_e[rt];return tt}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(tt,_e){df.set(tt,_e),fa(_e,[tt])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(tt,_e,rt){var nt=tt.type||"unknown-event";tt.currentTarget=rt,Ub(nt,_e,void 0,tt),tt.currentTarget=null}function se(tt,_e){_e=(_e&4)!==0;for(var rt=0;rt<tt.length;rt++){var nt=tt[rt],it=nt.event;nt=nt.listeners;e:{var st=void 0;if(_e)for(var ot=nt.length-1;0<=ot;ot--){var lt=nt[ot],at=lt.instance,ct=lt.currentTarget;if(lt=lt.listener,at!==st&&it.isPropagationStopped())break e;nf(it,lt,ct),st=at}else for(ot=0;ot<nt.length;ot++){if(lt=nt[ot],at=lt.instance,ct=lt.currentTarget,lt=lt.listener,at!==st&&it.isPropagationStopped())break e;nf(it,lt,ct),st=at}}}if(Qb)throw tt=Rb,Qb=!1,Rb=null,tt}function D$1(tt,_e){var rt=_e[of];rt===void 0&&(rt=_e[of]=new Set);var nt=tt+"__bubble";rt.has(nt)||(pf(_e,tt,2,!1),rt.add(nt))}function qf(tt,_e,rt){var nt=0;_e&&(nt|=4),pf(rt,tt,nt,_e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(tt){if(!tt[rf]){tt[rf]=!0,da.forEach(function(rt){rt!=="selectionchange"&&(mf.has(rt)||qf(rt,!1,tt),qf(rt,!0,tt))});var _e=tt.nodeType===9?tt:tt.ownerDocument;_e===null||_e[rf]||(_e[rf]=!0,qf("selectionchange",!1,_e))}}function pf(tt,_e,rt,nt){switch(jd(_e)){case 1:var it=ed;break;case 4:it=gd;break;default:it=fd$1}rt=it.bind(null,_e,rt,tt),it=void 0,!Lb||_e!=="touchstart"&&_e!=="touchmove"&&_e!=="wheel"||(it=!0),nt?it!==void 0?tt.addEventListener(_e,rt,{capture:!0,passive:it}):tt.addEventListener(_e,rt,!0):it!==void 0?tt.addEventListener(_e,rt,{passive:it}):tt.addEventListener(_e,rt,!1)}function hd(tt,_e,rt,nt,it){var st=nt;if(!(_e&1)&&!(_e&2)&&nt!==null)e:for(;;){if(nt===null)return;var ot=nt.tag;if(ot===3||ot===4){var lt=nt.stateNode.containerInfo;if(lt===it||lt.nodeType===8&&lt.parentNode===it)break;if(ot===4)for(ot=nt.return;ot!==null;){var at=ot.tag;if((at===3||at===4)&&(at=ot.stateNode.containerInfo,at===it||at.nodeType===8&&at.parentNode===it))return;ot=ot.return}for(;lt!==null;){if(ot=Wc(lt),ot===null)return;if(at=ot.tag,at===5||at===6){nt=st=ot;continue e}lt=lt.parentNode}}nt=nt.return}Jb(function(){var ct=st,ut=xb(rt),ht=[];e:{var dt=df.get(tt);if(dt!==void 0){var ft=td$1,pt=tt;switch(tt){case"keypress":if(od(rt)===0)break e;case"keydown":case"keyup":ft=Rd;break;case"focusin":pt="focus",ft=Fd;break;case"focusout":pt="blur",ft=Fd;break;case"beforeblur":case"afterblur":ft=Fd;break;case"click":if(rt.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=Vd;break;case $e:case af:case bf:ft=Hd;break;case cf:ft=Xd;break;case"scroll":ft=vd;break;case"wheel":ft=Zd;break;case"copy":case"cut":case"paste":ft=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Td}var mt=(_e&4)!==0,gt=!mt&&tt==="scroll",vt=mt?dt!==null?dt+"Capture":null:dt;mt=[];for(var At=ct,yt;At!==null;){yt=At;var xt=yt.stateNode;if(yt.tag===5&&xt!==null&&(yt=xt,vt!==null&&(xt=Kb(At,vt),xt!=null&&mt.push(tf(At,xt,yt)))),gt)break;At=At.return}0<mt.length&&(dt=new ft(dt,pt,null,rt,ut),ht.push({event:dt,listeners:mt}))}}if(!(_e&7)){e:{if(dt=tt==="mouseover"||tt==="pointerover",ft=tt==="mouseout"||tt==="pointerout",dt&&rt!==wb&&(pt=rt.relatedTarget||rt.fromElement)&&(Wc(pt)||pt[uf]))break e;if((ft||dt)&&(dt=ut.window===ut?ut:(dt=ut.ownerDocument)?dt.defaultView||dt.parentWindow:window,ft?(pt=rt.relatedTarget||rt.toElement,ft=ct,pt=pt?Wc(pt):null,pt!==null&&(gt=Vb(pt),pt!==gt||pt.tag!==5&&pt.tag!==6)&&(pt=null)):(ft=null,pt=ct),ft!==pt)){if(mt=Bd,xt="onMouseLeave",vt="onMouseEnter",At="mouse",(tt==="pointerout"||tt==="pointerover")&&(mt=Td,xt="onPointerLeave",vt="onPointerEnter",At="pointer"),gt=ft==null?dt:ue(ft),yt=pt==null?dt:ue(pt),dt=new mt(xt,At+"leave",ft,rt,ut),dt.target=gt,dt.relatedTarget=yt,xt=null,Wc(ut)===ct&&(mt=new mt(vt,At+"enter",pt,rt,ut),mt.target=yt,mt.relatedTarget=gt,xt=mt),gt=xt,ft&&pt)t:{for(mt=ft,vt=pt,At=0,yt=mt;yt;yt=vf(yt))At++;for(yt=0,xt=vt;xt;xt=vf(xt))yt++;for(;0<At-yt;)mt=vf(mt),At--;for(;0<yt-At;)vt=vf(vt),yt--;for(;At--;){if(mt===vt||vt!==null&&mt===vt.alternate)break t;mt=vf(mt),vt=vf(vt)}mt=null}else mt=null;ft!==null&&wf(ht,dt,ft,mt,!1),pt!==null&&gt!==null&&wf(ht,gt,pt,mt,!0)}}e:{if(dt=ct?ue(ct):window,ft=dt.nodeName&&dt.nodeName.toLowerCase(),ft==="select"||ft==="input"&&dt.type==="file")var _t=ve;else if(me(dt))if(we)_t=Fe;else{_t=De;var Et=Ce$1}else(ft=dt.nodeName)&&ft.toLowerCase()==="input"&&(dt.type==="checkbox"||dt.type==="radio")&&(_t=Ee);if(_t&&(_t=_t(tt,ct))){ne(ht,_t,rt,ut);break e}Et&&Et(tt,dt,ct),tt==="focusout"&&(Et=dt._wrapperState)&&Et.controlled&&dt.type==="number"&&cb(dt,"number",dt.value)}switch(Et=ct?ue(ct):window,tt){case"focusin":(me(Et)||Et.contentEditable==="true")&&(Qe=Et,Re=ct,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ht,rt,ut);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ht,rt,ut)}var bt;if(ae)e:{switch(tt){case"compositionstart":var wt="onCompositionStart";break e;case"compositionend":wt="onCompositionEnd";break e;case"compositionupdate":wt="onCompositionUpdate";break e}wt=void 0}else ie?ge(tt,rt)&&(wt="onCompositionEnd"):tt==="keydown"&&rt.keyCode===229&&(wt="onCompositionStart");wt&&(de&&rt.locale!=="ko"&&(ie||wt!=="onCompositionStart"?wt==="onCompositionEnd"&&ie&&(bt=nd()):(kd=ut,ld="value"in kd?kd.value:kd.textContent,ie=!0)),Et=oe(ct,wt),0<Et.length&&(wt=new Ld(wt,tt,null,rt,ut),ht.push({event:wt,listeners:Et}),bt?wt.data=bt:(bt=he(rt),bt!==null&&(wt.data=bt)))),(bt=ce?je(tt,rt):ke(tt,rt))&&(ct=oe(ct,"onBeforeInput"),0<ct.length&&(ut=new Ld("onBeforeInput","beforeinput",null,rt,ut),ht.push({event:ut,listeners:ct}),ut.data=bt))}se(ht,_e)})}function tf(tt,_e,rt){return{instance:tt,listener:_e,currentTarget:rt}}function oe(tt,_e){for(var rt=_e+"Capture",nt=[];tt!==null;){var it=tt,st=it.stateNode;it.tag===5&&st!==null&&(it=st,st=Kb(tt,rt),st!=null&&nt.unshift(tf(tt,st,it)),st=Kb(tt,_e),st!=null&&nt.push(tf(tt,st,it))),tt=tt.return}return nt}function vf(tt){if(tt===null)return null;do tt=tt.return;while(tt&&tt.tag!==5);return tt||null}function wf(tt,_e,rt,nt,it){for(var st=_e._reactName,ot=[];rt!==null&&rt!==nt;){var lt=rt,at=lt.alternate,ct=lt.stateNode;if(at!==null&&at===nt)break;lt.tag===5&&ct!==null&&(lt=ct,it?(at=Kb(rt,st),at!=null&&ot.unshift(tf(rt,at,lt))):it||(at=Kb(rt,st),at!=null&&ot.push(tf(rt,at,lt)))),rt=rt.return}ot.length!==0&&tt.push({event:_e,listeners:ot})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(tt){return(typeof tt=="string"?tt:""+tt).replace(xf,`
`).replace(yf,"")}function Af(tt,_e,rt){if(_e=zf(_e),zf(tt)!==_e&&rt)throw Error(p$4(425))}function Bf(){}var Cf=null,Df=null;function Ef(tt,_e){return tt==="textarea"||tt==="noscript"||typeof _e.children=="string"||typeof _e.children=="number"||typeof _e.dangerouslySetInnerHTML=="object"&&_e.dangerouslySetInnerHTML!==null&&_e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(tt){return Hf.resolve(null).then(tt).catch(If)}:Ff;function If(tt){setTimeout(function(){throw tt})}function Kf(tt,_e){var rt=_e,nt=0;do{var it=rt.nextSibling;if(tt.removeChild(rt),it&&it.nodeType===8)if(rt=it.data,rt==="/$"){if(nt===0){tt.removeChild(it),bd(_e);return}nt--}else rt!=="$"&&rt!=="$?"&&rt!=="$!"||nt++;rt=it}while(rt);bd(_e)}function Lf(tt){for(;tt!=null;tt=tt.nextSibling){var _e=tt.nodeType;if(_e===1||_e===3)break;if(_e===8){if(_e=tt.data,_e==="$"||_e==="$!"||_e==="$?")break;if(_e==="/$")return null}}return tt}function Mf(tt){tt=tt.previousSibling;for(var _e=0;tt;){if(tt.nodeType===8){var rt=tt.data;if(rt==="$"||rt==="$!"||rt==="$?"){if(_e===0)return tt;_e--}else rt==="/$"&&_e++}tt=tt.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(tt){var _e=tt[Of];if(_e)return _e;for(var rt=tt.parentNode;rt;){if(_e=rt[uf]||rt[Of]){if(rt=_e.alternate,_e.child!==null||rt!==null&&rt.child!==null)for(tt=Mf(tt);tt!==null;){if(rt=tt[Of])return rt;tt=Mf(tt)}return _e}tt=rt,rt=tt.parentNode}return null}function Cb(tt){return tt=tt[Of]||tt[uf],!tt||tt.tag!==5&&tt.tag!==6&&tt.tag!==13&&tt.tag!==3?null:tt}function ue(tt){if(tt.tag===5||tt.tag===6)return tt.stateNode;throw Error(p$4(33))}function Db(tt){return tt[Pf]||null}var Sf=[],Tf=-1;function Uf(tt){return{current:tt}}function E$2(tt){0>Tf||(tt.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(tt,_e){Tf++,Sf[Tf]=tt.current,tt.current=_e}var Vf={},H$2=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(tt,_e){var rt=tt.type.contextTypes;if(!rt)return Vf;var nt=tt.stateNode;if(nt&&nt.__reactInternalMemoizedUnmaskedChildContext===_e)return nt.__reactInternalMemoizedMaskedChildContext;var it={},st;for(st in rt)it[st]=_e[st];return nt&&(tt=tt.stateNode,tt.__reactInternalMemoizedUnmaskedChildContext=_e,tt.__reactInternalMemoizedMaskedChildContext=it),it}function Zf(tt){return tt=tt.childContextTypes,tt!=null}function $f(){E$2(Wf),E$2(H$2)}function ag(tt,_e,rt){if(H$2.current!==Vf)throw Error(p$4(168));G$1(H$2,_e),G$1(Wf,rt)}function bg(tt,_e,rt){var nt=tt.stateNode;if(_e=_e.childContextTypes,typeof nt.getChildContext!="function")return rt;nt=nt.getChildContext();for(var it in nt)if(!(it in _e))throw Error(p$4(108,Ra(tt)||"Unknown",it));return A$2({},rt,nt)}function cg(tt){return tt=(tt=tt.stateNode)&&tt.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$2.current,G$1(H$2,tt),G$1(Wf,Wf.current),!0}function dg(tt,_e,rt){var nt=tt.stateNode;if(!nt)throw Error(p$4(169));rt?(tt=bg(tt,_e,Xf),nt.__reactInternalMemoizedMergedChildContext=tt,E$2(Wf),E$2(H$2),G$1(H$2,tt)):E$2(Wf),G$1(Wf,rt)}var eg=null,fg=!1,gg=!1;function hg(tt){eg===null?eg=[tt]:eg.push(tt)}function ig(tt){fg=!0,hg(tt)}function jg(){if(!gg&&eg!==null){gg=!0;var tt=0,_e=C$2;try{var rt=eg;for(C$2=1;tt<rt.length;tt++){var nt=rt[tt];do nt=nt(!0);while(nt!==null)}eg=null,fg=!1}catch(it){throw eg!==null&&(eg=eg.slice(tt+1)),ac(fc,jg),it}finally{C$2=_e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(tt,_e){kg[lg++]=ng,kg[lg++]=mg,mg=tt,ng=_e}function ug(tt,_e,rt){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=tt;var nt=rg;tt=sg;var it=32-oc(nt)-1;nt&=~(1<<it),rt+=1;var st=32-oc(_e)+it;if(30<st){var ot=it-it%5;st=(nt&(1<<ot)-1).toString(32),nt>>=ot,it-=ot,rg=1<<32-oc(_e)+it|rt<<it|nt,sg=st+tt}else rg=1<<st|rt<<it|nt,sg=tt}function vg(tt){tt.return!==null&&(tg(tt,1),ug(tt,1,0))}function wg(tt){for(;tt===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;tt===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$4=!1,zg=null;function Ag(tt,_e){var rt=Bg(5,null,null,0);rt.elementType="DELETED",rt.stateNode=_e,rt.return=tt,_e=tt.deletions,_e===null?(tt.deletions=[rt],tt.flags|=16):_e.push(rt)}function Cg(tt,_e){switch(tt.tag){case 5:var rt=tt.type;return _e=_e.nodeType!==1||rt.toLowerCase()!==_e.nodeName.toLowerCase()?null:_e,_e!==null?(tt.stateNode=_e,xg=tt,yg=Lf(_e.firstChild),!0):!1;case 6:return _e=tt.pendingProps===""||_e.nodeType!==3?null:_e,_e!==null?(tt.stateNode=_e,xg=tt,yg=null,!0):!1;case 13:return _e=_e.nodeType!==8?null:_e,_e!==null?(rt=qg!==null?{id:rg,overflow:sg}:null,tt.memoizedState={dehydrated:_e,treeContext:rt,retryLane:1073741824},rt=Bg(18,null,null,0),rt.stateNode=_e,rt.return=tt,tt.child=rt,xg=tt,yg=null,!0):!1;default:return!1}}function Dg(tt){return(tt.mode&1)!==0&&(tt.flags&128)===0}function Eg(tt){if(I$4){var _e=yg;if(_e){var rt=_e;if(!Cg(tt,_e)){if(Dg(tt))throw Error(p$4(418));_e=Lf(rt.nextSibling);var nt=xg;_e&&Cg(tt,_e)?Ag(nt,rt):(tt.flags=tt.flags&-4097|2,I$4=!1,xg=tt)}}else{if(Dg(tt))throw Error(p$4(418));tt.flags=tt.flags&-4097|2,I$4=!1,xg=tt}}}function Fg(tt){for(tt=tt.return;tt!==null&&tt.tag!==5&&tt.tag!==3&&tt.tag!==13;)tt=tt.return;xg=tt}function Gg(tt){if(tt!==xg)return!1;if(!I$4)return Fg(tt),I$4=!0,!1;var _e;if((_e=tt.tag!==3)&&!(_e=tt.tag!==5)&&(_e=tt.type,_e=_e!=="head"&&_e!=="body"&&!Ef(tt.type,tt.memoizedProps)),_e&&(_e=yg)){if(Dg(tt))throw Hg(),Error(p$4(418));for(;_e;)Ag(tt,_e),_e=Lf(_e.nextSibling)}if(Fg(tt),tt.tag===13){if(tt=tt.memoizedState,tt=tt!==null?tt.dehydrated:null,!tt)throw Error(p$4(317));e:{for(tt=tt.nextSibling,_e=0;tt;){if(tt.nodeType===8){var rt=tt.data;if(rt==="/$"){if(_e===0){yg=Lf(tt.nextSibling);break e}_e--}else rt!=="$"&&rt!=="$!"&&rt!=="$?"||_e++}tt=tt.nextSibling}yg=null}}else yg=xg?Lf(tt.stateNode.nextSibling):null;return!0}function Hg(){for(var tt=yg;tt;)tt=Lf(tt.nextSibling)}function Ig(){yg=xg=null,I$4=!1}function Jg(tt){zg===null?zg=[tt]:zg.push(tt)}var Kg=ua.ReactCurrentBatchConfig;function Lg(tt,_e){if(tt&&tt.defaultProps){_e=A$2({},_e),tt=tt.defaultProps;for(var rt in tt)_e[rt]===void 0&&(_e[rt]=tt[rt]);return _e}return _e}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(tt){var _e=Mg.current;E$2(Mg),tt._currentValue=_e}function Sg(tt,_e,rt){for(;tt!==null;){var nt=tt.alternate;if((tt.childLanes&_e)!==_e?(tt.childLanes|=_e,nt!==null&&(nt.childLanes|=_e)):nt!==null&&(nt.childLanes&_e)!==_e&&(nt.childLanes|=_e),tt===rt)break;tt=tt.return}}function Tg(tt,_e){Ng=tt,Pg=Og=null,tt=tt.dependencies,tt!==null&&tt.firstContext!==null&&(tt.lanes&_e&&(Ug=!0),tt.firstContext=null)}function Vg(tt){var _e=tt._currentValue;if(Pg!==tt)if(tt={context:tt,memoizedValue:_e,next:null},Og===null){if(Ng===null)throw Error(p$4(308));Og=tt,Ng.dependencies={lanes:0,firstContext:tt}}else Og=Og.next=tt;return _e}var Wg=null;function Xg(tt){Wg===null?Wg=[tt]:Wg.push(tt)}function Yg(tt,_e,rt,nt){var it=_e.interleaved;return it===null?(rt.next=rt,Xg(_e)):(rt.next=it.next,it.next=rt),_e.interleaved=rt,Zg(tt,nt)}function Zg(tt,_e){tt.lanes|=_e;var rt=tt.alternate;for(rt!==null&&(rt.lanes|=_e),rt=tt,tt=tt.return;tt!==null;)tt.childLanes|=_e,rt=tt.alternate,rt!==null&&(rt.childLanes|=_e),rt=tt,tt=tt.return;return rt.tag===3?rt.stateNode:null}var $g=!1;function ah(tt){tt.updateQueue={baseState:tt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(tt,_e){tt=tt.updateQueue,_e.updateQueue===tt&&(_e.updateQueue={baseState:tt.baseState,firstBaseUpdate:tt.firstBaseUpdate,lastBaseUpdate:tt.lastBaseUpdate,shared:tt.shared,effects:tt.effects})}function ch(tt,_e){return{eventTime:tt,lane:_e,tag:0,payload:null,callback:null,next:null}}function dh(tt,_e,rt){var nt=tt.updateQueue;if(nt===null)return null;if(nt=nt.shared,K&2){var it=nt.pending;return it===null?_e.next=_e:(_e.next=it.next,it.next=_e),nt.pending=_e,Zg(tt,rt)}return it=nt.interleaved,it===null?(_e.next=_e,Xg(nt)):(_e.next=it.next,it.next=_e),nt.interleaved=_e,Zg(tt,rt)}function eh(tt,_e,rt){if(_e=_e.updateQueue,_e!==null&&(_e=_e.shared,(rt&4194240)!==0)){var nt=_e.lanes;nt&=tt.pendingLanes,rt|=nt,_e.lanes=rt,Cc(tt,rt)}}function fh(tt,_e){var rt=tt.updateQueue,nt=tt.alternate;if(nt!==null&&(nt=nt.updateQueue,rt===nt)){var it=null,st=null;if(rt=rt.firstBaseUpdate,rt!==null){do{var ot={eventTime:rt.eventTime,lane:rt.lane,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null};st===null?it=st=ot:st=st.next=ot,rt=rt.next}while(rt!==null);st===null?it=st=_e:st=st.next=_e}else it=st=_e;rt={baseState:nt.baseState,firstBaseUpdate:it,lastBaseUpdate:st,shared:nt.shared,effects:nt.effects},tt.updateQueue=rt;return}tt=rt.lastBaseUpdate,tt===null?rt.firstBaseUpdate=_e:tt.next=_e,rt.lastBaseUpdate=_e}function gh(tt,_e,rt,nt){var it=tt.updateQueue;$g=!1;var st=it.firstBaseUpdate,ot=it.lastBaseUpdate,lt=it.shared.pending;if(lt!==null){it.shared.pending=null;var at=lt,ct=at.next;at.next=null,ot===null?st=ct:ot.next=ct,ot=at;var ut=tt.alternate;ut!==null&&(ut=ut.updateQueue,lt=ut.lastBaseUpdate,lt!==ot&&(lt===null?ut.firstBaseUpdate=ct:lt.next=ct,ut.lastBaseUpdate=at))}if(st!==null){var ht=it.baseState;ot=0,ut=ct=at=null,lt=st;do{var dt=lt.lane,ft=lt.eventTime;if((nt&dt)===dt){ut!==null&&(ut=ut.next={eventTime:ft,lane:0,tag:lt.tag,payload:lt.payload,callback:lt.callback,next:null});e:{var pt=tt,mt=lt;switch(dt=_e,ft=rt,mt.tag){case 1:if(pt=mt.payload,typeof pt=="function"){ht=pt.call(ft,ht,dt);break e}ht=pt;break e;case 3:pt.flags=pt.flags&-65537|128;case 0:if(pt=mt.payload,dt=typeof pt=="function"?pt.call(ft,ht,dt):pt,dt==null)break e;ht=A$2({},ht,dt);break e;case 2:$g=!0}}lt.callback!==null&&lt.lane!==0&&(tt.flags|=64,dt=it.effects,dt===null?it.effects=[lt]:dt.push(lt))}else ft={eventTime:ft,lane:dt,tag:lt.tag,payload:lt.payload,callback:lt.callback,next:null},ut===null?(ct=ut=ft,at=ht):ut=ut.next=ft,ot|=dt;if(lt=lt.next,lt===null){if(lt=it.shared.pending,lt===null)break;dt=lt,lt=dt.next,dt.next=null,it.lastBaseUpdate=dt,it.shared.pending=null}}while(1);if(ut===null&&(at=ht),it.baseState=at,it.firstBaseUpdate=ct,it.lastBaseUpdate=ut,_e=it.shared.interleaved,_e!==null){it=_e;do ot|=it.lane,it=it.next;while(it!==_e)}else st===null&&(it.shared.lanes=0);hh|=ot,tt.lanes=ot,tt.memoizedState=ht}}function ih(tt,_e,rt){if(tt=_e.effects,_e.effects=null,tt!==null)for(_e=0;_e<tt.length;_e++){var nt=tt[_e],it=nt.callback;if(it!==null){if(nt.callback=null,nt=rt,typeof it!="function")throw Error(p$4(191,it));it.call(nt)}}}var jh=new aa.Component().refs;function kh(tt,_e,rt,nt){_e=tt.memoizedState,rt=rt(nt,_e),rt=rt==null?_e:A$2({},_e,rt),tt.memoizedState=rt,tt.lanes===0&&(tt.updateQueue.baseState=rt)}var nh={isMounted:function(tt){return(tt=tt._reactInternals)?Vb(tt)===tt:!1},enqueueSetState:function(tt,_e,rt){tt=tt._reactInternals;var nt=L$2(),it=lh(tt),st=ch(nt,it);st.payload=_e,rt!=null&&(st.callback=rt),_e=dh(tt,st,it),_e!==null&&(mh(_e,tt,it,nt),eh(_e,tt,it))},enqueueReplaceState:function(tt,_e,rt){tt=tt._reactInternals;var nt=L$2(),it=lh(tt),st=ch(nt,it);st.tag=1,st.payload=_e,rt!=null&&(st.callback=rt),_e=dh(tt,st,it),_e!==null&&(mh(_e,tt,it,nt),eh(_e,tt,it))},enqueueForceUpdate:function(tt,_e){tt=tt._reactInternals;var rt=L$2(),nt=lh(tt),it=ch(rt,nt);it.tag=2,_e!=null&&(it.callback=_e),_e=dh(tt,it,nt),_e!==null&&(mh(_e,tt,nt,rt),eh(_e,tt,nt))}};function oh(tt,_e,rt,nt,it,st,ot){return tt=tt.stateNode,typeof tt.shouldComponentUpdate=="function"?tt.shouldComponentUpdate(nt,st,ot):_e.prototype&&_e.prototype.isPureReactComponent?!Ie(rt,nt)||!Ie(it,st):!0}function ph(tt,_e,rt){var nt=!1,it=Vf,st=_e.contextType;return typeof st=="object"&&st!==null?st=Vg(st):(it=Zf(_e)?Xf:H$2.current,nt=_e.contextTypes,st=(nt=nt!=null)?Yf(tt,it):Vf),_e=new _e(rt,st),tt.memoizedState=_e.state!==null&&_e.state!==void 0?_e.state:null,_e.updater=nh,tt.stateNode=_e,_e._reactInternals=tt,nt&&(tt=tt.stateNode,tt.__reactInternalMemoizedUnmaskedChildContext=it,tt.__reactInternalMemoizedMaskedChildContext=st),_e}function qh(tt,_e,rt,nt){tt=_e.state,typeof _e.componentWillReceiveProps=="function"&&_e.componentWillReceiveProps(rt,nt),typeof _e.UNSAFE_componentWillReceiveProps=="function"&&_e.UNSAFE_componentWillReceiveProps(rt,nt),_e.state!==tt&&nh.enqueueReplaceState(_e,_e.state,null)}function rh(tt,_e,rt,nt){var it=tt.stateNode;it.props=rt,it.state=tt.memoizedState,it.refs=jh,ah(tt);var st=_e.contextType;typeof st=="object"&&st!==null?it.context=Vg(st):(st=Zf(_e)?Xf:H$2.current,it.context=Yf(tt,st)),it.state=tt.memoizedState,st=_e.getDerivedStateFromProps,typeof st=="function"&&(kh(tt,_e,st,rt),it.state=tt.memoizedState),typeof _e.getDerivedStateFromProps=="function"||typeof it.getSnapshotBeforeUpdate=="function"||typeof it.UNSAFE_componentWillMount!="function"&&typeof it.componentWillMount!="function"||(_e=it.state,typeof it.componentWillMount=="function"&&it.componentWillMount(),typeof it.UNSAFE_componentWillMount=="function"&&it.UNSAFE_componentWillMount(),_e!==it.state&&nh.enqueueReplaceState(it,it.state,null),gh(tt,rt,it,nt),it.state=tt.memoizedState),typeof it.componentDidMount=="function"&&(tt.flags|=4194308)}function sh(tt,_e,rt){if(tt=rt.ref,tt!==null&&typeof tt!="function"&&typeof tt!="object"){if(rt._owner){if(rt=rt._owner,rt){if(rt.tag!==1)throw Error(p$4(309));var nt=rt.stateNode}if(!nt)throw Error(p$4(147,tt));var it=nt,st=""+tt;return _e!==null&&_e.ref!==null&&typeof _e.ref=="function"&&_e.ref._stringRef===st?_e.ref:(_e=function(ot){var lt=it.refs;lt===jh&&(lt=it.refs={}),ot===null?delete lt[st]:lt[st]=ot},_e._stringRef=st,_e)}if(typeof tt!="string")throw Error(p$4(284));if(!rt._owner)throw Error(p$4(290,tt))}return tt}function th(tt,_e){throw tt=Object.prototype.toString.call(_e),Error(p$4(31,tt==="[object Object]"?"object with keys {"+Object.keys(_e).join(", ")+"}":tt))}function uh(tt){var _e=tt._init;return _e(tt._payload)}function vh(tt){function _e(vt,At){if(tt){var yt=vt.deletions;yt===null?(vt.deletions=[At],vt.flags|=16):yt.push(At)}}function rt(vt,At){if(!tt)return null;for(;At!==null;)_e(vt,At),At=At.sibling;return null}function nt(vt,At){for(vt=new Map;At!==null;)At.key!==null?vt.set(At.key,At):vt.set(At.index,At),At=At.sibling;return vt}function it(vt,At){return vt=wh(vt,At),vt.index=0,vt.sibling=null,vt}function st(vt,At,yt){return vt.index=yt,tt?(yt=vt.alternate,yt!==null?(yt=yt.index,yt<At?(vt.flags|=2,At):yt):(vt.flags|=2,At)):(vt.flags|=1048576,At)}function ot(vt){return tt&&vt.alternate===null&&(vt.flags|=2),vt}function lt(vt,At,yt,xt){return At===null||At.tag!==6?(At=xh(yt,vt.mode,xt),At.return=vt,At):(At=it(At,yt),At.return=vt,At)}function at(vt,At,yt,xt){var _t=yt.type;return _t===ya?ut(vt,At,yt.props.children,xt,yt.key):At!==null&&(At.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===Ha&&uh(_t)===At.type)?(xt=it(At,yt.props),xt.ref=sh(vt,At,yt),xt.return=vt,xt):(xt=yh(yt.type,yt.key,yt.props,null,vt.mode,xt),xt.ref=sh(vt,At,yt),xt.return=vt,xt)}function ct(vt,At,yt,xt){return At===null||At.tag!==4||At.stateNode.containerInfo!==yt.containerInfo||At.stateNode.implementation!==yt.implementation?(At=zh(yt,vt.mode,xt),At.return=vt,At):(At=it(At,yt.children||[]),At.return=vt,At)}function ut(vt,At,yt,xt,_t){return At===null||At.tag!==7?(At=Ah(yt,vt.mode,xt,_t),At.return=vt,At):(At=it(At,yt),At.return=vt,At)}function ht(vt,At,yt){if(typeof At=="string"&&At!==""||typeof At=="number")return At=xh(""+At,vt.mode,yt),At.return=vt,At;if(typeof At=="object"&&At!==null){switch(At.$$typeof){case va:return yt=yh(At.type,At.key,At.props,null,vt.mode,yt),yt.ref=sh(vt,null,At),yt.return=vt,yt;case wa:return At=zh(At,vt.mode,yt),At.return=vt,At;case Ha:var xt=At._init;return ht(vt,xt(At._payload),yt)}if(eb(At)||Ka(At))return At=Ah(At,vt.mode,yt,null),At.return=vt,At;th(vt,At)}return null}function dt(vt,At,yt,xt){var _t=At!==null?At.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number")return _t!==null?null:lt(vt,At,""+yt,xt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case va:return yt.key===_t?at(vt,At,yt,xt):null;case wa:return yt.key===_t?ct(vt,At,yt,xt):null;case Ha:return _t=yt._init,dt(vt,At,_t(yt._payload),xt)}if(eb(yt)||Ka(yt))return _t!==null?null:ut(vt,At,yt,xt,null);th(vt,yt)}return null}function ft(vt,At,yt,xt,_t){if(typeof xt=="string"&&xt!==""||typeof xt=="number")return vt=vt.get(yt)||null,lt(At,vt,""+xt,_t);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case va:return vt=vt.get(xt.key===null?yt:xt.key)||null,at(At,vt,xt,_t);case wa:return vt=vt.get(xt.key===null?yt:xt.key)||null,ct(At,vt,xt,_t);case Ha:var Et=xt._init;return ft(vt,At,yt,Et(xt._payload),_t)}if(eb(xt)||Ka(xt))return vt=vt.get(yt)||null,ut(At,vt,xt,_t,null);th(At,xt)}return null}function pt(vt,At,yt,xt){for(var _t=null,Et=null,bt=At,wt=At=0,Tt=null;bt!==null&&wt<yt.length;wt++){bt.index>wt?(Tt=bt,bt=null):Tt=bt.sibling;var Mt=dt(vt,bt,yt[wt],xt);if(Mt===null){bt===null&&(bt=Tt);break}tt&&bt&&Mt.alternate===null&&_e(vt,bt),At=st(Mt,At,wt),Et===null?_t=Mt:Et.sibling=Mt,Et=Mt,bt=Tt}if(wt===yt.length)return rt(vt,bt),I$4&&tg(vt,wt),_t;if(bt===null){for(;wt<yt.length;wt++)bt=ht(vt,yt[wt],xt),bt!==null&&(At=st(bt,At,wt),Et===null?_t=bt:Et.sibling=bt,Et=bt);return I$4&&tg(vt,wt),_t}for(bt=nt(vt,bt);wt<yt.length;wt++)Tt=ft(bt,vt,wt,yt[wt],xt),Tt!==null&&(tt&&Tt.alternate!==null&&bt.delete(Tt.key===null?wt:Tt.key),At=st(Tt,At,wt),Et===null?_t=Tt:Et.sibling=Tt,Et=Tt);return tt&&bt.forEach(function(Pt){return _e(vt,Pt)}),I$4&&tg(vt,wt),_t}function mt(vt,At,yt,xt){var _t=Ka(yt);if(typeof _t!="function")throw Error(p$4(150));if(yt=_t.call(yt),yt==null)throw Error(p$4(151));for(var Et=_t=null,bt=At,wt=At=0,Tt=null,Mt=yt.next();bt!==null&&!Mt.done;wt++,Mt=yt.next()){bt.index>wt?(Tt=bt,bt=null):Tt=bt.sibling;var Pt=dt(vt,bt,Mt.value,xt);if(Pt===null){bt===null&&(bt=Tt);break}tt&&bt&&Pt.alternate===null&&_e(vt,bt),At=st(Pt,At,wt),Et===null?_t=Pt:Et.sibling=Pt,Et=Pt,bt=Tt}if(Mt.done)return rt(vt,bt),I$4&&tg(vt,wt),_t;if(bt===null){for(;!Mt.done;wt++,Mt=yt.next())Mt=ht(vt,Mt.value,xt),Mt!==null&&(At=st(Mt,At,wt),Et===null?_t=Mt:Et.sibling=Mt,Et=Mt);return I$4&&tg(vt,wt),_t}for(bt=nt(vt,bt);!Mt.done;wt++,Mt=yt.next())Mt=ft(bt,vt,wt,Mt.value,xt),Mt!==null&&(tt&&Mt.alternate!==null&&bt.delete(Mt.key===null?wt:Mt.key),At=st(Mt,At,wt),Et===null?_t=Mt:Et.sibling=Mt,Et=Mt);return tt&&bt.forEach(function(It){return _e(vt,It)}),I$4&&tg(vt,wt),_t}function gt(vt,At,yt,xt){if(typeof yt=="object"&&yt!==null&&yt.type===ya&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case va:e:{for(var _t=yt.key,Et=At;Et!==null;){if(Et.key===_t){if(_t=yt.type,_t===ya){if(Et.tag===7){rt(vt,Et.sibling),At=it(Et,yt.props.children),At.return=vt,vt=At;break e}}else if(Et.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===Ha&&uh(_t)===Et.type){rt(vt,Et.sibling),At=it(Et,yt.props),At.ref=sh(vt,Et,yt),At.return=vt,vt=At;break e}rt(vt,Et);break}else _e(vt,Et);Et=Et.sibling}yt.type===ya?(At=Ah(yt.props.children,vt.mode,xt,yt.key),At.return=vt,vt=At):(xt=yh(yt.type,yt.key,yt.props,null,vt.mode,xt),xt.ref=sh(vt,At,yt),xt.return=vt,vt=xt)}return ot(vt);case wa:e:{for(Et=yt.key;At!==null;){if(At.key===Et)if(At.tag===4&&At.stateNode.containerInfo===yt.containerInfo&&At.stateNode.implementation===yt.implementation){rt(vt,At.sibling),At=it(At,yt.children||[]),At.return=vt,vt=At;break e}else{rt(vt,At);break}else _e(vt,At);At=At.sibling}At=zh(yt,vt.mode,xt),At.return=vt,vt=At}return ot(vt);case Ha:return Et=yt._init,gt(vt,At,Et(yt._payload),xt)}if(eb(yt))return pt(vt,At,yt,xt);if(Ka(yt))return mt(vt,At,yt,xt);th(vt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"?(yt=""+yt,At!==null&&At.tag===6?(rt(vt,At.sibling),At=it(At,yt),At.return=vt,vt=At):(rt(vt,At),At=xh(yt,vt.mode,xt),At.return=vt,vt=At),ot(vt)):rt(vt,At)}return gt}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(tt){if(tt===Dh)throw Error(p$4(174));return tt}function Ih(tt,_e){switch(G$1(Gh,_e),G$1(Fh,tt),G$1(Eh,Dh),tt=_e.nodeType,tt){case 9:case 11:_e=(_e=_e.documentElement)?_e.namespaceURI:lb(null,"");break;default:tt=tt===8?_e.parentNode:_e,_e=tt.namespaceURI||null,tt=tt.tagName,_e=lb(_e,tt)}E$2(Eh),G$1(Eh,_e)}function Jh(){E$2(Eh),E$2(Fh),E$2(Gh)}function Kh(tt){Hh(Gh.current);var _e=Hh(Eh.current),rt=lb(_e,tt.type);_e!==rt&&(G$1(Fh,tt),G$1(Eh,rt))}function Lh(tt){Fh.current===tt&&(E$2(Eh),E$2(Fh))}var M$2=Uf(0);function Mh(tt){for(var _e=tt;_e!==null;){if(_e.tag===13){var rt=_e.memoizedState;if(rt!==null&&(rt=rt.dehydrated,rt===null||rt.data==="$?"||rt.data==="$!"))return _e}else if(_e.tag===19&&_e.memoizedProps.revealOrder!==void 0){if(_e.flags&128)return _e}else if(_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===tt)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===tt)return null;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}return null}var Nh=[];function Oh(){for(var tt=0;tt<Nh.length;tt++)Nh[tt]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N$2=null,O$1=null,P$1=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q$2(){throw Error(p$4(321))}function Wh(tt,_e){if(_e===null)return!1;for(var rt=0;rt<_e.length&&rt<tt.length;rt++)if(!He(tt[rt],_e[rt]))return!1;return!0}function Xh(tt,_e,rt,nt,it,st){if(Rh=st,N$2=_e,_e.memoizedState=null,_e.updateQueue=null,_e.lanes=0,Ph.current=tt===null||tt.memoizedState===null?Yh:Zh,tt=rt(nt,it),Th){st=0;do{if(Th=!1,Uh=0,25<=st)throw Error(p$4(301));st+=1,P$1=O$1=null,_e.updateQueue=null,Ph.current=$h,tt=rt(nt,it)}while(Th)}if(Ph.current=ai,_e=O$1!==null&&O$1.next!==null,Rh=0,P$1=O$1=N$2=null,Sh=!1,_e)throw Error(p$4(300));return tt}function bi(){var tt=Uh!==0;return Uh=0,tt}function ci(){var tt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P$1===null?N$2.memoizedState=P$1=tt:P$1=P$1.next=tt,P$1}function di(){if(O$1===null){var tt=N$2.alternate;tt=tt!==null?tt.memoizedState:null}else tt=O$1.next;var _e=P$1===null?N$2.memoizedState:P$1.next;if(_e!==null)P$1=_e,O$1=tt;else{if(tt===null)throw Error(p$4(310));O$1=tt,tt={memoizedState:O$1.memoizedState,baseState:O$1.baseState,baseQueue:O$1.baseQueue,queue:O$1.queue,next:null},P$1===null?N$2.memoizedState=P$1=tt:P$1=P$1.next=tt}return P$1}function ei(tt,_e){return typeof _e=="function"?_e(tt):_e}function fi(tt){var _e=di(),rt=_e.queue;if(rt===null)throw Error(p$4(311));rt.lastRenderedReducer=tt;var nt=O$1,it=nt.baseQueue,st=rt.pending;if(st!==null){if(it!==null){var ot=it.next;it.next=st.next,st.next=ot}nt.baseQueue=it=st,rt.pending=null}if(it!==null){st=it.next,nt=nt.baseState;var lt=ot=null,at=null,ct=st;do{var ut=ct.lane;if((Rh&ut)===ut)at!==null&&(at=at.next={lane:0,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),nt=ct.hasEagerState?ct.eagerState:tt(nt,ct.action);else{var ht={lane:ut,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null};at===null?(lt=at=ht,ot=nt):at=at.next=ht,N$2.lanes|=ut,hh|=ut}ct=ct.next}while(ct!==null&&ct!==st);at===null?ot=nt:at.next=lt,He(nt,_e.memoizedState)||(Ug=!0),_e.memoizedState=nt,_e.baseState=ot,_e.baseQueue=at,rt.lastRenderedState=nt}if(tt=rt.interleaved,tt!==null){it=tt;do st=it.lane,N$2.lanes|=st,hh|=st,it=it.next;while(it!==tt)}else it===null&&(rt.lanes=0);return[_e.memoizedState,rt.dispatch]}function gi(tt){var _e=di(),rt=_e.queue;if(rt===null)throw Error(p$4(311));rt.lastRenderedReducer=tt;var nt=rt.dispatch,it=rt.pending,st=_e.memoizedState;if(it!==null){rt.pending=null;var ot=it=it.next;do st=tt(st,ot.action),ot=ot.next;while(ot!==it);He(st,_e.memoizedState)||(Ug=!0),_e.memoizedState=st,_e.baseQueue===null&&(_e.baseState=st),rt.lastRenderedState=st}return[st,nt]}function hi(){}function ii(tt,_e){var rt=N$2,nt=di(),it=_e(),st=!He(nt.memoizedState,it);if(st&&(nt.memoizedState=it,Ug=!0),nt=nt.queue,ji(ki.bind(null,rt,nt,tt),[tt]),nt.getSnapshot!==_e||st||P$1!==null&&P$1.memoizedState.tag&1){if(rt.flags|=2048,li(9,mi.bind(null,rt,nt,it,_e),void 0,null),R$1===null)throw Error(p$4(349));Rh&30||ni(rt,_e,it)}return it}function ni(tt,_e,rt){tt.flags|=16384,tt={getSnapshot:_e,value:rt},_e=N$2.updateQueue,_e===null?(_e={lastEffect:null,stores:null},N$2.updateQueue=_e,_e.stores=[tt]):(rt=_e.stores,rt===null?_e.stores=[tt]:rt.push(tt))}function mi(tt,_e,rt,nt){_e.value=rt,_e.getSnapshot=nt,oi(_e)&&pi(tt)}function ki(tt,_e,rt){return rt(function(){oi(_e)&&pi(tt)})}function oi(tt){var _e=tt.getSnapshot;tt=tt.value;try{var rt=_e();return!He(tt,rt)}catch{return!0}}function pi(tt){var _e=Zg(tt,1);_e!==null&&mh(_e,tt,1,-1)}function qi(tt){var _e=ci();return typeof tt=="function"&&(tt=tt()),_e.memoizedState=_e.baseState=tt,tt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:tt},_e.queue=tt,tt=tt.dispatch=ri.bind(null,N$2,tt),[_e.memoizedState,tt]}function li(tt,_e,rt,nt){return tt={tag:tt,create:_e,destroy:rt,deps:nt,next:null},_e=N$2.updateQueue,_e===null?(_e={lastEffect:null,stores:null},N$2.updateQueue=_e,_e.lastEffect=tt.next=tt):(rt=_e.lastEffect,rt===null?_e.lastEffect=tt.next=tt:(nt=rt.next,rt.next=tt,tt.next=nt,_e.lastEffect=tt)),tt}function si(){return di().memoizedState}function ti(tt,_e,rt,nt){var it=ci();N$2.flags|=tt,it.memoizedState=li(1|_e,rt,void 0,nt===void 0?null:nt)}function ui(tt,_e,rt,nt){var it=di();nt=nt===void 0?null:nt;var st=void 0;if(O$1!==null){var ot=O$1.memoizedState;if(st=ot.destroy,nt!==null&&Wh(nt,ot.deps)){it.memoizedState=li(_e,rt,st,nt);return}}N$2.flags|=tt,it.memoizedState=li(1|_e,rt,st,nt)}function vi(tt,_e){return ti(8390656,8,tt,_e)}function ji(tt,_e){return ui(2048,8,tt,_e)}function wi(tt,_e){return ui(4,2,tt,_e)}function xi(tt,_e){return ui(4,4,tt,_e)}function yi(tt,_e){if(typeof _e=="function")return tt=tt(),_e(tt),function(){_e(null)};if(_e!=null)return tt=tt(),_e.current=tt,function(){_e.current=null}}function zi(tt,_e,rt){return rt=rt!=null?rt.concat([tt]):null,ui(4,4,yi.bind(null,_e,tt),rt)}function Ai(){}function Bi(tt,_e){var rt=di();_e=_e===void 0?null:_e;var nt=rt.memoizedState;return nt!==null&&_e!==null&&Wh(_e,nt[1])?nt[0]:(rt.memoizedState=[tt,_e],tt)}function Ci(tt,_e){var rt=di();_e=_e===void 0?null:_e;var nt=rt.memoizedState;return nt!==null&&_e!==null&&Wh(_e,nt[1])?nt[0]:(tt=tt(),rt.memoizedState=[tt,_e],tt)}function Di(tt,_e,rt){return Rh&21?(He(rt,_e)||(rt=yc(),N$2.lanes|=rt,hh|=rt,tt.baseState=!0),_e):(tt.baseState&&(tt.baseState=!1,Ug=!0),tt.memoizedState=rt)}function Ei(tt,_e){var rt=C$2;C$2=rt!==0&&4>rt?rt:4,tt(!0);var nt=Qh.transition;Qh.transition={};try{tt(!1),_e()}finally{C$2=rt,Qh.transition=nt}}function Fi(){return di().memoizedState}function Gi(tt,_e,rt){var nt=lh(tt);if(rt={lane:nt,action:rt,hasEagerState:!1,eagerState:null,next:null},Hi(tt))Ii(_e,rt);else if(rt=Yg(tt,_e,rt,nt),rt!==null){var it=L$2();mh(rt,tt,nt,it),Ji(rt,_e,nt)}}function ri(tt,_e,rt){var nt=lh(tt),it={lane:nt,action:rt,hasEagerState:!1,eagerState:null,next:null};if(Hi(tt))Ii(_e,it);else{var st=tt.alternate;if(tt.lanes===0&&(st===null||st.lanes===0)&&(st=_e.lastRenderedReducer,st!==null))try{var ot=_e.lastRenderedState,lt=st(ot,rt);if(it.hasEagerState=!0,it.eagerState=lt,He(lt,ot)){var at=_e.interleaved;at===null?(it.next=it,Xg(_e)):(it.next=at.next,at.next=it),_e.interleaved=it;return}}catch{}finally{}rt=Yg(tt,_e,it,nt),rt!==null&&(it=L$2(),mh(rt,tt,nt,it),Ji(rt,_e,nt))}}function Hi(tt){var _e=tt.alternate;return tt===N$2||_e!==null&&_e===N$2}function Ii(tt,_e){Th=Sh=!0;var rt=tt.pending;rt===null?_e.next=_e:(_e.next=rt.next,rt.next=_e),tt.pending=_e}function Ji(tt,_e,rt){if(rt&4194240){var nt=_e.lanes;nt&=tt.pendingLanes,rt|=nt,_e.lanes=rt,Cc(tt,rt)}}var ai={readContext:Vg,useCallback:Q$2,useContext:Q$2,useEffect:Q$2,useImperativeHandle:Q$2,useInsertionEffect:Q$2,useLayoutEffect:Q$2,useMemo:Q$2,useReducer:Q$2,useRef:Q$2,useState:Q$2,useDebugValue:Q$2,useDeferredValue:Q$2,useTransition:Q$2,useMutableSource:Q$2,useSyncExternalStore:Q$2,useId:Q$2,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(tt,_e){return ci().memoizedState=[tt,_e===void 0?null:_e],tt},useContext:Vg,useEffect:vi,useImperativeHandle:function(tt,_e,rt){return rt=rt!=null?rt.concat([tt]):null,ti(4194308,4,yi.bind(null,_e,tt),rt)},useLayoutEffect:function(tt,_e){return ti(4194308,4,tt,_e)},useInsertionEffect:function(tt,_e){return ti(4,2,tt,_e)},useMemo:function(tt,_e){var rt=ci();return _e=_e===void 0?null:_e,tt=tt(),rt.memoizedState=[tt,_e],tt},useReducer:function(tt,_e,rt){var nt=ci();return _e=rt!==void 0?rt(_e):_e,nt.memoizedState=nt.baseState=_e,tt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tt,lastRenderedState:_e},nt.queue=tt,tt=tt.dispatch=Gi.bind(null,N$2,tt),[nt.memoizedState,tt]},useRef:function(tt){var _e=ci();return tt={current:tt},_e.memoizedState=tt},useState:qi,useDebugValue:Ai,useDeferredValue:function(tt){return ci().memoizedState=tt},useTransition:function(){var tt=qi(!1),_e=tt[0];return tt=Ei.bind(null,tt[1]),ci().memoizedState=tt,[_e,tt]},useMutableSource:function(){},useSyncExternalStore:function(tt,_e,rt){var nt=N$2,it=ci();if(I$4){if(rt===void 0)throw Error(p$4(407));rt=rt()}else{if(rt=_e(),R$1===null)throw Error(p$4(349));Rh&30||ni(nt,_e,rt)}it.memoizedState=rt;var st={value:rt,getSnapshot:_e};return it.queue=st,vi(ki.bind(null,nt,st,tt),[tt]),nt.flags|=2048,li(9,mi.bind(null,nt,st,rt,_e),void 0,null),rt},useId:function(){var tt=ci(),_e=R$1.identifierPrefix;if(I$4){var rt=sg,nt=rg;rt=(nt&~(1<<32-oc(nt)-1)).toString(32)+rt,_e=":"+_e+"R"+rt,rt=Uh++,0<rt&&(_e+="H"+rt.toString(32)),_e+=":"}else rt=Vh++,_e=":"+_e+"r"+rt.toString(32)+":";return tt.memoizedState=_e},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(tt){var _e=di();return Di(_e,O$1.memoizedState,tt)},useTransition:function(){var tt=fi(ei)[0],_e=di().memoizedState;return[tt,_e]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(tt){var _e=di();return O$1===null?_e.memoizedState=tt:Di(_e,O$1.memoizedState,tt)},useTransition:function(){var tt=gi(ei)[0],_e=di().memoizedState;return[tt,_e]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(tt,_e){try{var rt="",nt=_e;do rt+=Pa(nt),nt=nt.return;while(nt);var it=rt}catch(st){it=`
Error generating stack: `+st.message+`
`+st.stack}return{value:tt,source:_e,stack:it,digest:null}}function Li(tt,_e,rt){return{value:tt,source:null,stack:rt??null,digest:_e??null}}function Mi(tt,_e){try{console.error(_e.value)}catch(rt){setTimeout(function(){throw rt})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(tt,_e,rt){rt=ch(-1,rt),rt.tag=3,rt.payload={element:null};var nt=_e.value;return rt.callback=function(){Pi||(Pi=!0,Qi=nt),Mi(tt,_e)},rt}function Ri(tt,_e,rt){rt=ch(-1,rt),rt.tag=3;var nt=tt.type.getDerivedStateFromError;if(typeof nt=="function"){var it=_e.value;rt.payload=function(){return nt(it)},rt.callback=function(){Mi(tt,_e)}}var st=tt.stateNode;return st!==null&&typeof st.componentDidCatch=="function"&&(rt.callback=function(){Mi(tt,_e),typeof nt!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var ot=_e.stack;this.componentDidCatch(_e.value,{componentStack:ot!==null?ot:""})}),rt}function Ti(tt,_e,rt){var nt=tt.pingCache;if(nt===null){nt=tt.pingCache=new Ni;var it=new Set;nt.set(_e,it)}else it=nt.get(_e),it===void 0&&(it=new Set,nt.set(_e,it));it.has(rt)||(it.add(rt),tt=Ui.bind(null,tt,_e,rt),_e.then(tt,tt))}function Vi(tt){do{var _e;if((_e=tt.tag===13)&&(_e=tt.memoizedState,_e=_e!==null?_e.dehydrated!==null:!0),_e)return tt;tt=tt.return}while(tt!==null);return null}function Wi(tt,_e,rt,nt,it){return tt.mode&1?(tt.flags|=65536,tt.lanes=it,tt):(tt===_e?tt.flags|=65536:(tt.flags|=128,rt.flags|=131072,rt.flags&=-52805,rt.tag===1&&(rt.alternate===null?rt.tag=17:(_e=ch(-1,1),_e.tag=2,dh(rt,_e,1))),rt.lanes|=1),tt)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(tt,_e,rt,nt){_e.child=tt===null?Ch(_e,null,rt,nt):Bh(_e,tt.child,rt,nt)}function Zi(tt,_e,rt,nt,it){rt=rt.render;var st=_e.ref;return Tg(_e,it),nt=Xh(tt,_e,rt,nt,st,it),rt=bi(),tt!==null&&!Ug?(_e.updateQueue=tt.updateQueue,_e.flags&=-2053,tt.lanes&=~it,$i(tt,_e,it)):(I$4&&rt&&vg(_e),_e.flags|=1,Yi(tt,_e,nt,it),_e.child)}function aj(tt,_e,rt,nt,it){if(tt===null){var st=rt.type;return typeof st=="function"&&!bj(st)&&st.defaultProps===void 0&&rt.compare===null&&rt.defaultProps===void 0?(_e.tag=15,_e.type=st,cj(tt,_e,st,nt,it)):(tt=yh(rt.type,null,nt,_e,_e.mode,it),tt.ref=_e.ref,tt.return=_e,_e.child=tt)}if(st=tt.child,!(tt.lanes&it)){var ot=st.memoizedProps;if(rt=rt.compare,rt=rt!==null?rt:Ie,rt(ot,nt)&&tt.ref===_e.ref)return $i(tt,_e,it)}return _e.flags|=1,tt=wh(st,nt),tt.ref=_e.ref,tt.return=_e,_e.child=tt}function cj(tt,_e,rt,nt,it){if(tt!==null){var st=tt.memoizedProps;if(Ie(st,nt)&&tt.ref===_e.ref)if(Ug=!1,_e.pendingProps=nt=st,(tt.lanes&it)!==0)tt.flags&131072&&(Ug=!0);else return _e.lanes=tt.lanes,$i(tt,_e,it)}return dj(tt,_e,rt,nt,it)}function ej(tt,_e,rt){var nt=_e.pendingProps,it=nt.children,st=tt!==null?tt.memoizedState:null;if(nt.mode==="hidden")if(!(_e.mode&1))_e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(fj,gj),gj|=rt;else{if(!(rt&1073741824))return tt=st!==null?st.baseLanes|rt:rt,_e.lanes=_e.childLanes=1073741824,_e.memoizedState={baseLanes:tt,cachePool:null,transitions:null},_e.updateQueue=null,G$1(fj,gj),gj|=tt,null;_e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt=st!==null?st.baseLanes:rt,G$1(fj,gj),gj|=nt}else st!==null?(nt=st.baseLanes|rt,_e.memoizedState=null):nt=rt,G$1(fj,gj),gj|=nt;return Yi(tt,_e,it,rt),_e.child}function hj(tt,_e){var rt=_e.ref;(tt===null&&rt!==null||tt!==null&&tt.ref!==rt)&&(_e.flags|=512,_e.flags|=2097152)}function dj(tt,_e,rt,nt,it){var st=Zf(rt)?Xf:H$2.current;return st=Yf(_e,st),Tg(_e,it),rt=Xh(tt,_e,rt,nt,st,it),nt=bi(),tt!==null&&!Ug?(_e.updateQueue=tt.updateQueue,_e.flags&=-2053,tt.lanes&=~it,$i(tt,_e,it)):(I$4&&nt&&vg(_e),_e.flags|=1,Yi(tt,_e,rt,it),_e.child)}function ij(tt,_e,rt,nt,it){if(Zf(rt)){var st=!0;cg(_e)}else st=!1;if(Tg(_e,it),_e.stateNode===null)jj(tt,_e),ph(_e,rt,nt),rh(_e,rt,nt,it),nt=!0;else if(tt===null){var ot=_e.stateNode,lt=_e.memoizedProps;ot.props=lt;var at=ot.context,ct=rt.contextType;typeof ct=="object"&&ct!==null?ct=Vg(ct):(ct=Zf(rt)?Xf:H$2.current,ct=Yf(_e,ct));var ut=rt.getDerivedStateFromProps,ht=typeof ut=="function"||typeof ot.getSnapshotBeforeUpdate=="function";ht||typeof ot.UNSAFE_componentWillReceiveProps!="function"&&typeof ot.componentWillReceiveProps!="function"||(lt!==nt||at!==ct)&&qh(_e,ot,nt,ct),$g=!1;var dt=_e.memoizedState;ot.state=dt,gh(_e,nt,ot,it),at=_e.memoizedState,lt!==nt||dt!==at||Wf.current||$g?(typeof ut=="function"&&(kh(_e,rt,ut,nt),at=_e.memoizedState),(lt=$g||oh(_e,rt,lt,nt,dt,at,ct))?(ht||typeof ot.UNSAFE_componentWillMount!="function"&&typeof ot.componentWillMount!="function"||(typeof ot.componentWillMount=="function"&&ot.componentWillMount(),typeof ot.UNSAFE_componentWillMount=="function"&&ot.UNSAFE_componentWillMount()),typeof ot.componentDidMount=="function"&&(_e.flags|=4194308)):(typeof ot.componentDidMount=="function"&&(_e.flags|=4194308),_e.memoizedProps=nt,_e.memoizedState=at),ot.props=nt,ot.state=at,ot.context=ct,nt=lt):(typeof ot.componentDidMount=="function"&&(_e.flags|=4194308),nt=!1)}else{ot=_e.stateNode,bh(tt,_e),lt=_e.memoizedProps,ct=_e.type===_e.elementType?lt:Lg(_e.type,lt),ot.props=ct,ht=_e.pendingProps,dt=ot.context,at=rt.contextType,typeof at=="object"&&at!==null?at=Vg(at):(at=Zf(rt)?Xf:H$2.current,at=Yf(_e,at));var ft=rt.getDerivedStateFromProps;(ut=typeof ft=="function"||typeof ot.getSnapshotBeforeUpdate=="function")||typeof ot.UNSAFE_componentWillReceiveProps!="function"&&typeof ot.componentWillReceiveProps!="function"||(lt!==ht||dt!==at)&&qh(_e,ot,nt,at),$g=!1,dt=_e.memoizedState,ot.state=dt,gh(_e,nt,ot,it);var pt=_e.memoizedState;lt!==ht||dt!==pt||Wf.current||$g?(typeof ft=="function"&&(kh(_e,rt,ft,nt),pt=_e.memoizedState),(ct=$g||oh(_e,rt,ct,nt,dt,pt,at)||!1)?(ut||typeof ot.UNSAFE_componentWillUpdate!="function"&&typeof ot.componentWillUpdate!="function"||(typeof ot.componentWillUpdate=="function"&&ot.componentWillUpdate(nt,pt,at),typeof ot.UNSAFE_componentWillUpdate=="function"&&ot.UNSAFE_componentWillUpdate(nt,pt,at)),typeof ot.componentDidUpdate=="function"&&(_e.flags|=4),typeof ot.getSnapshotBeforeUpdate=="function"&&(_e.flags|=1024)):(typeof ot.componentDidUpdate!="function"||lt===tt.memoizedProps&&dt===tt.memoizedState||(_e.flags|=4),typeof ot.getSnapshotBeforeUpdate!="function"||lt===tt.memoizedProps&&dt===tt.memoizedState||(_e.flags|=1024),_e.memoizedProps=nt,_e.memoizedState=pt),ot.props=nt,ot.state=pt,ot.context=at,nt=ct):(typeof ot.componentDidUpdate!="function"||lt===tt.memoizedProps&&dt===tt.memoizedState||(_e.flags|=4),typeof ot.getSnapshotBeforeUpdate!="function"||lt===tt.memoizedProps&&dt===tt.memoizedState||(_e.flags|=1024),nt=!1)}return kj(tt,_e,rt,nt,st,it)}function kj(tt,_e,rt,nt,it,st){hj(tt,_e);var ot=(_e.flags&128)!==0;if(!nt&&!ot)return it&&dg(_e,rt,!1),$i(tt,_e,st);nt=_e.stateNode,Xi.current=_e;var lt=ot&&typeof rt.getDerivedStateFromError!="function"?null:nt.render();return _e.flags|=1,tt!==null&&ot?(_e.child=Bh(_e,tt.child,null,st),_e.child=Bh(_e,null,lt,st)):Yi(tt,_e,lt,st),_e.memoizedState=nt.state,it&&dg(_e,rt,!0),_e.child}function lj(tt){var _e=tt.stateNode;_e.pendingContext?ag(tt,_e.pendingContext,_e.pendingContext!==_e.context):_e.context&&ag(tt,_e.context,!1),Ih(tt,_e.containerInfo)}function mj(tt,_e,rt,nt,it){return Ig(),Jg(it),_e.flags|=256,Yi(tt,_e,rt,nt),_e.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(tt){return{baseLanes:tt,cachePool:null,transitions:null}}function pj(tt,_e,rt){var nt=_e.pendingProps,it=M$2.current,st=!1,ot=(_e.flags&128)!==0,lt;if((lt=ot)||(lt=tt!==null&&tt.memoizedState===null?!1:(it&2)!==0),lt?(st=!0,_e.flags&=-129):(tt===null||tt.memoizedState!==null)&&(it|=1),G$1(M$2,it&1),tt===null)return Eg(_e),tt=_e.memoizedState,tt!==null&&(tt=tt.dehydrated,tt!==null)?(_e.mode&1?tt.data==="$!"?_e.lanes=8:_e.lanes=1073741824:_e.lanes=1,null):(ot=nt.children,tt=nt.fallback,st?(nt=_e.mode,st=_e.child,ot={mode:"hidden",children:ot},!(nt&1)&&st!==null?(st.childLanes=0,st.pendingProps=ot):st=qj(ot,nt,0,null),tt=Ah(tt,nt,rt,null),st.return=_e,tt.return=_e,st.sibling=tt,_e.child=st,_e.child.memoizedState=oj(rt),_e.memoizedState=nj,tt):rj(_e,ot));if(it=tt.memoizedState,it!==null&&(lt=it.dehydrated,lt!==null))return sj(tt,_e,ot,nt,lt,it,rt);if(st){st=nt.fallback,ot=_e.mode,it=tt.child,lt=it.sibling;var at={mode:"hidden",children:nt.children};return!(ot&1)&&_e.child!==it?(nt=_e.child,nt.childLanes=0,nt.pendingProps=at,_e.deletions=null):(nt=wh(it,at),nt.subtreeFlags=it.subtreeFlags&14680064),lt!==null?st=wh(lt,st):(st=Ah(st,ot,rt,null),st.flags|=2),st.return=_e,nt.return=_e,nt.sibling=st,_e.child=nt,nt=st,st=_e.child,ot=tt.child.memoizedState,ot=ot===null?oj(rt):{baseLanes:ot.baseLanes|rt,cachePool:null,transitions:ot.transitions},st.memoizedState=ot,st.childLanes=tt.childLanes&~rt,_e.memoizedState=nj,nt}return st=tt.child,tt=st.sibling,nt=wh(st,{mode:"visible",children:nt.children}),!(_e.mode&1)&&(nt.lanes=rt),nt.return=_e,nt.sibling=null,tt!==null&&(rt=_e.deletions,rt===null?(_e.deletions=[tt],_e.flags|=16):rt.push(tt)),_e.child=nt,_e.memoizedState=null,nt}function rj(tt,_e){return _e=qj({mode:"visible",children:_e},tt.mode,0,null),_e.return=tt,tt.child=_e}function tj(tt,_e,rt,nt){return nt!==null&&Jg(nt),Bh(_e,tt.child,null,rt),tt=rj(_e,_e.pendingProps.children),tt.flags|=2,_e.memoizedState=null,tt}function sj(tt,_e,rt,nt,it,st,ot){if(rt)return _e.flags&256?(_e.flags&=-257,nt=Li(Error(p$4(422))),tj(tt,_e,ot,nt)):_e.memoizedState!==null?(_e.child=tt.child,_e.flags|=128,null):(st=nt.fallback,it=_e.mode,nt=qj({mode:"visible",children:nt.children},it,0,null),st=Ah(st,it,ot,null),st.flags|=2,nt.return=_e,st.return=_e,nt.sibling=st,_e.child=nt,_e.mode&1&&Bh(_e,tt.child,null,ot),_e.child.memoizedState=oj(ot),_e.memoizedState=nj,st);if(!(_e.mode&1))return tj(tt,_e,ot,null);if(it.data==="$!"){if(nt=it.nextSibling&&it.nextSibling.dataset,nt)var lt=nt.dgst;return nt=lt,st=Error(p$4(419)),nt=Li(st,nt,void 0),tj(tt,_e,ot,nt)}if(lt=(ot&tt.childLanes)!==0,Ug||lt){if(nt=R$1,nt!==null){switch(ot&-ot){case 4:it=2;break;case 16:it=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:it=32;break;case 536870912:it=268435456;break;default:it=0}it=it&(nt.suspendedLanes|ot)?0:it,it!==0&&it!==st.retryLane&&(st.retryLane=it,Zg(tt,it),mh(nt,tt,it,-1))}return uj(),nt=Li(Error(p$4(421))),tj(tt,_e,ot,nt)}return it.data==="$?"?(_e.flags|=128,_e.child=tt.child,_e=vj.bind(null,tt),it._reactRetry=_e,null):(tt=st.treeContext,yg=Lf(it.nextSibling),xg=_e,I$4=!0,zg=null,tt!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=tt.id,sg=tt.overflow,qg=_e),_e=rj(_e,nt.children),_e.flags|=4096,_e)}function wj(tt,_e,rt){tt.lanes|=_e;var nt=tt.alternate;nt!==null&&(nt.lanes|=_e),Sg(tt.return,_e,rt)}function xj(tt,_e,rt,nt,it){var st=tt.memoizedState;st===null?tt.memoizedState={isBackwards:_e,rendering:null,renderingStartTime:0,last:nt,tail:rt,tailMode:it}:(st.isBackwards=_e,st.rendering=null,st.renderingStartTime=0,st.last=nt,st.tail=rt,st.tailMode=it)}function yj(tt,_e,rt){var nt=_e.pendingProps,it=nt.revealOrder,st=nt.tail;if(Yi(tt,_e,nt.children,rt),nt=M$2.current,nt&2)nt=nt&1|2,_e.flags|=128;else{if(tt!==null&&tt.flags&128)e:for(tt=_e.child;tt!==null;){if(tt.tag===13)tt.memoizedState!==null&&wj(tt,rt,_e);else if(tt.tag===19)wj(tt,rt,_e);else if(tt.child!==null){tt.child.return=tt,tt=tt.child;continue}if(tt===_e)break e;for(;tt.sibling===null;){if(tt.return===null||tt.return===_e)break e;tt=tt.return}tt.sibling.return=tt.return,tt=tt.sibling}nt&=1}if(G$1(M$2,nt),!(_e.mode&1))_e.memoizedState=null;else switch(it){case"forwards":for(rt=_e.child,it=null;rt!==null;)tt=rt.alternate,tt!==null&&Mh(tt)===null&&(it=rt),rt=rt.sibling;rt=it,rt===null?(it=_e.child,_e.child=null):(it=rt.sibling,rt.sibling=null),xj(_e,!1,it,rt,st);break;case"backwards":for(rt=null,it=_e.child,_e.child=null;it!==null;){if(tt=it.alternate,tt!==null&&Mh(tt)===null){_e.child=it;break}tt=it.sibling,it.sibling=rt,rt=it,it=tt}xj(_e,!0,rt,null,st);break;case"together":xj(_e,!1,null,null,void 0);break;default:_e.memoizedState=null}return _e.child}function jj(tt,_e){!(_e.mode&1)&&tt!==null&&(tt.alternate=null,_e.alternate=null,_e.flags|=2)}function $i(tt,_e,rt){if(tt!==null&&(_e.dependencies=tt.dependencies),hh|=_e.lanes,!(rt&_e.childLanes))return null;if(tt!==null&&_e.child!==tt.child)throw Error(p$4(153));if(_e.child!==null){for(tt=_e.child,rt=wh(tt,tt.pendingProps),_e.child=rt,rt.return=_e;tt.sibling!==null;)tt=tt.sibling,rt=rt.sibling=wh(tt,tt.pendingProps),rt.return=_e;rt.sibling=null}return _e.child}function zj(tt,_e,rt){switch(_e.tag){case 3:lj(_e),Ig();break;case 5:Kh(_e);break;case 1:Zf(_e.type)&&cg(_e);break;case 4:Ih(_e,_e.stateNode.containerInfo);break;case 10:var nt=_e.type._context,it=_e.memoizedProps.value;G$1(Mg,nt._currentValue),nt._currentValue=it;break;case 13:if(nt=_e.memoizedState,nt!==null)return nt.dehydrated!==null?(G$1(M$2,M$2.current&1),_e.flags|=128,null):rt&_e.child.childLanes?pj(tt,_e,rt):(G$1(M$2,M$2.current&1),tt=$i(tt,_e,rt),tt!==null?tt.sibling:null);G$1(M$2,M$2.current&1);break;case 19:if(nt=(rt&_e.childLanes)!==0,tt.flags&128){if(nt)return yj(tt,_e,rt);_e.flags|=128}if(it=_e.memoizedState,it!==null&&(it.rendering=null,it.tail=null,it.lastEffect=null),G$1(M$2,M$2.current),nt)break;return null;case 22:case 23:return _e.lanes=0,ej(tt,_e,rt)}return $i(tt,_e,rt)}var Aj,Bj,Cj,Dj;Aj=function(tt,_e){for(var rt=_e.child;rt!==null;){if(rt.tag===5||rt.tag===6)tt.appendChild(rt.stateNode);else if(rt.tag!==4&&rt.child!==null){rt.child.return=rt,rt=rt.child;continue}if(rt===_e)break;for(;rt.sibling===null;){if(rt.return===null||rt.return===_e)return;rt=rt.return}rt.sibling.return=rt.return,rt=rt.sibling}};Bj=function(){};Cj=function(tt,_e,rt,nt){var it=tt.memoizedProps;if(it!==nt){tt=_e.stateNode,Hh(Eh.current);var st=null;switch(rt){case"input":it=Ya(tt,it),nt=Ya(tt,nt),st=[];break;case"select":it=A$2({},it,{value:void 0}),nt=A$2({},nt,{value:void 0}),st=[];break;case"textarea":it=gb(tt,it),nt=gb(tt,nt),st=[];break;default:typeof it.onClick!="function"&&typeof nt.onClick=="function"&&(tt.onclick=Bf)}ub(rt,nt);var ot;rt=null;for(ct in it)if(!nt.hasOwnProperty(ct)&&it.hasOwnProperty(ct)&&it[ct]!=null)if(ct==="style"){var lt=it[ct];for(ot in lt)lt.hasOwnProperty(ot)&&(rt||(rt={}),rt[ot]="")}else ct!=="dangerouslySetInnerHTML"&&ct!=="children"&&ct!=="suppressContentEditableWarning"&&ct!=="suppressHydrationWarning"&&ct!=="autoFocus"&&(ea.hasOwnProperty(ct)?st||(st=[]):(st=st||[]).push(ct,null));for(ct in nt){var at=nt[ct];if(lt=it!=null?it[ct]:void 0,nt.hasOwnProperty(ct)&&at!==lt&&(at!=null||lt!=null))if(ct==="style")if(lt){for(ot in lt)!lt.hasOwnProperty(ot)||at&&at.hasOwnProperty(ot)||(rt||(rt={}),rt[ot]="");for(ot in at)at.hasOwnProperty(ot)&&lt[ot]!==at[ot]&&(rt||(rt={}),rt[ot]=at[ot])}else rt||(st||(st=[]),st.push(ct,rt)),rt=at;else ct==="dangerouslySetInnerHTML"?(at=at?at.__html:void 0,lt=lt?lt.__html:void 0,at!=null&&lt!==at&&(st=st||[]).push(ct,at)):ct==="children"?typeof at!="string"&&typeof at!="number"||(st=st||[]).push(ct,""+at):ct!=="suppressContentEditableWarning"&&ct!=="suppressHydrationWarning"&&(ea.hasOwnProperty(ct)?(at!=null&&ct==="onScroll"&&D$1("scroll",tt),st||lt===at||(st=[])):(st=st||[]).push(ct,at))}rt&&(st=st||[]).push("style",rt);var ct=st;(_e.updateQueue=ct)&&(_e.flags|=4)}};Dj=function(tt,_e,rt,nt){rt!==nt&&(_e.flags|=4)};function Ej(tt,_e){if(!I$4)switch(tt.tailMode){case"hidden":_e=tt.tail;for(var rt=null;_e!==null;)_e.alternate!==null&&(rt=_e),_e=_e.sibling;rt===null?tt.tail=null:rt.sibling=null;break;case"collapsed":rt=tt.tail;for(var nt=null;rt!==null;)rt.alternate!==null&&(nt=rt),rt=rt.sibling;nt===null?_e||tt.tail===null?tt.tail=null:tt.tail.sibling=null:nt.sibling=null}}function S$3(tt){var _e=tt.alternate!==null&&tt.alternate.child===tt.child,rt=0,nt=0;if(_e)for(var it=tt.child;it!==null;)rt|=it.lanes|it.childLanes,nt|=it.subtreeFlags&14680064,nt|=it.flags&14680064,it.return=tt,it=it.sibling;else for(it=tt.child;it!==null;)rt|=it.lanes|it.childLanes,nt|=it.subtreeFlags,nt|=it.flags,it.return=tt,it=it.sibling;return tt.subtreeFlags|=nt,tt.childLanes=rt,_e}function Fj(tt,_e,rt){var nt=_e.pendingProps;switch(wg(_e),_e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$3(_e),null;case 1:return Zf(_e.type)&&$f(),S$3(_e),null;case 3:return nt=_e.stateNode,Jh(),E$2(Wf),E$2(H$2),Oh(),nt.pendingContext&&(nt.context=nt.pendingContext,nt.pendingContext=null),(tt===null||tt.child===null)&&(Gg(_e)?_e.flags|=4:tt===null||tt.memoizedState.isDehydrated&&!(_e.flags&256)||(_e.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(tt,_e),S$3(_e),null;case 5:Lh(_e);var it=Hh(Gh.current);if(rt=_e.type,tt!==null&&_e.stateNode!=null)Cj(tt,_e,rt,nt,it),tt.ref!==_e.ref&&(_e.flags|=512,_e.flags|=2097152);else{if(!nt){if(_e.stateNode===null)throw Error(p$4(166));return S$3(_e),null}if(tt=Hh(Eh.current),Gg(_e)){nt=_e.stateNode,rt=_e.type;var st=_e.memoizedProps;switch(nt[Of]=_e,nt[Pf]=st,tt=(_e.mode&1)!==0,rt){case"dialog":D$1("cancel",nt),D$1("close",nt);break;case"iframe":case"object":case"embed":D$1("load",nt);break;case"video":case"audio":for(it=0;it<lf.length;it++)D$1(lf[it],nt);break;case"source":D$1("error",nt);break;case"img":case"image":case"link":D$1("error",nt),D$1("load",nt);break;case"details":D$1("toggle",nt);break;case"input":Za(nt,st),D$1("invalid",nt);break;case"select":nt._wrapperState={wasMultiple:!!st.multiple},D$1("invalid",nt);break;case"textarea":hb(nt,st),D$1("invalid",nt)}ub(rt,st),it=null;for(var ot in st)if(st.hasOwnProperty(ot)){var lt=st[ot];ot==="children"?typeof lt=="string"?nt.textContent!==lt&&(st.suppressHydrationWarning!==!0&&Af(nt.textContent,lt,tt),it=["children",lt]):typeof lt=="number"&&nt.textContent!==""+lt&&(st.suppressHydrationWarning!==!0&&Af(nt.textContent,lt,tt),it=["children",""+lt]):ea.hasOwnProperty(ot)&&lt!=null&&ot==="onScroll"&&D$1("scroll",nt)}switch(rt){case"input":Va(nt),db(nt,st,!0);break;case"textarea":Va(nt),jb(nt);break;case"select":case"option":break;default:typeof st.onClick=="function"&&(nt.onclick=Bf)}nt=it,_e.updateQueue=nt,nt!==null&&(_e.flags|=4)}else{ot=it.nodeType===9?it:it.ownerDocument,tt==="http://www.w3.org/1999/xhtml"&&(tt=kb(rt)),tt==="http://www.w3.org/1999/xhtml"?rt==="script"?(tt=ot.createElement("div"),tt.innerHTML="<script><\/script>",tt=tt.removeChild(tt.firstChild)):typeof nt.is=="string"?tt=ot.createElement(rt,{is:nt.is}):(tt=ot.createElement(rt),rt==="select"&&(ot=tt,nt.multiple?ot.multiple=!0:nt.size&&(ot.size=nt.size))):tt=ot.createElementNS(tt,rt),tt[Of]=_e,tt[Pf]=nt,Aj(tt,_e,!1,!1),_e.stateNode=tt;e:{switch(ot=vb(rt,nt),rt){case"dialog":D$1("cancel",tt),D$1("close",tt),it=nt;break;case"iframe":case"object":case"embed":D$1("load",tt),it=nt;break;case"video":case"audio":for(it=0;it<lf.length;it++)D$1(lf[it],tt);it=nt;break;case"source":D$1("error",tt),it=nt;break;case"img":case"image":case"link":D$1("error",tt),D$1("load",tt),it=nt;break;case"details":D$1("toggle",tt),it=nt;break;case"input":Za(tt,nt),it=Ya(tt,nt),D$1("invalid",tt);break;case"option":it=nt;break;case"select":tt._wrapperState={wasMultiple:!!nt.multiple},it=A$2({},nt,{value:void 0}),D$1("invalid",tt);break;case"textarea":hb(tt,nt),it=gb(tt,nt),D$1("invalid",tt);break;default:it=nt}ub(rt,it),lt=it;for(st in lt)if(lt.hasOwnProperty(st)){var at=lt[st];st==="style"?sb(tt,at):st==="dangerouslySetInnerHTML"?(at=at?at.__html:void 0,at!=null&&nb(tt,at)):st==="children"?typeof at=="string"?(rt!=="textarea"||at!=="")&&ob(tt,at):typeof at=="number"&&ob(tt,""+at):st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&st!=="autoFocus"&&(ea.hasOwnProperty(st)?at!=null&&st==="onScroll"&&D$1("scroll",tt):at!=null&&ta(tt,st,at,ot))}switch(rt){case"input":Va(tt),db(tt,nt,!1);break;case"textarea":Va(tt),jb(tt);break;case"option":nt.value!=null&&tt.setAttribute("value",""+Sa(nt.value));break;case"select":tt.multiple=!!nt.multiple,st=nt.value,st!=null?fb(tt,!!nt.multiple,st,!1):nt.defaultValue!=null&&fb(tt,!!nt.multiple,nt.defaultValue,!0);break;default:typeof it.onClick=="function"&&(tt.onclick=Bf)}switch(rt){case"button":case"input":case"select":case"textarea":nt=!!nt.autoFocus;break e;case"img":nt=!0;break e;default:nt=!1}}nt&&(_e.flags|=4)}_e.ref!==null&&(_e.flags|=512,_e.flags|=2097152)}return S$3(_e),null;case 6:if(tt&&_e.stateNode!=null)Dj(tt,_e,tt.memoizedProps,nt);else{if(typeof nt!="string"&&_e.stateNode===null)throw Error(p$4(166));if(rt=Hh(Gh.current),Hh(Eh.current),Gg(_e)){if(nt=_e.stateNode,rt=_e.memoizedProps,nt[Of]=_e,(st=nt.nodeValue!==rt)&&(tt=xg,tt!==null))switch(tt.tag){case 3:Af(nt.nodeValue,rt,(tt.mode&1)!==0);break;case 5:tt.memoizedProps.suppressHydrationWarning!==!0&&Af(nt.nodeValue,rt,(tt.mode&1)!==0)}st&&(_e.flags|=4)}else nt=(rt.nodeType===9?rt:rt.ownerDocument).createTextNode(nt),nt[Of]=_e,_e.stateNode=nt}return S$3(_e),null;case 13:if(E$2(M$2),nt=_e.memoizedState,tt===null||tt.memoizedState!==null&&tt.memoizedState.dehydrated!==null){if(I$4&&yg!==null&&_e.mode&1&&!(_e.flags&128))Hg(),Ig(),_e.flags|=98560,st=!1;else if(st=Gg(_e),nt!==null&&nt.dehydrated!==null){if(tt===null){if(!st)throw Error(p$4(318));if(st=_e.memoizedState,st=st!==null?st.dehydrated:null,!st)throw Error(p$4(317));st[Of]=_e}else Ig(),!(_e.flags&128)&&(_e.memoizedState=null),_e.flags|=4;S$3(_e),st=!1}else zg!==null&&(Gj(zg),zg=null),st=!0;if(!st)return _e.flags&65536?_e:null}return _e.flags&128?(_e.lanes=rt,_e):(nt=nt!==null,nt!==(tt!==null&&tt.memoizedState!==null)&&nt&&(_e.child.flags|=8192,_e.mode&1&&(tt===null||M$2.current&1?T$2===0&&(T$2=3):uj())),_e.updateQueue!==null&&(_e.flags|=4),S$3(_e),null);case 4:return Jh(),Bj(tt,_e),tt===null&&sf(_e.stateNode.containerInfo),S$3(_e),null;case 10:return Rg(_e.type._context),S$3(_e),null;case 17:return Zf(_e.type)&&$f(),S$3(_e),null;case 19:if(E$2(M$2),st=_e.memoizedState,st===null)return S$3(_e),null;if(nt=(_e.flags&128)!==0,ot=st.rendering,ot===null)if(nt)Ej(st,!1);else{if(T$2!==0||tt!==null&&tt.flags&128)for(tt=_e.child;tt!==null;){if(ot=Mh(tt),ot!==null){for(_e.flags|=128,Ej(st,!1),nt=ot.updateQueue,nt!==null&&(_e.updateQueue=nt,_e.flags|=4),_e.subtreeFlags=0,nt=rt,rt=_e.child;rt!==null;)st=rt,tt=nt,st.flags&=14680066,ot=st.alternate,ot===null?(st.childLanes=0,st.lanes=tt,st.child=null,st.subtreeFlags=0,st.memoizedProps=null,st.memoizedState=null,st.updateQueue=null,st.dependencies=null,st.stateNode=null):(st.childLanes=ot.childLanes,st.lanes=ot.lanes,st.child=ot.child,st.subtreeFlags=0,st.deletions=null,st.memoizedProps=ot.memoizedProps,st.memoizedState=ot.memoizedState,st.updateQueue=ot.updateQueue,st.type=ot.type,tt=ot.dependencies,st.dependencies=tt===null?null:{lanes:tt.lanes,firstContext:tt.firstContext}),rt=rt.sibling;return G$1(M$2,M$2.current&1|2),_e.child}tt=tt.sibling}st.tail!==null&&B$2()>Hj&&(_e.flags|=128,nt=!0,Ej(st,!1),_e.lanes=4194304)}else{if(!nt)if(tt=Mh(ot),tt!==null){if(_e.flags|=128,nt=!0,rt=tt.updateQueue,rt!==null&&(_e.updateQueue=rt,_e.flags|=4),Ej(st,!0),st.tail===null&&st.tailMode==="hidden"&&!ot.alternate&&!I$4)return S$3(_e),null}else 2*B$2()-st.renderingStartTime>Hj&&rt!==1073741824&&(_e.flags|=128,nt=!0,Ej(st,!1),_e.lanes=4194304);st.isBackwards?(ot.sibling=_e.child,_e.child=ot):(rt=st.last,rt!==null?rt.sibling=ot:_e.child=ot,st.last=ot)}return st.tail!==null?(_e=st.tail,st.rendering=_e,st.tail=_e.sibling,st.renderingStartTime=B$2(),_e.sibling=null,rt=M$2.current,G$1(M$2,nt?rt&1|2:rt&1),_e):(S$3(_e),null);case 22:case 23:return Ij(),nt=_e.memoizedState!==null,tt!==null&&tt.memoizedState!==null!==nt&&(_e.flags|=8192),nt&&_e.mode&1?gj&1073741824&&(S$3(_e),_e.subtreeFlags&6&&(_e.flags|=8192)):S$3(_e),null;case 24:return null;case 25:return null}throw Error(p$4(156,_e.tag))}function Jj(tt,_e){switch(wg(_e),_e.tag){case 1:return Zf(_e.type)&&$f(),tt=_e.flags,tt&65536?(_e.flags=tt&-65537|128,_e):null;case 3:return Jh(),E$2(Wf),E$2(H$2),Oh(),tt=_e.flags,tt&65536&&!(tt&128)?(_e.flags=tt&-65537|128,_e):null;case 5:return Lh(_e),null;case 13:if(E$2(M$2),tt=_e.memoizedState,tt!==null&&tt.dehydrated!==null){if(_e.alternate===null)throw Error(p$4(340));Ig()}return tt=_e.flags,tt&65536?(_e.flags=tt&-65537|128,_e):null;case 19:return E$2(M$2),null;case 4:return Jh(),null;case 10:return Rg(_e.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U$2=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$3=null;function Mj(tt,_e){var rt=tt.ref;if(rt!==null)if(typeof rt=="function")try{rt(null)}catch(nt){W$1(tt,_e,nt)}else rt.current=null}function Nj(tt,_e,rt){try{rt()}catch(nt){W$1(tt,_e,nt)}}var Oj=!1;function Pj(tt,_e){if(Cf=dd,tt=Me$1(),Ne$1(tt)){if("selectionStart"in tt)var rt={start:tt.selectionStart,end:tt.selectionEnd};else e:{rt=(rt=tt.ownerDocument)&&rt.defaultView||window;var nt=rt.getSelection&&rt.getSelection();if(nt&&nt.rangeCount!==0){rt=nt.anchorNode;var it=nt.anchorOffset,st=nt.focusNode;nt=nt.focusOffset;try{rt.nodeType,st.nodeType}catch{rt=null;break e}var ot=0,lt=-1,at=-1,ct=0,ut=0,ht=tt,dt=null;t:for(;;){for(var ft;ht!==rt||it!==0&&ht.nodeType!==3||(lt=ot+it),ht!==st||nt!==0&&ht.nodeType!==3||(at=ot+nt),ht.nodeType===3&&(ot+=ht.nodeValue.length),(ft=ht.firstChild)!==null;)dt=ht,ht=ft;for(;;){if(ht===tt)break t;if(dt===rt&&++ct===it&&(lt=ot),dt===st&&++ut===nt&&(at=ot),(ft=ht.nextSibling)!==null)break;ht=dt,dt=ht.parentNode}ht=ft}rt=lt===-1||at===-1?null:{start:lt,end:at}}else rt=null}rt=rt||{start:0,end:0}}else rt=null;for(Df={focusedElem:tt,selectionRange:rt},dd=!1,V$3=_e;V$3!==null;)if(_e=V$3,tt=_e.child,(_e.subtreeFlags&1028)!==0&&tt!==null)tt.return=_e,V$3=tt;else for(;V$3!==null;){_e=V$3;try{var pt=_e.alternate;if(_e.flags&1024)switch(_e.tag){case 0:case 11:case 15:break;case 1:if(pt!==null){var mt=pt.memoizedProps,gt=pt.memoizedState,vt=_e.stateNode,At=vt.getSnapshotBeforeUpdate(_e.elementType===_e.type?mt:Lg(_e.type,mt),gt);vt.__reactInternalSnapshotBeforeUpdate=At}break;case 3:var yt=_e.stateNode.containerInfo;yt.nodeType===1?yt.textContent="":yt.nodeType===9&&yt.documentElement&&yt.removeChild(yt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$4(163))}}catch(xt){W$1(_e,_e.return,xt)}if(tt=_e.sibling,tt!==null){tt.return=_e.return,V$3=tt;break}V$3=_e.return}return pt=Oj,Oj=!1,pt}function Qj(tt,_e,rt){var nt=_e.updateQueue;if(nt=nt!==null?nt.lastEffect:null,nt!==null){var it=nt=nt.next;do{if((it.tag&tt)===tt){var st=it.destroy;it.destroy=void 0,st!==void 0&&Nj(_e,rt,st)}it=it.next}while(it!==nt)}}function Rj(tt,_e){if(_e=_e.updateQueue,_e=_e!==null?_e.lastEffect:null,_e!==null){var rt=_e=_e.next;do{if((rt.tag&tt)===tt){var nt=rt.create;rt.destroy=nt()}rt=rt.next}while(rt!==_e)}}function Sj(tt){var _e=tt.ref;if(_e!==null){var rt=tt.stateNode;switch(tt.tag){case 5:tt=rt;break;default:tt=rt}typeof _e=="function"?_e(tt):_e.current=tt}}function Tj(tt){var _e=tt.alternate;_e!==null&&(tt.alternate=null,Tj(_e)),tt.child=null,tt.deletions=null,tt.sibling=null,tt.tag===5&&(_e=tt.stateNode,_e!==null&&(delete _e[Of],delete _e[Pf],delete _e[of],delete _e[Qf],delete _e[Rf])),tt.stateNode=null,tt.return=null,tt.dependencies=null,tt.memoizedProps=null,tt.memoizedState=null,tt.pendingProps=null,tt.stateNode=null,tt.updateQueue=null}function Uj(tt){return tt.tag===5||tt.tag===3||tt.tag===4}function Vj(tt){e:for(;;){for(;tt.sibling===null;){if(tt.return===null||Uj(tt.return))return null;tt=tt.return}for(tt.sibling.return=tt.return,tt=tt.sibling;tt.tag!==5&&tt.tag!==6&&tt.tag!==18;){if(tt.flags&2||tt.child===null||tt.tag===4)continue e;tt.child.return=tt,tt=tt.child}if(!(tt.flags&2))return tt.stateNode}}function Wj(tt,_e,rt){var nt=tt.tag;if(nt===5||nt===6)tt=tt.stateNode,_e?rt.nodeType===8?rt.parentNode.insertBefore(tt,_e):rt.insertBefore(tt,_e):(rt.nodeType===8?(_e=rt.parentNode,_e.insertBefore(tt,rt)):(_e=rt,_e.appendChild(tt)),rt=rt._reactRootContainer,rt!=null||_e.onclick!==null||(_e.onclick=Bf));else if(nt!==4&&(tt=tt.child,tt!==null))for(Wj(tt,_e,rt),tt=tt.sibling;tt!==null;)Wj(tt,_e,rt),tt=tt.sibling}function Xj(tt,_e,rt){var nt=tt.tag;if(nt===5||nt===6)tt=tt.stateNode,_e?rt.insertBefore(tt,_e):rt.appendChild(tt);else if(nt!==4&&(tt=tt.child,tt!==null))for(Xj(tt,_e,rt),tt=tt.sibling;tt!==null;)Xj(tt,_e,rt),tt=tt.sibling}var X=null,Yj=!1;function Zj(tt,_e,rt){for(rt=rt.child;rt!==null;)ak(tt,_e,rt),rt=rt.sibling}function ak(tt,_e,rt){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,rt)}catch{}switch(rt.tag){case 5:U$2||Mj(rt,_e);case 6:var nt=X,it=Yj;X=null,Zj(tt,_e,rt),X=nt,Yj=it,X!==null&&(Yj?(tt=X,rt=rt.stateNode,tt.nodeType===8?tt.parentNode.removeChild(rt):tt.removeChild(rt)):X.removeChild(rt.stateNode));break;case 18:X!==null&&(Yj?(tt=X,rt=rt.stateNode,tt.nodeType===8?Kf(tt.parentNode,rt):tt.nodeType===1&&Kf(tt,rt),bd(tt)):Kf(X,rt.stateNode));break;case 4:nt=X,it=Yj,X=rt.stateNode.containerInfo,Yj=!0,Zj(tt,_e,rt),X=nt,Yj=it;break;case 0:case 11:case 14:case 15:if(!U$2&&(nt=rt.updateQueue,nt!==null&&(nt=nt.lastEffect,nt!==null))){it=nt=nt.next;do{var st=it,ot=st.destroy;st=st.tag,ot!==void 0&&(st&2||st&4)&&Nj(rt,_e,ot),it=it.next}while(it!==nt)}Zj(tt,_e,rt);break;case 1:if(!U$2&&(Mj(rt,_e),nt=rt.stateNode,typeof nt.componentWillUnmount=="function"))try{nt.props=rt.memoizedProps,nt.state=rt.memoizedState,nt.componentWillUnmount()}catch(lt){W$1(rt,_e,lt)}Zj(tt,_e,rt);break;case 21:Zj(tt,_e,rt);break;case 22:rt.mode&1?(U$2=(nt=U$2)||rt.memoizedState!==null,Zj(tt,_e,rt),U$2=nt):Zj(tt,_e,rt);break;default:Zj(tt,_e,rt)}}function bk(tt){var _e=tt.updateQueue;if(_e!==null){tt.updateQueue=null;var rt=tt.stateNode;rt===null&&(rt=tt.stateNode=new Lj),_e.forEach(function(nt){var it=ck.bind(null,tt,nt);rt.has(nt)||(rt.add(nt),nt.then(it,it))})}}function dk(tt,_e){var rt=_e.deletions;if(rt!==null)for(var nt=0;nt<rt.length;nt++){var it=rt[nt];try{var st=tt,ot=_e,lt=ot;e:for(;lt!==null;){switch(lt.tag){case 5:X=lt.stateNode,Yj=!1;break e;case 3:X=lt.stateNode.containerInfo,Yj=!0;break e;case 4:X=lt.stateNode.containerInfo,Yj=!0;break e}lt=lt.return}if(X===null)throw Error(p$4(160));ak(st,ot,it),X=null,Yj=!1;var at=it.alternate;at!==null&&(at.return=null),it.return=null}catch(ct){W$1(it,_e,ct)}}if(_e.subtreeFlags&12854)for(_e=_e.child;_e!==null;)ek(_e,tt),_e=_e.sibling}function ek(tt,_e){var rt=tt.alternate,nt=tt.flags;switch(tt.tag){case 0:case 11:case 14:case 15:if(dk(_e,tt),fk(tt),nt&4){try{Qj(3,tt,tt.return),Rj(3,tt)}catch(mt){W$1(tt,tt.return,mt)}try{Qj(5,tt,tt.return)}catch(mt){W$1(tt,tt.return,mt)}}break;case 1:dk(_e,tt),fk(tt),nt&512&&rt!==null&&Mj(rt,rt.return);break;case 5:if(dk(_e,tt),fk(tt),nt&512&&rt!==null&&Mj(rt,rt.return),tt.flags&32){var it=tt.stateNode;try{ob(it,"")}catch(mt){W$1(tt,tt.return,mt)}}if(nt&4&&(it=tt.stateNode,it!=null)){var st=tt.memoizedProps,ot=rt!==null?rt.memoizedProps:st,lt=tt.type,at=tt.updateQueue;if(tt.updateQueue=null,at!==null)try{lt==="input"&&st.type==="radio"&&st.name!=null&&ab(it,st),vb(lt,ot);var ct=vb(lt,st);for(ot=0;ot<at.length;ot+=2){var ut=at[ot],ht=at[ot+1];ut==="style"?sb(it,ht):ut==="dangerouslySetInnerHTML"?nb(it,ht):ut==="children"?ob(it,ht):ta(it,ut,ht,ct)}switch(lt){case"input":bb(it,st);break;case"textarea":ib(it,st);break;case"select":var dt=it._wrapperState.wasMultiple;it._wrapperState.wasMultiple=!!st.multiple;var ft=st.value;ft!=null?fb(it,!!st.multiple,ft,!1):dt!==!!st.multiple&&(st.defaultValue!=null?fb(it,!!st.multiple,st.defaultValue,!0):fb(it,!!st.multiple,st.multiple?[]:"",!1))}it[Pf]=st}catch(mt){W$1(tt,tt.return,mt)}}break;case 6:if(dk(_e,tt),fk(tt),nt&4){if(tt.stateNode===null)throw Error(p$4(162));it=tt.stateNode,st=tt.memoizedProps;try{it.nodeValue=st}catch(mt){W$1(tt,tt.return,mt)}}break;case 3:if(dk(_e,tt),fk(tt),nt&4&&rt!==null&&rt.memoizedState.isDehydrated)try{bd(_e.containerInfo)}catch(mt){W$1(tt,tt.return,mt)}break;case 4:dk(_e,tt),fk(tt);break;case 13:dk(_e,tt),fk(tt),it=tt.child,it.flags&8192&&(st=it.memoizedState!==null,it.stateNode.isHidden=st,!st||it.alternate!==null&&it.alternate.memoizedState!==null||(gk=B$2())),nt&4&&bk(tt);break;case 22:if(ut=rt!==null&&rt.memoizedState!==null,tt.mode&1?(U$2=(ct=U$2)||ut,dk(_e,tt),U$2=ct):dk(_e,tt),fk(tt),nt&8192){if(ct=tt.memoizedState!==null,(tt.stateNode.isHidden=ct)&&!ut&&tt.mode&1)for(V$3=tt,ut=tt.child;ut!==null;){for(ht=V$3=ut;V$3!==null;){switch(dt=V$3,ft=dt.child,dt.tag){case 0:case 11:case 14:case 15:Qj(4,dt,dt.return);break;case 1:Mj(dt,dt.return);var pt=dt.stateNode;if(typeof pt.componentWillUnmount=="function"){nt=dt,rt=dt.return;try{_e=nt,pt.props=_e.memoizedProps,pt.state=_e.memoizedState,pt.componentWillUnmount()}catch(mt){W$1(nt,rt,mt)}}break;case 5:Mj(dt,dt.return);break;case 22:if(dt.memoizedState!==null){hk(ht);continue}}ft!==null?(ft.return=dt,V$3=ft):hk(ht)}ut=ut.sibling}e:for(ut=null,ht=tt;;){if(ht.tag===5){if(ut===null){ut=ht;try{it=ht.stateNode,ct?(st=it.style,typeof st.setProperty=="function"?st.setProperty("display","none","important"):st.display="none"):(lt=ht.stateNode,at=ht.memoizedProps.style,ot=at!=null&&at.hasOwnProperty("display")?at.display:null,lt.style.display=rb("display",ot))}catch(mt){W$1(tt,tt.return,mt)}}}else if(ht.tag===6){if(ut===null)try{ht.stateNode.nodeValue=ct?"":ht.memoizedProps}catch(mt){W$1(tt,tt.return,mt)}}else if((ht.tag!==22&&ht.tag!==23||ht.memoizedState===null||ht===tt)&&ht.child!==null){ht.child.return=ht,ht=ht.child;continue}if(ht===tt)break e;for(;ht.sibling===null;){if(ht.return===null||ht.return===tt)break e;ut===ht&&(ut=null),ht=ht.return}ut===ht&&(ut=null),ht.sibling.return=ht.return,ht=ht.sibling}}break;case 19:dk(_e,tt),fk(tt),nt&4&&bk(tt);break;case 21:break;default:dk(_e,tt),fk(tt)}}function fk(tt){var _e=tt.flags;if(_e&2){try{e:{for(var rt=tt.return;rt!==null;){if(Uj(rt)){var nt=rt;break e}rt=rt.return}throw Error(p$4(160))}switch(nt.tag){case 5:var it=nt.stateNode;nt.flags&32&&(ob(it,""),nt.flags&=-33);var st=Vj(tt);Xj(tt,st,it);break;case 3:case 4:var ot=nt.stateNode.containerInfo,lt=Vj(tt);Wj(tt,lt,ot);break;default:throw Error(p$4(161))}}catch(at){W$1(tt,tt.return,at)}tt.flags&=-3}_e&4096&&(tt.flags&=-4097)}function ik(tt,_e,rt){V$3=tt,jk(tt)}function jk(tt,_e,rt){for(var nt=(tt.mode&1)!==0;V$3!==null;){var it=V$3,st=it.child;if(it.tag===22&&nt){var ot=it.memoizedState!==null||Kj;if(!ot){var lt=it.alternate,at=lt!==null&&lt.memoizedState!==null||U$2;lt=Kj;var ct=U$2;if(Kj=ot,(U$2=at)&&!ct)for(V$3=it;V$3!==null;)ot=V$3,at=ot.child,ot.tag===22&&ot.memoizedState!==null?kk(it):at!==null?(at.return=ot,V$3=at):kk(it);for(;st!==null;)V$3=st,jk(st),st=st.sibling;V$3=it,Kj=lt,U$2=ct}lk(tt)}else it.subtreeFlags&8772&&st!==null?(st.return=it,V$3=st):lk(tt)}}function lk(tt){for(;V$3!==null;){var _e=V$3;if(_e.flags&8772){var rt=_e.alternate;try{if(_e.flags&8772)switch(_e.tag){case 0:case 11:case 15:U$2||Rj(5,_e);break;case 1:var nt=_e.stateNode;if(_e.flags&4&&!U$2)if(rt===null)nt.componentDidMount();else{var it=_e.elementType===_e.type?rt.memoizedProps:Lg(_e.type,rt.memoizedProps);nt.componentDidUpdate(it,rt.memoizedState,nt.__reactInternalSnapshotBeforeUpdate)}var st=_e.updateQueue;st!==null&&ih(_e,st,nt);break;case 3:var ot=_e.updateQueue;if(ot!==null){if(rt=null,_e.child!==null)switch(_e.child.tag){case 5:rt=_e.child.stateNode;break;case 1:rt=_e.child.stateNode}ih(_e,ot,rt)}break;case 5:var lt=_e.stateNode;if(rt===null&&_e.flags&4){rt=lt;var at=_e.memoizedProps;switch(_e.type){case"button":case"input":case"select":case"textarea":at.autoFocus&&rt.focus();break;case"img":at.src&&(rt.src=at.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(_e.memoizedState===null){var ct=_e.alternate;if(ct!==null){var ut=ct.memoizedState;if(ut!==null){var ht=ut.dehydrated;ht!==null&&bd(ht)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$4(163))}U$2||_e.flags&512&&Sj(_e)}catch(dt){W$1(_e,_e.return,dt)}}if(_e===tt){V$3=null;break}if(rt=_e.sibling,rt!==null){rt.return=_e.return,V$3=rt;break}V$3=_e.return}}function hk(tt){for(;V$3!==null;){var _e=V$3;if(_e===tt){V$3=null;break}var rt=_e.sibling;if(rt!==null){rt.return=_e.return,V$3=rt;break}V$3=_e.return}}function kk(tt){for(;V$3!==null;){var _e=V$3;try{switch(_e.tag){case 0:case 11:case 15:var rt=_e.return;try{Rj(4,_e)}catch(at){W$1(_e,rt,at)}break;case 1:var nt=_e.stateNode;if(typeof nt.componentDidMount=="function"){var it=_e.return;try{nt.componentDidMount()}catch(at){W$1(_e,it,at)}}var st=_e.return;try{Sj(_e)}catch(at){W$1(_e,st,at)}break;case 5:var ot=_e.return;try{Sj(_e)}catch(at){W$1(_e,ot,at)}}}catch(at){W$1(_e,_e.return,at)}if(_e===tt){V$3=null;break}var lt=_e.sibling;if(lt!==null){lt.return=_e.return,V$3=lt;break}V$3=_e.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R$1=null,Y$2=null,Z=0,gj=0,fj=Uf(0),T$2=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L$2(){return K&6?B$2():Bk!==-1?Bk:Bk=B$2()}function lh(tt){return tt.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(tt=C$2,tt!==0||(tt=window.event,tt=tt===void 0?16:jd(tt.type)),tt):1}function mh(tt,_e,rt,nt){if(50<zk)throw zk=0,Ak=null,Error(p$4(185));Ac(tt,rt,nt),(!(K&2)||tt!==R$1)&&(tt===R$1&&(!(K&2)&&(rk|=rt),T$2===4&&Dk(tt,Z)),Ek(tt,nt),rt===1&&K===0&&!(_e.mode&1)&&(Hj=B$2()+500,fg&&jg()))}function Ek(tt,_e){var rt=tt.callbackNode;wc(tt,_e);var nt=uc(tt,tt===R$1?Z:0);if(nt===0)rt!==null&&bc(rt),tt.callbackNode=null,tt.callbackPriority=0;else if(_e=nt&-nt,tt.callbackPriority!==_e){if(rt!=null&&bc(rt),_e===1)tt.tag===0?ig(Fk.bind(null,tt)):hg(Fk.bind(null,tt)),Jf(function(){!(K&6)&&jg()}),rt=null;else{switch(Dc(nt)){case 1:rt=fc;break;case 4:rt=gc;break;case 16:rt=hc;break;case 536870912:rt=jc;break;default:rt=hc}rt=Gk(rt,Hk.bind(null,tt))}tt.callbackPriority=_e,tt.callbackNode=rt}}function Hk(tt,_e){if(Bk=-1,Ck=0,K&6)throw Error(p$4(327));var rt=tt.callbackNode;if(Ik()&&tt.callbackNode!==rt)return null;var nt=uc(tt,tt===R$1?Z:0);if(nt===0)return null;if(nt&30||nt&tt.expiredLanes||_e)_e=Jk(tt,nt);else{_e=nt;var it=K;K|=2;var st=Kk();(R$1!==tt||Z!==_e)&&(vk=null,Hj=B$2()+500,Lk(tt,_e));do try{Mk();break}catch(lt){Nk(tt,lt)}while(1);Qg(),nk.current=st,K=it,Y$2!==null?_e=0:(R$1=null,Z=0,_e=T$2)}if(_e!==0){if(_e===2&&(it=xc(tt),it!==0&&(nt=it,_e=Ok(tt,it))),_e===1)throw rt=qk,Lk(tt,0),Dk(tt,nt),Ek(tt,B$2()),rt;if(_e===6)Dk(tt,nt);else{if(it=tt.current.alternate,!(nt&30)&&!Pk(it)&&(_e=Jk(tt,nt),_e===2&&(st=xc(tt),st!==0&&(nt=st,_e=Ok(tt,st))),_e===1))throw rt=qk,Lk(tt,0),Dk(tt,nt),Ek(tt,B$2()),rt;switch(tt.finishedWork=it,tt.finishedLanes=nt,_e){case 0:case 1:throw Error(p$4(345));case 2:Qk(tt,uk,vk);break;case 3:if(Dk(tt,nt),(nt&130023424)===nt&&(_e=gk+500-B$2(),10<_e)){if(uc(tt,0)!==0)break;if(it=tt.suspendedLanes,(it&nt)!==nt){L$2(),tt.pingedLanes|=tt.suspendedLanes&it;break}tt.timeoutHandle=Ff(Qk.bind(null,tt,uk,vk),_e);break}Qk(tt,uk,vk);break;case 4:if(Dk(tt,nt),(nt&4194240)===nt)break;for(_e=tt.eventTimes,it=-1;0<nt;){var ot=31-oc(nt);st=1<<ot,ot=_e[ot],ot>it&&(it=ot),nt&=~st}if(nt=it,nt=B$2()-nt,nt=(120>nt?120:480>nt?480:1080>nt?1080:1920>nt?1920:3e3>nt?3e3:4320>nt?4320:1960*mk(nt/1960))-nt,10<nt){tt.timeoutHandle=Ff(Qk.bind(null,tt,uk,vk),nt);break}Qk(tt,uk,vk);break;case 5:Qk(tt,uk,vk);break;default:throw Error(p$4(329))}}}return Ek(tt,B$2()),tt.callbackNode===rt?Hk.bind(null,tt):null}function Ok(tt,_e){var rt=tk;return tt.current.memoizedState.isDehydrated&&(Lk(tt,_e).flags|=256),tt=Jk(tt,_e),tt!==2&&(_e=uk,uk=rt,_e!==null&&Gj(_e)),tt}function Gj(tt){uk===null?uk=tt:uk.push.apply(uk,tt)}function Pk(tt){for(var _e=tt;;){if(_e.flags&16384){var rt=_e.updateQueue;if(rt!==null&&(rt=rt.stores,rt!==null))for(var nt=0;nt<rt.length;nt++){var it=rt[nt],st=it.getSnapshot;it=it.value;try{if(!He(st(),it))return!1}catch{return!1}}}if(rt=_e.child,_e.subtreeFlags&16384&&rt!==null)rt.return=_e,_e=rt;else{if(_e===tt)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===tt)return!0;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}}return!0}function Dk(tt,_e){for(_e&=~sk,_e&=~rk,tt.suspendedLanes|=_e,tt.pingedLanes&=~_e,tt=tt.expirationTimes;0<_e;){var rt=31-oc(_e),nt=1<<rt;tt[rt]=-1,_e&=~nt}}function Fk(tt){if(K&6)throw Error(p$4(327));Ik();var _e=uc(tt,0);if(!(_e&1))return Ek(tt,B$2()),null;var rt=Jk(tt,_e);if(tt.tag!==0&&rt===2){var nt=xc(tt);nt!==0&&(_e=nt,rt=Ok(tt,nt))}if(rt===1)throw rt=qk,Lk(tt,0),Dk(tt,_e),Ek(tt,B$2()),rt;if(rt===6)throw Error(p$4(345));return tt.finishedWork=tt.current.alternate,tt.finishedLanes=_e,Qk(tt,uk,vk),Ek(tt,B$2()),null}function Rk(tt,_e){var rt=K;K|=1;try{return tt(_e)}finally{K=rt,K===0&&(Hj=B$2()+500,fg&&jg())}}function Sk(tt){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var _e=K;K|=1;var rt=pk.transition,nt=C$2;try{if(pk.transition=null,C$2=1,tt)return tt()}finally{C$2=nt,pk.transition=rt,K=_e,!(K&6)&&jg()}}function Ij(){gj=fj.current,E$2(fj)}function Lk(tt,_e){tt.finishedWork=null,tt.finishedLanes=0;var rt=tt.timeoutHandle;if(rt!==-1&&(tt.timeoutHandle=-1,Gf(rt)),Y$2!==null)for(rt=Y$2.return;rt!==null;){var nt=rt;switch(wg(nt),nt.tag){case 1:nt=nt.type.childContextTypes,nt!=null&&$f();break;case 3:Jh(),E$2(Wf),E$2(H$2),Oh();break;case 5:Lh(nt);break;case 4:Jh();break;case 13:E$2(M$2);break;case 19:E$2(M$2);break;case 10:Rg(nt.type._context);break;case 22:case 23:Ij()}rt=rt.return}if(R$1=tt,Y$2=tt=wh(tt.current,null),Z=gj=_e,T$2=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(_e=0;_e<Wg.length;_e++)if(rt=Wg[_e],nt=rt.interleaved,nt!==null){rt.interleaved=null;var it=nt.next,st=rt.pending;if(st!==null){var ot=st.next;st.next=it,nt.next=ot}rt.pending=nt}Wg=null}return tt}function Nk(tt,_e){do{var rt=Y$2;try{if(Qg(),Ph.current=ai,Sh){for(var nt=N$2.memoizedState;nt!==null;){var it=nt.queue;it!==null&&(it.pending=null),nt=nt.next}Sh=!1}if(Rh=0,P$1=O$1=N$2=null,Th=!1,Uh=0,ok.current=null,rt===null||rt.return===null){T$2=1,qk=_e,Y$2=null;break}e:{var st=tt,ot=rt.return,lt=rt,at=_e;if(_e=Z,lt.flags|=32768,at!==null&&typeof at=="object"&&typeof at.then=="function"){var ct=at,ut=lt,ht=ut.tag;if(!(ut.mode&1)&&(ht===0||ht===11||ht===15)){var dt=ut.alternate;dt?(ut.updateQueue=dt.updateQueue,ut.memoizedState=dt.memoizedState,ut.lanes=dt.lanes):(ut.updateQueue=null,ut.memoizedState=null)}var ft=Vi(ot);if(ft!==null){ft.flags&=-257,Wi(ft,ot,lt,st,_e),ft.mode&1&&Ti(st,ct,_e),_e=ft,at=ct;var pt=_e.updateQueue;if(pt===null){var mt=new Set;mt.add(at),_e.updateQueue=mt}else pt.add(at);break e}else{if(!(_e&1)){Ti(st,ct,_e),uj();break e}at=Error(p$4(426))}}else if(I$4&&lt.mode&1){var gt=Vi(ot);if(gt!==null){!(gt.flags&65536)&&(gt.flags|=256),Wi(gt,ot,lt,st,_e),Jg(Ki(at,lt));break e}}st=at=Ki(at,lt),T$2!==4&&(T$2=2),tk===null?tk=[st]:tk.push(st),st=ot;do{switch(st.tag){case 3:st.flags|=65536,_e&=-_e,st.lanes|=_e;var vt=Oi(st,at,_e);fh(st,vt);break e;case 1:lt=at;var At=st.type,yt=st.stateNode;if(!(st.flags&128)&&(typeof At.getDerivedStateFromError=="function"||yt!==null&&typeof yt.componentDidCatch=="function"&&(Si===null||!Si.has(yt)))){st.flags|=65536,_e&=-_e,st.lanes|=_e;var xt=Ri(st,lt,_e);fh(st,xt);break e}}st=st.return}while(st!==null)}Tk(rt)}catch(_t){_e=_t,Y$2===rt&&rt!==null&&(Y$2=rt=rt.return);continue}break}while(1)}function Kk(){var tt=nk.current;return nk.current=ai,tt===null?ai:tt}function uj(){(T$2===0||T$2===3||T$2===2)&&(T$2=4),R$1===null||!(hh&268435455)&&!(rk&268435455)||Dk(R$1,Z)}function Jk(tt,_e){var rt=K;K|=2;var nt=Kk();(R$1!==tt||Z!==_e)&&(vk=null,Lk(tt,_e));do try{Uk();break}catch(it){Nk(tt,it)}while(1);if(Qg(),K=rt,nk.current=nt,Y$2!==null)throw Error(p$4(261));return R$1=null,Z=0,T$2}function Uk(){for(;Y$2!==null;)Vk(Y$2)}function Mk(){for(;Y$2!==null&&!cc$1();)Vk(Y$2)}function Vk(tt){var _e=Wk(tt.alternate,tt,gj);tt.memoizedProps=tt.pendingProps,_e===null?Tk(tt):Y$2=_e,ok.current=null}function Tk(tt){var _e=tt;do{var rt=_e.alternate;if(tt=_e.return,_e.flags&32768){if(rt=Jj(rt,_e),rt!==null){rt.flags&=32767,Y$2=rt;return}if(tt!==null)tt.flags|=32768,tt.subtreeFlags=0,tt.deletions=null;else{T$2=6,Y$2=null;return}}else if(rt=Fj(rt,_e,gj),rt!==null){Y$2=rt;return}if(_e=_e.sibling,_e!==null){Y$2=_e;return}Y$2=_e=tt}while(_e!==null);T$2===0&&(T$2=5)}function Qk(tt,_e,rt){var nt=C$2,it=pk.transition;try{pk.transition=null,C$2=1,Xk(tt,_e,rt,nt)}finally{pk.transition=it,C$2=nt}return null}function Xk(tt,_e,rt,nt){do Ik();while(xk!==null);if(K&6)throw Error(p$4(327));rt=tt.finishedWork;var it=tt.finishedLanes;if(rt===null)return null;if(tt.finishedWork=null,tt.finishedLanes=0,rt===tt.current)throw Error(p$4(177));tt.callbackNode=null,tt.callbackPriority=0;var st=rt.lanes|rt.childLanes;if(Bc(tt,st),tt===R$1&&(Y$2=R$1=null,Z=0),!(rt.subtreeFlags&2064)&&!(rt.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),st=(rt.flags&15990)!==0,rt.subtreeFlags&15990||st){st=pk.transition,pk.transition=null;var ot=C$2;C$2=1;var lt=K;K|=4,ok.current=null,Pj(tt,rt),ek(rt,tt),Oe(Df),dd=!!Cf,Df=Cf=null,tt.current=rt,ik(rt),dc(),K=lt,C$2=ot,pk.transition=st}else tt.current=rt;if(wk&&(wk=!1,xk=tt,yk=it),st=tt.pendingLanes,st===0&&(Si=null),mc(rt.stateNode),Ek(tt,B$2()),_e!==null)for(nt=tt.onRecoverableError,rt=0;rt<_e.length;rt++)it=_e[rt],nt(it.value,{componentStack:it.stack,digest:it.digest});if(Pi)throw Pi=!1,tt=Qi,Qi=null,tt;return yk&1&&tt.tag!==0&&Ik(),st=tt.pendingLanes,st&1?tt===Ak?zk++:(zk=0,Ak=tt):zk=0,jg(),null}function Ik(){if(xk!==null){var tt=Dc(yk),_e=pk.transition,rt=C$2;try{if(pk.transition=null,C$2=16>tt?16:tt,xk===null)var nt=!1;else{if(tt=xk,xk=null,yk=0,K&6)throw Error(p$4(331));var it=K;for(K|=4,V$3=tt.current;V$3!==null;){var st=V$3,ot=st.child;if(V$3.flags&16){var lt=st.deletions;if(lt!==null){for(var at=0;at<lt.length;at++){var ct=lt[at];for(V$3=ct;V$3!==null;){var ut=V$3;switch(ut.tag){case 0:case 11:case 15:Qj(8,ut,st)}var ht=ut.child;if(ht!==null)ht.return=ut,V$3=ht;else for(;V$3!==null;){ut=V$3;var dt=ut.sibling,ft=ut.return;if(Tj(ut),ut===ct){V$3=null;break}if(dt!==null){dt.return=ft,V$3=dt;break}V$3=ft}}}var pt=st.alternate;if(pt!==null){var mt=pt.child;if(mt!==null){pt.child=null;do{var gt=mt.sibling;mt.sibling=null,mt=gt}while(mt!==null)}}V$3=st}}if(st.subtreeFlags&2064&&ot!==null)ot.return=st,V$3=ot;else e:for(;V$3!==null;){if(st=V$3,st.flags&2048)switch(st.tag){case 0:case 11:case 15:Qj(9,st,st.return)}var vt=st.sibling;if(vt!==null){vt.return=st.return,V$3=vt;break e}V$3=st.return}}var At=tt.current;for(V$3=At;V$3!==null;){ot=V$3;var yt=ot.child;if(ot.subtreeFlags&2064&&yt!==null)yt.return=ot,V$3=yt;else e:for(ot=At;V$3!==null;){if(lt=V$3,lt.flags&2048)try{switch(lt.tag){case 0:case 11:case 15:Rj(9,lt)}}catch(_t){W$1(lt,lt.return,_t)}if(lt===ot){V$3=null;break e}var xt=lt.sibling;if(xt!==null){xt.return=lt.return,V$3=xt;break e}V$3=lt.return}}if(K=it,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,tt)}catch{}nt=!0}return nt}finally{C$2=rt,pk.transition=_e}}return!1}function Yk(tt,_e,rt){_e=Ki(rt,_e),_e=Oi(tt,_e,1),tt=dh(tt,_e,1),_e=L$2(),tt!==null&&(Ac(tt,1,_e),Ek(tt,_e))}function W$1(tt,_e,rt){if(tt.tag===3)Yk(tt,tt,rt);else for(;_e!==null;){if(_e.tag===3){Yk(_e,tt,rt);break}else if(_e.tag===1){var nt=_e.stateNode;if(typeof _e.type.getDerivedStateFromError=="function"||typeof nt.componentDidCatch=="function"&&(Si===null||!Si.has(nt))){tt=Ki(rt,tt),tt=Ri(_e,tt,1),_e=dh(_e,tt,1),tt=L$2(),_e!==null&&(Ac(_e,1,tt),Ek(_e,tt));break}}_e=_e.return}}function Ui(tt,_e,rt){var nt=tt.pingCache;nt!==null&&nt.delete(_e),_e=L$2(),tt.pingedLanes|=tt.suspendedLanes&rt,R$1===tt&&(Z&rt)===rt&&(T$2===4||T$2===3&&(Z&130023424)===Z&&500>B$2()-gk?Lk(tt,0):sk|=rt),Ek(tt,_e)}function Zk(tt,_e){_e===0&&(tt.mode&1?(_e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):_e=1);var rt=L$2();tt=Zg(tt,_e),tt!==null&&(Ac(tt,_e,rt),Ek(tt,rt))}function vj(tt){var _e=tt.memoizedState,rt=0;_e!==null&&(rt=_e.retryLane),Zk(tt,rt)}function ck(tt,_e){var rt=0;switch(tt.tag){case 13:var nt=tt.stateNode,it=tt.memoizedState;it!==null&&(rt=it.retryLane);break;case 19:nt=tt.stateNode;break;default:throw Error(p$4(314))}nt!==null&&nt.delete(_e),Zk(tt,rt)}var Wk;Wk=function(tt,_e,rt){if(tt!==null)if(tt.memoizedProps!==_e.pendingProps||Wf.current)Ug=!0;else{if(!(tt.lanes&rt)&&!(_e.flags&128))return Ug=!1,zj(tt,_e,rt);Ug=!!(tt.flags&131072)}else Ug=!1,I$4&&_e.flags&1048576&&ug(_e,ng,_e.index);switch(_e.lanes=0,_e.tag){case 2:var nt=_e.type;jj(tt,_e),tt=_e.pendingProps;var it=Yf(_e,H$2.current);Tg(_e,rt),it=Xh(null,_e,nt,tt,it,rt);var st=bi();return _e.flags|=1,typeof it=="object"&&it!==null&&typeof it.render=="function"&&it.$$typeof===void 0?(_e.tag=1,_e.memoizedState=null,_e.updateQueue=null,Zf(nt)?(st=!0,cg(_e)):st=!1,_e.memoizedState=it.state!==null&&it.state!==void 0?it.state:null,ah(_e),it.updater=nh,_e.stateNode=it,it._reactInternals=_e,rh(_e,nt,tt,rt),_e=kj(null,_e,nt,!0,st,rt)):(_e.tag=0,I$4&&st&&vg(_e),Yi(null,_e,it,rt),_e=_e.child),_e;case 16:nt=_e.elementType;e:{switch(jj(tt,_e),tt=_e.pendingProps,it=nt._init,nt=it(nt._payload),_e.type=nt,it=_e.tag=$k(nt),tt=Lg(nt,tt),it){case 0:_e=dj(null,_e,nt,tt,rt);break e;case 1:_e=ij(null,_e,nt,tt,rt);break e;case 11:_e=Zi(null,_e,nt,tt,rt);break e;case 14:_e=aj(null,_e,nt,Lg(nt.type,tt),rt);break e}throw Error(p$4(306,nt,""))}return _e;case 0:return nt=_e.type,it=_e.pendingProps,it=_e.elementType===nt?it:Lg(nt,it),dj(tt,_e,nt,it,rt);case 1:return nt=_e.type,it=_e.pendingProps,it=_e.elementType===nt?it:Lg(nt,it),ij(tt,_e,nt,it,rt);case 3:e:{if(lj(_e),tt===null)throw Error(p$4(387));nt=_e.pendingProps,st=_e.memoizedState,it=st.element,bh(tt,_e),gh(_e,nt,null,rt);var ot=_e.memoizedState;if(nt=ot.element,st.isDehydrated)if(st={element:nt,isDehydrated:!1,cache:ot.cache,pendingSuspenseBoundaries:ot.pendingSuspenseBoundaries,transitions:ot.transitions},_e.updateQueue.baseState=st,_e.memoizedState=st,_e.flags&256){it=Ki(Error(p$4(423)),_e),_e=mj(tt,_e,nt,rt,it);break e}else if(nt!==it){it=Ki(Error(p$4(424)),_e),_e=mj(tt,_e,nt,rt,it);break e}else for(yg=Lf(_e.stateNode.containerInfo.firstChild),xg=_e,I$4=!0,zg=null,rt=Ch(_e,null,nt,rt),_e.child=rt;rt;)rt.flags=rt.flags&-3|4096,rt=rt.sibling;else{if(Ig(),nt===it){_e=$i(tt,_e,rt);break e}Yi(tt,_e,nt,rt)}_e=_e.child}return _e;case 5:return Kh(_e),tt===null&&Eg(_e),nt=_e.type,it=_e.pendingProps,st=tt!==null?tt.memoizedProps:null,ot=it.children,Ef(nt,it)?ot=null:st!==null&&Ef(nt,st)&&(_e.flags|=32),hj(tt,_e),Yi(tt,_e,ot,rt),_e.child;case 6:return tt===null&&Eg(_e),null;case 13:return pj(tt,_e,rt);case 4:return Ih(_e,_e.stateNode.containerInfo),nt=_e.pendingProps,tt===null?_e.child=Bh(_e,null,nt,rt):Yi(tt,_e,nt,rt),_e.child;case 11:return nt=_e.type,it=_e.pendingProps,it=_e.elementType===nt?it:Lg(nt,it),Zi(tt,_e,nt,it,rt);case 7:return Yi(tt,_e,_e.pendingProps,rt),_e.child;case 8:return Yi(tt,_e,_e.pendingProps.children,rt),_e.child;case 12:return Yi(tt,_e,_e.pendingProps.children,rt),_e.child;case 10:e:{if(nt=_e.type._context,it=_e.pendingProps,st=_e.memoizedProps,ot=it.value,G$1(Mg,nt._currentValue),nt._currentValue=ot,st!==null)if(He(st.value,ot)){if(st.children===it.children&&!Wf.current){_e=$i(tt,_e,rt);break e}}else for(st=_e.child,st!==null&&(st.return=_e);st!==null;){var lt=st.dependencies;if(lt!==null){ot=st.child;for(var at=lt.firstContext;at!==null;){if(at.context===nt){if(st.tag===1){at=ch(-1,rt&-rt),at.tag=2;var ct=st.updateQueue;if(ct!==null){ct=ct.shared;var ut=ct.pending;ut===null?at.next=at:(at.next=ut.next,ut.next=at),ct.pending=at}}st.lanes|=rt,at=st.alternate,at!==null&&(at.lanes|=rt),Sg(st.return,rt,_e),lt.lanes|=rt;break}at=at.next}}else if(st.tag===10)ot=st.type===_e.type?null:st.child;else if(st.tag===18){if(ot=st.return,ot===null)throw Error(p$4(341));ot.lanes|=rt,lt=ot.alternate,lt!==null&&(lt.lanes|=rt),Sg(ot,rt,_e),ot=st.sibling}else ot=st.child;if(ot!==null)ot.return=st;else for(ot=st;ot!==null;){if(ot===_e){ot=null;break}if(st=ot.sibling,st!==null){st.return=ot.return,ot=st;break}ot=ot.return}st=ot}Yi(tt,_e,it.children,rt),_e=_e.child}return _e;case 9:return it=_e.type,nt=_e.pendingProps.children,Tg(_e,rt),it=Vg(it),nt=nt(it),_e.flags|=1,Yi(tt,_e,nt,rt),_e.child;case 14:return nt=_e.type,it=Lg(nt,_e.pendingProps),it=Lg(nt.type,it),aj(tt,_e,nt,it,rt);case 15:return cj(tt,_e,_e.type,_e.pendingProps,rt);case 17:return nt=_e.type,it=_e.pendingProps,it=_e.elementType===nt?it:Lg(nt,it),jj(tt,_e),_e.tag=1,Zf(nt)?(tt=!0,cg(_e)):tt=!1,Tg(_e,rt),ph(_e,nt,it),rh(_e,nt,it,rt),kj(null,_e,nt,!0,tt,rt);case 19:return yj(tt,_e,rt);case 22:return ej(tt,_e,rt)}throw Error(p$4(156,_e.tag))};function Gk(tt,_e){return ac(tt,_e)}function al(tt,_e,rt,nt){this.tag=tt,this.key=rt,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=nt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(tt,_e,rt,nt){return new al(tt,_e,rt,nt)}function bj(tt){return tt=tt.prototype,!(!tt||!tt.isReactComponent)}function $k(tt){if(typeof tt=="function")return bj(tt)?1:0;if(tt!=null){if(tt=tt.$$typeof,tt===Da)return 11;if(tt===Ga)return 14}return 2}function wh(tt,_e){var rt=tt.alternate;return rt===null?(rt=Bg(tt.tag,_e,tt.key,tt.mode),rt.elementType=tt.elementType,rt.type=tt.type,rt.stateNode=tt.stateNode,rt.alternate=tt,tt.alternate=rt):(rt.pendingProps=_e,rt.type=tt.type,rt.flags=0,rt.subtreeFlags=0,rt.deletions=null),rt.flags=tt.flags&14680064,rt.childLanes=tt.childLanes,rt.lanes=tt.lanes,rt.child=tt.child,rt.memoizedProps=tt.memoizedProps,rt.memoizedState=tt.memoizedState,rt.updateQueue=tt.updateQueue,_e=tt.dependencies,rt.dependencies=_e===null?null:{lanes:_e.lanes,firstContext:_e.firstContext},rt.sibling=tt.sibling,rt.index=tt.index,rt.ref=tt.ref,rt}function yh(tt,_e,rt,nt,it,st){var ot=2;if(nt=tt,typeof tt=="function")bj(tt)&&(ot=1);else if(typeof tt=="string")ot=5;else e:switch(tt){case ya:return Ah(rt.children,it,st,_e);case za:ot=8,it|=8;break;case Aa:return tt=Bg(12,rt,_e,it|2),tt.elementType=Aa,tt.lanes=st,tt;case Ea:return tt=Bg(13,rt,_e,it),tt.elementType=Ea,tt.lanes=st,tt;case Fa:return tt=Bg(19,rt,_e,it),tt.elementType=Fa,tt.lanes=st,tt;case Ia:return qj(rt,it,st,_e);default:if(typeof tt=="object"&&tt!==null)switch(tt.$$typeof){case Ba:ot=10;break e;case Ca:ot=9;break e;case Da:ot=11;break e;case Ga:ot=14;break e;case Ha:ot=16,nt=null;break e}throw Error(p$4(130,tt==null?tt:typeof tt,""))}return _e=Bg(ot,rt,_e,it),_e.elementType=tt,_e.type=nt,_e.lanes=st,_e}function Ah(tt,_e,rt,nt){return tt=Bg(7,tt,nt,_e),tt.lanes=rt,tt}function qj(tt,_e,rt,nt){return tt=Bg(22,tt,nt,_e),tt.elementType=Ia,tt.lanes=rt,tt.stateNode={isHidden:!1},tt}function xh(tt,_e,rt){return tt=Bg(6,tt,null,_e),tt.lanes=rt,tt}function zh(tt,_e,rt){return _e=Bg(4,tt.children!==null?tt.children:[],tt.key,_e),_e.lanes=rt,_e.stateNode={containerInfo:tt.containerInfo,pendingChildren:null,implementation:tt.implementation},_e}function bl(tt,_e,rt,nt,it){this.tag=_e,this.containerInfo=tt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=nt,this.onRecoverableError=it,this.mutableSourceEagerHydrationData=null}function cl(tt,_e,rt,nt,it,st,ot,lt,at){return tt=new bl(tt,_e,rt,lt,at),_e===1?(_e=1,st===!0&&(_e|=8)):_e=0,st=Bg(3,null,null,_e),tt.current=st,st.stateNode=tt,st.memoizedState={element:nt,isDehydrated:rt,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(st),tt}function dl(tt,_e,rt){var nt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:nt==null?null:""+nt,children:tt,containerInfo:_e,implementation:rt}}function el(tt){if(!tt)return Vf;tt=tt._reactInternals;e:{if(Vb(tt)!==tt||tt.tag!==1)throw Error(p$4(170));var _e=tt;do{switch(_e.tag){case 3:_e=_e.stateNode.context;break e;case 1:if(Zf(_e.type)){_e=_e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_e=_e.return}while(_e!==null);throw Error(p$4(171))}if(tt.tag===1){var rt=tt.type;if(Zf(rt))return bg(tt,rt,_e)}return _e}function fl$1(tt,_e,rt,nt,it,st,ot,lt,at){return tt=cl(rt,nt,!0,tt,it,st,ot,lt,at),tt.context=el(null),rt=tt.current,nt=L$2(),it=lh(rt),st=ch(nt,it),st.callback=_e??null,dh(rt,st,it),tt.current.lanes=it,Ac(tt,it,nt),Ek(tt,nt),tt}function gl(tt,_e,rt,nt){var it=_e.current,st=L$2(),ot=lh(it);return rt=el(rt),_e.context===null?_e.context=rt:_e.pendingContext=rt,_e=ch(st,ot),_e.payload={element:tt},nt=nt===void 0?null:nt,nt!==null&&(_e.callback=nt),tt=dh(it,_e,ot),tt!==null&&(mh(tt,it,ot,st),eh(tt,it,ot)),ot}function hl(tt){if(tt=tt.current,!tt.child)return null;switch(tt.child.tag){case 5:return tt.child.stateNode;default:return tt.child.stateNode}}function il(tt,_e){if(tt=tt.memoizedState,tt!==null&&tt.dehydrated!==null){var rt=tt.retryLane;tt.retryLane=rt!==0&&rt<_e?rt:_e}}function jl(tt,_e){il(tt,_e),(tt=tt.alternate)&&il(tt,_e)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(tt){console.error(tt)};function ml(tt){this._internalRoot=tt}nl.prototype.render=ml.prototype.render=function(tt){var _e=this._internalRoot;if(_e===null)throw Error(p$4(409));gl(tt,_e,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var tt=this._internalRoot;if(tt!==null){this._internalRoot=null;var _e=tt.containerInfo;Sk(function(){gl(null,tt,null,null)}),_e[uf]=null}};function nl(tt){this._internalRoot=tt}nl.prototype.unstable_scheduleHydration=function(tt){if(tt){var _e=Hc();tt={blockedOn:null,target:tt,priority:_e};for(var rt=0;rt<Qc.length&&_e!==0&&_e<Qc[rt].priority;rt++);Qc.splice(rt,0,tt),rt===0&&Vc(tt)}};function ol(tt){return!(!tt||tt.nodeType!==1&&tt.nodeType!==9&&tt.nodeType!==11)}function pl(tt){return!(!tt||tt.nodeType!==1&&tt.nodeType!==9&&tt.nodeType!==11&&(tt.nodeType!==8||tt.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(tt,_e,rt,nt,it){if(it){if(typeof nt=="function"){var st=nt;nt=function(){var ct=hl(ot);st.call(ct)}}var ot=fl$1(_e,nt,tt,0,null,!1,!1,"",ql);return tt._reactRootContainer=ot,tt[uf]=ot.current,sf(tt.nodeType===8?tt.parentNode:tt),Sk(),ot}for(;it=tt.lastChild;)tt.removeChild(it);if(typeof nt=="function"){var lt=nt;nt=function(){var ct=hl(at);lt.call(ct)}}var at=cl(tt,0,!1,null,null,!1,!1,"",ql);return tt._reactRootContainer=at,tt[uf]=at.current,sf(tt.nodeType===8?tt.parentNode:tt),Sk(function(){gl(_e,at,rt,nt)}),at}function sl(tt,_e,rt,nt,it){var st=rt._reactRootContainer;if(st){var ot=st;if(typeof it=="function"){var lt=it;it=function(){var at=hl(ot);lt.call(at)}}gl(_e,ot,tt,it)}else ot=rl(rt,_e,tt,it,nt);return hl(ot)}Ec=function(tt){switch(tt.tag){case 3:var _e=tt.stateNode;if(_e.current.memoizedState.isDehydrated){var rt=tc(_e.pendingLanes);rt!==0&&(Cc(_e,rt|1),Ek(_e,B$2()),!(K&6)&&(Hj=B$2()+500,jg()))}break;case 13:Sk(function(){var nt=Zg(tt,1);if(nt!==null){var it=L$2();mh(nt,tt,1,it)}}),jl(tt,1)}};Fc=function(tt){if(tt.tag===13){var _e=Zg(tt,134217728);if(_e!==null){var rt=L$2();mh(_e,tt,134217728,rt)}jl(tt,134217728)}};Gc=function(tt){if(tt.tag===13){var _e=lh(tt),rt=Zg(tt,_e);if(rt!==null){var nt=L$2();mh(rt,tt,_e,nt)}jl(tt,_e)}};Hc=function(){return C$2};Ic=function(tt,_e){var rt=C$2;try{return C$2=tt,_e()}finally{C$2=rt}};yb=function(tt,_e,rt){switch(_e){case"input":if(bb(tt,rt),_e=rt.name,rt.type==="radio"&&_e!=null){for(rt=tt;rt.parentNode;)rt=rt.parentNode;for(rt=rt.querySelectorAll("input[name="+JSON.stringify(""+_e)+'][type="radio"]'),_e=0;_e<rt.length;_e++){var nt=rt[_e];if(nt!==tt&&nt.form===tt.form){var it=Db(nt);if(!it)throw Error(p$4(90));Wa(nt),bb(nt,it)}}}break;case"textarea":ib(tt,rt);break;case"select":_e=rt.value,_e!=null&&fb(tt,!!rt.multiple,_e,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(tt){return tt=Zb(tt),tt===null?null:tt.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(tt,_e){var rt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(_e))throw Error(p$4(200));return dl(tt,_e,null,rt)};reactDom_production_min.createRoot=function(tt,_e){if(!ol(tt))throw Error(p$4(299));var rt=!1,nt="",it=ll;return _e!=null&&(_e.unstable_strictMode===!0&&(rt=!0),_e.identifierPrefix!==void 0&&(nt=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(it=_e.onRecoverableError)),_e=cl(tt,1,!1,null,null,rt,!1,nt,it),tt[uf]=_e.current,sf(tt.nodeType===8?tt.parentNode:tt),new ml(_e)};reactDom_production_min.findDOMNode=function(tt){if(tt==null)return null;if(tt.nodeType===1)return tt;var _e=tt._reactInternals;if(_e===void 0)throw typeof tt.render=="function"?Error(p$4(188)):(tt=Object.keys(tt).join(","),Error(p$4(268,tt)));return tt=Zb(_e),tt=tt===null?null:tt.stateNode,tt};reactDom_production_min.flushSync=function(tt){return Sk(tt)};reactDom_production_min.hydrate=function(tt,_e,rt){if(!pl(_e))throw Error(p$4(200));return sl(null,tt,_e,!0,rt)};reactDom_production_min.hydrateRoot=function(tt,_e,rt){if(!ol(tt))throw Error(p$4(405));var nt=rt!=null&&rt.hydratedSources||null,it=!1,st="",ot=ll;if(rt!=null&&(rt.unstable_strictMode===!0&&(it=!0),rt.identifierPrefix!==void 0&&(st=rt.identifierPrefix),rt.onRecoverableError!==void 0&&(ot=rt.onRecoverableError)),_e=fl$1(_e,null,tt,1,rt??null,it,!1,st,ot),tt[uf]=_e.current,sf(tt),nt)for(tt=0;tt<nt.length;tt++)rt=nt[tt],it=rt._getVersion,it=it(rt._source),_e.mutableSourceEagerHydrationData==null?_e.mutableSourceEagerHydrationData=[rt,it]:_e.mutableSourceEagerHydrationData.push(rt,it);return new nl(_e)};reactDom_production_min.render=function(tt,_e,rt){if(!pl(_e))throw Error(p$4(200));return sl(null,tt,_e,!1,rt)};reactDom_production_min.unmountComponentAtNode=function(tt){if(!pl(tt))throw Error(p$4(40));return tt._reactRootContainer?(Sk(function(){sl(null,null,tt,!1,function(){tt._reactRootContainer=null,tt[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(tt,_e,rt,nt){if(!pl(rt))throw Error(p$4(200));if(tt==null||tt._reactInternals===void 0)throw Error(p$4(38));return sl(tt,_e,rt,!1,nt)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(tt){console.error(tt)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);var m$4=reactDomExports;client.createRoot=m$4.createRoot,client.hydrateRoot=m$4.hydrateRoot;/**
 * @remix-run/router v1.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(tt[nt]=rt[nt])}return tt},_extends$3.apply(this,arguments)}var Action;(function(tt){tt.Pop="POP",tt.Push="PUSH",tt.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(tt){tt===void 0&&(tt={});function _e(nt,it){let{pathname:st,search:ot,hash:lt}=nt.location;return createLocation("",{pathname:st,search:ot,hash:lt},it.state&&it.state.usr||null,it.state&&it.state.key||"default")}function rt(nt,it){return typeof it=="string"?it:createPath$1(it)}return getUrlBasedHistory(_e,rt,null,tt)}function invariant(tt,_e){if(tt===!1||tt===null||typeof tt>"u")throw new Error(_e)}function warning(tt,_e){if(!tt){typeof console<"u"&&console.warn(_e);try{throw new Error(_e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(tt,_e){return{usr:tt.state,key:tt.key,idx:_e}}function createLocation(tt,_e,rt,nt){return rt===void 0&&(rt=null),_extends$3({pathname:typeof tt=="string"?tt:tt.pathname,search:"",hash:""},typeof _e=="string"?parsePath(_e):_e,{state:rt,key:_e&&_e.key||nt||createKey()})}function createPath$1(tt){let{pathname:_e="/",search:rt="",hash:nt=""}=tt;return rt&&rt!=="?"&&(_e+=rt.charAt(0)==="?"?rt:"?"+rt),nt&&nt!=="#"&&(_e+=nt.charAt(0)==="#"?nt:"#"+nt),_e}function parsePath(tt){let _e={};if(tt){let rt=tt.indexOf("#");rt>=0&&(_e.hash=tt.substr(rt),tt=tt.substr(0,rt));let nt=tt.indexOf("?");nt>=0&&(_e.search=tt.substr(nt),tt=tt.substr(0,nt)),tt&&(_e.pathname=tt)}return _e}function getUrlBasedHistory(tt,_e,rt,nt){nt===void 0&&(nt={});let{window:it=document.defaultView,v5Compat:st=!1}=nt,ot=it.history,lt=Action.Pop,at=null,ct=ut();ct==null&&(ct=0,ot.replaceState(_extends$3({},ot.state,{idx:ct}),""));function ut(){return(ot.state||{idx:null}).idx}function ht(){lt=Action.Pop;let gt=ut(),vt=gt==null?null:gt-ct;ct=gt,at&&at({action:lt,location:mt.location,delta:vt})}function dt(gt,vt){lt=Action.Push;let At=createLocation(mt.location,gt,vt);rt&&rt(At,gt),ct=ut()+1;let yt=getHistoryState(At,ct),xt=mt.createHref(At);try{ot.pushState(yt,"",xt)}catch(_t){if(_t instanceof DOMException&&_t.name==="DataCloneError")throw _t;it.location.assign(xt)}st&&at&&at({action:lt,location:mt.location,delta:1})}function ft(gt,vt){lt=Action.Replace;let At=createLocation(mt.location,gt,vt);rt&&rt(At,gt),ct=ut();let yt=getHistoryState(At,ct),xt=mt.createHref(At);ot.replaceState(yt,"",xt),st&&at&&at({action:lt,location:mt.location,delta:0})}function pt(gt){let vt=it.location.origin!=="null"?it.location.origin:it.location.href,At=typeof gt=="string"?gt:createPath$1(gt);return invariant(vt,"No window.location.(origin|href) available to create URL for href: "+At),new URL(At,vt)}let mt={get action(){return lt},get location(){return tt(it,ot)},listen(gt){if(at)throw new Error("A history only accepts one active listener");return it.addEventListener(PopStateEventType,ht),at=gt,()=>{it.removeEventListener(PopStateEventType,ht),at=null}},createHref(gt){return _e(it,gt)},createURL:pt,encodeLocation(gt){let vt=pt(gt);return{pathname:vt.pathname,search:vt.search,hash:vt.hash}},push:dt,replace:ft,go(gt){return ot.go(gt)}};return mt}var ResultType;(function(tt){tt.data="data",tt.deferred="deferred",tt.redirect="redirect",tt.error="error"})(ResultType||(ResultType={}));function matchRoutes(tt,_e,rt){rt===void 0&&(rt="/");let nt=typeof _e=="string"?parsePath(_e):_e,it=stripBasename(nt.pathname||"/",rt);if(it==null)return null;let st=flattenRoutes(tt);rankRouteBranches(st);let ot=null;for(let lt=0;ot==null&&lt<st.length;++lt)ot=matchRouteBranch(st[lt],safelyDecodeURI(it));return ot}function flattenRoutes(tt,_e,rt,nt){_e===void 0&&(_e=[]),rt===void 0&&(rt=[]),nt===void 0&&(nt="");let it=(st,ot,lt)=>{let at={relativePath:lt===void 0?st.path||"":lt,caseSensitive:st.caseSensitive===!0,childrenIndex:ot,route:st};at.relativePath.startsWith("/")&&(invariant(at.relativePath.startsWith(nt),'Absolute route path "'+at.relativePath+'" nested under path '+('"'+nt+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),at.relativePath=at.relativePath.slice(nt.length));let ct=joinPaths([nt,at.relativePath]),ut=rt.concat(at);st.children&&st.children.length>0&&(invariant(st.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+ct+'".')),flattenRoutes(st.children,_e,ut,ct)),!(st.path==null&&!st.index)&&_e.push({path:ct,score:computeScore(ct,st.index),routesMeta:ut})};return tt.forEach((st,ot)=>{var lt;if(st.path===""||!((lt=st.path)!=null&&lt.includes("?")))it(st,ot);else for(let at of explodeOptionalSegments(st.path))it(st,ot,at)}),_e}function explodeOptionalSegments(tt){let _e=tt.split("/");if(_e.length===0)return[];let[rt,...nt]=_e,it=rt.endsWith("?"),st=rt.replace(/\?$/,"");if(nt.length===0)return it?[st,""]:[st];let ot=explodeOptionalSegments(nt.join("/")),lt=[];return lt.push(...ot.map(at=>at===""?st:[st,at].join("/"))),it&&lt.push(...ot),lt.map(at=>tt.startsWith("/")&&at===""?"/":at)}function rankRouteBranches(tt){tt.sort((_e,rt)=>_e.score!==rt.score?rt.score-_e.score:compareIndexes(_e.routesMeta.map(nt=>nt.childrenIndex),rt.routesMeta.map(nt=>nt.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=tt=>tt==="*";function computeScore(tt,_e){let rt=tt.split("/"),nt=rt.length;return rt.some(isSplat)&&(nt+=splatPenalty),_e&&(nt+=indexRouteValue),rt.filter(it=>!isSplat(it)).reduce((it,st)=>it+(paramRe.test(st)?dynamicSegmentValue:st===""?emptySegmentValue:staticSegmentValue),nt)}function compareIndexes(tt,_e){return tt.length===_e.length&&tt.slice(0,-1).every((nt,it)=>nt===_e[it])?tt[tt.length-1]-_e[_e.length-1]:0}function matchRouteBranch(tt,_e){let{routesMeta:rt}=tt,nt={},it="/",st=[];for(let ot=0;ot<rt.length;++ot){let lt=rt[ot],at=ot===rt.length-1,ct=it==="/"?_e:_e.slice(it.length)||"/",ut=matchPath({path:lt.relativePath,caseSensitive:lt.caseSensitive,end:at},ct);if(!ut)return null;Object.assign(nt,ut.params);let ht=lt.route;st.push({params:nt,pathname:joinPaths([it,ut.pathname]),pathnameBase:normalizePathname(joinPaths([it,ut.pathnameBase])),route:ht}),ut.pathnameBase!=="/"&&(it=joinPaths([it,ut.pathnameBase]))}return st}function matchPath(tt,_e){typeof tt=="string"&&(tt={path:tt,caseSensitive:!1,end:!0});let[rt,nt]=compilePath(tt.path,tt.caseSensitive,tt.end),it=_e.match(rt);if(!it)return null;let st=it[0],ot=st.replace(/(.)\/+$/,"$1"),lt=it.slice(1);return{params:nt.reduce((ct,ut,ht)=>{if(ut==="*"){let dt=lt[ht]||"";ot=st.slice(0,st.length-dt.length).replace(/(.)\/+$/,"$1")}return ct[ut]=safelyDecodeURIComponent(lt[ht]||"",ut),ct},{}),pathname:st,pathnameBase:ot,pattern:tt}}function compilePath(tt,_e,rt){_e===void 0&&(_e=!1),rt===void 0&&(rt=!0),warning(tt==="*"||!tt.endsWith("*")||tt.endsWith("/*"),'Route path "'+tt+'" will be treated as if it were '+('"'+tt.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+tt.replace(/\*$/,"/*")+'".'));let nt=[],it="^"+tt.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(ot,lt)=>(nt.push(lt),"/([^\\/]+)"));return tt.endsWith("*")?(nt.push("*"),it+=tt==="*"||tt==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):rt?it+="\\/*$":tt!==""&&tt!=="/"&&(it+="(?:(?=\\/|$))"),[new RegExp(it,_e?void 0:"i"),nt]}function safelyDecodeURI(tt){try{return decodeURI(tt)}catch(_e){return warning(!1,'The URL path "'+tt+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+_e+").")),tt}}function safelyDecodeURIComponent(tt,_e){try{return decodeURIComponent(tt)}catch(rt){return warning(!1,'The value for the URL param "'+_e+'" will not be decoded because'+(' the string "'+tt+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+rt+").")),tt}}function stripBasename(tt,_e){if(_e==="/")return tt;if(!tt.toLowerCase().startsWith(_e.toLowerCase()))return null;let rt=_e.endsWith("/")?_e.length-1:_e.length,nt=tt.charAt(rt);return nt&&nt!=="/"?null:tt.slice(rt)||"/"}const joinPaths=tt=>tt.join("/").replace(/\/\/+/g,"/"),normalizePathname=tt=>tt.replace(/\/+$/,"").replace(/^\/*/,"/");function isRouteErrorResponse(tt){return tt!=null&&typeof tt.status=="number"&&typeof tt.statusText=="string"&&typeof tt.internal=="boolean"&&"data"in tt}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(tt[nt]=rt[nt])}return tt},_extends$2.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useParams(){let{matches:tt}=reactExports.useContext(RouteContext),_e=tt[tt.length-1];return _e?_e.params:{}}function useRoutes(tt,_e){return useRoutesImpl(tt,_e)}function useRoutesImpl(tt,_e,rt){useInRouterContext()||invariant(!1);let{navigator:nt}=reactExports.useContext(NavigationContext),{matches:it}=reactExports.useContext(RouteContext),st=it[it.length-1],ot=st?st.params:{};st&&st.pathname;let lt=st?st.pathnameBase:"/";st&&st.route;let at=useLocation(),ct;if(_e){var ut;let mt=typeof _e=="string"?parsePath(_e):_e;lt==="/"||(ut=mt.pathname)!=null&&ut.startsWith(lt)||invariant(!1),ct=mt}else ct=at;let ht=ct.pathname||"/",dt=lt==="/"?ht:ht.slice(lt.length)||"/",ft=matchRoutes(tt,{pathname:dt}),pt=_renderMatches(ft&&ft.map(mt=>Object.assign({},mt,{params:Object.assign({},ot,mt.params),pathname:joinPaths([lt,nt.encodeLocation?nt.encodeLocation(mt.pathname).pathname:mt.pathname]),pathnameBase:mt.pathnameBase==="/"?lt:joinPaths([lt,nt.encodeLocation?nt.encodeLocation(mt.pathnameBase).pathname:mt.pathnameBase])})),it,rt);return _e&&pt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$2({pathname:"/",search:"",hash:"",state:null,key:"default"},ct),navigationType:Action.Pop}},pt):pt}function DefaultErrorComponent(){let tt=useRouteError(),_e=isRouteErrorResponse(tt)?tt.status+" "+tt.statusText:tt instanceof Error?tt.message:JSON.stringify(tt),rt=tt instanceof Error?tt.stack:null,it={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},st=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},_e),rt?reactExports.createElement("pre",{style:it},rt):null,st)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(_e){super(_e),this.state={location:_e.location,revalidation:_e.revalidation,error:_e.error}}static getDerivedStateFromError(_e){return{error:_e}}static getDerivedStateFromProps(_e,rt){return rt.location!==_e.location||rt.revalidation!=="idle"&&_e.revalidation==="idle"?{error:_e.error,location:_e.location,revalidation:_e.revalidation}:{error:_e.error||rt.error,location:rt.location,revalidation:_e.revalidation||rt.revalidation}}componentDidCatch(_e,rt){console.error("React Router caught the following error during render",_e,rt)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(tt){let{routeContext:_e,match:rt,children:nt}=tt,it=reactExports.useContext(DataRouterContext);return it&&it.static&&it.staticContext&&(rt.route.errorElement||rt.route.ErrorBoundary)&&(it.staticContext._deepestRenderedBoundaryId=rt.route.id),reactExports.createElement(RouteContext.Provider,{value:_e},nt)}function _renderMatches(tt,_e,rt){var nt;if(_e===void 0&&(_e=[]),rt===void 0&&(rt=null),tt==null){var it;if((it=rt)!=null&&it.errors)tt=rt.matches;else return null}let st=tt,ot=(nt=rt)==null?void 0:nt.errors;if(ot!=null){let lt=st.findIndex(at=>at.route.id&&(ot==null?void 0:ot[at.route.id]));lt>=0||invariant(!1),st=st.slice(0,Math.min(st.length,lt+1))}return st.reduceRight((lt,at,ct)=>{let ut=at.route.id?ot==null?void 0:ot[at.route.id]:null,ht=null;rt&&(ht=at.route.errorElement||defaultErrorElement);let dt=_e.concat(st.slice(0,ct+1)),ft=()=>{let pt;return ut?pt=ht:at.route.Component?pt=reactExports.createElement(at.route.Component,null):at.route.element?pt=at.route.element:pt=lt,reactExports.createElement(RenderedRoute,{match:at,routeContext:{outlet:lt,matches:dt,isDataRoute:rt!=null},children:pt})};return rt&&(at.route.ErrorBoundary||at.route.errorElement||ct===0)?reactExports.createElement(RenderErrorBoundary,{location:rt.location,revalidation:rt.revalidation,component:ht,error:ut,children:ft(),routeContext:{outlet:null,matches:dt,isDataRoute:!0}}):ft()},null)}var DataRouterStateHook$1=function(tt){return tt.UseBlocker="useBlocker",tt.UseLoaderData="useLoaderData",tt.UseActionData="useActionData",tt.UseRouteError="useRouteError",tt.UseNavigation="useNavigation",tt.UseRouteLoaderData="useRouteLoaderData",tt.UseMatches="useMatches",tt.UseRevalidator="useRevalidator",tt.UseNavigateStable="useNavigate",tt.UseRouteId="useRouteId",tt}(DataRouterStateHook$1||{});function useDataRouterState(tt){let _e=reactExports.useContext(DataRouterStateContext);return _e||invariant(!1),_e}function useRouteContext(tt){let _e=reactExports.useContext(RouteContext);return _e||invariant(!1),_e}function useCurrentRouteId(tt){let _e=useRouteContext(),rt=_e.matches[_e.matches.length-1];return rt.route.id||invariant(!1),rt.route.id}function useRouteError(){var tt;let _e=reactExports.useContext(RouteErrorContext),rt=useDataRouterState(DataRouterStateHook$1.UseRouteError),nt=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return _e||((tt=rt.errors)==null?void 0:tt[nt])}function Route(tt){invariant(!1)}function Router(tt){let{basename:_e="/",children:rt=null,location:nt,navigationType:it=Action.Pop,navigator:st,static:ot=!1}=tt;useInRouterContext()&&invariant(!1);let lt=_e.replace(/^\/*/,"/"),at=reactExports.useMemo(()=>({basename:lt,navigator:st,static:ot}),[lt,st,ot]);typeof nt=="string"&&(nt=parsePath(nt));let{pathname:ct="/",search:ut="",hash:ht="",state:dt=null,key:ft="default"}=nt,pt=reactExports.useMemo(()=>{let mt=stripBasename(ct,lt);return mt==null?null:{location:{pathname:mt,search:ut,hash:ht,state:dt,key:ft},navigationType:it}},[lt,ct,ut,ht,dt,ft,it]);return pt==null?null:reactExports.createElement(NavigationContext.Provider,{value:at},reactExports.createElement(LocationContext.Provider,{children:rt,value:pt}))}function Routes(tt){let{children:_e,location:rt}=tt;return useRoutes(createRoutesFromChildren(_e),rt)}new Promise(()=>{});function createRoutesFromChildren(tt,_e){_e===void 0&&(_e=[]);let rt=[];return reactExports.Children.forEach(tt,(nt,it)=>{if(!reactExports.isValidElement(nt))return;let st=[..._e,it];if(nt.type===reactExports.Fragment){rt.push.apply(rt,createRoutesFromChildren(nt.props.children,st));return}nt.type!==Route&&invariant(!1),!nt.props.index||!nt.props.children||invariant(!1);let ot={id:nt.props.id||st.join("-"),caseSensitive:nt.props.caseSensitive,element:nt.props.element,Component:nt.props.Component,index:nt.props.index,path:nt.props.path,loader:nt.props.loader,action:nt.props.action,errorElement:nt.props.errorElement,ErrorBoundary:nt.props.ErrorBoundary,hasErrorBoundary:nt.props.ErrorBoundary!=null||nt.props.errorElement!=null,shouldRevalidate:nt.props.shouldRevalidate,handle:nt.props.handle,lazy:nt.props.lazy};nt.props.children&&(ot.children=createRoutesFromChildren(nt.props.children,st)),rt.push(ot)}),rt}/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const START_TRANSITION="startTransition",startTransitionImpl=t$5[START_TRANSITION];function BrowserRouter(tt){let{basename:_e,children:rt,future:nt,window:it}=tt,st=reactExports.useRef();st.current==null&&(st.current=createBrowserHistory({window:it,v5Compat:!0}));let ot=st.current,[lt,at]=reactExports.useState({action:ot.action,location:ot.location}),{v7_startTransition:ct}=nt||{},ut=reactExports.useCallback(ht=>{ct&&startTransitionImpl?startTransitionImpl(()=>at(ht)):at(ht)},[at,ct]);return reactExports.useLayoutEffect(()=>ot.listen(ut),[ot,ut]),reactExports.createElement(Router,{basename:_e,children:rt,location:lt.location,navigationType:lt.action,navigator:ot})}var DataRouterHook;(function(tt){tt.UseScrollRestoration="useScrollRestoration",tt.UseSubmit="useSubmit",tt.UseSubmitFetcher="useSubmitFetcher",tt.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(tt){tt.UseFetchers="useFetchers",tt.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(tt[nt]=rt[nt])}return tt},_extends$1.apply(this,arguments)}var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function tt(nt,it,st,ot,lt,at){if(at!==ReactPropTypesSecret){var ct=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw ct.name="Invariant Violation",ct}}tt.isRequired=tt;function _e(){return tt}var rt={array:tt,bigint:tt,bool:tt,func:tt,number:tt,object:tt,string:tt,symbol:tt,any:tt,arrayOf:_e,element:tt,elementType:tt,instanceOf:_e,node:tt,objectOf:_e,oneOf:_e,oneOfType:_e,shape:_e,exact:_e,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return rt.PropTypes=rt,rt};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="154",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,TwoPassDoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,AlphaFormat=1021,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding=3e3,sRGBEncoding=3001,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",_SRGBAFormat=1035,WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(_e,rt){this._listeners===void 0&&(this._listeners={});const nt=this._listeners;nt[_e]===void 0&&(nt[_e]=[]),nt[_e].indexOf(rt)===-1&&nt[_e].push(rt)}hasEventListener(_e,rt){if(this._listeners===void 0)return!1;const nt=this._listeners;return nt[_e]!==void 0&&nt[_e].indexOf(rt)!==-1}removeEventListener(_e,rt){if(this._listeners===void 0)return;const it=this._listeners[_e];if(it!==void 0){const st=it.indexOf(rt);st!==-1&&it.splice(st,1)}}dispatchEvent(_e){if(this._listeners===void 0)return;const nt=this._listeners[_e.type];if(nt!==void 0){_e.target=this;const it=nt.slice(0);for(let st=0,ot=it.length;st<ot;st++)it[st].call(this,_e);_e.target=null}}}const _lut$1=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID$1(){const tt=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,rt=Math.random()*4294967295|0,nt=Math.random()*4294967295|0;return(_lut$1[tt&255]+_lut$1[tt>>8&255]+_lut$1[tt>>16&255]+_lut$1[tt>>24&255]+"-"+_lut$1[_e&255]+_lut$1[_e>>8&255]+"-"+_lut$1[_e>>16&15|64]+_lut$1[_e>>24&255]+"-"+_lut$1[rt&63|128]+_lut$1[rt>>8&255]+"-"+_lut$1[rt>>16&255]+_lut$1[rt>>24&255]+_lut$1[nt&255]+_lut$1[nt>>8&255]+_lut$1[nt>>16&255]+_lut$1[nt>>24&255]).toLowerCase()}function clamp$2(tt,_e,rt){return Math.max(_e,Math.min(rt,tt))}function euclideanModulo(tt,_e){return(tt%_e+_e)%_e}function mapLinear(tt,_e,rt,nt,it){return nt+(tt-_e)*(it-nt)/(rt-_e)}function inverseLerp(tt,_e,rt){return tt!==_e?(rt-tt)/(_e-tt):0}function lerp(tt,_e,rt){return(1-rt)*tt+rt*_e}function damp(tt,_e,rt,nt){return lerp(tt,_e,1-Math.exp(-rt*nt))}function pingpong(tt,_e=1){return _e-Math.abs(euclideanModulo(tt,_e*2)-_e)}function smoothstep(tt,_e,rt){return tt<=_e?0:tt>=rt?1:(tt=(tt-_e)/(rt-_e),tt*tt*(3-2*tt))}function smootherstep(tt,_e,rt){return tt<=_e?0:tt>=rt?1:(tt=(tt-_e)/(rt-_e),tt*tt*tt*(tt*(tt*6-15)+10))}function randInt(tt,_e){return tt+Math.floor(Math.random()*(_e-tt+1))}function randFloat(tt,_e){return tt+Math.random()*(_e-tt)}function randFloatSpread(tt){return tt*(.5-Math.random())}function seededRandom(tt){tt!==void 0&&(_seed=tt);let _e=_seed+=1831565813;return _e=Math.imul(_e^_e>>>15,_e|1),_e^=_e+Math.imul(_e^_e>>>7,_e|61),((_e^_e>>>14)>>>0)/4294967296}function degToRad(tt){return tt*DEG2RAD}function radToDeg(tt){return tt*RAD2DEG}function isPowerOfTwo(tt){return(tt&tt-1)===0&&tt!==0}function ceilPowerOfTwo(tt){return Math.pow(2,Math.ceil(Math.log(tt)/Math.LN2))}function floorPowerOfTwo(tt){return Math.pow(2,Math.floor(Math.log(tt)/Math.LN2))}function setQuaternionFromProperEuler(tt,_e,rt,nt,it){const st=Math.cos,ot=Math.sin,lt=st(rt/2),at=ot(rt/2),ct=st((_e+nt)/2),ut=ot((_e+nt)/2),ht=st((_e-nt)/2),dt=ot((_e-nt)/2),ft=st((nt-_e)/2),pt=ot((nt-_e)/2);switch(it){case"XYX":tt.set(lt*ut,at*ht,at*dt,lt*ct);break;case"YZY":tt.set(at*dt,lt*ut,at*ht,lt*ct);break;case"ZXZ":tt.set(at*ht,at*dt,lt*ut,lt*ct);break;case"XZX":tt.set(lt*ut,at*pt,at*ft,lt*ct);break;case"YXY":tt.set(at*ft,lt*ut,at*pt,lt*ct);break;case"ZYZ":tt.set(at*pt,at*ft,lt*ut,lt*ct);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+it)}}function denormalize(tt,_e){switch(_e.constructor){case Float32Array:return tt;case Uint32Array:return tt/4294967295;case Uint16Array:return tt/65535;case Uint8Array:return tt/255;case Int32Array:return Math.max(tt/2147483647,-1);case Int16Array:return Math.max(tt/32767,-1);case Int8Array:return Math.max(tt/127,-1);default:throw new Error("Invalid component type.")}}function normalize$5(tt,_e){switch(_e.constructor){case Float32Array:return tt;case Uint32Array:return Math.round(tt*4294967295);case Uint16Array:return Math.round(tt*65535);case Uint8Array:return Math.round(tt*255);case Int32Array:return Math.round(tt*2147483647);case Int16Array:return Math.round(tt*32767);case Int8Array:return Math.round(tt*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID:generateUUID$1,clamp:clamp$2,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize:normalize$5,denormalize};class Vector2{constructor(_e=0,rt=0){Vector2.prototype.isVector2=!0,this.x=_e,this.y=rt}get width(){return this.x}set width(_e){this.x=_e}get height(){return this.y}set height(_e){this.y=_e}set(_e,rt){return this.x=_e,this.y=rt,this}setScalar(_e){return this.x=_e,this.y=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setComponent(_e,rt){switch(_e){case 0:this.x=rt;break;case 1:this.y=rt;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y)}copy(_e){return this.x=_e.x,this.y=_e.y,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this}addScalar(_e){return this.x+=_e,this.y+=_e,this}addVectors(_e,rt){return this.x=_e.x+rt.x,this.y=_e.y+rt.y,this}addScaledVector(_e,rt){return this.x+=_e.x*rt,this.y+=_e.y*rt,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this}subScalar(_e){return this.x-=_e,this.y-=_e,this}subVectors(_e,rt){return this.x=_e.x-rt.x,this.y=_e.y-rt.y,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this}divide(_e){return this.x/=_e.x,this.y/=_e.y,this}divideScalar(_e){return this.multiplyScalar(1/_e)}applyMatrix3(_e){const rt=this.x,nt=this.y,it=_e.elements;return this.x=it[0]*rt+it[3]*nt+it[6],this.y=it[1]*rt+it[4]*nt+it[7],this}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this}clamp(_e,rt){return this.x=Math.max(_e.x,Math.min(rt.x,this.x)),this.y=Math.max(_e.y,Math.min(rt.y,this.y)),this}clampScalar(_e,rt){return this.x=Math.max(_e,Math.min(rt,this.x)),this.y=Math.max(_e,Math.min(rt,this.y)),this}clampLength(_e,rt){const nt=this.length();return this.divideScalar(nt||1).multiplyScalar(Math.max(_e,Math.min(rt,nt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_e){return this.x*_e.x+this.y*_e.y}cross(_e){return this.x*_e.y-this.y*_e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_e){const rt=Math.sqrt(this.lengthSq()*_e.lengthSq());if(rt===0)return Math.PI/2;const nt=this.dot(_e)/rt;return Math.acos(clamp$2(nt,-1,1))}distanceTo(_e){return Math.sqrt(this.distanceToSquared(_e))}distanceToSquared(_e){const rt=this.x-_e.x,nt=this.y-_e.y;return rt*rt+nt*nt}manhattanDistanceTo(_e){return Math.abs(this.x-_e.x)+Math.abs(this.y-_e.y)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,rt){return this.x+=(_e.x-this.x)*rt,this.y+=(_e.y-this.y)*rt,this}lerpVectors(_e,rt,nt){return this.x=_e.x+(rt.x-_e.x)*nt,this.y=_e.y+(rt.y-_e.y)*nt,this}equals(_e){return _e.x===this.x&&_e.y===this.y}fromArray(_e,rt=0){return this.x=_e[rt],this.y=_e[rt+1],this}toArray(_e=[],rt=0){return _e[rt]=this.x,_e[rt+1]=this.y,_e}fromBufferAttribute(_e,rt){return this.x=_e.getX(rt),this.y=_e.getY(rt),this}rotateAround(_e,rt){const nt=Math.cos(rt),it=Math.sin(rt),st=this.x-_e.x,ot=this.y-_e.y;return this.x=st*nt-ot*it+_e.x,this.y=st*it+ot*nt+_e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(_e,rt,nt,it,st,ot,lt,at,ct){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_e!==void 0&&this.set(_e,rt,nt,it,st,ot,lt,at,ct)}set(_e,rt,nt,it,st,ot,lt,at,ct){const ut=this.elements;return ut[0]=_e,ut[1]=it,ut[2]=lt,ut[3]=rt,ut[4]=st,ut[5]=at,ut[6]=nt,ut[7]=ot,ut[8]=ct,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_e){const rt=this.elements,nt=_e.elements;return rt[0]=nt[0],rt[1]=nt[1],rt[2]=nt[2],rt[3]=nt[3],rt[4]=nt[4],rt[5]=nt[5],rt[6]=nt[6],rt[7]=nt[7],rt[8]=nt[8],this}extractBasis(_e,rt,nt){return _e.setFromMatrix3Column(this,0),rt.setFromMatrix3Column(this,1),nt.setFromMatrix3Column(this,2),this}setFromMatrix4(_e){const rt=_e.elements;return this.set(rt[0],rt[4],rt[8],rt[1],rt[5],rt[9],rt[2],rt[6],rt[10]),this}multiply(_e){return this.multiplyMatrices(this,_e)}premultiply(_e){return this.multiplyMatrices(_e,this)}multiplyMatrices(_e,rt){const nt=_e.elements,it=rt.elements,st=this.elements,ot=nt[0],lt=nt[3],at=nt[6],ct=nt[1],ut=nt[4],ht=nt[7],dt=nt[2],ft=nt[5],pt=nt[8],mt=it[0],gt=it[3],vt=it[6],At=it[1],yt=it[4],xt=it[7],_t=it[2],Et=it[5],bt=it[8];return st[0]=ot*mt+lt*At+at*_t,st[3]=ot*gt+lt*yt+at*Et,st[6]=ot*vt+lt*xt+at*bt,st[1]=ct*mt+ut*At+ht*_t,st[4]=ct*gt+ut*yt+ht*Et,st[7]=ct*vt+ut*xt+ht*bt,st[2]=dt*mt+ft*At+pt*_t,st[5]=dt*gt+ft*yt+pt*Et,st[8]=dt*vt+ft*xt+pt*bt,this}multiplyScalar(_e){const rt=this.elements;return rt[0]*=_e,rt[3]*=_e,rt[6]*=_e,rt[1]*=_e,rt[4]*=_e,rt[7]*=_e,rt[2]*=_e,rt[5]*=_e,rt[8]*=_e,this}determinant(){const _e=this.elements,rt=_e[0],nt=_e[1],it=_e[2],st=_e[3],ot=_e[4],lt=_e[5],at=_e[6],ct=_e[7],ut=_e[8];return rt*ot*ut-rt*lt*ct-nt*st*ut+nt*lt*at+it*st*ct-it*ot*at}invert(){const _e=this.elements,rt=_e[0],nt=_e[1],it=_e[2],st=_e[3],ot=_e[4],lt=_e[5],at=_e[6],ct=_e[7],ut=_e[8],ht=ut*ot-lt*ct,dt=lt*at-ut*st,ft=ct*st-ot*at,pt=rt*ht+nt*dt+it*ft;if(pt===0)return this.set(0,0,0,0,0,0,0,0,0);const mt=1/pt;return _e[0]=ht*mt,_e[1]=(it*ct-ut*nt)*mt,_e[2]=(lt*nt-it*ot)*mt,_e[3]=dt*mt,_e[4]=(ut*rt-it*at)*mt,_e[5]=(it*st-lt*rt)*mt,_e[6]=ft*mt,_e[7]=(nt*at-ct*rt)*mt,_e[8]=(ot*rt-nt*st)*mt,this}transpose(){let _e;const rt=this.elements;return _e=rt[1],rt[1]=rt[3],rt[3]=_e,_e=rt[2],rt[2]=rt[6],rt[6]=_e,_e=rt[5],rt[5]=rt[7],rt[7]=_e,this}getNormalMatrix(_e){return this.setFromMatrix4(_e).invert().transpose()}transposeIntoArray(_e){const rt=this.elements;return _e[0]=rt[0],_e[1]=rt[3],_e[2]=rt[6],_e[3]=rt[1],_e[4]=rt[4],_e[5]=rt[7],_e[6]=rt[2],_e[7]=rt[5],_e[8]=rt[8],this}setUvTransform(_e,rt,nt,it,st,ot,lt){const at=Math.cos(st),ct=Math.sin(st);return this.set(nt*at,nt*ct,-nt*(at*ot+ct*lt)+ot+_e,-it*ct,it*at,-it*(-ct*ot+at*lt)+lt+rt,0,0,1),this}scale(_e,rt){return this.premultiply(_m3.makeScale(_e,rt)),this}rotate(_e){return this.premultiply(_m3.makeRotation(-_e)),this}translate(_e,rt){return this.premultiply(_m3.makeTranslation(_e,rt)),this}makeTranslation(_e,rt){return _e.isVector2?this.set(1,0,_e.x,0,1,_e.y,0,0,1):this.set(1,0,_e,0,1,rt,0,0,1),this}makeRotation(_e){const rt=Math.cos(_e),nt=Math.sin(_e);return this.set(rt,-nt,0,nt,rt,0,0,0,1),this}makeScale(_e,rt){return this.set(_e,0,0,0,rt,0,0,0,1),this}equals(_e){const rt=this.elements,nt=_e.elements;for(let it=0;it<9;it++)if(rt[it]!==nt[it])return!1;return!0}fromArray(_e,rt=0){for(let nt=0;nt<9;nt++)this.elements[nt]=_e[nt+rt];return this}toArray(_e=[],rt=0){const nt=this.elements;return _e[rt]=nt[0],_e[rt+1]=nt[1],_e[rt+2]=nt[2],_e[rt+3]=nt[3],_e[rt+4]=nt[4],_e[rt+5]=nt[5],_e[rt+6]=nt[6],_e[rt+7]=nt[7],_e[rt+8]=nt[8],_e}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(tt){for(let _e=tt.length-1;_e>=0;--_e)if(tt[_e]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(tt,_e){return new TYPED_ARRAYS[tt](_e)}function createElementNS(tt){return document.createElementNS("http://www.w3.org/1999/xhtml",tt)}const _cache={};function warnOnce(tt){tt in _cache||(_cache[tt]=!0,console.warn(tt))}function SRGBToLinear(tt){return tt<.04045?tt*.0773993808:Math.pow(tt*.9478672986+.0521327014,2.4)}function LinearToSRGB(tt){return tt<.0031308?tt*12.92:1.055*Math.pow(tt,.41666)-.055}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function DisplayP3ToLinearSRGB(tt){return tt.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB)}function LinearSRGBToDisplayP3(tt){return tt.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}const TO_LINEAR={[LinearSRGBColorSpace]:tt=>tt,[SRGBColorSpace]:tt=>tt.convertSRGBToLinear(),[DisplayP3ColorSpace]:DisplayP3ToLinearSRGB},FROM_LINEAR={[LinearSRGBColorSpace]:tt=>tt,[SRGBColorSpace]:tt=>tt.convertLinearToSRGB(),[DisplayP3ColorSpace]:LinearSRGBToDisplayP3},ColorManagement={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(tt){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!tt},get workingColorSpace(){return LinearSRGBColorSpace},set workingColorSpace(tt){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(tt,_e,rt){if(this.enabled===!1||_e===rt||!_e||!rt)return tt;const nt=TO_LINEAR[_e],it=FROM_LINEAR[rt];if(nt===void 0||it===void 0)throw new Error(`Unsupported color space conversion, "${_e}" to "${rt}".`);return it(nt(tt))},fromWorkingColorSpace:function(tt,_e){return this.convert(tt,this.workingColorSpace,_e)},toWorkingColorSpace:function(tt,_e){return this.convert(tt,_e,this.workingColorSpace)}};let _canvas;class ImageUtils{static getDataURL(_e){if(/^data:/i.test(_e.src)||typeof HTMLCanvasElement>"u")return _e.src;let rt;if(_e instanceof HTMLCanvasElement)rt=_e;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_e.width,_canvas.height=_e.height;const nt=_canvas.getContext("2d");_e instanceof ImageData?nt.putImageData(_e,0,0):nt.drawImage(_e,0,0,_e.width,_e.height),rt=_canvas}return rt.width>2048||rt.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_e),rt.toDataURL("image/jpeg",.6)):rt.toDataURL("image/png")}static sRGBToLinear(_e){if(typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_e instanceof ImageBitmap){const rt=createElementNS("canvas");rt.width=_e.width,rt.height=_e.height;const nt=rt.getContext("2d");nt.drawImage(_e,0,0,_e.width,_e.height);const it=nt.getImageData(0,0,_e.width,_e.height),st=it.data;for(let ot=0;ot<st.length;ot++)st[ot]=SRGBToLinear(st[ot]/255)*255;return nt.putImageData(it,0,0),rt}else if(_e.data){const rt=_e.data.slice(0);for(let nt=0;nt<rt.length;nt++)rt instanceof Uint8Array||rt instanceof Uint8ClampedArray?rt[nt]=Math.floor(SRGBToLinear(rt[nt]/255)*255):rt[nt]=SRGBToLinear(rt[nt]);return{data:rt,width:_e.width,height:_e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_e}}let sourceId=0;class Source{constructor(_e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:sourceId++}),this.uuid=generateUUID$1(),this.data=_e,this.version=0}set needsUpdate(_e){_e===!0&&this.version++}toJSON(_e){const rt=_e===void 0||typeof _e=="string";if(!rt&&_e.images[this.uuid]!==void 0)return _e.images[this.uuid];const nt={uuid:this.uuid,url:""},it=this.data;if(it!==null){let st;if(Array.isArray(it)){st=[];for(let ot=0,lt=it.length;ot<lt;ot++)it[ot].isDataTexture?st.push(serializeImage(it[ot].image)):st.push(serializeImage(it[ot]))}else st=serializeImage(it);nt.url=st}return rt||(_e.images[this.uuid]=nt),nt}}function serializeImage(tt){return typeof HTMLImageElement<"u"&&tt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&tt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&tt instanceof ImageBitmap?ImageUtils.getDataURL(tt):tt.data?{data:Array.from(tt.data),width:tt.width,height:tt.height,type:tt.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let textureId=0;class Texture extends EventDispatcher{constructor(_e=Texture.DEFAULT_IMAGE,rt=Texture.DEFAULT_MAPPING,nt=ClampToEdgeWrapping,it=ClampToEdgeWrapping,st=LinearFilter,ot=LinearMipmapLinearFilter,lt=RGBAFormat,at=UnsignedByteType,ct=Texture.DEFAULT_ANISOTROPY,ut=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:textureId++}),this.uuid=generateUUID$1(),this.name="",this.source=new Source(_e),this.mipmaps=[],this.mapping=rt,this.channel=0,this.wrapS=nt,this.wrapT=it,this.magFilter=st,this.minFilter=ot,this.anisotropy=ct,this.format=lt,this.internalFormat=null,this.type=at,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof ut=="string"?this.colorSpace=ut:(warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=ut===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(_e=null){this.source.data=_e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_e){return this.name=_e.name,this.source=_e.source,this.mipmaps=_e.mipmaps.slice(0),this.mapping=_e.mapping,this.channel=_e.channel,this.wrapS=_e.wrapS,this.wrapT=_e.wrapT,this.magFilter=_e.magFilter,this.minFilter=_e.minFilter,this.anisotropy=_e.anisotropy,this.format=_e.format,this.internalFormat=_e.internalFormat,this.type=_e.type,this.offset.copy(_e.offset),this.repeat.copy(_e.repeat),this.center.copy(_e.center),this.rotation=_e.rotation,this.matrixAutoUpdate=_e.matrixAutoUpdate,this.matrix.copy(_e.matrix),this.generateMipmaps=_e.generateMipmaps,this.premultiplyAlpha=_e.premultiplyAlpha,this.flipY=_e.flipY,this.unpackAlignment=_e.unpackAlignment,this.colorSpace=_e.colorSpace,this.userData=JSON.parse(JSON.stringify(_e.userData)),this.needsUpdate=!0,this}toJSON(_e){const rt=_e===void 0||typeof _e=="string";if(!rt&&_e.textures[this.uuid]!==void 0)return _e.textures[this.uuid];const nt={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(nt.userData=this.userData),rt||(_e.textures[this.uuid]=nt),nt}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_e){if(this.mapping!==UVMapping)return _e;if(_e.applyMatrix3(this.matrix),_e.x<0||_e.x>1)switch(this.wrapS){case RepeatWrapping:_e.x=_e.x-Math.floor(_e.x);break;case ClampToEdgeWrapping:_e.x=_e.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_e.x)%2)===1?_e.x=Math.ceil(_e.x)-_e.x:_e.x=_e.x-Math.floor(_e.x);break}if(_e.y<0||_e.y>1)switch(this.wrapT){case RepeatWrapping:_e.y=_e.y-Math.floor(_e.y);break;case ClampToEdgeWrapping:_e.y=_e.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_e.y)%2)===1?_e.y=Math.ceil(_e.y)-_e.y:_e.y=_e.y-Math.floor(_e.y);break}return this.flipY&&(_e.y=1-_e.y),_e}set needsUpdate(_e){_e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set encoding(_e){warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=_e===sRGBEncoding?SRGBColorSpace:NoColorSpace}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_e=0,rt=0,nt=0,it=1){Vector4.prototype.isVector4=!0,this.x=_e,this.y=rt,this.z=nt,this.w=it}get width(){return this.z}set width(_e){this.z=_e}get height(){return this.w}set height(_e){this.w=_e}set(_e,rt,nt,it){return this.x=_e,this.y=rt,this.z=nt,this.w=it,this}setScalar(_e){return this.x=_e,this.y=_e,this.z=_e,this.w=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setZ(_e){return this.z=_e,this}setW(_e){return this.w=_e,this}setComponent(_e,rt){switch(_e){case 0:this.x=rt;break;case 1:this.y=rt;break;case 2:this.z=rt;break;case 3:this.w=rt;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_e){return this.x=_e.x,this.y=_e.y,this.z=_e.z,this.w=_e.w!==void 0?_e.w:1,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this.z+=_e.z,this.w+=_e.w,this}addScalar(_e){return this.x+=_e,this.y+=_e,this.z+=_e,this.w+=_e,this}addVectors(_e,rt){return this.x=_e.x+rt.x,this.y=_e.y+rt.y,this.z=_e.z+rt.z,this.w=_e.w+rt.w,this}addScaledVector(_e,rt){return this.x+=_e.x*rt,this.y+=_e.y*rt,this.z+=_e.z*rt,this.w+=_e.w*rt,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this.z-=_e.z,this.w-=_e.w,this}subScalar(_e){return this.x-=_e,this.y-=_e,this.z-=_e,this.w-=_e,this}subVectors(_e,rt){return this.x=_e.x-rt.x,this.y=_e.y-rt.y,this.z=_e.z-rt.z,this.w=_e.w-rt.w,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this.z*=_e.z,this.w*=_e.w,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this.z*=_e,this.w*=_e,this}applyMatrix4(_e){const rt=this.x,nt=this.y,it=this.z,st=this.w,ot=_e.elements;return this.x=ot[0]*rt+ot[4]*nt+ot[8]*it+ot[12]*st,this.y=ot[1]*rt+ot[5]*nt+ot[9]*it+ot[13]*st,this.z=ot[2]*rt+ot[6]*nt+ot[10]*it+ot[14]*st,this.w=ot[3]*rt+ot[7]*nt+ot[11]*it+ot[15]*st,this}divideScalar(_e){return this.multiplyScalar(1/_e)}setAxisAngleFromQuaternion(_e){this.w=2*Math.acos(_e.w);const rt=Math.sqrt(1-_e.w*_e.w);return rt<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_e.x/rt,this.y=_e.y/rt,this.z=_e.z/rt),this}setAxisAngleFromRotationMatrix(_e){let rt,nt,it,st;const at=_e.elements,ct=at[0],ut=at[4],ht=at[8],dt=at[1],ft=at[5],pt=at[9],mt=at[2],gt=at[6],vt=at[10];if(Math.abs(ut-dt)<.01&&Math.abs(ht-mt)<.01&&Math.abs(pt-gt)<.01){if(Math.abs(ut+dt)<.1&&Math.abs(ht+mt)<.1&&Math.abs(pt+gt)<.1&&Math.abs(ct+ft+vt-3)<.1)return this.set(1,0,0,0),this;rt=Math.PI;const yt=(ct+1)/2,xt=(ft+1)/2,_t=(vt+1)/2,Et=(ut+dt)/4,bt=(ht+mt)/4,wt=(pt+gt)/4;return yt>xt&&yt>_t?yt<.01?(nt=0,it=.707106781,st=.707106781):(nt=Math.sqrt(yt),it=Et/nt,st=bt/nt):xt>_t?xt<.01?(nt=.707106781,it=0,st=.707106781):(it=Math.sqrt(xt),nt=Et/it,st=wt/it):_t<.01?(nt=.707106781,it=.707106781,st=0):(st=Math.sqrt(_t),nt=bt/st,it=wt/st),this.set(nt,it,st,rt),this}let At=Math.sqrt((gt-pt)*(gt-pt)+(ht-mt)*(ht-mt)+(dt-ut)*(dt-ut));return Math.abs(At)<.001&&(At=1),this.x=(gt-pt)/At,this.y=(ht-mt)/At,this.z=(dt-ut)/At,this.w=Math.acos((ct+ft+vt-1)/2),this}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this.z=Math.min(this.z,_e.z),this.w=Math.min(this.w,_e.w),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this.z=Math.max(this.z,_e.z),this.w=Math.max(this.w,_e.w),this}clamp(_e,rt){return this.x=Math.max(_e.x,Math.min(rt.x,this.x)),this.y=Math.max(_e.y,Math.min(rt.y,this.y)),this.z=Math.max(_e.z,Math.min(rt.z,this.z)),this.w=Math.max(_e.w,Math.min(rt.w,this.w)),this}clampScalar(_e,rt){return this.x=Math.max(_e,Math.min(rt,this.x)),this.y=Math.max(_e,Math.min(rt,this.y)),this.z=Math.max(_e,Math.min(rt,this.z)),this.w=Math.max(_e,Math.min(rt,this.w)),this}clampLength(_e,rt){const nt=this.length();return this.divideScalar(nt||1).multiplyScalar(Math.max(_e,Math.min(rt,nt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_e){return this.x*_e.x+this.y*_e.y+this.z*_e.z+this.w*_e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,rt){return this.x+=(_e.x-this.x)*rt,this.y+=(_e.y-this.y)*rt,this.z+=(_e.z-this.z)*rt,this.w+=(_e.w-this.w)*rt,this}lerpVectors(_e,rt,nt){return this.x=_e.x+(rt.x-_e.x)*nt,this.y=_e.y+(rt.y-_e.y)*nt,this.z=_e.z+(rt.z-_e.z)*nt,this.w=_e.w+(rt.w-_e.w)*nt,this}equals(_e){return _e.x===this.x&&_e.y===this.y&&_e.z===this.z&&_e.w===this.w}fromArray(_e,rt=0){return this.x=_e[rt],this.y=_e[rt+1],this.z=_e[rt+2],this.w=_e[rt+3],this}toArray(_e=[],rt=0){return _e[rt]=this.x,_e[rt+1]=this.y,_e[rt+2]=this.z,_e[rt+3]=this.w,_e}fromBufferAttribute(_e,rt){return this.x=_e.getX(rt),this.y=_e.getY(rt),this.z=_e.getZ(rt),this.w=_e.getW(rt),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class WebGLRenderTarget extends EventDispatcher{constructor(_e=1,rt=1,nt={}){super(),this.isWebGLRenderTarget=!0,this.width=_e,this.height=rt,this.depth=1,this.scissor=new Vector4(0,0,_e,rt),this.scissorTest=!1,this.viewport=new Vector4(0,0,_e,rt);const it={width:_e,height:rt,depth:1};nt.encoding!==void 0&&(warnOnce("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),nt.colorSpace=nt.encoding===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.texture=new Texture(it,nt.mapping,nt.wrapS,nt.wrapT,nt.magFilter,nt.minFilter,nt.format,nt.type,nt.anisotropy,nt.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=nt.generateMipmaps!==void 0?nt.generateMipmaps:!1,this.texture.internalFormat=nt.internalFormat!==void 0?nt.internalFormat:null,this.texture.minFilter=nt.minFilter!==void 0?nt.minFilter:LinearFilter,this.depthBuffer=nt.depthBuffer!==void 0?nt.depthBuffer:!0,this.stencilBuffer=nt.stencilBuffer!==void 0?nt.stencilBuffer:!1,this.depthTexture=nt.depthTexture!==void 0?nt.depthTexture:null,this.samples=nt.samples!==void 0?nt.samples:0}setSize(_e,rt,nt=1){(this.width!==_e||this.height!==rt||this.depth!==nt)&&(this.width=_e,this.height=rt,this.depth=nt,this.texture.image.width=_e,this.texture.image.height=rt,this.texture.image.depth=nt,this.dispose()),this.viewport.set(0,0,_e,rt),this.scissor.set(0,0,_e,rt)}clone(){return new this.constructor().copy(this)}copy(_e){this.width=_e.width,this.height=_e.height,this.depth=_e.depth,this.scissor.copy(_e.scissor),this.scissorTest=_e.scissorTest,this.viewport.copy(_e.viewport),this.texture=_e.texture.clone(),this.texture.isRenderTargetTexture=!0;const rt=Object.assign({},_e.texture.image);return this.texture.source=new Source(rt),this.depthBuffer=_e.depthBuffer,this.stencilBuffer=_e.stencilBuffer,_e.depthTexture!==null&&(this.depthTexture=_e.depthTexture.clone()),this.samples=_e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class DataArrayTexture extends Texture{constructor(_e=null,rt=1,nt=1,it=1){super(null),this.isDataArrayTexture=!0,this.image={data:_e,width:rt,height:nt,depth:it},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(_e=1,rt=1,nt=1){super(_e,rt),this.isWebGLArrayRenderTarget=!0,this.depth=nt,this.texture=new DataArrayTexture(null,_e,rt,nt),this.texture.isRenderTargetTexture=!0}}let Data3DTexture$1=class extends Texture{constructor(_e=null,rt=1,nt=1,it=1){super(null),this.isData3DTexture=!0,this.image={data:_e,width:rt,height:nt,depth:it},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(_e=1,rt=1,nt=1){super(_e,rt),this.isWebGL3DRenderTarget=!0,this.depth=nt,this.texture=new Data3DTexture$1(null,_e,rt,nt),this.texture.isRenderTargetTexture=!0}}class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(_e=1,rt=1,nt=1,it={}){super(_e,rt,it),this.isWebGLMultipleRenderTargets=!0;const st=this.texture;this.texture=[];for(let ot=0;ot<nt;ot++)this.texture[ot]=st.clone(),this.texture[ot].isRenderTargetTexture=!0}setSize(_e,rt,nt=1){if(this.width!==_e||this.height!==rt||this.depth!==nt){this.width=_e,this.height=rt,this.depth=nt;for(let it=0,st=this.texture.length;it<st;it++)this.texture[it].image.width=_e,this.texture[it].image.height=rt,this.texture[it].image.depth=nt;this.dispose()}return this.viewport.set(0,0,_e,rt),this.scissor.set(0,0,_e,rt),this}copy(_e){this.dispose(),this.width=_e.width,this.height=_e.height,this.depth=_e.depth,this.scissor.copy(_e.scissor),this.scissorTest=_e.scissorTest,this.viewport.copy(_e.viewport),this.depthBuffer=_e.depthBuffer,this.stencilBuffer=_e.stencilBuffer,_e.depthTexture!==null&&(this.depthTexture=_e.depthTexture.clone()),this.texture.length=0;for(let rt=0,nt=_e.texture.length;rt<nt;rt++)this.texture[rt]=_e.texture[rt].clone(),this.texture[rt].isRenderTargetTexture=!0;return this}}class Quaternion{constructor(_e=0,rt=0,nt=0,it=1){this.isQuaternion=!0,this._x=_e,this._y=rt,this._z=nt,this._w=it}static slerpFlat(_e,rt,nt,it,st,ot,lt){let at=nt[it+0],ct=nt[it+1],ut=nt[it+2],ht=nt[it+3];const dt=st[ot+0],ft=st[ot+1],pt=st[ot+2],mt=st[ot+3];if(lt===0){_e[rt+0]=at,_e[rt+1]=ct,_e[rt+2]=ut,_e[rt+3]=ht;return}if(lt===1){_e[rt+0]=dt,_e[rt+1]=ft,_e[rt+2]=pt,_e[rt+3]=mt;return}if(ht!==mt||at!==dt||ct!==ft||ut!==pt){let gt=1-lt;const vt=at*dt+ct*ft+ut*pt+ht*mt,At=vt>=0?1:-1,yt=1-vt*vt;if(yt>Number.EPSILON){const _t=Math.sqrt(yt),Et=Math.atan2(_t,vt*At);gt=Math.sin(gt*Et)/_t,lt=Math.sin(lt*Et)/_t}const xt=lt*At;if(at=at*gt+dt*xt,ct=ct*gt+ft*xt,ut=ut*gt+pt*xt,ht=ht*gt+mt*xt,gt===1-lt){const _t=1/Math.sqrt(at*at+ct*ct+ut*ut+ht*ht);at*=_t,ct*=_t,ut*=_t,ht*=_t}}_e[rt]=at,_e[rt+1]=ct,_e[rt+2]=ut,_e[rt+3]=ht}static multiplyQuaternionsFlat(_e,rt,nt,it,st,ot){const lt=nt[it],at=nt[it+1],ct=nt[it+2],ut=nt[it+3],ht=st[ot],dt=st[ot+1],ft=st[ot+2],pt=st[ot+3];return _e[rt]=lt*pt+ut*ht+at*ft-ct*dt,_e[rt+1]=at*pt+ut*dt+ct*ht-lt*ft,_e[rt+2]=ct*pt+ut*ft+lt*dt-at*ht,_e[rt+3]=ut*pt-lt*ht-at*dt-ct*ft,_e}get x(){return this._x}set x(_e){this._x=_e,this._onChangeCallback()}get y(){return this._y}set y(_e){this._y=_e,this._onChangeCallback()}get z(){return this._z}set z(_e){this._z=_e,this._onChangeCallback()}get w(){return this._w}set w(_e){this._w=_e,this._onChangeCallback()}set(_e,rt,nt,it){return this._x=_e,this._y=rt,this._z=nt,this._w=it,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_e){return this._x=_e.x,this._y=_e.y,this._z=_e.z,this._w=_e.w,this._onChangeCallback(),this}setFromEuler(_e,rt){const nt=_e._x,it=_e._y,st=_e._z,ot=_e._order,lt=Math.cos,at=Math.sin,ct=lt(nt/2),ut=lt(it/2),ht=lt(st/2),dt=at(nt/2),ft=at(it/2),pt=at(st/2);switch(ot){case"XYZ":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"YXZ":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;case"ZXY":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"ZYX":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;case"YZX":this._x=dt*ut*ht+ct*ft*pt,this._y=ct*ft*ht+dt*ut*pt,this._z=ct*ut*pt-dt*ft*ht,this._w=ct*ut*ht-dt*ft*pt;break;case"XZY":this._x=dt*ut*ht-ct*ft*pt,this._y=ct*ft*ht-dt*ut*pt,this._z=ct*ut*pt+dt*ft*ht,this._w=ct*ut*ht+dt*ft*pt;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+ot)}return rt!==!1&&this._onChangeCallback(),this}setFromAxisAngle(_e,rt){const nt=rt/2,it=Math.sin(nt);return this._x=_e.x*it,this._y=_e.y*it,this._z=_e.z*it,this._w=Math.cos(nt),this._onChangeCallback(),this}setFromRotationMatrix(_e){const rt=_e.elements,nt=rt[0],it=rt[4],st=rt[8],ot=rt[1],lt=rt[5],at=rt[9],ct=rt[2],ut=rt[6],ht=rt[10],dt=nt+lt+ht;if(dt>0){const ft=.5/Math.sqrt(dt+1);this._w=.25/ft,this._x=(ut-at)*ft,this._y=(st-ct)*ft,this._z=(ot-it)*ft}else if(nt>lt&&nt>ht){const ft=2*Math.sqrt(1+nt-lt-ht);this._w=(ut-at)/ft,this._x=.25*ft,this._y=(it+ot)/ft,this._z=(st+ct)/ft}else if(lt>ht){const ft=2*Math.sqrt(1+lt-nt-ht);this._w=(st-ct)/ft,this._x=(it+ot)/ft,this._y=.25*ft,this._z=(at+ut)/ft}else{const ft=2*Math.sqrt(1+ht-nt-lt);this._w=(ot-it)/ft,this._x=(st+ct)/ft,this._y=(at+ut)/ft,this._z=.25*ft}return this._onChangeCallback(),this}setFromUnitVectors(_e,rt){let nt=_e.dot(rt)+1;return nt<Number.EPSILON?(nt=0,Math.abs(_e.x)>Math.abs(_e.z)?(this._x=-_e.y,this._y=_e.x,this._z=0,this._w=nt):(this._x=0,this._y=-_e.z,this._z=_e.y,this._w=nt)):(this._x=_e.y*rt.z-_e.z*rt.y,this._y=_e.z*rt.x-_e.x*rt.z,this._z=_e.x*rt.y-_e.y*rt.x,this._w=nt),this.normalize()}angleTo(_e){return 2*Math.acos(Math.abs(clamp$2(this.dot(_e),-1,1)))}rotateTowards(_e,rt){const nt=this.angleTo(_e);if(nt===0)return this;const it=Math.min(1,rt/nt);return this.slerp(_e,it),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_e){return this._x*_e._x+this._y*_e._y+this._z*_e._z+this._w*_e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _e=this.length();return _e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_e=1/_e,this._x=this._x*_e,this._y=this._y*_e,this._z=this._z*_e,this._w=this._w*_e),this._onChangeCallback(),this}multiply(_e){return this.multiplyQuaternions(this,_e)}premultiply(_e){return this.multiplyQuaternions(_e,this)}multiplyQuaternions(_e,rt){const nt=_e._x,it=_e._y,st=_e._z,ot=_e._w,lt=rt._x,at=rt._y,ct=rt._z,ut=rt._w;return this._x=nt*ut+ot*lt+it*ct-st*at,this._y=it*ut+ot*at+st*lt-nt*ct,this._z=st*ut+ot*ct+nt*at-it*lt,this._w=ot*ut-nt*lt-it*at-st*ct,this._onChangeCallback(),this}slerp(_e,rt){if(rt===0)return this;if(rt===1)return this.copy(_e);const nt=this._x,it=this._y,st=this._z,ot=this._w;let lt=ot*_e._w+nt*_e._x+it*_e._y+st*_e._z;if(lt<0?(this._w=-_e._w,this._x=-_e._x,this._y=-_e._y,this._z=-_e._z,lt=-lt):this.copy(_e),lt>=1)return this._w=ot,this._x=nt,this._y=it,this._z=st,this;const at=1-lt*lt;if(at<=Number.EPSILON){const ft=1-rt;return this._w=ft*ot+rt*this._w,this._x=ft*nt+rt*this._x,this._y=ft*it+rt*this._y,this._z=ft*st+rt*this._z,this.normalize(),this._onChangeCallback(),this}const ct=Math.sqrt(at),ut=Math.atan2(ct,lt),ht=Math.sin((1-rt)*ut)/ct,dt=Math.sin(rt*ut)/ct;return this._w=ot*ht+this._w*dt,this._x=nt*ht+this._x*dt,this._y=it*ht+this._y*dt,this._z=st*ht+this._z*dt,this._onChangeCallback(),this}slerpQuaternions(_e,rt,nt){return this.copy(_e).slerp(rt,nt)}random(){const _e=Math.random(),rt=Math.sqrt(1-_e),nt=Math.sqrt(_e),it=2*Math.PI*Math.random(),st=2*Math.PI*Math.random();return this.set(rt*Math.cos(it),nt*Math.sin(st),nt*Math.cos(st),rt*Math.sin(it))}equals(_e){return _e._x===this._x&&_e._y===this._y&&_e._z===this._z&&_e._w===this._w}fromArray(_e,rt=0){return this._x=_e[rt],this._y=_e[rt+1],this._z=_e[rt+2],this._w=_e[rt+3],this._onChangeCallback(),this}toArray(_e=[],rt=0){return _e[rt]=this._x,_e[rt+1]=this._y,_e[rt+2]=this._z,_e[rt+3]=this._w,_e}fromBufferAttribute(_e,rt){return this._x=_e.getX(rt),this._y=_e.getY(rt),this._z=_e.getZ(rt),this._w=_e.getW(rt),this}toJSON(){return this.toArray()}_onChange(_e){return this._onChangeCallback=_e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_e=0,rt=0,nt=0){Vector3.prototype.isVector3=!0,this.x=_e,this.y=rt,this.z=nt}set(_e,rt,nt){return nt===void 0&&(nt=this.z),this.x=_e,this.y=rt,this.z=nt,this}setScalar(_e){return this.x=_e,this.y=_e,this.z=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setZ(_e){return this.z=_e,this}setComponent(_e,rt){switch(_e){case 0:this.x=rt;break;case 1:this.y=rt;break;case 2:this.z=rt;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_e){return this.x=_e.x,this.y=_e.y,this.z=_e.z,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this.z+=_e.z,this}addScalar(_e){return this.x+=_e,this.y+=_e,this.z+=_e,this}addVectors(_e,rt){return this.x=_e.x+rt.x,this.y=_e.y+rt.y,this.z=_e.z+rt.z,this}addScaledVector(_e,rt){return this.x+=_e.x*rt,this.y+=_e.y*rt,this.z+=_e.z*rt,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this.z-=_e.z,this}subScalar(_e){return this.x-=_e,this.y-=_e,this.z-=_e,this}subVectors(_e,rt){return this.x=_e.x-rt.x,this.y=_e.y-rt.y,this.z=_e.z-rt.z,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this.z*=_e.z,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this.z*=_e,this}multiplyVectors(_e,rt){return this.x=_e.x*rt.x,this.y=_e.y*rt.y,this.z=_e.z*rt.z,this}applyEuler(_e){return this.applyQuaternion(_quaternion$4.setFromEuler(_e))}applyAxisAngle(_e,rt){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_e,rt))}applyMatrix3(_e){const rt=this.x,nt=this.y,it=this.z,st=_e.elements;return this.x=st[0]*rt+st[3]*nt+st[6]*it,this.y=st[1]*rt+st[4]*nt+st[7]*it,this.z=st[2]*rt+st[5]*nt+st[8]*it,this}applyNormalMatrix(_e){return this.applyMatrix3(_e).normalize()}applyMatrix4(_e){const rt=this.x,nt=this.y,it=this.z,st=_e.elements,ot=1/(st[3]*rt+st[7]*nt+st[11]*it+st[15]);return this.x=(st[0]*rt+st[4]*nt+st[8]*it+st[12])*ot,this.y=(st[1]*rt+st[5]*nt+st[9]*it+st[13])*ot,this.z=(st[2]*rt+st[6]*nt+st[10]*it+st[14])*ot,this}applyQuaternion(_e){const rt=this.x,nt=this.y,it=this.z,st=_e.x,ot=_e.y,lt=_e.z,at=_e.w,ct=at*rt+ot*it-lt*nt,ut=at*nt+lt*rt-st*it,ht=at*it+st*nt-ot*rt,dt=-st*rt-ot*nt-lt*it;return this.x=ct*at+dt*-st+ut*-lt-ht*-ot,this.y=ut*at+dt*-ot+ht*-st-ct*-lt,this.z=ht*at+dt*-lt+ct*-ot-ut*-st,this}project(_e){return this.applyMatrix4(_e.matrixWorldInverse).applyMatrix4(_e.projectionMatrix)}unproject(_e){return this.applyMatrix4(_e.projectionMatrixInverse).applyMatrix4(_e.matrixWorld)}transformDirection(_e){const rt=this.x,nt=this.y,it=this.z,st=_e.elements;return this.x=st[0]*rt+st[4]*nt+st[8]*it,this.y=st[1]*rt+st[5]*nt+st[9]*it,this.z=st[2]*rt+st[6]*nt+st[10]*it,this.normalize()}divide(_e){return this.x/=_e.x,this.y/=_e.y,this.z/=_e.z,this}divideScalar(_e){return this.multiplyScalar(1/_e)}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this.z=Math.min(this.z,_e.z),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this.z=Math.max(this.z,_e.z),this}clamp(_e,rt){return this.x=Math.max(_e.x,Math.min(rt.x,this.x)),this.y=Math.max(_e.y,Math.min(rt.y,this.y)),this.z=Math.max(_e.z,Math.min(rt.z,this.z)),this}clampScalar(_e,rt){return this.x=Math.max(_e,Math.min(rt,this.x)),this.y=Math.max(_e,Math.min(rt,this.y)),this.z=Math.max(_e,Math.min(rt,this.z)),this}clampLength(_e,rt){const nt=this.length();return this.divideScalar(nt||1).multiplyScalar(Math.max(_e,Math.min(rt,nt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_e){return this.x*_e.x+this.y*_e.y+this.z*_e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,rt){return this.x+=(_e.x-this.x)*rt,this.y+=(_e.y-this.y)*rt,this.z+=(_e.z-this.z)*rt,this}lerpVectors(_e,rt,nt){return this.x=_e.x+(rt.x-_e.x)*nt,this.y=_e.y+(rt.y-_e.y)*nt,this.z=_e.z+(rt.z-_e.z)*nt,this}cross(_e){return this.crossVectors(this,_e)}crossVectors(_e,rt){const nt=_e.x,it=_e.y,st=_e.z,ot=rt.x,lt=rt.y,at=rt.z;return this.x=it*at-st*lt,this.y=st*ot-nt*at,this.z=nt*lt-it*ot,this}projectOnVector(_e){const rt=_e.lengthSq();if(rt===0)return this.set(0,0,0);const nt=_e.dot(this)/rt;return this.copy(_e).multiplyScalar(nt)}projectOnPlane(_e){return _vector$b.copy(this).projectOnVector(_e),this.sub(_vector$b)}reflect(_e){return this.sub(_vector$b.copy(_e).multiplyScalar(2*this.dot(_e)))}angleTo(_e){const rt=Math.sqrt(this.lengthSq()*_e.lengthSq());if(rt===0)return Math.PI/2;const nt=this.dot(_e)/rt;return Math.acos(clamp$2(nt,-1,1))}distanceTo(_e){return Math.sqrt(this.distanceToSquared(_e))}distanceToSquared(_e){const rt=this.x-_e.x,nt=this.y-_e.y,it=this.z-_e.z;return rt*rt+nt*nt+it*it}manhattanDistanceTo(_e){return Math.abs(this.x-_e.x)+Math.abs(this.y-_e.y)+Math.abs(this.z-_e.z)}setFromSpherical(_e){return this.setFromSphericalCoords(_e.radius,_e.phi,_e.theta)}setFromSphericalCoords(_e,rt,nt){const it=Math.sin(rt)*_e;return this.x=it*Math.sin(nt),this.y=Math.cos(rt)*_e,this.z=it*Math.cos(nt),this}setFromCylindrical(_e){return this.setFromCylindricalCoords(_e.radius,_e.theta,_e.y)}setFromCylindricalCoords(_e,rt,nt){return this.x=_e*Math.sin(rt),this.y=nt,this.z=_e*Math.cos(rt),this}setFromMatrixPosition(_e){const rt=_e.elements;return this.x=rt[12],this.y=rt[13],this.z=rt[14],this}setFromMatrixScale(_e){const rt=this.setFromMatrixColumn(_e,0).length(),nt=this.setFromMatrixColumn(_e,1).length(),it=this.setFromMatrixColumn(_e,2).length();return this.x=rt,this.y=nt,this.z=it,this}setFromMatrixColumn(_e,rt){return this.fromArray(_e.elements,rt*4)}setFromMatrix3Column(_e,rt){return this.fromArray(_e.elements,rt*3)}setFromEuler(_e){return this.x=_e._x,this.y=_e._y,this.z=_e._z,this}setFromColor(_e){return this.x=_e.r,this.y=_e.g,this.z=_e.b,this}equals(_e){return _e.x===this.x&&_e.y===this.y&&_e.z===this.z}fromArray(_e,rt=0){return this.x=_e[rt],this.y=_e[rt+1],this.z=_e[rt+2],this}toArray(_e=[],rt=0){return _e[rt]=this.x,_e[rt+1]=this.y,_e[rt+2]=this.z,_e}fromBufferAttribute(_e,rt){return this.x=_e.getX(rt),this.y=_e.getY(rt),this.z=_e.getZ(rt),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _e=(Math.random()-.5)*2,rt=Math.random()*Math.PI*2,nt=Math.sqrt(1-_e**2);return this.x=nt*Math.cos(rt),this.y=nt*Math.sin(rt),this.z=_e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$b=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(_e=new Vector3(1/0,1/0,1/0),rt=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_e,this.max=rt}set(_e,rt){return this.min.copy(_e),this.max.copy(rt),this}setFromArray(_e){this.makeEmpty();for(let rt=0,nt=_e.length;rt<nt;rt+=3)this.expandByPoint(_vector$a.fromArray(_e,rt));return this}setFromBufferAttribute(_e){this.makeEmpty();for(let rt=0,nt=_e.count;rt<nt;rt++)this.expandByPoint(_vector$a.fromBufferAttribute(_e,rt));return this}setFromPoints(_e){this.makeEmpty();for(let rt=0,nt=_e.length;rt<nt;rt++)this.expandByPoint(_e[rt]);return this}setFromCenterAndSize(_e,rt){const nt=_vector$a.copy(rt).multiplyScalar(.5);return this.min.copy(_e).sub(nt),this.max.copy(_e).add(nt),this}setFromObject(_e,rt=!1){return this.makeEmpty(),this.expandByObject(_e,rt)}clone(){return new this.constructor().copy(this)}copy(_e){return this.min.copy(_e.min),this.max.copy(_e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_e){return this.isEmpty()?_e.set(0,0,0):_e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_e){return this.isEmpty()?_e.set(0,0,0):_e.subVectors(this.max,this.min)}expandByPoint(_e){return this.min.min(_e),this.max.max(_e),this}expandByVector(_e){return this.min.sub(_e),this.max.add(_e),this}expandByScalar(_e){return this.min.addScalar(-_e),this.max.addScalar(_e),this}expandByObject(_e,rt=!1){if(_e.updateWorldMatrix(!1,!1),_e.boundingBox!==void 0)_e.boundingBox===null&&_e.computeBoundingBox(),_box$3.copy(_e.boundingBox),_box$3.applyMatrix4(_e.matrixWorld),this.union(_box$3);else{const it=_e.geometry;if(it!==void 0)if(rt&&it.attributes!==void 0&&it.attributes.position!==void 0){const st=it.attributes.position;for(let ot=0,lt=st.count;ot<lt;ot++)_vector$a.fromBufferAttribute(st,ot).applyMatrix4(_e.matrixWorld),this.expandByPoint(_vector$a)}else it.boundingBox===null&&it.computeBoundingBox(),_box$3.copy(it.boundingBox),_box$3.applyMatrix4(_e.matrixWorld),this.union(_box$3)}const nt=_e.children;for(let it=0,st=nt.length;it<st;it++)this.expandByObject(nt[it],rt);return this}containsPoint(_e){return!(_e.x<this.min.x||_e.x>this.max.x||_e.y<this.min.y||_e.y>this.max.y||_e.z<this.min.z||_e.z>this.max.z)}containsBox(_e){return this.min.x<=_e.min.x&&_e.max.x<=this.max.x&&this.min.y<=_e.min.y&&_e.max.y<=this.max.y&&this.min.z<=_e.min.z&&_e.max.z<=this.max.z}getParameter(_e,rt){return rt.set((_e.x-this.min.x)/(this.max.x-this.min.x),(_e.y-this.min.y)/(this.max.y-this.min.y),(_e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_e){return!(_e.max.x<this.min.x||_e.min.x>this.max.x||_e.max.y<this.min.y||_e.min.y>this.max.y||_e.max.z<this.min.z||_e.min.z>this.max.z)}intersectsSphere(_e){return this.clampPoint(_e.center,_vector$a),_vector$a.distanceToSquared(_e.center)<=_e.radius*_e.radius}intersectsPlane(_e){let rt,nt;return _e.normal.x>0?(rt=_e.normal.x*this.min.x,nt=_e.normal.x*this.max.x):(rt=_e.normal.x*this.max.x,nt=_e.normal.x*this.min.x),_e.normal.y>0?(rt+=_e.normal.y*this.min.y,nt+=_e.normal.y*this.max.y):(rt+=_e.normal.y*this.max.y,nt+=_e.normal.y*this.min.y),_e.normal.z>0?(rt+=_e.normal.z*this.min.z,nt+=_e.normal.z*this.max.z):(rt+=_e.normal.z*this.max.z,nt+=_e.normal.z*this.min.z),rt<=-_e.constant&&nt>=-_e.constant}intersectsTriangle(_e){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(_e.a,_center),_v1$7.subVectors(_e.b,_center),_v2$4.subVectors(_e.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let rt=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(rt,_v0$2,_v1$7,_v2$4,_extents)||(rt=[1,0,0,0,1,0,0,0,1],!satForAxes(rt,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),rt=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(rt,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(_e,rt){return rt.copy(_e).clamp(this.min,this.max)}distanceToPoint(_e){return this.clampPoint(_e,_vector$a).distanceTo(_e)}getBoundingSphere(_e){return this.isEmpty()?_e.makeEmpty():(this.getCenter(_e.center),_e.radius=this.getSize(_vector$a).length()*.5),_e}intersect(_e){return this.min.max(_e.min),this.max.min(_e.max),this.isEmpty()&&this.makeEmpty(),this}union(_e){return this.min.min(_e.min),this.max.max(_e.max),this}applyMatrix4(_e){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_e),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_e),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_e),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_e),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_e),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_e),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_e),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_e),this.setFromPoints(_points),this)}translate(_e){return this.min.add(_e),this.max.add(_e),this}equals(_e){return _e.min.equals(this.min)&&_e.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$a=new Vector3,_box$3=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(tt,_e,rt,nt,it){for(let st=0,ot=tt.length-3;st<=ot;st+=3){_testAxis.fromArray(tt,st);const lt=it.x*Math.abs(_testAxis.x)+it.y*Math.abs(_testAxis.y)+it.z*Math.abs(_testAxis.z),at=_e.dot(_testAxis),ct=rt.dot(_testAxis),ut=nt.dot(_testAxis);if(Math.max(-Math.max(at,ct,ut),Math.min(at,ct,ut))>lt)return!1}return!0}const _box$2=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(_e=new Vector3,rt=-1){this.center=_e,this.radius=rt}set(_e,rt){return this.center.copy(_e),this.radius=rt,this}setFromPoints(_e,rt){const nt=this.center;rt!==void 0?nt.copy(rt):_box$2.setFromPoints(_e).getCenter(nt);let it=0;for(let st=0,ot=_e.length;st<ot;st++)it=Math.max(it,nt.distanceToSquared(_e[st]));return this.radius=Math.sqrt(it),this}copy(_e){return this.center.copy(_e.center),this.radius=_e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_e){return _e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_e){return _e.distanceTo(this.center)-this.radius}intersectsSphere(_e){const rt=this.radius+_e.radius;return _e.center.distanceToSquared(this.center)<=rt*rt}intersectsBox(_e){return _e.intersectsSphere(this)}intersectsPlane(_e){return Math.abs(_e.distanceToPoint(this.center))<=this.radius}clampPoint(_e,rt){const nt=this.center.distanceToSquared(_e);return rt.copy(_e),nt>this.radius*this.radius&&(rt.sub(this.center).normalize(),rt.multiplyScalar(this.radius).add(this.center)),rt}getBoundingBox(_e){return this.isEmpty()?(_e.makeEmpty(),_e):(_e.set(this.center,this.center),_e.expandByScalar(this.radius),_e)}applyMatrix4(_e){return this.center.applyMatrix4(_e),this.radius=this.radius*_e.getMaxScaleOnAxis(),this}translate(_e){return this.center.add(_e),this}expandByPoint(_e){if(this.isEmpty())return this.center.copy(_e),this.radius=0,this;_v1$6.subVectors(_e,this.center);const rt=_v1$6.lengthSq();if(rt>this.radius*this.radius){const nt=Math.sqrt(rt),it=(nt-this.radius)*.5;this.center.addScaledVector(_v1$6,it/nt),this.radius+=it}return this}union(_e){return _e.isEmpty()?this:this.isEmpty()?(this.copy(_e),this):(this.center.equals(_e.center)===!0?this.radius=Math.max(this.radius,_e.radius):(_v2$3.subVectors(_e.center,this.center).setLength(_e.radius),this.expandByPoint(_v1$6.copy(_e.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_e.center).sub(_v2$3))),this)}equals(_e){return _e.center.equals(this.center)&&_e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$9=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;let Ray$1=class{constructor(_e=new Vector3,rt=new Vector3(0,0,-1)){this.origin=_e,this.direction=rt}set(_e,rt){return this.origin.copy(_e),this.direction.copy(rt),this}copy(_e){return this.origin.copy(_e.origin),this.direction.copy(_e.direction),this}at(_e,rt){return rt.copy(this.origin).addScaledVector(this.direction,_e)}lookAt(_e){return this.direction.copy(_e).sub(this.origin).normalize(),this}recast(_e){return this.origin.copy(this.at(_e,_vector$9)),this}closestPointToPoint(_e,rt){rt.subVectors(_e,this.origin);const nt=rt.dot(this.direction);return nt<0?rt.copy(this.origin):rt.copy(this.origin).addScaledVector(this.direction,nt)}distanceToPoint(_e){return Math.sqrt(this.distanceSqToPoint(_e))}distanceSqToPoint(_e){const rt=_vector$9.subVectors(_e,this.origin).dot(this.direction);return rt<0?this.origin.distanceToSquared(_e):(_vector$9.copy(this.origin).addScaledVector(this.direction,rt),_vector$9.distanceToSquared(_e))}distanceSqToSegment(_e,rt,nt,it){_segCenter.copy(_e).add(rt).multiplyScalar(.5),_segDir.copy(rt).sub(_e).normalize(),_diff.copy(this.origin).sub(_segCenter);const st=_e.distanceTo(rt)*.5,ot=-this.direction.dot(_segDir),lt=_diff.dot(this.direction),at=-_diff.dot(_segDir),ct=_diff.lengthSq(),ut=Math.abs(1-ot*ot);let ht,dt,ft,pt;if(ut>0)if(ht=ot*at-lt,dt=ot*lt-at,pt=st*ut,ht>=0)if(dt>=-pt)if(dt<=pt){const mt=1/ut;ht*=mt,dt*=mt,ft=ht*(ht+ot*dt+2*lt)+dt*(ot*ht+dt+2*at)+ct}else dt=st,ht=Math.max(0,-(ot*dt+lt)),ft=-ht*ht+dt*(dt+2*at)+ct;else dt=-st,ht=Math.max(0,-(ot*dt+lt)),ft=-ht*ht+dt*(dt+2*at)+ct;else dt<=-pt?(ht=Math.max(0,-(-ot*st+lt)),dt=ht>0?-st:Math.min(Math.max(-st,-at),st),ft=-ht*ht+dt*(dt+2*at)+ct):dt<=pt?(ht=0,dt=Math.min(Math.max(-st,-at),st),ft=dt*(dt+2*at)+ct):(ht=Math.max(0,-(ot*st+lt)),dt=ht>0?st:Math.min(Math.max(-st,-at),st),ft=-ht*ht+dt*(dt+2*at)+ct);else dt=ot>0?-st:st,ht=Math.max(0,-(ot*dt+lt)),ft=-ht*ht+dt*(dt+2*at)+ct;return nt&&nt.copy(this.origin).addScaledVector(this.direction,ht),it&&it.copy(_segCenter).addScaledVector(_segDir,dt),ft}intersectSphere(_e,rt){_vector$9.subVectors(_e.center,this.origin);const nt=_vector$9.dot(this.direction),it=_vector$9.dot(_vector$9)-nt*nt,st=_e.radius*_e.radius;if(it>st)return null;const ot=Math.sqrt(st-it),lt=nt-ot,at=nt+ot;return at<0?null:lt<0?this.at(at,rt):this.at(lt,rt)}intersectsSphere(_e){return this.distanceSqToPoint(_e.center)<=_e.radius*_e.radius}distanceToPlane(_e){const rt=_e.normal.dot(this.direction);if(rt===0)return _e.distanceToPoint(this.origin)===0?0:null;const nt=-(this.origin.dot(_e.normal)+_e.constant)/rt;return nt>=0?nt:null}intersectPlane(_e,rt){const nt=this.distanceToPlane(_e);return nt===null?null:this.at(nt,rt)}intersectsPlane(_e){const rt=_e.distanceToPoint(this.origin);return rt===0||_e.normal.dot(this.direction)*rt<0}intersectBox(_e,rt){let nt,it,st,ot,lt,at;const ct=1/this.direction.x,ut=1/this.direction.y,ht=1/this.direction.z,dt=this.origin;return ct>=0?(nt=(_e.min.x-dt.x)*ct,it=(_e.max.x-dt.x)*ct):(nt=(_e.max.x-dt.x)*ct,it=(_e.min.x-dt.x)*ct),ut>=0?(st=(_e.min.y-dt.y)*ut,ot=(_e.max.y-dt.y)*ut):(st=(_e.max.y-dt.y)*ut,ot=(_e.min.y-dt.y)*ut),nt>ot||st>it||((st>nt||isNaN(nt))&&(nt=st),(ot<it||isNaN(it))&&(it=ot),ht>=0?(lt=(_e.min.z-dt.z)*ht,at=(_e.max.z-dt.z)*ht):(lt=(_e.max.z-dt.z)*ht,at=(_e.min.z-dt.z)*ht),nt>at||lt>it)||((lt>nt||nt!==nt)&&(nt=lt),(at<it||it!==it)&&(it=at),it<0)?null:this.at(nt>=0?nt:it,rt)}intersectsBox(_e){return this.intersectBox(_e,_vector$9)!==null}intersectTriangle(_e,rt,nt,it,st){_edge1.subVectors(rt,_e),_edge2.subVectors(nt,_e),_normal$1.crossVectors(_edge1,_edge2);let ot=this.direction.dot(_normal$1),lt;if(ot>0){if(it)return null;lt=1}else if(ot<0)lt=-1,ot=-ot;else return null;_diff.subVectors(this.origin,_e);const at=lt*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(at<0)return null;const ct=lt*this.direction.dot(_edge1.cross(_diff));if(ct<0||at+ct>ot)return null;const ut=-lt*_diff.dot(_normal$1);return ut<0?null:this.at(ut/ot,st)}applyMatrix4(_e){return this.origin.applyMatrix4(_e),this.direction.transformDirection(_e),this}equals(_e){return _e.origin.equals(this.origin)&&_e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};class Matrix4{constructor(_e,rt,nt,it,st,ot,lt,at,ct,ut,ht,dt,ft,pt,mt,gt){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_e!==void 0&&this.set(_e,rt,nt,it,st,ot,lt,at,ct,ut,ht,dt,ft,pt,mt,gt)}set(_e,rt,nt,it,st,ot,lt,at,ct,ut,ht,dt,ft,pt,mt,gt){const vt=this.elements;return vt[0]=_e,vt[4]=rt,vt[8]=nt,vt[12]=it,vt[1]=st,vt[5]=ot,vt[9]=lt,vt[13]=at,vt[2]=ct,vt[6]=ut,vt[10]=ht,vt[14]=dt,vt[3]=ft,vt[7]=pt,vt[11]=mt,vt[15]=gt,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_e){const rt=this.elements,nt=_e.elements;return rt[0]=nt[0],rt[1]=nt[1],rt[2]=nt[2],rt[3]=nt[3],rt[4]=nt[4],rt[5]=nt[5],rt[6]=nt[6],rt[7]=nt[7],rt[8]=nt[8],rt[9]=nt[9],rt[10]=nt[10],rt[11]=nt[11],rt[12]=nt[12],rt[13]=nt[13],rt[14]=nt[14],rt[15]=nt[15],this}copyPosition(_e){const rt=this.elements,nt=_e.elements;return rt[12]=nt[12],rt[13]=nt[13],rt[14]=nt[14],this}setFromMatrix3(_e){const rt=_e.elements;return this.set(rt[0],rt[3],rt[6],0,rt[1],rt[4],rt[7],0,rt[2],rt[5],rt[8],0,0,0,0,1),this}extractBasis(_e,rt,nt){return _e.setFromMatrixColumn(this,0),rt.setFromMatrixColumn(this,1),nt.setFromMatrixColumn(this,2),this}makeBasis(_e,rt,nt){return this.set(_e.x,rt.x,nt.x,0,_e.y,rt.y,nt.y,0,_e.z,rt.z,nt.z,0,0,0,0,1),this}extractRotation(_e){const rt=this.elements,nt=_e.elements,it=1/_v1$5.setFromMatrixColumn(_e,0).length(),st=1/_v1$5.setFromMatrixColumn(_e,1).length(),ot=1/_v1$5.setFromMatrixColumn(_e,2).length();return rt[0]=nt[0]*it,rt[1]=nt[1]*it,rt[2]=nt[2]*it,rt[3]=0,rt[4]=nt[4]*st,rt[5]=nt[5]*st,rt[6]=nt[6]*st,rt[7]=0,rt[8]=nt[8]*ot,rt[9]=nt[9]*ot,rt[10]=nt[10]*ot,rt[11]=0,rt[12]=0,rt[13]=0,rt[14]=0,rt[15]=1,this}makeRotationFromEuler(_e){const rt=this.elements,nt=_e.x,it=_e.y,st=_e.z,ot=Math.cos(nt),lt=Math.sin(nt),at=Math.cos(it),ct=Math.sin(it),ut=Math.cos(st),ht=Math.sin(st);if(_e.order==="XYZ"){const dt=ot*ut,ft=ot*ht,pt=lt*ut,mt=lt*ht;rt[0]=at*ut,rt[4]=-at*ht,rt[8]=ct,rt[1]=ft+pt*ct,rt[5]=dt-mt*ct,rt[9]=-lt*at,rt[2]=mt-dt*ct,rt[6]=pt+ft*ct,rt[10]=ot*at}else if(_e.order==="YXZ"){const dt=at*ut,ft=at*ht,pt=ct*ut,mt=ct*ht;rt[0]=dt+mt*lt,rt[4]=pt*lt-ft,rt[8]=ot*ct,rt[1]=ot*ht,rt[5]=ot*ut,rt[9]=-lt,rt[2]=ft*lt-pt,rt[6]=mt+dt*lt,rt[10]=ot*at}else if(_e.order==="ZXY"){const dt=at*ut,ft=at*ht,pt=ct*ut,mt=ct*ht;rt[0]=dt-mt*lt,rt[4]=-ot*ht,rt[8]=pt+ft*lt,rt[1]=ft+pt*lt,rt[5]=ot*ut,rt[9]=mt-dt*lt,rt[2]=-ot*ct,rt[6]=lt,rt[10]=ot*at}else if(_e.order==="ZYX"){const dt=ot*ut,ft=ot*ht,pt=lt*ut,mt=lt*ht;rt[0]=at*ut,rt[4]=pt*ct-ft,rt[8]=dt*ct+mt,rt[1]=at*ht,rt[5]=mt*ct+dt,rt[9]=ft*ct-pt,rt[2]=-ct,rt[6]=lt*at,rt[10]=ot*at}else if(_e.order==="YZX"){const dt=ot*at,ft=ot*ct,pt=lt*at,mt=lt*ct;rt[0]=at*ut,rt[4]=mt-dt*ht,rt[8]=pt*ht+ft,rt[1]=ht,rt[5]=ot*ut,rt[9]=-lt*ut,rt[2]=-ct*ut,rt[6]=ft*ht+pt,rt[10]=dt-mt*ht}else if(_e.order==="XZY"){const dt=ot*at,ft=ot*ct,pt=lt*at,mt=lt*ct;rt[0]=at*ut,rt[4]=-ht,rt[8]=ct*ut,rt[1]=dt*ht+mt,rt[5]=ot*ut,rt[9]=ft*ht-pt,rt[2]=pt*ht-ft,rt[6]=lt*ut,rt[10]=mt*ht+dt}return rt[3]=0,rt[7]=0,rt[11]=0,rt[12]=0,rt[13]=0,rt[14]=0,rt[15]=1,this}makeRotationFromQuaternion(_e){return this.compose(_zero,_e,_one)}lookAt(_e,rt,nt){const it=this.elements;return _z.subVectors(_e,rt),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(nt,_z),_x.lengthSq()===0&&(Math.abs(nt.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(nt,_z)),_x.normalize(),_y.crossVectors(_z,_x),it[0]=_x.x,it[4]=_y.x,it[8]=_z.x,it[1]=_x.y,it[5]=_y.y,it[9]=_z.y,it[2]=_x.z,it[6]=_y.z,it[10]=_z.z,this}multiply(_e){return this.multiplyMatrices(this,_e)}premultiply(_e){return this.multiplyMatrices(_e,this)}multiplyMatrices(_e,rt){const nt=_e.elements,it=rt.elements,st=this.elements,ot=nt[0],lt=nt[4],at=nt[8],ct=nt[12],ut=nt[1],ht=nt[5],dt=nt[9],ft=nt[13],pt=nt[2],mt=nt[6],gt=nt[10],vt=nt[14],At=nt[3],yt=nt[7],xt=nt[11],_t=nt[15],Et=it[0],bt=it[4],wt=it[8],Tt=it[12],Mt=it[1],Pt=it[5],It=it[9],Ot=it[13],Bt=it[2],Ut=it[6],Ft=it[10],jt=it[14],Dt=it[3],Gt=it[7],zt=it[11],$t=it[15];return st[0]=ot*Et+lt*Mt+at*Bt+ct*Dt,st[4]=ot*bt+lt*Pt+at*Ut+ct*Gt,st[8]=ot*wt+lt*It+at*Ft+ct*zt,st[12]=ot*Tt+lt*Ot+at*jt+ct*$t,st[1]=ut*Et+ht*Mt+dt*Bt+ft*Dt,st[5]=ut*bt+ht*Pt+dt*Ut+ft*Gt,st[9]=ut*wt+ht*It+dt*Ft+ft*zt,st[13]=ut*Tt+ht*Ot+dt*jt+ft*$t,st[2]=pt*Et+mt*Mt+gt*Bt+vt*Dt,st[6]=pt*bt+mt*Pt+gt*Ut+vt*Gt,st[10]=pt*wt+mt*It+gt*Ft+vt*zt,st[14]=pt*Tt+mt*Ot+gt*jt+vt*$t,st[3]=At*Et+yt*Mt+xt*Bt+_t*Dt,st[7]=At*bt+yt*Pt+xt*Ut+_t*Gt,st[11]=At*wt+yt*It+xt*Ft+_t*zt,st[15]=At*Tt+yt*Ot+xt*jt+_t*$t,this}multiplyScalar(_e){const rt=this.elements;return rt[0]*=_e,rt[4]*=_e,rt[8]*=_e,rt[12]*=_e,rt[1]*=_e,rt[5]*=_e,rt[9]*=_e,rt[13]*=_e,rt[2]*=_e,rt[6]*=_e,rt[10]*=_e,rt[14]*=_e,rt[3]*=_e,rt[7]*=_e,rt[11]*=_e,rt[15]*=_e,this}determinant(){const _e=this.elements,rt=_e[0],nt=_e[4],it=_e[8],st=_e[12],ot=_e[1],lt=_e[5],at=_e[9],ct=_e[13],ut=_e[2],ht=_e[6],dt=_e[10],ft=_e[14],pt=_e[3],mt=_e[7],gt=_e[11],vt=_e[15];return pt*(+st*at*ht-it*ct*ht-st*lt*dt+nt*ct*dt+it*lt*ft-nt*at*ft)+mt*(+rt*at*ft-rt*ct*dt+st*ot*dt-it*ot*ft+it*ct*ut-st*at*ut)+gt*(+rt*ct*ht-rt*lt*ft-st*ot*ht+nt*ot*ft+st*lt*ut-nt*ct*ut)+vt*(-it*lt*ut-rt*at*ht+rt*lt*dt+it*ot*ht-nt*ot*dt+nt*at*ut)}transpose(){const _e=this.elements;let rt;return rt=_e[1],_e[1]=_e[4],_e[4]=rt,rt=_e[2],_e[2]=_e[8],_e[8]=rt,rt=_e[6],_e[6]=_e[9],_e[9]=rt,rt=_e[3],_e[3]=_e[12],_e[12]=rt,rt=_e[7],_e[7]=_e[13],_e[13]=rt,rt=_e[11],_e[11]=_e[14],_e[14]=rt,this}setPosition(_e,rt,nt){const it=this.elements;return _e.isVector3?(it[12]=_e.x,it[13]=_e.y,it[14]=_e.z):(it[12]=_e,it[13]=rt,it[14]=nt),this}invert(){const _e=this.elements,rt=_e[0],nt=_e[1],it=_e[2],st=_e[3],ot=_e[4],lt=_e[5],at=_e[6],ct=_e[7],ut=_e[8],ht=_e[9],dt=_e[10],ft=_e[11],pt=_e[12],mt=_e[13],gt=_e[14],vt=_e[15],At=ht*gt*ct-mt*dt*ct+mt*at*ft-lt*gt*ft-ht*at*vt+lt*dt*vt,yt=pt*dt*ct-ut*gt*ct-pt*at*ft+ot*gt*ft+ut*at*vt-ot*dt*vt,xt=ut*mt*ct-pt*ht*ct+pt*lt*ft-ot*mt*ft-ut*lt*vt+ot*ht*vt,_t=pt*ht*at-ut*mt*at-pt*lt*dt+ot*mt*dt+ut*lt*gt-ot*ht*gt,Et=rt*At+nt*yt+it*xt+st*_t;if(Et===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const bt=1/Et;return _e[0]=At*bt,_e[1]=(mt*dt*st-ht*gt*st-mt*it*ft+nt*gt*ft+ht*it*vt-nt*dt*vt)*bt,_e[2]=(lt*gt*st-mt*at*st+mt*it*ct-nt*gt*ct-lt*it*vt+nt*at*vt)*bt,_e[3]=(ht*at*st-lt*dt*st-ht*it*ct+nt*dt*ct+lt*it*ft-nt*at*ft)*bt,_e[4]=yt*bt,_e[5]=(ut*gt*st-pt*dt*st+pt*it*ft-rt*gt*ft-ut*it*vt+rt*dt*vt)*bt,_e[6]=(pt*at*st-ot*gt*st-pt*it*ct+rt*gt*ct+ot*it*vt-rt*at*vt)*bt,_e[7]=(ot*dt*st-ut*at*st+ut*it*ct-rt*dt*ct-ot*it*ft+rt*at*ft)*bt,_e[8]=xt*bt,_e[9]=(pt*ht*st-ut*mt*st-pt*nt*ft+rt*mt*ft+ut*nt*vt-rt*ht*vt)*bt,_e[10]=(ot*mt*st-pt*lt*st+pt*nt*ct-rt*mt*ct-ot*nt*vt+rt*lt*vt)*bt,_e[11]=(ut*lt*st-ot*ht*st-ut*nt*ct+rt*ht*ct+ot*nt*ft-rt*lt*ft)*bt,_e[12]=_t*bt,_e[13]=(ut*mt*it-pt*ht*it+pt*nt*dt-rt*mt*dt-ut*nt*gt+rt*ht*gt)*bt,_e[14]=(pt*lt*it-ot*mt*it-pt*nt*at+rt*mt*at+ot*nt*gt-rt*lt*gt)*bt,_e[15]=(ot*ht*it-ut*lt*it+ut*nt*at-rt*ht*at-ot*nt*dt+rt*lt*dt)*bt,this}scale(_e){const rt=this.elements,nt=_e.x,it=_e.y,st=_e.z;return rt[0]*=nt,rt[4]*=it,rt[8]*=st,rt[1]*=nt,rt[5]*=it,rt[9]*=st,rt[2]*=nt,rt[6]*=it,rt[10]*=st,rt[3]*=nt,rt[7]*=it,rt[11]*=st,this}getMaxScaleOnAxis(){const _e=this.elements,rt=_e[0]*_e[0]+_e[1]*_e[1]+_e[2]*_e[2],nt=_e[4]*_e[4]+_e[5]*_e[5]+_e[6]*_e[6],it=_e[8]*_e[8]+_e[9]*_e[9]+_e[10]*_e[10];return Math.sqrt(Math.max(rt,nt,it))}makeTranslation(_e,rt,nt){return _e.isVector3?this.set(1,0,0,_e.x,0,1,0,_e.y,0,0,1,_e.z,0,0,0,1):this.set(1,0,0,_e,0,1,0,rt,0,0,1,nt,0,0,0,1),this}makeRotationX(_e){const rt=Math.cos(_e),nt=Math.sin(_e);return this.set(1,0,0,0,0,rt,-nt,0,0,nt,rt,0,0,0,0,1),this}makeRotationY(_e){const rt=Math.cos(_e),nt=Math.sin(_e);return this.set(rt,0,nt,0,0,1,0,0,-nt,0,rt,0,0,0,0,1),this}makeRotationZ(_e){const rt=Math.cos(_e),nt=Math.sin(_e);return this.set(rt,-nt,0,0,nt,rt,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_e,rt){const nt=Math.cos(rt),it=Math.sin(rt),st=1-nt,ot=_e.x,lt=_e.y,at=_e.z,ct=st*ot,ut=st*lt;return this.set(ct*ot+nt,ct*lt-it*at,ct*at+it*lt,0,ct*lt+it*at,ut*lt+nt,ut*at-it*ot,0,ct*at-it*lt,ut*at+it*ot,st*at*at+nt,0,0,0,0,1),this}makeScale(_e,rt,nt){return this.set(_e,0,0,0,0,rt,0,0,0,0,nt,0,0,0,0,1),this}makeShear(_e,rt,nt,it,st,ot){return this.set(1,nt,st,0,_e,1,ot,0,rt,it,1,0,0,0,0,1),this}compose(_e,rt,nt){const it=this.elements,st=rt._x,ot=rt._y,lt=rt._z,at=rt._w,ct=st+st,ut=ot+ot,ht=lt+lt,dt=st*ct,ft=st*ut,pt=st*ht,mt=ot*ut,gt=ot*ht,vt=lt*ht,At=at*ct,yt=at*ut,xt=at*ht,_t=nt.x,Et=nt.y,bt=nt.z;return it[0]=(1-(mt+vt))*_t,it[1]=(ft+xt)*_t,it[2]=(pt-yt)*_t,it[3]=0,it[4]=(ft-xt)*Et,it[5]=(1-(dt+vt))*Et,it[6]=(gt+At)*Et,it[7]=0,it[8]=(pt+yt)*bt,it[9]=(gt-At)*bt,it[10]=(1-(dt+mt))*bt,it[11]=0,it[12]=_e.x,it[13]=_e.y,it[14]=_e.z,it[15]=1,this}decompose(_e,rt,nt){const it=this.elements;let st=_v1$5.set(it[0],it[1],it[2]).length();const ot=_v1$5.set(it[4],it[5],it[6]).length(),lt=_v1$5.set(it[8],it[9],it[10]).length();this.determinant()<0&&(st=-st),_e.x=it[12],_e.y=it[13],_e.z=it[14],_m1$2.copy(this);const ct=1/st,ut=1/ot,ht=1/lt;return _m1$2.elements[0]*=ct,_m1$2.elements[1]*=ct,_m1$2.elements[2]*=ct,_m1$2.elements[4]*=ut,_m1$2.elements[5]*=ut,_m1$2.elements[6]*=ut,_m1$2.elements[8]*=ht,_m1$2.elements[9]*=ht,_m1$2.elements[10]*=ht,rt.setFromRotationMatrix(_m1$2),nt.x=st,nt.y=ot,nt.z=lt,this}makePerspective(_e,rt,nt,it,st,ot,lt=WebGLCoordinateSystem){const at=this.elements,ct=2*st/(rt-_e),ut=2*st/(nt-it),ht=(rt+_e)/(rt-_e),dt=(nt+it)/(nt-it);let ft,pt;if(lt===WebGLCoordinateSystem)ft=-(ot+st)/(ot-st),pt=-2*ot*st/(ot-st);else if(lt===WebGPUCoordinateSystem)ft=-ot/(ot-st),pt=-ot*st/(ot-st);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+lt);return at[0]=ct,at[4]=0,at[8]=ht,at[12]=0,at[1]=0,at[5]=ut,at[9]=dt,at[13]=0,at[2]=0,at[6]=0,at[10]=ft,at[14]=pt,at[3]=0,at[7]=0,at[11]=-1,at[15]=0,this}makeOrthographic(_e,rt,nt,it,st,ot,lt=WebGLCoordinateSystem){const at=this.elements,ct=1/(rt-_e),ut=1/(nt-it),ht=1/(ot-st),dt=(rt+_e)*ct,ft=(nt+it)*ut;let pt,mt;if(lt===WebGLCoordinateSystem)pt=(ot+st)*ht,mt=-2*ht;else if(lt===WebGPUCoordinateSystem)pt=st*ht,mt=-1*ht;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+lt);return at[0]=2*ct,at[4]=0,at[8]=0,at[12]=-dt,at[1]=0,at[5]=2*ut,at[9]=0,at[13]=-ft,at[2]=0,at[6]=0,at[10]=mt,at[14]=-pt,at[3]=0,at[7]=0,at[11]=0,at[15]=1,this}equals(_e){const rt=this.elements,nt=_e.elements;for(let it=0;it<16;it++)if(rt[it]!==nt[it])return!1;return!0}fromArray(_e,rt=0){for(let nt=0;nt<16;nt++)this.elements[nt]=_e[nt+rt];return this}toArray(_e=[],rt=0){const nt=this.elements;return _e[rt]=nt[0],_e[rt+1]=nt[1],_e[rt+2]=nt[2],_e[rt+3]=nt[3],_e[rt+4]=nt[4],_e[rt+5]=nt[5],_e[rt+6]=nt[6],_e[rt+7]=nt[7],_e[rt+8]=nt[8],_e[rt+9]=nt[9],_e[rt+10]=nt[10],_e[rt+11]=nt[11],_e[rt+12]=nt[12],_e[rt+13]=nt[13],_e[rt+14]=nt[14],_e[rt+15]=nt[15],_e}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_e=0,rt=0,nt=0,it=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_e,this._y=rt,this._z=nt,this._order=it}get x(){return this._x}set x(_e){this._x=_e,this._onChangeCallback()}get y(){return this._y}set y(_e){this._y=_e,this._onChangeCallback()}get z(){return this._z}set z(_e){this._z=_e,this._onChangeCallback()}get order(){return this._order}set order(_e){this._order=_e,this._onChangeCallback()}set(_e,rt,nt,it=this._order){return this._x=_e,this._y=rt,this._z=nt,this._order=it,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_e){return this._x=_e._x,this._y=_e._y,this._z=_e._z,this._order=_e._order,this._onChangeCallback(),this}setFromRotationMatrix(_e,rt=this._order,nt=!0){const it=_e.elements,st=it[0],ot=it[4],lt=it[8],at=it[1],ct=it[5],ut=it[9],ht=it[2],dt=it[6],ft=it[10];switch(rt){case"XYZ":this._y=Math.asin(clamp$2(lt,-1,1)),Math.abs(lt)<.9999999?(this._x=Math.atan2(-ut,ft),this._z=Math.atan2(-ot,st)):(this._x=Math.atan2(dt,ct),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$2(ut,-1,1)),Math.abs(ut)<.9999999?(this._y=Math.atan2(lt,ft),this._z=Math.atan2(at,ct)):(this._y=Math.atan2(-ht,st),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$2(dt,-1,1)),Math.abs(dt)<.9999999?(this._y=Math.atan2(-ht,ft),this._z=Math.atan2(-ot,ct)):(this._y=0,this._z=Math.atan2(at,st));break;case"ZYX":this._y=Math.asin(-clamp$2(ht,-1,1)),Math.abs(ht)<.9999999?(this._x=Math.atan2(dt,ft),this._z=Math.atan2(at,st)):(this._x=0,this._z=Math.atan2(-ot,ct));break;case"YZX":this._z=Math.asin(clamp$2(at,-1,1)),Math.abs(at)<.9999999?(this._x=Math.atan2(-ut,ct),this._y=Math.atan2(-ht,st)):(this._x=0,this._y=Math.atan2(lt,ft));break;case"XZY":this._z=Math.asin(-clamp$2(ot,-1,1)),Math.abs(ot)<.9999999?(this._x=Math.atan2(dt,ct),this._y=Math.atan2(lt,st)):(this._x=Math.atan2(-ut,ft),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+rt)}return this._order=rt,nt===!0&&this._onChangeCallback(),this}setFromQuaternion(_e,rt,nt){return _matrix.makeRotationFromQuaternion(_e),this.setFromRotationMatrix(_matrix,rt,nt)}setFromVector3(_e,rt=this._order){return this.set(_e.x,_e.y,_e.z,rt)}reorder(_e){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_e)}equals(_e){return _e._x===this._x&&_e._y===this._y&&_e._z===this._z&&_e._order===this._order}fromArray(_e){return this._x=_e[0],this._y=_e[1],this._z=_e[2],_e[3]!==void 0&&(this._order=_e[3]),this._onChangeCallback(),this}toArray(_e=[],rt=0){return _e[rt]=this._x,_e[rt+1]=this._y,_e[rt+2]=this._z,_e[rt+3]=this._order,_e}_onChange(_e){return this._onChangeCallback=_e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_e){this.mask=(1<<_e|0)>>>0}enable(_e){this.mask|=1<<_e|0}enableAll(){this.mask=-1}toggle(_e){this.mask^=1<<_e|0}disable(_e){this.mask&=~(1<<_e|0)}disableAll(){this.mask=0}test(_e){return(this.mask&_e.mask)!==0}isEnabled(_e){return(this.mask&(1<<_e|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID$1(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _e=new Vector3,rt=new Euler,nt=new Quaternion,it=new Vector3(1,1,1);function st(){nt.setFromEuler(rt,!1)}function ot(){rt.setFromQuaternion(nt,void 0,!1)}rt._onChange(st),nt._onChange(ot),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_e},rotation:{configurable:!0,enumerable:!0,value:rt},quaternion:{configurable:!0,enumerable:!0,value:nt},scale:{configurable:!0,enumerable:!0,value:it},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(_e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_e){return this.quaternion.premultiply(_e),this}setRotationFromAxisAngle(_e,rt){this.quaternion.setFromAxisAngle(_e,rt)}setRotationFromEuler(_e){this.quaternion.setFromEuler(_e,!0)}setRotationFromMatrix(_e){this.quaternion.setFromRotationMatrix(_e)}setRotationFromQuaternion(_e){this.quaternion.copy(_e)}rotateOnAxis(_e,rt){return _q1.setFromAxisAngle(_e,rt),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(_e,rt){return _q1.setFromAxisAngle(_e,rt),this.quaternion.premultiply(_q1),this}rotateX(_e){return this.rotateOnAxis(_xAxis,_e)}rotateY(_e){return this.rotateOnAxis(_yAxis,_e)}rotateZ(_e){return this.rotateOnAxis(_zAxis,_e)}translateOnAxis(_e,rt){return _v1$4.copy(_e).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(rt)),this}translateX(_e){return this.translateOnAxis(_xAxis,_e)}translateY(_e){return this.translateOnAxis(_yAxis,_e)}translateZ(_e){return this.translateOnAxis(_zAxis,_e)}localToWorld(_e){return this.updateWorldMatrix(!0,!1),_e.applyMatrix4(this.matrixWorld)}worldToLocal(_e){return this.updateWorldMatrix(!0,!1),_e.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(_e,rt,nt){_e.isVector3?_target.copy(_e):_target.set(_e,rt,nt);const it=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target,this.up):_m1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),it&&(_m1$1.extractRotation(it.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))}add(_e){if(arguments.length>1){for(let rt=0;rt<arguments.length;rt++)this.add(arguments[rt]);return this}return _e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_e),this):(_e&&_e.isObject3D?(_e.parent!==null&&_e.parent.remove(_e),_e.parent=this,this.children.push(_e),_e.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_e),this)}remove(_e){if(arguments.length>1){for(let nt=0;nt<arguments.length;nt++)this.remove(arguments[nt]);return this}const rt=this.children.indexOf(_e);return rt!==-1&&(_e.parent=null,this.children.splice(rt,1),_e.dispatchEvent(_removedEvent)),this}removeFromParent(){const _e=this.parent;return _e!==null&&_e.remove(this),this}clear(){for(let _e=0;_e<this.children.length;_e++){const rt=this.children[_e];rt.parent=null,rt.dispatchEvent(_removedEvent)}return this.children.length=0,this}attach(_e){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),_e.parent!==null&&(_e.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(_e.parent.matrixWorld)),_e.applyMatrix4(_m1$1),this.add(_e),_e.updateWorldMatrix(!1,!0),this}getObjectById(_e){return this.getObjectByProperty("id",_e)}getObjectByName(_e){return this.getObjectByProperty("name",_e)}getObjectByProperty(_e,rt){if(this[_e]===rt)return this;for(let nt=0,it=this.children.length;nt<it;nt++){const ot=this.children[nt].getObjectByProperty(_e,rt);if(ot!==void 0)return ot}}getObjectsByProperty(_e,rt){let nt=[];this[_e]===rt&&nt.push(this);for(let it=0,st=this.children.length;it<st;it++){const ot=this.children[it].getObjectsByProperty(_e,rt);ot.length>0&&(nt=nt.concat(ot))}return nt}getWorldPosition(_e){return this.updateWorldMatrix(!0,!1),_e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_e,_scale$2),_e}getWorldScale(_e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_e),_e}getWorldDirection(_e){this.updateWorldMatrix(!0,!1);const rt=this.matrixWorld.elements;return _e.set(rt[8],rt[9],rt[10]).normalize()}raycast(){}traverse(_e){_e(this);const rt=this.children;for(let nt=0,it=rt.length;nt<it;nt++)rt[nt].traverse(_e)}traverseVisible(_e){if(this.visible===!1)return;_e(this);const rt=this.children;for(let nt=0,it=rt.length;nt<it;nt++)rt[nt].traverseVisible(_e)}traverseAncestors(_e){const rt=this.parent;rt!==null&&(_e(rt),rt.traverseAncestors(_e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,_e=!0);const rt=this.children;for(let nt=0,it=rt.length;nt<it;nt++){const st=rt[nt];(st.matrixWorldAutoUpdate===!0||_e===!0)&&st.updateMatrixWorld(_e)}}updateWorldMatrix(_e,rt){const nt=this.parent;if(_e===!0&&nt!==null&&nt.matrixWorldAutoUpdate===!0&&nt.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),rt===!0){const it=this.children;for(let st=0,ot=it.length;st<ot;st++){const lt=it[st];lt.matrixWorldAutoUpdate===!0&&lt.updateWorldMatrix(!1,!0)}}}toJSON(_e){const rt=_e===void 0||typeof _e=="string",nt={};rt&&(_e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},nt.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const it={};it.uuid=this.uuid,it.type=this.type,this.name!==""&&(it.name=this.name),this.castShadow===!0&&(it.castShadow=!0),this.receiveShadow===!0&&(it.receiveShadow=!0),this.visible===!1&&(it.visible=!1),this.frustumCulled===!1&&(it.frustumCulled=!1),this.renderOrder!==0&&(it.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(it.userData=this.userData),it.layers=this.layers.mask,it.matrix=this.matrix.toArray(),it.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(it.matrixAutoUpdate=!1),this.isInstancedMesh&&(it.type="InstancedMesh",it.count=this.count,it.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(it.instanceColor=this.instanceColor.toJSON()));function st(lt,at){return lt[at.uuid]===void 0&&(lt[at.uuid]=at.toJSON(_e)),at.uuid}if(this.isScene)this.background&&(this.background.isColor?it.background=this.background.toJSON():this.background.isTexture&&(it.background=this.background.toJSON(_e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(it.environment=this.environment.toJSON(_e).uuid);else if(this.isMesh||this.isLine||this.isPoints){it.geometry=st(_e.geometries,this.geometry);const lt=this.geometry.parameters;if(lt!==void 0&&lt.shapes!==void 0){const at=lt.shapes;if(Array.isArray(at))for(let ct=0,ut=at.length;ct<ut;ct++){const ht=at[ct];st(_e.shapes,ht)}else st(_e.shapes,at)}}if(this.isSkinnedMesh&&(it.bindMode=this.bindMode,it.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(st(_e.skeletons,this.skeleton),it.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const lt=[];for(let at=0,ct=this.material.length;at<ct;at++)lt.push(st(_e.materials,this.material[at]));it.material=lt}else it.material=st(_e.materials,this.material);if(this.children.length>0){it.children=[];for(let lt=0;lt<this.children.length;lt++)it.children.push(this.children[lt].toJSON(_e).object)}if(this.animations.length>0){it.animations=[];for(let lt=0;lt<this.animations.length;lt++){const at=this.animations[lt];it.animations.push(st(_e.animations,at))}}if(rt){const lt=ot(_e.geometries),at=ot(_e.materials),ct=ot(_e.textures),ut=ot(_e.images),ht=ot(_e.shapes),dt=ot(_e.skeletons),ft=ot(_e.animations),pt=ot(_e.nodes);lt.length>0&&(nt.geometries=lt),at.length>0&&(nt.materials=at),ct.length>0&&(nt.textures=ct),ut.length>0&&(nt.images=ut),ht.length>0&&(nt.shapes=ht),dt.length>0&&(nt.skeletons=dt),ft.length>0&&(nt.animations=ft),pt.length>0&&(nt.nodes=pt)}return nt.object=it,nt;function ot(lt){const at=[];for(const ct in lt){const ut=lt[ct];delete ut.metadata,at.push(ut)}return at}}clone(_e){return new this.constructor().copy(this,_e)}copy(_e,rt=!0){if(this.name=_e.name,this.up.copy(_e.up),this.position.copy(_e.position),this.rotation.order=_e.rotation.order,this.quaternion.copy(_e.quaternion),this.scale.copy(_e.scale),this.matrix.copy(_e.matrix),this.matrixWorld.copy(_e.matrixWorld),this.matrixAutoUpdate=_e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=_e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=_e.matrixWorldAutoUpdate,this.layers.mask=_e.layers.mask,this.visible=_e.visible,this.castShadow=_e.castShadow,this.receiveShadow=_e.receiveShadow,this.frustumCulled=_e.frustumCulled,this.renderOrder=_e.renderOrder,this.animations=_e.animations,this.userData=JSON.parse(JSON.stringify(_e.userData)),rt===!0)for(let nt=0;nt<_e.children.length;nt++){const it=_e.children[nt];this.add(it.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$1=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;let warnedGetUV=!1;class Triangle{constructor(_e=new Vector3,rt=new Vector3,nt=new Vector3){this.a=_e,this.b=rt,this.c=nt}static getNormal(_e,rt,nt,it){it.subVectors(nt,rt),_v0$1.subVectors(_e,rt),it.cross(_v0$1);const st=it.lengthSq();return st>0?it.multiplyScalar(1/Math.sqrt(st)):it.set(0,0,0)}static getBarycoord(_e,rt,nt,it,st){_v0$1.subVectors(it,rt),_v1$3.subVectors(nt,rt),_v2$2.subVectors(_e,rt);const ot=_v0$1.dot(_v0$1),lt=_v0$1.dot(_v1$3),at=_v0$1.dot(_v2$2),ct=_v1$3.dot(_v1$3),ut=_v1$3.dot(_v2$2),ht=ot*ct-lt*lt;if(ht===0)return st.set(-2,-1,-1);const dt=1/ht,ft=(ct*at-lt*ut)*dt,pt=(ot*ut-lt*at)*dt;return st.set(1-ft-pt,pt,ft)}static containsPoint(_e,rt,nt,it){return this.getBarycoord(_e,rt,nt,it,_v3$1),_v3$1.x>=0&&_v3$1.y>=0&&_v3$1.x+_v3$1.y<=1}static getUV(_e,rt,nt,it,st,ot,lt,at){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),this.getInterpolation(_e,rt,nt,it,st,ot,lt,at)}static getInterpolation(_e,rt,nt,it,st,ot,lt,at){return this.getBarycoord(_e,rt,nt,it,_v3$1),at.setScalar(0),at.addScaledVector(st,_v3$1.x),at.addScaledVector(ot,_v3$1.y),at.addScaledVector(lt,_v3$1.z),at}static isFrontFacing(_e,rt,nt,it){return _v0$1.subVectors(nt,rt),_v1$3.subVectors(_e,rt),_v0$1.cross(_v1$3).dot(it)<0}set(_e,rt,nt){return this.a.copy(_e),this.b.copy(rt),this.c.copy(nt),this}setFromPointsAndIndices(_e,rt,nt,it){return this.a.copy(_e[rt]),this.b.copy(_e[nt]),this.c.copy(_e[it]),this}setFromAttributeAndIndices(_e,rt,nt,it){return this.a.fromBufferAttribute(_e,rt),this.b.fromBufferAttribute(_e,nt),this.c.fromBufferAttribute(_e,it),this}clone(){return new this.constructor().copy(this)}copy(_e){return this.a.copy(_e.a),this.b.copy(_e.b),this.c.copy(_e.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(_e){return _e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_e){return Triangle.getNormal(this.a,this.b,this.c,_e)}getPlane(_e){return _e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_e,rt){return Triangle.getBarycoord(_e,this.a,this.b,this.c,rt)}getUV(_e,rt,nt,it,st){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),Triangle.getInterpolation(_e,this.a,this.b,this.c,rt,nt,it,st)}getInterpolation(_e,rt,nt,it,st){return Triangle.getInterpolation(_e,this.a,this.b,this.c,rt,nt,it,st)}containsPoint(_e){return Triangle.containsPoint(_e,this.a,this.b,this.c)}isFrontFacing(_e){return Triangle.isFrontFacing(this.a,this.b,this.c,_e)}intersectsBox(_e){return _e.intersectsTriangle(this)}closestPointToPoint(_e,rt){const nt=this.a,it=this.b,st=this.c;let ot,lt;_vab.subVectors(it,nt),_vac.subVectors(st,nt),_vap.subVectors(_e,nt);const at=_vab.dot(_vap),ct=_vac.dot(_vap);if(at<=0&&ct<=0)return rt.copy(nt);_vbp.subVectors(_e,it);const ut=_vab.dot(_vbp),ht=_vac.dot(_vbp);if(ut>=0&&ht<=ut)return rt.copy(it);const dt=at*ht-ut*ct;if(dt<=0&&at>=0&&ut<=0)return ot=at/(at-ut),rt.copy(nt).addScaledVector(_vab,ot);_vcp.subVectors(_e,st);const ft=_vab.dot(_vcp),pt=_vac.dot(_vcp);if(pt>=0&&ft<=pt)return rt.copy(st);const mt=ft*ct-at*pt;if(mt<=0&&ct>=0&&pt<=0)return lt=ct/(ct-pt),rt.copy(nt).addScaledVector(_vac,lt);const gt=ut*pt-ft*ht;if(gt<=0&&ht-ut>=0&&ft-pt>=0)return _vbc.subVectors(st,it),lt=(ht-ut)/(ht-ut+(ft-pt)),rt.copy(it).addScaledVector(_vbc,lt);const vt=1/(gt+mt+dt);return ot=mt*vt,lt=dt*vt,rt.copy(nt).addScaledVector(_vab,ot).addScaledVector(_vac,lt)}equals(_e){return _e.a.equals(this.a)&&_e.b.equals(this.b)&&_e.c.equals(this.c)}}let materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:materialId++}),this.uuid=generateUUID$1(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_e){this._alphaTest>0!=_e>0&&this.version++,this._alphaTest=_e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_e){if(_e!==void 0)for(const rt in _e){const nt=_e[rt];if(nt===void 0){console.warn(`THREE.Material: parameter '${rt}' has value of undefined.`);continue}const it=this[rt];if(it===void 0){console.warn(`THREE.Material: '${rt}' is not a property of THREE.${this.type}.`);continue}it&&it.isColor?it.set(nt):it&&it.isVector3&&nt&&nt.isVector3?it.copy(nt):this[rt]=nt}}toJSON(_e){const rt=_e===void 0||typeof _e=="string";rt&&(_e={textures:{},images:{}});const nt={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};nt.uuid=this.uuid,nt.type=this.type,this.name!==""&&(nt.name=this.name),this.color&&this.color.isColor&&(nt.color=this.color.getHex()),this.roughness!==void 0&&(nt.roughness=this.roughness),this.metalness!==void 0&&(nt.metalness=this.metalness),this.sheen!==void 0&&(nt.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(nt.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(nt.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(nt.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(nt.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(nt.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(nt.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(nt.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(nt.shininess=this.shininess),this.clearcoat!==void 0&&(nt.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(nt.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(nt.clearcoatMap=this.clearcoatMap.toJSON(_e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(nt.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(nt.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_e).uuid,nt.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(nt.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(nt.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(nt.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(nt.iridescenceMap=this.iridescenceMap.toJSON(_e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(nt.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_e).uuid),this.anisotropy!==void 0&&(nt.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(nt.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(nt.anisotropyMap=this.anisotropyMap.toJSON(_e).uuid),this.map&&this.map.isTexture&&(nt.map=this.map.toJSON(_e).uuid),this.matcap&&this.matcap.isTexture&&(nt.matcap=this.matcap.toJSON(_e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(nt.alphaMap=this.alphaMap.toJSON(_e).uuid),this.lightMap&&this.lightMap.isTexture&&(nt.lightMap=this.lightMap.toJSON(_e).uuid,nt.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(nt.aoMap=this.aoMap.toJSON(_e).uuid,nt.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(nt.bumpMap=this.bumpMap.toJSON(_e).uuid,nt.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(nt.normalMap=this.normalMap.toJSON(_e).uuid,nt.normalMapType=this.normalMapType,nt.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(nt.displacementMap=this.displacementMap.toJSON(_e).uuid,nt.displacementScale=this.displacementScale,nt.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(nt.roughnessMap=this.roughnessMap.toJSON(_e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(nt.metalnessMap=this.metalnessMap.toJSON(_e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(nt.emissiveMap=this.emissiveMap.toJSON(_e).uuid),this.specularMap&&this.specularMap.isTexture&&(nt.specularMap=this.specularMap.toJSON(_e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(nt.specularIntensityMap=this.specularIntensityMap.toJSON(_e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(nt.specularColorMap=this.specularColorMap.toJSON(_e).uuid),this.envMap&&this.envMap.isTexture&&(nt.envMap=this.envMap.toJSON(_e).uuid,this.combine!==void 0&&(nt.combine=this.combine)),this.envMapIntensity!==void 0&&(nt.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(nt.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(nt.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(nt.gradientMap=this.gradientMap.toJSON(_e).uuid),this.transmission!==void 0&&(nt.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(nt.transmissionMap=this.transmissionMap.toJSON(_e).uuid),this.thickness!==void 0&&(nt.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(nt.thicknessMap=this.thicknessMap.toJSON(_e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(nt.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(nt.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(nt.size=this.size),this.shadowSide!==null&&(nt.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(nt.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(nt.blending=this.blending),this.side!==FrontSide&&(nt.side=this.side),this.vertexColors&&(nt.vertexColors=!0),this.opacity<1&&(nt.opacity=this.opacity),this.transparent===!0&&(nt.transparent=this.transparent),nt.depthFunc=this.depthFunc,nt.depthTest=this.depthTest,nt.depthWrite=this.depthWrite,nt.colorWrite=this.colorWrite,nt.stencilWrite=this.stencilWrite,nt.stencilWriteMask=this.stencilWriteMask,nt.stencilFunc=this.stencilFunc,nt.stencilRef=this.stencilRef,nt.stencilFuncMask=this.stencilFuncMask,nt.stencilFail=this.stencilFail,nt.stencilZFail=this.stencilZFail,nt.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(nt.rotation=this.rotation),this.polygonOffset===!0&&(nt.polygonOffset=!0),this.polygonOffsetFactor!==0&&(nt.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(nt.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(nt.linewidth=this.linewidth),this.dashSize!==void 0&&(nt.dashSize=this.dashSize),this.gapSize!==void 0&&(nt.gapSize=this.gapSize),this.scale!==void 0&&(nt.scale=this.scale),this.dithering===!0&&(nt.dithering=!0),this.alphaTest>0&&(nt.alphaTest=this.alphaTest),this.alphaHash===!0&&(nt.alphaHash=this.alphaHash),this.alphaToCoverage===!0&&(nt.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(nt.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(nt.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(nt.wireframe=this.wireframe),this.wireframeLinewidth>1&&(nt.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(nt.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(nt.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(nt.flatShading=this.flatShading),this.visible===!1&&(nt.visible=!1),this.toneMapped===!1&&(nt.toneMapped=!1),this.fog===!1&&(nt.fog=!1),Object.keys(this.userData).length>0&&(nt.userData=this.userData);function it(st){const ot=[];for(const lt in st){const at=st[lt];delete at.metadata,ot.push(at)}return ot}if(rt){const st=it(_e.textures),ot=it(_e.images);st.length>0&&(nt.textures=st),ot.length>0&&(nt.images=ot)}return nt}clone(){return new this.constructor().copy(this)}copy(_e){this.name=_e.name,this.blending=_e.blending,this.side=_e.side,this.vertexColors=_e.vertexColors,this.opacity=_e.opacity,this.transparent=_e.transparent,this.blendSrc=_e.blendSrc,this.blendDst=_e.blendDst,this.blendEquation=_e.blendEquation,this.blendSrcAlpha=_e.blendSrcAlpha,this.blendDstAlpha=_e.blendDstAlpha,this.blendEquationAlpha=_e.blendEquationAlpha,this.depthFunc=_e.depthFunc,this.depthTest=_e.depthTest,this.depthWrite=_e.depthWrite,this.stencilWriteMask=_e.stencilWriteMask,this.stencilFunc=_e.stencilFunc,this.stencilRef=_e.stencilRef,this.stencilFuncMask=_e.stencilFuncMask,this.stencilFail=_e.stencilFail,this.stencilZFail=_e.stencilZFail,this.stencilZPass=_e.stencilZPass,this.stencilWrite=_e.stencilWrite;const rt=_e.clippingPlanes;let nt=null;if(rt!==null){const it=rt.length;nt=new Array(it);for(let st=0;st!==it;++st)nt[st]=rt[st].clone()}return this.clippingPlanes=nt,this.clipIntersection=_e.clipIntersection,this.clipShadows=_e.clipShadows,this.shadowSide=_e.shadowSide,this.colorWrite=_e.colorWrite,this.precision=_e.precision,this.polygonOffset=_e.polygonOffset,this.polygonOffsetFactor=_e.polygonOffsetFactor,this.polygonOffsetUnits=_e.polygonOffsetUnits,this.dithering=_e.dithering,this.alphaTest=_e.alphaTest,this.alphaHash=_e.alphaHash,this.alphaToCoverage=_e.alphaToCoverage,this.premultipliedAlpha=_e.premultipliedAlpha,this.forceSinglePass=_e.forceSinglePass,this.visible=_e.visible,this.toneMapped=_e.toneMapped,this.userData=JSON.parse(JSON.stringify(_e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_e){_e===!0&&this.version++}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(tt,_e,rt){return rt<0&&(rt+=1),rt>1&&(rt-=1),rt<1/6?tt+(_e-tt)*6*rt:rt<1/2?_e:rt<2/3?tt+(_e-tt)*6*(2/3-rt):tt}let Color$1=class{constructor(_e,rt,nt){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_e,rt,nt)}set(_e,rt,nt){if(rt===void 0&&nt===void 0){const it=_e;it&&it.isColor?this.copy(it):typeof it=="number"?this.setHex(it):typeof it=="string"&&this.setStyle(it)}else this.setRGB(_e,rt,nt);return this}setScalar(_e){return this.r=_e,this.g=_e,this.b=_e,this}setHex(_e,rt=SRGBColorSpace){return _e=Math.floor(_e),this.r=(_e>>16&255)/255,this.g=(_e>>8&255)/255,this.b=(_e&255)/255,ColorManagement.toWorkingColorSpace(this,rt),this}setRGB(_e,rt,nt,it=ColorManagement.workingColorSpace){return this.r=_e,this.g=rt,this.b=nt,ColorManagement.toWorkingColorSpace(this,it),this}setHSL(_e,rt,nt,it=ColorManagement.workingColorSpace){if(_e=euclideanModulo(_e,1),rt=clamp$2(rt,0,1),nt=clamp$2(nt,0,1),rt===0)this.r=this.g=this.b=nt;else{const st=nt<=.5?nt*(1+rt):nt+rt-nt*rt,ot=2*nt-st;this.r=hue2rgb(ot,st,_e+1/3),this.g=hue2rgb(ot,st,_e),this.b=hue2rgb(ot,st,_e-1/3)}return ColorManagement.toWorkingColorSpace(this,it),this}setStyle(_e,rt=SRGBColorSpace){function nt(st){st!==void 0&&parseFloat(st)<1&&console.warn("THREE.Color: Alpha component of "+_e+" will be ignored.")}let it;if(it=/^(\w+)\(([^\)]*)\)/.exec(_e)){let st;const ot=it[1],lt=it[2];switch(ot){case"rgb":case"rgba":if(st=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(lt))return nt(st[4]),this.setRGB(Math.min(255,parseInt(st[1],10))/255,Math.min(255,parseInt(st[2],10))/255,Math.min(255,parseInt(st[3],10))/255,rt);if(st=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(lt))return nt(st[4]),this.setRGB(Math.min(100,parseInt(st[1],10))/100,Math.min(100,parseInt(st[2],10))/100,Math.min(100,parseInt(st[3],10))/100,rt);break;case"hsl":case"hsla":if(st=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(lt))return nt(st[4]),this.setHSL(parseFloat(st[1])/360,parseFloat(st[2])/100,parseFloat(st[3])/100,rt);break;default:console.warn("THREE.Color: Unknown color model "+_e)}}else if(it=/^\#([A-Fa-f\d]+)$/.exec(_e)){const st=it[1],ot=st.length;if(ot===3)return this.setRGB(parseInt(st.charAt(0),16)/15,parseInt(st.charAt(1),16)/15,parseInt(st.charAt(2),16)/15,rt);if(ot===6)return this.setHex(parseInt(st,16),rt);console.warn("THREE.Color: Invalid hex color "+_e)}else if(_e&&_e.length>0)return this.setColorName(_e,rt);return this}setColorName(_e,rt=SRGBColorSpace){const nt=_colorKeywords[_e.toLowerCase()];return nt!==void 0?this.setHex(nt,rt):console.warn("THREE.Color: Unknown color "+_e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_e){return this.r=_e.r,this.g=_e.g,this.b=_e.b,this}copySRGBToLinear(_e){return this.r=SRGBToLinear(_e.r),this.g=SRGBToLinear(_e.g),this.b=SRGBToLinear(_e.b),this}copyLinearToSRGB(_e){return this.r=LinearToSRGB(_e.r),this.g=LinearToSRGB(_e.g),this.b=LinearToSRGB(_e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_e=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),_e),Math.round(clamp$2(_color.r*255,0,255))*65536+Math.round(clamp$2(_color.g*255,0,255))*256+Math.round(clamp$2(_color.b*255,0,255))}getHexString(_e=SRGBColorSpace){return("000000"+this.getHex(_e).toString(16)).slice(-6)}getHSL(_e,rt=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),rt);const nt=_color.r,it=_color.g,st=_color.b,ot=Math.max(nt,it,st),lt=Math.min(nt,it,st);let at,ct;const ut=(lt+ot)/2;if(lt===ot)at=0,ct=0;else{const ht=ot-lt;switch(ct=ut<=.5?ht/(ot+lt):ht/(2-ot-lt),ot){case nt:at=(it-st)/ht+(it<st?6:0);break;case it:at=(st-nt)/ht+2;break;case st:at=(nt-it)/ht+4;break}at/=6}return _e.h=at,_e.s=ct,_e.l=ut,_e}getRGB(_e,rt=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),rt),_e.r=_color.r,_e.g=_color.g,_e.b=_color.b,_e}getStyle(_e=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),_e);const rt=_color.r,nt=_color.g,it=_color.b;return _e!==SRGBColorSpace?`color(${_e} ${rt.toFixed(3)} ${nt.toFixed(3)} ${it.toFixed(3)})`:`rgb(${Math.round(rt*255)},${Math.round(nt*255)},${Math.round(it*255)})`}offsetHSL(_e,rt,nt){return this.getHSL(_hslA),_hslA.h+=_e,_hslA.s+=rt,_hslA.l+=nt,this.setHSL(_hslA.h,_hslA.s,_hslA.l),this}add(_e){return this.r+=_e.r,this.g+=_e.g,this.b+=_e.b,this}addColors(_e,rt){return this.r=_e.r+rt.r,this.g=_e.g+rt.g,this.b=_e.b+rt.b,this}addScalar(_e){return this.r+=_e,this.g+=_e,this.b+=_e,this}sub(_e){return this.r=Math.max(0,this.r-_e.r),this.g=Math.max(0,this.g-_e.g),this.b=Math.max(0,this.b-_e.b),this}multiply(_e){return this.r*=_e.r,this.g*=_e.g,this.b*=_e.b,this}multiplyScalar(_e){return this.r*=_e,this.g*=_e,this.b*=_e,this}lerp(_e,rt){return this.r+=(_e.r-this.r)*rt,this.g+=(_e.g-this.g)*rt,this.b+=(_e.b-this.b)*rt,this}lerpColors(_e,rt,nt){return this.r=_e.r+(rt.r-_e.r)*nt,this.g=_e.g+(rt.g-_e.g)*nt,this.b=_e.b+(rt.b-_e.b)*nt,this}lerpHSL(_e,rt){this.getHSL(_hslA),_e.getHSL(_hslB);const nt=lerp(_hslA.h,_hslB.h,rt),it=lerp(_hslA.s,_hslB.s,rt),st=lerp(_hslA.l,_hslB.l,rt);return this.setHSL(nt,it,st),this}setFromVector3(_e){return this.r=_e.x,this.g=_e.y,this.b=_e.z,this}applyMatrix3(_e){const rt=this.r,nt=this.g,it=this.b,st=_e.elements;return this.r=st[0]*rt+st[3]*nt+st[6]*it,this.g=st[1]*rt+st[4]*nt+st[7]*it,this.b=st[2]*rt+st[5]*nt+st[8]*it,this}equals(_e){return _e.r===this.r&&_e.g===this.g&&_e.b===this.b}fromArray(_e,rt=0){return this.r=_e[rt],this.g=_e[rt+1],this.b=_e[rt+2],this}toArray(_e=[],rt=0){return _e[rt]=this.r,_e[rt+1]=this.g,_e[rt+2]=this.b,_e}fromBufferAttribute(_e,rt){return this.r=_e.getX(rt),this.g=_e.getY(rt),this.b=_e.getZ(rt),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const _color=new Color$1;Color$1.NAMES=_colorKeywords;class MeshBasicMaterial extends Material{constructor(_e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.fog=_e.fog,this}}const _tables=_generateTables();function _generateTables(){const tt=new ArrayBuffer(4),_e=new Float32Array(tt),rt=new Uint32Array(tt),nt=new Uint32Array(512),it=new Uint32Array(512);for(let at=0;at<256;++at){const ct=at-127;ct<-27?(nt[at]=0,nt[at|256]=32768,it[at]=24,it[at|256]=24):ct<-14?(nt[at]=1024>>-ct-14,nt[at|256]=1024>>-ct-14|32768,it[at]=-ct-1,it[at|256]=-ct-1):ct<=15?(nt[at]=ct+15<<10,nt[at|256]=ct+15<<10|32768,it[at]=13,it[at|256]=13):ct<128?(nt[at]=31744,nt[at|256]=64512,it[at]=24,it[at|256]=24):(nt[at]=31744,nt[at|256]=64512,it[at]=13,it[at|256]=13)}const st=new Uint32Array(2048),ot=new Uint32Array(64),lt=new Uint32Array(64);for(let at=1;at<1024;++at){let ct=at<<13,ut=0;for(;!(ct&8388608);)ct<<=1,ut-=8388608;ct&=-8388609,ut+=947912704,st[at]=ct|ut}for(let at=1024;at<2048;++at)st[at]=939524096+(at-1024<<13);for(let at=1;at<31;++at)ot[at]=at<<23;ot[31]=1199570944,ot[32]=2147483648;for(let at=33;at<63;++at)ot[at]=2147483648+(at-32<<23);ot[63]=3347054592;for(let at=1;at<64;++at)at!==32&&(lt[at]=1024);return{floatView:_e,uint32View:rt,baseTable:nt,shiftTable:it,mantissaTable:st,exponentTable:ot,offsetTable:lt}}function toHalfFloat(tt){Math.abs(tt)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),tt=clamp$2(tt,-65504,65504),_tables.floatView[0]=tt;const _e=_tables.uint32View[0],rt=_e>>23&511;return _tables.baseTable[rt]+((_e&8388607)>>_tables.shiftTable[rt])}function fromHalfFloat(tt){const _e=tt>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_e]+(tt&1023)]+_tables.exponentTable[_e],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$8=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(_e,rt,nt=!1){if(Array.isArray(_e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_e,this.itemSize=rt,this.count=_e!==void 0?_e.length/rt:0,this.normalized=nt,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(_e){_e===!0&&this.version++}setUsage(_e){return this.usage=_e,this}copy(_e){return this.name=_e.name,this.array=new _e.array.constructor(_e.array),this.itemSize=_e.itemSize,this.count=_e.count,this.normalized=_e.normalized,this.usage=_e.usage,this.gpuType=_e.gpuType,this}copyAt(_e,rt,nt){_e*=this.itemSize,nt*=rt.itemSize;for(let it=0,st=this.itemSize;it<st;it++)this.array[_e+it]=rt.array[nt+it];return this}copyArray(_e){return this.array.set(_e),this}applyMatrix3(_e){if(this.itemSize===2)for(let rt=0,nt=this.count;rt<nt;rt++)_vector2$1.fromBufferAttribute(this,rt),_vector2$1.applyMatrix3(_e),this.setXY(rt,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let rt=0,nt=this.count;rt<nt;rt++)_vector$8.fromBufferAttribute(this,rt),_vector$8.applyMatrix3(_e),this.setXYZ(rt,_vector$8.x,_vector$8.y,_vector$8.z);return this}applyMatrix4(_e){for(let rt=0,nt=this.count;rt<nt;rt++)_vector$8.fromBufferAttribute(this,rt),_vector$8.applyMatrix4(_e),this.setXYZ(rt,_vector$8.x,_vector$8.y,_vector$8.z);return this}applyNormalMatrix(_e){for(let rt=0,nt=this.count;rt<nt;rt++)_vector$8.fromBufferAttribute(this,rt),_vector$8.applyNormalMatrix(_e),this.setXYZ(rt,_vector$8.x,_vector$8.y,_vector$8.z);return this}transformDirection(_e){for(let rt=0,nt=this.count;rt<nt;rt++)_vector$8.fromBufferAttribute(this,rt),_vector$8.transformDirection(_e),this.setXYZ(rt,_vector$8.x,_vector$8.y,_vector$8.z);return this}set(_e,rt=0){return this.array.set(_e,rt),this}getX(_e){let rt=this.array[_e*this.itemSize];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setX(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize]=rt,this}getY(_e){let rt=this.array[_e*this.itemSize+1];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setY(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+1]=rt,this}getZ(_e){let rt=this.array[_e*this.itemSize+2];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setZ(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+2]=rt,this}getW(_e){let rt=this.array[_e*this.itemSize+3];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setW(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+3]=rt,this}setXY(_e,rt,nt){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array)),this.array[_e+0]=rt,this.array[_e+1]=nt,this}setXYZ(_e,rt,nt,it){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array),it=normalize$5(it,this.array)),this.array[_e+0]=rt,this.array[_e+1]=nt,this.array[_e+2]=it,this}setXYZW(_e,rt,nt,it,st){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array),it=normalize$5(it,this.array),st=normalize$5(st,this.array)),this.array[_e+0]=rt,this.array[_e+1]=nt,this.array[_e+2]=it,this.array[_e+3]=st,this}onUpload(_e){return this.onUploadCallback=_e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_e.name=this.name),this.usage!==StaticDrawUsage&&(_e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(_e.updateRange=this.updateRange),_e}}class Int8BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Int8Array(_e),rt,nt)}}class Uint8BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Uint8Array(_e),rt,nt)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Uint8ClampedArray(_e),rt,nt)}}class Int16BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Int16Array(_e),rt,nt)}}class Uint16BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Uint16Array(_e),rt,nt)}}class Int32BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Int32Array(_e),rt,nt)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Uint32Array(_e),rt,nt)}}class Float16BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Uint16Array(_e),rt,nt),this.isFloat16BufferAttribute=!0}getX(_e){let rt=fromHalfFloat(this.array[_e*this.itemSize]);return this.normalized&&(rt=denormalize(rt,this.array)),rt}setX(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize]=toHalfFloat(rt),this}getY(_e){let rt=fromHalfFloat(this.array[_e*this.itemSize+1]);return this.normalized&&(rt=denormalize(rt,this.array)),rt}setY(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+1]=toHalfFloat(rt),this}getZ(_e){let rt=fromHalfFloat(this.array[_e*this.itemSize+2]);return this.normalized&&(rt=denormalize(rt,this.array)),rt}setZ(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+2]=toHalfFloat(rt),this}getW(_e){let rt=fromHalfFloat(this.array[_e*this.itemSize+3]);return this.normalized&&(rt=denormalize(rt,this.array)),rt}setW(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+3]=toHalfFloat(rt),this}setXY(_e,rt,nt){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array)),this.array[_e+0]=toHalfFloat(rt),this.array[_e+1]=toHalfFloat(nt),this}setXYZ(_e,rt,nt,it){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array),it=normalize$5(it,this.array)),this.array[_e+0]=toHalfFloat(rt),this.array[_e+1]=toHalfFloat(nt),this.array[_e+2]=toHalfFloat(it),this}setXYZW(_e,rt,nt,it,st){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array),it=normalize$5(it,this.array),st=normalize$5(st,this.array)),this.array[_e+0]=toHalfFloat(rt),this.array[_e+1]=toHalfFloat(nt),this.array[_e+2]=toHalfFloat(it),this.array[_e+3]=toHalfFloat(st),this}}class Float32BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Float32Array(_e),rt,nt)}}class Float64BufferAttribute extends BufferAttribute{constructor(_e,rt,nt){super(new Float64Array(_e),rt,nt)}}let _id$1=0;const _m1=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$1=new Box3,_boxMorphTargets=new Box3,_vector$7=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$1++}),this.uuid=generateUUID$1(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_e){return Array.isArray(_e)?this.index=new(arrayNeedsUint32(_e)?Uint32BufferAttribute:Uint16BufferAttribute)(_e,1):this.index=_e,this}getAttribute(_e){return this.attributes[_e]}setAttribute(_e,rt){return this.attributes[_e]=rt,this}deleteAttribute(_e){return delete this.attributes[_e],this}hasAttribute(_e){return this.attributes[_e]!==void 0}addGroup(_e,rt,nt=0){this.groups.push({start:_e,count:rt,materialIndex:nt})}clearGroups(){this.groups=[]}setDrawRange(_e,rt){this.drawRange.start=_e,this.drawRange.count=rt}applyMatrix4(_e){const rt=this.attributes.position;rt!==void 0&&(rt.applyMatrix4(_e),rt.needsUpdate=!0);const nt=this.attributes.normal;if(nt!==void 0){const st=new Matrix3().getNormalMatrix(_e);nt.applyNormalMatrix(st),nt.needsUpdate=!0}const it=this.attributes.tangent;return it!==void 0&&(it.transformDirection(_e),it.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_e){return _m1.makeRotationFromQuaternion(_e),this.applyMatrix4(_m1),this}rotateX(_e){return _m1.makeRotationX(_e),this.applyMatrix4(_m1),this}rotateY(_e){return _m1.makeRotationY(_e),this.applyMatrix4(_m1),this}rotateZ(_e){return _m1.makeRotationZ(_e),this.applyMatrix4(_m1),this}translate(_e,rt,nt){return _m1.makeTranslation(_e,rt,nt),this.applyMatrix4(_m1),this}scale(_e,rt,nt){return _m1.makeScale(_e,rt,nt),this.applyMatrix4(_m1),this}lookAt(_e){return _obj.lookAt(_e),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_e){const rt=[];for(let nt=0,it=_e.length;nt<it;nt++){const st=_e[nt];rt.push(st.x,st.y,st.z||0)}return this.setAttribute("position",new Float32BufferAttribute(rt,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _e=this.attributes.position,rt=this.morphAttributes.position;if(_e&&_e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_e!==void 0){if(this.boundingBox.setFromBufferAttribute(_e),rt)for(let nt=0,it=rt.length;nt<it;nt++){const st=rt[nt];_box$1.setFromBufferAttribute(st),this.morphTargetsRelative?(_vector$7.addVectors(this.boundingBox.min,_box$1.min),this.boundingBox.expandByPoint(_vector$7),_vector$7.addVectors(this.boundingBox.max,_box$1.max),this.boundingBox.expandByPoint(_vector$7)):(this.boundingBox.expandByPoint(_box$1.min),this.boundingBox.expandByPoint(_box$1.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _e=this.attributes.position,rt=this.morphAttributes.position;if(_e&&_e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Vector3,1/0);return}if(_e){const nt=this.boundingSphere.center;if(_box$1.setFromBufferAttribute(_e),rt)for(let st=0,ot=rt.length;st<ot;st++){const lt=rt[st];_boxMorphTargets.setFromBufferAttribute(lt),this.morphTargetsRelative?(_vector$7.addVectors(_box$1.min,_boxMorphTargets.min),_box$1.expandByPoint(_vector$7),_vector$7.addVectors(_box$1.max,_boxMorphTargets.max),_box$1.expandByPoint(_vector$7)):(_box$1.expandByPoint(_boxMorphTargets.min),_box$1.expandByPoint(_boxMorphTargets.max))}_box$1.getCenter(nt);let it=0;for(let st=0,ot=_e.count;st<ot;st++)_vector$7.fromBufferAttribute(_e,st),it=Math.max(it,nt.distanceToSquared(_vector$7));if(rt)for(let st=0,ot=rt.length;st<ot;st++){const lt=rt[st],at=this.morphTargetsRelative;for(let ct=0,ut=lt.count;ct<ut;ct++)_vector$7.fromBufferAttribute(lt,ct),at&&(_offset.fromBufferAttribute(_e,ct),_vector$7.add(_offset)),it=Math.max(it,nt.distanceToSquared(_vector$7))}this.boundingSphere.radius=Math.sqrt(it),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _e=this.index,rt=this.attributes;if(_e===null||rt.position===void 0||rt.normal===void 0||rt.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const nt=_e.array,it=rt.position.array,st=rt.normal.array,ot=rt.uv.array,lt=it.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*lt),4));const at=this.getAttribute("tangent").array,ct=[],ut=[];for(let Mt=0;Mt<lt;Mt++)ct[Mt]=new Vector3,ut[Mt]=new Vector3;const ht=new Vector3,dt=new Vector3,ft=new Vector3,pt=new Vector2,mt=new Vector2,gt=new Vector2,vt=new Vector3,At=new Vector3;function yt(Mt,Pt,It){ht.fromArray(it,Mt*3),dt.fromArray(it,Pt*3),ft.fromArray(it,It*3),pt.fromArray(ot,Mt*2),mt.fromArray(ot,Pt*2),gt.fromArray(ot,It*2),dt.sub(ht),ft.sub(ht),mt.sub(pt),gt.sub(pt);const Ot=1/(mt.x*gt.y-gt.x*mt.y);isFinite(Ot)&&(vt.copy(dt).multiplyScalar(gt.y).addScaledVector(ft,-mt.y).multiplyScalar(Ot),At.copy(ft).multiplyScalar(mt.x).addScaledVector(dt,-gt.x).multiplyScalar(Ot),ct[Mt].add(vt),ct[Pt].add(vt),ct[It].add(vt),ut[Mt].add(At),ut[Pt].add(At),ut[It].add(At))}let xt=this.groups;xt.length===0&&(xt=[{start:0,count:nt.length}]);for(let Mt=0,Pt=xt.length;Mt<Pt;++Mt){const It=xt[Mt],Ot=It.start,Bt=It.count;for(let Ut=Ot,Ft=Ot+Bt;Ut<Ft;Ut+=3)yt(nt[Ut+0],nt[Ut+1],nt[Ut+2])}const _t=new Vector3,Et=new Vector3,bt=new Vector3,wt=new Vector3;function Tt(Mt){bt.fromArray(st,Mt*3),wt.copy(bt);const Pt=ct[Mt];_t.copy(Pt),_t.sub(bt.multiplyScalar(bt.dot(Pt))).normalize(),Et.crossVectors(wt,Pt);const Ot=Et.dot(ut[Mt])<0?-1:1;at[Mt*4]=_t.x,at[Mt*4+1]=_t.y,at[Mt*4+2]=_t.z,at[Mt*4+3]=Ot}for(let Mt=0,Pt=xt.length;Mt<Pt;++Mt){const It=xt[Mt],Ot=It.start,Bt=It.count;for(let Ut=Ot,Ft=Ot+Bt;Ut<Ft;Ut+=3)Tt(nt[Ut+0]),Tt(nt[Ut+1]),Tt(nt[Ut+2])}}computeVertexNormals(){const _e=this.index,rt=this.getAttribute("position");if(rt!==void 0){let nt=this.getAttribute("normal");if(nt===void 0)nt=new BufferAttribute(new Float32Array(rt.count*3),3),this.setAttribute("normal",nt);else for(let dt=0,ft=nt.count;dt<ft;dt++)nt.setXYZ(dt,0,0,0);const it=new Vector3,st=new Vector3,ot=new Vector3,lt=new Vector3,at=new Vector3,ct=new Vector3,ut=new Vector3,ht=new Vector3;if(_e)for(let dt=0,ft=_e.count;dt<ft;dt+=3){const pt=_e.getX(dt+0),mt=_e.getX(dt+1),gt=_e.getX(dt+2);it.fromBufferAttribute(rt,pt),st.fromBufferAttribute(rt,mt),ot.fromBufferAttribute(rt,gt),ut.subVectors(ot,st),ht.subVectors(it,st),ut.cross(ht),lt.fromBufferAttribute(nt,pt),at.fromBufferAttribute(nt,mt),ct.fromBufferAttribute(nt,gt),lt.add(ut),at.add(ut),ct.add(ut),nt.setXYZ(pt,lt.x,lt.y,lt.z),nt.setXYZ(mt,at.x,at.y,at.z),nt.setXYZ(gt,ct.x,ct.y,ct.z)}else for(let dt=0,ft=rt.count;dt<ft;dt+=3)it.fromBufferAttribute(rt,dt+0),st.fromBufferAttribute(rt,dt+1),ot.fromBufferAttribute(rt,dt+2),ut.subVectors(ot,st),ht.subVectors(it,st),ut.cross(ht),nt.setXYZ(dt+0,ut.x,ut.y,ut.z),nt.setXYZ(dt+1,ut.x,ut.y,ut.z),nt.setXYZ(dt+2,ut.x,ut.y,ut.z);this.normalizeNormals(),nt.needsUpdate=!0}}normalizeNormals(){const _e=this.attributes.normal;for(let rt=0,nt=_e.count;rt<nt;rt++)_vector$7.fromBufferAttribute(_e,rt),_vector$7.normalize(),_e.setXYZ(rt,_vector$7.x,_vector$7.y,_vector$7.z)}toNonIndexed(){function _e(lt,at){const ct=lt.array,ut=lt.itemSize,ht=lt.normalized,dt=new ct.constructor(at.length*ut);let ft=0,pt=0;for(let mt=0,gt=at.length;mt<gt;mt++){lt.isInterleavedBufferAttribute?ft=at[mt]*lt.data.stride+lt.offset:ft=at[mt]*ut;for(let vt=0;vt<ut;vt++)dt[pt++]=ct[ft++]}return new BufferAttribute(dt,ut,ht)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const rt=new BufferGeometry,nt=this.index.array,it=this.attributes;for(const lt in it){const at=it[lt],ct=_e(at,nt);rt.setAttribute(lt,ct)}const st=this.morphAttributes;for(const lt in st){const at=[],ct=st[lt];for(let ut=0,ht=ct.length;ut<ht;ut++){const dt=ct[ut],ft=_e(dt,nt);at.push(ft)}rt.morphAttributes[lt]=at}rt.morphTargetsRelative=this.morphTargetsRelative;const ot=this.groups;for(let lt=0,at=ot.length;lt<at;lt++){const ct=ot[lt];rt.addGroup(ct.start,ct.count,ct.materialIndex)}return rt}toJSON(){const _e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_e.uuid=this.uuid,_e.type=this.type,this.name!==""&&(_e.name=this.name),Object.keys(this.userData).length>0&&(_e.userData=this.userData),this.parameters!==void 0){const at=this.parameters;for(const ct in at)at[ct]!==void 0&&(_e[ct]=at[ct]);return _e}_e.data={attributes:{}};const rt=this.index;rt!==null&&(_e.data.index={type:rt.array.constructor.name,array:Array.prototype.slice.call(rt.array)});const nt=this.attributes;for(const at in nt){const ct=nt[at];_e.data.attributes[at]=ct.toJSON(_e.data)}const it={};let st=!1;for(const at in this.morphAttributes){const ct=this.morphAttributes[at],ut=[];for(let ht=0,dt=ct.length;ht<dt;ht++){const ft=ct[ht];ut.push(ft.toJSON(_e.data))}ut.length>0&&(it[at]=ut,st=!0)}st&&(_e.data.morphAttributes=it,_e.data.morphTargetsRelative=this.morphTargetsRelative);const ot=this.groups;ot.length>0&&(_e.data.groups=JSON.parse(JSON.stringify(ot)));const lt=this.boundingSphere;return lt!==null&&(_e.data.boundingSphere={center:lt.center.toArray(),radius:lt.radius}),_e}clone(){return new this.constructor().copy(this)}copy(_e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const rt={};this.name=_e.name;const nt=_e.index;nt!==null&&this.setIndex(nt.clone(rt));const it=_e.attributes;for(const ct in it){const ut=it[ct];this.setAttribute(ct,ut.clone(rt))}const st=_e.morphAttributes;for(const ct in st){const ut=[],ht=st[ct];for(let dt=0,ft=ht.length;dt<ft;dt++)ut.push(ht[dt].clone(rt));this.morphAttributes[ct]=ut}this.morphTargetsRelative=_e.morphTargetsRelative;const ot=_e.groups;for(let ct=0,ut=ot.length;ct<ut;ct++){const ht=ot[ct];this.addGroup(ht.start,ht.count,ht.materialIndex)}const lt=_e.boundingBox;lt!==null&&(this.boundingBox=lt.clone());const at=_e.boundingSphere;return at!==null&&(this.boundingSphere=at.clone()),this.drawRange.start=_e.drawRange.start,this.drawRange.count=_e.drawRange.count,this.userData=_e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray$1,_sphere$5=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_e=new BufferGeometry,rt=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_e,this.material=rt,this.updateMorphTargets()}copy(_e,rt){return super.copy(_e,rt),_e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_e.morphTargetInfluences.slice()),_e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_e.morphTargetDictionary)),this.material=_e.material,this.geometry=_e.geometry,this}updateMorphTargets(){const rt=this.geometry.morphAttributes,nt=Object.keys(rt);if(nt.length>0){const it=rt[nt[0]];if(it!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,ot=it.length;st<ot;st++){const lt=it[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[lt]=st}}}}getVertexPosition(_e,rt){const nt=this.geometry,it=nt.attributes.position,st=nt.morphAttributes.position,ot=nt.morphTargetsRelative;rt.fromBufferAttribute(it,_e);const lt=this.morphTargetInfluences;if(st&&lt){_morphA.set(0,0,0);for(let at=0,ct=st.length;at<ct;at++){const ut=lt[at],ht=st[at];ut!==0&&(_tempA.fromBufferAttribute(ht,_e),ot?_morphA.addScaledVector(_tempA,ut):_morphA.addScaledVector(_tempA.sub(rt),ut))}rt.add(_morphA)}return rt}raycast(_e,rt){const nt=this.geometry,it=this.material,st=this.matrixWorld;it!==void 0&&(nt.boundingSphere===null&&nt.computeBoundingSphere(),_sphere$5.copy(nt.boundingSphere),_sphere$5.applyMatrix4(st),_ray$3.copy(_e.ray).recast(_e.near),!(_sphere$5.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$5,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(_e.far-_e.near)**2))&&(_inverseMatrix$3.copy(st).invert(),_ray$3.copy(_e.ray).applyMatrix4(_inverseMatrix$3),!(nt.boundingBox!==null&&_ray$3.intersectsBox(nt.boundingBox)===!1)&&this._computeIntersections(_e,rt,_ray$3)))}_computeIntersections(_e,rt,nt){let it;const st=this.geometry,ot=this.material,lt=st.index,at=st.attributes.position,ct=st.attributes.uv,ut=st.attributes.uv1,ht=st.attributes.normal,dt=st.groups,ft=st.drawRange;if(lt!==null)if(Array.isArray(ot))for(let pt=0,mt=dt.length;pt<mt;pt++){const gt=dt[pt],vt=ot[gt.materialIndex],At=Math.max(gt.start,ft.start),yt=Math.min(lt.count,Math.min(gt.start+gt.count,ft.start+ft.count));for(let xt=At,_t=yt;xt<_t;xt+=3){const Et=lt.getX(xt),bt=lt.getX(xt+1),wt=lt.getX(xt+2);it=checkGeometryIntersection(this,vt,_e,nt,ct,ut,ht,Et,bt,wt),it&&(it.faceIndex=Math.floor(xt/3),it.face.materialIndex=gt.materialIndex,rt.push(it))}}else{const pt=Math.max(0,ft.start),mt=Math.min(lt.count,ft.start+ft.count);for(let gt=pt,vt=mt;gt<vt;gt+=3){const At=lt.getX(gt),yt=lt.getX(gt+1),xt=lt.getX(gt+2);it=checkGeometryIntersection(this,ot,_e,nt,ct,ut,ht,At,yt,xt),it&&(it.faceIndex=Math.floor(gt/3),rt.push(it))}}else if(at!==void 0)if(Array.isArray(ot))for(let pt=0,mt=dt.length;pt<mt;pt++){const gt=dt[pt],vt=ot[gt.materialIndex],At=Math.max(gt.start,ft.start),yt=Math.min(at.count,Math.min(gt.start+gt.count,ft.start+ft.count));for(let xt=At,_t=yt;xt<_t;xt+=3){const Et=xt,bt=xt+1,wt=xt+2;it=checkGeometryIntersection(this,vt,_e,nt,ct,ut,ht,Et,bt,wt),it&&(it.faceIndex=Math.floor(xt/3),it.face.materialIndex=gt.materialIndex,rt.push(it))}}else{const pt=Math.max(0,ft.start),mt=Math.min(at.count,ft.start+ft.count);for(let gt=pt,vt=mt;gt<vt;gt+=3){const At=gt,yt=gt+1,xt=gt+2;it=checkGeometryIntersection(this,ot,_e,nt,ct,ut,ht,At,yt,xt),it&&(it.faceIndex=Math.floor(gt/3),rt.push(it))}}}}function checkIntersection(tt,_e,rt,nt,it,st,ot,lt){let at;if(_e.side===BackSide?at=nt.intersectTriangle(ot,st,it,!0,lt):at=nt.intersectTriangle(it,st,ot,_e.side===FrontSide,lt),at===null)return null;_intersectionPointWorld.copy(lt),_intersectionPointWorld.applyMatrix4(tt.matrixWorld);const ct=rt.ray.origin.distanceTo(_intersectionPointWorld);return ct<rt.near||ct>rt.far?null:{distance:ct,point:_intersectionPointWorld.clone(),object:tt}}function checkGeometryIntersection(tt,_e,rt,nt,it,st,ot,lt,at,ct){tt.getVertexPosition(lt,_vA$1),tt.getVertexPosition(at,_vB$1),tt.getVertexPosition(ct,_vC$1);const ut=checkIntersection(tt,_e,rt,nt,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(ut){it&&(_uvA$1.fromBufferAttribute(it,lt),_uvB$1.fromBufferAttribute(it,at),_uvC$1.fromBufferAttribute(it,ct),ut.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),st&&(_uvA$1.fromBufferAttribute(st,lt),_uvB$1.fromBufferAttribute(st,at),_uvC$1.fromBufferAttribute(st,ct),ut.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),ut.uv2=ut.uv1),ot&&(_normalA.fromBufferAttribute(ot,lt),_normalB.fromBufferAttribute(ot,at),_normalC.fromBufferAttribute(ot,ct),ut.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),ut.normal.dot(nt.direction)>0&&ut.normal.multiplyScalar(-1));const ht={a:lt,b:at,c:ct,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,ht.normal),ut.face=ht}return ut}class BoxGeometry extends BufferGeometry{constructor(_e=1,rt=1,nt=1,it=1,st=1,ot=1){super(),this.type="BoxGeometry",this.parameters={width:_e,height:rt,depth:nt,widthSegments:it,heightSegments:st,depthSegments:ot};const lt=this;it=Math.floor(it),st=Math.floor(st),ot=Math.floor(ot);const at=[],ct=[],ut=[],ht=[];let dt=0,ft=0;pt("z","y","x",-1,-1,nt,rt,_e,ot,st,0),pt("z","y","x",1,-1,nt,rt,-_e,ot,st,1),pt("x","z","y",1,1,_e,nt,rt,it,ot,2),pt("x","z","y",1,-1,_e,nt,-rt,it,ot,3),pt("x","y","z",1,-1,_e,rt,nt,it,st,4),pt("x","y","z",-1,-1,_e,rt,-nt,it,st,5),this.setIndex(at),this.setAttribute("position",new Float32BufferAttribute(ct,3)),this.setAttribute("normal",new Float32BufferAttribute(ut,3)),this.setAttribute("uv",new Float32BufferAttribute(ht,2));function pt(mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt){const Mt=xt/bt,Pt=_t/wt,It=xt/2,Ot=_t/2,Bt=Et/2,Ut=bt+1,Ft=wt+1;let jt=0,Dt=0;const Gt=new Vector3;for(let zt=0;zt<Ft;zt++){const $t=zt*Pt-Ot;for(let Ht=0;Ht<Ut;Ht++){const er=Ht*Mt-It;Gt[mt]=er*At,Gt[gt]=$t*yt,Gt[vt]=Bt,ct.push(Gt.x,Gt.y,Gt.z),Gt[mt]=0,Gt[gt]=0,Gt[vt]=Et>0?1:-1,ut.push(Gt.x,Gt.y,Gt.z),ht.push(Ht/bt),ht.push(1-zt/wt),jt+=1}}for(let zt=0;zt<wt;zt++)for(let $t=0;$t<bt;$t++){const Ht=dt+$t+Ut*zt,er=dt+$t+Ut*(zt+1),Zt=dt+($t+1)+Ut*(zt+1),or=dt+($t+1)+Ut*zt;at.push(Ht,er,or),at.push(er,Zt,or),Dt+=6}lt.addGroup(ft,Dt,Tt),ft+=Dt,dt+=jt}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new BoxGeometry(_e.width,_e.height,_e.depth,_e.widthSegments,_e.heightSegments,_e.depthSegments)}}function cloneUniforms(tt){const _e={};for(const rt in tt){_e[rt]={};for(const nt in tt[rt]){const it=tt[rt][nt];it&&(it.isColor||it.isMatrix3||it.isMatrix4||it.isVector2||it.isVector3||it.isVector4||it.isTexture||it.isQuaternion)?it.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_e[rt][nt]=null):_e[rt][nt]=it.clone():Array.isArray(it)?_e[rt][nt]=it.slice():_e[rt][nt]=it}}return _e}function mergeUniforms(tt){const _e={};for(let rt=0;rt<tt.length;rt++){const nt=cloneUniforms(tt[rt]);for(const it in nt)_e[it]=nt[it]}return _e}function cloneUniformsGroups(tt){const _e=[];for(let rt=0;rt<tt.length;rt++)_e.push(tt[rt].clone());return _e}function getUnlitUniformColorSpace(tt){return tt.getRenderTarget()===null?tt.outputColorSpace:LinearSRGBColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(_e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_e!==void 0&&this.setValues(_e)}copy(_e){return super.copy(_e),this.fragmentShader=_e.fragmentShader,this.vertexShader=_e.vertexShader,this.uniforms=cloneUniforms(_e.uniforms),this.uniformsGroups=cloneUniformsGroups(_e.uniformsGroups),this.defines=Object.assign({},_e.defines),this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.fog=_e.fog,this.lights=_e.lights,this.clipping=_e.clipping,this.extensions=Object.assign({},_e.extensions),this.glslVersion=_e.glslVersion,this}toJSON(_e){const rt=super.toJSON(_e);rt.glslVersion=this.glslVersion,rt.uniforms={};for(const it in this.uniforms){const ot=this.uniforms[it].value;ot&&ot.isTexture?rt.uniforms[it]={type:"t",value:ot.toJSON(_e).uuid}:ot&&ot.isColor?rt.uniforms[it]={type:"c",value:ot.getHex()}:ot&&ot.isVector2?rt.uniforms[it]={type:"v2",value:ot.toArray()}:ot&&ot.isVector3?rt.uniforms[it]={type:"v3",value:ot.toArray()}:ot&&ot.isVector4?rt.uniforms[it]={type:"v4",value:ot.toArray()}:ot&&ot.isMatrix3?rt.uniforms[it]={type:"m3",value:ot.toArray()}:ot&&ot.isMatrix4?rt.uniforms[it]={type:"m4",value:ot.toArray()}:rt.uniforms[it]={value:ot}}Object.keys(this.defines).length>0&&(rt.defines=this.defines),rt.vertexShader=this.vertexShader,rt.fragmentShader=this.fragmentShader,rt.lights=this.lights,rt.clipping=this.clipping;const nt={};for(const it in this.extensions)this.extensions[it]===!0&&(nt[it]=!0);return Object.keys(nt).length>0&&(rt.extensions=nt),rt}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(_e,rt){return super.copy(_e,rt),this.matrixWorldInverse.copy(_e.matrixWorldInverse),this.projectionMatrix.copy(_e.projectionMatrix),this.projectionMatrixInverse.copy(_e.projectionMatrixInverse),this.coordinateSystem=_e.coordinateSystem,this}getWorldDirection(_e){this.updateWorldMatrix(!0,!1);const rt=this.matrixWorld.elements;return _e.set(-rt[8],-rt[9],-rt[10]).normalize()}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_e,rt){super.updateWorldMatrix(_e,rt),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class PerspectiveCamera extends Camera{constructor(_e=50,rt=1,nt=.1,it=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_e,this.zoom=1,this.near=nt,this.far=it,this.focus=10,this.aspect=rt,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_e,rt){return super.copy(_e,rt),this.fov=_e.fov,this.zoom=_e.zoom,this.near=_e.near,this.far=_e.far,this.focus=_e.focus,this.aspect=_e.aspect,this.view=_e.view===null?null:Object.assign({},_e.view),this.filmGauge=_e.filmGauge,this.filmOffset=_e.filmOffset,this}setFocalLength(_e){const rt=.5*this.getFilmHeight()/_e;this.fov=RAD2DEG*2*Math.atan(rt),this.updateProjectionMatrix()}getFocalLength(){const _e=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_e}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(_e,rt,nt,it,st,ot){this.aspect=_e/rt,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_e,this.view.fullHeight=rt,this.view.offsetX=nt,this.view.offsetY=it,this.view.width=st,this.view.height=ot,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _e=this.near;let rt=_e*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,nt=2*rt,it=this.aspect*nt,st=-.5*it;const ot=this.view;if(this.view!==null&&this.view.enabled){const at=ot.fullWidth,ct=ot.fullHeight;st+=ot.offsetX*it/at,rt-=ot.offsetY*nt/ct,it*=ot.width/at,nt*=ot.height/ct}const lt=this.filmOffset;lt!==0&&(st+=_e*lt/this.getFilmWidth()),this.projectionMatrix.makePerspective(st,st+it,rt,rt-nt,_e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_e){const rt=super.toJSON(_e);return rt.object.fov=this.fov,rt.object.zoom=this.zoom,rt.object.near=this.near,rt.object.far=this.far,rt.object.focus=this.focus,rt.object.aspect=this.aspect,this.view!==null&&(rt.object.view=Object.assign({},this.view)),rt.object.filmGauge=this.filmGauge,rt.object.filmOffset=this.filmOffset,rt}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(_e,rt,nt){super(),this.type="CubeCamera",this.renderTarget=nt,this.coordinateSystem=null;const it=new PerspectiveCamera(fov,aspect,_e,rt);it.layers=this.layers,this.add(it);const st=new PerspectiveCamera(fov,aspect,_e,rt);st.layers=this.layers,this.add(st);const ot=new PerspectiveCamera(fov,aspect,_e,rt);ot.layers=this.layers,this.add(ot);const lt=new PerspectiveCamera(fov,aspect,_e,rt);lt.layers=this.layers,this.add(lt);const at=new PerspectiveCamera(fov,aspect,_e,rt);at.layers=this.layers,this.add(at);const ct=new PerspectiveCamera(fov,aspect,_e,rt);ct.layers=this.layers,this.add(ct)}updateCoordinateSystem(){const _e=this.coordinateSystem,rt=this.children.concat(),[nt,it,st,ot,lt,at]=rt;for(const ct of rt)this.remove(ct);if(_e===WebGLCoordinateSystem)nt.up.set(0,1,0),nt.lookAt(1,0,0),it.up.set(0,1,0),it.lookAt(-1,0,0),st.up.set(0,0,-1),st.lookAt(0,1,0),ot.up.set(0,0,1),ot.lookAt(0,-1,0),lt.up.set(0,1,0),lt.lookAt(0,0,1),at.up.set(0,1,0),at.lookAt(0,0,-1);else if(_e===WebGPUCoordinateSystem)nt.up.set(0,-1,0),nt.lookAt(-1,0,0),it.up.set(0,-1,0),it.lookAt(1,0,0),st.up.set(0,0,1),st.lookAt(0,1,0),ot.up.set(0,0,-1),ot.lookAt(0,-1,0),lt.up.set(0,-1,0),lt.lookAt(0,0,1),at.up.set(0,-1,0),at.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_e);for(const ct of rt)this.add(ct),ct.updateMatrixWorld()}update(_e,rt){this.parent===null&&this.updateMatrixWorld();const nt=this.renderTarget;this.coordinateSystem!==_e.coordinateSystem&&(this.coordinateSystem=_e.coordinateSystem,this.updateCoordinateSystem());const[it,st,ot,lt,at,ct]=this.children,ut=_e.getRenderTarget(),ht=_e.toneMapping,dt=_e.xr.enabled;_e.toneMapping=NoToneMapping,_e.xr.enabled=!1;const ft=nt.texture.generateMipmaps;nt.texture.generateMipmaps=!1,_e.setRenderTarget(nt,0),_e.render(rt,it),_e.setRenderTarget(nt,1),_e.render(rt,st),_e.setRenderTarget(nt,2),_e.render(rt,ot),_e.setRenderTarget(nt,3),_e.render(rt,lt),_e.setRenderTarget(nt,4),_e.render(rt,at),nt.texture.generateMipmaps=ft,_e.setRenderTarget(nt,5),_e.render(rt,ct),_e.setRenderTarget(ut),_e.toneMapping=ht,_e.xr.enabled=dt,nt.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(_e,rt,nt,it,st,ot,lt,at,ct,ut){_e=_e!==void 0?_e:[],rt=rt!==void 0?rt:CubeReflectionMapping,super(_e,rt,nt,it,st,ot,lt,at,ct,ut),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_e){this.image=_e}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_e=1,rt={}){super(_e,_e,rt),this.isWebGLCubeRenderTarget=!0;const nt={width:_e,height:_e,depth:1},it=[nt,nt,nt,nt,nt,nt];rt.encoding!==void 0&&(warnOnce("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),rt.colorSpace=rt.encoding===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.texture=new CubeTexture(it,rt.mapping,rt.wrapS,rt.wrapT,rt.magFilter,rt.minFilter,rt.format,rt.type,rt.anisotropy,rt.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=rt.generateMipmaps!==void 0?rt.generateMipmaps:!1,this.texture.minFilter=rt.minFilter!==void 0?rt.minFilter:LinearFilter}fromEquirectangularTexture(_e,rt){this.texture.type=rt.type,this.texture.colorSpace=rt.colorSpace,this.texture.generateMipmaps=rt.generateMipmaps,this.texture.minFilter=rt.minFilter,this.texture.magFilter=rt.magFilter;const nt={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},it=new BoxGeometry(5,5,5),st=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(nt.uniforms),vertexShader:nt.vertexShader,fragmentShader:nt.fragmentShader,side:BackSide,blending:NoBlending});st.uniforms.tEquirect.value=rt;const ot=new Mesh(it,st),lt=rt.minFilter;return rt.minFilter===LinearMipmapLinearFilter&&(rt.minFilter=LinearFilter),new CubeCamera(1,10,this).update(_e,ot),rt.minFilter=lt,ot.geometry.dispose(),ot.material.dispose(),this}clear(_e,rt,nt,it){const st=_e.getRenderTarget();for(let ot=0;ot<6;ot++)_e.setRenderTarget(this,ot),_e.clear(rt,nt,it);_e.setRenderTarget(st)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(_e=new Vector3(1,0,0),rt=0){this.isPlane=!0,this.normal=_e,this.constant=rt}set(_e,rt){return this.normal.copy(_e),this.constant=rt,this}setComponents(_e,rt,nt,it){return this.normal.set(_e,rt,nt),this.constant=it,this}setFromNormalAndCoplanarPoint(_e,rt){return this.normal.copy(_e),this.constant=-rt.dot(this.normal),this}setFromCoplanarPoints(_e,rt,nt){const it=_vector1.subVectors(nt,rt).cross(_vector2.subVectors(_e,rt)).normalize();return this.setFromNormalAndCoplanarPoint(it,_e),this}copy(_e){return this.normal.copy(_e.normal),this.constant=_e.constant,this}normalize(){const _e=1/this.normal.length();return this.normal.multiplyScalar(_e),this.constant*=_e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_e){return this.normal.dot(_e)+this.constant}distanceToSphere(_e){return this.distanceToPoint(_e.center)-_e.radius}projectPoint(_e,rt){return rt.copy(_e).addScaledVector(this.normal,-this.distanceToPoint(_e))}intersectLine(_e,rt){const nt=_e.delta(_vector1),it=this.normal.dot(nt);if(it===0)return this.distanceToPoint(_e.start)===0?rt.copy(_e.start):null;const st=-(_e.start.dot(this.normal)+this.constant)/it;return st<0||st>1?null:rt.copy(_e.start).addScaledVector(nt,st)}intersectsLine(_e){const rt=this.distanceToPoint(_e.start),nt=this.distanceToPoint(_e.end);return rt<0&&nt>0||nt<0&&rt>0}intersectsBox(_e){return _e.intersectsPlane(this)}intersectsSphere(_e){return _e.intersectsPlane(this)}coplanarPoint(_e){return _e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_e,rt){const nt=rt||_normalMatrix.getNormalMatrix(_e),it=this.coplanarPoint(_vector1).applyMatrix4(_e),st=this.normal.applyMatrix3(nt).normalize();return this.constant=-it.dot(st),this}translate(_e){return this.constant-=_e.dot(this.normal),this}equals(_e){return _e.normal.equals(this.normal)&&_e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$4=new Sphere,_vector$6=new Vector3;class Frustum{constructor(_e=new Plane,rt=new Plane,nt=new Plane,it=new Plane,st=new Plane,ot=new Plane){this.planes=[_e,rt,nt,it,st,ot]}set(_e,rt,nt,it,st,ot){const lt=this.planes;return lt[0].copy(_e),lt[1].copy(rt),lt[2].copy(nt),lt[3].copy(it),lt[4].copy(st),lt[5].copy(ot),this}copy(_e){const rt=this.planes;for(let nt=0;nt<6;nt++)rt[nt].copy(_e.planes[nt]);return this}setFromProjectionMatrix(_e,rt=WebGLCoordinateSystem){const nt=this.planes,it=_e.elements,st=it[0],ot=it[1],lt=it[2],at=it[3],ct=it[4],ut=it[5],ht=it[6],dt=it[7],ft=it[8],pt=it[9],mt=it[10],gt=it[11],vt=it[12],At=it[13],yt=it[14],xt=it[15];if(nt[0].setComponents(at-st,dt-ct,gt-ft,xt-vt).normalize(),nt[1].setComponents(at+st,dt+ct,gt+ft,xt+vt).normalize(),nt[2].setComponents(at+ot,dt+ut,gt+pt,xt+At).normalize(),nt[3].setComponents(at-ot,dt-ut,gt-pt,xt-At).normalize(),nt[4].setComponents(at-lt,dt-ht,gt-mt,xt-yt).normalize(),rt===WebGLCoordinateSystem)nt[5].setComponents(at+lt,dt+ht,gt+mt,xt+yt).normalize();else if(rt===WebGPUCoordinateSystem)nt[5].setComponents(lt,ht,mt,yt).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+rt);return this}intersectsObject(_e){if(_e.boundingSphere!==void 0)_e.boundingSphere===null&&_e.computeBoundingSphere(),_sphere$4.copy(_e.boundingSphere).applyMatrix4(_e.matrixWorld);else{const rt=_e.geometry;rt.boundingSphere===null&&rt.computeBoundingSphere(),_sphere$4.copy(rt.boundingSphere).applyMatrix4(_e.matrixWorld)}return this.intersectsSphere(_sphere$4)}intersectsSprite(_e){return _sphere$4.center.set(0,0,0),_sphere$4.radius=.7071067811865476,_sphere$4.applyMatrix4(_e.matrixWorld),this.intersectsSphere(_sphere$4)}intersectsSphere(_e){const rt=this.planes,nt=_e.center,it=-_e.radius;for(let st=0;st<6;st++)if(rt[st].distanceToPoint(nt)<it)return!1;return!0}intersectsBox(_e){const rt=this.planes;for(let nt=0;nt<6;nt++){const it=rt[nt];if(_vector$6.x=it.normal.x>0?_e.max.x:_e.min.x,_vector$6.y=it.normal.y>0?_e.max.y:_e.min.y,_vector$6.z=it.normal.z>0?_e.max.z:_e.min.z,it.distanceToPoint(_vector$6)<0)return!1}return!0}containsPoint(_e){const rt=this.planes;for(let nt=0;nt<6;nt++)if(rt[nt].distanceToPoint(_e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let tt=null,_e=!1,rt=null,nt=null;function it(st,ot){rt(st,ot),nt=tt.requestAnimationFrame(it)}return{start:function(){_e!==!0&&rt!==null&&(nt=tt.requestAnimationFrame(it),_e=!0)},stop:function(){tt.cancelAnimationFrame(nt),_e=!1},setAnimationLoop:function(st){rt=st},setContext:function(st){tt=st}}}function WebGLAttributes(tt,_e){const rt=_e.isWebGL2,nt=new WeakMap;function it(ct,ut){const ht=ct.array,dt=ct.usage,ft=tt.createBuffer();tt.bindBuffer(ut,ft),tt.bufferData(ut,ht,dt),ct.onUploadCallback();let pt;if(ht instanceof Float32Array)pt=tt.FLOAT;else if(ht instanceof Uint16Array)if(ct.isFloat16BufferAttribute)if(rt)pt=tt.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else pt=tt.UNSIGNED_SHORT;else if(ht instanceof Int16Array)pt=tt.SHORT;else if(ht instanceof Uint32Array)pt=tt.UNSIGNED_INT;else if(ht instanceof Int32Array)pt=tt.INT;else if(ht instanceof Int8Array)pt=tt.BYTE;else if(ht instanceof Uint8Array)pt=tt.UNSIGNED_BYTE;else if(ht instanceof Uint8ClampedArray)pt=tt.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+ht);return{buffer:ft,type:pt,bytesPerElement:ht.BYTES_PER_ELEMENT,version:ct.version}}function st(ct,ut,ht){const dt=ut.array,ft=ut.updateRange;tt.bindBuffer(ht,ct),ft.count===-1?tt.bufferSubData(ht,0,dt):(rt?tt.bufferSubData(ht,ft.offset*dt.BYTES_PER_ELEMENT,dt,ft.offset,ft.count):tt.bufferSubData(ht,ft.offset*dt.BYTES_PER_ELEMENT,dt.subarray(ft.offset,ft.offset+ft.count)),ft.count=-1),ut.onUploadCallback()}function ot(ct){return ct.isInterleavedBufferAttribute&&(ct=ct.data),nt.get(ct)}function lt(ct){ct.isInterleavedBufferAttribute&&(ct=ct.data);const ut=nt.get(ct);ut&&(tt.deleteBuffer(ut.buffer),nt.delete(ct))}function at(ct,ut){if(ct.isGLBufferAttribute){const dt=nt.get(ct);(!dt||dt.version<ct.version)&&nt.set(ct,{buffer:ct.buffer,type:ct.type,bytesPerElement:ct.elementSize,version:ct.version});return}ct.isInterleavedBufferAttribute&&(ct=ct.data);const ht=nt.get(ct);ht===void 0?nt.set(ct,it(ct,ut)):ht.version<ct.version&&(st(ht.buffer,ct,ut),ht.version=ct.version)}return{get:ot,remove:lt,update:at}}class PlaneGeometry extends BufferGeometry{constructor(_e=1,rt=1,nt=1,it=1){super(),this.type="PlaneGeometry",this.parameters={width:_e,height:rt,widthSegments:nt,heightSegments:it};const st=_e/2,ot=rt/2,lt=Math.floor(nt),at=Math.floor(it),ct=lt+1,ut=at+1,ht=_e/lt,dt=rt/at,ft=[],pt=[],mt=[],gt=[];for(let vt=0;vt<ut;vt++){const At=vt*dt-ot;for(let yt=0;yt<ct;yt++){const xt=yt*ht-st;pt.push(xt,-At,0),mt.push(0,0,1),gt.push(yt/lt),gt.push(1-vt/at)}}for(let vt=0;vt<at;vt++)for(let At=0;At<lt;At++){const yt=At+ct*vt,xt=At+ct*(vt+1),_t=At+1+ct*(vt+1),Et=At+1+ct*vt;ft.push(yt,xt,Et),ft.push(xt,_t,Et)}this.setIndex(ft),this.setAttribute("position",new Float32BufferAttribute(pt,3)),this.setAttribute("normal",new Float32BufferAttribute(mt,3)),this.setAttribute("uv",new Float32BufferAttribute(gt,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new PlaneGeometry(_e.width,_e.height,_e.widthSegments,_e.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_fragment=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color$1(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},specular:{value:new Color$1(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color$1(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color$1(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color$1(0)},specularColor:{value:new Color$1(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0};function WebGLBackground(tt,_e,rt,nt,it,st,ot){const lt=new Color$1(0);let at=st===!0?0:1,ct,ut,ht=null,dt=0,ft=null;function pt(gt,vt){let At=!1,yt=vt.isScene===!0?vt.background:null;switch(yt&&yt.isTexture&&(yt=(vt.backgroundBlurriness>0?rt:_e).get(yt)),yt===null?mt(lt,at):yt&&yt.isColor&&(mt(yt,1),At=!0),tt.xr.getEnvironmentBlendMode()){case"opaque":At=!0;break;case"additive":nt.buffers.color.setClear(0,0,0,1,ot),At=!0;break;case"alpha-blend":nt.buffers.color.setClear(0,0,0,0,ot),At=!0;break}(tt.autoClear||At)&&tt.clear(tt.autoClearColor,tt.autoClearDepth,tt.autoClearStencil),yt&&(yt.isCubeTexture||yt.mapping===CubeUVReflectionMapping)?(ut===void 0&&(ut=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),ut.geometry.deleteAttribute("normal"),ut.geometry.deleteAttribute("uv"),ut.onBeforeRender=function(Et,bt,wt){this.matrixWorld.copyPosition(wt.matrixWorld)},Object.defineProperty(ut.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),it.update(ut)),ut.material.uniforms.envMap.value=yt,ut.material.uniforms.flipEnvMap.value=yt.isCubeTexture&&yt.isRenderTargetTexture===!1?-1:1,ut.material.uniforms.backgroundBlurriness.value=vt.backgroundBlurriness,ut.material.uniforms.backgroundIntensity.value=vt.backgroundIntensity,ut.material.toneMapped=yt.colorSpace!==SRGBColorSpace,(ht!==yt||dt!==yt.version||ft!==tt.toneMapping)&&(ut.material.needsUpdate=!0,ht=yt,dt=yt.version,ft=tt.toneMapping),ut.layers.enableAll(),gt.unshift(ut,ut.geometry,ut.material,0,0,null)):yt&&yt.isTexture&&(ct===void 0&&(ct=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),ct.geometry.deleteAttribute("normal"),Object.defineProperty(ct.material,"map",{get:function(){return this.uniforms.t2D.value}}),it.update(ct)),ct.material.uniforms.t2D.value=yt,ct.material.uniforms.backgroundIntensity.value=vt.backgroundIntensity,ct.material.toneMapped=yt.colorSpace!==SRGBColorSpace,yt.matrixAutoUpdate===!0&&yt.updateMatrix(),ct.material.uniforms.uvTransform.value.copy(yt.matrix),(ht!==yt||dt!==yt.version||ft!==tt.toneMapping)&&(ct.material.needsUpdate=!0,ht=yt,dt=yt.version,ft=tt.toneMapping),ct.layers.enableAll(),gt.unshift(ct,ct.geometry,ct.material,0,0,null))}function mt(gt,vt){gt.getRGB(_rgb,getUnlitUniformColorSpace(tt)),nt.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,vt,ot)}return{getClearColor:function(){return lt},setClearColor:function(gt,vt=1){lt.set(gt),at=vt,mt(lt,at)},getClearAlpha:function(){return at},setClearAlpha:function(gt){at=gt,mt(lt,at)},render:pt}}function WebGLBindingStates(tt,_e,rt,nt){const it=tt.getParameter(tt.MAX_VERTEX_ATTRIBS),st=nt.isWebGL2?null:_e.get("OES_vertex_array_object"),ot=nt.isWebGL2||st!==null,lt={},at=gt(null);let ct=at,ut=!1;function ht(Bt,Ut,Ft,jt,Dt){let Gt=!1;if(ot){const zt=mt(jt,Ft,Ut);ct!==zt&&(ct=zt,ft(ct.object)),Gt=vt(Bt,jt,Ft,Dt),Gt&&At(Bt,jt,Ft,Dt)}else{const zt=Ut.wireframe===!0;(ct.geometry!==jt.id||ct.program!==Ft.id||ct.wireframe!==zt)&&(ct.geometry=jt.id,ct.program=Ft.id,ct.wireframe=zt,Gt=!0)}Dt!==null&&rt.update(Dt,tt.ELEMENT_ARRAY_BUFFER),(Gt||ut)&&(ut=!1,wt(Bt,Ut,Ft,jt),Dt!==null&&tt.bindBuffer(tt.ELEMENT_ARRAY_BUFFER,rt.get(Dt).buffer))}function dt(){return nt.isWebGL2?tt.createVertexArray():st.createVertexArrayOES()}function ft(Bt){return nt.isWebGL2?tt.bindVertexArray(Bt):st.bindVertexArrayOES(Bt)}function pt(Bt){return nt.isWebGL2?tt.deleteVertexArray(Bt):st.deleteVertexArrayOES(Bt)}function mt(Bt,Ut,Ft){const jt=Ft.wireframe===!0;let Dt=lt[Bt.id];Dt===void 0&&(Dt={},lt[Bt.id]=Dt);let Gt=Dt[Ut.id];Gt===void 0&&(Gt={},Dt[Ut.id]=Gt);let zt=Gt[jt];return zt===void 0&&(zt=gt(dt()),Gt[jt]=zt),zt}function gt(Bt){const Ut=[],Ft=[],jt=[];for(let Dt=0;Dt<it;Dt++)Ut[Dt]=0,Ft[Dt]=0,jt[Dt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ut,enabledAttributes:Ft,attributeDivisors:jt,object:Bt,attributes:{},index:null}}function vt(Bt,Ut,Ft,jt){const Dt=ct.attributes,Gt=Ut.attributes;let zt=0;const $t=Ft.getAttributes();for(const Ht in $t)if($t[Ht].location>=0){const Zt=Dt[Ht];let or=Gt[Ht];if(or===void 0&&(Ht==="instanceMatrix"&&Bt.instanceMatrix&&(or=Bt.instanceMatrix),Ht==="instanceColor"&&Bt.instanceColor&&(or=Bt.instanceColor)),Zt===void 0||Zt.attribute!==or||or&&Zt.data!==or.data)return!0;zt++}return ct.attributesNum!==zt||ct.index!==jt}function At(Bt,Ut,Ft,jt){const Dt={},Gt=Ut.attributes;let zt=0;const $t=Ft.getAttributes();for(const Ht in $t)if($t[Ht].location>=0){let Zt=Gt[Ht];Zt===void 0&&(Ht==="instanceMatrix"&&Bt.instanceMatrix&&(Zt=Bt.instanceMatrix),Ht==="instanceColor"&&Bt.instanceColor&&(Zt=Bt.instanceColor));const or={};or.attribute=Zt,Zt&&Zt.data&&(or.data=Zt.data),Dt[Ht]=or,zt++}ct.attributes=Dt,ct.attributesNum=zt,ct.index=jt}function yt(){const Bt=ct.newAttributes;for(let Ut=0,Ft=Bt.length;Ut<Ft;Ut++)Bt[Ut]=0}function xt(Bt){_t(Bt,0)}function _t(Bt,Ut){const Ft=ct.newAttributes,jt=ct.enabledAttributes,Dt=ct.attributeDivisors;Ft[Bt]=1,jt[Bt]===0&&(tt.enableVertexAttribArray(Bt),jt[Bt]=1),Dt[Bt]!==Ut&&((nt.isWebGL2?tt:_e.get("ANGLE_instanced_arrays"))[nt.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Bt,Ut),Dt[Bt]=Ut)}function Et(){const Bt=ct.newAttributes,Ut=ct.enabledAttributes;for(let Ft=0,jt=Ut.length;Ft<jt;Ft++)Ut[Ft]!==Bt[Ft]&&(tt.disableVertexAttribArray(Ft),Ut[Ft]=0)}function bt(Bt,Ut,Ft,jt,Dt,Gt,zt){zt===!0?tt.vertexAttribIPointer(Bt,Ut,Ft,Dt,Gt):tt.vertexAttribPointer(Bt,Ut,Ft,jt,Dt,Gt)}function wt(Bt,Ut,Ft,jt){if(nt.isWebGL2===!1&&(Bt.isInstancedMesh||jt.isInstancedBufferGeometry)&&_e.get("ANGLE_instanced_arrays")===null)return;yt();const Dt=jt.attributes,Gt=Ft.getAttributes(),zt=Ut.defaultAttributeValues;for(const $t in Gt){const Ht=Gt[$t];if(Ht.location>=0){let er=Dt[$t];if(er===void 0&&($t==="instanceMatrix"&&Bt.instanceMatrix&&(er=Bt.instanceMatrix),$t==="instanceColor"&&Bt.instanceColor&&(er=Bt.instanceColor)),er!==void 0){const Zt=er.normalized,or=er.itemSize,Kt=rt.get(er);if(Kt===void 0)continue;const rr=Kt.buffer,ur=Kt.type,fr=Kt.bytesPerElement,dr=nt.isWebGL2===!0&&(ur===tt.INT||ur===tt.UNSIGNED_INT||er.gpuType===IntType);if(er.isInterleavedBufferAttribute){const gr=er.data,Yt=gr.stride,xr=er.offset;if(gr.isInstancedInterleavedBuffer){for(let vr=0;vr<Ht.locationSize;vr++)_t(Ht.location+vr,gr.meshPerAttribute);Bt.isInstancedMesh!==!0&&jt._maxInstanceCount===void 0&&(jt._maxInstanceCount=gr.meshPerAttribute*gr.count)}else for(let vr=0;vr<Ht.locationSize;vr++)xt(Ht.location+vr);tt.bindBuffer(tt.ARRAY_BUFFER,rr);for(let vr=0;vr<Ht.locationSize;vr++)bt(Ht.location+vr,or/Ht.locationSize,ur,Zt,Yt*fr,(xr+or/Ht.locationSize*vr)*fr,dr)}else{if(er.isInstancedBufferAttribute){for(let gr=0;gr<Ht.locationSize;gr++)_t(Ht.location+gr,er.meshPerAttribute);Bt.isInstancedMesh!==!0&&jt._maxInstanceCount===void 0&&(jt._maxInstanceCount=er.meshPerAttribute*er.count)}else for(let gr=0;gr<Ht.locationSize;gr++)xt(Ht.location+gr);tt.bindBuffer(tt.ARRAY_BUFFER,rr);for(let gr=0;gr<Ht.locationSize;gr++)bt(Ht.location+gr,or/Ht.locationSize,ur,Zt,or*fr,or/Ht.locationSize*gr*fr,dr)}}else if(zt!==void 0){const Zt=zt[$t];if(Zt!==void 0)switch(Zt.length){case 2:tt.vertexAttrib2fv(Ht.location,Zt);break;case 3:tt.vertexAttrib3fv(Ht.location,Zt);break;case 4:tt.vertexAttrib4fv(Ht.location,Zt);break;default:tt.vertexAttrib1fv(Ht.location,Zt)}}}}Et()}function Tt(){It();for(const Bt in lt){const Ut=lt[Bt];for(const Ft in Ut){const jt=Ut[Ft];for(const Dt in jt)pt(jt[Dt].object),delete jt[Dt];delete Ut[Ft]}delete lt[Bt]}}function Mt(Bt){if(lt[Bt.id]===void 0)return;const Ut=lt[Bt.id];for(const Ft in Ut){const jt=Ut[Ft];for(const Dt in jt)pt(jt[Dt].object),delete jt[Dt];delete Ut[Ft]}delete lt[Bt.id]}function Pt(Bt){for(const Ut in lt){const Ft=lt[Ut];if(Ft[Bt.id]===void 0)continue;const jt=Ft[Bt.id];for(const Dt in jt)pt(jt[Dt].object),delete jt[Dt];delete Ft[Bt.id]}}function It(){Ot(),ut=!0,ct!==at&&(ct=at,ft(ct.object))}function Ot(){at.geometry=null,at.program=null,at.wireframe=!1}return{setup:ht,reset:It,resetDefaultState:Ot,dispose:Tt,releaseStatesOfGeometry:Mt,releaseStatesOfProgram:Pt,initAttributes:yt,enableAttribute:xt,disableUnusedAttributes:Et}}function WebGLBufferRenderer(tt,_e,rt,nt){const it=nt.isWebGL2;let st;function ot(ct){st=ct}function lt(ct,ut){tt.drawArrays(st,ct,ut),rt.update(ut,st,1)}function at(ct,ut,ht){if(ht===0)return;let dt,ft;if(it)dt=tt,ft="drawArraysInstanced";else if(dt=_e.get("ANGLE_instanced_arrays"),ft="drawArraysInstancedANGLE",dt===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}dt[ft](st,ct,ut,ht),rt.update(ut,st,ht)}this.setMode=ot,this.render=lt,this.renderInstances=at}function WebGLCapabilities(tt,_e,rt){let nt;function it(){if(nt!==void 0)return nt;if(_e.has("EXT_texture_filter_anisotropic")===!0){const bt=_e.get("EXT_texture_filter_anisotropic");nt=tt.getParameter(bt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else nt=0;return nt}function st(bt){if(bt==="highp"){if(tt.getShaderPrecisionFormat(tt.VERTEX_SHADER,tt.HIGH_FLOAT).precision>0&&tt.getShaderPrecisionFormat(tt.FRAGMENT_SHADER,tt.HIGH_FLOAT).precision>0)return"highp";bt="mediump"}return bt==="mediump"&&tt.getShaderPrecisionFormat(tt.VERTEX_SHADER,tt.MEDIUM_FLOAT).precision>0&&tt.getShaderPrecisionFormat(tt.FRAGMENT_SHADER,tt.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const ot=typeof WebGL2RenderingContext<"u"&&tt.constructor.name==="WebGL2RenderingContext";let lt=rt.precision!==void 0?rt.precision:"highp";const at=st(lt);at!==lt&&(console.warn("THREE.WebGLRenderer:",lt,"not supported, using",at,"instead."),lt=at);const ct=ot||_e.has("WEBGL_draw_buffers"),ut=rt.logarithmicDepthBuffer===!0,ht=tt.getParameter(tt.MAX_TEXTURE_IMAGE_UNITS),dt=tt.getParameter(tt.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ft=tt.getParameter(tt.MAX_TEXTURE_SIZE),pt=tt.getParameter(tt.MAX_CUBE_MAP_TEXTURE_SIZE),mt=tt.getParameter(tt.MAX_VERTEX_ATTRIBS),gt=tt.getParameter(tt.MAX_VERTEX_UNIFORM_VECTORS),vt=tt.getParameter(tt.MAX_VARYING_VECTORS),At=tt.getParameter(tt.MAX_FRAGMENT_UNIFORM_VECTORS),yt=dt>0,xt=ot||_e.has("OES_texture_float"),_t=yt&&xt,Et=ot?tt.getParameter(tt.MAX_SAMPLES):0;return{isWebGL2:ot,drawBuffers:ct,getMaxAnisotropy:it,getMaxPrecision:st,precision:lt,logarithmicDepthBuffer:ut,maxTextures:ht,maxVertexTextures:dt,maxTextureSize:ft,maxCubemapSize:pt,maxAttributes:mt,maxVertexUniforms:gt,maxVaryings:vt,maxFragmentUniforms:At,vertexTextures:yt,floatFragmentTextures:xt,floatVertexTextures:_t,maxSamples:Et}}function WebGLClipping(tt){const _e=this;let rt=null,nt=0,it=!1,st=!1;const ot=new Plane,lt=new Matrix3,at={value:null,needsUpdate:!1};this.uniform=at,this.numPlanes=0,this.numIntersection=0,this.init=function(ht,dt){const ft=ht.length!==0||dt||nt!==0||it;return it=dt,nt=ht.length,ft},this.beginShadows=function(){st=!0,ut(null)},this.endShadows=function(){st=!1},this.setGlobalState=function(ht,dt){rt=ut(ht,dt,0)},this.setState=function(ht,dt,ft){const pt=ht.clippingPlanes,mt=ht.clipIntersection,gt=ht.clipShadows,vt=tt.get(ht);if(!it||pt===null||pt.length===0||st&&!gt)st?ut(null):ct();else{const At=st?0:nt,yt=At*4;let xt=vt.clippingState||null;at.value=xt,xt=ut(pt,dt,yt,ft);for(let _t=0;_t!==yt;++_t)xt[_t]=rt[_t];vt.clippingState=xt,this.numIntersection=mt?this.numPlanes:0,this.numPlanes+=At}};function ct(){at.value!==rt&&(at.value=rt,at.needsUpdate=nt>0),_e.numPlanes=nt,_e.numIntersection=0}function ut(ht,dt,ft,pt){const mt=ht!==null?ht.length:0;let gt=null;if(mt!==0){if(gt=at.value,pt!==!0||gt===null){const vt=ft+mt*4,At=dt.matrixWorldInverse;lt.getNormalMatrix(At),(gt===null||gt.length<vt)&&(gt=new Float32Array(vt));for(let yt=0,xt=ft;yt!==mt;++yt,xt+=4)ot.copy(ht[yt]).applyMatrix4(At,lt),ot.normal.toArray(gt,xt),gt[xt+3]=ot.constant}at.value=gt,at.needsUpdate=!0}return _e.numPlanes=mt,_e.numIntersection=0,gt}}function WebGLCubeMaps(tt){let _e=new WeakMap;function rt(ot,lt){return lt===EquirectangularReflectionMapping?ot.mapping=CubeReflectionMapping:lt===EquirectangularRefractionMapping&&(ot.mapping=CubeRefractionMapping),ot}function nt(ot){if(ot&&ot.isTexture&&ot.isRenderTargetTexture===!1){const lt=ot.mapping;if(lt===EquirectangularReflectionMapping||lt===EquirectangularRefractionMapping)if(_e.has(ot)){const at=_e.get(ot).texture;return rt(at,ot.mapping)}else{const at=ot.image;if(at&&at.height>0){const ct=new WebGLCubeRenderTarget(at.height/2);return ct.fromEquirectangularTexture(tt,ot),_e.set(ot,ct),ot.addEventListener("dispose",it),rt(ct.texture,ot.mapping)}else return null}}return ot}function it(ot){const lt=ot.target;lt.removeEventListener("dispose",it);const at=_e.get(lt);at!==void 0&&(_e.delete(lt),at.dispose())}function st(){_e=new WeakMap}return{get:nt,dispose:st}}class OrthographicCamera extends Camera{constructor(_e=-1,rt=1,nt=1,it=-1,st=.1,ot=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_e,this.right=rt,this.top=nt,this.bottom=it,this.near=st,this.far=ot,this.updateProjectionMatrix()}copy(_e,rt){return super.copy(_e,rt),this.left=_e.left,this.right=_e.right,this.top=_e.top,this.bottom=_e.bottom,this.near=_e.near,this.far=_e.far,this.zoom=_e.zoom,this.view=_e.view===null?null:Object.assign({},_e.view),this}setViewOffset(_e,rt,nt,it,st,ot){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_e,this.view.fullHeight=rt,this.view.offsetX=nt,this.view.offsetY=it,this.view.width=st,this.view.height=ot,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _e=(this.right-this.left)/(2*this.zoom),rt=(this.top-this.bottom)/(2*this.zoom),nt=(this.right+this.left)/2,it=(this.top+this.bottom)/2;let st=nt-_e,ot=nt+_e,lt=it+rt,at=it-rt;if(this.view!==null&&this.view.enabled){const ct=(this.right-this.left)/this.view.fullWidth/this.zoom,ut=(this.top-this.bottom)/this.view.fullHeight/this.zoom;st+=ct*this.view.offsetX,ot=st+ct*this.view.width,lt-=ut*this.view.offsetY,at=lt-ut*this.view.height}this.projectionMatrix.makeOrthographic(st,ot,lt,at,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_e){const rt=super.toJSON(_e);return rt.object.zoom=this.zoom,rt.object.left=this.left,rt.object.right=this.right,rt.object.top=this.top,rt.object.bottom=this.bottom,rt.object.near=this.near,rt.object.far=this.far,this.view!==null&&(rt.object.view=Object.assign({},this.view)),rt}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera,_clearColor=new Color$1;let _oldTarget=null;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];class PMREMGenerator{constructor(_e){this._renderer=_e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_e,rt=0,nt=.1,it=100){_oldTarget=this._renderer.getRenderTarget(),this._setSize(256);const st=this._allocateTargets();return st.depthBuffer=!0,this._sceneToCubeUV(_e,nt,it,st),rt>0&&this._blur(st,0,0,rt),this._applyPMREM(st),this._cleanup(st),st}fromEquirectangular(_e,rt=null){return this._fromTexture(_e,rt)}fromCubemap(_e,rt=null){return this._fromTexture(_e,rt)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_e){this._lodMax=Math.floor(Math.log2(_e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _e=0;_e<this._lodPlanes.length;_e++)this._lodPlanes[_e].dispose()}_cleanup(_e){this._renderer.setRenderTarget(_oldTarget),_e.scissorTest=!1,_setViewport(_e,0,0,_e.width,_e.height)}_fromTexture(_e,rt){_e.mapping===CubeReflectionMapping||_e.mapping===CubeRefractionMapping?this._setSize(_e.image.length===0?16:_e.image[0].width||_e.image[0].image.width):this._setSize(_e.image.width/4),_oldTarget=this._renderer.getRenderTarget();const nt=rt||this._allocateTargets();return this._textureToCubeUV(_e,nt),this._applyPMREM(nt),this._cleanup(nt),nt}_allocateTargets(){const _e=3*Math.max(this._cubeSize,112),rt=4*this._cubeSize,nt={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,depthBuffer:!1},it=_createRenderTarget(_e,rt,nt);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_e||this._pingPongRenderTarget.height!==rt){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_e,rt,nt);const{_lodMax:st}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(st)),this._blurMaterial=_getBlurShader(st,_e,rt)}return it}_compileMaterial(_e){const rt=new Mesh(this._lodPlanes[0],_e);this._renderer.compile(rt,_flatCamera)}_sceneToCubeUV(_e,rt,nt,it){const lt=new PerspectiveCamera(90,1,rt,nt),at=[1,-1,1,1,1,1],ct=[1,1,1,-1,-1,-1],ut=this._renderer,ht=ut.autoClear,dt=ut.toneMapping;ut.getClearColor(_clearColor),ut.toneMapping=NoToneMapping,ut.autoClear=!1;const ft=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),pt=new Mesh(new BoxGeometry,ft);let mt=!1;const gt=_e.background;gt?gt.isColor&&(ft.color.copy(gt),_e.background=null,mt=!0):(ft.color.copy(_clearColor),mt=!0);for(let vt=0;vt<6;vt++){const At=vt%3;At===0?(lt.up.set(0,at[vt],0),lt.lookAt(ct[vt],0,0)):At===1?(lt.up.set(0,0,at[vt]),lt.lookAt(0,ct[vt],0)):(lt.up.set(0,at[vt],0),lt.lookAt(0,0,ct[vt]));const yt=this._cubeSize;_setViewport(it,At*yt,vt>2?yt:0,yt,yt),ut.setRenderTarget(it),mt&&ut.render(pt,lt),ut.render(_e,lt)}pt.geometry.dispose(),pt.material.dispose(),ut.toneMapping=dt,ut.autoClear=ht,_e.background=gt}_textureToCubeUV(_e,rt){const nt=this._renderer,it=_e.mapping===CubeReflectionMapping||_e.mapping===CubeRefractionMapping;it?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=_e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const st=it?this._cubemapMaterial:this._equirectMaterial,ot=new Mesh(this._lodPlanes[0],st),lt=st.uniforms;lt.envMap.value=_e;const at=this._cubeSize;_setViewport(rt,0,0,3*at,2*at),nt.setRenderTarget(rt),nt.render(ot,_flatCamera)}_applyPMREM(_e){const rt=this._renderer,nt=rt.autoClear;rt.autoClear=!1;for(let it=1;it<this._lodPlanes.length;it++){const st=Math.sqrt(this._sigmas[it]*this._sigmas[it]-this._sigmas[it-1]*this._sigmas[it-1]),ot=_axisDirections[(it-1)%_axisDirections.length];this._blur(_e,it-1,it,st,ot)}rt.autoClear=nt}_blur(_e,rt,nt,it,st){const ot=this._pingPongRenderTarget;this._halfBlur(_e,ot,rt,nt,it,"latitudinal",st),this._halfBlur(ot,_e,nt,nt,it,"longitudinal",st)}_halfBlur(_e,rt,nt,it,st,ot,lt){const at=this._renderer,ct=this._blurMaterial;ot!=="latitudinal"&&ot!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const ut=3,ht=new Mesh(this._lodPlanes[it],ct),dt=ct.uniforms,ft=this._sizeLods[nt]-1,pt=isFinite(st)?Math.PI/(2*ft):2*Math.PI/(2*MAX_SAMPLES-1),mt=st/pt,gt=isFinite(st)?1+Math.floor(ut*mt):MAX_SAMPLES;gt>MAX_SAMPLES&&console.warn(`sigmaRadians, ${st}, is too large and will clip, as it requested ${gt} samples when the maximum is set to ${MAX_SAMPLES}`);const vt=[];let At=0;for(let bt=0;bt<MAX_SAMPLES;++bt){const wt=bt/mt,Tt=Math.exp(-wt*wt/2);vt.push(Tt),bt===0?At+=Tt:bt<gt&&(At+=2*Tt)}for(let bt=0;bt<vt.length;bt++)vt[bt]=vt[bt]/At;dt.envMap.value=_e.texture,dt.samples.value=gt,dt.weights.value=vt,dt.latitudinal.value=ot==="latitudinal",lt&&(dt.poleAxis.value=lt);const{_lodMax:yt}=this;dt.dTheta.value=pt,dt.mipInt.value=yt-nt;const xt=this._sizeLods[it],_t=3*xt*(it>yt-LOD_MIN?it-yt+LOD_MIN:0),Et=4*(this._cubeSize-xt);_setViewport(rt,_t,Et,3*xt,2*xt),at.setRenderTarget(rt),at.render(ht,_flatCamera)}}function _createPlanes(tt){const _e=[],rt=[],nt=[];let it=tt;const st=tt-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let ot=0;ot<st;ot++){const lt=Math.pow(2,it);rt.push(lt);let at=1/lt;ot>tt-LOD_MIN?at=EXTRA_LOD_SIGMA[ot-tt+LOD_MIN-1]:ot===0&&(at=0),nt.push(at);const ct=1/(lt-2),ut=-ct,ht=1+ct,dt=[ut,ut,ht,ut,ht,ht,ut,ut,ht,ht,ut,ht],ft=6,pt=6,mt=3,gt=2,vt=1,At=new Float32Array(mt*pt*ft),yt=new Float32Array(gt*pt*ft),xt=new Float32Array(vt*pt*ft);for(let Et=0;Et<ft;Et++){const bt=Et%3*2/3-1,wt=Et>2?0:-1,Tt=[bt,wt,0,bt+2/3,wt,0,bt+2/3,wt+1,0,bt,wt,0,bt+2/3,wt+1,0,bt,wt+1,0];At.set(Tt,mt*pt*Et),yt.set(dt,gt*pt*Et);const Mt=[Et,Et,Et,Et,Et,Et];xt.set(Mt,vt*pt*Et)}const _t=new BufferGeometry;_t.setAttribute("position",new BufferAttribute(At,mt)),_t.setAttribute("uv",new BufferAttribute(yt,gt)),_t.setAttribute("faceIndex",new BufferAttribute(xt,vt)),_e.push(_t),it>LOD_MIN&&it--}return{lodPlanes:_e,sizeLods:rt,sigmas:nt}}function _createRenderTarget(tt,_e,rt){const nt=new WebGLRenderTarget(tt,_e,rt);return nt.texture.mapping=CubeUVReflectionMapping,nt.texture.name="PMREM.cubeUv",nt.scissorTest=!0,nt}function _setViewport(tt,_e,rt,nt,it){tt.viewport.set(_e,rt,nt,it),tt.scissor.set(_e,rt,nt,it)}function _getBlurShader(tt,_e,rt){const nt=new Float32Array(MAX_SAMPLES),it=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/_e,CUBEUV_TEXEL_HEIGHT:1/rt,CUBEUV_MAX_MIP:`${tt}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:nt},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:it}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(tt){let _e=new WeakMap,rt=null;function nt(lt){if(lt&&lt.isTexture){const at=lt.mapping,ct=at===EquirectangularReflectionMapping||at===EquirectangularRefractionMapping,ut=at===CubeReflectionMapping||at===CubeRefractionMapping;if(ct||ut)if(lt.isRenderTargetTexture&&lt.needsPMREMUpdate===!0){lt.needsPMREMUpdate=!1;let ht=_e.get(lt);return rt===null&&(rt=new PMREMGenerator(tt)),ht=ct?rt.fromEquirectangular(lt,ht):rt.fromCubemap(lt,ht),_e.set(lt,ht),ht.texture}else{if(_e.has(lt))return _e.get(lt).texture;{const ht=lt.image;if(ct&&ht&&ht.height>0||ut&&ht&&it(ht)){rt===null&&(rt=new PMREMGenerator(tt));const dt=ct?rt.fromEquirectangular(lt):rt.fromCubemap(lt);return _e.set(lt,dt),lt.addEventListener("dispose",st),dt.texture}else return null}}}return lt}function it(lt){let at=0;const ct=6;for(let ut=0;ut<ct;ut++)lt[ut]!==void 0&&at++;return at===ct}function st(lt){const at=lt.target;at.removeEventListener("dispose",st);const ct=_e.get(at);ct!==void 0&&(_e.delete(at),ct.dispose())}function ot(){_e=new WeakMap,rt!==null&&(rt.dispose(),rt=null)}return{get:nt,dispose:ot}}function WebGLExtensions(tt){const _e={};function rt(nt){if(_e[nt]!==void 0)return _e[nt];let it;switch(nt){case"WEBGL_depth_texture":it=tt.getExtension("WEBGL_depth_texture")||tt.getExtension("MOZ_WEBGL_depth_texture")||tt.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":it=tt.getExtension("EXT_texture_filter_anisotropic")||tt.getExtension("MOZ_EXT_texture_filter_anisotropic")||tt.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":it=tt.getExtension("WEBGL_compressed_texture_s3tc")||tt.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||tt.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":it=tt.getExtension("WEBGL_compressed_texture_pvrtc")||tt.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:it=tt.getExtension(nt)}return _e[nt]=it,it}return{has:function(nt){return rt(nt)!==null},init:function(nt){nt.isWebGL2?rt("EXT_color_buffer_float"):(rt("WEBGL_depth_texture"),rt("OES_texture_float"),rt("OES_texture_half_float"),rt("OES_texture_half_float_linear"),rt("OES_standard_derivatives"),rt("OES_element_index_uint"),rt("OES_vertex_array_object"),rt("ANGLE_instanced_arrays")),rt("OES_texture_float_linear"),rt("EXT_color_buffer_half_float"),rt("WEBGL_multisampled_render_to_texture")},get:function(nt){const it=rt(nt);return it===null&&console.warn("THREE.WebGLRenderer: "+nt+" extension not supported."),it}}}function WebGLGeometries(tt,_e,rt,nt){const it={},st=new WeakMap;function ot(ht){const dt=ht.target;dt.index!==null&&_e.remove(dt.index);for(const pt in dt.attributes)_e.remove(dt.attributes[pt]);for(const pt in dt.morphAttributes){const mt=dt.morphAttributes[pt];for(let gt=0,vt=mt.length;gt<vt;gt++)_e.remove(mt[gt])}dt.removeEventListener("dispose",ot),delete it[dt.id];const ft=st.get(dt);ft&&(_e.remove(ft),st.delete(dt)),nt.releaseStatesOfGeometry(dt),dt.isInstancedBufferGeometry===!0&&delete dt._maxInstanceCount,rt.memory.geometries--}function lt(ht,dt){return it[dt.id]===!0||(dt.addEventListener("dispose",ot),it[dt.id]=!0,rt.memory.geometries++),dt}function at(ht){const dt=ht.attributes;for(const pt in dt)_e.update(dt[pt],tt.ARRAY_BUFFER);const ft=ht.morphAttributes;for(const pt in ft){const mt=ft[pt];for(let gt=0,vt=mt.length;gt<vt;gt++)_e.update(mt[gt],tt.ARRAY_BUFFER)}}function ct(ht){const dt=[],ft=ht.index,pt=ht.attributes.position;let mt=0;if(ft!==null){const At=ft.array;mt=ft.version;for(let yt=0,xt=At.length;yt<xt;yt+=3){const _t=At[yt+0],Et=At[yt+1],bt=At[yt+2];dt.push(_t,Et,Et,bt,bt,_t)}}else{const At=pt.array;mt=pt.version;for(let yt=0,xt=At.length/3-1;yt<xt;yt+=3){const _t=yt+0,Et=yt+1,bt=yt+2;dt.push(_t,Et,Et,bt,bt,_t)}}const gt=new(arrayNeedsUint32(dt)?Uint32BufferAttribute:Uint16BufferAttribute)(dt,1);gt.version=mt;const vt=st.get(ht);vt&&_e.remove(vt),st.set(ht,gt)}function ut(ht){const dt=st.get(ht);if(dt){const ft=ht.index;ft!==null&&dt.version<ft.version&&ct(ht)}else ct(ht);return st.get(ht)}return{get:lt,update:at,getWireframeAttribute:ut}}function WebGLIndexedBufferRenderer(tt,_e,rt,nt){const it=nt.isWebGL2;let st;function ot(dt){st=dt}let lt,at;function ct(dt){lt=dt.type,at=dt.bytesPerElement}function ut(dt,ft){tt.drawElements(st,ft,lt,dt*at),rt.update(ft,st,1)}function ht(dt,ft,pt){if(pt===0)return;let mt,gt;if(it)mt=tt,gt="drawElementsInstanced";else if(mt=_e.get("ANGLE_instanced_arrays"),gt="drawElementsInstancedANGLE",mt===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}mt[gt](st,ft,lt,dt*at,pt),rt.update(ft,st,pt)}this.setMode=ot,this.setIndex=ct,this.render=ut,this.renderInstances=ht}function WebGLInfo(tt){const _e={geometries:0,textures:0},rt={frame:0,calls:0,triangles:0,points:0,lines:0};function nt(st,ot,lt){switch(rt.calls++,ot){case tt.TRIANGLES:rt.triangles+=lt*(st/3);break;case tt.LINES:rt.lines+=lt*(st/2);break;case tt.LINE_STRIP:rt.lines+=lt*(st-1);break;case tt.LINE_LOOP:rt.lines+=lt*st;break;case tt.POINTS:rt.points+=lt*st;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",ot);break}}function it(){rt.calls=0,rt.triangles=0,rt.points=0,rt.lines=0}return{memory:_e,render:rt,programs:null,autoReset:!0,reset:it,update:nt}}function numericalSort(tt,_e){return tt[0]-_e[0]}function absNumericalSort(tt,_e){return Math.abs(_e[1])-Math.abs(tt[1])}function WebGLMorphtargets(tt,_e,rt){const nt={},it=new Float32Array(8),st=new WeakMap,ot=new Vector4,lt=[];for(let ct=0;ct<8;ct++)lt[ct]=[ct,0];function at(ct,ut,ht){const dt=ct.morphTargetInfluences;if(_e.isWebGL2===!0){const pt=ut.morphAttributes.position||ut.morphAttributes.normal||ut.morphAttributes.color,mt=pt!==void 0?pt.length:0;let gt=st.get(ut);if(gt===void 0||gt.count!==mt){let Ut=function(){Ot.dispose(),st.delete(ut),ut.removeEventListener("dispose",Ut)};var ft=Ut;gt!==void 0&&gt.texture.dispose();const yt=ut.morphAttributes.position!==void 0,xt=ut.morphAttributes.normal!==void 0,_t=ut.morphAttributes.color!==void 0,Et=ut.morphAttributes.position||[],bt=ut.morphAttributes.normal||[],wt=ut.morphAttributes.color||[];let Tt=0;yt===!0&&(Tt=1),xt===!0&&(Tt=2),_t===!0&&(Tt=3);let Mt=ut.attributes.position.count*Tt,Pt=1;Mt>_e.maxTextureSize&&(Pt=Math.ceil(Mt/_e.maxTextureSize),Mt=_e.maxTextureSize);const It=new Float32Array(Mt*Pt*4*mt),Ot=new DataArrayTexture(It,Mt,Pt,mt);Ot.type=FloatType,Ot.needsUpdate=!0;const Bt=Tt*4;for(let Ft=0;Ft<mt;Ft++){const jt=Et[Ft],Dt=bt[Ft],Gt=wt[Ft],zt=Mt*Pt*4*Ft;for(let $t=0;$t<jt.count;$t++){const Ht=$t*Bt;yt===!0&&(ot.fromBufferAttribute(jt,$t),It[zt+Ht+0]=ot.x,It[zt+Ht+1]=ot.y,It[zt+Ht+2]=ot.z,It[zt+Ht+3]=0),xt===!0&&(ot.fromBufferAttribute(Dt,$t),It[zt+Ht+4]=ot.x,It[zt+Ht+5]=ot.y,It[zt+Ht+6]=ot.z,It[zt+Ht+7]=0),_t===!0&&(ot.fromBufferAttribute(Gt,$t),It[zt+Ht+8]=ot.x,It[zt+Ht+9]=ot.y,It[zt+Ht+10]=ot.z,It[zt+Ht+11]=Gt.itemSize===4?ot.w:1)}}gt={count:mt,texture:Ot,size:new Vector2(Mt,Pt)},st.set(ut,gt),ut.addEventListener("dispose",Ut)}let vt=0;for(let yt=0;yt<dt.length;yt++)vt+=dt[yt];const At=ut.morphTargetsRelative?1:1-vt;ht.getUniforms().setValue(tt,"morphTargetBaseInfluence",At),ht.getUniforms().setValue(tt,"morphTargetInfluences",dt),ht.getUniforms().setValue(tt,"morphTargetsTexture",gt.texture,rt),ht.getUniforms().setValue(tt,"morphTargetsTextureSize",gt.size)}else{const pt=dt===void 0?0:dt.length;let mt=nt[ut.id];if(mt===void 0||mt.length!==pt){mt=[];for(let xt=0;xt<pt;xt++)mt[xt]=[xt,0];nt[ut.id]=mt}for(let xt=0;xt<pt;xt++){const _t=mt[xt];_t[0]=xt,_t[1]=dt[xt]}mt.sort(absNumericalSort);for(let xt=0;xt<8;xt++)xt<pt&&mt[xt][1]?(lt[xt][0]=mt[xt][0],lt[xt][1]=mt[xt][1]):(lt[xt][0]=Number.MAX_SAFE_INTEGER,lt[xt][1]=0);lt.sort(numericalSort);const gt=ut.morphAttributes.position,vt=ut.morphAttributes.normal;let At=0;for(let xt=0;xt<8;xt++){const _t=lt[xt],Et=_t[0],bt=_t[1];Et!==Number.MAX_SAFE_INTEGER&&bt?(gt&&ut.getAttribute("morphTarget"+xt)!==gt[Et]&&ut.setAttribute("morphTarget"+xt,gt[Et]),vt&&ut.getAttribute("morphNormal"+xt)!==vt[Et]&&ut.setAttribute("morphNormal"+xt,vt[Et]),it[xt]=bt,At+=bt):(gt&&ut.hasAttribute("morphTarget"+xt)===!0&&ut.deleteAttribute("morphTarget"+xt),vt&&ut.hasAttribute("morphNormal"+xt)===!0&&ut.deleteAttribute("morphNormal"+xt),it[xt]=0)}const yt=ut.morphTargetsRelative?1:1-At;ht.getUniforms().setValue(tt,"morphTargetBaseInfluence",yt),ht.getUniforms().setValue(tt,"morphTargetInfluences",it)}}return{update:at}}function WebGLObjects(tt,_e,rt,nt){let it=new WeakMap;function st(at){const ct=nt.render.frame,ut=at.geometry,ht=_e.get(at,ut);if(it.get(ht)!==ct&&(_e.update(ht),it.set(ht,ct)),at.isInstancedMesh&&(at.hasEventListener("dispose",lt)===!1&&at.addEventListener("dispose",lt),it.get(at)!==ct&&(rt.update(at.instanceMatrix,tt.ARRAY_BUFFER),at.instanceColor!==null&&rt.update(at.instanceColor,tt.ARRAY_BUFFER),it.set(at,ct))),at.isSkinnedMesh){const dt=at.skeleton;it.get(dt)!==ct&&(dt.update(),it.set(dt,ct))}return ht}function ot(){it=new WeakMap}function lt(at){const ct=at.target;ct.removeEventListener("dispose",lt),rt.remove(ct.instanceMatrix),ct.instanceColor!==null&&rt.remove(ct.instanceColor)}return{update:st,dispose:ot}}const emptyTexture=new Texture,emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture$1,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten$2(tt,_e,rt){const nt=tt[0];if(nt<=0||nt>0)return tt;const it=_e*rt;let st=arrayCacheF32[it];if(st===void 0&&(st=new Float32Array(it),arrayCacheF32[it]=st),_e!==0){nt.toArray(st,0);for(let ot=1,lt=0;ot!==_e;++ot)lt+=rt,tt[ot].toArray(st,lt)}return st}function arraysEqual$1(tt,_e){if(tt.length!==_e.length)return!1;for(let rt=0,nt=tt.length;rt<nt;rt++)if(tt[rt]!==_e[rt])return!1;return!0}function copyArray$1(tt,_e){for(let rt=0,nt=_e.length;rt<nt;rt++)tt[rt]=_e[rt]}function allocTexUnits(tt,_e){let rt=arrayCacheI32[_e];rt===void 0&&(rt=new Int32Array(_e),arrayCacheI32[_e]=rt);for(let nt=0;nt!==_e;++nt)rt[nt]=tt.allocateTextureUnit();return rt}function setValueV1f(tt,_e){const rt=this.cache;rt[0]!==_e&&(tt.uniform1f(this.addr,_e),rt[0]=_e)}function setValueV2f(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y)&&(tt.uniform2f(this.addr,_e.x,_e.y),rt[0]=_e.x,rt[1]=_e.y);else{if(arraysEqual$1(rt,_e))return;tt.uniform2fv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV3f(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z)&&(tt.uniform3f(this.addr,_e.x,_e.y,_e.z),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z);else if(_e.r!==void 0)(rt[0]!==_e.r||rt[1]!==_e.g||rt[2]!==_e.b)&&(tt.uniform3f(this.addr,_e.r,_e.g,_e.b),rt[0]=_e.r,rt[1]=_e.g,rt[2]=_e.b);else{if(arraysEqual$1(rt,_e))return;tt.uniform3fv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV4f(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z||rt[3]!==_e.w)&&(tt.uniform4f(this.addr,_e.x,_e.y,_e.z,_e.w),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z,rt[3]=_e.w);else{if(arraysEqual$1(rt,_e))return;tt.uniform4fv(this.addr,_e),copyArray$1(rt,_e)}}function setValueM2(tt,_e){const rt=this.cache,nt=_e.elements;if(nt===void 0){if(arraysEqual$1(rt,_e))return;tt.uniformMatrix2fv(this.addr,!1,_e),copyArray$1(rt,_e)}else{if(arraysEqual$1(rt,nt))return;mat2array.set(nt),tt.uniformMatrix2fv(this.addr,!1,mat2array),copyArray$1(rt,nt)}}function setValueM3(tt,_e){const rt=this.cache,nt=_e.elements;if(nt===void 0){if(arraysEqual$1(rt,_e))return;tt.uniformMatrix3fv(this.addr,!1,_e),copyArray$1(rt,_e)}else{if(arraysEqual$1(rt,nt))return;mat3array.set(nt),tt.uniformMatrix3fv(this.addr,!1,mat3array),copyArray$1(rt,nt)}}function setValueM4(tt,_e){const rt=this.cache,nt=_e.elements;if(nt===void 0){if(arraysEqual$1(rt,_e))return;tt.uniformMatrix4fv(this.addr,!1,_e),copyArray$1(rt,_e)}else{if(arraysEqual$1(rt,nt))return;mat4array.set(nt),tt.uniformMatrix4fv(this.addr,!1,mat4array),copyArray$1(rt,nt)}}function setValueV1i(tt,_e){const rt=this.cache;rt[0]!==_e&&(tt.uniform1i(this.addr,_e),rt[0]=_e)}function setValueV2i(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y)&&(tt.uniform2i(this.addr,_e.x,_e.y),rt[0]=_e.x,rt[1]=_e.y);else{if(arraysEqual$1(rt,_e))return;tt.uniform2iv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV3i(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z)&&(tt.uniform3i(this.addr,_e.x,_e.y,_e.z),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z);else{if(arraysEqual$1(rt,_e))return;tt.uniform3iv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV4i(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z||rt[3]!==_e.w)&&(tt.uniform4i(this.addr,_e.x,_e.y,_e.z,_e.w),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z,rt[3]=_e.w);else{if(arraysEqual$1(rt,_e))return;tt.uniform4iv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV1ui(tt,_e){const rt=this.cache;rt[0]!==_e&&(tt.uniform1ui(this.addr,_e),rt[0]=_e)}function setValueV2ui(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y)&&(tt.uniform2ui(this.addr,_e.x,_e.y),rt[0]=_e.x,rt[1]=_e.y);else{if(arraysEqual$1(rt,_e))return;tt.uniform2uiv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV3ui(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z)&&(tt.uniform3ui(this.addr,_e.x,_e.y,_e.z),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z);else{if(arraysEqual$1(rt,_e))return;tt.uniform3uiv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV4ui(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z||rt[3]!==_e.w)&&(tt.uniform4ui(this.addr,_e.x,_e.y,_e.z,_e.w),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z,rt[3]=_e.w);else{if(arraysEqual$1(rt,_e))return;tt.uniform4uiv(this.addr,_e),copyArray$1(rt,_e)}}function setValueT1(tt,_e,rt){const nt=this.cache,it=rt.allocateTextureUnit();nt[0]!==it&&(tt.uniform1i(this.addr,it),nt[0]=it),rt.setTexture2D(_e||emptyTexture,it)}function setValueT3D1(tt,_e,rt){const nt=this.cache,it=rt.allocateTextureUnit();nt[0]!==it&&(tt.uniform1i(this.addr,it),nt[0]=it),rt.setTexture3D(_e||empty3dTexture,it)}function setValueT6(tt,_e,rt){const nt=this.cache,it=rt.allocateTextureUnit();nt[0]!==it&&(tt.uniform1i(this.addr,it),nt[0]=it),rt.setTextureCube(_e||emptyCubeTexture,it)}function setValueT2DArray1(tt,_e,rt){const nt=this.cache,it=rt.allocateTextureUnit();nt[0]!==it&&(tt.uniform1i(this.addr,it),nt[0]=it),rt.setTexture2DArray(_e||emptyArrayTexture,it)}function getSingularSetter(tt){switch(tt){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(tt,_e){tt.uniform1fv(this.addr,_e)}function setValueV2fArray(tt,_e){const rt=flatten$2(_e,this.size,2);tt.uniform2fv(this.addr,rt)}function setValueV3fArray(tt,_e){const rt=flatten$2(_e,this.size,3);tt.uniform3fv(this.addr,rt)}function setValueV4fArray(tt,_e){const rt=flatten$2(_e,this.size,4);tt.uniform4fv(this.addr,rt)}function setValueM2Array(tt,_e){const rt=flatten$2(_e,this.size,4);tt.uniformMatrix2fv(this.addr,!1,rt)}function setValueM3Array(tt,_e){const rt=flatten$2(_e,this.size,9);tt.uniformMatrix3fv(this.addr,!1,rt)}function setValueM4Array(tt,_e){const rt=flatten$2(_e,this.size,16);tt.uniformMatrix4fv(this.addr,!1,rt)}function setValueV1iArray(tt,_e){tt.uniform1iv(this.addr,_e)}function setValueV2iArray(tt,_e){tt.uniform2iv(this.addr,_e)}function setValueV3iArray(tt,_e){tt.uniform3iv(this.addr,_e)}function setValueV4iArray(tt,_e){tt.uniform4iv(this.addr,_e)}function setValueV1uiArray(tt,_e){tt.uniform1uiv(this.addr,_e)}function setValueV2uiArray(tt,_e){tt.uniform2uiv(this.addr,_e)}function setValueV3uiArray(tt,_e){tt.uniform3uiv(this.addr,_e)}function setValueV4uiArray(tt,_e){tt.uniform4uiv(this.addr,_e)}function setValueT1Array(tt,_e,rt){const nt=this.cache,it=_e.length,st=allocTexUnits(rt,it);arraysEqual$1(nt,st)||(tt.uniform1iv(this.addr,st),copyArray$1(nt,st));for(let ot=0;ot!==it;++ot)rt.setTexture2D(_e[ot]||emptyTexture,st[ot])}function setValueT3DArray(tt,_e,rt){const nt=this.cache,it=_e.length,st=allocTexUnits(rt,it);arraysEqual$1(nt,st)||(tt.uniform1iv(this.addr,st),copyArray$1(nt,st));for(let ot=0;ot!==it;++ot)rt.setTexture3D(_e[ot]||empty3dTexture,st[ot])}function setValueT6Array(tt,_e,rt){const nt=this.cache,it=_e.length,st=allocTexUnits(rt,it);arraysEqual$1(nt,st)||(tt.uniform1iv(this.addr,st),copyArray$1(nt,st));for(let ot=0;ot!==it;++ot)rt.setTextureCube(_e[ot]||emptyCubeTexture,st[ot])}function setValueT2DArrayArray(tt,_e,rt){const nt=this.cache,it=_e.length,st=allocTexUnits(rt,it);arraysEqual$1(nt,st)||(tt.uniform1iv(this.addr,st),copyArray$1(nt,st));for(let ot=0;ot!==it;++ot)rt.setTexture2DArray(_e[ot]||emptyArrayTexture,st[ot])}function getPureArraySetter(tt){switch(tt){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_e,rt,nt){this.id=_e,this.addr=nt,this.cache=[],this.setValue=getSingularSetter(rt.type)}}class PureArrayUniform{constructor(_e,rt,nt){this.id=_e,this.addr=nt,this.cache=[],this.size=rt.size,this.setValue=getPureArraySetter(rt.type)}}class StructuredUniform{constructor(_e){this.id=_e,this.seq=[],this.map={}}setValue(_e,rt,nt){const it=this.seq;for(let st=0,ot=it.length;st!==ot;++st){const lt=it[st];lt.setValue(_e,rt[lt.id],nt)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(tt,_e){tt.seq.push(_e),tt.map[_e.id]=_e}function parseUniform(tt,_e,rt){const nt=tt.name,it=nt.length;for(RePathPart.lastIndex=0;;){const st=RePathPart.exec(nt),ot=RePathPart.lastIndex;let lt=st[1];const at=st[2]==="]",ct=st[3];if(at&&(lt=lt|0),ct===void 0||ct==="["&&ot+2===it){addUniform(rt,ct===void 0?new SingleUniform(lt,tt,_e):new PureArrayUniform(lt,tt,_e));break}else{let ht=rt.map[lt];ht===void 0&&(ht=new StructuredUniform(lt),addUniform(rt,ht)),rt=ht}}}class WebGLUniforms{constructor(_e,rt){this.seq=[],this.map={};const nt=_e.getProgramParameter(rt,_e.ACTIVE_UNIFORMS);for(let it=0;it<nt;++it){const st=_e.getActiveUniform(rt,it),ot=_e.getUniformLocation(rt,st.name);parseUniform(st,ot,this)}}setValue(_e,rt,nt,it){const st=this.map[rt];st!==void 0&&st.setValue(_e,nt,it)}setOptional(_e,rt,nt){const it=rt[nt];it!==void 0&&this.setValue(_e,nt,it)}static upload(_e,rt,nt,it){for(let st=0,ot=rt.length;st!==ot;++st){const lt=rt[st],at=nt[lt.id];at.needsUpdate!==!1&&lt.setValue(_e,at.value,it)}}static seqWithValue(_e,rt){const nt=[];for(let it=0,st=_e.length;it!==st;++it){const ot=_e[it];ot.id in rt&&nt.push(ot)}return nt}}function WebGLShader(tt,_e,rt){const nt=tt.createShader(_e);return tt.shaderSource(nt,rt),tt.compileShader(nt),nt}let programIdCount=0;function handleSource(tt,_e){const rt=tt.split(`
`),nt=[],it=Math.max(_e-6,0),st=Math.min(_e+6,rt.length);for(let ot=it;ot<st;ot++){const lt=ot+1;nt.push(`${lt===_e?">":" "} ${lt}: ${rt[ot]}`)}return nt.join(`
`)}function getEncodingComponents(tt){switch(tt){case LinearSRGBColorSpace:return["Linear","( value )"];case SRGBColorSpace:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",tt),["Linear","( value )"]}}function getShaderErrors(tt,_e,rt){const nt=tt.getShaderParameter(_e,tt.COMPILE_STATUS),it=tt.getShaderInfoLog(_e).trim();if(nt&&it==="")return"";const st=/ERROR: 0:(\d+)/.exec(it);if(st){const ot=parseInt(st[1]);return rt.toUpperCase()+`

`+it+`

`+handleSource(tt.getShaderSource(_e),ot)}else return it}function getTexelEncodingFunction(tt,_e){const rt=getEncodingComponents(_e);return"vec4 "+tt+"( vec4 value ) { return LinearTo"+rt[0]+rt[1]+"; }"}function getToneMappingFunction(tt,_e){let rt;switch(_e){case LinearToneMapping:rt="Linear";break;case ReinhardToneMapping:rt="Reinhard";break;case CineonToneMapping:rt="OptimizedCineon";break;case ACESFilmicToneMapping:rt="ACESFilmic";break;case CustomToneMapping:rt="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_e),rt="Linear"}return"vec3 "+tt+"( vec3 color ) { return "+rt+"ToneMapping( color ); }"}function generateExtensions(tt){return[tt.extensionDerivatives||tt.envMapCubeUVHeight||tt.bumpMap||tt.normalMapTangentSpace||tt.clearcoatNormalMap||tt.flatShading||tt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(tt.extensionFragDepth||tt.logarithmicDepthBuffer)&&tt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",tt.extensionDrawBuffers&&tt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(tt.extensionShaderTextureLOD||tt.envMap||tt.transmission)&&tt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join(`
`)}function generateDefines(tt){const _e=[];for(const rt in tt){const nt=tt[rt];nt!==!1&&_e.push("#define "+rt+" "+nt)}return _e.join(`
`)}function fetchAttributeLocations(tt,_e){const rt={},nt=tt.getProgramParameter(_e,tt.ACTIVE_ATTRIBUTES);for(let it=0;it<nt;it++){const st=tt.getActiveAttrib(_e,it),ot=st.name;let lt=1;st.type===tt.FLOAT_MAT2&&(lt=2),st.type===tt.FLOAT_MAT3&&(lt=3),st.type===tt.FLOAT_MAT4&&(lt=4),rt[ot]={type:st.type,location:tt.getAttribLocation(_e,ot),locationSize:lt}}return rt}function filterEmptyLine(tt){return tt!==""}function replaceLightNums(tt,_e){const rt=_e.numSpotLightShadows+_e.numSpotLightMaps-_e.numSpotLightShadowsWithMaps;return tt.replace(/NUM_DIR_LIGHTS/g,_e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,rt).replace(/NUM_RECT_AREA_LIGHTS/g,_e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_e.numPointLightShadows)}function replaceClippingPlaneNums(tt,_e){return tt.replace(/NUM_CLIPPING_PLANES/g,_e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_e.numClippingPlanes-_e.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(tt){return tt.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function includeReplacer(tt,_e){let rt=ShaderChunk[_e];if(rt===void 0){const nt=shaderChunkMap.get(_e);if(nt!==void 0)rt=ShaderChunk[nt],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',_e,nt);else throw new Error("Can not resolve #include <"+_e+">")}return resolveIncludes(rt)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(tt){return tt.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(tt,_e,rt,nt){let it="";for(let st=parseInt(_e);st<parseInt(rt);st++)it+=nt.replace(/\[\s*i\s*\]/g,"[ "+st+" ]").replace(/UNROLLED_LOOP_INDEX/g,st);return it}function generatePrecision(tt){let _e="precision "+tt.precision+` float;
precision `+tt.precision+" int;";return tt.precision==="highp"?_e+=`
#define HIGH_PRECISION`:tt.precision==="mediump"?_e+=`
#define MEDIUM_PRECISION`:tt.precision==="lowp"&&(_e+=`
#define LOW_PRECISION`),_e}function generateShadowMapTypeDefine(tt){let _e="SHADOWMAP_TYPE_BASIC";return tt.shadowMapType===PCFShadowMap?_e="SHADOWMAP_TYPE_PCF":tt.shadowMapType===PCFSoftShadowMap?_e="SHADOWMAP_TYPE_PCF_SOFT":tt.shadowMapType===VSMShadowMap&&(_e="SHADOWMAP_TYPE_VSM"),_e}function generateEnvMapTypeDefine(tt){let _e="ENVMAP_TYPE_CUBE";if(tt.envMap)switch(tt.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:_e="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:_e="ENVMAP_TYPE_CUBE_UV";break}return _e}function generateEnvMapModeDefine(tt){let _e="ENVMAP_MODE_REFLECTION";if(tt.envMap)switch(tt.envMapMode){case CubeRefractionMapping:_e="ENVMAP_MODE_REFRACTION";break}return _e}function generateEnvMapBlendingDefine(tt){let _e="ENVMAP_BLENDING_NONE";if(tt.envMap)switch(tt.combine){case MultiplyOperation:_e="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:_e="ENVMAP_BLENDING_MIX";break;case AddOperation:_e="ENVMAP_BLENDING_ADD";break}return _e}function generateCubeUVSize(tt){const _e=tt.envMapCubeUVHeight;if(_e===null)return null;const rt=Math.log2(_e)-2,nt=1/_e;return{texelWidth:1/(3*Math.max(Math.pow(2,rt),7*16)),texelHeight:nt,maxMip:rt}}function WebGLProgram(tt,_e,rt,nt){const it=tt.getContext(),st=rt.defines;let ot=rt.vertexShader,lt=rt.fragmentShader;const at=generateShadowMapTypeDefine(rt),ct=generateEnvMapTypeDefine(rt),ut=generateEnvMapModeDefine(rt),ht=generateEnvMapBlendingDefine(rt),dt=generateCubeUVSize(rt),ft=rt.isWebGL2?"":generateExtensions(rt),pt=generateDefines(st),mt=it.createProgram();let gt,vt,At=rt.glslVersion?"#version "+rt.glslVersion+`
`:"";rt.isRawShaderMaterial?(gt=["#define SHADER_TYPE "+rt.shaderType,"#define SHADER_NAME "+rt.shaderName,pt].filter(filterEmptyLine).join(`
`),gt.length>0&&(gt+=`
`),vt=[ft,"#define SHADER_TYPE "+rt.shaderType,"#define SHADER_NAME "+rt.shaderName,pt].filter(filterEmptyLine).join(`
`),vt.length>0&&(vt+=`
`)):(gt=[generatePrecision(rt),"#define SHADER_TYPE "+rt.shaderType,"#define SHADER_NAME "+rt.shaderName,pt,rt.instancing?"#define USE_INSTANCING":"",rt.instancingColor?"#define USE_INSTANCING_COLOR":"",rt.useFog&&rt.fog?"#define USE_FOG":"",rt.useFog&&rt.fogExp2?"#define FOG_EXP2":"",rt.map?"#define USE_MAP":"",rt.envMap?"#define USE_ENVMAP":"",rt.envMap?"#define "+ut:"",rt.lightMap?"#define USE_LIGHTMAP":"",rt.aoMap?"#define USE_AOMAP":"",rt.bumpMap?"#define USE_BUMPMAP":"",rt.normalMap?"#define USE_NORMALMAP":"",rt.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",rt.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",rt.displacementMap?"#define USE_DISPLACEMENTMAP":"",rt.emissiveMap?"#define USE_EMISSIVEMAP":"",rt.anisotropyMap?"#define USE_ANISOTROPYMAP":"",rt.clearcoatMap?"#define USE_CLEARCOATMAP":"",rt.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",rt.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",rt.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",rt.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",rt.specularMap?"#define USE_SPECULARMAP":"",rt.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",rt.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",rt.roughnessMap?"#define USE_ROUGHNESSMAP":"",rt.metalnessMap?"#define USE_METALNESSMAP":"",rt.alphaMap?"#define USE_ALPHAMAP":"",rt.alphaHash?"#define USE_ALPHAHASH":"",rt.transmission?"#define USE_TRANSMISSION":"",rt.transmissionMap?"#define USE_TRANSMISSIONMAP":"",rt.thicknessMap?"#define USE_THICKNESSMAP":"",rt.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",rt.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",rt.mapUv?"#define MAP_UV "+rt.mapUv:"",rt.alphaMapUv?"#define ALPHAMAP_UV "+rt.alphaMapUv:"",rt.lightMapUv?"#define LIGHTMAP_UV "+rt.lightMapUv:"",rt.aoMapUv?"#define AOMAP_UV "+rt.aoMapUv:"",rt.emissiveMapUv?"#define EMISSIVEMAP_UV "+rt.emissiveMapUv:"",rt.bumpMapUv?"#define BUMPMAP_UV "+rt.bumpMapUv:"",rt.normalMapUv?"#define NORMALMAP_UV "+rt.normalMapUv:"",rt.displacementMapUv?"#define DISPLACEMENTMAP_UV "+rt.displacementMapUv:"",rt.metalnessMapUv?"#define METALNESSMAP_UV "+rt.metalnessMapUv:"",rt.roughnessMapUv?"#define ROUGHNESSMAP_UV "+rt.roughnessMapUv:"",rt.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+rt.anisotropyMapUv:"",rt.clearcoatMapUv?"#define CLEARCOATMAP_UV "+rt.clearcoatMapUv:"",rt.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+rt.clearcoatNormalMapUv:"",rt.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+rt.clearcoatRoughnessMapUv:"",rt.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+rt.iridescenceMapUv:"",rt.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+rt.iridescenceThicknessMapUv:"",rt.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+rt.sheenColorMapUv:"",rt.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+rt.sheenRoughnessMapUv:"",rt.specularMapUv?"#define SPECULARMAP_UV "+rt.specularMapUv:"",rt.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+rt.specularColorMapUv:"",rt.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+rt.specularIntensityMapUv:"",rt.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+rt.transmissionMapUv:"",rt.thicknessMapUv?"#define THICKNESSMAP_UV "+rt.thicknessMapUv:"",rt.vertexTangents&&rt.flatShading===!1?"#define USE_TANGENT":"",rt.vertexColors?"#define USE_COLOR":"",rt.vertexAlphas?"#define USE_COLOR_ALPHA":"",rt.vertexUv1s?"#define USE_UV1":"",rt.vertexUv2s?"#define USE_UV2":"",rt.vertexUv3s?"#define USE_UV3":"",rt.pointsUvs?"#define USE_POINTS_UV":"",rt.flatShading?"#define FLAT_SHADED":"",rt.skinning?"#define USE_SKINNING":"",rt.morphTargets?"#define USE_MORPHTARGETS":"",rt.morphNormals&&rt.flatShading===!1?"#define USE_MORPHNORMALS":"",rt.morphColors&&rt.isWebGL2?"#define USE_MORPHCOLORS":"",rt.morphTargetsCount>0&&rt.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",rt.morphTargetsCount>0&&rt.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+rt.morphTextureStride:"",rt.morphTargetsCount>0&&rt.isWebGL2?"#define MORPHTARGETS_COUNT "+rt.morphTargetsCount:"",rt.doubleSided?"#define DOUBLE_SIDED":"",rt.flipSided?"#define FLIP_SIDED":"",rt.shadowMapEnabled?"#define USE_SHADOWMAP":"",rt.shadowMapEnabled?"#define "+at:"",rt.sizeAttenuation?"#define USE_SIZEATTENUATION":"",rt.useLegacyLights?"#define LEGACY_LIGHTS":"",rt.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",rt.logarithmicDepthBuffer&&rt.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),vt=[ft,generatePrecision(rt),"#define SHADER_TYPE "+rt.shaderType,"#define SHADER_NAME "+rt.shaderName,pt,rt.useFog&&rt.fog?"#define USE_FOG":"",rt.useFog&&rt.fogExp2?"#define FOG_EXP2":"",rt.map?"#define USE_MAP":"",rt.matcap?"#define USE_MATCAP":"",rt.envMap?"#define USE_ENVMAP":"",rt.envMap?"#define "+ct:"",rt.envMap?"#define "+ut:"",rt.envMap?"#define "+ht:"",dt?"#define CUBEUV_TEXEL_WIDTH "+dt.texelWidth:"",dt?"#define CUBEUV_TEXEL_HEIGHT "+dt.texelHeight:"",dt?"#define CUBEUV_MAX_MIP "+dt.maxMip+".0":"",rt.lightMap?"#define USE_LIGHTMAP":"",rt.aoMap?"#define USE_AOMAP":"",rt.bumpMap?"#define USE_BUMPMAP":"",rt.normalMap?"#define USE_NORMALMAP":"",rt.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",rt.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",rt.emissiveMap?"#define USE_EMISSIVEMAP":"",rt.anisotropy?"#define USE_ANISOTROPY":"",rt.anisotropyMap?"#define USE_ANISOTROPYMAP":"",rt.clearcoat?"#define USE_CLEARCOAT":"",rt.clearcoatMap?"#define USE_CLEARCOATMAP":"",rt.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",rt.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",rt.iridescence?"#define USE_IRIDESCENCE":"",rt.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",rt.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",rt.specularMap?"#define USE_SPECULARMAP":"",rt.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",rt.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",rt.roughnessMap?"#define USE_ROUGHNESSMAP":"",rt.metalnessMap?"#define USE_METALNESSMAP":"",rt.alphaMap?"#define USE_ALPHAMAP":"",rt.alphaTest?"#define USE_ALPHATEST":"",rt.alphaHash?"#define USE_ALPHAHASH":"",rt.sheen?"#define USE_SHEEN":"",rt.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",rt.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",rt.transmission?"#define USE_TRANSMISSION":"",rt.transmissionMap?"#define USE_TRANSMISSIONMAP":"",rt.thicknessMap?"#define USE_THICKNESSMAP":"",rt.vertexTangents&&rt.flatShading===!1?"#define USE_TANGENT":"",rt.vertexColors||rt.instancingColor?"#define USE_COLOR":"",rt.vertexAlphas?"#define USE_COLOR_ALPHA":"",rt.vertexUv1s?"#define USE_UV1":"",rt.vertexUv2s?"#define USE_UV2":"",rt.vertexUv3s?"#define USE_UV3":"",rt.pointsUvs?"#define USE_POINTS_UV":"",rt.gradientMap?"#define USE_GRADIENTMAP":"",rt.flatShading?"#define FLAT_SHADED":"",rt.doubleSided?"#define DOUBLE_SIDED":"",rt.flipSided?"#define FLIP_SIDED":"",rt.shadowMapEnabled?"#define USE_SHADOWMAP":"",rt.shadowMapEnabled?"#define "+at:"",rt.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",rt.useLegacyLights?"#define LEGACY_LIGHTS":"",rt.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",rt.logarithmicDepthBuffer&&rt.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",rt.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",rt.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",rt.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",rt.toneMapping):"",rt.dithering?"#define DITHERING":"",rt.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",rt.outputColorSpace),rt.useDepthPacking?"#define DEPTH_PACKING "+rt.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),ot=resolveIncludes(ot),ot=replaceLightNums(ot,rt),ot=replaceClippingPlaneNums(ot,rt),lt=resolveIncludes(lt),lt=replaceLightNums(lt,rt),lt=replaceClippingPlaneNums(lt,rt),ot=unrollLoops(ot),lt=unrollLoops(lt),rt.isWebGL2&&rt.isRawShaderMaterial!==!0&&(At=`#version 300 es
`,gt=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+gt,vt=["#define varying in",rt.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",rt.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+vt);const yt=At+gt+ot,xt=At+vt+lt,_t=WebGLShader(it,it.VERTEX_SHADER,yt),Et=WebGLShader(it,it.FRAGMENT_SHADER,xt);if(it.attachShader(mt,_t),it.attachShader(mt,Et),rt.index0AttributeName!==void 0?it.bindAttribLocation(mt,0,rt.index0AttributeName):rt.morphTargets===!0&&it.bindAttribLocation(mt,0,"position"),it.linkProgram(mt),tt.debug.checkShaderErrors){const Tt=it.getProgramInfoLog(mt).trim(),Mt=it.getShaderInfoLog(_t).trim(),Pt=it.getShaderInfoLog(Et).trim();let It=!0,Ot=!0;if(it.getProgramParameter(mt,it.LINK_STATUS)===!1)if(It=!1,typeof tt.debug.onShaderError=="function")tt.debug.onShaderError(it,mt,_t,Et);else{const Bt=getShaderErrors(it,_t,"vertex"),Ut=getShaderErrors(it,Et,"fragment");console.error("THREE.WebGLProgram: Shader Error "+it.getError()+" - VALIDATE_STATUS "+it.getProgramParameter(mt,it.VALIDATE_STATUS)+`

Program Info Log: `+Tt+`
`+Bt+`
`+Ut)}else Tt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Tt):(Mt===""||Pt==="")&&(Ot=!1);Ot&&(this.diagnostics={runnable:It,programLog:Tt,vertexShader:{log:Mt,prefix:gt},fragmentShader:{log:Pt,prefix:vt}})}it.deleteShader(_t),it.deleteShader(Et);let bt;this.getUniforms=function(){return bt===void 0&&(bt=new WebGLUniforms(it,mt)),bt};let wt;return this.getAttributes=function(){return wt===void 0&&(wt=fetchAttributeLocations(it,mt)),wt},this.destroy=function(){nt.releaseStatesOfProgram(this),it.deleteProgram(mt),this.program=void 0},this.type=rt.shaderType,this.name=rt.shaderName,this.id=programIdCount++,this.cacheKey=_e,this.usedTimes=1,this.program=mt,this.vertexShader=_t,this.fragmentShader=Et,this}let _id=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_e){const rt=_e.vertexShader,nt=_e.fragmentShader,it=this._getShaderStage(rt),st=this._getShaderStage(nt),ot=this._getShaderCacheForMaterial(_e);return ot.has(it)===!1&&(ot.add(it),it.usedTimes++),ot.has(st)===!1&&(ot.add(st),st.usedTimes++),this}remove(_e){const rt=this.materialCache.get(_e);for(const nt of rt)nt.usedTimes--,nt.usedTimes===0&&this.shaderCache.delete(nt.code);return this.materialCache.delete(_e),this}getVertexShaderID(_e){return this._getShaderStage(_e.vertexShader).id}getFragmentShaderID(_e){return this._getShaderStage(_e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_e){const rt=this.materialCache;let nt=rt.get(_e);return nt===void 0&&(nt=new Set,rt.set(_e,nt)),nt}_getShaderStage(_e){const rt=this.shaderCache;let nt=rt.get(_e);return nt===void 0&&(nt=new WebGLShaderStage(_e),rt.set(_e,nt)),nt}}class WebGLShaderStage{constructor(_e){this.id=_id++,this.code=_e,this.usedTimes=0}}function WebGLPrograms(tt,_e,rt,nt,it,st,ot){const lt=new Layers,at=new WebGLShaderCache,ct=[],ut=it.isWebGL2,ht=it.logarithmicDepthBuffer,dt=it.vertexTextures;let ft=it.precision;const pt={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function mt(Tt){return Tt===0?"uv":`uv${Tt}`}function gt(Tt,Mt,Pt,It,Ot){const Bt=It.fog,Ut=Ot.geometry,Ft=Tt.isMeshStandardMaterial?It.environment:null,jt=(Tt.isMeshStandardMaterial?rt:_e).get(Tt.envMap||Ft),Dt=jt&&jt.mapping===CubeUVReflectionMapping?jt.image.height:null,Gt=pt[Tt.type];Tt.precision!==null&&(ft=it.getMaxPrecision(Tt.precision),ft!==Tt.precision&&console.warn("THREE.WebGLProgram.getParameters:",Tt.precision,"not supported, using",ft,"instead."));const zt=Ut.morphAttributes.position||Ut.morphAttributes.normal||Ut.morphAttributes.color,$t=zt!==void 0?zt.length:0;let Ht=0;Ut.morphAttributes.position!==void 0&&(Ht=1),Ut.morphAttributes.normal!==void 0&&(Ht=2),Ut.morphAttributes.color!==void 0&&(Ht=3);let er,Zt,or,Kt;if(Gt){const Cn=ShaderLib[Gt];er=Cn.vertexShader,Zt=Cn.fragmentShader}else er=Tt.vertexShader,Zt=Tt.fragmentShader,at.update(Tt),or=at.getVertexShaderID(Tt),Kt=at.getFragmentShaderID(Tt);const rr=tt.getRenderTarget(),ur=Ot.isInstancedMesh===!0,fr=!!Tt.map,dr=!!Tt.matcap,gr=!!jt,Yt=!!Tt.aoMap,xr=!!Tt.lightMap,vr=!!Tt.bumpMap,Pr=!!Tt.normalMap,Sr=!!Tt.displacementMap,Qr=!!Tt.emissiveMap,Ir=!!Tt.metalnessMap,Dr=!!Tt.roughnessMap,Ur=Tt.anisotropy>0,Lr=Tt.clearcoat>0,Wr=Tt.iridescence>0,Xt=Tt.sheen>0,Qt=Tt.transmission>0,hr=Ur&&!!Tt.anisotropyMap,kr=Lr&&!!Tt.clearcoatMap,yr=Lr&&!!Tt.clearcoatNormalMap,_r=Lr&&!!Tt.clearcoatRoughnessMap,Hr=Wr&&!!Tt.iridescenceMap,Er=Wr&&!!Tt.iridescenceThicknessMap,Ar=Xt&&!!Tt.sheenColorMap,qt=Xt&&!!Tt.sheenRoughnessMap,pr=!!Tt.specularMap,mr=!!Tt.specularColorMap,nr=!!Tt.specularIntensityMap,Cr=Qt&&!!Tt.transmissionMap,cr=Qt&&!!Tt.thicknessMap,Jr=!!Tt.gradientMap,lr=!!Tt.alphaMap,Rr=Tt.alphaTest>0,br=!!Tt.alphaHash,jr=!!Tt.extensions,Yr=!!Ut.attributes.uv1,mn=!!Ut.attributes.uv2,bn=!!Ut.attributes.uv3;return{isWebGL2:ut,shaderID:Gt,shaderType:Tt.type,shaderName:Tt.name,vertexShader:er,fragmentShader:Zt,defines:Tt.defines,customVertexShaderID:or,customFragmentShaderID:Kt,isRawShaderMaterial:Tt.isRawShaderMaterial===!0,glslVersion:Tt.glslVersion,precision:ft,instancing:ur,instancingColor:ur&&Ot.instanceColor!==null,supportsVertexTextures:dt,outputColorSpace:rr===null?tt.outputColorSpace:rr.isXRRenderTarget===!0?rr.texture.colorSpace:LinearSRGBColorSpace,map:fr,matcap:dr,envMap:gr,envMapMode:gr&&jt.mapping,envMapCubeUVHeight:Dt,aoMap:Yt,lightMap:xr,bumpMap:vr,normalMap:Pr,displacementMap:dt&&Sr,emissiveMap:Qr,normalMapObjectSpace:Pr&&Tt.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:Pr&&Tt.normalMapType===TangentSpaceNormalMap,metalnessMap:Ir,roughnessMap:Dr,anisotropy:Ur,anisotropyMap:hr,clearcoat:Lr,clearcoatMap:kr,clearcoatNormalMap:yr,clearcoatRoughnessMap:_r,iridescence:Wr,iridescenceMap:Hr,iridescenceThicknessMap:Er,sheen:Xt,sheenColorMap:Ar,sheenRoughnessMap:qt,specularMap:pr,specularColorMap:mr,specularIntensityMap:nr,transmission:Qt,transmissionMap:Cr,thicknessMap:cr,gradientMap:Jr,opaque:Tt.transparent===!1&&Tt.blending===NormalBlending,alphaMap:lr,alphaTest:Rr,alphaHash:br,combine:Tt.combine,mapUv:fr&&mt(Tt.map.channel),aoMapUv:Yt&&mt(Tt.aoMap.channel),lightMapUv:xr&&mt(Tt.lightMap.channel),bumpMapUv:vr&&mt(Tt.bumpMap.channel),normalMapUv:Pr&&mt(Tt.normalMap.channel),displacementMapUv:Sr&&mt(Tt.displacementMap.channel),emissiveMapUv:Qr&&mt(Tt.emissiveMap.channel),metalnessMapUv:Ir&&mt(Tt.metalnessMap.channel),roughnessMapUv:Dr&&mt(Tt.roughnessMap.channel),anisotropyMapUv:hr&&mt(Tt.anisotropyMap.channel),clearcoatMapUv:kr&&mt(Tt.clearcoatMap.channel),clearcoatNormalMapUv:yr&&mt(Tt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:_r&&mt(Tt.clearcoatRoughnessMap.channel),iridescenceMapUv:Hr&&mt(Tt.iridescenceMap.channel),iridescenceThicknessMapUv:Er&&mt(Tt.iridescenceThicknessMap.channel),sheenColorMapUv:Ar&&mt(Tt.sheenColorMap.channel),sheenRoughnessMapUv:qt&&mt(Tt.sheenRoughnessMap.channel),specularMapUv:pr&&mt(Tt.specularMap.channel),specularColorMapUv:mr&&mt(Tt.specularColorMap.channel),specularIntensityMapUv:nr&&mt(Tt.specularIntensityMap.channel),transmissionMapUv:Cr&&mt(Tt.transmissionMap.channel),thicknessMapUv:cr&&mt(Tt.thicknessMap.channel),alphaMapUv:lr&&mt(Tt.alphaMap.channel),vertexTangents:!!Ut.attributes.tangent&&(Pr||Ur),vertexColors:Tt.vertexColors,vertexAlphas:Tt.vertexColors===!0&&!!Ut.attributes.color&&Ut.attributes.color.itemSize===4,vertexUv1s:Yr,vertexUv2s:mn,vertexUv3s:bn,pointsUvs:Ot.isPoints===!0&&!!Ut.attributes.uv&&(fr||lr),fog:!!Bt,useFog:Tt.fog===!0,fogExp2:Bt&&Bt.isFogExp2,flatShading:Tt.flatShading===!0,sizeAttenuation:Tt.sizeAttenuation===!0,logarithmicDepthBuffer:ht,skinning:Ot.isSkinnedMesh===!0,morphTargets:Ut.morphAttributes.position!==void 0,morphNormals:Ut.morphAttributes.normal!==void 0,morphColors:Ut.morphAttributes.color!==void 0,morphTargetsCount:$t,morphTextureStride:Ht,numDirLights:Mt.directional.length,numPointLights:Mt.point.length,numSpotLights:Mt.spot.length,numSpotLightMaps:Mt.spotLightMap.length,numRectAreaLights:Mt.rectArea.length,numHemiLights:Mt.hemi.length,numDirLightShadows:Mt.directionalShadowMap.length,numPointLightShadows:Mt.pointShadowMap.length,numSpotLightShadows:Mt.spotShadowMap.length,numSpotLightShadowsWithMaps:Mt.numSpotLightShadowsWithMaps,numClippingPlanes:ot.numPlanes,numClipIntersection:ot.numIntersection,dithering:Tt.dithering,shadowMapEnabled:tt.shadowMap.enabled&&Pt.length>0,shadowMapType:tt.shadowMap.type,toneMapping:Tt.toneMapped?tt.toneMapping:NoToneMapping,useLegacyLights:tt.useLegacyLights,premultipliedAlpha:Tt.premultipliedAlpha,doubleSided:Tt.side===DoubleSide,flipSided:Tt.side===BackSide,useDepthPacking:Tt.depthPacking>=0,depthPacking:Tt.depthPacking||0,index0AttributeName:Tt.index0AttributeName,extensionDerivatives:jr&&Tt.extensions.derivatives===!0,extensionFragDepth:jr&&Tt.extensions.fragDepth===!0,extensionDrawBuffers:jr&&Tt.extensions.drawBuffers===!0,extensionShaderTextureLOD:jr&&Tt.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:ut||nt.has("EXT_frag_depth"),rendererExtensionDrawBuffers:ut||nt.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:ut||nt.has("EXT_shader_texture_lod"),customProgramCacheKey:Tt.customProgramCacheKey()}}function vt(Tt){const Mt=[];if(Tt.shaderID?Mt.push(Tt.shaderID):(Mt.push(Tt.customVertexShaderID),Mt.push(Tt.customFragmentShaderID)),Tt.defines!==void 0)for(const Pt in Tt.defines)Mt.push(Pt),Mt.push(Tt.defines[Pt]);return Tt.isRawShaderMaterial===!1&&(At(Mt,Tt),yt(Mt,Tt),Mt.push(tt.outputColorSpace)),Mt.push(Tt.customProgramCacheKey),Mt.join()}function At(Tt,Mt){Tt.push(Mt.precision),Tt.push(Mt.outputColorSpace),Tt.push(Mt.envMapMode),Tt.push(Mt.envMapCubeUVHeight),Tt.push(Mt.mapUv),Tt.push(Mt.alphaMapUv),Tt.push(Mt.lightMapUv),Tt.push(Mt.aoMapUv),Tt.push(Mt.bumpMapUv),Tt.push(Mt.normalMapUv),Tt.push(Mt.displacementMapUv),Tt.push(Mt.emissiveMapUv),Tt.push(Mt.metalnessMapUv),Tt.push(Mt.roughnessMapUv),Tt.push(Mt.anisotropyMapUv),Tt.push(Mt.clearcoatMapUv),Tt.push(Mt.clearcoatNormalMapUv),Tt.push(Mt.clearcoatRoughnessMapUv),Tt.push(Mt.iridescenceMapUv),Tt.push(Mt.iridescenceThicknessMapUv),Tt.push(Mt.sheenColorMapUv),Tt.push(Mt.sheenRoughnessMapUv),Tt.push(Mt.specularMapUv),Tt.push(Mt.specularColorMapUv),Tt.push(Mt.specularIntensityMapUv),Tt.push(Mt.transmissionMapUv),Tt.push(Mt.thicknessMapUv),Tt.push(Mt.combine),Tt.push(Mt.fogExp2),Tt.push(Mt.sizeAttenuation),Tt.push(Mt.morphTargetsCount),Tt.push(Mt.morphAttributeCount),Tt.push(Mt.numDirLights),Tt.push(Mt.numPointLights),Tt.push(Mt.numSpotLights),Tt.push(Mt.numSpotLightMaps),Tt.push(Mt.numHemiLights),Tt.push(Mt.numRectAreaLights),Tt.push(Mt.numDirLightShadows),Tt.push(Mt.numPointLightShadows),Tt.push(Mt.numSpotLightShadows),Tt.push(Mt.numSpotLightShadowsWithMaps),Tt.push(Mt.shadowMapType),Tt.push(Mt.toneMapping),Tt.push(Mt.numClippingPlanes),Tt.push(Mt.numClipIntersection),Tt.push(Mt.depthPacking)}function yt(Tt,Mt){lt.disableAll(),Mt.isWebGL2&&lt.enable(0),Mt.supportsVertexTextures&&lt.enable(1),Mt.instancing&&lt.enable(2),Mt.instancingColor&&lt.enable(3),Mt.matcap&&lt.enable(4),Mt.envMap&&lt.enable(5),Mt.normalMapObjectSpace&&lt.enable(6),Mt.normalMapTangentSpace&&lt.enable(7),Mt.clearcoat&&lt.enable(8),Mt.iridescence&&lt.enable(9),Mt.alphaTest&&lt.enable(10),Mt.vertexColors&&lt.enable(11),Mt.vertexAlphas&&lt.enable(12),Mt.vertexUv1s&&lt.enable(13),Mt.vertexUv2s&&lt.enable(14),Mt.vertexUv3s&&lt.enable(15),Mt.vertexTangents&&lt.enable(16),Mt.anisotropy&&lt.enable(17),Tt.push(lt.mask),lt.disableAll(),Mt.fog&&lt.enable(0),Mt.useFog&&lt.enable(1),Mt.flatShading&&lt.enable(2),Mt.logarithmicDepthBuffer&&lt.enable(3),Mt.skinning&&lt.enable(4),Mt.morphTargets&&lt.enable(5),Mt.morphNormals&&lt.enable(6),Mt.morphColors&&lt.enable(7),Mt.premultipliedAlpha&&lt.enable(8),Mt.shadowMapEnabled&&lt.enable(9),Mt.useLegacyLights&&lt.enable(10),Mt.doubleSided&&lt.enable(11),Mt.flipSided&&lt.enable(12),Mt.useDepthPacking&&lt.enable(13),Mt.dithering&&lt.enable(14),Mt.transmission&&lt.enable(15),Mt.sheen&&lt.enable(16),Mt.opaque&&lt.enable(17),Mt.pointsUvs&&lt.enable(18),Tt.push(lt.mask)}function xt(Tt){const Mt=pt[Tt.type];let Pt;if(Mt){const It=ShaderLib[Mt];Pt=UniformsUtils.clone(It.uniforms)}else Pt=Tt.uniforms;return Pt}function _t(Tt,Mt){let Pt;for(let It=0,Ot=ct.length;It<Ot;It++){const Bt=ct[It];if(Bt.cacheKey===Mt){Pt=Bt,++Pt.usedTimes;break}}return Pt===void 0&&(Pt=new WebGLProgram(tt,Mt,Tt,st),ct.push(Pt)),Pt}function Et(Tt){if(--Tt.usedTimes===0){const Mt=ct.indexOf(Tt);ct[Mt]=ct[ct.length-1],ct.pop(),Tt.destroy()}}function bt(Tt){at.remove(Tt)}function wt(){at.dispose()}return{getParameters:gt,getProgramCacheKey:vt,getUniforms:xt,acquireProgram:_t,releaseProgram:Et,releaseShaderCache:bt,programs:ct,dispose:wt}}function WebGLProperties(){let tt=new WeakMap;function _e(st){let ot=tt.get(st);return ot===void 0&&(ot={},tt.set(st,ot)),ot}function rt(st){tt.delete(st)}function nt(st,ot,lt){tt.get(st)[ot]=lt}function it(){tt=new WeakMap}return{get:_e,remove:rt,update:nt,dispose:it}}function painterSortStable(tt,_e){return tt.groupOrder!==_e.groupOrder?tt.groupOrder-_e.groupOrder:tt.renderOrder!==_e.renderOrder?tt.renderOrder-_e.renderOrder:tt.material.id!==_e.material.id?tt.material.id-_e.material.id:tt.z!==_e.z?tt.z-_e.z:tt.id-_e.id}function reversePainterSortStable(tt,_e){return tt.groupOrder!==_e.groupOrder?tt.groupOrder-_e.groupOrder:tt.renderOrder!==_e.renderOrder?tt.renderOrder-_e.renderOrder:tt.z!==_e.z?_e.z-tt.z:tt.id-_e.id}function WebGLRenderList(){const tt=[];let _e=0;const rt=[],nt=[],it=[];function st(){_e=0,rt.length=0,nt.length=0,it.length=0}function ot(ht,dt,ft,pt,mt,gt){let vt=tt[_e];return vt===void 0?(vt={id:ht.id,object:ht,geometry:dt,material:ft,groupOrder:pt,renderOrder:ht.renderOrder,z:mt,group:gt},tt[_e]=vt):(vt.id=ht.id,vt.object=ht,vt.geometry=dt,vt.material=ft,vt.groupOrder=pt,vt.renderOrder=ht.renderOrder,vt.z=mt,vt.group=gt),_e++,vt}function lt(ht,dt,ft,pt,mt,gt){const vt=ot(ht,dt,ft,pt,mt,gt);ft.transmission>0?nt.push(vt):ft.transparent===!0?it.push(vt):rt.push(vt)}function at(ht,dt,ft,pt,mt,gt){const vt=ot(ht,dt,ft,pt,mt,gt);ft.transmission>0?nt.unshift(vt):ft.transparent===!0?it.unshift(vt):rt.unshift(vt)}function ct(ht,dt){rt.length>1&&rt.sort(ht||painterSortStable),nt.length>1&&nt.sort(dt||reversePainterSortStable),it.length>1&&it.sort(dt||reversePainterSortStable)}function ut(){for(let ht=_e,dt=tt.length;ht<dt;ht++){const ft=tt[ht];if(ft.id===null)break;ft.id=null,ft.object=null,ft.geometry=null,ft.material=null,ft.group=null}}return{opaque:rt,transmissive:nt,transparent:it,init:st,push:lt,unshift:at,finish:ut,sort:ct}}function WebGLRenderLists(){let tt=new WeakMap;function _e(nt,it){const st=tt.get(nt);let ot;return st===void 0?(ot=new WebGLRenderList,tt.set(nt,[ot])):it>=st.length?(ot=new WebGLRenderList,st.push(ot)):ot=st[it],ot}function rt(){tt=new WeakMap}return{get:_e,dispose:rt}}function UniformsCache(){const tt={};return{get:function(_e){if(tt[_e.id]!==void 0)return tt[_e.id];let rt;switch(_e.type){case"DirectionalLight":rt={direction:new Vector3,color:new Color$1};break;case"SpotLight":rt={position:new Vector3,direction:new Vector3,color:new Color$1,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":rt={position:new Vector3,color:new Color$1,distance:0,decay:0};break;case"HemisphereLight":rt={direction:new Vector3,skyColor:new Color$1,groundColor:new Color$1};break;case"RectAreaLight":rt={color:new Color$1,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return tt[_e.id]=rt,rt}}}function ShadowUniformsCache(){const tt={};return{get:function(_e){if(tt[_e.id]!==void 0)return tt[_e.id];let rt;switch(_e.type){case"DirectionalLight":rt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":rt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":rt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return tt[_e.id]=rt,rt}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(tt,_e){return(_e.castShadow?2:0)-(tt.castShadow?2:0)+(_e.map?1:0)-(tt.map?1:0)}function WebGLLights(tt,_e){const rt=new UniformsCache,nt=ShadowUniformsCache(),it={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let ut=0;ut<9;ut++)it.probe.push(new Vector3);const st=new Vector3,ot=new Matrix4,lt=new Matrix4;function at(ut,ht){let dt=0,ft=0,pt=0;for(let Pt=0;Pt<9;Pt++)it.probe[Pt].set(0,0,0);let mt=0,gt=0,vt=0,At=0,yt=0,xt=0,_t=0,Et=0,bt=0,wt=0;ut.sort(shadowCastingAndTexturingLightsFirst);const Tt=ht===!0?Math.PI:1;for(let Pt=0,It=ut.length;Pt<It;Pt++){const Ot=ut[Pt],Bt=Ot.color,Ut=Ot.intensity,Ft=Ot.distance,jt=Ot.shadow&&Ot.shadow.map?Ot.shadow.map.texture:null;if(Ot.isAmbientLight)dt+=Bt.r*Ut*Tt,ft+=Bt.g*Ut*Tt,pt+=Bt.b*Ut*Tt;else if(Ot.isLightProbe)for(let Dt=0;Dt<9;Dt++)it.probe[Dt].addScaledVector(Ot.sh.coefficients[Dt],Ut);else if(Ot.isDirectionalLight){const Dt=rt.get(Ot);if(Dt.color.copy(Ot.color).multiplyScalar(Ot.intensity*Tt),Ot.castShadow){const Gt=Ot.shadow,zt=nt.get(Ot);zt.shadowBias=Gt.bias,zt.shadowNormalBias=Gt.normalBias,zt.shadowRadius=Gt.radius,zt.shadowMapSize=Gt.mapSize,it.directionalShadow[mt]=zt,it.directionalShadowMap[mt]=jt,it.directionalShadowMatrix[mt]=Ot.shadow.matrix,xt++}it.directional[mt]=Dt,mt++}else if(Ot.isSpotLight){const Dt=rt.get(Ot);Dt.position.setFromMatrixPosition(Ot.matrixWorld),Dt.color.copy(Bt).multiplyScalar(Ut*Tt),Dt.distance=Ft,Dt.coneCos=Math.cos(Ot.angle),Dt.penumbraCos=Math.cos(Ot.angle*(1-Ot.penumbra)),Dt.decay=Ot.decay,it.spot[vt]=Dt;const Gt=Ot.shadow;if(Ot.map&&(it.spotLightMap[bt]=Ot.map,bt++,Gt.updateMatrices(Ot),Ot.castShadow&&wt++),it.spotLightMatrix[vt]=Gt.matrix,Ot.castShadow){const zt=nt.get(Ot);zt.shadowBias=Gt.bias,zt.shadowNormalBias=Gt.normalBias,zt.shadowRadius=Gt.radius,zt.shadowMapSize=Gt.mapSize,it.spotShadow[vt]=zt,it.spotShadowMap[vt]=jt,Et++}vt++}else if(Ot.isRectAreaLight){const Dt=rt.get(Ot);Dt.color.copy(Bt).multiplyScalar(Ut),Dt.halfWidth.set(Ot.width*.5,0,0),Dt.halfHeight.set(0,Ot.height*.5,0),it.rectArea[At]=Dt,At++}else if(Ot.isPointLight){const Dt=rt.get(Ot);if(Dt.color.copy(Ot.color).multiplyScalar(Ot.intensity*Tt),Dt.distance=Ot.distance,Dt.decay=Ot.decay,Ot.castShadow){const Gt=Ot.shadow,zt=nt.get(Ot);zt.shadowBias=Gt.bias,zt.shadowNormalBias=Gt.normalBias,zt.shadowRadius=Gt.radius,zt.shadowMapSize=Gt.mapSize,zt.shadowCameraNear=Gt.camera.near,zt.shadowCameraFar=Gt.camera.far,it.pointShadow[gt]=zt,it.pointShadowMap[gt]=jt,it.pointShadowMatrix[gt]=Ot.shadow.matrix,_t++}it.point[gt]=Dt,gt++}else if(Ot.isHemisphereLight){const Dt=rt.get(Ot);Dt.skyColor.copy(Ot.color).multiplyScalar(Ut*Tt),Dt.groundColor.copy(Ot.groundColor).multiplyScalar(Ut*Tt),it.hemi[yt]=Dt,yt++}}At>0&&(_e.isWebGL2||tt.has("OES_texture_float_linear")===!0?(it.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,it.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):tt.has("OES_texture_half_float_linear")===!0?(it.rectAreaLTC1=UniformsLib.LTC_HALF_1,it.rectAreaLTC2=UniformsLib.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),it.ambient[0]=dt,it.ambient[1]=ft,it.ambient[2]=pt;const Mt=it.hash;(Mt.directionalLength!==mt||Mt.pointLength!==gt||Mt.spotLength!==vt||Mt.rectAreaLength!==At||Mt.hemiLength!==yt||Mt.numDirectionalShadows!==xt||Mt.numPointShadows!==_t||Mt.numSpotShadows!==Et||Mt.numSpotMaps!==bt)&&(it.directional.length=mt,it.spot.length=vt,it.rectArea.length=At,it.point.length=gt,it.hemi.length=yt,it.directionalShadow.length=xt,it.directionalShadowMap.length=xt,it.pointShadow.length=_t,it.pointShadowMap.length=_t,it.spotShadow.length=Et,it.spotShadowMap.length=Et,it.directionalShadowMatrix.length=xt,it.pointShadowMatrix.length=_t,it.spotLightMatrix.length=Et+bt-wt,it.spotLightMap.length=bt,it.numSpotLightShadowsWithMaps=wt,Mt.directionalLength=mt,Mt.pointLength=gt,Mt.spotLength=vt,Mt.rectAreaLength=At,Mt.hemiLength=yt,Mt.numDirectionalShadows=xt,Mt.numPointShadows=_t,Mt.numSpotShadows=Et,Mt.numSpotMaps=bt,it.version=nextVersion++)}function ct(ut,ht){let dt=0,ft=0,pt=0,mt=0,gt=0;const vt=ht.matrixWorldInverse;for(let At=0,yt=ut.length;At<yt;At++){const xt=ut[At];if(xt.isDirectionalLight){const _t=it.directional[dt];_t.direction.setFromMatrixPosition(xt.matrixWorld),st.setFromMatrixPosition(xt.target.matrixWorld),_t.direction.sub(st),_t.direction.transformDirection(vt),dt++}else if(xt.isSpotLight){const _t=it.spot[pt];_t.position.setFromMatrixPosition(xt.matrixWorld),_t.position.applyMatrix4(vt),_t.direction.setFromMatrixPosition(xt.matrixWorld),st.setFromMatrixPosition(xt.target.matrixWorld),_t.direction.sub(st),_t.direction.transformDirection(vt),pt++}else if(xt.isRectAreaLight){const _t=it.rectArea[mt];_t.position.setFromMatrixPosition(xt.matrixWorld),_t.position.applyMatrix4(vt),lt.identity(),ot.copy(xt.matrixWorld),ot.premultiply(vt),lt.extractRotation(ot),_t.halfWidth.set(xt.width*.5,0,0),_t.halfHeight.set(0,xt.height*.5,0),_t.halfWidth.applyMatrix4(lt),_t.halfHeight.applyMatrix4(lt),mt++}else if(xt.isPointLight){const _t=it.point[ft];_t.position.setFromMatrixPosition(xt.matrixWorld),_t.position.applyMatrix4(vt),ft++}else if(xt.isHemisphereLight){const _t=it.hemi[gt];_t.direction.setFromMatrixPosition(xt.matrixWorld),_t.direction.transformDirection(vt),gt++}}}return{setup:at,setupView:ct,state:it}}function WebGLRenderState(tt,_e){const rt=new WebGLLights(tt,_e),nt=[],it=[];function st(){nt.length=0,it.length=0}function ot(ht){nt.push(ht)}function lt(ht){it.push(ht)}function at(ht){rt.setup(nt,ht)}function ct(ht){rt.setupView(nt,ht)}return{init:st,state:{lightsArray:nt,shadowsArray:it,lights:rt},setupLights:at,setupLightsView:ct,pushLight:ot,pushShadow:lt}}function WebGLRenderStates(tt,_e){let rt=new WeakMap;function nt(st,ot=0){const lt=rt.get(st);let at;return lt===void 0?(at=new WebGLRenderState(tt,_e),rt.set(st,[at])):ot>=lt.length?(at=new WebGLRenderState(tt,_e),lt.push(at)):at=lt[ot],at}function it(){rt=new WeakMap}return{get:nt,dispose:it}}class MeshDepthMaterial extends Material{constructor(_e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_e)}copy(_e){return super.copy(_e),this.depthPacking=_e.depthPacking,this.map=_e.map,this.alphaMap=_e.alphaMap,this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(_e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_e)}copy(_e){return super.copy(_e),this.map=_e.map,this.alphaMap=_e.alphaMap,this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(tt,_e,rt){let nt=new Frustum;const it=new Vector2,st=new Vector2,ot=new Vector4,lt=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),at=new MeshDistanceMaterial,ct={},ut=rt.maxTextureSize,ht={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},dt=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),ft=dt.clone();ft.defines.HORIZONTAL_PASS=1;const pt=new BufferGeometry;pt.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const mt=new Mesh(pt,dt),gt=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let vt=this.type;this.render=function(_t,Et,bt){if(gt.enabled===!1||gt.autoUpdate===!1&&gt.needsUpdate===!1||_t.length===0)return;const wt=tt.getRenderTarget(),Tt=tt.getActiveCubeFace(),Mt=tt.getActiveMipmapLevel(),Pt=tt.state;Pt.setBlending(NoBlending),Pt.buffers.color.setClear(1,1,1,1),Pt.buffers.depth.setTest(!0),Pt.setScissorTest(!1);const It=vt!==VSMShadowMap&&this.type===VSMShadowMap,Ot=vt===VSMShadowMap&&this.type!==VSMShadowMap;for(let Bt=0,Ut=_t.length;Bt<Ut;Bt++){const Ft=_t[Bt],jt=Ft.shadow;if(jt===void 0){console.warn("THREE.WebGLShadowMap:",Ft,"has no shadow.");continue}if(jt.autoUpdate===!1&&jt.needsUpdate===!1)continue;it.copy(jt.mapSize);const Dt=jt.getFrameExtents();if(it.multiply(Dt),st.copy(jt.mapSize),(it.x>ut||it.y>ut)&&(it.x>ut&&(st.x=Math.floor(ut/Dt.x),it.x=st.x*Dt.x,jt.mapSize.x=st.x),it.y>ut&&(st.y=Math.floor(ut/Dt.y),it.y=st.y*Dt.y,jt.mapSize.y=st.y)),jt.map===null||It===!0||Ot===!0){const zt=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};jt.map!==null&&jt.map.dispose(),jt.map=new WebGLRenderTarget(it.x,it.y,zt),jt.map.texture.name=Ft.name+".shadowMap",jt.camera.updateProjectionMatrix()}tt.setRenderTarget(jt.map),tt.clear();const Gt=jt.getViewportCount();for(let zt=0;zt<Gt;zt++){const $t=jt.getViewport(zt);ot.set(st.x*$t.x,st.y*$t.y,st.x*$t.z,st.y*$t.w),Pt.viewport(ot),jt.updateMatrices(Ft,zt),nt=jt.getFrustum(),xt(Et,bt,jt.camera,Ft,this.type)}jt.isPointLightShadow!==!0&&this.type===VSMShadowMap&&At(jt,bt),jt.needsUpdate=!1}vt=this.type,gt.needsUpdate=!1,tt.setRenderTarget(wt,Tt,Mt)};function At(_t,Et){const bt=_e.update(mt);dt.defines.VSM_SAMPLES!==_t.blurSamples&&(dt.defines.VSM_SAMPLES=_t.blurSamples,ft.defines.VSM_SAMPLES=_t.blurSamples,dt.needsUpdate=!0,ft.needsUpdate=!0),_t.mapPass===null&&(_t.mapPass=new WebGLRenderTarget(it.x,it.y)),dt.uniforms.shadow_pass.value=_t.map.texture,dt.uniforms.resolution.value=_t.mapSize,dt.uniforms.radius.value=_t.radius,tt.setRenderTarget(_t.mapPass),tt.clear(),tt.renderBufferDirect(Et,null,bt,dt,mt,null),ft.uniforms.shadow_pass.value=_t.mapPass.texture,ft.uniforms.resolution.value=_t.mapSize,ft.uniforms.radius.value=_t.radius,tt.setRenderTarget(_t.map),tt.clear(),tt.renderBufferDirect(Et,null,bt,ft,mt,null)}function yt(_t,Et,bt,wt){let Tt=null;const Mt=bt.isPointLight===!0?_t.customDistanceMaterial:_t.customDepthMaterial;if(Mt!==void 0)Tt=Mt;else if(Tt=bt.isPointLight===!0?at:lt,tt.localClippingEnabled&&Et.clipShadows===!0&&Array.isArray(Et.clippingPlanes)&&Et.clippingPlanes.length!==0||Et.displacementMap&&Et.displacementScale!==0||Et.alphaMap&&Et.alphaTest>0||Et.map&&Et.alphaTest>0){const Pt=Tt.uuid,It=Et.uuid;let Ot=ct[Pt];Ot===void 0&&(Ot={},ct[Pt]=Ot);let Bt=Ot[It];Bt===void 0&&(Bt=Tt.clone(),Ot[It]=Bt),Tt=Bt}if(Tt.visible=Et.visible,Tt.wireframe=Et.wireframe,wt===VSMShadowMap?Tt.side=Et.shadowSide!==null?Et.shadowSide:Et.side:Tt.side=Et.shadowSide!==null?Et.shadowSide:ht[Et.side],Tt.alphaMap=Et.alphaMap,Tt.alphaTest=Et.alphaTest,Tt.map=Et.map,Tt.clipShadows=Et.clipShadows,Tt.clippingPlanes=Et.clippingPlanes,Tt.clipIntersection=Et.clipIntersection,Tt.displacementMap=Et.displacementMap,Tt.displacementScale=Et.displacementScale,Tt.displacementBias=Et.displacementBias,Tt.wireframeLinewidth=Et.wireframeLinewidth,Tt.linewidth=Et.linewidth,bt.isPointLight===!0&&Tt.isMeshDistanceMaterial===!0){const Pt=tt.properties.get(Tt);Pt.light=bt}return Tt}function xt(_t,Et,bt,wt,Tt){if(_t.visible===!1)return;if(_t.layers.test(Et.layers)&&(_t.isMesh||_t.isLine||_t.isPoints)&&(_t.castShadow||_t.receiveShadow&&Tt===VSMShadowMap)&&(!_t.frustumCulled||nt.intersectsObject(_t))){_t.modelViewMatrix.multiplyMatrices(bt.matrixWorldInverse,_t.matrixWorld);const It=_e.update(_t),Ot=_t.material;if(Array.isArray(Ot)){const Bt=It.groups;for(let Ut=0,Ft=Bt.length;Ut<Ft;Ut++){const jt=Bt[Ut],Dt=Ot[jt.materialIndex];if(Dt&&Dt.visible){const Gt=yt(_t,Dt,wt,Tt);tt.renderBufferDirect(bt,null,It,Gt,_t,jt)}}}else if(Ot.visible){const Bt=yt(_t,Ot,wt,Tt);tt.renderBufferDirect(bt,null,It,Bt,_t,null)}}const Pt=_t.children;for(let It=0,Ot=Pt.length;It<Ot;It++)xt(Pt[It],Et,bt,wt,Tt)}}function WebGLState(tt,_e,rt){const nt=rt.isWebGL2;function it(){let lr=!1;const Rr=new Vector4;let br=null;const jr=new Vector4(0,0,0,0);return{setMask:function(Yr){br!==Yr&&!lr&&(tt.colorMask(Yr,Yr,Yr,Yr),br=Yr)},setLocked:function(Yr){lr=Yr},setClear:function(Yr,mn,bn,fn,Cn){Cn===!0&&(Yr*=fn,mn*=fn,bn*=fn),Rr.set(Yr,mn,bn,fn),jr.equals(Rr)===!1&&(tt.clearColor(Yr,mn,bn,fn),jr.copy(Rr))},reset:function(){lr=!1,br=null,jr.set(-1,0,0,0)}}}function st(){let lr=!1,Rr=null,br=null,jr=null;return{setTest:function(Yr){Yr?rr(tt.DEPTH_TEST):ur(tt.DEPTH_TEST)},setMask:function(Yr){Rr!==Yr&&!lr&&(tt.depthMask(Yr),Rr=Yr)},setFunc:function(Yr){if(br!==Yr){switch(Yr){case NeverDepth:tt.depthFunc(tt.NEVER);break;case AlwaysDepth:tt.depthFunc(tt.ALWAYS);break;case LessDepth:tt.depthFunc(tt.LESS);break;case LessEqualDepth:tt.depthFunc(tt.LEQUAL);break;case EqualDepth:tt.depthFunc(tt.EQUAL);break;case GreaterEqualDepth:tt.depthFunc(tt.GEQUAL);break;case GreaterDepth:tt.depthFunc(tt.GREATER);break;case NotEqualDepth:tt.depthFunc(tt.NOTEQUAL);break;default:tt.depthFunc(tt.LEQUAL)}br=Yr}},setLocked:function(Yr){lr=Yr},setClear:function(Yr){jr!==Yr&&(tt.clearDepth(Yr),jr=Yr)},reset:function(){lr=!1,Rr=null,br=null,jr=null}}}function ot(){let lr=!1,Rr=null,br=null,jr=null,Yr=null,mn=null,bn=null,fn=null,Cn=null;return{setTest:function(Tn){lr||(Tn?rr(tt.STENCIL_TEST):ur(tt.STENCIL_TEST))},setMask:function(Tn){Rr!==Tn&&!lr&&(tt.stencilMask(Tn),Rr=Tn)},setFunc:function(Tn,gn,En){(br!==Tn||jr!==gn||Yr!==En)&&(tt.stencilFunc(Tn,gn,En),br=Tn,jr=gn,Yr=En)},setOp:function(Tn,gn,En){(mn!==Tn||bn!==gn||fn!==En)&&(tt.stencilOp(Tn,gn,En),mn=Tn,bn=gn,fn=En)},setLocked:function(Tn){lr=Tn},setClear:function(Tn){Cn!==Tn&&(tt.clearStencil(Tn),Cn=Tn)},reset:function(){lr=!1,Rr=null,br=null,jr=null,Yr=null,mn=null,bn=null,fn=null,Cn=null}}}const lt=new it,at=new st,ct=new ot,ut=new WeakMap,ht=new WeakMap;let dt={},ft={},pt=new WeakMap,mt=[],gt=null,vt=!1,At=null,yt=null,xt=null,_t=null,Et=null,bt=null,wt=null,Tt=!1,Mt=null,Pt=null,It=null,Ot=null,Bt=null;const Ut=tt.getParameter(tt.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Ft=!1,jt=0;const Dt=tt.getParameter(tt.VERSION);Dt.indexOf("WebGL")!==-1?(jt=parseFloat(/^WebGL (\d)/.exec(Dt)[1]),Ft=jt>=1):Dt.indexOf("OpenGL ES")!==-1&&(jt=parseFloat(/^OpenGL ES (\d)/.exec(Dt)[1]),Ft=jt>=2);let Gt=null,zt={};const $t=tt.getParameter(tt.SCISSOR_BOX),Ht=tt.getParameter(tt.VIEWPORT),er=new Vector4().fromArray($t),Zt=new Vector4().fromArray(Ht);function or(lr,Rr,br,jr){const Yr=new Uint8Array(4),mn=tt.createTexture();tt.bindTexture(lr,mn),tt.texParameteri(lr,tt.TEXTURE_MIN_FILTER,tt.NEAREST),tt.texParameteri(lr,tt.TEXTURE_MAG_FILTER,tt.NEAREST);for(let bn=0;bn<br;bn++)nt&&(lr===tt.TEXTURE_3D||lr===tt.TEXTURE_2D_ARRAY)?tt.texImage3D(Rr,0,tt.RGBA,1,1,jr,0,tt.RGBA,tt.UNSIGNED_BYTE,Yr):tt.texImage2D(Rr+bn,0,tt.RGBA,1,1,0,tt.RGBA,tt.UNSIGNED_BYTE,Yr);return mn}const Kt={};Kt[tt.TEXTURE_2D]=or(tt.TEXTURE_2D,tt.TEXTURE_2D,1),Kt[tt.TEXTURE_CUBE_MAP]=or(tt.TEXTURE_CUBE_MAP,tt.TEXTURE_CUBE_MAP_POSITIVE_X,6),nt&&(Kt[tt.TEXTURE_2D_ARRAY]=or(tt.TEXTURE_2D_ARRAY,tt.TEXTURE_2D_ARRAY,1,1),Kt[tt.TEXTURE_3D]=or(tt.TEXTURE_3D,tt.TEXTURE_3D,1,1)),lt.setClear(0,0,0,1),at.setClear(1),ct.setClear(0),rr(tt.DEPTH_TEST),at.setFunc(LessEqualDepth),Sr(!1),Qr(CullFaceBack),rr(tt.CULL_FACE),vr(NoBlending);function rr(lr){dt[lr]!==!0&&(tt.enable(lr),dt[lr]=!0)}function ur(lr){dt[lr]!==!1&&(tt.disable(lr),dt[lr]=!1)}function fr(lr,Rr){return ft[lr]!==Rr?(tt.bindFramebuffer(lr,Rr),ft[lr]=Rr,nt&&(lr===tt.DRAW_FRAMEBUFFER&&(ft[tt.FRAMEBUFFER]=Rr),lr===tt.FRAMEBUFFER&&(ft[tt.DRAW_FRAMEBUFFER]=Rr)),!0):!1}function dr(lr,Rr){let br=mt,jr=!1;if(lr)if(br=pt.get(Rr),br===void 0&&(br=[],pt.set(Rr,br)),lr.isWebGLMultipleRenderTargets){const Yr=lr.texture;if(br.length!==Yr.length||br[0]!==tt.COLOR_ATTACHMENT0){for(let mn=0,bn=Yr.length;mn<bn;mn++)br[mn]=tt.COLOR_ATTACHMENT0+mn;br.length=Yr.length,jr=!0}}else br[0]!==tt.COLOR_ATTACHMENT0&&(br[0]=tt.COLOR_ATTACHMENT0,jr=!0);else br[0]!==tt.BACK&&(br[0]=tt.BACK,jr=!0);jr&&(rt.isWebGL2?tt.drawBuffers(br):_e.get("WEBGL_draw_buffers").drawBuffersWEBGL(br))}function gr(lr){return gt!==lr?(tt.useProgram(lr),gt=lr,!0):!1}const Yt={[AddEquation]:tt.FUNC_ADD,[SubtractEquation]:tt.FUNC_SUBTRACT,[ReverseSubtractEquation]:tt.FUNC_REVERSE_SUBTRACT};if(nt)Yt[MinEquation]=tt.MIN,Yt[MaxEquation]=tt.MAX;else{const lr=_e.get("EXT_blend_minmax");lr!==null&&(Yt[MinEquation]=lr.MIN_EXT,Yt[MaxEquation]=lr.MAX_EXT)}const xr={[ZeroFactor]:tt.ZERO,[OneFactor]:tt.ONE,[SrcColorFactor]:tt.SRC_COLOR,[SrcAlphaFactor]:tt.SRC_ALPHA,[SrcAlphaSaturateFactor]:tt.SRC_ALPHA_SATURATE,[DstColorFactor]:tt.DST_COLOR,[DstAlphaFactor]:tt.DST_ALPHA,[OneMinusSrcColorFactor]:tt.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:tt.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:tt.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:tt.ONE_MINUS_DST_ALPHA};function vr(lr,Rr,br,jr,Yr,mn,bn,fn){if(lr===NoBlending){vt===!0&&(ur(tt.BLEND),vt=!1);return}if(vt===!1&&(rr(tt.BLEND),vt=!0),lr!==CustomBlending){if(lr!==At||fn!==Tt){if((yt!==AddEquation||Et!==AddEquation)&&(tt.blendEquation(tt.FUNC_ADD),yt=AddEquation,Et=AddEquation),fn)switch(lr){case NormalBlending:tt.blendFuncSeparate(tt.ONE,tt.ONE_MINUS_SRC_ALPHA,tt.ONE,tt.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:tt.blendFunc(tt.ONE,tt.ONE);break;case SubtractiveBlending:tt.blendFuncSeparate(tt.ZERO,tt.ONE_MINUS_SRC_COLOR,tt.ZERO,tt.ONE);break;case MultiplyBlending:tt.blendFuncSeparate(tt.ZERO,tt.SRC_COLOR,tt.ZERO,tt.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",lr);break}else switch(lr){case NormalBlending:tt.blendFuncSeparate(tt.SRC_ALPHA,tt.ONE_MINUS_SRC_ALPHA,tt.ONE,tt.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:tt.blendFunc(tt.SRC_ALPHA,tt.ONE);break;case SubtractiveBlending:tt.blendFuncSeparate(tt.ZERO,tt.ONE_MINUS_SRC_COLOR,tt.ZERO,tt.ONE);break;case MultiplyBlending:tt.blendFunc(tt.ZERO,tt.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",lr);break}xt=null,_t=null,bt=null,wt=null,At=lr,Tt=fn}return}Yr=Yr||Rr,mn=mn||br,bn=bn||jr,(Rr!==yt||Yr!==Et)&&(tt.blendEquationSeparate(Yt[Rr],Yt[Yr]),yt=Rr,Et=Yr),(br!==xt||jr!==_t||mn!==bt||bn!==wt)&&(tt.blendFuncSeparate(xr[br],xr[jr],xr[mn],xr[bn]),xt=br,_t=jr,bt=mn,wt=bn),At=lr,Tt=!1}function Pr(lr,Rr){lr.side===DoubleSide?ur(tt.CULL_FACE):rr(tt.CULL_FACE);let br=lr.side===BackSide;Rr&&(br=!br),Sr(br),lr.blending===NormalBlending&&lr.transparent===!1?vr(NoBlending):vr(lr.blending,lr.blendEquation,lr.blendSrc,lr.blendDst,lr.blendEquationAlpha,lr.blendSrcAlpha,lr.blendDstAlpha,lr.premultipliedAlpha),at.setFunc(lr.depthFunc),at.setTest(lr.depthTest),at.setMask(lr.depthWrite),lt.setMask(lr.colorWrite);const jr=lr.stencilWrite;ct.setTest(jr),jr&&(ct.setMask(lr.stencilWriteMask),ct.setFunc(lr.stencilFunc,lr.stencilRef,lr.stencilFuncMask),ct.setOp(lr.stencilFail,lr.stencilZFail,lr.stencilZPass)),Dr(lr.polygonOffset,lr.polygonOffsetFactor,lr.polygonOffsetUnits),lr.alphaToCoverage===!0?rr(tt.SAMPLE_ALPHA_TO_COVERAGE):ur(tt.SAMPLE_ALPHA_TO_COVERAGE)}function Sr(lr){Mt!==lr&&(lr?tt.frontFace(tt.CW):tt.frontFace(tt.CCW),Mt=lr)}function Qr(lr){lr!==CullFaceNone?(rr(tt.CULL_FACE),lr!==Pt&&(lr===CullFaceBack?tt.cullFace(tt.BACK):lr===CullFaceFront?tt.cullFace(tt.FRONT):tt.cullFace(tt.FRONT_AND_BACK))):ur(tt.CULL_FACE),Pt=lr}function Ir(lr){lr!==It&&(Ft&&tt.lineWidth(lr),It=lr)}function Dr(lr,Rr,br){lr?(rr(tt.POLYGON_OFFSET_FILL),(Ot!==Rr||Bt!==br)&&(tt.polygonOffset(Rr,br),Ot=Rr,Bt=br)):ur(tt.POLYGON_OFFSET_FILL)}function Ur(lr){lr?rr(tt.SCISSOR_TEST):ur(tt.SCISSOR_TEST)}function Lr(lr){lr===void 0&&(lr=tt.TEXTURE0+Ut-1),Gt!==lr&&(tt.activeTexture(lr),Gt=lr)}function Wr(lr,Rr,br){br===void 0&&(Gt===null?br=tt.TEXTURE0+Ut-1:br=Gt);let jr=zt[br];jr===void 0&&(jr={type:void 0,texture:void 0},zt[br]=jr),(jr.type!==lr||jr.texture!==Rr)&&(Gt!==br&&(tt.activeTexture(br),Gt=br),tt.bindTexture(lr,Rr||Kt[lr]),jr.type=lr,jr.texture=Rr)}function Xt(){const lr=zt[Gt];lr!==void 0&&lr.type!==void 0&&(tt.bindTexture(lr.type,null),lr.type=void 0,lr.texture=void 0)}function Qt(){try{tt.compressedTexImage2D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function hr(){try{tt.compressedTexImage3D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function kr(){try{tt.texSubImage2D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function yr(){try{tt.texSubImage3D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function _r(){try{tt.compressedTexSubImage2D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function Hr(){try{tt.compressedTexSubImage3D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function Er(){try{tt.texStorage2D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function Ar(){try{tt.texStorage3D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function qt(){try{tt.texImage2D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function pr(){try{tt.texImage3D.apply(tt,arguments)}catch(lr){console.error("THREE.WebGLState:",lr)}}function mr(lr){er.equals(lr)===!1&&(tt.scissor(lr.x,lr.y,lr.z,lr.w),er.copy(lr))}function nr(lr){Zt.equals(lr)===!1&&(tt.viewport(lr.x,lr.y,lr.z,lr.w),Zt.copy(lr))}function Cr(lr,Rr){let br=ht.get(Rr);br===void 0&&(br=new WeakMap,ht.set(Rr,br));let jr=br.get(lr);jr===void 0&&(jr=tt.getUniformBlockIndex(Rr,lr.name),br.set(lr,jr))}function cr(lr,Rr){const jr=ht.get(Rr).get(lr);ut.get(Rr)!==jr&&(tt.uniformBlockBinding(Rr,jr,lr.__bindingPointIndex),ut.set(Rr,jr))}function Jr(){tt.disable(tt.BLEND),tt.disable(tt.CULL_FACE),tt.disable(tt.DEPTH_TEST),tt.disable(tt.POLYGON_OFFSET_FILL),tt.disable(tt.SCISSOR_TEST),tt.disable(tt.STENCIL_TEST),tt.disable(tt.SAMPLE_ALPHA_TO_COVERAGE),tt.blendEquation(tt.FUNC_ADD),tt.blendFunc(tt.ONE,tt.ZERO),tt.blendFuncSeparate(tt.ONE,tt.ZERO,tt.ONE,tt.ZERO),tt.colorMask(!0,!0,!0,!0),tt.clearColor(0,0,0,0),tt.depthMask(!0),tt.depthFunc(tt.LESS),tt.clearDepth(1),tt.stencilMask(4294967295),tt.stencilFunc(tt.ALWAYS,0,4294967295),tt.stencilOp(tt.KEEP,tt.KEEP,tt.KEEP),tt.clearStencil(0),tt.cullFace(tt.BACK),tt.frontFace(tt.CCW),tt.polygonOffset(0,0),tt.activeTexture(tt.TEXTURE0),tt.bindFramebuffer(tt.FRAMEBUFFER,null),nt===!0&&(tt.bindFramebuffer(tt.DRAW_FRAMEBUFFER,null),tt.bindFramebuffer(tt.READ_FRAMEBUFFER,null)),tt.useProgram(null),tt.lineWidth(1),tt.scissor(0,0,tt.canvas.width,tt.canvas.height),tt.viewport(0,0,tt.canvas.width,tt.canvas.height),dt={},Gt=null,zt={},ft={},pt=new WeakMap,mt=[],gt=null,vt=!1,At=null,yt=null,xt=null,_t=null,Et=null,bt=null,wt=null,Tt=!1,Mt=null,Pt=null,It=null,Ot=null,Bt=null,er.set(0,0,tt.canvas.width,tt.canvas.height),Zt.set(0,0,tt.canvas.width,tt.canvas.height),lt.reset(),at.reset(),ct.reset()}return{buffers:{color:lt,depth:at,stencil:ct},enable:rr,disable:ur,bindFramebuffer:fr,drawBuffers:dr,useProgram:gr,setBlending:vr,setMaterial:Pr,setFlipSided:Sr,setCullFace:Qr,setLineWidth:Ir,setPolygonOffset:Dr,setScissorTest:Ur,activeTexture:Lr,bindTexture:Wr,unbindTexture:Xt,compressedTexImage2D:Qt,compressedTexImage3D:hr,texImage2D:qt,texImage3D:pr,updateUBOMapping:Cr,uniformBlockBinding:cr,texStorage2D:Er,texStorage3D:Ar,texSubImage2D:kr,texSubImage3D:yr,compressedTexSubImage2D:_r,compressedTexSubImage3D:Hr,scissor:mr,viewport:nr,reset:Jr}}function WebGLTextures(tt,_e,rt,nt,it,st,ot){const lt=it.isWebGL2,at=it.maxTextures,ct=it.maxCubemapSize,ut=it.maxTextureSize,ht=it.maxSamples,dt=_e.has("WEBGL_multisampled_render_to_texture")?_e.get("WEBGL_multisampled_render_to_texture"):null,ft=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),pt=new WeakMap;let mt;const gt=new WeakMap;let vt=!1;try{vt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function At(Xt,Qt){return vt?new OffscreenCanvas(Xt,Qt):createElementNS("canvas")}function yt(Xt,Qt,hr,kr){let yr=1;if((Xt.width>kr||Xt.height>kr)&&(yr=kr/Math.max(Xt.width,Xt.height)),yr<1||Qt===!0)if(typeof HTMLImageElement<"u"&&Xt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Xt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Xt instanceof ImageBitmap){const _r=Qt?floorPowerOfTwo:Math.floor,Hr=_r(yr*Xt.width),Er=_r(yr*Xt.height);mt===void 0&&(mt=At(Hr,Er));const Ar=hr?At(Hr,Er):mt;return Ar.width=Hr,Ar.height=Er,Ar.getContext("2d").drawImage(Xt,0,0,Hr,Er),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Xt.width+"x"+Xt.height+") to ("+Hr+"x"+Er+")."),Ar}else return"data"in Xt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Xt.width+"x"+Xt.height+")."),Xt;return Xt}function xt(Xt){return isPowerOfTwo(Xt.width)&&isPowerOfTwo(Xt.height)}function _t(Xt){return lt?!1:Xt.wrapS!==ClampToEdgeWrapping||Xt.wrapT!==ClampToEdgeWrapping||Xt.minFilter!==NearestFilter&&Xt.minFilter!==LinearFilter}function Et(Xt,Qt){return Xt.generateMipmaps&&Qt&&Xt.minFilter!==NearestFilter&&Xt.minFilter!==LinearFilter}function bt(Xt){tt.generateMipmap(Xt)}function wt(Xt,Qt,hr,kr,yr=!1){if(lt===!1)return Qt;if(Xt!==null){if(tt[Xt]!==void 0)return tt[Xt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Xt+"'")}let _r=Qt;return Qt===tt.RED&&(hr===tt.FLOAT&&(_r=tt.R32F),hr===tt.HALF_FLOAT&&(_r=tt.R16F),hr===tt.UNSIGNED_BYTE&&(_r=tt.R8)),Qt===tt.RG&&(hr===tt.FLOAT&&(_r=tt.RG32F),hr===tt.HALF_FLOAT&&(_r=tt.RG16F),hr===tt.UNSIGNED_BYTE&&(_r=tt.RG8)),Qt===tt.RGBA&&(hr===tt.FLOAT&&(_r=tt.RGBA32F),hr===tt.HALF_FLOAT&&(_r=tt.RGBA16F),hr===tt.UNSIGNED_BYTE&&(_r=kr===SRGBColorSpace&&yr===!1?tt.SRGB8_ALPHA8:tt.RGBA8),hr===tt.UNSIGNED_SHORT_4_4_4_4&&(_r=tt.RGBA4),hr===tt.UNSIGNED_SHORT_5_5_5_1&&(_r=tt.RGB5_A1)),(_r===tt.R16F||_r===tt.R32F||_r===tt.RG16F||_r===tt.RG32F||_r===tt.RGBA16F||_r===tt.RGBA32F)&&_e.get("EXT_color_buffer_float"),_r}function Tt(Xt,Qt,hr){return Et(Xt,hr)===!0||Xt.isFramebufferTexture&&Xt.minFilter!==NearestFilter&&Xt.minFilter!==LinearFilter?Math.log2(Math.max(Qt.width,Qt.height))+1:Xt.mipmaps!==void 0&&Xt.mipmaps.length>0?Xt.mipmaps.length:Xt.isCompressedTexture&&Array.isArray(Xt.image)?Qt.mipmaps.length:1}function Mt(Xt){return Xt===NearestFilter||Xt===NearestMipmapNearestFilter||Xt===NearestMipmapLinearFilter?tt.NEAREST:tt.LINEAR}function Pt(Xt){const Qt=Xt.target;Qt.removeEventListener("dispose",Pt),Ot(Qt),Qt.isVideoTexture&&pt.delete(Qt)}function It(Xt){const Qt=Xt.target;Qt.removeEventListener("dispose",It),Ut(Qt)}function Ot(Xt){const Qt=nt.get(Xt);if(Qt.__webglInit===void 0)return;const hr=Xt.source,kr=gt.get(hr);if(kr){const yr=kr[Qt.__cacheKey];yr.usedTimes--,yr.usedTimes===0&&Bt(Xt),Object.keys(kr).length===0&&gt.delete(hr)}nt.remove(Xt)}function Bt(Xt){const Qt=nt.get(Xt);tt.deleteTexture(Qt.__webglTexture);const hr=Xt.source,kr=gt.get(hr);delete kr[Qt.__cacheKey],ot.memory.textures--}function Ut(Xt){const Qt=Xt.texture,hr=nt.get(Xt),kr=nt.get(Qt);if(kr.__webglTexture!==void 0&&(tt.deleteTexture(kr.__webglTexture),ot.memory.textures--),Xt.depthTexture&&Xt.depthTexture.dispose(),Xt.isWebGLCubeRenderTarget)for(let yr=0;yr<6;yr++)tt.deleteFramebuffer(hr.__webglFramebuffer[yr]),hr.__webglDepthbuffer&&tt.deleteRenderbuffer(hr.__webglDepthbuffer[yr]);else{if(tt.deleteFramebuffer(hr.__webglFramebuffer),hr.__webglDepthbuffer&&tt.deleteRenderbuffer(hr.__webglDepthbuffer),hr.__webglMultisampledFramebuffer&&tt.deleteFramebuffer(hr.__webglMultisampledFramebuffer),hr.__webglColorRenderbuffer)for(let yr=0;yr<hr.__webglColorRenderbuffer.length;yr++)hr.__webglColorRenderbuffer[yr]&&tt.deleteRenderbuffer(hr.__webglColorRenderbuffer[yr]);hr.__webglDepthRenderbuffer&&tt.deleteRenderbuffer(hr.__webglDepthRenderbuffer)}if(Xt.isWebGLMultipleRenderTargets)for(let yr=0,_r=Qt.length;yr<_r;yr++){const Hr=nt.get(Qt[yr]);Hr.__webglTexture&&(tt.deleteTexture(Hr.__webglTexture),ot.memory.textures--),nt.remove(Qt[yr])}nt.remove(Qt),nt.remove(Xt)}let Ft=0;function jt(){Ft=0}function Dt(){const Xt=Ft;return Xt>=at&&console.warn("THREE.WebGLTextures: Trying to use "+Xt+" texture units while this GPU supports only "+at),Ft+=1,Xt}function Gt(Xt){const Qt=[];return Qt.push(Xt.wrapS),Qt.push(Xt.wrapT),Qt.push(Xt.wrapR||0),Qt.push(Xt.magFilter),Qt.push(Xt.minFilter),Qt.push(Xt.anisotropy),Qt.push(Xt.internalFormat),Qt.push(Xt.format),Qt.push(Xt.type),Qt.push(Xt.generateMipmaps),Qt.push(Xt.premultiplyAlpha),Qt.push(Xt.flipY),Qt.push(Xt.unpackAlignment),Qt.push(Xt.colorSpace),Qt.join()}function zt(Xt,Qt){const hr=nt.get(Xt);if(Xt.isVideoTexture&&Lr(Xt),Xt.isRenderTargetTexture===!1&&Xt.version>0&&hr.__version!==Xt.version){const kr=Xt.image;if(kr===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(kr.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{fr(hr,Xt,Qt);return}}rt.bindTexture(tt.TEXTURE_2D,hr.__webglTexture,tt.TEXTURE0+Qt)}function $t(Xt,Qt){const hr=nt.get(Xt);if(Xt.version>0&&hr.__version!==Xt.version){fr(hr,Xt,Qt);return}rt.bindTexture(tt.TEXTURE_2D_ARRAY,hr.__webglTexture,tt.TEXTURE0+Qt)}function Ht(Xt,Qt){const hr=nt.get(Xt);if(Xt.version>0&&hr.__version!==Xt.version){fr(hr,Xt,Qt);return}rt.bindTexture(tt.TEXTURE_3D,hr.__webglTexture,tt.TEXTURE0+Qt)}function er(Xt,Qt){const hr=nt.get(Xt);if(Xt.version>0&&hr.__version!==Xt.version){dr(hr,Xt,Qt);return}rt.bindTexture(tt.TEXTURE_CUBE_MAP,hr.__webglTexture,tt.TEXTURE0+Qt)}const Zt={[RepeatWrapping]:tt.REPEAT,[ClampToEdgeWrapping]:tt.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:tt.MIRRORED_REPEAT},or={[NearestFilter]:tt.NEAREST,[NearestMipmapNearestFilter]:tt.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:tt.NEAREST_MIPMAP_LINEAR,[LinearFilter]:tt.LINEAR,[LinearMipmapNearestFilter]:tt.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:tt.LINEAR_MIPMAP_LINEAR},Kt={[NeverCompare]:tt.NEVER,[AlwaysCompare]:tt.ALWAYS,[LessCompare]:tt.LESS,[LessEqualCompare]:tt.LEQUAL,[EqualCompare]:tt.EQUAL,[GreaterEqualCompare]:tt.GEQUAL,[GreaterCompare]:tt.GREATER,[NotEqualCompare]:tt.NOTEQUAL};function rr(Xt,Qt,hr){if(hr?(tt.texParameteri(Xt,tt.TEXTURE_WRAP_S,Zt[Qt.wrapS]),tt.texParameteri(Xt,tt.TEXTURE_WRAP_T,Zt[Qt.wrapT]),(Xt===tt.TEXTURE_3D||Xt===tt.TEXTURE_2D_ARRAY)&&tt.texParameteri(Xt,tt.TEXTURE_WRAP_R,Zt[Qt.wrapR]),tt.texParameteri(Xt,tt.TEXTURE_MAG_FILTER,or[Qt.magFilter]),tt.texParameteri(Xt,tt.TEXTURE_MIN_FILTER,or[Qt.minFilter])):(tt.texParameteri(Xt,tt.TEXTURE_WRAP_S,tt.CLAMP_TO_EDGE),tt.texParameteri(Xt,tt.TEXTURE_WRAP_T,tt.CLAMP_TO_EDGE),(Xt===tt.TEXTURE_3D||Xt===tt.TEXTURE_2D_ARRAY)&&tt.texParameteri(Xt,tt.TEXTURE_WRAP_R,tt.CLAMP_TO_EDGE),(Qt.wrapS!==ClampToEdgeWrapping||Qt.wrapT!==ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),tt.texParameteri(Xt,tt.TEXTURE_MAG_FILTER,Mt(Qt.magFilter)),tt.texParameteri(Xt,tt.TEXTURE_MIN_FILTER,Mt(Qt.minFilter)),Qt.minFilter!==NearestFilter&&Qt.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Qt.compareFunction&&(tt.texParameteri(Xt,tt.TEXTURE_COMPARE_MODE,tt.COMPARE_REF_TO_TEXTURE),tt.texParameteri(Xt,tt.TEXTURE_COMPARE_FUNC,Kt[Qt.compareFunction])),_e.has("EXT_texture_filter_anisotropic")===!0){const kr=_e.get("EXT_texture_filter_anisotropic");if(Qt.magFilter===NearestFilter||Qt.minFilter!==NearestMipmapLinearFilter&&Qt.minFilter!==LinearMipmapLinearFilter||Qt.type===FloatType&&_e.has("OES_texture_float_linear")===!1||lt===!1&&Qt.type===HalfFloatType&&_e.has("OES_texture_half_float_linear")===!1)return;(Qt.anisotropy>1||nt.get(Qt).__currentAnisotropy)&&(tt.texParameterf(Xt,kr.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Qt.anisotropy,it.getMaxAnisotropy())),nt.get(Qt).__currentAnisotropy=Qt.anisotropy)}}function ur(Xt,Qt){let hr=!1;Xt.__webglInit===void 0&&(Xt.__webglInit=!0,Qt.addEventListener("dispose",Pt));const kr=Qt.source;let yr=gt.get(kr);yr===void 0&&(yr={},gt.set(kr,yr));const _r=Gt(Qt);if(_r!==Xt.__cacheKey){yr[_r]===void 0&&(yr[_r]={texture:tt.createTexture(),usedTimes:0},ot.memory.textures++,hr=!0),yr[_r].usedTimes++;const Hr=yr[Xt.__cacheKey];Hr!==void 0&&(yr[Xt.__cacheKey].usedTimes--,Hr.usedTimes===0&&Bt(Qt)),Xt.__cacheKey=_r,Xt.__webglTexture=yr[_r].texture}return hr}function fr(Xt,Qt,hr){let kr=tt.TEXTURE_2D;(Qt.isDataArrayTexture||Qt.isCompressedArrayTexture)&&(kr=tt.TEXTURE_2D_ARRAY),Qt.isData3DTexture&&(kr=tt.TEXTURE_3D);const yr=ur(Xt,Qt),_r=Qt.source;rt.bindTexture(kr,Xt.__webglTexture,tt.TEXTURE0+hr);const Hr=nt.get(_r);if(_r.version!==Hr.__version||yr===!0){rt.activeTexture(tt.TEXTURE0+hr),tt.pixelStorei(tt.UNPACK_FLIP_Y_WEBGL,Qt.flipY),tt.pixelStorei(tt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Qt.premultiplyAlpha),tt.pixelStorei(tt.UNPACK_ALIGNMENT,Qt.unpackAlignment),tt.pixelStorei(tt.UNPACK_COLORSPACE_CONVERSION_WEBGL,tt.NONE);const Er=_t(Qt)&&xt(Qt.image)===!1;let Ar=yt(Qt.image,Er,!1,ut);Ar=Wr(Qt,Ar);const qt=xt(Ar)||lt,pr=st.convert(Qt.format,Qt.colorSpace);let mr=st.convert(Qt.type),nr=wt(Qt.internalFormat,pr,mr,Qt.colorSpace);rr(kr,Qt,qt);let Cr;const cr=Qt.mipmaps,Jr=lt&&Qt.isVideoTexture!==!0,lr=Hr.__version===void 0||yr===!0,Rr=Tt(Qt,Ar,qt);if(Qt.isDepthTexture)nr=tt.DEPTH_COMPONENT,lt?Qt.type===FloatType?nr=tt.DEPTH_COMPONENT32F:Qt.type===UnsignedIntType?nr=tt.DEPTH_COMPONENT24:Qt.type===UnsignedInt248Type?nr=tt.DEPTH24_STENCIL8:nr=tt.DEPTH_COMPONENT16:Qt.type===FloatType&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Qt.format===DepthFormat&&nr===tt.DEPTH_COMPONENT&&Qt.type!==UnsignedShortType&&Qt.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Qt.type=UnsignedIntType,mr=st.convert(Qt.type)),Qt.format===DepthStencilFormat&&nr===tt.DEPTH_COMPONENT&&(nr=tt.DEPTH_STENCIL,Qt.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Qt.type=UnsignedInt248Type,mr=st.convert(Qt.type))),lr&&(Jr?rt.texStorage2D(tt.TEXTURE_2D,1,nr,Ar.width,Ar.height):rt.texImage2D(tt.TEXTURE_2D,0,nr,Ar.width,Ar.height,0,pr,mr,null));else if(Qt.isDataTexture)if(cr.length>0&&qt){Jr&&lr&&rt.texStorage2D(tt.TEXTURE_2D,Rr,nr,cr[0].width,cr[0].height);for(let br=0,jr=cr.length;br<jr;br++)Cr=cr[br],Jr?rt.texSubImage2D(tt.TEXTURE_2D,br,0,0,Cr.width,Cr.height,pr,mr,Cr.data):rt.texImage2D(tt.TEXTURE_2D,br,nr,Cr.width,Cr.height,0,pr,mr,Cr.data);Qt.generateMipmaps=!1}else Jr?(lr&&rt.texStorage2D(tt.TEXTURE_2D,Rr,nr,Ar.width,Ar.height),rt.texSubImage2D(tt.TEXTURE_2D,0,0,0,Ar.width,Ar.height,pr,mr,Ar.data)):rt.texImage2D(tt.TEXTURE_2D,0,nr,Ar.width,Ar.height,0,pr,mr,Ar.data);else if(Qt.isCompressedTexture)if(Qt.isCompressedArrayTexture){Jr&&lr&&rt.texStorage3D(tt.TEXTURE_2D_ARRAY,Rr,nr,cr[0].width,cr[0].height,Ar.depth);for(let br=0,jr=cr.length;br<jr;br++)Cr=cr[br],Qt.format!==RGBAFormat?pr!==null?Jr?rt.compressedTexSubImage3D(tt.TEXTURE_2D_ARRAY,br,0,0,0,Cr.width,Cr.height,Ar.depth,pr,Cr.data,0,0):rt.compressedTexImage3D(tt.TEXTURE_2D_ARRAY,br,nr,Cr.width,Cr.height,Ar.depth,0,Cr.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Jr?rt.texSubImage3D(tt.TEXTURE_2D_ARRAY,br,0,0,0,Cr.width,Cr.height,Ar.depth,pr,mr,Cr.data):rt.texImage3D(tt.TEXTURE_2D_ARRAY,br,nr,Cr.width,Cr.height,Ar.depth,0,pr,mr,Cr.data)}else{Jr&&lr&&rt.texStorage2D(tt.TEXTURE_2D,Rr,nr,cr[0].width,cr[0].height);for(let br=0,jr=cr.length;br<jr;br++)Cr=cr[br],Qt.format!==RGBAFormat?pr!==null?Jr?rt.compressedTexSubImage2D(tt.TEXTURE_2D,br,0,0,Cr.width,Cr.height,pr,Cr.data):rt.compressedTexImage2D(tt.TEXTURE_2D,br,nr,Cr.width,Cr.height,0,Cr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Jr?rt.texSubImage2D(tt.TEXTURE_2D,br,0,0,Cr.width,Cr.height,pr,mr,Cr.data):rt.texImage2D(tt.TEXTURE_2D,br,nr,Cr.width,Cr.height,0,pr,mr,Cr.data)}else if(Qt.isDataArrayTexture)Jr?(lr&&rt.texStorage3D(tt.TEXTURE_2D_ARRAY,Rr,nr,Ar.width,Ar.height,Ar.depth),rt.texSubImage3D(tt.TEXTURE_2D_ARRAY,0,0,0,0,Ar.width,Ar.height,Ar.depth,pr,mr,Ar.data)):rt.texImage3D(tt.TEXTURE_2D_ARRAY,0,nr,Ar.width,Ar.height,Ar.depth,0,pr,mr,Ar.data);else if(Qt.isData3DTexture)Jr?(lr&&rt.texStorage3D(tt.TEXTURE_3D,Rr,nr,Ar.width,Ar.height,Ar.depth),rt.texSubImage3D(tt.TEXTURE_3D,0,0,0,0,Ar.width,Ar.height,Ar.depth,pr,mr,Ar.data)):rt.texImage3D(tt.TEXTURE_3D,0,nr,Ar.width,Ar.height,Ar.depth,0,pr,mr,Ar.data);else if(Qt.isFramebufferTexture){if(lr)if(Jr)rt.texStorage2D(tt.TEXTURE_2D,Rr,nr,Ar.width,Ar.height);else{let br=Ar.width,jr=Ar.height;for(let Yr=0;Yr<Rr;Yr++)rt.texImage2D(tt.TEXTURE_2D,Yr,nr,br,jr,0,pr,mr,null),br>>=1,jr>>=1}}else if(cr.length>0&&qt){Jr&&lr&&rt.texStorage2D(tt.TEXTURE_2D,Rr,nr,cr[0].width,cr[0].height);for(let br=0,jr=cr.length;br<jr;br++)Cr=cr[br],Jr?rt.texSubImage2D(tt.TEXTURE_2D,br,0,0,pr,mr,Cr):rt.texImage2D(tt.TEXTURE_2D,br,nr,pr,mr,Cr);Qt.generateMipmaps=!1}else Jr?(lr&&rt.texStorage2D(tt.TEXTURE_2D,Rr,nr,Ar.width,Ar.height),rt.texSubImage2D(tt.TEXTURE_2D,0,0,0,pr,mr,Ar)):rt.texImage2D(tt.TEXTURE_2D,0,nr,pr,mr,Ar);Et(Qt,qt)&&bt(kr),Hr.__version=_r.version,Qt.onUpdate&&Qt.onUpdate(Qt)}Xt.__version=Qt.version}function dr(Xt,Qt,hr){if(Qt.image.length!==6)return;const kr=ur(Xt,Qt),yr=Qt.source;rt.bindTexture(tt.TEXTURE_CUBE_MAP,Xt.__webglTexture,tt.TEXTURE0+hr);const _r=nt.get(yr);if(yr.version!==_r.__version||kr===!0){rt.activeTexture(tt.TEXTURE0+hr),tt.pixelStorei(tt.UNPACK_FLIP_Y_WEBGL,Qt.flipY),tt.pixelStorei(tt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Qt.premultiplyAlpha),tt.pixelStorei(tt.UNPACK_ALIGNMENT,Qt.unpackAlignment),tt.pixelStorei(tt.UNPACK_COLORSPACE_CONVERSION_WEBGL,tt.NONE);const Hr=Qt.isCompressedTexture||Qt.image[0].isCompressedTexture,Er=Qt.image[0]&&Qt.image[0].isDataTexture,Ar=[];for(let br=0;br<6;br++)!Hr&&!Er?Ar[br]=yt(Qt.image[br],!1,!0,ct):Ar[br]=Er?Qt.image[br].image:Qt.image[br],Ar[br]=Wr(Qt,Ar[br]);const qt=Ar[0],pr=xt(qt)||lt,mr=st.convert(Qt.format,Qt.colorSpace),nr=st.convert(Qt.type),Cr=wt(Qt.internalFormat,mr,nr,Qt.colorSpace),cr=lt&&Qt.isVideoTexture!==!0,Jr=_r.__version===void 0||kr===!0;let lr=Tt(Qt,qt,pr);rr(tt.TEXTURE_CUBE_MAP,Qt,pr);let Rr;if(Hr){cr&&Jr&&rt.texStorage2D(tt.TEXTURE_CUBE_MAP,lr,Cr,qt.width,qt.height);for(let br=0;br<6;br++){Rr=Ar[br].mipmaps;for(let jr=0;jr<Rr.length;jr++){const Yr=Rr[jr];Qt.format!==RGBAFormat?mr!==null?cr?rt.compressedTexSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,jr,0,0,Yr.width,Yr.height,mr,Yr.data):rt.compressedTexImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,jr,Cr,Yr.width,Yr.height,0,Yr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):cr?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,jr,0,0,Yr.width,Yr.height,mr,nr,Yr.data):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,jr,Cr,Yr.width,Yr.height,0,mr,nr,Yr.data)}}}else{Rr=Qt.mipmaps,cr&&Jr&&(Rr.length>0&&lr++,rt.texStorage2D(tt.TEXTURE_CUBE_MAP,lr,Cr,Ar[0].width,Ar[0].height));for(let br=0;br<6;br++)if(Er){cr?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,0,0,0,Ar[br].width,Ar[br].height,mr,nr,Ar[br].data):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,0,Cr,Ar[br].width,Ar[br].height,0,mr,nr,Ar[br].data);for(let jr=0;jr<Rr.length;jr++){const mn=Rr[jr].image[br].image;cr?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,jr+1,0,0,mn.width,mn.height,mr,nr,mn.data):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,jr+1,Cr,mn.width,mn.height,0,mr,nr,mn.data)}}else{cr?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,0,0,0,mr,nr,Ar[br]):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,0,Cr,mr,nr,Ar[br]);for(let jr=0;jr<Rr.length;jr++){const Yr=Rr[jr];cr?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,jr+1,0,0,mr,nr,Yr.image[br]):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+br,jr+1,Cr,mr,nr,Yr.image[br])}}}Et(Qt,pr)&&bt(tt.TEXTURE_CUBE_MAP),_r.__version=yr.version,Qt.onUpdate&&Qt.onUpdate(Qt)}Xt.__version=Qt.version}function gr(Xt,Qt,hr,kr,yr){const _r=st.convert(hr.format,hr.colorSpace),Hr=st.convert(hr.type),Er=wt(hr.internalFormat,_r,Hr,hr.colorSpace);nt.get(Qt).__hasExternalTextures||(yr===tt.TEXTURE_3D||yr===tt.TEXTURE_2D_ARRAY?rt.texImage3D(yr,0,Er,Qt.width,Qt.height,Qt.depth,0,_r,Hr,null):rt.texImage2D(yr,0,Er,Qt.width,Qt.height,0,_r,Hr,null)),rt.bindFramebuffer(tt.FRAMEBUFFER,Xt),Ur(Qt)?dt.framebufferTexture2DMultisampleEXT(tt.FRAMEBUFFER,kr,yr,nt.get(hr).__webglTexture,0,Dr(Qt)):(yr===tt.TEXTURE_2D||yr>=tt.TEXTURE_CUBE_MAP_POSITIVE_X&&yr<=tt.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&tt.framebufferTexture2D(tt.FRAMEBUFFER,kr,yr,nt.get(hr).__webglTexture,0),rt.bindFramebuffer(tt.FRAMEBUFFER,null)}function Yt(Xt,Qt,hr){if(tt.bindRenderbuffer(tt.RENDERBUFFER,Xt),Qt.depthBuffer&&!Qt.stencilBuffer){let kr=tt.DEPTH_COMPONENT16;if(hr||Ur(Qt)){const yr=Qt.depthTexture;yr&&yr.isDepthTexture&&(yr.type===FloatType?kr=tt.DEPTH_COMPONENT32F:yr.type===UnsignedIntType&&(kr=tt.DEPTH_COMPONENT24));const _r=Dr(Qt);Ur(Qt)?dt.renderbufferStorageMultisampleEXT(tt.RENDERBUFFER,_r,kr,Qt.width,Qt.height):tt.renderbufferStorageMultisample(tt.RENDERBUFFER,_r,kr,Qt.width,Qt.height)}else tt.renderbufferStorage(tt.RENDERBUFFER,kr,Qt.width,Qt.height);tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.DEPTH_ATTACHMENT,tt.RENDERBUFFER,Xt)}else if(Qt.depthBuffer&&Qt.stencilBuffer){const kr=Dr(Qt);hr&&Ur(Qt)===!1?tt.renderbufferStorageMultisample(tt.RENDERBUFFER,kr,tt.DEPTH24_STENCIL8,Qt.width,Qt.height):Ur(Qt)?dt.renderbufferStorageMultisampleEXT(tt.RENDERBUFFER,kr,tt.DEPTH24_STENCIL8,Qt.width,Qt.height):tt.renderbufferStorage(tt.RENDERBUFFER,tt.DEPTH_STENCIL,Qt.width,Qt.height),tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.DEPTH_STENCIL_ATTACHMENT,tt.RENDERBUFFER,Xt)}else{const kr=Qt.isWebGLMultipleRenderTargets===!0?Qt.texture:[Qt.texture];for(let yr=0;yr<kr.length;yr++){const _r=kr[yr],Hr=st.convert(_r.format,_r.colorSpace),Er=st.convert(_r.type),Ar=wt(_r.internalFormat,Hr,Er,_r.colorSpace),qt=Dr(Qt);hr&&Ur(Qt)===!1?tt.renderbufferStorageMultisample(tt.RENDERBUFFER,qt,Ar,Qt.width,Qt.height):Ur(Qt)?dt.renderbufferStorageMultisampleEXT(tt.RENDERBUFFER,qt,Ar,Qt.width,Qt.height):tt.renderbufferStorage(tt.RENDERBUFFER,Ar,Qt.width,Qt.height)}}tt.bindRenderbuffer(tt.RENDERBUFFER,null)}function xr(Xt,Qt){if(Qt&&Qt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(rt.bindFramebuffer(tt.FRAMEBUFFER,Xt),!(Qt.depthTexture&&Qt.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!nt.get(Qt.depthTexture).__webglTexture||Qt.depthTexture.image.width!==Qt.width||Qt.depthTexture.image.height!==Qt.height)&&(Qt.depthTexture.image.width=Qt.width,Qt.depthTexture.image.height=Qt.height,Qt.depthTexture.needsUpdate=!0),zt(Qt.depthTexture,0);const kr=nt.get(Qt.depthTexture).__webglTexture,yr=Dr(Qt);if(Qt.depthTexture.format===DepthFormat)Ur(Qt)?dt.framebufferTexture2DMultisampleEXT(tt.FRAMEBUFFER,tt.DEPTH_ATTACHMENT,tt.TEXTURE_2D,kr,0,yr):tt.framebufferTexture2D(tt.FRAMEBUFFER,tt.DEPTH_ATTACHMENT,tt.TEXTURE_2D,kr,0);else if(Qt.depthTexture.format===DepthStencilFormat)Ur(Qt)?dt.framebufferTexture2DMultisampleEXT(tt.FRAMEBUFFER,tt.DEPTH_STENCIL_ATTACHMENT,tt.TEXTURE_2D,kr,0,yr):tt.framebufferTexture2D(tt.FRAMEBUFFER,tt.DEPTH_STENCIL_ATTACHMENT,tt.TEXTURE_2D,kr,0);else throw new Error("Unknown depthTexture format")}function vr(Xt){const Qt=nt.get(Xt),hr=Xt.isWebGLCubeRenderTarget===!0;if(Xt.depthTexture&&!Qt.__autoAllocateDepthBuffer){if(hr)throw new Error("target.depthTexture not supported in Cube render targets");xr(Qt.__webglFramebuffer,Xt)}else if(hr){Qt.__webglDepthbuffer=[];for(let kr=0;kr<6;kr++)rt.bindFramebuffer(tt.FRAMEBUFFER,Qt.__webglFramebuffer[kr]),Qt.__webglDepthbuffer[kr]=tt.createRenderbuffer(),Yt(Qt.__webglDepthbuffer[kr],Xt,!1)}else rt.bindFramebuffer(tt.FRAMEBUFFER,Qt.__webglFramebuffer),Qt.__webglDepthbuffer=tt.createRenderbuffer(),Yt(Qt.__webglDepthbuffer,Xt,!1);rt.bindFramebuffer(tt.FRAMEBUFFER,null)}function Pr(Xt,Qt,hr){const kr=nt.get(Xt);Qt!==void 0&&gr(kr.__webglFramebuffer,Xt,Xt.texture,tt.COLOR_ATTACHMENT0,tt.TEXTURE_2D),hr!==void 0&&vr(Xt)}function Sr(Xt){const Qt=Xt.texture,hr=nt.get(Xt),kr=nt.get(Qt);Xt.addEventListener("dispose",It),Xt.isWebGLMultipleRenderTargets!==!0&&(kr.__webglTexture===void 0&&(kr.__webglTexture=tt.createTexture()),kr.__version=Qt.version,ot.memory.textures++);const yr=Xt.isWebGLCubeRenderTarget===!0,_r=Xt.isWebGLMultipleRenderTargets===!0,Hr=xt(Xt)||lt;if(yr){hr.__webglFramebuffer=[];for(let Er=0;Er<6;Er++)hr.__webglFramebuffer[Er]=tt.createFramebuffer()}else{if(hr.__webglFramebuffer=tt.createFramebuffer(),_r)if(it.drawBuffers){const Er=Xt.texture;for(let Ar=0,qt=Er.length;Ar<qt;Ar++){const pr=nt.get(Er[Ar]);pr.__webglTexture===void 0&&(pr.__webglTexture=tt.createTexture(),ot.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(lt&&Xt.samples>0&&Ur(Xt)===!1){const Er=_r?Qt:[Qt];hr.__webglMultisampledFramebuffer=tt.createFramebuffer(),hr.__webglColorRenderbuffer=[],rt.bindFramebuffer(tt.FRAMEBUFFER,hr.__webglMultisampledFramebuffer);for(let Ar=0;Ar<Er.length;Ar++){const qt=Er[Ar];hr.__webglColorRenderbuffer[Ar]=tt.createRenderbuffer(),tt.bindRenderbuffer(tt.RENDERBUFFER,hr.__webglColorRenderbuffer[Ar]);const pr=st.convert(qt.format,qt.colorSpace),mr=st.convert(qt.type),nr=wt(qt.internalFormat,pr,mr,qt.colorSpace,Xt.isXRRenderTarget===!0),Cr=Dr(Xt);tt.renderbufferStorageMultisample(tt.RENDERBUFFER,Cr,nr,Xt.width,Xt.height),tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0+Ar,tt.RENDERBUFFER,hr.__webglColorRenderbuffer[Ar])}tt.bindRenderbuffer(tt.RENDERBUFFER,null),Xt.depthBuffer&&(hr.__webglDepthRenderbuffer=tt.createRenderbuffer(),Yt(hr.__webglDepthRenderbuffer,Xt,!0)),rt.bindFramebuffer(tt.FRAMEBUFFER,null)}}if(yr){rt.bindTexture(tt.TEXTURE_CUBE_MAP,kr.__webglTexture),rr(tt.TEXTURE_CUBE_MAP,Qt,Hr);for(let Er=0;Er<6;Er++)gr(hr.__webglFramebuffer[Er],Xt,Qt,tt.COLOR_ATTACHMENT0,tt.TEXTURE_CUBE_MAP_POSITIVE_X+Er);Et(Qt,Hr)&&bt(tt.TEXTURE_CUBE_MAP),rt.unbindTexture()}else if(_r){const Er=Xt.texture;for(let Ar=0,qt=Er.length;Ar<qt;Ar++){const pr=Er[Ar],mr=nt.get(pr);rt.bindTexture(tt.TEXTURE_2D,mr.__webglTexture),rr(tt.TEXTURE_2D,pr,Hr),gr(hr.__webglFramebuffer,Xt,pr,tt.COLOR_ATTACHMENT0+Ar,tt.TEXTURE_2D),Et(pr,Hr)&&bt(tt.TEXTURE_2D)}rt.unbindTexture()}else{let Er=tt.TEXTURE_2D;(Xt.isWebGL3DRenderTarget||Xt.isWebGLArrayRenderTarget)&&(lt?Er=Xt.isWebGL3DRenderTarget?tt.TEXTURE_3D:tt.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),rt.bindTexture(Er,kr.__webglTexture),rr(Er,Qt,Hr),gr(hr.__webglFramebuffer,Xt,Qt,tt.COLOR_ATTACHMENT0,Er),Et(Qt,Hr)&&bt(Er),rt.unbindTexture()}Xt.depthBuffer&&vr(Xt)}function Qr(Xt){const Qt=xt(Xt)||lt,hr=Xt.isWebGLMultipleRenderTargets===!0?Xt.texture:[Xt.texture];for(let kr=0,yr=hr.length;kr<yr;kr++){const _r=hr[kr];if(Et(_r,Qt)){const Hr=Xt.isWebGLCubeRenderTarget?tt.TEXTURE_CUBE_MAP:tt.TEXTURE_2D,Er=nt.get(_r).__webglTexture;rt.bindTexture(Hr,Er),bt(Hr),rt.unbindTexture()}}}function Ir(Xt){if(lt&&Xt.samples>0&&Ur(Xt)===!1){const Qt=Xt.isWebGLMultipleRenderTargets?Xt.texture:[Xt.texture],hr=Xt.width,kr=Xt.height;let yr=tt.COLOR_BUFFER_BIT;const _r=[],Hr=Xt.stencilBuffer?tt.DEPTH_STENCIL_ATTACHMENT:tt.DEPTH_ATTACHMENT,Er=nt.get(Xt),Ar=Xt.isWebGLMultipleRenderTargets===!0;if(Ar)for(let qt=0;qt<Qt.length;qt++)rt.bindFramebuffer(tt.FRAMEBUFFER,Er.__webglMultisampledFramebuffer),tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0+qt,tt.RENDERBUFFER,null),rt.bindFramebuffer(tt.FRAMEBUFFER,Er.__webglFramebuffer),tt.framebufferTexture2D(tt.DRAW_FRAMEBUFFER,tt.COLOR_ATTACHMENT0+qt,tt.TEXTURE_2D,null,0);rt.bindFramebuffer(tt.READ_FRAMEBUFFER,Er.__webglMultisampledFramebuffer),rt.bindFramebuffer(tt.DRAW_FRAMEBUFFER,Er.__webglFramebuffer);for(let qt=0;qt<Qt.length;qt++){_r.push(tt.COLOR_ATTACHMENT0+qt),Xt.depthBuffer&&_r.push(Hr);const pr=Er.__ignoreDepthValues!==void 0?Er.__ignoreDepthValues:!1;if(pr===!1&&(Xt.depthBuffer&&(yr|=tt.DEPTH_BUFFER_BIT),Xt.stencilBuffer&&(yr|=tt.STENCIL_BUFFER_BIT)),Ar&&tt.framebufferRenderbuffer(tt.READ_FRAMEBUFFER,tt.COLOR_ATTACHMENT0,tt.RENDERBUFFER,Er.__webglColorRenderbuffer[qt]),pr===!0&&(tt.invalidateFramebuffer(tt.READ_FRAMEBUFFER,[Hr]),tt.invalidateFramebuffer(tt.DRAW_FRAMEBUFFER,[Hr])),Ar){const mr=nt.get(Qt[qt]).__webglTexture;tt.framebufferTexture2D(tt.DRAW_FRAMEBUFFER,tt.COLOR_ATTACHMENT0,tt.TEXTURE_2D,mr,0)}tt.blitFramebuffer(0,0,hr,kr,0,0,hr,kr,yr,tt.NEAREST),ft&&tt.invalidateFramebuffer(tt.READ_FRAMEBUFFER,_r)}if(rt.bindFramebuffer(tt.READ_FRAMEBUFFER,null),rt.bindFramebuffer(tt.DRAW_FRAMEBUFFER,null),Ar)for(let qt=0;qt<Qt.length;qt++){rt.bindFramebuffer(tt.FRAMEBUFFER,Er.__webglMultisampledFramebuffer),tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0+qt,tt.RENDERBUFFER,Er.__webglColorRenderbuffer[qt]);const pr=nt.get(Qt[qt]).__webglTexture;rt.bindFramebuffer(tt.FRAMEBUFFER,Er.__webglFramebuffer),tt.framebufferTexture2D(tt.DRAW_FRAMEBUFFER,tt.COLOR_ATTACHMENT0+qt,tt.TEXTURE_2D,pr,0)}rt.bindFramebuffer(tt.DRAW_FRAMEBUFFER,Er.__webglMultisampledFramebuffer)}}function Dr(Xt){return Math.min(ht,Xt.samples)}function Ur(Xt){const Qt=nt.get(Xt);return lt&&Xt.samples>0&&_e.has("WEBGL_multisampled_render_to_texture")===!0&&Qt.__useRenderToTexture!==!1}function Lr(Xt){const Qt=ot.render.frame;pt.get(Xt)!==Qt&&(pt.set(Xt,Qt),Xt.update())}function Wr(Xt,Qt){const hr=Xt.colorSpace,kr=Xt.format,yr=Xt.type;return Xt.isCompressedTexture===!0||Xt.format===_SRGBAFormat||hr!==LinearSRGBColorSpace&&hr!==NoColorSpace&&(hr===SRGBColorSpace?lt===!1?_e.has("EXT_sRGB")===!0&&kr===RGBAFormat?(Xt.format=_SRGBAFormat,Xt.minFilter=LinearFilter,Xt.generateMipmaps=!1):Qt=ImageUtils.sRGBToLinear(Qt):(kr!==RGBAFormat||yr!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",hr)),Qt}this.allocateTextureUnit=Dt,this.resetTextureUnits=jt,this.setTexture2D=zt,this.setTexture2DArray=$t,this.setTexture3D=Ht,this.setTextureCube=er,this.rebindTextures=Pr,this.setupRenderTarget=Sr,this.updateRenderTargetMipmap=Qr,this.updateMultisampleRenderTarget=Ir,this.setupDepthRenderbuffer=vr,this.setupFrameBufferTexture=gr,this.useMultisampledRTT=Ur}function WebGLUtils(tt,_e,rt){const nt=rt.isWebGL2;function it(st,ot=NoColorSpace){let lt;if(st===UnsignedByteType)return tt.UNSIGNED_BYTE;if(st===UnsignedShort4444Type)return tt.UNSIGNED_SHORT_4_4_4_4;if(st===UnsignedShort5551Type)return tt.UNSIGNED_SHORT_5_5_5_1;if(st===ByteType)return tt.BYTE;if(st===ShortType)return tt.SHORT;if(st===UnsignedShortType)return tt.UNSIGNED_SHORT;if(st===IntType)return tt.INT;if(st===UnsignedIntType)return tt.UNSIGNED_INT;if(st===FloatType)return tt.FLOAT;if(st===HalfFloatType)return nt?tt.HALF_FLOAT:(lt=_e.get("OES_texture_half_float"),lt!==null?lt.HALF_FLOAT_OES:null);if(st===AlphaFormat)return tt.ALPHA;if(st===RGBAFormat)return tt.RGBA;if(st===LuminanceFormat)return tt.LUMINANCE;if(st===LuminanceAlphaFormat)return tt.LUMINANCE_ALPHA;if(st===DepthFormat)return tt.DEPTH_COMPONENT;if(st===DepthStencilFormat)return tt.DEPTH_STENCIL;if(st===_SRGBAFormat)return lt=_e.get("EXT_sRGB"),lt!==null?lt.SRGB_ALPHA_EXT:null;if(st===RedFormat)return tt.RED;if(st===RedIntegerFormat)return tt.RED_INTEGER;if(st===RGFormat)return tt.RG;if(st===RGIntegerFormat)return tt.RG_INTEGER;if(st===RGBAIntegerFormat)return tt.RGBA_INTEGER;if(st===RGB_S3TC_DXT1_Format||st===RGBA_S3TC_DXT1_Format||st===RGBA_S3TC_DXT3_Format||st===RGBA_S3TC_DXT5_Format)if(ot===SRGBColorSpace)if(lt=_e.get("WEBGL_compressed_texture_s3tc_srgb"),lt!==null){if(st===RGB_S3TC_DXT1_Format)return lt.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(st===RGBA_S3TC_DXT1_Format)return lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(st===RGBA_S3TC_DXT3_Format)return lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(st===RGBA_S3TC_DXT5_Format)return lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(lt=_e.get("WEBGL_compressed_texture_s3tc"),lt!==null){if(st===RGB_S3TC_DXT1_Format)return lt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(st===RGBA_S3TC_DXT1_Format)return lt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(st===RGBA_S3TC_DXT3_Format)return lt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(st===RGBA_S3TC_DXT5_Format)return lt.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(st===RGB_PVRTC_4BPPV1_Format||st===RGB_PVRTC_2BPPV1_Format||st===RGBA_PVRTC_4BPPV1_Format||st===RGBA_PVRTC_2BPPV1_Format)if(lt=_e.get("WEBGL_compressed_texture_pvrtc"),lt!==null){if(st===RGB_PVRTC_4BPPV1_Format)return lt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(st===RGB_PVRTC_2BPPV1_Format)return lt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(st===RGBA_PVRTC_4BPPV1_Format)return lt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(st===RGBA_PVRTC_2BPPV1_Format)return lt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(st===RGB_ETC1_Format)return lt=_e.get("WEBGL_compressed_texture_etc1"),lt!==null?lt.COMPRESSED_RGB_ETC1_WEBGL:null;if(st===RGB_ETC2_Format||st===RGBA_ETC2_EAC_Format)if(lt=_e.get("WEBGL_compressed_texture_etc"),lt!==null){if(st===RGB_ETC2_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ETC2:lt.COMPRESSED_RGB8_ETC2;if(st===RGBA_ETC2_EAC_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:lt.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(st===RGBA_ASTC_4x4_Format||st===RGBA_ASTC_5x4_Format||st===RGBA_ASTC_5x5_Format||st===RGBA_ASTC_6x5_Format||st===RGBA_ASTC_6x6_Format||st===RGBA_ASTC_8x5_Format||st===RGBA_ASTC_8x6_Format||st===RGBA_ASTC_8x8_Format||st===RGBA_ASTC_10x5_Format||st===RGBA_ASTC_10x6_Format||st===RGBA_ASTC_10x8_Format||st===RGBA_ASTC_10x10_Format||st===RGBA_ASTC_12x10_Format||st===RGBA_ASTC_12x12_Format)if(lt=_e.get("WEBGL_compressed_texture_astc"),lt!==null){if(st===RGBA_ASTC_4x4_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:lt.COMPRESSED_RGBA_ASTC_4x4_KHR;if(st===RGBA_ASTC_5x4_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:lt.COMPRESSED_RGBA_ASTC_5x4_KHR;if(st===RGBA_ASTC_5x5_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:lt.COMPRESSED_RGBA_ASTC_5x5_KHR;if(st===RGBA_ASTC_6x5_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:lt.COMPRESSED_RGBA_ASTC_6x5_KHR;if(st===RGBA_ASTC_6x6_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:lt.COMPRESSED_RGBA_ASTC_6x6_KHR;if(st===RGBA_ASTC_8x5_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:lt.COMPRESSED_RGBA_ASTC_8x5_KHR;if(st===RGBA_ASTC_8x6_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:lt.COMPRESSED_RGBA_ASTC_8x6_KHR;if(st===RGBA_ASTC_8x8_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:lt.COMPRESSED_RGBA_ASTC_8x8_KHR;if(st===RGBA_ASTC_10x5_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:lt.COMPRESSED_RGBA_ASTC_10x5_KHR;if(st===RGBA_ASTC_10x6_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:lt.COMPRESSED_RGBA_ASTC_10x6_KHR;if(st===RGBA_ASTC_10x8_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:lt.COMPRESSED_RGBA_ASTC_10x8_KHR;if(st===RGBA_ASTC_10x10_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:lt.COMPRESSED_RGBA_ASTC_10x10_KHR;if(st===RGBA_ASTC_12x10_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:lt.COMPRESSED_RGBA_ASTC_12x10_KHR;if(st===RGBA_ASTC_12x12_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:lt.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(st===RGBA_BPTC_Format)if(lt=_e.get("EXT_texture_compression_bptc"),lt!==null){if(st===RGBA_BPTC_Format)return ot===SRGBColorSpace?lt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:lt.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(st===RED_RGTC1_Format||st===SIGNED_RED_RGTC1_Format||st===RED_GREEN_RGTC2_Format||st===SIGNED_RED_GREEN_RGTC2_Format)if(lt=_e.get("EXT_texture_compression_rgtc"),lt!==null){if(st===RGBA_BPTC_Format)return lt.COMPRESSED_RED_RGTC1_EXT;if(st===SIGNED_RED_RGTC1_Format)return lt.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(st===RED_GREEN_RGTC2_Format)return lt.COMPRESSED_RED_GREEN_RGTC2_EXT;if(st===SIGNED_RED_GREEN_RGTC2_Format)return lt.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return st===UnsignedInt248Type?nt?tt.UNSIGNED_INT_24_8:(lt=_e.get("WEBGL_depth_texture"),lt!==null?lt.UNSIGNED_INT_24_8_WEBGL:null):tt[st]!==void 0?tt[st]:null}return{convert:it}}class ArrayCamera extends PerspectiveCamera{constructor(_e=[]){super(),this.isArrayCamera=!0,this.cameras=_e}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(_e){return this._targetRay!==null&&this._targetRay.dispatchEvent(_e),this._grip!==null&&this._grip.dispatchEvent(_e),this._hand!==null&&this._hand.dispatchEvent(_e),this}connect(_e){if(_e&&_e.hand){const rt=this._hand;if(rt)for(const nt of _e.hand.values())this._getHandJoint(rt,nt)}return this.dispatchEvent({type:"connected",data:_e}),this}disconnect(_e){return this.dispatchEvent({type:"disconnected",data:_e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_e,rt,nt){let it=null,st=null,ot=null;const lt=this._targetRay,at=this._grip,ct=this._hand;if(_e&&rt.session.visibilityState!=="visible-blurred"){if(ct&&_e.hand){ot=!0;for(const mt of _e.hand.values()){const gt=rt.getJointPose(mt,nt),vt=this._getHandJoint(ct,mt);gt!==null&&(vt.matrix.fromArray(gt.transform.matrix),vt.matrix.decompose(vt.position,vt.rotation,vt.scale),vt.matrixWorldNeedsUpdate=!0,vt.jointRadius=gt.radius),vt.visible=gt!==null}const ut=ct.joints["index-finger-tip"],ht=ct.joints["thumb-tip"],dt=ut.position.distanceTo(ht.position),ft=.02,pt=.005;ct.inputState.pinching&&dt>ft+pt?(ct.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_e.handedness,target:this})):!ct.inputState.pinching&&dt<=ft-pt&&(ct.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_e.handedness,target:this}))}else at!==null&&_e.gripSpace&&(st=rt.getPose(_e.gripSpace,nt),st!==null&&(at.matrix.fromArray(st.transform.matrix),at.matrix.decompose(at.position,at.rotation,at.scale),at.matrixWorldNeedsUpdate=!0,st.linearVelocity?(at.hasLinearVelocity=!0,at.linearVelocity.copy(st.linearVelocity)):at.hasLinearVelocity=!1,st.angularVelocity?(at.hasAngularVelocity=!0,at.angularVelocity.copy(st.angularVelocity)):at.hasAngularVelocity=!1));lt!==null&&(it=rt.getPose(_e.targetRaySpace,nt),it===null&&st!==null&&(it=st),it!==null&&(lt.matrix.fromArray(it.transform.matrix),lt.matrix.decompose(lt.position,lt.rotation,lt.scale),lt.matrixWorldNeedsUpdate=!0,it.linearVelocity?(lt.hasLinearVelocity=!0,lt.linearVelocity.copy(it.linearVelocity)):lt.hasLinearVelocity=!1,it.angularVelocity?(lt.hasAngularVelocity=!0,lt.angularVelocity.copy(it.angularVelocity)):lt.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return lt!==null&&(lt.visible=it!==null),at!==null&&(at.visible=st!==null),ct!==null&&(ct.visible=ot!==null),this}_getHandJoint(_e,rt){if(_e.joints[rt.jointName]===void 0){const nt=new Group;nt.matrixAutoUpdate=!1,nt.visible=!1,_e.joints[rt.jointName]=nt,_e.add(nt)}return _e.joints[rt.jointName]}}class DepthTexture extends Texture{constructor(_e,rt,nt,it,st,ot,lt,at,ct,ut){if(ut=ut!==void 0?ut:DepthFormat,ut!==DepthFormat&&ut!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");nt===void 0&&ut===DepthFormat&&(nt=UnsignedIntType),nt===void 0&&ut===DepthStencilFormat&&(nt=UnsignedInt248Type),super(null,it,st,ot,lt,at,ut,nt,ct),this.isDepthTexture=!0,this.image={width:_e,height:rt},this.magFilter=lt!==void 0?lt:NearestFilter,this.minFilter=at!==void 0?at:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_e){return super.copy(_e),this.compareFunction=_e.compareFunction,this}toJSON(_e){const rt=super.toJSON(_e);return this.compareFunction!==null&&(rt.compareFunction=this.compareFunction),rt}}class WebXRManager extends EventDispatcher{constructor(_e,rt){super();const nt=this;let it=null,st=1,ot=null,lt="local-floor",at=1,ct=null,ut=null,ht=null,dt=null,ft=null,pt=null;const mt=rt.getContextAttributes();let gt=null,vt=null;const At=[],yt=[],xt=new PerspectiveCamera;xt.layers.enable(1),xt.viewport=new Vector4;const _t=new PerspectiveCamera;_t.layers.enable(2),_t.viewport=new Vector4;const Et=[xt,_t],bt=new ArrayCamera;bt.layers.enable(1),bt.layers.enable(2);let wt=null,Tt=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function($t){let Ht=At[$t];return Ht===void 0&&(Ht=new WebXRController,At[$t]=Ht),Ht.getTargetRaySpace()},this.getControllerGrip=function($t){let Ht=At[$t];return Ht===void 0&&(Ht=new WebXRController,At[$t]=Ht),Ht.getGripSpace()},this.getHand=function($t){let Ht=At[$t];return Ht===void 0&&(Ht=new WebXRController,At[$t]=Ht),Ht.getHandSpace()};function Mt($t){const Ht=yt.indexOf($t.inputSource);if(Ht===-1)return;const er=At[Ht];er!==void 0&&(er.update($t.inputSource,$t.frame,ct||ot),er.dispatchEvent({type:$t.type,data:$t.inputSource}))}function Pt(){it.removeEventListener("select",Mt),it.removeEventListener("selectstart",Mt),it.removeEventListener("selectend",Mt),it.removeEventListener("squeeze",Mt),it.removeEventListener("squeezestart",Mt),it.removeEventListener("squeezeend",Mt),it.removeEventListener("end",Pt),it.removeEventListener("inputsourceschange",It);for(let $t=0;$t<At.length;$t++){const Ht=yt[$t];Ht!==null&&(yt[$t]=null,At[$t].disconnect(Ht))}wt=null,Tt=null,_e.setRenderTarget(gt),ft=null,dt=null,ht=null,it=null,vt=null,zt.stop(),nt.isPresenting=!1,nt.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function($t){st=$t,nt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function($t){lt=$t,nt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return ct||ot},this.setReferenceSpace=function($t){ct=$t},this.getBaseLayer=function(){return dt!==null?dt:ft},this.getBinding=function(){return ht},this.getFrame=function(){return pt},this.getSession=function(){return it},this.setSession=async function($t){if(it=$t,it!==null){if(gt=_e.getRenderTarget(),it.addEventListener("select",Mt),it.addEventListener("selectstart",Mt),it.addEventListener("selectend",Mt),it.addEventListener("squeeze",Mt),it.addEventListener("squeezestart",Mt),it.addEventListener("squeezeend",Mt),it.addEventListener("end",Pt),it.addEventListener("inputsourceschange",It),mt.xrCompatible!==!0&&await rt.makeXRCompatible(),it.renderState.layers===void 0||_e.capabilities.isWebGL2===!1){const Ht={antialias:it.renderState.layers===void 0?mt.antialias:!0,alpha:!0,depth:mt.depth,stencil:mt.stencil,framebufferScaleFactor:st};ft=new XRWebGLLayer(it,rt,Ht),it.updateRenderState({baseLayer:ft}),vt=new WebGLRenderTarget(ft.framebufferWidth,ft.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:_e.outputColorSpace,stencilBuffer:mt.stencil})}else{let Ht=null,er=null,Zt=null;mt.depth&&(Zt=mt.stencil?rt.DEPTH24_STENCIL8:rt.DEPTH_COMPONENT24,Ht=mt.stencil?DepthStencilFormat:DepthFormat,er=mt.stencil?UnsignedInt248Type:UnsignedIntType);const or={colorFormat:rt.RGBA8,depthFormat:Zt,scaleFactor:st};ht=new XRWebGLBinding(it,rt),dt=ht.createProjectionLayer(or),it.updateRenderState({layers:[dt]}),vt=new WebGLRenderTarget(dt.textureWidth,dt.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(dt.textureWidth,dt.textureHeight,er,void 0,void 0,void 0,void 0,void 0,void 0,Ht),stencilBuffer:mt.stencil,colorSpace:_e.outputColorSpace,samples:mt.antialias?4:0});const Kt=_e.properties.get(vt);Kt.__ignoreDepthValues=dt.ignoreDepthValues}vt.isXRRenderTarget=!0,this.setFoveation(at),ct=null,ot=await it.requestReferenceSpace(lt),zt.setContext(it),zt.start(),nt.isPresenting=!0,nt.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(it!==null)return it.environmentBlendMode};function It($t){for(let Ht=0;Ht<$t.removed.length;Ht++){const er=$t.removed[Ht],Zt=yt.indexOf(er);Zt>=0&&(yt[Zt]=null,At[Zt].disconnect(er))}for(let Ht=0;Ht<$t.added.length;Ht++){const er=$t.added[Ht];let Zt=yt.indexOf(er);if(Zt===-1){for(let Kt=0;Kt<At.length;Kt++)if(Kt>=yt.length){yt.push(er),Zt=Kt;break}else if(yt[Kt]===null){yt[Kt]=er,Zt=Kt;break}if(Zt===-1)break}const or=At[Zt];or&&or.connect(er)}}const Ot=new Vector3,Bt=new Vector3;function Ut($t,Ht,er){Ot.setFromMatrixPosition(Ht.matrixWorld),Bt.setFromMatrixPosition(er.matrixWorld);const Zt=Ot.distanceTo(Bt),or=Ht.projectionMatrix.elements,Kt=er.projectionMatrix.elements,rr=or[14]/(or[10]-1),ur=or[14]/(or[10]+1),fr=(or[9]+1)/or[5],dr=(or[9]-1)/or[5],gr=(or[8]-1)/or[0],Yt=(Kt[8]+1)/Kt[0],xr=rr*gr,vr=rr*Yt,Pr=Zt/(-gr+Yt),Sr=Pr*-gr;Ht.matrixWorld.decompose($t.position,$t.quaternion,$t.scale),$t.translateX(Sr),$t.translateZ(Pr),$t.matrixWorld.compose($t.position,$t.quaternion,$t.scale),$t.matrixWorldInverse.copy($t.matrixWorld).invert();const Qr=rr+Pr,Ir=ur+Pr,Dr=xr-Sr,Ur=vr+(Zt-Sr),Lr=fr*ur/Ir*Qr,Wr=dr*ur/Ir*Qr;$t.projectionMatrix.makePerspective(Dr,Ur,Lr,Wr,Qr,Ir),$t.projectionMatrixInverse.copy($t.projectionMatrix).invert()}function Ft($t,Ht){Ht===null?$t.matrixWorld.copy($t.matrix):$t.matrixWorld.multiplyMatrices(Ht.matrixWorld,$t.matrix),$t.matrixWorldInverse.copy($t.matrixWorld).invert()}this.updateCamera=function($t){if(it===null)return;bt.near=_t.near=xt.near=$t.near,bt.far=_t.far=xt.far=$t.far,(wt!==bt.near||Tt!==bt.far)&&(it.updateRenderState({depthNear:bt.near,depthFar:bt.far}),wt=bt.near,Tt=bt.far);const Ht=$t.parent,er=bt.cameras;Ft(bt,Ht);for(let Zt=0;Zt<er.length;Zt++)Ft(er[Zt],Ht);er.length===2?Ut(bt,xt,_t):bt.projectionMatrix.copy(xt.projectionMatrix),jt($t,bt,Ht)};function jt($t,Ht,er){er===null?$t.matrix.copy(Ht.matrixWorld):($t.matrix.copy(er.matrixWorld),$t.matrix.invert(),$t.matrix.multiply(Ht.matrixWorld)),$t.matrix.decompose($t.position,$t.quaternion,$t.scale),$t.updateMatrixWorld(!0);const Zt=$t.children;for(let or=0,Kt=Zt.length;or<Kt;or++)Zt[or].updateMatrixWorld(!0);$t.projectionMatrix.copy(Ht.projectionMatrix),$t.projectionMatrixInverse.copy(Ht.projectionMatrixInverse),$t.isPerspectiveCamera&&($t.fov=RAD2DEG*2*Math.atan(1/$t.projectionMatrix.elements[5]),$t.zoom=1)}this.getCamera=function(){return bt},this.getFoveation=function(){if(!(dt===null&&ft===null))return at},this.setFoveation=function($t){at=$t,dt!==null&&(dt.fixedFoveation=$t),ft!==null&&ft.fixedFoveation!==void 0&&(ft.fixedFoveation=$t)};let Dt=null;function Gt($t,Ht){if(ut=Ht.getViewerPose(ct||ot),pt=Ht,ut!==null){const er=ut.views;ft!==null&&(_e.setRenderTargetFramebuffer(vt,ft.framebuffer),_e.setRenderTarget(vt));let Zt=!1;er.length!==bt.cameras.length&&(bt.cameras.length=0,Zt=!0);for(let or=0;or<er.length;or++){const Kt=er[or];let rr=null;if(ft!==null)rr=ft.getViewport(Kt);else{const fr=ht.getViewSubImage(dt,Kt);rr=fr.viewport,or===0&&(_e.setRenderTargetTextures(vt,fr.colorTexture,dt.ignoreDepthValues?void 0:fr.depthStencilTexture),_e.setRenderTarget(vt))}let ur=Et[or];ur===void 0&&(ur=new PerspectiveCamera,ur.layers.enable(or),ur.viewport=new Vector4,Et[or]=ur),ur.matrix.fromArray(Kt.transform.matrix),ur.matrix.decompose(ur.position,ur.quaternion,ur.scale),ur.projectionMatrix.fromArray(Kt.projectionMatrix),ur.projectionMatrixInverse.copy(ur.projectionMatrix).invert(),ur.viewport.set(rr.x,rr.y,rr.width,rr.height),or===0&&(bt.matrix.copy(ur.matrix),bt.matrix.decompose(bt.position,bt.quaternion,bt.scale)),Zt===!0&&bt.cameras.push(ur)}}for(let er=0;er<At.length;er++){const Zt=yt[er],or=At[er];Zt!==null&&or!==void 0&&or.update(Zt,Ht,ct||ot)}Dt&&Dt($t,Ht),Ht.detectedPlanes&&nt.dispatchEvent({type:"planesdetected",data:Ht}),pt=null}const zt=new WebGLAnimation;zt.setAnimationLoop(Gt),this.setAnimationLoop=function($t){Dt=$t},this.dispose=function(){}}}function WebGLMaterials(tt,_e){function rt(gt,vt){gt.matrixAutoUpdate===!0&&gt.updateMatrix(),vt.value.copy(gt.matrix)}function nt(gt,vt){vt.color.getRGB(gt.fogColor.value,getUnlitUniformColorSpace(tt)),vt.isFog?(gt.fogNear.value=vt.near,gt.fogFar.value=vt.far):vt.isFogExp2&&(gt.fogDensity.value=vt.density)}function it(gt,vt,At,yt,xt){vt.isMeshBasicMaterial||vt.isMeshLambertMaterial?st(gt,vt):vt.isMeshToonMaterial?(st(gt,vt),ht(gt,vt)):vt.isMeshPhongMaterial?(st(gt,vt),ut(gt,vt)):vt.isMeshStandardMaterial?(st(gt,vt),dt(gt,vt),vt.isMeshPhysicalMaterial&&ft(gt,vt,xt)):vt.isMeshMatcapMaterial?(st(gt,vt),pt(gt,vt)):vt.isMeshDepthMaterial?st(gt,vt):vt.isMeshDistanceMaterial?(st(gt,vt),mt(gt,vt)):vt.isMeshNormalMaterial?st(gt,vt):vt.isLineBasicMaterial?(ot(gt,vt),vt.isLineDashedMaterial&&lt(gt,vt)):vt.isPointsMaterial?at(gt,vt,At,yt):vt.isSpriteMaterial?ct(gt,vt):vt.isShadowMaterial?(gt.color.value.copy(vt.color),gt.opacity.value=vt.opacity):vt.isShaderMaterial&&(vt.uniformsNeedUpdate=!1)}function st(gt,vt){gt.opacity.value=vt.opacity,vt.color&&gt.diffuse.value.copy(vt.color),vt.emissive&&gt.emissive.value.copy(vt.emissive).multiplyScalar(vt.emissiveIntensity),vt.map&&(gt.map.value=vt.map,rt(vt.map,gt.mapTransform)),vt.alphaMap&&(gt.alphaMap.value=vt.alphaMap,rt(vt.alphaMap,gt.alphaMapTransform)),vt.bumpMap&&(gt.bumpMap.value=vt.bumpMap,rt(vt.bumpMap,gt.bumpMapTransform),gt.bumpScale.value=vt.bumpScale,vt.side===BackSide&&(gt.bumpScale.value*=-1)),vt.normalMap&&(gt.normalMap.value=vt.normalMap,rt(vt.normalMap,gt.normalMapTransform),gt.normalScale.value.copy(vt.normalScale),vt.side===BackSide&&gt.normalScale.value.negate()),vt.displacementMap&&(gt.displacementMap.value=vt.displacementMap,rt(vt.displacementMap,gt.displacementMapTransform),gt.displacementScale.value=vt.displacementScale,gt.displacementBias.value=vt.displacementBias),vt.emissiveMap&&(gt.emissiveMap.value=vt.emissiveMap,rt(vt.emissiveMap,gt.emissiveMapTransform)),vt.specularMap&&(gt.specularMap.value=vt.specularMap,rt(vt.specularMap,gt.specularMapTransform)),vt.alphaTest>0&&(gt.alphaTest.value=vt.alphaTest);const At=_e.get(vt).envMap;if(At&&(gt.envMap.value=At,gt.flipEnvMap.value=At.isCubeTexture&&At.isRenderTargetTexture===!1?-1:1,gt.reflectivity.value=vt.reflectivity,gt.ior.value=vt.ior,gt.refractionRatio.value=vt.refractionRatio),vt.lightMap){gt.lightMap.value=vt.lightMap;const yt=tt.useLegacyLights===!0?Math.PI:1;gt.lightMapIntensity.value=vt.lightMapIntensity*yt,rt(vt.lightMap,gt.lightMapTransform)}vt.aoMap&&(gt.aoMap.value=vt.aoMap,gt.aoMapIntensity.value=vt.aoMapIntensity,rt(vt.aoMap,gt.aoMapTransform))}function ot(gt,vt){gt.diffuse.value.copy(vt.color),gt.opacity.value=vt.opacity,vt.map&&(gt.map.value=vt.map,rt(vt.map,gt.mapTransform))}function lt(gt,vt){gt.dashSize.value=vt.dashSize,gt.totalSize.value=vt.dashSize+vt.gapSize,gt.scale.value=vt.scale}function at(gt,vt,At,yt){gt.diffuse.value.copy(vt.color),gt.opacity.value=vt.opacity,gt.size.value=vt.size*At,gt.scale.value=yt*.5,vt.map&&(gt.map.value=vt.map,rt(vt.map,gt.uvTransform)),vt.alphaMap&&(gt.alphaMap.value=vt.alphaMap,rt(vt.alphaMap,gt.alphaMapTransform)),vt.alphaTest>0&&(gt.alphaTest.value=vt.alphaTest)}function ct(gt,vt){gt.diffuse.value.copy(vt.color),gt.opacity.value=vt.opacity,gt.rotation.value=vt.rotation,vt.map&&(gt.map.value=vt.map,rt(vt.map,gt.mapTransform)),vt.alphaMap&&(gt.alphaMap.value=vt.alphaMap,rt(vt.alphaMap,gt.alphaMapTransform)),vt.alphaTest>0&&(gt.alphaTest.value=vt.alphaTest)}function ut(gt,vt){gt.specular.value.copy(vt.specular),gt.shininess.value=Math.max(vt.shininess,1e-4)}function ht(gt,vt){vt.gradientMap&&(gt.gradientMap.value=vt.gradientMap)}function dt(gt,vt){gt.metalness.value=vt.metalness,vt.metalnessMap&&(gt.metalnessMap.value=vt.metalnessMap,rt(vt.metalnessMap,gt.metalnessMapTransform)),gt.roughness.value=vt.roughness,vt.roughnessMap&&(gt.roughnessMap.value=vt.roughnessMap,rt(vt.roughnessMap,gt.roughnessMapTransform)),_e.get(vt).envMap&&(gt.envMapIntensity.value=vt.envMapIntensity)}function ft(gt,vt,At){gt.ior.value=vt.ior,vt.sheen>0&&(gt.sheenColor.value.copy(vt.sheenColor).multiplyScalar(vt.sheen),gt.sheenRoughness.value=vt.sheenRoughness,vt.sheenColorMap&&(gt.sheenColorMap.value=vt.sheenColorMap,rt(vt.sheenColorMap,gt.sheenColorMapTransform)),vt.sheenRoughnessMap&&(gt.sheenRoughnessMap.value=vt.sheenRoughnessMap,rt(vt.sheenRoughnessMap,gt.sheenRoughnessMapTransform))),vt.clearcoat>0&&(gt.clearcoat.value=vt.clearcoat,gt.clearcoatRoughness.value=vt.clearcoatRoughness,vt.clearcoatMap&&(gt.clearcoatMap.value=vt.clearcoatMap,rt(vt.clearcoatMap,gt.clearcoatMapTransform)),vt.clearcoatRoughnessMap&&(gt.clearcoatRoughnessMap.value=vt.clearcoatRoughnessMap,rt(vt.clearcoatRoughnessMap,gt.clearcoatRoughnessMapTransform)),vt.clearcoatNormalMap&&(gt.clearcoatNormalMap.value=vt.clearcoatNormalMap,rt(vt.clearcoatNormalMap,gt.clearcoatNormalMapTransform),gt.clearcoatNormalScale.value.copy(vt.clearcoatNormalScale),vt.side===BackSide&&gt.clearcoatNormalScale.value.negate())),vt.iridescence>0&&(gt.iridescence.value=vt.iridescence,gt.iridescenceIOR.value=vt.iridescenceIOR,gt.iridescenceThicknessMinimum.value=vt.iridescenceThicknessRange[0],gt.iridescenceThicknessMaximum.value=vt.iridescenceThicknessRange[1],vt.iridescenceMap&&(gt.iridescenceMap.value=vt.iridescenceMap,rt(vt.iridescenceMap,gt.iridescenceMapTransform)),vt.iridescenceThicknessMap&&(gt.iridescenceThicknessMap.value=vt.iridescenceThicknessMap,rt(vt.iridescenceThicknessMap,gt.iridescenceThicknessMapTransform))),vt.transmission>0&&(gt.transmission.value=vt.transmission,gt.transmissionSamplerMap.value=At.texture,gt.transmissionSamplerSize.value.set(At.width,At.height),vt.transmissionMap&&(gt.transmissionMap.value=vt.transmissionMap,rt(vt.transmissionMap,gt.transmissionMapTransform)),gt.thickness.value=vt.thickness,vt.thicknessMap&&(gt.thicknessMap.value=vt.thicknessMap,rt(vt.thicknessMap,gt.thicknessMapTransform)),gt.attenuationDistance.value=vt.attenuationDistance,gt.attenuationColor.value.copy(vt.attenuationColor)),vt.anisotropy>0&&(gt.anisotropyVector.value.set(vt.anisotropy*Math.cos(vt.anisotropyRotation),vt.anisotropy*Math.sin(vt.anisotropyRotation)),vt.anisotropyMap&&(gt.anisotropyMap.value=vt.anisotropyMap,rt(vt.anisotropyMap,gt.anisotropyMapTransform))),gt.specularIntensity.value=vt.specularIntensity,gt.specularColor.value.copy(vt.specularColor),vt.specularColorMap&&(gt.specularColorMap.value=vt.specularColorMap,rt(vt.specularColorMap,gt.specularColorMapTransform)),vt.specularIntensityMap&&(gt.specularIntensityMap.value=vt.specularIntensityMap,rt(vt.specularIntensityMap,gt.specularIntensityMapTransform))}function pt(gt,vt){vt.matcap&&(gt.matcap.value=vt.matcap)}function mt(gt,vt){const At=_e.get(vt).light;gt.referencePosition.value.setFromMatrixPosition(At.matrixWorld),gt.nearDistance.value=At.shadow.camera.near,gt.farDistance.value=At.shadow.camera.far}return{refreshFogUniforms:nt,refreshMaterialUniforms:it}}function WebGLUniformsGroups(tt,_e,rt,nt){let it={},st={},ot=[];const lt=rt.isWebGL2?tt.getParameter(tt.MAX_UNIFORM_BUFFER_BINDINGS):0;function at(At,yt){const xt=yt.program;nt.uniformBlockBinding(At,xt)}function ct(At,yt){let xt=it[At.id];xt===void 0&&(pt(At),xt=ut(At),it[At.id]=xt,At.addEventListener("dispose",gt));const _t=yt.program;nt.updateUBOMapping(At,_t);const Et=_e.render.frame;st[At.id]!==Et&&(dt(At),st[At.id]=Et)}function ut(At){const yt=ht();At.__bindingPointIndex=yt;const xt=tt.createBuffer(),_t=At.__size,Et=At.usage;return tt.bindBuffer(tt.UNIFORM_BUFFER,xt),tt.bufferData(tt.UNIFORM_BUFFER,_t,Et),tt.bindBuffer(tt.UNIFORM_BUFFER,null),tt.bindBufferBase(tt.UNIFORM_BUFFER,yt,xt),xt}function ht(){for(let At=0;At<lt;At++)if(ot.indexOf(At)===-1)return ot.push(At),At;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function dt(At){const yt=it[At.id],xt=At.uniforms,_t=At.__cache;tt.bindBuffer(tt.UNIFORM_BUFFER,yt);for(let Et=0,bt=xt.length;Et<bt;Et++){const wt=xt[Et];if(ft(wt,Et,_t)===!0){const Tt=wt.__offset,Mt=Array.isArray(wt.value)?wt.value:[wt.value];let Pt=0;for(let It=0;It<Mt.length;It++){const Ot=Mt[It],Bt=mt(Ot);typeof Ot=="number"?(wt.__data[0]=Ot,tt.bufferSubData(tt.UNIFORM_BUFFER,Tt+Pt,wt.__data)):Ot.isMatrix3?(wt.__data[0]=Ot.elements[0],wt.__data[1]=Ot.elements[1],wt.__data[2]=Ot.elements[2],wt.__data[3]=Ot.elements[0],wt.__data[4]=Ot.elements[3],wt.__data[5]=Ot.elements[4],wt.__data[6]=Ot.elements[5],wt.__data[7]=Ot.elements[0],wt.__data[8]=Ot.elements[6],wt.__data[9]=Ot.elements[7],wt.__data[10]=Ot.elements[8],wt.__data[11]=Ot.elements[0]):(Ot.toArray(wt.__data,Pt),Pt+=Bt.storage/Float32Array.BYTES_PER_ELEMENT)}tt.bufferSubData(tt.UNIFORM_BUFFER,Tt,wt.__data)}}tt.bindBuffer(tt.UNIFORM_BUFFER,null)}function ft(At,yt,xt){const _t=At.value;if(xt[yt]===void 0){if(typeof _t=="number")xt[yt]=_t;else{const Et=Array.isArray(_t)?_t:[_t],bt=[];for(let wt=0;wt<Et.length;wt++)bt.push(Et[wt].clone());xt[yt]=bt}return!0}else if(typeof _t=="number"){if(xt[yt]!==_t)return xt[yt]=_t,!0}else{const Et=Array.isArray(xt[yt])?xt[yt]:[xt[yt]],bt=Array.isArray(_t)?_t:[_t];for(let wt=0;wt<Et.length;wt++){const Tt=Et[wt];if(Tt.equals(bt[wt])===!1)return Tt.copy(bt[wt]),!0}}return!1}function pt(At){const yt=At.uniforms;let xt=0;const _t=16;let Et=0;for(let bt=0,wt=yt.length;bt<wt;bt++){const Tt=yt[bt],Mt={boundary:0,storage:0},Pt=Array.isArray(Tt.value)?Tt.value:[Tt.value];for(let It=0,Ot=Pt.length;It<Ot;It++){const Bt=Pt[It],Ut=mt(Bt);Mt.boundary+=Ut.boundary,Mt.storage+=Ut.storage}if(Tt.__data=new Float32Array(Mt.storage/Float32Array.BYTES_PER_ELEMENT),Tt.__offset=xt,bt>0){Et=xt%_t;const It=_t-Et;Et!==0&&It-Mt.boundary<0&&(xt+=_t-Et,Tt.__offset=xt)}xt+=Mt.storage}return Et=xt%_t,Et>0&&(xt+=_t-Et),At.__size=xt,At.__cache={},this}function mt(At){const yt={boundary:0,storage:0};return typeof At=="number"?(yt.boundary=4,yt.storage=4):At.isVector2?(yt.boundary=8,yt.storage=8):At.isVector3||At.isColor?(yt.boundary=16,yt.storage=12):At.isVector4?(yt.boundary=16,yt.storage=16):At.isMatrix3?(yt.boundary=48,yt.storage=48):At.isMatrix4?(yt.boundary=64,yt.storage=64):At.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",At),yt}function gt(At){const yt=At.target;yt.removeEventListener("dispose",gt);const xt=ot.indexOf(yt.__bindingPointIndex);ot.splice(xt,1),tt.deleteBuffer(it[yt.id]),delete it[yt.id],delete st[yt.id]}function vt(){for(const At in it)tt.deleteBuffer(it[At]);ot=[],it={},st={}}return{bind:at,update:ct,dispose:vt}}function createCanvasElement(){const tt=createElementNS("canvas");return tt.style.display="block",tt}class WebGLRenderer{constructor(_e={}){const{canvas:rt=createCanvasElement(),context:nt=null,depth:it=!0,stencil:st=!0,alpha:ot=!1,antialias:lt=!1,premultipliedAlpha:at=!0,preserveDrawingBuffer:ct=!1,powerPreference:ut="default",failIfMajorPerformanceCaveat:ht=!1}=_e;this.isWebGLRenderer=!0;let dt;nt!==null?dt=nt.getContextAttributes().alpha:dt=ot;const ft=new Uint32Array(4),pt=new Int32Array(4);let mt=null,gt=null;const vt=[],At=[];this.domElement=rt,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=SRGBColorSpace,this.useLegacyLights=!0,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const yt=this;let xt=!1,_t=0,Et=0,bt=null,wt=-1,Tt=null;const Mt=new Vector4,Pt=new Vector4;let It=null;const Ot=new Color$1(0);let Bt=0,Ut=rt.width,Ft=rt.height,jt=1,Dt=null,Gt=null;const zt=new Vector4(0,0,Ut,Ft),$t=new Vector4(0,0,Ut,Ft);let Ht=!1;const er=new Frustum;let Zt=!1,or=!1,Kt=null;const rr=new Matrix4,ur=new Vector2,fr=new Vector3,dr={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function gr(){return bt===null?jt:1}let Yt=nt;function xr(kt,Jt){for(let ir=0;ir<kt.length;ir++){const tr=kt[ir],ar=rt.getContext(tr,Jt);if(ar!==null)return ar}return null}try{const kt={alpha:!0,depth:it,stencil:st,antialias:lt,premultipliedAlpha:at,preserveDrawingBuffer:ct,powerPreference:ut,failIfMajorPerformanceCaveat:ht};if("setAttribute"in rt&&rt.setAttribute("data-engine",`three.js r${REVISION}`),rt.addEventListener("webglcontextlost",Rr,!1),rt.addEventListener("webglcontextrestored",br,!1),rt.addEventListener("webglcontextcreationerror",jr,!1),Yt===null){const Jt=["webgl2","webgl","experimental-webgl"];if(yt.isWebGL1Renderer===!0&&Jt.shift(),Yt=xr(Jt,kt),Yt===null)throw xr(Jt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Yt instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Yt.getShaderPrecisionFormat===void 0&&(Yt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(kt){throw console.error("THREE.WebGLRenderer: "+kt.message),kt}let vr,Pr,Sr,Qr,Ir,Dr,Ur,Lr,Wr,Xt,Qt,hr,kr,yr,_r,Hr,Er,Ar,qt,pr,mr,nr,Cr,cr;function Jr(){vr=new WebGLExtensions(Yt),Pr=new WebGLCapabilities(Yt,vr,_e),vr.init(Pr),nr=new WebGLUtils(Yt,vr,Pr),Sr=new WebGLState(Yt,vr,Pr),Qr=new WebGLInfo(Yt),Ir=new WebGLProperties,Dr=new WebGLTextures(Yt,vr,Sr,Ir,Pr,nr,Qr),Ur=new WebGLCubeMaps(yt),Lr=new WebGLCubeUVMaps(yt),Wr=new WebGLAttributes(Yt,Pr),Cr=new WebGLBindingStates(Yt,vr,Wr,Pr),Xt=new WebGLGeometries(Yt,Wr,Qr,Cr),Qt=new WebGLObjects(Yt,Xt,Wr,Qr),qt=new WebGLMorphtargets(Yt,Pr,Dr),Hr=new WebGLClipping(Ir),hr=new WebGLPrograms(yt,Ur,Lr,vr,Pr,Cr,Hr),kr=new WebGLMaterials(yt,Ir),yr=new WebGLRenderLists,_r=new WebGLRenderStates(vr,Pr),Ar=new WebGLBackground(yt,Ur,Lr,Sr,Qt,dt,at),Er=new WebGLShadowMap(yt,Qt,Pr),cr=new WebGLUniformsGroups(Yt,Qr,Pr,Sr),pr=new WebGLBufferRenderer(Yt,vr,Qr,Pr),mr=new WebGLIndexedBufferRenderer(Yt,vr,Qr,Pr),Qr.programs=hr.programs,yt.capabilities=Pr,yt.extensions=vr,yt.properties=Ir,yt.renderLists=yr,yt.shadowMap=Er,yt.state=Sr,yt.info=Qr}Jr();const lr=new WebXRManager(yt,Yt);this.xr=lr,this.getContext=function(){return Yt},this.getContextAttributes=function(){return Yt.getContextAttributes()},this.forceContextLoss=function(){const kt=vr.get("WEBGL_lose_context");kt&&kt.loseContext()},this.forceContextRestore=function(){const kt=vr.get("WEBGL_lose_context");kt&&kt.restoreContext()},this.getPixelRatio=function(){return jt},this.setPixelRatio=function(kt){kt!==void 0&&(jt=kt,this.setSize(Ut,Ft,!1))},this.getSize=function(kt){return kt.set(Ut,Ft)},this.setSize=function(kt,Jt,ir=!0){if(lr.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ut=kt,Ft=Jt,rt.width=Math.floor(kt*jt),rt.height=Math.floor(Jt*jt),ir===!0&&(rt.style.width=kt+"px",rt.style.height=Jt+"px"),this.setViewport(0,0,kt,Jt)},this.getDrawingBufferSize=function(kt){return kt.set(Ut*jt,Ft*jt).floor()},this.setDrawingBufferSize=function(kt,Jt,ir){Ut=kt,Ft=Jt,jt=ir,rt.width=Math.floor(kt*ir),rt.height=Math.floor(Jt*ir),this.setViewport(0,0,kt,Jt)},this.getCurrentViewport=function(kt){return kt.copy(Mt)},this.getViewport=function(kt){return kt.copy(zt)},this.setViewport=function(kt,Jt,ir,tr){kt.isVector4?zt.set(kt.x,kt.y,kt.z,kt.w):zt.set(kt,Jt,ir,tr),Sr.viewport(Mt.copy(zt).multiplyScalar(jt).floor())},this.getScissor=function(kt){return kt.copy($t)},this.setScissor=function(kt,Jt,ir,tr){kt.isVector4?$t.set(kt.x,kt.y,kt.z,kt.w):$t.set(kt,Jt,ir,tr),Sr.scissor(Pt.copy($t).multiplyScalar(jt).floor())},this.getScissorTest=function(){return Ht},this.setScissorTest=function(kt){Sr.setScissorTest(Ht=kt)},this.setOpaqueSort=function(kt){Dt=kt},this.setTransparentSort=function(kt){Gt=kt},this.getClearColor=function(kt){return kt.copy(Ar.getClearColor())},this.setClearColor=function(){Ar.setClearColor.apply(Ar,arguments)},this.getClearAlpha=function(){return Ar.getClearAlpha()},this.setClearAlpha=function(){Ar.setClearAlpha.apply(Ar,arguments)},this.clear=function(kt=!0,Jt=!0,ir=!0){let tr=0;if(kt){let ar=!1;if(bt!==null){const Or=bt.texture.format;ar=Or===RGBAIntegerFormat||Or===RGIntegerFormat||Or===RedIntegerFormat}if(ar){const Or=bt.texture.type,Br=Or===UnsignedByteType||Or===UnsignedIntType||Or===UnsignedShortType||Or===UnsignedInt248Type||Or===UnsignedShort4444Type||Or===UnsignedShort5551Type,$r=Ar.getClearColor(),Gr=Ar.getClearAlpha(),Vr=$r.r,wr=$r.g,Zr=$r.b;Br?(ft[0]=Vr,ft[1]=wr,ft[2]=Zr,ft[3]=Gr,Yt.clearBufferuiv(Yt.COLOR,0,ft)):(pt[0]=Vr,pt[1]=wr,pt[2]=Zr,pt[3]=Gr,Yt.clearBufferiv(Yt.COLOR,0,pt))}else tr|=Yt.COLOR_BUFFER_BIT}Jt&&(tr|=Yt.DEPTH_BUFFER_BIT),ir&&(tr|=Yt.STENCIL_BUFFER_BIT),Yt.clear(tr)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){rt.removeEventListener("webglcontextlost",Rr,!1),rt.removeEventListener("webglcontextrestored",br,!1),rt.removeEventListener("webglcontextcreationerror",jr,!1),yr.dispose(),_r.dispose(),Ir.dispose(),Ur.dispose(),Lr.dispose(),Qt.dispose(),Cr.dispose(),cr.dispose(),hr.dispose(),lr.dispose(),lr.removeEventListener("sessionstart",Tn),lr.removeEventListener("sessionend",gn),Kt&&(Kt.dispose(),Kt=null),En.stop()};function Rr(kt){kt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),xt=!0}function br(){console.log("THREE.WebGLRenderer: Context Restored."),xt=!1;const kt=Qr.autoReset,Jt=Er.enabled,ir=Er.autoUpdate,tr=Er.needsUpdate,ar=Er.type;Jr(),Qr.autoReset=kt,Er.enabled=Jt,Er.autoUpdate=ir,Er.needsUpdate=tr,Er.type=ar}function jr(kt){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",kt.statusMessage)}function Yr(kt){const Jt=kt.target;Jt.removeEventListener("dispose",Yr),mn(Jt)}function mn(kt){bn(kt),Ir.remove(kt)}function bn(kt){const Jt=Ir.get(kt).programs;Jt!==void 0&&(Jt.forEach(function(ir){hr.releaseProgram(ir)}),kt.isShaderMaterial&&hr.releaseShaderCache(kt))}this.renderBufferDirect=function(kt,Jt,ir,tr,ar,Or){Jt===null&&(Jt=dr);const Br=ar.isMesh&&ar.matrixWorld.determinant()<0,$r=Gn(kt,Jt,ir,tr,ar);Sr.setMaterial(tr,Br);let Gr=ir.index,Vr=1;tr.wireframe===!0&&(Gr=Xt.getWireframeAttribute(ir),Vr=2);const wr=ir.drawRange,Zr=ir.attributes.position;let Kr=wr.start*Vr,qr=(wr.start+wr.count)*Vr;Or!==null&&(Kr=Math.max(Kr,Or.start*Vr),qr=Math.min(qr,(Or.start+Or.count)*Vr)),Gr!==null?(Kr=Math.max(Kr,0),qr=Math.min(qr,Gr.count)):Zr!=null&&(Kr=Math.max(Kr,0),qr=Math.min(qr,Zr.count));const an=qr-Kr;if(an<0||an===1/0)return;Cr.setup(ar,tr,$r,ir,Gr);let hn,ln=pr;if(Gr!==null&&(hn=Wr.get(Gr),ln=mr,ln.setIndex(hn)),ar.isMesh)tr.wireframe===!0?(Sr.setLineWidth(tr.wireframeLinewidth*gr()),ln.setMode(Yt.LINES)):ln.setMode(Yt.TRIANGLES);else if(ar.isLine){let en=tr.linewidth;en===void 0&&(en=1),Sr.setLineWidth(en*gr()),ar.isLineSegments?ln.setMode(Yt.LINES):ar.isLineLoop?ln.setMode(Yt.LINE_LOOP):ln.setMode(Yt.LINE_STRIP)}else ar.isPoints?ln.setMode(Yt.POINTS):ar.isSprite&&ln.setMode(Yt.TRIANGLES);if(ar.isInstancedMesh)ln.renderInstances(Kr,an,ar.count);else if(ir.isInstancedBufferGeometry){const en=ir._maxInstanceCount!==void 0?ir._maxInstanceCount:1/0,dn=Math.min(ir.instanceCount,en);ln.renderInstances(Kr,an,dn)}else ln.render(Kr,an)},this.compile=function(kt,Jt){function ir(tr,ar,Or){tr.transparent===!0&&tr.side===DoubleSide&&tr.forceSinglePass===!1?(tr.side=BackSide,tr.needsUpdate=!0,Mn(tr,ar,Or),tr.side=FrontSide,tr.needsUpdate=!0,Mn(tr,ar,Or),tr.side=DoubleSide):Mn(tr,ar,Or)}gt=_r.get(kt),gt.init(),At.push(gt),kt.traverseVisible(function(tr){tr.isLight&&tr.layers.test(Jt.layers)&&(gt.pushLight(tr),tr.castShadow&&gt.pushShadow(tr))}),gt.setupLights(yt.useLegacyLights),kt.traverse(function(tr){const ar=tr.material;if(ar)if(Array.isArray(ar))for(let Or=0;Or<ar.length;Or++){const Br=ar[Or];ir(Br,kt,tr)}else ir(ar,kt,tr)}),At.pop(),gt=null};let fn=null;function Cn(kt){fn&&fn(kt)}function Tn(){En.stop()}function gn(){En.start()}const En=new WebGLAnimation;En.setAnimationLoop(Cn),typeof self<"u"&&En.setContext(self),this.setAnimationLoop=function(kt){fn=kt,lr.setAnimationLoop(kt),kt===null?En.stop():En.start()},lr.addEventListener("sessionstart",Tn),lr.addEventListener("sessionend",gn),this.render=function(kt,Jt){if(Jt!==void 0&&Jt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(xt===!0)return;kt.matrixWorldAutoUpdate===!0&&kt.updateMatrixWorld(),Jt.parent===null&&Jt.matrixWorldAutoUpdate===!0&&Jt.updateMatrixWorld(),lr.enabled===!0&&lr.isPresenting===!0&&(lr.cameraAutoUpdate===!0&&lr.updateCamera(Jt),Jt=lr.getCamera()),kt.isScene===!0&&kt.onBeforeRender(yt,kt,Jt,bt),gt=_r.get(kt,At.length),gt.init(),At.push(gt),rr.multiplyMatrices(Jt.projectionMatrix,Jt.matrixWorldInverse),er.setFromProjectionMatrix(rr),or=this.localClippingEnabled,Zt=Hr.init(this.clippingPlanes,or),mt=yr.get(kt,vt.length),mt.init(),vt.push(mt),Xn(kt,Jt,0,yt.sortObjects),mt.finish(),yt.sortObjects===!0&&mt.sort(Dt,Gt),this.info.render.frame++,Zt===!0&&Hr.beginShadows();const ir=gt.state.shadowsArray;if(Er.render(ir,kt,Jt),Zt===!0&&Hr.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ar.render(mt,kt),gt.setupLights(yt.useLegacyLights),Jt.isArrayCamera){const tr=Jt.cameras;for(let ar=0,Or=tr.length;ar<Or;ar++){const Br=tr[ar];$n(mt,kt,Br,Br.viewport)}}else $n(mt,kt,Jt);bt!==null&&(Dr.updateMultisampleRenderTarget(bt),Dr.updateRenderTargetMipmap(bt)),kt.isScene===!0&&kt.onAfterRender(yt,kt,Jt),Cr.resetDefaultState(),wt=-1,Tt=null,At.pop(),At.length>0?gt=At[At.length-1]:gt=null,vt.pop(),vt.length>0?mt=vt[vt.length-1]:mt=null};function Xn(kt,Jt,ir,tr){if(kt.visible===!1)return;if(kt.layers.test(Jt.layers)){if(kt.isGroup)ir=kt.renderOrder;else if(kt.isLOD)kt.autoUpdate===!0&&kt.update(Jt);else if(kt.isLight)gt.pushLight(kt),kt.castShadow&&gt.pushShadow(kt);else if(kt.isSprite){if(!kt.frustumCulled||er.intersectsSprite(kt)){tr&&fr.setFromMatrixPosition(kt.matrixWorld).applyMatrix4(rr);const Br=Qt.update(kt),$r=kt.material;$r.visible&&mt.push(kt,Br,$r,ir,fr.z,null)}}else if((kt.isMesh||kt.isLine||kt.isPoints)&&(!kt.frustumCulled||er.intersectsObject(kt))){const Br=Qt.update(kt),$r=kt.material;if(tr&&(kt.boundingSphere!==void 0?(kt.boundingSphere===null&&kt.computeBoundingSphere(),fr.copy(kt.boundingSphere.center)):(Br.boundingSphere===null&&Br.computeBoundingSphere(),fr.copy(Br.boundingSphere.center)),fr.applyMatrix4(kt.matrixWorld).applyMatrix4(rr)),Array.isArray($r)){const Gr=Br.groups;for(let Vr=0,wr=Gr.length;Vr<wr;Vr++){const Zr=Gr[Vr],Kr=$r[Zr.materialIndex];Kr&&Kr.visible&&mt.push(kt,Br,Kr,ir,fr.z,Zr)}}else $r.visible&&mt.push(kt,Br,$r,ir,fr.z,null)}}const Or=kt.children;for(let Br=0,$r=Or.length;Br<$r;Br++)Xn(Or[Br],Jt,ir,tr)}function $n(kt,Jt,ir,tr){const ar=kt.opaque,Or=kt.transmissive,Br=kt.transparent;gt.setupLightsView(ir),Zt===!0&&Hr.setGlobalState(yt.clippingPlanes,ir),Or.length>0&&wn(ar,Or,Jt,ir),tr&&Sr.viewport(Mt.copy(tr)),ar.length>0&&Bn(ar,Jt,ir),Or.length>0&&Bn(Or,Jt,ir),Br.length>0&&Bn(Br,Jt,ir),Sr.buffers.depth.setTest(!0),Sr.buffers.depth.setMask(!0),Sr.buffers.color.setMask(!0),Sr.setPolygonOffset(!1)}function wn(kt,Jt,ir,tr){const ar=Pr.isWebGL2;Kt===null&&(Kt=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:vr.has("EXT_color_buffer_half_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:ar?4:0})),yt.getDrawingBufferSize(ur),ar?Kt.setSize(ur.x,ur.y):Kt.setSize(floorPowerOfTwo(ur.x),floorPowerOfTwo(ur.y));const Or=yt.getRenderTarget();yt.setRenderTarget(Kt),yt.getClearColor(Ot),Bt=yt.getClearAlpha(),Bt<1&&yt.setClearColor(16777215,.5),yt.clear();const Br=yt.toneMapping;yt.toneMapping=NoToneMapping,Bn(kt,ir,tr),Dr.updateMultisampleRenderTarget(Kt),Dr.updateRenderTargetMipmap(Kt);let $r=!1;for(let Gr=0,Vr=Jt.length;Gr<Vr;Gr++){const wr=Jt[Gr],Zr=wr.object,Kr=wr.geometry,qr=wr.material,an=wr.group;if(qr.side===DoubleSide&&Zr.layers.test(tr.layers)){const hn=qr.side;qr.side=BackSide,qr.needsUpdate=!0,Qn(Zr,ir,tr,Kr,qr,an),qr.side=hn,qr.needsUpdate=!0,$r=!0}}$r===!0&&(Dr.updateMultisampleRenderTarget(Kt),Dr.updateRenderTargetMipmap(Kt)),yt.setRenderTarget(Or),yt.setClearColor(Ot,Bt),yt.toneMapping=Br}function Bn(kt,Jt,ir){const tr=Jt.isScene===!0?Jt.overrideMaterial:null;for(let ar=0,Or=kt.length;ar<Or;ar++){const Br=kt[ar],$r=Br.object,Gr=Br.geometry,Vr=tr===null?Br.material:tr,wr=Br.group;$r.layers.test(ir.layers)&&Qn($r,Jt,ir,Gr,Vr,wr)}}function Qn(kt,Jt,ir,tr,ar,Or){kt.onBeforeRender(yt,Jt,ir,tr,ar,Or),kt.modelViewMatrix.multiplyMatrices(ir.matrixWorldInverse,kt.matrixWorld),kt.normalMatrix.getNormalMatrix(kt.modelViewMatrix),ar.onBeforeRender(yt,Jt,ir,tr,kt,Or),ar.transparent===!0&&ar.side===DoubleSide&&ar.forceSinglePass===!1?(ar.side=BackSide,ar.needsUpdate=!0,yt.renderBufferDirect(ir,Jt,tr,ar,kt,Or),ar.side=FrontSide,ar.needsUpdate=!0,yt.renderBufferDirect(ir,Jt,tr,ar,kt,Or),ar.side=DoubleSide):yt.renderBufferDirect(ir,Jt,tr,ar,kt,Or),kt.onAfterRender(yt,Jt,ir,tr,ar,Or)}function Mn(kt,Jt,ir){Jt.isScene!==!0&&(Jt=dr);const tr=Ir.get(kt),ar=gt.state.lights,Or=gt.state.shadowsArray,Br=ar.state.version,$r=hr.getParameters(kt,ar.state,Or,Jt,ir),Gr=hr.getProgramCacheKey($r);let Vr=tr.programs;tr.environment=kt.isMeshStandardMaterial?Jt.environment:null,tr.fog=Jt.fog,tr.envMap=(kt.isMeshStandardMaterial?Lr:Ur).get(kt.envMap||tr.environment),Vr===void 0&&(kt.addEventListener("dispose",Yr),Vr=new Map,tr.programs=Vr);let wr=Vr.get(Gr);if(wr!==void 0){if(tr.currentProgram===wr&&tr.lightsStateVersion===Br)return on(kt,$r),wr}else $r.uniforms=hr.getUniforms(kt),kt.onBuild(ir,$r,yt),kt.onBeforeCompile($r,yt),wr=hr.acquireProgram($r,Gr),Vr.set(Gr,wr),tr.uniforms=$r.uniforms;const Zr=tr.uniforms;(!kt.isShaderMaterial&&!kt.isRawShaderMaterial||kt.clipping===!0)&&(Zr.clippingPlanes=Hr.uniform),on(kt,$r),tr.needsLights=Wt(kt),tr.lightsStateVersion=Br,tr.needsLights&&(Zr.ambientLightColor.value=ar.state.ambient,Zr.lightProbe.value=ar.state.probe,Zr.directionalLights.value=ar.state.directional,Zr.directionalLightShadows.value=ar.state.directionalShadow,Zr.spotLights.value=ar.state.spot,Zr.spotLightShadows.value=ar.state.spotShadow,Zr.rectAreaLights.value=ar.state.rectArea,Zr.ltc_1.value=ar.state.rectAreaLTC1,Zr.ltc_2.value=ar.state.rectAreaLTC2,Zr.pointLights.value=ar.state.point,Zr.pointLightShadows.value=ar.state.pointShadow,Zr.hemisphereLights.value=ar.state.hemi,Zr.directionalShadowMap.value=ar.state.directionalShadowMap,Zr.directionalShadowMatrix.value=ar.state.directionalShadowMatrix,Zr.spotShadowMap.value=ar.state.spotShadowMap,Zr.spotLightMatrix.value=ar.state.spotLightMatrix,Zr.spotLightMap.value=ar.state.spotLightMap,Zr.pointShadowMap.value=ar.state.pointShadowMap,Zr.pointShadowMatrix.value=ar.state.pointShadowMatrix);const Kr=wr.getUniforms(),qr=WebGLUniforms.seqWithValue(Kr.seq,Zr);return tr.currentProgram=wr,tr.uniformsList=qr,wr}function on(kt,Jt){const ir=Ir.get(kt);ir.outputColorSpace=Jt.outputColorSpace,ir.instancing=Jt.instancing,ir.skinning=Jt.skinning,ir.morphTargets=Jt.morphTargets,ir.morphNormals=Jt.morphNormals,ir.morphColors=Jt.morphColors,ir.morphTargetsCount=Jt.morphTargetsCount,ir.numClippingPlanes=Jt.numClippingPlanes,ir.numIntersection=Jt.numClipIntersection,ir.vertexAlphas=Jt.vertexAlphas,ir.vertexTangents=Jt.vertexTangents,ir.toneMapping=Jt.toneMapping}function Gn(kt,Jt,ir,tr,ar){Jt.isScene!==!0&&(Jt=dr),Dr.resetTextureUnits();const Or=Jt.fog,Br=tr.isMeshStandardMaterial?Jt.environment:null,$r=bt===null?yt.outputColorSpace:bt.isXRRenderTarget===!0?bt.texture.colorSpace:LinearSRGBColorSpace,Gr=(tr.isMeshStandardMaterial?Lr:Ur).get(tr.envMap||Br),Vr=tr.vertexColors===!0&&!!ir.attributes.color&&ir.attributes.color.itemSize===4,wr=!!ir.attributes.tangent&&(!!tr.normalMap||tr.anisotropy>0),Zr=!!ir.morphAttributes.position,Kr=!!ir.morphAttributes.normal,qr=!!ir.morphAttributes.color,an=tr.toneMapped?yt.toneMapping:NoToneMapping,hn=ir.morphAttributes.position||ir.morphAttributes.normal||ir.morphAttributes.color,ln=hn!==void 0?hn.length:0,en=Ir.get(tr),dn=gt.state.lights;if(Zt===!0&&(or===!0||kt!==Tt)){const yn=kt===Tt&&tr.id===wt;Hr.setState(tr,kt,yn)}let sn=!1;tr.version===en.__version?(en.needsLights&&en.lightsStateVersion!==dn.state.version||en.outputColorSpace!==$r||ar.isInstancedMesh&&en.instancing===!1||!ar.isInstancedMesh&&en.instancing===!0||ar.isSkinnedMesh&&en.skinning===!1||!ar.isSkinnedMesh&&en.skinning===!0||en.envMap!==Gr||tr.fog===!0&&en.fog!==Or||en.numClippingPlanes!==void 0&&(en.numClippingPlanes!==Hr.numPlanes||en.numIntersection!==Hr.numIntersection)||en.vertexAlphas!==Vr||en.vertexTangents!==wr||en.morphTargets!==Zr||en.morphNormals!==Kr||en.morphColors!==qr||en.toneMapping!==an||Pr.isWebGL2===!0&&en.morphTargetsCount!==ln)&&(sn=!0):(sn=!0,en.__version=tr.version);let An=en.currentProgram;sn===!0&&(An=Mn(tr,Jt,ar));let Nn=!1,vn=!1,kn=!1;const In=An.getUniforms(),Dn=en.uniforms;if(Sr.useProgram(An.program)&&(Nn=!0,vn=!0,kn=!0),tr.id!==wt&&(wt=tr.id,vn=!0),Nn||Tt!==kt){if(In.setValue(Yt,"projectionMatrix",kt.projectionMatrix),Pr.logarithmicDepthBuffer&&In.setValue(Yt,"logDepthBufFC",2/(Math.log(kt.far+1)/Math.LN2)),Tt!==kt&&(Tt=kt,vn=!0,kn=!0),tr.isShaderMaterial||tr.isMeshPhongMaterial||tr.isMeshToonMaterial||tr.isMeshStandardMaterial||tr.envMap){const yn=In.map.cameraPosition;yn!==void 0&&yn.setValue(Yt,fr.setFromMatrixPosition(kt.matrixWorld))}(tr.isMeshPhongMaterial||tr.isMeshToonMaterial||tr.isMeshLambertMaterial||tr.isMeshBasicMaterial||tr.isMeshStandardMaterial||tr.isShaderMaterial)&&In.setValue(Yt,"isOrthographic",kt.isOrthographicCamera===!0),(tr.isMeshPhongMaterial||tr.isMeshToonMaterial||tr.isMeshLambertMaterial||tr.isMeshBasicMaterial||tr.isMeshStandardMaterial||tr.isShaderMaterial||tr.isShadowMaterial||ar.isSkinnedMesh)&&In.setValue(Yt,"viewMatrix",kt.matrixWorldInverse)}if(ar.isSkinnedMesh){In.setOptional(Yt,ar,"bindMatrix"),In.setOptional(Yt,ar,"bindMatrixInverse");const yn=ar.skeleton;yn&&(Pr.floatVertexTextures?(yn.boneTexture===null&&yn.computeBoneTexture(),In.setValue(Yt,"boneTexture",yn.boneTexture,Dr),In.setValue(Yt,"boneTextureSize",yn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const zn=ir.morphAttributes;if((zn.position!==void 0||zn.normal!==void 0||zn.color!==void 0&&Pr.isWebGL2===!0)&&qt.update(ar,ir,An),(vn||en.receiveShadow!==ar.receiveShadow)&&(en.receiveShadow=ar.receiveShadow,In.setValue(Yt,"receiveShadow",ar.receiveShadow)),tr.isMeshGouraudMaterial&&tr.envMap!==null&&(Dn.envMap.value=Gr,Dn.flipEnvMap.value=Gr.isCubeTexture&&Gr.isRenderTargetTexture===!1?-1:1),vn&&(In.setValue(Yt,"toneMappingExposure",yt.toneMappingExposure),en.needsLights&&_s(Dn,kn),Or&&tr.fog===!0&&kr.refreshFogUniforms(Dn,Or),kr.refreshMaterialUniforms(Dn,tr,jt,Ft,Kt),WebGLUniforms.upload(Yt,en.uniformsList,Dn,Dr)),tr.isShaderMaterial&&tr.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(Yt,en.uniformsList,Dn,Dr),tr.uniformsNeedUpdate=!1),tr.isSpriteMaterial&&In.setValue(Yt,"center",ar.center),In.setValue(Yt,"modelViewMatrix",ar.modelViewMatrix),In.setValue(Yt,"normalMatrix",ar.normalMatrix),In.setValue(Yt,"modelMatrix",ar.matrixWorld),tr.isShaderMaterial||tr.isRawShaderMaterial){const yn=tr.uniformsGroups;for(let Vn=0,On=yn.length;Vn<On;Vn++)if(Pr.isWebGL2){const _n=yn[Vn];cr.update(_n,An),cr.bind(_n,An)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return An}function _s(kt,Jt){kt.ambientLightColor.needsUpdate=Jt,kt.lightProbe.needsUpdate=Jt,kt.directionalLights.needsUpdate=Jt,kt.directionalLightShadows.needsUpdate=Jt,kt.pointLights.needsUpdate=Jt,kt.pointLightShadows.needsUpdate=Jt,kt.spotLights.needsUpdate=Jt,kt.spotLightShadows.needsUpdate=Jt,kt.rectAreaLights.needsUpdate=Jt,kt.hemisphereLights.needsUpdate=Jt}function Wt(kt){return kt.isMeshLambertMaterial||kt.isMeshToonMaterial||kt.isMeshPhongMaterial||kt.isMeshStandardMaterial||kt.isShadowMaterial||kt.isShaderMaterial&&kt.lights===!0}this.getActiveCubeFace=function(){return _t},this.getActiveMipmapLevel=function(){return Et},this.getRenderTarget=function(){return bt},this.setRenderTargetTextures=function(kt,Jt,ir){Ir.get(kt.texture).__webglTexture=Jt,Ir.get(kt.depthTexture).__webglTexture=ir;const tr=Ir.get(kt);tr.__hasExternalTextures=!0,tr.__hasExternalTextures&&(tr.__autoAllocateDepthBuffer=ir===void 0,tr.__autoAllocateDepthBuffer||vr.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),tr.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(kt,Jt){const ir=Ir.get(kt);ir.__webglFramebuffer=Jt,ir.__useDefaultFramebuffer=Jt===void 0},this.setRenderTarget=function(kt,Jt=0,ir=0){bt=kt,_t=Jt,Et=ir;let tr=!0,ar=null,Or=!1,Br=!1;if(kt){const Gr=Ir.get(kt);Gr.__useDefaultFramebuffer!==void 0?(Sr.bindFramebuffer(Yt.FRAMEBUFFER,null),tr=!1):Gr.__webglFramebuffer===void 0?Dr.setupRenderTarget(kt):Gr.__hasExternalTextures&&Dr.rebindTextures(kt,Ir.get(kt.texture).__webglTexture,Ir.get(kt.depthTexture).__webglTexture);const Vr=kt.texture;(Vr.isData3DTexture||Vr.isDataArrayTexture||Vr.isCompressedArrayTexture)&&(Br=!0);const wr=Ir.get(kt).__webglFramebuffer;kt.isWebGLCubeRenderTarget?(ar=wr[Jt],Or=!0):Pr.isWebGL2&&kt.samples>0&&Dr.useMultisampledRTT(kt)===!1?ar=Ir.get(kt).__webglMultisampledFramebuffer:ar=wr,Mt.copy(kt.viewport),Pt.copy(kt.scissor),It=kt.scissorTest}else Mt.copy(zt).multiplyScalar(jt).floor(),Pt.copy($t).multiplyScalar(jt).floor(),It=Ht;if(Sr.bindFramebuffer(Yt.FRAMEBUFFER,ar)&&Pr.drawBuffers&&tr&&Sr.drawBuffers(kt,ar),Sr.viewport(Mt),Sr.scissor(Pt),Sr.setScissorTest(It),Or){const Gr=Ir.get(kt.texture);Yt.framebufferTexture2D(Yt.FRAMEBUFFER,Yt.COLOR_ATTACHMENT0,Yt.TEXTURE_CUBE_MAP_POSITIVE_X+Jt,Gr.__webglTexture,ir)}else if(Br){const Gr=Ir.get(kt.texture),Vr=Jt||0;Yt.framebufferTextureLayer(Yt.FRAMEBUFFER,Yt.COLOR_ATTACHMENT0,Gr.__webglTexture,ir||0,Vr)}wt=-1},this.readRenderTargetPixels=function(kt,Jt,ir,tr,ar,Or,Br){if(!(kt&&kt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let $r=Ir.get(kt).__webglFramebuffer;if(kt.isWebGLCubeRenderTarget&&Br!==void 0&&($r=$r[Br]),$r){Sr.bindFramebuffer(Yt.FRAMEBUFFER,$r);try{const Gr=kt.texture,Vr=Gr.format,wr=Gr.type;if(Vr!==RGBAFormat&&nr.convert(Vr)!==Yt.getParameter(Yt.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Zr=wr===HalfFloatType&&(vr.has("EXT_color_buffer_half_float")||Pr.isWebGL2&&vr.has("EXT_color_buffer_float"));if(wr!==UnsignedByteType&&nr.convert(wr)!==Yt.getParameter(Yt.IMPLEMENTATION_COLOR_READ_TYPE)&&!(wr===FloatType&&(Pr.isWebGL2||vr.has("OES_texture_float")||vr.has("WEBGL_color_buffer_float")))&&!Zr){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Jt>=0&&Jt<=kt.width-tr&&ir>=0&&ir<=kt.height-ar&&Yt.readPixels(Jt,ir,tr,ar,nr.convert(Vr),nr.convert(wr),Or)}finally{const Gr=bt!==null?Ir.get(bt).__webglFramebuffer:null;Sr.bindFramebuffer(Yt.FRAMEBUFFER,Gr)}}},this.copyFramebufferToTexture=function(kt,Jt,ir=0){const tr=Math.pow(2,-ir),ar=Math.floor(Jt.image.width*tr),Or=Math.floor(Jt.image.height*tr);Dr.setTexture2D(Jt,0),Yt.copyTexSubImage2D(Yt.TEXTURE_2D,ir,0,0,kt.x,kt.y,ar,Or),Sr.unbindTexture()},this.copyTextureToTexture=function(kt,Jt,ir,tr=0){const ar=Jt.image.width,Or=Jt.image.height,Br=nr.convert(ir.format),$r=nr.convert(ir.type);Dr.setTexture2D(ir,0),Yt.pixelStorei(Yt.UNPACK_FLIP_Y_WEBGL,ir.flipY),Yt.pixelStorei(Yt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ir.premultiplyAlpha),Yt.pixelStorei(Yt.UNPACK_ALIGNMENT,ir.unpackAlignment),Jt.isDataTexture?Yt.texSubImage2D(Yt.TEXTURE_2D,tr,kt.x,kt.y,ar,Or,Br,$r,Jt.image.data):Jt.isCompressedTexture?Yt.compressedTexSubImage2D(Yt.TEXTURE_2D,tr,kt.x,kt.y,Jt.mipmaps[0].width,Jt.mipmaps[0].height,Br,Jt.mipmaps[0].data):Yt.texSubImage2D(Yt.TEXTURE_2D,tr,kt.x,kt.y,Br,$r,Jt.image),tr===0&&ir.generateMipmaps&&Yt.generateMipmap(Yt.TEXTURE_2D),Sr.unbindTexture()},this.copyTextureToTexture3D=function(kt,Jt,ir,tr,ar=0){if(yt.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Or=kt.max.x-kt.min.x+1,Br=kt.max.y-kt.min.y+1,$r=kt.max.z-kt.min.z+1,Gr=nr.convert(tr.format),Vr=nr.convert(tr.type);let wr;if(tr.isData3DTexture)Dr.setTexture3D(tr,0),wr=Yt.TEXTURE_3D;else if(tr.isDataArrayTexture)Dr.setTexture2DArray(tr,0),wr=Yt.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Yt.pixelStorei(Yt.UNPACK_FLIP_Y_WEBGL,tr.flipY),Yt.pixelStorei(Yt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,tr.premultiplyAlpha),Yt.pixelStorei(Yt.UNPACK_ALIGNMENT,tr.unpackAlignment);const Zr=Yt.getParameter(Yt.UNPACK_ROW_LENGTH),Kr=Yt.getParameter(Yt.UNPACK_IMAGE_HEIGHT),qr=Yt.getParameter(Yt.UNPACK_SKIP_PIXELS),an=Yt.getParameter(Yt.UNPACK_SKIP_ROWS),hn=Yt.getParameter(Yt.UNPACK_SKIP_IMAGES),ln=ir.isCompressedTexture?ir.mipmaps[0]:ir.image;Yt.pixelStorei(Yt.UNPACK_ROW_LENGTH,ln.width),Yt.pixelStorei(Yt.UNPACK_IMAGE_HEIGHT,ln.height),Yt.pixelStorei(Yt.UNPACK_SKIP_PIXELS,kt.min.x),Yt.pixelStorei(Yt.UNPACK_SKIP_ROWS,kt.min.y),Yt.pixelStorei(Yt.UNPACK_SKIP_IMAGES,kt.min.z),ir.isDataTexture||ir.isData3DTexture?Yt.texSubImage3D(wr,ar,Jt.x,Jt.y,Jt.z,Or,Br,$r,Gr,Vr,ln.data):ir.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Yt.compressedTexSubImage3D(wr,ar,Jt.x,Jt.y,Jt.z,Or,Br,$r,Gr,ln.data)):Yt.texSubImage3D(wr,ar,Jt.x,Jt.y,Jt.z,Or,Br,$r,Gr,Vr,ln),Yt.pixelStorei(Yt.UNPACK_ROW_LENGTH,Zr),Yt.pixelStorei(Yt.UNPACK_IMAGE_HEIGHT,Kr),Yt.pixelStorei(Yt.UNPACK_SKIP_PIXELS,qr),Yt.pixelStorei(Yt.UNPACK_SKIP_ROWS,an),Yt.pixelStorei(Yt.UNPACK_SKIP_IMAGES,hn),ar===0&&tr.generateMipmaps&&Yt.generateMipmap(wr),Sr.unbindTexture()},this.initTexture=function(kt){kt.isCubeTexture?Dr.setTextureCube(kt,0):kt.isData3DTexture?Dr.setTexture3D(kt,0):kt.isDataArrayTexture||kt.isCompressedArrayTexture?Dr.setTexture2DArray(kt,0):Dr.setTexture2D(kt,0),Sr.unbindTexture()},this.resetState=function(){_t=0,Et=0,bt=null,Sr.reset(),Cr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(_e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!_e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set outputEncoding(_e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=_e===sRGBEncoding?SRGBColorSpace:LinearSRGBColorSpace}}class WebGL1Renderer extends WebGLRenderer{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class FogExp2{constructor(_e,rt=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color$1(_e),this.density=rt}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Fog{constructor(_e,rt=1,nt=1e3){this.isFog=!0,this.name="",this.color=new Color$1(_e),this.near=rt,this.far=nt}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_e,rt){return super.copy(_e,rt),_e.background!==null&&(this.background=_e.background.clone()),_e.environment!==null&&(this.environment=_e.environment.clone()),_e.fog!==null&&(this.fog=_e.fog.clone()),this.backgroundBlurriness=_e.backgroundBlurriness,this.backgroundIntensity=_e.backgroundIntensity,_e.overrideMaterial!==null&&(this.overrideMaterial=_e.overrideMaterial.clone()),this.matrixAutoUpdate=_e.matrixAutoUpdate,this}toJSON(_e){const rt=super.toJSON(_e);return this.fog!==null&&(rt.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(rt.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(rt.object.backgroundIntensity=this.backgroundIntensity),rt}}class InterleavedBuffer{constructor(_e,rt){this.isInterleavedBuffer=!0,this.array=_e,this.stride=rt,this.count=_e!==void 0?_e.length/rt:0,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=generateUUID$1()}onUploadCallback(){}set needsUpdate(_e){_e===!0&&this.version++}setUsage(_e){return this.usage=_e,this}copy(_e){return this.array=new _e.array.constructor(_e.array),this.count=_e.count,this.stride=_e.stride,this.usage=_e.usage,this}copyAt(_e,rt,nt){_e*=this.stride,nt*=rt.stride;for(let it=0,st=this.stride;it<st;it++)this.array[_e+it]=rt.array[nt+it];return this}set(_e,rt=0){return this.array.set(_e,rt),this}clone(_e){_e.arrayBuffers===void 0&&(_e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_e.arrayBuffers[this.array.buffer._uuid]===void 0&&(_e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const rt=new this.array.constructor(_e.arrayBuffers[this.array.buffer._uuid]),nt=new this.constructor(rt,this.stride);return nt.setUsage(this.usage),nt}onUpload(_e){return this.onUploadCallback=_e,this}toJSON(_e){return _e.arrayBuffers===void 0&&(_e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_e.arrayBuffers[this.array.buffer._uuid]===void 0&&(_e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$5=new Vector3;class InterleavedBufferAttribute{constructor(_e,rt,nt,it=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_e,this.itemSize=rt,this.offset=nt,this.normalized=it}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_e){this.data.needsUpdate=_e}applyMatrix4(_e){for(let rt=0,nt=this.data.count;rt<nt;rt++)_vector$5.fromBufferAttribute(this,rt),_vector$5.applyMatrix4(_e),this.setXYZ(rt,_vector$5.x,_vector$5.y,_vector$5.z);return this}applyNormalMatrix(_e){for(let rt=0,nt=this.count;rt<nt;rt++)_vector$5.fromBufferAttribute(this,rt),_vector$5.applyNormalMatrix(_e),this.setXYZ(rt,_vector$5.x,_vector$5.y,_vector$5.z);return this}transformDirection(_e){for(let rt=0,nt=this.count;rt<nt;rt++)_vector$5.fromBufferAttribute(this,rt),_vector$5.transformDirection(_e),this.setXYZ(rt,_vector$5.x,_vector$5.y,_vector$5.z);return this}setX(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.data.array[_e*this.data.stride+this.offset]=rt,this}setY(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.data.array[_e*this.data.stride+this.offset+1]=rt,this}setZ(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.data.array[_e*this.data.stride+this.offset+2]=rt,this}setW(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.data.array[_e*this.data.stride+this.offset+3]=rt,this}getX(_e){let rt=this.data.array[_e*this.data.stride+this.offset];return this.normalized&&(rt=denormalize(rt,this.array)),rt}getY(_e){let rt=this.data.array[_e*this.data.stride+this.offset+1];return this.normalized&&(rt=denormalize(rt,this.array)),rt}getZ(_e){let rt=this.data.array[_e*this.data.stride+this.offset+2];return this.normalized&&(rt=denormalize(rt,this.array)),rt}getW(_e){let rt=this.data.array[_e*this.data.stride+this.offset+3];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setXY(_e,rt,nt){return _e=_e*this.data.stride+this.offset,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array)),this.data.array[_e+0]=rt,this.data.array[_e+1]=nt,this}setXYZ(_e,rt,nt,it){return _e=_e*this.data.stride+this.offset,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array),it=normalize$5(it,this.array)),this.data.array[_e+0]=rt,this.data.array[_e+1]=nt,this.data.array[_e+2]=it,this}setXYZW(_e,rt,nt,it,st){return _e=_e*this.data.stride+this.offset,this.normalized&&(rt=normalize$5(rt,this.array),nt=normalize$5(nt,this.array),it=normalize$5(it,this.array),st=normalize$5(st,this.array)),this.data.array[_e+0]=rt,this.data.array[_e+1]=nt,this.data.array[_e+2]=it,this.data.array[_e+3]=st,this}clone(_e){if(_e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const rt=[];for(let nt=0;nt<this.count;nt++){const it=nt*this.data.stride+this.offset;for(let st=0;st<this.itemSize;st++)rt.push(this.data.array[it+st])}return new BufferAttribute(new this.array.constructor(rt),this.itemSize,this.normalized)}else return _e.interleavedBuffers===void 0&&(_e.interleavedBuffers={}),_e.interleavedBuffers[this.data.uuid]===void 0&&(_e.interleavedBuffers[this.data.uuid]=this.data.clone(_e)),new InterleavedBufferAttribute(_e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_e){if(_e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const rt=[];for(let nt=0;nt<this.count;nt++){const it=nt*this.data.stride+this.offset;for(let st=0;st<this.itemSize;st++)rt.push(this.data.array[it+st])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:rt,normalized:this.normalized}}else return _e.interleavedBuffers===void 0&&(_e.interleavedBuffers={}),_e.interleavedBuffers[this.data.uuid]===void 0&&(_e.interleavedBuffers[this.data.uuid]=this.data.toJSON(_e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(_e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.alphaMap=_e.alphaMap,this.rotation=_e.rotation,this.sizeAttenuation=_e.sizeAttenuation,this.fog=_e.fog,this}}let _geometry;const _intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2;class Sprite extends Object3D{constructor(_e){if(super(),this.isSprite=!0,this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;const rt=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),nt=new InterleavedBuffer(rt,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(nt,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(nt,2,3,!1))}this.geometry=_geometry,this.material=_e!==void 0?_e:new SpriteMaterial,this.center=new Vector2(.5,.5)}raycast(_e,rt){_e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(_e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_e.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),_e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const nt=this.material.rotation;let it,st;nt!==0&&(st=Math.cos(nt),it=Math.sin(nt));const ot=this.center;transformVertex(_vA.set(-.5,-.5,0),_mvPosition,ot,_worldScale,it,st),transformVertex(_vB.set(.5,-.5,0),_mvPosition,ot,_worldScale,it,st),transformVertex(_vC.set(.5,.5,0),_mvPosition,ot,_worldScale,it,st),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let lt=_e.ray.intersectTriangle(_vA,_vB,_vC,!1,_intersectPoint);if(lt===null&&(transformVertex(_vB.set(-.5,.5,0),_mvPosition,ot,_worldScale,it,st),_uvB.set(0,1),lt=_e.ray.intersectTriangle(_vA,_vC,_vB,!1,_intersectPoint),lt===null))return;const at=_e.ray.origin.distanceTo(_intersectPoint);at<_e.near||at>_e.far||rt.push({distance:at,point:_intersectPoint.clone(),uv:Triangle.getInterpolation(_intersectPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2),face:null,object:this})}copy(_e,rt){return super.copy(_e,rt),_e.center!==void 0&&this.center.copy(_e.center),this.material=_e.material,this}}function transformVertex(tt,_e,rt,nt,it,st){_alignedPosition.subVectors(tt,rt).addScalar(.5).multiply(nt),it!==void 0?(_rotatedPosition.x=st*_alignedPosition.x-it*_alignedPosition.y,_rotatedPosition.y=it*_alignedPosition.x+st*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),tt.copy(_e),tt.x+=_rotatedPosition.x,tt.y+=_rotatedPosition.y,tt.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(_e){super.copy(_e,!1);const rt=_e.levels;for(let nt=0,it=rt.length;nt<it;nt++){const st=rt[nt];this.addLevel(st.object.clone(),st.distance,st.hysteresis)}return this.autoUpdate=_e.autoUpdate,this}addLevel(_e,rt=0,nt=0){rt=Math.abs(rt);const it=this.levels;let st;for(st=0;st<it.length&&!(rt<it[st].distance);st++);return it.splice(st,0,{distance:rt,hysteresis:nt,object:_e}),this.add(_e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_e){const rt=this.levels;if(rt.length>0){let nt,it;for(nt=1,it=rt.length;nt<it;nt++){let st=rt[nt].distance;if(rt[nt].object.visible&&(st-=st*rt[nt].hysteresis),_e<st)break}return rt[nt-1].object}return null}raycast(_e,rt){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const it=_e.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(it).raycast(_e,rt)}}update(_e){const rt=this.levels;if(rt.length>1){_v1$2.setFromMatrixPosition(_e.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const nt=_v1$2.distanceTo(_v2$1)/_e.zoom;rt[0].object.visible=!0;let it,st;for(it=1,st=rt.length;it<st;it++){let ot=rt[it].distance;if(rt[it].object.visible&&(ot-=ot*rt[it].hysteresis),nt>=ot)rt[it-1].object.visible=!1,rt[it].object.visible=!0;else break}for(this._currentLevel=it-1;it<st;it++)rt[it].object.visible=!1}}toJSON(_e){const rt=super.toJSON(_e);this.autoUpdate===!1&&(rt.object.autoUpdate=!1),rt.object.levels=[];const nt=this.levels;for(let it=0,st=nt.length;it<st;it++){const ot=nt[it];rt.object.levels.push({object:ot.object.uuid,distance:ot.distance,hysteresis:ot.hysteresis})}return rt}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$3=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray$1;class SkinnedMesh extends Mesh{constructor(_e,rt){super(_e,rt),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const _e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const rt=_e.getAttribute("position");for(let nt=0;nt<rt.count;nt++)_vertex.fromBufferAttribute(rt,nt),this.applyBoneTransform(nt,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const _e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const rt=_e.getAttribute("position");for(let nt=0;nt<rt.count;nt++)_vertex.fromBufferAttribute(rt,nt),this.applyBoneTransform(nt,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(_e,rt){return super.copy(_e,rt),this.bindMode=_e.bindMode,this.bindMatrix.copy(_e.bindMatrix),this.bindMatrixInverse.copy(_e.bindMatrixInverse),this.skeleton=_e.skeleton,_e.boundingBox!==null&&(this.boundingBox=_e.boundingBox.clone()),_e.boundingSphere!==null&&(this.boundingSphere=_e.boundingSphere.clone()),this}raycast(_e,rt){const nt=this.material,it=this.matrixWorld;nt!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4(it),_e.ray.intersectsSphere(_sphere$3)!==!1&&(_inverseMatrix$2.copy(it).invert(),_ray$2.copy(_e.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(_e,rt,_ray$2)))}getVertexPosition(_e,rt){return super.getVertexPosition(_e,rt),this.applyBoneTransform(_e,rt),rt}bind(_e,rt){this.skeleton=_e,rt===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),rt=this.matrixWorld),this.bindMatrix.copy(rt),this.bindMatrixInverse.copy(rt).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _e=new Vector4,rt=this.geometry.attributes.skinWeight;for(let nt=0,it=rt.count;nt<it;nt++){_e.fromBufferAttribute(rt,nt);const st=1/_e.manhattanLength();st!==1/0?_e.multiplyScalar(st):_e.set(1,0,0,0),rt.setXYZW(nt,_e.x,_e.y,_e.z,_e.w)}}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(_e,rt){const nt=this.skeleton,it=this.geometry;_skinIndex.fromBufferAttribute(it.attributes.skinIndex,_e),_skinWeight.fromBufferAttribute(it.attributes.skinWeight,_e),_basePosition.copy(rt).applyMatrix4(this.bindMatrix),rt.set(0,0,0);for(let st=0;st<4;st++){const ot=_skinWeight.getComponent(st);if(ot!==0){const lt=_skinIndex.getComponent(st);_matrix4.multiplyMatrices(nt.bones[lt].matrixWorld,nt.boneInverses[lt]),rt.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),ot)}}return rt.applyMatrix4(this.bindMatrixInverse)}boneTransform(_e,rt){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(_e,rt)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(_e=null,rt=1,nt=1,it,st,ot,lt,at,ct=NearestFilter,ut=NearestFilter,ht,dt){super(null,ot,lt,at,ct,ut,it,st,ht,dt),this.isDataTexture=!0,this.image={data:_e,width:rt,height:nt},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$2=new Matrix4;class Skeleton{constructor(_e=[],rt=[]){this.uuid=generateUUID$1(),this.bones=_e.slice(0),this.boneInverses=rt,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const _e=this.bones,rt=this.boneInverses;if(this.boneMatrices=new Float32Array(_e.length*16),rt.length===0)this.calculateInverses();else if(_e.length!==rt.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let nt=0,it=this.bones.length;nt<it;nt++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let _e=0,rt=this.bones.length;_e<rt;_e++){const nt=new Matrix4;this.bones[_e]&&nt.copy(this.bones[_e].matrixWorld).invert(),this.boneInverses.push(nt)}}pose(){for(let _e=0,rt=this.bones.length;_e<rt;_e++){const nt=this.bones[_e];nt&&nt.matrixWorld.copy(this.boneInverses[_e]).invert()}for(let _e=0,rt=this.bones.length;_e<rt;_e++){const nt=this.bones[_e];nt&&(nt.parent&&nt.parent.isBone?(nt.matrix.copy(nt.parent.matrixWorld).invert(),nt.matrix.multiply(nt.matrixWorld)):nt.matrix.copy(nt.matrixWorld),nt.matrix.decompose(nt.position,nt.quaternion,nt.scale))}}update(){const _e=this.bones,rt=this.boneInverses,nt=this.boneMatrices,it=this.boneTexture;for(let st=0,ot=_e.length;st<ot;st++){const lt=_e[st]?_e[st].matrixWorld:_identityMatrix$2;_offsetMatrix.multiplyMatrices(lt,rt[st]),_offsetMatrix.toArray(nt,st*16)}it!==null&&(it.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _e=Math.sqrt(this.bones.length*4);_e=ceilPowerOfTwo(_e),_e=Math.max(_e,4);const rt=new Float32Array(_e*_e*4);rt.set(this.boneMatrices);const nt=new DataTexture(rt,_e,_e,RGBAFormat,FloatType);return nt.needsUpdate=!0,this.boneMatrices=rt,this.boneTexture=nt,this.boneTextureSize=_e,this}getBoneByName(_e){for(let rt=0,nt=this.bones.length;rt<nt;rt++){const it=this.bones[rt];if(it.name===_e)return it}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_e,rt){this.uuid=_e.uuid;for(let nt=0,it=_e.bones.length;nt<it;nt++){const st=_e.bones[nt];let ot=rt[st];ot===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",st),ot=new Bone),this.bones.push(ot),this.boneInverses.push(new Matrix4().fromArray(_e.boneInverses[nt]))}return this.init(),this}toJSON(){const _e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_e.uuid=this.uuid;const rt=this.bones,nt=this.boneInverses;for(let it=0,st=rt.length;it<st;it++){const ot=rt[it];_e.bones.push(ot.uuid);const lt=nt[it];_e.boneInverses.push(lt.toArray())}return _e}}class InstancedBufferAttribute extends BufferAttribute{constructor(_e,rt,nt,it=1){super(_e,rt,nt),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=it}copy(_e){return super.copy(_e),this.meshPerAttribute=_e.meshPerAttribute,this}toJSON(){const _e=super.toJSON();return _e.meshPerAttribute=this.meshPerAttribute,_e.isInstancedBufferAttribute=!0,_e}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh=new Mesh,_sphere$2=new Sphere;class InstancedMesh extends Mesh{constructor(_e,rt,nt){super(_e,rt),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(nt*16),16),this.instanceColor=null,this.count=nt,this.boundingBox=null,this.boundingSphere=null;for(let it=0;it<nt;it++)this.setMatrixAt(it,_identity)}computeBoundingBox(){const _e=this.geometry,rt=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),_e.boundingBox===null&&_e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let nt=0;nt<rt;nt++)this.getMatrixAt(nt,_instanceLocalMatrix),_box3.copy(_e.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const _e=this.geometry,rt=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),_e.boundingSphere===null&&_e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let nt=0;nt<rt;nt++)this.getMatrixAt(nt,_instanceLocalMatrix),_sphere$2.copy(_e.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$2)}copy(_e,rt){return super.copy(_e,rt),this.instanceMatrix.copy(_e.instanceMatrix),_e.instanceColor!==null&&(this.instanceColor=_e.instanceColor.clone()),this.count=_e.count,_e.boundingBox!==null&&(this.boundingBox=_e.boundingBox.clone()),_e.boundingSphere!==null&&(this.boundingSphere=_e.boundingSphere.clone()),this}getColorAt(_e,rt){rt.fromArray(this.instanceColor.array,_e*3)}getMatrixAt(_e,rt){rt.fromArray(this.instanceMatrix.array,_e*16)}raycast(_e,rt){const nt=this.matrixWorld,it=this.count;if(_mesh.geometry=this.geometry,_mesh.material=this.material,_mesh.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$2.copy(this.boundingSphere),_sphere$2.applyMatrix4(nt),_e.ray.intersectsSphere(_sphere$2)!==!1))for(let st=0;st<it;st++){this.getMatrixAt(st,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(nt,_instanceLocalMatrix),_mesh.matrixWorld=_instanceWorldMatrix,_mesh.raycast(_e,_instanceIntersects);for(let ot=0,lt=_instanceIntersects.length;ot<lt;ot++){const at=_instanceIntersects[ot];at.instanceId=st,at.object=this,rt.push(at)}_instanceIntersects.length=0}}setColorAt(_e,rt){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3),3)),rt.toArray(this.instanceColor.array,_e*3)}setMatrixAt(_e,rt){rt.toArray(this.instanceMatrix.array,_e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class LineBasicMaterial extends Material{constructor(_e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.linewidth=_e.linewidth,this.linecap=_e.linecap,this.linejoin=_e.linejoin,this.fog=_e.fog,this}}const _start$1=new Vector3,_end$1=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray$1,_sphere$1=new Sphere;class Line extends Object3D{constructor(_e=new BufferGeometry,rt=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=_e,this.material=rt,this.updateMorphTargets()}copy(_e,rt){return super.copy(_e,rt),this.material=_e.material,this.geometry=_e.geometry,this}computeLineDistances(){const _e=this.geometry;if(_e.index===null){const rt=_e.attributes.position,nt=[0];for(let it=1,st=rt.count;it<st;it++)_start$1.fromBufferAttribute(rt,it-1),_end$1.fromBufferAttribute(rt,it),nt[it]=nt[it-1],nt[it]+=_start$1.distanceTo(_end$1);_e.setAttribute("lineDistance",new Float32BufferAttribute(nt,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_e,rt){const nt=this.geometry,it=this.matrixWorld,st=_e.params.Line.threshold,ot=nt.drawRange;if(nt.boundingSphere===null&&nt.computeBoundingSphere(),_sphere$1.copy(nt.boundingSphere),_sphere$1.applyMatrix4(it),_sphere$1.radius+=st,_e.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(it).invert(),_ray$1.copy(_e.ray).applyMatrix4(_inverseMatrix$1);const lt=st/((this.scale.x+this.scale.y+this.scale.z)/3),at=lt*lt,ct=new Vector3,ut=new Vector3,ht=new Vector3,dt=new Vector3,ft=this.isLineSegments?2:1,pt=nt.index,gt=nt.attributes.position;if(pt!==null){const vt=Math.max(0,ot.start),At=Math.min(pt.count,ot.start+ot.count);for(let yt=vt,xt=At-1;yt<xt;yt+=ft){const _t=pt.getX(yt),Et=pt.getX(yt+1);if(ct.fromBufferAttribute(gt,_t),ut.fromBufferAttribute(gt,Et),_ray$1.distanceSqToSegment(ct,ut,dt,ht)>at)continue;dt.applyMatrix4(this.matrixWorld);const wt=_e.ray.origin.distanceTo(dt);wt<_e.near||wt>_e.far||rt.push({distance:wt,point:ht.clone().applyMatrix4(this.matrixWorld),index:yt,face:null,faceIndex:null,object:this})}}else{const vt=Math.max(0,ot.start),At=Math.min(gt.count,ot.start+ot.count);for(let yt=vt,xt=At-1;yt<xt;yt+=ft){if(ct.fromBufferAttribute(gt,yt),ut.fromBufferAttribute(gt,yt+1),_ray$1.distanceSqToSegment(ct,ut,dt,ht)>at)continue;dt.applyMatrix4(this.matrixWorld);const Et=_e.ray.origin.distanceTo(dt);Et<_e.near||Et>_e.far||rt.push({distance:Et,point:ht.clone().applyMatrix4(this.matrixWorld),index:yt,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const rt=this.geometry.morphAttributes,nt=Object.keys(rt);if(nt.length>0){const it=rt[nt[0]];if(it!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,ot=it.length;st<ot;st++){const lt=it[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[lt]=st}}}}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(_e,rt){super(_e,rt),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _e=this.geometry;if(_e.index===null){const rt=_e.attributes.position,nt=[];for(let it=0,st=rt.count;it<st;it+=2)_start.fromBufferAttribute(rt,it),_end.fromBufferAttribute(rt,it+1),nt[it]=it===0?0:nt[it-1],nt[it+1]=nt[it]+_start.distanceTo(_end);_e.setAttribute("lineDistance",new Float32BufferAttribute(nt,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(_e,rt){super(_e,rt),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(_e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.alphaMap=_e.alphaMap,this.size=_e.size,this.sizeAttenuation=_e.sizeAttenuation,this.fog=_e.fog,this}}const _inverseMatrix=new Matrix4,_ray=new Ray$1,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(_e=new BufferGeometry,rt=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=_e,this.material=rt,this.updateMorphTargets()}copy(_e,rt){return super.copy(_e,rt),this.material=_e.material,this.geometry=_e.geometry,this}raycast(_e,rt){const nt=this.geometry,it=this.matrixWorld,st=_e.params.Points.threshold,ot=nt.drawRange;if(nt.boundingSphere===null&&nt.computeBoundingSphere(),_sphere.copy(nt.boundingSphere),_sphere.applyMatrix4(it),_sphere.radius+=st,_e.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(it).invert(),_ray.copy(_e.ray).applyMatrix4(_inverseMatrix);const lt=st/((this.scale.x+this.scale.y+this.scale.z)/3),at=lt*lt,ct=nt.index,ht=nt.attributes.position;if(ct!==null){const dt=Math.max(0,ot.start),ft=Math.min(ct.count,ot.start+ot.count);for(let pt=dt,mt=ft;pt<mt;pt++){const gt=ct.getX(pt);_position$2.fromBufferAttribute(ht,gt),testPoint(_position$2,gt,at,it,_e,rt,this)}}else{const dt=Math.max(0,ot.start),ft=Math.min(ht.count,ot.start+ot.count);for(let pt=dt,mt=ft;pt<mt;pt++)_position$2.fromBufferAttribute(ht,pt),testPoint(_position$2,pt,at,it,_e,rt,this)}}updateMorphTargets(){const rt=this.geometry.morphAttributes,nt=Object.keys(rt);if(nt.length>0){const it=rt[nt[0]];if(it!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,ot=it.length;st<ot;st++){const lt=it[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[lt]=st}}}}}function testPoint(tt,_e,rt,nt,it,st,ot){const lt=_ray.distanceSqToPoint(tt);if(lt<rt){const at=new Vector3;_ray.closestPointToPoint(tt,at),at.applyMatrix4(nt);const ct=it.ray.origin.distanceTo(at);if(ct<it.near||ct>it.far)return;st.push({distance:ct,distanceToRay:Math.sqrt(lt),point:at,index:_e,face:null,object:ot})}}class VideoTexture extends Texture{constructor(_e,rt,nt,it,st,ot,lt,at,ct){super(_e,rt,nt,it,st,ot,lt,at,ct),this.isVideoTexture=!0,this.minFilter=ot!==void 0?ot:LinearFilter,this.magFilter=st!==void 0?st:LinearFilter,this.generateMipmaps=!1;const ut=this;function ht(){ut.needsUpdate=!0,_e.requestVideoFrameCallback(ht)}"requestVideoFrameCallback"in _e&&_e.requestVideoFrameCallback(ht)}clone(){return new this.constructor(this.image).copy(this)}update(){const _e=this.image;"requestVideoFrameCallback"in _e===!1&&_e.readyState>=_e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class FramebufferTexture extends Texture{constructor(_e,rt){super({width:_e,height:rt}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture{constructor(_e,rt,nt,it,st,ot,lt,at,ct,ut,ht,dt){super(null,ot,lt,at,ct,ut,it,st,ht,dt),this.isCompressedTexture=!0,this.image={width:rt,height:nt},this.mipmaps=_e,this.flipY=!1,this.generateMipmaps=!1}}let CompressedArrayTexture$1=class extends CompressedTexture{constructor(_e,rt,nt,it,st,ot){super(_e,rt,nt,st,ot),this.isCompressedArrayTexture=!0,this.image.depth=it,this.wrapR=ClampToEdgeWrapping}};class CanvasTexture extends Texture{constructor(_e,rt,nt,it,st,ot,lt,at,ct){super(_e,rt,nt,it,st,ot,lt,at,ct),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(_e,rt){const nt=this.getUtoTmapping(_e);return this.getPoint(nt,rt)}getPoints(_e=5){const rt=[];for(let nt=0;nt<=_e;nt++)rt.push(this.getPoint(nt/_e));return rt}getSpacedPoints(_e=5){const rt=[];for(let nt=0;nt<=_e;nt++)rt.push(this.getPointAt(nt/_e));return rt}getLength(){const _e=this.getLengths();return _e[_e.length-1]}getLengths(_e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const rt=[];let nt,it=this.getPoint(0),st=0;rt.push(0);for(let ot=1;ot<=_e;ot++)nt=this.getPoint(ot/_e),st+=nt.distanceTo(it),rt.push(st),it=nt;return this.cacheArcLengths=rt,rt}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_e,rt){const nt=this.getLengths();let it=0;const st=nt.length;let ot;rt?ot=rt:ot=_e*nt[st-1];let lt=0,at=st-1,ct;for(;lt<=at;)if(it=Math.floor(lt+(at-lt)/2),ct=nt[it]-ot,ct<0)lt=it+1;else if(ct>0)at=it-1;else{at=it;break}if(it=at,nt[it]===ot)return it/(st-1);const ut=nt[it],dt=nt[it+1]-ut,ft=(ot-ut)/dt;return(it+ft)/(st-1)}getTangent(_e,rt){let it=_e-1e-4,st=_e+1e-4;it<0&&(it=0),st>1&&(st=1);const ot=this.getPoint(it),lt=this.getPoint(st),at=rt||(ot.isVector2?new Vector2:new Vector3);return at.copy(lt).sub(ot).normalize(),at}getTangentAt(_e,rt){const nt=this.getUtoTmapping(_e);return this.getTangent(nt,rt)}computeFrenetFrames(_e,rt){const nt=new Vector3,it=[],st=[],ot=[],lt=new Vector3,at=new Matrix4;for(let ft=0;ft<=_e;ft++){const pt=ft/_e;it[ft]=this.getTangentAt(pt,new Vector3)}st[0]=new Vector3,ot[0]=new Vector3;let ct=Number.MAX_VALUE;const ut=Math.abs(it[0].x),ht=Math.abs(it[0].y),dt=Math.abs(it[0].z);ut<=ct&&(ct=ut,nt.set(1,0,0)),ht<=ct&&(ct=ht,nt.set(0,1,0)),dt<=ct&&nt.set(0,0,1),lt.crossVectors(it[0],nt).normalize(),st[0].crossVectors(it[0],lt),ot[0].crossVectors(it[0],st[0]);for(let ft=1;ft<=_e;ft++){if(st[ft]=st[ft-1].clone(),ot[ft]=ot[ft-1].clone(),lt.crossVectors(it[ft-1],it[ft]),lt.length()>Number.EPSILON){lt.normalize();const pt=Math.acos(clamp$2(it[ft-1].dot(it[ft]),-1,1));st[ft].applyMatrix4(at.makeRotationAxis(lt,pt))}ot[ft].crossVectors(it[ft],st[ft])}if(rt===!0){let ft=Math.acos(clamp$2(st[0].dot(st[_e]),-1,1));ft/=_e,it[0].dot(lt.crossVectors(st[0],st[_e]))>0&&(ft=-ft);for(let pt=1;pt<=_e;pt++)st[pt].applyMatrix4(at.makeRotationAxis(it[pt],ft*pt)),ot[pt].crossVectors(it[pt],st[pt])}return{tangents:it,normals:st,binormals:ot}}clone(){return new this.constructor().copy(this)}copy(_e){return this.arcLengthDivisions=_e.arcLengthDivisions,this}toJSON(){const _e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return _e.arcLengthDivisions=this.arcLengthDivisions,_e.type=this.type,_e}fromJSON(_e){return this.arcLengthDivisions=_e.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(_e=0,rt=0,nt=1,it=1,st=0,ot=Math.PI*2,lt=!1,at=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_e,this.aY=rt,this.xRadius=nt,this.yRadius=it,this.aStartAngle=st,this.aEndAngle=ot,this.aClockwise=lt,this.aRotation=at}getPoint(_e,rt){const nt=rt||new Vector2,it=Math.PI*2;let st=this.aEndAngle-this.aStartAngle;const ot=Math.abs(st)<Number.EPSILON;for(;st<0;)st+=it;for(;st>it;)st-=it;st<Number.EPSILON&&(ot?st=0:st=it),this.aClockwise===!0&&!ot&&(st===it?st=-it:st=st-it);const lt=this.aStartAngle+_e*st;let at=this.aX+this.xRadius*Math.cos(lt),ct=this.aY+this.yRadius*Math.sin(lt);if(this.aRotation!==0){const ut=Math.cos(this.aRotation),ht=Math.sin(this.aRotation),dt=at-this.aX,ft=ct-this.aY;at=dt*ut-ft*ht+this.aX,ct=dt*ht+ft*ut+this.aY}return nt.set(at,ct)}copy(_e){return super.copy(_e),this.aX=_e.aX,this.aY=_e.aY,this.xRadius=_e.xRadius,this.yRadius=_e.yRadius,this.aStartAngle=_e.aStartAngle,this.aEndAngle=_e.aEndAngle,this.aClockwise=_e.aClockwise,this.aRotation=_e.aRotation,this}toJSON(){const _e=super.toJSON();return _e.aX=this.aX,_e.aY=this.aY,_e.xRadius=this.xRadius,_e.yRadius=this.yRadius,_e.aStartAngle=this.aStartAngle,_e.aEndAngle=this.aEndAngle,_e.aClockwise=this.aClockwise,_e.aRotation=this.aRotation,_e}fromJSON(_e){return super.fromJSON(_e),this.aX=_e.aX,this.aY=_e.aY,this.xRadius=_e.xRadius,this.yRadius=_e.yRadius,this.aStartAngle=_e.aStartAngle,this.aEndAngle=_e.aEndAngle,this.aClockwise=_e.aClockwise,this.aRotation=_e.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(_e,rt,nt,it,st,ot){super(_e,rt,nt,nt,it,st,ot),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let tt=0,_e=0,rt=0,nt=0;function it(st,ot,lt,at){tt=st,_e=lt,rt=-3*st+3*ot-2*lt-at,nt=2*st-2*ot+lt+at}return{initCatmullRom:function(st,ot,lt,at,ct){it(ot,lt,ct*(lt-st),ct*(at-ot))},initNonuniformCatmullRom:function(st,ot,lt,at,ct,ut,ht){let dt=(ot-st)/ct-(lt-st)/(ct+ut)+(lt-ot)/ut,ft=(lt-ot)/ut-(at-ot)/(ut+ht)+(at-lt)/ht;dt*=ut,ft*=ut,it(ot,lt,dt,ft)},calc:function(st){const ot=st*st,lt=ot*st;return tt+_e*st+rt*ot+nt*lt}}}const tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(_e=[],rt=!1,nt="centripetal",it=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_e,this.closed=rt,this.curveType=nt,this.tension=it}getPoint(_e,rt=new Vector3){const nt=rt,it=this.points,st=it.length,ot=(st-(this.closed?0:1))*_e;let lt=Math.floor(ot),at=ot-lt;this.closed?lt+=lt>0?0:(Math.floor(Math.abs(lt)/st)+1)*st:at===0&&lt===st-1&&(lt=st-2,at=1);let ct,ut;this.closed||lt>0?ct=it[(lt-1)%st]:(tmp.subVectors(it[0],it[1]).add(it[0]),ct=tmp);const ht=it[lt%st],dt=it[(lt+1)%st];if(this.closed||lt+2<st?ut=it[(lt+2)%st]:(tmp.subVectors(it[st-1],it[st-2]).add(it[st-1]),ut=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const ft=this.curveType==="chordal"?.5:.25;let pt=Math.pow(ct.distanceToSquared(ht),ft),mt=Math.pow(ht.distanceToSquared(dt),ft),gt=Math.pow(dt.distanceToSquared(ut),ft);mt<1e-4&&(mt=1),pt<1e-4&&(pt=mt),gt<1e-4&&(gt=mt),px.initNonuniformCatmullRom(ct.x,ht.x,dt.x,ut.x,pt,mt,gt),py.initNonuniformCatmullRom(ct.y,ht.y,dt.y,ut.y,pt,mt,gt),pz.initNonuniformCatmullRom(ct.z,ht.z,dt.z,ut.z,pt,mt,gt)}else this.curveType==="catmullrom"&&(px.initCatmullRom(ct.x,ht.x,dt.x,ut.x,this.tension),py.initCatmullRom(ct.y,ht.y,dt.y,ut.y,this.tension),pz.initCatmullRom(ct.z,ht.z,dt.z,ut.z,this.tension));return nt.set(px.calc(at),py.calc(at),pz.calc(at)),nt}copy(_e){super.copy(_e),this.points=[];for(let rt=0,nt=_e.points.length;rt<nt;rt++){const it=_e.points[rt];this.points.push(it.clone())}return this.closed=_e.closed,this.curveType=_e.curveType,this.tension=_e.tension,this}toJSON(){const _e=super.toJSON();_e.points=[];for(let rt=0,nt=this.points.length;rt<nt;rt++){const it=this.points[rt];_e.points.push(it.toArray())}return _e.closed=this.closed,_e.curveType=this.curveType,_e.tension=this.tension,_e}fromJSON(_e){super.fromJSON(_e),this.points=[];for(let rt=0,nt=_e.points.length;rt<nt;rt++){const it=_e.points[rt];this.points.push(new Vector3().fromArray(it))}return this.closed=_e.closed,this.curveType=_e.curveType,this.tension=_e.tension,this}}function CatmullRom(tt,_e,rt,nt,it){const st=(nt-_e)*.5,ot=(it-rt)*.5,lt=tt*tt,at=tt*lt;return(2*rt-2*nt+st+ot)*at+(-3*rt+3*nt-2*st-ot)*lt+st*tt+rt}function QuadraticBezierP0(tt,_e){const rt=1-tt;return rt*rt*_e}function QuadraticBezierP1(tt,_e){return 2*(1-tt)*tt*_e}function QuadraticBezierP2(tt,_e){return tt*tt*_e}function QuadraticBezier(tt,_e,rt,nt){return QuadraticBezierP0(tt,_e)+QuadraticBezierP1(tt,rt)+QuadraticBezierP2(tt,nt)}function CubicBezierP0(tt,_e){const rt=1-tt;return rt*rt*rt*_e}function CubicBezierP1(tt,_e){const rt=1-tt;return 3*rt*rt*tt*_e}function CubicBezierP2(tt,_e){return 3*(1-tt)*tt*tt*_e}function CubicBezierP3(tt,_e){return tt*tt*tt*_e}function CubicBezier(tt,_e,rt,nt,it){return CubicBezierP0(tt,_e)+CubicBezierP1(tt,rt)+CubicBezierP2(tt,nt)+CubicBezierP3(tt,it)}class CubicBezierCurve extends Curve{constructor(_e=new Vector2,rt=new Vector2,nt=new Vector2,it=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_e,this.v1=rt,this.v2=nt,this.v3=it}getPoint(_e,rt=new Vector2){const nt=rt,it=this.v0,st=this.v1,ot=this.v2,lt=this.v3;return nt.set(CubicBezier(_e,it.x,st.x,ot.x,lt.x),CubicBezier(_e,it.y,st.y,ot.y,lt.y)),nt}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this.v3.copy(_e.v3),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e.v3=this.v3.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this.v3.fromArray(_e.v3),this}}class CubicBezierCurve3 extends Curve{constructor(_e=new Vector3,rt=new Vector3,nt=new Vector3,it=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_e,this.v1=rt,this.v2=nt,this.v3=it}getPoint(_e,rt=new Vector3){const nt=rt,it=this.v0,st=this.v1,ot=this.v2,lt=this.v3;return nt.set(CubicBezier(_e,it.x,st.x,ot.x,lt.x),CubicBezier(_e,it.y,st.y,ot.y,lt.y),CubicBezier(_e,it.z,st.z,ot.z,lt.z)),nt}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this.v3.copy(_e.v3),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e.v3=this.v3.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this.v3.fromArray(_e.v3),this}}class LineCurve extends Curve{constructor(_e=new Vector2,rt=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_e,this.v2=rt}getPoint(_e,rt=new Vector2){const nt=rt;return _e===1?nt.copy(this.v2):(nt.copy(this.v2).sub(this.v1),nt.multiplyScalar(_e).add(this.v1)),nt}getPointAt(_e,rt){return this.getPoint(_e,rt)}getTangent(_e,rt=new Vector2){return rt.subVectors(this.v2,this.v1).normalize()}getTangentAt(_e,rt){return this.getTangent(_e,rt)}copy(_e){return super.copy(_e),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class LineCurve3 extends Curve{constructor(_e=new Vector3,rt=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_e,this.v2=rt}getPoint(_e,rt=new Vector3){const nt=rt;return _e===1?nt.copy(this.v2):(nt.copy(this.v2).sub(this.v1),nt.multiplyScalar(_e).add(this.v1)),nt}getPointAt(_e,rt){return this.getPoint(_e,rt)}getTangent(_e,rt=new Vector3){return rt.subVectors(this.v2,this.v1).normalize()}getTangentAt(_e,rt){return this.getTangent(_e,rt)}copy(_e){return super.copy(_e),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class QuadraticBezierCurve extends Curve{constructor(_e=new Vector2,rt=new Vector2,nt=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_e,this.v1=rt,this.v2=nt}getPoint(_e,rt=new Vector2){const nt=rt,it=this.v0,st=this.v1,ot=this.v2;return nt.set(QuadraticBezier(_e,it.x,st.x,ot.x),QuadraticBezier(_e,it.y,st.y,ot.y)),nt}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(_e=new Vector3,rt=new Vector3,nt=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_e,this.v1=rt,this.v2=nt}getPoint(_e,rt=new Vector3){const nt=rt,it=this.v0,st=this.v1,ot=this.v2;return nt.set(QuadraticBezier(_e,it.x,st.x,ot.x),QuadraticBezier(_e,it.y,st.y,ot.y),QuadraticBezier(_e,it.z,st.z,ot.z)),nt}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class SplineCurve extends Curve{constructor(_e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_e}getPoint(_e,rt=new Vector2){const nt=rt,it=this.points,st=(it.length-1)*_e,ot=Math.floor(st),lt=st-ot,at=it[ot===0?ot:ot-1],ct=it[ot],ut=it[ot>it.length-2?it.length-1:ot+1],ht=it[ot>it.length-3?it.length-1:ot+2];return nt.set(CatmullRom(lt,at.x,ct.x,ut.x,ht.x),CatmullRom(lt,at.y,ct.y,ut.y,ht.y)),nt}copy(_e){super.copy(_e),this.points=[];for(let rt=0,nt=_e.points.length;rt<nt;rt++){const it=_e.points[rt];this.points.push(it.clone())}return this}toJSON(){const _e=super.toJSON();_e.points=[];for(let rt=0,nt=this.points.length;rt<nt;rt++){const it=this.points[rt];_e.points.push(it.toArray())}return _e}fromJSON(_e){super.fromJSON(_e),this.points=[];for(let rt=0,nt=_e.points.length;rt<nt;rt++){const it=_e.points[rt];this.points.push(new Vector2().fromArray(it))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_e){this.curves.push(_e)}closePath(){const _e=this.curves[0].getPoint(0),rt=this.curves[this.curves.length-1].getPoint(1);_e.equals(rt)||this.curves.push(new LineCurve(rt,_e))}getPoint(_e,rt){const nt=_e*this.getLength(),it=this.getCurveLengths();let st=0;for(;st<it.length;){if(it[st]>=nt){const ot=it[st]-nt,lt=this.curves[st],at=lt.getLength(),ct=at===0?0:1-ot/at;return lt.getPointAt(ct,rt)}st++}return null}getLength(){const _e=this.getCurveLengths();return _e[_e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _e=[];let rt=0;for(let nt=0,it=this.curves.length;nt<it;nt++)rt+=this.curves[nt].getLength(),_e.push(rt);return this.cacheLengths=_e,_e}getSpacedPoints(_e=40){const rt=[];for(let nt=0;nt<=_e;nt++)rt.push(this.getPoint(nt/_e));return this.autoClose&&rt.push(rt[0]),rt}getPoints(_e=12){const rt=[];let nt;for(let it=0,st=this.curves;it<st.length;it++){const ot=st[it],lt=ot.isEllipseCurve?_e*2:ot.isLineCurve||ot.isLineCurve3?1:ot.isSplineCurve?_e*ot.points.length:_e,at=ot.getPoints(lt);for(let ct=0;ct<at.length;ct++){const ut=at[ct];nt&&nt.equals(ut)||(rt.push(ut),nt=ut)}}return this.autoClose&&rt.length>1&&!rt[rt.length-1].equals(rt[0])&&rt.push(rt[0]),rt}copy(_e){super.copy(_e),this.curves=[];for(let rt=0,nt=_e.curves.length;rt<nt;rt++){const it=_e.curves[rt];this.curves.push(it.clone())}return this.autoClose=_e.autoClose,this}toJSON(){const _e=super.toJSON();_e.autoClose=this.autoClose,_e.curves=[];for(let rt=0,nt=this.curves.length;rt<nt;rt++){const it=this.curves[rt];_e.curves.push(it.toJSON())}return _e}fromJSON(_e){super.fromJSON(_e),this.autoClose=_e.autoClose,this.curves=[];for(let rt=0,nt=_e.curves.length;rt<nt;rt++){const it=_e.curves[rt];this.curves.push(new Curves[it.type]().fromJSON(it))}return this}}let Path$1=class extends CurvePath{constructor(_e){super(),this.type="Path",this.currentPoint=new Vector2,_e&&this.setFromPoints(_e)}setFromPoints(_e){this.moveTo(_e[0].x,_e[0].y);for(let rt=1,nt=_e.length;rt<nt;rt++)this.lineTo(_e[rt].x,_e[rt].y);return this}moveTo(_e,rt){return this.currentPoint.set(_e,rt),this}lineTo(_e,rt){const nt=new LineCurve(this.currentPoint.clone(),new Vector2(_e,rt));return this.curves.push(nt),this.currentPoint.set(_e,rt),this}quadraticCurveTo(_e,rt,nt,it){const st=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(_e,rt),new Vector2(nt,it));return this.curves.push(st),this.currentPoint.set(nt,it),this}bezierCurveTo(_e,rt,nt,it,st,ot){const lt=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(_e,rt),new Vector2(nt,it),new Vector2(st,ot));return this.curves.push(lt),this.currentPoint.set(st,ot),this}splineThru(_e){const rt=[this.currentPoint.clone()].concat(_e),nt=new SplineCurve(rt);return this.curves.push(nt),this.currentPoint.copy(_e[_e.length-1]),this}arc(_e,rt,nt,it,st,ot){const lt=this.currentPoint.x,at=this.currentPoint.y;return this.absarc(_e+lt,rt+at,nt,it,st,ot),this}absarc(_e,rt,nt,it,st,ot){return this.absellipse(_e,rt,nt,nt,it,st,ot),this}ellipse(_e,rt,nt,it,st,ot,lt,at){const ct=this.currentPoint.x,ut=this.currentPoint.y;return this.absellipse(_e+ct,rt+ut,nt,it,st,ot,lt,at),this}absellipse(_e,rt,nt,it,st,ot,lt,at){const ct=new EllipseCurve(_e,rt,nt,it,st,ot,lt,at);if(this.curves.length>0){const ht=ct.getPoint(0);ht.equals(this.currentPoint)||this.lineTo(ht.x,ht.y)}this.curves.push(ct);const ut=ct.getPoint(1);return this.currentPoint.copy(ut),this}copy(_e){return super.copy(_e),this.currentPoint.copy(_e.currentPoint),this}toJSON(){const _e=super.toJSON();return _e.currentPoint=this.currentPoint.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.currentPoint.fromArray(_e.currentPoint),this}};class LatheGeometry extends BufferGeometry{constructor(_e=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],rt=12,nt=0,it=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:_e,segments:rt,phiStart:nt,phiLength:it},rt=Math.floor(rt),it=clamp$2(it,0,Math.PI*2);const st=[],ot=[],lt=[],at=[],ct=[],ut=1/rt,ht=new Vector3,dt=new Vector2,ft=new Vector3,pt=new Vector3,mt=new Vector3;let gt=0,vt=0;for(let At=0;At<=_e.length-1;At++)switch(At){case 0:gt=_e[At+1].x-_e[At].x,vt=_e[At+1].y-_e[At].y,ft.x=vt*1,ft.y=-gt,ft.z=vt*0,mt.copy(ft),ft.normalize(),at.push(ft.x,ft.y,ft.z);break;case _e.length-1:at.push(mt.x,mt.y,mt.z);break;default:gt=_e[At+1].x-_e[At].x,vt=_e[At+1].y-_e[At].y,ft.x=vt*1,ft.y=-gt,ft.z=vt*0,pt.copy(ft),ft.x+=mt.x,ft.y+=mt.y,ft.z+=mt.z,ft.normalize(),at.push(ft.x,ft.y,ft.z),mt.copy(pt)}for(let At=0;At<=rt;At++){const yt=nt+At*ut*it,xt=Math.sin(yt),_t=Math.cos(yt);for(let Et=0;Et<=_e.length-1;Et++){ht.x=_e[Et].x*xt,ht.y=_e[Et].y,ht.z=_e[Et].x*_t,ot.push(ht.x,ht.y,ht.z),dt.x=At/rt,dt.y=Et/(_e.length-1),lt.push(dt.x,dt.y);const bt=at[3*Et+0]*xt,wt=at[3*Et+1],Tt=at[3*Et+0]*_t;ct.push(bt,wt,Tt)}}for(let At=0;At<rt;At++)for(let yt=0;yt<_e.length-1;yt++){const xt=yt+At*_e.length,_t=xt,Et=xt+_e.length,bt=xt+_e.length+1,wt=xt+1;st.push(_t,Et,wt),st.push(bt,wt,Et)}this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute(ot,3)),this.setAttribute("uv",new Float32BufferAttribute(lt,2)),this.setAttribute("normal",new Float32BufferAttribute(ct,3))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new LatheGeometry(_e.points,_e.segments,_e.phiStart,_e.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(_e=1,rt=1,nt=4,it=8){const st=new Path$1;st.absarc(0,-rt/2,_e,Math.PI*1.5,0),st.absarc(0,rt/2,_e,0,Math.PI*.5),super(st.getPoints(nt),it),this.type="CapsuleGeometry",this.parameters={radius:_e,height:rt,capSegments:nt,radialSegments:it}}static fromJSON(_e){return new CapsuleGeometry(_e.radius,_e.length,_e.capSegments,_e.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(_e=1,rt=32,nt=0,it=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:_e,segments:rt,thetaStart:nt,thetaLength:it},rt=Math.max(3,rt);const st=[],ot=[],lt=[],at=[],ct=new Vector3,ut=new Vector2;ot.push(0,0,0),lt.push(0,0,1),at.push(.5,.5);for(let ht=0,dt=3;ht<=rt;ht++,dt+=3){const ft=nt+ht/rt*it;ct.x=_e*Math.cos(ft),ct.y=_e*Math.sin(ft),ot.push(ct.x,ct.y,ct.z),lt.push(0,0,1),ut.x=(ot[dt]/_e+1)/2,ut.y=(ot[dt+1]/_e+1)/2,at.push(ut.x,ut.y)}for(let ht=1;ht<=rt;ht++)st.push(ht,ht+1,0);this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute(ot,3)),this.setAttribute("normal",new Float32BufferAttribute(lt,3)),this.setAttribute("uv",new Float32BufferAttribute(at,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new CircleGeometry(_e.radius,_e.segments,_e.thetaStart,_e.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(_e=1,rt=1,nt=1,it=32,st=1,ot=!1,lt=0,at=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_e,radiusBottom:rt,height:nt,radialSegments:it,heightSegments:st,openEnded:ot,thetaStart:lt,thetaLength:at};const ct=this;it=Math.floor(it),st=Math.floor(st);const ut=[],ht=[],dt=[],ft=[];let pt=0;const mt=[],gt=nt/2;let vt=0;At(),ot===!1&&(_e>0&&yt(!0),rt>0&&yt(!1)),this.setIndex(ut),this.setAttribute("position",new Float32BufferAttribute(ht,3)),this.setAttribute("normal",new Float32BufferAttribute(dt,3)),this.setAttribute("uv",new Float32BufferAttribute(ft,2));function At(){const xt=new Vector3,_t=new Vector3;let Et=0;const bt=(rt-_e)/nt;for(let wt=0;wt<=st;wt++){const Tt=[],Mt=wt/st,Pt=Mt*(rt-_e)+_e;for(let It=0;It<=it;It++){const Ot=It/it,Bt=Ot*at+lt,Ut=Math.sin(Bt),Ft=Math.cos(Bt);_t.x=Pt*Ut,_t.y=-Mt*nt+gt,_t.z=Pt*Ft,ht.push(_t.x,_t.y,_t.z),xt.set(Ut,bt,Ft).normalize(),dt.push(xt.x,xt.y,xt.z),ft.push(Ot,1-Mt),Tt.push(pt++)}mt.push(Tt)}for(let wt=0;wt<it;wt++)for(let Tt=0;Tt<st;Tt++){const Mt=mt[Tt][wt],Pt=mt[Tt+1][wt],It=mt[Tt+1][wt+1],Ot=mt[Tt][wt+1];ut.push(Mt,Pt,Ot),ut.push(Pt,It,Ot),Et+=6}ct.addGroup(vt,Et,0),vt+=Et}function yt(xt){const _t=pt,Et=new Vector2,bt=new Vector3;let wt=0;const Tt=xt===!0?_e:rt,Mt=xt===!0?1:-1;for(let It=1;It<=it;It++)ht.push(0,gt*Mt,0),dt.push(0,Mt,0),ft.push(.5,.5),pt++;const Pt=pt;for(let It=0;It<=it;It++){const Bt=It/it*at+lt,Ut=Math.cos(Bt),Ft=Math.sin(Bt);bt.x=Tt*Ft,bt.y=gt*Mt,bt.z=Tt*Ut,ht.push(bt.x,bt.y,bt.z),dt.push(0,Mt,0),Et.x=Ut*.5+.5,Et.y=Ft*.5*Mt+.5,ft.push(Et.x,Et.y),pt++}for(let It=0;It<it;It++){const Ot=_t+It,Bt=Pt+It;xt===!0?ut.push(Bt,Bt+1,Ot):ut.push(Bt+1,Bt,Ot),wt+=3}ct.addGroup(vt,wt,xt===!0?1:2),vt+=wt}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new CylinderGeometry(_e.radiusTop,_e.radiusBottom,_e.height,_e.radialSegments,_e.heightSegments,_e.openEnded,_e.thetaStart,_e.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(_e=1,rt=1,nt=32,it=1,st=!1,ot=0,lt=Math.PI*2){super(0,_e,rt,nt,it,st,ot,lt),this.type="ConeGeometry",this.parameters={radius:_e,height:rt,radialSegments:nt,heightSegments:it,openEnded:st,thetaStart:ot,thetaLength:lt}}static fromJSON(_e){return new ConeGeometry(_e.radius,_e.height,_e.radialSegments,_e.heightSegments,_e.openEnded,_e.thetaStart,_e.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(_e=[],rt=[],nt=1,it=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_e,indices:rt,radius:nt,detail:it};const st=[],ot=[];lt(it),ct(nt),ut(),this.setAttribute("position",new Float32BufferAttribute(st,3)),this.setAttribute("normal",new Float32BufferAttribute(st.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(ot,2)),it===0?this.computeVertexNormals():this.normalizeNormals();function lt(At){const yt=new Vector3,xt=new Vector3,_t=new Vector3;for(let Et=0;Et<rt.length;Et+=3)ft(rt[Et+0],yt),ft(rt[Et+1],xt),ft(rt[Et+2],_t),at(yt,xt,_t,At)}function at(At,yt,xt,_t){const Et=_t+1,bt=[];for(let wt=0;wt<=Et;wt++){bt[wt]=[];const Tt=At.clone().lerp(xt,wt/Et),Mt=yt.clone().lerp(xt,wt/Et),Pt=Et-wt;for(let It=0;It<=Pt;It++)It===0&&wt===Et?bt[wt][It]=Tt:bt[wt][It]=Tt.clone().lerp(Mt,It/Pt)}for(let wt=0;wt<Et;wt++)for(let Tt=0;Tt<2*(Et-wt)-1;Tt++){const Mt=Math.floor(Tt/2);Tt%2===0?(dt(bt[wt][Mt+1]),dt(bt[wt+1][Mt]),dt(bt[wt][Mt])):(dt(bt[wt][Mt+1]),dt(bt[wt+1][Mt+1]),dt(bt[wt+1][Mt]))}}function ct(At){const yt=new Vector3;for(let xt=0;xt<st.length;xt+=3)yt.x=st[xt+0],yt.y=st[xt+1],yt.z=st[xt+2],yt.normalize().multiplyScalar(At),st[xt+0]=yt.x,st[xt+1]=yt.y,st[xt+2]=yt.z}function ut(){const At=new Vector3;for(let yt=0;yt<st.length;yt+=3){At.x=st[yt+0],At.y=st[yt+1],At.z=st[yt+2];const xt=gt(At)/2/Math.PI+.5,_t=vt(At)/Math.PI+.5;ot.push(xt,1-_t)}pt(),ht()}function ht(){for(let At=0;At<ot.length;At+=6){const yt=ot[At+0],xt=ot[At+2],_t=ot[At+4],Et=Math.max(yt,xt,_t),bt=Math.min(yt,xt,_t);Et>.9&&bt<.1&&(yt<.2&&(ot[At+0]+=1),xt<.2&&(ot[At+2]+=1),_t<.2&&(ot[At+4]+=1))}}function dt(At){st.push(At.x,At.y,At.z)}function ft(At,yt){const xt=At*3;yt.x=_e[xt+0],yt.y=_e[xt+1],yt.z=_e[xt+2]}function pt(){const At=new Vector3,yt=new Vector3,xt=new Vector3,_t=new Vector3,Et=new Vector2,bt=new Vector2,wt=new Vector2;for(let Tt=0,Mt=0;Tt<st.length;Tt+=9,Mt+=6){At.set(st[Tt+0],st[Tt+1],st[Tt+2]),yt.set(st[Tt+3],st[Tt+4],st[Tt+5]),xt.set(st[Tt+6],st[Tt+7],st[Tt+8]),Et.set(ot[Mt+0],ot[Mt+1]),bt.set(ot[Mt+2],ot[Mt+3]),wt.set(ot[Mt+4],ot[Mt+5]),_t.copy(At).add(yt).add(xt).divideScalar(3);const Pt=gt(_t);mt(Et,Mt+0,At,Pt),mt(bt,Mt+2,yt,Pt),mt(wt,Mt+4,xt,Pt)}}function mt(At,yt,xt,_t){_t<0&&At.x===1&&(ot[yt]=At.x-1),xt.x===0&&xt.z===0&&(ot[yt]=_t/2/Math.PI+.5)}function gt(At){return Math.atan2(At.z,-At.x)}function vt(At){return Math.atan2(-At.y,Math.sqrt(At.x*At.x+At.z*At.z))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new PolyhedronGeometry(_e.vertices,_e.indices,_e.radius,_e.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(_e=1,rt=0){const nt=(1+Math.sqrt(5))/2,it=1/nt,st=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-it,-nt,0,-it,nt,0,it,-nt,0,it,nt,-it,-nt,0,-it,nt,0,it,-nt,0,it,nt,0,-nt,0,-it,nt,0,-it,-nt,0,it,nt,0,it],ot=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(st,ot,_e,rt),this.type="DodecahedronGeometry",this.parameters={radius:_e,detail:rt}}static fromJSON(_e){return new DodecahedronGeometry(_e.radius,_e.detail)}}const _v0=new Vector3,_v1$1=new Vector3,_normal=new Vector3,_triangle=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(_e=null,rt=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_e,thresholdAngle:rt},_e!==null){const it=Math.pow(10,4),st=Math.cos(DEG2RAD*rt),ot=_e.getIndex(),lt=_e.getAttribute("position"),at=ot?ot.count:lt.count,ct=[0,0,0],ut=["a","b","c"],ht=new Array(3),dt={},ft=[];for(let pt=0;pt<at;pt+=3){ot?(ct[0]=ot.getX(pt),ct[1]=ot.getX(pt+1),ct[2]=ot.getX(pt+2)):(ct[0]=pt,ct[1]=pt+1,ct[2]=pt+2);const{a:mt,b:gt,c:vt}=_triangle;if(mt.fromBufferAttribute(lt,ct[0]),gt.fromBufferAttribute(lt,ct[1]),vt.fromBufferAttribute(lt,ct[2]),_triangle.getNormal(_normal),ht[0]=`${Math.round(mt.x*it)},${Math.round(mt.y*it)},${Math.round(mt.z*it)}`,ht[1]=`${Math.round(gt.x*it)},${Math.round(gt.y*it)},${Math.round(gt.z*it)}`,ht[2]=`${Math.round(vt.x*it)},${Math.round(vt.y*it)},${Math.round(vt.z*it)}`,!(ht[0]===ht[1]||ht[1]===ht[2]||ht[2]===ht[0]))for(let At=0;At<3;At++){const yt=(At+1)%3,xt=ht[At],_t=ht[yt],Et=_triangle[ut[At]],bt=_triangle[ut[yt]],wt=`${xt}_${_t}`,Tt=`${_t}_${xt}`;Tt in dt&&dt[Tt]?(_normal.dot(dt[Tt].normal)<=st&&(ft.push(Et.x,Et.y,Et.z),ft.push(bt.x,bt.y,bt.z)),dt[Tt]=null):wt in dt||(dt[wt]={index0:ct[At],index1:ct[yt],normal:_normal.clone()})}}for(const pt in dt)if(dt[pt]){const{index0:mt,index1:gt}=dt[pt];_v0.fromBufferAttribute(lt,mt),_v1$1.fromBufferAttribute(lt,gt),ft.push(_v0.x,_v0.y,_v0.z),ft.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute(ft,3))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}}class Shape extends Path$1{constructor(_e){super(_e),this.uuid=generateUUID$1(),this.type="Shape",this.holes=[]}getPointsHoles(_e){const rt=[];for(let nt=0,it=this.holes.length;nt<it;nt++)rt[nt]=this.holes[nt].getPoints(_e);return rt}extractPoints(_e){return{shape:this.getPoints(_e),holes:this.getPointsHoles(_e)}}copy(_e){super.copy(_e),this.holes=[];for(let rt=0,nt=_e.holes.length;rt<nt;rt++){const it=_e.holes[rt];this.holes.push(it.clone())}return this}toJSON(){const _e=super.toJSON();_e.uuid=this.uuid,_e.holes=[];for(let rt=0,nt=this.holes.length;rt<nt;rt++){const it=this.holes[rt];_e.holes.push(it.toJSON())}return _e}fromJSON(_e){super.fromJSON(_e),this.uuid=_e.uuid,this.holes=[];for(let rt=0,nt=_e.holes.length;rt<nt;rt++){const it=_e.holes[rt];this.holes.push(new Path$1().fromJSON(it))}return this}}const Earcut={triangulate:function(tt,_e,rt=2){const nt=_e&&_e.length,it=nt?_e[0]*rt:tt.length;let st=linkedList(tt,0,it,rt,!0);const ot=[];if(!st||st.next===st.prev)return ot;let lt,at,ct,ut,ht,dt,ft;if(nt&&(st=eliminateHoles(tt,_e,st,rt)),tt.length>80*rt){lt=ct=tt[0],at=ut=tt[1];for(let pt=rt;pt<it;pt+=rt)ht=tt[pt],dt=tt[pt+1],ht<lt&&(lt=ht),dt<at&&(at=dt),ht>ct&&(ct=ht),dt>ut&&(ut=dt);ft=Math.max(ct-lt,ut-at),ft=ft!==0?32767/ft:0}return earcutLinked(st,ot,rt,lt,at,ft,0),ot}};function linkedList(tt,_e,rt,nt,it){let st,ot;if(it===signedArea(tt,_e,rt,nt)>0)for(st=_e;st<rt;st+=nt)ot=insertNode(st,tt[st],tt[st+1],ot);else for(st=rt-nt;st>=_e;st-=nt)ot=insertNode(st,tt[st],tt[st+1],ot);return ot&&equals$1(ot,ot.next)&&(removeNode(ot),ot=ot.next),ot}function filterPoints(tt,_e){if(!tt)return tt;_e||(_e=tt);let rt=tt,nt;do if(nt=!1,!rt.steiner&&(equals$1(rt,rt.next)||area(rt.prev,rt,rt.next)===0)){if(removeNode(rt),rt=_e=rt.prev,rt===rt.next)break;nt=!0}else rt=rt.next;while(nt||rt!==_e);return _e}function earcutLinked(tt,_e,rt,nt,it,st,ot){if(!tt)return;!ot&&st&&indexCurve(tt,nt,it,st);let lt=tt,at,ct;for(;tt.prev!==tt.next;){if(at=tt.prev,ct=tt.next,st?isEarHashed(tt,nt,it,st):isEar(tt)){_e.push(at.i/rt|0),_e.push(tt.i/rt|0),_e.push(ct.i/rt|0),removeNode(tt),tt=ct.next,lt=ct.next;continue}if(tt=ct,tt===lt){ot?ot===1?(tt=cureLocalIntersections(filterPoints(tt),_e,rt),earcutLinked(tt,_e,rt,nt,it,st,2)):ot===2&&splitEarcut(tt,_e,rt,nt,it,st):earcutLinked(filterPoints(tt),_e,rt,nt,it,st,1);break}}}function isEar(tt){const _e=tt.prev,rt=tt,nt=tt.next;if(area(_e,rt,nt)>=0)return!1;const it=_e.x,st=rt.x,ot=nt.x,lt=_e.y,at=rt.y,ct=nt.y,ut=it<st?it<ot?it:ot:st<ot?st:ot,ht=lt<at?lt<ct?lt:ct:at<ct?at:ct,dt=it>st?it>ot?it:ot:st>ot?st:ot,ft=lt>at?lt>ct?lt:ct:at>ct?at:ct;let pt=nt.next;for(;pt!==_e;){if(pt.x>=ut&&pt.x<=dt&&pt.y>=ht&&pt.y<=ft&&pointInTriangle(it,lt,st,at,ot,ct,pt.x,pt.y)&&area(pt.prev,pt,pt.next)>=0)return!1;pt=pt.next}return!0}function isEarHashed(tt,_e,rt,nt){const it=tt.prev,st=tt,ot=tt.next;if(area(it,st,ot)>=0)return!1;const lt=it.x,at=st.x,ct=ot.x,ut=it.y,ht=st.y,dt=ot.y,ft=lt<at?lt<ct?lt:ct:at<ct?at:ct,pt=ut<ht?ut<dt?ut:dt:ht<dt?ht:dt,mt=lt>at?lt>ct?lt:ct:at>ct?at:ct,gt=ut>ht?ut>dt?ut:dt:ht>dt?ht:dt,vt=zOrder(ft,pt,_e,rt,nt),At=zOrder(mt,gt,_e,rt,nt);let yt=tt.prevZ,xt=tt.nextZ;for(;yt&&yt.z>=vt&&xt&&xt.z<=At;){if(yt.x>=ft&&yt.x<=mt&&yt.y>=pt&&yt.y<=gt&&yt!==it&&yt!==ot&&pointInTriangle(lt,ut,at,ht,ct,dt,yt.x,yt.y)&&area(yt.prev,yt,yt.next)>=0||(yt=yt.prevZ,xt.x>=ft&&xt.x<=mt&&xt.y>=pt&&xt.y<=gt&&xt!==it&&xt!==ot&&pointInTriangle(lt,ut,at,ht,ct,dt,xt.x,xt.y)&&area(xt.prev,xt,xt.next)>=0))return!1;xt=xt.nextZ}for(;yt&&yt.z>=vt;){if(yt.x>=ft&&yt.x<=mt&&yt.y>=pt&&yt.y<=gt&&yt!==it&&yt!==ot&&pointInTriangle(lt,ut,at,ht,ct,dt,yt.x,yt.y)&&area(yt.prev,yt,yt.next)>=0)return!1;yt=yt.prevZ}for(;xt&&xt.z<=At;){if(xt.x>=ft&&xt.x<=mt&&xt.y>=pt&&xt.y<=gt&&xt!==it&&xt!==ot&&pointInTriangle(lt,ut,at,ht,ct,dt,xt.x,xt.y)&&area(xt.prev,xt,xt.next)>=0)return!1;xt=xt.nextZ}return!0}function cureLocalIntersections(tt,_e,rt){let nt=tt;do{const it=nt.prev,st=nt.next.next;!equals$1(it,st)&&intersects(it,nt,nt.next,st)&&locallyInside(it,st)&&locallyInside(st,it)&&(_e.push(it.i/rt|0),_e.push(nt.i/rt|0),_e.push(st.i/rt|0),removeNode(nt),removeNode(nt.next),nt=tt=st),nt=nt.next}while(nt!==tt);return filterPoints(nt)}function splitEarcut(tt,_e,rt,nt,it,st){let ot=tt;do{let lt=ot.next.next;for(;lt!==ot.prev;){if(ot.i!==lt.i&&isValidDiagonal(ot,lt)){let at=splitPolygon(ot,lt);ot=filterPoints(ot,ot.next),at=filterPoints(at,at.next),earcutLinked(ot,_e,rt,nt,it,st,0),earcutLinked(at,_e,rt,nt,it,st,0);return}lt=lt.next}ot=ot.next}while(ot!==tt)}function eliminateHoles(tt,_e,rt,nt){const it=[];let st,ot,lt,at,ct;for(st=0,ot=_e.length;st<ot;st++)lt=_e[st]*nt,at=st<ot-1?_e[st+1]*nt:tt.length,ct=linkedList(tt,lt,at,nt,!1),ct===ct.next&&(ct.steiner=!0),it.push(getLeftmost(ct));for(it.sort(compareX),st=0;st<it.length;st++)rt=eliminateHole(it[st],rt);return rt}function compareX(tt,_e){return tt.x-_e.x}function eliminateHole(tt,_e){const rt=findHoleBridge(tt,_e);if(!rt)return _e;const nt=splitPolygon(rt,tt);return filterPoints(nt,nt.next),filterPoints(rt,rt.next)}function findHoleBridge(tt,_e){let rt=_e,nt=-1/0,it;const st=tt.x,ot=tt.y;do{if(ot<=rt.y&&ot>=rt.next.y&&rt.next.y!==rt.y){const dt=rt.x+(ot-rt.y)*(rt.next.x-rt.x)/(rt.next.y-rt.y);if(dt<=st&&dt>nt&&(nt=dt,it=rt.x<rt.next.x?rt:rt.next,dt===st))return it}rt=rt.next}while(rt!==_e);if(!it)return null;const lt=it,at=it.x,ct=it.y;let ut=1/0,ht;rt=it;do st>=rt.x&&rt.x>=at&&st!==rt.x&&pointInTriangle(ot<ct?st:nt,ot,at,ct,ot<ct?nt:st,ot,rt.x,rt.y)&&(ht=Math.abs(ot-rt.y)/(st-rt.x),locallyInside(rt,tt)&&(ht<ut||ht===ut&&(rt.x>it.x||rt.x===it.x&&sectorContainsSector(it,rt)))&&(it=rt,ut=ht)),rt=rt.next;while(rt!==lt);return it}function sectorContainsSector(tt,_e){return area(tt.prev,tt,_e.prev)<0&&area(_e.next,tt,tt.next)<0}function indexCurve(tt,_e,rt,nt){let it=tt;do it.z===0&&(it.z=zOrder(it.x,it.y,_e,rt,nt)),it.prevZ=it.prev,it.nextZ=it.next,it=it.next;while(it!==tt);it.prevZ.nextZ=null,it.prevZ=null,sortLinked(it)}function sortLinked(tt){let _e,rt,nt,it,st,ot,lt,at,ct=1;do{for(rt=tt,tt=null,st=null,ot=0;rt;){for(ot++,nt=rt,lt=0,_e=0;_e<ct&&(lt++,nt=nt.nextZ,!!nt);_e++);for(at=ct;lt>0||at>0&&nt;)lt!==0&&(at===0||!nt||rt.z<=nt.z)?(it=rt,rt=rt.nextZ,lt--):(it=nt,nt=nt.nextZ,at--),st?st.nextZ=it:tt=it,it.prevZ=st,st=it;rt=nt}st.nextZ=null,ct*=2}while(ot>1);return tt}function zOrder(tt,_e,rt,nt,it){return tt=(tt-rt)*it|0,_e=(_e-nt)*it|0,tt=(tt|tt<<8)&16711935,tt=(tt|tt<<4)&252645135,tt=(tt|tt<<2)&858993459,tt=(tt|tt<<1)&1431655765,_e=(_e|_e<<8)&16711935,_e=(_e|_e<<4)&252645135,_e=(_e|_e<<2)&858993459,_e=(_e|_e<<1)&1431655765,tt|_e<<1}function getLeftmost(tt){let _e=tt,rt=tt;do(_e.x<rt.x||_e.x===rt.x&&_e.y<rt.y)&&(rt=_e),_e=_e.next;while(_e!==tt);return rt}function pointInTriangle(tt,_e,rt,nt,it,st,ot,lt){return(it-ot)*(_e-lt)>=(tt-ot)*(st-lt)&&(tt-ot)*(nt-lt)>=(rt-ot)*(_e-lt)&&(rt-ot)*(st-lt)>=(it-ot)*(nt-lt)}function isValidDiagonal(tt,_e){return tt.next.i!==_e.i&&tt.prev.i!==_e.i&&!intersectsPolygon(tt,_e)&&(locallyInside(tt,_e)&&locallyInside(_e,tt)&&middleInside(tt,_e)&&(area(tt.prev,tt,_e.prev)||area(tt,_e.prev,_e))||equals$1(tt,_e)&&area(tt.prev,tt,tt.next)>0&&area(_e.prev,_e,_e.next)>0)}function area(tt,_e,rt){return(_e.y-tt.y)*(rt.x-_e.x)-(_e.x-tt.x)*(rt.y-_e.y)}function equals$1(tt,_e){return tt.x===_e.x&&tt.y===_e.y}function intersects(tt,_e,rt,nt){const it=sign(area(tt,_e,rt)),st=sign(area(tt,_e,nt)),ot=sign(area(rt,nt,tt)),lt=sign(area(rt,nt,_e));return!!(it!==st&&ot!==lt||it===0&&onSegment(tt,rt,_e)||st===0&&onSegment(tt,nt,_e)||ot===0&&onSegment(rt,tt,nt)||lt===0&&onSegment(rt,_e,nt))}function onSegment(tt,_e,rt){return _e.x<=Math.max(tt.x,rt.x)&&_e.x>=Math.min(tt.x,rt.x)&&_e.y<=Math.max(tt.y,rt.y)&&_e.y>=Math.min(tt.y,rt.y)}function sign(tt){return tt>0?1:tt<0?-1:0}function intersectsPolygon(tt,_e){let rt=tt;do{if(rt.i!==tt.i&&rt.next.i!==tt.i&&rt.i!==_e.i&&rt.next.i!==_e.i&&intersects(rt,rt.next,tt,_e))return!0;rt=rt.next}while(rt!==tt);return!1}function locallyInside(tt,_e){return area(tt.prev,tt,tt.next)<0?area(tt,_e,tt.next)>=0&&area(tt,tt.prev,_e)>=0:area(tt,_e,tt.prev)<0||area(tt,tt.next,_e)<0}function middleInside(tt,_e){let rt=tt,nt=!1;const it=(tt.x+_e.x)/2,st=(tt.y+_e.y)/2;do rt.y>st!=rt.next.y>st&&rt.next.y!==rt.y&&it<(rt.next.x-rt.x)*(st-rt.y)/(rt.next.y-rt.y)+rt.x&&(nt=!nt),rt=rt.next;while(rt!==tt);return nt}function splitPolygon(tt,_e){const rt=new Node(tt.i,tt.x,tt.y),nt=new Node(_e.i,_e.x,_e.y),it=tt.next,st=_e.prev;return tt.next=_e,_e.prev=tt,rt.next=it,it.prev=rt,nt.next=rt,rt.prev=nt,st.next=nt,nt.prev=st,nt}function insertNode(tt,_e,rt,nt){const it=new Node(tt,_e,rt);return nt?(it.next=nt.next,it.prev=nt,nt.next.prev=it,nt.next=it):(it.prev=it,it.next=it),it}function removeNode(tt){tt.next.prev=tt.prev,tt.prev.next=tt.next,tt.prevZ&&(tt.prevZ.nextZ=tt.nextZ),tt.nextZ&&(tt.nextZ.prevZ=tt.prevZ)}function Node(tt,_e,rt){this.i=tt,this.x=_e,this.y=rt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(tt,_e,rt,nt){let it=0;for(let st=_e,ot=rt-nt;st<rt;st+=nt)it+=(tt[ot]-tt[st])*(tt[st+1]+tt[ot+1]),ot=st;return it}class ShapeUtils{static area(_e){const rt=_e.length;let nt=0;for(let it=rt-1,st=0;st<rt;it=st++)nt+=_e[it].x*_e[st].y-_e[st].x*_e[it].y;return nt*.5}static isClockWise(_e){return ShapeUtils.area(_e)<0}static triangulateShape(_e,rt){const nt=[],it=[],st=[];removeDupEndPts(_e),addContour(nt,_e);let ot=_e.length;rt.forEach(removeDupEndPts);for(let at=0;at<rt.length;at++)it.push(ot),ot+=rt[at].length,addContour(nt,rt[at]);const lt=Earcut.triangulate(nt,it);for(let at=0;at<lt.length;at+=3)st.push(lt.slice(at,at+3));return st}}function removeDupEndPts(tt){const _e=tt.length;_e>2&&tt[_e-1].equals(tt[0])&&tt.pop()}function addContour(tt,_e){for(let rt=0;rt<_e.length;rt++)tt.push(_e[rt].x),tt.push(_e[rt].y)}class ExtrudeGeometry extends BufferGeometry{constructor(_e=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),rt={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_e,options:rt},_e=Array.isArray(_e)?_e:[_e];const nt=this,it=[],st=[];for(let lt=0,at=_e.length;lt<at;lt++){const ct=_e[lt];ot(ct)}this.setAttribute("position",new Float32BufferAttribute(it,3)),this.setAttribute("uv",new Float32BufferAttribute(st,2)),this.computeVertexNormals();function ot(lt){const at=[],ct=rt.curveSegments!==void 0?rt.curveSegments:12,ut=rt.steps!==void 0?rt.steps:1,ht=rt.depth!==void 0?rt.depth:1;let dt=rt.bevelEnabled!==void 0?rt.bevelEnabled:!0,ft=rt.bevelThickness!==void 0?rt.bevelThickness:.2,pt=rt.bevelSize!==void 0?rt.bevelSize:ft-.1,mt=rt.bevelOffset!==void 0?rt.bevelOffset:0,gt=rt.bevelSegments!==void 0?rt.bevelSegments:3;const vt=rt.extrudePath,At=rt.UVGenerator!==void 0?rt.UVGenerator:WorldUVGenerator;let yt,xt=!1,_t,Et,bt,wt;vt&&(yt=vt.getSpacedPoints(ut),xt=!0,dt=!1,_t=vt.computeFrenetFrames(ut,!1),Et=new Vector3,bt=new Vector3,wt=new Vector3),dt||(gt=0,ft=0,pt=0,mt=0);const Tt=lt.extractPoints(ct);let Mt=Tt.shape;const Pt=Tt.holes;if(!ShapeUtils.isClockWise(Mt)){Mt=Mt.reverse();for(let Yt=0,xr=Pt.length;Yt<xr;Yt++){const vr=Pt[Yt];ShapeUtils.isClockWise(vr)&&(Pt[Yt]=vr.reverse())}}const Ot=ShapeUtils.triangulateShape(Mt,Pt),Bt=Mt;for(let Yt=0,xr=Pt.length;Yt<xr;Yt++){const vr=Pt[Yt];Mt=Mt.concat(vr)}function Ut(Yt,xr,vr){return xr||console.error("THREE.ExtrudeGeometry: vec does not exist"),Yt.clone().addScaledVector(xr,vr)}const Ft=Mt.length,jt=Ot.length;function Dt(Yt,xr,vr){let Pr,Sr,Qr;const Ir=Yt.x-xr.x,Dr=Yt.y-xr.y,Ur=vr.x-Yt.x,Lr=vr.y-Yt.y,Wr=Ir*Ir+Dr*Dr,Xt=Ir*Lr-Dr*Ur;if(Math.abs(Xt)>Number.EPSILON){const Qt=Math.sqrt(Wr),hr=Math.sqrt(Ur*Ur+Lr*Lr),kr=xr.x-Dr/Qt,yr=xr.y+Ir/Qt,_r=vr.x-Lr/hr,Hr=vr.y+Ur/hr,Er=((_r-kr)*Lr-(Hr-yr)*Ur)/(Ir*Lr-Dr*Ur);Pr=kr+Ir*Er-Yt.x,Sr=yr+Dr*Er-Yt.y;const Ar=Pr*Pr+Sr*Sr;if(Ar<=2)return new Vector2(Pr,Sr);Qr=Math.sqrt(Ar/2)}else{let Qt=!1;Ir>Number.EPSILON?Ur>Number.EPSILON&&(Qt=!0):Ir<-Number.EPSILON?Ur<-Number.EPSILON&&(Qt=!0):Math.sign(Dr)===Math.sign(Lr)&&(Qt=!0),Qt?(Pr=-Dr,Sr=Ir,Qr=Math.sqrt(Wr)):(Pr=Ir,Sr=Dr,Qr=Math.sqrt(Wr/2))}return new Vector2(Pr/Qr,Sr/Qr)}const Gt=[];for(let Yt=0,xr=Bt.length,vr=xr-1,Pr=Yt+1;Yt<xr;Yt++,vr++,Pr++)vr===xr&&(vr=0),Pr===xr&&(Pr=0),Gt[Yt]=Dt(Bt[Yt],Bt[vr],Bt[Pr]);const zt=[];let $t,Ht=Gt.concat();for(let Yt=0,xr=Pt.length;Yt<xr;Yt++){const vr=Pt[Yt];$t=[];for(let Pr=0,Sr=vr.length,Qr=Sr-1,Ir=Pr+1;Pr<Sr;Pr++,Qr++,Ir++)Qr===Sr&&(Qr=0),Ir===Sr&&(Ir=0),$t[Pr]=Dt(vr[Pr],vr[Qr],vr[Ir]);zt.push($t),Ht=Ht.concat($t)}for(let Yt=0;Yt<gt;Yt++){const xr=Yt/gt,vr=ft*Math.cos(xr*Math.PI/2),Pr=pt*Math.sin(xr*Math.PI/2)+mt;for(let Sr=0,Qr=Bt.length;Sr<Qr;Sr++){const Ir=Ut(Bt[Sr],Gt[Sr],Pr);rr(Ir.x,Ir.y,-vr)}for(let Sr=0,Qr=Pt.length;Sr<Qr;Sr++){const Ir=Pt[Sr];$t=zt[Sr];for(let Dr=0,Ur=Ir.length;Dr<Ur;Dr++){const Lr=Ut(Ir[Dr],$t[Dr],Pr);rr(Lr.x,Lr.y,-vr)}}}const er=pt+mt;for(let Yt=0;Yt<Ft;Yt++){const xr=dt?Ut(Mt[Yt],Ht[Yt],er):Mt[Yt];xt?(bt.copy(_t.normals[0]).multiplyScalar(xr.x),Et.copy(_t.binormals[0]).multiplyScalar(xr.y),wt.copy(yt[0]).add(bt).add(Et),rr(wt.x,wt.y,wt.z)):rr(xr.x,xr.y,0)}for(let Yt=1;Yt<=ut;Yt++)for(let xr=0;xr<Ft;xr++){const vr=dt?Ut(Mt[xr],Ht[xr],er):Mt[xr];xt?(bt.copy(_t.normals[Yt]).multiplyScalar(vr.x),Et.copy(_t.binormals[Yt]).multiplyScalar(vr.y),wt.copy(yt[Yt]).add(bt).add(Et),rr(wt.x,wt.y,wt.z)):rr(vr.x,vr.y,ht/ut*Yt)}for(let Yt=gt-1;Yt>=0;Yt--){const xr=Yt/gt,vr=ft*Math.cos(xr*Math.PI/2),Pr=pt*Math.sin(xr*Math.PI/2)+mt;for(let Sr=0,Qr=Bt.length;Sr<Qr;Sr++){const Ir=Ut(Bt[Sr],Gt[Sr],Pr);rr(Ir.x,Ir.y,ht+vr)}for(let Sr=0,Qr=Pt.length;Sr<Qr;Sr++){const Ir=Pt[Sr];$t=zt[Sr];for(let Dr=0,Ur=Ir.length;Dr<Ur;Dr++){const Lr=Ut(Ir[Dr],$t[Dr],Pr);xt?rr(Lr.x,Lr.y+yt[ut-1].y,yt[ut-1].x+vr):rr(Lr.x,Lr.y,ht+vr)}}}Zt(),or();function Zt(){const Yt=it.length/3;if(dt){let xr=0,vr=Ft*xr;for(let Pr=0;Pr<jt;Pr++){const Sr=Ot[Pr];ur(Sr[2]+vr,Sr[1]+vr,Sr[0]+vr)}xr=ut+gt*2,vr=Ft*xr;for(let Pr=0;Pr<jt;Pr++){const Sr=Ot[Pr];ur(Sr[0]+vr,Sr[1]+vr,Sr[2]+vr)}}else{for(let xr=0;xr<jt;xr++){const vr=Ot[xr];ur(vr[2],vr[1],vr[0])}for(let xr=0;xr<jt;xr++){const vr=Ot[xr];ur(vr[0]+Ft*ut,vr[1]+Ft*ut,vr[2]+Ft*ut)}}nt.addGroup(Yt,it.length/3-Yt,0)}function or(){const Yt=it.length/3;let xr=0;Kt(Bt,xr),xr+=Bt.length;for(let vr=0,Pr=Pt.length;vr<Pr;vr++){const Sr=Pt[vr];Kt(Sr,xr),xr+=Sr.length}nt.addGroup(Yt,it.length/3-Yt,1)}function Kt(Yt,xr){let vr=Yt.length;for(;--vr>=0;){const Pr=vr;let Sr=vr-1;Sr<0&&(Sr=Yt.length-1);for(let Qr=0,Ir=ut+gt*2;Qr<Ir;Qr++){const Dr=Ft*Qr,Ur=Ft*(Qr+1),Lr=xr+Pr+Dr,Wr=xr+Sr+Dr,Xt=xr+Sr+Ur,Qt=xr+Pr+Ur;fr(Lr,Wr,Xt,Qt)}}}function rr(Yt,xr,vr){at.push(Yt),at.push(xr),at.push(vr)}function ur(Yt,xr,vr){dr(Yt),dr(xr),dr(vr);const Pr=it.length/3,Sr=At.generateTopUV(nt,it,Pr-3,Pr-2,Pr-1);gr(Sr[0]),gr(Sr[1]),gr(Sr[2])}function fr(Yt,xr,vr,Pr){dr(Yt),dr(xr),dr(Pr),dr(xr),dr(vr),dr(Pr);const Sr=it.length/3,Qr=At.generateSideWallUV(nt,it,Sr-6,Sr-3,Sr-2,Sr-1);gr(Qr[0]),gr(Qr[1]),gr(Qr[3]),gr(Qr[1]),gr(Qr[2]),gr(Qr[3])}function dr(Yt){it.push(at[Yt*3+0]),it.push(at[Yt*3+1]),it.push(at[Yt*3+2])}function gr(Yt){st.push(Yt.x),st.push(Yt.y)}}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON(),rt=this.parameters.shapes,nt=this.parameters.options;return toJSON$1(rt,nt,_e)}static fromJSON(_e,rt){const nt=[];for(let st=0,ot=_e.shapes.length;st<ot;st++){const lt=rt[_e.shapes[st]];nt.push(lt)}const it=_e.options.extrudePath;return it!==void 0&&(_e.options.extrudePath=new Curves[it.type]().fromJSON(it)),new ExtrudeGeometry(nt,_e.options)}}const WorldUVGenerator={generateTopUV:function(tt,_e,rt,nt,it){const st=_e[rt*3],ot=_e[rt*3+1],lt=_e[nt*3],at=_e[nt*3+1],ct=_e[it*3],ut=_e[it*3+1];return[new Vector2(st,ot),new Vector2(lt,at),new Vector2(ct,ut)]},generateSideWallUV:function(tt,_e,rt,nt,it,st){const ot=_e[rt*3],lt=_e[rt*3+1],at=_e[rt*3+2],ct=_e[nt*3],ut=_e[nt*3+1],ht=_e[nt*3+2],dt=_e[it*3],ft=_e[it*3+1],pt=_e[it*3+2],mt=_e[st*3],gt=_e[st*3+1],vt=_e[st*3+2];return Math.abs(lt-ut)<Math.abs(ot-ct)?[new Vector2(ot,1-at),new Vector2(ct,1-ht),new Vector2(dt,1-pt),new Vector2(mt,1-vt)]:[new Vector2(lt,1-at),new Vector2(ut,1-ht),new Vector2(ft,1-pt),new Vector2(gt,1-vt)]}};function toJSON$1(tt,_e,rt){if(rt.shapes=[],Array.isArray(tt))for(let nt=0,it=tt.length;nt<it;nt++){const st=tt[nt];rt.shapes.push(st.uuid)}else rt.shapes.push(tt.uuid);return rt.options=Object.assign({},_e),_e.extrudePath!==void 0&&(rt.options.extrudePath=_e.extrudePath.toJSON()),rt}class IcosahedronGeometry extends PolyhedronGeometry{constructor(_e=1,rt=0){const nt=(1+Math.sqrt(5))/2,it=[-1,nt,0,1,nt,0,-1,-nt,0,1,-nt,0,0,-1,nt,0,1,nt,0,-1,-nt,0,1,-nt,nt,0,-1,nt,0,1,-nt,0,-1,-nt,0,1],st=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(it,st,_e,rt),this.type="IcosahedronGeometry",this.parameters={radius:_e,detail:rt}}static fromJSON(_e){return new IcosahedronGeometry(_e.radius,_e.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(_e=1,rt=0){const nt=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],it=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(nt,it,_e,rt),this.type="OctahedronGeometry",this.parameters={radius:_e,detail:rt}}static fromJSON(_e){return new OctahedronGeometry(_e.radius,_e.detail)}}class RingGeometry extends BufferGeometry{constructor(_e=.5,rt=1,nt=32,it=1,st=0,ot=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:_e,outerRadius:rt,thetaSegments:nt,phiSegments:it,thetaStart:st,thetaLength:ot},nt=Math.max(3,nt),it=Math.max(1,it);const lt=[],at=[],ct=[],ut=[];let ht=_e;const dt=(rt-_e)/it,ft=new Vector3,pt=new Vector2;for(let mt=0;mt<=it;mt++){for(let gt=0;gt<=nt;gt++){const vt=st+gt/nt*ot;ft.x=ht*Math.cos(vt),ft.y=ht*Math.sin(vt),at.push(ft.x,ft.y,ft.z),ct.push(0,0,1),pt.x=(ft.x/rt+1)/2,pt.y=(ft.y/rt+1)/2,ut.push(pt.x,pt.y)}ht+=dt}for(let mt=0;mt<it;mt++){const gt=mt*(nt+1);for(let vt=0;vt<nt;vt++){const At=vt+gt,yt=At,xt=At+nt+1,_t=At+nt+2,Et=At+1;lt.push(yt,xt,Et),lt.push(xt,_t,Et)}}this.setIndex(lt),this.setAttribute("position",new Float32BufferAttribute(at,3)),this.setAttribute("normal",new Float32BufferAttribute(ct,3)),this.setAttribute("uv",new Float32BufferAttribute(ut,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new RingGeometry(_e.innerRadius,_e.outerRadius,_e.thetaSegments,_e.phiSegments,_e.thetaStart,_e.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(_e=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),rt=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_e,curveSegments:rt};const nt=[],it=[],st=[],ot=[];let lt=0,at=0;if(Array.isArray(_e)===!1)ct(_e);else for(let ut=0;ut<_e.length;ut++)ct(_e[ut]),this.addGroup(lt,at,ut),lt+=at,at=0;this.setIndex(nt),this.setAttribute("position",new Float32BufferAttribute(it,3)),this.setAttribute("normal",new Float32BufferAttribute(st,3)),this.setAttribute("uv",new Float32BufferAttribute(ot,2));function ct(ut){const ht=it.length/3,dt=ut.extractPoints(rt);let ft=dt.shape;const pt=dt.holes;ShapeUtils.isClockWise(ft)===!1&&(ft=ft.reverse());for(let gt=0,vt=pt.length;gt<vt;gt++){const At=pt[gt];ShapeUtils.isClockWise(At)===!0&&(pt[gt]=At.reverse())}const mt=ShapeUtils.triangulateShape(ft,pt);for(let gt=0,vt=pt.length;gt<vt;gt++){const At=pt[gt];ft=ft.concat(At)}for(let gt=0,vt=ft.length;gt<vt;gt++){const At=ft[gt];it.push(At.x,At.y,0),st.push(0,0,1),ot.push(At.x,At.y)}for(let gt=0,vt=mt.length;gt<vt;gt++){const At=mt[gt],yt=At[0]+ht,xt=At[1]+ht,_t=At[2]+ht;nt.push(yt,xt,_t),at+=3}}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON(),rt=this.parameters.shapes;return toJSON(rt,_e)}static fromJSON(_e,rt){const nt=[];for(let it=0,st=_e.shapes.length;it<st;it++){const ot=rt[_e.shapes[it]];nt.push(ot)}return new ShapeGeometry(nt,_e.curveSegments)}}function toJSON(tt,_e){if(_e.shapes=[],Array.isArray(tt))for(let rt=0,nt=tt.length;rt<nt;rt++){const it=tt[rt];_e.shapes.push(it.uuid)}else _e.shapes.push(tt.uuid);return _e}class SphereGeometry extends BufferGeometry{constructor(_e=1,rt=32,nt=16,it=0,st=Math.PI*2,ot=0,lt=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_e,widthSegments:rt,heightSegments:nt,phiStart:it,phiLength:st,thetaStart:ot,thetaLength:lt},rt=Math.max(3,Math.floor(rt)),nt=Math.max(2,Math.floor(nt));const at=Math.min(ot+lt,Math.PI);let ct=0;const ut=[],ht=new Vector3,dt=new Vector3,ft=[],pt=[],mt=[],gt=[];for(let vt=0;vt<=nt;vt++){const At=[],yt=vt/nt;let xt=0;vt===0&&ot===0?xt=.5/rt:vt===nt&&at===Math.PI&&(xt=-.5/rt);for(let _t=0;_t<=rt;_t++){const Et=_t/rt;ht.x=-_e*Math.cos(it+Et*st)*Math.sin(ot+yt*lt),ht.y=_e*Math.cos(ot+yt*lt),ht.z=_e*Math.sin(it+Et*st)*Math.sin(ot+yt*lt),pt.push(ht.x,ht.y,ht.z),dt.copy(ht).normalize(),mt.push(dt.x,dt.y,dt.z),gt.push(Et+xt,1-yt),At.push(ct++)}ut.push(At)}for(let vt=0;vt<nt;vt++)for(let At=0;At<rt;At++){const yt=ut[vt][At+1],xt=ut[vt][At],_t=ut[vt+1][At],Et=ut[vt+1][At+1];(vt!==0||ot>0)&&ft.push(yt,xt,Et),(vt!==nt-1||at<Math.PI)&&ft.push(xt,_t,Et)}this.setIndex(ft),this.setAttribute("position",new Float32BufferAttribute(pt,3)),this.setAttribute("normal",new Float32BufferAttribute(mt,3)),this.setAttribute("uv",new Float32BufferAttribute(gt,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new SphereGeometry(_e.radius,_e.widthSegments,_e.heightSegments,_e.phiStart,_e.phiLength,_e.thetaStart,_e.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(_e=1,rt=0){const nt=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],it=[2,1,0,0,3,2,1,3,0,2,3,1];super(nt,it,_e,rt),this.type="TetrahedronGeometry",this.parameters={radius:_e,detail:rt}}static fromJSON(_e){return new TetrahedronGeometry(_e.radius,_e.detail)}}class TorusGeometry extends BufferGeometry{constructor(_e=1,rt=.4,nt=12,it=48,st=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:_e,tube:rt,radialSegments:nt,tubularSegments:it,arc:st},nt=Math.floor(nt),it=Math.floor(it);const ot=[],lt=[],at=[],ct=[],ut=new Vector3,ht=new Vector3,dt=new Vector3;for(let ft=0;ft<=nt;ft++)for(let pt=0;pt<=it;pt++){const mt=pt/it*st,gt=ft/nt*Math.PI*2;ht.x=(_e+rt*Math.cos(gt))*Math.cos(mt),ht.y=(_e+rt*Math.cos(gt))*Math.sin(mt),ht.z=rt*Math.sin(gt),lt.push(ht.x,ht.y,ht.z),ut.x=_e*Math.cos(mt),ut.y=_e*Math.sin(mt),dt.subVectors(ht,ut).normalize(),at.push(dt.x,dt.y,dt.z),ct.push(pt/it),ct.push(ft/nt)}for(let ft=1;ft<=nt;ft++)for(let pt=1;pt<=it;pt++){const mt=(it+1)*ft+pt-1,gt=(it+1)*(ft-1)+pt-1,vt=(it+1)*(ft-1)+pt,At=(it+1)*ft+pt;ot.push(mt,gt,At),ot.push(gt,vt,At)}this.setIndex(ot),this.setAttribute("position",new Float32BufferAttribute(lt,3)),this.setAttribute("normal",new Float32BufferAttribute(at,3)),this.setAttribute("uv",new Float32BufferAttribute(ct,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new TorusGeometry(_e.radius,_e.tube,_e.radialSegments,_e.tubularSegments,_e.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(_e=1,rt=.4,nt=64,it=8,st=2,ot=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_e,tube:rt,tubularSegments:nt,radialSegments:it,p:st,q:ot},nt=Math.floor(nt),it=Math.floor(it);const lt=[],at=[],ct=[],ut=[],ht=new Vector3,dt=new Vector3,ft=new Vector3,pt=new Vector3,mt=new Vector3,gt=new Vector3,vt=new Vector3;for(let yt=0;yt<=nt;++yt){const xt=yt/nt*st*Math.PI*2;At(xt,st,ot,_e,ft),At(xt+.01,st,ot,_e,pt),gt.subVectors(pt,ft),vt.addVectors(pt,ft),mt.crossVectors(gt,vt),vt.crossVectors(mt,gt),mt.normalize(),vt.normalize();for(let _t=0;_t<=it;++_t){const Et=_t/it*Math.PI*2,bt=-rt*Math.cos(Et),wt=rt*Math.sin(Et);ht.x=ft.x+(bt*vt.x+wt*mt.x),ht.y=ft.y+(bt*vt.y+wt*mt.y),ht.z=ft.z+(bt*vt.z+wt*mt.z),at.push(ht.x,ht.y,ht.z),dt.subVectors(ht,ft).normalize(),ct.push(dt.x,dt.y,dt.z),ut.push(yt/nt),ut.push(_t/it)}}for(let yt=1;yt<=nt;yt++)for(let xt=1;xt<=it;xt++){const _t=(it+1)*(yt-1)+(xt-1),Et=(it+1)*yt+(xt-1),bt=(it+1)*yt+xt,wt=(it+1)*(yt-1)+xt;lt.push(_t,Et,wt),lt.push(Et,bt,wt)}this.setIndex(lt),this.setAttribute("position",new Float32BufferAttribute(at,3)),this.setAttribute("normal",new Float32BufferAttribute(ct,3)),this.setAttribute("uv",new Float32BufferAttribute(ut,2));function At(yt,xt,_t,Et,bt){const wt=Math.cos(yt),Tt=Math.sin(yt),Mt=_t/xt*yt,Pt=Math.cos(Mt);bt.x=Et*(2+Pt)*.5*wt,bt.y=Et*(2+Pt)*Tt*.5,bt.z=Et*Math.sin(Mt)*.5}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new TorusKnotGeometry(_e.radius,_e.tube,_e.tubularSegments,_e.radialSegments,_e.p,_e.q)}}class TubeGeometry extends BufferGeometry{constructor(_e=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),rt=64,nt=1,it=8,st=!1){super(),this.type="TubeGeometry",this.parameters={path:_e,tubularSegments:rt,radius:nt,radialSegments:it,closed:st};const ot=_e.computeFrenetFrames(rt,st);this.tangents=ot.tangents,this.normals=ot.normals,this.binormals=ot.binormals;const lt=new Vector3,at=new Vector3,ct=new Vector2;let ut=new Vector3;const ht=[],dt=[],ft=[],pt=[];mt(),this.setIndex(pt),this.setAttribute("position",new Float32BufferAttribute(ht,3)),this.setAttribute("normal",new Float32BufferAttribute(dt,3)),this.setAttribute("uv",new Float32BufferAttribute(ft,2));function mt(){for(let yt=0;yt<rt;yt++)gt(yt);gt(st===!1?rt:0),At(),vt()}function gt(yt){ut=_e.getPointAt(yt/rt,ut);const xt=ot.normals[yt],_t=ot.binormals[yt];for(let Et=0;Et<=it;Et++){const bt=Et/it*Math.PI*2,wt=Math.sin(bt),Tt=-Math.cos(bt);at.x=Tt*xt.x+wt*_t.x,at.y=Tt*xt.y+wt*_t.y,at.z=Tt*xt.z+wt*_t.z,at.normalize(),dt.push(at.x,at.y,at.z),lt.x=ut.x+nt*at.x,lt.y=ut.y+nt*at.y,lt.z=ut.z+nt*at.z,ht.push(lt.x,lt.y,lt.z)}}function vt(){for(let yt=1;yt<=rt;yt++)for(let xt=1;xt<=it;xt++){const _t=(it+1)*(yt-1)+(xt-1),Et=(it+1)*yt+(xt-1),bt=(it+1)*yt+xt,wt=(it+1)*(yt-1)+xt;pt.push(_t,Et,wt),pt.push(Et,bt,wt)}}function At(){for(let yt=0;yt<=rt;yt++)for(let xt=0;xt<=it;xt++)ct.x=yt/rt,ct.y=xt/it,ft.push(ct.x,ct.y)}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON();return _e.path=this.parameters.path.toJSON(),_e}static fromJSON(_e){return new TubeGeometry(new Curves[_e.path.type]().fromJSON(_e.path),_e.tubularSegments,_e.radius,_e.radialSegments,_e.closed)}}class WireframeGeometry extends BufferGeometry{constructor(_e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_e},_e!==null){const rt=[],nt=new Set,it=new Vector3,st=new Vector3;if(_e.index!==null){const ot=_e.attributes.position,lt=_e.index;let at=_e.groups;at.length===0&&(at=[{start:0,count:lt.count,materialIndex:0}]);for(let ct=0,ut=at.length;ct<ut;++ct){const ht=at[ct],dt=ht.start,ft=ht.count;for(let pt=dt,mt=dt+ft;pt<mt;pt+=3)for(let gt=0;gt<3;gt++){const vt=lt.getX(pt+gt),At=lt.getX(pt+(gt+1)%3);it.fromBufferAttribute(ot,vt),st.fromBufferAttribute(ot,At),isUniqueEdge(it,st,nt)===!0&&(rt.push(it.x,it.y,it.z),rt.push(st.x,st.y,st.z))}}}else{const ot=_e.attributes.position;for(let lt=0,at=ot.count/3;lt<at;lt++)for(let ct=0;ct<3;ct++){const ut=3*lt+ct,ht=3*lt+(ct+1)%3;it.fromBufferAttribute(ot,ut),st.fromBufferAttribute(ot,ht),isUniqueEdge(it,st,nt)===!0&&(rt.push(it.x,it.y,it.z),rt.push(st.x,st.y,st.z))}}this.setAttribute("position",new Float32BufferAttribute(rt,3))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}}function isUniqueEdge(tt,_e,rt){const nt=`${tt.x},${tt.y},${tt.z}-${_e.x},${_e.y},${_e.z}`,it=`${_e.x},${_e.y},${_e.z}-${tt.x},${tt.y},${tt.z}`;return rt.has(nt)===!0||rt.has(it)===!0?!1:(rt.add(nt),rt.add(it),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(_e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color$1(0),this.transparent=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.fog=_e.fog,this}}class RawShaderMaterial extends ShaderMaterial{constructor(_e){super(_e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(_e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color$1(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.defines={STANDARD:""},this.color.copy(_e.color),this.roughness=_e.roughness,this.metalness=_e.metalness,this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.roughnessMap=_e.roughnessMap,this.metalnessMap=_e.metalnessMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapIntensity=_e.envMapIntensity,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$2(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(rt){this.ior=(1+.4*rt)/(1-.4*rt)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color$1(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color$1(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color$1(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_e)}get anisotropy(){return this._anisotropy}set anisotropy(_e){this._anisotropy>0!=_e>0&&this.version++,this._anisotropy=_e}get clearcoat(){return this._clearcoat}set clearcoat(_e){this._clearcoat>0!=_e>0&&this.version++,this._clearcoat=_e}get iridescence(){return this._iridescence}set iridescence(_e){this._iridescence>0!=_e>0&&this.version++,this._iridescence=_e}get sheen(){return this._sheen}set sheen(_e){this._sheen>0!=_e>0&&this.version++,this._sheen=_e}get transmission(){return this._transmission}set transmission(_e){this._transmission>0!=_e>0&&this.version++,this._transmission=_e}copy(_e){return super.copy(_e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_e.anisotropy,this.anisotropyRotation=_e.anisotropyRotation,this.anisotropyMap=_e.anisotropyMap,this.clearcoat=_e.clearcoat,this.clearcoatMap=_e.clearcoatMap,this.clearcoatRoughness=_e.clearcoatRoughness,this.clearcoatRoughnessMap=_e.clearcoatRoughnessMap,this.clearcoatNormalMap=_e.clearcoatNormalMap,this.clearcoatNormalScale.copy(_e.clearcoatNormalScale),this.ior=_e.ior,this.iridescence=_e.iridescence,this.iridescenceMap=_e.iridescenceMap,this.iridescenceIOR=_e.iridescenceIOR,this.iridescenceThicknessRange=[..._e.iridescenceThicknessRange],this.iridescenceThicknessMap=_e.iridescenceThicknessMap,this.sheen=_e.sheen,this.sheenColor.copy(_e.sheenColor),this.sheenColorMap=_e.sheenColorMap,this.sheenRoughness=_e.sheenRoughness,this.sheenRoughnessMap=_e.sheenRoughnessMap,this.transmission=_e.transmission,this.transmissionMap=_e.transmissionMap,this.thickness=_e.thickness,this.thicknessMap=_e.thicknessMap,this.attenuationDistance=_e.attenuationDistance,this.attenuationColor.copy(_e.attenuationColor),this.specularIntensity=_e.specularIntensity,this.specularIntensityMap=_e.specularIntensityMap,this.specularColor.copy(_e.specularColor),this.specularColorMap=_e.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(_e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color$1(16777215),this.specular=new Color$1(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.specular.copy(_e.specular),this.shininess=_e.shininess,this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshToonMaterial extends Material{constructor(_e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color$1(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.gradientMap=_e.gradientMap,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.alphaMap=_e.alphaMap,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.fog=_e.fog,this}}class MeshNormalMaterial extends Material{constructor(_e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_e)}copy(_e){return super.copy(_e),this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.flatShading=_e.flatShading,this}}class MeshLambertMaterial extends Material{constructor(_e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshMatcapMaterial extends Material{constructor(_e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color$1(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.defines={MATCAP:""},this.color.copy(_e.color),this.matcap=_e.matcap,this.map=_e.map,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.alphaMap=_e.alphaMap,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(_e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_e)}copy(_e){return super.copy(_e),this.scale=_e.scale,this.dashSize=_e.dashSize,this.gapSize=_e.gapSize,this}}function arraySlice(tt,_e,rt){return isTypedArray$2(tt)?new tt.constructor(tt.subarray(_e,rt!==void 0?rt:tt.length)):tt.slice(_e,rt)}function convertArray(tt,_e,rt){return!tt||!rt&&tt.constructor===_e?tt:typeof _e.BYTES_PER_ELEMENT=="number"?new _e(tt):Array.prototype.slice.call(tt)}function isTypedArray$2(tt){return ArrayBuffer.isView(tt)&&!(tt instanceof DataView)}function getKeyframeOrder(tt){function _e(it,st){return tt[it]-tt[st]}const rt=tt.length,nt=new Array(rt);for(let it=0;it!==rt;++it)nt[it]=it;return nt.sort(_e),nt}function sortedArray(tt,_e,rt){const nt=tt.length,it=new tt.constructor(nt);for(let st=0,ot=0;ot!==nt;++st){const lt=rt[st]*_e;for(let at=0;at!==_e;++at)it[ot++]=tt[lt+at]}return it}function flattenJSON(tt,_e,rt,nt){let it=1,st=tt[0];for(;st!==void 0&&st[nt]===void 0;)st=tt[it++];if(st===void 0)return;let ot=st[nt];if(ot!==void 0)if(Array.isArray(ot))do ot=st[nt],ot!==void 0&&(_e.push(st.time),rt.push.apply(rt,ot)),st=tt[it++];while(st!==void 0);else if(ot.toArray!==void 0)do ot=st[nt],ot!==void 0&&(_e.push(st.time),ot.toArray(rt,rt.length)),st=tt[it++];while(st!==void 0);else do ot=st[nt],ot!==void 0&&(_e.push(st.time),rt.push(ot)),st=tt[it++];while(st!==void 0)}function subclip(tt,_e,rt,nt,it=30){const st=tt.clone();st.name=_e;const ot=[];for(let at=0;at<st.tracks.length;++at){const ct=st.tracks[at],ut=ct.getValueSize(),ht=[],dt=[];for(let ft=0;ft<ct.times.length;++ft){const pt=ct.times[ft]*it;if(!(pt<rt||pt>=nt)){ht.push(ct.times[ft]);for(let mt=0;mt<ut;++mt)dt.push(ct.values[ft*ut+mt])}}ht.length!==0&&(ct.times=convertArray(ht,ct.times.constructor),ct.values=convertArray(dt,ct.values.constructor),ot.push(ct))}st.tracks=ot;let lt=1/0;for(let at=0;at<st.tracks.length;++at)lt>st.tracks[at].times[0]&&(lt=st.tracks[at].times[0]);for(let at=0;at<st.tracks.length;++at)st.tracks[at].shift(-1*lt);return st.resetDuration(),st}function makeClipAdditive(tt,_e=0,rt=tt,nt=30){nt<=0&&(nt=30);const it=rt.tracks.length,st=_e/nt;for(let ot=0;ot<it;++ot){const lt=rt.tracks[ot],at=lt.ValueTypeName;if(at==="bool"||at==="string")continue;const ct=tt.tracks.find(function(vt){return vt.name===lt.name&&vt.ValueTypeName===at});if(ct===void 0)continue;let ut=0;const ht=lt.getValueSize();lt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ut=ht/3);let dt=0;const ft=ct.getValueSize();ct.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(dt=ft/3);const pt=lt.times.length-1;let mt;if(st<=lt.times[0]){const vt=ut,At=ht-ut;mt=arraySlice(lt.values,vt,At)}else if(st>=lt.times[pt]){const vt=pt*ht+ut,At=vt+ht-ut;mt=arraySlice(lt.values,vt,At)}else{const vt=lt.createInterpolant(),At=ut,yt=ht-ut;vt.evaluate(st),mt=arraySlice(vt.resultBuffer,At,yt)}at==="quaternion"&&new Quaternion().fromArray(mt).normalize().conjugate().toArray(mt);const gt=ct.times.length;for(let vt=0;vt<gt;++vt){const At=vt*ft+dt;if(at==="quaternion")Quaternion.multiplyQuaternionsFlat(ct.values,At,mt,0,ct.values,At);else{const yt=ft-dt*2;for(let xt=0;xt<yt;++xt)ct.values[At+xt]-=mt[xt]}}}return tt.blendMode=AdditiveAnimationBlendMode,tt}const AnimationUtils={arraySlice,convertArray,isTypedArray:isTypedArray$2,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(_e,rt,nt,it){this.parameterPositions=_e,this._cachedIndex=0,this.resultBuffer=it!==void 0?it:new rt.constructor(nt),this.sampleValues=rt,this.valueSize=nt,this.settings=null,this.DefaultSettings_={}}evaluate(_e){const rt=this.parameterPositions;let nt=this._cachedIndex,it=rt[nt],st=rt[nt-1];e:{t:{let ot;r:{n:if(!(_e<it)){for(let lt=nt+2;;){if(it===void 0){if(_e<st)break n;return nt=rt.length,this._cachedIndex=nt,this.copySampleValue_(nt-1)}if(nt===lt)break;if(st=it,it=rt[++nt],_e<it)break t}ot=rt.length;break r}if(!(_e>=st)){const lt=rt[1];_e<lt&&(nt=2,st=lt);for(let at=nt-2;;){if(st===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(nt===at)break;if(it=st,st=rt[--nt-1],_e>=st)break t}ot=nt,nt=0;break r}break e}for(;nt<ot;){const lt=nt+ot>>>1;_e<rt[lt]?ot=lt:nt=lt+1}if(it=rt[nt],st=rt[nt-1],st===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(it===void 0)return nt=rt.length,this._cachedIndex=nt,this.copySampleValue_(nt-1)}this._cachedIndex=nt,this.intervalChanged_(nt,st,it)}return this.interpolate_(nt,st,_e,it)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_e){const rt=this.resultBuffer,nt=this.sampleValues,it=this.valueSize,st=_e*it;for(let ot=0;ot!==it;++ot)rt[ot]=nt[st+ot];return rt}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_e,rt,nt,it){super(_e,rt,nt,it),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_e,rt,nt){const it=this.parameterPositions;let st=_e-2,ot=_e+1,lt=it[st],at=it[ot];if(lt===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:st=_e,lt=2*rt-nt;break;case WrapAroundEnding:st=it.length-2,lt=rt+it[st]-it[st+1];break;default:st=_e,lt=nt}if(at===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:ot=_e,at=2*nt-rt;break;case WrapAroundEnding:ot=1,at=nt+it[1]-it[0];break;default:ot=_e-1,at=rt}const ct=(nt-rt)*.5,ut=this.valueSize;this._weightPrev=ct/(rt-lt),this._weightNext=ct/(at-nt),this._offsetPrev=st*ut,this._offsetNext=ot*ut}interpolate_(_e,rt,nt,it){const st=this.resultBuffer,ot=this.sampleValues,lt=this.valueSize,at=_e*lt,ct=at-lt,ut=this._offsetPrev,ht=this._offsetNext,dt=this._weightPrev,ft=this._weightNext,pt=(nt-rt)/(it-rt),mt=pt*pt,gt=mt*pt,vt=-dt*gt+2*dt*mt-dt*pt,At=(1+dt)*gt+(-1.5-2*dt)*mt+(-.5+dt)*pt+1,yt=(-1-ft)*gt+(1.5+ft)*mt+.5*pt,xt=ft*gt-ft*mt;for(let _t=0;_t!==lt;++_t)st[_t]=vt*ot[ut+_t]+At*ot[ct+_t]+yt*ot[at+_t]+xt*ot[ht+_t];return st}}class LinearInterpolant extends Interpolant{constructor(_e,rt,nt,it){super(_e,rt,nt,it)}interpolate_(_e,rt,nt,it){const st=this.resultBuffer,ot=this.sampleValues,lt=this.valueSize,at=_e*lt,ct=at-lt,ut=(nt-rt)/(it-rt),ht=1-ut;for(let dt=0;dt!==lt;++dt)st[dt]=ot[ct+dt]*ht+ot[at+dt]*ut;return st}}class DiscreteInterpolant extends Interpolant{constructor(_e,rt,nt,it){super(_e,rt,nt,it)}interpolate_(_e){return this.copySampleValue_(_e-1)}}class KeyframeTrack{constructor(_e,rt,nt,it){if(_e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(rt===void 0||rt.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_e);this.name=_e,this.times=convertArray(rt,this.TimeBufferType),this.values=convertArray(nt,this.ValueBufferType),this.setInterpolation(it||this.DefaultInterpolation)}static toJSON(_e){const rt=_e.constructor;let nt;if(rt.toJSON!==this.toJSON)nt=rt.toJSON(_e);else{nt={name:_e.name,times:convertArray(_e.times,Array),values:convertArray(_e.values,Array)};const it=_e.getInterpolation();it!==_e.DefaultInterpolation&&(nt.interpolation=it)}return nt.type=_e.ValueTypeName,nt}InterpolantFactoryMethodDiscrete(_e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_e)}InterpolantFactoryMethodLinear(_e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_e)}InterpolantFactoryMethodSmooth(_e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_e)}setInterpolation(_e){let rt;switch(_e){case InterpolateDiscrete:rt=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:rt=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:rt=this.InterpolantFactoryMethodSmooth;break}if(rt===void 0){const nt="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(nt);return console.warn("THREE.KeyframeTrack:",nt),this}return this.createInterpolant=rt,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_e){if(_e!==0){const rt=this.times;for(let nt=0,it=rt.length;nt!==it;++nt)rt[nt]+=_e}return this}scale(_e){if(_e!==1){const rt=this.times;for(let nt=0,it=rt.length;nt!==it;++nt)rt[nt]*=_e}return this}trim(_e,rt){const nt=this.times,it=nt.length;let st=0,ot=it-1;for(;st!==it&&nt[st]<_e;)++st;for(;ot!==-1&&nt[ot]>rt;)--ot;if(++ot,st!==0||ot!==it){st>=ot&&(ot=Math.max(ot,1),st=ot-1);const lt=this.getValueSize();this.times=arraySlice(nt,st,ot),this.values=arraySlice(this.values,st*lt,ot*lt)}return this}validate(){let _e=!0;const rt=this.getValueSize();rt-Math.floor(rt)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_e=!1);const nt=this.times,it=this.values,st=nt.length;st===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_e=!1);let ot=null;for(let lt=0;lt!==st;lt++){const at=nt[lt];if(typeof at=="number"&&isNaN(at)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,lt,at),_e=!1;break}if(ot!==null&&ot>at){console.error("THREE.KeyframeTrack: Out of order keys.",this,lt,at,ot),_e=!1;break}ot=at}if(it!==void 0&&isTypedArray$2(it))for(let lt=0,at=it.length;lt!==at;++lt){const ct=it[lt];if(isNaN(ct)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,lt,ct),_e=!1;break}}return _e}optimize(){const _e=arraySlice(this.times),rt=arraySlice(this.values),nt=this.getValueSize(),it=this.getInterpolation()===InterpolateSmooth,st=_e.length-1;let ot=1;for(let lt=1;lt<st;++lt){let at=!1;const ct=_e[lt],ut=_e[lt+1];if(ct!==ut&&(lt!==1||ct!==_e[0]))if(it)at=!0;else{const ht=lt*nt,dt=ht-nt,ft=ht+nt;for(let pt=0;pt!==nt;++pt){const mt=rt[ht+pt];if(mt!==rt[dt+pt]||mt!==rt[ft+pt]){at=!0;break}}}if(at){if(lt!==ot){_e[ot]=_e[lt];const ht=lt*nt,dt=ot*nt;for(let ft=0;ft!==nt;++ft)rt[dt+ft]=rt[ht+ft]}++ot}}if(st>0){_e[ot]=_e[st];for(let lt=st*nt,at=ot*nt,ct=0;ct!==nt;++ct)rt[at+ct]=rt[lt+ct];++ot}return ot!==_e.length?(this.times=arraySlice(_e,0,ot),this.values=arraySlice(rt,0,ot*nt)):(this.times=_e,this.values=rt),this}clone(){const _e=arraySlice(this.times,0),rt=arraySlice(this.values,0),nt=this.constructor,it=new nt(this.name,_e,rt);return it.createInterpolant=this.createInterpolant,it}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_e,rt,nt,it){super(_e,rt,nt,it)}interpolate_(_e,rt,nt,it){const st=this.resultBuffer,ot=this.sampleValues,lt=this.valueSize,at=(nt-rt)/(it-rt);let ct=_e*lt;for(let ut=ct+lt;ct!==ut;ct+=4)Quaternion.slerpFlat(st,0,ot,ct-lt,ot,ct,at);return st}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(_e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_e)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_e,rt=-1,nt,it=NormalAnimationBlendMode){this.name=_e,this.tracks=nt,this.duration=rt,this.blendMode=it,this.uuid=generateUUID$1(),this.duration<0&&this.resetDuration()}static parse(_e){const rt=[],nt=_e.tracks,it=1/(_e.fps||1);for(let ot=0,lt=nt.length;ot!==lt;++ot)rt.push(parseKeyframeTrack(nt[ot]).scale(it));const st=new this(_e.name,_e.duration,rt,_e.blendMode);return st.uuid=_e.uuid,st}static toJSON(_e){const rt=[],nt=_e.tracks,it={name:_e.name,duration:_e.duration,tracks:rt,uuid:_e.uuid,blendMode:_e.blendMode};for(let st=0,ot=nt.length;st!==ot;++st)rt.push(KeyframeTrack.toJSON(nt[st]));return it}static CreateFromMorphTargetSequence(_e,rt,nt,it){const st=rt.length,ot=[];for(let lt=0;lt<st;lt++){let at=[],ct=[];at.push((lt+st-1)%st,lt,(lt+1)%st),ct.push(0,1,0);const ut=getKeyframeOrder(at);at=sortedArray(at,1,ut),ct=sortedArray(ct,1,ut),!it&&at[0]===0&&(at.push(st),ct.push(ct[0])),ot.push(new NumberKeyframeTrack(".morphTargetInfluences["+rt[lt].name+"]",at,ct).scale(1/nt))}return new this(_e,-1,ot)}static findByName(_e,rt){let nt=_e;if(!Array.isArray(_e)){const it=_e;nt=it.geometry&&it.geometry.animations||it.animations}for(let it=0;it<nt.length;it++)if(nt[it].name===rt)return nt[it];return null}static CreateClipsFromMorphTargetSequences(_e,rt,nt){const it={},st=/^([\w-]*?)([\d]+)$/;for(let lt=0,at=_e.length;lt<at;lt++){const ct=_e[lt],ut=ct.name.match(st);if(ut&&ut.length>1){const ht=ut[1];let dt=it[ht];dt||(it[ht]=dt=[]),dt.push(ct)}}const ot=[];for(const lt in it)ot.push(this.CreateFromMorphTargetSequence(lt,it[lt],rt,nt));return ot}static parseAnimation(_e,rt){if(!_e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const nt=function(ht,dt,ft,pt,mt){if(ft.length!==0){const gt=[],vt=[];flattenJSON(ft,gt,vt,pt),gt.length!==0&&mt.push(new ht(dt,gt,vt))}},it=[],st=_e.name||"default",ot=_e.fps||30,lt=_e.blendMode;let at=_e.length||-1;const ct=_e.hierarchy||[];for(let ht=0;ht<ct.length;ht++){const dt=ct[ht].keys;if(!(!dt||dt.length===0))if(dt[0].morphTargets){const ft={};let pt;for(pt=0;pt<dt.length;pt++)if(dt[pt].morphTargets)for(let mt=0;mt<dt[pt].morphTargets.length;mt++)ft[dt[pt].morphTargets[mt]]=-1;for(const mt in ft){const gt=[],vt=[];for(let At=0;At!==dt[pt].morphTargets.length;++At){const yt=dt[pt];gt.push(yt.time),vt.push(yt.morphTarget===mt?1:0)}it.push(new NumberKeyframeTrack(".morphTargetInfluence["+mt+"]",gt,vt))}at=ft.length*ot}else{const ft=".bones["+rt[ht].name+"]";nt(VectorKeyframeTrack,ft+".position",dt,"pos",it),nt(QuaternionKeyframeTrack,ft+".quaternion",dt,"rot",it),nt(VectorKeyframeTrack,ft+".scale",dt,"scl",it)}}return it.length===0?null:new this(st,at,it,lt)}resetDuration(){const _e=this.tracks;let rt=0;for(let nt=0,it=_e.length;nt!==it;++nt){const st=this.tracks[nt];rt=Math.max(rt,st.times[st.times.length-1])}return this.duration=rt,this}trim(){for(let _e=0;_e<this.tracks.length;_e++)this.tracks[_e].trim(0,this.duration);return this}validate(){let _e=!0;for(let rt=0;rt<this.tracks.length;rt++)_e=_e&&this.tracks[rt].validate();return _e}optimize(){for(let _e=0;_e<this.tracks.length;_e++)this.tracks[_e].optimize();return this}clone(){const _e=[];for(let rt=0;rt<this.tracks.length;rt++)_e.push(this.tracks[rt].clone());return new this.constructor(this.name,this.duration,_e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(tt){switch(tt.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+tt)}function parseKeyframeTrack(tt){if(tt.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _e=getTrackTypeForValueTypeName(tt.type);if(tt.times===void 0){const rt=[],nt=[];flattenJSON(tt.keys,rt,nt,"value"),tt.times=rt,tt.values=nt}return _e.parse!==void 0?_e.parse(tt):new _e(tt.name,tt.times,tt.values,tt.interpolation)}const Cache={enabled:!1,files:{},add:function(tt,_e){this.enabled!==!1&&(this.files[tt]=_e)},get:function(tt){if(this.enabled!==!1)return this.files[tt]},remove:function(tt){delete this.files[tt]},clear:function(){this.files={}}};class LoadingManager{constructor(_e,rt,nt){const it=this;let st=!1,ot=0,lt=0,at;const ct=[];this.onStart=void 0,this.onLoad=_e,this.onProgress=rt,this.onError=nt,this.itemStart=function(ut){lt++,st===!1&&it.onStart!==void 0&&it.onStart(ut,ot,lt),st=!0},this.itemEnd=function(ut){ot++,it.onProgress!==void 0&&it.onProgress(ut,ot,lt),ot===lt&&(st=!1,it.onLoad!==void 0&&it.onLoad())},this.itemError=function(ut){it.onError!==void 0&&it.onError(ut)},this.resolveURL=function(ut){return at?at(ut):ut},this.setURLModifier=function(ut){return at=ut,this},this.addHandler=function(ut,ht){return ct.push(ut,ht),this},this.removeHandler=function(ut){const ht=ct.indexOf(ut);return ht!==-1&&ct.splice(ht,2),this},this.getHandler=function(ut){for(let ht=0,dt=ct.length;ht<dt;ht+=2){const ft=ct[ht],pt=ct[ht+1];if(ft.global&&(ft.lastIndex=0),ft.test(ut))return pt}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_e){this.manager=_e!==void 0?_e:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_e,rt){const nt=this;return new Promise(function(it,st){nt.load(_e,it,rt,st)})}parse(){}setCrossOrigin(_e){return this.crossOrigin=_e,this}setWithCredentials(_e){return this.withCredentials=_e,this}setPath(_e){return this.path=_e,this}setResourcePath(_e){return this.resourcePath=_e,this}setRequestHeader(_e){return this.requestHeader=_e,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(_e,rt){super(_e),this.response=rt}}class FileLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){_e===void 0&&(_e=""),this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=Cache.get(_e);if(st!==void 0)return this.manager.itemStart(_e),setTimeout(()=>{rt&&rt(st),this.manager.itemEnd(_e)},0),st;if(loading[_e]!==void 0){loading[_e].push({onLoad:rt,onProgress:nt,onError:it});return}loading[_e]=[],loading[_e].push({onLoad:rt,onProgress:nt,onError:it});const ot=new Request(_e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),lt=this.mimeType,at=this.responseType;fetch(ot).then(ct=>{if(ct.status===200||ct.status===0){if(ct.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||ct.body===void 0||ct.body.getReader===void 0)return ct;const ut=loading[_e],ht=ct.body.getReader(),dt=ct.headers.get("Content-Length")||ct.headers.get("X-File-Size"),ft=dt?parseInt(dt):0,pt=ft!==0;let mt=0;const gt=new ReadableStream({start(vt){At();function At(){ht.read().then(({done:yt,value:xt})=>{if(yt)vt.close();else{mt+=xt.byteLength;const _t=new ProgressEvent("progress",{lengthComputable:pt,loaded:mt,total:ft});for(let Et=0,bt=ut.length;Et<bt;Et++){const wt=ut[Et];wt.onProgress&&wt.onProgress(_t)}vt.enqueue(xt),At()}})}}});return new Response(gt)}else throw new HttpError(`fetch for "${ct.url}" responded with ${ct.status}: ${ct.statusText}`,ct)}).then(ct=>{switch(at){case"arraybuffer":return ct.arrayBuffer();case"blob":return ct.blob();case"document":return ct.text().then(ut=>new DOMParser().parseFromString(ut,lt));case"json":return ct.json();default:if(lt===void 0)return ct.text();{const ht=/charset="?([^;"\s]*)"?/i.exec(lt),dt=ht&&ht[1]?ht[1].toLowerCase():void 0,ft=new TextDecoder(dt);return ct.arrayBuffer().then(pt=>ft.decode(pt))}}}).then(ct=>{Cache.add(_e,ct);const ut=loading[_e];delete loading[_e];for(let ht=0,dt=ut.length;ht<dt;ht++){const ft=ut[ht];ft.onLoad&&ft.onLoad(ct)}}).catch(ct=>{const ut=loading[_e];if(ut===void 0)throw this.manager.itemError(_e),ct;delete loading[_e];for(let ht=0,dt=ut.length;ht<dt;ht++){const ft=ut[ht];ft.onError&&ft.onError(ct)}this.manager.itemError(_e)}).finally(()=>{this.manager.itemEnd(_e)}),this.manager.itemStart(_e)}setResponseType(_e){return this.responseType=_e,this}setMimeType(_e){return this.mimeType=_e,this}}class AnimationLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){const st=this,ot=new FileLoader(this.manager);ot.setPath(this.path),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(this.withCredentials),ot.load(_e,function(lt){try{rt(st.parse(JSON.parse(lt)))}catch(at){it?it(at):console.error(at),st.manager.itemError(_e)}},nt,it)}parse(_e){const rt=[];for(let nt=0;nt<_e.length;nt++){const it=AnimationClip.parse(_e[nt]);rt.push(it)}return rt}}class CompressedTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){const st=this,ot=[],lt=new CompressedTexture,at=new FileLoader(this.manager);at.setPath(this.path),at.setResponseType("arraybuffer"),at.setRequestHeader(this.requestHeader),at.setWithCredentials(st.withCredentials);let ct=0;function ut(ht){at.load(_e[ht],function(dt){const ft=st.parse(dt,!0);ot[ht]={width:ft.width,height:ft.height,format:ft.format,mipmaps:ft.mipmaps},ct+=1,ct===6&&(ft.mipmapCount===1&&(lt.minFilter=LinearFilter),lt.image=ot,lt.format=ft.format,lt.needsUpdate=!0,rt&&rt(lt))},nt,it)}if(Array.isArray(_e))for(let ht=0,dt=_e.length;ht<dt;++ht)ut(ht);else at.load(_e,function(ht){const dt=st.parse(ht,!0);if(dt.isCubemap){const ft=dt.mipmaps.length/dt.mipmapCount;for(let pt=0;pt<ft;pt++){ot[pt]={mipmaps:[]};for(let mt=0;mt<dt.mipmapCount;mt++)ot[pt].mipmaps.push(dt.mipmaps[pt*dt.mipmapCount+mt]),ot[pt].format=dt.format,ot[pt].width=dt.width,ot[pt].height=dt.height}lt.image=ot}else lt.image.width=dt.width,lt.image.height=dt.height,lt.mipmaps=dt.mipmaps;dt.mipmapCount===1&&(lt.minFilter=LinearFilter),lt.format=dt.format,lt.needsUpdate=!0,rt&&rt(lt)},nt,it);return lt}}class ImageLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=this,ot=Cache.get(_e);if(ot!==void 0)return st.manager.itemStart(_e),setTimeout(function(){rt&&rt(ot),st.manager.itemEnd(_e)},0),ot;const lt=createElementNS("img");function at(){ut(),Cache.add(_e,this),rt&&rt(this),st.manager.itemEnd(_e)}function ct(ht){ut(),it&&it(ht),st.manager.itemError(_e),st.manager.itemEnd(_e)}function ut(){lt.removeEventListener("load",at,!1),lt.removeEventListener("error",ct,!1)}return lt.addEventListener("load",at,!1),lt.addEventListener("error",ct,!1),_e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(lt.crossOrigin=this.crossOrigin),st.manager.itemStart(_e),lt.src=_e,lt}}class CubeTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){const st=new CubeTexture;st.colorSpace=SRGBColorSpace;const ot=new ImageLoader(this.manager);ot.setCrossOrigin(this.crossOrigin),ot.setPath(this.path);let lt=0;function at(ct){ot.load(_e[ct],function(ut){st.images[ct]=ut,lt++,lt===6&&(st.needsUpdate=!0,rt&&rt(st))},void 0,it)}for(let ct=0;ct<_e.length;++ct)at(ct);return st}}class DataTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){const st=this,ot=new DataTexture,lt=new FileLoader(this.manager);return lt.setResponseType("arraybuffer"),lt.setRequestHeader(this.requestHeader),lt.setPath(this.path),lt.setWithCredentials(st.withCredentials),lt.load(_e,function(at){const ct=st.parse(at);ct&&(ct.image!==void 0?ot.image=ct.image:ct.data!==void 0&&(ot.image.width=ct.width,ot.image.height=ct.height,ot.image.data=ct.data),ot.wrapS=ct.wrapS!==void 0?ct.wrapS:ClampToEdgeWrapping,ot.wrapT=ct.wrapT!==void 0?ct.wrapT:ClampToEdgeWrapping,ot.magFilter=ct.magFilter!==void 0?ct.magFilter:LinearFilter,ot.minFilter=ct.minFilter!==void 0?ct.minFilter:LinearFilter,ot.anisotropy=ct.anisotropy!==void 0?ct.anisotropy:1,ct.colorSpace!==void 0?ot.colorSpace=ct.colorSpace:ct.encoding!==void 0&&(ot.encoding=ct.encoding),ct.flipY!==void 0&&(ot.flipY=ct.flipY),ct.format!==void 0&&(ot.format=ct.format),ct.type!==void 0&&(ot.type=ct.type),ct.mipmaps!==void 0&&(ot.mipmaps=ct.mipmaps,ot.minFilter=LinearMipmapLinearFilter),ct.mipmapCount===1&&(ot.minFilter=LinearFilter),ct.generateMipmaps!==void 0&&(ot.generateMipmaps=ct.generateMipmaps),ot.needsUpdate=!0,rt&&rt(ot,ct))},nt,it),ot}}class TextureLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){const st=new Texture,ot=new ImageLoader(this.manager);return ot.setCrossOrigin(this.crossOrigin),ot.setPath(this.path),ot.load(_e,function(lt){st.image=lt,st.needsUpdate=!0,rt!==void 0&&rt(st)},nt,it),st}}class Light extends Object3D{constructor(_e,rt=1){super(),this.isLight=!0,this.type="Light",this.color=new Color$1(_e),this.intensity=rt}dispose(){}copy(_e,rt){return super.copy(_e,rt),this.color.copy(_e.color),this.intensity=_e.intensity,this}toJSON(_e){const rt=super.toJSON(_e);return rt.object.color=this.color.getHex(),rt.object.intensity=this.intensity,this.groundColor!==void 0&&(rt.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(rt.object.distance=this.distance),this.angle!==void 0&&(rt.object.angle=this.angle),this.decay!==void 0&&(rt.object.decay=this.decay),this.penumbra!==void 0&&(rt.object.penumbra=this.penumbra),this.shadow!==void 0&&(rt.object.shadow=this.shadow.toJSON()),rt}}class HemisphereLight extends Light{constructor(_e,rt,nt){super(_e,nt),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color$1(rt)}copy(_e,rt){return super.copy(_e,rt),this.groundColor.copy(_e.groundColor),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_e){this.camera=_e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_e){const rt=this.camera,nt=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_e.matrixWorld),rt.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_e.target.matrixWorld),rt.lookAt(_lookTarget$1),rt.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(rt.projectionMatrix,rt.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),nt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),nt.multiply(_projScreenMatrix$1)}getViewport(_e){return this._viewports[_e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_e){return this.camera=_e.camera.clone(),this.bias=_e.bias,this.radius=_e.radius,this.mapSize.copy(_e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _e={};return this.bias!==0&&(_e.bias=this.bias),this.normalBias!==0&&(_e.normalBias=this.normalBias),this.radius!==1&&(_e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_e.mapSize=this.mapSize.toArray()),_e.camera=this.camera.toJSON(!1).object,delete _e.camera.matrix,_e}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_e){const rt=this.camera,nt=RAD2DEG*2*_e.angle*this.focus,it=this.mapSize.width/this.mapSize.height,st=_e.distance||rt.far;(nt!==rt.fov||it!==rt.aspect||st!==rt.far)&&(rt.fov=nt,rt.aspect=it,rt.far=st,rt.updateProjectionMatrix()),super.updateMatrices(_e)}copy(_e){return super.copy(_e),this.focus=_e.focus,this}}class SpotLight extends Light{constructor(_e,rt,nt=0,it=Math.PI/3,st=0,ot=2){super(_e,rt),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=nt,this.angle=it,this.penumbra=st,this.decay=ot,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(_e){this.intensity=_e/Math.PI}dispose(){this.shadow.dispose()}copy(_e,rt){return super.copy(_e,rt),this.distance=_e.distance,this.angle=_e.angle,this.penumbra=_e.penumbra,this.decay=_e.decay,this.target=_e.target.clone(),this.shadow=_e.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_e,rt=0){const nt=this.camera,it=this.matrix,st=_e.distance||nt.far;st!==nt.far&&(nt.far=st,nt.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_e.matrixWorld),nt.position.copy(_lightPositionWorld),_lookTarget.copy(nt.position),_lookTarget.add(this._cubeDirections[rt]),nt.up.copy(this._cubeUps[rt]),nt.lookAt(_lookTarget),nt.updateMatrixWorld(),it.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(nt.projectionMatrix,nt.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(_e,rt,nt=0,it=2){super(_e,rt),this.isPointLight=!0,this.type="PointLight",this.distance=nt,this.decay=it,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_e){this.intensity=_e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_e,rt){return super.copy(_e,rt),this.distance=_e.distance,this.decay=_e.decay,this.shadow=_e.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(_e,rt){super(_e,rt),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_e){return super.copy(_e),this.target=_e.target.clone(),this.shadow=_e.shadow.clone(),this}}class AmbientLight extends Light{constructor(_e,rt){super(_e,rt),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(_e,rt,nt=10,it=10){super(_e,rt),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=nt,this.height=it}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_e){this.intensity=_e/(this.width*this.height*Math.PI)}copy(_e){return super.copy(_e),this.width=_e.width,this.height=_e.height,this}toJSON(_e){const rt=super.toJSON(_e);return rt.object.width=this.width,rt.object.height=this.height,rt}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _e=0;_e<9;_e++)this.coefficients.push(new Vector3)}set(_e){for(let rt=0;rt<9;rt++)this.coefficients[rt].copy(_e[rt]);return this}zero(){for(let _e=0;_e<9;_e++)this.coefficients[_e].set(0,0,0);return this}getAt(_e,rt){const nt=_e.x,it=_e.y,st=_e.z,ot=this.coefficients;return rt.copy(ot[0]).multiplyScalar(.282095),rt.addScaledVector(ot[1],.488603*it),rt.addScaledVector(ot[2],.488603*st),rt.addScaledVector(ot[3],.488603*nt),rt.addScaledVector(ot[4],1.092548*(nt*it)),rt.addScaledVector(ot[5],1.092548*(it*st)),rt.addScaledVector(ot[6],.315392*(3*st*st-1)),rt.addScaledVector(ot[7],1.092548*(nt*st)),rt.addScaledVector(ot[8],.546274*(nt*nt-it*it)),rt}getIrradianceAt(_e,rt){const nt=_e.x,it=_e.y,st=_e.z,ot=this.coefficients;return rt.copy(ot[0]).multiplyScalar(.886227),rt.addScaledVector(ot[1],2*.511664*it),rt.addScaledVector(ot[2],2*.511664*st),rt.addScaledVector(ot[3],2*.511664*nt),rt.addScaledVector(ot[4],2*.429043*nt*it),rt.addScaledVector(ot[5],2*.429043*it*st),rt.addScaledVector(ot[6],.743125*st*st-.247708),rt.addScaledVector(ot[7],2*.429043*nt*st),rt.addScaledVector(ot[8],.429043*(nt*nt-it*it)),rt}add(_e){for(let rt=0;rt<9;rt++)this.coefficients[rt].add(_e.coefficients[rt]);return this}addScaledSH(_e,rt){for(let nt=0;nt<9;nt++)this.coefficients[nt].addScaledVector(_e.coefficients[nt],rt);return this}scale(_e){for(let rt=0;rt<9;rt++)this.coefficients[rt].multiplyScalar(_e);return this}lerp(_e,rt){for(let nt=0;nt<9;nt++)this.coefficients[nt].lerp(_e.coefficients[nt],rt);return this}equals(_e){for(let rt=0;rt<9;rt++)if(!this.coefficients[rt].equals(_e.coefficients[rt]))return!1;return!0}copy(_e){return this.set(_e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_e,rt=0){const nt=this.coefficients;for(let it=0;it<9;it++)nt[it].fromArray(_e,rt+it*3);return this}toArray(_e=[],rt=0){const nt=this.coefficients;for(let it=0;it<9;it++)nt[it].toArray(_e,rt+it*3);return _e}static getBasisAt(_e,rt){const nt=_e.x,it=_e.y,st=_e.z;rt[0]=.282095,rt[1]=.488603*it,rt[2]=.488603*st,rt[3]=.488603*nt,rt[4]=1.092548*nt*it,rt[5]=1.092548*it*st,rt[6]=.315392*(3*st*st-1),rt[7]=1.092548*nt*st,rt[8]=.546274*(nt*nt-it*it)}}class LightProbe extends Light{constructor(_e=new SphericalHarmonics3,rt=1){super(void 0,rt),this.isLightProbe=!0,this.sh=_e}copy(_e){return super.copy(_e),this.sh.copy(_e.sh),this}fromJSON(_e){return this.intensity=_e.intensity,this.sh.fromArray(_e.sh),this}toJSON(_e){const rt=super.toJSON(_e);return rt.object.sh=this.sh.toArray(),rt}}class MaterialLoader extends Loader{constructor(_e){super(_e),this.textures={}}load(_e,rt,nt,it){const st=this,ot=new FileLoader(st.manager);ot.setPath(st.path),ot.setRequestHeader(st.requestHeader),ot.setWithCredentials(st.withCredentials),ot.load(_e,function(lt){try{rt(st.parse(JSON.parse(lt)))}catch(at){it?it(at):console.error(at),st.manager.itemError(_e)}},nt,it)}parse(_e){const rt=this.textures;function nt(st){return rt[st]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",st),rt[st]}const it=MaterialLoader.createMaterialFromType(_e.type);if(_e.uuid!==void 0&&(it.uuid=_e.uuid),_e.name!==void 0&&(it.name=_e.name),_e.color!==void 0&&it.color!==void 0&&it.color.setHex(_e.color),_e.roughness!==void 0&&(it.roughness=_e.roughness),_e.metalness!==void 0&&(it.metalness=_e.metalness),_e.sheen!==void 0&&(it.sheen=_e.sheen),_e.sheenColor!==void 0&&(it.sheenColor=new Color$1().setHex(_e.sheenColor)),_e.sheenRoughness!==void 0&&(it.sheenRoughness=_e.sheenRoughness),_e.emissive!==void 0&&it.emissive!==void 0&&it.emissive.setHex(_e.emissive),_e.specular!==void 0&&it.specular!==void 0&&it.specular.setHex(_e.specular),_e.specularIntensity!==void 0&&(it.specularIntensity=_e.specularIntensity),_e.specularColor!==void 0&&it.specularColor!==void 0&&it.specularColor.setHex(_e.specularColor),_e.shininess!==void 0&&(it.shininess=_e.shininess),_e.clearcoat!==void 0&&(it.clearcoat=_e.clearcoat),_e.clearcoatRoughness!==void 0&&(it.clearcoatRoughness=_e.clearcoatRoughness),_e.iridescence!==void 0&&(it.iridescence=_e.iridescence),_e.iridescenceIOR!==void 0&&(it.iridescenceIOR=_e.iridescenceIOR),_e.iridescenceThicknessRange!==void 0&&(it.iridescenceThicknessRange=_e.iridescenceThicknessRange),_e.transmission!==void 0&&(it.transmission=_e.transmission),_e.thickness!==void 0&&(it.thickness=_e.thickness),_e.attenuationDistance!==void 0&&(it.attenuationDistance=_e.attenuationDistance),_e.attenuationColor!==void 0&&it.attenuationColor!==void 0&&it.attenuationColor.setHex(_e.attenuationColor),_e.anisotropy!==void 0&&(it.anisotropy=_e.anisotropy),_e.anisotropyRotation!==void 0&&(it.anisotropyRotation=_e.anisotropyRotation),_e.fog!==void 0&&(it.fog=_e.fog),_e.flatShading!==void 0&&(it.flatShading=_e.flatShading),_e.blending!==void 0&&(it.blending=_e.blending),_e.combine!==void 0&&(it.combine=_e.combine),_e.side!==void 0&&(it.side=_e.side),_e.shadowSide!==void 0&&(it.shadowSide=_e.shadowSide),_e.opacity!==void 0&&(it.opacity=_e.opacity),_e.transparent!==void 0&&(it.transparent=_e.transparent),_e.alphaTest!==void 0&&(it.alphaTest=_e.alphaTest),_e.alphaHash!==void 0&&(it.alphaHash=_e.alphaHash),_e.depthTest!==void 0&&(it.depthTest=_e.depthTest),_e.depthWrite!==void 0&&(it.depthWrite=_e.depthWrite),_e.colorWrite!==void 0&&(it.colorWrite=_e.colorWrite),_e.stencilWrite!==void 0&&(it.stencilWrite=_e.stencilWrite),_e.stencilWriteMask!==void 0&&(it.stencilWriteMask=_e.stencilWriteMask),_e.stencilFunc!==void 0&&(it.stencilFunc=_e.stencilFunc),_e.stencilRef!==void 0&&(it.stencilRef=_e.stencilRef),_e.stencilFuncMask!==void 0&&(it.stencilFuncMask=_e.stencilFuncMask),_e.stencilFail!==void 0&&(it.stencilFail=_e.stencilFail),_e.stencilZFail!==void 0&&(it.stencilZFail=_e.stencilZFail),_e.stencilZPass!==void 0&&(it.stencilZPass=_e.stencilZPass),_e.wireframe!==void 0&&(it.wireframe=_e.wireframe),_e.wireframeLinewidth!==void 0&&(it.wireframeLinewidth=_e.wireframeLinewidth),_e.wireframeLinecap!==void 0&&(it.wireframeLinecap=_e.wireframeLinecap),_e.wireframeLinejoin!==void 0&&(it.wireframeLinejoin=_e.wireframeLinejoin),_e.rotation!==void 0&&(it.rotation=_e.rotation),_e.linewidth!==1&&(it.linewidth=_e.linewidth),_e.dashSize!==void 0&&(it.dashSize=_e.dashSize),_e.gapSize!==void 0&&(it.gapSize=_e.gapSize),_e.scale!==void 0&&(it.scale=_e.scale),_e.polygonOffset!==void 0&&(it.polygonOffset=_e.polygonOffset),_e.polygonOffsetFactor!==void 0&&(it.polygonOffsetFactor=_e.polygonOffsetFactor),_e.polygonOffsetUnits!==void 0&&(it.polygonOffsetUnits=_e.polygonOffsetUnits),_e.dithering!==void 0&&(it.dithering=_e.dithering),_e.alphaToCoverage!==void 0&&(it.alphaToCoverage=_e.alphaToCoverage),_e.premultipliedAlpha!==void 0&&(it.premultipliedAlpha=_e.premultipliedAlpha),_e.forceSinglePass!==void 0&&(it.forceSinglePass=_e.forceSinglePass),_e.visible!==void 0&&(it.visible=_e.visible),_e.toneMapped!==void 0&&(it.toneMapped=_e.toneMapped),_e.userData!==void 0&&(it.userData=_e.userData),_e.vertexColors!==void 0&&(typeof _e.vertexColors=="number"?it.vertexColors=_e.vertexColors>0:it.vertexColors=_e.vertexColors),_e.uniforms!==void 0)for(const st in _e.uniforms){const ot=_e.uniforms[st];switch(it.uniforms[st]={},ot.type){case"t":it.uniforms[st].value=nt(ot.value);break;case"c":it.uniforms[st].value=new Color$1().setHex(ot.value);break;case"v2":it.uniforms[st].value=new Vector2().fromArray(ot.value);break;case"v3":it.uniforms[st].value=new Vector3().fromArray(ot.value);break;case"v4":it.uniforms[st].value=new Vector4().fromArray(ot.value);break;case"m3":it.uniforms[st].value=new Matrix3().fromArray(ot.value);break;case"m4":it.uniforms[st].value=new Matrix4().fromArray(ot.value);break;default:it.uniforms[st].value=ot.value}}if(_e.defines!==void 0&&(it.defines=_e.defines),_e.vertexShader!==void 0&&(it.vertexShader=_e.vertexShader),_e.fragmentShader!==void 0&&(it.fragmentShader=_e.fragmentShader),_e.glslVersion!==void 0&&(it.glslVersion=_e.glslVersion),_e.extensions!==void 0)for(const st in _e.extensions)it.extensions[st]=_e.extensions[st];if(_e.lights!==void 0&&(it.lights=_e.lights),_e.clipping!==void 0&&(it.clipping=_e.clipping),_e.size!==void 0&&(it.size=_e.size),_e.sizeAttenuation!==void 0&&(it.sizeAttenuation=_e.sizeAttenuation),_e.map!==void 0&&(it.map=nt(_e.map)),_e.matcap!==void 0&&(it.matcap=nt(_e.matcap)),_e.alphaMap!==void 0&&(it.alphaMap=nt(_e.alphaMap)),_e.bumpMap!==void 0&&(it.bumpMap=nt(_e.bumpMap)),_e.bumpScale!==void 0&&(it.bumpScale=_e.bumpScale),_e.normalMap!==void 0&&(it.normalMap=nt(_e.normalMap)),_e.normalMapType!==void 0&&(it.normalMapType=_e.normalMapType),_e.normalScale!==void 0){let st=_e.normalScale;Array.isArray(st)===!1&&(st=[st,st]),it.normalScale=new Vector2().fromArray(st)}return _e.displacementMap!==void 0&&(it.displacementMap=nt(_e.displacementMap)),_e.displacementScale!==void 0&&(it.displacementScale=_e.displacementScale),_e.displacementBias!==void 0&&(it.displacementBias=_e.displacementBias),_e.roughnessMap!==void 0&&(it.roughnessMap=nt(_e.roughnessMap)),_e.metalnessMap!==void 0&&(it.metalnessMap=nt(_e.metalnessMap)),_e.emissiveMap!==void 0&&(it.emissiveMap=nt(_e.emissiveMap)),_e.emissiveIntensity!==void 0&&(it.emissiveIntensity=_e.emissiveIntensity),_e.specularMap!==void 0&&(it.specularMap=nt(_e.specularMap)),_e.specularIntensityMap!==void 0&&(it.specularIntensityMap=nt(_e.specularIntensityMap)),_e.specularColorMap!==void 0&&(it.specularColorMap=nt(_e.specularColorMap)),_e.envMap!==void 0&&(it.envMap=nt(_e.envMap)),_e.envMapIntensity!==void 0&&(it.envMapIntensity=_e.envMapIntensity),_e.reflectivity!==void 0&&(it.reflectivity=_e.reflectivity),_e.refractionRatio!==void 0&&(it.refractionRatio=_e.refractionRatio),_e.lightMap!==void 0&&(it.lightMap=nt(_e.lightMap)),_e.lightMapIntensity!==void 0&&(it.lightMapIntensity=_e.lightMapIntensity),_e.aoMap!==void 0&&(it.aoMap=nt(_e.aoMap)),_e.aoMapIntensity!==void 0&&(it.aoMapIntensity=_e.aoMapIntensity),_e.gradientMap!==void 0&&(it.gradientMap=nt(_e.gradientMap)),_e.clearcoatMap!==void 0&&(it.clearcoatMap=nt(_e.clearcoatMap)),_e.clearcoatRoughnessMap!==void 0&&(it.clearcoatRoughnessMap=nt(_e.clearcoatRoughnessMap)),_e.clearcoatNormalMap!==void 0&&(it.clearcoatNormalMap=nt(_e.clearcoatNormalMap)),_e.clearcoatNormalScale!==void 0&&(it.clearcoatNormalScale=new Vector2().fromArray(_e.clearcoatNormalScale)),_e.iridescenceMap!==void 0&&(it.iridescenceMap=nt(_e.iridescenceMap)),_e.iridescenceThicknessMap!==void 0&&(it.iridescenceThicknessMap=nt(_e.iridescenceThicknessMap)),_e.transmissionMap!==void 0&&(it.transmissionMap=nt(_e.transmissionMap)),_e.thicknessMap!==void 0&&(it.thicknessMap=nt(_e.thicknessMap)),_e.anisotropyMap!==void 0&&(it.anisotropyMap=nt(_e.anisotropyMap)),_e.sheenColorMap!==void 0&&(it.sheenColorMap=nt(_e.sheenColorMap)),_e.sheenRoughnessMap!==void 0&&(it.sheenRoughnessMap=nt(_e.sheenRoughnessMap)),it}setTextures(_e){return this.textures=_e,this}static createMaterialFromType(_e){const rt={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new rt[_e]}}class LoaderUtils{static decodeText(_e){if(typeof TextDecoder<"u")return new TextDecoder().decode(_e);let rt="";for(let nt=0,it=_e.length;nt<it;nt++)rt+=String.fromCharCode(_e[nt]);try{return decodeURIComponent(escape(rt))}catch{return rt}}static extractUrlBase(_e){const rt=_e.lastIndexOf("/");return rt===-1?"./":_e.slice(0,rt+1)}static resolveURL(_e,rt){return typeof _e!="string"||_e===""?"":(/^https?:\/\//i.test(rt)&&/^\//.test(_e)&&(rt=rt.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_e)||/^data:.*,.*$/i.test(_e)||/^blob:.*$/i.test(_e)?_e:rt+_e)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_e){return super.copy(_e),this.instanceCount=_e.instanceCount,this}toJSON(){const _e=super.toJSON();return _e.instanceCount=this.instanceCount,_e.isInstancedBufferGeometry=!0,_e}}class BufferGeometryLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){const st=this,ot=new FileLoader(st.manager);ot.setPath(st.path),ot.setRequestHeader(st.requestHeader),ot.setWithCredentials(st.withCredentials),ot.load(_e,function(lt){try{rt(st.parse(JSON.parse(lt)))}catch(at){it?it(at):console.error(at),st.manager.itemError(_e)}},nt,it)}parse(_e){const rt={},nt={};function it(ft,pt){if(rt[pt]!==void 0)return rt[pt];const gt=ft.interleavedBuffers[pt],vt=st(ft,gt.buffer),At=getTypedArray(gt.type,vt),yt=new InterleavedBuffer(At,gt.stride);return yt.uuid=gt.uuid,rt[pt]=yt,yt}function st(ft,pt){if(nt[pt]!==void 0)return nt[pt];const gt=ft.arrayBuffers[pt],vt=new Uint32Array(gt).buffer;return nt[pt]=vt,vt}const ot=_e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,lt=_e.data.index;if(lt!==void 0){const ft=getTypedArray(lt.type,lt.array);ot.setIndex(new BufferAttribute(ft,1))}const at=_e.data.attributes;for(const ft in at){const pt=at[ft];let mt;if(pt.isInterleavedBufferAttribute){const gt=it(_e.data,pt.data);mt=new InterleavedBufferAttribute(gt,pt.itemSize,pt.offset,pt.normalized)}else{const gt=getTypedArray(pt.type,pt.array),vt=pt.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;mt=new vt(gt,pt.itemSize,pt.normalized)}pt.name!==void 0&&(mt.name=pt.name),pt.usage!==void 0&&mt.setUsage(pt.usage),pt.updateRange!==void 0&&(mt.updateRange.offset=pt.updateRange.offset,mt.updateRange.count=pt.updateRange.count),ot.setAttribute(ft,mt)}const ct=_e.data.morphAttributes;if(ct)for(const ft in ct){const pt=ct[ft],mt=[];for(let gt=0,vt=pt.length;gt<vt;gt++){const At=pt[gt];let yt;if(At.isInterleavedBufferAttribute){const xt=it(_e.data,At.data);yt=new InterleavedBufferAttribute(xt,At.itemSize,At.offset,At.normalized)}else{const xt=getTypedArray(At.type,At.array);yt=new BufferAttribute(xt,At.itemSize,At.normalized)}At.name!==void 0&&(yt.name=At.name),mt.push(yt)}ot.morphAttributes[ft]=mt}_e.data.morphTargetsRelative&&(ot.morphTargetsRelative=!0);const ht=_e.data.groups||_e.data.drawcalls||_e.data.offsets;if(ht!==void 0)for(let ft=0,pt=ht.length;ft!==pt;++ft){const mt=ht[ft];ot.addGroup(mt.start,mt.count,mt.materialIndex)}const dt=_e.data.boundingSphere;if(dt!==void 0){const ft=new Vector3;dt.center!==void 0&&ft.fromArray(dt.center),ot.boundingSphere=new Sphere(ft,dt.radius)}return _e.name&&(ot.name=_e.name),_e.userData&&(ot.userData=_e.userData),ot}}class ObjectLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){const st=this,ot=this.path===""?LoaderUtils.extractUrlBase(_e):this.path;this.resourcePath=this.resourcePath||ot;const lt=new FileLoader(this.manager);lt.setPath(this.path),lt.setRequestHeader(this.requestHeader),lt.setWithCredentials(this.withCredentials),lt.load(_e,function(at){let ct=null;try{ct=JSON.parse(at)}catch(ht){it!==void 0&&it(ht),console.error("THREE:ObjectLoader: Can't parse "+_e+".",ht.message);return}const ut=ct.metadata;if(ut===void 0||ut.type===void 0||ut.type.toLowerCase()==="geometry"){it!==void 0&&it(new Error("THREE.ObjectLoader: Can't load "+_e)),console.error("THREE.ObjectLoader: Can't load "+_e);return}st.parse(ct,rt)},nt,it)}async loadAsync(_e,rt){const nt=this,it=this.path===""?LoaderUtils.extractUrlBase(_e):this.path;this.resourcePath=this.resourcePath||it;const st=new FileLoader(this.manager);st.setPath(this.path),st.setRequestHeader(this.requestHeader),st.setWithCredentials(this.withCredentials);const ot=await st.loadAsync(_e,rt),lt=JSON.parse(ot),at=lt.metadata;if(at===void 0||at.type===void 0||at.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_e);return await nt.parseAsync(lt)}parse(_e,rt){const nt=this.parseAnimations(_e.animations),it=this.parseShapes(_e.shapes),st=this.parseGeometries(_e.geometries,it),ot=this.parseImages(_e.images,function(){rt!==void 0&&rt(ct)}),lt=this.parseTextures(_e.textures,ot),at=this.parseMaterials(_e.materials,lt),ct=this.parseObject(_e.object,st,at,lt,nt),ut=this.parseSkeletons(_e.skeletons,ct);if(this.bindSkeletons(ct,ut),rt!==void 0){let ht=!1;for(const dt in ot)if(ot[dt].data instanceof HTMLImageElement){ht=!0;break}ht===!1&&rt(ct)}return ct}async parseAsync(_e){const rt=this.parseAnimations(_e.animations),nt=this.parseShapes(_e.shapes),it=this.parseGeometries(_e.geometries,nt),st=await this.parseImagesAsync(_e.images),ot=this.parseTextures(_e.textures,st),lt=this.parseMaterials(_e.materials,ot),at=this.parseObject(_e.object,it,lt,ot,rt),ct=this.parseSkeletons(_e.skeletons,at);return this.bindSkeletons(at,ct),at}parseShapes(_e){const rt={};if(_e!==void 0)for(let nt=0,it=_e.length;nt<it;nt++){const st=new Shape().fromJSON(_e[nt]);rt[st.uuid]=st}return rt}parseSkeletons(_e,rt){const nt={},it={};if(rt.traverse(function(st){st.isBone&&(it[st.uuid]=st)}),_e!==void 0)for(let st=0,ot=_e.length;st<ot;st++){const lt=new Skeleton().fromJSON(_e[st],it);nt[lt.uuid]=lt}return nt}parseGeometries(_e,rt){const nt={};if(_e!==void 0){const it=new BufferGeometryLoader;for(let st=0,ot=_e.length;st<ot;st++){let lt;const at=_e[st];switch(at.type){case"BufferGeometry":case"InstancedBufferGeometry":lt=it.parse(at);break;default:at.type in Geometries?lt=Geometries[at.type].fromJSON(at,rt):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${at.type}"`)}lt.uuid=at.uuid,at.name!==void 0&&(lt.name=at.name),at.userData!==void 0&&(lt.userData=at.userData),nt[at.uuid]=lt}}return nt}parseMaterials(_e,rt){const nt={},it={};if(_e!==void 0){const st=new MaterialLoader;st.setTextures(rt);for(let ot=0,lt=_e.length;ot<lt;ot++){const at=_e[ot];nt[at.uuid]===void 0&&(nt[at.uuid]=st.parse(at)),it[at.uuid]=nt[at.uuid]}}return it}parseAnimations(_e){const rt={};if(_e!==void 0)for(let nt=0;nt<_e.length;nt++){const it=_e[nt],st=AnimationClip.parse(it);rt[st.uuid]=st}return rt}parseImages(_e,rt){const nt=this,it={};let st;function ot(at){return nt.manager.itemStart(at),st.load(at,function(){nt.manager.itemEnd(at)},void 0,function(){nt.manager.itemError(at),nt.manager.itemEnd(at)})}function lt(at){if(typeof at=="string"){const ct=at,ut=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(ct)?ct:nt.resourcePath+ct;return ot(ut)}else return at.data?{data:getTypedArray(at.type,at.data),width:at.width,height:at.height}:null}if(_e!==void 0&&_e.length>0){const at=new LoadingManager(rt);st=new ImageLoader(at),st.setCrossOrigin(this.crossOrigin);for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct],dt=ht.url;if(Array.isArray(dt)){const ft=[];for(let pt=0,mt=dt.length;pt<mt;pt++){const gt=dt[pt],vt=lt(gt);vt!==null&&(vt instanceof HTMLImageElement?ft.push(vt):ft.push(new DataTexture(vt.data,vt.width,vt.height)))}it[ht.uuid]=new Source(ft)}else{const ft=lt(ht.url);it[ht.uuid]=new Source(ft)}}}return it}async parseImagesAsync(_e){const rt=this,nt={};let it;async function st(ot){if(typeof ot=="string"){const lt=ot,at=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(lt)?lt:rt.resourcePath+lt;return await it.loadAsync(at)}else return ot.data?{data:getTypedArray(ot.type,ot.data),width:ot.width,height:ot.height}:null}if(_e!==void 0&&_e.length>0){it=new ImageLoader(this.manager),it.setCrossOrigin(this.crossOrigin);for(let ot=0,lt=_e.length;ot<lt;ot++){const at=_e[ot],ct=at.url;if(Array.isArray(ct)){const ut=[];for(let ht=0,dt=ct.length;ht<dt;ht++){const ft=ct[ht],pt=await st(ft);pt!==null&&(pt instanceof HTMLImageElement?ut.push(pt):ut.push(new DataTexture(pt.data,pt.width,pt.height)))}nt[at.uuid]=new Source(ut)}else{const ut=await st(at.url);nt[at.uuid]=new Source(ut)}}}return nt}parseTextures(_e,rt){function nt(st,ot){return typeof st=="number"?st:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",st),ot[st])}const it={};if(_e!==void 0)for(let st=0,ot=_e.length;st<ot;st++){const lt=_e[st];lt.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',lt.uuid),rt[lt.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",lt.image);const at=rt[lt.image],ct=at.data;let ut;Array.isArray(ct)?(ut=new CubeTexture,ct.length===6&&(ut.needsUpdate=!0)):(ct&&ct.data?ut=new DataTexture:ut=new Texture,ct&&(ut.needsUpdate=!0)),ut.source=at,ut.uuid=lt.uuid,lt.name!==void 0&&(ut.name=lt.name),lt.mapping!==void 0&&(ut.mapping=nt(lt.mapping,TEXTURE_MAPPING)),lt.channel!==void 0&&(ut.channel=lt.channel),lt.offset!==void 0&&ut.offset.fromArray(lt.offset),lt.repeat!==void 0&&ut.repeat.fromArray(lt.repeat),lt.center!==void 0&&ut.center.fromArray(lt.center),lt.rotation!==void 0&&(ut.rotation=lt.rotation),lt.wrap!==void 0&&(ut.wrapS=nt(lt.wrap[0],TEXTURE_WRAPPING),ut.wrapT=nt(lt.wrap[1],TEXTURE_WRAPPING)),lt.format!==void 0&&(ut.format=lt.format),lt.internalFormat!==void 0&&(ut.internalFormat=lt.internalFormat),lt.type!==void 0&&(ut.type=lt.type),lt.colorSpace!==void 0&&(ut.colorSpace=lt.colorSpace),lt.encoding!==void 0&&(ut.encoding=lt.encoding),lt.minFilter!==void 0&&(ut.minFilter=nt(lt.minFilter,TEXTURE_FILTER)),lt.magFilter!==void 0&&(ut.magFilter=nt(lt.magFilter,TEXTURE_FILTER)),lt.anisotropy!==void 0&&(ut.anisotropy=lt.anisotropy),lt.flipY!==void 0&&(ut.flipY=lt.flipY),lt.generateMipmaps!==void 0&&(ut.generateMipmaps=lt.generateMipmaps),lt.premultiplyAlpha!==void 0&&(ut.premultiplyAlpha=lt.premultiplyAlpha),lt.unpackAlignment!==void 0&&(ut.unpackAlignment=lt.unpackAlignment),lt.compareFunction!==void 0&&(ut.compareFunction=lt.compareFunction),lt.userData!==void 0&&(ut.userData=lt.userData),it[lt.uuid]=ut}return it}parseObject(_e,rt,nt,it,st){let ot;function lt(dt){return rt[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",dt),rt[dt]}function at(dt){if(dt!==void 0){if(Array.isArray(dt)){const ft=[];for(let pt=0,mt=dt.length;pt<mt;pt++){const gt=dt[pt];nt[gt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",gt),ft.push(nt[gt])}return ft}return nt[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",dt),nt[dt]}}function ct(dt){return it[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",dt),it[dt]}let ut,ht;switch(_e.type){case"Scene":ot=new Scene,_e.background!==void 0&&(Number.isInteger(_e.background)?ot.background=new Color$1(_e.background):ot.background=ct(_e.background)),_e.environment!==void 0&&(ot.environment=ct(_e.environment)),_e.fog!==void 0&&(_e.fog.type==="Fog"?ot.fog=new Fog(_e.fog.color,_e.fog.near,_e.fog.far):_e.fog.type==="FogExp2"&&(ot.fog=new FogExp2(_e.fog.color,_e.fog.density))),_e.backgroundBlurriness!==void 0&&(ot.backgroundBlurriness=_e.backgroundBlurriness),_e.backgroundIntensity!==void 0&&(ot.backgroundIntensity=_e.backgroundIntensity);break;case"PerspectiveCamera":ot=new PerspectiveCamera(_e.fov,_e.aspect,_e.near,_e.far),_e.focus!==void 0&&(ot.focus=_e.focus),_e.zoom!==void 0&&(ot.zoom=_e.zoom),_e.filmGauge!==void 0&&(ot.filmGauge=_e.filmGauge),_e.filmOffset!==void 0&&(ot.filmOffset=_e.filmOffset),_e.view!==void 0&&(ot.view=Object.assign({},_e.view));break;case"OrthographicCamera":ot=new OrthographicCamera(_e.left,_e.right,_e.top,_e.bottom,_e.near,_e.far),_e.zoom!==void 0&&(ot.zoom=_e.zoom),_e.view!==void 0&&(ot.view=Object.assign({},_e.view));break;case"AmbientLight":ot=new AmbientLight(_e.color,_e.intensity);break;case"DirectionalLight":ot=new DirectionalLight(_e.color,_e.intensity);break;case"PointLight":ot=new PointLight(_e.color,_e.intensity,_e.distance,_e.decay);break;case"RectAreaLight":ot=new RectAreaLight(_e.color,_e.intensity,_e.width,_e.height);break;case"SpotLight":ot=new SpotLight(_e.color,_e.intensity,_e.distance,_e.angle,_e.penumbra,_e.decay);break;case"HemisphereLight":ot=new HemisphereLight(_e.color,_e.groundColor,_e.intensity);break;case"LightProbe":ot=new LightProbe().fromJSON(_e);break;case"SkinnedMesh":ut=lt(_e.geometry),ht=at(_e.material),ot=new SkinnedMesh(ut,ht),_e.bindMode!==void 0&&(ot.bindMode=_e.bindMode),_e.bindMatrix!==void 0&&ot.bindMatrix.fromArray(_e.bindMatrix),_e.skeleton!==void 0&&(ot.skeleton=_e.skeleton);break;case"Mesh":ut=lt(_e.geometry),ht=at(_e.material),ot=new Mesh(ut,ht);break;case"InstancedMesh":ut=lt(_e.geometry),ht=at(_e.material);const dt=_e.count,ft=_e.instanceMatrix,pt=_e.instanceColor;ot=new InstancedMesh(ut,ht,dt),ot.instanceMatrix=new InstancedBufferAttribute(new Float32Array(ft.array),16),pt!==void 0&&(ot.instanceColor=new InstancedBufferAttribute(new Float32Array(pt.array),pt.itemSize));break;case"LOD":ot=new LOD;break;case"Line":ot=new Line(lt(_e.geometry),at(_e.material));break;case"LineLoop":ot=new LineLoop(lt(_e.geometry),at(_e.material));break;case"LineSegments":ot=new LineSegments(lt(_e.geometry),at(_e.material));break;case"PointCloud":case"Points":ot=new Points(lt(_e.geometry),at(_e.material));break;case"Sprite":ot=new Sprite(at(_e.material));break;case"Group":ot=new Group;break;case"Bone":ot=new Bone;break;default:ot=new Object3D}if(ot.uuid=_e.uuid,_e.name!==void 0&&(ot.name=_e.name),_e.matrix!==void 0?(ot.matrix.fromArray(_e.matrix),_e.matrixAutoUpdate!==void 0&&(ot.matrixAutoUpdate=_e.matrixAutoUpdate),ot.matrixAutoUpdate&&ot.matrix.decompose(ot.position,ot.quaternion,ot.scale)):(_e.position!==void 0&&ot.position.fromArray(_e.position),_e.rotation!==void 0&&ot.rotation.fromArray(_e.rotation),_e.quaternion!==void 0&&ot.quaternion.fromArray(_e.quaternion),_e.scale!==void 0&&ot.scale.fromArray(_e.scale)),_e.up!==void 0&&ot.up.fromArray(_e.up),_e.castShadow!==void 0&&(ot.castShadow=_e.castShadow),_e.receiveShadow!==void 0&&(ot.receiveShadow=_e.receiveShadow),_e.shadow&&(_e.shadow.bias!==void 0&&(ot.shadow.bias=_e.shadow.bias),_e.shadow.normalBias!==void 0&&(ot.shadow.normalBias=_e.shadow.normalBias),_e.shadow.radius!==void 0&&(ot.shadow.radius=_e.shadow.radius),_e.shadow.mapSize!==void 0&&ot.shadow.mapSize.fromArray(_e.shadow.mapSize),_e.shadow.camera!==void 0&&(ot.shadow.camera=this.parseObject(_e.shadow.camera))),_e.visible!==void 0&&(ot.visible=_e.visible),_e.frustumCulled!==void 0&&(ot.frustumCulled=_e.frustumCulled),_e.renderOrder!==void 0&&(ot.renderOrder=_e.renderOrder),_e.userData!==void 0&&(ot.userData=_e.userData),_e.layers!==void 0&&(ot.layers.mask=_e.layers),_e.children!==void 0){const dt=_e.children;for(let ft=0;ft<dt.length;ft++)ot.add(this.parseObject(dt[ft],rt,nt,it,st))}if(_e.animations!==void 0){const dt=_e.animations;for(let ft=0;ft<dt.length;ft++){const pt=dt[ft];ot.animations.push(st[pt])}}if(_e.type==="LOD"){_e.autoUpdate!==void 0&&(ot.autoUpdate=_e.autoUpdate);const dt=_e.levels;for(let ft=0;ft<dt.length;ft++){const pt=dt[ft],mt=ot.getObjectByProperty("uuid",pt.object);mt!==void 0&&ot.addLevel(mt,pt.distance,pt.hysteresis)}}return ot}bindSkeletons(_e,rt){Object.keys(rt).length!==0&&_e.traverse(function(nt){if(nt.isSkinnedMesh===!0&&nt.skeleton!==void 0){const it=rt[nt.skeleton];it===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",nt.skeleton):nt.bind(it,nt.bindMatrix)}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(_e){super(_e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_e){return this.options=_e,this}load(_e,rt,nt,it){_e===void 0&&(_e=""),this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=this,ot=Cache.get(_e);if(ot!==void 0)return st.manager.itemStart(_e),setTimeout(function(){rt&&rt(ot),st.manager.itemEnd(_e)},0),ot;const lt={};lt.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",lt.headers=this.requestHeader,fetch(_e,lt).then(function(at){return at.blob()}).then(function(at){return createImageBitmap(at,Object.assign(st.options,{colorSpaceConversion:"none"}))}).then(function(at){Cache.add(_e,at),rt&&rt(at),st.manager.itemEnd(_e)}).catch(function(at){it&&it(at),st.manager.itemError(_e),st.manager.itemEnd(_e)}),st.manager.itemStart(_e)}}let _context;class AudioContext{static getContext(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context}static setContext(_e){_context=_e}}class AudioLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,nt,it){const st=this,ot=new FileLoader(this.manager);ot.setResponseType("arraybuffer"),ot.setPath(this.path),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(this.withCredentials),ot.load(_e,function(at){try{const ct=at.slice(0);AudioContext.getContext().decodeAudioData(ct,function(ht){rt(ht)},lt)}catch(ct){lt(ct)}},nt,it);function lt(at){it?it(at):console.error(at),st.manager.itemError(_e)}}}class HemisphereLightProbe extends LightProbe{constructor(_e,rt,nt=1){super(void 0,nt),this.isHemisphereLightProbe=!0;const it=new Color$1().set(_e),st=new Color$1().set(rt),ot=new Vector3(it.r,it.g,it.b),lt=new Vector3(st.r,st.g,st.b),at=Math.sqrt(Math.PI),ct=at*Math.sqrt(.75);this.sh.coefficients[0].copy(ot).add(lt).multiplyScalar(at),this.sh.coefficients[1].copy(ot).sub(lt).multiplyScalar(ct)}}class AmbientLightProbe extends LightProbe{constructor(_e,rt=1){super(void 0,rt),this.isAmbientLightProbe=!0;const nt=new Color$1().set(_e);this.sh.coefficients[0].set(nt.r,nt.g,nt.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_e){const rt=this._cache;if(rt.focus!==_e.focus||rt.fov!==_e.fov||rt.aspect!==_e.aspect*this.aspect||rt.near!==_e.near||rt.far!==_e.far||rt.zoom!==_e.zoom||rt.eyeSep!==this.eyeSep){rt.focus=_e.focus,rt.fov=_e.fov,rt.aspect=_e.aspect*this.aspect,rt.near=_e.near,rt.far=_e.far,rt.zoom=_e.zoom,rt.eyeSep=this.eyeSep,_projectionMatrix.copy(_e.projectionMatrix);const it=rt.eyeSep/2,st=it*rt.near/rt.focus,ot=rt.near*Math.tan(DEG2RAD*rt.fov*.5)/rt.zoom;let lt,at;_eyeLeft.elements[12]=-it,_eyeRight.elements[12]=it,lt=-ot*rt.aspect+st,at=ot*rt.aspect+st,_projectionMatrix.elements[0]=2*rt.near/(at-lt),_projectionMatrix.elements[8]=(at+lt)/(at-lt),this.cameraL.projectionMatrix.copy(_projectionMatrix),lt=-ot*rt.aspect-st,at=ot*rt.aspect-st,_projectionMatrix.elements[0]=2*rt.near/(at-lt),_projectionMatrix.elements[8]=(at+lt)/(at-lt),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(_e.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(_e.matrixWorld).multiply(_eyeRight)}}class Clock{constructor(_e=!0){this.autoStart=_e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now$2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const rt=now$2();_e=(rt-this.oldTime)/1e3,this.oldTime=rt,this.elapsedTime+=_e}return _e}}function now$2(){return(typeof performance>"u"?Date:performance).now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_e){return this.gain.gain.setTargetAtTime(_e,this.context.currentTime,.01),this}updateMatrixWorld(_e){super.updateMatrixWorld(_e);const rt=this.context.listener,nt=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),rt.positionX){const it=this.context.currentTime+this.timeDelta;rt.positionX.linearRampToValueAtTime(_position$1.x,it),rt.positionY.linearRampToValueAtTime(_position$1.y,it),rt.positionZ.linearRampToValueAtTime(_position$1.z,it),rt.forwardX.linearRampToValueAtTime(_orientation$1.x,it),rt.forwardY.linearRampToValueAtTime(_orientation$1.y,it),rt.forwardZ.linearRampToValueAtTime(_orientation$1.z,it),rt.upX.linearRampToValueAtTime(nt.x,it),rt.upY.linearRampToValueAtTime(nt.y,it),rt.upZ.linearRampToValueAtTime(nt.z,it)}else rt.setPosition(_position$1.x,_position$1.y,_position$1.z),rt.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,nt.x,nt.y,nt.z)}}class Audio extends Object3D{constructor(_e){super(),this.type="Audio",this.listener=_e,this.context=_e.context,this.gain=this.context.createGain(),this.gain.connect(_e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_e,this.connect(),this}setMediaElementSource(_e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_e),this.connect(),this}setMediaStreamSource(_e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_e),this.connect(),this}setBuffer(_e){return this.buffer=_e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+_e;const rt=this.context.createBufferSource();return rt.buffer=this.buffer,rt.loop=this.loop,rt.loopStart=this.loopStart,rt.loopEnd=this.loopEnd,rt.onended=this.onEnded.bind(this),rt.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=rt,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _e=1,rt=this.filters.length;_e<rt;_e++)this.filters[_e-1].connect(this.filters[_e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _e=1,rt=this.filters.length;_e<rt;_e++)this.filters[_e-1].disconnect(this.filters[_e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(_e){return _e||(_e=[]),this._connected===!0?(this.disconnect(),this.filters=_e.slice(),this.connect()):this.filters=_e.slice(),this}setDetune(_e){if(this.detune=_e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_e){return this.setFilters(_e?[_e]:[])}setPlaybackRate(_e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=_e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=_e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(_e){return this.loopStart=_e,this}setLoopEnd(_e){return this.loopEnd=_e,this}getVolume(){return this.gain.gain.value}setVolume(_e){return this.gain.gain.setTargetAtTime(_e,this.context.currentTime,.01),this}}const _position=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_orientation=new Vector3;class PositionalAudio extends Audio{constructor(_e){super(_e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_e){return this.panner.refDistance=_e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_e){return this.panner.rolloffFactor=_e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_e){return this.panner.distanceModel=_e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_e){return this.panner.maxDistance=_e,this}setDirectionalCone(_e,rt,nt){return this.panner.coneInnerAngle=_e,this.panner.coneOuterAngle=rt,this.panner.coneOuterGain=nt,this}updateMatrixWorld(_e){if(super.updateMatrixWorld(_e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position,_quaternion,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion);const rt=this.panner;if(rt.positionX){const nt=this.context.currentTime+this.listener.timeDelta;rt.positionX.linearRampToValueAtTime(_position.x,nt),rt.positionY.linearRampToValueAtTime(_position.y,nt),rt.positionZ.linearRampToValueAtTime(_position.z,nt),rt.orientationX.linearRampToValueAtTime(_orientation.x,nt),rt.orientationY.linearRampToValueAtTime(_orientation.y,nt),rt.orientationZ.linearRampToValueAtTime(_orientation.z,nt)}else rt.setPosition(_position.x,_position.y,_position.z),rt.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(_e,rt=2048){this.analyser=_e.context.createAnalyser(),this.analyser.fftSize=rt,this.data=new Uint8Array(this.analyser.frequencyBinCount),_e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _e=0;const rt=this.getFrequencyData();for(let nt=0;nt<rt.length;nt++)_e+=rt[nt];return _e/rt.length}}class PropertyMixer{constructor(_e,rt,nt){this.binding=_e,this.valueSize=nt;let it,st,ot;switch(rt){case"quaternion":it=this._slerp,st=this._slerpAdditive,ot=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(nt*6),this._workIndex=5;break;case"string":case"bool":it=this._select,st=this._select,ot=this._setAdditiveIdentityOther,this.buffer=new Array(nt*5);break;default:it=this._lerp,st=this._lerpAdditive,ot=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(nt*5)}this._mixBufferRegion=it,this._mixBufferRegionAdditive=st,this._setIdentity=ot,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_e,rt){const nt=this.buffer,it=this.valueSize,st=_e*it+it;let ot=this.cumulativeWeight;if(ot===0){for(let lt=0;lt!==it;++lt)nt[st+lt]=nt[lt];ot=rt}else{ot+=rt;const lt=rt/ot;this._mixBufferRegion(nt,st,0,lt,it)}this.cumulativeWeight=ot}accumulateAdditive(_e){const rt=this.buffer,nt=this.valueSize,it=nt*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(rt,it,0,_e,nt),this.cumulativeWeightAdditive+=_e}apply(_e){const rt=this.valueSize,nt=this.buffer,it=_e*rt+rt,st=this.cumulativeWeight,ot=this.cumulativeWeightAdditive,lt=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,st<1){const at=rt*this._origIndex;this._mixBufferRegion(nt,it,at,1-st,rt)}ot>0&&this._mixBufferRegionAdditive(nt,it,this._addIndex*rt,1,rt);for(let at=rt,ct=rt+rt;at!==ct;++at)if(nt[at]!==nt[at+rt]){lt.setValue(nt,it);break}}saveOriginalState(){const _e=this.binding,rt=this.buffer,nt=this.valueSize,it=nt*this._origIndex;_e.getValue(rt,it);for(let st=nt,ot=it;st!==ot;++st)rt[st]=rt[it+st%nt];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _e=this.valueSize*3;this.binding.setValue(this.buffer,_e)}_setAdditiveIdentityNumeric(){const _e=this._addIndex*this.valueSize,rt=_e+this.valueSize;for(let nt=_e;nt<rt;nt++)this.buffer[nt]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _e=this._origIndex*this.valueSize,rt=this._addIndex*this.valueSize;for(let nt=0;nt<this.valueSize;nt++)this.buffer[rt+nt]=this.buffer[_e+nt]}_select(_e,rt,nt,it,st){if(it>=.5)for(let ot=0;ot!==st;++ot)_e[rt+ot]=_e[nt+ot]}_slerp(_e,rt,nt,it){Quaternion.slerpFlat(_e,rt,_e,rt,_e,nt,it)}_slerpAdditive(_e,rt,nt,it,st){const ot=this._workIndex*st;Quaternion.multiplyQuaternionsFlat(_e,ot,_e,rt,_e,nt),Quaternion.slerpFlat(_e,rt,_e,rt,_e,ot,it)}_lerp(_e,rt,nt,it,st){const ot=1-it;for(let lt=0;lt!==st;++lt){const at=rt+lt;_e[at]=_e[at]*ot+_e[nt+lt]*it}}_lerpAdditive(_e,rt,nt,it,st){for(let ot=0;ot!==st;++ot){const lt=rt+ot;_e[lt]=_e[lt]+_e[nt+ot]*it}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_e,rt,nt){const it=nt||PropertyBinding.parseTrackName(rt);this._targetGroup=_e,this._bindings=_e.subscribe_(rt,it)}getValue(_e,rt){this.bind();const nt=this._targetGroup.nCachedObjects_,it=this._bindings[nt];it!==void 0&&it.getValue(_e,rt)}setValue(_e,rt){const nt=this._bindings;for(let it=this._targetGroup.nCachedObjects_,st=nt.length;it!==st;++it)nt[it].setValue(_e,rt)}bind(){const _e=this._bindings;for(let rt=this._targetGroup.nCachedObjects_,nt=_e.length;rt!==nt;++rt)_e[rt].bind()}unbind(){const _e=this._bindings;for(let rt=this._targetGroup.nCachedObjects_,nt=_e.length;rt!==nt;++rt)_e[rt].unbind()}}class PropertyBinding{constructor(_e,rt,nt){this.path=rt,this.parsedPath=nt||PropertyBinding.parseTrackName(rt),this.node=PropertyBinding.findNode(_e,this.parsedPath.nodeName),this.rootNode=_e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_e,rt,nt){return _e&&_e.isAnimationObjectGroup?new PropertyBinding.Composite(_e,rt,nt):new PropertyBinding(_e,rt,nt)}static sanitizeNodeName(_e){return _e.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_e){const rt=_trackRe.exec(_e);if(rt===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_e);const nt={nodeName:rt[2],objectName:rt[3],objectIndex:rt[4],propertyName:rt[5],propertyIndex:rt[6]},it=nt.nodeName&&nt.nodeName.lastIndexOf(".");if(it!==void 0&&it!==-1){const st=nt.nodeName.substring(it+1);_supportedObjectNames.indexOf(st)!==-1&&(nt.nodeName=nt.nodeName.substring(0,it),nt.objectName=st)}if(nt.propertyName===null||nt.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_e);return nt}static findNode(_e,rt){if(rt===void 0||rt===""||rt==="."||rt===-1||rt===_e.name||rt===_e.uuid)return _e;if(_e.skeleton){const nt=_e.skeleton.getBoneByName(rt);if(nt!==void 0)return nt}if(_e.children){const nt=function(st){for(let ot=0;ot<st.length;ot++){const lt=st[ot];if(lt.name===rt||lt.uuid===rt)return lt;const at=nt(lt.children);if(at)return at}return null},it=nt(_e.children);if(it)return it}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_e,rt){_e[rt]=this.targetObject[this.propertyName]}_getValue_array(_e,rt){const nt=this.resolvedProperty;for(let it=0,st=nt.length;it!==st;++it)_e[rt++]=nt[it]}_getValue_arrayElement(_e,rt){_e[rt]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_e,rt){this.resolvedProperty.toArray(_e,rt)}_setValue_direct(_e,rt){this.targetObject[this.propertyName]=_e[rt]}_setValue_direct_setNeedsUpdate(_e,rt){this.targetObject[this.propertyName]=_e[rt],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_e,rt){this.targetObject[this.propertyName]=_e[rt],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_e,rt){const nt=this.resolvedProperty;for(let it=0,st=nt.length;it!==st;++it)nt[it]=_e[rt++]}_setValue_array_setNeedsUpdate(_e,rt){const nt=this.resolvedProperty;for(let it=0,st=nt.length;it!==st;++it)nt[it]=_e[rt++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_e,rt){const nt=this.resolvedProperty;for(let it=0,st=nt.length;it!==st;++it)nt[it]=_e[rt++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_e,rt){this.resolvedProperty[this.propertyIndex]=_e[rt]}_setValue_arrayElement_setNeedsUpdate(_e,rt){this.resolvedProperty[this.propertyIndex]=_e[rt],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_e,rt){this.resolvedProperty[this.propertyIndex]=_e[rt],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_e,rt){this.resolvedProperty.fromArray(_e,rt)}_setValue_fromArray_setNeedsUpdate(_e,rt){this.resolvedProperty.fromArray(_e,rt),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_e,rt){this.resolvedProperty.fromArray(_e,rt),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_e,rt){this.bind(),this.getValue(_e,rt)}_setValue_unbound(_e,rt){this.bind(),this.setValue(_e,rt)}bind(){let _e=this.node;const rt=this.parsedPath,nt=rt.objectName,it=rt.propertyName;let st=rt.propertyIndex;if(_e||(_e=PropertyBinding.findNode(this.rootNode,rt.nodeName),this.node=_e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(nt){let ct=rt.objectIndex;switch(nt){case"materials":if(!_e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_e=_e.material.materials;break;case"bones":if(!_e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_e=_e.skeleton.bones;for(let ut=0;ut<_e.length;ut++)if(_e[ut].name===ct){ct=ut;break}break;case"map":if("map"in _e){_e=_e.map;break}if(!_e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_e=_e.material.map;break;default:if(_e[nt]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_e=_e[nt]}if(ct!==void 0){if(_e[ct]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_e);return}_e=_e[ct]}}const ot=_e[it];if(ot===void 0){const ct=rt.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+ct+"."+it+" but it wasn't found.",_e);return}let lt=this.Versioning.None;this.targetObject=_e,_e.needsUpdate!==void 0?lt=this.Versioning.NeedsUpdate:_e.matrixWorldNeedsUpdate!==void 0&&(lt=this.Versioning.MatrixWorldNeedsUpdate);let at=this.BindingType.Direct;if(st!==void 0){if(it==="morphTargetInfluences"){if(!_e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_e.morphTargetDictionary[st]!==void 0&&(st=_e.morphTargetDictionary[st])}at=this.BindingType.ArrayElement,this.resolvedProperty=ot,this.propertyIndex=st}else ot.fromArray!==void 0&&ot.toArray!==void 0?(at=this.BindingType.HasFromToArray,this.resolvedProperty=ot):Array.isArray(ot)?(at=this.BindingType.EntireArray,this.resolvedProperty=ot):this.propertyName=it;this.getValue=this.GetterByBindingType[at],this.setValue=this.SetterByBindingTypeAndVersioning[at][lt]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID$1(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _e={};this._indicesByUUID=_e;for(let nt=0,it=arguments.length;nt!==it;++nt)_e[arguments[nt].uuid]=nt;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const rt=this;this.stats={objects:{get total(){return rt._objects.length},get inUse(){return this.total-rt.nCachedObjects_}},get bindingsPerObject(){return rt._bindings.length}}}add(){const _e=this._objects,rt=this._indicesByUUID,nt=this._paths,it=this._parsedPaths,st=this._bindings,ot=st.length;let lt,at=_e.length,ct=this.nCachedObjects_;for(let ut=0,ht=arguments.length;ut!==ht;++ut){const dt=arguments[ut],ft=dt.uuid;let pt=rt[ft];if(pt===void 0){pt=at++,rt[ft]=pt,_e.push(dt);for(let mt=0,gt=ot;mt!==gt;++mt)st[mt].push(new PropertyBinding(dt,nt[mt],it[mt]))}else if(pt<ct){lt=_e[pt];const mt=--ct,gt=_e[mt];rt[gt.uuid]=pt,_e[pt]=gt,rt[ft]=mt,_e[mt]=dt;for(let vt=0,At=ot;vt!==At;++vt){const yt=st[vt],xt=yt[mt];let _t=yt[pt];yt[pt]=xt,_t===void 0&&(_t=new PropertyBinding(dt,nt[vt],it[vt])),yt[mt]=_t}}else _e[pt]!==lt&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=ct}remove(){const _e=this._objects,rt=this._indicesByUUID,nt=this._bindings,it=nt.length;let st=this.nCachedObjects_;for(let ot=0,lt=arguments.length;ot!==lt;++ot){const at=arguments[ot],ct=at.uuid,ut=rt[ct];if(ut!==void 0&&ut>=st){const ht=st++,dt=_e[ht];rt[dt.uuid]=ut,_e[ut]=dt,rt[ct]=ht,_e[ht]=at;for(let ft=0,pt=it;ft!==pt;++ft){const mt=nt[ft],gt=mt[ht],vt=mt[ut];mt[ut]=gt,mt[ht]=vt}}}this.nCachedObjects_=st}uncache(){const _e=this._objects,rt=this._indicesByUUID,nt=this._bindings,it=nt.length;let st=this.nCachedObjects_,ot=_e.length;for(let lt=0,at=arguments.length;lt!==at;++lt){const ct=arguments[lt],ut=ct.uuid,ht=rt[ut];if(ht!==void 0)if(delete rt[ut],ht<st){const dt=--st,ft=_e[dt],pt=--ot,mt=_e[pt];rt[ft.uuid]=ht,_e[ht]=ft,rt[mt.uuid]=dt,_e[dt]=mt,_e.pop();for(let gt=0,vt=it;gt!==vt;++gt){const At=nt[gt],yt=At[dt],xt=At[pt];At[ht]=yt,At[dt]=xt,At.pop()}}else{const dt=--ot,ft=_e[dt];dt>0&&(rt[ft.uuid]=ht),_e[ht]=ft,_e.pop();for(let pt=0,mt=it;pt!==mt;++pt){const gt=nt[pt];gt[ht]=gt[dt],gt.pop()}}}this.nCachedObjects_=st}subscribe_(_e,rt){const nt=this._bindingsIndicesByPath;let it=nt[_e];const st=this._bindings;if(it!==void 0)return st[it];const ot=this._paths,lt=this._parsedPaths,at=this._objects,ct=at.length,ut=this.nCachedObjects_,ht=new Array(ct);it=st.length,nt[_e]=it,ot.push(_e),lt.push(rt),st.push(ht);for(let dt=ut,ft=at.length;dt!==ft;++dt){const pt=at[dt];ht[dt]=new PropertyBinding(pt,_e,rt)}return ht}unsubscribe_(_e){const rt=this._bindingsIndicesByPath,nt=rt[_e];if(nt!==void 0){const it=this._paths,st=this._parsedPaths,ot=this._bindings,lt=ot.length-1,at=ot[lt],ct=_e[lt];rt[ct]=nt,ot[nt]=at,ot.pop(),st[nt]=st[lt],st.pop(),it[nt]=it[lt],it.pop()}}}class AnimationAction{constructor(_e,rt,nt=null,it=rt.blendMode){this._mixer=_e,this._clip=rt,this._localRoot=nt,this.blendMode=it;const st=rt.tracks,ot=st.length,lt=new Array(ot),at={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let ct=0;ct!==ot;++ct){const ut=st[ct].createInterpolant(null);lt[ct]=ut,ut.settings=at}this._interpolantSettings=at,this._interpolants=lt,this._propertyBindings=new Array(ot),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_e){return this._startTime=_e,this}setLoop(_e,rt){return this.loop=_e,this.repetitions=rt,this}setEffectiveWeight(_e){return this.weight=_e,this._effectiveWeight=this.enabled?_e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_e){return this._scheduleFading(_e,0,1)}fadeOut(_e){return this._scheduleFading(_e,1,0)}crossFadeFrom(_e,rt,nt){if(_e.fadeOut(rt),this.fadeIn(rt),nt){const it=this._clip.duration,st=_e._clip.duration,ot=st/it,lt=it/st;_e.warp(1,ot,rt),this.warp(lt,1,rt)}return this}crossFadeTo(_e,rt,nt){return _e.crossFadeFrom(this,rt,nt)}stopFading(){const _e=this._weightInterpolant;return _e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_e)),this}setEffectiveTimeScale(_e){return this.timeScale=_e,this._effectiveTimeScale=this.paused?0:_e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_e){return this.timeScale=this._clip.duration/_e,this.stopWarping()}syncWith(_e){return this.time=_e.time,this.timeScale=_e.timeScale,this.stopWarping()}halt(_e){return this.warp(this._effectiveTimeScale,0,_e)}warp(_e,rt,nt){const it=this._mixer,st=it.time,ot=this.timeScale;let lt=this._timeScaleInterpolant;lt===null&&(lt=it._lendControlInterpolant(),this._timeScaleInterpolant=lt);const at=lt.parameterPositions,ct=lt.sampleValues;return at[0]=st,at[1]=st+nt,ct[0]=_e/ot,ct[1]=rt/ot,this}stopWarping(){const _e=this._timeScaleInterpolant;return _e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_e,rt,nt,it){if(!this.enabled){this._updateWeight(_e);return}const st=this._startTime;if(st!==null){const at=(_e-st)*nt;at<0||nt===0?rt=0:(this._startTime=null,rt=nt*at)}rt*=this._updateTimeScale(_e);const ot=this._updateTime(rt),lt=this._updateWeight(_e);if(lt>0){const at=this._interpolants,ct=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let ut=0,ht=at.length;ut!==ht;++ut)at[ut].evaluate(ot),ct[ut].accumulateAdditive(lt);break;case NormalAnimationBlendMode:default:for(let ut=0,ht=at.length;ut!==ht;++ut)at[ut].evaluate(ot),ct[ut].accumulate(it,lt)}}}_updateWeight(_e){let rt=0;if(this.enabled){rt=this.weight;const nt=this._weightInterpolant;if(nt!==null){const it=nt.evaluate(_e)[0];rt*=it,_e>nt.parameterPositions[1]&&(this.stopFading(),it===0&&(this.enabled=!1))}}return this._effectiveWeight=rt,rt}_updateTimeScale(_e){let rt=0;if(!this.paused){rt=this.timeScale;const nt=this._timeScaleInterpolant;if(nt!==null){const it=nt.evaluate(_e)[0];rt*=it,_e>nt.parameterPositions[1]&&(this.stopWarping(),rt===0?this.paused=!0:this.timeScale=rt)}}return this._effectiveTimeScale=rt,rt}_updateTime(_e){const rt=this._clip.duration,nt=this.loop;let it=this.time+_e,st=this._loopCount;const ot=nt===LoopPingPong;if(_e===0)return st===-1?it:ot&&(st&1)===1?rt-it:it;if(nt===LoopOnce){st===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(it>=rt)it=rt;else if(it<0)it=0;else{this.time=it;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=it,this._mixer.dispatchEvent({type:"finished",action:this,direction:_e<0?-1:1})}}else{if(st===-1&&(_e>=0?(st=0,this._setEndings(!0,this.repetitions===0,ot)):this._setEndings(this.repetitions===0,!0,ot)),it>=rt||it<0){const lt=Math.floor(it/rt);it-=rt*lt,st+=Math.abs(lt);const at=this.repetitions-st;if(at<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,it=_e>0?rt:0,this.time=it,this._mixer.dispatchEvent({type:"finished",action:this,direction:_e>0?1:-1});else{if(at===1){const ct=_e<0;this._setEndings(ct,!ct,ot)}else this._setEndings(!1,!1,ot);this._loopCount=st,this.time=it,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:lt})}}else this.time=it;if(ot&&(st&1)===1)return rt-it}return it}_setEndings(_e,rt,nt){const it=this._interpolantSettings;nt?(it.endingStart=ZeroSlopeEnding,it.endingEnd=ZeroSlopeEnding):(_e?it.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:it.endingStart=WrapAroundEnding,rt?it.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:it.endingEnd=WrapAroundEnding)}_scheduleFading(_e,rt,nt){const it=this._mixer,st=it.time;let ot=this._weightInterpolant;ot===null&&(ot=it._lendControlInterpolant(),this._weightInterpolant=ot);const lt=ot.parameterPositions,at=ot.sampleValues;return lt[0]=st,at[0]=rt,lt[1]=st+_e,at[1]=nt,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(_e){super(),this._root=_e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_e,rt){const nt=_e._localRoot||this._root,it=_e._clip.tracks,st=it.length,ot=_e._propertyBindings,lt=_e._interpolants,at=nt.uuid,ct=this._bindingsByRootAndName;let ut=ct[at];ut===void 0&&(ut={},ct[at]=ut);for(let ht=0;ht!==st;++ht){const dt=it[ht],ft=dt.name;let pt=ut[ft];if(pt!==void 0)++pt.referenceCount,ot[ht]=pt;else{if(pt=ot[ht],pt!==void 0){pt._cacheIndex===null&&(++pt.referenceCount,this._addInactiveBinding(pt,at,ft));continue}const mt=rt&&rt._propertyBindings[ht].binding.parsedPath;pt=new PropertyMixer(PropertyBinding.create(nt,ft,mt),dt.ValueTypeName,dt.getValueSize()),++pt.referenceCount,this._addInactiveBinding(pt,at,ft),ot[ht]=pt}lt[ht].resultBuffer=pt.buffer}}_activateAction(_e){if(!this._isActiveAction(_e)){if(_e._cacheIndex===null){const nt=(_e._localRoot||this._root).uuid,it=_e._clip.uuid,st=this._actionsByClip[it];this._bindAction(_e,st&&st.knownActions[0]),this._addInactiveAction(_e,it,nt)}const rt=_e._propertyBindings;for(let nt=0,it=rt.length;nt!==it;++nt){const st=rt[nt];st.useCount++===0&&(this._lendBinding(st),st.saveOriginalState())}this._lendAction(_e)}}_deactivateAction(_e){if(this._isActiveAction(_e)){const rt=_e._propertyBindings;for(let nt=0,it=rt.length;nt!==it;++nt){const st=rt[nt];--st.useCount===0&&(st.restoreOriginalState(),this._takeBackBinding(st))}this._takeBackAction(_e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _e=this;this.stats={actions:{get total(){return _e._actions.length},get inUse(){return _e._nActiveActions}},bindings:{get total(){return _e._bindings.length},get inUse(){return _e._nActiveBindings}},controlInterpolants:{get total(){return _e._controlInterpolants.length},get inUse(){return _e._nActiveControlInterpolants}}}}_isActiveAction(_e){const rt=_e._cacheIndex;return rt!==null&&rt<this._nActiveActions}_addInactiveAction(_e,rt,nt){const it=this._actions,st=this._actionsByClip;let ot=st[rt];if(ot===void 0)ot={knownActions:[_e],actionByRoot:{}},_e._byClipCacheIndex=0,st[rt]=ot;else{const lt=ot.knownActions;_e._byClipCacheIndex=lt.length,lt.push(_e)}_e._cacheIndex=it.length,it.push(_e),ot.actionByRoot[nt]=_e}_removeInactiveAction(_e){const rt=this._actions,nt=rt[rt.length-1],it=_e._cacheIndex;nt._cacheIndex=it,rt[it]=nt,rt.pop(),_e._cacheIndex=null;const st=_e._clip.uuid,ot=this._actionsByClip,lt=ot[st],at=lt.knownActions,ct=at[at.length-1],ut=_e._byClipCacheIndex;ct._byClipCacheIndex=ut,at[ut]=ct,at.pop(),_e._byClipCacheIndex=null;const ht=lt.actionByRoot,dt=(_e._localRoot||this._root).uuid;delete ht[dt],at.length===0&&delete ot[st],this._removeInactiveBindingsForAction(_e)}_removeInactiveBindingsForAction(_e){const rt=_e._propertyBindings;for(let nt=0,it=rt.length;nt!==it;++nt){const st=rt[nt];--st.referenceCount===0&&this._removeInactiveBinding(st)}}_lendAction(_e){const rt=this._actions,nt=_e._cacheIndex,it=this._nActiveActions++,st=rt[it];_e._cacheIndex=it,rt[it]=_e,st._cacheIndex=nt,rt[nt]=st}_takeBackAction(_e){const rt=this._actions,nt=_e._cacheIndex,it=--this._nActiveActions,st=rt[it];_e._cacheIndex=it,rt[it]=_e,st._cacheIndex=nt,rt[nt]=st}_addInactiveBinding(_e,rt,nt){const it=this._bindingsByRootAndName,st=this._bindings;let ot=it[rt];ot===void 0&&(ot={},it[rt]=ot),ot[nt]=_e,_e._cacheIndex=st.length,st.push(_e)}_removeInactiveBinding(_e){const rt=this._bindings,nt=_e.binding,it=nt.rootNode.uuid,st=nt.path,ot=this._bindingsByRootAndName,lt=ot[it],at=rt[rt.length-1],ct=_e._cacheIndex;at._cacheIndex=ct,rt[ct]=at,rt.pop(),delete lt[st],Object.keys(lt).length===0&&delete ot[it]}_lendBinding(_e){const rt=this._bindings,nt=_e._cacheIndex,it=this._nActiveBindings++,st=rt[it];_e._cacheIndex=it,rt[it]=_e,st._cacheIndex=nt,rt[nt]=st}_takeBackBinding(_e){const rt=this._bindings,nt=_e._cacheIndex,it=--this._nActiveBindings,st=rt[it];_e._cacheIndex=it,rt[it]=_e,st._cacheIndex=nt,rt[nt]=st}_lendControlInterpolant(){const _e=this._controlInterpolants,rt=this._nActiveControlInterpolants++;let nt=_e[rt];return nt===void 0&&(nt=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),nt.__cacheIndex=rt,_e[rt]=nt),nt}_takeBackControlInterpolant(_e){const rt=this._controlInterpolants,nt=_e.__cacheIndex,it=--this._nActiveControlInterpolants,st=rt[it];_e.__cacheIndex=it,rt[it]=_e,st.__cacheIndex=nt,rt[nt]=st}clipAction(_e,rt,nt){const it=rt||this._root,st=it.uuid;let ot=typeof _e=="string"?AnimationClip.findByName(it,_e):_e;const lt=ot!==null?ot.uuid:_e,at=this._actionsByClip[lt];let ct=null;if(nt===void 0&&(ot!==null?nt=ot.blendMode:nt=NormalAnimationBlendMode),at!==void 0){const ht=at.actionByRoot[st];if(ht!==void 0&&ht.blendMode===nt)return ht;ct=at.knownActions[0],ot===null&&(ot=ct._clip)}if(ot===null)return null;const ut=new AnimationAction(this,ot,rt,nt);return this._bindAction(ut,ct),this._addInactiveAction(ut,lt,st),ut}existingAction(_e,rt){const nt=rt||this._root,it=nt.uuid,st=typeof _e=="string"?AnimationClip.findByName(nt,_e):_e,ot=st?st.uuid:_e,lt=this._actionsByClip[ot];return lt!==void 0&&lt.actionByRoot[it]||null}stopAllAction(){const _e=this._actions,rt=this._nActiveActions;for(let nt=rt-1;nt>=0;--nt)_e[nt].stop();return this}update(_e){_e*=this.timeScale;const rt=this._actions,nt=this._nActiveActions,it=this.time+=_e,st=Math.sign(_e),ot=this._accuIndex^=1;for(let ct=0;ct!==nt;++ct)rt[ct]._update(it,_e,st,ot);const lt=this._bindings,at=this._nActiveBindings;for(let ct=0;ct!==at;++ct)lt[ct].apply(ot);return this}setTime(_e){this.time=0;for(let rt=0;rt<this._actions.length;rt++)this._actions[rt].time=0;return this.update(_e)}getRoot(){return this._root}uncacheClip(_e){const rt=this._actions,nt=_e.uuid,it=this._actionsByClip,st=it[nt];if(st!==void 0){const ot=st.knownActions;for(let lt=0,at=ot.length;lt!==at;++lt){const ct=ot[lt];this._deactivateAction(ct);const ut=ct._cacheIndex,ht=rt[rt.length-1];ct._cacheIndex=null,ct._byClipCacheIndex=null,ht._cacheIndex=ut,rt[ut]=ht,rt.pop(),this._removeInactiveBindingsForAction(ct)}delete it[nt]}}uncacheRoot(_e){const rt=_e.uuid,nt=this._actionsByClip;for(const ot in nt){const lt=nt[ot].actionByRoot,at=lt[rt];at!==void 0&&(this._deactivateAction(at),this._removeInactiveAction(at))}const it=this._bindingsByRootAndName,st=it[rt];if(st!==void 0)for(const ot in st){const lt=st[ot];lt.restoreOriginalState(),this._removeInactiveBinding(lt)}}uncacheAction(_e,rt){const nt=this.existingAction(_e,rt);nt!==null&&(this._deactivateAction(nt),this._removeInactiveAction(nt))}}class Uniform{constructor(_e){this.value=_e}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let id=0;class UniformsGroup extends EventDispatcher{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:id++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(_e){return this.uniforms.push(_e),this}remove(_e){const rt=this.uniforms.indexOf(_e);return rt!==-1&&this.uniforms.splice(rt,1),this}setName(_e){return this.name=_e,this}setUsage(_e){return this.usage=_e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(_e){this.name=_e.name,this.usage=_e.usage;const rt=_e.uniforms;this.uniforms.length=0;for(let nt=0,it=rt.length;nt<it;nt++)this.uniforms.push(rt[nt].clone());return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(_e,rt,nt=1){super(_e,rt),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=nt}copy(_e){return super.copy(_e),this.meshPerAttribute=_e.meshPerAttribute,this}clone(_e){const rt=super.clone(_e);return rt.meshPerAttribute=this.meshPerAttribute,rt}toJSON(_e){const rt=super.toJSON(_e);return rt.isInstancedInterleavedBuffer=!0,rt.meshPerAttribute=this.meshPerAttribute,rt}}class GLBufferAttribute{constructor(_e,rt,nt,it,st){this.isGLBufferAttribute=!0,this.name="",this.buffer=_e,this.type=rt,this.itemSize=nt,this.elementSize=it,this.count=st,this.version=0}set needsUpdate(_e){_e===!0&&this.version++}setBuffer(_e){return this.buffer=_e,this}setType(_e,rt){return this.type=_e,this.elementSize=rt,this}setItemSize(_e){return this.itemSize=_e,this}setCount(_e){return this.count=_e,this}}class Raycaster{constructor(_e,rt,nt=0,it=1/0){this.ray=new Ray$1(_e,rt),this.near=nt,this.far=it,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_e,rt){this.ray.set(_e,rt)}setFromCamera(_e,rt){rt.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(rt.matrixWorld),this.ray.direction.set(_e.x,_e.y,.5).unproject(rt).sub(this.ray.origin).normalize(),this.camera=rt):rt.isOrthographicCamera?(this.ray.origin.set(_e.x,_e.y,(rt.near+rt.far)/(rt.near-rt.far)).unproject(rt),this.ray.direction.set(0,0,-1).transformDirection(rt.matrixWorld),this.camera=rt):console.error("THREE.Raycaster: Unsupported camera type: "+rt.type)}intersectObject(_e,rt=!0,nt=[]){return intersectObject(_e,this,nt,rt),nt.sort(ascSort),nt}intersectObjects(_e,rt=!0,nt=[]){for(let it=0,st=_e.length;it<st;it++)intersectObject(_e[it],this,nt,rt);return nt.sort(ascSort),nt}}function ascSort(tt,_e){return tt.distance-_e.distance}function intersectObject(tt,_e,rt,nt){if(tt.layers.test(_e.layers)&&tt.raycast(_e,rt),nt===!0){const it=tt.children;for(let st=0,ot=it.length;st<ot;st++)intersectObject(it[st],_e,rt,!0)}}class Spherical{constructor(_e=1,rt=0,nt=0){return this.radius=_e,this.phi=rt,this.theta=nt,this}set(_e,rt,nt){return this.radius=_e,this.phi=rt,this.theta=nt,this}copy(_e){return this.radius=_e.radius,this.phi=_e.phi,this.theta=_e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(_e){return this.setFromCartesianCoords(_e.x,_e.y,_e.z)}setFromCartesianCoords(_e,rt,nt){return this.radius=Math.sqrt(_e*_e+rt*rt+nt*nt),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_e,nt),this.phi=Math.acos(clamp$2(rt/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(_e=1,rt=0,nt=0){return this.radius=_e,this.theta=rt,this.y=nt,this}set(_e,rt,nt){return this.radius=_e,this.theta=rt,this.y=nt,this}copy(_e){return this.radius=_e.radius,this.theta=_e.theta,this.y=_e.y,this}setFromVector3(_e){return this.setFromCartesianCoords(_e.x,_e.y,_e.z)}setFromCartesianCoords(_e,rt,nt){return this.radius=Math.sqrt(_e*_e+nt*nt),this.theta=Math.atan2(_e,nt),this.y=rt,this}clone(){return new this.constructor().copy(this)}}const _vector$4=new Vector2;class Box2{constructor(_e=new Vector2(1/0,1/0),rt=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=_e,this.max=rt}set(_e,rt){return this.min.copy(_e),this.max.copy(rt),this}setFromPoints(_e){this.makeEmpty();for(let rt=0,nt=_e.length;rt<nt;rt++)this.expandByPoint(_e[rt]);return this}setFromCenterAndSize(_e,rt){const nt=_vector$4.copy(rt).multiplyScalar(.5);return this.min.copy(_e).sub(nt),this.max.copy(_e).add(nt),this}clone(){return new this.constructor().copy(this)}copy(_e){return this.min.copy(_e.min),this.max.copy(_e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_e){return this.isEmpty()?_e.set(0,0):_e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_e){return this.isEmpty()?_e.set(0,0):_e.subVectors(this.max,this.min)}expandByPoint(_e){return this.min.min(_e),this.max.max(_e),this}expandByVector(_e){return this.min.sub(_e),this.max.add(_e),this}expandByScalar(_e){return this.min.addScalar(-_e),this.max.addScalar(_e),this}containsPoint(_e){return!(_e.x<this.min.x||_e.x>this.max.x||_e.y<this.min.y||_e.y>this.max.y)}containsBox(_e){return this.min.x<=_e.min.x&&_e.max.x<=this.max.x&&this.min.y<=_e.min.y&&_e.max.y<=this.max.y}getParameter(_e,rt){return rt.set((_e.x-this.min.x)/(this.max.x-this.min.x),(_e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_e){return!(_e.max.x<this.min.x||_e.min.x>this.max.x||_e.max.y<this.min.y||_e.min.y>this.max.y)}clampPoint(_e,rt){return rt.copy(_e).clamp(this.min,this.max)}distanceToPoint(_e){return this.clampPoint(_e,_vector$4).distanceTo(_e)}intersect(_e){return this.min.max(_e.min),this.max.min(_e.max),this.isEmpty()&&this.makeEmpty(),this}union(_e){return this.min.min(_e.min),this.max.max(_e.max),this}translate(_e){return this.min.add(_e),this.max.add(_e),this}equals(_e){return _e.min.equals(this.min)&&_e.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(_e=new Vector3,rt=new Vector3){this.start=_e,this.end=rt}set(_e,rt){return this.start.copy(_e),this.end.copy(rt),this}copy(_e){return this.start.copy(_e.start),this.end.copy(_e.end),this}getCenter(_e){return _e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_e){return _e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_e,rt){return this.delta(rt).multiplyScalar(_e).add(this.start)}closestPointToPointParameter(_e,rt){_startP.subVectors(_e,this.start),_startEnd.subVectors(this.end,this.start);const nt=_startEnd.dot(_startEnd);let st=_startEnd.dot(_startP)/nt;return rt&&(st=clamp$2(st,0,1)),st}closestPointToPoint(_e,rt,nt){const it=this.closestPointToPointParameter(_e,rt);return this.delta(nt).multiplyScalar(it).add(this.start)}applyMatrix4(_e){return this.start.applyMatrix4(_e),this.end.applyMatrix4(_e),this}equals(_e){return _e.start.equals(this.start)&&_e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3;class SpotLightHelper extends Object3D{constructor(_e,rt){super(),this.light=_e,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.color=rt,this.type="SpotLightHelper";const nt=new BufferGeometry,it=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let ot=0,lt=1,at=32;ot<at;ot++,lt++){const ct=ot/at*Math.PI*2,ut=lt/at*Math.PI*2;it.push(Math.cos(ct),Math.sin(ct),1,Math.cos(ut),Math.sin(ut),1)}nt.setAttribute("position",new Float32BufferAttribute(it,3));const st=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(nt,st),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const _e=this.light.distance?this.light.distance:1e3,rt=_e*Math.tan(this.light.angle);this.cone.scale.set(rt,rt,_e),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;class SkeletonHelper extends LineSegments{constructor(_e){const rt=getBoneList(_e),nt=new BufferGeometry,it=[],st=[],ot=new Color$1(0,0,1),lt=new Color$1(0,1,0);for(let ct=0;ct<rt.length;ct++){const ut=rt[ct];ut.parent&&ut.parent.isBone&&(it.push(0,0,0),it.push(0,0,0),st.push(ot.r,ot.g,ot.b),st.push(lt.r,lt.g,lt.b))}nt.setAttribute("position",new Float32BufferAttribute(it,3)),nt.setAttribute("color",new Float32BufferAttribute(st,3));const at=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(nt,at),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_e,this.bones=rt,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_e){const rt=this.bones,nt=this.geometry,it=nt.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let st=0,ot=0;st<rt.length;st++){const lt=rt[st];lt.parent&&lt.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,lt.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),it.setXYZ(ot,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,lt.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),it.setXYZ(ot+1,_vector$2.x,_vector$2.y,_vector$2.z),ot+=2)}nt.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(tt){const _e=[];tt.isBone===!0&&_e.push(tt);for(let rt=0;rt<tt.children.length;rt++)_e.push.apply(_e,getBoneList(tt.children[rt]));return _e}class PointLightHelper extends Mesh{constructor(_e,rt,nt){const it=new SphereGeometry(rt,4,2),st=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super(it,st),this.light=_e,this.color=nt,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color$1,_color2=new Color$1;class HemisphereLightHelper extends Object3D{constructor(_e,rt,nt){super(),this.light=_e,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.color=nt,this.type="HemisphereLightHelper";const it=new OctahedronGeometry(rt);it.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const st=it.getAttribute("position"),ot=new Float32Array(st.count*3);it.setAttribute("color",new BufferAttribute(ot,3)),this.add(new Mesh(it,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const rt=_e.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let nt=0,it=rt.count;nt<it;nt++){const st=nt<it/2?_color1:_color2;rt.setXYZ(nt,st.r,st.g,st.b)}rt.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),_e.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(_e=10,rt=10,nt=4473924,it=8947848){nt=new Color$1(nt),it=new Color$1(it);const st=rt/2,ot=_e/rt,lt=_e/2,at=[],ct=[];for(let dt=0,ft=0,pt=-lt;dt<=rt;dt++,pt+=ot){at.push(-lt,0,pt,lt,0,pt),at.push(pt,0,-lt,pt,0,lt);const mt=dt===st?nt:it;mt.toArray(ct,ft),ft+=3,mt.toArray(ct,ft),ft+=3,mt.toArray(ct,ft),ft+=3,mt.toArray(ct,ft),ft+=3}const ut=new BufferGeometry;ut.setAttribute("position",new Float32BufferAttribute(at,3)),ut.setAttribute("color",new Float32BufferAttribute(ct,3));const ht=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(ut,ht),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(_e=10,rt=16,nt=8,it=64,st=4473924,ot=8947848){st=new Color$1(st),ot=new Color$1(ot);const lt=[],at=[];if(rt>1)for(let ht=0;ht<rt;ht++){const dt=ht/rt*(Math.PI*2),ft=Math.sin(dt)*_e,pt=Math.cos(dt)*_e;lt.push(0,0,0),lt.push(ft,0,pt);const mt=ht&1?st:ot;at.push(mt.r,mt.g,mt.b),at.push(mt.r,mt.g,mt.b)}for(let ht=0;ht<nt;ht++){const dt=ht&1?st:ot,ft=_e-_e/nt*ht;for(let pt=0;pt<it;pt++){let mt=pt/it*(Math.PI*2),gt=Math.sin(mt)*ft,vt=Math.cos(mt)*ft;lt.push(gt,0,vt),at.push(dt.r,dt.g,dt.b),mt=(pt+1)/it*(Math.PI*2),gt=Math.sin(mt)*ft,vt=Math.cos(mt)*ft,lt.push(gt,0,vt),at.push(dt.r,dt.g,dt.b)}}const ct=new BufferGeometry;ct.setAttribute("position",new Float32BufferAttribute(lt,3)),ct.setAttribute("color",new Float32BufferAttribute(at,3));const ut=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(ct,ut),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3,_v2=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(_e,rt,nt){super(),this.light=_e,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.color=nt,this.type="DirectionalLightHelper",rt===void 0&&(rt=1);let it=new BufferGeometry;it.setAttribute("position",new Float32BufferAttribute([-rt,rt,0,rt,rt,0,rt,-rt,0,-rt,-rt,0,-rt,rt,0],3));const st=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(it,st),this.add(this.lightPlane),it=new BufferGeometry,it.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(it,st),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2,_v1),this.lightPlane.lookAt(_v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2),this.targetLine.scale.z=_v3.length()}}const _vector=new Vector3,_camera=new Camera;class CameraHelper extends LineSegments{constructor(_e){const rt=new BufferGeometry,nt=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),it=[],st=[],ot={};lt("n1","n2"),lt("n2","n4"),lt("n4","n3"),lt("n3","n1"),lt("f1","f2"),lt("f2","f4"),lt("f4","f3"),lt("f3","f1"),lt("n1","f1"),lt("n2","f2"),lt("n3","f3"),lt("n4","f4"),lt("p","n1"),lt("p","n2"),lt("p","n3"),lt("p","n4"),lt("u1","u2"),lt("u2","u3"),lt("u3","u1"),lt("c","t"),lt("p","c"),lt("cn1","cn2"),lt("cn3","cn4"),lt("cf1","cf2"),lt("cf3","cf4");function lt(pt,mt){at(pt),at(mt)}function at(pt){it.push(0,0,0),st.push(0,0,0),ot[pt]===void 0&&(ot[pt]=[]),ot[pt].push(it.length/3-1)}rt.setAttribute("position",new Float32BufferAttribute(it,3)),rt.setAttribute("color",new Float32BufferAttribute(st,3)),super(rt,nt),this.type="CameraHelper",this.camera=_e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=ot,this.update();const ct=new Color$1(16755200),ut=new Color$1(16711680),ht=new Color$1(43775),dt=new Color$1(16777215),ft=new Color$1(3355443);this.setColors(ct,ut,ht,dt,ft)}setColors(_e,rt,nt,it,st){const lt=this.geometry.getAttribute("color");lt.setXYZ(0,_e.r,_e.g,_e.b),lt.setXYZ(1,_e.r,_e.g,_e.b),lt.setXYZ(2,_e.r,_e.g,_e.b),lt.setXYZ(3,_e.r,_e.g,_e.b),lt.setXYZ(4,_e.r,_e.g,_e.b),lt.setXYZ(5,_e.r,_e.g,_e.b),lt.setXYZ(6,_e.r,_e.g,_e.b),lt.setXYZ(7,_e.r,_e.g,_e.b),lt.setXYZ(8,_e.r,_e.g,_e.b),lt.setXYZ(9,_e.r,_e.g,_e.b),lt.setXYZ(10,_e.r,_e.g,_e.b),lt.setXYZ(11,_e.r,_e.g,_e.b),lt.setXYZ(12,_e.r,_e.g,_e.b),lt.setXYZ(13,_e.r,_e.g,_e.b),lt.setXYZ(14,_e.r,_e.g,_e.b),lt.setXYZ(15,_e.r,_e.g,_e.b),lt.setXYZ(16,_e.r,_e.g,_e.b),lt.setXYZ(17,_e.r,_e.g,_e.b),lt.setXYZ(18,_e.r,_e.g,_e.b),lt.setXYZ(19,_e.r,_e.g,_e.b),lt.setXYZ(20,_e.r,_e.g,_e.b),lt.setXYZ(21,_e.r,_e.g,_e.b),lt.setXYZ(22,_e.r,_e.g,_e.b),lt.setXYZ(23,_e.r,_e.g,_e.b),lt.setXYZ(24,rt.r,rt.g,rt.b),lt.setXYZ(25,rt.r,rt.g,rt.b),lt.setXYZ(26,rt.r,rt.g,rt.b),lt.setXYZ(27,rt.r,rt.g,rt.b),lt.setXYZ(28,rt.r,rt.g,rt.b),lt.setXYZ(29,rt.r,rt.g,rt.b),lt.setXYZ(30,rt.r,rt.g,rt.b),lt.setXYZ(31,rt.r,rt.g,rt.b),lt.setXYZ(32,nt.r,nt.g,nt.b),lt.setXYZ(33,nt.r,nt.g,nt.b),lt.setXYZ(34,nt.r,nt.g,nt.b),lt.setXYZ(35,nt.r,nt.g,nt.b),lt.setXYZ(36,nt.r,nt.g,nt.b),lt.setXYZ(37,nt.r,nt.g,nt.b),lt.setXYZ(38,it.r,it.g,it.b),lt.setXYZ(39,it.r,it.g,it.b),lt.setXYZ(40,st.r,st.g,st.b),lt.setXYZ(41,st.r,st.g,st.b),lt.setXYZ(42,st.r,st.g,st.b),lt.setXYZ(43,st.r,st.g,st.b),lt.setXYZ(44,st.r,st.g,st.b),lt.setXYZ(45,st.r,st.g,st.b),lt.setXYZ(46,st.r,st.g,st.b),lt.setXYZ(47,st.r,st.g,st.b),lt.setXYZ(48,st.r,st.g,st.b),lt.setXYZ(49,st.r,st.g,st.b),lt.needsUpdate=!0}update(){const _e=this.geometry,rt=this.pointMap,nt=1,it=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",rt,_e,_camera,0,0,-1),setPoint("t",rt,_e,_camera,0,0,1),setPoint("n1",rt,_e,_camera,-nt,-it,-1),setPoint("n2",rt,_e,_camera,nt,-it,-1),setPoint("n3",rt,_e,_camera,-nt,it,-1),setPoint("n4",rt,_e,_camera,nt,it,-1),setPoint("f1",rt,_e,_camera,-nt,-it,1),setPoint("f2",rt,_e,_camera,nt,-it,1),setPoint("f3",rt,_e,_camera,-nt,it,1),setPoint("f4",rt,_e,_camera,nt,it,1),setPoint("u1",rt,_e,_camera,nt*.7,it*1.1,-1),setPoint("u2",rt,_e,_camera,-nt*.7,it*1.1,-1),setPoint("u3",rt,_e,_camera,0,it*2,-1),setPoint("cf1",rt,_e,_camera,-nt,0,1),setPoint("cf2",rt,_e,_camera,nt,0,1),setPoint("cf3",rt,_e,_camera,0,-it,1),setPoint("cf4",rt,_e,_camera,0,it,1),setPoint("cn1",rt,_e,_camera,-nt,0,-1),setPoint("cn2",rt,_e,_camera,nt,0,-1),setPoint("cn3",rt,_e,_camera,0,-it,-1),setPoint("cn4",rt,_e,_camera,0,it,-1),_e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(tt,_e,rt,nt,it,st,ot){_vector.set(it,st,ot).unproject(nt);const lt=_e[tt];if(lt!==void 0){const at=rt.getAttribute("position");for(let ct=0,ut=lt.length;ct<ut;ct++)at.setXYZ(lt[ct],_vector.x,_vector.y,_vector.z)}}const _box=new Box3;class BoxHelper extends LineSegments{constructor(_e,rt=16776960){const nt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),it=new Float32Array(8*3),st=new BufferGeometry;st.setIndex(new BufferAttribute(nt,1)),st.setAttribute("position",new BufferAttribute(it,3)),super(st,new LineBasicMaterial({color:rt,toneMapped:!1})),this.object=_e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(_e){if(_e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box.setFromObject(this.object),_box.isEmpty())return;const rt=_box.min,nt=_box.max,it=this.geometry.attributes.position,st=it.array;st[0]=nt.x,st[1]=nt.y,st[2]=nt.z,st[3]=rt.x,st[4]=nt.y,st[5]=nt.z,st[6]=rt.x,st[7]=rt.y,st[8]=nt.z,st[9]=nt.x,st[10]=rt.y,st[11]=nt.z,st[12]=nt.x,st[13]=nt.y,st[14]=rt.z,st[15]=rt.x,st[16]=nt.y,st[17]=rt.z,st[18]=rt.x,st[19]=rt.y,st[20]=rt.z,st[21]=nt.x,st[22]=rt.y,st[23]=rt.z,it.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_e){return this.object=_e,this.update(),this}copy(_e,rt){return super.copy(_e,rt),this.object=_e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(_e,rt=16776960){const nt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),it=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],st=new BufferGeometry;st.setIndex(new BufferAttribute(nt,1)),st.setAttribute("position",new Float32BufferAttribute(it,3)),super(st,new LineBasicMaterial({color:rt,toneMapped:!1})),this.box=_e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_e){const rt=this.box;rt.isEmpty()||(rt.getCenter(this.position),rt.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line{constructor(_e,rt=1,nt=16776960){const it=nt,st=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],ot=new BufferGeometry;ot.setAttribute("position",new Float32BufferAttribute(st,3)),ot.computeBoundingSphere(),super(ot,new LineBasicMaterial({color:it,toneMapped:!1})),this.type="PlaneHelper",this.plane=_e,this.size=rt;const lt=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],at=new BufferGeometry;at.setAttribute("position",new Float32BufferAttribute(lt,3)),at.computeBoundingSphere(),this.add(new Mesh(at,new MeshBasicMaterial({color:it,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(_e=new Vector3(0,0,1),rt=new Vector3(0,0,0),nt=1,it=16776960,st=nt*.2,ot=st*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(rt),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:it,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:it,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_e),this.setLength(nt,st,ot)}setDirection(_e){if(_e.y>.99999)this.quaternion.set(0,0,0,1);else if(_e.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(_e.z,0,-_e.x).normalize();const rt=Math.acos(_e.y);this.quaternion.setFromAxisAngle(_axis,rt)}}setLength(_e,rt=_e*.2,nt=rt*.2){this.line.scale.set(1,Math.max(1e-4,_e-rt),1),this.line.updateMatrix(),this.cone.scale.set(nt,rt,nt),this.cone.position.y=_e,this.cone.updateMatrix()}setColor(_e){this.line.material.color.set(_e),this.cone.material.color.set(_e)}copy(_e){return super.copy(_e,!1),this.line.copy(_e.line),this.cone.copy(_e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(_e=1){const rt=[0,0,0,_e,0,0,0,0,0,0,_e,0,0,0,0,0,0,_e],nt=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],it=new BufferGeometry;it.setAttribute("position",new Float32BufferAttribute(rt,3)),it.setAttribute("color",new Float32BufferAttribute(nt,3));const st=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(it,st),this.type="AxesHelper"}setColors(_e,rt,nt){const it=new Color$1,st=this.geometry.attributes.color.array;return it.set(_e),it.toArray(st,0),it.toArray(st,3),it.set(rt),it.toArray(st,6),it.toArray(st,9),it.set(nt),it.toArray(st,12),it.toArray(st,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color$1,this.subPaths=[],this.currentPath=null}moveTo(_e,rt){return this.currentPath=new Path$1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_e,rt),this}lineTo(_e,rt){return this.currentPath.lineTo(_e,rt),this}quadraticCurveTo(_e,rt,nt,it){return this.currentPath.quadraticCurveTo(_e,rt,nt,it),this}bezierCurveTo(_e,rt,nt,it,st,ot){return this.currentPath.bezierCurveTo(_e,rt,nt,it,st,ot),this}splineThru(_e){return this.currentPath.splineThru(_e),this}toShapes(_e){function rt(vt){const At=[];for(let yt=0,xt=vt.length;yt<xt;yt++){const _t=vt[yt],Et=new Shape;Et.curves=_t.curves,At.push(Et)}return At}function nt(vt,At){const yt=At.length;let xt=!1;for(let _t=yt-1,Et=0;Et<yt;_t=Et++){let bt=At[_t],wt=At[Et],Tt=wt.x-bt.x,Mt=wt.y-bt.y;if(Math.abs(Mt)>Number.EPSILON){if(Mt<0&&(bt=At[Et],Tt=-Tt,wt=At[_t],Mt=-Mt),vt.y<bt.y||vt.y>wt.y)continue;if(vt.y===bt.y){if(vt.x===bt.x)return!0}else{const Pt=Mt*(vt.x-bt.x)-Tt*(vt.y-bt.y);if(Pt===0)return!0;if(Pt<0)continue;xt=!xt}}else{if(vt.y!==bt.y)continue;if(wt.x<=vt.x&&vt.x<=bt.x||bt.x<=vt.x&&vt.x<=wt.x)return!0}}return xt}const it=ShapeUtils.isClockWise,st=this.subPaths;if(st.length===0)return[];let ot,lt,at;const ct=[];if(st.length===1)return lt=st[0],at=new Shape,at.curves=lt.curves,ct.push(at),ct;let ut=!it(st[0].getPoints());ut=_e?!ut:ut;const ht=[],dt=[];let ft=[],pt=0,mt;dt[pt]=void 0,ft[pt]=[];for(let vt=0,At=st.length;vt<At;vt++)lt=st[vt],mt=lt.getPoints(),ot=it(mt),ot=_e?!ot:ot,ot?(!ut&&dt[pt]&&pt++,dt[pt]={s:new Shape,p:mt},dt[pt].s.curves=lt.curves,ut&&pt++,ft[pt]=[]):ft[pt].push({h:lt,p:mt[0]});if(!dt[0])return rt(st);if(dt.length>1){let vt=!1,At=0;for(let yt=0,xt=dt.length;yt<xt;yt++)ht[yt]=[];for(let yt=0,xt=dt.length;yt<xt;yt++){const _t=ft[yt];for(let Et=0;Et<_t.length;Et++){const bt=_t[Et];let wt=!0;for(let Tt=0;Tt<dt.length;Tt++)nt(bt.p,dt[Tt].p)&&(yt!==Tt&&At++,wt?(wt=!1,ht[Tt].push(bt)):vt=!0);wt&&ht[yt].push(bt)}}At>0&&vt===!1&&(ft=ht)}let gt;for(let vt=0,At=dt.length;vt<At;vt++){at=dt[vt].s,ct.push(at),gt=ft[vt];for(let yt=0,xt=gt.length;yt<xt;yt++)at.holes.push(gt[yt].h)}return ct}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const THREE=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AlphaFormat,AlwaysCompare,AlwaysDepth,AlwaysStencilFunc,AmbientLight,AmbientLightProbe,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache,Camera,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping,CircleGeometry,ClampToEdgeWrapping,Clock,Color:Color$1,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture:CompressedArrayTexture$1,CompressedTexture,CompressedTextureLoader,ConeGeometry,CubeCamera,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderGeometry,Cylindrical,Data3DTexture:Data3DTexture$1,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DisplayP3ColorSpace,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,Float64BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare,GreaterDepth,GreaterEqualCompare,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group,HalfFloatType,HemisphereLight,HemisphereLightHelper,HemisphereLightProbe,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheGeometry,Layers,LessCompare,LessDepth,LessEqualCompare,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearEncoding,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace,LinearToneMapping,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeverCompare,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualCompare,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronGeometry,OneFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path:Path$1,PerspectiveCamera,Plane,PlaneGeometry,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray:Ray$1,Raycaster,RectAreaLight,RedFormat,RedIntegerFormat,ReinhardToneMapping,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace,Scene,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape,ShapeGeometry,ShapePath,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronGeometry,Texture,TextureLoader,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,TwoPassDoubleSide,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoTexture,WebGL1Renderer,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem,WebGLCubeRenderTarget,WebGLMultipleRenderTargets,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WebGPUCoordinateSystem,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,_SRGBAFormat,sRGBEncoding},Symbol.toStringTag,{value:"Module"}));var constants={exports:{}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */reactReconcilerConstants_production_min.ConcurrentRoot=1;reactReconcilerConstants_production_min.ContinuousEventPriority=4;reactReconcilerConstants_production_min.DefaultEventPriority=16;reactReconcilerConstants_production_min.DiscreteEventPriority=1;reactReconcilerConstants_production_min.IdleEventPriority=536870912;reactReconcilerConstants_production_min.LegacyRoot=0;constants.exports=reactReconcilerConstants_production_min;var constantsExports=constants.exports;function createStore$1(tt){let _e;const rt=new Set,nt=(ct,ut)=>{const ht=typeof ct=="function"?ct(_e):ct;if(ht!==_e){const dt=_e;_e=ut?ht:Object.assign({},_e,ht),rt.forEach(ft=>ft(_e,dt))}},it=()=>_e,st=(ct,ut=it,ht=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let dt=ut(_e);function ft(){const pt=ut(_e);if(!ht(dt,pt)){const mt=dt;ct(dt=pt,mt)}}return rt.add(ft),()=>rt.delete(ft)},at={setState:nt,getState:it,subscribe:(ct,ut,ht)=>ut||ht?st(ct,ut,ht):(rt.add(ct),()=>rt.delete(ct)),destroy:()=>rt.clear()};return _e=tt(nt,it,at),at}const isSSR=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$2=isSSR?reactExports.useEffect:reactExports.useLayoutEffect;function create(tt){const _e=typeof tt=="function"?createStore$1(tt):tt,rt=(nt=_e.getState,it=Object.is)=>{const[,st]=reactExports.useReducer(gt=>gt+1,0),ot=_e.getState(),lt=reactExports.useRef(ot),at=reactExports.useRef(nt),ct=reactExports.useRef(it),ut=reactExports.useRef(!1),ht=reactExports.useRef();ht.current===void 0&&(ht.current=nt(ot));let dt,ft=!1;(lt.current!==ot||at.current!==nt||ct.current!==it||ut.current)&&(dt=nt(ot),ft=!it(ht.current,dt)),useIsomorphicLayoutEffect$2(()=>{ft&&(ht.current=dt),lt.current=ot,at.current=nt,ct.current=it,ut.current=!1});const pt=reactExports.useRef(ot);useIsomorphicLayoutEffect$2(()=>{const gt=()=>{try{const At=_e.getState(),yt=at.current(At);ct.current(ht.current,yt)||(lt.current=At,ht.current=yt,st())}catch{ut.current=!0,st()}},vt=_e.subscribe(gt);return _e.getState()!==pt.current&&gt(),vt},[]);const mt=ft?dt:ht.current;return reactExports.useDebugValue(mt),mt};return Object.assign(rt,_e),rt[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const nt=[rt,_e];return{next(){const it=nt.length<=0;return{value:nt.shift(),done:it}}}},rt}var reactReconciler={exports:{}},scheduler$1={exports:{}},scheduler_production_min$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(tt){function _e(Dt,Gt){var zt=Dt.length;Dt.push(Gt);e:for(;0<zt;){var $t=zt-1>>>1,Ht=Dt[$t];if(0<it(Ht,Gt))Dt[$t]=Gt,Dt[zt]=Ht,zt=$t;else break e}}function rt(Dt){return Dt.length===0?null:Dt[0]}function nt(Dt){if(Dt.length===0)return null;var Gt=Dt[0],zt=Dt.pop();if(zt!==Gt){Dt[0]=zt;e:for(var $t=0,Ht=Dt.length,er=Ht>>>1;$t<er;){var Zt=2*($t+1)-1,or=Dt[Zt],Kt=Zt+1,rr=Dt[Kt];if(0>it(or,zt))Kt<Ht&&0>it(rr,or)?(Dt[$t]=rr,Dt[Kt]=zt,$t=Kt):(Dt[$t]=or,Dt[Zt]=zt,$t=Zt);else if(Kt<Ht&&0>it(rr,zt))Dt[$t]=rr,Dt[Kt]=zt,$t=Kt;else break e}}return Gt}function it(Dt,Gt){var zt=Dt.sortIndex-Gt.sortIndex;return zt!==0?zt:Dt.id-Gt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;tt.unstable_now=function(){return st.now()}}else{var ot=Date,lt=ot.now();tt.unstable_now=function(){return ot.now()-lt}}var at=[],ct=[],ut=1,ht=null,dt=3,ft=!1,pt=!1,mt=!1,gt=typeof setTimeout=="function"?setTimeout:null,vt=typeof clearTimeout=="function"?clearTimeout:null,At=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function yt(Dt){for(var Gt=rt(ct);Gt!==null;){if(Gt.callback===null)nt(ct);else if(Gt.startTime<=Dt)nt(ct),Gt.sortIndex=Gt.expirationTime,_e(at,Gt);else break;Gt=rt(ct)}}function xt(Dt){if(mt=!1,yt(Dt),!pt)if(rt(at)!==null)pt=!0,Ft(_t);else{var Gt=rt(ct);Gt!==null&&jt(xt,Gt.startTime-Dt)}}function _t(Dt,Gt){pt=!1,mt&&(mt=!1,vt(wt),wt=-1),ft=!0;var zt=dt;try{for(yt(Gt),ht=rt(at);ht!==null&&(!(ht.expirationTime>Gt)||Dt&&!Pt());){var $t=ht.callback;if(typeof $t=="function"){ht.callback=null,dt=ht.priorityLevel;var Ht=$t(ht.expirationTime<=Gt);Gt=tt.unstable_now(),typeof Ht=="function"?ht.callback=Ht:ht===rt(at)&&nt(at),yt(Gt)}else nt(at);ht=rt(at)}if(ht!==null)var er=!0;else{var Zt=rt(ct);Zt!==null&&jt(xt,Zt.startTime-Gt),er=!1}return er}finally{ht=null,dt=zt,ft=!1}}var Et=!1,bt=null,wt=-1,Tt=5,Mt=-1;function Pt(){return!(tt.unstable_now()-Mt<Tt)}function It(){if(bt!==null){var Dt=tt.unstable_now();Mt=Dt;var Gt=!0;try{Gt=bt(!0,Dt)}finally{Gt?Ot():(Et=!1,bt=null)}}else Et=!1}var Ot;if(typeof At=="function")Ot=function(){At(It)};else if(typeof MessageChannel<"u"){var Bt=new MessageChannel,Ut=Bt.port2;Bt.port1.onmessage=It,Ot=function(){Ut.postMessage(null)}}else Ot=function(){gt(It,0)};function Ft(Dt){bt=Dt,Et||(Et=!0,Ot())}function jt(Dt,Gt){wt=gt(function(){Dt(tt.unstable_now())},Gt)}tt.unstable_IdlePriority=5,tt.unstable_ImmediatePriority=1,tt.unstable_LowPriority=4,tt.unstable_NormalPriority=3,tt.unstable_Profiling=null,tt.unstable_UserBlockingPriority=2,tt.unstable_cancelCallback=function(Dt){Dt.callback=null},tt.unstable_continueExecution=function(){pt||ft||(pt=!0,Ft(_t))},tt.unstable_forceFrameRate=function(Dt){0>Dt||125<Dt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Tt=0<Dt?Math.floor(1e3/Dt):5},tt.unstable_getCurrentPriorityLevel=function(){return dt},tt.unstable_getFirstCallbackNode=function(){return rt(at)},tt.unstable_next=function(Dt){switch(dt){case 1:case 2:case 3:var Gt=3;break;default:Gt=dt}var zt=dt;dt=Gt;try{return Dt()}finally{dt=zt}},tt.unstable_pauseExecution=function(){},tt.unstable_requestPaint=function(){},tt.unstable_runWithPriority=function(Dt,Gt){switch(Dt){case 1:case 2:case 3:case 4:case 5:break;default:Dt=3}var zt=dt;dt=Dt;try{return Gt()}finally{dt=zt}},tt.unstable_scheduleCallback=function(Dt,Gt,zt){var $t=tt.unstable_now();switch(typeof zt=="object"&&zt!==null?(zt=zt.delay,zt=typeof zt=="number"&&0<zt?$t+zt:$t):zt=$t,Dt){case 1:var Ht=-1;break;case 2:Ht=250;break;case 5:Ht=1073741823;break;case 4:Ht=1e4;break;default:Ht=5e3}return Ht=zt+Ht,Dt={id:ut++,callback:Gt,priorityLevel:Dt,startTime:zt,expirationTime:Ht,sortIndex:-1},zt>$t?(Dt.sortIndex=zt,_e(ct,Dt),rt(at)===null&&Dt===rt(ct)&&(mt?(vt(wt),wt=-1):mt=!0,jt(xt,zt-$t))):(Dt.sortIndex=Ht,_e(at,Dt),pt||ft||(pt=!0,Ft(_t))),Dt},tt.unstable_shouldYield=Pt,tt.unstable_wrapCallback=function(Dt){var Gt=dt;return function(){var zt=dt;dt=Gt;try{return Dt.apply(this,arguments)}finally{dt=zt}}}}(scheduler_production_min$1)),scheduler_production_min$1}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler$1.exports=requireScheduler_production_min()),scheduler$1.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min=function(_e){var rt={},nt=reactExports,it=requireScheduler(),st=Object.assign;function ot(St){for(var Ct="https://reactjs.org/docs/error-decoder.html?invariant="+St,Rt=1;Rt<arguments.length;Rt++)Ct+="&args[]="+encodeURIComponent(arguments[Rt]);return"Minified React error #"+St+"; visit "+Ct+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lt=nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,at=Symbol.for("react.element"),ct=Symbol.for("react.portal"),ut=Symbol.for("react.fragment"),ht=Symbol.for("react.strict_mode"),dt=Symbol.for("react.profiler"),ft=Symbol.for("react.provider"),pt=Symbol.for("react.context"),mt=Symbol.for("react.forward_ref"),gt=Symbol.for("react.suspense"),vt=Symbol.for("react.suspense_list"),At=Symbol.for("react.memo"),yt=Symbol.for("react.lazy"),xt=Symbol.for("react.offscreen"),_t=Symbol.iterator;function Et(St){return St===null||typeof St!="object"?null:(St=_t&&St[_t]||St["@@iterator"],typeof St=="function"?St:null)}function bt(St){if(St==null)return null;if(typeof St=="function")return St.displayName||St.name||null;if(typeof St=="string")return St;switch(St){case ut:return"Fragment";case ct:return"Portal";case dt:return"Profiler";case ht:return"StrictMode";case gt:return"Suspense";case vt:return"SuspenseList"}if(typeof St=="object")switch(St.$$typeof){case pt:return(St.displayName||"Context")+".Consumer";case ft:return(St._context.displayName||"Context")+".Provider";case mt:var Ct=St.render;return St=St.displayName,St||(St=Ct.displayName||Ct.name||"",St=St!==""?"ForwardRef("+St+")":"ForwardRef"),St;case At:return Ct=St.displayName||null,Ct!==null?Ct:bt(St.type)||"Memo";case yt:Ct=St._payload,St=St._init;try{return bt(St(Ct))}catch{}}return null}function wt(St){var Ct=St.type;switch(St.tag){case 24:return"Cache";case 9:return(Ct.displayName||"Context")+".Consumer";case 10:return(Ct._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return St=Ct.render,St=St.displayName||St.name||"",Ct.displayName||(St!==""?"ForwardRef("+St+")":"ForwardRef");case 7:return"Fragment";case 5:return Ct;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bt(Ct);case 8:return Ct===ht?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof Ct=="function")return Ct.displayName||Ct.name||null;if(typeof Ct=="string")return Ct}return null}function Tt(St){var Ct=St,Rt=St;if(St.alternate)for(;Ct.return;)Ct=Ct.return;else{St=Ct;do Ct=St,Ct.flags&4098&&(Rt=Ct.return),St=Ct.return;while(St)}return Ct.tag===3?Rt:null}function Mt(St){if(Tt(St)!==St)throw Error(ot(188))}function Pt(St){var Ct=St.alternate;if(!Ct){if(Ct=Tt(St),Ct===null)throw Error(ot(188));return Ct!==St?null:St}for(var Rt=St,Lt=Ct;;){var Nt=Rt.return;if(Nt===null)break;var Vt=Nt.alternate;if(Vt===null){if(Lt=Nt.return,Lt!==null){Rt=Lt;continue}break}if(Nt.child===Vt.child){for(Vt=Nt.child;Vt;){if(Vt===Rt)return Mt(Nt),St;if(Vt===Lt)return Mt(Nt),Ct;Vt=Vt.sibling}throw Error(ot(188))}if(Rt.return!==Lt.return)Rt=Nt,Lt=Vt;else{for(var sr=!1,Tr=Nt.child;Tr;){if(Tr===Rt){sr=!0,Rt=Nt,Lt=Vt;break}if(Tr===Lt){sr=!0,Lt=Nt,Rt=Vt;break}Tr=Tr.sibling}if(!sr){for(Tr=Vt.child;Tr;){if(Tr===Rt){sr=!0,Rt=Vt,Lt=Nt;break}if(Tr===Lt){sr=!0,Lt=Vt,Rt=Nt;break}Tr=Tr.sibling}if(!sr)throw Error(ot(189))}}if(Rt.alternate!==Lt)throw Error(ot(190))}if(Rt.tag!==3)throw Error(ot(188));return Rt.stateNode.current===Rt?St:Ct}function It(St){return St=Pt(St),St!==null?Ot(St):null}function Ot(St){if(St.tag===5||St.tag===6)return St;for(St=St.child;St!==null;){var Ct=Ot(St);if(Ct!==null)return Ct;St=St.sibling}return null}function Bt(St){if(St.tag===5||St.tag===6)return St;for(St=St.child;St!==null;){if(St.tag!==4){var Ct=Bt(St);if(Ct!==null)return Ct}St=St.sibling}return null}var Ut=Array.isArray,Ft=_e.getPublicInstance,jt=_e.getRootHostContext,Dt=_e.getChildHostContext,Gt=_e.prepareForCommit,zt=_e.resetAfterCommit,$t=_e.createInstance,Ht=_e.appendInitialChild,er=_e.finalizeInitialChildren,Zt=_e.prepareUpdate,or=_e.shouldSetTextContent,Kt=_e.createTextInstance,rr=_e.scheduleTimeout,ur=_e.cancelTimeout,fr=_e.noTimeout,dr=_e.isPrimaryRenderer,gr=_e.supportsMutation,Yt=_e.supportsPersistence,xr=_e.supportsHydration,vr=_e.getInstanceFromNode,Pr=_e.preparePortalMount,Sr=_e.getCurrentEventPriority,Qr=_e.detachDeletedInstance,Ir=_e.supportsMicrotasks,Dr=_e.scheduleMicrotask,Ur=_e.supportsTestSelectors,Lr=_e.findFiberRoot,Wr=_e.getBoundingRect,Xt=_e.getTextContent,Qt=_e.isHiddenSubtree,hr=_e.matchAccessibilityRole,kr=_e.setFocusIfFocusable,yr=_e.setupIntersectionObserver,_r=_e.appendChild,Hr=_e.appendChildToContainer,Er=_e.commitTextUpdate,Ar=_e.commitMount,qt=_e.commitUpdate,pr=_e.insertBefore,mr=_e.insertInContainerBefore,nr=_e.removeChild,Cr=_e.removeChildFromContainer,cr=_e.resetTextContent,Jr=_e.hideInstance,lr=_e.hideTextInstance,Rr=_e.unhideInstance,br=_e.unhideTextInstance,jr=_e.clearContainer,Yr=_e.cloneInstance,mn=_e.createContainerChildSet,bn=_e.appendChildToContainerChildSet,fn=_e.finalizeContainerChildren,Cn=_e.replaceContainerChildren,Tn=_e.cloneHiddenInstance,gn=_e.cloneHiddenTextInstance,En=_e.canHydrateInstance,Xn=_e.canHydrateTextInstance,$n=_e.canHydrateSuspenseInstance,wn=_e.isSuspenseInstancePending,Bn=_e.isSuspenseInstanceFallback,Qn=_e.registerSuspenseInstanceRetry,Mn=_e.getNextHydratableSibling,on=_e.getFirstHydratableChild,Gn=_e.getFirstHydratableChildWithinContainer,_s=_e.getFirstHydratableChildWithinSuspenseInstance,Wt=_e.hydrateInstance,kt=_e.hydrateTextInstance,Jt=_e.hydrateSuspenseInstance,ir=_e.getNextHydratableInstanceAfterSuspenseInstance,tr=_e.commitHydratedContainer,ar=_e.commitHydratedSuspenseInstance,Or=_e.clearSuspenseBoundary,Br=_e.clearSuspenseBoundaryFromContainer,$r=_e.shouldDeleteUnhydratedTailInstances,Gr=_e.didNotMatchHydratedContainerTextInstance,Vr=_e.didNotMatchHydratedTextInstance,wr;function Zr(St){if(wr===void 0)try{throw Error()}catch(Rt){var Ct=Rt.stack.trim().match(/\n( *(at )?)/);wr=Ct&&Ct[1]||""}return`
`+wr+St}var Kr=!1;function qr(St,Ct){if(!St||Kr)return"";Kr=!0;var Rt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(Ct)if(Ct=function(){throw Error()},Object.defineProperty(Ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ct,[])}catch(Xr){var Lt=Xr}Reflect.construct(St,[],Ct)}else{try{Ct.call()}catch(Xr){Lt=Xr}St.call(Ct.prototype)}else{try{throw Error()}catch(Xr){Lt=Xr}St()}}catch(Xr){if(Xr&&Lt&&typeof Xr.stack=="string"){for(var Nt=Xr.stack.split(`
`),Vt=Lt.stack.split(`
`),sr=Nt.length-1,Tr=Vt.length-1;1<=sr&&0<=Tr&&Nt[sr]!==Vt[Tr];)Tr--;for(;1<=sr&&0<=Tr;sr--,Tr--)if(Nt[sr]!==Vt[Tr]){if(sr!==1||Tr!==1)do if(sr--,Tr--,0>Tr||Nt[sr]!==Vt[Tr]){var zr=`
`+Nt[sr].replace(" at new "," at ");return St.displayName&&zr.includes("<anonymous>")&&(zr=zr.replace("<anonymous>",St.displayName)),zr}while(1<=sr&&0<=Tr);break}}}finally{Kr=!1,Error.prepareStackTrace=Rt}return(St=St?St.displayName||St.name:"")?Zr(St):""}var an=Object.prototype.hasOwnProperty,hn=[],ln=-1;function en(St){return{current:St}}function dn(St){0>ln||(St.current=hn[ln],hn[ln]=null,ln--)}function sn(St,Ct){ln++,hn[ln]=St.current,St.current=Ct}var An={},Nn=en(An),vn=en(!1),kn=An;function In(St,Ct){var Rt=St.type.contextTypes;if(!Rt)return An;var Lt=St.stateNode;if(Lt&&Lt.__reactInternalMemoizedUnmaskedChildContext===Ct)return Lt.__reactInternalMemoizedMaskedChildContext;var Nt={},Vt;for(Vt in Rt)Nt[Vt]=Ct[Vt];return Lt&&(St=St.stateNode,St.__reactInternalMemoizedUnmaskedChildContext=Ct,St.__reactInternalMemoizedMaskedChildContext=Nt),Nt}function Dn(St){return St=St.childContextTypes,St!=null}function zn(){dn(vn),dn(Nn)}function yn(St,Ct,Rt){if(Nn.current!==An)throw Error(ot(168));sn(Nn,Ct),sn(vn,Rt)}function Vn(St,Ct,Rt){var Lt=St.stateNode;if(Ct=Ct.childContextTypes,typeof Lt.getChildContext!="function")return Rt;Lt=Lt.getChildContext();for(var Nt in Lt)if(!(Nt in Ct))throw Error(ot(108,wt(St)||"Unknown",Nt));return st({},Rt,Lt)}function On(St){return St=(St=St.stateNode)&&St.__reactInternalMemoizedMergedChildContext||An,kn=Nn.current,sn(Nn,St),sn(vn,vn.current),!0}function _n(St,Ct,Rt){var Lt=St.stateNode;if(!Lt)throw Error(ot(169));Rt?(St=Vn(St,Ct,kn),Lt.__reactInternalMemoizedMergedChildContext=St,dn(vn),dn(Nn),sn(Nn,St)):dn(vn),sn(vn,Rt)}var jn=Math.clz32?Math.clz32:Ts,Es=Math.log,Kn=Math.LN2;function Ts(St){return St>>>=0,St===0?32:31-(Es(St)/Kn|0)|0}var Js=64,qs=4194304;function Ks(St){switch(St&-St){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return St&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return St&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return St}}function vo(St,Ct){var Rt=St.pendingLanes;if(Rt===0)return 0;var Lt=0,Nt=St.suspendedLanes,Vt=St.pingedLanes,sr=Rt&268435455;if(sr!==0){var Tr=sr&~Nt;Tr!==0?Lt=Ks(Tr):(Vt&=sr,Vt!==0&&(Lt=Ks(Vt)))}else sr=Rt&~Nt,sr!==0?Lt=Ks(sr):Vt!==0&&(Lt=Ks(Vt));if(Lt===0)return 0;if(Ct!==0&&Ct!==Lt&&!(Ct&Nt)&&(Nt=Lt&-Lt,Vt=Ct&-Ct,Nt>=Vt||Nt===16&&(Vt&4194240)!==0))return Ct;if(Lt&4&&(Lt|=Rt&16),Ct=St.entangledLanes,Ct!==0)for(St=St.entanglements,Ct&=Lt;0<Ct;)Rt=31-jn(Ct),Nt=1<<Rt,Lt|=St[Rt],Ct&=~Nt;return Lt}function Il(St,Ct){switch(St){case 1:case 2:case 4:return Ct+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Ct+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qo(St,Ct){for(var Rt=St.suspendedLanes,Lt=St.pingedLanes,Nt=St.expirationTimes,Vt=St.pendingLanes;0<Vt;){var sr=31-jn(Vt),Tr=1<<sr,zr=Nt[sr];zr===-1?(!(Tr&Rt)||Tr&Lt)&&(Nt[sr]=Il(Tr,Ct)):zr<=Ct&&(St.expiredLanes|=Tr),Vt&=~Tr}}function Zs(St){return St=St.pendingLanes&-1073741825,St!==0?St:St&1073741824?1073741824:0}function Lo(St){for(var Ct=[],Rt=0;31>Rt;Rt++)Ct.push(St);return Ct}function Hs(St,Ct,Rt){St.pendingLanes|=Ct,Ct!==536870912&&(St.suspendedLanes=0,St.pingedLanes=0),St=St.eventTimes,Ct=31-jn(Ct),St[Ct]=Rt}function oo(St,Ct){var Rt=St.pendingLanes&~Ct;St.pendingLanes=Ct,St.suspendedLanes=0,St.pingedLanes=0,St.expiredLanes&=Ct,St.mutableReadLanes&=Ct,St.entangledLanes&=Ct,Ct=St.entanglements;var Lt=St.eventTimes;for(St=St.expirationTimes;0<Rt;){var Nt=31-jn(Rt),Vt=1<<Nt;Ct[Nt]=0,Lt[Nt]=-1,St[Nt]=-1,Rt&=~Vt}}function js(St,Ct){var Rt=St.entangledLanes|=Ct;for(St=St.entanglements;Rt;){var Lt=31-jn(Rt),Nt=1<<Lt;Nt&Ct|St[Lt]&Ct&&(St[Lt]|=Ct),Rt&=~Nt}}var Ln=0;function Wo(St){return St&=-St,1<St?4<St?St&268435455?16:536870912:4:1}var eo=it.unstable_scheduleCallback,Oo=it.unstable_cancelCallback,Xo=it.unstable_shouldYield,Ll=it.unstable_requestPaint,Yn=it.unstable_now,Ao=it.unstable_ImmediatePriority,Ol=it.unstable_UserBlockingPriority,ps=it.unstable_NormalPriority,Yo=it.unstable_IdlePriority,yo=null,ws=null;function Jo(St){if(ws&&typeof ws.onCommitFiberRoot=="function")try{ws.onCommitFiberRoot(yo,St,void 0,(St.current.flags&128)===128)}catch{}}function Bl(St,Ct){return St===Ct&&(St!==0||1/St===1/Ct)||St!==St&&Ct!==Ct}var Ms=typeof Object.is=="function"?Object.is:Bl,ms=null,Qs=!1,Bs=!1;function qo(St){ms===null?ms=[St]:ms.push(St)}function Ko(St){Qs=!0,qo(St)}function bs(){if(!Bs&&ms!==null){Bs=!0;var St=0,Ct=Ln;try{var Rt=ms;for(Ln=1;St<Rt.length;St++){var Lt=Rt[St];do Lt=Lt(!0);while(Lt!==null)}ms=null,Qs=!1}catch(Nt){throw ms!==null&&(ms=ms.slice(St+1)),eo(Ao,bs),Nt}finally{Ln=Ct,Bs=!1}}return null}var _o=lt.ReactCurrentBatchConfig;function Eo(St,Ct){if(Ms(St,Ct))return!0;if(typeof St!="object"||St===null||typeof Ct!="object"||Ct===null)return!1;var Rt=Object.keys(St),Lt=Object.keys(Ct);if(Rt.length!==Lt.length)return!1;for(Lt=0;Lt<Rt.length;Lt++){var Nt=Rt[Lt];if(!an.call(Ct,Nt)||!Ms(St[Nt],Ct[Nt]))return!1}return!0}function bo(St){switch(St.tag){case 5:return Zr(St.type);case 16:return Zr("Lazy");case 13:return Zr("Suspense");case 19:return Zr("SuspenseList");case 0:case 2:case 15:return St=qr(St.type,!1),St;case 11:return St=qr(St.type.render,!1),St;case 1:return St=qr(St.type,!0),St;default:return""}}function gs(St,Ct){if(St&&St.defaultProps){Ct=st({},Ct),St=St.defaultProps;for(var Rt in St)Ct[Rt]===void 0&&(Ct[Rt]=St[Rt]);return Ct}return Ct}var ss=en(null),Bo=null,zs=null,ao=null;function No(){ao=zs=Bo=null}function Nl(St,Ct,Rt){dr?(sn(ss,Ct._currentValue),Ct._currentValue=Rt):(sn(ss,Ct._currentValue2),Ct._currentValue2=Rt)}function os(St){var Ct=ss.current;dn(ss),dr?St._currentValue=Ct:St._currentValue2=Ct}function vs(St,Ct,Rt){for(;St!==null;){var Lt=St.alternate;if((St.childLanes&Ct)!==Ct?(St.childLanes|=Ct,Lt!==null&&(Lt.childLanes|=Ct)):Lt!==null&&(Lt.childLanes&Ct)!==Ct&&(Lt.childLanes|=Ct),St===Rt)break;St=St.return}}function Zn(St,Ct){Bo=St,ao=zs=null,St=St.dependencies,St!==null&&St.firstContext!==null&&(St.lanes&Ct&&(Ls=!0),St.firstContext=null)}function _i(St){var Ct=dr?St._currentValue:St._currentValue2;if(ao!==St)if(St={context:St,memoizedValue:Ct,next:null},zs===null){if(Bo===null)throw Error(ot(308));zs=St,Bo.dependencies={lanes:0,firstContext:St}}else zs=zs.next=St;return Ct}var Rs=null,lo=!1;function bu(St){St.updateQueue={baseState:St.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dp(St,Ct){St=St.updateQueue,Ct.updateQueue===St&&(Ct.updateQueue={baseState:St.baseState,firstBaseUpdate:St.firstBaseUpdate,lastBaseUpdate:St.lastBaseUpdate,shared:St.shared,effects:St.effects})}function to(St,Ct){return{eventTime:St,lane:Ct,tag:0,payload:null,callback:null,next:null}}function co(St,Ct){var Rt=St.updateQueue;Rt!==null&&(Rt=Rt.shared,ts!==null&&St.mode&1&&!(Pn&2)?(St=Rt.interleaved,St===null?(Ct.next=Ct,Rs===null?Rs=[Rt]:Rs.push(Rt)):(Ct.next=St.next,St.next=Ct),Rt.interleaved=Ct):(St=Rt.pending,St===null?Ct.next=Ct:(Ct.next=St.next,St.next=Ct),Rt.pending=Ct))}function Dl(St,Ct,Rt){if(Ct=Ct.updateQueue,Ct!==null&&(Ct=Ct.shared,(Rt&4194240)!==0)){var Lt=Ct.lanes;Lt&=St.pendingLanes,Rt|=Lt,Ct.lanes=Rt,js(St,Rt)}}function fp(St,Ct){var Rt=St.updateQueue,Lt=St.alternate;if(Lt!==null&&(Lt=Lt.updateQueue,Rt===Lt)){var Nt=null,Vt=null;if(Rt=Rt.firstBaseUpdate,Rt!==null){do{var sr={eventTime:Rt.eventTime,lane:Rt.lane,tag:Rt.tag,payload:Rt.payload,callback:Rt.callback,next:null};Vt===null?Nt=Vt=sr:Vt=Vt.next=sr,Rt=Rt.next}while(Rt!==null);Vt===null?Nt=Vt=Ct:Vt=Vt.next=Ct}else Nt=Vt=Ct;Rt={baseState:Lt.baseState,firstBaseUpdate:Nt,lastBaseUpdate:Vt,shared:Lt.shared,effects:Lt.effects},St.updateQueue=Rt;return}St=Rt.lastBaseUpdate,St===null?Rt.firstBaseUpdate=Ct:St.next=Ct,Rt.lastBaseUpdate=Ct}function Fl(St,Ct,Rt,Lt){var Nt=St.updateQueue;lo=!1;var Vt=Nt.firstBaseUpdate,sr=Nt.lastBaseUpdate,Tr=Nt.shared.pending;if(Tr!==null){Nt.shared.pending=null;var zr=Tr,Xr=zr.next;zr.next=null,sr===null?Vt=Xr:sr.next=Xr,sr=zr;var nn=St.alternate;nn!==null&&(nn=nn.updateQueue,Tr=nn.lastBaseUpdate,Tr!==sr&&(Tr===null?nn.firstBaseUpdate=Xr:Tr.next=Xr,nn.lastBaseUpdate=zr))}if(Vt!==null){var xn=Nt.baseState;sr=0,nn=Xr=zr=null,Tr=Vt;do{var pn=Tr.lane,Hn=Tr.eventTime;if((Lt&pn)===pn){nn!==null&&(nn=nn.next={eventTime:Hn,lane:0,tag:Tr.tag,payload:Tr.payload,callback:Tr.callback,next:null});e:{var un=St,fs=Tr;switch(pn=Ct,Hn=Rt,fs.tag){case 1:if(un=fs.payload,typeof un=="function"){xn=un.call(Hn,xn,pn);break e}xn=un;break e;case 3:un.flags=un.flags&-65537|128;case 0:if(un=fs.payload,pn=typeof un=="function"?un.call(Hn,xn,pn):un,pn==null)break e;xn=st({},xn,pn);break e;case 2:lo=!0}}Tr.callback!==null&&Tr.lane!==0&&(St.flags|=64,pn=Nt.effects,pn===null?Nt.effects=[Tr]:pn.push(Tr))}else Hn={eventTime:Hn,lane:pn,tag:Tr.tag,payload:Tr.payload,callback:Tr.callback,next:null},nn===null?(Xr=nn=Hn,zr=xn):nn=nn.next=Hn,sr|=pn;if(Tr=Tr.next,Tr===null){if(Tr=Nt.shared.pending,Tr===null)break;pn=Tr,Tr=pn.next,pn.next=null,Nt.lastBaseUpdate=pn,Nt.shared.pending=null}}while(1);if(nn===null&&(zr=xn),Nt.baseState=zr,Nt.firstBaseUpdate=Xr,Nt.lastBaseUpdate=nn,Ct=Nt.shared.interleaved,Ct!==null){Nt=Ct;do sr|=Nt.lane,Nt=Nt.next;while(Nt!==Ct)}else Vt===null&&(Nt.shared.lanes=0);Ho|=sr,St.lanes=sr,St.memoizedState=xn}}function pp(St,Ct,Rt){if(St=Ct.effects,Ct.effects=null,St!==null)for(Ct=0;Ct<St.length;Ct++){var Lt=St[Ct],Nt=Lt.callback;if(Nt!==null){if(Lt.callback=null,Lt=Rt,typeof Nt!="function")throw Error(ot(191,Nt));Nt.call(Lt)}}}var mp=new nt.Component().refs;function xu(St,Ct,Rt,Lt){Ct=St.memoizedState,Rt=Rt(Lt,Ct),Rt=Rt==null?Ct:st({},Ct,Rt),St.memoizedState=Rt,St.lanes===0&&(St.updateQueue.baseState=Rt)}var Ul={isMounted:function(St){return(St=St._reactInternals)?Tt(St)===St:!1},enqueueSetState:function(St,Ct,Rt){St=St._reactInternals;var Lt=ys(),Nt=fo(St),Vt=to(Lt,Nt);Vt.payload=Ct,Rt!=null&&(Vt.callback=Rt),co(St,Vt),Ct=Us(St,Nt,Lt),Ct!==null&&Dl(Ct,St,Nt)},enqueueReplaceState:function(St,Ct,Rt){St=St._reactInternals;var Lt=ys(),Nt=fo(St),Vt=to(Lt,Nt);Vt.tag=1,Vt.payload=Ct,Rt!=null&&(Vt.callback=Rt),co(St,Vt),Ct=Us(St,Nt,Lt),Ct!==null&&Dl(Ct,St,Nt)},enqueueForceUpdate:function(St,Ct){St=St._reactInternals;var Rt=ys(),Lt=fo(St),Nt=to(Rt,Lt);Nt.tag=2,Ct!=null&&(Nt.callback=Ct),co(St,Nt),Ct=Us(St,Lt,Rt),Ct!==null&&Dl(Ct,St,Lt)}};function gp(St,Ct,Rt,Lt,Nt,Vt,sr){return St=St.stateNode,typeof St.shouldComponentUpdate=="function"?St.shouldComponentUpdate(Lt,Vt,sr):Ct.prototype&&Ct.prototype.isPureReactComponent?!Eo(Rt,Lt)||!Eo(Nt,Vt):!0}function vp(St,Ct,Rt){var Lt=!1,Nt=An,Vt=Ct.contextType;return typeof Vt=="object"&&Vt!==null?Vt=_i(Vt):(Nt=Dn(Ct)?kn:Nn.current,Lt=Ct.contextTypes,Vt=(Lt=Lt!=null)?In(St,Nt):An),Ct=new Ct(Rt,Vt),St.memoizedState=Ct.state!==null&&Ct.state!==void 0?Ct.state:null,Ct.updater=Ul,St.stateNode=Ct,Ct._reactInternals=St,Lt&&(St=St.stateNode,St.__reactInternalMemoizedUnmaskedChildContext=Nt,St.__reactInternalMemoizedMaskedChildContext=Vt),Ct}function Ap(St,Ct,Rt,Lt){St=Ct.state,typeof Ct.componentWillReceiveProps=="function"&&Ct.componentWillReceiveProps(Rt,Lt),typeof Ct.UNSAFE_componentWillReceiveProps=="function"&&Ct.UNSAFE_componentWillReceiveProps(Rt,Lt),Ct.state!==St&&Ul.enqueueReplaceState(Ct,Ct.state,null)}function Su(St,Ct,Rt,Lt){var Nt=St.stateNode;Nt.props=Rt,Nt.state=St.memoizedState,Nt.refs=mp,bu(St);var Vt=Ct.contextType;typeof Vt=="object"&&Vt!==null?Nt.context=_i(Vt):(Vt=Dn(Ct)?kn:Nn.current,Nt.context=In(St,Vt)),Nt.state=St.memoizedState,Vt=Ct.getDerivedStateFromProps,typeof Vt=="function"&&(xu(St,Ct,Vt,Rt),Nt.state=St.memoizedState),typeof Ct.getDerivedStateFromProps=="function"||typeof Nt.getSnapshotBeforeUpdate=="function"||typeof Nt.UNSAFE_componentWillMount!="function"&&typeof Nt.componentWillMount!="function"||(Ct=Nt.state,typeof Nt.componentWillMount=="function"&&Nt.componentWillMount(),typeof Nt.UNSAFE_componentWillMount=="function"&&Nt.UNSAFE_componentWillMount(),Ct!==Nt.state&&Ul.enqueueReplaceState(Nt,Nt.state,null),Fl(St,Rt,Nt,Lt),Nt.state=St.memoizedState),typeof Nt.componentDidMount=="function"&&(St.flags|=4194308)}var ko=[],Do=0,$l=null,Gl=0,Ns=[],ks=0,xo=null,ro=1,no="";function So(St,Ct){ko[Do++]=Gl,ko[Do++]=$l,$l=St,Gl=Ct}function yp(St,Ct,Rt){Ns[ks++]=ro,Ns[ks++]=no,Ns[ks++]=xo,xo=St;var Lt=ro;St=no;var Nt=32-jn(Lt)-1;Lt&=~(1<<Nt),Rt+=1;var Vt=32-jn(Ct)+Nt;if(30<Vt){var sr=Nt-Nt%5;Vt=(Lt&(1<<sr)-1).toString(32),Lt>>=sr,Nt-=sr,ro=1<<32-jn(Ct)+Nt|Rt<<Nt|Lt,no=Vt+St}else ro=1<<Vt|Rt<<Nt|Lt,no=St}function Cu(St){St.return!==null&&(So(St,1),yp(St,1,0))}function Tu(St){for(;St===$l;)$l=ko[--Do],ko[Do]=null,Gl=ko[--Do],ko[Do]=null;for(;St===xo;)xo=Ns[--ks],Ns[ks]=null,no=Ns[--ks],Ns[ks]=null,ro=Ns[--ks],Ns[ks]=null}var Ps=null,Is=null,Wn=!1,Zo=!1,Vs=null;function _p(St,Ct){var Rt=$s(5,null,null,0);Rt.elementType="DELETED",Rt.stateNode=Ct,Rt.return=St,Ct=St.deletions,Ct===null?(St.deletions=[Rt],St.flags|=16):Ct.push(Rt)}function Ep(St,Ct){switch(St.tag){case 5:return Ct=En(Ct,St.type,St.pendingProps),Ct!==null?(St.stateNode=Ct,Ps=St,Is=on(Ct),!0):!1;case 6:return Ct=Xn(Ct,St.pendingProps),Ct!==null?(St.stateNode=Ct,Ps=St,Is=null,!0):!1;case 13:if(Ct=$n(Ct),Ct!==null){var Rt=xo!==null?{id:ro,overflow:no}:null;return St.memoizedState={dehydrated:Ct,treeContext:Rt,retryLane:1073741824},Rt=$s(18,null,null,0),Rt.stateNode=Ct,Rt.return=St,St.child=Rt,Ps=St,Is=null,!0}return!1;default:return!1}}function wu(St){return(St.mode&1)!==0&&(St.flags&128)===0}function Mu(St){if(Wn){var Ct=Is;if(Ct){var Rt=Ct;if(!Ep(St,Ct)){if(wu(St))throw Error(ot(418));Ct=Mn(Rt);var Lt=Ps;Ct&&Ep(St,Ct)?_p(Lt,Rt):(St.flags=St.flags&-4097|2,Wn=!1,Ps=St)}}else{if(wu(St))throw Error(ot(418));St.flags=St.flags&-4097|2,Wn=!1,Ps=St}}}function bp(St){for(St=St.return;St!==null&&St.tag!==5&&St.tag!==3&&St.tag!==13;)St=St.return;Ps=St}function na(St){if(!xr||St!==Ps)return!1;if(!Wn)return bp(St),Wn=!0,!1;if(St.tag!==3&&(St.tag!==5||$r(St.type)&&!or(St.type,St.memoizedProps))){var Ct=Is;if(Ct){if(wu(St)){for(St=Is;St;)St=Mn(St);throw Error(ot(418))}for(;Ct;)_p(St,Ct),Ct=Mn(Ct)}}if(bp(St),St.tag===13){if(!xr)throw Error(ot(316));if(St=St.memoizedState,St=St!==null?St.dehydrated:null,!St)throw Error(ot(317));Is=ir(St)}else Is=Ps?Mn(St.stateNode):null;return!0}function Fo(){xr&&(Is=Ps=null,Zo=Wn=!1)}function Ru(St){Vs===null?Vs=[St]:Vs.push(St)}function ga(St,Ct,Rt){if(St=Rt.ref,St!==null&&typeof St!="function"&&typeof St!="object"){if(Rt._owner){if(Rt=Rt._owner,Rt){if(Rt.tag!==1)throw Error(ot(309));var Lt=Rt.stateNode}if(!Lt)throw Error(ot(147,St));var Nt=Lt,Vt=""+St;return Ct!==null&&Ct.ref!==null&&typeof Ct.ref=="function"&&Ct.ref._stringRef===Vt?Ct.ref:(Ct=function(sr){var Tr=Nt.refs;Tr===mp&&(Tr=Nt.refs={}),sr===null?delete Tr[Vt]:Tr[Vt]=sr},Ct._stringRef=Vt,Ct)}if(typeof St!="string")throw Error(ot(284));if(!Rt._owner)throw Error(ot(290,St))}return St}function zl(St,Ct){throw St=Object.prototype.toString.call(Ct),Error(ot(31,St==="[object Object]"?"object with keys {"+Object.keys(Ct).join(", ")+"}":St))}function xp(St){var Ct=St._init;return Ct(St._payload)}function Sp(St){function Ct(Nr,Mr){if(St){var Fr=Nr.deletions;Fr===null?(Nr.deletions=[Mr],Nr.flags|=16):Fr.push(Mr)}}function Rt(Nr,Mr){if(!St)return null;for(;Mr!==null;)Ct(Nr,Mr),Mr=Mr.sibling;return null}function Lt(Nr,Mr){for(Nr=new Map;Mr!==null;)Mr.key!==null?Nr.set(Mr.key,Mr):Nr.set(Mr.index,Mr),Mr=Mr.sibling;return Nr}function Nt(Nr,Mr){return Nr=mo(Nr,Mr),Nr.index=0,Nr.sibling=null,Nr}function Vt(Nr,Mr,Fr){return Nr.index=Fr,St?(Fr=Nr.alternate,Fr!==null?(Fr=Fr.index,Fr<Mr?(Nr.flags|=2,Mr):Fr):(Nr.flags|=2,Mr)):(Nr.flags|=1048576,Mr)}function sr(Nr){return St&&Nr.alternate===null&&(Nr.flags|=2),Nr}function Tr(Nr,Mr,Fr,rn){return Mr===null||Mr.tag!==6?(Mr=cp(Fr,Nr.mode,rn),Mr.return=Nr,Mr):(Mr=Nt(Mr,Fr),Mr.return=Nr,Mr)}function zr(Nr,Mr,Fr,rn){var cn=Fr.type;return cn===ut?nn(Nr,Mr,Fr.props.children,rn,Fr.key):Mr!==null&&(Mr.elementType===cn||typeof cn=="object"&&cn!==null&&cn.$$typeof===yt&&xp(cn)===Mr.type)?(rn=Nt(Mr,Fr.props),rn.ref=ga(Nr,Mr,Fr),rn.return=Nr,rn):(rn=_u(Fr.type,Fr.key,Fr.props,null,Nr.mode,rn),rn.ref=ga(Nr,Mr,Fr),rn.return=Nr,rn)}function Xr(Nr,Mr,Fr,rn){return Mr===null||Mr.tag!==4||Mr.stateNode.containerInfo!==Fr.containerInfo||Mr.stateNode.implementation!==Fr.implementation?(Mr=up(Fr,Nr.mode,rn),Mr.return=Nr,Mr):(Mr=Nt(Mr,Fr.children||[]),Mr.return=Nr,Mr)}function nn(Nr,Mr,Fr,rn,cn){return Mr===null||Mr.tag!==7?(Mr=Io(Fr,Nr.mode,rn,cn),Mr.return=Nr,Mr):(Mr=Nt(Mr,Fr),Mr.return=Nr,Mr)}function xn(Nr,Mr,Fr){if(typeof Mr=="string"&&Mr!==""||typeof Mr=="number")return Mr=cp(""+Mr,Nr.mode,Fr),Mr.return=Nr,Mr;if(typeof Mr=="object"&&Mr!==null){switch(Mr.$$typeof){case at:return Fr=_u(Mr.type,Mr.key,Mr.props,null,Nr.mode,Fr),Fr.ref=ga(Nr,null,Mr),Fr.return=Nr,Fr;case ct:return Mr=up(Mr,Nr.mode,Fr),Mr.return=Nr,Mr;case yt:var rn=Mr._init;return xn(Nr,rn(Mr._payload),Fr)}if(Ut(Mr)||Et(Mr))return Mr=Io(Mr,Nr.mode,Fr,null),Mr.return=Nr,Mr;zl(Nr,Mr)}return null}function pn(Nr,Mr,Fr,rn){var cn=Mr!==null?Mr.key:null;if(typeof Fr=="string"&&Fr!==""||typeof Fr=="number")return cn!==null?null:Tr(Nr,Mr,""+Fr,rn);if(typeof Fr=="object"&&Fr!==null){switch(Fr.$$typeof){case at:return Fr.key===cn?zr(Nr,Mr,Fr,rn):null;case ct:return Fr.key===cn?Xr(Nr,Mr,Fr,rn):null;case yt:return cn=Fr._init,pn(Nr,Mr,cn(Fr._payload),rn)}if(Ut(Fr)||Et(Fr))return cn!==null?null:nn(Nr,Mr,Fr,rn,null);zl(Nr,Fr)}return null}function Hn(Nr,Mr,Fr,rn,cn){if(typeof rn=="string"&&rn!==""||typeof rn=="number")return Nr=Nr.get(Fr)||null,Tr(Mr,Nr,""+rn,cn);if(typeof rn=="object"&&rn!==null){switch(rn.$$typeof){case at:return Nr=Nr.get(rn.key===null?Fr:rn.key)||null,zr(Mr,Nr,rn,cn);case ct:return Nr=Nr.get(rn.key===null?Fr:rn.key)||null,Xr(Mr,Nr,rn,cn);case yt:var Rn=rn._init;return Hn(Nr,Mr,Fr,Rn(rn._payload),cn)}if(Ut(rn)||Et(rn))return Nr=Nr.get(Fr)||null,nn(Mr,Nr,rn,cn,null);zl(Mr,rn)}return null}function un(Nr,Mr,Fr,rn){for(var cn=null,Rn=null,Sn=Mr,Fn=Mr=0,ls=null;Sn!==null&&Fn<Fr.length;Fn++){Sn.index>Fn?(ls=Sn,Sn=null):ls=Sn.sibling;var Un=pn(Nr,Sn,Fr[Fn],rn);if(Un===null){Sn===null&&(Sn=ls);break}St&&Sn&&Un.alternate===null&&Ct(Nr,Sn),Mr=Vt(Un,Mr,Fn),Rn===null?cn=Un:Rn.sibling=Un,Rn=Un,Sn=ls}if(Fn===Fr.length)return Rt(Nr,Sn),Wn&&So(Nr,Fn),cn;if(Sn===null){for(;Fn<Fr.length;Fn++)Sn=xn(Nr,Fr[Fn],rn),Sn!==null&&(Mr=Vt(Sn,Mr,Fn),Rn===null?cn=Sn:Rn.sibling=Sn,Rn=Sn);return Wn&&So(Nr,Fn),cn}for(Sn=Lt(Nr,Sn);Fn<Fr.length;Fn++)ls=Hn(Sn,Nr,Fn,Fr[Fn],rn),ls!==null&&(St&&ls.alternate!==null&&Sn.delete(ls.key===null?Fn:ls.key),Mr=Vt(ls,Mr,Fn),Rn===null?cn=ls:Rn.sibling=ls,Rn=ls);return St&&Sn.forEach(function(go){return Ct(Nr,go)}),Wn&&So(Nr,Fn),cn}function fs(Nr,Mr,Fr,rn){var cn=Et(Fr);if(typeof cn!="function")throw Error(ot(150));if(Fr=cn.call(Fr),Fr==null)throw Error(ot(151));for(var Rn=cn=null,Sn=Mr,Fn=Mr=0,ls=null,Un=Fr.next();Sn!==null&&!Un.done;Fn++,Un=Fr.next()){Sn.index>Fn?(ls=Sn,Sn=null):ls=Sn.sibling;var go=pn(Nr,Sn,Un.value,rn);if(go===null){Sn===null&&(Sn=ls);break}St&&Sn&&go.alternate===null&&Ct(Nr,Sn),Mr=Vt(go,Mr,Fn),Rn===null?cn=go:Rn.sibling=go,Rn=go,Sn=ls}if(Un.done)return Rt(Nr,Sn),Wn&&So(Nr,Fn),cn;if(Sn===null){for(;!Un.done;Fn++,Un=Fr.next())Un=xn(Nr,Un.value,rn),Un!==null&&(Mr=Vt(Un,Mr,Fn),Rn===null?cn=Un:Rn.sibling=Un,Rn=Un);return Wn&&So(Nr,Fn),cn}for(Sn=Lt(Nr,Sn);!Un.done;Fn++,Un=Fr.next())Un=Hn(Sn,Nr,Fn,Un.value,rn),Un!==null&&(St&&Un.alternate!==null&&Sn.delete(Un.key===null?Fn:Un.key),Mr=Vt(Un,Mr,Fn),Rn===null?cn=Un:Rn.sibling=Un,Rn=Un);return St&&Sn.forEach(function(mm){return Ct(Nr,mm)}),Wn&&So(Nr,Fn),cn}function Gs(Nr,Mr,Fr,rn){if(typeof Fr=="object"&&Fr!==null&&Fr.type===ut&&Fr.key===null&&(Fr=Fr.props.children),typeof Fr=="object"&&Fr!==null){switch(Fr.$$typeof){case at:e:{for(var cn=Fr.key,Rn=Mr;Rn!==null;){if(Rn.key===cn){if(cn=Fr.type,cn===ut){if(Rn.tag===7){Rt(Nr,Rn.sibling),Mr=Nt(Rn,Fr.props.children),Mr.return=Nr,Nr=Mr;break e}}else if(Rn.elementType===cn||typeof cn=="object"&&cn!==null&&cn.$$typeof===yt&&xp(cn)===Rn.type){Rt(Nr,Rn.sibling),Mr=Nt(Rn,Fr.props),Mr.ref=ga(Nr,Rn,Fr),Mr.return=Nr,Nr=Mr;break e}Rt(Nr,Rn);break}else Ct(Nr,Rn);Rn=Rn.sibling}Fr.type===ut?(Mr=Io(Fr.props.children,Nr.mode,rn,Fr.key),Mr.return=Nr,Nr=Mr):(rn=_u(Fr.type,Fr.key,Fr.props,null,Nr.mode,rn),rn.ref=ga(Nr,Mr,Fr),rn.return=Nr,Nr=rn)}return sr(Nr);case ct:e:{for(Rn=Fr.key;Mr!==null;){if(Mr.key===Rn)if(Mr.tag===4&&Mr.stateNode.containerInfo===Fr.containerInfo&&Mr.stateNode.implementation===Fr.implementation){Rt(Nr,Mr.sibling),Mr=Nt(Mr,Fr.children||[]),Mr.return=Nr,Nr=Mr;break e}else{Rt(Nr,Mr);break}else Ct(Nr,Mr);Mr=Mr.sibling}Mr=up(Fr,Nr.mode,rn),Mr.return=Nr,Nr=Mr}return sr(Nr);case yt:return Rn=Fr._init,Gs(Nr,Mr,Rn(Fr._payload),rn)}if(Ut(Fr))return un(Nr,Mr,Fr,rn);if(Et(Fr))return fs(Nr,Mr,Fr,rn);zl(Nr,Fr)}return typeof Fr=="string"&&Fr!==""||typeof Fr=="number"?(Fr=""+Fr,Mr!==null&&Mr.tag===6?(Rt(Nr,Mr.sibling),Mr=Nt(Mr,Fr),Mr.return=Nr,Nr=Mr):(Rt(Nr,Mr),Mr=cp(Fr,Nr.mode,rn),Mr.return=Nr,Nr=Mr),sr(Nr)):Rt(Nr,Mr)}return Gs}var Uo=Sp(!0),Cp=Sp(!1),ba={},Ds=en(ba),xa=en(ba),$o=en(ba);function Ws(St){if(St===ba)throw Error(ot(174));return St}function Pu(St,Ct){sn($o,Ct),sn(xa,St),sn(Ds,ba),St=jt(Ct),dn(Ds),sn(Ds,St)}function Go(){dn(Ds),dn(xa),dn($o)}function Tp(St){var Ct=Ws($o.current),Rt=Ws(Ds.current);Ct=Dt(Rt,St.type,Ct),Rt!==Ct&&(sn(xa,St),sn(Ds,Ct))}function Iu(St){xa.current===St&&(dn(Ds),dn(xa))}var Jn=en(0);function Vl(St){for(var Ct=St;Ct!==null;){if(Ct.tag===13){var Rt=Ct.memoizedState;if(Rt!==null&&(Rt=Rt.dehydrated,Rt===null||wn(Rt)||Bn(Rt)))return Ct}else if(Ct.tag===19&&Ct.memoizedProps.revealOrder!==void 0){if(Ct.flags&128)return Ct}else if(Ct.child!==null){Ct.child.return=Ct,Ct=Ct.child;continue}if(Ct===St)break;for(;Ct.sibling===null;){if(Ct.return===null||Ct.return===St)return null;Ct=Ct.return}Ct.sibling.return=Ct.return,Ct=Ct.sibling}return null}var Lu=[];function Ou(){for(var St=0;St<Lu.length;St++){var Ct=Lu[St];dr?Ct._workInProgressVersionPrimary=null:Ct._workInProgressVersionSecondary=null}Lu.length=0}var Hl=lt.ReactCurrentDispatcher,Fs=lt.ReactCurrentBatchConfig,zo=0,qn=null,us=null,as=null,Ql=!1,$a=!1,Al=0,$0=0;function hs(){throw Error(ot(321))}function Bu(St,Ct){if(Ct===null)return!1;for(var Rt=0;Rt<Ct.length&&Rt<St.length;Rt++)if(!Ms(St[Rt],Ct[Rt]))return!1;return!0}function Nu(St,Ct,Rt,Lt,Nt,Vt){if(zo=Vt,qn=Ct,Ct.memoizedState=null,Ct.updateQueue=null,Ct.lanes=0,Hl.current=St===null||St.memoizedState===null?H0:j0,St=Rt(Lt,Nt),$a){Vt=0;do{if($a=!1,Al=0,25<=Vt)throw Error(ot(301));Vt+=1,as=us=null,Ct.updateQueue=null,Hl.current=Q0,St=Rt(Lt,Nt)}while($a)}if(Hl.current=Kl,Ct=us!==null&&us.next!==null,zo=0,as=us=qn=null,Ql=!1,Ct)throw Error(ot(300));return St}function ku(){var St=Al!==0;return Al=0,St}function io(){var St={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return as===null?qn.memoizedState=as=St:as=as.next=St,as}function Xs(){if(us===null){var St=qn.alternate;St=St!==null?St.memoizedState:null}else St=us.next;var Ct=as===null?qn.memoizedState:as.next;if(Ct!==null)as=Ct,us=St;else{if(St===null)throw Error(ot(310));us=St,St={memoizedState:us.memoizedState,baseState:us.baseState,baseQueue:us.baseQueue,queue:us.queue,next:null},as===null?qn.memoizedState=as=St:as=as.next=St}return as}function Co(St,Ct){return typeof Ct=="function"?Ct(St):Ct}function Wl(St){var Ct=Xs(),Rt=Ct.queue;if(Rt===null)throw Error(ot(311));Rt.lastRenderedReducer=St;var Lt=us,Nt=Lt.baseQueue,Vt=Rt.pending;if(Vt!==null){if(Nt!==null){var sr=Nt.next;Nt.next=Vt.next,Vt.next=sr}Lt.baseQueue=Nt=Vt,Rt.pending=null}if(Nt!==null){Vt=Nt.next,Lt=Lt.baseState;var Tr=sr=null,zr=null,Xr=Vt;do{var nn=Xr.lane;if((zo&nn)===nn)zr!==null&&(zr=zr.next={lane:0,action:Xr.action,hasEagerState:Xr.hasEagerState,eagerState:Xr.eagerState,next:null}),Lt=Xr.hasEagerState?Xr.eagerState:St(Lt,Xr.action);else{var xn={lane:nn,action:Xr.action,hasEagerState:Xr.hasEagerState,eagerState:Xr.eagerState,next:null};zr===null?(Tr=zr=xn,sr=Lt):zr=zr.next=xn,qn.lanes|=nn,Ho|=nn}Xr=Xr.next}while(Xr!==null&&Xr!==Vt);zr===null?sr=Lt:zr.next=Tr,Ms(Lt,Ct.memoizedState)||(Ls=!0),Ct.memoizedState=Lt,Ct.baseState=sr,Ct.baseQueue=zr,Rt.lastRenderedState=Lt}if(St=Rt.interleaved,St!==null){Nt=St;do Vt=Nt.lane,qn.lanes|=Vt,Ho|=Vt,Nt=Nt.next;while(Nt!==St)}else Nt===null&&(Rt.lanes=0);return[Ct.memoizedState,Rt.dispatch]}function Xl(St){var Ct=Xs(),Rt=Ct.queue;if(Rt===null)throw Error(ot(311));Rt.lastRenderedReducer=St;var Lt=Rt.dispatch,Nt=Rt.pending,Vt=Ct.memoizedState;if(Nt!==null){Rt.pending=null;var sr=Nt=Nt.next;do Vt=St(Vt,sr.action),sr=sr.next;while(sr!==Nt);Ms(Vt,Ct.memoizedState)||(Ls=!0),Ct.memoizedState=Vt,Ct.baseQueue===null&&(Ct.baseState=Vt),Rt.lastRenderedState=Vt}return[Vt,Lt]}function wp(){}function Mp(St,Ct){var Rt=qn,Lt=Xs(),Nt=Ct(),Vt=!Ms(Lt.memoizedState,Nt);if(Vt&&(Lt.memoizedState=Nt,Ls=!0),Lt=Lt.queue,_l(Ip.bind(null,Rt,Lt,St),[St]),Lt.getSnapshot!==Ct||Vt||as!==null&&as.memoizedState.tag&1){if(Rt.flags|=2048,yl(9,Pp.bind(null,Rt,Lt,Nt,Ct),void 0,null),ts===null)throw Error(ot(349));zo&30||Rp(Rt,Ct,Nt)}return Nt}function Rp(St,Ct,Rt){St.flags|=16384,St={getSnapshot:Ct,value:Rt},Ct=qn.updateQueue,Ct===null?(Ct={lastEffect:null,stores:null},qn.updateQueue=Ct,Ct.stores=[St]):(Rt=Ct.stores,Rt===null?Ct.stores=[St]:Rt.push(St))}function Pp(St,Ct,Rt,Lt){Ct.value=Rt,Ct.getSnapshot=Lt,Lp(Ct)&&Us(St,1,-1)}function Ip(St,Ct,Rt){return Rt(function(){Lp(Ct)&&Us(St,1,-1)})}function Lp(St){var Ct=St.getSnapshot;St=St.value;try{var Rt=Ct();return!Ms(St,Rt)}catch{return!0}}function Du(St){var Ct=io();return typeof St=="function"&&(St=St()),Ct.memoizedState=Ct.baseState=St,St={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:St},Ct.queue=St,St=St.dispatch=V0.bind(null,qn,St),[Ct.memoizedState,St]}function yl(St,Ct,Rt,Lt){return St={tag:St,create:Ct,destroy:Rt,deps:Lt,next:null},Ct=qn.updateQueue,Ct===null?(Ct={lastEffect:null,stores:null},qn.updateQueue=Ct,Ct.lastEffect=St.next=St):(Rt=Ct.lastEffect,Rt===null?Ct.lastEffect=St.next=St:(Lt=Rt.next,Rt.next=St,St.next=Lt,Ct.lastEffect=St)),St}function Op(){return Xs().memoizedState}function Yl(St,Ct,Rt,Lt){var Nt=io();qn.flags|=St,Nt.memoizedState=yl(1|Ct,Rt,void 0,Lt===void 0?null:Lt)}function Jl(St,Ct,Rt,Lt){var Nt=Xs();Lt=Lt===void 0?null:Lt;var Vt=void 0;if(us!==null){var sr=us.memoizedState;if(Vt=sr.destroy,Lt!==null&&Bu(Lt,sr.deps)){Nt.memoizedState=yl(Ct,Rt,Vt,Lt);return}}qn.flags|=St,Nt.memoizedState=yl(1|Ct,Rt,Vt,Lt)}function Fu(St,Ct){return Yl(8390656,8,St,Ct)}function _l(St,Ct){return Jl(2048,8,St,Ct)}function Bp(St,Ct){return Jl(4,2,St,Ct)}function Np(St,Ct){return Jl(4,4,St,Ct)}function kp(St,Ct){if(typeof Ct=="function")return St=St(),Ct(St),function(){Ct(null)};if(Ct!=null)return St=St(),Ct.current=St,function(){Ct.current=null}}function Dp(St,Ct,Rt){return Rt=Rt!=null?Rt.concat([St]):null,Jl(4,4,kp.bind(null,Ct,St),Rt)}function Uu(){}function Fp(St,Ct){var Rt=Xs();Ct=Ct===void 0?null:Ct;var Lt=Rt.memoizedState;return Lt!==null&&Ct!==null&&Bu(Ct,Lt[1])?Lt[0]:(Rt.memoizedState=[St,Ct],St)}function Up(St,Ct){var Rt=Xs();Ct=Ct===void 0?null:Ct;var Lt=Rt.memoizedState;return Lt!==null&&Ct!==null&&Bu(Ct,Lt[1])?Lt[0]:(St=St(),Rt.memoizedState=[St,Ct],St)}function G0(St,Ct){var Rt=Ln;Ln=Rt!==0&&4>Rt?Rt:4,St(!0);var Lt=Fs.transition;Fs.transition={};try{St(!1),Ct()}finally{Ln=Rt,Fs.transition=Lt}}function $p(){return Xs().memoizedState}function z0(St,Ct,Rt){var Lt=fo(St);Rt={lane:Lt,action:Rt,hasEagerState:!1,eagerState:null,next:null},Gp(St)?zp(Ct,Rt):(Vp(St,Ct,Rt),Rt=ys(),St=Us(St,Lt,Rt),St!==null&&Hp(St,Ct,Lt))}function V0(St,Ct,Rt){var Lt=fo(St),Nt={lane:Lt,action:Rt,hasEagerState:!1,eagerState:null,next:null};if(Gp(St))zp(Ct,Nt);else{Vp(St,Ct,Nt);var Vt=St.alternate;if(St.lanes===0&&(Vt===null||Vt.lanes===0)&&(Vt=Ct.lastRenderedReducer,Vt!==null))try{var sr=Ct.lastRenderedState,Tr=Vt(sr,Rt);if(Nt.hasEagerState=!0,Nt.eagerState=Tr,Ms(Tr,sr))return}catch{}finally{}Rt=ys(),St=Us(St,Lt,Rt),St!==null&&Hp(St,Ct,Lt)}}function Gp(St){var Ct=St.alternate;return St===qn||Ct!==null&&Ct===qn}function zp(St,Ct){$a=Ql=!0;var Rt=St.pending;Rt===null?Ct.next=Ct:(Ct.next=Rt.next,Rt.next=Ct),St.pending=Ct}function Vp(St,Ct,Rt){ts!==null&&St.mode&1&&!(Pn&2)?(St=Ct.interleaved,St===null?(Rt.next=Rt,Rs===null?Rs=[Ct]:Rs.push(Ct)):(Rt.next=St.next,St.next=Rt),Ct.interleaved=Rt):(St=Ct.pending,St===null?Rt.next=Rt:(Rt.next=St.next,St.next=Rt),Ct.pending=Rt)}function Hp(St,Ct,Rt){if(Rt&4194240){var Lt=Ct.lanes;Lt&=St.pendingLanes,Rt|=Lt,Ct.lanes=Rt,js(St,Rt)}}var Kl={readContext:_i,useCallback:hs,useContext:hs,useEffect:hs,useImperativeHandle:hs,useInsertionEffect:hs,useLayoutEffect:hs,useMemo:hs,useReducer:hs,useRef:hs,useState:hs,useDebugValue:hs,useDeferredValue:hs,useTransition:hs,useMutableSource:hs,useSyncExternalStore:hs,useId:hs,unstable_isNewReconciler:!1},H0={readContext:_i,useCallback:function(St,Ct){return io().memoizedState=[St,Ct===void 0?null:Ct],St},useContext:_i,useEffect:Fu,useImperativeHandle:function(St,Ct,Rt){return Rt=Rt!=null?Rt.concat([St]):null,Yl(4194308,4,kp.bind(null,Ct,St),Rt)},useLayoutEffect:function(St,Ct){return Yl(4194308,4,St,Ct)},useInsertionEffect:function(St,Ct){return Yl(4,2,St,Ct)},useMemo:function(St,Ct){var Rt=io();return Ct=Ct===void 0?null:Ct,St=St(),Rt.memoizedState=[St,Ct],St},useReducer:function(St,Ct,Rt){var Lt=io();return Ct=Rt!==void 0?Rt(Ct):Ct,Lt.memoizedState=Lt.baseState=Ct,St={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:St,lastRenderedState:Ct},Lt.queue=St,St=St.dispatch=z0.bind(null,qn,St),[Lt.memoizedState,St]},useRef:function(St){var Ct=io();return St={current:St},Ct.memoizedState=St},useState:Du,useDebugValue:Uu,useDeferredValue:function(St){var Ct=Du(St),Rt=Ct[0],Lt=Ct[1];return Fu(function(){var Nt=Fs.transition;Fs.transition={};try{Lt(St)}finally{Fs.transition=Nt}},[St]),Rt},useTransition:function(){var St=Du(!1),Ct=St[0];return St=G0.bind(null,St[1]),io().memoizedState=St,[Ct,St]},useMutableSource:function(){},useSyncExternalStore:function(St,Ct,Rt){var Lt=qn,Nt=io();if(Wn){if(Rt===void 0)throw Error(ot(407));Rt=Rt()}else{if(Rt=Ct(),ts===null)throw Error(ot(349));zo&30||Rp(Lt,Ct,Rt)}Nt.memoizedState=Rt;var Vt={value:Rt,getSnapshot:Ct};return Nt.queue=Vt,Fu(Ip.bind(null,Lt,Vt,St),[St]),Lt.flags|=2048,yl(9,Pp.bind(null,Lt,Vt,Rt,Ct),void 0,null),Rt},useId:function(){var St=io(),Ct=ts.identifierPrefix;if(Wn){var Rt=no,Lt=ro;Rt=(Lt&~(1<<32-jn(Lt)-1)).toString(32)+Rt,Ct=":"+Ct+"R"+Rt,Rt=Al++,0<Rt&&(Ct+="H"+Rt.toString(32)),Ct+=":"}else Rt=$0++,Ct=":"+Ct+"r"+Rt.toString(32)+":";return St.memoizedState=Ct},unstable_isNewReconciler:!1},j0={readContext:_i,useCallback:Fp,useContext:_i,useEffect:_l,useImperativeHandle:Dp,useInsertionEffect:Bp,useLayoutEffect:Np,useMemo:Up,useReducer:Wl,useRef:Op,useState:function(){return Wl(Co)},useDebugValue:Uu,useDeferredValue:function(St){var Ct=Wl(Co),Rt=Ct[0],Lt=Ct[1];return _l(function(){var Nt=Fs.transition;Fs.transition={};try{Lt(St)}finally{Fs.transition=Nt}},[St]),Rt},useTransition:function(){var St=Wl(Co)[0],Ct=Xs().memoizedState;return[St,Ct]},useMutableSource:wp,useSyncExternalStore:Mp,useId:$p,unstable_isNewReconciler:!1},Q0={readContext:_i,useCallback:Fp,useContext:_i,useEffect:_l,useImperativeHandle:Dp,useInsertionEffect:Bp,useLayoutEffect:Np,useMemo:Up,useReducer:Xl,useRef:Op,useState:function(){return Xl(Co)},useDebugValue:Uu,useDeferredValue:function(St){var Ct=Xl(Co),Rt=Ct[0],Lt=Ct[1];return _l(function(){var Nt=Fs.transition;Fs.transition={};try{Lt(St)}finally{Fs.transition=Nt}},[St]),Rt},useTransition:function(){var St=Xl(Co)[0],Ct=Xs().memoizedState;return[St,Ct]},useMutableSource:wp,useSyncExternalStore:Mp,useId:$p,unstable_isNewReconciler:!1};function $u(St,Ct){try{var Rt="",Lt=Ct;do Rt+=bo(Lt),Lt=Lt.return;while(Lt);var Nt=Rt}catch(Vt){Nt=`
Error generating stack: `+Vt.message+`
`+Vt.stack}return{value:St,source:Ct,stack:Nt}}function Gu(St,Ct){try{console.error(Ct.value)}catch(Rt){setTimeout(function(){throw Rt})}}var W0=typeof WeakMap=="function"?WeakMap:Map;function jp(St,Ct,Rt){Rt=to(-1,Rt),Rt.tag=3,Rt.payload={element:null};var Lt=Ct.value;return Rt.callback=function(){fu||(fu=!0,rp=Lt),Gu(St,Ct)},Rt}function Qp(St,Ct,Rt){Rt=to(-1,Rt),Rt.tag=3;var Lt=St.type.getDerivedStateFromError;if(typeof Lt=="function"){var Nt=Ct.value;Rt.payload=function(){return Lt(Nt)},Rt.callback=function(){Gu(St,Ct)}}var Vt=St.stateNode;return Vt!==null&&typeof Vt.componentDidCatch=="function"&&(Rt.callback=function(){Gu(St,Ct),typeof Lt!="function"&&(uo===null?uo=new Set([this]):uo.add(this));var sr=Ct.stack;this.componentDidCatch(Ct.value,{componentStack:sr!==null?sr:""})}),Rt}function Wp(St,Ct,Rt){var Lt=St.pingCache;if(Lt===null){Lt=St.pingCache=new W0;var Nt=new Set;Lt.set(Ct,Nt)}else Nt=Lt.get(Ct),Nt===void 0&&(Nt=new Set,Lt.set(Ct,Nt));Nt.has(Rt)||(Nt.add(Rt),St=am.bind(null,St,Ct,Rt),Ct.then(St,St))}function Xp(St){do{var Ct;if((Ct=St.tag===13)&&(Ct=St.memoizedState,Ct=Ct!==null?Ct.dehydrated!==null:!0),Ct)return St;St=St.return}while(St!==null);return null}function Yp(St,Ct,Rt,Lt,Nt){return St.mode&1?(St.flags|=65536,St.lanes=Nt,St):(St===Ct?St.flags|=65536:(St.flags|=128,Rt.flags|=131072,Rt.flags&=-52805,Rt.tag===1&&(Rt.alternate===null?Rt.tag=17:(Ct=to(-1,1),Ct.tag=2,co(Rt,Ct))),Rt.lanes|=1),St)}function Ys(St){St.flags|=4}function Jp(St,Ct){if(St!==null&&St.child===Ct.child)return!0;if(Ct.flags&16)return!1;for(St=Ct.child;St!==null;){if(St.flags&12854||St.subtreeFlags&12854)return!1;St=St.sibling}return!0}var El,xl,Zl,_c;if(gr)El=function(St,Ct){for(var Rt=Ct.child;Rt!==null;){if(Rt.tag===5||Rt.tag===6)Ht(St,Rt.stateNode);else if(Rt.tag!==4&&Rt.child!==null){Rt.child.return=Rt,Rt=Rt.child;continue}if(Rt===Ct)break;for(;Rt.sibling===null;){if(Rt.return===null||Rt.return===Ct)return;Rt=Rt.return}Rt.sibling.return=Rt.return,Rt=Rt.sibling}},xl=function(){},Zl=function(St,Ct,Rt,Lt,Nt){if(St=St.memoizedProps,St!==Lt){var Vt=Ct.stateNode,sr=Ws(Ds.current);Rt=Zt(Vt,Rt,St,Lt,Nt,sr),(Ct.updateQueue=Rt)&&Ys(Ct)}},_c=function(St,Ct,Rt,Lt){Rt!==Lt&&Ys(Ct)};else if(Yt){El=function(St,Ct,Rt,Lt){for(var Nt=Ct.child;Nt!==null;){if(Nt.tag===5){var Vt=Nt.stateNode;Rt&&Lt&&(Vt=Tn(Vt,Nt.type,Nt.memoizedProps,Nt)),Ht(St,Vt)}else if(Nt.tag===6)Vt=Nt.stateNode,Rt&&Lt&&(Vt=gn(Vt,Nt.memoizedProps,Nt)),Ht(St,Vt);else if(Nt.tag!==4){if(Nt.tag===22&&Nt.memoizedState!==null)Vt=Nt.child,Vt!==null&&(Vt.return=Nt),El(St,Nt,!0,!0);else if(Nt.child!==null){Nt.child.return=Nt,Nt=Nt.child;continue}}if(Nt===Ct)break;for(;Nt.sibling===null;){if(Nt.return===null||Nt.return===Ct)return;Nt=Nt.return}Nt.sibling.return=Nt.return,Nt=Nt.sibling}};var qp=function(St,Ct,Rt,Lt){for(var Nt=Ct.child;Nt!==null;){if(Nt.tag===5){var Vt=Nt.stateNode;Rt&&Lt&&(Vt=Tn(Vt,Nt.type,Nt.memoizedProps,Nt)),bn(St,Vt)}else if(Nt.tag===6)Vt=Nt.stateNode,Rt&&Lt&&(Vt=gn(Vt,Nt.memoizedProps,Nt)),bn(St,Vt);else if(Nt.tag!==4){if(Nt.tag===22&&Nt.memoizedState!==null)Vt=Nt.child,Vt!==null&&(Vt.return=Nt),qp(St,Nt,!0,!0);else if(Nt.child!==null){Nt.child.return=Nt,Nt=Nt.child;continue}}if(Nt===Ct)break;for(;Nt.sibling===null;){if(Nt.return===null||Nt.return===Ct)return;Nt=Nt.return}Nt.sibling.return=Nt.return,Nt=Nt.sibling}};xl=function(St,Ct){var Rt=Ct.stateNode;if(!Jp(St,Ct)){St=Rt.containerInfo;var Lt=mn(St);qp(Lt,Ct,!1,!1),Rt.pendingChildren=Lt,Ys(Ct),fn(St,Lt)}},Zl=function(St,Ct,Rt,Lt,Nt){var Vt=St.stateNode,sr=St.memoizedProps;if((St=Jp(St,Ct))&&sr===Lt)Ct.stateNode=Vt;else{var Tr=Ct.stateNode,zr=Ws(Ds.current),Xr=null;sr!==Lt&&(Xr=Zt(Tr,Rt,sr,Lt,Nt,zr)),St&&Xr===null?Ct.stateNode=Vt:(Vt=Yr(Vt,Xr,Rt,sr,Lt,Ct,St,Tr),er(Vt,Rt,Lt,Nt,zr)&&Ys(Ct),Ct.stateNode=Vt,St?Ys(Ct):El(Vt,Ct,!1,!1))}},_c=function(St,Ct,Rt,Lt){Rt!==Lt?(St=Ws($o.current),Rt=Ws(Ds.current),Ct.stateNode=Kt(Lt,St,Rt,Ct),Ys(Ct)):Ct.stateNode=St.stateNode}}else xl=function(){},Zl=function(){},_c=function(){};function Sl(St,Ct){if(!Wn)switch(St.tailMode){case"hidden":Ct=St.tail;for(var Rt=null;Ct!==null;)Ct.alternate!==null&&(Rt=Ct),Ct=Ct.sibling;Rt===null?St.tail=null:Rt.sibling=null;break;case"collapsed":Rt=St.tail;for(var Lt=null;Rt!==null;)Rt.alternate!==null&&(Lt=Rt),Rt=Rt.sibling;Lt===null?Ct||St.tail===null?St.tail=null:St.tail.sibling=null:Lt.sibling=null}}function ds(St){var Ct=St.alternate!==null&&St.alternate.child===St.child,Rt=0,Lt=0;if(Ct)for(var Nt=St.child;Nt!==null;)Rt|=Nt.lanes|Nt.childLanes,Lt|=Nt.subtreeFlags&14680064,Lt|=Nt.flags&14680064,Nt.return=St,Nt=Nt.sibling;else for(Nt=St.child;Nt!==null;)Rt|=Nt.lanes|Nt.childLanes,Lt|=Nt.subtreeFlags,Lt|=Nt.flags,Nt.return=St,Nt=Nt.sibling;return St.subtreeFlags|=Lt,St.childLanes=Rt,Ct}function X0(St,Ct,Rt){var Lt=Ct.pendingProps;switch(Tu(Ct),Ct.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(Ct),null;case 1:return Dn(Ct.type)&&zn(),ds(Ct),null;case 3:return Lt=Ct.stateNode,Go(),dn(vn),dn(Nn),Ou(),Lt.pendingContext&&(Lt.context=Lt.pendingContext,Lt.pendingContext=null),(St===null||St.child===null)&&(na(Ct)?Ys(Ct):St===null||St.memoizedState.isDehydrated&&!(Ct.flags&256)||(Ct.flags|=1024,Vs!==null&&(sp(Vs),Vs=null))),xl(St,Ct),ds(Ct),null;case 5:Iu(Ct),Rt=Ws($o.current);var Nt=Ct.type;if(St!==null&&Ct.stateNode!=null)Zl(St,Ct,Nt,Lt,Rt),St.ref!==Ct.ref&&(Ct.flags|=512,Ct.flags|=2097152);else{if(!Lt){if(Ct.stateNode===null)throw Error(ot(166));return ds(Ct),null}if(St=Ws(Ds.current),na(Ct)){if(!xr)throw Error(ot(175));St=Wt(Ct.stateNode,Ct.type,Ct.memoizedProps,Rt,St,Ct,!Zo),Ct.updateQueue=St,St!==null&&Ys(Ct)}else{var Vt=$t(Nt,Lt,Rt,St,Ct);El(Vt,Ct,!1,!1),Ct.stateNode=Vt,er(Vt,Nt,Lt,Rt,St)&&Ys(Ct)}Ct.ref!==null&&(Ct.flags|=512,Ct.flags|=2097152)}return ds(Ct),null;case 6:if(St&&Ct.stateNode!=null)_c(St,Ct,St.memoizedProps,Lt);else{if(typeof Lt!="string"&&Ct.stateNode===null)throw Error(ot(166));if(St=Ws($o.current),Rt=Ws(Ds.current),na(Ct)){if(!xr)throw Error(ot(176));if(St=Ct.stateNode,Lt=Ct.memoizedProps,(Rt=kt(St,Lt,Ct,!Zo))&&(Nt=Ps,Nt!==null))switch(Vt=(Nt.mode&1)!==0,Nt.tag){case 3:Gr(Nt.stateNode.containerInfo,St,Lt,Vt);break;case 5:Vr(Nt.type,Nt.memoizedProps,Nt.stateNode,St,Lt,Vt)}Rt&&Ys(Ct)}else Ct.stateNode=Kt(Lt,St,Rt,Ct)}return ds(Ct),null;case 13:if(dn(Jn),Lt=Ct.memoizedState,Wn&&Is!==null&&Ct.mode&1&&!(Ct.flags&128)){for(St=Is;St;)St=Mn(St);return Fo(),Ct.flags|=98560,Ct}if(Lt!==null&&Lt.dehydrated!==null){if(Lt=na(Ct),St===null){if(!Lt)throw Error(ot(318));if(!xr)throw Error(ot(344));if(St=Ct.memoizedState,St=St!==null?St.dehydrated:null,!St)throw Error(ot(317));Jt(St,Ct)}else Fo(),!(Ct.flags&128)&&(Ct.memoizedState=null),Ct.flags|=4;return ds(Ct),null}return Vs!==null&&(sp(Vs),Vs=null),Ct.flags&128?(Ct.lanes=Rt,Ct):(Lt=Lt!==null,Rt=!1,St===null?na(Ct):Rt=St.memoizedState!==null,Lt&&!Rt&&(Ct.child.flags|=8192,Ct.mode&1&&(St===null||Jn.current&1?ns===0&&(ns=3):ap())),Ct.updateQueue!==null&&(Ct.flags|=4),ds(Ct),null);case 4:return Go(),xl(St,Ct),St===null&&Pr(Ct.stateNode.containerInfo),ds(Ct),null;case 10:return os(Ct.type._context),ds(Ct),null;case 17:return Dn(Ct.type)&&zn(),ds(Ct),null;case 19:if(dn(Jn),Nt=Ct.memoizedState,Nt===null)return ds(Ct),null;if(Lt=(Ct.flags&128)!==0,Vt=Nt.rendering,Vt===null)if(Lt)Sl(Nt,!1);else{if(ns!==0||St!==null&&St.flags&128)for(St=Ct.child;St!==null;){if(Vt=Vl(St),Vt!==null){for(Ct.flags|=128,Sl(Nt,!1),St=Vt.updateQueue,St!==null&&(Ct.updateQueue=St,Ct.flags|=4),Ct.subtreeFlags=0,St=Rt,Lt=Ct.child;Lt!==null;)Rt=Lt,Nt=St,Rt.flags&=14680066,Vt=Rt.alternate,Vt===null?(Rt.childLanes=0,Rt.lanes=Nt,Rt.child=null,Rt.subtreeFlags=0,Rt.memoizedProps=null,Rt.memoizedState=null,Rt.updateQueue=null,Rt.dependencies=null,Rt.stateNode=null):(Rt.childLanes=Vt.childLanes,Rt.lanes=Vt.lanes,Rt.child=Vt.child,Rt.subtreeFlags=0,Rt.deletions=null,Rt.memoizedProps=Vt.memoizedProps,Rt.memoizedState=Vt.memoizedState,Rt.updateQueue=Vt.updateQueue,Rt.type=Vt.type,Nt=Vt.dependencies,Rt.dependencies=Nt===null?null:{lanes:Nt.lanes,firstContext:Nt.firstContext}),Lt=Lt.sibling;return sn(Jn,Jn.current&1|2),Ct.child}St=St.sibling}Nt.tail!==null&&Yn()>tp&&(Ct.flags|=128,Lt=!0,Sl(Nt,!1),Ct.lanes=4194304)}else{if(!Lt)if(St=Vl(Vt),St!==null){if(Ct.flags|=128,Lt=!0,St=St.updateQueue,St!==null&&(Ct.updateQueue=St,Ct.flags|=4),Sl(Nt,!0),Nt.tail===null&&Nt.tailMode==="hidden"&&!Vt.alternate&&!Wn)return ds(Ct),null}else 2*Yn()-Nt.renderingStartTime>tp&&Rt!==1073741824&&(Ct.flags|=128,Lt=!0,Sl(Nt,!1),Ct.lanes=4194304);Nt.isBackwards?(Vt.sibling=Ct.child,Ct.child=Vt):(St=Nt.last,St!==null?St.sibling=Vt:Ct.child=Vt,Nt.last=Vt)}return Nt.tail!==null?(Ct=Nt.tail,Nt.rendering=Ct,Nt.tail=Ct.sibling,Nt.renderingStartTime=Yn(),Ct.sibling=null,St=Jn.current,sn(Jn,Lt?St&1|2:St&1),Ct):(ds(Ct),null);case 22:case 23:return op(),Lt=Ct.memoizedState!==null,St!==null&&St.memoizedState!==null!==Lt&&(Ct.flags|=8192),Lt&&Ct.mode&1?Os&1073741824&&(ds(Ct),gr&&Ct.subtreeFlags&6&&(Ct.flags|=8192)):ds(Ct),null;case 24:return null;case 25:return null}throw Error(ot(156,Ct.tag))}var Y0=lt.ReactCurrentOwner,Ls=!1;function As(St,Ct,Rt,Lt){Ct.child=St===null?Cp(Ct,null,Rt,Lt):Uo(Ct,St.child,Rt,Lt)}function Kp(St,Ct,Rt,Lt,Nt){Rt=Rt.render;var Vt=Ct.ref;return Zn(Ct,Nt),Lt=Nu(St,Ct,Rt,Lt,Vt,Nt),Rt=ku(),St!==null&&!Ls?(Ct.updateQueue=St.updateQueue,Ct.flags&=-2053,St.lanes&=~Nt,so(St,Ct,Nt)):(Wn&&Rt&&Cu(Ct),Ct.flags|=1,As(St,Ct,Lt,Nt),Ct.child)}function Zp(St,Ct,Rt,Lt,Nt){if(St===null){var Vt=Rt.type;return typeof Vt=="function"&&!lp(Vt)&&Vt.defaultProps===void 0&&Rt.compare===null&&Rt.defaultProps===void 0?(Ct.tag=15,Ct.type=Vt,e0(St,Ct,Vt,Lt,Nt)):(St=_u(Rt.type,null,Lt,Ct,Ct.mode,Nt),St.ref=Ct.ref,St.return=Ct,Ct.child=St)}if(Vt=St.child,!(St.lanes&Nt)){var sr=Vt.memoizedProps;if(Rt=Rt.compare,Rt=Rt!==null?Rt:Eo,Rt(sr,Lt)&&St.ref===Ct.ref)return so(St,Ct,Nt)}return Ct.flags|=1,St=mo(Vt,Lt),St.ref=Ct.ref,St.return=Ct,Ct.child=St}function e0(St,Ct,Rt,Lt,Nt){if(St!==null&&Eo(St.memoizedProps,Lt)&&St.ref===Ct.ref)if(Ls=!1,(St.lanes&Nt)!==0)St.flags&131072&&(Ls=!0);else return Ct.lanes=St.lanes,so(St,Ct,Nt);return zu(St,Ct,Rt,Lt,Nt)}function r0(St,Ct,Rt){var Lt=Ct.pendingProps,Nt=Lt.children,Vt=St!==null?St.memoizedState:null;if(Lt.mode==="hidden")if(!(Ct.mode&1))Ct.memoizedState={baseLanes:0,cachePool:null},sn(Vo,Os),Os|=Rt;else if(Rt&1073741824)Ct.memoizedState={baseLanes:0,cachePool:null},Lt=Vt!==null?Vt.baseLanes:Rt,sn(Vo,Os),Os|=Lt;else return St=Vt!==null?Vt.baseLanes|Rt:Rt,Ct.lanes=Ct.childLanes=1073741824,Ct.memoizedState={baseLanes:St,cachePool:null},Ct.updateQueue=null,sn(Vo,Os),Os|=St,null;else Vt!==null?(Lt=Vt.baseLanes|Rt,Ct.memoizedState=null):Lt=Rt,sn(Vo,Os),Os|=Lt;return As(St,Ct,Nt,Rt),Ct.child}function n0(St,Ct){var Rt=Ct.ref;(St===null&&Rt!==null||St!==null&&St.ref!==Rt)&&(Ct.flags|=512,Ct.flags|=2097152)}function zu(St,Ct,Rt,Lt,Nt){var Vt=Dn(Rt)?kn:Nn.current;return Vt=In(Ct,Vt),Zn(Ct,Nt),Rt=Nu(St,Ct,Rt,Lt,Vt,Nt),Lt=ku(),St!==null&&!Ls?(Ct.updateQueue=St.updateQueue,Ct.flags&=-2053,St.lanes&=~Nt,so(St,Ct,Nt)):(Wn&&Lt&&Cu(Ct),Ct.flags|=1,As(St,Ct,Rt,Nt),Ct.child)}function i0(St,Ct,Rt,Lt,Nt){if(Dn(Rt)){var Vt=!0;On(Ct)}else Vt=!1;if(Zn(Ct,Nt),Ct.stateNode===null)St!==null&&(St.alternate=null,Ct.alternate=null,Ct.flags|=2),vp(Ct,Rt,Lt),Su(Ct,Rt,Lt,Nt),Lt=!0;else if(St===null){var sr=Ct.stateNode,Tr=Ct.memoizedProps;sr.props=Tr;var zr=sr.context,Xr=Rt.contextType;typeof Xr=="object"&&Xr!==null?Xr=_i(Xr):(Xr=Dn(Rt)?kn:Nn.current,Xr=In(Ct,Xr));var nn=Rt.getDerivedStateFromProps,xn=typeof nn=="function"||typeof sr.getSnapshotBeforeUpdate=="function";xn||typeof sr.UNSAFE_componentWillReceiveProps!="function"&&typeof sr.componentWillReceiveProps!="function"||(Tr!==Lt||zr!==Xr)&&Ap(Ct,sr,Lt,Xr),lo=!1;var pn=Ct.memoizedState;sr.state=pn,Fl(Ct,Lt,sr,Nt),zr=Ct.memoizedState,Tr!==Lt||pn!==zr||vn.current||lo?(typeof nn=="function"&&(xu(Ct,Rt,nn,Lt),zr=Ct.memoizedState),(Tr=lo||gp(Ct,Rt,Tr,Lt,pn,zr,Xr))?(xn||typeof sr.UNSAFE_componentWillMount!="function"&&typeof sr.componentWillMount!="function"||(typeof sr.componentWillMount=="function"&&sr.componentWillMount(),typeof sr.UNSAFE_componentWillMount=="function"&&sr.UNSAFE_componentWillMount()),typeof sr.componentDidMount=="function"&&(Ct.flags|=4194308)):(typeof sr.componentDidMount=="function"&&(Ct.flags|=4194308),Ct.memoizedProps=Lt,Ct.memoizedState=zr),sr.props=Lt,sr.state=zr,sr.context=Xr,Lt=Tr):(typeof sr.componentDidMount=="function"&&(Ct.flags|=4194308),Lt=!1)}else{sr=Ct.stateNode,dp(St,Ct),Tr=Ct.memoizedProps,Xr=Ct.type===Ct.elementType?Tr:gs(Ct.type,Tr),sr.props=Xr,xn=Ct.pendingProps,pn=sr.context,zr=Rt.contextType,typeof zr=="object"&&zr!==null?zr=_i(zr):(zr=Dn(Rt)?kn:Nn.current,zr=In(Ct,zr));var Hn=Rt.getDerivedStateFromProps;(nn=typeof Hn=="function"||typeof sr.getSnapshotBeforeUpdate=="function")||typeof sr.UNSAFE_componentWillReceiveProps!="function"&&typeof sr.componentWillReceiveProps!="function"||(Tr!==xn||pn!==zr)&&Ap(Ct,sr,Lt,zr),lo=!1,pn=Ct.memoizedState,sr.state=pn,Fl(Ct,Lt,sr,Nt);var un=Ct.memoizedState;Tr!==xn||pn!==un||vn.current||lo?(typeof Hn=="function"&&(xu(Ct,Rt,Hn,Lt),un=Ct.memoizedState),(Xr=lo||gp(Ct,Rt,Xr,Lt,pn,un,zr)||!1)?(nn||typeof sr.UNSAFE_componentWillUpdate!="function"&&typeof sr.componentWillUpdate!="function"||(typeof sr.componentWillUpdate=="function"&&sr.componentWillUpdate(Lt,un,zr),typeof sr.UNSAFE_componentWillUpdate=="function"&&sr.UNSAFE_componentWillUpdate(Lt,un,zr)),typeof sr.componentDidUpdate=="function"&&(Ct.flags|=4),typeof sr.getSnapshotBeforeUpdate=="function"&&(Ct.flags|=1024)):(typeof sr.componentDidUpdate!="function"||Tr===St.memoizedProps&&pn===St.memoizedState||(Ct.flags|=4),typeof sr.getSnapshotBeforeUpdate!="function"||Tr===St.memoizedProps&&pn===St.memoizedState||(Ct.flags|=1024),Ct.memoizedProps=Lt,Ct.memoizedState=un),sr.props=Lt,sr.state=un,sr.context=zr,Lt=Xr):(typeof sr.componentDidUpdate!="function"||Tr===St.memoizedProps&&pn===St.memoizedState||(Ct.flags|=4),typeof sr.getSnapshotBeforeUpdate!="function"||Tr===St.memoizedProps&&pn===St.memoizedState||(Ct.flags|=1024),Lt=!1)}return Vu(St,Ct,Rt,Lt,Vt,Nt)}function Vu(St,Ct,Rt,Lt,Nt,Vt){n0(St,Ct);var sr=(Ct.flags&128)!==0;if(!Lt&&!sr)return Nt&&_n(Ct,Rt,!1),so(St,Ct,Vt);Lt=Ct.stateNode,Y0.current=Ct;var Tr=sr&&typeof Rt.getDerivedStateFromError!="function"?null:Lt.render();return Ct.flags|=1,St!==null&&sr?(Ct.child=Uo(Ct,St.child,null,Vt),Ct.child=Uo(Ct,null,Tr,Vt)):As(St,Ct,Tr,Vt),Ct.memoizedState=Lt.state,Nt&&_n(Ct,Rt,!0),Ct.child}function s0(St){var Ct=St.stateNode;Ct.pendingContext?yn(St,Ct.pendingContext,Ct.pendingContext!==Ct.context):Ct.context&&yn(St,Ct.context,!1),Pu(St,Ct.containerInfo)}function o0(St,Ct,Rt,Lt,Nt){return Fo(),Ru(Nt),Ct.flags|=256,As(St,Ct,Rt,Lt),Ct.child}var eu={dehydrated:null,treeContext:null,retryLane:0};function tu(St){return{baseLanes:St,cachePool:null}}function a0(St,Ct,Rt){var Lt=Ct.pendingProps,Nt=Jn.current,Vt=!1,sr=(Ct.flags&128)!==0,Tr;if((Tr=sr)||(Tr=St!==null&&St.memoizedState===null?!1:(Nt&2)!==0),Tr?(Vt=!0,Ct.flags&=-129):(St===null||St.memoizedState!==null)&&(Nt|=1),sn(Jn,Nt&1),St===null)return Mu(Ct),St=Ct.memoizedState,St!==null&&(St=St.dehydrated,St!==null)?(Ct.mode&1?Bn(St)?Ct.lanes=8:Ct.lanes=1073741824:Ct.lanes=1,null):(Nt=Lt.children,St=Lt.fallback,Vt?(Lt=Ct.mode,Vt=Ct.child,Nt={mode:"hidden",children:Nt},!(Lt&1)&&Vt!==null?(Vt.childLanes=0,Vt.pendingProps=Nt):Vt=Eu(Nt,Lt,0,null),St=Io(St,Lt,Rt,null),Vt.return=Ct,St.return=Ct,Vt.sibling=St,Ct.child=Vt,Ct.child.memoizedState=tu(Rt),Ct.memoizedState=eu,St):Hu(Ct,Nt));if(Nt=St.memoizedState,Nt!==null){if(Tr=Nt.dehydrated,Tr!==null){if(sr)return Ct.flags&256?(Ct.flags&=-257,ru(St,Ct,Rt,Error(ot(422)))):Ct.memoizedState!==null?(Ct.child=St.child,Ct.flags|=128,null):(Vt=Lt.fallback,Nt=Ct.mode,Lt=Eu({mode:"visible",children:Lt.children},Nt,0,null),Vt=Io(Vt,Nt,Rt,null),Vt.flags|=2,Lt.return=Ct,Vt.return=Ct,Lt.sibling=Vt,Ct.child=Lt,Ct.mode&1&&Uo(Ct,St.child,null,Rt),Ct.child.memoizedState=tu(Rt),Ct.memoizedState=eu,Vt);if(!(Ct.mode&1))Ct=ru(St,Ct,Rt,null);else if(Bn(Tr))Ct=ru(St,Ct,Rt,Error(ot(419)));else if(Lt=(Rt&St.childLanes)!==0,Ls||Lt){if(Lt=ts,Lt!==null){switch(Rt&-Rt){case 4:Vt=2;break;case 16:Vt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Vt=32;break;case 536870912:Vt=268435456;break;default:Vt=0}Lt=Vt&(Lt.suspendedLanes|Rt)?0:Vt,Lt!==0&&Lt!==Nt.retryLane&&(Nt.retryLane=Lt,Us(St,Lt,-1))}ap(),Ct=ru(St,Ct,Rt,Error(ot(421)))}else wn(Tr)?(Ct.flags|=128,Ct.child=St.child,Ct=lm.bind(null,St),Qn(Tr,Ct),Ct=null):(Rt=Nt.treeContext,xr&&(Is=_s(Tr),Ps=Ct,Wn=!0,Vs=null,Zo=!1,Rt!==null&&(Ns[ks++]=ro,Ns[ks++]=no,Ns[ks++]=xo,ro=Rt.id,no=Rt.overflow,xo=Ct)),Ct=Hu(Ct,Ct.pendingProps.children),Ct.flags|=4096);return Ct}return Vt?(Lt=c0(St,Ct,Lt.children,Lt.fallback,Rt),Vt=Ct.child,Nt=St.child.memoizedState,Vt.memoizedState=Nt===null?tu(Rt):{baseLanes:Nt.baseLanes|Rt,cachePool:null},Vt.childLanes=St.childLanes&~Rt,Ct.memoizedState=eu,Lt):(Rt=l0(St,Ct,Lt.children,Rt),Ct.memoizedState=null,Rt)}return Vt?(Lt=c0(St,Ct,Lt.children,Lt.fallback,Rt),Vt=Ct.child,Nt=St.child.memoizedState,Vt.memoizedState=Nt===null?tu(Rt):{baseLanes:Nt.baseLanes|Rt,cachePool:null},Vt.childLanes=St.childLanes&~Rt,Ct.memoizedState=eu,Lt):(Rt=l0(St,Ct,Lt.children,Rt),Ct.memoizedState=null,Rt)}function Hu(St,Ct){return Ct=Eu({mode:"visible",children:Ct},St.mode,0,null),Ct.return=St,St.child=Ct}function l0(St,Ct,Rt,Lt){var Nt=St.child;return St=Nt.sibling,Rt=mo(Nt,{mode:"visible",children:Rt}),!(Ct.mode&1)&&(Rt.lanes=Lt),Rt.return=Ct,Rt.sibling=null,St!==null&&(Lt=Ct.deletions,Lt===null?(Ct.deletions=[St],Ct.flags|=16):Lt.push(St)),Ct.child=Rt}function c0(St,Ct,Rt,Lt,Nt){var Vt=Ct.mode;St=St.child;var sr=St.sibling,Tr={mode:"hidden",children:Rt};return!(Vt&1)&&Ct.child!==St?(Rt=Ct.child,Rt.childLanes=0,Rt.pendingProps=Tr,Ct.deletions=null):(Rt=mo(St,Tr),Rt.subtreeFlags=St.subtreeFlags&14680064),sr!==null?Lt=mo(sr,Lt):(Lt=Io(Lt,Vt,Nt,null),Lt.flags|=2),Lt.return=Ct,Rt.return=Ct,Rt.sibling=Lt,Ct.child=Rt,Lt}function ru(St,Ct,Rt,Lt){return Lt!==null&&Ru(Lt),Uo(Ct,St.child,null,Rt),St=Hu(Ct,Ct.pendingProps.children),St.flags|=2,Ct.memoizedState=null,St}function u0(St,Ct,Rt){St.lanes|=Ct;var Lt=St.alternate;Lt!==null&&(Lt.lanes|=Ct),vs(St.return,Ct,Rt)}function ju(St,Ct,Rt,Lt,Nt){var Vt=St.memoizedState;Vt===null?St.memoizedState={isBackwards:Ct,rendering:null,renderingStartTime:0,last:Lt,tail:Rt,tailMode:Nt}:(Vt.isBackwards=Ct,Vt.rendering=null,Vt.renderingStartTime=0,Vt.last=Lt,Vt.tail=Rt,Vt.tailMode=Nt)}function h0(St,Ct,Rt){var Lt=Ct.pendingProps,Nt=Lt.revealOrder,Vt=Lt.tail;if(As(St,Ct,Lt.children,Rt),Lt=Jn.current,Lt&2)Lt=Lt&1|2,Ct.flags|=128;else{if(St!==null&&St.flags&128)e:for(St=Ct.child;St!==null;){if(St.tag===13)St.memoizedState!==null&&u0(St,Rt,Ct);else if(St.tag===19)u0(St,Rt,Ct);else if(St.child!==null){St.child.return=St,St=St.child;continue}if(St===Ct)break e;for(;St.sibling===null;){if(St.return===null||St.return===Ct)break e;St=St.return}St.sibling.return=St.return,St=St.sibling}Lt&=1}if(sn(Jn,Lt),!(Ct.mode&1))Ct.memoizedState=null;else switch(Nt){case"forwards":for(Rt=Ct.child,Nt=null;Rt!==null;)St=Rt.alternate,St!==null&&Vl(St)===null&&(Nt=Rt),Rt=Rt.sibling;Rt=Nt,Rt===null?(Nt=Ct.child,Ct.child=null):(Nt=Rt.sibling,Rt.sibling=null),ju(Ct,!1,Nt,Rt,Vt);break;case"backwards":for(Rt=null,Nt=Ct.child,Ct.child=null;Nt!==null;){if(St=Nt.alternate,St!==null&&Vl(St)===null){Ct.child=Nt;break}St=Nt.sibling,Nt.sibling=Rt,Rt=Nt,Nt=St}ju(Ct,!0,Rt,null,Vt);break;case"together":ju(Ct,!1,null,null,void 0);break;default:Ct.memoizedState=null}return Ct.child}function so(St,Ct,Rt){if(St!==null&&(Ct.dependencies=St.dependencies),Ho|=Ct.lanes,!(Rt&Ct.childLanes))return null;if(St!==null&&Ct.child!==St.child)throw Error(ot(153));if(Ct.child!==null){for(St=Ct.child,Rt=mo(St,St.pendingProps),Ct.child=Rt,Rt.return=Ct;St.sibling!==null;)St=St.sibling,Rt=Rt.sibling=mo(St,St.pendingProps),Rt.return=Ct;Rt.sibling=null}return Ct.child}function J0(St,Ct,Rt){switch(Ct.tag){case 3:s0(Ct),Fo();break;case 5:Tp(Ct);break;case 1:Dn(Ct.type)&&On(Ct);break;case 4:Pu(Ct,Ct.stateNode.containerInfo);break;case 10:Nl(Ct,Ct.type._context,Ct.memoizedProps.value);break;case 13:var Lt=Ct.memoizedState;if(Lt!==null)return Lt.dehydrated!==null?(sn(Jn,Jn.current&1),Ct.flags|=128,null):Rt&Ct.child.childLanes?a0(St,Ct,Rt):(sn(Jn,Jn.current&1),St=so(St,Ct,Rt),St!==null?St.sibling:null);sn(Jn,Jn.current&1);break;case 19:if(Lt=(Rt&Ct.childLanes)!==0,St.flags&128){if(Lt)return h0(St,Ct,Rt);Ct.flags|=128}var Nt=Ct.memoizedState;if(Nt!==null&&(Nt.rendering=null,Nt.tail=null,Nt.lastEffect=null),sn(Jn,Jn.current),Lt)break;return null;case 22:case 23:return Ct.lanes=0,r0(St,Ct,Rt)}return so(St,Ct,Rt)}function q0(St,Ct){switch(Tu(Ct),Ct.tag){case 1:return Dn(Ct.type)&&zn(),St=Ct.flags,St&65536?(Ct.flags=St&-65537|128,Ct):null;case 3:return Go(),dn(vn),dn(Nn),Ou(),St=Ct.flags,St&65536&&!(St&128)?(Ct.flags=St&-65537|128,Ct):null;case 5:return Iu(Ct),null;case 13:if(dn(Jn),St=Ct.memoizedState,St!==null&&St.dehydrated!==null){if(Ct.alternate===null)throw Error(ot(340));Fo()}return St=Ct.flags,St&65536?(Ct.flags=St&-65537|128,Ct):null;case 19:return dn(Jn),null;case 4:return Go(),null;case 10:return os(Ct.type._context),null;case 22:case 23:return op(),null;case 24:return null;default:return null}}var nu=!1,To=!1,K0=typeof WeakSet=="function"?WeakSet:Set,tn=null;function iu(St,Ct){var Rt=St.ref;if(Rt!==null)if(typeof Rt=="function")try{Rt(null)}catch(Lt){Cs(St,Ct,Lt)}else Rt.current=null}function Qu(St,Ct,Rt){try{Rt()}catch(Lt){Cs(St,Ct,Lt)}}var d0=!1;function Z0(St,Ct){for(Gt(St.containerInfo),tn=Ct;tn!==null;)if(St=tn,Ct=St.child,(St.subtreeFlags&1028)!==0&&Ct!==null)Ct.return=St,tn=Ct;else for(;tn!==null;){St=tn;try{var Rt=St.alternate;if(St.flags&1024)switch(St.tag){case 0:case 11:case 15:break;case 1:if(Rt!==null){var Lt=Rt.memoizedProps,Nt=Rt.memoizedState,Vt=St.stateNode,sr=Vt.getSnapshotBeforeUpdate(St.elementType===St.type?Lt:gs(St.type,Lt),Nt);Vt.__reactInternalSnapshotBeforeUpdate=sr}break;case 3:gr&&jr(St.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(ot(163))}}catch(Tr){Cs(St,St.return,Tr)}if(Ct=St.sibling,Ct!==null){Ct.return=St.return,tn=Ct;break}tn=St.return}return Rt=d0,d0=!1,Rt}function wo(St,Ct,Rt){var Lt=Ct.updateQueue;if(Lt=Lt!==null?Lt.lastEffect:null,Lt!==null){var Nt=Lt=Lt.next;do{if((Nt.tag&St)===St){var Vt=Nt.destroy;Nt.destroy=void 0,Vt!==void 0&&Qu(Ct,Rt,Vt)}Nt=Nt.next}while(Nt!==Lt)}}function Cl(St,Ct){if(Ct=Ct.updateQueue,Ct=Ct!==null?Ct.lastEffect:null,Ct!==null){var Rt=Ct=Ct.next;do{if((Rt.tag&St)===St){var Lt=Rt.create;Rt.destroy=Lt()}Rt=Rt.next}while(Rt!==Ct)}}function Wu(St){var Ct=St.ref;if(Ct!==null){var Rt=St.stateNode;switch(St.tag){case 5:St=Ft(Rt);break;default:St=Rt}typeof Ct=="function"?Ct(St):Ct.current=St}}function f0(St,Ct,Rt){if(ws&&typeof ws.onCommitFiberUnmount=="function")try{ws.onCommitFiberUnmount(yo,Ct)}catch{}switch(Ct.tag){case 0:case 11:case 14:case 15:if(St=Ct.updateQueue,St!==null&&(St=St.lastEffect,St!==null)){var Lt=St=St.next;do{var Nt=Lt,Vt=Nt.destroy;Nt=Nt.tag,Vt!==void 0&&(Nt&2||Nt&4)&&Qu(Ct,Rt,Vt),Lt=Lt.next}while(Lt!==St)}break;case 1:if(iu(Ct,Rt),St=Ct.stateNode,typeof St.componentWillUnmount=="function")try{St.props=Ct.memoizedProps,St.state=Ct.memoizedState,St.componentWillUnmount()}catch(sr){Cs(Ct,Rt,sr)}break;case 5:iu(Ct,Rt);break;case 4:gr?y0(St,Ct,Rt):Yt&&Yt&&(Ct=Ct.stateNode.containerInfo,Rt=mn(Ct),Cn(Ct,Rt))}}function p0(St,Ct,Rt){for(var Lt=Ct;;)if(f0(St,Lt,Rt),Lt.child===null||gr&&Lt.tag===4){if(Lt===Ct)break;for(;Lt.sibling===null;){if(Lt.return===null||Lt.return===Ct)return;Lt=Lt.return}Lt.sibling.return=Lt.return,Lt=Lt.sibling}else Lt.child.return=Lt,Lt=Lt.child}function m0(St){var Ct=St.alternate;Ct!==null&&(St.alternate=null,m0(Ct)),St.child=null,St.deletions=null,St.sibling=null,St.tag===5&&(Ct=St.stateNode,Ct!==null&&Qr(Ct)),St.stateNode=null,St.return=null,St.dependencies=null,St.memoizedProps=null,St.memoizedState=null,St.pendingProps=null,St.stateNode=null,St.updateQueue=null}function g0(St){return St.tag===5||St.tag===3||St.tag===4}function v0(St){e:for(;;){for(;St.sibling===null;){if(St.return===null||g0(St.return))return null;St=St.return}for(St.sibling.return=St.return,St=St.sibling;St.tag!==5&&St.tag!==6&&St.tag!==18;){if(St.flags&2||St.child===null||St.tag===4)continue e;St.child.return=St,St=St.child}if(!(St.flags&2))return St.stateNode}}function A0(St){if(gr){e:{for(var Ct=St.return;Ct!==null;){if(g0(Ct))break e;Ct=Ct.return}throw Error(ot(160))}var Rt=Ct;switch(Rt.tag){case 5:Ct=Rt.stateNode,Rt.flags&32&&(cr(Ct),Rt.flags&=-33),Rt=v0(St),Yu(St,Rt,Ct);break;case 3:case 4:Ct=Rt.stateNode.containerInfo,Rt=v0(St),Xu(St,Rt,Ct);break;default:throw Error(ot(161))}}}function Xu(St,Ct,Rt){var Lt=St.tag;if(Lt===5||Lt===6)St=St.stateNode,Ct?mr(Rt,St,Ct):Hr(Rt,St);else if(Lt!==4&&(St=St.child,St!==null))for(Xu(St,Ct,Rt),St=St.sibling;St!==null;)Xu(St,Ct,Rt),St=St.sibling}function Yu(St,Ct,Rt){var Lt=St.tag;if(Lt===5||Lt===6)St=St.stateNode,Ct?pr(Rt,St,Ct):_r(Rt,St);else if(Lt!==4&&(St=St.child,St!==null))for(Yu(St,Ct,Rt),St=St.sibling;St!==null;)Yu(St,Ct,Rt),St=St.sibling}function y0(St,Ct,Rt){for(var Lt=Ct,Nt=!1,Vt,sr;;){if(!Nt){Nt=Lt.return;e:for(;;){if(Nt===null)throw Error(ot(160));switch(Vt=Nt.stateNode,Nt.tag){case 5:sr=!1;break e;case 3:Vt=Vt.containerInfo,sr=!0;break e;case 4:Vt=Vt.containerInfo,sr=!0;break e}Nt=Nt.return}Nt=!0}if(Lt.tag===5||Lt.tag===6)p0(St,Lt,Rt),sr?Cr(Vt,Lt.stateNode):nr(Vt,Lt.stateNode);else if(Lt.tag===18)sr?Br(Vt,Lt.stateNode):Or(Vt,Lt.stateNode);else if(Lt.tag===4){if(Lt.child!==null){Vt=Lt.stateNode.containerInfo,sr=!0,Lt.child.return=Lt,Lt=Lt.child;continue}}else if(f0(St,Lt,Rt),Lt.child!==null){Lt.child.return=Lt,Lt=Lt.child;continue}if(Lt===Ct)break;for(;Lt.sibling===null;){if(Lt.return===null||Lt.return===Ct)return;Lt=Lt.return,Lt.tag===4&&(Nt=!1)}Lt.sibling.return=Lt.return,Lt=Lt.sibling}}function Ju(St,Ct){if(gr){switch(Ct.tag){case 0:case 11:case 14:case 15:wo(3,Ct,Ct.return),Cl(3,Ct),wo(5,Ct,Ct.return);return;case 1:return;case 5:var Rt=Ct.stateNode;if(Rt!=null){var Lt=Ct.memoizedProps;St=St!==null?St.memoizedProps:Lt;var Nt=Ct.type,Vt=Ct.updateQueue;Ct.updateQueue=null,Vt!==null&&qt(Rt,Vt,Nt,St,Lt,Ct)}return;case 6:if(Ct.stateNode===null)throw Error(ot(162));Rt=Ct.memoizedProps,Er(Ct.stateNode,St!==null?St.memoizedProps:Rt,Rt);return;case 3:xr&&St!==null&&St.memoizedState.isDehydrated&&tr(Ct.stateNode.containerInfo);return;case 12:return;case 13:su(Ct);return;case 19:su(Ct);return;case 17:return}throw Error(ot(163))}switch(Ct.tag){case 0:case 11:case 14:case 15:wo(3,Ct,Ct.return),Cl(3,Ct),wo(5,Ct,Ct.return);return;case 12:return;case 13:su(Ct);return;case 19:su(Ct);return;case 3:xr&&St!==null&&St.memoizedState.isDehydrated&&tr(Ct.stateNode.containerInfo);break;case 22:case 23:return}e:if(Yt){switch(Ct.tag){case 1:case 5:case 6:break e;case 3:case 4:Ct=Ct.stateNode,Cn(Ct.containerInfo,Ct.pendingChildren);break e}throw Error(ot(163))}}function su(St){var Ct=St.updateQueue;if(Ct!==null){St.updateQueue=null;var Rt=St.stateNode;Rt===null&&(Rt=St.stateNode=new K0),Ct.forEach(function(Lt){var Nt=cm.bind(null,St,Lt);Rt.has(Lt)||(Rt.add(Lt),Lt.then(Nt,Nt))})}}function em(St,Ct){for(tn=Ct;tn!==null;){Ct=tn;var Rt=Ct.deletions;if(Rt!==null)for(var Lt=0;Lt<Rt.length;Lt++){var Nt=Rt[Lt];try{var Vt=St;gr?y0(Vt,Nt,Ct):p0(Vt,Nt,Ct);var sr=Nt.alternate;sr!==null&&(sr.return=null),Nt.return=null}catch(cn){Cs(Nt,Ct,cn)}}if(Rt=Ct.child,Ct.subtreeFlags&12854&&Rt!==null)Rt.return=Ct,tn=Rt;else for(;tn!==null;){Ct=tn;try{var Tr=Ct.flags;if(Tr&32&&gr&&cr(Ct.stateNode),Tr&512){var zr=Ct.alternate;if(zr!==null){var Xr=zr.ref;Xr!==null&&(typeof Xr=="function"?Xr(null):Xr.current=null)}}if(Tr&8192)switch(Ct.tag){case 13:if(Ct.memoizedState!==null){var nn=Ct.alternate;(nn===null||nn.memoizedState===null)&&(ep=Yn())}break;case 22:var xn=Ct.memoizedState!==null,pn=Ct.alternate,Hn=pn!==null&&pn.memoizedState!==null;if(Rt=Ct,gr){e:if(Lt=Rt,Nt=xn,Vt=null,gr)for(var un=Lt;;){if(un.tag===5){if(Vt===null){Vt=un;var fs=un.stateNode;Nt?Jr(fs):Rr(un.stateNode,un.memoizedProps)}}else if(un.tag===6){if(Vt===null){var Gs=un.stateNode;Nt?lr(Gs):br(Gs,un.memoizedProps)}}else if((un.tag!==22&&un.tag!==23||un.memoizedState===null||un===Lt)&&un.child!==null){un.child.return=un,un=un.child;continue}if(un===Lt)break;for(;un.sibling===null;){if(un.return===null||un.return===Lt)break e;Vt===un&&(Vt=null),un=un.return}Vt===un&&(Vt=null),un.sibling.return=un.return,un=un.sibling}}if(xn&&!Hn&&Rt.mode&1){tn=Rt;for(var Nr=Rt.child;Nr!==null;){for(Rt=tn=Nr;tn!==null;){Lt=tn;var Mr=Lt.child;switch(Lt.tag){case 0:case 11:case 14:case 15:wo(4,Lt,Lt.return);break;case 1:iu(Lt,Lt.return);var Fr=Lt.stateNode;if(typeof Fr.componentWillUnmount=="function"){var rn=Lt.return;try{Fr.props=Lt.memoizedProps,Fr.state=Lt.memoizedState,Fr.componentWillUnmount()}catch(cn){Cs(Lt,rn,cn)}}break;case 5:iu(Lt,Lt.return);break;case 22:if(Lt.memoizedState!==null){b0(Rt);continue}}Mr!==null?(Mr.return=Lt,tn=Mr):b0(Rt)}Nr=Nr.sibling}}}switch(Tr&4102){case 2:A0(Ct),Ct.flags&=-3;break;case 6:A0(Ct),Ct.flags&=-3,Ju(Ct.alternate,Ct);break;case 4096:Ct.flags&=-4097;break;case 4100:Ct.flags&=-4097,Ju(Ct.alternate,Ct);break;case 4:Ju(Ct.alternate,Ct)}}catch(cn){Cs(Ct,Ct.return,cn)}if(Rt=Ct.sibling,Rt!==null){Rt.return=Ct.return,tn=Rt;break}tn=Ct.return}}}function tm(St,Ct,Rt){tn=St,_0(St)}function _0(St,Ct,Rt){for(var Lt=(St.mode&1)!==0;tn!==null;){var Nt=tn,Vt=Nt.child;if(Nt.tag===22&&Lt){var sr=Nt.memoizedState!==null||nu;if(!sr){var Tr=Nt.alternate,zr=Tr!==null&&Tr.memoizedState!==null||To;Tr=nu;var Xr=To;if(nu=sr,(To=zr)&&!Xr)for(tn=Nt;tn!==null;)sr=tn,zr=sr.child,sr.tag===22&&sr.memoizedState!==null?x0(Nt):zr!==null?(zr.return=sr,tn=zr):x0(Nt);for(;Vt!==null;)tn=Vt,_0(Vt),Vt=Vt.sibling;tn=Nt,nu=Tr,To=Xr}E0(St)}else Nt.subtreeFlags&8772&&Vt!==null?(Vt.return=Nt,tn=Vt):E0(St)}}function E0(St){for(;tn!==null;){var Ct=tn;if(Ct.flags&8772){var Rt=Ct.alternate;try{if(Ct.flags&8772)switch(Ct.tag){case 0:case 11:case 15:To||Cl(5,Ct);break;case 1:var Lt=Ct.stateNode;if(Ct.flags&4&&!To)if(Rt===null)Lt.componentDidMount();else{var Nt=Ct.elementType===Ct.type?Rt.memoizedProps:gs(Ct.type,Rt.memoizedProps);Lt.componentDidUpdate(Nt,Rt.memoizedState,Lt.__reactInternalSnapshotBeforeUpdate)}var Vt=Ct.updateQueue;Vt!==null&&pp(Ct,Vt,Lt);break;case 3:var sr=Ct.updateQueue;if(sr!==null){if(Rt=null,Ct.child!==null)switch(Ct.child.tag){case 5:Rt=Ft(Ct.child.stateNode);break;case 1:Rt=Ct.child.stateNode}pp(Ct,sr,Rt)}break;case 5:var Tr=Ct.stateNode;Rt===null&&Ct.flags&4&&Ar(Tr,Ct.type,Ct.memoizedProps,Ct);break;case 6:break;case 4:break;case 12:break;case 13:if(xr&&Ct.memoizedState===null){var zr=Ct.alternate;if(zr!==null){var Xr=zr.memoizedState;if(Xr!==null){var nn=Xr.dehydrated;nn!==null&&ar(nn)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(ot(163))}To||Ct.flags&512&&Wu(Ct)}catch(xn){Cs(Ct,Ct.return,xn)}}if(Ct===St){tn=null;break}if(Rt=Ct.sibling,Rt!==null){Rt.return=Ct.return,tn=Rt;break}tn=Ct.return}}function b0(St){for(;tn!==null;){var Ct=tn;if(Ct===St){tn=null;break}var Rt=Ct.sibling;if(Rt!==null){Rt.return=Ct.return,tn=Rt;break}tn=Ct.return}}function x0(St){for(;tn!==null;){var Ct=tn;try{switch(Ct.tag){case 0:case 11:case 15:var Rt=Ct.return;try{Cl(4,Ct)}catch(zr){Cs(Ct,Rt,zr)}break;case 1:var Lt=Ct.stateNode;if(typeof Lt.componentDidMount=="function"){var Nt=Ct.return;try{Lt.componentDidMount()}catch(zr){Cs(Ct,Nt,zr)}}var Vt=Ct.return;try{Wu(Ct)}catch(zr){Cs(Ct,Vt,zr)}break;case 5:var sr=Ct.return;try{Wu(Ct)}catch(zr){Cs(Ct,sr,zr)}}}catch(zr){Cs(Ct,Ct.return,zr)}if(Ct===St){tn=null;break}var Tr=Ct.sibling;if(Tr!==null){Tr.return=Ct.return,tn=Tr;break}tn=Ct.return}}var ou=0,au=1,lu=2,cu=3,uu=4;if(typeof Symbol=="function"&&Symbol.for){var Tl=Symbol.for;ou=Tl("selector.component"),au=Tl("selector.has_pseudo_class"),lu=Tl("selector.role"),cu=Tl("selector.test_id"),uu=Tl("selector.text")}function qu(St){var Ct=vr(St);if(Ct!=null){if(typeof Ct.memoizedProps["data-testname"]!="string")throw Error(ot(364));return Ct}if(St=Lr(St),St===null)throw Error(ot(362));return St.stateNode.current}function Ku(St,Ct){switch(Ct.$$typeof){case ou:if(St.type===Ct.value)return!0;break;case au:e:{Ct=Ct.value,St=[St,0];for(var Rt=0;Rt<St.length;){var Lt=St[Rt++],Nt=St[Rt++],Vt=Ct[Nt];if(Lt.tag!==5||!Qt(Lt)){for(;Vt!=null&&Ku(Lt,Vt);)Nt++,Vt=Ct[Nt];if(Nt===Ct.length){Ct=!0;break e}else for(Lt=Lt.child;Lt!==null;)St.push(Lt,Nt),Lt=Lt.sibling}}Ct=!1}return Ct;case lu:if(St.tag===5&&hr(St.stateNode,Ct.value))return!0;break;case uu:if((St.tag===5||St.tag===6)&&(St=Xt(St),St!==null&&0<=St.indexOf(Ct.value)))return!0;break;case cu:if(St.tag===5&&(St=St.memoizedProps["data-testname"],typeof St=="string"&&St.toLowerCase()===Ct.value.toLowerCase()))return!0;break;default:throw Error(ot(365))}return!1}function Zu(St){switch(St.$$typeof){case ou:return"<"+(bt(St.value)||"Unknown")+">";case au:return":has("+(Zu(St)||"")+")";case lu:return'[role="'+St.value+'"]';case uu:return'"'+St.value+'"';case cu:return'[data-testname="'+St.value+'"]';default:throw Error(ot(365))}}function S0(St,Ct){var Rt=[];St=[St,0];for(var Lt=0;Lt<St.length;){var Nt=St[Lt++],Vt=St[Lt++],sr=Ct[Vt];if(Nt.tag!==5||!Qt(Nt)){for(;sr!=null&&Ku(Nt,sr);)Vt++,sr=Ct[Vt];if(Vt===Ct.length)Rt.push(Nt);else for(Nt=Nt.child;Nt!==null;)St.push(Nt,Vt),Nt=Nt.sibling}}return Rt}function _h(St,Ct){if(!Ur)throw Error(ot(363));St=qu(St),St=S0(St,Ct),Ct=[],St=Array.from(St);for(var Rt=0;Rt<St.length;){var Lt=St[Rt++];if(Lt.tag===5)Qt(Lt)||Ct.push(Lt.stateNode);else for(Lt=Lt.child;Lt!==null;)St.push(Lt),Lt=Lt.sibling}return Ct}var rm=Math.ceil,hu=lt.ReactCurrentDispatcher,_d=lt.ReactCurrentOwner,es=lt.ReactCurrentBatchConfig,Pn=0,ts=null,rs=null,cs=0,Os=0,Vo=en(0),ns=0,Ml=null,Ho=0,du=0,_f=0,Rl=null,xs=null,ep=0,tp=1/0;function jo(){tp=Yn()+500}var fu=!1,rp=null,uo=null,pu=!1,ho=null,mu=0,Pl=0,np=null,gu=-1,vu=0;function ys(){return Pn&6?Yn():gu!==-1?gu:gu=Yn()}function fo(St){return St.mode&1?Pn&2&&cs!==0?cs&-cs:_o.transition!==null?(vu===0&&(St=Js,Js<<=1,!(Js&4194240)&&(Js=64),vu=St),vu):(St=Ln,St!==0?St:Sr()):1}function Us(St,Ct,Rt){if(50<Pl)throw Pl=0,np=null,Error(ot(185));var Lt=Au(St,Ct);return Lt===null?null:(Hs(Lt,Ct,Rt),(!(Pn&2)||Lt!==ts)&&(Lt===ts&&(!(Pn&2)&&(du|=Ct),ns===4&&po(Lt,cs)),Ss(Lt,Rt),Ct===1&&Pn===0&&!(St.mode&1)&&(jo(),Qs&&bs())),Lt)}function Au(St,Ct){St.lanes|=Ct;var Rt=St.alternate;for(Rt!==null&&(Rt.lanes|=Ct),Rt=St,St=St.return;St!==null;)St.childLanes|=Ct,Rt=St.alternate,Rt!==null&&(Rt.childLanes|=Ct),Rt=St,St=St.return;return Rt.tag===3?Rt.stateNode:null}function Ss(St,Ct){var Rt=St.callbackNode;Qo(St,Ct);var Lt=vo(St,St===ts?cs:0);if(Lt===0)Rt!==null&&Oo(Rt),St.callbackNode=null,St.callbackPriority=0;else if(Ct=Lt&-Lt,St.callbackPriority!==Ct){if(Rt!=null&&Oo(Rt),Ct===1)St.tag===0?Ko(T0.bind(null,St)):qo(T0.bind(null,St)),Ir?Dr(function(){Pn===0&&bs()}):eo(Ao,bs),Rt=null;else{switch(Wo(Lt)){case 1:Rt=Ao;break;case 4:Rt=Ol;break;case 16:Rt=ps;break;case 536870912:Rt=Yo;break;default:Rt=ps}Rt=N0(Rt,C0.bind(null,St))}St.callbackPriority=Ct,St.callbackNode=Rt}}function C0(St,Ct){if(gu=-1,vu=0,Pn&6)throw Error(ot(327));var Rt=St.callbackNode;if(Po()&&St.callbackNode!==Rt)return null;var Lt=vo(St,St===ts?cs:0);if(Lt===0)return null;if(Lt&30||Lt&St.expiredLanes||Ct)Ct=yu(St,Lt);else{Ct=Lt;var Nt=Pn;Pn|=2;var Vt=R0();(ts!==St||cs!==Ct)&&(jo(),Mo(St,Ct));do try{sm();break}catch(Tr){M0(St,Tr)}while(1);No(),hu.current=Vt,Pn=Nt,rs!==null?Ct=0:(ts=null,cs=0,Ct=ns)}if(Ct!==0){if(Ct===2&&(Nt=Zs(St),Nt!==0&&(Lt=Nt,Ct=ip(St,Nt))),Ct===1)throw Rt=Ml,Mo(St,0),po(St,Lt),Ss(St,Yn()),Rt;if(Ct===6)po(St,Lt);else{if(Nt=St.current.alternate,!(Lt&30)&&!nm(Nt)&&(Ct=yu(St,Lt),Ct===2&&(Vt=Zs(St),Vt!==0&&(Lt=Vt,Ct=ip(St,Vt))),Ct===1))throw Rt=Ml,Mo(St,0),po(St,Lt),Ss(St,Yn()),Rt;switch(St.finishedWork=Nt,St.finishedLanes=Lt,Ct){case 0:case 1:throw Error(ot(345));case 2:Ro(St,xs);break;case 3:if(po(St,Lt),(Lt&130023424)===Lt&&(Ct=ep+500-Yn(),10<Ct)){if(vo(St,0)!==0)break;if(Nt=St.suspendedLanes,(Nt&Lt)!==Lt){ys(),St.pingedLanes|=St.suspendedLanes&Nt;break}St.timeoutHandle=rr(Ro.bind(null,St,xs),Ct);break}Ro(St,xs);break;case 4:if(po(St,Lt),(Lt&4194240)===Lt)break;for(Ct=St.eventTimes,Nt=-1;0<Lt;){var sr=31-jn(Lt);Vt=1<<sr,sr=Ct[sr],sr>Nt&&(Nt=sr),Lt&=~Vt}if(Lt=Nt,Lt=Yn()-Lt,Lt=(120>Lt?120:480>Lt?480:1080>Lt?1080:1920>Lt?1920:3e3>Lt?3e3:4320>Lt?4320:1960*rm(Lt/1960))-Lt,10<Lt){St.timeoutHandle=rr(Ro.bind(null,St,xs),Lt);break}Ro(St,xs);break;case 5:Ro(St,xs);break;default:throw Error(ot(329))}}}return Ss(St,Yn()),St.callbackNode===Rt?C0.bind(null,St):null}function ip(St,Ct){var Rt=Rl;return St.current.memoizedState.isDehydrated&&(Mo(St,Ct).flags|=256),St=yu(St,Ct),St!==2&&(Ct=xs,xs=Rt,Ct!==null&&sp(Ct)),St}function sp(St){xs===null?xs=St:xs.push.apply(xs,St)}function nm(St){for(var Ct=St;;){if(Ct.flags&16384){var Rt=Ct.updateQueue;if(Rt!==null&&(Rt=Rt.stores,Rt!==null))for(var Lt=0;Lt<Rt.length;Lt++){var Nt=Rt[Lt],Vt=Nt.getSnapshot;Nt=Nt.value;try{if(!Ms(Vt(),Nt))return!1}catch{return!1}}}if(Rt=Ct.child,Ct.subtreeFlags&16384&&Rt!==null)Rt.return=Ct,Ct=Rt;else{if(Ct===St)break;for(;Ct.sibling===null;){if(Ct.return===null||Ct.return===St)return!0;Ct=Ct.return}Ct.sibling.return=Ct.return,Ct=Ct.sibling}}return!0}function po(St,Ct){for(Ct&=~_f,Ct&=~du,St.suspendedLanes|=Ct,St.pingedLanes&=~Ct,St=St.expirationTimes;0<Ct;){var Rt=31-jn(Ct),Lt=1<<Rt;St[Rt]=-1,Ct&=~Lt}}function T0(St){if(Pn&6)throw Error(ot(327));Po();var Ct=vo(St,0);if(!(Ct&1))return Ss(St,Yn()),null;var Rt=yu(St,Ct);if(St.tag!==0&&Rt===2){var Lt=Zs(St);Lt!==0&&(Ct=Lt,Rt=ip(St,Lt))}if(Rt===1)throw Rt=Ml,Mo(St,0),po(St,Ct),Ss(St,Yn()),Rt;if(Rt===6)throw Error(ot(345));return St.finishedWork=St.current.alternate,St.finishedLanes=Ct,Ro(St,xs),Ss(St,Yn()),null}function w0(St){ho!==null&&ho.tag===0&&!(Pn&6)&&Po();var Ct=Pn;Pn|=1;var Rt=es.transition,Lt=Ln;try{if(es.transition=null,Ln=1,St)return St()}finally{Ln=Lt,es.transition=Rt,Pn=Ct,!(Pn&6)&&bs()}}function op(){Os=Vo.current,dn(Vo)}function Mo(St,Ct){St.finishedWork=null,St.finishedLanes=0;var Rt=St.timeoutHandle;if(Rt!==fr&&(St.timeoutHandle=fr,ur(Rt)),rs!==null)for(Rt=rs.return;Rt!==null;){var Lt=Rt;switch(Tu(Lt),Lt.tag){case 1:Lt=Lt.type.childContextTypes,Lt!=null&&zn();break;case 3:Go(),dn(vn),dn(Nn),Ou();break;case 5:Iu(Lt);break;case 4:Go();break;case 13:dn(Jn);break;case 19:dn(Jn);break;case 10:os(Lt.type._context);break;case 22:case 23:op()}Rt=Rt.return}if(ts=St,rs=St=mo(St.current,null),cs=Os=Ct,ns=0,Ml=null,_f=du=Ho=0,xs=Rl=null,Rs!==null){for(Ct=0;Ct<Rs.length;Ct++)if(Rt=Rs[Ct],Lt=Rt.interleaved,Lt!==null){Rt.interleaved=null;var Nt=Lt.next,Vt=Rt.pending;if(Vt!==null){var sr=Vt.next;Vt.next=Nt,Lt.next=sr}Rt.pending=Lt}Rs=null}return St}function M0(St,Ct){do{var Rt=rs;try{if(No(),Hl.current=Kl,Ql){for(var Lt=qn.memoizedState;Lt!==null;){var Nt=Lt.queue;Nt!==null&&(Nt.pending=null),Lt=Lt.next}Ql=!1}if(zo=0,as=us=qn=null,$a=!1,Al=0,_d.current=null,Rt===null||Rt.return===null){ns=1,Ml=Ct,rs=null;break}e:{var Vt=St,sr=Rt.return,Tr=Rt,zr=Ct;if(Ct=cs,Tr.flags|=32768,zr!==null&&typeof zr=="object"&&typeof zr.then=="function"){var Xr=zr,nn=Tr,xn=nn.tag;if(!(nn.mode&1)&&(xn===0||xn===11||xn===15)){var pn=nn.alternate;pn?(nn.updateQueue=pn.updateQueue,nn.memoizedState=pn.memoizedState,nn.lanes=pn.lanes):(nn.updateQueue=null,nn.memoizedState=null)}var Hn=Xp(sr);if(Hn!==null){Hn.flags&=-257,Yp(Hn,sr,Tr,Vt,Ct),Hn.mode&1&&Wp(Vt,Xr,Ct),Ct=Hn,zr=Xr;var un=Ct.updateQueue;if(un===null){var fs=new Set;fs.add(zr),Ct.updateQueue=fs}else un.add(zr);break e}else{if(!(Ct&1)){Wp(Vt,Xr,Ct),ap();break e}zr=Error(ot(426))}}else if(Wn&&Tr.mode&1){var Gs=Xp(sr);if(Gs!==null){!(Gs.flags&65536)&&(Gs.flags|=256),Yp(Gs,sr,Tr,Vt,Ct),Ru(zr);break e}}Vt=zr,ns!==4&&(ns=2),Rl===null?Rl=[Vt]:Rl.push(Vt),zr=$u(zr,Tr),Tr=sr;do{switch(Tr.tag){case 3:Tr.flags|=65536,Ct&=-Ct,Tr.lanes|=Ct;var Nr=jp(Tr,zr,Ct);fp(Tr,Nr);break e;case 1:Vt=zr;var Mr=Tr.type,Fr=Tr.stateNode;if(!(Tr.flags&128)&&(typeof Mr.getDerivedStateFromError=="function"||Fr!==null&&typeof Fr.componentDidCatch=="function"&&(uo===null||!uo.has(Fr)))){Tr.flags|=65536,Ct&=-Ct,Tr.lanes|=Ct;var rn=Qp(Tr,Vt,Ct);fp(Tr,rn);break e}}Tr=Tr.return}while(Tr!==null)}I0(Rt)}catch(cn){Ct=cn,rs===Rt&&Rt!==null&&(rs=Rt=Rt.return);continue}break}while(1)}function R0(){var St=hu.current;return hu.current=Kl,St===null?Kl:St}function ap(){(ns===0||ns===3||ns===2)&&(ns=4),ts===null||!(Ho&268435455)&&!(du&268435455)||po(ts,cs)}function yu(St,Ct){var Rt=Pn;Pn|=2;var Lt=R0();ts===St&&cs===Ct||Mo(St,Ct);do try{im();break}catch(Nt){M0(St,Nt)}while(1);if(No(),Pn=Rt,hu.current=Lt,rs!==null)throw Error(ot(261));return ts=null,cs=0,ns}function im(){for(;rs!==null;)P0(rs)}function sm(){for(;rs!==null&&!Xo();)P0(rs)}function P0(St){var Ct=B0(St.alternate,St,Os);St.memoizedProps=St.pendingProps,Ct===null?I0(St):rs=Ct,_d.current=null}function I0(St){var Ct=St;do{var Rt=Ct.alternate;if(St=Ct.return,Ct.flags&32768){if(Rt=q0(Rt,Ct),Rt!==null){Rt.flags&=32767,rs=Rt;return}if(St!==null)St.flags|=32768,St.subtreeFlags=0,St.deletions=null;else{ns=6,rs=null;return}}else if(Rt=X0(Rt,Ct,Os),Rt!==null){rs=Rt;return}if(Ct=Ct.sibling,Ct!==null){rs=Ct;return}rs=Ct=St}while(Ct!==null);ns===0&&(ns=5)}function Ro(St,Ct){var Rt=Ln,Lt=es.transition;try{es.transition=null,Ln=1,om(St,Ct,Rt)}finally{es.transition=Lt,Ln=Rt}return null}function om(St,Ct,Rt){do Po();while(ho!==null);if(Pn&6)throw Error(ot(327));var Lt=St.finishedWork,Nt=St.finishedLanes;if(Lt===null)return null;if(St.finishedWork=null,St.finishedLanes=0,Lt===St.current)throw Error(ot(177));St.callbackNode=null,St.callbackPriority=0;var Vt=Lt.lanes|Lt.childLanes;if(oo(St,Vt),St===ts&&(rs=ts=null,cs=0),!(Lt.subtreeFlags&2064)&&!(Lt.flags&2064)||pu||(pu=!0,N0(ps,function(){return Po(),null})),Vt=(Lt.flags&15990)!==0,Lt.subtreeFlags&15990||Vt){Vt=es.transition,es.transition=null;var sr=Ln;Ln=1;var Tr=Pn;Pn|=4,_d.current=null,Z0(St,Lt),em(St,Lt),zt(St.containerInfo),St.current=Lt,tm(Lt),Ll(),Pn=Tr,Ln=sr,es.transition=Vt}else St.current=Lt;if(pu&&(pu=!1,ho=St,mu=Nt),Vt=St.pendingLanes,Vt===0&&(uo=null),Jo(Lt.stateNode),Ss(St,Yn()),Ct!==null)for(Rt=St.onRecoverableError,Lt=0;Lt<Ct.length;Lt++)Rt(Ct[Lt]);if(fu)throw fu=!1,St=rp,rp=null,St;return mu&1&&St.tag!==0&&Po(),Vt=St.pendingLanes,Vt&1?St===np?Pl++:(Pl=0,np=St):Pl=0,bs(),null}function Po(){if(ho!==null){var St=Wo(mu),Ct=es.transition,Rt=Ln;try{if(es.transition=null,Ln=16>St?16:St,ho===null)var Lt=!1;else{if(St=ho,ho=null,mu=0,Pn&6)throw Error(ot(331));var Nt=Pn;for(Pn|=4,tn=St.current;tn!==null;){var Vt=tn,sr=Vt.child;if(tn.flags&16){var Tr=Vt.deletions;if(Tr!==null){for(var zr=0;zr<Tr.length;zr++){var Xr=Tr[zr];for(tn=Xr;tn!==null;){var nn=tn;switch(nn.tag){case 0:case 11:case 15:wo(8,nn,Vt)}var xn=nn.child;if(xn!==null)xn.return=nn,tn=xn;else for(;tn!==null;){nn=tn;var pn=nn.sibling,Hn=nn.return;if(m0(nn),nn===Xr){tn=null;break}if(pn!==null){pn.return=Hn,tn=pn;break}tn=Hn}}}var un=Vt.alternate;if(un!==null){var fs=un.child;if(fs!==null){un.child=null;do{var Gs=fs.sibling;fs.sibling=null,fs=Gs}while(fs!==null)}}tn=Vt}}if(Vt.subtreeFlags&2064&&sr!==null)sr.return=Vt,tn=sr;else e:for(;tn!==null;){if(Vt=tn,Vt.flags&2048)switch(Vt.tag){case 0:case 11:case 15:wo(9,Vt,Vt.return)}var Nr=Vt.sibling;if(Nr!==null){Nr.return=Vt.return,tn=Nr;break e}tn=Vt.return}}var Mr=St.current;for(tn=Mr;tn!==null;){sr=tn;var Fr=sr.child;if(sr.subtreeFlags&2064&&Fr!==null)Fr.return=sr,tn=Fr;else e:for(sr=Mr;tn!==null;){if(Tr=tn,Tr.flags&2048)try{switch(Tr.tag){case 0:case 11:case 15:Cl(9,Tr)}}catch(cn){Cs(Tr,Tr.return,cn)}if(Tr===sr){tn=null;break e}var rn=Tr.sibling;if(rn!==null){rn.return=Tr.return,tn=rn;break e}tn=Tr.return}}if(Pn=Nt,bs(),ws&&typeof ws.onPostCommitFiberRoot=="function")try{ws.onPostCommitFiberRoot(yo,St)}catch{}Lt=!0}return Lt}finally{Ln=Rt,es.transition=Ct}}return!1}function L0(St,Ct,Rt){Ct=$u(Rt,Ct),Ct=jp(St,Ct,1),co(St,Ct),Ct=ys(),St=Au(St,1),St!==null&&(Hs(St,1,Ct),Ss(St,Ct))}function Cs(St,Ct,Rt){if(St.tag===3)L0(St,St,Rt);else for(;Ct!==null;){if(Ct.tag===3){L0(Ct,St,Rt);break}else if(Ct.tag===1){var Lt=Ct.stateNode;if(typeof Ct.type.getDerivedStateFromError=="function"||typeof Lt.componentDidCatch=="function"&&(uo===null||!uo.has(Lt))){St=$u(Rt,St),St=Qp(Ct,St,1),co(Ct,St),St=ys(),Ct=Au(Ct,1),Ct!==null&&(Hs(Ct,1,St),Ss(Ct,St));break}}Ct=Ct.return}}function am(St,Ct,Rt){var Lt=St.pingCache;Lt!==null&&Lt.delete(Ct),Ct=ys(),St.pingedLanes|=St.suspendedLanes&Rt,ts===St&&(cs&Rt)===Rt&&(ns===4||ns===3&&(cs&130023424)===cs&&500>Yn()-ep?Mo(St,0):_f|=Rt),Ss(St,Ct)}function O0(St,Ct){Ct===0&&(St.mode&1?(Ct=qs,qs<<=1,!(qs&130023424)&&(qs=4194304)):Ct=1);var Rt=ys();St=Au(St,Ct),St!==null&&(Hs(St,Ct,Rt),Ss(St,Rt))}function lm(St){var Ct=St.memoizedState,Rt=0;Ct!==null&&(Rt=Ct.retryLane),O0(St,Rt)}function cm(St,Ct){var Rt=0;switch(St.tag){case 13:var Lt=St.stateNode,Nt=St.memoizedState;Nt!==null&&(Rt=Nt.retryLane);break;case 19:Lt=St.stateNode;break;default:throw Error(ot(314))}Lt!==null&&Lt.delete(Ct),O0(St,Rt)}var B0;B0=function(St,Ct,Rt){if(St!==null)if(St.memoizedProps!==Ct.pendingProps||vn.current)Ls=!0;else{if(!(St.lanes&Rt)&&!(Ct.flags&128))return Ls=!1,J0(St,Ct,Rt);Ls=!!(St.flags&131072)}else Ls=!1,Wn&&Ct.flags&1048576&&yp(Ct,Gl,Ct.index);switch(Ct.lanes=0,Ct.tag){case 2:var Lt=Ct.type;St!==null&&(St.alternate=null,Ct.alternate=null,Ct.flags|=2),St=Ct.pendingProps;var Nt=In(Ct,Nn.current);Zn(Ct,Rt),Nt=Nu(null,Ct,Lt,St,Nt,Rt);var Vt=ku();return Ct.flags|=1,typeof Nt=="object"&&Nt!==null&&typeof Nt.render=="function"&&Nt.$$typeof===void 0?(Ct.tag=1,Ct.memoizedState=null,Ct.updateQueue=null,Dn(Lt)?(Vt=!0,On(Ct)):Vt=!1,Ct.memoizedState=Nt.state!==null&&Nt.state!==void 0?Nt.state:null,bu(Ct),Nt.updater=Ul,Ct.stateNode=Nt,Nt._reactInternals=Ct,Su(Ct,Lt,St,Rt),Ct=Vu(null,Ct,Lt,!0,Vt,Rt)):(Ct.tag=0,Wn&&Vt&&Cu(Ct),As(null,Ct,Nt,Rt),Ct=Ct.child),Ct;case 16:Lt=Ct.elementType;e:{switch(St!==null&&(St.alternate=null,Ct.alternate=null,Ct.flags|=2),St=Ct.pendingProps,Nt=Lt._init,Lt=Nt(Lt._payload),Ct.type=Lt,Nt=Ct.tag=hm(Lt),St=gs(Lt,St),Nt){case 0:Ct=zu(null,Ct,Lt,St,Rt);break e;case 1:Ct=i0(null,Ct,Lt,St,Rt);break e;case 11:Ct=Kp(null,Ct,Lt,St,Rt);break e;case 14:Ct=Zp(null,Ct,Lt,gs(Lt.type,St),Rt);break e}throw Error(ot(306,Lt,""))}return Ct;case 0:return Lt=Ct.type,Nt=Ct.pendingProps,Nt=Ct.elementType===Lt?Nt:gs(Lt,Nt),zu(St,Ct,Lt,Nt,Rt);case 1:return Lt=Ct.type,Nt=Ct.pendingProps,Nt=Ct.elementType===Lt?Nt:gs(Lt,Nt),i0(St,Ct,Lt,Nt,Rt);case 3:e:{if(s0(Ct),St===null)throw Error(ot(387));Lt=Ct.pendingProps,Vt=Ct.memoizedState,Nt=Vt.element,dp(St,Ct),Fl(Ct,Lt,null,Rt);var sr=Ct.memoizedState;if(Lt=sr.element,xr&&Vt.isDehydrated)if(Vt={element:Lt,isDehydrated:!1,cache:sr.cache,transitions:sr.transitions},Ct.updateQueue.baseState=Vt,Ct.memoizedState=Vt,Ct.flags&256){Nt=Error(ot(423)),Ct=o0(St,Ct,Lt,Rt,Nt);break e}else if(Lt!==Nt){Nt=Error(ot(424)),Ct=o0(St,Ct,Lt,Rt,Nt);break e}else for(xr&&(Is=Gn(Ct.stateNode.containerInfo),Ps=Ct,Wn=!0,Vs=null,Zo=!1),Rt=Cp(Ct,null,Lt,Rt),Ct.child=Rt;Rt;)Rt.flags=Rt.flags&-3|4096,Rt=Rt.sibling;else{if(Fo(),Lt===Nt){Ct=so(St,Ct,Rt);break e}As(St,Ct,Lt,Rt)}Ct=Ct.child}return Ct;case 5:return Tp(Ct),St===null&&Mu(Ct),Lt=Ct.type,Nt=Ct.pendingProps,Vt=St!==null?St.memoizedProps:null,sr=Nt.children,or(Lt,Nt)?sr=null:Vt!==null&&or(Lt,Vt)&&(Ct.flags|=32),n0(St,Ct),As(St,Ct,sr,Rt),Ct.child;case 6:return St===null&&Mu(Ct),null;case 13:return a0(St,Ct,Rt);case 4:return Pu(Ct,Ct.stateNode.containerInfo),Lt=Ct.pendingProps,St===null?Ct.child=Uo(Ct,null,Lt,Rt):As(St,Ct,Lt,Rt),Ct.child;case 11:return Lt=Ct.type,Nt=Ct.pendingProps,Nt=Ct.elementType===Lt?Nt:gs(Lt,Nt),Kp(St,Ct,Lt,Nt,Rt);case 7:return As(St,Ct,Ct.pendingProps,Rt),Ct.child;case 8:return As(St,Ct,Ct.pendingProps.children,Rt),Ct.child;case 12:return As(St,Ct,Ct.pendingProps.children,Rt),Ct.child;case 10:e:{if(Lt=Ct.type._context,Nt=Ct.pendingProps,Vt=Ct.memoizedProps,sr=Nt.value,Nl(Ct,Lt,sr),Vt!==null)if(Ms(Vt.value,sr)){if(Vt.children===Nt.children&&!vn.current){Ct=so(St,Ct,Rt);break e}}else for(Vt=Ct.child,Vt!==null&&(Vt.return=Ct);Vt!==null;){var Tr=Vt.dependencies;if(Tr!==null){sr=Vt.child;for(var zr=Tr.firstContext;zr!==null;){if(zr.context===Lt){if(Vt.tag===1){zr=to(-1,Rt&-Rt),zr.tag=2;var Xr=Vt.updateQueue;if(Xr!==null){Xr=Xr.shared;var nn=Xr.pending;nn===null?zr.next=zr:(zr.next=nn.next,nn.next=zr),Xr.pending=zr}}Vt.lanes|=Rt,zr=Vt.alternate,zr!==null&&(zr.lanes|=Rt),vs(Vt.return,Rt,Ct),Tr.lanes|=Rt;break}zr=zr.next}}else if(Vt.tag===10)sr=Vt.type===Ct.type?null:Vt.child;else if(Vt.tag===18){if(sr=Vt.return,sr===null)throw Error(ot(341));sr.lanes|=Rt,Tr=sr.alternate,Tr!==null&&(Tr.lanes|=Rt),vs(sr,Rt,Ct),sr=Vt.sibling}else sr=Vt.child;if(sr!==null)sr.return=Vt;else for(sr=Vt;sr!==null;){if(sr===Ct){sr=null;break}if(Vt=sr.sibling,Vt!==null){Vt.return=sr.return,sr=Vt;break}sr=sr.return}Vt=sr}As(St,Ct,Nt.children,Rt),Ct=Ct.child}return Ct;case 9:return Nt=Ct.type,Lt=Ct.pendingProps.children,Zn(Ct,Rt),Nt=_i(Nt),Lt=Lt(Nt),Ct.flags|=1,As(St,Ct,Lt,Rt),Ct.child;case 14:return Lt=Ct.type,Nt=gs(Lt,Ct.pendingProps),Nt=gs(Lt.type,Nt),Zp(St,Ct,Lt,Nt,Rt);case 15:return e0(St,Ct,Ct.type,Ct.pendingProps,Rt);case 17:return Lt=Ct.type,Nt=Ct.pendingProps,Nt=Ct.elementType===Lt?Nt:gs(Lt,Nt),St!==null&&(St.alternate=null,Ct.alternate=null,Ct.flags|=2),Ct.tag=1,Dn(Lt)?(St=!0,On(Ct)):St=!1,Zn(Ct,Rt),vp(Ct,Lt,Nt),Su(Ct,Lt,Nt,Rt),Vu(null,Ct,Lt,!0,St,Rt);case 19:return h0(St,Ct,Rt);case 22:return r0(St,Ct,Rt)}throw Error(ot(156,Ct.tag))};function N0(St,Ct){return eo(St,Ct)}function um(St,Ct,Rt,Lt){this.tag=St,this.key=Rt,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=Ct,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Lt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $s(St,Ct,Rt,Lt){return new um(St,Ct,Rt,Lt)}function lp(St){return St=St.prototype,!(!St||!St.isReactComponent)}function hm(St){if(typeof St=="function")return lp(St)?1:0;if(St!=null){if(St=St.$$typeof,St===mt)return 11;if(St===At)return 14}return 2}function mo(St,Ct){var Rt=St.alternate;return Rt===null?(Rt=$s(St.tag,Ct,St.key,St.mode),Rt.elementType=St.elementType,Rt.type=St.type,Rt.stateNode=St.stateNode,Rt.alternate=St,St.alternate=Rt):(Rt.pendingProps=Ct,Rt.type=St.type,Rt.flags=0,Rt.subtreeFlags=0,Rt.deletions=null),Rt.flags=St.flags&14680064,Rt.childLanes=St.childLanes,Rt.lanes=St.lanes,Rt.child=St.child,Rt.memoizedProps=St.memoizedProps,Rt.memoizedState=St.memoizedState,Rt.updateQueue=St.updateQueue,Ct=St.dependencies,Rt.dependencies=Ct===null?null:{lanes:Ct.lanes,firstContext:Ct.firstContext},Rt.sibling=St.sibling,Rt.index=St.index,Rt.ref=St.ref,Rt}function _u(St,Ct,Rt,Lt,Nt,Vt){var sr=2;if(Lt=St,typeof St=="function")lp(St)&&(sr=1);else if(typeof St=="string")sr=5;else e:switch(St){case ut:return Io(Rt.children,Nt,Vt,Ct);case ht:sr=8,Nt|=8;break;case dt:return St=$s(12,Rt,Ct,Nt|2),St.elementType=dt,St.lanes=Vt,St;case gt:return St=$s(13,Rt,Ct,Nt),St.elementType=gt,St.lanes=Vt,St;case vt:return St=$s(19,Rt,Ct,Nt),St.elementType=vt,St.lanes=Vt,St;case xt:return Eu(Rt,Nt,Vt,Ct);default:if(typeof St=="object"&&St!==null)switch(St.$$typeof){case ft:sr=10;break e;case pt:sr=9;break e;case mt:sr=11;break e;case At:sr=14;break e;case yt:sr=16,Lt=null;break e}throw Error(ot(130,St==null?St:typeof St,""))}return Ct=$s(sr,Rt,Ct,Nt),Ct.elementType=St,Ct.type=Lt,Ct.lanes=Vt,Ct}function Io(St,Ct,Rt,Lt){return St=$s(7,St,Lt,Ct),St.lanes=Rt,St}function Eu(St,Ct,Rt,Lt){return St=$s(22,St,Lt,Ct),St.elementType=xt,St.lanes=Rt,St.stateNode={},St}function cp(St,Ct,Rt){return St=$s(6,St,null,Ct),St.lanes=Rt,St}function up(St,Ct,Rt){return Ct=$s(4,St.children!==null?St.children:[],St.key,Ct),Ct.lanes=Rt,Ct.stateNode={containerInfo:St.containerInfo,pendingChildren:null,implementation:St.implementation},Ct}function dm(St,Ct,Rt,Lt,Nt){this.tag=Ct,this.containerInfo=St,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=fr,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lo(0),this.expirationTimes=Lo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lo(0),this.identifierPrefix=Lt,this.onRecoverableError=Nt,xr&&(this.mutableSourceEagerHydrationData=null)}function k0(St,Ct,Rt,Lt,Nt,Vt,sr,Tr,zr){return St=new dm(St,Ct,Rt,Tr,zr),Ct===1?(Ct=1,Vt===!0&&(Ct|=8)):Ct=0,Vt=$s(3,null,null,Ct),St.current=Vt,Vt.stateNode=St,Vt.memoizedState={element:Lt,isDehydrated:Rt,cache:null,transitions:null},bu(Vt),St}function D0(St){if(!St)return An;St=St._reactInternals;e:{if(Tt(St)!==St||St.tag!==1)throw Error(ot(170));var Ct=St;do{switch(Ct.tag){case 3:Ct=Ct.stateNode.context;break e;case 1:if(Dn(Ct.type)){Ct=Ct.stateNode.__reactInternalMemoizedMergedChildContext;break e}}Ct=Ct.return}while(Ct!==null);throw Error(ot(171))}if(St.tag===1){var Rt=St.type;if(Dn(Rt))return Vn(St,Rt,Ct)}return Ct}function F0(St){var Ct=St._reactInternals;if(Ct===void 0)throw typeof St.render=="function"?Error(ot(188)):(St=Object.keys(St).join(","),Error(ot(268,St)));return St=It(Ct),St===null?null:St.stateNode}function U0(St,Ct){if(St=St.memoizedState,St!==null&&St.dehydrated!==null){var Rt=St.retryLane;St.retryLane=Rt!==0&&Rt<Ct?Rt:Ct}}function hp(St,Ct){U0(St,Ct),(St=St.alternate)&&U0(St,Ct)}function fm(St){return St=It(St),St===null?null:St.stateNode}function pm(){return null}return rt.attemptContinuousHydration=function(St){if(St.tag===13){var Ct=ys();Us(St,134217728,Ct),hp(St,134217728)}},rt.attemptHydrationAtCurrentPriority=function(St){if(St.tag===13){var Ct=ys(),Rt=fo(St);Us(St,Rt,Ct),hp(St,Rt)}},rt.attemptSynchronousHydration=function(St){switch(St.tag){case 3:var Ct=St.stateNode;if(Ct.current.memoizedState.isDehydrated){var Rt=Ks(Ct.pendingLanes);Rt!==0&&(js(Ct,Rt|1),Ss(Ct,Yn()),!(Pn&6)&&(jo(),bs()))}break;case 13:var Lt=ys();w0(function(){return Us(St,1,Lt)}),hp(St,1)}},rt.batchedUpdates=function(St,Ct){var Rt=Pn;Pn|=1;try{return St(Ct)}finally{Pn=Rt,Pn===0&&(jo(),Qs&&bs())}},rt.createComponentSelector=function(St){return{$$typeof:ou,value:St}},rt.createContainer=function(St,Ct,Rt,Lt,Nt,Vt,sr){return k0(St,Ct,!1,null,Rt,Lt,Nt,Vt,sr)},rt.createHasPseudoClassSelector=function(St){return{$$typeof:au,value:St}},rt.createHydrationContainer=function(St,Ct,Rt,Lt,Nt,Vt,sr,Tr,zr){return St=k0(Rt,Lt,!0,St,Nt,Vt,sr,Tr,zr),St.context=D0(null),Rt=St.current,Lt=ys(),Nt=fo(Rt),Vt=to(Lt,Nt),Vt.callback=Ct??null,co(Rt,Vt),St.current.lanes=Nt,Hs(St,Nt,Lt),Ss(St,Lt),St},rt.createPortal=function(St,Ct,Rt){var Lt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ct,key:Lt==null?null:""+Lt,children:St,containerInfo:Ct,implementation:Rt}},rt.createRoleSelector=function(St){return{$$typeof:lu,value:St}},rt.createTestNameSelector=function(St){return{$$typeof:cu,value:St}},rt.createTextSelector=function(St){return{$$typeof:uu,value:St}},rt.deferredUpdates=function(St){var Ct=Ln,Rt=es.transition;try{return es.transition=null,Ln=16,St()}finally{Ln=Ct,es.transition=Rt}},rt.discreteUpdates=function(St,Ct,Rt,Lt,Nt){var Vt=Ln,sr=es.transition;try{return es.transition=null,Ln=1,St(Ct,Rt,Lt,Nt)}finally{Ln=Vt,es.transition=sr,Pn===0&&jo()}},rt.findAllNodes=_h,rt.findBoundingRects=function(St,Ct){if(!Ur)throw Error(ot(363));Ct=_h(St,Ct),St=[];for(var Rt=0;Rt<Ct.length;Rt++)St.push(Wr(Ct[Rt]));for(Ct=St.length-1;0<Ct;Ct--){Rt=St[Ct];for(var Lt=Rt.x,Nt=Lt+Rt.width,Vt=Rt.y,sr=Vt+Rt.height,Tr=Ct-1;0<=Tr;Tr--)if(Ct!==Tr){var zr=St[Tr],Xr=zr.x,nn=Xr+zr.width,xn=zr.y,pn=xn+zr.height;if(Lt>=Xr&&Vt>=xn&&Nt<=nn&&sr<=pn){St.splice(Ct,1);break}else if(Lt!==Xr||Rt.width!==zr.width||pn<Vt||xn>sr){if(!(Vt!==xn||Rt.height!==zr.height||nn<Lt||Xr>Nt)){Xr>Lt&&(zr.width+=Xr-Lt,zr.x=Lt),nn<Nt&&(zr.width=Nt-Xr),St.splice(Ct,1);break}}else{xn>Vt&&(zr.height+=xn-Vt,zr.y=Vt),pn<sr&&(zr.height=sr-xn),St.splice(Ct,1);break}}}return St},rt.findHostInstance=F0,rt.findHostInstanceWithNoPortals=function(St){return St=Pt(St),St=St!==null?Bt(St):null,St===null?null:St.stateNode},rt.findHostInstanceWithWarning=function(St){return F0(St)},rt.flushControlled=function(St){var Ct=Pn;Pn|=1;var Rt=es.transition,Lt=Ln;try{es.transition=null,Ln=1,St()}finally{Ln=Lt,es.transition=Rt,Pn=Ct,Pn===0&&(jo(),bs())}},rt.flushPassiveEffects=Po,rt.flushSync=w0,rt.focusWithin=function(St,Ct){if(!Ur)throw Error(ot(363));for(St=qu(St),Ct=S0(St,Ct),Ct=Array.from(Ct),St=0;St<Ct.length;){var Rt=Ct[St++];if(!Qt(Rt)){if(Rt.tag===5&&kr(Rt.stateNode))return!0;for(Rt=Rt.child;Rt!==null;)Ct.push(Rt),Rt=Rt.sibling}}return!1},rt.getCurrentUpdatePriority=function(){return Ln},rt.getFindAllNodesFailureDescription=function(St,Ct){if(!Ur)throw Error(ot(363));var Rt=0,Lt=[];St=[qu(St),0];for(var Nt=0;Nt<St.length;){var Vt=St[Nt++],sr=St[Nt++],Tr=Ct[sr];if((Vt.tag!==5||!Qt(Vt))&&(Ku(Vt,Tr)&&(Lt.push(Zu(Tr)),sr++,sr>Rt&&(Rt=sr)),sr<Ct.length))for(Vt=Vt.child;Vt!==null;)St.push(Vt,sr),Vt=Vt.sibling}if(Rt<Ct.length){for(St=[];Rt<Ct.length;Rt++)St.push(Zu(Ct[Rt]));return`findAllNodes was able to match part of the selector:
  `+(Lt.join(" > ")+`

No matching component was found for:
  `)+St.join(" > ")}return null},rt.getPublicRootInstance=function(St){if(St=St.current,!St.child)return null;switch(St.child.tag){case 5:return Ft(St.child.stateNode);default:return St.child.stateNode}},rt.injectIntoDevTools=function(St){if(St={bundleType:St.bundleType,version:St.version,rendererPackageName:St.rendererPackageName,rendererConfig:St.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lt.ReactCurrentDispatcher,findHostInstanceByFiber:fm,findFiberByHostInstance:St.findFiberByHostInstance||pm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")St=!1;else{var Ct=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(Ct.isDisabled||!Ct.supportsFiber)St=!0;else{try{yo=Ct.inject(St),ws=Ct}catch{}St=!!Ct.checkDCE}}return St},rt.isAlreadyRendering=function(){return!1},rt.observeVisibleRects=function(St,Ct,Rt,Lt){if(!Ur)throw Error(ot(363));St=_h(St,Ct);var Nt=yr(St,Rt,Lt).disconnect;return{disconnect:function(){Nt()}}},rt.registerMutableSourceForHydration=function(St,Ct){var Rt=Ct._getVersion;Rt=Rt(Ct._source),St.mutableSourceEagerHydrationData==null?St.mutableSourceEagerHydrationData=[Ct,Rt]:St.mutableSourceEagerHydrationData.push(Ct,Rt)},rt.runWithPriority=function(St,Ct){var Rt=Ln;try{return Ln=St,Ct()}finally{Ln=Rt}},rt.shouldError=function(){return null},rt.shouldSuspend=function(){return!1},rt.updateContainer=function(St,Ct,Rt,Lt){var Nt=Ct.current,Vt=ys(),sr=fo(Nt);return Rt=D0(Rt),Ct.context===null?Ct.context=Rt:Ct.pendingContext=Rt,Ct=to(Vt,sr),Ct.payload={element:St},Lt=Lt===void 0?null:Lt,Lt!==null&&(Ct.callback=Lt),co(Nt,Ct),St=Us(Nt,sr,Vt),St!==null&&Dl(St,Nt,sr),sr},rt};reactReconciler.exports=reactReconciler_production_min;var reactReconcilerExports=reactReconciler.exports;const Reconciler=getDefaultExportFromCjs(reactReconcilerExports);var scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(tt){function _e(Dt,Gt){var zt=Dt.length;Dt.push(Gt);e:for(;0<zt;){var $t=zt-1>>>1,Ht=Dt[$t];if(0<it(Ht,Gt))Dt[$t]=Gt,Dt[zt]=Ht,zt=$t;else break e}}function rt(Dt){return Dt.length===0?null:Dt[0]}function nt(Dt){if(Dt.length===0)return null;var Gt=Dt[0],zt=Dt.pop();if(zt!==Gt){Dt[0]=zt;e:for(var $t=0,Ht=Dt.length,er=Ht>>>1;$t<er;){var Zt=2*($t+1)-1,or=Dt[Zt],Kt=Zt+1,rr=Dt[Kt];if(0>it(or,zt))Kt<Ht&&0>it(rr,or)?(Dt[$t]=rr,Dt[Kt]=zt,$t=Kt):(Dt[$t]=or,Dt[Zt]=zt,$t=Zt);else if(Kt<Ht&&0>it(rr,zt))Dt[$t]=rr,Dt[Kt]=zt,$t=Kt;else break e}}return Gt}function it(Dt,Gt){var zt=Dt.sortIndex-Gt.sortIndex;return zt!==0?zt:Dt.id-Gt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;tt.unstable_now=function(){return st.now()}}else{var ot=Date,lt=ot.now();tt.unstable_now=function(){return ot.now()-lt}}var at=[],ct=[],ut=1,ht=null,dt=3,ft=!1,pt=!1,mt=!1,gt=typeof setTimeout=="function"?setTimeout:null,vt=typeof clearTimeout=="function"?clearTimeout:null,At=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function yt(Dt){for(var Gt=rt(ct);Gt!==null;){if(Gt.callback===null)nt(ct);else if(Gt.startTime<=Dt)nt(ct),Gt.sortIndex=Gt.expirationTime,_e(at,Gt);else break;Gt=rt(ct)}}function xt(Dt){if(mt=!1,yt(Dt),!pt)if(rt(at)!==null)pt=!0,Ft(_t);else{var Gt=rt(ct);Gt!==null&&jt(xt,Gt.startTime-Dt)}}function _t(Dt,Gt){pt=!1,mt&&(mt=!1,vt(wt),wt=-1),ft=!0;var zt=dt;try{for(yt(Gt),ht=rt(at);ht!==null&&(!(ht.expirationTime>Gt)||Dt&&!Pt());){var $t=ht.callback;if(typeof $t=="function"){ht.callback=null,dt=ht.priorityLevel;var Ht=$t(ht.expirationTime<=Gt);Gt=tt.unstable_now(),typeof Ht=="function"?ht.callback=Ht:ht===rt(at)&&nt(at),yt(Gt)}else nt(at);ht=rt(at)}if(ht!==null)var er=!0;else{var Zt=rt(ct);Zt!==null&&jt(xt,Zt.startTime-Gt),er=!1}return er}finally{ht=null,dt=zt,ft=!1}}var Et=!1,bt=null,wt=-1,Tt=5,Mt=-1;function Pt(){return!(tt.unstable_now()-Mt<Tt)}function It(){if(bt!==null){var Dt=tt.unstable_now();Mt=Dt;var Gt=!0;try{Gt=bt(!0,Dt)}finally{Gt?Ot():(Et=!1,bt=null)}}else Et=!1}var Ot;if(typeof At=="function")Ot=function(){At(It)};else if(typeof MessageChannel<"u"){var Bt=new MessageChannel,Ut=Bt.port2;Bt.port1.onmessage=It,Ot=function(){Ut.postMessage(null)}}else Ot=function(){gt(It,0)};function Ft(Dt){bt=Dt,Et||(Et=!0,Ot())}function jt(Dt,Gt){wt=gt(function(){Dt(tt.unstable_now())},Gt)}tt.unstable_IdlePriority=5,tt.unstable_ImmediatePriority=1,tt.unstable_LowPriority=4,tt.unstable_NormalPriority=3,tt.unstable_Profiling=null,tt.unstable_UserBlockingPriority=2,tt.unstable_cancelCallback=function(Dt){Dt.callback=null},tt.unstable_continueExecution=function(){pt||ft||(pt=!0,Ft(_t))},tt.unstable_forceFrameRate=function(Dt){0>Dt||125<Dt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Tt=0<Dt?Math.floor(1e3/Dt):5},tt.unstable_getCurrentPriorityLevel=function(){return dt},tt.unstable_getFirstCallbackNode=function(){return rt(at)},tt.unstable_next=function(Dt){switch(dt){case 1:case 2:case 3:var Gt=3;break;default:Gt=dt}var zt=dt;dt=Gt;try{return Dt()}finally{dt=zt}},tt.unstable_pauseExecution=function(){},tt.unstable_requestPaint=function(){},tt.unstable_runWithPriority=function(Dt,Gt){switch(Dt){case 1:case 2:case 3:case 4:case 5:break;default:Dt=3}var zt=dt;dt=Dt;try{return Gt()}finally{dt=zt}},tt.unstable_scheduleCallback=function(Dt,Gt,zt){var $t=tt.unstable_now();switch(typeof zt=="object"&&zt!==null?(zt=zt.delay,zt=typeof zt=="number"&&0<zt?$t+zt:$t):zt=$t,Dt){case 1:var Ht=-1;break;case 2:Ht=250;break;case 5:Ht=1073741823;break;case 4:Ht=1e4;break;default:Ht=5e3}return Ht=zt+Ht,Dt={id:ut++,callback:Gt,priorityLevel:Dt,startTime:zt,expirationTime:Ht,sortIndex:-1},zt>$t?(Dt.sortIndex=zt,_e(ct,Dt),rt(at)===null&&Dt===rt(ct)&&(mt?(vt(wt),wt=-1):mt=!0,jt(xt,zt-$t))):(Dt.sortIndex=Ht,_e(at,Dt),pt||ft||(pt=!0,Ft(_t))),Dt},tt.unstable_shouldYield=Pt,tt.unstable_wrapCallback=function(Dt){var Gt=dt;return function(){var zt=dt;dt=Gt;try{return Dt.apply(this,arguments)}finally{dt=zt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;const isPromise=tt=>typeof tt=="object"&&typeof tt.then=="function",globalCache=[];function shallowEqualArrays(tt,_e,rt=(nt,it)=>nt===it){if(tt===_e)return!0;if(!tt||!_e)return!1;const nt=tt.length;if(_e.length!==nt)return!1;for(let it=0;it<nt;it++)if(!rt(tt[it],_e[it]))return!1;return!0}function query(tt,_e=null,rt=!1,nt={}){_e===null&&(_e=[tt]);for(const st of globalCache)if(shallowEqualArrays(_e,st.keys,st.equal)){if(rt)return;if(Object.prototype.hasOwnProperty.call(st,"error"))throw st.error;if(Object.prototype.hasOwnProperty.call(st,"response"))return nt.lifespan&&nt.lifespan>0&&(st.timeout&&clearTimeout(st.timeout),st.timeout=setTimeout(st.remove,nt.lifespan)),st.response;if(!rt)throw st.promise}const it={keys:_e,equal:nt.equal,remove:()=>{const st=globalCache.indexOf(it);st!==-1&&globalCache.splice(st,1)},promise:(isPromise(tt)?tt:tt(..._e)).then(st=>{it.response=st,nt.lifespan&&nt.lifespan>0&&(it.timeout=setTimeout(it.remove,nt.lifespan))}).catch(st=>it.error=st)};if(globalCache.push(it),!rt)throw it.promise}const suspend=(tt,_e,rt)=>query(tt,_e,!1,rt),preload=(tt,_e,rt)=>void query(tt,_e,!0,rt),clear=tt=>{if(tt===void 0||tt.length===0)globalCache.splice(0,globalCache.length);else{const _e=globalCache.find(rt=>shallowEqualArrays(tt,rt.keys,rt.equal));_e&&_e.remove()}},catalogue={},extend$2=tt=>void Object.assign(catalogue,tt);function createRenderer(tt,_e){function rt(ut,{args:ht=[],attach:dt,...ft},pt){let mt=`${ut[0].toUpperCase()}${ut.slice(1)}`,gt;if(ut==="primitive"){if(ft.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const vt=ft.object;gt=prepare(vt,{type:ut,root:pt,attach:dt,primitive:!0})}else{const vt=catalogue[mt];if(!vt)throw new Error(`R3F: ${mt} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(ht))throw new Error("R3F: The args prop must be an array!");gt=prepare(new vt(...ht),{type:ut,root:pt,attach:dt,memoizedProps:{args:ht}})}return gt.__r3f.attach===void 0&&(gt instanceof BufferGeometry?gt.__r3f.attach="geometry":gt instanceof Material&&(gt.__r3f.attach="material")),mt!=="inject"&&applyProps$1(gt,ft),gt}function nt(ut,ht){let dt=!1;if(ht){var ft,pt;(ft=ht.__r3f)!=null&&ft.attach?attach(ut,ht,ht.__r3f.attach):ht.isObject3D&&ut.isObject3D&&(ut.add(ht),dt=!0),dt||(pt=ut.__r3f)==null||pt.objects.push(ht),ht.__r3f||prepare(ht,{}),ht.__r3f.parent=ut,updateInstance(ht),invalidateInstance(ht)}}function it(ut,ht,dt){let ft=!1;if(ht){var pt,mt;if((pt=ht.__r3f)!=null&&pt.attach)attach(ut,ht,ht.__r3f.attach);else if(ht.isObject3D&&ut.isObject3D){ht.parent=ut,ht.dispatchEvent({type:"added"});const gt=ut.children.filter(At=>At!==ht),vt=gt.indexOf(dt);ut.children=[...gt.slice(0,vt),ht,...gt.slice(vt)],ft=!0}ft||(mt=ut.__r3f)==null||mt.objects.push(ht),ht.__r3f||prepare(ht,{}),ht.__r3f.parent=ut,updateInstance(ht),invalidateInstance(ht)}}function st(ut,ht,dt=!1){ut&&[...ut].forEach(ft=>ot(ht,ft,dt))}function ot(ut,ht,dt){if(ht){var ft,pt,mt;if(ht.__r3f&&(ht.__r3f.parent=null),(ft=ut.__r3f)!=null&&ft.objects&&(ut.__r3f.objects=ut.__r3f.objects.filter(xt=>xt!==ht)),(pt=ht.__r3f)!=null&&pt.attach)detach(ut,ht,ht.__r3f.attach);else if(ht.isObject3D&&ut.isObject3D){var gt;ut.remove(ht),(gt=ht.__r3f)!=null&&gt.root&&removeInteractivity(ht.__r3f.root,ht)}const At=(mt=ht.__r3f)==null?void 0:mt.primitive,yt=dt===void 0?ht.dispose!==null&&!At:dt;if(!At){var vt;st((vt=ht.__r3f)==null?void 0:vt.objects,ht,yt),st(ht.children,ht,yt)}delete ht.__r3f,yt&&ht.dispose&&ht.type!=="Scene"&&schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,()=>{try{ht.dispose()}catch{}}),invalidateInstance(ut)}}function lt(ut,ht,dt,ft){var pt;const mt=(pt=ut.__r3f)==null?void 0:pt.parent;if(!mt)return;const gt=rt(ht,dt,ut.__r3f.root);if(ut.children){for(const vt of ut.children)vt.__r3f&&nt(gt,vt);ut.children=ut.children.filter(vt=>!vt.__r3f)}ut.__r3f.objects.forEach(vt=>nt(gt,vt)),ut.__r3f.objects=[],ut.__r3f.autoRemovedBeforeAppend||ot(mt,ut),gt.parent&&(gt.__r3f.autoRemovedBeforeAppend=!0),nt(mt,gt),gt.raycast&&gt.__r3f.eventCount&&gt.__r3f.root.getState().internal.interaction.push(gt),[ft,ft.alternate].forEach(vt=>{vt!==null&&(vt.stateNode=gt,vt.ref&&(typeof vt.ref=="function"?vt.ref(gt):vt.ref.current=gt))})}const at=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Reconciler({createInstance:rt,removeChild:ot,appendChild:nt,appendInitialChild:nt,insertBefore:it,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(ut,ht)=>{if(!ht)return;const dt=ut.getState().scene;dt.__r3f&&(dt.__r3f.root=ut,nt(dt,ht))},removeChildFromContainer:(ut,ht)=>{ht&&ot(ut.getState().scene,ht)},insertInContainerBefore:(ut,ht,dt)=>{if(!ht||!dt)return;const ft=ut.getState().scene;ft.__r3f&&it(ft,ht,dt)},getRootHostContext:()=>null,getChildHostContext:ut=>ut,finalizeInitialChildren(ut){var ht;return!!((ht=ut==null?void 0:ut.__r3f)!=null?ht:{}).handlers},prepareUpdate(ut,ht,dt,ft){var pt;if(((pt=ut==null?void 0:ut.__r3f)!=null?pt:{}).primitive&&ft.object&&ft.object!==ut)return[!0];{const{args:gt=[],children:vt,...At}=ft,{args:yt=[],children:xt,..._t}=dt;if(!Array.isArray(gt))throw new Error("R3F: the args prop must be an array!");if(gt.some((bt,wt)=>bt!==yt[wt]))return[!0];const Et=diffProps(ut,At,_t,!0);return Et.changes.length?[!1,Et]:null}},commitUpdate(ut,[ht,dt],ft,pt,mt,gt){ht?lt(ut,ft,mt,gt):applyProps$1(ut,dt)},commitMount(ut,ht,dt,ft){var pt;const mt=(pt=ut.__r3f)!=null?pt:{};ut.raycast&&mt.handlers&&mt.eventCount&&ut.__r3f.root.getState().internal.interaction.push(ut)},getPublicInstance:ut=>ut,prepareForCommit:()=>null,preparePortalMount:ut=>prepare(ut.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(ut){var ht;const{attach:dt,parent:ft}=(ht=ut.__r3f)!=null?ht:{};dt&&ft&&detach(ft,ut,dt),ut.isObject3D&&(ut.visible=!1),invalidateInstance(ut)},unhideInstance(ut,ht){var dt;const{attach:ft,parent:pt}=(dt=ut.__r3f)!=null?dt:{};ft&&pt&&attach(pt,ut,ft),(ut.isObject3D&&ht.visible==null||ht.visible)&&(ut.visible=!0),invalidateInstance(ut)},createTextInstance:at,hideTextInstance:at,unhideTextInstance:at,getCurrentEventPriority:()=>_e?_e():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is.fun(performance.now)?performance.now:is.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document,_window$navigator;const hasColorSpace$1=tt=>"colorSpace"in tt||"outputColorSpace"in tt,getColorManagement=()=>{var tt;return(tt=catalogue.ColorManagement)!=null?tt:null},isOrthographicCamera=tt=>tt&&tt.isOrthographicCamera,isRef$1=tt=>tt&&tt.hasOwnProperty("current"),useIsomorphicLayoutEffect$1=typeof window<"u"&&((_window$document=window.document)!=null&&_window$document.createElement||((_window$navigator=window.navigator)==null?void 0:_window$navigator.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(tt){const _e=reactExports.useRef(tt);return useIsomorphicLayoutEffect$1(()=>void(_e.current=tt),[tt]),_e}function Block({set:tt}){return useIsomorphicLayoutEffect$1(()=>(tt(new Promise(()=>null)),()=>tt(!1)),[tt]),null}class ErrorBoundary extends reactExports.Component{constructor(..._e){super(..._e),this.state={error:!1}}componentDidCatch(_e){this.props.set(_e)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=tt=>tt&&!!tt.memoized&&!!tt.changes;function calculateDpr(tt){var _e;const rt=typeof window<"u"?(_e=window.devicePixelRatio)!=null?_e:2:1;return Array.isArray(tt)?Math.min(Math.max(tt[0],rt),tt[1]):tt}const getRootState=tt=>{var _e;return(_e=tt.__r3f)==null?void 0:_e.root.getState()},is={obj:tt=>tt===Object(tt)&&!is.arr(tt)&&typeof tt!="function",fun:tt=>typeof tt=="function",str:tt=>typeof tt=="string",num:tt=>typeof tt=="number",boo:tt=>typeof tt=="boolean",und:tt=>tt===void 0,arr:tt=>Array.isArray(tt),equ(tt,_e,{arrays:rt="shallow",objects:nt="reference",strict:it=!0}={}){if(typeof tt!=typeof _e||!!tt!=!!_e)return!1;if(is.str(tt)||is.num(tt))return tt===_e;const st=is.obj(tt);if(st&&nt==="reference")return tt===_e;const ot=is.arr(tt);if(ot&&rt==="reference")return tt===_e;if((ot||st)&&tt===_e)return!0;let lt;for(lt in tt)if(!(lt in _e))return!1;if(st&&rt==="shallow"&&nt==="shallow"){for(lt in it?_e:tt)if(!is.equ(tt[lt],_e[lt],{strict:it,objects:"reference"}))return!1}else for(lt in it?_e:tt)if(tt[lt]!==_e[lt])return!1;if(is.und(lt)){if(ot&&tt.length===0&&_e.length===0||st&&Object.keys(tt).length===0&&Object.keys(_e).length===0)return!0;if(tt!==_e)return!1}return!0}};function buildGraph(tt){const _e={nodes:{},materials:{}};return tt&&tt.traverse(rt=>{rt.name&&(_e.nodes[rt.name]=rt),rt.material&&!_e.materials[rt.material.name]&&(_e.materials[rt.material.name]=rt.material)}),_e}function dispose(tt){tt.dispose&&tt.type!=="Scene"&&tt.dispose();for(const _e in tt)_e.dispose==null||_e.dispose(),delete tt[_e]}function prepare(tt,_e){const rt=tt;return rt.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,..._e},tt}function resolve(tt,_e){let rt=tt;if(_e.includes("-")){const nt=_e.split("-"),it=nt.pop();return rt=nt.reduce((st,ot)=>st[ot],tt),{target:rt,key:it}}else return{target:rt,key:_e}}const INDEX_REGEX=/-\d+$/;function attach(tt,_e,rt){if(is.str(rt)){if(INDEX_REGEX.test(rt)){const st=rt.replace(INDEX_REGEX,""),{target:ot,key:lt}=resolve(tt,st);Array.isArray(ot[lt])||(ot[lt]=[])}const{target:nt,key:it}=resolve(tt,rt);_e.__r3f.previousAttach=nt[it],nt[it]=_e}else _e.__r3f.previousAttach=rt(tt,_e)}function detach(tt,_e,rt){var nt,it;if(is.str(rt)){const{target:st,key:ot}=resolve(tt,rt),lt=_e.__r3f.previousAttach;lt===void 0?delete st[ot]:st[ot]=lt}else(nt=_e.__r3f)==null||nt.previousAttach==null||nt.previousAttach(tt,_e);(it=_e.__r3f)==null||delete it.previousAttach}function diffProps(tt,{children:_e,key:rt,ref:nt,...it},{children:st,key:ot,ref:lt,...at}={},ct=!1){var ut;const ht=(ut=tt==null?void 0:tt.__r3f)!=null?ut:{},dt=Object.entries(it),ft=[];if(ct){const mt=Object.keys(at);for(let gt=0;gt<mt.length;gt++)it.hasOwnProperty(mt[gt])||dt.unshift([mt[gt],DEFAULT+"remove"])}dt.forEach(([mt,gt])=>{var vt;if((vt=tt.__r3f)!=null&&vt.primitive&&mt==="object"||is.equ(gt,at[mt]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(mt))return ft.push([mt,gt,!0,[]]);let At=[];mt.includes("-")&&(At=mt.split("-")),ft.push([mt,gt,!1,At]);for(const yt in it){const xt=it[yt];yt.startsWith(`${mt}-`)&&ft.push([yt,xt,!1,yt.split("-")])}});const pt={...it};return ht.memoizedProps&&ht.memoizedProps.args&&(pt.args=ht.memoizedProps.args),ht.memoizedProps&&ht.memoizedProps.attach&&(pt.attach=ht.memoizedProps.attach),{memoized:pt,changes:ft}}function applyProps$1(tt,_e){var rt,nt,it;const st=(rt=tt.__r3f)!=null?rt:{},ot=st.root,lt=(nt=ot==null||ot.getState==null?void 0:ot.getState())!=null?nt:{},{memoized:at,changes:ct}=isDiffSet(_e)?_e:diffProps(tt,_e),ut=st.eventCount;tt.__r3f&&(tt.__r3f.memoizedProps=at);for(let dt=0;dt<ct.length;dt++){let[ft,pt,mt,gt]=ct[dt];if(hasColorSpace$1(tt)){const xt="srgb",_t="srgb-linear";ft==="encoding"?(ft="colorSpace",pt=pt===3001?xt:_t):ft==="outputEncoding"&&(ft="outputColorSpace",pt=pt===3001?xt:_t)}let vt=tt,At=vt[ft];if(gt.length&&(At=gt.reduce((yt,xt)=>yt[xt],tt),!(At&&At.set))){const[yt,...xt]=gt.reverse();vt=xt.reverse().reduce((_t,Et)=>_t[Et],tt),ft=yt}if(pt===DEFAULT+"remove")if(vt.constructor){let yt=DEFAULTS.get(vt.constructor);yt||(yt=new vt.constructor,DEFAULTS.set(vt.constructor,yt)),pt=yt[ft]}else pt=0;if(mt)pt?st.handlers[ft]=pt:delete st.handlers[ft],st.eventCount=Object.keys(st.handlers).length;else if(At&&At.set&&(At.copy||At instanceof Layers)){if(Array.isArray(pt))At.fromArray?At.fromArray(pt):At.set(...pt);else if(At.copy&&pt&&pt.constructor&&At.constructor===pt.constructor)At.copy(pt);else if(pt!==void 0){const yt=At instanceof Color$1;!yt&&At.setScalar?At.setScalar(pt):At instanceof Layers&&pt instanceof Layers?At.mask=pt.mask:At.set(pt),!getColorManagement()&&!lt.linear&&yt&&At.convertSRGBToLinear()}}else if(vt[ft]=pt,vt[ft]instanceof Texture&&vt[ft].format===RGBAFormat&&vt[ft].type===UnsignedByteType){const yt=vt[ft];hasColorSpace$1(yt)&&hasColorSpace$1(lt.gl)?yt.colorSpace=lt.gl.outputColorSpace:yt.encoding=lt.gl.outputEncoding}invalidateInstance(tt)}if(st.parent&&lt.internal&&tt.raycast&&ut!==st.eventCount){const dt=lt.internal.interaction.indexOf(tt);dt>-1&&lt.internal.interaction.splice(dt,1),st.eventCount&&lt.internal.interaction.push(tt)}return!(ct.length===1&&ct[0][0]==="onUpdate")&&ct.length&&(it=tt.__r3f)!=null&&it.parent&&updateInstance(tt),tt}function invalidateInstance(tt){var _e,rt;const nt=(_e=tt.__r3f)==null||(rt=_e.root)==null||rt.getState==null?void 0:rt.getState();nt&&nt.internal.frames===0&&nt.invalidate()}function updateInstance(tt){tt.onUpdate==null||tt.onUpdate(tt)}function updateCamera(tt,_e){tt.manual||(isOrthographicCamera(tt)?(tt.left=_e.width/-2,tt.right=_e.width/2,tt.top=_e.height/2,tt.bottom=_e.height/-2):tt.aspect=_e.width/_e.height,tt.updateProjectionMatrix(),tt.updateMatrixWorld())}function makeId(tt){return(tt.eventObject||tt.object).uuid+"/"+tt.index+tt.instanceId}function getEventPriority(){var tt;const _e=typeof self<"u"&&self||typeof window<"u"&&window;if(!_e)return constantsExports.DefaultEventPriority;switch((tt=_e.event)==null?void 0:tt.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(tt,_e,rt,nt){const it=rt.get(_e);it&&(rt.delete(_e),rt.size===0&&(tt.delete(nt),it.target.releasePointerCapture(nt)))}function removeInteractivity(tt,_e){const{internal:rt}=tt.getState();rt.interaction=rt.interaction.filter(nt=>nt!==_e),rt.initialHits=rt.initialHits.filter(nt=>nt!==_e),rt.hovered.forEach((nt,it)=>{(nt.eventObject===_e||nt.object===_e)&&rt.hovered.delete(it)}),rt.capturedMap.forEach((nt,it)=>{releaseInternalPointerCapture(rt.capturedMap,_e,nt,it)})}function createEvents(tt){function _e(at){const{internal:ct}=tt.getState(),ut=at.offsetX-ct.initialClick[0],ht=at.offsetY-ct.initialClick[1];return Math.round(Math.sqrt(ut*ut+ht*ht))}function rt(at){return at.filter(ct=>["Move","Over","Enter","Out","Leave"].some(ut=>{var ht;return(ht=ct.__r3f)==null?void 0:ht.handlers["onPointer"+ut]}))}function nt(at,ct){const ut=tt.getState(),ht=new Set,dt=[],ft=ct?ct(ut.internal.interaction):ut.internal.interaction;for(let vt=0;vt<ft.length;vt++){const At=getRootState(ft[vt]);At&&(At.raycaster.camera=void 0)}ut.previousRoot||ut.events.compute==null||ut.events.compute(at,ut);function pt(vt){const At=getRootState(vt);if(!At||!At.events.enabled||At.raycaster.camera===null)return[];if(At.raycaster.camera===void 0){var yt;At.events.compute==null||At.events.compute(at,At,(yt=At.previousRoot)==null?void 0:yt.getState()),At.raycaster.camera===void 0&&(At.raycaster.camera=null)}return At.raycaster.camera?At.raycaster.intersectObject(vt,!0):[]}let mt=ft.flatMap(pt).sort((vt,At)=>{const yt=getRootState(vt.object),xt=getRootState(At.object);return!yt||!xt?vt.distance-At.distance:xt.events.priority-yt.events.priority||vt.distance-At.distance}).filter(vt=>{const At=makeId(vt);return ht.has(At)?!1:(ht.add(At),!0)});ut.events.filter&&(mt=ut.events.filter(mt,ut));for(const vt of mt){let At=vt.object;for(;At;){var gt;(gt=At.__r3f)!=null&&gt.eventCount&&dt.push({...vt,eventObject:At}),At=At.parent}}if("pointerId"in at&&ut.internal.capturedMap.has(at.pointerId))for(let vt of ut.internal.capturedMap.get(at.pointerId).values())ht.has(makeId(vt.intersection))||dt.push(vt.intersection);return dt}function it(at,ct,ut,ht){const dt=tt.getState();if(at.length){const ft={stopped:!1};for(const pt of at){const mt=getRootState(pt.object)||dt,{raycaster:gt,pointer:vt,camera:At,internal:yt}=mt,xt=new Vector3(vt.x,vt.y,0).unproject(At),_t=Mt=>{var Pt,It;return(Pt=(It=yt.capturedMap.get(Mt))==null?void 0:It.has(pt.eventObject))!=null?Pt:!1},Et=Mt=>{const Pt={intersection:pt,target:ct.target};yt.capturedMap.has(Mt)?yt.capturedMap.get(Mt).set(pt.eventObject,Pt):yt.capturedMap.set(Mt,new Map([[pt.eventObject,Pt]])),ct.target.setPointerCapture(Mt)},bt=Mt=>{const Pt=yt.capturedMap.get(Mt);Pt&&releaseInternalPointerCapture(yt.capturedMap,pt.eventObject,Pt,Mt)};let wt={};for(let Mt in ct){let Pt=ct[Mt];typeof Pt!="function"&&(wt[Mt]=Pt)}let Tt={...pt,...wt,pointer:vt,intersections:at,stopped:ft.stopped,delta:ut,unprojectedPoint:xt,ray:gt.ray,camera:At,stopPropagation(){const Mt="pointerId"in ct&&yt.capturedMap.get(ct.pointerId);if((!Mt||Mt.has(pt.eventObject))&&(Tt.stopped=ft.stopped=!0,yt.hovered.size&&Array.from(yt.hovered.values()).find(Pt=>Pt.eventObject===pt.eventObject))){const Pt=at.slice(0,at.indexOf(pt));st([...Pt,pt])}},target:{hasPointerCapture:_t,setPointerCapture:Et,releasePointerCapture:bt},currentTarget:{hasPointerCapture:_t,setPointerCapture:Et,releasePointerCapture:bt},nativeEvent:ct};if(ht(Tt),ft.stopped===!0)break}}return at}function st(at){const{internal:ct}=tt.getState();for(const ut of ct.hovered.values())if(!at.length||!at.find(ht=>ht.object===ut.object&&ht.index===ut.index&&ht.instanceId===ut.instanceId)){const dt=ut.eventObject.__r3f,ft=dt==null?void 0:dt.handlers;if(ct.hovered.delete(makeId(ut)),dt!=null&&dt.eventCount){const pt={...ut,intersections:at};ft.onPointerOut==null||ft.onPointerOut(pt),ft.onPointerLeave==null||ft.onPointerLeave(pt)}}}function ot(at,ct){for(let ut=0;ut<ct.length;ut++){const ht=ct[ut].__r3f;ht==null||ht.handlers.onPointerMissed==null||ht.handlers.onPointerMissed(at)}}function lt(at){switch(at){case"onPointerLeave":case"onPointerCancel":return()=>st([]);case"onLostPointerCapture":return ct=>{const{internal:ut}=tt.getState();"pointerId"in ct&&ut.capturedMap.has(ct.pointerId)&&requestAnimationFrame(()=>{ut.capturedMap.has(ct.pointerId)&&(ut.capturedMap.delete(ct.pointerId),st([]))})}}return function(ut){const{onPointerMissed:ht,internal:dt}=tt.getState();dt.lastEvent.current=ut;const ft=at==="onPointerMove",pt=at==="onClick"||at==="onContextMenu"||at==="onDoubleClick",gt=nt(ut,ft?rt:void 0),vt=pt?_e(ut):0;at==="onPointerDown"&&(dt.initialClick=[ut.offsetX,ut.offsetY],dt.initialHits=gt.map(yt=>yt.eventObject)),pt&&!gt.length&&vt<=2&&(ot(ut,dt.interaction),ht&&ht(ut)),ft&&st(gt);function At(yt){const xt=yt.eventObject,_t=xt.__r3f,Et=_t==null?void 0:_t.handlers;if(_t!=null&&_t.eventCount)if(ft){if(Et.onPointerOver||Et.onPointerEnter||Et.onPointerOut||Et.onPointerLeave){const bt=makeId(yt),wt=dt.hovered.get(bt);wt?wt.stopped&&yt.stopPropagation():(dt.hovered.set(bt,yt),Et.onPointerOver==null||Et.onPointerOver(yt),Et.onPointerEnter==null||Et.onPointerEnter(yt))}Et.onPointerMove==null||Et.onPointerMove(yt)}else{const bt=Et[at];bt?(!pt||dt.initialHits.includes(xt))&&(ot(ut,dt.interaction.filter(wt=>!dt.initialHits.includes(wt))),bt(yt)):pt&&dt.initialHits.includes(xt)&&ot(ut,dt.interaction.filter(wt=>!dt.initialHits.includes(wt)))}}it(gt,ut,vt,At)}}return{handlePointer:lt}}const privateKeys=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],isRenderer=tt=>!!(tt!=null&&tt.render),context=reactExports.createContext(null),createStore=(tt,_e)=>{const rt=create((lt,at)=>{const ct=new Vector3,ut=new Vector3,ht=new Vector3;function dt(vt=at().camera,At=ut,yt=at().size){const{width:xt,height:_t,top:Et,left:bt}=yt,wt=xt/_t;At instanceof Vector3?ht.copy(At):ht.set(...At);const Tt=vt.getWorldPosition(ct).distanceTo(ht);if(isOrthographicCamera(vt))return{width:xt/vt.zoom,height:_t/vt.zoom,top:Et,left:bt,factor:1,distance:Tt,aspect:wt};{const Mt=vt.fov*Math.PI/180,Pt=2*Math.tan(Mt/2)*Tt,It=Pt*(xt/_t);return{width:It,height:Pt,top:Et,left:bt,factor:xt/It,distance:Tt,aspect:wt}}}let ft;const pt=vt=>lt(At=>({performance:{...At.performance,current:vt}})),mt=new Vector2;return{set:lt,get:at,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(vt=1)=>tt(at(),vt),advance:(vt,At)=>_e(vt,At,at()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock,pointer:mt,mouse:mt,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const vt=at();ft&&clearTimeout(ft),vt.performance.current!==vt.performance.min&&pt(vt.performance.min),ft=setTimeout(()=>pt(at().performance.max),vt.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:dt},setEvents:vt=>lt(At=>({...At,events:{...At.events,...vt}})),setSize:(vt,At,yt,xt,_t)=>{const Et=at().camera,bt={width:vt,height:At,top:xt||0,left:_t||0,updateStyle:yt};lt(wt=>({size:bt,viewport:{...wt.viewport,...dt(Et,ut,bt)}}))},setDpr:vt=>lt(At=>{const yt=calculateDpr(vt);return{viewport:{...At.viewport,dpr:yt,initialDpr:At.viewport.initialDpr||yt}}}),setFrameloop:(vt="always")=>{const At=at().clock;At.stop(),At.elapsedTime=0,vt!=="never"&&(At.start(),At.elapsedTime=0),lt(()=>({frameloop:vt}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(vt,At,yt)=>{const xt=at().internal;return xt.priority=xt.priority+(At>0?1:0),xt.subscribers.push({ref:vt,priority:At,store:yt}),xt.subscribers=xt.subscribers.sort((_t,Et)=>_t.priority-Et.priority),()=>{const _t=at().internal;_t!=null&&_t.subscribers&&(_t.priority=_t.priority-(At>0?1:0),_t.subscribers=_t.subscribers.filter(Et=>Et.ref!==vt))}}}}}),nt=rt.getState();let it=nt.size,st=nt.viewport.dpr,ot=nt.camera;return rt.subscribe(()=>{const{camera:lt,size:at,viewport:ct,gl:ut,set:ht}=rt.getState();if(at!==it||ct.dpr!==st){var dt;it=at,st=ct.dpr,updateCamera(lt,at),ut.setPixelRatio(ct.dpr);const ft=(dt=at.updateStyle)!=null?dt:typeof HTMLCanvasElement<"u"&&ut.domElement instanceof HTMLCanvasElement;ut.setSize(at.width,at.height,ft)}lt!==ot&&(ot=lt,ht(ft=>({viewport:{...ft.viewport,...ft.viewport.getCurrentViewport(lt)}})))}),rt.subscribe(lt=>tt(lt)),rt};function createSubs(tt,_e){const rt={callback:tt};return _e.add(rt),()=>void _e.delete(rt)}let i$6,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;const addEffect=tt=>createSubs(tt,globalEffects),addAfterEffect=tt=>createSubs(tt,globalAfterEffects);function run(tt,_e){if(tt.size)for(const{callback:rt}of tt.values())rt(_e)}function flushGlobalEffects(tt,_e){switch(tt){case"before":return run(globalEffects,_e);case"after":return run(globalAfterEffects,_e);case"tail":return run(globalTailEffects,_e)}}let subscribers,subscription;function render$1(tt,_e,rt){let nt=_e.clock.getDelta();for(_e.frameloop==="never"&&typeof tt=="number"&&(nt=tt-_e.clock.elapsedTime,_e.clock.oldTime=_e.clock.elapsedTime,_e.clock.elapsedTime=tt),subscribers=_e.internal.subscribers,i$6=0;i$6<subscribers.length;i$6++)subscription=subscribers[i$6],subscription.ref.current(subscription.store.getState(),nt,rt);return!_e.internal.priority&&_e.gl.render&&_e.gl.render(_e.scene,_e.camera),_e.internal.frames=Math.max(0,_e.internal.frames-1),_e.frameloop==="always"?1:_e.internal.frames}function createLoop(tt){let _e=!1,rt,nt,it;function st(at){nt=requestAnimationFrame(st),_e=!0,rt=0,flushGlobalEffects("before",at);for(const ut of tt.values()){var ct;it=ut.store.getState(),it.internal.active&&(it.frameloop==="always"||it.internal.frames>0)&&!((ct=it.gl.xr)!=null&&ct.isPresenting)&&(rt+=render$1(at,it))}if(flushGlobalEffects("after",at),rt===0)return flushGlobalEffects("tail",at),_e=!1,cancelAnimationFrame(nt)}function ot(at,ct=1){var ut;if(!at)return tt.forEach(ht=>ot(ht.store.getState()),ct);(ut=at.gl.xr)!=null&&ut.isPresenting||!at.internal.active||at.frameloop==="never"||(at.internal.frames=Math.min(60,at.internal.frames+ct),_e||(_e=!0,requestAnimationFrame(st)))}function lt(at,ct=!0,ut,ht){if(ct&&flushGlobalEffects("before",at),ut)render$1(at,ut,ht);else for(const dt of tt.values())render$1(at,dt.store.getState());ct&&flushGlobalEffects("after",at)}return{loop:st,invalidate:ot,advance:lt}}function useStore(){const tt=reactExports.useContext(context);if(!tt)throw new Error("R3F: Hooks can only be used within the Canvas component!");return tt}function useThree(tt=rt=>rt,_e){return useStore()(tt,_e)}function useFrame(tt,_e=0){const rt=useStore(),nt=rt.getState().internal.subscribe,it=useMutableCallback(tt);return useIsomorphicLayoutEffect$1(()=>nt(it,_e,rt),[_e,nt,rt]),null}function loadingFn(tt,_e){return function(rt,...nt){const it=new rt;return tt&&tt(it),Promise.all(nt.map(st=>new Promise((ot,lt)=>it.load(st,at=>{at.scene&&Object.assign(at,buildGraph(at.scene)),ot(at)},_e,at=>lt(new Error(`Could not load ${st}: ${at.message})`))))))}}function useLoader(tt,_e,rt,nt){const it=Array.isArray(_e)?_e:[_e],st=suspend(loadingFn(rt,nt),[tt,...it],{equal:is.equ});return Array.isArray(_e)?st:st[0]}useLoader.preload=function(tt,_e,rt){const nt=Array.isArray(_e)?_e:[_e];return preload(loadingFn(rt),[tt,...nt])};useLoader.clear=function(tt,_e){const rt=Array.isArray(_e)?_e:[_e];return clear([tt,...rt])};const roots=new Map,{invalidate,advance}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(tt,_e)=>{const rt=typeof tt=="function"?tt(_e):tt;return isRenderer(rt)?rt:new WebGLRenderer({powerPreference:"high-performance",canvas:_e,antialias:!0,alpha:!0,...tt})};function computeInitialSize(tt,_e){if(_e)return _e;if(typeof HTMLCanvasElement<"u"&&tt instanceof HTMLCanvasElement&&tt.parentElement){const{width:rt,height:nt,top:it,left:st}=tt.parentElement.getBoundingClientRect();return{width:rt,height:nt,top:it,left:st}}else if(typeof OffscreenCanvas<"u"&&tt instanceof OffscreenCanvas)return{width:tt.width,height:tt.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function createRoot(tt){const _e=roots.get(tt),rt=_e==null?void 0:_e.fiber,nt=_e==null?void 0:_e.store;_e&&console.warn("R3F.createRoot should only be called once!");const it=typeof reportError=="function"?reportError:console.error,st=nt||createStore(invalidate,advance),ot=rt||reconciler.createContainer(st,constantsExports.ConcurrentRoot,null,!1,null,"",it,null);_e||roots.set(tt,{fiber:ot,store:st});let lt,at=!1,ct;return{configure(ut={}){let{gl:ht,size:dt,scene:ft,events:pt,onCreated:mt,shadows:gt=!1,linear:vt=!1,flat:At=!1,legacy:yt=!1,orthographic:xt=!1,frameloop:_t="always",dpr:Et=[1,2],performance:bt,raycaster:wt,camera:Tt,onPointerMissed:Mt}=ut,Pt=st.getState(),It=Pt.gl;Pt.gl||Pt.set({gl:It=createRendererInstance(ht,tt)});let Ot=Pt.raycaster;Ot||Pt.set({raycaster:Ot=new Raycaster});const{params:Bt,...Ut}=wt||{};if(is.equ(Ut,Ot,shallowLoose)||applyProps(Ot,{...Ut}),is.equ(Bt,Ot.params,shallowLoose)||applyProps(Ot,{params:{...Ot.params,...Bt}}),!Pt.camera||Pt.camera===ct&&!is.equ(ct,Tt,shallowLoose)){ct=Tt;const $t=Tt instanceof Camera,Ht=$t?Tt:xt?new OrthographicCamera(0,0,0,0,.1,1e3):new PerspectiveCamera(75,0,.1,1e3);$t||(Ht.position.z=5,Tt&&applyProps(Ht,Tt),!Pt.camera&&!(Tt!=null&&Tt.rotation)&&Ht.lookAt(0,0,0)),Pt.set({camera:Ht})}if(!Pt.scene){let $t;ft instanceof Scene?$t=ft:($t=new Scene,ft&&applyProps($t,ft)),Pt.set({scene:prepare($t)})}if(!Pt.xr){const $t=(Zt,or)=>{const Kt=st.getState();Kt.frameloop!=="never"&&advance(Zt,!0,Kt,or)},Ht=()=>{const Zt=st.getState();Zt.gl.xr.enabled=Zt.gl.xr.isPresenting,Zt.gl.xr.setAnimationLoop(Zt.gl.xr.isPresenting?$t:null),Zt.gl.xr.isPresenting||invalidate(Zt)},er={connect(){const Zt=st.getState().gl;Zt.xr.addEventListener("sessionstart",Ht),Zt.xr.addEventListener("sessionend",Ht)},disconnect(){const Zt=st.getState().gl;Zt.xr.removeEventListener("sessionstart",Ht),Zt.xr.removeEventListener("sessionend",Ht)}};It.xr&&er.connect(),Pt.set({xr:er})}if(It.shadowMap){const $t=It.shadowMap.enabled,Ht=It.shadowMap.type;if(It.shadowMap.enabled=!!gt,is.boo(gt))It.shadowMap.type=PCFSoftShadowMap;else if(is.str(gt)){var Ft;const er={basic:BasicShadowMap,percentage:PCFShadowMap,soft:PCFSoftShadowMap,variance:VSMShadowMap};It.shadowMap.type=(Ft=er[gt])!=null?Ft:PCFSoftShadowMap}else is.obj(gt)&&Object.assign(It.shadowMap,gt);($t!==It.shadowMap.enabled||Ht!==It.shadowMap.type)&&(It.shadowMap.needsUpdate=!0)}const jt=getColorManagement();jt&&("enabled"in jt?jt.enabled=!yt:"legacyMode"in jt&&(jt.legacyMode=yt)),applyProps(It,{outputEncoding:vt?3e3:3001,toneMapping:At?NoToneMapping:ACESFilmicToneMapping}),Pt.legacy!==yt&&Pt.set(()=>({legacy:yt})),Pt.linear!==vt&&Pt.set(()=>({linear:vt})),Pt.flat!==At&&Pt.set(()=>({flat:At})),ht&&!is.fun(ht)&&!isRenderer(ht)&&!is.equ(ht,It,shallowLoose)&&applyProps(It,ht),pt&&!Pt.events.handlers&&Pt.set({events:pt(st)});const zt=computeInitialSize(tt,dt);return is.equ(zt,Pt.size,shallowLoose)||Pt.setSize(zt.width,zt.height,zt.updateStyle,zt.top,zt.left),Et&&Pt.viewport.dpr!==calculateDpr(Et)&&Pt.setDpr(Et),Pt.frameloop!==_t&&Pt.setFrameloop(_t),Pt.onPointerMissed||Pt.set({onPointerMissed:Mt}),bt&&!is.equ(bt,Pt.performance,shallowLoose)&&Pt.set($t=>({performance:{...$t.performance,...bt}})),lt=mt,at=!0,this},render(ut){return at||this.configure(),reconciler.updateContainer(reactExports.createElement(Provider,{store:st,children:ut,onCreated:lt,rootElement:tt}),ot,null,()=>{}),st},unmount(){unmountComponentAtNode(tt)}}}function Provider({store:tt,children:_e,onCreated:rt,rootElement:nt}){return useIsomorphicLayoutEffect$1(()=>{const it=tt.getState();it.set(st=>({internal:{...st.internal,active:!0}})),rt&&rt(it),tt.getState().events.connected||it.events.connect==null||it.events.connect(nt)},[]),reactExports.createElement(context.Provider,{value:tt},_e)}function unmountComponentAtNode(tt,_e){const rt=roots.get(tt),nt=rt==null?void 0:rt.fiber;if(nt){const it=rt==null?void 0:rt.store.getState();it&&(it.internal.active=!1),reconciler.updateContainer(null,nt,null,()=>{it&&setTimeout(()=>{try{var st,ot,lt,at;it.events.disconnect==null||it.events.disconnect(),(st=it.gl)==null||(ot=st.renderLists)==null||ot.dispose==null||ot.dispose(),(lt=it.gl)==null||lt.forceContextLoss==null||lt.forceContextLoss(),(at=it.gl)!=null&&at.xr&&it.xr.disconnect(),dispose(it),roots.delete(tt),_e&&_e(tt)}catch{}},500)})}}function createPortal(tt,_e,rt){return reactExports.createElement(Portal$3,{key:_e.uuid,children:tt,container:_e,state:rt})}function Portal$3({state:tt={},children:_e,container:rt}){const{events:nt,size:it,...st}=tt,ot=useStore(),[lt]=reactExports.useState(()=>new Raycaster),[at]=reactExports.useState(()=>new Vector2),ct=reactExports.useCallback((ht,dt)=>{const ft={...ht};Object.keys(ht).forEach(mt=>{(privateKeys.includes(mt)||ht[mt]!==dt[mt]&&dt[mt])&&delete ft[mt]});let pt;if(dt&&it){const mt=dt.camera;pt=ht.viewport.getCurrentViewport(mt,new Vector3,it),mt!==ht.camera&&updateCamera(mt,it)}return{...ft,scene:rt,raycaster:lt,pointer:at,mouse:at,previousRoot:ot,events:{...ht.events,...dt==null?void 0:dt.events,...nt},size:{...ht.size,...it},viewport:{...ht.viewport,...pt},...st}},[tt]),[ut]=reactExports.useState(()=>{const ht=ot.getState();return create((ft,pt)=>({...ht,scene:rt,raycaster:lt,pointer:at,mouse:at,previousRoot:ot,events:{...ht.events,...nt},size:{...ht.size,...it},...st,set:ft,get:pt,setEvents:mt=>ft(gt=>({...gt,events:{...gt.events,...mt}}))}))});return reactExports.useEffect(()=>{const ht=ot.subscribe(dt=>ut.setState(ft=>ct(dt,ft)));return()=>{ht(),ut.destroy()}},[]),reactExports.useEffect(()=>{ut.setState(ht=>ct(ot.getState(),ht))},[ct]),reactExports.createElement(reactExports.Fragment,null,reconciler.createPortal(reactExports.createElement(context.Provider,{value:ut},_e),ut,null))}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});function debounce$1(tt,_e,rt){var nt,it,st,ot,lt;_e==null&&(_e=100);function at(){var ut=Date.now()-ot;ut<_e&&ut>=0?nt=setTimeout(at,_e-ut):(nt=null,rt||(lt=tt.apply(st,it),st=it=null))}var ct=function(){st=this,it=arguments,ot=Date.now();var ut=rt&&!nt;return nt||(nt=setTimeout(at,_e)),ut&&(lt=tt.apply(st,it),st=it=null),lt};return ct.clear=function(){nt&&(clearTimeout(nt),nt=null)},ct.flush=function(){nt&&(lt=tt.apply(st,it),st=it=null,clearTimeout(nt),nt=null)},ct}debounce$1.debounce=debounce$1;var debounce_1=debounce$1;const createDebounce=getDefaultExportFromCjs(debounce_1);function useMeasure(tt){let{debounce:_e,scroll:rt,polyfill:nt,offsetSize:it}=tt===void 0?{debounce:0,scroll:!1,offsetSize:!1}:tt;const st=nt||(typeof window>"u"?class{}:window.ResizeObserver);if(!st)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[ot,lt]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),at=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:ot}),ct=_e?typeof _e=="number"?_e:_e.scroll:null,ut=_e?typeof _e=="number"?_e:_e.resize:null,ht=reactExports.useRef(!1);reactExports.useEffect(()=>(ht.current=!0,()=>void(ht.current=!1)));const[dt,ft,pt]=reactExports.useMemo(()=>{const At=()=>{if(!at.current.element)return;const{left:yt,top:xt,width:_t,height:Et,bottom:bt,right:wt,x:Tt,y:Mt}=at.current.element.getBoundingClientRect(),Pt={left:yt,top:xt,width:_t,height:Et,bottom:bt,right:wt,x:Tt,y:Mt};at.current.element instanceof HTMLElement&&it&&(Pt.height=at.current.element.offsetHeight,Pt.width=at.current.element.offsetWidth),Object.freeze(Pt),ht.current&&!areBoundsEqual(at.current.lastBounds,Pt)&&lt(at.current.lastBounds=Pt)};return[At,ut?createDebounce(At,ut):At,ct?createDebounce(At,ct):At]},[lt,it,ct,ut]);function mt(){at.current.scrollContainers&&(at.current.scrollContainers.forEach(At=>At.removeEventListener("scroll",pt,!0)),at.current.scrollContainers=null),at.current.resizeObserver&&(at.current.resizeObserver.disconnect(),at.current.resizeObserver=null)}function gt(){at.current.element&&(at.current.resizeObserver=new st(pt),at.current.resizeObserver.observe(at.current.element),rt&&at.current.scrollContainers&&at.current.scrollContainers.forEach(At=>At.addEventListener("scroll",pt,{capture:!0,passive:!0})))}const vt=At=>{!At||At===at.current.element||(mt(),at.current.element=At,at.current.scrollContainers=findScrollContainers(At),gt())};return useOnWindowScroll(pt,!!rt),useOnWindowResize(ft),reactExports.useEffect(()=>{mt(),gt()},[rt,pt,ft]),reactExports.useEffect(()=>mt,[]),[vt,ot,dt]}function useOnWindowResize(tt){reactExports.useEffect(()=>{const _e=tt;return window.addEventListener("resize",_e),()=>void window.removeEventListener("resize",_e)},[tt])}function useOnWindowScroll(tt,_e){reactExports.useEffect(()=>{if(_e){const rt=tt;return window.addEventListener("scroll",rt,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",rt,!0)}},[tt,_e])}function findScrollContainers(tt){const _e=[];if(!tt||tt===document.body)return _e;const{overflow:rt,overflowX:nt,overflowY:it}=window.getComputedStyle(tt);return[rt,nt,it].some(st=>st==="auto"||st==="scroll")&&_e.push(tt),[..._e,...findScrollContainers(tt.parentElement)]}const keys$2=["x","y","top","bottom","left","right","width","height"],areBoundsEqual=(tt,_e)=>keys$2.every(rt=>tt[rt]===_e[rt]);var __defProp$1=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(tt,_e,rt)=>_e in tt?__defProp$1(tt,_e,{enumerable:!0,configurable:!0,writable:!0,value:rt}):tt[_e]=rt,__spreadValues=(tt,_e)=>{for(var rt in _e||(_e={}))__hasOwnProp.call(_e,rt)&&__defNormalProp$1(tt,rt,_e[rt]);if(__getOwnPropSymbols)for(var rt of __getOwnPropSymbols(_e))__propIsEnum.call(_e,rt)&&__defNormalProp$1(tt,rt,_e[rt]);return tt},__spreadProps=(tt,_e)=>__defProps(tt,__getOwnPropDescs(_e));function traverseFiber(tt,_e,rt){if(!tt)return;if(rt(tt)===!0)return tt;let nt=_e?tt.return:tt.child;for(;nt;){const it=traverseFiber(nt,_e,rt);if(it)return it;nt=_e?null:nt.sibling}}function wrapContext(tt){try{return Object.defineProperties(tt,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return tt}}const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner,ReactCurrentDispatcher}=reactExports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function useFiber(){const tt=reactExports.useContext(FiberContext);if(tt===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const _e=reactExports.useId();return reactExports.useMemo(()=>{for(const nt of[ReactCurrentOwner==null?void 0:ReactCurrentOwner.current,tt,tt==null?void 0:tt.alternate]){if(!nt)continue;const it=traverseFiber(nt,!1,st=>{let ot=st.memoizedState;for(;ot;){if(ot.memoizedState===_e)return!0;ot=ot.next}});if(it)return it}},[tt,_e])}function useContextMap(){var tt,_e;const rt=useFiber(),[nt]=reactExports.useState(()=>new Map);nt.clear();let it=rt;for(;it;){const st=(tt=it.type)==null?void 0:tt._context;st&&st!==FiberContext&&!nt.has(st)&&nt.set(st,(_e=ReactCurrentDispatcher==null?void 0:ReactCurrentDispatcher.current)==null?void 0:_e.readContext(wrapContext(st))),it=it.return}return nt}function useContextBridge(){const tt=useContextMap();return reactExports.useMemo(()=>Array.from(tt.keys()).reduce((_e,rt)=>nt=>reactExports.createElement(_e,null,reactExports.createElement(rt.Provider,__spreadProps(__spreadValues({},nt),{value:tt.get(rt)}))),_e=>reactExports.createElement(FiberProvider,__spreadValues({},_e))),[tt])}const DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(tt){const{handlePointer:_e}=createEvents(tt);return{priority:1,enabled:!0,compute(rt,nt,it){nt.pointer.set(rt.offsetX/nt.size.width*2-1,-(rt.offsetY/nt.size.height)*2+1),nt.raycaster.setFromCamera(nt.pointer,nt.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((rt,nt)=>({...rt,[nt]:_e(nt)}),{}),update:()=>{var rt;const{events:nt,internal:it}=tt.getState();(rt=it.lastEvent)!=null&&rt.current&&nt.handlers&&nt.handlers.onPointerMove(it.lastEvent.current)},connect:rt=>{var nt;const{set:it,events:st}=tt.getState();st.disconnect==null||st.disconnect(),it(ot=>({events:{...ot.events,connected:rt}})),Object.entries((nt=st.handlers)!=null?nt:[]).forEach(([ot,lt])=>{const[at,ct]=DOM_EVENTS[ot];rt.addEventListener(at,lt,{passive:ct})})},disconnect:()=>{const{set:rt,events:nt}=tt.getState();if(nt.connected){var it;Object.entries((it=nt.handlers)!=null?it:[]).forEach(([st,ot])=>{if(nt&&nt.connected instanceof HTMLElement){const[lt]=DOM_EVENTS[st];nt.connected.removeEventListener(lt,ot)}}),rt(st=>({events:{...st.events,connected:void 0}}))}}}}const CanvasImpl=reactExports.forwardRef(function({children:_e,fallback:rt,resize:nt,style:it,gl:st,events:ot=createPointerEvents,eventSource:lt,eventPrefix:at,shadows:ct,linear:ut,flat:ht,legacy:dt,orthographic:ft,frameloop:pt,dpr:mt,performance:gt,raycaster:vt,camera:At,onPointerMissed:yt,onCreated:xt,..._t},Et){reactExports.useMemo(()=>extend$2(THREE),[]);const bt=useContextBridge(),[wt,Tt]=useMeasure({scroll:!0,debounce:{scroll:50,resize:0},...nt}),Mt=reactExports.useRef(null),Pt=reactExports.useRef(null);reactExports.useImperativeHandle(Et,()=>Mt.current);const It=useMutableCallback(yt),[Ot,Bt]=reactExports.useState(!1),[Ut,Ft]=reactExports.useState(!1);if(Ot)throw Ot;if(Ut)throw Ut;const jt=reactExports.useRef(null);useIsomorphicLayoutEffect$1(()=>{const Gt=Mt.current;Tt.width>0&&Tt.height>0&&Gt&&(jt.current||(jt.current=createRoot(Gt)),jt.current.configure({gl:st,events:ot,shadows:ct,linear:ut,flat:ht,legacy:dt,orthographic:ft,frameloop:pt,dpr:mt,performance:gt,raycaster:vt,camera:At,size:Tt,onPointerMissed:(...zt)=>It.current==null?void 0:It.current(...zt),onCreated:zt=>{zt.events.connect==null||zt.events.connect(lt?isRef$1(lt)?lt.current:lt:Pt.current),at&&zt.setEvents({compute:($t,Ht)=>{const er=$t[at+"X"],Zt=$t[at+"Y"];Ht.pointer.set(er/Ht.size.width*2-1,-(Zt/Ht.size.height)*2+1),Ht.raycaster.setFromCamera(Ht.pointer,Ht.camera)}}),xt==null||xt(zt)}}),jt.current.render(reactExports.createElement(bt,null,reactExports.createElement(ErrorBoundary,{set:Ft},reactExports.createElement(reactExports.Suspense,{fallback:reactExports.createElement(Block,{set:Bt})},_e)))))}),reactExports.useEffect(()=>{const Gt=Mt.current;if(Gt)return()=>unmountComponentAtNode(Gt)},[]);const Dt=lt?"none":"auto";return reactExports.createElement("div",_extends$1({ref:Pt,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Dt,...it}},_t),reactExports.createElement("div",{ref:wt,style:{width:"100%",height:"100%"}},reactExports.createElement("canvas",{ref:Mt,style:{display:"block"}},rt)))}),Canvas$1=reactExports.forwardRef(function(_e,rt){return reactExports.createElement(FiberProvider,null,reactExports.createElement(CanvasImpl,_extends$1({},_e,{ref:rt})))});class XRController extends Group{constructor(_e,rt){super(),this.inputSource=null,this.xrControllerModel=null,this.index=_e,this.controller=rt.xr.getController(_e),this.grip=rt.xr.getControllerGrip(_e),this.hand=rt.xr.getHand(_e),this.grip.userData.name="grip",this.controller.userData.name="controller",this.hand.userData.name="hand",this.visible=!1,this.add(this.controller,this.grip,this.hand),this._onConnected=this._onConnected.bind(this),this._onDisconnected=this._onDisconnected.bind(this),this.controller.addEventListener("connected",this._onConnected),this.controller.addEventListener("disconnected",this._onDisconnected)}_onConnected(_e){_e.fake||_e.data&&(this.visible=!0,this.inputSource=_e.data,this.dispatchEvent(_e))}_onDisconnected(_e){_e.fake||(this.visible=!1,this.inputSource=null,this.dispatchEvent(_e))}dispose(){this.controller.removeEventListener("connected",this._onConnected),this.controller.removeEventListener("disconnected",this._onDisconnected)}}var _a$1,_b$1;const uniq$1=tt=>Array.from(new Set(tt)),useIsomorphicLayoutEffect=typeof window<"u"&&((_a$1=window.document)!=null&&_a$1.createElement||((_b$1=window.navigator)==null?void 0:_b$1.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useCallbackRef$2(tt){const _e=reactExports.useRef(tt);return useIsomorphicLayoutEffect(()=>void(_e.current=tt),[tt]),_e}function useXREvent(tt,_e,{handedness:rt}={}){const nt=useCallbackRef$2(_e),it=useXR(st=>st.controllers);useIsomorphicLayoutEffect(()=>{const st=it.map(ot=>{if(rt&&ot.inputSource&&ot.inputSource.handedness!==rt)return;const lt=at=>nt.current({nativeEvent:at,target:ot});return ot.controller.addEventListener(tt,lt),()=>ot.controller.removeEventListener(tt,lt)});return()=>st.forEach(ot=>ot==null?void 0:ot())},[it,rt,tt])}const tempMatrix=new Matrix4;function InteractionManager({children:tt}){const _e=useThree(ht=>ht.events),rt=useThree(ht=>ht.get),nt=useThree(ht=>ht.raycaster),it=useXR(ht=>ht.controllers),st=useXR(ht=>ht.interactions),ot=useXR(ht=>ht.hoverState),lt=useXR(ht=>ht.hasInteraction),at=useXR(ht=>ht.getInteraction),ct=reactExports.useCallback(ht=>{const dt=Array.from(st.keys());return tempMatrix.identity().extractRotation(ht.matrixWorld),nt.ray.origin.setFromMatrixPosition(ht.matrixWorld),nt.ray.direction.set(0,0,-1).applyMatrix4(tempMatrix),nt.intersectObjects(dt,!0)},[st,nt]);useFrame(()=>{var ht;if(st.size!==0)for(const dt of it){if(!((ht=dt.inputSource)!=null&&ht.handedness))return;const ft=ot[dt.inputSource.handedness],pt=new Set;let mt=ct(dt.controller);if(_e.filter)mt=_e.filter(mt,rt());else{const gt=mt.find(vt=>vt==null?void 0:vt.object);gt&&(mt=[gt])}for(const gt of mt){let vt=gt.object;for(;vt;){if(lt(vt,"onHover")&&!ft.has(vt)){const yt=at(vt,"onHover");for(const xt of yt)xt({target:dt,intersection:gt,intersections:mt})}const At=at(vt,"onMove");At==null||At.forEach(yt=>yt({target:dt,intersection:gt,intersections:mt})),ft.set(vt,gt),pt.add(vt.id),vt=vt.parent}}for(const gt of ft.keys())if(!pt.has(gt.id)){ft.delete(gt);const vt=at(gt,"onBlur");if(!vt)continue;for(const At of vt)At({target:dt,intersections:mt})}}});const ut=reactExports.useCallback(ht=>dt=>{var ft;if(!((ft=dt.target.inputSource)!=null&&ft.handedness))return;const pt=ot[dt.target.inputSource.handedness],mt=Array.from(new Set(pt.values()));st.forEach((gt,vt)=>{var At,yt,xt;if(pt.has(vt)){if(!gt[ht])return;for(const _t of gt[ht])(At=_t.current)==null||At.call(_t,{target:dt.target,intersection:pt.get(vt),intersections:mt})}else if(ht==="onSelect"&&gt.onSelectMissed)for(const _t of gt.onSelectMissed)(yt=_t.current)==null||yt.call(_t,{target:dt.target,intersections:mt});else if(ht==="onSqueeze"&&gt.onSqueezeMissed)for(const _t of gt.onSqueezeMissed)(xt=_t.current)==null||xt.call(_t,{target:dt.target,intersections:mt})})},[ot,st]);return useXREvent("select",ut("onSelect")),useXREvent("selectstart",ut("onSelectStart")),useXREvent("selectend",ut("onSelectEnd")),useXREvent("squeeze",ut("onSqueeze")),useXREvent("squeezeend",ut("onSqueezeEnd")),useXREvent("squeezestart",ut("onSqueezeStart")),reactExports.createElement(reactExports.Fragment,null,tt)}function useInteraction(tt,_e,rt){const nt=useXR(ot=>ot.addInteraction),it=useXR(ot=>ot.removeInteraction),st=useCallbackRef$2(rt);useIsomorphicLayoutEffect(()=>{const ot=tt.current;if(!(!ot||!st.current))return nt(ot,_e,st),()=>it(ot,_e,st)},[tt,_e,nt,it])}const Interactive=reactExports.forwardRef(function({onHover:_e,onBlur:rt,onSelectStart:nt,onSelectEnd:it,onSelectMissed:st,onSelect:ot,onSqueezeStart:lt,onSqueezeEnd:at,onSqueezeMissed:ct,onSqueeze:ut,onMove:ht,children:dt},ft){const pt=reactExports.useRef(null);return reactExports.useImperativeHandle(ft,()=>pt.current),useInteraction(pt,"onHover",_e),useInteraction(pt,"onBlur",rt),useInteraction(pt,"onSelectStart",nt),useInteraction(pt,"onSelectEnd",it),useInteraction(pt,"onSelectMissed",st),useInteraction(pt,"onSelect",ot),useInteraction(pt,"onSqueezeStart",lt),useInteraction(pt,"onSqueezeEnd",at),useInteraction(pt,"onSqueezeMissed",ct),useInteraction(pt,"onSqueeze",ut),useInteraction(pt,"onMove",ht),reactExports.createElement("group",{ref:pt},dt)}),RayGrab=reactExports.forwardRef(function({onSelectStart:_e,onSelectEnd:rt,children:nt,...it},st){const ot=reactExports.useRef(),lt=reactExports.useRef(null),at=reactExports.useMemo(()=>new Matrix4,[]);return reactExports.useImperativeHandle(st,()=>lt.current),useFrame(()=>{const ct=ot.current,ut=lt.current;ct&&(ut.applyMatrix4(at),ut.applyMatrix4(ct.matrixWorld),ut.updateMatrixWorld(),at.copy(ct.matrixWorld).invert())}),reactExports.createElement(Interactive,{ref:lt,onSelectStart:ct=>{ot.current=ct.target.controller,at.copy(ct.target.controller.matrixWorld).invert(),_e==null||_e(ct)},onSelectEnd:ct=>{ct.target.controller===ot.current&&(ot.current=void 0),rt==null||rt(ct)},...it},nt)}),XRContext=reactExports.createContext(null),globalSessionStore=create((tt,_e)=>({set:tt,get:_e,session:null,referenceSpaceType:null}));function XRManager({foveation:tt=0,frameRate:_e=void 0,referenceSpace:rt="local-floor",onSessionStart:nt,onSessionEnd:it,onVisibilityChange:st,onInputSourcesChange:ot,children:lt}){const at=useThree(yt=>yt.gl),ct=useThree(yt=>yt.camera),ut=useXR(yt=>yt.player),ht=useXR(yt=>yt.get),dt=useXR(yt=>yt.set),ft=useXR(yt=>yt.session),pt=useXR(yt=>yt.controllers),mt=useCallbackRef$2(nt),gt=useCallbackRef$2(it),vt=useCallbackRef$2(st),At=useCallbackRef$2(ot);return useIsomorphicLayoutEffect(()=>{const yt=[0,1].map(xt=>{const _t=new XRController(xt,at),Et=()=>dt(wt=>({controllers:[...wt.controllers,_t]})),bt=()=>dt(wt=>({controllers:wt.controllers.filter(Tt=>Tt!==_t)}));return _t.addEventListener("connected",Et),_t.addEventListener("disconnected",bt),()=>{_t.removeEventListener("connected",Et),_t.removeEventListener("disconnected",bt)}});return()=>yt.forEach(xt=>xt())},[at,dt]),useIsomorphicLayoutEffect(()=>globalSessionStore.subscribe(({session:yt})=>dt(()=>({session:yt}))),[at.xr,dt]),useIsomorphicLayoutEffect(()=>{at.xr.setFoveation(tt),dt(()=>({foveation:tt}))},[at.xr,tt,dt]),useIsomorphicLayoutEffect(()=>{var yt;try{_e&&((yt=ft==null?void 0:ft.updateTargetFrameRate)==null||yt.call(ft,_e))}catch{}dt(()=>({frameRate:_e}))},[ft,_e,dt]),useIsomorphicLayoutEffect(()=>{const yt=globalSessionStore.getState();at.xr.setReferenceSpaceType(rt),dt(()=>({referenceSpace:rt})),yt.set({referenceSpaceType:rt})},[at.xr,rt,dt]),useIsomorphicLayoutEffect(()=>{if(!ft)return void at.xr.setSession(null);const yt=bt=>{var wt;dt(()=>({isPresenting:!0})),(wt=mt.current)==null||wt.call(mt,{nativeEvent:{...bt,target:ft},target:ft})},xt=bt=>{var wt;dt(()=>({isPresenting:!1,session:null})),globalSessionStore.setState(()=>({session:null})),(wt=gt.current)==null||wt.call(gt,{nativeEvent:{...bt,target:ft},target:ft})},_t=bt=>{var wt;(wt=vt.current)==null||wt.call(vt,{nativeEvent:bt,target:ft})},Et=bt=>{var wt;const Tt=Object.values(ft.inputSources).some(Mt=>Mt.hand);dt(()=>({isHandTracking:Tt})),(wt=At.current)==null||wt.call(At,{nativeEvent:bt,target:ft})};return at.xr.addEventListener("sessionstart",yt),at.xr.addEventListener("sessionend",xt),ft.addEventListener("visibilitychange",_t),ft.addEventListener("inputsourceschange",Et),at.xr.setSession(ft).then(()=>{at.xr.setFoveation(ht().foveation)}),()=>{at.xr.removeEventListener("sessionstart",yt),at.xr.removeEventListener("sessionend",xt),ft.removeEventListener("visibilitychange",_t),ft.removeEventListener("inputsourceschange",Et)}},[ft,at.xr,dt,ht]),reactExports.createElement(InteractionManager,null,reactExports.createElement("primitive",{object:ut},reactExports.createElement("primitive",{object:ct}),pt.map(yt=>reactExports.createElement("primitive",{key:yt.index,object:yt}))),lt)}function XR(tt){const _e=reactExports.useMemo(()=>create((rt,nt)=>({set:rt,get:nt,controllers:[],isPresenting:!1,isHandTracking:!1,player:new Group,session:null,foveation:0,referenceSpace:"local-floor",hoverState:{left:new Map,right:new Map,none:new Map},interactions:new Map,hasInteraction(it,st){var ot;return!!((ot=nt().interactions.get(it))!=null&&ot[st].some(lt=>lt.current))},getInteraction(it,st){var ot;return(ot=nt().interactions.get(it))==null?void 0:ot[st].reduce((lt,at)=>(at.current&&lt.push(at.current),lt),[])},addInteraction(it,st,ot){const lt=nt().interactions;lt.has(it)||lt.set(it,{onHover:[],onBlur:[],onSelect:[],onSelectEnd:[],onSelectStart:[],onSelectMissed:[],onSqueeze:[],onSqueezeEnd:[],onSqueezeStart:[],onSqueezeMissed:[],onMove:[]}),lt.get(it)[st].push(ot)},removeInteraction(it,st,ot){const lt=nt().interactions.get(it);if(lt){const at=lt[st].indexOf(ot);at!==-1&&lt[st].splice(at,1)}}})),[]);return reactExports.createElement(XRContext.Provider,{value:_e},reactExports.createElement(XRManager,{...tt}))}const getSessionOptions=(tt,_e)=>{var rt;if(!(!tt&&!_e))return tt&&!_e?{optionalFeatures:[tt]}:tt&&_e?{..._e,optionalFeatures:uniq$1([...(rt=_e.optionalFeatures)!=null?rt:[],tt])}:_e},startSession=async(tt,_e)=>{const rt=globalSessionStore.getState();if(rt.session){console.warn("@react-three/xr: session already started, please stop it first");return}const nt=getSessionOptions(rt.referenceSpaceType,_e),it=await navigator.xr.requestSession(tt,nt);return rt.set(()=>({session:it})),it},stopSession=async()=>{const tt=globalSessionStore.getState();if(!tt.session){console.warn("@react-three/xr: no session to stop, please start it first");return}await tt.session.end(),tt.set({session:null})},toggleSession=async(tt,{sessionInit:_e,enterOnly:rt,exitOnly:nt}={})=>{const it=globalSessionStore.getState();if(!(it.session&&rt)&&!(!it.session&&nt))return it.session?await stopSession():await startSession(tt,_e)},getLabel=(tt,_e,rt)=>{switch(tt){case"entered":return`Exit ${_e}`;case"exited":return`Enter ${_e}`;case"unsupported":default:switch(rt){case"https":return"HTTPS needed";case"security":return`${_e} blocked`;case"unknown":default:return`${_e} unsupported`}}},XRButton=reactExports.forwardRef(function({mode:_e,sessionInit:rt,enterOnly:nt=!1,exitOnly:it=!1,onClick:st,onError:ot,children:lt,...at},ct){var ut;const[ht,dt]=reactExports.useState("exited"),[ft,pt]=reactExports.useState("unknown"),mt=getLabel(ht,_e,ft),gt=_e==="inline"?_e:`immersive-${_e.toLowerCase()}`,vt=useCallbackRef$2(ot);useIsomorphicLayoutEffect(()=>{if(!(navigator!=null&&navigator.xr))return void dt("unsupported");navigator.xr.isSessionSupported(gt).then(yt=>{if(yt)dt("exited");else{const xt=location.protocol==="https:";dt("unsupported"),pt(xt?"unknown":"https")}}).catch(yt=>{dt("unsupported"),"name"in yt&&yt.name==="SecurityError"?pt("security"):pt("unknown")})},[gt]),useIsomorphicLayoutEffect(()=>globalSessionStore.subscribe(yt=>{yt.session?dt("entered"):ht!=="unsupported"&&dt("exited")}),[ht]);const At=reactExports.useCallback(async yt=>{st==null||st(yt);try{toggleSession(gt,{sessionInit:rt,enterOnly:nt,exitOnly:it})}catch(xt){const _t=vt.current;if(_t&&xt instanceof Error)_t(xt);else throw xt}},[st,gt,rt,nt,it,vt]);return reactExports.createElement("button",{...at,ref:ct,onClick:ht==="unsupported"?st:At},(ut=typeof lt=="function"?lt(ht):lt)!=null?ut:mt)}),buttonStyles={position:"absolute",bottom:"24px",left:"50%",transform:"translateX(-50%)",padding:"12px 24px",border:"1px solid white",borderRadius:"4px",background:"rgba(0, 0, 0, 0.1)",color:"white",font:"normal 0.8125rem sans-serif",outline:"none",zIndex:99999,cursor:"pointer"};reactExports.forwardRef(({style:tt=buttonStyles,sessionInit:_e={domOverlay:typeof document<"u"?{root:document.body}:void 0,optionalFeatures:["hit-test","dom-overlay","dom-overlay-for-handheld-ar"]},children:rt,...nt},it)=>reactExports.createElement(XRButton,{...nt,ref:it,mode:"AR",style:tt,sessionInit:_e},rt));const VRButton$1=reactExports.forwardRef(({style:tt=buttonStyles,sessionInit:_e={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]},children:rt,...nt},it)=>reactExports.createElement(XRButton,{...nt,ref:it,mode:"VR",style:tt,sessionInit:_e},rt));function useXR(tt=rt=>rt,_e){const rt=reactExports.useContext(XRContext);if(!rt)throw new Error("useXR must be used within an <XR /> component!");return rt(tt,_e)}var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(tt,_e){for(var rt=new u16(31),nt=0;nt<31;++nt)rt[nt]=_e+=1<<tt[nt-1];for(var it=new u32(rt[30]),nt=1;nt<30;++nt)for(var st=rt[nt];st<rt[nt+1];++st)it[st]=st-rt[nt]<<5|nt;return[rt,it]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b[0],rev=new u16(32768);for(var i$5=0;i$5<32768;++i$5){var x$3=(i$5&43690)>>>1|(i$5&21845)<<1;x$3=(x$3&52428)>>>2|(x$3&13107)<<2,x$3=(x$3&61680)>>>4|(x$3&3855)<<4,rev[i$5]=((x$3&65280)>>>8|(x$3&255)<<8)>>>1}var hMap=function(tt,_e,rt){for(var nt=tt.length,it=0,st=new u16(_e);it<nt;++it)++st[tt[it]-1];var ot=new u16(_e);for(it=0;it<_e;++it)ot[it]=ot[it-1]+st[it-1]<<1;var lt;if(rt){lt=new u16(1<<_e);var at=15-_e;for(it=0;it<nt;++it)if(tt[it])for(var ct=it<<4|tt[it],ut=_e-tt[it],ht=ot[tt[it]-1]++<<ut,dt=ht|(1<<ut)-1;ht<=dt;++ht)lt[rev[ht]>>>at]=ct}else for(lt=new u16(nt),it=0;it<nt;++it)tt[it]&&(lt[it]=rev[ot[tt[it]-1]++]>>>15-tt[it]);return lt},flt=new u8(288);for(var i$5=0;i$5<144;++i$5)flt[i$5]=8;for(var i$5=144;i$5<256;++i$5)flt[i$5]=9;for(var i$5=256;i$5<280;++i$5)flt[i$5]=7;for(var i$5=280;i$5<288;++i$5)flt[i$5]=8;var fdt=new u8(32);for(var i$5=0;i$5<32;++i$5)fdt[i$5]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(tt){for(var _e=tt[0],rt=1;rt<tt.length;++rt)tt[rt]>_e&&(_e=tt[rt]);return _e},bits=function(tt,_e,rt){var nt=_e/8|0;return(tt[nt]|tt[nt+1]<<8)>>(_e&7)&rt},bits16=function(tt,_e){var rt=_e/8|0;return(tt[rt]|tt[rt+1]<<8|tt[rt+2]<<16)>>(_e&7)},shft=function(tt){return(tt/8|0)+(tt&7&&1)},slc=function(tt,_e,rt){(_e==null||_e<0)&&(_e=0),(rt==null||rt>tt.length)&&(rt=tt.length);var nt=new(tt instanceof u16?u16:tt instanceof u32?u32:u8)(rt-_e);return nt.set(tt.subarray(_e,rt)),nt},inflt=function(tt,_e,rt){var nt=tt.length;if(!nt||rt&&!rt.l&&nt<5)return _e||new u8(0);var it=!_e||rt,st=!rt||rt.i;rt||(rt={}),_e||(_e=new u8(nt*3));var ot=function(Kt){var rr=_e.length;if(Kt>rr){var ur=new u8(Math.max(rr*2,Kt));ur.set(_e),_e=ur}},lt=rt.f||0,at=rt.p||0,ct=rt.b||0,ut=rt.l,ht=rt.d,dt=rt.m,ft=rt.n,pt=nt*8;do{if(!ut){rt.f=lt=bits(tt,at,1);var mt=bits(tt,at+1,3);if(at+=3,mt)if(mt==1)ut=flrm,ht=fdrm,dt=9,ft=5;else if(mt==2){var yt=bits(tt,at,31)+257,xt=bits(tt,at+10,15)+4,_t=yt+bits(tt,at+5,31)+1;at+=14;for(var Et=new u8(_t),bt=new u8(19),wt=0;wt<xt;++wt)bt[clim[wt]]=bits(tt,at+wt*3,7);at+=xt*3;for(var Tt=max(bt),Mt=(1<<Tt)-1,Pt=hMap(bt,Tt,1),wt=0;wt<_t;){var It=Pt[bits(tt,at,Mt)];at+=It&15;var gt=It>>>4;if(gt<16)Et[wt++]=gt;else{var Ot=0,Bt=0;for(gt==16?(Bt=3+bits(tt,at,3),at+=2,Ot=Et[wt-1]):gt==17?(Bt=3+bits(tt,at,7),at+=3):gt==18&&(Bt=11+bits(tt,at,127),at+=7);Bt--;)Et[wt++]=Ot}}var Ut=Et.subarray(0,yt),Ft=Et.subarray(yt);dt=max(Ut),ft=max(Ft),ut=hMap(Ut,dt,1),ht=hMap(Ft,ft,1)}else throw"invalid block type";else{var gt=shft(at)+4,vt=tt[gt-4]|tt[gt-3]<<8,At=gt+vt;if(At>nt){if(st)throw"unexpected EOF";break}it&&ot(ct+vt),_e.set(tt.subarray(gt,At),ct),rt.b=ct+=vt,rt.p=at=At*8;continue}if(at>pt){if(st)throw"unexpected EOF";break}}it&&ot(ct+131072);for(var jt=(1<<dt)-1,Dt=(1<<ft)-1,Gt=at;;Gt=at){var Ot=ut[bits16(tt,at)&jt],zt=Ot>>>4;if(at+=Ot&15,at>pt){if(st)throw"unexpected EOF";break}if(!Ot)throw"invalid length/literal";if(zt<256)_e[ct++]=zt;else if(zt==256){Gt=at,ut=null;break}else{var $t=zt-254;if(zt>264){var wt=zt-257,Ht=fleb[wt];$t=bits(tt,at,(1<<Ht)-1)+fl[wt],at+=Ht}var er=ht[bits16(tt,at)&Dt],Zt=er>>>4;if(!er)throw"invalid distance";at+=er&15;var Ft=fd[Zt];if(Zt>3){var Ht=fdeb[Zt];Ft+=bits16(tt,at)&(1<<Ht)-1,at+=Ht}if(at>pt){if(st)throw"unexpected EOF";break}it&&ot(ct+131072);for(var or=ct+$t;ct<or;ct+=4)_e[ct]=_e[ct-Ft],_e[ct+1]=_e[ct+1-Ft],_e[ct+2]=_e[ct+2-Ft],_e[ct+3]=_e[ct+3-Ft];ct=or}}rt.l=ut,rt.p=Gt,rt.b=ct,ut&&(lt=1,rt.m=dt,rt.d=ht,rt.n=ft)}while(!lt);return ct==_e.length?_e:slc(_e,0,ct)},et=new u8(0),zlv=function(tt){if((tt[0]&15)!=8||tt[0]>>>4>7||(tt[0]<<8|tt[1])%31)throw"invalid zlib data";if(tt[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function unzlibSync(tt,_e){return inflt((zlv(tt),tt.subarray(2,-4)),_e)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch{}function CharsetEncoder(){}CharsetEncoder.prototype.s2u=function(tt){for(var _e=this.s2uTable,rt="",nt=0;nt<tt.length;){var it=tt[nt++];if(!(it>=0&&it<=126||it>=161&&it<=223)&&nt<tt.length&&(it=it<<8|tt[nt++]),_e[it]===void 0)return console.error("unknown char code "+it+"."),rt;rt+=String.fromCharCode(_e[it])}return rt};CharsetEncoder.prototype.s2uTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:65340,33120:65374,33121:8741,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:65293,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:65504,33170:65505,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:65506,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34624:9312,34625:9313,34626:9314,34627:9315,34628:9316,34629:9317,34630:9318,34631:9319,34632:9320,34633:9321,34634:9322,34635:9323,34636:9324,34637:9325,34638:9326,34639:9327,34640:9328,34641:9329,34642:9330,34643:9331,34644:8544,34645:8545,34646:8546,34647:8547,34648:8548,34649:8549,34650:8550,34651:8551,34652:8552,34653:8553,34655:13129,34656:13076,34657:13090,34658:13133,34659:13080,34660:13095,34661:13059,34662:13110,34663:13137,34664:13143,34665:13069,34666:13094,34667:13091,34668:13099,34669:13130,34670:13115,34671:13212,34672:13213,34673:13214,34674:13198,34675:13199,34676:13252,34677:13217,34686:13179,34688:12317,34689:12319,34690:8470,34691:13261,34692:8481,34693:12964,34694:12965,34695:12966,34696:12967,34697:12968,34698:12849,34699:12850,34700:12857,34701:13182,34702:13181,34703:13180,34704:8786,34705:8801,34706:8747,34707:8750,34708:8721,34709:8730,34710:8869,34711:8736,34712:8735,34713:8895,34714:8757,34715:8745,34716:8746,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081,60736:32394,60737:35100,60738:37704,60739:37512,60740:34012,60741:20425,60742:28859,60743:26161,60744:26824,60745:37625,60746:26363,60747:24389,60748:20008,60749:20193,60750:20220,60751:20224,60752:20227,60753:20281,60754:20310,60755:20370,60756:20362,60757:20378,60758:20372,60759:20429,60760:20544,60761:20514,60762:20479,60763:20510,60764:20550,60765:20592,60766:20546,60767:20628,60768:20724,60769:20696,60770:20810,60771:20836,60772:20893,60773:20926,60774:20972,60775:21013,60776:21148,60777:21158,60778:21184,60779:21211,60780:21248,60781:21255,60782:21284,60783:21362,60784:21395,60785:21426,60786:21469,60787:64014,60788:21660,60789:21642,60790:21673,60791:21759,60792:21894,60793:22361,60794:22373,60795:22444,60796:22472,60797:22471,60798:64015,60800:64016,60801:22686,60802:22706,60803:22795,60804:22867,60805:22875,60806:22877,60807:22883,60808:22948,60809:22970,60810:23382,60811:23488,60812:29999,60813:23512,60814:23532,60815:23582,60816:23718,60817:23738,60818:23797,60819:23847,60820:23891,60821:64017,60822:23874,60823:23917,60824:23992,60825:23993,60826:24016,60827:24353,60828:24372,60829:24423,60830:24503,60831:24542,60832:24669,60833:24709,60834:24714,60835:24798,60836:24789,60837:24864,60838:24818,60839:24849,60840:24887,60841:24880,60842:24984,60843:25107,60844:25254,60845:25589,60846:25696,60847:25757,60848:25806,60849:25934,60850:26112,60851:26133,60852:26171,60853:26121,60854:26158,60855:26142,60856:26148,60857:26213,60858:26199,60859:26201,60860:64018,60861:26227,60862:26265,60863:26272,60864:26290,60865:26303,60866:26362,60867:26382,60868:63785,60869:26470,60870:26555,60871:26706,60872:26560,60873:26625,60874:26692,60875:26831,60876:64019,60877:26984,60878:64020,60879:27032,60880:27106,60881:27184,60882:27243,60883:27206,60884:27251,60885:27262,60886:27362,60887:27364,60888:27606,60889:27711,60890:27740,60891:27782,60892:27759,60893:27866,60894:27908,60895:28039,60896:28015,60897:28054,60898:28076,60899:28111,60900:28152,60901:28146,60902:28156,60903:28217,60904:28252,60905:28199,60906:28220,60907:28351,60908:28552,60909:28597,60910:28661,60911:28677,60912:28679,60913:28712,60914:28805,60915:28843,60916:28943,60917:28932,60918:29020,60919:28998,60920:28999,60921:64021,60922:29121,60923:29182,60924:29361,60992:29374,60993:29476,60994:64022,60995:29559,60996:29629,60997:29641,60998:29654,60999:29667,61e3:29650,61001:29703,61002:29685,61003:29734,61004:29738,61005:29737,61006:29742,61007:29794,61008:29833,61009:29855,61010:29953,61011:30063,61012:30338,61013:30364,61014:30366,61015:30363,61016:30374,61017:64023,61018:30534,61019:21167,61020:30753,61021:30798,61022:30820,61023:30842,61024:31024,61025:64024,61026:64025,61027:64026,61028:31124,61029:64027,61030:31131,61031:31441,61032:31463,61033:64028,61034:31467,61035:31646,61036:64029,61037:32072,61038:32092,61039:32183,61040:32160,61041:32214,61042:32338,61043:32583,61044:32673,61045:64030,61046:33537,61047:33634,61048:33663,61049:33735,61050:33782,61051:33864,61052:33972,61053:34131,61054:34137,61056:34155,61057:64031,61058:34224,61059:64032,61060:64033,61061:34823,61062:35061,61063:35346,61064:35383,61065:35449,61066:35495,61067:35518,61068:35551,61069:64034,61070:35574,61071:35667,61072:35711,61073:36080,61074:36084,61075:36114,61076:36214,61077:64035,61078:36559,61079:64036,61080:64037,61081:36967,61082:37086,61083:64038,61084:37141,61085:37159,61086:37338,61087:37335,61088:37342,61089:37357,61090:37358,61091:37348,61092:37349,61093:37382,61094:37392,61095:37386,61096:37434,61097:37440,61098:37436,61099:37454,61100:37465,61101:37457,61102:37433,61103:37479,61104:37543,61105:37495,61106:37496,61107:37607,61108:37591,61109:37593,61110:37584,61111:64039,61112:37589,61113:37600,61114:37587,61115:37669,61116:37665,61117:37627,61118:64040,61119:37662,61120:37631,61121:37661,61122:37634,61123:37744,61124:37719,61125:37796,61126:37830,61127:37854,61128:37880,61129:37937,61130:37957,61131:37960,61132:38290,61133:63964,61134:64041,61135:38557,61136:38575,61137:38707,61138:38715,61139:38723,61140:38733,61141:38735,61142:38737,61143:38741,61144:38999,61145:39013,61146:64042,61147:64043,61148:39207,61149:64044,61150:39326,61151:39502,61152:39641,61153:39644,61154:39797,61155:39794,61156:39823,61157:39857,61158:39867,61159:39936,61160:40304,61161:40299,61162:64045,61163:40473,61164:40657,61167:8560,61168:8561,61169:8562,61170:8563,61171:8564,61172:8565,61173:8566,61174:8567,61175:8568,61176:8569,61177:65506,61178:65508,61179:65287,61180:65282,61504:57344,61505:57345,61506:57346,61507:57347,61508:57348,61509:57349,61510:57350,61511:57351,61512:57352,61513:57353,61514:57354,61515:57355,61516:57356,61517:57357,61518:57358,61519:57359,61520:57360,61521:57361,61522:57362,61523:57363,61524:57364,61525:57365,61526:57366,61527:57367,61528:57368,61529:57369,61530:57370,61531:57371,61532:57372,61533:57373,61534:57374,61535:57375,61536:57376,61537:57377,61538:57378,61539:57379,61540:57380,61541:57381,61542:57382,61543:57383,61544:57384,61545:57385,61546:57386,61547:57387,61548:57388,61549:57389,61550:57390,61551:57391,61552:57392,61553:57393,61554:57394,61555:57395,61556:57396,61557:57397,61558:57398,61559:57399,61560:57400,61561:57401,61562:57402,61563:57403,61564:57404,61565:57405,61566:57406,61568:57407,61569:57408,61570:57409,61571:57410,61572:57411,61573:57412,61574:57413,61575:57414,61576:57415,61577:57416,61578:57417,61579:57418,61580:57419,61581:57420,61582:57421,61583:57422,61584:57423,61585:57424,61586:57425,61587:57426,61588:57427,61589:57428,61590:57429,61591:57430,61592:57431,61593:57432,61594:57433,61595:57434,61596:57435,61597:57436,61598:57437,61599:57438,61600:57439,61601:57440,61602:57441,61603:57442,61604:57443,61605:57444,61606:57445,61607:57446,61608:57447,61609:57448,61610:57449,61611:57450,61612:57451,61613:57452,61614:57453,61615:57454,61616:57455,61617:57456,61618:57457,61619:57458,61620:57459,61621:57460,61622:57461,61623:57462,61624:57463,61625:57464,61626:57465,61627:57466,61628:57467,61629:57468,61630:57469,61631:57470,61632:57471,61633:57472,61634:57473,61635:57474,61636:57475,61637:57476,61638:57477,61639:57478,61640:57479,61641:57480,61642:57481,61643:57482,61644:57483,61645:57484,61646:57485,61647:57486,61648:57487,61649:57488,61650:57489,61651:57490,61652:57491,61653:57492,61654:57493,61655:57494,61656:57495,61657:57496,61658:57497,61659:57498,61660:57499,61661:57500,61662:57501,61663:57502,61664:57503,61665:57504,61666:57505,61667:57506,61668:57507,61669:57508,61670:57509,61671:57510,61672:57511,61673:57512,61674:57513,61675:57514,61676:57515,61677:57516,61678:57517,61679:57518,61680:57519,61681:57520,61682:57521,61683:57522,61684:57523,61685:57524,61686:57525,61687:57526,61688:57527,61689:57528,61690:57529,61691:57530,61692:57531,61760:57532,61761:57533,61762:57534,61763:57535,61764:57536,61765:57537,61766:57538,61767:57539,61768:57540,61769:57541,61770:57542,61771:57543,61772:57544,61773:57545,61774:57546,61775:57547,61776:57548,61777:57549,61778:57550,61779:57551,61780:57552,61781:57553,61782:57554,61783:57555,61784:57556,61785:57557,61786:57558,61787:57559,61788:57560,61789:57561,61790:57562,61791:57563,61792:57564,61793:57565,61794:57566,61795:57567,61796:57568,61797:57569,61798:57570,61799:57571,61800:57572,61801:57573,61802:57574,61803:57575,61804:57576,61805:57577,61806:57578,61807:57579,61808:57580,61809:57581,61810:57582,61811:57583,61812:57584,61813:57585,61814:57586,61815:57587,61816:57588,61817:57589,61818:57590,61819:57591,61820:57592,61821:57593,61822:57594,61824:57595,61825:57596,61826:57597,61827:57598,61828:57599,61829:57600,61830:57601,61831:57602,61832:57603,61833:57604,61834:57605,61835:57606,61836:57607,61837:57608,61838:57609,61839:57610,61840:57611,61841:57612,61842:57613,61843:57614,61844:57615,61845:57616,61846:57617,61847:57618,61848:57619,61849:57620,61850:57621,61851:57622,61852:57623,61853:57624,61854:57625,61855:57626,61856:57627,61857:57628,61858:57629,61859:57630,61860:57631,61861:57632,61862:57633,61863:57634,61864:57635,61865:57636,61866:57637,61867:57638,61868:57639,61869:57640,61870:57641,61871:57642,61872:57643,61873:57644,61874:57645,61875:57646,61876:57647,61877:57648,61878:57649,61879:57650,61880:57651,61881:57652,61882:57653,61883:57654,61884:57655,61885:57656,61886:57657,61887:57658,61888:57659,61889:57660,61890:57661,61891:57662,61892:57663,61893:57664,61894:57665,61895:57666,61896:57667,61897:57668,61898:57669,61899:57670,61900:57671,61901:57672,61902:57673,61903:57674,61904:57675,61905:57676,61906:57677,61907:57678,61908:57679,61909:57680,61910:57681,61911:57682,61912:57683,61913:57684,61914:57685,61915:57686,61916:57687,61917:57688,61918:57689,61919:57690,61920:57691,61921:57692,61922:57693,61923:57694,61924:57695,61925:57696,61926:57697,61927:57698,61928:57699,61929:57700,61930:57701,61931:57702,61932:57703,61933:57704,61934:57705,61935:57706,61936:57707,61937:57708,61938:57709,61939:57710,61940:57711,61941:57712,61942:57713,61943:57714,61944:57715,61945:57716,61946:57717,61947:57718,61948:57719,62016:57720,62017:57721,62018:57722,62019:57723,62020:57724,62021:57725,62022:57726,62023:57727,62024:57728,62025:57729,62026:57730,62027:57731,62028:57732,62029:57733,62030:57734,62031:57735,62032:57736,62033:57737,62034:57738,62035:57739,62036:57740,62037:57741,62038:57742,62039:57743,62040:57744,62041:57745,62042:57746,62043:57747,62044:57748,62045:57749,62046:57750,62047:57751,62048:57752,62049:57753,62050:57754,62051:57755,62052:57756,62053:57757,62054:57758,62055:57759,62056:57760,62057:57761,62058:57762,62059:57763,62060:57764,62061:57765,62062:57766,62063:57767,62064:57768,62065:57769,62066:57770,62067:57771,62068:57772,62069:57773,62070:57774,62071:57775,62072:57776,62073:57777,62074:57778,62075:57779,62076:57780,62077:57781,62078:57782,62080:57783,62081:57784,62082:57785,62083:57786,62084:57787,62085:57788,62086:57789,62087:57790,62088:57791,62089:57792,62090:57793,62091:57794,62092:57795,62093:57796,62094:57797,62095:57798,62096:57799,62097:57800,62098:57801,62099:57802,62100:57803,62101:57804,62102:57805,62103:57806,62104:57807,62105:57808,62106:57809,62107:57810,62108:57811,62109:57812,62110:57813,62111:57814,62112:57815,62113:57816,62114:57817,62115:57818,62116:57819,62117:57820,62118:57821,62119:57822,62120:57823,62121:57824,62122:57825,62123:57826,62124:57827,62125:57828,62126:57829,62127:57830,62128:57831,62129:57832,62130:57833,62131:57834,62132:57835,62133:57836,62134:57837,62135:57838,62136:57839,62137:57840,62138:57841,62139:57842,62140:57843,62141:57844,62142:57845,62143:57846,62144:57847,62145:57848,62146:57849,62147:57850,62148:57851,62149:57852,62150:57853,62151:57854,62152:57855,62153:57856,62154:57857,62155:57858,62156:57859,62157:57860,62158:57861,62159:57862,62160:57863,62161:57864,62162:57865,62163:57866,62164:57867,62165:57868,62166:57869,62167:57870,62168:57871,62169:57872,62170:57873,62171:57874,62172:57875,62173:57876,62174:57877,62175:57878,62176:57879,62177:57880,62178:57881,62179:57882,62180:57883,62181:57884,62182:57885,62183:57886,62184:57887,62185:57888,62186:57889,62187:57890,62188:57891,62189:57892,62190:57893,62191:57894,62192:57895,62193:57896,62194:57897,62195:57898,62196:57899,62197:57900,62198:57901,62199:57902,62200:57903,62201:57904,62202:57905,62203:57906,62204:57907,62272:57908,62273:57909,62274:57910,62275:57911,62276:57912,62277:57913,62278:57914,62279:57915,62280:57916,62281:57917,62282:57918,62283:57919,62284:57920,62285:57921,62286:57922,62287:57923,62288:57924,62289:57925,62290:57926,62291:57927,62292:57928,62293:57929,62294:57930,62295:57931,62296:57932,62297:57933,62298:57934,62299:57935,62300:57936,62301:57937,62302:57938,62303:57939,62304:57940,62305:57941,62306:57942,62307:57943,62308:57944,62309:57945,62310:57946,62311:57947,62312:57948,62313:57949,62314:57950,62315:57951,62316:57952,62317:57953,62318:57954,62319:57955,62320:57956,62321:57957,62322:57958,62323:57959,62324:57960,62325:57961,62326:57962,62327:57963,62328:57964,62329:57965,62330:57966,62331:57967,62332:57968,62333:57969,62334:57970,62336:57971,62337:57972,62338:57973,62339:57974,62340:57975,62341:57976,62342:57977,62343:57978,62344:57979,62345:57980,62346:57981,62347:57982,62348:57983,62349:57984,62350:57985,62351:57986,62352:57987,62353:57988,62354:57989,62355:57990,62356:57991,62357:57992,62358:57993,62359:57994,62360:57995,62361:57996,62362:57997,62363:57998,62364:57999,62365:58e3,62366:58001,62367:58002,62368:58003,62369:58004,62370:58005,62371:58006,62372:58007,62373:58008,62374:58009,62375:58010,62376:58011,62377:58012,62378:58013,62379:58014,62380:58015,62381:58016,62382:58017,62383:58018,62384:58019,62385:58020,62386:58021,62387:58022,62388:58023,62389:58024,62390:58025,62391:58026,62392:58027,62393:58028,62394:58029,62395:58030,62396:58031,62397:58032,62398:58033,62399:58034,62400:58035,62401:58036,62402:58037,62403:58038,62404:58039,62405:58040,62406:58041,62407:58042,62408:58043,62409:58044,62410:58045,62411:58046,62412:58047,62413:58048,62414:58049,62415:58050,62416:58051,62417:58052,62418:58053,62419:58054,62420:58055,62421:58056,62422:58057,62423:58058,62424:58059,62425:58060,62426:58061,62427:58062,62428:58063,62429:58064,62430:58065,62431:58066,62432:58067,62433:58068,62434:58069,62435:58070,62436:58071,62437:58072,62438:58073,62439:58074,62440:58075,62441:58076,62442:58077,62443:58078,62444:58079,62445:58080,62446:58081,62447:58082,62448:58083,62449:58084,62450:58085,62451:58086,62452:58087,62453:58088,62454:58089,62455:58090,62456:58091,62457:58092,62458:58093,62459:58094,62460:58095,62528:58096,62529:58097,62530:58098,62531:58099,62532:58100,62533:58101,62534:58102,62535:58103,62536:58104,62537:58105,62538:58106,62539:58107,62540:58108,62541:58109,62542:58110,62543:58111,62544:58112,62545:58113,62546:58114,62547:58115,62548:58116,62549:58117,62550:58118,62551:58119,62552:58120,62553:58121,62554:58122,62555:58123,62556:58124,62557:58125,62558:58126,62559:58127,62560:58128,62561:58129,62562:58130,62563:58131,62564:58132,62565:58133,62566:58134,62567:58135,62568:58136,62569:58137,62570:58138,62571:58139,62572:58140,62573:58141,62574:58142,62575:58143,62576:58144,62577:58145,62578:58146,62579:58147,62580:58148,62581:58149,62582:58150,62583:58151,62584:58152,62585:58153,62586:58154,62587:58155,62588:58156,62589:58157,62590:58158,62592:58159,62593:58160,62594:58161,62595:58162,62596:58163,62597:58164,62598:58165,62599:58166,62600:58167,62601:58168,62602:58169,62603:58170,62604:58171,62605:58172,62606:58173,62607:58174,62608:58175,62609:58176,62610:58177,62611:58178,62612:58179,62613:58180,62614:58181,62615:58182,62616:58183,62617:58184,62618:58185,62619:58186,62620:58187,62621:58188,62622:58189,62623:58190,62624:58191,62625:58192,62626:58193,62627:58194,62628:58195,62629:58196,62630:58197,62631:58198,62632:58199,62633:58200,62634:58201,62635:58202,62636:58203,62637:58204,62638:58205,62639:58206,62640:58207,62641:58208,62642:58209,62643:58210,62644:58211,62645:58212,62646:58213,62647:58214,62648:58215,62649:58216,62650:58217,62651:58218,62652:58219,62653:58220,62654:58221,62655:58222,62656:58223,62657:58224,62658:58225,62659:58226,62660:58227,62661:58228,62662:58229,62663:58230,62664:58231,62665:58232,62666:58233,62667:58234,62668:58235,62669:58236,62670:58237,62671:58238,62672:58239,62673:58240,62674:58241,62675:58242,62676:58243,62677:58244,62678:58245,62679:58246,62680:58247,62681:58248,62682:58249,62683:58250,62684:58251,62685:58252,62686:58253,62687:58254,62688:58255,62689:58256,62690:58257,62691:58258,62692:58259,62693:58260,62694:58261,62695:58262,62696:58263,62697:58264,62698:58265,62699:58266,62700:58267,62701:58268,62702:58269,62703:58270,62704:58271,62705:58272,62706:58273,62707:58274,62708:58275,62709:58276,62710:58277,62711:58278,62712:58279,62713:58280,62714:58281,62715:58282,62716:58283,62784:58284,62785:58285,62786:58286,62787:58287,62788:58288,62789:58289,62790:58290,62791:58291,62792:58292,62793:58293,62794:58294,62795:58295,62796:58296,62797:58297,62798:58298,62799:58299,62800:58300,62801:58301,62802:58302,62803:58303,62804:58304,62805:58305,62806:58306,62807:58307,62808:58308,62809:58309,62810:58310,62811:58311,62812:58312,62813:58313,62814:58314,62815:58315,62816:58316,62817:58317,62818:58318,62819:58319,62820:58320,62821:58321,62822:58322,62823:58323,62824:58324,62825:58325,62826:58326,62827:58327,62828:58328,62829:58329,62830:58330,62831:58331,62832:58332,62833:58333,62834:58334,62835:58335,62836:58336,62837:58337,62838:58338,62839:58339,62840:58340,62841:58341,62842:58342,62843:58343,62844:58344,62845:58345,62846:58346,62848:58347,62849:58348,62850:58349,62851:58350,62852:58351,62853:58352,62854:58353,62855:58354,62856:58355,62857:58356,62858:58357,62859:58358,62860:58359,62861:58360,62862:58361,62863:58362,62864:58363,62865:58364,62866:58365,62867:58366,62868:58367,62869:58368,62870:58369,62871:58370,62872:58371,62873:58372,62874:58373,62875:58374,62876:58375,62877:58376,62878:58377,62879:58378,62880:58379,62881:58380,62882:58381,62883:58382,62884:58383,62885:58384,62886:58385,62887:58386,62888:58387,62889:58388,62890:58389,62891:58390,62892:58391,62893:58392,62894:58393,62895:58394,62896:58395,62897:58396,62898:58397,62899:58398,62900:58399,62901:58400,62902:58401,62903:58402,62904:58403,62905:58404,62906:58405,62907:58406,62908:58407,62909:58408,62910:58409,62911:58410,62912:58411,62913:58412,62914:58413,62915:58414,62916:58415,62917:58416,62918:58417,62919:58418,62920:58419,62921:58420,62922:58421,62923:58422,62924:58423,62925:58424,62926:58425,62927:58426,62928:58427,62929:58428,62930:58429,62931:58430,62932:58431,62933:58432,62934:58433,62935:58434,62936:58435,62937:58436,62938:58437,62939:58438,62940:58439,62941:58440,62942:58441,62943:58442,62944:58443,62945:58444,62946:58445,62947:58446,62948:58447,62949:58448,62950:58449,62951:58450,62952:58451,62953:58452,62954:58453,62955:58454,62956:58455,62957:58456,62958:58457,62959:58458,62960:58459,62961:58460,62962:58461,62963:58462,62964:58463,62965:58464,62966:58465,62967:58466,62968:58467,62969:58468,62970:58469,62971:58470,62972:58471,63040:58472,63041:58473,63042:58474,63043:58475,63044:58476,63045:58477,63046:58478,63047:58479,63048:58480,63049:58481,63050:58482,63051:58483,63052:58484,63053:58485,63054:58486,63055:58487,63056:58488,63057:58489,63058:58490,63059:58491,63060:58492,63061:58493,63062:58494,63063:58495,63064:58496,63065:58497,63066:58498,63067:58499,63068:58500,63069:58501,63070:58502,63071:58503,63072:58504,63073:58505,63074:58506,63075:58507,63076:58508,63077:58509,63078:58510,63079:58511,63080:58512,63081:58513,63082:58514,63083:58515,63084:58516,63085:58517,63086:58518,63087:58519,63088:58520,63089:58521,63090:58522,63091:58523,63092:58524,63093:58525,63094:58526,63095:58527,63096:58528,63097:58529,63098:58530,63099:58531,63100:58532,63101:58533,63102:58534,63104:58535,63105:58536,63106:58537,63107:58538,63108:58539,63109:58540,63110:58541,63111:58542,63112:58543,63113:58544,63114:58545,63115:58546,63116:58547,63117:58548,63118:58549,63119:58550,63120:58551,63121:58552,63122:58553,63123:58554,63124:58555,63125:58556,63126:58557,63127:58558,63128:58559,63129:58560,63130:58561,63131:58562,63132:58563,63133:58564,63134:58565,63135:58566,63136:58567,63137:58568,63138:58569,63139:58570,63140:58571,63141:58572,63142:58573,63143:58574,63144:58575,63145:58576,63146:58577,63147:58578,63148:58579,63149:58580,63150:58581,63151:58582,63152:58583,63153:58584,63154:58585,63155:58586,63156:58587,63157:58588,63158:58589,63159:58590,63160:58591,63161:58592,63162:58593,63163:58594,63164:58595,63165:58596,63166:58597,63167:58598,63168:58599,63169:58600,63170:58601,63171:58602,63172:58603,63173:58604,63174:58605,63175:58606,63176:58607,63177:58608,63178:58609,63179:58610,63180:58611,63181:58612,63182:58613,63183:58614,63184:58615,63185:58616,63186:58617,63187:58618,63188:58619,63189:58620,63190:58621,63191:58622,63192:58623,63193:58624,63194:58625,63195:58626,63196:58627,63197:58628,63198:58629,63199:58630,63200:58631,63201:58632,63202:58633,63203:58634,63204:58635,63205:58636,63206:58637,63207:58638,63208:58639,63209:58640,63210:58641,63211:58642,63212:58643,63213:58644,63214:58645,63215:58646,63216:58647,63217:58648,63218:58649,63219:58650,63220:58651,63221:58652,63222:58653,63223:58654,63224:58655,63225:58656,63226:58657,63227:58658,63228:58659,63296:58660,63297:58661,63298:58662,63299:58663,63300:58664,63301:58665,63302:58666,63303:58667,63304:58668,63305:58669,63306:58670,63307:58671,63308:58672,63309:58673,63310:58674,63311:58675,63312:58676,63313:58677,63314:58678,63315:58679,63316:58680,63317:58681,63318:58682,63319:58683,63320:58684,63321:58685,63322:58686,63323:58687,63324:58688,63325:58689,63326:58690,63327:58691,63328:58692,63329:58693,63330:58694,63331:58695,63332:58696,63333:58697,63334:58698,63335:58699,63336:58700,63337:58701,63338:58702,63339:58703,63340:58704,63341:58705,63342:58706,63343:58707,63344:58708,63345:58709,63346:58710,63347:58711,63348:58712,63349:58713,63350:58714,63351:58715,63352:58716,63353:58717,63354:58718,63355:58719,63356:58720,63357:58721,63358:58722,63360:58723,63361:58724,63362:58725,63363:58726,63364:58727,63365:58728,63366:58729,63367:58730,63368:58731,63369:58732,63370:58733,63371:58734,63372:58735,63373:58736,63374:58737,63375:58738,63376:58739,63377:58740,63378:58741,63379:58742,63380:58743,63381:58744,63382:58745,63383:58746,63384:58747,63385:58748,63386:58749,63387:58750,63388:58751,63389:58752,63390:58753,63391:58754,63392:58755,63393:58756,63394:58757,63395:58758,63396:58759,63397:58760,63398:58761,63399:58762,63400:58763,63401:58764,63402:58765,63403:58766,63404:58767,63405:58768,63406:58769,63407:58770,63408:58771,63409:58772,63410:58773,63411:58774,63412:58775,63413:58776,63414:58777,63415:58778,63416:58779,63417:58780,63418:58781,63419:58782,63420:58783,63421:58784,63422:58785,63423:58786,63424:58787,63425:58788,63426:58789,63427:58790,63428:58791,63429:58792,63430:58793,63431:58794,63432:58795,63433:58796,63434:58797,63435:58798,63436:58799,63437:58800,63438:58801,63439:58802,63440:58803,63441:58804,63442:58805,63443:58806,63444:58807,63445:58808,63446:58809,63447:58810,63448:58811,63449:58812,63450:58813,63451:58814,63452:58815,63453:58816,63454:58817,63455:58818,63456:58819,63457:58820,63458:58821,63459:58822,63460:58823,63461:58824,63462:58825,63463:58826,63464:58827,63465:58828,63466:58829,63467:58830,63468:58831,63469:58832,63470:58833,63471:58834,63472:58835,63473:58836,63474:58837,63475:58838,63476:58839,63477:58840,63478:58841,63479:58842,63480:58843,63481:58844,63482:58845,63483:58846,63484:58847,63552:58848,63553:58849,63554:58850,63555:58851,63556:58852,63557:58853,63558:58854,63559:58855,63560:58856,63561:58857,63562:58858,63563:58859,63564:58860,63565:58861,63566:58862,63567:58863,63568:58864,63569:58865,63570:58866,63571:58867,63572:58868,63573:58869,63574:58870,63575:58871,63576:58872,63577:58873,63578:58874,63579:58875,63580:58876,63581:58877,63582:58878,63583:58879,63584:58880,63585:58881,63586:58882,63587:58883,63588:58884,63589:58885,63590:58886,63591:58887,63592:58888,63593:58889,63594:58890,63595:58891,63596:58892,63597:58893,63598:58894,63599:58895,63600:58896,63601:58897,63602:58898,63603:58899,63604:58900,63605:58901,63606:58902,63607:58903,63608:58904,63609:58905,63610:58906,63611:58907,63612:58908,63613:58909,63614:58910,63616:58911,63617:58912,63618:58913,63619:58914,63620:58915,63621:58916,63622:58917,63623:58918,63624:58919,63625:58920,63626:58921,63627:58922,63628:58923,63629:58924,63630:58925,63631:58926,63632:58927,63633:58928,63634:58929,63635:58930,63636:58931,63637:58932,63638:58933,63639:58934,63640:58935,63641:58936,63642:58937,63643:58938,63644:58939,63645:58940,63646:58941,63647:58942,63648:58943,63649:58944,63650:58945,63651:58946,63652:58947,63653:58948,63654:58949,63655:58950,63656:58951,63657:58952,63658:58953,63659:58954,63660:58955,63661:58956,63662:58957,63663:58958,63664:58959,63665:58960,63666:58961,63667:58962,63668:58963,63669:58964,63670:58965,63671:58966,63672:58967,63673:58968,63674:58969,63675:58970,63676:58971,63677:58972,63678:58973,63679:58974,63680:58975,63681:58976,63682:58977,63683:58978,63684:58979,63685:58980,63686:58981,63687:58982,63688:58983,63689:58984,63690:58985,63691:58986,63692:58987,63693:58988,63694:58989,63695:58990,63696:58991,63697:58992,63698:58993,63699:58994,63700:58995,63701:58996,63702:58997,63703:58998,63704:58999,63705:59e3,63706:59001,63707:59002,63708:59003,63709:59004,63710:59005,63711:59006,63712:59007,63713:59008,63714:59009,63715:59010,63716:59011,63717:59012,63718:59013,63719:59014,63720:59015,63721:59016,63722:59017,63723:59018,63724:59019,63725:59020,63726:59021,63727:59022,63728:59023,63729:59024,63730:59025,63731:59026,63732:59027,63733:59028,63734:59029,63735:59030,63736:59031,63737:59032,63738:59033,63739:59034,63740:59035,64064:8560,64065:8561,64066:8562,64067:8563,64068:8564,64069:8565,64070:8566,64071:8567,64072:8568,64073:8569,64074:8544,64075:8545,64076:8546,64077:8547,64078:8548,64079:8549,64080:8550,64081:8551,64082:8552,64083:8553,64084:65506,64085:65508,64086:65287,64087:65282,64088:12849,64089:8470,64090:8481,64091:8757,64092:32394,64093:35100,64094:37704,64095:37512,64096:34012,64097:20425,64098:28859,64099:26161,64100:26824,64101:37625,64102:26363,64103:24389,64104:20008,64105:20193,64106:20220,64107:20224,64108:20227,64109:20281,64110:20310,64111:20370,64112:20362,64113:20378,64114:20372,64115:20429,64116:20544,64117:20514,64118:20479,64119:20510,64120:20550,64121:20592,64122:20546,64123:20628,64124:20724,64125:20696,64126:20810,64128:20836,64129:20893,64130:20926,64131:20972,64132:21013,64133:21148,64134:21158,64135:21184,64136:21211,64137:21248,64138:21255,64139:21284,64140:21362,64141:21395,64142:21426,64143:21469,64144:64014,64145:21660,64146:21642,64147:21673,64148:21759,64149:21894,64150:22361,64151:22373,64152:22444,64153:22472,64154:22471,64155:64015,64156:64016,64157:22686,64158:22706,64159:22795,64160:22867,64161:22875,64162:22877,64163:22883,64164:22948,64165:22970,64166:23382,64167:23488,64168:29999,64169:23512,64170:23532,64171:23582,64172:23718,64173:23738,64174:23797,64175:23847,64176:23891,64177:64017,64178:23874,64179:23917,64180:23992,64181:23993,64182:24016,64183:24353,64184:24372,64185:24423,64186:24503,64187:24542,64188:24669,64189:24709,64190:24714,64191:24798,64192:24789,64193:24864,64194:24818,64195:24849,64196:24887,64197:24880,64198:24984,64199:25107,64200:25254,64201:25589,64202:25696,64203:25757,64204:25806,64205:25934,64206:26112,64207:26133,64208:26171,64209:26121,64210:26158,64211:26142,64212:26148,64213:26213,64214:26199,64215:26201,64216:64018,64217:26227,64218:26265,64219:26272,64220:26290,64221:26303,64222:26362,64223:26382,64224:63785,64225:26470,64226:26555,64227:26706,64228:26560,64229:26625,64230:26692,64231:26831,64232:64019,64233:26984,64234:64020,64235:27032,64236:27106,64237:27184,64238:27243,64239:27206,64240:27251,64241:27262,64242:27362,64243:27364,64244:27606,64245:27711,64246:27740,64247:27782,64248:27759,64249:27866,64250:27908,64251:28039,64252:28015,64320:28054,64321:28076,64322:28111,64323:28152,64324:28146,64325:28156,64326:28217,64327:28252,64328:28199,64329:28220,64330:28351,64331:28552,64332:28597,64333:28661,64334:28677,64335:28679,64336:28712,64337:28805,64338:28843,64339:28943,64340:28932,64341:29020,64342:28998,64343:28999,64344:64021,64345:29121,64346:29182,64347:29361,64348:29374,64349:29476,64350:64022,64351:29559,64352:29629,64353:29641,64354:29654,64355:29667,64356:29650,64357:29703,64358:29685,64359:29734,64360:29738,64361:29737,64362:29742,64363:29794,64364:29833,64365:29855,64366:29953,64367:30063,64368:30338,64369:30364,64370:30366,64371:30363,64372:30374,64373:64023,64374:30534,64375:21167,64376:30753,64377:30798,64378:30820,64379:30842,64380:31024,64381:64024,64382:64025,64384:64026,64385:31124,64386:64027,64387:31131,64388:31441,64389:31463,64390:64028,64391:31467,64392:31646,64393:64029,64394:32072,64395:32092,64396:32183,64397:32160,64398:32214,64399:32338,64400:32583,64401:32673,64402:64030,64403:33537,64404:33634,64405:33663,64406:33735,64407:33782,64408:33864,64409:33972,64410:34131,64411:34137,64412:34155,64413:64031,64414:34224,64415:64032,64416:64033,64417:34823,64418:35061,64419:35346,64420:35383,64421:35449,64422:35495,64423:35518,64424:35551,64425:64034,64426:35574,64427:35667,64428:35711,64429:36080,64430:36084,64431:36114,64432:36214,64433:64035,64434:36559,64435:64036,64436:64037,64437:36967,64438:37086,64439:64038,64440:37141,64441:37159,64442:37338,64443:37335,64444:37342,64445:37357,64446:37358,64447:37348,64448:37349,64449:37382,64450:37392,64451:37386,64452:37434,64453:37440,64454:37436,64455:37454,64456:37465,64457:37457,64458:37433,64459:37479,64460:37543,64461:37495,64462:37496,64463:37607,64464:37591,64465:37593,64466:37584,64467:64039,64468:37589,64469:37600,64470:37587,64471:37669,64472:37665,64473:37627,64474:64040,64475:37662,64476:37631,64477:37661,64478:37634,64479:37744,64480:37719,64481:37796,64482:37830,64483:37854,64484:37880,64485:37937,64486:37957,64487:37960,64488:38290,64489:63964,64490:64041,64491:38557,64492:38575,64493:38707,64494:38715,64495:38723,64496:38733,64497:38735,64498:38737,64499:38741,64500:38999,64501:39013,64502:64042,64503:64043,64504:39207,64505:64044,64506:39326,64507:39502,64508:39641,64576:39644,64577:39797,64578:39794,64579:39823,64580:39857,64581:39867,64582:39936,64583:40304,64584:40299,64585:64045,64586:40473,64587:40657};function DataViewEx(tt,_e){this.dv=new DataView(tt),this.offset=0,this.littleEndian=_e!==void 0?_e:!0,this.encoder=new CharsetEncoder}DataViewEx.prototype={constructor:DataViewEx,getInt8:function(){var tt=this.dv.getInt8(this.offset);return this.offset+=1,tt},getInt8Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getInt8());return _e},getUint8:function(){var tt=this.dv.getUint8(this.offset);return this.offset+=1,tt},getUint8Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getUint8());return _e},getInt16:function(){var tt=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,tt},getInt16Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getInt16());return _e},getUint16:function(){var tt=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,tt},getUint16Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getUint16());return _e},getInt32:function(){var tt=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,tt},getInt32Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getInt32());return _e},getUint32:function(){var tt=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,tt},getUint32Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getUint32());return _e},getFloat32:function(){var tt=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,tt},getFloat32Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getFloat32());return _e},getFloat64:function(){var tt=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,tt},getFloat64Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getFloat64());return _e},getIndex:function(tt,_e){switch(tt){case 1:return _e===!0?this.getUint8():this.getInt8();case 2:return _e===!0?this.getUint16():this.getInt16();case 4:return this.getInt32();default:throw"unknown number type "+tt+" exception."}},getIndexArray:function(tt,_e,rt){for(var nt=[],it=0;it<_e;it++)nt.push(this.getIndex(tt,rt));return nt},getChars:function(tt){for(var _e="";tt>0;){var rt=this.getUint8();if(tt--,rt===0)break;_e+=String.fromCharCode(rt)}for(;tt>0;)this.getUint8(),tt--;return _e},getSjisStringsAsUnicode:function(tt){for(var _e=[];tt>0;){var rt=this.getUint8();if(tt--,rt===0)break;_e.push(rt)}for(;tt>0;)this.getUint8(),tt--;return this.encoder.s2u(new Uint8Array(_e))},getUnicodeStrings:function(tt){for(var _e="";tt>0;){var rt=this.getUint16();if(tt-=2,rt===0)break;_e+=String.fromCharCode(rt)}for(;tt>0;)this.getUint8(),tt--;return _e},getTextBuffer:function(){var tt=this.getUint32();return this.getUnicodeStrings(tt)}};function DataCreationHelper(){}DataCreationHelper.prototype={constructor:DataCreationHelper,leftToRightVector3:function(tt){tt[2]=-tt[2]},leftToRightQuaternion:function(tt){tt[0]=-tt[0],tt[1]=-tt[1]},leftToRightEuler:function(tt){tt[0]=-tt[0],tt[1]=-tt[1]},leftToRightIndexOrder:function(tt){var _e=tt[2];tt[2]=tt[0],tt[0]=_e},leftToRightVector3Range:function(tt,_e){var rt=-_e[2];_e[2]=-tt[2],tt[2]=rt},leftToRightEulerRange:function(tt,_e){var rt=-_e[0],nt=-_e[1];_e[0]=-tt[0],_e[1]=-tt[1],tt[0]=rt,tt[1]=nt}};const KHR_SUPERCOMPRESSION_NONE=0,KHR_SUPERCOMPRESSION_ZSTD=2,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT=0,KHR_DF_VENDORID_KHRONOS=0,KHR_DF_VERSION=2,KHR_DF_MODEL_UNSPECIFIED=0,KHR_DF_FLAG_ALPHA_STRAIGHT=0,KHR_DF_FLAG_ALPHA_PREMULTIPLIED=1,KHR_DF_TRANSFER_SRGB=2,KHR_DF_PRIMARIES_BT709=1,KHR_DF_SAMPLE_DATATYPE_SIGNED=64,VK_FORMAT_UNDEFINED=0,VK_FORMAT_R8_UNORM=9,VK_FORMAT_R8_SRGB=15,VK_FORMAT_R8G8_UNORM=16,VK_FORMAT_R8G8_SRGB=22,VK_FORMAT_R8G8B8A8_UNORM=37,VK_FORMAT_R8G8B8A8_SRGB=43,VK_FORMAT_R16_SFLOAT=76,VK_FORMAT_R16G16_SFLOAT=83,VK_FORMAT_R16G16B16A16_SFLOAT=97,VK_FORMAT_R32_SFLOAT=100,VK_FORMAT_R32G32_SFLOAT=103,VK_FORMAT_R32G32B32A32_SFLOAT=109;class KTX2Container{constructor(){this.vkFormat=VK_FORMAT_UNDEFINED,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=KHR_SUPERCOMPRESSION_NONE,this.levels=[],this.dataFormatDescriptor=[{vendorId:KHR_DF_VENDORID_KHRONOS,descriptorType:KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT,descriptorBlockSize:0,versionNumber:KHR_DF_VERSION,colorModel:KHR_DF_MODEL_UNSPECIFIED,colorPrimaries:KHR_DF_PRIMARIES_BT709,transferFunction:KHR_DF_TRANSFER_SRGB,flags:KHR_DF_FLAG_ALPHA_STRAIGHT,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class BufferReader{constructor(_e,rt,nt,it){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(_e.buffer,_e.byteOffset+rt,nt),this._littleEndian=it,this._offset=0}_nextUint8(){const _e=this._dataView.getUint8(this._offset);return this._offset+=1,_e}_nextUint16(){const _e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,_e}_nextUint32(){const _e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,_e}_nextUint64(){const _e=this._dataView.getUint32(this._offset,this._littleEndian),rt=this._dataView.getUint32(this._offset+4,this._littleEndian),nt=_e+2**32*rt;return this._offset+=8,nt}_nextInt32(){const _e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,_e}_skip(_e){return this._offset+=_e,this}_scan(_e,rt=0){const nt=this._offset;let it=0;for(;this._dataView.getUint8(this._offset)!==rt&&it<_e;)it++,this._offset++;return it<_e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+nt,it)}}const KTX2_ID=[171,75,84,88,32,50,48,187,13,10,26,10];function decodeText(tt){return typeof TextDecoder<"u"?new TextDecoder().decode(tt):Buffer.from(tt).toString("utf8")}function read(tt){const _e=new Uint8Array(tt.buffer,tt.byteOffset,KTX2_ID.length);if(_e[0]!==KTX2_ID[0]||_e[1]!==KTX2_ID[1]||_e[2]!==KTX2_ID[2]||_e[3]!==KTX2_ID[3]||_e[4]!==KTX2_ID[4]||_e[5]!==KTX2_ID[5]||_e[6]!==KTX2_ID[6]||_e[7]!==KTX2_ID[7]||_e[8]!==KTX2_ID[8]||_e[9]!==KTX2_ID[9]||_e[10]!==KTX2_ID[10]||_e[11]!==KTX2_ID[11])throw new Error("Missing KTX 2.0 identifier.");const rt=new KTX2Container,nt=17*Uint32Array.BYTES_PER_ELEMENT,it=new BufferReader(tt,KTX2_ID.length,nt,!0);rt.vkFormat=it._nextUint32(),rt.typeSize=it._nextUint32(),rt.pixelWidth=it._nextUint32(),rt.pixelHeight=it._nextUint32(),rt.pixelDepth=it._nextUint32(),rt.layerCount=it._nextUint32(),rt.faceCount=it._nextUint32();const st=it._nextUint32();rt.supercompressionScheme=it._nextUint32();const ot=it._nextUint32(),lt=it._nextUint32(),at=it._nextUint32(),ct=it._nextUint32(),ut=it._nextUint64(),ht=it._nextUint64(),dt=st*3*8,ft=new BufferReader(tt,KTX2_ID.length+nt,dt,!0);for(let zt=0;zt<st;zt++)rt.levels.push({levelData:new Uint8Array(tt.buffer,tt.byteOffset+ft._nextUint64(),ft._nextUint64()),uncompressedByteLength:ft._nextUint64()});const pt=new BufferReader(tt,ot,lt,!0),mt={vendorId:pt._skip(4)._nextUint16(),descriptorType:pt._nextUint16(),versionNumber:pt._nextUint16(),descriptorBlockSize:pt._nextUint16(),colorModel:pt._nextUint8(),colorPrimaries:pt._nextUint8(),transferFunction:pt._nextUint8(),flags:pt._nextUint8(),texelBlockDimension:[pt._nextUint8(),pt._nextUint8(),pt._nextUint8(),pt._nextUint8()],bytesPlane:[pt._nextUint8(),pt._nextUint8(),pt._nextUint8(),pt._nextUint8(),pt._nextUint8(),pt._nextUint8(),pt._nextUint8(),pt._nextUint8()],samples:[]},gt=6,vt=4,At=(mt.descriptorBlockSize/4-gt)/vt;for(let zt=0;zt<At;zt++){const $t={bitOffset:pt._nextUint16(),bitLength:pt._nextUint8(),channelType:pt._nextUint8(),samplePosition:[pt._nextUint8(),pt._nextUint8(),pt._nextUint8(),pt._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};$t.channelType&KHR_DF_SAMPLE_DATATYPE_SIGNED?($t.sampleLower=pt._nextInt32(),$t.sampleUpper=pt._nextInt32()):($t.sampleLower=pt._nextUint32(),$t.sampleUpper=pt._nextUint32()),mt.samples[zt]=$t}rt.dataFormatDescriptor.length=0,rt.dataFormatDescriptor.push(mt);const yt=new BufferReader(tt,at,ct,!0);for(;yt._offset<ct;){const zt=yt._nextUint32(),$t=yt._scan(zt),Ht=decodeText($t),er=yt._scan(zt-$t.byteLength);rt.keyValue[Ht]=Ht.match(/^ktx/i)?decodeText(er):er,yt._offset%4&&yt._skip(4-yt._offset%4)}if(ht<=0)return rt;const xt=new BufferReader(tt,ut,ht,!0),_t=xt._nextUint16(),Et=xt._nextUint16(),bt=xt._nextUint32(),wt=xt._nextUint32(),Tt=xt._nextUint32(),Mt=xt._nextUint32(),Pt=[];for(let zt=0;zt<st;zt++)Pt.push({imageFlags:xt._nextUint32(),rgbSliceByteOffset:xt._nextUint32(),rgbSliceByteLength:xt._nextUint32(),alphaSliceByteOffset:xt._nextUint32(),alphaSliceByteLength:xt._nextUint32()});const It=ut+xt._offset,Ot=It+bt,Bt=Ot+wt,Ut=Bt+Tt,Ft=new Uint8Array(tt.buffer,tt.byteOffset+It,bt),jt=new Uint8Array(tt.buffer,tt.byteOffset+Ot,wt),Dt=new Uint8Array(tt.buffer,tt.byteOffset+Bt,Tt),Gt=new Uint8Array(tt.buffer,tt.byteOffset+Ut,Mt);return rt.globalData={endpointCount:_t,selectorCount:Et,imageDescs:Pt,endpointsData:Ft,selectorsData:jt,tablesData:Dt,extendedData:Gt},rt}let A$1,I$3,B$1;const g$4={env:{emscripten_notify_memory_growth:function(tt){B$1=new Uint8Array(I$3.exports.memory.buffer)}}};let Q$1=class{init(){return A$1||(A$1=typeof fetch<"u"?fetch("data:application/wasm;base64,"+C$1).then(_e=>_e.arrayBuffer()).then(_e=>WebAssembly.instantiate(_e,g$4)).then(this._init):WebAssembly.instantiate(Buffer.from(C$1,"base64"),g$4).then(this._init),A$1)}_init(_e){I$3=_e.instance,g$4.env.emscripten_notify_memory_growth(0)}decode(_e,rt=0){if(!I$3)throw new Error("ZSTDDecoder: Await .init() before decoding.");const nt=_e.byteLength,it=I$3.exports.malloc(nt);B$1.set(_e,it),rt=rt||Number(I$3.exports.ZSTD_findDecompressedSize(it,nt));const st=I$3.exports.malloc(rt),ot=I$3.exports.ZSTD_decompress(st,rt,it,nt),lt=B$1.slice(st,st+ot);return I$3.exports.free(it),I$3.exports.free(st),lt}};const C$1="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ";/*! https://mths.be/codepointat v0.2.0 by @mathias */String.prototype.codePointAt||function(){var tt=function(){try{var rt={},nt=Object.defineProperty,it=nt(rt,rt,rt)&&nt}catch{}return it}(),_e=function(rt){if(this==null)throw TypeError();var nt=String(this),it=nt.length,st=rt?Number(rt):0;if(st!=st&&(st=0),!(st<0||st>=it)){var ot=nt.charCodeAt(st),lt;return ot>=55296&&ot<=56319&&it>st+1&&(lt=nt.charCodeAt(st+1),lt>=56320&&lt<=57343)?(ot-55296)*1024+lt-56320+65536:ot}};tt?tt(String.prototype,"codePointAt",{value:_e,configurable:!0,writable:!0}):String.prototype.codePointAt=_e}();function Tree(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}var sltree=new Tree,sdtree=new Tree,length_bits=new Uint8Array(30),length_base=new Uint16Array(30),dist_bits=new Uint8Array(30),dist_base=new Uint16Array(30);function tinf_build_bits_base(tt,_e,rt,nt){var it,st;for(it=0;it<rt;++it)tt[it]=0;for(it=0;it<30-rt;++it)tt[it+rt]=it/rt|0;for(st=nt,it=0;it<30;++it)_e[it]=st,st+=1<<tt[it]}function tinf_build_fixed_trees(tt,_e){var rt;for(rt=0;rt<7;++rt)tt.table[rt]=0;for(tt.table[7]=24,tt.table[8]=152,tt.table[9]=112,rt=0;rt<24;++rt)tt.trans[rt]=256+rt;for(rt=0;rt<144;++rt)tt.trans[24+rt]=rt;for(rt=0;rt<8;++rt)tt.trans[24+144+rt]=280+rt;for(rt=0;rt<112;++rt)tt.trans[24+144+8+rt]=144+rt;for(rt=0;rt<5;++rt)_e.table[rt]=0;for(_e.table[5]=32,rt=0;rt<32;++rt)_e.trans[rt]=rt}tinf_build_fixed_trees(sltree,sdtree);tinf_build_bits_base(length_bits,length_base,4,3);tinf_build_bits_base(dist_bits,dist_base,2,1);length_bits[28]=0;length_base[28]=258;function derive(tt,_e,rt,nt,it){return Math.pow(1-it,3)*tt+3*Math.pow(1-it,2)*it*_e+3*(1-it)*Math.pow(it,2)*rt+Math.pow(it,3)*nt}function BoundingBox(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}BoundingBox.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)};BoundingBox.prototype.addPoint=function(tt,_e){typeof tt=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=tt,this.x2=tt),tt<this.x1&&(this.x1=tt),tt>this.x2&&(this.x2=tt)),typeof _e=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=_e,this.y2=_e),_e<this.y1&&(this.y1=_e),_e>this.y2&&(this.y2=_e))};BoundingBox.prototype.addX=function(tt){this.addPoint(tt,null)};BoundingBox.prototype.addY=function(tt){this.addPoint(null,tt)};BoundingBox.prototype.addBezier=function(tt,_e,rt,nt,it,st,ot,lt){var at=[tt,_e],ct=[rt,nt],ut=[it,st],ht=[ot,lt];this.addPoint(tt,_e),this.addPoint(ot,lt);for(var dt=0;dt<=1;dt++){var ft=6*at[dt]-12*ct[dt]+6*ut[dt],pt=-3*at[dt]+9*ct[dt]-9*ut[dt]+3*ht[dt],mt=3*ct[dt]-3*at[dt];if(pt===0){if(ft===0)continue;var gt=-mt/ft;0<gt&&gt<1&&(dt===0&&this.addX(derive(at[dt],ct[dt],ut[dt],ht[dt],gt)),dt===1&&this.addY(derive(at[dt],ct[dt],ut[dt],ht[dt],gt)));continue}var vt=Math.pow(ft,2)-4*mt*pt;if(!(vt<0)){var At=(-ft+Math.sqrt(vt))/(2*pt);0<At&&At<1&&(dt===0&&this.addX(derive(at[dt],ct[dt],ut[dt],ht[dt],At)),dt===1&&this.addY(derive(at[dt],ct[dt],ut[dt],ht[dt],At)));var yt=(-ft-Math.sqrt(vt))/(2*pt);0<yt&&yt<1&&(dt===0&&this.addX(derive(at[dt],ct[dt],ut[dt],ht[dt],yt)),dt===1&&this.addY(derive(at[dt],ct[dt],ut[dt],ht[dt],yt)))}}};BoundingBox.prototype.addQuad=function(tt,_e,rt,nt,it,st){var ot=tt+.6666666666666666*(rt-tt),lt=_e+2/3*(nt-_e),at=ot+1/3*(it-tt),ct=lt+1/3*(st-_e);this.addBezier(tt,_e,ot,lt,at,ct,it,st)};function Path(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}Path.prototype.moveTo=function(tt,_e){this.commands.push({type:"M",x:tt,y:_e})};Path.prototype.lineTo=function(tt,_e){this.commands.push({type:"L",x:tt,y:_e})};Path.prototype.curveTo=Path.prototype.bezierCurveTo=function(tt,_e,rt,nt,it,st){this.commands.push({type:"C",x1:tt,y1:_e,x2:rt,y2:nt,x:it,y:st})};Path.prototype.quadTo=Path.prototype.quadraticCurveTo=function(tt,_e,rt,nt){this.commands.push({type:"Q",x1:tt,y1:_e,x:rt,y:nt})};Path.prototype.close=Path.prototype.closePath=function(){this.commands.push({type:"Z"})};Path.prototype.extend=function(tt){if(tt.commands)tt=tt.commands;else if(tt instanceof BoundingBox){var _e=tt;this.moveTo(_e.x1,_e.y1),this.lineTo(_e.x2,_e.y1),this.lineTo(_e.x2,_e.y2),this.lineTo(_e.x1,_e.y2),this.close();return}Array.prototype.push.apply(this.commands,tt)};Path.prototype.getBoundingBox=function(){for(var tt=new BoundingBox,_e=0,rt=0,nt=0,it=0,st=0;st<this.commands.length;st++){var ot=this.commands[st];switch(ot.type){case"M":tt.addPoint(ot.x,ot.y),_e=nt=ot.x,rt=it=ot.y;break;case"L":tt.addPoint(ot.x,ot.y),nt=ot.x,it=ot.y;break;case"Q":tt.addQuad(nt,it,ot.x1,ot.y1,ot.x,ot.y),nt=ot.x,it=ot.y;break;case"C":tt.addBezier(nt,it,ot.x1,ot.y1,ot.x2,ot.y2,ot.x,ot.y),nt=ot.x,it=ot.y;break;case"Z":nt=_e,it=rt;break;default:throw new Error("Unexpected path command "+ot.type)}}return tt.isEmpty()&&tt.addPoint(0,0),tt};Path.prototype.draw=function(tt){tt.beginPath();for(var _e=0;_e<this.commands.length;_e+=1){var rt=this.commands[_e];rt.type==="M"?tt.moveTo(rt.x,rt.y):rt.type==="L"?tt.lineTo(rt.x,rt.y):rt.type==="C"?tt.bezierCurveTo(rt.x1,rt.y1,rt.x2,rt.y2,rt.x,rt.y):rt.type==="Q"?tt.quadraticCurveTo(rt.x1,rt.y1,rt.x,rt.y):rt.type==="Z"&&tt.closePath()}this.fill&&(tt.fillStyle=this.fill,tt.fill()),this.stroke&&(tt.strokeStyle=this.stroke,tt.lineWidth=this.strokeWidth,tt.stroke())};Path.prototype.toPathData=function(tt){tt=tt!==void 0?tt:2;function _e(ot){return Math.round(ot)===ot?""+Math.round(ot):ot.toFixed(tt)}function rt(){for(var ot=arguments,lt="",at=0;at<arguments.length;at+=1){var ct=ot[at];ct>=0&&at>0&&(lt+=" "),lt+=_e(ct)}return lt}for(var nt="",it=0;it<this.commands.length;it+=1){var st=this.commands[it];st.type==="M"?nt+="M"+rt(st.x,st.y):st.type==="L"?nt+="L"+rt(st.x,st.y):st.type==="C"?nt+="C"+rt(st.x1,st.y1,st.x2,st.y2,st.x,st.y):st.type==="Q"?nt+="Q"+rt(st.x1,st.y1,st.x,st.y):st.type==="Z"&&(nt+="Z")}return nt};Path.prototype.toSVG=function(tt){var _e='<path d="';return _e+=this.toPathData(tt),_e+='"',this.fill&&this.fill!=="black"&&(this.fill===null?_e+=' fill="none"':_e+=' fill="'+this.fill+'"'),this.stroke&&(_e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),_e+="/>",_e};Path.prototype.toDOMElement=function(tt){var _e=this.toPathData(tt),rt=document.createElementNS("http://www.w3.org/2000/svg","path");return rt.setAttribute("d",_e),rt};function fail(tt){throw new Error(tt)}function argument(tt,_e){tt||fail(_e)}var check={fail,argument,assert:argument},LIMIT16=32768,LIMIT32=2147483648,decode={},encode={},sizeOf={};function constant$2(tt){return function(){return tt}}encode.BYTE=function(tt){return check.argument(tt>=0&&tt<=255,"Byte value should be between 0 and 255."),[tt]};sizeOf.BYTE=constant$2(1);encode.CHAR=function(tt){return[tt.charCodeAt(0)]};sizeOf.CHAR=constant$2(1);encode.CHARARRAY=function(tt){typeof tt>"u"&&(tt="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var _e=[],rt=0;rt<tt.length;rt+=1)_e[rt]=tt.charCodeAt(rt);return _e};sizeOf.CHARARRAY=function(tt){return typeof tt>"u"?0:tt.length};encode.USHORT=function(tt){return[tt>>8&255,tt&255]};sizeOf.USHORT=constant$2(2);encode.SHORT=function(tt){return tt>=LIMIT16&&(tt=-(2*LIMIT16-tt)),[tt>>8&255,tt&255]};sizeOf.SHORT=constant$2(2);encode.UINT24=function(tt){return[tt>>16&255,tt>>8&255,tt&255]};sizeOf.UINT24=constant$2(3);encode.ULONG=function(tt){return[tt>>24&255,tt>>16&255,tt>>8&255,tt&255]};sizeOf.ULONG=constant$2(4);encode.LONG=function(tt){return tt>=LIMIT32&&(tt=-(2*LIMIT32-tt)),[tt>>24&255,tt>>16&255,tt>>8&255,tt&255]};sizeOf.LONG=constant$2(4);encode.FIXED=encode.ULONG;sizeOf.FIXED=sizeOf.ULONG;encode.FWORD=encode.SHORT;sizeOf.FWORD=sizeOf.SHORT;encode.UFWORD=encode.USHORT;sizeOf.UFWORD=sizeOf.USHORT;encode.LONGDATETIME=function(tt){return[0,0,0,0,tt>>24&255,tt>>16&255,tt>>8&255,tt&255]};sizeOf.LONGDATETIME=constant$2(8);encode.TAG=function(tt){return check.argument(tt.length===4,"Tag should be exactly 4 ASCII characters."),[tt.charCodeAt(0),tt.charCodeAt(1),tt.charCodeAt(2),tt.charCodeAt(3)]};sizeOf.TAG=constant$2(4);encode.Card8=encode.BYTE;sizeOf.Card8=sizeOf.BYTE;encode.Card16=encode.USHORT;sizeOf.Card16=sizeOf.USHORT;encode.OffSize=encode.BYTE;sizeOf.OffSize=sizeOf.BYTE;encode.SID=encode.USHORT;sizeOf.SID=sizeOf.USHORT;encode.NUMBER=function(tt){return tt>=-107&&tt<=107?[tt+139]:tt>=108&&tt<=1131?(tt=tt-108,[(tt>>8)+247,tt&255]):tt>=-1131&&tt<=-108?(tt=-tt-108,[(tt>>8)+251,tt&255]):tt>=-32768&&tt<=32767?encode.NUMBER16(tt):encode.NUMBER32(tt)};sizeOf.NUMBER=function(tt){return encode.NUMBER(tt).length};encode.NUMBER16=function(tt){return[28,tt>>8&255,tt&255]};sizeOf.NUMBER16=constant$2(3);encode.NUMBER32=function(tt){return[29,tt>>24&255,tt>>16&255,tt>>8&255,tt&255]};sizeOf.NUMBER32=constant$2(5);encode.REAL=function(tt){var _e=tt.toString(),rt=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(_e);if(rt){var nt=parseFloat("1e"+((rt[2]?+rt[2]:0)+rt[1].length));_e=(Math.round(tt*nt)/nt).toString()}for(var it="",st=0,ot=_e.length;st<ot;st+=1){var lt=_e[st];lt==="e"?it+=_e[++st]==="-"?"c":"b":lt==="."?it+="a":lt==="-"?it+="e":it+=lt}it+=it.length&1?"f":"ff";for(var at=[30],ct=0,ut=it.length;ct<ut;ct+=2)at.push(parseInt(it.substr(ct,2),16));return at};sizeOf.REAL=function(tt){return encode.REAL(tt).length};encode.NAME=encode.CHARARRAY;sizeOf.NAME=sizeOf.CHARARRAY;encode.STRING=encode.CHARARRAY;sizeOf.STRING=sizeOf.CHARARRAY;decode.UTF8=function(tt,_e,rt){for(var nt=[],it=rt,st=0;st<it;st++,_e+=1)nt[st]=tt.getUint8(_e);return String.fromCharCode.apply(null,nt)};decode.UTF16=function(tt,_e,rt){for(var nt=[],it=rt/2,st=0;st<it;st++,_e+=2)nt[st]=tt.getUint16(_e);return String.fromCharCode.apply(null,nt)};encode.UTF16=function(tt){for(var _e=[],rt=0;rt<tt.length;rt+=1){var nt=tt.charCodeAt(rt);_e[_e.length]=nt>>8&255,_e[_e.length]=nt&255}return _e};sizeOf.UTF16=function(tt){return tt.length*2};var eightBitMacEncodings={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};decode.MACSTRING=function(tt,_e,rt,nt){var it=eightBitMacEncodings[nt];if(it!==void 0){for(var st="",ot=0;ot<rt;ot++){var lt=tt.getUint8(_e+ot);lt<=127?st+=String.fromCharCode(lt):st+=it[lt&127]}return st}};var macEncodingTableCache=typeof WeakMap=="function"&&new WeakMap,macEncodingCacheKeys,getMacEncodingTable=function(tt){if(!macEncodingCacheKeys){macEncodingCacheKeys={};for(var _e in eightBitMacEncodings)macEncodingCacheKeys[_e]=new String(_e)}var rt=macEncodingCacheKeys[tt];if(rt!==void 0){if(macEncodingTableCache){var nt=macEncodingTableCache.get(rt);if(nt!==void 0)return nt}var it=eightBitMacEncodings[tt];if(it!==void 0){for(var st={},ot=0;ot<it.length;ot++)st[it.charCodeAt(ot)]=ot+128;return macEncodingTableCache&&macEncodingTableCache.set(rt,st),st}}};encode.MACSTRING=function(tt,_e){var rt=getMacEncodingTable(_e);if(rt!==void 0){for(var nt=[],it=0;it<tt.length;it++){var st=tt.charCodeAt(it);if(st>=128&&(st=rt[st],st===void 0))return;nt[it]=st}return nt}};sizeOf.MACSTRING=function(tt,_e){var rt=encode.MACSTRING(tt,_e);return rt!==void 0?rt.length:0};function isByteEncodable(tt){return tt>=-128&&tt<=127}function encodeVarDeltaRunAsZeroes(tt,_e,rt){for(var nt=0,it=tt.length;_e<it&&nt<64&&tt[_e]===0;)++_e,++nt;return rt.push(128|nt-1),_e}function encodeVarDeltaRunAsBytes(tt,_e,rt){for(var nt=0,it=tt.length,st=_e;st<it&&nt<64;){var ot=tt[st];if(!isByteEncodable(ot)||ot===0&&st+1<it&&tt[st+1]===0)break;++st,++nt}rt.push(nt-1);for(var lt=_e;lt<st;++lt)rt.push(tt[lt]+256&255);return st}function encodeVarDeltaRunAsWords(tt,_e,rt){for(var nt=0,it=tt.length,st=_e;st<it&&nt<64;){var ot=tt[st];if(ot===0||isByteEncodable(ot)&&st+1<it&&isByteEncodable(tt[st+1]))break;++st,++nt}rt.push(64|nt-1);for(var lt=_e;lt<st;++lt){var at=tt[lt];rt.push(at+65536>>8&255,at+256&255)}return st}encode.VARDELTAS=function(tt){for(var _e=0,rt=[];_e<tt.length;){var nt=tt[_e];nt===0?_e=encodeVarDeltaRunAsZeroes(tt,_e,rt):nt>=-128&&nt<=127?_e=encodeVarDeltaRunAsBytes(tt,_e,rt):_e=encodeVarDeltaRunAsWords(tt,_e,rt)}return rt};encode.INDEX=function(tt){for(var _e=1,rt=[_e],nt=[],it=0;it<tt.length;it+=1){var st=encode.OBJECT(tt[it]);Array.prototype.push.apply(nt,st),_e+=st.length,rt.push(_e)}if(nt.length===0)return[0,0];for(var ot=[],lt=1+Math.floor(Math.log(_e)/Math.log(2))/8|0,at=[void 0,encode.BYTE,encode.USHORT,encode.UINT24,encode.ULONG][lt],ct=0;ct<rt.length;ct+=1){var ut=at(rt[ct]);Array.prototype.push.apply(ot,ut)}return Array.prototype.concat(encode.Card16(tt.length),encode.OffSize(lt),ot,nt)};sizeOf.INDEX=function(tt){return encode.INDEX(tt).length};encode.DICT=function(tt){for(var _e=[],rt=Object.keys(tt),nt=rt.length,it=0;it<nt;it+=1){var st=parseInt(rt[it],0),ot=tt[st];_e=_e.concat(encode.OPERAND(ot.value,ot.type)),_e=_e.concat(encode.OPERATOR(st))}return _e};sizeOf.DICT=function(tt){return encode.DICT(tt).length};encode.OPERATOR=function(tt){return tt<1200?[tt]:[12,tt-1200]};encode.OPERAND=function(tt,_e){var rt=[];if(Array.isArray(_e))for(var nt=0;nt<_e.length;nt+=1)check.argument(tt.length===_e.length,"Not enough arguments given for type"+_e),rt=rt.concat(encode.OPERAND(tt[nt],_e[nt]));else if(_e==="SID")rt=rt.concat(encode.NUMBER(tt));else if(_e==="offset")rt=rt.concat(encode.NUMBER32(tt));else if(_e==="number")rt=rt.concat(encode.NUMBER(tt));else if(_e==="real")rt=rt.concat(encode.REAL(tt));else throw new Error("Unknown operand type "+_e);return rt};encode.OP=encode.BYTE;sizeOf.OP=sizeOf.BYTE;var wmm=typeof WeakMap=="function"&&new WeakMap;encode.CHARSTRING=function(tt){if(wmm){var _e=wmm.get(tt);if(_e!==void 0)return _e}for(var rt=[],nt=tt.length,it=0;it<nt;it+=1){var st=tt[it];rt=rt.concat(encode[st.type](st.value))}return wmm&&wmm.set(tt,rt),rt};sizeOf.CHARSTRING=function(tt){return encode.CHARSTRING(tt).length};encode.OBJECT=function(tt){var _e=encode[tt.type];return check.argument(_e!==void 0,"No encoding function for type "+tt.type),_e(tt.value)};sizeOf.OBJECT=function(tt){var _e=sizeOf[tt.type];return check.argument(_e!==void 0,"No sizeOf function for type "+tt.type),_e(tt.value)};encode.TABLE=function(tt){for(var _e=[],rt=tt.fields.length,nt=[],it=[],st=0;st<rt;st+=1){var ot=tt.fields[st],lt=encode[ot.type];check.argument(lt!==void 0,"No encoding function for field type "+ot.type+" ("+ot.name+")");var at=tt[ot.name];at===void 0&&(at=ot.value);var ct=lt(at);ot.type==="TABLE"?(it.push(_e.length),_e=_e.concat([0,0]),nt.push(ct)):_e=_e.concat(ct)}for(var ut=0;ut<nt.length;ut+=1){var ht=it[ut],dt=_e.length;check.argument(dt<65536,"Table "+tt.tableName+" too big."),_e[ht]=dt>>8,_e[ht+1]=dt&255,_e=_e.concat(nt[ut])}return _e};sizeOf.TABLE=function(tt){for(var _e=0,rt=tt.fields.length,nt=0;nt<rt;nt+=1){var it=tt.fields[nt],st=sizeOf[it.type];check.argument(st!==void 0,"No sizeOf function for field type "+it.type+" ("+it.name+")");var ot=tt[it.name];ot===void 0&&(ot=it.value),_e+=st(ot),it.type==="TABLE"&&(_e+=2)}return _e};encode.RECORD=encode.TABLE;sizeOf.RECORD=sizeOf.TABLE;encode.LITERAL=function(tt){return tt};sizeOf.LITERAL=function(tt){return tt.length};function Table(tt,_e,rt){if(_e.length&&(_e[0].name!=="coverageFormat"||_e[0].value===1))for(var nt=0;nt<_e.length;nt+=1){var it=_e[nt];this[it.name]=it.value}if(this.tableName=tt,this.fields=_e,rt)for(var st=Object.keys(rt),ot=0;ot<st.length;ot+=1){var lt=st[ot],at=rt[lt];this[lt]!==void 0&&(this[lt]=at)}}Table.prototype.encode=function(){return encode.TABLE(this)};Table.prototype.sizeOf=function(){return sizeOf.TABLE(this)};function ushortList(tt,_e,rt){rt===void 0&&(rt=_e.length);var nt=new Array(_e.length+1);nt[0]={name:tt+"Count",type:"USHORT",value:rt};for(var it=0;it<_e.length;it++)nt[it+1]={name:tt+it,type:"USHORT",value:_e[it]};return nt}function tableList(tt,_e,rt){var nt=_e.length,it=new Array(nt+1);it[0]={name:tt+"Count",type:"USHORT",value:nt};for(var st=0;st<nt;st++)it[st+1]={name:tt+st,type:"TABLE",value:rt(_e[st],st)};return it}function recordList(tt,_e,rt){var nt=_e.length,it=[];it[0]={name:tt+"Count",type:"USHORT",value:nt};for(var st=0;st<nt;st++)it=it.concat(rt(_e[st],st));return it}function Coverage(tt){tt.format===1?Table.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(ushortList("glyph",tt.glyphs))):tt.format===2?Table.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(recordList("rangeRecord",tt.ranges,function(_e){return[{name:"startGlyphID",type:"USHORT",value:_e.start},{name:"endGlyphID",type:"USHORT",value:_e.end},{name:"startCoverageIndex",type:"USHORT",value:_e.index}]}))):check.assert(!1,"Coverage format must be 1 or 2.")}Coverage.prototype=Object.create(Table.prototype);Coverage.prototype.constructor=Coverage;function ScriptList(tt){Table.call(this,"scriptListTable",recordList("scriptRecord",tt,function(_e,rt){var nt=_e.script,it=nt.defaultLangSys;return check.assert(!!it,"Unable to write GSUB: script "+_e.tag+" has no default language system."),[{name:"scriptTag"+rt,type:"TAG",value:_e.tag},{name:"script"+rt,type:"TABLE",value:new Table("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Table("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:it.reqFeatureIndex}].concat(ushortList("featureIndex",it.featureIndexes)))}].concat(recordList("langSys",nt.langSysRecords,function(st,ot){var lt=st.langSys;return[{name:"langSysTag"+ot,type:"TAG",value:st.tag},{name:"langSys"+ot,type:"TABLE",value:new Table("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:lt.reqFeatureIndex}].concat(ushortList("featureIndex",lt.featureIndexes)))}]})))}]}))}ScriptList.prototype=Object.create(Table.prototype);ScriptList.prototype.constructor=ScriptList;function FeatureList(tt){Table.call(this,"featureListTable",recordList("featureRecord",tt,function(_e,rt){var nt=_e.feature;return[{name:"featureTag"+rt,type:"TAG",value:_e.tag},{name:"feature"+rt,type:"TABLE",value:new Table("featureTable",[{name:"featureParams",type:"USHORT",value:nt.featureParams}].concat(ushortList("lookupListIndex",nt.lookupListIndexes)))}]}))}FeatureList.prototype=Object.create(Table.prototype);FeatureList.prototype.constructor=FeatureList;function LookupList(tt,_e){Table.call(this,"lookupListTable",tableList("lookup",tt,function(rt){var nt=_e[rt.lookupType];return check.assert(!!nt,"Unable to write GSUB lookup type "+rt.lookupType+" tables."),new Table("lookupTable",[{name:"lookupType",type:"USHORT",value:rt.lookupType},{name:"lookupFlag",type:"USHORT",value:rt.lookupFlag}].concat(tableList("subtable",rt.subtables,nt)))}))}LookupList.prototype=Object.create(Table.prototype);LookupList.prototype.constructor=LookupList;var table={Table,Record:Table,Coverage,ScriptList,FeatureList,LookupList,ushortList,tableList,recordList};function getByte(tt,_e){return tt.getUint8(_e)}function getUShort(tt,_e){return tt.getUint16(_e,!1)}function getShort(tt,_e){return tt.getInt16(_e,!1)}function getULong(tt,_e){return tt.getUint32(_e,!1)}function getFixed(tt,_e){var rt=tt.getInt16(_e,!1),nt=tt.getUint16(_e+2,!1);return rt+nt/65535}function getTag$2(tt,_e){for(var rt="",nt=_e;nt<_e+4;nt+=1)rt+=String.fromCharCode(tt.getInt8(nt));return rt}function getOffset(tt,_e,rt){for(var nt=0,it=0;it<rt;it+=1)nt<<=8,nt+=tt.getUint8(_e+it);return nt}function getBytes(tt,_e,rt){for(var nt=[],it=_e;it<rt;it+=1)nt.push(tt.getUint8(it));return nt}function bytesToString(tt){for(var _e="",rt=0;rt<tt.length;rt+=1)_e+=String.fromCharCode(tt[rt]);return _e}var typeOffsets={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Parser$1(tt,_e){this.data=tt,this.offset=_e,this.relativeOffset=0}Parser$1.prototype.parseByte=function(){var tt=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,tt};Parser$1.prototype.parseChar=function(){var tt=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,tt};Parser$1.prototype.parseCard8=Parser$1.prototype.parseByte;Parser$1.prototype.parseUShort=function(){var tt=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,tt};Parser$1.prototype.parseCard16=Parser$1.prototype.parseUShort;Parser$1.prototype.parseSID=Parser$1.prototype.parseUShort;Parser$1.prototype.parseOffset16=Parser$1.prototype.parseUShort;Parser$1.prototype.parseShort=function(){var tt=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,tt};Parser$1.prototype.parseF2Dot14=function(){var tt=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,tt};Parser$1.prototype.parseULong=function(){var tt=getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,tt};Parser$1.prototype.parseOffset32=Parser$1.prototype.parseULong;Parser$1.prototype.parseFixed=function(){var tt=getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,tt};Parser$1.prototype.parseString=function(tt){var _e=this.data,rt=this.offset+this.relativeOffset,nt="";this.relativeOffset+=tt;for(var it=0;it<tt;it++)nt+=String.fromCharCode(_e.getUint8(rt+it));return nt};Parser$1.prototype.parseTag=function(){return this.parseString(4)};Parser$1.prototype.parseLongDateTime=function(){var tt=getULong(this.data,this.offset+this.relativeOffset+4);return tt-=2082844800,this.relativeOffset+=8,tt};Parser$1.prototype.parseVersion=function(tt){var _e=getUShort(this.data,this.offset+this.relativeOffset),rt=getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,tt===void 0&&(tt=4096),_e+rt/tt/10};Parser$1.prototype.skip=function(tt,_e){_e===void 0&&(_e=1),this.relativeOffset+=typeOffsets[tt]*_e};Parser$1.prototype.parseULongList=function(tt){tt===void 0&&(tt=this.parseULong());for(var _e=new Array(tt),rt=this.data,nt=this.offset+this.relativeOffset,it=0;it<tt;it++)_e[it]=rt.getUint32(nt),nt+=4;return this.relativeOffset+=tt*4,_e};Parser$1.prototype.parseOffset16List=Parser$1.prototype.parseUShortList=function(tt){tt===void 0&&(tt=this.parseUShort());for(var _e=new Array(tt),rt=this.data,nt=this.offset+this.relativeOffset,it=0;it<tt;it++)_e[it]=rt.getUint16(nt),nt+=2;return this.relativeOffset+=tt*2,_e};Parser$1.prototype.parseShortList=function(tt){for(var _e=new Array(tt),rt=this.data,nt=this.offset+this.relativeOffset,it=0;it<tt;it++)_e[it]=rt.getInt16(nt),nt+=2;return this.relativeOffset+=tt*2,_e};Parser$1.prototype.parseByteList=function(tt){for(var _e=new Array(tt),rt=this.data,nt=this.offset+this.relativeOffset,it=0;it<tt;it++)_e[it]=rt.getUint8(nt++);return this.relativeOffset+=tt,_e};Parser$1.prototype.parseList=function(tt,_e){_e||(_e=tt,tt=this.parseUShort());for(var rt=new Array(tt),nt=0;nt<tt;nt++)rt[nt]=_e.call(this);return rt};Parser$1.prototype.parseList32=function(tt,_e){_e||(_e=tt,tt=this.parseULong());for(var rt=new Array(tt),nt=0;nt<tt;nt++)rt[nt]=_e.call(this);return rt};Parser$1.prototype.parseRecordList=function(tt,_e){_e||(_e=tt,tt=this.parseUShort());for(var rt=new Array(tt),nt=Object.keys(_e),it=0;it<tt;it++){for(var st={},ot=0;ot<nt.length;ot++){var lt=nt[ot],at=_e[lt];st[lt]=at.call(this)}rt[it]=st}return rt};Parser$1.prototype.parseRecordList32=function(tt,_e){_e||(_e=tt,tt=this.parseULong());for(var rt=new Array(tt),nt=Object.keys(_e),it=0;it<tt;it++){for(var st={},ot=0;ot<nt.length;ot++){var lt=nt[ot],at=_e[lt];st[lt]=at.call(this)}rt[it]=st}return rt};Parser$1.prototype.parseStruct=function(tt){if(typeof tt=="function")return tt.call(this);for(var _e=Object.keys(tt),rt={},nt=0;nt<_e.length;nt++){var it=_e[nt],st=tt[it];rt[it]=st.call(this)}return rt};Parser$1.prototype.parseValueRecord=function(tt){if(tt===void 0&&(tt=this.parseUShort()),tt!==0){var _e={};return tt&1&&(_e.xPlacement=this.parseShort()),tt&2&&(_e.yPlacement=this.parseShort()),tt&4&&(_e.xAdvance=this.parseShort()),tt&8&&(_e.yAdvance=this.parseShort()),tt&16&&(_e.xPlaDevice=void 0,this.parseShort()),tt&32&&(_e.yPlaDevice=void 0,this.parseShort()),tt&64&&(_e.xAdvDevice=void 0,this.parseShort()),tt&128&&(_e.yAdvDevice=void 0,this.parseShort()),_e}};Parser$1.prototype.parseValueRecordList=function(){for(var tt=this.parseUShort(),_e=this.parseUShort(),rt=new Array(_e),nt=0;nt<_e;nt++)rt[nt]=this.parseValueRecord(tt);return rt};Parser$1.prototype.parsePointer=function(tt){var _e=this.parseOffset16();if(_e>0)return new Parser$1(this.data,this.offset+_e).parseStruct(tt)};Parser$1.prototype.parsePointer32=function(tt){var _e=this.parseOffset32();if(_e>0)return new Parser$1(this.data,this.offset+_e).parseStruct(tt)};Parser$1.prototype.parseListOfLists=function(tt){for(var _e=this.parseOffset16List(),rt=_e.length,nt=this.relativeOffset,it=new Array(rt),st=0;st<rt;st++){var ot=_e[st];if(ot===0){it[st]=void 0;continue}if(this.relativeOffset=ot,tt){for(var lt=this.parseOffset16List(),at=new Array(lt.length),ct=0;ct<lt.length;ct++)this.relativeOffset=ot+lt[ct],at[ct]=tt.call(this);it[st]=at}else it[st]=this.parseUShortList()}return this.relativeOffset=nt,it};Parser$1.prototype.parseCoverage=function(){var tt=this.offset+this.relativeOffset,_e=this.parseUShort(),rt=this.parseUShort();if(_e===1)return{format:1,glyphs:this.parseUShortList(rt)};if(_e===2){for(var nt=new Array(rt),it=0;it<rt;it++)nt[it]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:nt}}throw new Error("0x"+tt.toString(16)+": Coverage format must be 1 or 2.")};Parser$1.prototype.parseClassDef=function(){var tt=this.offset+this.relativeOffset,_e=this.parseUShort();if(_e===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(_e===2)return{format:2,ranges:this.parseRecordList({start:Parser$1.uShort,end:Parser$1.uShort,classId:Parser$1.uShort})};throw new Error("0x"+tt.toString(16)+": ClassDef format must be 1 or 2.")};Parser$1.list=function(tt,_e){return function(){return this.parseList(tt,_e)}};Parser$1.list32=function(tt,_e){return function(){return this.parseList32(tt,_e)}};Parser$1.recordList=function(tt,_e){return function(){return this.parseRecordList(tt,_e)}};Parser$1.recordList32=function(tt,_e){return function(){return this.parseRecordList32(tt,_e)}};Parser$1.pointer=function(tt){return function(){return this.parsePointer(tt)}};Parser$1.pointer32=function(tt){return function(){return this.parsePointer32(tt)}};Parser$1.tag=Parser$1.prototype.parseTag;Parser$1.byte=Parser$1.prototype.parseByte;Parser$1.uShort=Parser$1.offset16=Parser$1.prototype.parseUShort;Parser$1.uShortList=Parser$1.prototype.parseUShortList;Parser$1.uLong=Parser$1.offset32=Parser$1.prototype.parseULong;Parser$1.uLongList=Parser$1.prototype.parseULongList;Parser$1.struct=Parser$1.prototype.parseStruct;Parser$1.coverage=Parser$1.prototype.parseCoverage;Parser$1.classDef=Parser$1.prototype.parseClassDef;var langSysTable={reserved:Parser$1.uShort,reqFeatureIndex:Parser$1.uShort,featureIndexes:Parser$1.uShortList};Parser$1.prototype.parseScriptList=function(){return this.parsePointer(Parser$1.recordList({tag:Parser$1.tag,script:Parser$1.pointer({defaultLangSys:Parser$1.pointer(langSysTable),langSysRecords:Parser$1.recordList({tag:Parser$1.tag,langSys:Parser$1.pointer(langSysTable)})})}))||[]};Parser$1.prototype.parseFeatureList=function(){return this.parsePointer(Parser$1.recordList({tag:Parser$1.tag,feature:Parser$1.pointer({featureParams:Parser$1.offset16,lookupListIndexes:Parser$1.uShortList})}))||[]};Parser$1.prototype.parseLookupList=function(tt){return this.parsePointer(Parser$1.list(Parser$1.pointer(function(){var _e=this.parseUShort();check.argument(1<=_e&&_e<=9,"GPOS/GSUB lookup type "+_e+" unknown.");var rt=this.parseUShort(),nt=rt&16;return{lookupType:_e,lookupFlag:rt,subtables:this.parseList(Parser$1.pointer(tt[_e])),markFilteringSet:nt?this.parseUShort():void 0}})))||[]};Parser$1.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var tt=this.parseUShort(),_e=this.parseUShort();check.argument(tt===1&&_e<1,"GPOS/GSUB feature variations table unknown.");var rt=this.parseRecordList32({conditionSetOffset:Parser$1.offset32,featureTableSubstitutionOffset:Parser$1.offset32});return rt})||[]};var parse$2={getByte,getCard8:getByte,getUShort,getCard16:getUShort,getShort,getULong,getFixed,getTag:getTag$2,getOffset,getBytes,bytesToString,Parser:Parser$1};function parseCmapTableFormat12(tt,_e){_e.parseUShort(),tt.length=_e.parseULong(),tt.language=_e.parseULong();var rt;tt.groupCount=rt=_e.parseULong(),tt.glyphIndexMap={};for(var nt=0;nt<rt;nt+=1)for(var it=_e.parseULong(),st=_e.parseULong(),ot=_e.parseULong(),lt=it;lt<=st;lt+=1)tt.glyphIndexMap[lt]=ot,ot++}function parseCmapTableFormat4(tt,_e,rt,nt,it){tt.length=_e.parseUShort(),tt.language=_e.parseUShort();var st;tt.segCount=st=_e.parseUShort()>>1,_e.skip("uShort",3),tt.glyphIndexMap={};for(var ot=new parse$2.Parser(rt,nt+it+14),lt=new parse$2.Parser(rt,nt+it+16+st*2),at=new parse$2.Parser(rt,nt+it+16+st*4),ct=new parse$2.Parser(rt,nt+it+16+st*6),ut=nt+it+16+st*8,ht=0;ht<st-1;ht+=1)for(var dt=void 0,ft=ot.parseUShort(),pt=lt.parseUShort(),mt=at.parseShort(),gt=ct.parseUShort(),vt=pt;vt<=ft;vt+=1)gt!==0?(ut=ct.offset+ct.relativeOffset-2,ut+=gt,ut+=(vt-pt)*2,dt=parse$2.getUShort(rt,ut),dt!==0&&(dt=dt+mt&65535)):dt=vt+mt&65535,tt.glyphIndexMap[vt]=dt}function parseCmapTable(tt,_e){var rt={};rt.version=parse$2.getUShort(tt,_e),check.argument(rt.version===0,"cmap table version should be 0."),rt.numTables=parse$2.getUShort(tt,_e+2);for(var nt=-1,it=rt.numTables-1;it>=0;it-=1){var st=parse$2.getUShort(tt,_e+4+it*8),ot=parse$2.getUShort(tt,_e+4+it*8+2);if(st===3&&(ot===0||ot===1||ot===10)||st===0&&(ot===0||ot===1||ot===2||ot===3||ot===4)){nt=parse$2.getULong(tt,_e+4+it*8+4);break}}if(nt===-1)throw new Error("No valid cmap sub-tables found.");var lt=new parse$2.Parser(tt,_e+nt);if(rt.format=lt.parseUShort(),rt.format===12)parseCmapTableFormat12(rt,lt);else if(rt.format===4)parseCmapTableFormat4(rt,lt,tt,_e,nt);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+rt.format+").");return rt}function addSegment(tt,_e,rt){tt.segments.push({end:_e,start:_e,delta:-(_e-rt),offset:0,glyphIndex:rt})}function addTerminatorSegment(tt){tt.segments.push({end:65535,start:65535,delta:1,offset:0})}function makeCmapTable(tt){var _e=!0,rt;for(rt=tt.length-1;rt>0;rt-=1){var nt=tt.get(rt);if(nt.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),_e=!1;break}}var it=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:_e?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:_e?12:12+8}];_e||(it=it.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),it=it.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var st=new table.Table("cmap",it);for(st.segments=[],rt=0;rt<tt.length;rt+=1){for(var ot=tt.get(rt),lt=0;lt<ot.unicodes.length;lt+=1)addSegment(st,ot.unicodes[lt],rt);st.segments=st.segments.sort(function(At,yt){return At.start-yt.start})}addTerminatorSegment(st);var at=st.segments.length,ct=0,ut=[],ht=[],dt=[],ft=[],pt=[],mt=[];for(rt=0;rt<at;rt+=1){var gt=st.segments[rt];gt.end<=65535&&gt.start<=65535?(ut=ut.concat({name:"end_"+rt,type:"USHORT",value:gt.end}),ht=ht.concat({name:"start_"+rt,type:"USHORT",value:gt.start}),dt=dt.concat({name:"idDelta_"+rt,type:"SHORT",value:gt.delta}),ft=ft.concat({name:"idRangeOffset_"+rt,type:"USHORT",value:gt.offset}),gt.glyphId!==void 0&&(pt=pt.concat({name:"glyph_"+rt,type:"USHORT",value:gt.glyphId}))):ct+=1,!_e&&gt.glyphIndex!==void 0&&(mt=mt.concat({name:"cmap12Start_"+rt,type:"ULONG",value:gt.start}),mt=mt.concat({name:"cmap12End_"+rt,type:"ULONG",value:gt.end}),mt=mt.concat({name:"cmap12Glyph_"+rt,type:"ULONG",value:gt.glyphIndex}))}if(st.segCountX2=(at-ct)*2,st.searchRange=Math.pow(2,Math.floor(Math.log(at-ct)/Math.log(2)))*2,st.entrySelector=Math.log(st.searchRange/2)/Math.log(2),st.rangeShift=st.segCountX2-st.searchRange,st.fields=st.fields.concat(ut),st.fields.push({name:"reservedPad",type:"USHORT",value:0}),st.fields=st.fields.concat(ht),st.fields=st.fields.concat(dt),st.fields=st.fields.concat(ft),st.fields=st.fields.concat(pt),st.cmap4Length=14+ut.length*2+2+ht.length*2+dt.length*2+ft.length*2+pt.length*2,!_e){var vt=16+mt.length*4;st.cmap12Offset=12+2*2+4+st.cmap4Length,st.fields=st.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:vt},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:mt.length/3}]),st.fields=st.fields.concat(mt)}return st}var cmap={parse:parseCmapTable,make:makeCmapTable},cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function DefaultEncoding(tt){this.font=tt}DefaultEncoding.prototype.charToGlyphIndex=function(tt){var _e=tt.codePointAt(0),rt=this.font.glyphs;if(rt){for(var nt=0;nt<rt.length;nt+=1)for(var it=rt.get(nt),st=0;st<it.unicodes.length;st+=1)if(it.unicodes[st]===_e)return nt}return null};function CffEncoding(tt,_e){this.encoding=tt,this.charset=_e}CffEncoding.prototype.charToGlyphIndex=function(tt){var _e=tt.codePointAt(0),rt=this.encoding[_e];return this.charset.indexOf(rt)};function line(tt,_e,rt,nt,it){tt.beginPath(),tt.moveTo(_e,rt),tt.lineTo(nt,it),tt.stroke()}var draw={line};function getPathDefinition(tt,_e){var rt=_e||new Path;return{configurable:!0,get:function(){return typeof rt=="function"&&(rt=rt()),rt},set:function(nt){rt=nt}}}function Glyph(tt){this.bindConstructorValues(tt)}Glyph.prototype.bindConstructorValues=function(tt){this.index=tt.index||0,this.name=tt.name||null,this.unicode=tt.unicode||void 0,this.unicodes=tt.unicodes||tt.unicode!==void 0?[tt.unicode]:[],"xMin"in tt&&(this.xMin=tt.xMin),"yMin"in tt&&(this.yMin=tt.yMin),"xMax"in tt&&(this.xMax=tt.xMax),"yMax"in tt&&(this.yMax=tt.yMax),"advanceWidth"in tt&&(this.advanceWidth=tt.advanceWidth),Object.defineProperty(this,"path",getPathDefinition(this,tt.path))};Glyph.prototype.addUnicode=function(tt){this.unicodes.length===0&&(this.unicode=tt),this.unicodes.push(tt)};Glyph.prototype.getBoundingBox=function(){return this.path.getBoundingBox()};Glyph.prototype.getPath=function(tt,_e,rt,nt,it){tt=tt!==void 0?tt:0,_e=_e!==void 0?_e:0,rt=rt!==void 0?rt:72;var st,ot;nt||(nt={});var lt=nt.xScale,at=nt.yScale;if(nt.hinting&&it&&it.hinting&&(ot=this.path&&it.hinting.exec(this,rt)),ot)st=it.hinting.getCommands(ot),tt=Math.round(tt),_e=Math.round(_e),lt=at=1;else{st=this.path.commands;var ct=1/(this.path.unitsPerEm||1e3)*rt;lt===void 0&&(lt=ct),at===void 0&&(at=ct)}for(var ut=new Path,ht=0;ht<st.length;ht+=1){var dt=st[ht];dt.type==="M"?ut.moveTo(tt+dt.x*lt,_e+-dt.y*at):dt.type==="L"?ut.lineTo(tt+dt.x*lt,_e+-dt.y*at):dt.type==="Q"?ut.quadraticCurveTo(tt+dt.x1*lt,_e+-dt.y1*at,tt+dt.x*lt,_e+-dt.y*at):dt.type==="C"?ut.curveTo(tt+dt.x1*lt,_e+-dt.y1*at,tt+dt.x2*lt,_e+-dt.y2*at,tt+dt.x*lt,_e+-dt.y*at):dt.type==="Z"&&ut.closePath()}return ut};Glyph.prototype.getContours=function(){if(this.points===void 0)return[];for(var tt=[],_e=[],rt=0;rt<this.points.length;rt+=1){var nt=this.points[rt];_e.push(nt),nt.lastPointOfContour&&(tt.push(_e),_e=[])}return check.argument(_e.length===0,"There are still points left in the current contour."),tt};Glyph.prototype.getMetrics=function(){for(var tt=this.path.commands,_e=[],rt=[],nt=0;nt<tt.length;nt+=1){var it=tt[nt];it.type!=="Z"&&(_e.push(it.x),rt.push(it.y)),(it.type==="Q"||it.type==="C")&&(_e.push(it.x1),rt.push(it.y1)),it.type==="C"&&(_e.push(it.x2),rt.push(it.y2))}var st={xMin:Math.min.apply(null,_e),yMin:Math.min.apply(null,rt),xMax:Math.max.apply(null,_e),yMax:Math.max.apply(null,rt),leftSideBearing:this.leftSideBearing};return isFinite(st.xMin)||(st.xMin=0),isFinite(st.xMax)||(st.xMax=this.advanceWidth),isFinite(st.yMin)||(st.yMin=0),isFinite(st.yMax)||(st.yMax=0),st.rightSideBearing=this.advanceWidth-st.leftSideBearing-(st.xMax-st.xMin),st};Glyph.prototype.draw=function(tt,_e,rt,nt,it){this.getPath(_e,rt,nt,it).draw(tt)};Glyph.prototype.drawPoints=function(tt,_e,rt,nt){function it(ht,dt,ft,pt){tt.beginPath();for(var mt=0;mt<ht.length;mt+=1)tt.moveTo(dt+ht[mt].x*pt,ft+ht[mt].y*pt),tt.arc(dt+ht[mt].x*pt,ft+ht[mt].y*pt,2,0,Math.PI*2,!1);tt.closePath(),tt.fill()}_e=_e!==void 0?_e:0,rt=rt!==void 0?rt:0,nt=nt!==void 0?nt:24;for(var st=1/this.path.unitsPerEm*nt,ot=[],lt=[],at=this.path,ct=0;ct<at.commands.length;ct+=1){var ut=at.commands[ct];ut.x!==void 0&&ot.push({x:ut.x,y:-ut.y}),ut.x1!==void 0&&lt.push({x:ut.x1,y:-ut.y1}),ut.x2!==void 0&&lt.push({x:ut.x2,y:-ut.y2})}tt.fillStyle="blue",it(ot,_e,rt,st),tt.fillStyle="red",it(lt,_e,rt,st)};Glyph.prototype.drawMetrics=function(tt,_e,rt,nt){var it;_e=_e!==void 0?_e:0,rt=rt!==void 0?rt:0,nt=nt!==void 0?nt:24,it=1/this.path.unitsPerEm*nt,tt.lineWidth=1,tt.strokeStyle="black",draw.line(tt,_e,-1e4,_e,1e4),draw.line(tt,-1e4,rt,1e4,rt);var st=this.xMin||0,ot=this.yMin||0,lt=this.xMax||0,at=this.yMax||0,ct=this.advanceWidth||0;tt.strokeStyle="blue",draw.line(tt,_e+st*it,-1e4,_e+st*it,1e4),draw.line(tt,_e+lt*it,-1e4,_e+lt*it,1e4),draw.line(tt,-1e4,rt+-ot*it,1e4,rt+-ot*it),draw.line(tt,-1e4,rt+-at*it,1e4,rt+-at*it),tt.strokeStyle="green",draw.line(tt,_e+ct*it,-1e4,_e+ct*it,1e4)};function defineDependentProperty(tt,_e,rt){Object.defineProperty(tt,_e,{get:function(){return tt.path,tt[rt]},set:function(nt){tt[rt]=nt},enumerable:!0,configurable:!0})}function GlyphSet(tt,_e){if(this.font=tt,this.glyphs={},Array.isArray(_e))for(var rt=0;rt<_e.length;rt++){var nt=_e[rt];nt.path.unitsPerEm=tt.unitsPerEm,this.glyphs[rt]=nt}this.length=_e&&_e.length||0}GlyphSet.prototype.get=function(tt){if(this.glyphs[tt]===void 0){this.font._push(tt),typeof this.glyphs[tt]=="function"&&(this.glyphs[tt]=this.glyphs[tt]());var _e=this.glyphs[tt],rt=this.font._IndexToUnicodeMap[tt];if(rt)for(var nt=0;nt<rt.unicodes.length;nt++)_e.addUnicode(rt.unicodes[nt]);this.font.cffEncoding?this.font.isCIDFont?_e.name="gid"+tt:_e.name=this.font.cffEncoding.charset[tt]:this.font.glyphNames.names&&(_e.name=this.font.glyphNames.glyphIndexToName(tt)),this.glyphs[tt].advanceWidth=this.font._hmtxTableData[tt].advanceWidth,this.glyphs[tt].leftSideBearing=this.font._hmtxTableData[tt].leftSideBearing}else typeof this.glyphs[tt]=="function"&&(this.glyphs[tt]=this.glyphs[tt]());return this.glyphs[tt]};GlyphSet.prototype.push=function(tt,_e){this.glyphs[tt]=_e,this.length++};function glyphLoader(tt,_e){return new Glyph({index:_e,font:tt})}function ttfGlyphLoader(tt,_e,rt,nt,it,st){return function(){var ot=new Glyph({index:_e,font:tt});return ot.path=function(){rt(ot,nt,it);var lt=st(tt.glyphs,ot);return lt.unitsPerEm=tt.unitsPerEm,lt},defineDependentProperty(ot,"xMin","_xMin"),defineDependentProperty(ot,"xMax","_xMax"),defineDependentProperty(ot,"yMin","_yMin"),defineDependentProperty(ot,"yMax","_yMax"),ot}}function cffGlyphLoader(tt,_e,rt,nt){return function(){var it=new Glyph({index:_e,font:tt});return it.path=function(){var st=rt(tt,it,nt);return st.unitsPerEm=tt.unitsPerEm,st},it}}var glyphset={GlyphSet,glyphLoader,ttfGlyphLoader,cffGlyphLoader};function equals(tt,_e){if(tt===_e)return!0;if(Array.isArray(tt)&&Array.isArray(_e)){if(tt.length!==_e.length)return!1;for(var rt=0;rt<tt.length;rt+=1)if(!equals(tt[rt],_e[rt]))return!1;return!0}else return!1}function calcCFFSubroutineBias(tt){var _e;return tt.length<1240?_e=107:tt.length<33900?_e=1131:_e=32768,_e}function parseCFFIndex(tt,_e,rt){var nt=[],it=[],st=parse$2.getCard16(tt,_e),ot,lt;if(st!==0){var at=parse$2.getByte(tt,_e+2);ot=_e+(st+1)*at+2;for(var ct=_e+3,ut=0;ut<st+1;ut+=1)nt.push(parse$2.getOffset(tt,ct,at)),ct+=at;lt=ot+nt[st]}else lt=_e+2;for(var ht=0;ht<nt.length-1;ht+=1){var dt=parse$2.getBytes(tt,ot+nt[ht],ot+nt[ht+1]);rt&&(dt=rt(dt)),it.push(dt)}return{objects:it,startOffset:_e,endOffset:lt}}function parseCFFIndexLowMemory(tt,_e){var rt=[],nt=parse$2.getCard16(tt,_e),it,st;if(nt!==0){var ot=parse$2.getByte(tt,_e+2);it=_e+(nt+1)*ot+2;for(var lt=_e+3,at=0;at<nt+1;at+=1)rt.push(parse$2.getOffset(tt,lt,ot)),lt+=ot;st=it+rt[nt]}else st=_e+2;return{offsets:rt,startOffset:_e,endOffset:st}}function getCffIndexObject(tt,_e,rt,nt,it){var st=parse$2.getCard16(rt,nt),ot=0;if(st!==0){var lt=parse$2.getByte(rt,nt+2);ot=nt+(st+1)*lt+2}var at=parse$2.getBytes(rt,ot+_e[tt],ot+_e[tt+1]);return it&&(at=it(at)),at}function parseFloatOperand(tt){for(var _e="",rt=15,nt=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var it=tt.parseByte(),st=it>>4,ot=it&15;if(st===rt||(_e+=nt[st],ot===rt))break;_e+=nt[ot]}return parseFloat(_e)}function parseOperand(tt,_e){var rt,nt,it,st;if(_e===28)return rt=tt.parseByte(),nt=tt.parseByte(),rt<<8|nt;if(_e===29)return rt=tt.parseByte(),nt=tt.parseByte(),it=tt.parseByte(),st=tt.parseByte(),rt<<24|nt<<16|it<<8|st;if(_e===30)return parseFloatOperand(tt);if(_e>=32&&_e<=246)return _e-139;if(_e>=247&&_e<=250)return rt=tt.parseByte(),(_e-247)*256+rt+108;if(_e>=251&&_e<=254)return rt=tt.parseByte(),-(_e-251)*256-rt-108;throw new Error("Invalid b0 "+_e)}function entriesToObject(tt){for(var _e={},rt=0;rt<tt.length;rt+=1){var nt=tt[rt][0],it=tt[rt][1],st=void 0;if(it.length===1?st=it[0]:st=it,_e.hasOwnProperty(nt)&&!isNaN(_e[nt]))throw new Error("Object "+_e+" already has key "+nt);_e[nt]=st}return _e}function parseCFFDict(tt,_e,rt){_e=_e!==void 0?_e:0;var nt=new parse$2.Parser(tt,_e),it=[],st=[];for(rt=rt!==void 0?rt:tt.length;nt.relativeOffset<rt;){var ot=nt.parseByte();ot<=21?(ot===12&&(ot=1200+nt.parseByte()),it.push([ot,st]),st=[]):st.push(parseOperand(nt,ot))}return entriesToObject(it)}function getCFFString(tt,_e){return _e<=390?_e=cffStandardStrings[_e]:_e=tt[_e-391],_e}function interpretDict(tt,_e,rt){for(var nt={},it,st=0;st<_e.length;st+=1){var ot=_e[st];if(Array.isArray(ot.type)){var lt=[];lt.length=ot.type.length;for(var at=0;at<ot.type.length;at++)it=tt[ot.op]!==void 0?tt[ot.op][at]:void 0,it===void 0&&(it=ot.value!==void 0&&ot.value[at]!==void 0?ot.value[at]:null),ot.type[at]==="SID"&&(it=getCFFString(rt,it)),lt[at]=it;nt[ot.name]=lt}else it=tt[ot.op],it===void 0&&(it=ot.value!==void 0?ot.value:null),ot.type==="SID"&&(it=getCFFString(rt,it)),nt[ot.name]=it}return nt}function parseCFFHeader(tt,_e){var rt={};return rt.formatMajor=parse$2.getCard8(tt,_e),rt.formatMinor=parse$2.getCard8(tt,_e+1),rt.size=parse$2.getCard8(tt,_e+2),rt.offsetSize=parse$2.getCard8(tt,_e+3),rt.startOffset=_e,rt.endOffset=_e+4,rt}var TOP_DICT_META=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],PRIVATE_DICT_META=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function parseCFFTopDict(tt,_e){var rt=parseCFFDict(tt,0,tt.byteLength);return interpretDict(rt,TOP_DICT_META,_e)}function parseCFFPrivateDict(tt,_e,rt,nt){var it=parseCFFDict(tt,_e,rt);return interpretDict(it,PRIVATE_DICT_META,nt)}function gatherCFFTopDicts(tt,_e,rt,nt){for(var it=[],st=0;st<rt.length;st+=1){var ot=new DataView(new Uint8Array(rt[st]).buffer),lt=parseCFFTopDict(ot,nt);lt._subrs=[],lt._subrsBias=0,lt._defaultWidthX=0,lt._nominalWidthX=0;var at=lt.private[0],ct=lt.private[1];if(at!==0&&ct!==0){var ut=parseCFFPrivateDict(tt,ct+_e,at,nt);if(lt._defaultWidthX=ut.defaultWidthX,lt._nominalWidthX=ut.nominalWidthX,ut.subrs!==0){var ht=ct+ut.subrs,dt=parseCFFIndex(tt,ht+_e);lt._subrs=dt.objects,lt._subrsBias=calcCFFSubroutineBias(lt._subrs)}lt._privateDict=ut}it.push(lt)}return it}function parseCFFCharset(tt,_e,rt,nt){var it,st,ot=new parse$2.Parser(tt,_e);rt-=1;var lt=[".notdef"],at=ot.parseCard8();if(at===0)for(var ct=0;ct<rt;ct+=1)it=ot.parseSID(),lt.push(getCFFString(nt,it));else if(at===1)for(;lt.length<=rt;){it=ot.parseSID(),st=ot.parseCard8();for(var ut=0;ut<=st;ut+=1)lt.push(getCFFString(nt,it)),it+=1}else if(at===2)for(;lt.length<=rt;){it=ot.parseSID(),st=ot.parseCard16();for(var ht=0;ht<=st;ht+=1)lt.push(getCFFString(nt,it)),it+=1}else throw new Error("Unknown charset format "+at);return lt}function parseCFFEncoding(tt,_e,rt){var nt,it={},st=new parse$2.Parser(tt,_e),ot=st.parseCard8();if(ot===0)for(var lt=st.parseCard8(),at=0;at<lt;at+=1)nt=st.parseCard8(),it[nt]=at;else if(ot===1){var ct=st.parseCard8();nt=1;for(var ut=0;ut<ct;ut+=1)for(var ht=st.parseCard8(),dt=st.parseCard8(),ft=ht;ft<=ht+dt;ft+=1)it[ft]=nt,nt+=1}else throw new Error("Unknown encoding format "+ot);return new CffEncoding(it,rt)}function parseCFFCharstring(tt,_e,rt){var nt,it,st,ot,lt=new Path,at=[],ct=0,ut=!1,ht=!1,dt=0,ft=0,pt,mt,gt,vt;if(tt.isCIDFont){var At=tt.tables.cff.topDict._fdSelect[_e.index],yt=tt.tables.cff.topDict._fdArray[At];pt=yt._subrs,mt=yt._subrsBias,gt=yt._defaultWidthX,vt=yt._nominalWidthX}else pt=tt.tables.cff.topDict._subrs,mt=tt.tables.cff.topDict._subrsBias,gt=tt.tables.cff.topDict._defaultWidthX,vt=tt.tables.cff.topDict._nominalWidthX;var xt=gt;function _t(wt,Tt){ht&&lt.closePath(),lt.moveTo(wt,Tt),ht=!0}function Et(){var wt;wt=at.length%2!==0,wt&&!ut&&(xt=at.shift()+vt),ct+=at.length>>1,at.length=0,ut=!0}function bt(wt){for(var Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt,Dt,Gt,zt,$t=0;$t<wt.length;){var Ht=wt[$t];switch($t+=1,Ht){case 1:Et();break;case 3:Et();break;case 4:at.length>1&&!ut&&(xt=at.shift()+vt,ut=!0),ft+=at.pop(),_t(dt,ft);break;case 5:for(;at.length>0;)dt+=at.shift(),ft+=at.shift(),lt.lineTo(dt,ft);break;case 6:for(;at.length>0&&(dt+=at.shift(),lt.lineTo(dt,ft),at.length!==0);)ft+=at.shift(),lt.lineTo(dt,ft);break;case 7:for(;at.length>0&&(ft+=at.shift(),lt.lineTo(dt,ft),at.length!==0);)dt+=at.shift(),lt.lineTo(dt,ft);break;case 8:for(;at.length>0;)nt=dt+at.shift(),it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),dt=st+at.shift(),ft=ot+at.shift(),lt.curveTo(nt,it,st,ot,dt,ft);break;case 10:Ot=at.pop()+mt,Bt=pt[Ot],Bt&&bt(Bt);break;case 11:return;case 12:switch(Ht=wt[$t],$t+=1,Ht){case 35:nt=dt+at.shift(),it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),Ut=st+at.shift(),Ft=ot+at.shift(),jt=Ut+at.shift(),Dt=Ft+at.shift(),Gt=jt+at.shift(),zt=Dt+at.shift(),dt=Gt+at.shift(),ft=zt+at.shift(),at.shift(),lt.curveTo(nt,it,st,ot,Ut,Ft),lt.curveTo(jt,Dt,Gt,zt,dt,ft);break;case 34:nt=dt+at.shift(),it=ft,st=nt+at.shift(),ot=it+at.shift(),Ut=st+at.shift(),Ft=ot,jt=Ut+at.shift(),Dt=ot,Gt=jt+at.shift(),zt=ft,dt=Gt+at.shift(),lt.curveTo(nt,it,st,ot,Ut,Ft),lt.curveTo(jt,Dt,Gt,zt,dt,ft);break;case 36:nt=dt+at.shift(),it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),Ut=st+at.shift(),Ft=ot,jt=Ut+at.shift(),Dt=ot,Gt=jt+at.shift(),zt=Dt+at.shift(),dt=Gt+at.shift(),lt.curveTo(nt,it,st,ot,Ut,Ft),lt.curveTo(jt,Dt,Gt,zt,dt,ft);break;case 37:nt=dt+at.shift(),it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),Ut=st+at.shift(),Ft=ot+at.shift(),jt=Ut+at.shift(),Dt=Ft+at.shift(),Gt=jt+at.shift(),zt=Dt+at.shift(),Math.abs(Gt-dt)>Math.abs(zt-ft)?dt=Gt+at.shift():ft=zt+at.shift(),lt.curveTo(nt,it,st,ot,Ut,Ft),lt.curveTo(jt,Dt,Gt,zt,dt,ft);break;default:console.log("Glyph "+_e.index+": unknown operator 1200"+Ht),at.length=0}break;case 14:at.length>0&&!ut&&(xt=at.shift()+vt,ut=!0),ht&&(lt.closePath(),ht=!1);break;case 18:Et();break;case 19:case 20:Et(),$t+=ct+7>>3;break;case 21:at.length>2&&!ut&&(xt=at.shift()+vt,ut=!0),ft+=at.pop(),dt+=at.pop(),_t(dt,ft);break;case 22:at.length>1&&!ut&&(xt=at.shift()+vt,ut=!0),dt+=at.pop(),_t(dt,ft);break;case 23:Et();break;case 24:for(;at.length>2;)nt=dt+at.shift(),it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),dt=st+at.shift(),ft=ot+at.shift(),lt.curveTo(nt,it,st,ot,dt,ft);dt+=at.shift(),ft+=at.shift(),lt.lineTo(dt,ft);break;case 25:for(;at.length>6;)dt+=at.shift(),ft+=at.shift(),lt.lineTo(dt,ft);nt=dt+at.shift(),it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),dt=st+at.shift(),ft=ot+at.shift(),lt.curveTo(nt,it,st,ot,dt,ft);break;case 26:for(at.length%2&&(dt+=at.shift());at.length>0;)nt=dt,it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),dt=st,ft=ot+at.shift(),lt.curveTo(nt,it,st,ot,dt,ft);break;case 27:for(at.length%2&&(ft+=at.shift());at.length>0;)nt=dt+at.shift(),it=ft,st=nt+at.shift(),ot=it+at.shift(),dt=st+at.shift(),ft=ot,lt.curveTo(nt,it,st,ot,dt,ft);break;case 28:Tt=wt[$t],Mt=wt[$t+1],at.push((Tt<<24|Mt<<16)>>16),$t+=2;break;case 29:Ot=at.pop()+tt.gsubrsBias,Bt=tt.gsubrs[Ot],Bt&&bt(Bt);break;case 30:for(;at.length>0&&(nt=dt,it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),dt=st+at.shift(),ft=ot+(at.length===1?at.shift():0),lt.curveTo(nt,it,st,ot,dt,ft),at.length!==0);)nt=dt+at.shift(),it=ft,st=nt+at.shift(),ot=it+at.shift(),ft=ot+at.shift(),dt=st+(at.length===1?at.shift():0),lt.curveTo(nt,it,st,ot,dt,ft);break;case 31:for(;at.length>0&&(nt=dt+at.shift(),it=ft,st=nt+at.shift(),ot=it+at.shift(),ft=ot+at.shift(),dt=st+(at.length===1?at.shift():0),lt.curveTo(nt,it,st,ot,dt,ft),at.length!==0);)nt=dt,it=ft+at.shift(),st=nt+at.shift(),ot=it+at.shift(),dt=st+at.shift(),ft=ot+(at.length===1?at.shift():0),lt.curveTo(nt,it,st,ot,dt,ft);break;default:Ht<32?console.log("Glyph "+_e.index+": unknown operator "+Ht):Ht<247?at.push(Ht-139):Ht<251?(Tt=wt[$t],$t+=1,at.push((Ht-247)*256+Tt+108)):Ht<255?(Tt=wt[$t],$t+=1,at.push(-(Ht-251)*256-Tt-108)):(Tt=wt[$t],Mt=wt[$t+1],Pt=wt[$t+2],It=wt[$t+3],$t+=4,at.push((Tt<<24|Mt<<16|Pt<<8|It)/65536))}}}return bt(rt),_e.advanceWidth=xt,lt}function parseCFFFDSelect(tt,_e,rt,nt){var it=[],st,ot=new parse$2.Parser(tt,_e),lt=ot.parseCard8();if(lt===0)for(var at=0;at<rt;at++){if(st=ot.parseCard8(),st>=nt)throw new Error("CFF table CID Font FDSelect has bad FD index value "+st+" (FD count "+nt+")");it.push(st)}else if(lt===3){var ct=ot.parseCard16(),ut=ot.parseCard16();if(ut!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+ut);for(var ht,dt=0;dt<ct;dt++){if(st=ot.parseCard8(),ht=ot.parseCard16(),st>=nt)throw new Error("CFF table CID Font FDSelect has bad FD index value "+st+" (FD count "+nt+")");if(ht>rt)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+ht);for(;ut<ht;ut++)it.push(st);ut=ht}if(ht!==rt)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+ht)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+lt);return it}function parseCFFTable(tt,_e,rt,nt){rt.tables.cff={};var it=parseCFFHeader(tt,_e),st=parseCFFIndex(tt,it.endOffset,parse$2.bytesToString),ot=parseCFFIndex(tt,st.endOffset),lt=parseCFFIndex(tt,ot.endOffset,parse$2.bytesToString),at=parseCFFIndex(tt,lt.endOffset);rt.gsubrs=at.objects,rt.gsubrsBias=calcCFFSubroutineBias(rt.gsubrs);var ct=gatherCFFTopDicts(tt,_e,ot.objects,lt.objects);if(ct.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+ct.length);var ut=ct[0];if(rt.tables.cff.topDict=ut,ut._privateDict&&(rt.defaultWidthX=ut._privateDict.defaultWidthX,rt.nominalWidthX=ut._privateDict.nominalWidthX),ut.ros[0]!==void 0&&ut.ros[1]!==void 0&&(rt.isCIDFont=!0),rt.isCIDFont){var ht=ut.fdArray,dt=ut.fdSelect;if(ht===0||dt===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");ht+=_e;var ft=parseCFFIndex(tt,ht),pt=gatherCFFTopDicts(tt,_e,ft.objects,lt.objects);ut._fdArray=pt,dt+=_e,ut._fdSelect=parseCFFFDSelect(tt,dt,rt.numGlyphs,pt.length)}var mt=_e+ut.private[1],gt=parseCFFPrivateDict(tt,mt,ut.private[0],lt.objects);if(rt.defaultWidthX=gt.defaultWidthX,rt.nominalWidthX=gt.nominalWidthX,gt.subrs!==0){var vt=mt+gt.subrs,At=parseCFFIndex(tt,vt);rt.subrs=At.objects,rt.subrsBias=calcCFFSubroutineBias(rt.subrs)}else rt.subrs=[],rt.subrsBias=0;var yt;nt.lowMemory?(yt=parseCFFIndexLowMemory(tt,_e+ut.charStrings),rt.nGlyphs=yt.offsets.length):(yt=parseCFFIndex(tt,_e+ut.charStrings),rt.nGlyphs=yt.objects.length);var xt=parseCFFCharset(tt,_e+ut.charset,rt.nGlyphs,lt.objects);if(ut.encoding===0?rt.cffEncoding=new CffEncoding(cffStandardEncoding,xt):ut.encoding===1?rt.cffEncoding=new CffEncoding(cffExpertEncoding,xt):rt.cffEncoding=parseCFFEncoding(tt,_e+ut.encoding,xt),rt.encoding=rt.encoding||rt.cffEncoding,rt.glyphs=new glyphset.GlyphSet(rt),nt.lowMemory)rt._push=function(bt){var wt=getCffIndexObject(bt,yt.offsets,tt,_e+ut.charStrings);rt.glyphs.push(bt,glyphset.cffGlyphLoader(rt,bt,parseCFFCharstring,wt))};else for(var _t=0;_t<rt.nGlyphs;_t+=1){var Et=yt.objects[_t];rt.glyphs.push(_t,glyphset.cffGlyphLoader(rt,_t,parseCFFCharstring,Et))}}function encodeString(tt,_e){var rt,nt=cffStandardStrings.indexOf(tt);return nt>=0&&(rt=nt),nt=_e.indexOf(tt),nt>=0?rt=nt+cffStandardStrings.length:(rt=cffStandardStrings.length+_e.length,_e.push(tt)),rt}function makeHeader(){return new table.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function makeNameIndex(tt){var _e=new table.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);_e.names=[];for(var rt=0;rt<tt.length;rt+=1)_e.names.push({name:"name_"+rt,type:"NAME",value:tt[rt]});return _e}function makeDict(tt,_e,rt){for(var nt={},it=0;it<tt.length;it+=1){var st=tt[it],ot=_e[st.name];ot!==void 0&&!equals(ot,st.value)&&(st.type==="SID"&&(ot=encodeString(ot,rt)),nt[st.op]={name:st.name,type:st.type,value:ot})}return nt}function makeTopDict(tt,_e){var rt=new table.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return rt.dict=makeDict(TOP_DICT_META,tt,_e),rt}function makeTopDictIndex(tt){var _e=new table.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return _e.topDicts=[{name:"topDict_0",type:"TABLE",value:tt}],_e}function makeStringIndex(tt){var _e=new table.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);_e.strings=[];for(var rt=0;rt<tt.length;rt+=1)_e.strings.push({name:"string_"+rt,type:"STRING",value:tt[rt]});return _e}function makeGlobalSubrIndex(){return new table.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function makeCharsets(tt,_e){for(var rt=new table.Record("Charsets",[{name:"format",type:"Card8",value:0}]),nt=0;nt<tt.length;nt+=1){var it=tt[nt],st=encodeString(it,_e);rt.fields.push({name:"glyph_"+nt,type:"SID",value:st})}return rt}function glyphToOps(tt){var _e=[],rt=tt.path;_e.push({name:"width",type:"NUMBER",value:tt.advanceWidth});for(var nt=0,it=0,st=0;st<rt.commands.length;st+=1){var ot=void 0,lt=void 0,at=rt.commands[st];if(at.type==="Q"){var ct=.3333333333333333,ut=2/3;at={type:"C",x:at.x,y:at.y,x1:Math.round(ct*nt+ut*at.x1),y1:Math.round(ct*it+ut*at.y1),x2:Math.round(ct*at.x+ut*at.x1),y2:Math.round(ct*at.y+ut*at.y1)}}if(at.type==="M")ot=Math.round(at.x-nt),lt=Math.round(at.y-it),_e.push({name:"dx",type:"NUMBER",value:ot}),_e.push({name:"dy",type:"NUMBER",value:lt}),_e.push({name:"rmoveto",type:"OP",value:21}),nt=Math.round(at.x),it=Math.round(at.y);else if(at.type==="L")ot=Math.round(at.x-nt),lt=Math.round(at.y-it),_e.push({name:"dx",type:"NUMBER",value:ot}),_e.push({name:"dy",type:"NUMBER",value:lt}),_e.push({name:"rlineto",type:"OP",value:5}),nt=Math.round(at.x),it=Math.round(at.y);else if(at.type==="C"){var ht=Math.round(at.x1-nt),dt=Math.round(at.y1-it),ft=Math.round(at.x2-at.x1),pt=Math.round(at.y2-at.y1);ot=Math.round(at.x-at.x2),lt=Math.round(at.y-at.y2),_e.push({name:"dx1",type:"NUMBER",value:ht}),_e.push({name:"dy1",type:"NUMBER",value:dt}),_e.push({name:"dx2",type:"NUMBER",value:ft}),_e.push({name:"dy2",type:"NUMBER",value:pt}),_e.push({name:"dx",type:"NUMBER",value:ot}),_e.push({name:"dy",type:"NUMBER",value:lt}),_e.push({name:"rrcurveto",type:"OP",value:8}),nt=Math.round(at.x),it=Math.round(at.y)}}return _e.push({name:"endchar",type:"OP",value:14}),_e}function makeCharStringsIndex(tt){for(var _e=new table.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),rt=0;rt<tt.length;rt+=1){var nt=tt.get(rt),it=glyphToOps(nt);_e.charStrings.push({name:nt.name,type:"CHARSTRING",value:it})}return _e}function makePrivateDict(tt,_e){var rt=new table.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return rt.dict=makeDict(PRIVATE_DICT_META,tt,_e),rt}function makeCFFTable(tt,_e){for(var rt=new table.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),nt=1/_e.unitsPerEm,it={version:_e.version,fullName:_e.fullName,familyName:_e.familyName,weight:_e.weightName,fontBBox:_e.fontBBox||[0,0,0,0],fontMatrix:[nt,0,0,nt,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},st={},ot=[],lt,at=1;at<tt.length;at+=1)lt=tt.get(at),ot.push(lt.name);var ct=[];rt.header=makeHeader(),rt.nameIndex=makeNameIndex([_e.postScriptName]);var ut=makeTopDict(it,ct);rt.topDictIndex=makeTopDictIndex(ut),rt.globalSubrIndex=makeGlobalSubrIndex(),rt.charsets=makeCharsets(ot,ct),rt.charStringsIndex=makeCharStringsIndex(tt),rt.privateDict=makePrivateDict(st,ct),rt.stringIndex=makeStringIndex(ct);var ht=rt.header.sizeOf()+rt.nameIndex.sizeOf()+rt.topDictIndex.sizeOf()+rt.stringIndex.sizeOf()+rt.globalSubrIndex.sizeOf();return it.charset=ht,it.encoding=0,it.charStrings=it.charset+rt.charsets.sizeOf(),it.private[1]=it.charStrings+rt.charStringsIndex.sizeOf(),ut=makeTopDict(it,ct),rt.topDictIndex=makeTopDictIndex(ut),rt}var cff={parse:parseCFFTable,make:makeCFFTable};function parseHeadTable(tt,_e){var rt={},nt=new parse$2.Parser(tt,_e);return rt.version=nt.parseVersion(),rt.fontRevision=Math.round(nt.parseFixed()*1e3)/1e3,rt.checkSumAdjustment=nt.parseULong(),rt.magicNumber=nt.parseULong(),check.argument(rt.magicNumber===1594834165,"Font header has wrong magic number."),rt.flags=nt.parseUShort(),rt.unitsPerEm=nt.parseUShort(),rt.created=nt.parseLongDateTime(),rt.modified=nt.parseLongDateTime(),rt.xMin=nt.parseShort(),rt.yMin=nt.parseShort(),rt.xMax=nt.parseShort(),rt.yMax=nt.parseShort(),rt.macStyle=nt.parseUShort(),rt.lowestRecPPEM=nt.parseUShort(),rt.fontDirectionHint=nt.parseShort(),rt.indexToLocFormat=nt.parseShort(),rt.glyphDataFormat=nt.parseShort(),rt}function makeHeadTable(tt){var _e=Math.round(new Date().getTime()/1e3)+2082844800,rt=_e;return tt.createdTimestamp&&(rt=tt.createdTimestamp+2082844800),new table.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:rt},{name:"modified",type:"LONGDATETIME",value:_e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],tt)}var head$1={parse:parseHeadTable,make:makeHeadTable};function parseHheaTable(tt,_e){var rt={},nt=new parse$2.Parser(tt,_e);return rt.version=nt.parseVersion(),rt.ascender=nt.parseShort(),rt.descender=nt.parseShort(),rt.lineGap=nt.parseShort(),rt.advanceWidthMax=nt.parseUShort(),rt.minLeftSideBearing=nt.parseShort(),rt.minRightSideBearing=nt.parseShort(),rt.xMaxExtent=nt.parseShort(),rt.caretSlopeRise=nt.parseShort(),rt.caretSlopeRun=nt.parseShort(),rt.caretOffset=nt.parseShort(),nt.relativeOffset+=8,rt.metricDataFormat=nt.parseShort(),rt.numberOfHMetrics=nt.parseUShort(),rt}function makeHheaTable(tt){return new table.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],tt)}var hhea={parse:parseHheaTable,make:makeHheaTable};function parseHmtxTableAll(tt,_e,rt,nt,it){for(var st,ot,lt=new parse$2.Parser(tt,_e),at=0;at<nt;at+=1){at<rt&&(st=lt.parseUShort(),ot=lt.parseShort());var ct=it.get(at);ct.advanceWidth=st,ct.leftSideBearing=ot}}function parseHmtxTableOnLowMemory(tt,_e,rt,nt,it){tt._hmtxTableData={};for(var st,ot,lt=new parse$2.Parser(_e,rt),at=0;at<it;at+=1)at<nt&&(st=lt.parseUShort(),ot=lt.parseShort()),tt._hmtxTableData[at]={advanceWidth:st,leftSideBearing:ot}}function parseHmtxTable(tt,_e,rt,nt,it,st,ot){ot.lowMemory?parseHmtxTableOnLowMemory(tt,_e,rt,nt,it):parseHmtxTableAll(_e,rt,nt,it,st)}function makeHmtxTable(tt){for(var _e=new table.Table("hmtx",[]),rt=0;rt<tt.length;rt+=1){var nt=tt.get(rt),it=nt.advanceWidth||0,st=nt.leftSideBearing||0;_e.fields.push({name:"advanceWidth_"+rt,type:"USHORT",value:it}),_e.fields.push({name:"leftSideBearing_"+rt,type:"SHORT",value:st})}return _e}var hmtx={parse:parseHmtxTable,make:makeHmtxTable};function makeLtagTable(tt){for(var _e=new table.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:tt.length}]),rt="",nt=12+tt.length*4,it=0;it<tt.length;++it){var st=rt.indexOf(tt[it]);st<0&&(st=rt.length,rt+=tt[it]),_e.fields.push({name:"offset "+it,type:"USHORT",value:nt+st}),_e.fields.push({name:"length "+it,type:"USHORT",value:tt[it].length})}return _e.fields.push({name:"stringPool",type:"CHARARRAY",value:rt}),_e}function parseLtagTable(tt,_e){var rt=new parse$2.Parser(tt,_e),nt=rt.parseULong();check.argument(nt===1,"Unsupported ltag table version."),rt.skip("uLong",1);for(var it=rt.parseULong(),st=[],ot=0;ot<it;ot++){for(var lt="",at=_e+rt.parseUShort(),ct=rt.parseUShort(),ut=at;ut<at+ct;++ut)lt+=String.fromCharCode(tt.getInt8(ut));st.push(lt)}return st}var ltag={make:makeLtagTable,parse:parseLtagTable};function parseMaxpTable(tt,_e){var rt={},nt=new parse$2.Parser(tt,_e);return rt.version=nt.parseVersion(),rt.numGlyphs=nt.parseUShort(),rt.version===1&&(rt.maxPoints=nt.parseUShort(),rt.maxContours=nt.parseUShort(),rt.maxCompositePoints=nt.parseUShort(),rt.maxCompositeContours=nt.parseUShort(),rt.maxZones=nt.parseUShort(),rt.maxTwilightPoints=nt.parseUShort(),rt.maxStorage=nt.parseUShort(),rt.maxFunctionDefs=nt.parseUShort(),rt.maxInstructionDefs=nt.parseUShort(),rt.maxStackElements=nt.parseUShort(),rt.maxSizeOfInstructions=nt.parseUShort(),rt.maxComponentElements=nt.parseUShort(),rt.maxComponentDepth=nt.parseUShort()),rt}function makeMaxpTable(tt){return new table.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:tt}])}var maxp={parse:parseMaxpTable,make:makeMaxpTable},nameTableNames=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],macLanguages={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},macLanguageToScript={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},windowsLanguages={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function getLanguageCode(tt,_e,rt){switch(tt){case 0:if(_e===65535)return"und";if(rt)return rt[_e];break;case 1:return macLanguages[_e];case 3:return windowsLanguages[_e]}}var utf16="utf-16",macScriptEncodings={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},macLanguageEncodings={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function getEncoding(tt,_e,rt){switch(tt){case 0:return utf16;case 1:return macLanguageEncodings[rt]||macScriptEncodings[_e];case 3:if(_e===1||_e===10)return utf16;break}}function parseNameTable(tt,_e,rt){for(var nt={},it=new parse$2.Parser(tt,_e),st=it.parseUShort(),ot=it.parseUShort(),lt=it.offset+it.parseUShort(),at=0;at<ot;at++){var ct=it.parseUShort(),ut=it.parseUShort(),ht=it.parseUShort(),dt=it.parseUShort(),ft=nameTableNames[dt]||dt,pt=it.parseUShort(),mt=it.parseUShort(),gt=getLanguageCode(ct,ht,rt),vt=getEncoding(ct,ut,ht);if(vt!==void 0&&gt!==void 0){var At=void 0;if(vt===utf16?At=decode.UTF16(tt,lt+mt,pt):At=decode.MACSTRING(tt,lt+mt,pt,vt),At){var yt=nt[ft];yt===void 0&&(yt=nt[ft]={}),yt[gt]=At}}}return st===1&&it.parseUShort(),nt}function reverseDict(tt){var _e={};for(var rt in tt)_e[tt[rt]]=parseInt(rt);return _e}function makeNameRecord(tt,_e,rt,nt,it,st){return new table.Record("NameRecord",[{name:"platformID",type:"USHORT",value:tt},{name:"encodingID",type:"USHORT",value:_e},{name:"languageID",type:"USHORT",value:rt},{name:"nameID",type:"USHORT",value:nt},{name:"length",type:"USHORT",value:it},{name:"offset",type:"USHORT",value:st}])}function findSubArray(tt,_e){var rt=tt.length,nt=_e.length-rt+1;e:for(var it=0;it<nt;it++)for(;it<nt;it++){for(var st=0;st<rt;st++)if(_e[it+st]!==tt[st])continue e;return it}return-1}function addStringToPool(tt,_e){var rt=findSubArray(tt,_e);if(rt<0){rt=_e.length;for(var nt=0,it=tt.length;nt<it;++nt)_e.push(tt[nt])}return rt}function makeNameTable(tt,_e){var rt,nt=[],it={},st=reverseDict(nameTableNames);for(var ot in tt){var lt=st[ot];if(lt===void 0&&(lt=ot),rt=parseInt(lt),isNaN(rt))throw new Error('Name table entry "'+ot+'" does not exist, see nameTableNames for complete list.');it[rt]=tt[ot],nt.push(rt)}for(var at=reverseDict(macLanguages),ct=reverseDict(windowsLanguages),ut=[],ht=[],dt=0;dt<nt.length;dt++){rt=nt[dt];var ft=it[rt];for(var pt in ft){var mt=ft[pt],gt=1,vt=at[pt],At=macLanguageToScript[vt],yt=getEncoding(gt,At,vt),xt=encode.MACSTRING(mt,yt);xt===void 0&&(gt=0,vt=_e.indexOf(pt),vt<0&&(vt=_e.length,_e.push(pt)),At=4,xt=encode.UTF16(mt));var _t=addStringToPool(xt,ht);ut.push(makeNameRecord(gt,At,vt,rt,xt.length,_t));var Et=ct[pt];if(Et!==void 0){var bt=encode.UTF16(mt),wt=addStringToPool(bt,ht);ut.push(makeNameRecord(3,1,Et,rt,bt.length,wt))}}}ut.sort(function(Pt,It){return Pt.platformID-It.platformID||Pt.encodingID-It.encodingID||Pt.languageID-It.languageID||Pt.nameID-It.nameID});for(var Tt=new table.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:ut.length},{name:"stringOffset",type:"USHORT",value:6+ut.length*12}]),Mt=0;Mt<ut.length;Mt++)Tt.fields.push({name:"record_"+Mt,type:"RECORD",value:ut[Mt]});return Tt.fields.push({name:"strings",type:"LITERAL",value:ht}),Tt}var _name={parse:parseNameTable,make:makeNameTable},unicodeRanges=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function getUnicodeRange(tt){for(var _e=0;_e<unicodeRanges.length;_e+=1){var rt=unicodeRanges[_e];if(tt>=rt.begin&&tt<rt.end)return _e}return-1}function parseOS2Table(tt,_e){var rt={},nt=new parse$2.Parser(tt,_e);rt.version=nt.parseUShort(),rt.xAvgCharWidth=nt.parseShort(),rt.usWeightClass=nt.parseUShort(),rt.usWidthClass=nt.parseUShort(),rt.fsType=nt.parseUShort(),rt.ySubscriptXSize=nt.parseShort(),rt.ySubscriptYSize=nt.parseShort(),rt.ySubscriptXOffset=nt.parseShort(),rt.ySubscriptYOffset=nt.parseShort(),rt.ySuperscriptXSize=nt.parseShort(),rt.ySuperscriptYSize=nt.parseShort(),rt.ySuperscriptXOffset=nt.parseShort(),rt.ySuperscriptYOffset=nt.parseShort(),rt.yStrikeoutSize=nt.parseShort(),rt.yStrikeoutPosition=nt.parseShort(),rt.sFamilyClass=nt.parseShort(),rt.panose=[];for(var it=0;it<10;it++)rt.panose[it]=nt.parseByte();return rt.ulUnicodeRange1=nt.parseULong(),rt.ulUnicodeRange2=nt.parseULong(),rt.ulUnicodeRange3=nt.parseULong(),rt.ulUnicodeRange4=nt.parseULong(),rt.achVendID=String.fromCharCode(nt.parseByte(),nt.parseByte(),nt.parseByte(),nt.parseByte()),rt.fsSelection=nt.parseUShort(),rt.usFirstCharIndex=nt.parseUShort(),rt.usLastCharIndex=nt.parseUShort(),rt.sTypoAscender=nt.parseShort(),rt.sTypoDescender=nt.parseShort(),rt.sTypoLineGap=nt.parseShort(),rt.usWinAscent=nt.parseUShort(),rt.usWinDescent=nt.parseUShort(),rt.version>=1&&(rt.ulCodePageRange1=nt.parseULong(),rt.ulCodePageRange2=nt.parseULong()),rt.version>=2&&(rt.sxHeight=nt.parseShort(),rt.sCapHeight=nt.parseShort(),rt.usDefaultChar=nt.parseUShort(),rt.usBreakChar=nt.parseUShort(),rt.usMaxContent=nt.parseUShort()),rt}function makeOS2Table(tt){return new table.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],tt)}var os2={parse:parseOS2Table,make:makeOS2Table,unicodeRanges,getUnicodeRange};function parsePostTable(tt,_e){var rt={},nt=new parse$2.Parser(tt,_e);switch(rt.version=nt.parseVersion(),rt.italicAngle=nt.parseFixed(),rt.underlinePosition=nt.parseShort(),rt.underlineThickness=nt.parseShort(),rt.isFixedPitch=nt.parseULong(),rt.minMemType42=nt.parseULong(),rt.maxMemType42=nt.parseULong(),rt.minMemType1=nt.parseULong(),rt.maxMemType1=nt.parseULong(),rt.version){case 1:rt.names=standardNames.slice();break;case 2:rt.numberOfGlyphs=nt.parseUShort(),rt.glyphNameIndex=new Array(rt.numberOfGlyphs);for(var it=0;it<rt.numberOfGlyphs;it++)rt.glyphNameIndex[it]=nt.parseUShort();rt.names=[];for(var st=0;st<rt.numberOfGlyphs;st++)if(rt.glyphNameIndex[st]>=standardNames.length){var ot=nt.parseChar();rt.names.push(nt.parseString(ot))}break;case 2.5:rt.numberOfGlyphs=nt.parseUShort(),rt.offset=new Array(rt.numberOfGlyphs);for(var lt=0;lt<rt.numberOfGlyphs;lt++)rt.offset[lt]=nt.parseChar();break}return rt}function makePostTable(){return new table.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var post={parse:parsePostTable,make:makePostTable},subtableParsers=new Array(9);subtableParsers[1]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();if(rt===1)return{substFormat:1,coverage:this.parsePointer(Parser$1.coverage),deltaGlyphId:this.parseUShort()};if(rt===2)return{substFormat:2,coverage:this.parsePointer(Parser$1.coverage),substitute:this.parseOffset16List()};check.assert(!1,"0x"+_e.toString(16)+": lookup type 1 format must be 1 or 2.")};subtableParsers[2]=function(){var _e=this.parseUShort();return check.argument(_e===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:_e,coverage:this.parsePointer(Parser$1.coverage),sequences:this.parseListOfLists()}};subtableParsers[3]=function(){var _e=this.parseUShort();return check.argument(_e===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:_e,coverage:this.parsePointer(Parser$1.coverage),alternateSets:this.parseListOfLists()}};subtableParsers[4]=function(){var _e=this.parseUShort();return check.argument(_e===1,"GSUB ligature table identifier-format must be 1"),{substFormat:_e,coverage:this.parsePointer(Parser$1.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var lookupRecordDesc={sequenceIndex:Parser$1.uShort,lookupListIndex:Parser$1.uShort};subtableParsers[5]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();if(rt===1)return{substFormat:rt,coverage:this.parsePointer(Parser$1.coverage),ruleSets:this.parseListOfLists(function(){var st=this.parseUShort(),ot=this.parseUShort();return{input:this.parseUShortList(st-1),lookupRecords:this.parseRecordList(ot,lookupRecordDesc)}})};if(rt===2)return{substFormat:rt,coverage:this.parsePointer(Parser$1.coverage),classDef:this.parsePointer(Parser$1.classDef),classSets:this.parseListOfLists(function(){var st=this.parseUShort(),ot=this.parseUShort();return{classes:this.parseUShortList(st-1),lookupRecords:this.parseRecordList(ot,lookupRecordDesc)}})};if(rt===3){var nt=this.parseUShort(),it=this.parseUShort();return{substFormat:rt,coverages:this.parseList(nt,Parser$1.pointer(Parser$1.coverage)),lookupRecords:this.parseRecordList(it,lookupRecordDesc)}}check.assert(!1,"0x"+_e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")};subtableParsers[6]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();if(rt===1)return{substFormat:1,coverage:this.parsePointer(Parser$1.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)}})};if(rt===2)return{substFormat:2,coverage:this.parsePointer(Parser$1.coverage),backtrackClassDef:this.parsePointer(Parser$1.classDef),inputClassDef:this.parsePointer(Parser$1.classDef),lookaheadClassDef:this.parsePointer(Parser$1.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)}})};if(rt===3)return{substFormat:3,backtrackCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),inputCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),lookaheadCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),lookupRecords:this.parseRecordList(lookupRecordDesc)};check.assert(!1,"0x"+_e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")};subtableParsers[7]=function(){var _e=this.parseUShort();check.argument(_e===1,"GSUB Extension Substitution subtable identifier-format must be 1");var rt=this.parseUShort(),nt=new Parser$1(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:rt,extension:subtableParsers[rt].call(nt)}};subtableParsers[8]=function(){var _e=this.parseUShort();return check.argument(_e===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:_e,coverage:this.parsePointer(Parser$1.coverage),backtrackCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),lookaheadCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),substitutes:this.parseUShortList()}};function parseGsubTable(tt,_e){_e=_e||0;var rt=new Parser$1(tt,_e),nt=rt.parseVersion(1);return check.argument(nt===1||nt===1.1,"Unsupported GSUB table version."),nt===1?{version:nt,scripts:rt.parseScriptList(),features:rt.parseFeatureList(),lookups:rt.parseLookupList(subtableParsers)}:{version:nt,scripts:rt.parseScriptList(),features:rt.parseFeatureList(),lookups:rt.parseLookupList(subtableParsers),variations:rt.parseFeatureVariationsList()}}var subtableMakers=new Array(9);subtableMakers[1]=function(_e){return _e.substFormat===1?new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:_e.deltaGlyphId}]):new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.ushortList("substitute",_e.substitute)))};subtableMakers[2]=function(_e){return check.assert(_e.substFormat===1,"Lookup type 2 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.tableList("seqSet",_e.sequences,function(rt){return new table.Table("sequenceSetTable",table.ushortList("sequence",rt))})))};subtableMakers[3]=function(_e){return check.assert(_e.substFormat===1,"Lookup type 3 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.tableList("altSet",_e.alternateSets,function(rt){return new table.Table("alternateSetTable",table.ushortList("alternate",rt))})))};subtableMakers[4]=function(_e){return check.assert(_e.substFormat===1,"Lookup type 4 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.tableList("ligSet",_e.ligatureSets,function(rt){return new table.Table("ligatureSetTable",table.tableList("ligature",rt,function(nt){return new table.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:nt.ligGlyph}].concat(table.ushortList("component",nt.components,nt.components.length+1)))}))})))};subtableMakers[6]=function(_e){if(_e.substFormat===1){var rt=new table.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:_e.substFormat},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.tableList("chainRuleSet",_e.chainRuleSets,function(st){return new table.Table("chainRuleSetTable",table.tableList("chainRule",st,function(ot){var lt=table.ushortList("backtrackGlyph",ot.backtrack,ot.backtrack.length).concat(table.ushortList("inputGlyph",ot.input,ot.input.length+1)).concat(table.ushortList("lookaheadGlyph",ot.lookahead,ot.lookahead.length)).concat(table.ushortList("substitution",[],ot.lookupRecords.length));return ot.lookupRecords.forEach(function(at,ct){lt=lt.concat({name:"sequenceIndex"+ct,type:"USHORT",value:at.sequenceIndex}).concat({name:"lookupListIndex"+ct,type:"USHORT",value:at.lookupListIndex})}),new table.Table("chainRuleTable",lt)}))})));return rt}else if(_e.substFormat===2)check.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(_e.substFormat===3){var nt=[{name:"substFormat",type:"USHORT",value:_e.substFormat}];nt.push({name:"backtrackGlyphCount",type:"USHORT",value:_e.backtrackCoverage.length}),_e.backtrackCoverage.forEach(function(st,ot){nt.push({name:"backtrackCoverage"+ot,type:"TABLE",value:new table.Coverage(st)})}),nt.push({name:"inputGlyphCount",type:"USHORT",value:_e.inputCoverage.length}),_e.inputCoverage.forEach(function(st,ot){nt.push({name:"inputCoverage"+ot,type:"TABLE",value:new table.Coverage(st)})}),nt.push({name:"lookaheadGlyphCount",type:"USHORT",value:_e.lookaheadCoverage.length}),_e.lookaheadCoverage.forEach(function(st,ot){nt.push({name:"lookaheadCoverage"+ot,type:"TABLE",value:new table.Coverage(st)})}),nt.push({name:"substitutionCount",type:"USHORT",value:_e.lookupRecords.length}),_e.lookupRecords.forEach(function(st,ot){nt=nt.concat({name:"sequenceIndex"+ot,type:"USHORT",value:st.sequenceIndex}).concat({name:"lookupListIndex"+ot,type:"USHORT",value:st.lookupListIndex})});var it=new table.Table("chainContextTable",nt);return it}check.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function makeGsubTable(tt){return new table.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new table.ScriptList(tt.scripts)},{name:"features",type:"TABLE",value:new table.FeatureList(tt.features)},{name:"lookups",type:"TABLE",value:new table.LookupList(tt.lookups,subtableMakers)}])}var gsub={parse:parseGsubTable,make:makeGsubTable};function parseMetaTable(tt,_e){var rt=new parse$2.Parser(tt,_e),nt=rt.parseULong();check.argument(nt===1,"Unsupported META table version."),rt.parseULong(),rt.parseULong();for(var it=rt.parseULong(),st={},ot=0;ot<it;ot++){var lt=rt.parseTag(),at=rt.parseULong(),ct=rt.parseULong(),ut=decode.UTF8(tt,_e+at,ct);st[lt]=ut}return st}function makeMetaTable(tt){var _e=Object.keys(tt).length,rt="",nt=16+_e*12,it=new table.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:nt},{name:"numTags",type:"ULONG",value:_e}]);for(var st in tt){var ot=rt.length;rt+=tt[st],it.fields.push({name:"tag "+st,type:"TAG",value:st}),it.fields.push({name:"offset "+st,type:"ULONG",value:nt+ot}),it.fields.push({name:"length "+st,type:"ULONG",value:tt[st].length})}return it.fields.push({name:"stringPool",type:"CHARARRAY",value:rt}),it}var meta={parse:parseMetaTable,make:makeMetaTable};function log2(tt){return Math.log(tt)/Math.log(2)|0}function computeCheckSum(tt){for(;tt.length%4!==0;)tt.push(0);for(var _e=0,rt=0;rt<tt.length;rt+=4)_e+=(tt[rt]<<24)+(tt[rt+1]<<16)+(tt[rt+2]<<8)+tt[rt+3];return _e%=Math.pow(2,32),_e}function makeTableRecord(tt,_e,rt,nt){return new table.Record("Table Record",[{name:"tag",type:"TAG",value:tt!==void 0?tt:""},{name:"checkSum",type:"ULONG",value:_e!==void 0?_e:0},{name:"offset",type:"ULONG",value:rt!==void 0?rt:0},{name:"length",type:"ULONG",value:nt!==void 0?nt:0}])}function makeSfntTable(tt){var _e=new table.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);_e.tables=tt,_e.numTables=tt.length;var rt=Math.pow(2,log2(_e.numTables));_e.searchRange=16*rt,_e.entrySelector=log2(rt),_e.rangeShift=_e.numTables*16-_e.searchRange;for(var nt=[],it=[],st=_e.sizeOf()+makeTableRecord().sizeOf()*_e.numTables;st%4!==0;)st+=1,it.push({name:"padding",type:"BYTE",value:0});for(var ot=0;ot<tt.length;ot+=1){var lt=tt[ot];check.argument(lt.tableName.length===4,"Table name"+lt.tableName+" is invalid.");var at=lt.sizeOf(),ct=makeTableRecord(lt.tableName,computeCheckSum(lt.encode()),st,at);for(nt.push({name:ct.tag+" Table Record",type:"RECORD",value:ct}),it.push({name:lt.tableName+" table",type:"RECORD",value:lt}),st+=at,check.argument(!isNaN(st),"Something went wrong calculating the offset.");st%4!==0;)st+=1,it.push({name:"padding",type:"BYTE",value:0})}return nt.sort(function(ut,ht){return ut.value.tag>ht.value.tag?1:-1}),_e.fields=_e.fields.concat(nt),_e.fields=_e.fields.concat(it),_e}function metricsForChar(tt,_e,rt){for(var nt=0;nt<_e.length;nt+=1){var it=tt.charToGlyphIndex(_e[nt]);if(it>0){var st=tt.glyphs.get(it);return st.getMetrics()}}return rt}function average(tt){for(var _e=0,rt=0;rt<tt.length;rt+=1)_e+=tt[rt];return _e/tt.length}function fontToSfntTable(tt){for(var _e=[],rt=[],nt=[],it=[],st=[],ot=[],lt=[],at,ct=0,ut=0,ht=0,dt=0,ft=0,pt=0;pt<tt.glyphs.length;pt+=1){var mt=tt.glyphs.get(pt),gt=mt.unicode|0;if(isNaN(mt.advanceWidth))throw new Error("Glyph "+mt.name+" ("+pt+"): advanceWidth is not a number.");(at>gt||at===void 0)&&gt>0&&(at=gt),ct<gt&&(ct=gt);var vt=os2.getUnicodeRange(gt);if(vt<32)ut|=1<<vt;else if(vt<64)ht|=1<<vt-32;else if(vt<96)dt|=1<<vt-64;else if(vt<123)ft|=1<<vt-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(mt.name!==".notdef"){var At=mt.getMetrics();_e.push(At.xMin),rt.push(At.yMin),nt.push(At.xMax),it.push(At.yMax),ot.push(At.leftSideBearing),lt.push(At.rightSideBearing),st.push(mt.advanceWidth)}}var yt={xMin:Math.min.apply(null,_e),yMin:Math.min.apply(null,rt),xMax:Math.max.apply(null,nt),yMax:Math.max.apply(null,it),advanceWidthMax:Math.max.apply(null,st),advanceWidthAvg:average(st),minLeftSideBearing:Math.min.apply(null,ot),maxLeftSideBearing:Math.max.apply(null,ot),minRightSideBearing:Math.min.apply(null,lt)};yt.ascender=tt.ascender,yt.descender=tt.descender;var xt=head$1.make({flags:3,unitsPerEm:tt.unitsPerEm,xMin:yt.xMin,yMin:yt.yMin,xMax:yt.xMax,yMax:yt.yMax,lowestRecPPEM:3,createdTimestamp:tt.createdTimestamp}),_t=hhea.make({ascender:yt.ascender,descender:yt.descender,advanceWidthMax:yt.advanceWidthMax,minLeftSideBearing:yt.minLeftSideBearing,minRightSideBearing:yt.minRightSideBearing,xMaxExtent:yt.maxLeftSideBearing+(yt.xMax-yt.xMin),numberOfHMetrics:tt.glyphs.length}),Et=maxp.make(tt.glyphs.length),bt=os2.make(Object.assign({xAvgCharWidth:Math.round(yt.advanceWidthAvg),usFirstCharIndex:at,usLastCharIndex:ct,ulUnicodeRange1:ut,ulUnicodeRange2:ht,ulUnicodeRange3:dt,ulUnicodeRange4:ft,sTypoAscender:yt.ascender,sTypoDescender:yt.descender,sTypoLineGap:0,usWinAscent:yt.yMax,usWinDescent:Math.abs(yt.yMin),ulCodePageRange1:1,sxHeight:metricsForChar(tt,"xyvw",{yMax:Math.round(yt.ascender/2)}).yMax,sCapHeight:metricsForChar(tt,"HIKLEFJMNTZBDPRAGOQSUVWXY",yt).yMax,usDefaultChar:tt.hasChar(" ")?32:0,usBreakChar:tt.hasChar(" ")?32:0},tt.tables.os2)),wt=hmtx.make(tt.glyphs),Tt=cmap.make(tt.glyphs),Mt=tt.getEnglishName("fontFamily"),Pt=tt.getEnglishName("fontSubfamily"),It=Mt+" "+Pt,Ot=tt.getEnglishName("postScriptName");Ot||(Ot=Mt.replace(/\s/g,"")+"-"+Pt);var Bt={};for(var Ut in tt.names)Bt[Ut]=tt.names[Ut];Bt.uniqueID||(Bt.uniqueID={en:tt.getEnglishName("manufacturer")+":"+It}),Bt.postScriptName||(Bt.postScriptName={en:Ot}),Bt.preferredFamily||(Bt.preferredFamily=tt.names.fontFamily),Bt.preferredSubfamily||(Bt.preferredSubfamily=tt.names.fontSubfamily);var Ft=[],jt=_name.make(Bt,Ft),Dt=Ft.length>0?ltag.make(Ft):void 0,Gt=post.make(),zt=cff.make(tt.glyphs,{version:tt.getEnglishName("version"),fullName:It,familyName:Mt,weightName:Pt,postScriptName:Ot,unitsPerEm:tt.unitsPerEm,fontBBox:[0,yt.yMin,yt.ascender,yt.advanceWidthMax]}),$t=tt.metas&&Object.keys(tt.metas).length>0?meta.make(tt.metas):void 0,Ht=[xt,_t,Et,bt,jt,Tt,Gt,zt,wt];Dt&&Ht.push(Dt),tt.tables.gsub&&Ht.push(gsub.make(tt.tables.gsub)),$t&&Ht.push($t);for(var er=makeSfntTable(Ht),Zt=er.encode(),or=computeCheckSum(Zt),Kt=er.fields,rr=!1,ur=0;ur<Kt.length;ur+=1)if(Kt[ur].name==="head table"){Kt[ur].value.checkSumAdjustment=2981146554-or,rr=!0;break}if(!rr)throw new Error("Could not find head table with checkSum to adjust.");return er}var sfnt={make:makeSfntTable,fontToTable:fontToSfntTable,computeCheckSum};function searchTag(tt,_e){for(var rt=0,nt=tt.length-1;rt<=nt;){var it=rt+nt>>>1,st=tt[it].tag;if(st===_e)return it;st<_e?rt=it+1:nt=it-1}return-rt-1}function binSearch(tt,_e){for(var rt=0,nt=tt.length-1;rt<=nt;){var it=rt+nt>>>1,st=tt[it];if(st===_e)return it;st<_e?rt=it+1:nt=it-1}return-rt-1}function searchRange(tt,_e){for(var rt,nt=0,it=tt.length-1;nt<=it;){var st=nt+it>>>1;rt=tt[st];var ot=rt.start;if(ot===_e)return rt;ot<_e?nt=st+1:it=st-1}if(nt>0)return rt=tt[nt-1],_e>rt.end?0:rt}function Layout(tt,_e){this.font=tt,this.tableName=_e}Layout.prototype={searchTag,binSearch,getTable:function(tt){var _e=this.font.tables[this.tableName];return!_e&&tt&&(_e=this.font.tables[this.tableName]=this.createDefaultTable()),_e},getScriptNames:function(){var tt=this.getTable();return tt?tt.scripts.map(function(_e){return _e.tag}):[]},getDefaultScriptName:function(){var tt=this.getTable();if(tt){for(var _e=!1,rt=0;rt<tt.scripts.length;rt++){var nt=tt.scripts[rt].tag;if(nt==="DFLT")return nt;nt==="latn"&&(_e=!0)}if(_e)return"latn"}},getScriptTable:function(tt,_e){var rt=this.getTable(_e);if(rt){tt=tt||"DFLT";var nt=rt.scripts,it=searchTag(rt.scripts,tt);if(it>=0)return nt[it].script;if(_e){var st={tag:tt,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return nt.splice(-1-it,0,st),st.script}}},getLangSysTable:function(tt,_e,rt){var nt=this.getScriptTable(tt,rt);if(nt){if(!_e||_e==="dflt"||_e==="DFLT")return nt.defaultLangSys;var it=searchTag(nt.langSysRecords,_e);if(it>=0)return nt.langSysRecords[it].langSys;if(rt){var st={tag:_e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return nt.langSysRecords.splice(-1-it,0,st),st.langSys}}},getFeatureTable:function(tt,_e,rt,nt){var it=this.getLangSysTable(tt,_e,nt);if(it){for(var st,ot=it.featureIndexes,lt=this.font.tables[this.tableName].features,at=0;at<ot.length;at++)if(st=lt[ot[at]],st.tag===rt)return st.feature;if(nt){var ct=lt.length;return check.assert(ct===0||rt>=lt[ct-1].tag,"Features must be added in alphabetical order."),st={tag:rt,feature:{params:0,lookupListIndexes:[]}},lt.push(st),ot.push(ct),st.feature}}},getLookupTables:function(tt,_e,rt,nt,it){var st=this.getFeatureTable(tt,_e,rt,it),ot=[];if(st){for(var lt,at=st.lookupListIndexes,ct=this.font.tables[this.tableName].lookups,ut=0;ut<at.length;ut++)lt=ct[at[ut]],lt.lookupType===nt&&ot.push(lt);if(ot.length===0&&it){lt={lookupType:nt,lookupFlag:0,subtables:[],markFilteringSet:void 0};var ht=ct.length;return ct.push(lt),at.push(ht),[lt]}}return ot},getGlyphClass:function(tt,_e){switch(tt.format){case 1:return tt.startGlyph<=_e&&_e<tt.startGlyph+tt.classes.length?tt.classes[_e-tt.startGlyph]:0;case 2:var rt=searchRange(tt.ranges,_e);return rt?rt.classId:0}},getCoverageIndex:function(tt,_e){switch(tt.format){case 1:var rt=binSearch(tt.glyphs,_e);return rt>=0?rt:-1;case 2:var nt=searchRange(tt.ranges,_e);return nt?nt.index+_e-nt.start:-1}},expandCoverage:function(tt){if(tt.format===1)return tt.glyphs;for(var _e=[],rt=tt.ranges,nt=0;nt<rt.length;nt++)for(var it=rt[nt],st=it.start,ot=it.end,lt=st;lt<=ot;lt++)_e.push(lt);return _e}};function Position(tt){Layout.call(this,tt,"gpos")}Position.prototype=Layout.prototype;Position.prototype.init=function(){var tt=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(tt)};Position.prototype.getKerningValue=function(tt,_e,rt){for(var nt=0;nt<tt.length;nt++)for(var it=tt[nt].subtables,st=0;st<it.length;st++){var ot=it[st],lt=this.getCoverageIndex(ot.coverage,_e);if(!(lt<0))switch(ot.posFormat){case 1:for(var at=ot.pairSets[lt],ct=0;ct<at.length;ct++){var ut=at[ct];if(ut.secondGlyph===rt)return ut.value1&&ut.value1.xAdvance||0}break;case 2:var ht=this.getGlyphClass(ot.classDef1,_e),dt=this.getGlyphClass(ot.classDef2,rt),ft=ot.classRecords[ht][dt];return ft.value1&&ft.value1.xAdvance||0}}return 0};Position.prototype.getKerningTables=function(tt,_e){if(this.font.tables.gpos)return this.getLookupTables(tt,_e,"kern",2)};function Substitution(tt){Layout.call(this,tt,"gsub")}function arraysEqual(tt,_e){var rt=tt.length;if(rt!==_e.length)return!1;for(var nt=0;nt<rt;nt++)if(tt[nt]!==_e[nt])return!1;return!0}function getSubstFormat(tt,_e,rt){for(var nt=tt.subtables,it=0;it<nt.length;it++){var st=nt[it];if(st.substFormat===_e)return st}if(rt)return nt.push(rt),rt}Substitution.prototype=Layout.prototype;Substitution.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}};Substitution.prototype.getSingle=function(tt,_e,rt){for(var nt=[],it=this.getLookupTables(_e,rt,tt,1),st=0;st<it.length;st++)for(var ot=it[st].subtables,lt=0;lt<ot.length;lt++){var at=ot[lt],ct=this.expandCoverage(at.coverage),ut=void 0;if(at.substFormat===1){var ht=at.deltaGlyphId;for(ut=0;ut<ct.length;ut++){var dt=ct[ut];nt.push({sub:dt,by:dt+ht})}}else{var ft=at.substitute;for(ut=0;ut<ct.length;ut++)nt.push({sub:ct[ut],by:ft[ut]})}}return nt};Substitution.prototype.getMultiple=function(tt,_e,rt){for(var nt=[],it=this.getLookupTables(_e,rt,tt,2),st=0;st<it.length;st++)for(var ot=it[st].subtables,lt=0;lt<ot.length;lt++){var at=ot[lt],ct=this.expandCoverage(at.coverage),ut=void 0;for(ut=0;ut<ct.length;ut++){var ht=ct[ut],dt=at.sequences[ut];nt.push({sub:ht,by:dt})}}return nt};Substitution.prototype.getAlternates=function(tt,_e,rt){for(var nt=[],it=this.getLookupTables(_e,rt,tt,3),st=0;st<it.length;st++)for(var ot=it[st].subtables,lt=0;lt<ot.length;lt++)for(var at=ot[lt],ct=this.expandCoverage(at.coverage),ut=at.alternateSets,ht=0;ht<ct.length;ht++)nt.push({sub:ct[ht],by:ut[ht]});return nt};Substitution.prototype.getLigatures=function(tt,_e,rt){for(var nt=[],it=this.getLookupTables(_e,rt,tt,4),st=0;st<it.length;st++)for(var ot=it[st].subtables,lt=0;lt<ot.length;lt++)for(var at=ot[lt],ct=this.expandCoverage(at.coverage),ut=at.ligatureSets,ht=0;ht<ct.length;ht++)for(var dt=ct[ht],ft=ut[ht],pt=0;pt<ft.length;pt++){var mt=ft[pt];nt.push({sub:[dt].concat(mt.components),by:mt.ligGlyph})}return nt};Substitution.prototype.addSingle=function(tt,_e,rt,nt){var it=this.getLookupTables(rt,nt,tt,1,!0)[0],st=getSubstFormat(it,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});check.assert(st.coverage.format===1,"Single: unable to modify coverage table format "+st.coverage.format);var ot=_e.sub,lt=this.binSearch(st.coverage.glyphs,ot);lt<0&&(lt=-1-lt,st.coverage.glyphs.splice(lt,0,ot),st.substitute.splice(lt,0,0)),st.substitute[lt]=_e.by};Substitution.prototype.addMultiple=function(tt,_e,rt,nt){check.assert(_e.by instanceof Array&&_e.by.length>1,'Multiple: "by" must be an array of two or more ids');var it=this.getLookupTables(rt,nt,tt,2,!0)[0],st=getSubstFormat(it,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});check.assert(st.coverage.format===1,"Multiple: unable to modify coverage table format "+st.coverage.format);var ot=_e.sub,lt=this.binSearch(st.coverage.glyphs,ot);lt<0&&(lt=-1-lt,st.coverage.glyphs.splice(lt,0,ot),st.sequences.splice(lt,0,0)),st.sequences[lt]=_e.by};Substitution.prototype.addAlternate=function(tt,_e,rt,nt){var it=this.getLookupTables(rt,nt,tt,3,!0)[0],st=getSubstFormat(it,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});check.assert(st.coverage.format===1,"Alternate: unable to modify coverage table format "+st.coverage.format);var ot=_e.sub,lt=this.binSearch(st.coverage.glyphs,ot);lt<0&&(lt=-1-lt,st.coverage.glyphs.splice(lt,0,ot),st.alternateSets.splice(lt,0,0)),st.alternateSets[lt]=_e.by};Substitution.prototype.addLigature=function(tt,_e,rt,nt){var it=this.getLookupTables(rt,nt,tt,4,!0)[0],st=it.subtables[0];st||(st={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},it.subtables[0]=st),check.assert(st.coverage.format===1,"Ligature: unable to modify coverage table format "+st.coverage.format);var ot=_e.sub[0],lt=_e.sub.slice(1),at={ligGlyph:_e.by,components:lt},ct=this.binSearch(st.coverage.glyphs,ot);if(ct>=0){for(var ut=st.ligatureSets[ct],ht=0;ht<ut.length;ht++)if(arraysEqual(ut[ht].components,lt))return;ut.push(at)}else ct=-1-ct,st.coverage.glyphs.splice(ct,0,ot),st.ligatureSets.splice(ct,0,[at])};Substitution.prototype.getFeature=function(tt,_e,rt){if(/ss\d\d/.test(tt))return this.getSingle(tt,_e,rt);switch(tt){case"aalt":case"salt":return this.getSingle(tt,_e,rt).concat(this.getAlternates(tt,_e,rt));case"dlig":case"liga":case"rlig":return this.getLigatures(tt,_e,rt);case"ccmp":return this.getMultiple(tt,_e,rt).concat(this.getLigatures(tt,_e,rt));case"stch":return this.getMultiple(tt,_e,rt)}};Substitution.prototype.add=function(tt,_e,rt,nt){if(/ss\d\d/.test(tt))return this.addSingle(tt,_e,rt,nt);switch(tt){case"aalt":case"salt":return typeof _e.by=="number"?this.addSingle(tt,_e,rt,nt):this.addAlternate(tt,_e,rt,nt);case"dlig":case"liga":case"rlig":return this.addLigature(tt,_e,rt,nt);case"ccmp":return _e.by instanceof Array?this.addMultiple(tt,_e,rt,nt):this.addLigature(tt,_e,rt,nt)}};function isBrowser$1(){return typeof window<"u"}function arrayBufferToNodeBuffer(tt){for(var _e=new Buffer(tt.byteLength),rt=new Uint8Array(tt),nt=0;nt<_e.length;++nt)_e[nt]=rt[nt];return _e}function checkArgument(tt,_e){if(!tt)throw _e}function parseGlyphCoordinate(tt,_e,rt,nt,it){var st;return(_e&nt)>0?(st=tt.parseByte(),_e&it||(st=-st),st=rt+st):(_e&it)>0?st=rt:st=rt+tt.parseShort(),st}function parseGlyph(tt,_e,rt){var nt=new parse$2.Parser(_e,rt);tt.numberOfContours=nt.parseShort(),tt._xMin=nt.parseShort(),tt._yMin=nt.parseShort(),tt._xMax=nt.parseShort(),tt._yMax=nt.parseShort();var it,st;if(tt.numberOfContours>0){for(var ot=tt.endPointIndices=[],lt=0;lt<tt.numberOfContours;lt+=1)ot.push(nt.parseUShort());tt.instructionLength=nt.parseUShort(),tt.instructions=[];for(var at=0;at<tt.instructionLength;at+=1)tt.instructions.push(nt.parseByte());var ct=ot[ot.length-1]+1;it=[];for(var ut=0;ut<ct;ut+=1)if(st=nt.parseByte(),it.push(st),(st&8)>0)for(var ht=nt.parseByte(),dt=0;dt<ht;dt+=1)it.push(st),ut+=1;if(check.argument(it.length===ct,"Bad flags."),ot.length>0){var ft=[],pt;if(ct>0){for(var mt=0;mt<ct;mt+=1)st=it[mt],pt={},pt.onCurve=!!(st&1),pt.lastPointOfContour=ot.indexOf(mt)>=0,ft.push(pt);for(var gt=0,vt=0;vt<ct;vt+=1)st=it[vt],pt=ft[vt],pt.x=parseGlyphCoordinate(nt,st,gt,2,16),gt=pt.x;for(var At=0,yt=0;yt<ct;yt+=1)st=it[yt],pt=ft[yt],pt.y=parseGlyphCoordinate(nt,st,At,4,32),At=pt.y}tt.points=ft}else tt.points=[]}else if(tt.numberOfContours===0)tt.points=[];else{tt.isComposite=!0,tt.points=[],tt.components=[];for(var xt=!0;xt;){it=nt.parseUShort();var _t={glyphIndex:nt.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(it&1)>0?(it&2)>0?(_t.dx=nt.parseShort(),_t.dy=nt.parseShort()):_t.matchedPoints=[nt.parseUShort(),nt.parseUShort()]:(it&2)>0?(_t.dx=nt.parseChar(),_t.dy=nt.parseChar()):_t.matchedPoints=[nt.parseByte(),nt.parseByte()],(it&8)>0?_t.xScale=_t.yScale=nt.parseF2Dot14():(it&64)>0?(_t.xScale=nt.parseF2Dot14(),_t.yScale=nt.parseF2Dot14()):(it&128)>0&&(_t.xScale=nt.parseF2Dot14(),_t.scale01=nt.parseF2Dot14(),_t.scale10=nt.parseF2Dot14(),_t.yScale=nt.parseF2Dot14()),tt.components.push(_t),xt=!!(it&32)}if(it&256){tt.instructionLength=nt.parseUShort(),tt.instructions=[];for(var Et=0;Et<tt.instructionLength;Et+=1)tt.instructions.push(nt.parseByte())}}}function transformPoints(tt,_e){for(var rt=[],nt=0;nt<tt.length;nt+=1){var it=tt[nt],st={x:_e.xScale*it.x+_e.scale01*it.y+_e.dx,y:_e.scale10*it.x+_e.yScale*it.y+_e.dy,onCurve:it.onCurve,lastPointOfContour:it.lastPointOfContour};rt.push(st)}return rt}function getContours(tt){for(var _e=[],rt=[],nt=0;nt<tt.length;nt+=1){var it=tt[nt];rt.push(it),it.lastPointOfContour&&(_e.push(rt),rt=[])}return check.argument(rt.length===0,"There are still points left in the current contour."),_e}function getPath(tt){var _e=new Path;if(!tt)return _e;for(var rt=getContours(tt),nt=0;nt<rt.length;++nt){var it=rt[nt],st=null,ot=it[it.length-1],lt=it[0];if(ot.onCurve)_e.moveTo(ot.x,ot.y);else if(lt.onCurve)_e.moveTo(lt.x,lt.y);else{var at={x:(ot.x+lt.x)*.5,y:(ot.y+lt.y)*.5};_e.moveTo(at.x,at.y)}for(var ct=0;ct<it.length;++ct)if(st=ot,ot=lt,lt=it[(ct+1)%it.length],ot.onCurve)_e.lineTo(ot.x,ot.y);else{var ut=lt;st.onCurve||((ot.x+st.x)*.5,(ot.y+st.y)*.5),lt.onCurve||(ut={x:(ot.x+lt.x)*.5,y:(ot.y+lt.y)*.5}),_e.quadraticCurveTo(ot.x,ot.y,ut.x,ut.y)}_e.closePath()}return _e}function buildPath(tt,_e){if(_e.isComposite)for(var rt=0;rt<_e.components.length;rt+=1){var nt=_e.components[rt],it=tt.get(nt.glyphIndex);if(it.getPath(),it.points){var st=void 0;if(nt.matchedPoints===void 0)st=transformPoints(it.points,nt);else{if(nt.matchedPoints[0]>_e.points.length-1||nt.matchedPoints[1]>it.points.length-1)throw Error("Matched points out of range in "+_e.name);var ot=_e.points[nt.matchedPoints[0]],lt=it.points[nt.matchedPoints[1]],at={xScale:nt.xScale,scale01:nt.scale01,scale10:nt.scale10,yScale:nt.yScale,dx:0,dy:0};lt=transformPoints([lt],at)[0],at.dx=ot.x-lt.x,at.dy=ot.y-lt.y,st=transformPoints(it.points,at)}_e.points=_e.points.concat(st)}}return getPath(_e.points)}function parseGlyfTableAll(tt,_e,rt,nt){for(var it=new glyphset.GlyphSet(nt),st=0;st<rt.length-1;st+=1){var ot=rt[st],lt=rt[st+1];ot!==lt?it.push(st,glyphset.ttfGlyphLoader(nt,st,parseGlyph,tt,_e+ot,buildPath)):it.push(st,glyphset.glyphLoader(nt,st))}return it}function parseGlyfTableOnLowMemory(tt,_e,rt,nt){var it=new glyphset.GlyphSet(nt);return nt._push=function(st){var ot=rt[st],lt=rt[st+1];ot!==lt?it.push(st,glyphset.ttfGlyphLoader(nt,st,parseGlyph,tt,_e+ot,buildPath)):it.push(st,glyphset.glyphLoader(nt,st))},it}function parseGlyfTable(tt,_e,rt,nt,it){return it.lowMemory?parseGlyfTableOnLowMemory(tt,_e,rt,nt):parseGlyfTableAll(tt,_e,rt,nt)}var glyf={getPath,parse:parseGlyfTable},instructionTable,exec,execGlyph,execComponent;function Hinting(tt){this.font=tt,this.getCommands=function(_e){return glyf.getPath(_e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function roundOff(tt){return tt}function roundToGrid(tt){return Math.sign(tt)*Math.round(Math.abs(tt))}function roundToDoubleGrid(tt){return Math.sign(tt)*Math.round(Math.abs(tt*2))/2}function roundToHalfGrid(tt){return Math.sign(tt)*(Math.round(Math.abs(tt)+.5)-.5)}function roundUpToGrid(tt){return Math.sign(tt)*Math.ceil(Math.abs(tt))}function roundDownToGrid(tt){return Math.sign(tt)*Math.floor(Math.abs(tt))}var roundSuper=function(tt){var _e=this.srPeriod,rt=this.srPhase,nt=this.srThreshold,it=1;return tt<0&&(tt=-tt,it=-1),tt+=nt-rt,tt=Math.trunc(tt/_e)*_e,tt+=rt,tt<0?rt*it:tt*it},xUnitVector={x:1,y:0,axis:"x",distance:function(tt,_e,rt,nt){return(rt?tt.xo:tt.x)-(nt?_e.xo:_e.x)},interpolate:function(tt,_e,rt,nt){var it,st,ot,lt,at,ct,ut;if(!nt||nt===this){if(it=tt.xo-_e.xo,st=tt.xo-rt.xo,at=_e.x-_e.xo,ct=rt.x-rt.xo,ot=Math.abs(it),lt=Math.abs(st),ut=ot+lt,ut===0){tt.x=tt.xo+(at+ct)/2;return}tt.x=tt.xo+(at*lt+ct*ot)/ut;return}if(it=nt.distance(tt,_e,!0,!0),st=nt.distance(tt,rt,!0,!0),at=nt.distance(_e,_e,!1,!0),ct=nt.distance(rt,rt,!1,!0),ot=Math.abs(it),lt=Math.abs(st),ut=ot+lt,ut===0){xUnitVector.setRelative(tt,tt,(at+ct)/2,nt,!0);return}xUnitVector.setRelative(tt,tt,(at*lt+ct*ot)/ut,nt,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(tt,_e,rt,nt,it){if(!nt||nt===this){tt.x=(it?_e.xo:_e.x)+rt;return}var st=it?_e.xo:_e.x,ot=it?_e.yo:_e.y,lt=st+rt*nt.x,at=ot+rt*nt.y;tt.x=lt+(tt.y-at)/nt.normalSlope},slope:0,touch:function(tt){tt.xTouched=!0},touched:function(tt){return tt.xTouched},untouch:function(tt){tt.xTouched=!1}},yUnitVector={x:0,y:1,axis:"y",distance:function(tt,_e,rt,nt){return(rt?tt.yo:tt.y)-(nt?_e.yo:_e.y)},interpolate:function(tt,_e,rt,nt){var it,st,ot,lt,at,ct,ut;if(!nt||nt===this){if(it=tt.yo-_e.yo,st=tt.yo-rt.yo,at=_e.y-_e.yo,ct=rt.y-rt.yo,ot=Math.abs(it),lt=Math.abs(st),ut=ot+lt,ut===0){tt.y=tt.yo+(at+ct)/2;return}tt.y=tt.yo+(at*lt+ct*ot)/ut;return}if(it=nt.distance(tt,_e,!0,!0),st=nt.distance(tt,rt,!0,!0),at=nt.distance(_e,_e,!1,!0),ct=nt.distance(rt,rt,!1,!0),ot=Math.abs(it),lt=Math.abs(st),ut=ot+lt,ut===0){yUnitVector.setRelative(tt,tt,(at+ct)/2,nt,!0);return}yUnitVector.setRelative(tt,tt,(at*lt+ct*ot)/ut,nt,!0)},normalSlope:0,setRelative:function(tt,_e,rt,nt,it){if(!nt||nt===this){tt.y=(it?_e.yo:_e.y)+rt;return}var st=it?_e.xo:_e.x,ot=it?_e.yo:_e.y,lt=st+rt*nt.x,at=ot+rt*nt.y;tt.y=at+nt.normalSlope*(tt.x-lt)},slope:Number.POSITIVE_INFINITY,touch:function(tt){tt.yTouched=!0},touched:function(tt){return tt.yTouched},untouch:function(tt){tt.yTouched=!1}};Object.freeze(xUnitVector);Object.freeze(yUnitVector);function UnitVector(tt,_e){this.x=tt,this.y=_e,this.axis=void 0,this.slope=_e/tt,this.normalSlope=-tt/_e,Object.freeze(this)}UnitVector.prototype.distance=function(tt,_e,rt,nt){return this.x*xUnitVector.distance(tt,_e,rt,nt)+this.y*yUnitVector.distance(tt,_e,rt,nt)};UnitVector.prototype.interpolate=function(tt,_e,rt,nt){var it,st,ot,lt,at,ct,ut;if(ot=nt.distance(tt,_e,!0,!0),lt=nt.distance(tt,rt,!0,!0),it=nt.distance(_e,_e,!1,!0),st=nt.distance(rt,rt,!1,!0),at=Math.abs(ot),ct=Math.abs(lt),ut=at+ct,ut===0){this.setRelative(tt,tt,(it+st)/2,nt,!0);return}this.setRelative(tt,tt,(it*ct+st*at)/ut,nt,!0)};UnitVector.prototype.setRelative=function(tt,_e,rt,nt,it){nt=nt||this;var st=it?_e.xo:_e.x,ot=it?_e.yo:_e.y,lt=st+rt*nt.x,at=ot+rt*nt.y,ct=nt.normalSlope,ut=this.slope,ht=tt.x,dt=tt.y;tt.x=(ut*ht-ct*lt+at-dt)/(ut-ct),tt.y=ut*(tt.x-ht)+dt};UnitVector.prototype.touch=function(tt){tt.xTouched=!0,tt.yTouched=!0};function getUnitVector(tt,_e){var rt=Math.sqrt(tt*tt+_e*_e);return tt/=rt,_e/=rt,tt===1&&_e===0?xUnitVector:tt===0&&_e===1?yUnitVector:new UnitVector(tt,_e)}function HPoint(tt,_e,rt,nt){this.x=this.xo=Math.round(tt*64)/64,this.y=this.yo=Math.round(_e*64)/64,this.lastPointOfContour=rt,this.onCurve=nt,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}HPoint.prototype.nextTouched=function(tt){for(var _e=this.nextPointOnContour;!tt.touched(_e)&&_e!==this;)_e=_e.nextPointOnContour;return _e};HPoint.prototype.prevTouched=function(tt){for(var _e=this.prevPointOnContour;!tt.touched(_e)&&_e!==this;)_e=_e.prevPointOnContour;return _e};var HPZero=Object.freeze(new HPoint(0,0)),defaultState={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function State(tt,_e){switch(this.env=tt,this.stack=[],this.prog=_e,tt){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=xUnitVector,this.round=roundToGrid}}Hinting.prototype.exec=function(tt,_e){if(typeof _e!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var rt=this.font,nt=this._prepState;if(!nt||nt.ppem!==_e){var it=this._fpgmState;if(!it){State.prototype=defaultState,it=this._fpgmState=new State("fpgm",rt.tables.fpgm),it.funcs=[],it.font=rt,exports.DEBUG&&(console.log("---EXEC FPGM---"),it.step=-1);try{exec(it)}catch(ct){console.log("Hinting error in FPGM:"+ct),this._errorState=3;return}}State.prototype=it,nt=this._prepState=new State("prep",rt.tables.prep),nt.ppem=_e;var st=rt.tables.cvt;if(st)for(var ot=nt.cvt=new Array(st.length),lt=_e/rt.unitsPerEm,at=0;at<st.length;at++)ot[at]=st[at]*lt;else nt.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),nt.step=-1);try{exec(nt)}catch(ct){this._errorState<2&&console.log("Hinting error in PREP:"+ct),this._errorState=2}}if(!(this._errorState>1))try{return execGlyph(tt,nt)}catch(ct){this._errorState<1&&(console.log("Hinting error:"+ct),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}};execGlyph=function(tt,_e){var rt=_e.ppem/_e.font.unitsPerEm,nt=rt,it=tt.components,st,ot,lt;if(State.prototype=_e,!it)lt=new State("glyf",tt.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),lt.step=-1),execComponent(tt,lt,rt,nt),ot=lt.gZone;else{var at=_e.font;ot=[],st=[];for(var ct=0;ct<it.length;ct++){var ut=it[ct],ht=at.glyphs.get(ut.glyphIndex);lt=new State("glyf",ht.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+ct+"---"),lt.step=-1),execComponent(ht,lt,rt,nt);for(var dt=Math.round(ut.dx*rt),ft=Math.round(ut.dy*nt),pt=lt.gZone,mt=lt.contours,gt=0;gt<pt.length;gt++){var vt=pt[gt];vt.xTouched=vt.yTouched=!1,vt.xo=vt.x=vt.x+dt,vt.yo=vt.y=vt.y+ft}var At=ot.length;ot.push.apply(ot,pt);for(var yt=0;yt<mt.length;yt++)st.push(mt[yt]+At)}tt.instructions&&!lt.inhibitGridFit&&(lt=new State("glyf",tt.instructions),lt.gZone=lt.z0=lt.z1=lt.z2=ot,lt.contours=st,ot.push(new HPoint(0,0),new HPoint(Math.round(tt.advanceWidth*rt),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),lt.step=-1),exec(lt),ot.length-=2)}return ot};execComponent=function(tt,_e,rt,nt){for(var it=tt.points||[],st=it.length,ot=_e.gZone=_e.z0=_e.z1=_e.z2=[],lt=_e.contours=[],at,ct=0;ct<st;ct++)at=it[ct],ot[ct]=new HPoint(at.x*rt,at.y*nt,at.lastPointOfContour,at.onCurve);for(var ut,ht,dt=0;dt<st;dt++)at=ot[dt],ut||(ut=at,lt.push(dt)),at.lastPointOfContour?(at.nextPointOnContour=ut,ut.prevPointOnContour=at,ut=void 0):(ht=ot[dt+1],at.nextPointOnContour=ht,ht.prevPointOnContour=at);if(!_e.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",_e.stack);for(var ft=0;ft<st;ft++)console.log(ft,ot[ft].x,ot[ft].y)}if(ot.push(new HPoint(0,0),new HPoint(Math.round(tt.advanceWidth*rt),0)),exec(_e),ot.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",_e.stack);for(var pt=0;pt<st;pt++)console.log(pt,ot[pt].x,ot[pt].y)}}};exec=function(tt){var _e=tt.prog;if(_e){var rt=_e.length,nt;for(tt.ip=0;tt.ip<rt;tt.ip++){if(exports.DEBUG&&tt.step++,nt=instructionTable[_e[tt.ip]],!nt)throw new Error("unknown instruction: 0x"+Number(_e[tt.ip]).toString(16));nt(tt)}}};function initTZone(tt){for(var _e=tt.tZone=new Array(tt.gZone.length),rt=0;rt<_e.length;rt++)_e[rt]=new HPoint(0,0)}function skip(tt,_e){var rt=tt.prog,nt=tt.ip,it=1,st;do if(st=rt[++nt],st===88)it++;else if(st===89)it--;else if(st===64)nt+=rt[nt+1]+1;else if(st===65)nt+=2*rt[nt+1]+1;else if(st>=176&&st<=183)nt+=st-176+1;else if(st>=184&&st<=191)nt+=(st-184+1)*2;else if(_e&&it===1&&st===27)break;while(it>0);tt.ip=nt}function SVTCA(tt,_e){exports.DEBUG&&console.log(_e.step,"SVTCA["+tt.axis+"]"),_e.fv=_e.pv=_e.dpv=tt}function SPVTCA(tt,_e){exports.DEBUG&&console.log(_e.step,"SPVTCA["+tt.axis+"]"),_e.pv=_e.dpv=tt}function SFVTCA(tt,_e){exports.DEBUG&&console.log(_e.step,"SFVTCA["+tt.axis+"]"),_e.fv=tt}function SPVTL(tt,_e){var rt=_e.stack,nt=rt.pop(),it=rt.pop(),st=_e.z2[nt],ot=_e.z1[it];exports.DEBUG&&console.log("SPVTL["+tt+"]",nt,it);var lt,at;tt?(lt=st.y-ot.y,at=ot.x-st.x):(lt=ot.x-st.x,at=ot.y-st.y),_e.pv=_e.dpv=getUnitVector(lt,at)}function SFVTL(tt,_e){var rt=_e.stack,nt=rt.pop(),it=rt.pop(),st=_e.z2[nt],ot=_e.z1[it];exports.DEBUG&&console.log("SFVTL["+tt+"]",nt,it);var lt,at;tt?(lt=st.y-ot.y,at=ot.x-st.x):(lt=ot.x-st.x,at=ot.y-st.y),_e.fv=getUnitVector(lt,at)}function SPVFS(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"SPVFS[]",rt,nt),tt.pv=tt.dpv=getUnitVector(nt,rt)}function SFVFS(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"SPVFS[]",rt,nt),tt.fv=getUnitVector(nt,rt)}function GPV(tt){var _e=tt.stack,rt=tt.pv;exports.DEBUG&&console.log(tt.step,"GPV[]"),_e.push(rt.x*16384),_e.push(rt.y*16384)}function GFV(tt){var _e=tt.stack,rt=tt.fv;exports.DEBUG&&console.log(tt.step,"GFV[]"),_e.push(rt.x*16384),_e.push(rt.y*16384)}function SFVTPV(tt){tt.fv=tt.pv,exports.DEBUG&&console.log(tt.step,"SFVTPV[]")}function ISECT(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop(),it=_e.pop(),st=_e.pop(),ot=_e.pop(),lt=tt.z0,at=tt.z1,ct=lt[rt],ut=lt[nt],ht=at[it],dt=at[st],ft=tt.z2[ot];exports.DEBUG&&console.log("ISECT[], ",rt,nt,it,st,ot);var pt=ct.x,mt=ct.y,gt=ut.x,vt=ut.y,At=ht.x,yt=ht.y,xt=dt.x,_t=dt.y,Et=(pt-gt)*(yt-_t)-(mt-vt)*(At-xt),bt=pt*vt-mt*gt,wt=At*_t-yt*xt;ft.x=(bt*(At-xt)-wt*(pt-gt))/Et,ft.y=(bt*(yt-_t)-wt*(mt-vt))/Et}function SRP0(tt){tt.rp0=tt.stack.pop(),exports.DEBUG&&console.log(tt.step,"SRP0[]",tt.rp0)}function SRP1(tt){tt.rp1=tt.stack.pop(),exports.DEBUG&&console.log(tt.step,"SRP1[]",tt.rp1)}function SRP2(tt){tt.rp2=tt.stack.pop(),exports.DEBUG&&console.log(tt.step,"SRP2[]",tt.rp2)}function SZP0(tt){var _e=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"SZP0[]",_e),tt.zp0=_e,_e){case 0:tt.tZone||initTZone(tt),tt.z0=tt.tZone;break;case 1:tt.z0=tt.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZP1(tt){var _e=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"SZP1[]",_e),tt.zp1=_e,_e){case 0:tt.tZone||initTZone(tt),tt.z1=tt.tZone;break;case 1:tt.z1=tt.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZP2(tt){var _e=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"SZP2[]",_e),tt.zp2=_e,_e){case 0:tt.tZone||initTZone(tt),tt.z2=tt.tZone;break;case 1:tt.z2=tt.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZPS(tt){var _e=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"SZPS[]",_e),tt.zp0=tt.zp1=tt.zp2=_e,_e){case 0:tt.tZone||initTZone(tt),tt.z0=tt.z1=tt.z2=tt.tZone;break;case 1:tt.z0=tt.z1=tt.z2=tt.gZone;break;default:throw new Error("Invalid zone pointer")}}function SLOOP(tt){tt.loop=tt.stack.pop(),exports.DEBUG&&console.log(tt.step,"SLOOP[]",tt.loop)}function RTG(tt){exports.DEBUG&&console.log(tt.step,"RTG[]"),tt.round=roundToGrid}function RTHG(tt){exports.DEBUG&&console.log(tt.step,"RTHG[]"),tt.round=roundToHalfGrid}function SMD(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SMD[]",_e),tt.minDis=_e/64}function ELSE(tt){exports.DEBUG&&console.log(tt.step,"ELSE[]"),skip(tt,!1)}function JMPR(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"JMPR[]",_e),tt.ip+=_e-1}function SCVTCI(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SCVTCI[]",_e),tt.cvCutIn=_e/64}function DUP(tt){var _e=tt.stack;exports.DEBUG&&console.log(tt.step,"DUP[]"),_e.push(_e[_e.length-1])}function POP(tt){exports.DEBUG&&console.log(tt.step,"POP[]"),tt.stack.pop()}function CLEAR(tt){exports.DEBUG&&console.log(tt.step,"CLEAR[]"),tt.stack.length=0}function SWAP(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"SWAP[]"),_e.push(rt),_e.push(nt)}function DEPTH(tt){var _e=tt.stack;exports.DEBUG&&console.log(tt.step,"DEPTH[]"),_e.push(_e.length)}function LOOPCALL(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"LOOPCALL[]",rt,nt);var it=tt.ip,st=tt.prog;tt.prog=tt.funcs[rt];for(var ot=0;ot<nt;ot++)exec(tt),exports.DEBUG&&console.log(++tt.step,ot+1<nt?"next loopcall":"done loopcall",ot);tt.ip=it,tt.prog=st}function CALL(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"CALL[]",_e);var rt=tt.ip,nt=tt.prog;tt.prog=tt.funcs[_e],exec(tt),tt.ip=rt,tt.prog=nt,exports.DEBUG&&console.log(++tt.step,"returning from",_e)}function CINDEX(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"CINDEX[]",rt),_e.push(_e[_e.length-rt])}function MINDEX(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"MINDEX[]",rt),_e.push(_e.splice(_e.length-rt,1)[0])}function FDEF(tt){if(tt.env!=="fpgm")throw new Error("FDEF not allowed here");var _e=tt.stack,rt=tt.prog,nt=tt.ip,it=_e.pop(),st=nt;for(exports.DEBUG&&console.log(tt.step,"FDEF[]",it);rt[++nt]!==45;);tt.ip=nt,tt.funcs[it]=rt.slice(st+1,nt)}function MDAP(tt,_e){var rt=_e.stack.pop(),nt=_e.z0[rt],it=_e.fv,st=_e.pv;exports.DEBUG&&console.log(_e.step,"MDAP["+tt+"]",rt);var ot=st.distance(nt,HPZero);tt&&(ot=_e.round(ot)),it.setRelative(nt,HPZero,ot,st),it.touch(nt),_e.rp0=_e.rp1=rt}function IUP(tt,_e){var rt=_e.z2,nt=rt.length-2,it,st,ot;exports.DEBUG&&console.log(_e.step,"IUP["+tt.axis+"]");for(var lt=0;lt<nt;lt++)it=rt[lt],!tt.touched(it)&&(st=it.prevTouched(tt),st!==it&&(ot=it.nextTouched(tt),st===ot&&tt.setRelative(it,it,tt.distance(st,st,!1,!0),tt,!0),tt.interpolate(it,st,ot,tt)))}function SHP(tt,_e){for(var rt=_e.stack,nt=tt?_e.rp1:_e.rp2,it=(tt?_e.z0:_e.z1)[nt],st=_e.fv,ot=_e.pv,lt=_e.loop,at=_e.z2;lt--;){var ct=rt.pop(),ut=at[ct],ht=ot.distance(it,it,!1,!0);st.setRelative(ut,ut,ht,ot),st.touch(ut),exports.DEBUG&&console.log(_e.step,(_e.loop>1?"loop "+(_e.loop-lt)+": ":"")+"SHP["+(tt?"rp1":"rp2")+"]",ct)}_e.loop=1}function SHC(tt,_e){var rt=_e.stack,nt=tt?_e.rp1:_e.rp2,it=(tt?_e.z0:_e.z1)[nt],st=_e.fv,ot=_e.pv,lt=rt.pop(),at=_e.z2[_e.contours[lt]],ct=at;exports.DEBUG&&console.log(_e.step,"SHC["+tt+"]",lt);var ut=ot.distance(it,it,!1,!0);do ct!==it&&st.setRelative(ct,ct,ut,ot),ct=ct.nextPointOnContour;while(ct!==at)}function SHZ(tt,_e){var rt=_e.stack,nt=tt?_e.rp1:_e.rp2,it=(tt?_e.z0:_e.z1)[nt],st=_e.fv,ot=_e.pv,lt=rt.pop();exports.DEBUG&&console.log(_e.step,"SHZ["+tt+"]",lt);var at;switch(lt){case 0:at=_e.tZone;break;case 1:at=_e.gZone;break;default:throw new Error("Invalid zone")}for(var ct,ut=ot.distance(it,it,!1,!0),ht=at.length-2,dt=0;dt<ht;dt++)ct=at[dt],st.setRelative(ct,ct,ut,ot)}function SHPIX(tt){for(var _e=tt.stack,rt=tt.loop,nt=tt.fv,it=_e.pop()/64,st=tt.z2;rt--;){var ot=_e.pop(),lt=st[ot];exports.DEBUG&&console.log(tt.step,(tt.loop>1?"loop "+(tt.loop-rt)+": ":"")+"SHPIX[]",ot,it),nt.setRelative(lt,lt,it),nt.touch(lt)}tt.loop=1}function IP(tt){for(var _e=tt.stack,rt=tt.rp1,nt=tt.rp2,it=tt.loop,st=tt.z0[rt],ot=tt.z1[nt],lt=tt.fv,at=tt.dpv,ct=tt.z2;it--;){var ut=_e.pop(),ht=ct[ut];exports.DEBUG&&console.log(tt.step,(tt.loop>1?"loop "+(tt.loop-it)+": ":"")+"IP[]",ut,rt,"<->",nt),lt.interpolate(ht,st,ot,at),lt.touch(ht)}tt.loop=1}function MSIRP(tt,_e){var rt=_e.stack,nt=rt.pop()/64,it=rt.pop(),st=_e.z1[it],ot=_e.z0[_e.rp0],lt=_e.fv,at=_e.pv;lt.setRelative(st,ot,nt,at),lt.touch(st),exports.DEBUG&&console.log(_e.step,"MSIRP["+tt+"]",nt,it),_e.rp1=_e.rp0,_e.rp2=it,tt&&(_e.rp0=it)}function ALIGNRP(tt){for(var _e=tt.stack,rt=tt.rp0,nt=tt.z0[rt],it=tt.loop,st=tt.fv,ot=tt.pv,lt=tt.z1;it--;){var at=_e.pop(),ct=lt[at];exports.DEBUG&&console.log(tt.step,(tt.loop>1?"loop "+(tt.loop-it)+": ":"")+"ALIGNRP[]",at),st.setRelative(ct,nt,0,ot),st.touch(ct)}tt.loop=1}function RTDG(tt){exports.DEBUG&&console.log(tt.step,"RTDG[]"),tt.round=roundToDoubleGrid}function MIAP(tt,_e){var rt=_e.stack,nt=rt.pop(),it=rt.pop(),st=_e.z0[it],ot=_e.fv,lt=_e.pv,at=_e.cvt[nt];exports.DEBUG&&console.log(_e.step,"MIAP["+tt+"]",nt,"(",at,")",it);var ct=lt.distance(st,HPZero);tt&&(Math.abs(ct-at)<_e.cvCutIn&&(ct=at),ct=_e.round(ct)),ot.setRelative(st,HPZero,ct,lt),_e.zp0===0&&(st.xo=st.x,st.yo=st.y),ot.touch(st),_e.rp0=_e.rp1=it}function NPUSHB(tt){var _e=tt.prog,rt=tt.ip,nt=tt.stack,it=_e[++rt];exports.DEBUG&&console.log(tt.step,"NPUSHB[]",it);for(var st=0;st<it;st++)nt.push(_e[++rt]);tt.ip=rt}function NPUSHW(tt){var _e=tt.ip,rt=tt.prog,nt=tt.stack,it=rt[++_e];exports.DEBUG&&console.log(tt.step,"NPUSHW[]",it);for(var st=0;st<it;st++){var ot=rt[++_e]<<8|rt[++_e];ot&32768&&(ot=-((ot^65535)+1)),nt.push(ot)}tt.ip=_e}function WS(tt){var _e=tt.stack,rt=tt.store;rt||(rt=tt.store=[]);var nt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"WS",nt,it),rt[it]=nt}function RS(tt){var _e=tt.stack,rt=tt.store,nt=_e.pop();exports.DEBUG&&console.log(tt.step,"RS",nt);var it=rt&&rt[nt]||0;_e.push(it)}function WCVTP(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"WCVTP",rt,nt),tt.cvt[nt]=rt/64}function RCVT(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"RCVT",rt),_e.push(tt.cvt[rt]*64)}function GC(tt,_e){var rt=_e.stack,nt=rt.pop(),it=_e.z2[nt];exports.DEBUG&&console.log(_e.step,"GC["+tt+"]",nt),rt.push(_e.dpv.distance(it,HPZero,tt,!1)*64)}function MD(tt,_e){var rt=_e.stack,nt=rt.pop(),it=rt.pop(),st=_e.z1[nt],ot=_e.z0[it],lt=_e.dpv.distance(ot,st,tt,tt);exports.DEBUG&&console.log(_e.step,"MD["+tt+"]",nt,it,"->",lt),_e.stack.push(Math.round(lt*64))}function MPPEM(tt){exports.DEBUG&&console.log(tt.step,"MPPEM[]"),tt.stack.push(tt.ppem)}function FLIPON(tt){exports.DEBUG&&console.log(tt.step,"FLIPON[]"),tt.autoFlip=!0}function LT(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"LT[]",rt,nt),_e.push(nt<rt?1:0)}function LTEQ(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"LTEQ[]",rt,nt),_e.push(nt<=rt?1:0)}function GT(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"GT[]",rt,nt),_e.push(nt>rt?1:0)}function GTEQ(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"GTEQ[]",rt,nt),_e.push(nt>=rt?1:0)}function EQ(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"EQ[]",rt,nt),_e.push(rt===nt?1:0)}function NEQ(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"NEQ[]",rt,nt),_e.push(rt!==nt?1:0)}function ODD(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"ODD[]",rt),_e.push(Math.trunc(rt)%2?1:0)}function EVEN(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"EVEN[]",rt),_e.push(Math.trunc(rt)%2?0:1)}function IF(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"IF[]",_e),_e||(skip(tt,!0),exports.DEBUG&&console.log(tt.step,"EIF[]"))}function EIF(tt){exports.DEBUG&&console.log(tt.step,"EIF[]")}function AND(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"AND[]",rt,nt),_e.push(rt&&nt?1:0)}function OR(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"OR[]",rt,nt),_e.push(rt||nt?1:0)}function NOT(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"NOT[]",rt),_e.push(rt?0:1)}function DELTAP123(tt,_e){var rt=_e.stack,nt=rt.pop(),it=_e.fv,st=_e.pv,ot=_e.ppem,lt=_e.deltaBase+(tt-1)*16,at=_e.deltaShift,ct=_e.z0;exports.DEBUG&&console.log(_e.step,"DELTAP["+tt+"]",nt,rt);for(var ut=0;ut<nt;ut++){var ht=rt.pop(),dt=rt.pop(),ft=lt+((dt&240)>>4);if(ft===ot){var pt=(dt&15)-8;pt>=0&&pt++,exports.DEBUG&&console.log(_e.step,"DELTAPFIX",ht,"by",pt*at);var mt=ct[ht];it.setRelative(mt,mt,pt*at,st)}}}function SDB(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"SDB[]",rt),tt.deltaBase=rt}function SDS(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"SDS[]",rt),tt.deltaShift=Math.pow(.5,rt)}function ADD(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"ADD[]",rt,nt),_e.push(nt+rt)}function SUB(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"SUB[]",rt,nt),_e.push(nt-rt)}function DIV(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"DIV[]",rt,nt),_e.push(nt*64/rt)}function MUL(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"MUL[]",rt,nt),_e.push(nt*rt/64)}function ABS(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"ABS[]",rt),_e.push(Math.abs(rt))}function NEG(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"NEG[]",rt),_e.push(-rt)}function FLOOR(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"FLOOR[]",rt),_e.push(Math.floor(rt/64)*64)}function CEILING(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"CEILING[]",rt),_e.push(Math.ceil(rt/64)*64)}function ROUND(tt,_e){var rt=_e.stack,nt=rt.pop();exports.DEBUG&&console.log(_e.step,"ROUND[]"),rt.push(_e.round(nt/64)*64)}function WCVTF(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"WCVTF[]",rt,nt),tt.cvt[nt]=rt*tt.ppem/tt.font.unitsPerEm}function DELTAC123(tt,_e){var rt=_e.stack,nt=rt.pop(),it=_e.ppem,st=_e.deltaBase+(tt-1)*16,ot=_e.deltaShift;exports.DEBUG&&console.log(_e.step,"DELTAC["+tt+"]",nt,rt);for(var lt=0;lt<nt;lt++){var at=rt.pop(),ct=rt.pop(),ut=st+((ct&240)>>4);if(ut===it){var ht=(ct&15)-8;ht>=0&&ht++;var dt=ht*ot;exports.DEBUG&&console.log(_e.step,"DELTACFIX",at,"by",dt),_e.cvt[at]+=dt}}}function SROUND(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SROUND[]",_e),tt.round=roundSuper;var rt;switch(_e&192){case 0:rt=.5;break;case 64:rt=1;break;case 128:rt=2;break;default:throw new Error("invalid SROUND value")}switch(tt.srPeriod=rt,_e&48){case 0:tt.srPhase=0;break;case 16:tt.srPhase=.25*rt;break;case 32:tt.srPhase=.5*rt;break;case 48:tt.srPhase=.75*rt;break;default:throw new Error("invalid SROUND value")}_e&=15,_e===0?tt.srThreshold=0:tt.srThreshold=(_e/8-.5)*rt}function S45ROUND(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"S45ROUND[]",_e),tt.round=roundSuper;var rt;switch(_e&192){case 0:rt=Math.sqrt(2)/2;break;case 64:rt=Math.sqrt(2);break;case 128:rt=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(tt.srPeriod=rt,_e&48){case 0:tt.srPhase=0;break;case 16:tt.srPhase=.25*rt;break;case 32:tt.srPhase=.5*rt;break;case 48:tt.srPhase=.75*rt;break;default:throw new Error("invalid S45ROUND value")}_e&=15,_e===0?tt.srThreshold=0:tt.srThreshold=(_e/8-.5)*rt}function ROFF(tt){exports.DEBUG&&console.log(tt.step,"ROFF[]"),tt.round=roundOff}function RUTG(tt){exports.DEBUG&&console.log(tt.step,"RUTG[]"),tt.round=roundUpToGrid}function RDTG(tt){exports.DEBUG&&console.log(tt.step,"RDTG[]"),tt.round=roundDownToGrid}function SCANCTRL(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SCANCTRL[]",_e)}function SDPVTL(tt,_e){var rt=_e.stack,nt=rt.pop(),it=rt.pop(),st=_e.z2[nt],ot=_e.z1[it];exports.DEBUG&&console.log(_e.step,"SDPVTL["+tt+"]",nt,it);var lt,at;tt?(lt=st.y-ot.y,at=ot.x-st.x):(lt=ot.x-st.x,at=ot.y-st.y),_e.dpv=getUnitVector(lt,at)}function GETINFO(tt){var _e=tt.stack,rt=_e.pop(),nt=0;exports.DEBUG&&console.log(tt.step,"GETINFO[]",rt),rt&1&&(nt=35),rt&32&&(nt|=4096),_e.push(nt)}function ROLL(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"ROLL[]"),_e.push(nt),_e.push(rt),_e.push(it)}function MAX(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"MAX[]",rt,nt),_e.push(Math.max(nt,rt))}function MIN(tt){var _e=tt.stack,rt=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"MIN[]",rt,nt),_e.push(Math.min(nt,rt))}function SCANTYPE(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SCANTYPE[]",_e)}function INSTCTRL(tt){var _e=tt.stack.pop(),rt=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"INSTCTRL[]",_e,rt),_e){case 1:tt.inhibitGridFit=!!rt;return;case 2:tt.ignoreCvt=!!rt;return;default:throw new Error("invalid INSTCTRL[] selector")}}function PUSHB(tt,_e){var rt=_e.stack,nt=_e.prog,it=_e.ip;exports.DEBUG&&console.log(_e.step,"PUSHB["+tt+"]");for(var st=0;st<tt;st++)rt.push(nt[++it]);_e.ip=it}function PUSHW(tt,_e){var rt=_e.ip,nt=_e.prog,it=_e.stack;exports.DEBUG&&console.log(_e.ip,"PUSHW["+tt+"]");for(var st=0;st<tt;st++){var ot=nt[++rt]<<8|nt[++rt];ot&32768&&(ot=-((ot^65535)+1)),it.push(ot)}_e.ip=rt}function MDRP_MIRP(tt,_e,rt,nt,it,st){var ot=st.stack,lt=tt&&ot.pop(),at=ot.pop(),ct=st.rp0,ut=st.z0[ct],ht=st.z1[at],dt=st.minDis,ft=st.fv,pt=st.dpv,mt,gt,vt,At;gt=mt=pt.distance(ht,ut,!0,!0),vt=gt>=0?1:-1,gt=Math.abs(gt),tt&&(At=st.cvt[lt],nt&&Math.abs(gt-At)<st.cvCutIn&&(gt=At)),rt&&gt<dt&&(gt=dt),nt&&(gt=st.round(gt)),ft.setRelative(ht,ut,vt*gt,pt),ft.touch(ht),exports.DEBUG&&console.log(st.step,(tt?"MIRP[":"MDRP[")+(_e?"M":"m")+(rt?">":"_")+(nt?"R":"_")+(it===0?"Gr":it===1?"Bl":it===2?"Wh":"")+"]",tt?lt+"("+st.cvt[lt]+","+At+")":"",at,"(d =",mt,"->",vt*gt,")"),st.rp1=st.rp0,st.rp2=at,_e&&(st.rp0=at)}instructionTable=[SVTCA.bind(void 0,yUnitVector),SVTCA.bind(void 0,xUnitVector),SPVTCA.bind(void 0,yUnitVector),SPVTCA.bind(void 0,xUnitVector),SFVTCA.bind(void 0,yUnitVector),SFVTCA.bind(void 0,xUnitVector),SPVTL.bind(void 0,0),SPVTL.bind(void 0,1),SFVTL.bind(void 0,0),SFVTL.bind(void 0,1),SPVFS,SFVFS,GPV,GFV,SFVTPV,ISECT,SRP0,SRP1,SRP2,SZP0,SZP1,SZP2,SZPS,SLOOP,RTG,RTHG,SMD,ELSE,JMPR,SCVTCI,void 0,void 0,DUP,POP,CLEAR,SWAP,DEPTH,CINDEX,MINDEX,void 0,void 0,void 0,LOOPCALL,CALL,FDEF,void 0,MDAP.bind(void 0,0),MDAP.bind(void 0,1),IUP.bind(void 0,yUnitVector),IUP.bind(void 0,xUnitVector),SHP.bind(void 0,0),SHP.bind(void 0,1),SHC.bind(void 0,0),SHC.bind(void 0,1),SHZ.bind(void 0,0),SHZ.bind(void 0,1),SHPIX,IP,MSIRP.bind(void 0,0),MSIRP.bind(void 0,1),ALIGNRP,RTDG,MIAP.bind(void 0,0),MIAP.bind(void 0,1),NPUSHB,NPUSHW,WS,RS,WCVTP,RCVT,GC.bind(void 0,0),GC.bind(void 0,1),void 0,MD.bind(void 0,0),MD.bind(void 0,1),MPPEM,void 0,FLIPON,void 0,void 0,LT,LTEQ,GT,GTEQ,EQ,NEQ,ODD,EVEN,IF,EIF,AND,OR,NOT,DELTAP123.bind(void 0,1),SDB,SDS,ADD,SUB,DIV,MUL,ABS,NEG,FLOOR,CEILING,ROUND.bind(void 0,0),ROUND.bind(void 0,1),ROUND.bind(void 0,2),ROUND.bind(void 0,3),void 0,void 0,void 0,void 0,WCVTF,DELTAP123.bind(void 0,2),DELTAP123.bind(void 0,3),DELTAC123.bind(void 0,1),DELTAC123.bind(void 0,2),DELTAC123.bind(void 0,3),SROUND,S45ROUND,void 0,void 0,ROFF,void 0,RUTG,RDTG,POP,POP,void 0,void 0,void 0,void 0,void 0,SCANCTRL,SDPVTL.bind(void 0,0),SDPVTL.bind(void 0,1),GETINFO,void 0,ROLL,MAX,MIN,SCANTYPE,INSTCTRL,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,PUSHB.bind(void 0,1),PUSHB.bind(void 0,2),PUSHB.bind(void 0,3),PUSHB.bind(void 0,4),PUSHB.bind(void 0,5),PUSHB.bind(void 0,6),PUSHB.bind(void 0,7),PUSHB.bind(void 0,8),PUSHW.bind(void 0,1),PUSHW.bind(void 0,2),PUSHW.bind(void 0,3),PUSHW.bind(void 0,4),PUSHW.bind(void 0,5),PUSHW.bind(void 0,6),PUSHW.bind(void 0,7),PUSHW.bind(void 0,8),MDRP_MIRP.bind(void 0,0,0,0,0,0),MDRP_MIRP.bind(void 0,0,0,0,0,1),MDRP_MIRP.bind(void 0,0,0,0,0,2),MDRP_MIRP.bind(void 0,0,0,0,0,3),MDRP_MIRP.bind(void 0,0,0,0,1,0),MDRP_MIRP.bind(void 0,0,0,0,1,1),MDRP_MIRP.bind(void 0,0,0,0,1,2),MDRP_MIRP.bind(void 0,0,0,0,1,3),MDRP_MIRP.bind(void 0,0,0,1,0,0),MDRP_MIRP.bind(void 0,0,0,1,0,1),MDRP_MIRP.bind(void 0,0,0,1,0,2),MDRP_MIRP.bind(void 0,0,0,1,0,3),MDRP_MIRP.bind(void 0,0,0,1,1,0),MDRP_MIRP.bind(void 0,0,0,1,1,1),MDRP_MIRP.bind(void 0,0,0,1,1,2),MDRP_MIRP.bind(void 0,0,0,1,1,3),MDRP_MIRP.bind(void 0,0,1,0,0,0),MDRP_MIRP.bind(void 0,0,1,0,0,1),MDRP_MIRP.bind(void 0,0,1,0,0,2),MDRP_MIRP.bind(void 0,0,1,0,0,3),MDRP_MIRP.bind(void 0,0,1,0,1,0),MDRP_MIRP.bind(void 0,0,1,0,1,1),MDRP_MIRP.bind(void 0,0,1,0,1,2),MDRP_MIRP.bind(void 0,0,1,0,1,3),MDRP_MIRP.bind(void 0,0,1,1,0,0),MDRP_MIRP.bind(void 0,0,1,1,0,1),MDRP_MIRP.bind(void 0,0,1,1,0,2),MDRP_MIRP.bind(void 0,0,1,1,0,3),MDRP_MIRP.bind(void 0,0,1,1,1,0),MDRP_MIRP.bind(void 0,0,1,1,1,1),MDRP_MIRP.bind(void 0,0,1,1,1,2),MDRP_MIRP.bind(void 0,0,1,1,1,3),MDRP_MIRP.bind(void 0,1,0,0,0,0),MDRP_MIRP.bind(void 0,1,0,0,0,1),MDRP_MIRP.bind(void 0,1,0,0,0,2),MDRP_MIRP.bind(void 0,1,0,0,0,3),MDRP_MIRP.bind(void 0,1,0,0,1,0),MDRP_MIRP.bind(void 0,1,0,0,1,1),MDRP_MIRP.bind(void 0,1,0,0,1,2),MDRP_MIRP.bind(void 0,1,0,0,1,3),MDRP_MIRP.bind(void 0,1,0,1,0,0),MDRP_MIRP.bind(void 0,1,0,1,0,1),MDRP_MIRP.bind(void 0,1,0,1,0,2),MDRP_MIRP.bind(void 0,1,0,1,0,3),MDRP_MIRP.bind(void 0,1,0,1,1,0),MDRP_MIRP.bind(void 0,1,0,1,1,1),MDRP_MIRP.bind(void 0,1,0,1,1,2),MDRP_MIRP.bind(void 0,1,0,1,1,3),MDRP_MIRP.bind(void 0,1,1,0,0,0),MDRP_MIRP.bind(void 0,1,1,0,0,1),MDRP_MIRP.bind(void 0,1,1,0,0,2),MDRP_MIRP.bind(void 0,1,1,0,0,3),MDRP_MIRP.bind(void 0,1,1,0,1,0),MDRP_MIRP.bind(void 0,1,1,0,1,1),MDRP_MIRP.bind(void 0,1,1,0,1,2),MDRP_MIRP.bind(void 0,1,1,0,1,3),MDRP_MIRP.bind(void 0,1,1,1,0,0),MDRP_MIRP.bind(void 0,1,1,1,0,1),MDRP_MIRP.bind(void 0,1,1,1,0,2),MDRP_MIRP.bind(void 0,1,1,1,0,3),MDRP_MIRP.bind(void 0,1,1,1,1,0),MDRP_MIRP.bind(void 0,1,1,1,1,1),MDRP_MIRP.bind(void 0,1,1,1,1,2),MDRP_MIRP.bind(void 0,1,1,1,1,3)];function Token(tt){this.char=tt,this.state={},this.activeState=null}function ContextRange(tt,_e,rt){this.contextName=rt,this.startIndex=tt,this.endOffset=_e}function ContextChecker(tt,_e,rt){this.contextName=tt,this.openRange=null,this.ranges=[],this.checkStart=_e,this.checkEnd=rt}function ContextParams(tt,_e){this.context=tt,this.index=_e,this.length=tt.length,this.current=tt[_e],this.backtrack=tt.slice(0,_e),this.lookahead=tt.slice(_e+1)}function Event(tt){this.eventId=tt,this.subscribers=[]}function initializeCoreEvents(tt){var _e=this,rt=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];rt.forEach(function(it){Object.defineProperty(_e.events,it,{value:new Event(it)})}),tt&&rt.forEach(function(it){var st=tt[it];typeof st=="function"&&_e.events[it].subscribe(st)});var nt=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];nt.forEach(function(it){_e.events[it].subscribe(_e.updateContextsRanges)})}function Tokenizer(tt){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],initializeCoreEvents.call(this,tt)}Token.prototype.setState=function(tt,_e){return this.state[tt]=_e,this.activeState={key:tt,value:this.state[tt]},this.activeState};Token.prototype.getState=function(tt){return this.state[tt]||null};Tokenizer.prototype.inboundIndex=function(tt){return tt>=0&&tt<this.tokens.length};Tokenizer.prototype.composeRUD=function(tt){var _e=this,rt=!0,nt=tt.map(function(st){return _e[st[0]].apply(_e,st.slice(1).concat(rt))}),it=function(st){return typeof st=="object"&&st.hasOwnProperty("FAIL")};if(nt.every(it))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:nt.filter(it)};this.dispatch("composeRUD",[nt.filter(function(st){return!it(st)})])};Tokenizer.prototype.replaceRange=function(tt,_e,rt,nt){_e=_e!==null?_e:this.tokens.length;var it=rt.every(function(ot){return ot instanceof Token});if(!isNaN(tt)&&this.inboundIndex(tt)&&it){var st=this.tokens.splice.apply(this.tokens,[tt,_e].concat(rt));return nt||this.dispatch("replaceToken",[tt,_e,rt]),[st,rt]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}};Tokenizer.prototype.replaceToken=function(tt,_e,rt){if(!isNaN(tt)&&this.inboundIndex(tt)&&_e instanceof Token){var nt=this.tokens.splice(tt,1,_e);return rt||this.dispatch("replaceToken",[tt,_e]),[nt[0],_e]}else return{FAIL:"replaceToken: invalid token or index."}};Tokenizer.prototype.removeRange=function(tt,_e,rt){_e=isNaN(_e)?this.tokens.length:_e;var nt=this.tokens.splice(tt,_e);return rt||this.dispatch("removeRange",[nt,tt,_e]),nt};Tokenizer.prototype.removeToken=function(tt,_e){if(!isNaN(tt)&&this.inboundIndex(tt)){var rt=this.tokens.splice(tt,1);return _e||this.dispatch("removeToken",[rt,tt]),rt}else return{FAIL:"removeToken: invalid token index."}};Tokenizer.prototype.insertToken=function(tt,_e,rt){var nt=tt.every(function(it){return it instanceof Token});return nt?(this.tokens.splice.apply(this.tokens,[_e,0].concat(tt)),rt||this.dispatch("insertToken",[tt,_e]),tt):{FAIL:"insertToken: invalid token(s)."}};Tokenizer.prototype.registerModifier=function(tt,_e,rt){this.events.newToken.subscribe(function(nt,it){var st=[nt,it],ot=_e===null||_e.apply(this,st)===!0,lt=[nt,it];if(ot){var at=rt.apply(this,lt);nt.setState(tt,at)}}),this.registeredModifiers.push(tt)};Event.prototype.subscribe=function(tt){return typeof tt=="function"?this.subscribers.push(tt)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}};Event.prototype.unsubscribe=function(tt){this.subscribers.splice(tt,1)};ContextParams.prototype.setCurrentIndex=function(tt){this.index=tt,this.current=this.context[tt],this.backtrack=this.context.slice(0,tt),this.lookahead=this.context.slice(tt+1)};ContextParams.prototype.get=function(tt){switch(!0){case tt===0:return this.current;case(tt<0&&Math.abs(tt)<=this.backtrack.length):return this.backtrack.slice(tt)[0];case(tt>0&&tt<=this.lookahead.length):return this.lookahead[tt-1];default:return null}};Tokenizer.prototype.rangeToText=function(tt){if(tt instanceof ContextRange)return this.getRangeTokens(tt).map(function(_e){return _e.char}).join("")};Tokenizer.prototype.getText=function(){return this.tokens.map(function(tt){return tt.char}).join("")};Tokenizer.prototype.getContext=function(tt){var _e=this.registeredContexts[tt];return _e||null};Tokenizer.prototype.on=function(tt,_e){var rt=this.events[tt];return rt?rt.subscribe(_e):null};Tokenizer.prototype.dispatch=function(tt,_e){var rt=this,nt=this.events[tt];nt instanceof Event&&nt.subscribers.forEach(function(it){it.apply(rt,_e||[])})};Tokenizer.prototype.registerContextChecker=function(tt,_e,rt){if(this.getContext(tt))return{FAIL:"context name '"+tt+"' is already registered."};if(typeof _e!="function")return{FAIL:"missing context start check."};if(typeof rt!="function")return{FAIL:"missing context end check."};var nt=new ContextChecker(tt,_e,rt);return this.registeredContexts[tt]=nt,this.contextCheckers.push(nt),nt};Tokenizer.prototype.getRangeTokens=function(tt){var _e=tt.startIndex+tt.endOffset;return[].concat(this.tokens.slice(tt.startIndex,_e))};Tokenizer.prototype.getContextRanges=function(tt){var _e=this.getContext(tt);return _e?_e.ranges:{FAIL:"context checker '"+tt+"' is not registered."}};Tokenizer.prototype.resetContextsRanges=function(){var tt=this.registeredContexts;for(var _e in tt)if(tt.hasOwnProperty(_e)){var rt=tt[_e];rt.ranges=[]}};Tokenizer.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var tt=this.tokens.map(function(nt){return nt.char}),_e=0;_e<tt.length;_e++){var rt=new ContextParams(tt,_e);this.runContextCheck(rt)}this.dispatch("updateContextsRanges",[this.registeredContexts])};Tokenizer.prototype.setEndOffset=function(tt,_e){var rt=this.getContext(_e).openRange.startIndex,nt=new ContextRange(rt,tt,_e),it=this.getContext(_e).ranges;return nt.rangeId=_e+"."+it.length,it.push(nt),this.getContext(_e).openRange=null,nt};Tokenizer.prototype.runContextCheck=function(tt){var _e=this,rt=tt.index;this.contextCheckers.forEach(function(nt){var it=nt.contextName,st=_e.getContext(it).openRange;if(!st&&nt.checkStart(tt)&&(st=new ContextRange(rt,null,it),_e.getContext(it).openRange=st,_e.dispatch("contextStart",[it,rt])),st&&nt.checkEnd(tt)){var ot=rt-st.startIndex+1,lt=_e.setEndOffset(ot,it);_e.dispatch("contextEnd",[it,lt])}})};Tokenizer.prototype.tokenize=function(tt){this.tokens=[],this.resetContextsRanges();var _e=Array.from(tt);this.dispatch("start");for(var rt=0;rt<_e.length;rt++){var nt=_e[rt],it=new ContextParams(_e,rt);this.dispatch("next",[it]),this.runContextCheck(it);var st=new Token(nt);this.tokens.push(st),this.dispatch("newToken",[st,it])}return this.dispatch("end",[this.tokens]),this.tokens};function isArabicChar(tt){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(tt)}function isIsolatedArabicChar(tt){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(tt)}function isTashkeelArabicChar(tt){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(tt)}function isLatinChar(tt){return/[A-z]/.test(tt)}function isWhiteSpace(tt){return/\s/.test(tt)}function FeatureQuery(tt){this.font=tt,this.features={}}function SubstitutionAction(tt){this.id=tt.id,this.tag=tt.tag,this.substitution=tt.substitution}function lookupCoverage(tt,_e){if(!tt)return-1;switch(_e.format){case 1:return _e.glyphs.indexOf(tt);case 2:for(var rt=_e.ranges,nt=0;nt<rt.length;nt++){var it=rt[nt];if(tt>=it.start&&tt<=it.end){var st=tt-it.start;return it.index+st}}break;default:return-1}return-1}function singleSubstitutionFormat1(tt,_e){var rt=lookupCoverage(tt,_e.coverage);return rt===-1?null:tt+_e.deltaGlyphId}function singleSubstitutionFormat2(tt,_e){var rt=lookupCoverage(tt,_e.coverage);return rt===-1?null:_e.substitute[rt]}function lookupCoverageList(tt,_e){for(var rt=[],nt=0;nt<tt.length;nt++){var it=tt[nt],st=_e.current;st=Array.isArray(st)?st[0]:st;var ot=lookupCoverage(st,it);ot!==-1&&rt.push(ot)}return rt.length!==tt.length?-1:rt}function chainingSubstitutionFormat3(tt,_e){var rt=_e.inputCoverage.length+_e.lookaheadCoverage.length+_e.backtrackCoverage.length;if(tt.context.length<rt)return[];var nt=lookupCoverageList(_e.inputCoverage,tt);if(nt===-1)return[];var it=_e.inputCoverage.length-1;if(tt.lookahead.length<_e.lookaheadCoverage.length)return[];for(var st=tt.lookahead.slice(it);st.length&&isTashkeelArabicChar(st[0].char);)st.shift();var ot=new ContextParams(st,0),lt=lookupCoverageList(_e.lookaheadCoverage,ot),at=[].concat(tt.backtrack);for(at.reverse();at.length&&isTashkeelArabicChar(at[0].char);)at.shift();if(at.length<_e.backtrackCoverage.length)return[];var ct=new ContextParams(at,0),ut=lookupCoverageList(_e.backtrackCoverage,ct),ht=nt.length===_e.inputCoverage.length&&lt.length===_e.lookaheadCoverage.length&&ut.length===_e.backtrackCoverage.length,dt=[];if(ht)for(var ft=0;ft<_e.lookupRecords.length;ft++)for(var pt=_e.lookupRecords[ft],mt=pt.lookupListIndex,gt=this.getLookupByIndex(mt),vt=0;vt<gt.subtables.length;vt++){var At=gt.subtables[vt],yt=this.getLookupMethod(gt,At),xt=this.getSubstitutionType(gt,At);if(xt==="12")for(var _t=0;_t<nt.length;_t++){var Et=tt.get(_t),bt=yt(Et);bt&&dt.push(bt)}}return dt}function ligatureSubstitutionFormat1(tt,_e){var rt=tt.current,nt=lookupCoverage(rt,_e.coverage);if(nt===-1)return null;for(var it,st=_e.ligatureSets[nt],ot=0;ot<st.length;ot++){it=st[ot];for(var lt=0;lt<it.components.length;lt++){var at=tt.lookahead[lt],ct=it.components[lt];if(at!==ct)break;if(lt===it.components.length-1)return it}}return null}function decompositionSubstitutionFormat1(tt,_e){var rt=lookupCoverage(tt,_e.coverage);return rt===-1?null:_e.sequences[rt]}FeatureQuery.prototype.getDefaultScriptFeaturesIndexes=function(){for(var tt=this.font.tables.gsub.scripts,_e=0;_e<tt.length;_e++){var rt=tt[_e];if(rt.tag==="DFLT")return rt.script.defaultLangSys.featureIndexes}return[]};FeatureQuery.prototype.getScriptFeaturesIndexes=function(tt){var _e=this.font.tables;if(!_e.gsub)return[];if(!tt)return this.getDefaultScriptFeaturesIndexes();for(var rt=this.font.tables.gsub.scripts,nt=0;nt<rt.length;nt++){var it=rt[nt];if(it.tag===tt&&it.script.defaultLangSys)return it.script.defaultLangSys.featureIndexes;var st=it.langSysRecords;if(st)for(var ot=0;ot<st.length;ot++){var lt=st[ot];if(lt.tag===tt){var at=lt.langSys;return at.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()};FeatureQuery.prototype.mapTagsToFeatures=function(tt,_e){for(var rt={},nt=0;nt<tt.length;nt++){var it=tt[nt].tag,st=tt[nt].feature;rt[it]=st}this.features[_e].tags=rt};FeatureQuery.prototype.getScriptFeatures=function(tt){var _e=this.features[tt];if(this.features.hasOwnProperty(tt))return _e;var rt=this.getScriptFeaturesIndexes(tt);if(!rt)return null;var nt=this.font.tables.gsub;return _e=rt.map(function(it){return nt.features[it]}),this.features[tt]=_e,this.mapTagsToFeatures(_e,tt),_e};FeatureQuery.prototype.getSubstitutionType=function(tt,_e){var rt=tt.lookupType.toString(),nt=_e.substFormat.toString();return rt+nt};FeatureQuery.prototype.getLookupMethod=function(tt,_e){var rt=this,nt=this.getSubstitutionType(tt,_e);switch(nt){case"11":return function(it){return singleSubstitutionFormat1.apply(rt,[it,_e])};case"12":return function(it){return singleSubstitutionFormat2.apply(rt,[it,_e])};case"63":return function(it){return chainingSubstitutionFormat3.apply(rt,[it,_e])};case"41":return function(it){return ligatureSubstitutionFormat1.apply(rt,[it,_e])};case"21":return function(it){return decompositionSubstitutionFormat1.apply(rt,[it,_e])};default:throw new Error("lookupType: "+tt.lookupType+" - substFormat: "+_e.substFormat+" is not yet supported")}};FeatureQuery.prototype.lookupFeature=function(tt){var _e=tt.contextParams,rt=_e.index,nt=this.getFeature({tag:tt.tag,script:tt.script});if(!nt)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+tt.tag+"' for script '"+tt.script+"'.");for(var it=this.getFeatureLookups(nt),st=[].concat(_e.context),ot=0;ot<it.length;ot++)for(var lt=it[ot],at=this.getLookupSubtables(lt),ct=0;ct<at.length;ct++){var ut=at[ct],ht=this.getSubstitutionType(lt,ut),dt=this.getLookupMethod(lt,ut),ft=void 0;switch(ht){case"11":ft=dt(_e.current),ft&&st.splice(rt,1,new SubstitutionAction({id:11,tag:tt.tag,substitution:ft}));break;case"12":ft=dt(_e.current),ft&&st.splice(rt,1,new SubstitutionAction({id:12,tag:tt.tag,substitution:ft}));break;case"63":ft=dt(_e),Array.isArray(ft)&&ft.length&&st.splice(rt,1,new SubstitutionAction({id:63,tag:tt.tag,substitution:ft}));break;case"41":ft=dt(_e),ft&&st.splice(rt,1,new SubstitutionAction({id:41,tag:tt.tag,substitution:ft}));break;case"21":ft=dt(_e.current),ft&&st.splice(rt,1,new SubstitutionAction({id:21,tag:tt.tag,substitution:ft}));break}_e=new ContextParams(st,rt),!(Array.isArray(ft)&&!ft.length)&&(ft=null)}return st.length?st:null};FeatureQuery.prototype.supports=function(tt){if(!tt.script)return!1;this.getScriptFeatures(tt.script);var _e=this.features.hasOwnProperty(tt.script);if(!tt.tag)return _e;var rt=this.features[tt.script].some(function(nt){return nt.tag===tt.tag});return _e&&rt};FeatureQuery.prototype.getLookupSubtables=function(tt){return tt.subtables||null};FeatureQuery.prototype.getLookupByIndex=function(tt){var _e=this.font.tables.gsub.lookups;return _e[tt]||null};FeatureQuery.prototype.getFeatureLookups=function(tt){return tt.lookupListIndexes.map(this.getLookupByIndex.bind(this))};FeatureQuery.prototype.getFeature=function(_e){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(_e.script)||this.getScriptFeatures(_e.script);var rt=this.features[_e.script];return rt?rt.tags[_e.tag]?this.features[_e.script].tags[_e.tag]:null:{FAIL:"No feature for script "+_e.script}};function arabicWordStartCheck(tt){var _e=tt.current,rt=tt.get(-1);return rt===null&&isArabicChar(_e)||!isArabicChar(rt)&&isArabicChar(_e)}function arabicWordEndCheck(tt){var _e=tt.get(1);return _e===null||!isArabicChar(_e)}var arabicWordCheck={startCheck:arabicWordStartCheck,endCheck:arabicWordEndCheck};function arabicSentenceStartCheck(tt){var _e=tt.current,rt=tt.get(-1);return(isArabicChar(_e)||isTashkeelArabicChar(_e))&&!isArabicChar(rt)}function arabicSentenceEndCheck(tt){var _e=tt.get(1);switch(!0){case _e===null:return!0;case(!isArabicChar(_e)&&!isTashkeelArabicChar(_e)):var rt=isWhiteSpace(_e);if(!rt)return!0;if(rt){var nt=!1;if(nt=tt.lookahead.some(function(it){return isArabicChar(it)||isTashkeelArabicChar(it)}),!nt)return!0}break;default:return!1}}var arabicSentenceCheck={startCheck:arabicSentenceStartCheck,endCheck:arabicSentenceEndCheck};function singleSubstitutionFormat1$1(tt,_e,rt){_e[rt].setState(tt.tag,tt.substitution)}function singleSubstitutionFormat2$1(tt,_e,rt){_e[rt].setState(tt.tag,tt.substitution)}function chainingSubstitutionFormat3$1(tt,_e,rt){tt.substitution.forEach(function(nt,it){var st=_e[rt+it];st.setState(tt.tag,nt)})}function ligatureSubstitutionFormat1$1(tt,_e,rt){var nt=_e[rt];nt.setState(tt.tag,tt.substitution.ligGlyph);for(var it=tt.substitution.components.length,st=0;st<it;st++)nt=_e[rt+st+1],nt.setState("deleted",!0)}var SUBSTITUTIONS={11:singleSubstitutionFormat1$1,12:singleSubstitutionFormat2$1,63:chainingSubstitutionFormat3$1,41:ligatureSubstitutionFormat1$1};function applySubstitution(tt,_e,rt){tt instanceof SubstitutionAction&&SUBSTITUTIONS[tt.id]&&SUBSTITUTIONS[tt.id](tt,_e,rt)}function willConnectPrev(tt){for(var _e=[].concat(tt.backtrack),rt=_e.length-1;rt>=0;rt--){var nt=_e[rt],it=isIsolatedArabicChar(nt),st=isTashkeelArabicChar(nt);if(!it&&!st)return!0;if(it)return!1}return!1}function willConnectNext(tt){if(isIsolatedArabicChar(tt.current))return!1;for(var _e=0;_e<tt.lookahead.length;_e++){var rt=tt.lookahead[_e],nt=isTashkeelArabicChar(rt);if(!nt)return!0}return!1}function arabicPresentationForms(tt){var _e=this,rt="arab",nt=this.featuresTags[rt],it=this.tokenizer.getRangeTokens(tt);if(it.length!==1){var st=new ContextParams(it.map(function(lt){return lt.getState("glyphIndex")}),0),ot=new ContextParams(it.map(function(lt){return lt.char}),0);it.forEach(function(lt,at){if(!isTashkeelArabicChar(lt.char)){st.setCurrentIndex(at),ot.setCurrentIndex(at);var ct=0;willConnectPrev(ot)&&(ct|=1),willConnectNext(ot)&&(ct|=2);var ut;switch(ct){case 1:ut="fina";break;case 2:ut="init";break;case 3:ut="medi";break}if(nt.indexOf(ut)!==-1){var ht=_e.query.lookupFeature({tag:ut,script:rt,contextParams:st});if(ht instanceof Error)return console.info(ht.message);ht.forEach(function(dt,ft){dt instanceof SubstitutionAction&&(applySubstitution(dt,it,ft),st.context[ft]=dt.substitution)})}}})}}function getContextParams(tt,_e){var rt=tt.map(function(nt){return nt.activeState.value});return new ContextParams(rt,_e||0)}function arabicRequiredLigatures(tt){var _e=this,rt="arab",nt=this.tokenizer.getRangeTokens(tt),it=getContextParams(nt);it.context.forEach(function(st,ot){it.setCurrentIndex(ot);var lt=_e.query.lookupFeature({tag:"rlig",script:rt,contextParams:it});lt.length&&(lt.forEach(function(at){return applySubstitution(at,nt,ot)}),it=getContextParams(nt))})}function latinWordStartCheck(tt){var _e=tt.current,rt=tt.get(-1);return rt===null&&isLatinChar(_e)||!isLatinChar(rt)&&isLatinChar(_e)}function latinWordEndCheck(tt){var _e=tt.get(1);return _e===null||!isLatinChar(_e)}var latinWordCheck={startCheck:latinWordStartCheck,endCheck:latinWordEndCheck};function getContextParams$1(tt,_e){var rt=tt.map(function(nt){return nt.activeState.value});return new ContextParams(rt,_e||0)}function latinLigature(tt){var _e=this,rt="latn",nt=this.tokenizer.getRangeTokens(tt),it=getContextParams$1(nt);it.context.forEach(function(st,ot){it.setCurrentIndex(ot);var lt=_e.query.lookupFeature({tag:"liga",script:rt,contextParams:it});lt.length&&(lt.forEach(function(at){return applySubstitution(at,nt,ot)}),it=getContextParams$1(nt))})}function Bidi(tt){this.baseDir=tt||"ltr",this.tokenizer=new Tokenizer,this.featuresTags={}}Bidi.prototype.setText=function(tt){this.text=tt};Bidi.prototype.contextChecks={latinWordCheck,arabicWordCheck,arabicSentenceCheck};function registerContextChecker(tt){var _e=this.contextChecks[tt+"Check"];return this.tokenizer.registerContextChecker(tt,_e.startCheck,_e.endCheck)}function tokenizeText(){return registerContextChecker.call(this,"latinWord"),registerContextChecker.call(this,"arabicWord"),registerContextChecker.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function reverseArabicSentences(){var tt=this,_e=this.tokenizer.getContextRanges("arabicSentence");_e.forEach(function(rt){var nt=tt.tokenizer.getRangeTokens(rt);tt.tokenizer.replaceRange(rt.startIndex,rt.endOffset,nt.reverse())})}Bidi.prototype.registerFeatures=function(tt,_e){var rt=this,nt=_e.filter(function(it){return rt.query.supports({script:tt,tag:it})});this.featuresTags.hasOwnProperty(tt)?this.featuresTags[tt]=this.featuresTags[tt].concat(nt):this.featuresTags[tt]=nt};Bidi.prototype.applyFeatures=function(tt,_e){if(!tt)throw new Error("No valid font was provided to apply features");this.query||(this.query=new FeatureQuery(tt));for(var rt=0;rt<_e.length;rt++){var nt=_e[rt];this.query.supports({script:nt.script})&&this.registerFeatures(nt.script,nt.tags)}};Bidi.prototype.registerModifier=function(tt,_e,rt){this.tokenizer.registerModifier(tt,_e,rt)};function checkGlyphIndexStatus(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function applyArabicPresentationForms(){var tt=this,_e="arab";if(this.featuresTags.hasOwnProperty(_e)){checkGlyphIndexStatus.call(this);var rt=this.tokenizer.getContextRanges("arabicWord");rt.forEach(function(nt){arabicPresentationForms.call(tt,nt)})}}function applyArabicRequireLigatures(){var tt=this,_e="arab";if(this.featuresTags.hasOwnProperty(_e)){var rt=this.featuresTags[_e];if(rt.indexOf("rlig")!==-1){checkGlyphIndexStatus.call(this);var nt=this.tokenizer.getContextRanges("arabicWord");nt.forEach(function(it){arabicRequiredLigatures.call(tt,it)})}}}function applyLatinLigatures(){var tt=this,_e="latn";if(this.featuresTags.hasOwnProperty(_e)){var rt=this.featuresTags[_e];if(rt.indexOf("liga")!==-1){checkGlyphIndexStatus.call(this);var nt=this.tokenizer.getContextRanges("latinWord");nt.forEach(function(it){latinLigature.call(tt,it)})}}}Bidi.prototype.checkContextReady=function(tt){return!!this.tokenizer.getContext(tt)};Bidi.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(applyArabicPresentationForms.call(this),applyArabicRequireLigatures.call(this)),this.checkContextReady("latinWord")&&applyLatinLigatures.call(this),this.checkContextReady("arabicSentence")&&reverseArabicSentences.call(this)};Bidi.prototype.processText=function(tt){(!this.text||this.text!==tt)&&(this.setText(tt),tokenizeText.call(this),this.applyFeaturesToContexts())};Bidi.prototype.getBidiText=function(tt){return this.processText(tt),this.tokenizer.getText()};Bidi.prototype.getTextGlyphs=function(tt){this.processText(tt);for(var _e=[],rt=0;rt<this.tokenizer.tokens.length;rt++){var nt=this.tokenizer.tokens[rt];if(!nt.state.deleted){var it=nt.activeState.value;_e.push(Array.isArray(it)?it[0]:it)}}return _e};function Font$1(tt){tt=tt||{},tt.tables=tt.tables||{},tt.empty||(checkArgument(tt.familyName,"When creating a new Font object, familyName is required."),checkArgument(tt.styleName,"When creating a new Font object, styleName is required."),checkArgument(tt.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),checkArgument(tt.ascender,"When creating a new Font object, ascender is required."),checkArgument(tt.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:tt.familyName||" "},fontSubfamily:{en:tt.styleName||" "},fullName:{en:tt.fullName||tt.familyName+" "+tt.styleName},postScriptName:{en:tt.postScriptName||(tt.familyName+tt.styleName).replace(/\s/g,"")},designer:{en:tt.designer||" "},designerURL:{en:tt.designerURL||" "},manufacturer:{en:tt.manufacturer||" "},manufacturerURL:{en:tt.manufacturerURL||" "},license:{en:tt.license||" "},licenseURL:{en:tt.licenseURL||" "},version:{en:tt.version||"Version 0.1"},description:{en:tt.description||" "},copyright:{en:tt.copyright||" "},trademark:{en:tt.trademark||" "}},this.unitsPerEm=tt.unitsPerEm||1e3,this.ascender=tt.ascender,this.descender=tt.descender,this.createdTimestamp=tt.createdTimestamp,this.tables=Object.assign(tt.tables,{os2:Object.assign({usWeightClass:tt.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:tt.widthClass||this.usWidthClasses.MEDIUM,fsSelection:tt.fsSelection||this.fsSelectionValues.REGULAR},tt.tables.os2)})),this.supported=!0,this.glyphs=new glyphset.GlyphSet(this,tt.glyphs||[]),this.encoding=new DefaultEncoding(this),this.position=new Position(this),this.substitution=new Substitution(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new Hinting(this)}})}Font$1.prototype.hasChar=function(tt){return this.encoding.charToGlyphIndex(tt)!==null};Font$1.prototype.charToGlyphIndex=function(tt){return this.encoding.charToGlyphIndex(tt)};Font$1.prototype.charToGlyph=function(tt){var _e=this.charToGlyphIndex(tt),rt=this.glyphs.get(_e);return rt||(rt=this.glyphs.get(0)),rt};Font$1.prototype.updateFeatures=function(tt){return this.defaultRenderOptions.features.map(function(_e){return _e.script==="latn"?{script:"latn",tags:_e.tags.filter(function(rt){return tt[rt]})}:_e})};Font$1.prototype.stringToGlyphs=function(tt,_e){var rt=this,nt=new Bidi,it=function(ht){return rt.charToGlyphIndex(ht.char)};nt.registerModifier("glyphIndex",null,it);var st=_e?this.updateFeatures(_e.features):this.defaultRenderOptions.features;nt.applyFeatures(this,st);for(var ot=nt.getTextGlyphs(tt),lt=ot.length,at=new Array(lt),ct=this.glyphs.get(0),ut=0;ut<lt;ut+=1)at[ut]=this.glyphs.get(ot[ut])||ct;return at};Font$1.prototype.nameToGlyphIndex=function(tt){return this.glyphNames.nameToGlyphIndex(tt)};Font$1.prototype.nameToGlyph=function(tt){var _e=this.nameToGlyphIndex(tt),rt=this.glyphs.get(_e);return rt||(rt=this.glyphs.get(0)),rt};Font$1.prototype.glyphIndexToName=function(tt){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(tt):""};Font$1.prototype.getKerningValue=function(tt,_e){tt=tt.index||tt,_e=_e.index||_e;var rt=this.position.defaultKerningTables;return rt?this.position.getKerningValue(rt,tt,_e):this.kerningPairs[tt+","+_e]||0};Font$1.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]};Font$1.prototype.forEachGlyph=function(tt,_e,rt,nt,it,st){_e=_e!==void 0?_e:0,rt=rt!==void 0?rt:0,nt=nt!==void 0?nt:72,it=Object.assign({},this.defaultRenderOptions,it);var ot=1/this.unitsPerEm*nt,lt=this.stringToGlyphs(tt,it),at;if(it.kerning){var ct=it.script||this.position.getDefaultScriptName();at=this.position.getKerningTables(ct,it.language)}for(var ut=0;ut<lt.length;ut+=1){var ht=lt[ut];if(st.call(this,ht,_e,rt,nt,it),ht.advanceWidth&&(_e+=ht.advanceWidth*ot),it.kerning&&ut<lt.length-1){var dt=at?this.position.getKerningValue(at,ht.index,lt[ut+1].index):this.getKerningValue(ht,lt[ut+1]);_e+=dt*ot}it.letterSpacing?_e+=it.letterSpacing*nt:it.tracking&&(_e+=it.tracking/1e3*nt)}return _e};Font$1.prototype.getPath=function(tt,_e,rt,nt,it){var st=new Path;return this.forEachGlyph(tt,_e,rt,nt,it,function(ot,lt,at,ct){var ut=ot.getPath(lt,at,ct,it,this);st.extend(ut)}),st};Font$1.prototype.getPaths=function(tt,_e,rt,nt,it){var st=[];return this.forEachGlyph(tt,_e,rt,nt,it,function(ot,lt,at,ct){var ut=ot.getPath(lt,at,ct,it,this);st.push(ut)}),st};Font$1.prototype.getAdvanceWidth=function(tt,_e,rt){return this.forEachGlyph(tt,0,0,_e,rt,function(){})};Font$1.prototype.draw=function(tt,_e,rt,nt,it,st){this.getPath(_e,rt,nt,it,st).draw(tt)};Font$1.prototype.drawPoints=function(tt,_e,rt,nt,it,st){this.forEachGlyph(_e,rt,nt,it,st,function(ot,lt,at,ct){ot.drawPoints(tt,lt,at,ct)})};Font$1.prototype.drawMetrics=function(tt,_e,rt,nt,it,st){this.forEachGlyph(_e,rt,nt,it,st,function(ot,lt,at,ct){ot.drawMetrics(tt,lt,at,ct)})};Font$1.prototype.getEnglishName=function(tt){var _e=this.names[tt];if(_e)return _e.en};Font$1.prototype.validate=function(){var tt=this;function _e(nt,it){}function rt(nt){var it=tt.getEnglishName(nt);it&&it.trim().length>0}rt("fontFamily"),rt("weightName"),rt("manufacturer"),rt("copyright"),rt("version"),this.unitsPerEm>0};Font$1.prototype.toTables=function(){return sfnt.fontToTable(this)};Font$1.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()};Font$1.prototype.toArrayBuffer=function(){for(var tt=this.toTables(),_e=tt.encode(),rt=new ArrayBuffer(_e.length),nt=new Uint8Array(rt),it=0;it<_e.length;it++)nt[it]=_e[it];return rt};Font$1.prototype.download=function(tt){var _e=this.getEnglishName("fontFamily"),rt=this.getEnglishName("fontSubfamily");tt=tt||_e.replace(/\s/g,"")+"-"+rt+".otf";var nt=this.toArrayBuffer();if(isBrowser$1())if(window.URL=window.URL||window.webkitURL,window.URL){var it=new DataView(nt),st=new Blob([it],{type:"font/opentype"}),ot=document.createElement("a");ot.href=window.URL.createObjectURL(st),ot.download=tt;var lt=document.createEvent("MouseEvents");lt.initEvent("click",!0,!1),ot.dispatchEvent(lt)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var at=require("fs"),ct=arrayBufferToNodeBuffer(nt);at.writeFileSync(tt,ct)}};Font$1.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512};Font$1.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};Font$1.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var subtableParsers$1=new Array(10);subtableParsers$1[1]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();if(rt===1)return{posFormat:1,coverage:this.parsePointer(Parser$1.coverage),value:this.parseValueRecord()};if(rt===2)return{posFormat:2,coverage:this.parsePointer(Parser$1.coverage),values:this.parseValueRecordList()};check.assert(!1,"0x"+_e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")};subtableParsers$1[2]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();check.assert(rt===1||rt===2,"0x"+_e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var nt=this.parsePointer(Parser$1.coverage),it=this.parseUShort(),st=this.parseUShort();if(rt===1)return{posFormat:rt,coverage:nt,valueFormat1:it,valueFormat2:st,pairSets:this.parseList(Parser$1.pointer(Parser$1.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(it),value2:this.parseValueRecord(st)}})))};if(rt===2){var ot=this.parsePointer(Parser$1.classDef),lt=this.parsePointer(Parser$1.classDef),at=this.parseUShort(),ct=this.parseUShort();return{posFormat:rt,coverage:nt,valueFormat1:it,valueFormat2:st,classDef1:ot,classDef2:lt,class1Count:at,class2Count:ct,classRecords:this.parseList(at,Parser$1.list(ct,function(){return{value1:this.parseValueRecord(it),value2:this.parseValueRecord(st)}}))}}};subtableParsers$1[3]=function(){return{error:"GPOS Lookup 3 not supported"}};subtableParsers$1[4]=function(){return{error:"GPOS Lookup 4 not supported"}};subtableParsers$1[5]=function(){return{error:"GPOS Lookup 5 not supported"}};subtableParsers$1[6]=function(){return{error:"GPOS Lookup 6 not supported"}};subtableParsers$1[7]=function(){return{error:"GPOS Lookup 7 not supported"}};subtableParsers$1[8]=function(){return{error:"GPOS Lookup 8 not supported"}};subtableParsers$1[9]=function(){return{error:"GPOS Lookup 9 not supported"}};new Array(10);var __defProp=Object.defineProperty,__defNormalProp=(tt,_e,rt)=>_e in tt?__defProp(tt,_e,{enumerable:!0,configurable:!0,writable:!0,value:rt}):tt[_e]=rt,__publicField=(tt,_e,rt)=>(__defNormalProp(tt,typeof _e!="symbol"?_e+"":_e,rt),rt);function toTrianglesDrawMode$1(tt,_e){if(_e===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),tt;if(_e===TriangleFanDrawMode||_e===TriangleStripDrawMode){let rt=tt.getIndex();if(rt===null){const ot=[],lt=tt.getAttribute("position");if(lt!==void 0){for(let at=0;at<lt.count;at++)ot.push(at);tt.setIndex(ot),rt=tt.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),tt}const nt=rt.count-2,it=[];if(rt)if(_e===TriangleFanDrawMode)for(let ot=1;ot<=nt;ot++)it.push(rt.getX(0)),it.push(rt.getX(ot)),it.push(rt.getX(ot+1));else for(let ot=0;ot<nt;ot++)ot%2===0?(it.push(rt.getX(ot)),it.push(rt.getX(ot+1)),it.push(rt.getX(ot+2))):(it.push(rt.getX(ot+2)),it.push(rt.getX(ot+1)),it.push(rt.getX(ot)));it.length/3!==nt&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const st=tt.clone();return st.setIndex(it),st.clearGroups(),st}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_e),tt}new Color$1;const _DRACOExporter=class{parse(tt,_e={decodeSpeed:5,encodeSpeed:5,encoderMethod:_DRACOExporter.MESH_EDGEBREAKER_ENCODING,quantization:[16,8,8,8,8],exportUvs:!0,exportNormals:!0,exportColor:!1}){if(tt instanceof BufferGeometry&&tt.isBufferGeometry)throw new Error("DRACOExporter: The first parameter of parse() is now an instance of Mesh or Points.");if(DracoEncoderModule===void 0)throw new Error("THREE.DRACOExporter: required the draco_encoder to work.");const rt=tt.geometry,nt=DracoEncoderModule(),it=new nt.Encoder;let st,ot;if(!rt.isBufferGeometry)throw new Error("THREE.DRACOExporter.parse(geometry, options): geometry is not a THREE.BufferGeometry instance.");if(tt instanceof Mesh&&tt.isMesh){st=new nt.MeshBuilder,ot=new nt.Mesh;const dt=rt.getAttribute("position");st.AddFloatAttributeToMesh(ot,nt.POSITION,dt.count,dt.itemSize,dt.array);const ft=rt.getIndex();if(ft!==null)st.AddFacesToMesh(ot,ft.count/3,ft.array);else{const pt=new(dt.count>65535?Uint32Array:Uint16Array)(dt.count);for(let mt=0;mt<pt.length;mt++)pt[mt]=mt;st.AddFacesToMesh(ot,dt.count,pt)}if(_e.exportNormals){const pt=rt.getAttribute("normal");pt!==void 0&&st.AddFloatAttributeToMesh(ot,nt.NORMAL,pt.count,pt.itemSize,pt.array)}if(_e.exportUvs){const pt=rt.getAttribute("uv");pt!==void 0&&st.AddFloatAttributeToMesh(ot,nt.TEX_COORD,pt.count,pt.itemSize,pt.array)}if(_e.exportColor){const pt=rt.getAttribute("color");pt!==void 0&&st.AddFloatAttributeToMesh(ot,nt.COLOR,pt.count,pt.itemSize,pt.array)}}else if(tt instanceof Points&&tt.isPoints){st=new nt.PointCloudBuilder,ot=new nt.PointCloud;const dt=rt.getAttribute("position");if(st.AddFloatAttribute(ot,nt.POSITION,dt.count,dt.itemSize,dt.array),_e.exportColor){const ft=rt.getAttribute("color");ft!==void 0&&st.AddFloatAttribute(ot,nt.COLOR,ft.count,ft.itemSize,ft.array)}}else throw new Error("DRACOExporter: Unsupported object type.");const lt=new nt.DracoInt8Array,at=_e.encodeSpeed!==void 0?_e.encodeSpeed:5,ct=_e.decodeSpeed!==void 0?_e.decodeSpeed:5;if(it.SetSpeedOptions(at,ct),_e.encoderMethod!==void 0&&it.SetEncodingMethod(_e.encoderMethod),_e.quantization!==void 0)for(let dt=0;dt<5;dt++)_e.quantization[dt]!==void 0&&it.SetAttributeQuantization(dt,_e.quantization[dt]);let ut;if(tt instanceof Mesh&&tt.isMesh?ut=it.EncodeMeshToDracoBuffer(ot,lt):ut=it.EncodePointCloudToDracoBuffer(ot,!0,lt),nt.destroy(ot),ut===0)throw new Error("THREE.DRACOExporter: Draco encoding failed.");const ht=new Int8Array(new ArrayBuffer(ut));for(let dt=0;dt<ut;dt++)ht[dt]=lt.GetValue(dt);return nt.destroy(lt),nt.destroy(it),nt.destroy(st),ht}};let DRACOExporter=_DRACOExporter;__publicField(DRACOExporter,"MESH_EDGEBREAKER_ENCODING",1);__publicField(DRACOExporter,"MESH_SEQUENTIAL_ENCODING",0);__publicField(DRACOExporter,"POINT_CLOUD",0);__publicField(DRACOExporter,"TRIANGULAR_MESH",1);__publicField(DRACOExporter,"INVALID",-1);__publicField(DRACOExporter,"POSITION",0);__publicField(DRACOExporter,"NORMAL",1);__publicField(DRACOExporter,"COLOR",2);__publicField(DRACOExporter,"TEX_COORD",3);__publicField(DRACOExporter,"GENERIC",4);const _Reflector=class extends Mesh{constructor(tt,_e={}){super(tt),this.isReflector=!0,this.type="Reflector",this.camera=new PerspectiveCamera;const rt=this,nt=_e.color!==void 0?new Color$1(_e.color):new Color$1(8355711),it=_e.textureWidth||512,st=_e.textureHeight||512,ot=_e.clipBias||0,lt=_e.shader||_Reflector.ReflectorShader,at=_e.multisample!==void 0?_e.multisample:4,ct=new Plane,ut=new Vector3,ht=new Vector3,dt=new Vector3,ft=new Matrix4,pt=new Vector3(0,0,-1),mt=new Vector4,gt=new Vector3,vt=new Vector3,At=new Vector4,yt=new Matrix4,xt=this.camera,_t=new WebGLRenderTarget(it,st,{samples:at,type:HalfFloatType}),Et=new ShaderMaterial({uniforms:UniformsUtils.clone(lt.uniforms),fragmentShader:lt.fragmentShader,vertexShader:lt.vertexShader});Et.uniforms.tDiffuse.value=_t.texture,Et.uniforms.color.value=nt,Et.uniforms.textureMatrix.value=yt,this.material=Et,this.onBeforeRender=function(bt,wt,Tt){if(ht.setFromMatrixPosition(rt.matrixWorld),dt.setFromMatrixPosition(Tt.matrixWorld),ft.extractRotation(rt.matrixWorld),ut.set(0,0,1),ut.applyMatrix4(ft),gt.subVectors(ht,dt),gt.dot(ut)>0)return;gt.reflect(ut).negate(),gt.add(ht),ft.extractRotation(Tt.matrixWorld),pt.set(0,0,-1),pt.applyMatrix4(ft),pt.add(dt),vt.subVectors(ht,pt),vt.reflect(ut).negate(),vt.add(ht),xt.position.copy(gt),xt.up.set(0,1,0),xt.up.applyMatrix4(ft),xt.up.reflect(ut),xt.lookAt(vt),xt.far=Tt.far,xt.updateMatrixWorld(),xt.projectionMatrix.copy(Tt.projectionMatrix),yt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),yt.multiply(xt.projectionMatrix),yt.multiply(xt.matrixWorldInverse),yt.multiply(rt.matrixWorld),ct.setFromNormalAndCoplanarPoint(ut,ht),ct.applyMatrix4(xt.matrixWorldInverse),mt.set(ct.normal.x,ct.normal.y,ct.normal.z,ct.constant);const Mt=xt.projectionMatrix;At.x=(Math.sign(mt.x)+Mt.elements[8])/Mt.elements[0],At.y=(Math.sign(mt.y)+Mt.elements[9])/Mt.elements[5],At.z=-1,At.w=(1+Mt.elements[10])/Mt.elements[14],mt.multiplyScalar(2/mt.dot(At)),Mt.elements[2]=mt.x,Mt.elements[6]=mt.y,Mt.elements[10]=mt.z+1-ot,Mt.elements[14]=mt.w,rt.visible=!1;const Pt=bt.getRenderTarget(),It=bt.xr.enabled,Ot=bt.shadowMap.autoUpdate,Bt=bt.toneMapping;let Ut=!1;"outputColorSpace"in bt?Ut=bt.outputColorSpace==="srgb":Ut=bt.outputEncoding===3001,bt.xr.enabled=!1,bt.shadowMap.autoUpdate=!1,"outputColorSpace"in bt?bt.outputColorSpace="linear-srgb":bt.outputEncoding=3e3,bt.toneMapping=NoToneMapping,bt.setRenderTarget(_t),bt.state.buffers.depth.setMask(!0),bt.autoClear===!1&&bt.clear(),bt.render(wt,xt),bt.xr.enabled=It,bt.shadowMap.autoUpdate=Ot,bt.toneMapping=Bt,"outputColorSpace"in bt?bt.outputColorSpace=Ut?"srgb":"srgb-linear":bt.outputEncoding=Ut?3001:3e3,bt.setRenderTarget(Pt);const Ft=Tt.viewport;Ft!==void 0&&bt.state.viewport(Ft),rt.visible=!0},this.getRenderTarget=function(){return _t},this.dispose=function(){_t.dispose(),rt.material.dispose()}}};let Reflector=_Reflector;__publicField(Reflector,"ReflectorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>

		}`});const _Refractor=class extends Mesh{constructor(tt,_e={}){super(tt),this.isRefractor=!0,this.type="Refractor",this.camera=new PerspectiveCamera;const rt=this,nt=_e.color!==void 0?new Color$1(_e.color):new Color$1(8355711),it=_e.textureWidth||512,st=_e.textureHeight||512,ot=_e.clipBias||0,lt=_e.shader||_Refractor.RefractorShader,at=_e.multisample!==void 0?_e.multisample:4,ct=this.camera;ct.matrixAutoUpdate=!1,ct.userData.refractor=!0;const ut=new Plane,ht=new Matrix4,dt=new WebGLRenderTarget(it,st,{samples:at,type:HalfFloatType});this.material=new ShaderMaterial({uniforms:UniformsUtils.clone(lt.uniforms),vertexShader:lt.vertexShader,fragmentShader:lt.fragmentShader,transparent:!0}),this.material.uniforms.color.value=nt,this.material.uniforms.tDiffuse.value=dt.texture,this.material.uniforms.textureMatrix.value=ht;const ft=function(){const At=new Vector3,yt=new Vector3,xt=new Matrix4,_t=new Vector3,Et=new Vector3;return function(wt){return At.setFromMatrixPosition(rt.matrixWorld),yt.setFromMatrixPosition(wt.matrixWorld),_t.subVectors(At,yt),xt.extractRotation(rt.matrixWorld),Et.set(0,0,1),Et.applyMatrix4(xt),_t.dot(Et)<0}}(),pt=function(){const At=new Vector3,yt=new Vector3,xt=new Quaternion,_t=new Vector3;return function(){rt.matrixWorld.decompose(yt,xt,_t),At.set(0,0,1).applyQuaternion(xt).normalize(),At.negate(),ut.setFromNormalAndCoplanarPoint(At,yt)}}(),mt=function(){const At=new Plane,yt=new Vector4,xt=new Vector4;return function(Et){ct.matrixWorld.copy(Et.matrixWorld),ct.matrixWorldInverse.copy(ct.matrixWorld).invert(),ct.projectionMatrix.copy(Et.projectionMatrix),ct.far=Et.far,At.copy(ut),At.applyMatrix4(ct.matrixWorldInverse),yt.set(At.normal.x,At.normal.y,At.normal.z,At.constant);const bt=ct.projectionMatrix;xt.x=(Math.sign(yt.x)+bt.elements[8])/bt.elements[0],xt.y=(Math.sign(yt.y)+bt.elements[9])/bt.elements[5],xt.z=-1,xt.w=(1+bt.elements[10])/bt.elements[14],yt.multiplyScalar(2/yt.dot(xt)),bt.elements[2]=yt.x,bt.elements[6]=yt.y,bt.elements[10]=yt.z+1-ot,bt.elements[14]=yt.w}}();function gt(At){ht.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ht.multiply(At.projectionMatrix),ht.multiply(At.matrixWorldInverse),ht.multiply(rt.matrixWorld)}function vt(At,yt,xt){rt.visible=!1;const _t=At.getRenderTarget(),Et=At.xr.enabled,bt=At.shadowMap.autoUpdate,wt=At.toneMapping;let Tt=!1;"outputColorSpace"in At?Tt=At.outputColorSpace==="srgb":Tt=At.outputEncoding===3001,At.xr.enabled=!1,At.shadowMap.autoUpdate=!1,"outputColorSpace"in At?At.outputColorSpace="linear-srgb":At.outputEncoding=3e3,At.toneMapping=NoToneMapping,At.setRenderTarget(dt),At.autoClear===!1&&At.clear(),At.render(yt,ct),At.xr.enabled=Et,At.shadowMap.autoUpdate=bt,At.toneMapping=wt,At.setRenderTarget(_t),"outputColorSpace"in At?At.outputColorSpace=Tt?"srgb":"srgb-linear":At.outputEncoding=Tt?3001:3e3;const Mt=xt.viewport;Mt!==void 0&&At.state.viewport(Mt),rt.visible=!0}this.onBeforeRender=function(At,yt,xt){xt.userData.refractor!==!0&&ft(xt)&&(pt(),gt(xt),mt(xt),vt(At,yt,xt))},this.getRenderTarget=function(){return dt},this.dispose=function(){dt.dispose(),rt.material.dispose()}}};let Refractor=_Refractor;__publicField(Refractor,"RefractorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`

		uniform mat4 textureMatrix;

		varying vec4 vUv;

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform vec3 color;
		uniform sampler2D tDiffuse;

		varying vec4 vUv;

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>

		}`});const geometry=new BufferGeometry,_Lensflare=class extends Mesh{constructor(){super(_Lensflare.Geometry,new MeshBasicMaterial({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const tt=new Vector3,_e=new Vector3,rt=new DataTexture(new Uint8Array(16*16*3),16,16,RGBAFormat);rt.minFilter=NearestFilter,rt.magFilter=NearestFilter,rt.wrapS=ClampToEdgeWrapping,rt.wrapT=ClampToEdgeWrapping;const nt=new DataTexture(new Uint8Array(16*16*3),16,16,RGBAFormat);nt.minFilter=NearestFilter,nt.magFilter=NearestFilter,nt.wrapS=ClampToEdgeWrapping,nt.wrapT=ClampToEdgeWrapping;const it=_Lensflare.Geometry,st=new RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),ot=new RawShaderMaterial({uniforms:{map:{value:rt},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),lt=new Mesh(it,st),at=[],ct=LensflareElement.Shader,ut=new RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:nt},color:{value:new Color$1(16777215)},scale:{value:new Vector2},screenPosition:{value:new Vector3}},vertexShader:ct.vertexShader,fragmentShader:ct.fragmentShader,blending:AdditiveBlending,transparent:!0,depthWrite:!1}),ht=new Mesh(it,ut);this.addElement=function(gt){at.push(gt)};const dt=new Vector2,ft=new Vector2,pt=new Box2,mt=new Vector4;this.onBeforeRender=function(gt,vt,At){gt.getCurrentViewport(mt);const yt=mt.w/mt.z,xt=mt.z/2,_t=mt.w/2;let Et=16/mt.w;if(dt.set(Et*yt,Et),pt.min.set(mt.x,mt.y),pt.max.set(mt.x+(mt.z-16),mt.y+(mt.w-16)),_e.setFromMatrixPosition(this.matrixWorld),_e.applyMatrix4(At.matrixWorldInverse),!(_e.z>0)&&(tt.copy(_e).applyMatrix4(At.projectionMatrix),ft.x=mt.x+tt.x*xt+xt-8,ft.y=mt.y+tt.y*_t+_t-8,pt.containsPoint(ft))){gt.copyFramebufferToTexture(ft,rt);let bt=st.uniforms;bt.scale.value=dt,bt.screenPosition.value=tt,gt.renderBufferDirect(At,null,it,st,lt,null),gt.copyFramebufferToTexture(ft,nt),bt=ot.uniforms,bt.scale.value=dt,bt.screenPosition.value=tt,gt.renderBufferDirect(At,null,it,ot,lt,null);const wt=-tt.x*2,Tt=-tt.y*2;for(let Mt=0,Pt=at.length;Mt<Pt;Mt++){const It=at[Mt],Ot=ut.uniforms;Ot.color.value.copy(It.color),Ot.map.value=It.texture,Ot.screenPosition.value.x=tt.x+wt*It.distance,Ot.screenPosition.value.y=tt.y+Tt*It.distance,Et=It.size/mt.w;const Bt=mt.w/mt.z;Ot.scale.value.set(Et*Bt,Et),ut.uniformsNeedUpdate=!0,gt.renderBufferDirect(At,null,it,ut,ht,null)}}},this.dispose=function(){st.dispose(),ot.dispose(),ut.dispose(),rt.dispose(),nt.dispose();for(let gt=0,vt=at.length;gt<vt;gt++)at[gt].texture.dispose()}}};let Lensflare=_Lensflare;__publicField(Lensflare,"Geometry",geometry);class LensflareElement{constructor(_e,rt=1,nt=0,it=new Color$1(16777215)){this.texture=_e,this.size=rt,this.distance=nt,this.color=it}}__publicField(LensflareElement,"Shader",{uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`});class SimplexNoise{constructor(_e=Math){__publicField(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),__publicField(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),__publicField(this,"p",[]),__publicField(this,"perm",[]),__publicField(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),__publicField(this,"dot",(rt,nt,it)=>rt[0]*nt+rt[1]*it),__publicField(this,"dot3",(rt,nt,it,st)=>rt[0]*nt+rt[1]*it+rt[2]*st),__publicField(this,"dot4",(rt,nt,it,st,ot)=>rt[0]*nt+rt[1]*it+rt[2]*st+rt[3]*ot),__publicField(this,"noise",(rt,nt)=>{let it,st,ot;const lt=.5*(Math.sqrt(3)-1),at=(rt+nt)*lt,ct=Math.floor(rt+at),ut=Math.floor(nt+at),ht=(3-Math.sqrt(3))/6,dt=(ct+ut)*ht,ft=ct-dt,pt=ut-dt,mt=rt-ft,gt=nt-pt;let vt=0,At=1;mt>gt&&(vt=1,At=0);const yt=mt-vt+ht,xt=gt-At+ht,_t=mt-1+2*ht,Et=gt-1+2*ht,bt=ct&255,wt=ut&255,Tt=this.perm[bt+this.perm[wt]]%12,Mt=this.perm[bt+vt+this.perm[wt+At]]%12,Pt=this.perm[bt+1+this.perm[wt+1]]%12;let It=.5-mt*mt-gt*gt;It<0?it=0:(It*=It,it=It*It*this.dot(this.grad3[Tt],mt,gt));let Ot=.5-yt*yt-xt*xt;Ot<0?st=0:(Ot*=Ot,st=Ot*Ot*this.dot(this.grad3[Mt],yt,xt));let Bt=.5-_t*_t-Et*Et;return Bt<0?ot=0:(Bt*=Bt,ot=Bt*Bt*this.dot(this.grad3[Pt],_t,Et)),70*(it+st+ot)}),__publicField(this,"noise3d",(rt,nt,it)=>{let st,ot,lt,at;const ct=.3333333333333333,ut=(rt+nt+it)*ct,ht=Math.floor(rt+ut),dt=Math.floor(nt+ut),ft=Math.floor(it+ut),pt=1/6,mt=(ht+dt+ft)*pt,gt=ht-mt,vt=dt-mt,At=ft-mt,yt=rt-gt,xt=nt-vt,_t=it-At;let Et,bt,wt,Tt,Mt,Pt;yt>=xt?xt>=_t?(Et=1,bt=0,wt=0,Tt=1,Mt=1,Pt=0):yt>=_t?(Et=1,bt=0,wt=0,Tt=1,Mt=0,Pt=1):(Et=0,bt=0,wt=1,Tt=1,Mt=0,Pt=1):xt<_t?(Et=0,bt=0,wt=1,Tt=0,Mt=1,Pt=1):yt<_t?(Et=0,bt=1,wt=0,Tt=0,Mt=1,Pt=1):(Et=0,bt=1,wt=0,Tt=1,Mt=1,Pt=0);const It=yt-Et+pt,Ot=xt-bt+pt,Bt=_t-wt+pt,Ut=yt-Tt+2*pt,Ft=xt-Mt+2*pt,jt=_t-Pt+2*pt,Dt=yt-1+3*pt,Gt=xt-1+3*pt,zt=_t-1+3*pt,$t=ht&255,Ht=dt&255,er=ft&255,Zt=this.perm[$t+this.perm[Ht+this.perm[er]]]%12,or=this.perm[$t+Et+this.perm[Ht+bt+this.perm[er+wt]]]%12,Kt=this.perm[$t+Tt+this.perm[Ht+Mt+this.perm[er+Pt]]]%12,rr=this.perm[$t+1+this.perm[Ht+1+this.perm[er+1]]]%12;let ur=.6-yt*yt-xt*xt-_t*_t;ur<0?st=0:(ur*=ur,st=ur*ur*this.dot3(this.grad3[Zt],yt,xt,_t));let fr=.6-It*It-Ot*Ot-Bt*Bt;fr<0?ot=0:(fr*=fr,ot=fr*fr*this.dot3(this.grad3[or],It,Ot,Bt));let dr=.6-Ut*Ut-Ft*Ft-jt*jt;dr<0?lt=0:(dr*=dr,lt=dr*dr*this.dot3(this.grad3[Kt],Ut,Ft,jt));let gr=.6-Dt*Dt-Gt*Gt-zt*zt;return gr<0?at=0:(gr*=gr,at=gr*gr*this.dot3(this.grad3[rr],Dt,Gt,zt)),32*(st+ot+lt+at)}),__publicField(this,"noise4d",(rt,nt,it,st)=>{const ot=this.grad4,lt=this.simplex,at=this.perm,ct=(Math.sqrt(5)-1)/4,ut=(5-Math.sqrt(5))/20;let ht,dt,ft,pt,mt;const gt=(rt+nt+it+st)*ct,vt=Math.floor(rt+gt),At=Math.floor(nt+gt),yt=Math.floor(it+gt),xt=Math.floor(st+gt),_t=(vt+At+yt+xt)*ut,Et=vt-_t,bt=At-_t,wt=yt-_t,Tt=xt-_t,Mt=rt-Et,Pt=nt-bt,It=it-wt,Ot=st-Tt,Bt=Mt>Pt?32:0,Ut=Mt>It?16:0,Ft=Pt>It?8:0,jt=Mt>Ot?4:0,Dt=Pt>Ot?2:0,Gt=It>Ot?1:0,zt=Bt+Ut+Ft+jt+Dt+Gt;let $t,Ht,er,Zt,or,Kt,rr,ur,fr,dr,gr,Yt;$t=lt[zt][0]>=3?1:0,Ht=lt[zt][1]>=3?1:0,er=lt[zt][2]>=3?1:0,Zt=lt[zt][3]>=3?1:0,or=lt[zt][0]>=2?1:0,Kt=lt[zt][1]>=2?1:0,rr=lt[zt][2]>=2?1:0,ur=lt[zt][3]>=2?1:0,fr=lt[zt][0]>=1?1:0,dr=lt[zt][1]>=1?1:0,gr=lt[zt][2]>=1?1:0,Yt=lt[zt][3]>=1?1:0;const xr=Mt-$t+ut,vr=Pt-Ht+ut,Pr=It-er+ut,Sr=Ot-Zt+ut,Qr=Mt-or+2*ut,Ir=Pt-Kt+2*ut,Dr=It-rr+2*ut,Ur=Ot-ur+2*ut,Lr=Mt-fr+3*ut,Wr=Pt-dr+3*ut,Xt=It-gr+3*ut,Qt=Ot-Yt+3*ut,hr=Mt-1+4*ut,kr=Pt-1+4*ut,yr=It-1+4*ut,_r=Ot-1+4*ut,Hr=vt&255,Er=At&255,Ar=yt&255,qt=xt&255,pr=at[Hr+at[Er+at[Ar+at[qt]]]]%32,mr=at[Hr+$t+at[Er+Ht+at[Ar+er+at[qt+Zt]]]]%32,nr=at[Hr+or+at[Er+Kt+at[Ar+rr+at[qt+ur]]]]%32,Cr=at[Hr+fr+at[Er+dr+at[Ar+gr+at[qt+Yt]]]]%32,cr=at[Hr+1+at[Er+1+at[Ar+1+at[qt+1]]]]%32;let Jr=.6-Mt*Mt-Pt*Pt-It*It-Ot*Ot;Jr<0?ht=0:(Jr*=Jr,ht=Jr*Jr*this.dot4(ot[pr],Mt,Pt,It,Ot));let lr=.6-xr*xr-vr*vr-Pr*Pr-Sr*Sr;lr<0?dt=0:(lr*=lr,dt=lr*lr*this.dot4(ot[mr],xr,vr,Pr,Sr));let Rr=.6-Qr*Qr-Ir*Ir-Dr*Dr-Ur*Ur;Rr<0?ft=0:(Rr*=Rr,ft=Rr*Rr*this.dot4(ot[nr],Qr,Ir,Dr,Ur));let br=.6-Lr*Lr-Wr*Wr-Xt*Xt-Qt*Qt;br<0?pt=0:(br*=br,pt=br*br*this.dot4(ot[Cr],Lr,Wr,Xt,Qt));let jr=.6-hr*hr-kr*kr-yr*yr-_r*_r;return jr<0?mt=0:(jr*=jr,mt=jr*jr*this.dot4(ot[cr],hr,kr,yr,_r)),27*(ht+dt+ft+pt+mt)});for(let rt=0;rt<256;rt++)this.p[rt]=Math.floor(_e.random()*256);for(let rt=0;rt<512;rt++)this.perm[rt]=this.p[rt&255]}}const _LightningStrike=class extends BufferGeometry{constructor(tt={}){super(),this.isLightningStrike=!0,this.type="LightningStrike",this.init(_LightningStrike.copyParameters(tt,tt)),this.createMesh()}static createRandomGenerator(){const _e=[];for(let nt=0;nt<2053;nt++)_e.push(Math.random());const rt={currentSeed:0,random:function(){const nt=_e[rt.currentSeed];return rt.currentSeed=(rt.currentSeed+1)%2053,nt},getSeed:function(){return rt.currentSeed/2053},setSeed:function(nt){rt.currentSeed=Math.floor(nt*2053)%2053}};return rt}static copyParameters(tt={},_e={}){const rt=function(nt){return _e===tt?nt:nt.clone()};return tt.sourceOffset=_e.sourceOffset!==void 0?rt(_e.sourceOffset):new Vector3(0,100,0),tt.destOffset=_e.destOffset!==void 0?rt(_e.destOffset):new Vector3(0,0,0),tt.timeScale=_e.timeScale!==void 0?_e.timeScale:1,tt.roughness=_e.roughness!==void 0?_e.roughness:.9,tt.straightness=_e.straightness!==void 0?_e.straightness:.7,tt.up0=_e.up0!==void 0?rt(_e.up0):new Vector3(0,0,1),tt.up1=_e.up1!==void 0?rt(_e.up1):new Vector3(0,0,1),tt.radius0=_e.radius0!==void 0?_e.radius0:1,tt.radius1=_e.radius1!==void 0?_e.radius1:1,tt.radius0Factor=_e.radius0Factor!==void 0?_e.radius0Factor:.5,tt.radius1Factor=_e.radius1Factor!==void 0?_e.radius1Factor:.2,tt.minRadius=_e.minRadius!==void 0?_e.minRadius:.2,tt.isEternal=_e.isEternal!==void 0?_e.isEternal:_e.birthTime===void 0||_e.deathTime===void 0,tt.birthTime=_e.birthTime,tt.deathTime=_e.deathTime,tt.propagationTimeFactor=_e.propagationTimeFactor!==void 0?_e.propagationTimeFactor:.1,tt.vanishingTimeFactor=_e.vanishingTimeFactor!==void 0?_e.vanishingTimeFactor:.9,tt.subrayPeriod=_e.subrayPeriod!==void 0?_e.subrayPeriod:4,tt.subrayDutyCycle=_e.subrayDutyCycle!==void 0?_e.subrayDutyCycle:.6,tt.maxIterations=_e.maxIterations!==void 0?_e.maxIterations:9,tt.isStatic=_e.isStatic!==void 0?_e.isStatic:!1,tt.ramification=_e.ramification!==void 0?_e.ramification:5,tt.maxSubrayRecursion=_e.maxSubrayRecursion!==void 0?_e.maxSubrayRecursion:3,tt.recursionProbability=_e.recursionProbability!==void 0?_e.recursionProbability:.6,tt.generateUVs=_e.generateUVs!==void 0?_e.generateUVs:!1,tt.randomGenerator=_e.randomGenerator,tt.noiseSeed=_e.noiseSeed,tt.onDecideSubrayCreation=_e.onDecideSubrayCreation,tt.onSubrayCreation=_e.onSubrayCreation,tt}update(tt){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=tt&&tt<=this.rayParameters.deathTime?(this.updateMesh(tt),tt<this.subrays[0].endPropagationTime?this.state=_LightningStrike.RAY_PROPAGATING:tt>this.subrays[0].beginVanishingTime?this.state=_LightningStrike.RAY_VANISHING:this.state=_LightningStrike.RAY_STEADY,this.visible=!0):(this.visible=!1,tt<this.rayParameters.birthTime?this.state=_LightningStrike.RAY_UNBORN:this.state=_LightningStrike.RAY_EXTINGUISHED))}init(tt){this.rayParameters=tt,this.maxIterations=tt.maxIterations!==void 0?Math.floor(tt.maxIterations):9,tt.maxIterations=this.maxIterations,this.isStatic=tt.isStatic!==void 0?tt.isStatic:!1,tt.isStatic=this.isStatic,this.ramification=tt.ramification!==void 0?Math.floor(tt.ramification):5,tt.ramification=this.ramification,this.maxSubrayRecursion=tt.maxSubrayRecursion!==void 0?Math.floor(tt.maxSubrayRecursion):3,tt.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=tt.recursionProbability!==void 0?tt.recursionProbability:.6,tt.recursionProbability=this.recursionProbability,this.generateUVs=tt.generateUVs!==void 0?tt.generateUVs:!1,tt.generateUVs=this.generateUVs,tt.randomGenerator!==void 0?(this.randomGenerator=tt.randomGenerator,this.seedGenerator=tt.randomGenerator,tt.noiseSeed!==void 0&&this.seedGenerator.setSeed(tt.noiseSeed)):(this.randomGenerator=_LightningStrike.createRandomGenerator(),this.seedGenerator=Math),tt.onDecideSubrayCreation!==void 0?this.onDecideSubrayCreation=tt.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),tt.onSubrayCreation!==void 0&&(this.onSubrayCreation=tt.onSubrayCreation)),this.state=_LightningStrike.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),tt.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(let _e=0;_e<this.maxSubrays;_e++)this.subrays.push(this.createSubray());this.raySegments=[];for(let _e=0;_e<this.maxRaySegments;_e++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new SimplexNoise(this.seedGenerator),this.simplexY=new SimplexNoise(this.seedGenerator),this.simplexZ=new SimplexNoise(this.seedGenerator),this.forwards=new Vector3,this.forwardsFill=new Vector3,this.side=new Vector3,this.down=new Vector3,this.middlePos=new Vector3,this.middleLinPos=new Vector3,this.newPos=new Vector3,this.vPos=new Vector3,this.cross1=new Vector3}createMesh(){const tt=1<<this.maxIterations,_e=3*(tt+1)*this.maxSubrays,rt=18*tt*this.maxSubrays;this.vertices=new Float32Array(_e*3),this.indices=new Uint32Array(rt),this.generateUVs&&(this.uvs=new Float32Array(_e*2)),this.fillMesh(0),this.setIndex(new Uint32BufferAttribute(this.indices,1)),this.positionAttribute=new Float32BufferAttribute(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new Float32BufferAttribute(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=DynamicDrawUsage,this.positionAttribute.usage=DynamicDrawUsage,this.generateUVs&&(this.uvsAttribute.usage=DynamicDrawUsage)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)}updateMesh(tt){this.fillMesh(tt),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)}fillMesh(tt){const _e=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(tt,function(nt){const it=_e.currentSubray;tt<it.birthTime||(this.rayParameters.isEternal&&_e.currentSubray.recursion==0?(_e.createPrism(nt),_e.onDecideSubrayCreation(nt,_e)):tt<it.endPropagationTime?_e.timeFraction>=nt.fraction0*it.propagationTimeFactor&&(_e.createPrism(nt),_e.onDecideSubrayCreation(nt,_e)):tt<it.beginVanishingTime?(_e.createPrism(nt),_e.onDecideSubrayCreation(nt,_e)):(_e.timeFraction<=it.vanishingTimeFactor+nt.fraction1*(1-it.vanishingTimeFactor)&&_e.createPrism(nt),_e.onDecideSubrayCreation(nt,_e)))})}addNewSubray(){return this.subrays[this.numSubrays++]}initSubray(tt,_e){tt.pos0.copy(_e.sourceOffset),tt.pos1.copy(_e.destOffset),tt.up0.copy(_e.up0),tt.up1.copy(_e.up1),tt.radius0=_e.radius0,tt.radius1=_e.radius1,tt.birthTime=_e.birthTime,tt.deathTime=_e.deathTime,tt.timeScale=_e.timeScale,tt.roughness=_e.roughness,tt.straightness=_e.straightness,tt.propagationTimeFactor=_e.propagationTimeFactor,tt.vanishingTimeFactor=_e.vanishingTimeFactor,tt.maxIterations=this.maxIterations,tt.seed=_e.noiseSeed!==void 0?_e.noiseSeed:0,tt.recursion=0}fractalRay(tt,_e){this.time=tt,this.currentSegmentCallback=_e,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(let rt=0;rt<this.numSubrays;rt++){const nt=this.subrays[rt];this.currentSubray=nt,this.randomGenerator.setSeed(nt.seed),nt.endPropagationTime=MathUtils.lerp(nt.birthTime,nt.deathTime,nt.propagationTimeFactor),nt.beginVanishingTime=MathUtils.lerp(nt.deathTime,nt.birthTime,1-nt.vanishingTimeFactor);const it=this.randomGenerator.random;nt.linPos0.set(it(),it(),it()).multiplyScalar(1e3),nt.linPos1.set(it(),it(),it()).multiplyScalar(1e3),this.timeFraction=(tt-nt.birthTime)/(nt.deathTime-nt.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;const st=this.getNewSegment();st.iteration=0,st.pos0.copy(nt.pos0),st.pos1.copy(nt.pos1),st.linPos0.copy(nt.linPos0),st.linPos1.copy(nt.linPos1),st.up0.copy(nt.up0),st.up1.copy(nt.up1),st.radius0=nt.radius0,st.radius1=nt.radius1,st.fraction0=0,st.fraction1=1,st.positionVariationFactor=1-nt.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,nt.recursion)/(1<<nt.maxIterations),this.fractalRayRecursive(st)}this.currentSegmentCallback=null,this.currentSubray=null}fractalRayRecursive(tt){if(tt.iteration>=this.currentSubray.maxIterations){this.currentSegmentCallback(tt);return}this.forwards.subVectors(tt.pos1,tt.pos0);let _e=this.forwards.length();_e<1e-6&&(this.forwards.set(0,0,.01),_e=this.forwards.length());const rt=(tt.radius0+tt.radius1)*.5,nt=(tt.fraction0+tt.fraction1)*.5,it=this.time*this.currentSubray.timeScale*Math.pow(2,tt.iteration);this.middlePos.lerpVectors(tt.pos0,tt.pos1,.5),this.middleLinPos.lerpVectors(tt.linPos0,tt.linPos1,.5);const st=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(st.x,st.y,st.z,it),this.simplexY.noise4d(st.x,st.y,st.z,it),this.simplexZ.noise4d(st.x,st.y,st.z,it)),this.newPos.multiplyScalar(tt.positionVariationFactor*_e),this.newPos.add(this.middlePos);const ot=this.getNewSegment();ot.pos0.copy(tt.pos0),ot.pos1.copy(this.newPos),ot.linPos0.copy(tt.linPos0),ot.linPos1.copy(this.middleLinPos),ot.up0.copy(tt.up0),ot.up1.copy(tt.up1),ot.radius0=tt.radius0,ot.radius1=rt,ot.fraction0=tt.fraction0,ot.fraction1=nt,ot.positionVariationFactor=tt.positionVariationFactor*this.currentSubray.roughness,ot.iteration=tt.iteration+1;const lt=this.getNewSegment();lt.pos0.copy(this.newPos),lt.pos1.copy(tt.pos1),lt.linPos0.copy(this.middleLinPos),lt.linPos1.copy(tt.linPos1),this.cross1.crossVectors(tt.up0,this.forwards.normalize()),lt.up0.crossVectors(this.forwards,this.cross1).normalize(),lt.up1.copy(tt.up1),lt.radius0=rt,lt.radius1=tt.radius1,lt.fraction0=nt,lt.fraction1=tt.fraction1,lt.positionVariationFactor=tt.positionVariationFactor*this.currentSubray.roughness,lt.iteration=tt.iteration+1,this.fractalRayRecursive(ot),this.fractalRayRecursive(lt)}createPrism(tt){this.forwardsFill.subVectors(tt.pos1,tt.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(tt.pos0,tt.up0,this.forwardsFill,tt.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(tt.pos1,tt.up0,this.forwardsFill,tt.radius1,tt.fraction1),this.createPrismFaces()}createTriangleVerticesWithoutUVs(tt,_e,rt,nt){this.side.crossVectors(_e,rt).multiplyScalar(nt*_LightningStrike.COS30DEG),this.down.copy(_e).multiplyScalar(-nt*_LightningStrike.SIN30DEG);const it=this.vPos,st=this.vertices;it.copy(tt).sub(this.side).add(this.down),st[this.currentCoordinate++]=it.x,st[this.currentCoordinate++]=it.y,st[this.currentCoordinate++]=it.z,it.copy(tt).add(this.side).add(this.down),st[this.currentCoordinate++]=it.x,st[this.currentCoordinate++]=it.y,st[this.currentCoordinate++]=it.z,it.copy(_e).multiplyScalar(nt).add(tt),st[this.currentCoordinate++]=it.x,st[this.currentCoordinate++]=it.y,st[this.currentCoordinate++]=it.z,this.currentVertex+=3}createTriangleVerticesWithUVs(tt,_e,rt,nt,it){this.side.crossVectors(_e,rt).multiplyScalar(nt*_LightningStrike.COS30DEG),this.down.copy(_e).multiplyScalar(-nt*_LightningStrike.SIN30DEG);const st=this.vPos,ot=this.vertices,lt=this.uvs;st.copy(tt).sub(this.side).add(this.down),ot[this.currentCoordinate++]=st.x,ot[this.currentCoordinate++]=st.y,ot[this.currentCoordinate++]=st.z,lt[this.currentUVCoordinate++]=it,lt[this.currentUVCoordinate++]=0,st.copy(tt).add(this.side).add(this.down),ot[this.currentCoordinate++]=st.x,ot[this.currentCoordinate++]=st.y,ot[this.currentCoordinate++]=st.z,lt[this.currentUVCoordinate++]=it,lt[this.currentUVCoordinate++]=.5,st.copy(_e).multiplyScalar(nt).add(tt),ot[this.currentCoordinate++]=st.x,ot[this.currentCoordinate++]=st.y,ot[this.currentCoordinate++]=st.z,lt[this.currentUVCoordinate++]=it,lt[this.currentUVCoordinate++]=1,this.currentVertex+=3}createPrismFaces(tt){const _e=this.indices;tt=this.currentVertex-6,_e[this.currentIndex++]=tt+1,_e[this.currentIndex++]=tt+2,_e[this.currentIndex++]=tt+5,_e[this.currentIndex++]=tt+1,_e[this.currentIndex++]=tt+5,_e[this.currentIndex++]=tt+4,_e[this.currentIndex++]=tt+0,_e[this.currentIndex++]=tt+1,_e[this.currentIndex++]=tt+4,_e[this.currentIndex++]=tt+0,_e[this.currentIndex++]=tt+4,_e[this.currentIndex++]=tt+3,_e[this.currentIndex++]=tt+2,_e[this.currentIndex++]=tt+0,_e[this.currentIndex++]=tt+3,_e[this.currentIndex++]=tt+2,_e[this.currentIndex++]=tt+3,_e[this.currentIndex++]=tt+5}createDefaultSubrayCreationCallbacks(){const tt=this.randomGenerator.random;this.onDecideSubrayCreation=function(st,ot){const lt=ot.currentSubray,at=ot.rayParameters.subrayPeriod,ct=ot.rayParameters.subrayDutyCycle,ut=ot.rayParameters.isEternal&&lt.recursion==0?-tt()*at:MathUtils.lerp(lt.birthTime,lt.endPropagationTime,st.fraction0)-tt()*at,ht=ot.time-ut,dt=Math.floor(ht/at),ft=tt()*(dt+1),pt=ht%at<=ct*at;let mt=0;if(pt&&(mt=ot.subrayProbability),lt.recursion<ot.maxSubrayRecursion&&ot.numSubrays<ot.maxSubrays&&tt()<mt){const gt=ot.addNewSubray(),vt=ot.randomGenerator.getSeed();gt.seed=ft,ot.randomGenerator.setSeed(ft),gt.recursion=lt.recursion+1,gt.maxIterations=Math.max(1,lt.maxIterations-1),gt.linPos0.set(tt(),tt(),tt()).multiplyScalar(1e3),gt.linPos1.set(tt(),tt(),tt()).multiplyScalar(1e3),gt.up0.copy(lt.up0),gt.up1.copy(lt.up1),gt.radius0=st.radius0*ot.rayParameters.radius0Factor,gt.radius1=Math.min(ot.rayParameters.minRadius,st.radius1*ot.rayParameters.radius1Factor),gt.birthTime=ut+dt*at,gt.deathTime=gt.birthTime+at*ct,!ot.rayParameters.isEternal&&lt.recursion==0&&(gt.birthTime=Math.max(gt.birthTime,lt.birthTime),gt.deathTime=Math.min(gt.deathTime,lt.deathTime)),gt.timeScale=lt.timeScale*2,gt.roughness=lt.roughness,gt.straightness=lt.straightness,gt.propagationTimeFactor=lt.propagationTimeFactor,gt.vanishingTimeFactor=lt.vanishingTimeFactor,ot.onSubrayCreation(st,lt,gt,ot),ot.randomGenerator.setSeed(vt)}};const _e=new Vector3,rt=new Vector3,nt=new Vector3,it=new Vector3;this.onSubrayCreation=function(st,ot,lt,at){at.subrayCylinderPosition(st,ot,lt,.5,.6,.2)},this.subrayConePosition=function(st,ot,lt,at,ct,ut){lt.pos0.copy(st.pos0),_e.subVectors(ot.pos1,ot.pos0),rt.copy(_e).normalize(),_e.multiplyScalar(st.fraction0+(1-st.fraction0)*(tt()*at));const ht=_e.length();nt.crossVectors(ot.up0,rt);const dt=2*Math.PI*tt();nt.multiplyScalar(Math.cos(dt)),it.copy(ot.up0).multiplyScalar(Math.sin(dt)),lt.pos1.copy(nt).add(it).multiplyScalar(ht*ct*(ut+tt()*(1-ut))).add(_e).add(ot.pos0)},this.subrayCylinderPosition=function(st,ot,lt,at,ct,ut){lt.pos0.copy(st.pos0),_e.subVectors(ot.pos1,ot.pos0),rt.copy(_e).normalize(),_e.multiplyScalar(st.fraction0+(1-st.fraction0)*((2*tt()-1)*at));const ht=_e.length();nt.crossVectors(ot.up0,rt);const dt=2*Math.PI*tt();nt.multiplyScalar(Math.cos(dt)),it.copy(ot.up0).multiplyScalar(Math.sin(dt)),lt.pos1.copy(nt).add(it).multiplyScalar(ht*ct*(ut+tt()*(1-ut))).add(_e).add(ot.pos0)}}createSubray(){return{seed:0,maxIterations:0,recursion:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}createSegment(){return{iteration:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}getNewSegment(){return this.raySegments[this.currentSegmentIndex++]}copy(tt){return super.copy(tt),this.init(_LightningStrike.copyParameters({},tt.rayParameters)),this}clone(){return new this.constructor(_LightningStrike.copyParameters({},this.rayParameters))}};let LightningStrike=_LightningStrike;__publicField(LightningStrike,"RAY_INITIALIZED",0);__publicField(LightningStrike,"RAY_UNBORN",1);__publicField(LightningStrike,"RAY_PROPAGATING",2);__publicField(LightningStrike,"RAY_STEADY",3);__publicField(LightningStrike,"RAY_VANISHING",4);__publicField(LightningStrike,"RAY_EXTINGUISHED",5);__publicField(LightningStrike,"COS30DEG",Math.cos(30*Math.PI/180));__publicField(LightningStrike,"SIN30DEG",Math.sin(30*Math.PI/180));const _ReflectorForSSRPass=class extends Mesh{constructor(tt,_e={}){super(tt),this.isReflectorForSSRPass=!0,this.type="ReflectorForSSRPass";const rt=this,nt=_e.color!==void 0?new Color$1(_e.color):new Color$1(8355711),it=_e.textureWidth||512,st=_e.textureHeight||512,ot=_e.clipBias||0,lt=_e.shader||_ReflectorForSSRPass.ReflectorShader,at=_e.useDepthTexture===!0,ct=new Vector3(0,1,0),ut=new Vector3,ht=new Vector3;rt.needsUpdate=!1,rt.maxDistance=_ReflectorForSSRPass.ReflectorShader.uniforms.maxDistance.value,rt.opacity=_ReflectorForSSRPass.ReflectorShader.uniforms.opacity.value,rt.color=nt,rt.resolution=_e.resolution||new Vector2(window.innerWidth,window.innerHeight),rt._distanceAttenuation=_ReflectorForSSRPass.ReflectorShader.defines.DISTANCE_ATTENUATION,Object.defineProperty(rt,"distanceAttenuation",{get(){return rt._distanceAttenuation},set(Pt){rt._distanceAttenuation!==Pt&&(rt._distanceAttenuation=Pt,rt.material.defines.DISTANCE_ATTENUATION=Pt,rt.material.needsUpdate=!0)}}),rt._fresnel=_ReflectorForSSRPass.ReflectorShader.defines.FRESNEL,Object.defineProperty(rt,"fresnel",{get(){return rt._fresnel},set(Pt){rt._fresnel!==Pt&&(rt._fresnel=Pt,rt.material.defines.FRESNEL=Pt,rt.material.needsUpdate=!0)}});const dt=new Vector3,ft=new Vector3,pt=new Vector3,mt=new Matrix4,gt=new Vector3(0,0,-1),vt=new Vector3,At=new Vector3,yt=new Matrix4,xt=new PerspectiveCamera;let _t;at&&(_t=new DepthTexture,_t.type=UnsignedShortType,_t.minFilter=NearestFilter,_t.magFilter=NearestFilter);const Et={depthTexture:at?_t:null,type:HalfFloatType},bt=new WebGLRenderTarget(it,st,Et),wt=new ShaderMaterial({transparent:at,defines:Object.assign({},_ReflectorForSSRPass.ReflectorShader.defines,{useDepthTexture:at}),uniforms:UniformsUtils.clone(lt.uniforms),fragmentShader:lt.fragmentShader,vertexShader:lt.vertexShader});wt.uniforms.tDiffuse.value=bt.texture,wt.uniforms.color.value=rt.color,wt.uniforms.textureMatrix.value=yt,at&&(wt.uniforms.tDepth.value=bt.depthTexture),this.material=wt;const Mt=[new Plane(new Vector3(0,1,0),ot)];this.doRender=function(Pt,It,Ot){if(wt.uniforms.maxDistance.value=rt.maxDistance,wt.uniforms.color.value=rt.color,wt.uniforms.opacity.value=rt.opacity,ut.copy(Ot.position).normalize(),ht.copy(ut).reflect(ct),wt.uniforms.fresnelCoe.value=(ut.dot(ht)+1)/2,ft.setFromMatrixPosition(rt.matrixWorld),pt.setFromMatrixPosition(Ot.matrixWorld),mt.extractRotation(rt.matrixWorld),dt.set(0,0,1),dt.applyMatrix4(mt),vt.subVectors(ft,pt),vt.dot(dt)>0)return;vt.reflect(dt).negate(),vt.add(ft),mt.extractRotation(Ot.matrixWorld),gt.set(0,0,-1),gt.applyMatrix4(mt),gt.add(pt),At.subVectors(ft,gt),At.reflect(dt).negate(),At.add(ft),xt.position.copy(vt),xt.up.set(0,1,0),xt.up.applyMatrix4(mt),xt.up.reflect(dt),xt.lookAt(At),xt.far=Ot.far,xt.updateMatrixWorld(),xt.projectionMatrix.copy(Ot.projectionMatrix),wt.uniforms.virtualCameraNear.value=Ot.near,wt.uniforms.virtualCameraFar.value=Ot.far,wt.uniforms.virtualCameraMatrixWorld.value=xt.matrixWorld,wt.uniforms.virtualCameraProjectionMatrix.value=Ot.projectionMatrix,wt.uniforms.virtualCameraProjectionMatrixInverse.value=Ot.projectionMatrixInverse,wt.uniforms.resolution.value=rt.resolution,yt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),yt.multiply(xt.projectionMatrix),yt.multiply(xt.matrixWorldInverse),yt.multiply(rt.matrixWorld);const Bt=Pt.getRenderTarget(),Ut=Pt.xr.enabled,Ft=Pt.shadowMap.autoUpdate,jt=Pt.clippingPlanes;Pt.xr.enabled=!1,Pt.shadowMap.autoUpdate=!1,Pt.clippingPlanes=Mt,Pt.setRenderTarget(bt),Pt.state.buffers.depth.setMask(!0),Pt.autoClear===!1&&Pt.clear(),Pt.render(It,xt),Pt.xr.enabled=Ut,Pt.shadowMap.autoUpdate=Ft,Pt.clippingPlanes=jt,Pt.setRenderTarget(Bt);const Dt=Ot.viewport;Dt!==void 0&&Pt.state.viewport(Dt)},this.getRenderTarget=function(){return bt}}};let ReflectorForSSRPass=_ReflectorForSSRPass;__publicField(ReflectorForSSRPass,"ReflectorShader",{defines:{DISTANCE_ATTENUATION:!0,FRESNEL:!0},uniforms:{color:{value:null},tDiffuse:{value:null},tDepth:{value:null},textureMatrix:{value:new Matrix4},maxDistance:{value:180},opacity:{value:.5},fresnelCoe:{value:null},virtualCameraNear:{value:null},virtualCameraFar:{value:null},virtualCameraProjectionMatrix:{value:new Matrix4},virtualCameraMatrixWorld:{value:new Matrix4},virtualCameraProjectionMatrixInverse:{value:new Matrix4},resolution:{value:new Vector2}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		uniform sampler2D tDepth;
		uniform float maxDistance;
		uniform float opacity;
		uniform float fresnelCoe;
		uniform float virtualCameraNear;
		uniform float virtualCameraFar;
		uniform mat4 virtualCameraProjectionMatrix;
		uniform mat4 virtualCameraProjectionMatrixInverse;
		uniform mat4 virtualCameraMatrixWorld;
		uniform vec2 resolution;
		varying vec4 vUv;
		#include <packing>
		float blendOverlay( float base, float blend ) {
			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );
		}
		vec3 blendOverlay( vec3 base, vec3 blend ) {
			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );
		}
		float getDepth( const in vec2 uv ) {
			return texture2D( tDepth, uv ).x;
		}
		float getViewZ( const in float depth ) {
			return perspectiveDepthToViewZ( depth, virtualCameraNear, virtualCameraFar );
		}
		vec3 getViewPosition( const in vec2 uv, const in float depth/*clip space*/, const in float clipW ) {
			vec4 clipPosition = vec4( ( vec3( uv, depth ) - 0.5 ) * 2.0, 1.0 );//ndc
			clipPosition *= clipW; //clip
			return ( virtualCameraProjectionMatrixInverse * clipPosition ).xyz;//view
		}
		void main() {
			vec4 base = texture2DProj( tDiffuse, vUv );
			#ifdef useDepthTexture
				vec2 uv=(gl_FragCoord.xy-.5)/resolution.xy;
				uv.x=1.-uv.x;
				float depth = texture2DProj( tDepth, vUv ).r;
				float viewZ = getViewZ( depth );
				float clipW = virtualCameraProjectionMatrix[2][3] * viewZ+virtualCameraProjectionMatrix[3][3];
				vec3 viewPosition=getViewPosition( uv, depth, clipW );
				vec3 worldPosition=(virtualCameraMatrixWorld*vec4(viewPosition,1)).xyz;
				if(worldPosition.y>maxDistance) discard;
				float op=opacity;
				#ifdef DISTANCE_ATTENUATION
					float ratio=1.-(worldPosition.y/maxDistance);
					float attenuation=ratio*ratio;
					op=opacity*attenuation;
				#endif
				#ifdef FRESNEL
					op*=fresnelCoe;
				#endif
				gl_FragColor = vec4( blendOverlay( base.rgb, color ), op );
			#else
				gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );
			#endif
		}
	`});const SkyShader={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3},up:{value:new Vector3(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},material=new ShaderMaterial({name:"SkyShader",fragmentShader:SkyShader.fragmentShader,vertexShader:SkyShader.vertexShader,uniforms:UniformsUtils.clone(SkyShader.uniforms),side:BackSide,depthWrite:!1});let Sky$1=class extends Mesh{constructor(){super(new BoxGeometry(1,1,1),material)}};__publicField(Sky$1,"SkyShader",SkyShader);__publicField(Sky$1,"material",material);const _Water2=class extends Mesh{constructor(tt,_e={}){super(tt),this.isWater=!0,this.type="Water";const rt=this,nt=_e.color!==void 0?new Color$1(_e.color):new Color$1(16777215),it=_e.textureWidth||512,st=_e.textureHeight||512,ot=_e.clipBias||0,lt=_e.flowDirection||new Vector2(1,0),at=_e.flowSpeed||.03,ct=_e.reflectivity||.02,ut=_e.scale||1,ht=_e.shader||_Water2.WaterShader,dt=_e.encoding!==void 0?_e.encoding:3e3,ft=_e.flowMap||void 0,pt=_e.normalMap0,mt=_e.normalMap1,gt=.15,vt=gt*.5,At=new Matrix4,yt=new Clock;if(Reflector===void 0){console.error("THREE.Water: Required component Reflector not found.");return}if(Refractor===void 0){console.error("THREE.Water: Required component Refractor not found.");return}const xt=new Reflector(tt,{textureWidth:it,textureHeight:st,clipBias:ot,encoding:dt}),_t=new Refractor(tt,{textureWidth:it,textureHeight:st,clipBias:ot,encoding:dt});xt.matrixAutoUpdate=!1,_t.matrixAutoUpdate=!1,this.material=new ShaderMaterial({uniforms:UniformsUtils.merge([UniformsLib.fog,ht.uniforms]),vertexShader:ht.vertexShader,fragmentShader:ht.fragmentShader,transparent:!0,fog:!0}),ft!==void 0?(this.material.defines.USE_FLOWMAP="",this.material.uniforms.tFlowMap={type:"t",value:ft}):this.material.uniforms.flowDirection={type:"v2",value:lt},pt.wrapS=pt.wrapT=RepeatWrapping,mt.wrapS=mt.wrapT=RepeatWrapping,this.material.uniforms.tReflectionMap.value=xt.getRenderTarget().texture,this.material.uniforms.tRefractionMap.value=_t.getRenderTarget().texture,this.material.uniforms.tNormalMap0.value=pt,this.material.uniforms.tNormalMap1.value=mt,this.material.uniforms.color.value=nt,this.material.uniforms.reflectivity.value=ct,this.material.uniforms.textureMatrix.value=At,this.material.uniforms.config.value.x=0,this.material.uniforms.config.value.y=vt,this.material.uniforms.config.value.z=vt,this.material.uniforms.config.value.w=ut;function Et(wt){At.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),At.multiply(wt.projectionMatrix),At.multiply(wt.matrixWorldInverse),At.multiply(rt.matrixWorld)}function bt(){const wt=yt.getDelta(),Tt=rt.material.uniforms.config;Tt.value.x+=at*wt,Tt.value.y=Tt.value.x+vt,Tt.value.x>=gt?(Tt.value.x=0,Tt.value.y=vt):Tt.value.y>=gt&&(Tt.value.y=Tt.value.y-gt)}this.onBeforeRender=function(wt,Tt,Mt){Et(Mt),bt(),rt.visible=!1,xt.matrixWorld.copy(rt.matrixWorld),_t.matrixWorld.copy(rt.matrixWorld),xt.onBeforeRender(wt,Tt,Mt),_t.onBeforeRender(wt,Tt,Mt),rt.visible=!0}}};let Water2=_Water2;__publicField(Water2,"WaterShader",{uniforms:{color:{value:null},reflectivity:{value:0},tReflectionMap:{value:null},tRefractionMap:{value:null},tNormalMap0:{value:null},tNormalMap1:{value:null},textureMatrix:{value:null},config:{value:new Vector4}},vertexShader:`

		#include <common>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>

		uniform mat4 textureMatrix;

		varying vec4 vCoord;
		varying vec2 vUv;
		varying vec3 vToEye;

		void main() {

			vUv = uv;
			vCoord = textureMatrix * vec4( position, 1.0 );

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vToEye = cameraPosition - worldPosition.xyz;

			vec4 mvPosition =  viewMatrix * worldPosition; // used in fog_vertex
			gl_Position = projectionMatrix * mvPosition;

			#include <logdepthbuf_vertex>
			#include <fog_vertex>

		}`,fragmentShader:`

		#include <common>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>

		uniform sampler2D tReflectionMap;
		uniform sampler2D tRefractionMap;
		uniform sampler2D tNormalMap0;
		uniform sampler2D tNormalMap1;

		#ifdef USE_FLOWMAP
			uniform sampler2D tFlowMap;
		#else
			uniform vec2 flowDirection;
		#endif

		uniform vec3 color;
		uniform float reflectivity;
		uniform vec4 config;

		varying vec4 vCoord;
		varying vec2 vUv;
		varying vec3 vToEye;

		void main() {

			#include <logdepthbuf_fragment>

			float flowMapOffset0 = config.x;
			float flowMapOffset1 = config.y;
			float halfCycle = config.z;
			float scale = config.w;

			vec3 toEye = normalize( vToEye );

			// determine flow direction
			vec2 flow;
			#ifdef USE_FLOWMAP
				flow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;
			#else
				flow = flowDirection;
			#endif
			flow.x *= - 1.0;

			// sample normal maps (distort uvs with flowdata)
			vec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );
			vec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );

			// linear interpolate to get the final normal color
			float flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;
			vec4 normalColor = mix( normalColor0, normalColor1, flowLerp );

			// calculate normal vector
			vec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );

			// calculate the fresnel term to blend reflection and refraction maps
			float theta = max( dot( toEye, normal ), 0.0 );
			float reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );

			// calculate final uv coords
			vec3 coord = vCoord.xyz / vCoord.w;
			vec2 uv = coord.xy + coord.z * normal.xz * 0.05;

			vec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );
			vec4 refractColor = texture2D( tRefractionMap, uv );

			// multiply water color with the mix of both textures
			gl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );

			#include <tonemapping_fragment>
			#include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
			#include <fog_fragment>

		}`});const isCubeTexture=tt=>tt&&tt.isCubeTexture;class GroundProjectedEnv extends Mesh{constructor(_e,rt){var nt,it;const st=isCubeTexture(_e),lt=((it=st?(nt=_e.image[0])==null?void 0:nt.width:_e.image.width)!=null?it:1024)/4,at=Math.floor(Math.log2(lt)),ct=Math.pow(2,at),ut=3*Math.max(ct,16*7),ht=4*ct,dt=[st?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/ut}`,`#define CUBEUV_TEXEL_HEIGHT ${1/ht}`,`#define CUBEUV_MAX_MIP ${at}.0`],ft=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,pt=dt.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,mt={map:{value:_e},height:{value:(rt==null?void 0:rt.height)||15},radius:{value:(rt==null?void 0:rt.radius)||100}},gt=new IcosahedronGeometry(1,16),vt=new ShaderMaterial({uniforms:mt,fragmentShader:pt,vertexShader:ft,side:DoubleSide});super(gt,vt)}set radius(_e){this.material.uniforms.radius.value=_e}get radius(){return this.material.uniforms.radius.value}set height(_e){this.material.uniforms.height.value=_e}get height(){return this.material.uniforms.height.value}}const UnpackDepthRGBAShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","	float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","	gl_FragColor = vec4( vec3( depth ), opacity );","}"].join(`
`)},moduloWrapAround=(tt,_e)=>(tt%_e+_e)%_e;let OrbitControls$1=class extends EventDispatcher{constructor(_e,rt){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"target",new Vector3),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"minZoom",0),__publicField(this,"maxZoom",1/0),__publicField(this,"minPolarAngle",0),__publicField(this,"maxPolarAngle",Math.PI),__publicField(this,"minAzimuthAngle",-1/0),__publicField(this,"maxAzimuthAngle",1/0),__publicField(this,"enableDamping",!1),__publicField(this,"dampingFactor",.05),__publicField(this,"enableZoom",!0),__publicField(this,"zoomSpeed",1),__publicField(this,"enableRotate",!0),__publicField(this,"rotateSpeed",1),__publicField(this,"enablePan",!0),__publicField(this,"panSpeed",1),__publicField(this,"screenSpacePanning",!0),__publicField(this,"keyPanSpeed",7),__publicField(this,"autoRotate",!1),__publicField(this,"autoRotateSpeed",2),__publicField(this,"reverseOrbit",!1),__publicField(this,"reverseHorizontalOrbit",!1),__publicField(this,"reverseVerticalOrbit",!1),__publicField(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"zoom0"),__publicField(this,"_domElementKeyEvents",null),__publicField(this,"getPolarAngle"),__publicField(this,"getAzimuthalAngle"),__publicField(this,"setPolarAngle"),__publicField(this,"setAzimuthalAngle"),__publicField(this,"getDistance"),__publicField(this,"listenToKeyEvents"),__publicField(this,"stopListenToKeyEvents"),__publicField(this,"saveState"),__publicField(this,"reset"),__publicField(this,"update"),__publicField(this,"connect"),__publicField(this,"dispose"),this.object=_e,this.domElement=rt,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>ut.phi,this.getAzimuthalAngle=()=>ut.theta,this.setPolarAngle=qt=>{let pr=moduloWrapAround(qt,2*Math.PI),mr=ut.phi;mr<0&&(mr+=2*Math.PI),pr<0&&(pr+=2*Math.PI);let nr=Math.abs(pr-mr);2*Math.PI-nr<nr&&(pr<mr?pr+=2*Math.PI:mr+=2*Math.PI),ht.phi=pr-mr,nt.update()},this.setAzimuthalAngle=qt=>{let pr=moduloWrapAround(qt,2*Math.PI),mr=ut.theta;mr<0&&(mr+=2*Math.PI),pr<0&&(pr+=2*Math.PI);let nr=Math.abs(pr-mr);2*Math.PI-nr<nr&&(pr<mr?pr+=2*Math.PI:mr+=2*Math.PI),ht.theta=pr-mr,nt.update()},this.getDistance=()=>nt.object.position.distanceTo(nt.target),this.listenToKeyEvents=qt=>{qt.addEventListener("keydown",Qt),this._domElementKeyEvents=qt},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Qt),this._domElementKeyEvents=null},this.saveState=()=>{nt.target0.copy(nt.target),nt.position0.copy(nt.object.position),nt.zoom0=nt.object.zoom},this.reset=()=>{nt.target.copy(nt.target0),nt.object.position.copy(nt.position0),nt.object.zoom=nt.zoom0,nt.object.updateProjectionMatrix(),nt.dispatchEvent(it),nt.update(),at=lt.NONE},this.update=(()=>{const qt=new Vector3,pr=new Vector3(0,1,0),mr=new Quaternion().setFromUnitVectors(_e.up,pr),nr=mr.clone().invert(),Cr=new Vector3,cr=new Quaternion,Jr=2*Math.PI;return function(){const Rr=nt.object.position;mr.setFromUnitVectors(_e.up,pr),nr.copy(mr).invert(),qt.copy(Rr).sub(nt.target),qt.applyQuaternion(mr),ut.setFromVector3(qt),nt.autoRotate&&at===lt.NONE&&It(Mt()),nt.enableDamping?(ut.theta+=ht.theta*nt.dampingFactor,ut.phi+=ht.phi*nt.dampingFactor):(ut.theta+=ht.theta,ut.phi+=ht.phi);let br=nt.minAzimuthAngle,jr=nt.maxAzimuthAngle;return isFinite(br)&&isFinite(jr)&&(br<-Math.PI?br+=Jr:br>Math.PI&&(br-=Jr),jr<-Math.PI?jr+=Jr:jr>Math.PI&&(jr-=Jr),br<=jr?ut.theta=Math.max(br,Math.min(jr,ut.theta)):ut.theta=ut.theta>(br+jr)/2?Math.max(br,ut.theta):Math.min(jr,ut.theta)),ut.phi=Math.max(nt.minPolarAngle,Math.min(nt.maxPolarAngle,ut.phi)),ut.makeSafe(),ut.radius*=dt,ut.radius=Math.max(nt.minDistance,Math.min(nt.maxDistance,ut.radius)),nt.enableDamping===!0?nt.target.addScaledVector(ft,nt.dampingFactor):nt.target.add(ft),qt.setFromSpherical(ut),qt.applyQuaternion(nr),Rr.copy(nt.target).add(qt),nt.object.lookAt(nt.target),nt.enableDamping===!0?(ht.theta*=1-nt.dampingFactor,ht.phi*=1-nt.dampingFactor,ft.multiplyScalar(1-nt.dampingFactor)):(ht.set(0,0,0),ft.set(0,0,0)),dt=1,pt||Cr.distanceToSquared(nt.object.position)>ct||8*(1-cr.dot(nt.object.quaternion))>ct?(nt.dispatchEvent(it),Cr.copy(nt.object.position),cr.copy(nt.object.quaternion),pt=!1,!0):!1}})(),this.connect=qt=>{qt===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),nt.domElement=qt,nt.domElement.style.touchAction="none",nt.domElement.addEventListener("contextmenu",yr),nt.domElement.addEventListener("pointerdown",Qr),nt.domElement.addEventListener("pointercancel",Ur),nt.domElement.addEventListener("wheel",Xt)},this.dispose=()=>{var qt,pr,mr,nr,Cr,cr;(qt=nt.domElement)==null||qt.removeEventListener("contextmenu",yr),(pr=nt.domElement)==null||pr.removeEventListener("pointerdown",Qr),(mr=nt.domElement)==null||mr.removeEventListener("pointercancel",Ur),(nr=nt.domElement)==null||nr.removeEventListener("wheel",Xt),(Cr=nt.domElement)==null||Cr.ownerDocument.removeEventListener("pointermove",Ir),(cr=nt.domElement)==null||cr.ownerDocument.removeEventListener("pointerup",Dr),nt._domElementKeyEvents!==null&&nt._domElementKeyEvents.removeEventListener("keydown",Qt)};const nt=this,it={type:"change"},st={type:"start"},ot={type:"end"},lt={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let at=lt.NONE;const ct=1e-6,ut=new Spherical,ht=new Spherical;let dt=1;const ft=new Vector3;let pt=!1;const mt=new Vector2,gt=new Vector2,vt=new Vector2,At=new Vector2,yt=new Vector2,xt=new Vector2,_t=new Vector2,Et=new Vector2,bt=new Vector2,wt=[],Tt={};function Mt(){return 2*Math.PI/60/60*nt.autoRotateSpeed}function Pt(){return Math.pow(.95,nt.zoomSpeed)}function It(qt){nt.reverseOrbit||nt.reverseHorizontalOrbit?ht.theta+=qt:ht.theta-=qt}function Ot(qt){nt.reverseOrbit||nt.reverseVerticalOrbit?ht.phi+=qt:ht.phi-=qt}const Bt=(()=>{const qt=new Vector3;return function(mr,nr){qt.setFromMatrixColumn(nr,0),qt.multiplyScalar(-mr),ft.add(qt)}})(),Ut=(()=>{const qt=new Vector3;return function(mr,nr){nt.screenSpacePanning===!0?qt.setFromMatrixColumn(nr,1):(qt.setFromMatrixColumn(nr,0),qt.crossVectors(nt.object.up,qt)),qt.multiplyScalar(mr),ft.add(qt)}})(),Ft=(()=>{const qt=new Vector3;return function(mr,nr){const Cr=nt.domElement;if(Cr&&nt.object instanceof PerspectiveCamera&&nt.object.isPerspectiveCamera){const cr=nt.object.position;qt.copy(cr).sub(nt.target);let Jr=qt.length();Jr*=Math.tan(nt.object.fov/2*Math.PI/180),Bt(2*mr*Jr/Cr.clientHeight,nt.object.matrix),Ut(2*nr*Jr/Cr.clientHeight,nt.object.matrix)}else Cr&&nt.object instanceof OrthographicCamera&&nt.object.isOrthographicCamera?(Bt(mr*(nt.object.right-nt.object.left)/nt.object.zoom/Cr.clientWidth,nt.object.matrix),Ut(nr*(nt.object.top-nt.object.bottom)/nt.object.zoom/Cr.clientHeight,nt.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),nt.enablePan=!1)}})();function jt(qt){nt.object instanceof PerspectiveCamera&&nt.object.isPerspectiveCamera?dt/=qt:nt.object instanceof OrthographicCamera&&nt.object.isOrthographicCamera?(nt.object.zoom=Math.max(nt.minZoom,Math.min(nt.maxZoom,nt.object.zoom*qt)),nt.object.updateProjectionMatrix(),pt=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),nt.enableZoom=!1)}function Dt(qt){nt.object instanceof PerspectiveCamera&&nt.object.isPerspectiveCamera?dt*=qt:nt.object instanceof OrthographicCamera&&nt.object.isOrthographicCamera?(nt.object.zoom=Math.max(nt.minZoom,Math.min(nt.maxZoom,nt.object.zoom/qt)),nt.object.updateProjectionMatrix(),pt=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),nt.enableZoom=!1)}function Gt(qt){mt.set(qt.clientX,qt.clientY)}function zt(qt){_t.set(qt.clientX,qt.clientY)}function $t(qt){At.set(qt.clientX,qt.clientY)}function Ht(qt){gt.set(qt.clientX,qt.clientY),vt.subVectors(gt,mt).multiplyScalar(nt.rotateSpeed);const pr=nt.domElement;pr&&(It(2*Math.PI*vt.x/pr.clientHeight),Ot(2*Math.PI*vt.y/pr.clientHeight)),mt.copy(gt),nt.update()}function er(qt){Et.set(qt.clientX,qt.clientY),bt.subVectors(Et,_t),bt.y>0?jt(Pt()):bt.y<0&&Dt(Pt()),_t.copy(Et),nt.update()}function Zt(qt){yt.set(qt.clientX,qt.clientY),xt.subVectors(yt,At).multiplyScalar(nt.panSpeed),Ft(xt.x,xt.y),At.copy(yt),nt.update()}function or(qt){qt.deltaY<0?Dt(Pt()):qt.deltaY>0&&jt(Pt()),nt.update()}function Kt(qt){let pr=!1;switch(qt.code){case nt.keys.UP:Ft(0,nt.keyPanSpeed),pr=!0;break;case nt.keys.BOTTOM:Ft(0,-nt.keyPanSpeed),pr=!0;break;case nt.keys.LEFT:Ft(nt.keyPanSpeed,0),pr=!0;break;case nt.keys.RIGHT:Ft(-nt.keyPanSpeed,0),pr=!0;break}pr&&(qt.preventDefault(),nt.update())}function rr(){if(wt.length==1)mt.set(wt[0].pageX,wt[0].pageY);else{const qt=.5*(wt[0].pageX+wt[1].pageX),pr=.5*(wt[0].pageY+wt[1].pageY);mt.set(qt,pr)}}function ur(){if(wt.length==1)At.set(wt[0].pageX,wt[0].pageY);else{const qt=.5*(wt[0].pageX+wt[1].pageX),pr=.5*(wt[0].pageY+wt[1].pageY);At.set(qt,pr)}}function fr(){const qt=wt[0].pageX-wt[1].pageX,pr=wt[0].pageY-wt[1].pageY,mr=Math.sqrt(qt*qt+pr*pr);_t.set(0,mr)}function dr(){nt.enableZoom&&fr(),nt.enablePan&&ur()}function gr(){nt.enableZoom&&fr(),nt.enableRotate&&rr()}function Yt(qt){if(wt.length==1)gt.set(qt.pageX,qt.pageY);else{const mr=Ar(qt),nr=.5*(qt.pageX+mr.x),Cr=.5*(qt.pageY+mr.y);gt.set(nr,Cr)}vt.subVectors(gt,mt).multiplyScalar(nt.rotateSpeed);const pr=nt.domElement;pr&&(It(2*Math.PI*vt.x/pr.clientHeight),Ot(2*Math.PI*vt.y/pr.clientHeight)),mt.copy(gt)}function xr(qt){if(wt.length==1)yt.set(qt.pageX,qt.pageY);else{const pr=Ar(qt),mr=.5*(qt.pageX+pr.x),nr=.5*(qt.pageY+pr.y);yt.set(mr,nr)}xt.subVectors(yt,At).multiplyScalar(nt.panSpeed),Ft(xt.x,xt.y),At.copy(yt)}function vr(qt){const pr=Ar(qt),mr=qt.pageX-pr.x,nr=qt.pageY-pr.y,Cr=Math.sqrt(mr*mr+nr*nr);Et.set(0,Cr),bt.set(0,Math.pow(Et.y/_t.y,nt.zoomSpeed)),jt(bt.y),_t.copy(Et)}function Pr(qt){nt.enableZoom&&vr(qt),nt.enablePan&&xr(qt)}function Sr(qt){nt.enableZoom&&vr(qt),nt.enableRotate&&Yt(qt)}function Qr(qt){var pr,mr;nt.enabled!==!1&&(wt.length===0&&((pr=nt.domElement)==null||pr.ownerDocument.addEventListener("pointermove",Ir),(mr=nt.domElement)==null||mr.ownerDocument.addEventListener("pointerup",Dr)),_r(qt),qt.pointerType==="touch"?hr(qt):Lr(qt))}function Ir(qt){nt.enabled!==!1&&(qt.pointerType==="touch"?kr(qt):Wr(qt))}function Dr(qt){var pr,mr,nr;Hr(qt),wt.length===0&&((pr=nt.domElement)==null||pr.releasePointerCapture(qt.pointerId),(mr=nt.domElement)==null||mr.ownerDocument.removeEventListener("pointermove",Ir),(nr=nt.domElement)==null||nr.ownerDocument.removeEventListener("pointerup",Dr)),nt.dispatchEvent(ot),at=lt.NONE}function Ur(qt){Hr(qt)}function Lr(qt){let pr;switch(qt.button){case 0:pr=nt.mouseButtons.LEFT;break;case 1:pr=nt.mouseButtons.MIDDLE;break;case 2:pr=nt.mouseButtons.RIGHT;break;default:pr=-1}switch(pr){case MOUSE.DOLLY:if(nt.enableZoom===!1)return;zt(qt),at=lt.DOLLY;break;case MOUSE.ROTATE:if(qt.ctrlKey||qt.metaKey||qt.shiftKey){if(nt.enablePan===!1)return;$t(qt),at=lt.PAN}else{if(nt.enableRotate===!1)return;Gt(qt),at=lt.ROTATE}break;case MOUSE.PAN:if(qt.ctrlKey||qt.metaKey||qt.shiftKey){if(nt.enableRotate===!1)return;Gt(qt),at=lt.ROTATE}else{if(nt.enablePan===!1)return;$t(qt),at=lt.PAN}break;default:at=lt.NONE}at!==lt.NONE&&nt.dispatchEvent(st)}function Wr(qt){if(nt.enabled!==!1)switch(at){case lt.ROTATE:if(nt.enableRotate===!1)return;Ht(qt);break;case lt.DOLLY:if(nt.enableZoom===!1)return;er(qt);break;case lt.PAN:if(nt.enablePan===!1)return;Zt(qt);break}}function Xt(qt){nt.enabled===!1||nt.enableZoom===!1||at!==lt.NONE&&at!==lt.ROTATE||(qt.preventDefault(),nt.dispatchEvent(st),or(qt),nt.dispatchEvent(ot))}function Qt(qt){nt.enabled===!1||nt.enablePan===!1||Kt(qt)}function hr(qt){switch(Er(qt),wt.length){case 1:switch(nt.touches.ONE){case TOUCH.ROTATE:if(nt.enableRotate===!1)return;rr(),at=lt.TOUCH_ROTATE;break;case TOUCH.PAN:if(nt.enablePan===!1)return;ur(),at=lt.TOUCH_PAN;break;default:at=lt.NONE}break;case 2:switch(nt.touches.TWO){case TOUCH.DOLLY_PAN:if(nt.enableZoom===!1&&nt.enablePan===!1)return;dr(),at=lt.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(nt.enableZoom===!1&&nt.enableRotate===!1)return;gr(),at=lt.TOUCH_DOLLY_ROTATE;break;default:at=lt.NONE}break;default:at=lt.NONE}at!==lt.NONE&&nt.dispatchEvent(st)}function kr(qt){switch(Er(qt),at){case lt.TOUCH_ROTATE:if(nt.enableRotate===!1)return;Yt(qt),nt.update();break;case lt.TOUCH_PAN:if(nt.enablePan===!1)return;xr(qt),nt.update();break;case lt.TOUCH_DOLLY_PAN:if(nt.enableZoom===!1&&nt.enablePan===!1)return;Pr(qt),nt.update();break;case lt.TOUCH_DOLLY_ROTATE:if(nt.enableZoom===!1&&nt.enableRotate===!1)return;Sr(qt),nt.update();break;default:at=lt.NONE}}function yr(qt){nt.enabled!==!1&&qt.preventDefault()}function _r(qt){wt.push(qt)}function Hr(qt){delete Tt[qt.pointerId];for(let pr=0;pr<wt.length;pr++)if(wt[pr].pointerId==qt.pointerId){wt.splice(pr,1);return}}function Er(qt){let pr=Tt[qt.pointerId];pr===void 0&&(pr=new Vector2,Tt[qt.pointerId]=pr),pr.set(qt.pageX,qt.pageY)}function Ar(qt){const pr=qt.pointerId===wt[0].pointerId?wt[1]:wt[0];return Tt[pr.pointerId]}rt!==void 0&&this.connect(rt),this.update()}};class Pass{constructor(){__publicField(this,"enabled",!0),__publicField(this,"needsSwap",!0),__publicField(this,"clear",!1),__publicField(this,"renderToScreen",!1)}setSize(_e,rt){}render(_e,rt,nt,it,st){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}class FullScreenQuad{constructor(_e){__publicField(this,"camera",new OrthographicCamera(-1,1,1,-1,0,1)),__publicField(this,"geometry",new PlaneGeometry(2,2)),__publicField(this,"mesh"),this.mesh=new Mesh(this.geometry,_e)}get material(){return this.mesh.material}set material(_e){this.mesh.material=_e}dispose(){this.mesh.geometry.dispose()}render(_e){_e.render(this.mesh,this.camera)}}const CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","	vec4 texel = texture2D( tDiffuse, vUv );","	gl_FragColor = opacity * texel;","}"].join(`
`)},SSAOShader={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new Vector2},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","	return texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","	#if PERSPECTIVE_CAMERA == 1","		float fragCoordZ = texture2D( tDepth, screenPosition ).x;","		float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","		return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","	#else","		return texture2D( tDepth, screenPosition ).x;","	#endif","}","float getViewZ( const in float depth ) {","	#if PERSPECTIVE_CAMERA == 1","		return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","	#else","		return orthographicDepthToViewZ( depth, cameraNear, cameraFar );","	#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","	float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","	vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","	clipPosition *= clipW; // unprojection.","	return ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","	return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","	float depth = getDepth( vUv );","	float viewZ = getViewZ( depth );","	vec3 viewPosition = getViewPosition( vUv, depth, viewZ );","	vec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","	vec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","	vec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","	vec3 bitangent = cross( viewNormal, tangent );","	mat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","		vec3 sampleVector = kernelMatrix * kernel[ i ];","		vec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","		vec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","		samplePointNDC /= samplePointNDC.w;","		vec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","		float realDepth = getLinearDepth( samplePointUv );","		float sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","		float delta = sampleDepth - realDepth;","		if ( delta > minDistance && delta < maxDistance ) {","			occlusion += 1.0;","		}","	}","	occlusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","	gl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join(`
`)},SSAODepthShader={defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","	#if PERSPECTIVE_CAMERA == 1","		float fragCoordZ = texture2D( tDepth, screenPosition ).x;","		float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","		return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","	#else","		return texture2D( tDepth, screenPosition ).x;","	#endif","}","void main() {","	float depth = getLinearDepth( vUv );","	gl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join(`
`)},SSAOBlurShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","	vec2 texelSize = ( 1.0 / resolution );","	float result = 0.0;","	for ( int i = - 2; i <= 2; i ++ ) {","		for ( int j = - 2; j <= 2; j ++ ) {","			vec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","			result += texture2D( tDiffuse, vUv + offset ).r;","		}","	}","	gl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join(`
`)},_SSAOPass=class extends Pass{constructor(tt,_e,rt,nt){super(),this.width=rt!==void 0?rt:512,this.height=nt!==void 0?nt:512,this.clear=!0,this.camera=_e,this.scene=tt,this.kernelRadius=8,this.kernelSize=32,this.kernel=[],this.noiseTexture=null,this.output=0,this.minDistance=.005,this.maxDistance=.1,this._visibilityCache=new Map,this.generateSampleKernel(),this.generateRandomKernelRotations();const it=new DepthTexture;it.format=DepthStencilFormat,it.type=UnsignedInt248Type,this.beautyRenderTarget=new WebGLRenderTarget(this.width,this.height),this.normalRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,depthTexture:it}),this.ssaoRenderTarget=new WebGLRenderTarget(this.width,this.height),this.blurRenderTarget=this.ssaoRenderTarget.clone(),SSAOShader===void 0&&console.error("THREE.SSAOPass: The pass relies on SSAOShader."),this.ssaoMaterial=new ShaderMaterial({defines:Object.assign({},SSAOShader.defines),uniforms:UniformsUtils.clone(SSAOShader.uniforms),vertexShader:SSAOShader.vertexShader,fragmentShader:SSAOShader.fragmentShader,blending:NoBlending}),this.ssaoMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssaoMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.ssaoMaterial.uniforms.tNoise.value=this.noiseTexture,this.ssaoMaterial.uniforms.kernel.value=this.kernel,this.ssaoMaterial.uniforms.cameraNear.value=this.camera.near,this.ssaoMaterial.uniforms.cameraFar.value=this.camera.far,this.ssaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,this.blurMaterial=new ShaderMaterial({defines:Object.assign({},SSAOBlurShader.defines),uniforms:UniformsUtils.clone(SSAOBlurShader.uniforms),vertexShader:SSAOBlurShader.vertexShader,fragmentShader:SSAOBlurShader.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new ShaderMaterial({defines:Object.assign({},SSAODepthShader.defines),uniforms:UniformsUtils.clone(SSAODepthShader.uniforms),vertexShader:SSAODepthShader.vertexShader,fragmentShader:SSAODepthShader.fragmentShader,blending:NoBlending}),this.depthRenderMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:DstColorFactor,blendDst:ZeroFactor,blendEquation:AddEquation,blendSrcAlpha:DstAlphaFactor,blendDstAlpha:ZeroFactor,blendEquationAlpha:AddEquation}),this.fsQuad=new FullScreenQuad(null),this.originalClearColor=new Color$1}dispose(){this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(tt,_e){switch(tt.capabilities.isWebGL2===!1&&(this.noiseTexture.format=LuminanceFormat),tt.setRenderTarget(this.beautyRenderTarget),tt.clear(),tt.render(this.scene,this.camera),this.overrideVisibility(),this.renderOverride(tt,this.normalMaterial,this.normalRenderTarget,7829503,1),this.restoreVisibility(),this.ssaoMaterial.uniforms.kernelRadius.value=this.kernelRadius,this.ssaoMaterial.uniforms.minDistance.value=this.minDistance,this.ssaoMaterial.uniforms.maxDistance.value=this.maxDistance,this.renderPass(tt,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(tt,this.blurMaterial,this.blurRenderTarget),this.output){case _SSAOPass.OUTPUT.SSAO:this.copyMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Blur:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Depth:this.renderPass(tt,this.depthRenderMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=CustomBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;default:console.warn("THREE.SSAOPass: Unknown output type.")}}renderPass(tt,_e,rt,nt,it){tt.getClearColor(this.originalClearColor);const st=tt.getClearAlpha(),ot=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,nt!=null&&(tt.setClearColor(nt),tt.setClearAlpha(it||0),tt.clear()),this.fsQuad.material=_e,this.fsQuad.render(tt),tt.autoClear=ot,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}renderOverride(tt,_e,rt,nt,it){tt.getClearColor(this.originalClearColor);const st=tt.getClearAlpha(),ot=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,nt=_e.clearColor||nt,it=_e.clearAlpha||it,nt!=null&&(tt.setClearColor(nt),tt.setClearAlpha(it||0),tt.clear()),this.scene.overrideMaterial=_e,tt.render(this.scene,this.camera),this.scene.overrideMaterial=null,tt.autoClear=ot,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}setSize(tt,_e){this.width=tt,this.height=_e,this.beautyRenderTarget.setSize(tt,_e),this.ssaoRenderTarget.setSize(tt,_e),this.normalRenderTarget.setSize(tt,_e),this.blurRenderTarget.setSize(tt,_e),this.ssaoMaterial.uniforms.resolution.value.set(tt,_e),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(tt,_e)}generateSampleKernel(){const tt=this.kernelSize,_e=this.kernel;for(let rt=0;rt<tt;rt++){const nt=new Vector3;nt.x=Math.random()*2-1,nt.y=Math.random()*2-1,nt.z=Math.random(),nt.normalize();let it=rt/tt;it=MathUtils.lerp(.1,1,it*it),nt.multiplyScalar(it),_e.push(nt)}}generateRandomKernelRotations(){SimplexNoise===void 0&&console.error("THREE.SSAOPass: The pass relies on SimplexNoise.");const rt=new SimplexNoise,nt=4*4,it=new Float32Array(nt);for(let st=0;st<nt;st++){const ot=Math.random()*2-1,lt=Math.random()*2-1,at=0;it[st]=rt.noise3d(ot,lt,at)}this.noiseTexture=new DataTexture(it,4,4,RedFormat,FloatType),this.noiseTexture.wrapS=RepeatWrapping,this.noiseTexture.wrapT=RepeatWrapping,this.noiseTexture.needsUpdate=!0}overrideVisibility(){const tt=this.scene,_e=this._visibilityCache;tt.traverse(function(rt){_e.set(rt,rt.visible),(rt.isPoints||rt.isLine)&&(rt.visible=!1)})}restoreVisibility(){const tt=this.scene,_e=this._visibilityCache;tt.traverse(function(rt){const nt=_e.get(rt);rt.visible=nt}),_e.clear()}};let SSAOPass=_SSAOPass;__publicField(SSAOPass,"OUTPUT",{Default:0,SSAO:1,Blur:2,Beauty:3,Depth:4,Normal:5});const LuminosityHighPassShader={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Color$1(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","	vec4 texel = texture2D( tDiffuse, vUv );","	vec3 luma = vec3( 0.299, 0.587, 0.114 );","	float v = dot( texel.xyz, luma );","	vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","	float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","	gl_FragColor = mix( outputColor, texel, alpha );","}"].join(`
`)},_UnrealBloomPass=class extends Pass{constructor(tt,_e,rt,nt){super(),this.strength=_e!==void 0?_e:1,this.radius=rt,this.threshold=nt,this.resolution=tt!==void 0?new Vector2(tt.x,tt.y):new Vector2(256,256),this.clearColor=new Color$1(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let it=Math.round(this.resolution.x/2),st=Math.round(this.resolution.y/2);this.renderTargetBright=new WebGLRenderTarget(it,st,{type:HalfFloatType}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let ut=0;ut<this.nMips;ut++){const ht=new WebGLRenderTarget(it,st,{type:HalfFloatType});ht.texture.name="UnrealBloomPass.h"+ut,ht.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(ht);const dt=new WebGLRenderTarget(it,st,{type:HalfFloatType});dt.texture.name="UnrealBloomPass.v"+ut,dt.texture.generateMipmaps=!1,this.renderTargetsVertical.push(dt),it=Math.round(it/2),st=Math.round(st/2)}const ot=LuminosityHighPassShader;this.highPassUniforms=UniformsUtils.clone(ot.uniforms),this.highPassUniforms.luminosityThreshold.value=nt,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:ot.vertexShader,fragmentShader:ot.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const lt=[3,5,7,9,11];it=Math.round(this.resolution.x/2),st=Math.round(this.resolution.y/2);for(let ut=0;ut<this.nMips;ut++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(lt[ut])),this.separableBlurMaterials[ut].uniforms.texSize.value=new Vector2(it,st),it=Math.round(it/2),st=Math.round(st/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=_e,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const at=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=at,this.bloomTintColors=[new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const ct=CopyShader;this.copyUniforms=UniformsUtils.clone(ct.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ct.vertexShader,fragmentShader:ct.fragmentShader,blending:AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Color$1,this.oldClearAlpha=1,this.basic=new MeshBasicMaterial,this.fsQuad=new FullScreenQuad(null)}dispose(){for(let tt=0;tt<this.renderTargetsHorizontal.length;tt++)this.renderTargetsHorizontal[tt].dispose();for(let tt=0;tt<this.renderTargetsVertical.length;tt++)this.renderTargetsVertical[tt].dispose();this.renderTargetBright.dispose();for(let tt=0;tt<this.separableBlurMaterials.length;tt++)this.separableBlurMaterials[tt].dispose();this.compositeMaterial.dispose(),this.materialCopy.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(tt,_e){let rt=Math.round(tt/2),nt=Math.round(_e/2);this.renderTargetBright.setSize(rt,nt);for(let it=0;it<this.nMips;it++)this.renderTargetsHorizontal[it].setSize(rt,nt),this.renderTargetsVertical[it].setSize(rt,nt),this.separableBlurMaterials[it].uniforms.texSize.value=new Vector2(rt,nt),rt=Math.round(rt/2),nt=Math.round(nt/2)}render(tt,_e,rt,nt,it){tt.getClearColor(this._oldClearColor),this.oldClearAlpha=tt.getClearAlpha();const st=tt.autoClear;tt.autoClear=!1,tt.setClearColor(this.clearColor,0),it&&tt.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=rt.texture,tt.setRenderTarget(null),tt.clear(),this.fsQuad.render(tt)),this.highPassUniforms.tDiffuse.value=rt.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,tt.setRenderTarget(this.renderTargetBright),tt.clear(),this.fsQuad.render(tt);let ot=this.renderTargetBright;for(let lt=0;lt<this.nMips;lt++)this.fsQuad.material=this.separableBlurMaterials[lt],this.separableBlurMaterials[lt].uniforms.colorTexture.value=ot.texture,this.separableBlurMaterials[lt].uniforms.direction.value=_UnrealBloomPass.BlurDirectionX,tt.setRenderTarget(this.renderTargetsHorizontal[lt]),tt.clear(),this.fsQuad.render(tt),this.separableBlurMaterials[lt].uniforms.colorTexture.value=this.renderTargetsHorizontal[lt].texture,this.separableBlurMaterials[lt].uniforms.direction.value=_UnrealBloomPass.BlurDirectionY,tt.setRenderTarget(this.renderTargetsVertical[lt]),tt.clear(),this.fsQuad.render(tt),ot=this.renderTargetsVertical[lt];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,tt.setRenderTarget(this.renderTargetsHorizontal[0]),tt.clear(),this.fsQuad.render(tt),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,it&&tt.state.buffers.stencil.setTest(!0),this.renderToScreen?(tt.setRenderTarget(null),this.fsQuad.render(tt)):(tt.setRenderTarget(rt),this.fsQuad.render(tt)),tt.setClearColor(this._oldClearColor,this.oldClearAlpha),tt.autoClear=st}getSeperableBlurMaterial(tt){return new ShaderMaterial({defines:{KERNEL_RADIUS:tt,SIGMA:tt},uniforms:{colorTexture:{value:null},texSize:{value:new Vector2(.5,.5)},direction:{value:new Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(tt){return new ShaderMaterial({defines:{NUM_MIPS:tt},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}};let UnrealBloomPass=_UnrealBloomPass;__publicField(UnrealBloomPass,"BlurDirectionX",new Vector2(1,0));__publicField(UnrealBloomPass,"BlurDirectionY",new Vector2(0,1));const SAOShader={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","	#if DIFFUSE_TEXTURE == 1","	return texture2D( tDiffuse, vUv );","	#else","	return vec4( 1.0 );","	#endif","}","float getDepth( const in vec2 screenPosition ) {","	#if DEPTH_PACKING == 1","	return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","	#else","	return texture2D( tDepth, screenPosition ).x;","	#endif","}","float getViewZ( const in float depth ) {","	#if PERSPECTIVE_CAMERA == 1","	return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","	#else","	return orthographicDepthToViewZ( depth, cameraNear, cameraFar );","	#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","	float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","	vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","	clipPosition *= clipW; // unprojection.","	return ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","	#if NORMAL_TEXTURE == 1","	return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","	#else","	return normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","	#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","	vec3 viewDelta = sampleViewPosition - centerViewPosition;","	float viewDistance = length( viewDelta );","	float scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","	return max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","	// precompute some variables require in getOcclusion.","	scaleDividedByCameraFar = scale / cameraFar;","	minResolutionMultipliedByCameraFar = minResolution * cameraFar;","	vec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","	// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","	float angle = rand( vUv + randomSeed ) * PI2;","	vec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","	vec2 radiusStep = radius;","	float occlusionSum = 0.0;","	float weightSum = 0.0;","	for( int i = 0; i < NUM_SAMPLES; i ++ ) {","		vec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","		radius += radiusStep;","		angle += ANGLE_STEP;","		float sampleDepth = getDepth( sampleUv );","		if( sampleDepth >= ( 1.0 - EPSILON ) ) {","			continue;","		}","		float sampleViewZ = getViewZ( sampleDepth );","		vec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","		occlusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","		weightSum += 1.0;","	}","	if( weightSum == 0.0 ) discard;","	return occlusionSum * ( intensity / weightSum );","}","void main() {","	float centerDepth = getDepth( vUv );","	if( centerDepth >= ( 1.0 - EPSILON ) ) {","		discard;","	}","	float centerViewZ = getViewZ( centerDepth );","	vec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","	float ambientOcclusion = getAmbientOcclusion( viewPosition );","	gl_FragColor = getDefaultColor( vUv );","	gl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join(`
`)},DepthLimitedBlurShader={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new Vector2(512,512)},sampleUvOffsets:{value:[new Vector2(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","	vUv = uv;","	vInvSize = 1.0 / size;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","	#if DEPTH_PACKING == 1","	return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","	#else","	return texture2D( tDepth, screenPosition ).x;","	#endif","}","float getViewZ( const in float depth ) {","	#if PERSPECTIVE_CAMERA == 1","	return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","	#else","	return orthographicDepthToViewZ( depth, cameraNear, cameraFar );","	#endif","}","void main() {","	float depth = getDepth( vUv );","	if( depth >= ( 1.0 - EPSILON ) ) {","		discard;","	}","	float centerViewZ = -getViewZ( depth );","	bool rBreak = false, lBreak = false;","	float weightSum = sampleWeights[0];","	vec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","	for( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","		float sampleWeight = sampleWeights[i];","		vec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","		vec2 sampleUv = vUv + sampleUvOffset;","		float viewZ = -getViewZ( getDepth( sampleUv ) );","		if( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","		if( ! rBreak ) {","			diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","			weightSum += sampleWeight;","		}","		sampleUv = vUv - sampleUvOffset;","		viewZ = -getViewZ( getDepth( sampleUv ) );","		if( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","		if( ! lBreak ) {","			diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","			weightSum += sampleWeight;","		}","	}","	gl_FragColor = diffuseSum / weightSum;","}"].join(`
`)},BlurShaderUtils={createSampleWeights:(tt,_e)=>{const rt=(it,st)=>Math.exp(-(it*it)/(2*(st*st)))/(Math.sqrt(2*Math.PI)*st),nt=[];for(let it=0;it<=tt;it++)nt.push(rt(it,_e));return nt},createSampleOffsets:(tt,_e)=>{const rt=[];for(let nt=0;nt<=tt;nt++)rt.push(_e.clone().multiplyScalar(nt));return rt},configure:(tt,_e,rt,nt)=>{tt.defines.KERNEL_RADIUS=_e,tt.uniforms.sampleUvOffsets.value=BlurShaderUtils.createSampleOffsets(_e,nt),tt.uniforms.sampleWeights.value=BlurShaderUtils.createSampleWeights(_e,rt),tt.needsUpdate=!0}};class SAOPass extends Pass{constructor(_e,rt,nt=!1,it=!1,st=new Vector2(256,256)){super(),this.scene=_e,this.camera=rt,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=nt,this.supportsNormalTexture=it,this.originalClearColor=new Color$1,this._oldClearColor=new Color$1,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=new Vector2(st.x,st.y),this.saoRenderTarget=new WebGLRenderTarget(this.resolution.x,this.resolution.y,{type:HalfFloatType}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType}),this.depthRenderTarget=this.normalRenderTarget.clone();let ot;this.supportsDepthTextureExtension&&(ot=new DepthTexture,ot.type=UnsignedShortType,this.beautyRenderTarget.depthTexture=ot,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new MeshDepthMaterial,this.depthMaterial.depthPacking=RGBADepthPacking,this.depthMaterial.blending=NoBlending,this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,this.saoMaterial=new ShaderMaterial({defines:Object.assign({},SAOShader.defines),fragmentShader:SAOShader.fragmentShader,vertexShader:SAOShader.vertexShader,uniforms:UniformsUtils.clone(SAOShader.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?ot:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=NoBlending,this.vBlurMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(DepthLimitedBlurShader.uniforms),defines:Object.assign({},DepthLimitedBlurShader.defines),vertexShader:DepthLimitedBlurShader.vertexShader,fragmentShader:DepthLimitedBlurShader.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?ot:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=NoBlending,this.hBlurMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(DepthLimitedBlurShader.uniforms),defines:Object.assign({},DepthLimitedBlurShader.defines),vertexShader:DepthLimitedBlurShader.vertexShader,fragmentShader:DepthLimitedBlurShader.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?ot:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=NoBlending,this.materialCopy=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,blending:NoBlending}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=CustomBlending,this.materialCopy.blendSrc=DstColorFactor,this.materialCopy.blendDst=ZeroFactor,this.materialCopy.blendEquation=AddEquation,this.materialCopy.blendSrcAlpha=DstAlphaFactor,this.materialCopy.blendDstAlpha=ZeroFactor,this.materialCopy.blendEquationAlpha=AddEquation,this.depthCopy=new ShaderMaterial({uniforms:UniformsUtils.clone(UnpackDepthRGBAShader.uniforms),vertexShader:UnpackDepthRGBAShader.vertexShader,fragmentShader:UnpackDepthRGBAShader.fragmentShader,blending:NoBlending}),this.fsQuad=new FullScreenQuad(null)}render(_e,rt,nt){if(this.renderToScreen&&(this.materialCopy.blending=NoBlending,this.materialCopy.uniforms.tDiffuse.value=nt.texture,this.materialCopy.needsUpdate=!0,this.renderPass(_e,this.materialCopy,null)),this.params.output===1)return;_e.getClearColor(this._oldClearColor),this.oldClearAlpha=_e.getClearAlpha();const it=_e.autoClear;_e.autoClear=!1,_e.setRenderTarget(this.depthRenderTarget),_e.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;const st=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=st,this.hBlurMaterial.uniforms.depthCutoff.value=st,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(BlurShaderUtils.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new Vector2(0,1)),BlurShaderUtils.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new Vector2(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),_e.setClearColor(0),_e.setRenderTarget(this.beautyRenderTarget),_e.clear(),_e.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(_e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(_e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(_e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(_e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(_e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let ot=this.materialCopy;this.params.output===3?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,ot=this.depthCopy):this.params.output===4?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),this.params.output===0?ot.blending=CustomBlending:ot.blending=NoBlending,this.renderPass(_e,ot,this.renderToScreen?null:nt),_e.setClearColor(this._oldClearColor,this.oldClearAlpha),_e.autoClear=it}renderPass(_e,rt,nt,it,st){_e.getClearColor(this.originalClearColor);const ot=_e.getClearAlpha(),lt=_e.autoClear;_e.setRenderTarget(nt),_e.autoClear=!1,it!=null&&(_e.setClearColor(it),_e.setClearAlpha(st||0),_e.clear()),this.fsQuad.material=rt,this.fsQuad.render(_e),_e.autoClear=lt,_e.setClearColor(this.originalClearColor),_e.setClearAlpha(ot)}renderOverride(_e,rt,nt,it,st){_e.getClearColor(this.originalClearColor);const ot=_e.getClearAlpha(),lt=_e.autoClear;_e.setRenderTarget(nt),_e.autoClear=!1,it=rt.clearColor||it,st=rt.clearAlpha||st,it!=null&&(_e.setClearColor(it),_e.setClearAlpha(st||0),_e.clear()),this.scene.overrideMaterial=rt,_e.render(this.scene,this.camera),this.scene.overrideMaterial=null,_e.autoClear=lt,_e.setClearColor(this.originalClearColor),_e.setClearAlpha(ot)}setSize(_e,rt){this.beautyRenderTarget.setSize(_e,rt),this.saoRenderTarget.setSize(_e,rt),this.blurIntermediateRenderTarget.setSize(_e,rt),this.normalRenderTarget.setSize(_e,rt),this.depthRenderTarget.setSize(_e,rt),this.saoMaterial.uniforms.size.value.set(_e,rt),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(_e,rt),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(_e,rt),this.hBlurMaterial.needsUpdate=!0}dispose(){this.saoRenderTarget.dispose(),this.blurIntermediateRenderTarget.dispose(),this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.depthRenderTarget.dispose(),this.depthMaterial.dispose(),this.normalMaterial.dispose(),this.saoMaterial.dispose(),this.vBlurMaterial.dispose(),this.hBlurMaterial.dispose(),this.materialCopy.dispose(),this.depthCopy.dispose(),this.fsQuad.dispose()}}__publicField(SAOPass,"OUTPUT",{Beauty:1,Default:0,SAO:2,Depth:3,Normal:4});const SSRShader={defines:{MAX_STEP:0,isPerspectiveCamera:!0,isDistanceAttenuation:!0,isFresnel:!0,isInfiniteThick:!1,isSelective:!1},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tMetalness:{value:null},tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new Vector2},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},opacity:{value:.5},maxDistance:{value:180},cameraRange:{value:0},surfDist:{value:.007},thickTolerance:{value:.03}},vertexShader:`

    varying vec2 vUv;

    void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }

  `,fragmentShader:`
		// precision highp float;
		precision highp sampler2D;
		varying vec2 vUv;
		uniform sampler2D tDepth;
		uniform sampler2D tNormal;
		uniform sampler2D tMetalness;
		uniform sampler2D tDiffuse;
		uniform float cameraRange;
		uniform vec2 resolution;
		uniform float opacity;
		uniform float cameraNear;
		uniform float cameraFar;
		uniform float maxDistance;
		uniform float surfDist;
		uniform mat4 cameraProjectionMatrix;
		uniform mat4 cameraInverseProjectionMatrix;
		uniform float thickTolerance;
		#include <packing>
		float pointToLineDistance(vec3 x0, vec3 x1, vec3 x2) {
			//x0: point, x1: linePointA, x2: linePointB
			//https://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html
			return length(cross(x0-x1,x0-x2))/length(x2-x1);
		}
		float pointPlaneDistance(vec3 point,vec3 planePoint,vec3 planeNormal){
			// https://mathworld.wolfram.com/Point-PlaneDistance.html
			//// https://en.wikipedia.org/wiki/Plane_(geometry)
			//// http://paulbourke.net/geometry/pointlineplane/
			float a=planeNormal.x,b=planeNormal.y,c=planeNormal.z;
			float x0=point.x,y0=point.y,z0=point.z;
			float x=planePoint.x,y=planePoint.y,z=planePoint.z;
			float d=-(a*x+b*y+c*z);
			float distance=(a*x0+b*y0+c*z0+d)/sqrt(a*a+b*b+c*c);
			return distance;
		}
		float getDepth( const in vec2 uv ) {
			return texture2D( tDepth, uv ).x;
		}
		float getViewZ( const in float depth ) {
			#ifdef isPerspectiveCamera
				return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
				return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}
		vec3 getViewPosition( const in vec2 uv, const in float depth/*clip space*/, const in float clipW ) {
			vec4 clipPosition = vec4( ( vec3( uv, depth ) - 0.5 ) * 2.0, 1.0 );//ndc
			clipPosition *= clipW; //clip
			return ( cameraInverseProjectionMatrix * clipPosition ).xyz;//view
		}
		vec3 getViewNormal( const in vec2 uv ) {
			return unpackRGBToNormal( texture2D( tNormal, uv ).xyz );
		}
		vec2 viewPositionToXY(vec3 viewPosition){
			vec2 xy;
			vec4 clip=cameraProjectionMatrix*vec4(viewPosition,1);
			xy=clip.xy;//clip
			float clipW=clip.w;
			xy/=clipW;//NDC
			xy=(xy+1.)/2.;//uv
			xy*=resolution;//screen
			return xy;
		}
		void main(){
			#ifdef isSelective
				float metalness=texture2D(tMetalness,vUv).r;
				if(metalness==0.) return;
			#endif

			float depth = getDepth( vUv );
			float viewZ = getViewZ( depth );
			if(-viewZ>=cameraFar) return;

			float clipW = cameraProjectionMatrix[2][3] * viewZ+cameraProjectionMatrix[3][3];
			vec3 viewPosition=getViewPosition( vUv, depth, clipW );

			vec2 d0=gl_FragCoord.xy;
			vec2 d1;

			vec3 viewNormal=getViewNormal( vUv );

			#ifdef isPerspectiveCamera
				vec3 viewIncidenceDir=normalize(viewPosition);
				vec3 viewReflectDir=reflect(viewIncidenceDir,viewNormal);
			#else
				vec3 viewIncidenceDir=vec3(0,0,-1);
				vec3 viewReflectDir=reflect(viewIncidenceDir,viewNormal);
			#endif

			float maxReflectRayLen=maxDistance/dot(-viewIncidenceDir,viewNormal);
			// dot(a,b)==length(a)*length(b)*cos(theta) // https://www.mathsisfun.com/algebra/vectors-dot-product.html
			// if(a.isNormalized&&b.isNormalized) dot(a,b)==cos(theta)
			// maxDistance/maxReflectRayLen=cos(theta)
			// maxDistance/maxReflectRayLen==dot(a,b)
			// maxReflectRayLen==maxDistance/dot(a,b)

			vec3 d1viewPosition=viewPosition+viewReflectDir*maxReflectRayLen;
			#ifdef isPerspectiveCamera
				if(d1viewPosition.z>-cameraNear){
					//https://tutorial.math.lamar.edu/Classes/CalcIII/EqnsOfLines.aspx
					float t=(-cameraNear-viewPosition.z)/viewReflectDir.z;
					d1viewPosition=viewPosition+viewReflectDir*t;
				}
			#endif
			d1=viewPositionToXY(d1viewPosition);

			float totalLen=length(d1-d0);
			float xLen=d1.x-d0.x;
			float yLen=d1.y-d0.y;
			float totalStep=max(abs(xLen),abs(yLen));
			float xSpan=xLen/totalStep;
			float ySpan=yLen/totalStep;
			for(float i=0.;i<MAX_STEP;i++){
				if(i>=totalStep) break;
				vec2 xy=vec2(d0.x+i*xSpan,d0.y+i*ySpan);
				if(xy.x<0.||xy.x>resolution.x||xy.y<0.||xy.y>resolution.y) break;
				float s=length(xy-d0)/totalLen;
				vec2 uv=xy/resolution;

				float d = getDepth(uv);
				float vZ = getViewZ( d );
				if(-vZ>=cameraFar) continue;
				float cW = cameraProjectionMatrix[2][3] * vZ+cameraProjectionMatrix[3][3];
				vec3 vP=getViewPosition( uv, d, cW );

				#ifdef isPerspectiveCamera
					// https://www.comp.nus.edu.sg/~lowkl/publications/lowk_persp_interp_techrep.pdf
					float recipVPZ=1./viewPosition.z;
					float viewReflectRayZ=1./(recipVPZ+s*(1./d1viewPosition.z-recipVPZ));
					float sD=surfDist*cW;
				#else
					float viewReflectRayZ=viewPosition.z+s*(d1viewPosition.z-viewPosition.z);
					float sD=surfDist;
				#endif
				if(viewReflectRayZ-sD>vZ) continue;

				#ifdef isInfiniteThick
					if(viewReflectRayZ+thickTolerance*clipW<vP.z) break;
				#endif
				float away=pointToLineDistance(vP,viewPosition,d1viewPosition);

				float op=opacity;

				if(away<sD){
					vec3 vN=getViewNormal( uv );
					if(dot(viewReflectDir,vN)>=0.) continue;
					float distance=pointPlaneDistance(vP,viewPosition,viewNormal);
					if(distance>maxDistance) break;
					#ifdef isDistanceAttenuation
						float ratio=1.-(distance/maxDistance);
						float attenuation=ratio*ratio;
						op=opacity*attenuation;
					#endif
					#ifdef isFresnel
						float fresnel=(dot(viewIncidenceDir,viewReflectDir)+1.)/2.;
						op*=fresnel;
					#endif
					vec4 reflectColor=texture2D(tDiffuse,uv);
					gl_FragColor.xyz=reflectColor.xyz;
					gl_FragColor.a=op;
					break;
				}
			}
		}
	`},SSRDepthShader={defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:`

    varying vec2 vUv;

    void main() {

    	vUv = uv;
    	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }

  `,fragmentShader:`

    uniform sampler2D tDepth;

    uniform float cameraNear;
    uniform float cameraFar;

    varying vec2 vUv;

    #include <packing>

		float getLinearDepth( const in vec2 uv ) {

			#if PERSPECTIVE_CAMERA == 1

				float fragCoordZ = texture2D( tDepth, uv ).x;
				float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );
				return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );

			#else

				return texture2D( tDepth, uv ).x;

			#endif

		}

    void main() {

    	float depth = getLinearDepth( vUv );
			float d = 1.0 - depth;
			// d=(d-.999)*1000.;
    	gl_FragColor = vec4( vec3( d ), 1.0 );

    }

  `},SSRBlurShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2},opacity:{value:.5}},vertexShader:`

    varying vec2 vUv;

    void main() {

    	vUv = uv;
    	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }

  `,fragmentShader:`

    uniform sampler2D tDiffuse;
    uniform vec2 resolution;
    varying vec2 vUv;
    void main() {
			//reverse engineering from PhotoShop blur filter, then change coefficient

    	vec2 texelSize = ( 1.0 / resolution );

			vec4 c=texture2D(tDiffuse,vUv);

			vec2 offset;

			offset=(vec2(-1,0))*texelSize;
			vec4 cl=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(1,0))*texelSize;
			vec4 cr=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(0,-1))*texelSize;
			vec4 cb=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(0,1))*texelSize;
			vec4 ct=texture2D(tDiffuse,vUv+offset);

			// float coeCenter=.5;
			// float coeSide=.125;
			float coeCenter=.2;
			float coeSide=.2;
			float a=c.a*coeCenter+cl.a*coeSide+cr.a*coeSide+cb.a*coeSide+ct.a*coeSide;
			vec3 rgb=(c.rgb*c.a*coeCenter+cl.rgb*cl.a*coeSide+cr.rgb*cr.a*coeSide+cb.rgb*cb.a*coeSide+ct.rgb*ct.a*coeSide)/a;
			gl_FragColor=vec4(rgb,a);

		}
	`},_SSRPass=class extends Pass{constructor({renderer:tt,scene:_e,camera:rt,width:nt,height:it,selects:st,bouncing:ot=!1,groundReflector:lt}){super(),this.width=nt!==void 0?nt:512,this.height=it!==void 0?it:512,this.clear=!0,this.renderer=tt,this.scene=_e,this.camera=rt,this.groundReflector=lt,this.opacity=SSRShader.uniforms.opacity.value,this.output=0,this.maxDistance=SSRShader.uniforms.maxDistance.value,this.thickness=SSRShader.uniforms.thickness.value,this.tempColor=new Color$1,this._selects=st,this.selective=Array.isArray(this._selects),Object.defineProperty(this,"selects",{get(){return this._selects},set(ct){this._selects!==ct&&(this._selects=ct,Array.isArray(ct)?(this.selective=!0,this.ssrMaterial.defines.SELECTIVE=!0,this.ssrMaterial.needsUpdate=!0):(this.selective=!1,this.ssrMaterial.defines.SELECTIVE=!1,this.ssrMaterial.needsUpdate=!0))}}),this._bouncing=ot,Object.defineProperty(this,"bouncing",{get(){return this._bouncing},set(ct){this._bouncing!==ct&&(this._bouncing=ct,ct?this.ssrMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture:this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture)}}),this.blur=!0,this._distanceAttenuation=SSRShader.defines.DISTANCE_ATTENUATION,Object.defineProperty(this,"distanceAttenuation",{get(){return this._distanceAttenuation},set(ct){this._distanceAttenuation!==ct&&(this._distanceAttenuation=ct,this.ssrMaterial.defines.DISTANCE_ATTENUATION=ct,this.ssrMaterial.needsUpdate=!0)}}),this._fresnel=SSRShader.defines.FRESNEL,Object.defineProperty(this,"fresnel",{get(){return this._fresnel},set(ct){this._fresnel!==ct&&(this._fresnel=ct,this.ssrMaterial.defines.FRESNEL=ct,this.ssrMaterial.needsUpdate=!0)}}),this._infiniteThick=SSRShader.defines.INFINITE_THICK,Object.defineProperty(this,"infiniteThick",{get(){return this._infiniteThick},set(ct){this._infiniteThick!==ct&&(this._infiniteThick=ct,this.ssrMaterial.defines.INFINITE_THICK=ct,this.ssrMaterial.needsUpdate=!0)}});const at=new DepthTexture;at.type=UnsignedShortType,at.minFilter=NearestFilter,at.magFilter=NearestFilter,this.beautyRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType,depthTexture:at,depthBuffer:!0}),this.prevRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter}),this.normalRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType}),this.metalnessRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType}),this.ssrRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter}),this.blurRenderTarget=this.ssrRenderTarget.clone(),this.blurRenderTarget2=this.ssrRenderTarget.clone(),this.ssrMaterial=new ShaderMaterial({defines:Object.assign({},SSRShader.defines,{MAX_STEP:Math.sqrt(this.width*this.width+this.height*this.height)}),uniforms:UniformsUtils.clone(SSRShader.uniforms),vertexShader:SSRShader.vertexShader,fragmentShader:SSRShader.fragmentShader,blending:NoBlending}),this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssrMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssrMaterial.defines.SELECTIVE=this.selective,this.ssrMaterial.needsUpdate=!0,this.ssrMaterial.uniforms.tMetalness.value=this.metalnessRenderTarget.texture,this.ssrMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.ssrMaterial.uniforms.cameraNear.value=this.camera.near,this.ssrMaterial.uniforms.cameraFar.value=this.camera.far,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.ssrMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,this.metalnessOnMaterial=new MeshBasicMaterial({color:"white"}),this.metalnessOffMaterial=new MeshBasicMaterial({color:"black"}),this.blurMaterial=new ShaderMaterial({defines:Object.assign({},SSRBlurShader.defines),uniforms:UniformsUtils.clone(SSRBlurShader.uniforms),vertexShader:SSRBlurShader.vertexShader,fragmentShader:SSRBlurShader.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.blurMaterial2=new ShaderMaterial({defines:Object.assign({},SSRBlurShader.defines),uniforms:UniformsUtils.clone(SSRBlurShader.uniforms),vertexShader:SSRBlurShader.vertexShader,fragmentShader:SSRBlurShader.fragmentShader}),this.blurMaterial2.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.blurMaterial2.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new ShaderMaterial({defines:Object.assign({},SSRDepthShader.defines),uniforms:UniformsUtils.clone(SSRDepthShader.uniforms),vertexShader:SSRDepthShader.vertexShader,fragmentShader:SSRDepthShader.fragmentShader,blending:NoBlending}),this.depthRenderMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:SrcAlphaFactor,blendDst:OneMinusSrcAlphaFactor,blendEquation:AddEquation,blendSrcAlpha:SrcAlphaFactor,blendDstAlpha:OneMinusSrcAlphaFactor,blendEquationAlpha:AddEquation}),this.fsQuad=new FullScreenQuad(null),this.originalClearColor=new Color$1}dispose(){this.beautyRenderTarget.dispose(),this.prevRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.metalnessRenderTarget.dispose(),this.ssrRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.blurRenderTarget2.dispose(),this.normalMaterial.dispose(),this.metalnessOnMaterial.dispose(),this.metalnessOffMaterial.dispose(),this.blurMaterial.dispose(),this.blurMaterial2.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(tt,_e){switch(tt.setRenderTarget(this.beautyRenderTarget),tt.clear(),this.groundReflector&&(this.groundReflector.visible=!1,this.groundReflector.doRender(this.renderer,this.scene,this.camera),this.groundReflector.visible=!0),tt.render(this.scene,this.camera),this.groundReflector&&(this.groundReflector.visible=!1),this.renderOverride(tt,this.normalMaterial,this.normalRenderTarget,0,0),this.selective&&this.renderMetalness(tt,this.metalnessOnMaterial,this.metalnessRenderTarget,0,0),this.ssrMaterial.uniforms.opacity.value=this.opacity,this.ssrMaterial.uniforms.maxDistance.value=this.maxDistance,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.renderPass(tt,this.ssrMaterial,this.ssrRenderTarget),this.blur&&(this.renderPass(tt,this.blurMaterial,this.blurRenderTarget),this.renderPass(tt,this.blurMaterial2,this.blurRenderTarget2)),this.output){case _SSRPass.OUTPUT.Default:this.bouncing?(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.prevRenderTarget),this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=NormalBlending,this.renderPass(tt,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e)):(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e),this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=NormalBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e));break;case _SSRPass.OUTPUT.SSR:this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e),this.bouncing&&(this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=NormalBlending,this.renderPass(tt,this.copyMaterial,this.prevRenderTarget));break;case _SSRPass.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSRPass.OUTPUT.Depth:this.renderPass(tt,this.depthRenderMaterial,this.renderToScreen?null:_e);break;case _SSRPass.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSRPass.OUTPUT.Metalness:this.copyMaterial.uniforms.tDiffuse.value=this.metalnessRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;default:console.warn("THREE.SSRPass: Unknown output type.")}}renderPass(tt,_e,rt,nt,it){this.originalClearColor.copy(tt.getClearColor(this.tempColor));const st=tt.getClearAlpha(this.tempColor),ot=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,nt!=null&&(tt.setClearColor(nt),tt.setClearAlpha(it||0),tt.clear()),this.fsQuad.material=_e,this.fsQuad.render(tt),tt.autoClear=ot,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}renderOverride(tt,_e,rt,nt,it){this.originalClearColor.copy(tt.getClearColor(this.tempColor));const st=tt.getClearAlpha(this.tempColor),ot=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,nt=_e.clearColor||nt,it=_e.clearAlpha||it,nt!=null&&(tt.setClearColor(nt),tt.setClearAlpha(it||0),tt.clear()),this.scene.overrideMaterial=_e,tt.render(this.scene,this.camera),this.scene.overrideMaterial=null,tt.autoClear=ot,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}renderMetalness(tt,_e,rt,nt,it){this.originalClearColor.copy(tt.getClearColor(this.tempColor));const st=tt.getClearAlpha(this.tempColor),ot=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,nt=_e.clearColor||nt,it=_e.clearAlpha||it,nt!=null&&(tt.setClearColor(nt),tt.setClearAlpha(it||0),tt.clear()),this.scene.traverseVisible(lt=>{lt._SSRPassBackupMaterial=lt.material,this._selects.includes(lt)?lt.material=this.metalnessOnMaterial:lt.material=this.metalnessOffMaterial}),tt.render(this.scene,this.camera),this.scene.traverseVisible(lt=>{lt.material=lt._SSRPassBackupMaterial}),tt.autoClear=ot,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}setSize(tt,_e){this.width=tt,this.height=_e,this.ssrMaterial.defines.MAX_STEP=Math.sqrt(tt*tt+_e*_e),this.ssrMaterial.needsUpdate=!0,this.beautyRenderTarget.setSize(tt,_e),this.prevRenderTarget.setSize(tt,_e),this.ssrRenderTarget.setSize(tt,_e),this.normalRenderTarget.setSize(tt,_e),this.metalnessRenderTarget.setSize(tt,_e),this.blurRenderTarget.setSize(tt,_e),this.blurRenderTarget2.setSize(tt,_e),this.ssrMaterial.uniforms.resolution.value.set(tt,_e),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(tt,_e),this.blurMaterial2.uniforms.resolution.value.set(tt,_e)}};let SSRPass=_SSRPass;__publicField(SSRPass,"OUTPUT",{Default:0,SSR:1,Beauty:3,Depth:4,Normal:5,Metalness:7});let GLTFLoader$1=class extends Loader{constructor(_e){super(_e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(rt){return new GLTFMaterialsClearcoatExtension2(rt)}),this.register(function(rt){return new GLTFTextureBasisUExtension$1(rt)}),this.register(function(rt){return new GLTFTextureWebPExtension$1(rt)}),this.register(function(rt){return new GLTFTextureAVIFExtension$1(rt)}),this.register(function(rt){return new GLTFMaterialsSheenExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsTransmissionExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsVolumeExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsIorExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsEmissiveStrengthExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsSpecularExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsIridescenceExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsAnisotropyExtension2(rt)}),this.register(function(rt){return new GLTFLightsExtension$1(rt)}),this.register(function(rt){return new GLTFMeshoptCompression$1(rt)}),this.register(function(rt){return new GLTFMeshGpuInstancing$1(rt)})}load(_e,rt,nt,it){const st=this;let ot;this.resourcePath!==""?ot=this.resourcePath:this.path!==""?ot=this.path:ot=LoaderUtils.extractUrlBase(_e),this.manager.itemStart(_e);const lt=function(ct){it?it(ct):console.error(ct),st.manager.itemError(_e),st.manager.itemEnd(_e)},at=new FileLoader(this.manager);at.setPath(this.path),at.setResponseType("arraybuffer"),at.setRequestHeader(this.requestHeader),at.setWithCredentials(this.withCredentials),at.load(_e,function(ct){try{st.parse(ct,ot,function(ut){rt(ut),st.manager.itemEnd(_e)},lt)}catch(ut){lt(ut)}},nt,lt)}setDRACOLoader(_e){return this.dracoLoader=_e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_e){return this.ktx2Loader=_e,this}setMeshoptDecoder(_e){return this.meshoptDecoder=_e,this}register(_e){return this.pluginCallbacks.indexOf(_e)===-1&&this.pluginCallbacks.push(_e),this}unregister(_e){return this.pluginCallbacks.indexOf(_e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_e),1),this}parse(_e,rt,nt,it){let st;const ot={},lt={};if(typeof _e=="string")st=JSON.parse(_e);else if(_e instanceof ArrayBuffer)if(LoaderUtils.decodeText(new Uint8Array(_e.slice(0,4)))===BINARY_EXTENSION_HEADER_MAGIC$1){try{ot[EXTENSIONS$1.KHR_BINARY_GLTF]=new GLTFBinaryExtension$1(_e)}catch(ut){it&&it(ut);return}st=JSON.parse(ot[EXTENSIONS$1.KHR_BINARY_GLTF].content)}else st=JSON.parse(LoaderUtils.decodeText(new Uint8Array(_e)));else st=_e;if(st.asset===void 0||st.asset.version[0]<2){it&&it(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const at=new GLTFParser$1(st,{path:rt||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});at.fileLoader.setRequestHeader(this.requestHeader);for(let ct=0;ct<this.pluginCallbacks.length;ct++){const ut=this.pluginCallbacks[ct](at);lt[ut.name]=ut,ot[ut.name]=!0}if(st.extensionsUsed)for(let ct=0;ct<st.extensionsUsed.length;++ct){const ut=st.extensionsUsed[ct],ht=st.extensionsRequired||[];switch(ut){case EXTENSIONS$1.KHR_MATERIALS_UNLIT:ot[ut]=new GLTFMaterialsUnlitExtension2;break;case EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION:ot[ut]=new GLTFDracoMeshCompressionExtension$1(st,this.dracoLoader);break;case EXTENSIONS$1.KHR_TEXTURE_TRANSFORM:ot[ut]=new GLTFTextureTransformExtension$1;break;case EXTENSIONS$1.KHR_MESH_QUANTIZATION:ot[ut]=new GLTFMeshQuantizationExtension$1;break;default:ht.indexOf(ut)>=0&&lt[ut]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ut+'".')}}at.setExtensions(ot),at.setPlugins(lt),at.parse(nt,it)}parseAsync(_e,rt){const nt=this;return new Promise(function(it,st){nt.parse(_e,rt,it,st)})}};function GLTFRegistry$1(){let tt={};return{get:function(_e){return tt[_e]},add:function(_e,rt){tt[_e]=rt},remove:function(_e){delete tt[_e]},removeAll:function(){tt={}}}}const EXTENSIONS$1={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let GLTFLightsExtension$1=class{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _e=this.parser,rt=this.parser.json.nodes||[];for(let nt=0,it=rt.length;nt<it;nt++){const st=rt[nt];st.extensions&&st.extensions[this.name]&&st.extensions[this.name].light!==void 0&&_e._addNodeRef(this.cache,st.extensions[this.name].light)}}_loadLight(_e){const rt=this.parser,nt="light:"+_e;let it=rt.cache.get(nt);if(it)return it;const st=rt.json,at=((st.extensions&&st.extensions[this.name]||{}).lights||[])[_e];let ct;const ut=new Color$1(16777215);at.color!==void 0&&ut.fromArray(at.color);const ht=at.range!==void 0?at.range:0;switch(at.type){case"directional":ct=new DirectionalLight(ut),ct.target.position.set(0,0,-1),ct.add(ct.target);break;case"point":ct=new PointLight(ut),ct.distance=ht;break;case"spot":ct=new SpotLight(ut),ct.distance=ht,at.spot=at.spot||{},at.spot.innerConeAngle=at.spot.innerConeAngle!==void 0?at.spot.innerConeAngle:0,at.spot.outerConeAngle=at.spot.outerConeAngle!==void 0?at.spot.outerConeAngle:Math.PI/4,ct.angle=at.spot.outerConeAngle,ct.penumbra=1-at.spot.innerConeAngle/at.spot.outerConeAngle,ct.target.position.set(0,0,-1),ct.add(ct.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+at.type)}return ct.position.set(0,0,0),ct.decay=2,assignExtrasToUserData$1(ct,at),at.intensity!==void 0&&(ct.intensity=at.intensity),ct.name=rt.createUniqueName(at.name||"light_"+_e),it=Promise.resolve(ct),rt.cache.add(nt,it),it}getDependency(_e,rt){if(_e==="light")return this._loadLight(rt)}createNodeAttachment(_e){const rt=this,nt=this.parser,st=nt.json.nodes[_e],lt=(st.extensions&&st.extensions[this.name]||{}).light;return lt===void 0?null:this._loadLight(lt).then(function(at){return nt._getNodeRef(rt.cache,lt,at)})}};class GLTFMaterialsUnlitExtension2{constructor(){this.name=EXTENSIONS$1.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_e,rt,nt){const it=[];_e.color=new Color$1(1,1,1),_e.opacity=1;const st=rt.pbrMetallicRoughness;if(st){if(Array.isArray(st.baseColorFactor)){const ot=st.baseColorFactor;_e.color.fromArray(ot),_e.opacity=ot[3]}st.baseColorTexture!==void 0&&it.push(nt.assignTexture(_e,"map",st.baseColorTexture,3001))}return Promise.all(it)}}class GLTFMaterialsEmissiveStrengthExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_e,rt){const it=this.parser.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=it.extensions[this.name].emissiveStrength;return st!==void 0&&(rt.emissiveIntensity=st),Promise.resolve()}}class GLTFMaterialsClearcoatExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_CLEARCOAT}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];if(ot.clearcoatFactor!==void 0&&(rt.clearcoat=ot.clearcoatFactor),ot.clearcoatTexture!==void 0&&st.push(nt.assignTexture(rt,"clearcoatMap",ot.clearcoatTexture)),ot.clearcoatRoughnessFactor!==void 0&&(rt.clearcoatRoughness=ot.clearcoatRoughnessFactor),ot.clearcoatRoughnessTexture!==void 0&&st.push(nt.assignTexture(rt,"clearcoatRoughnessMap",ot.clearcoatRoughnessTexture)),ot.clearcoatNormalTexture!==void 0&&(st.push(nt.assignTexture(rt,"clearcoatNormalMap",ot.clearcoatNormalTexture)),ot.clearcoatNormalTexture.scale!==void 0)){const lt=ot.clearcoatNormalTexture.scale;rt.clearcoatNormalScale=new Vector2(lt,lt)}return Promise.all(st)}}class GLTFMaterialsIridescenceExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.iridescenceFactor!==void 0&&(rt.iridescence=ot.iridescenceFactor),ot.iridescenceTexture!==void 0&&st.push(nt.assignTexture(rt,"iridescenceMap",ot.iridescenceTexture)),ot.iridescenceIor!==void 0&&(rt.iridescenceIOR=ot.iridescenceIor),rt.iridescenceThicknessRange===void 0&&(rt.iridescenceThicknessRange=[100,400]),ot.iridescenceThicknessMinimum!==void 0&&(rt.iridescenceThicknessRange[0]=ot.iridescenceThicknessMinimum),ot.iridescenceThicknessMaximum!==void 0&&(rt.iridescenceThicknessRange[1]=ot.iridescenceThicknessMaximum),ot.iridescenceThicknessTexture!==void 0&&st.push(nt.assignTexture(rt,"iridescenceThicknessMap",ot.iridescenceThicknessTexture)),Promise.all(st)}}class GLTFMaterialsSheenExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_SHEEN}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[];rt.sheenColor=new Color$1(0,0,0),rt.sheenRoughness=0,rt.sheen=1;const ot=it.extensions[this.name];return ot.sheenColorFactor!==void 0&&rt.sheenColor.fromArray(ot.sheenColorFactor),ot.sheenRoughnessFactor!==void 0&&(rt.sheenRoughness=ot.sheenRoughnessFactor),ot.sheenColorTexture!==void 0&&st.push(nt.assignTexture(rt,"sheenColorMap",ot.sheenColorTexture,3001)),ot.sheenRoughnessTexture!==void 0&&st.push(nt.assignTexture(rt,"sheenRoughnessMap",ot.sheenRoughnessTexture)),Promise.all(st)}}class GLTFMaterialsTransmissionExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_TRANSMISSION}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.transmissionFactor!==void 0&&(rt.transmission=ot.transmissionFactor),ot.transmissionTexture!==void 0&&st.push(nt.assignTexture(rt,"transmissionMap",ot.transmissionTexture)),Promise.all(st)}}class GLTFMaterialsVolumeExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_VOLUME}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];rt.thickness=ot.thicknessFactor!==void 0?ot.thicknessFactor:0,ot.thicknessTexture!==void 0&&st.push(nt.assignTexture(rt,"thicknessMap",ot.thicknessTexture)),rt.attenuationDistance=ot.attenuationDistance||1/0;const lt=ot.attenuationColor||[1,1,1];return rt.attenuationColor=new Color$1(lt[0],lt[1],lt[2]),Promise.all(st)}}class GLTFMaterialsIorExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_IOR}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=it.extensions[this.name];return rt.ior=st.ior!==void 0?st.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_SPECULAR}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];rt.specularIntensity=ot.specularFactor!==void 0?ot.specularFactor:1,ot.specularTexture!==void 0&&st.push(nt.assignTexture(rt,"specularIntensityMap",ot.specularTexture));const lt=ot.specularColorFactor||[1,1,1];return rt.specularColor=new Color$1(lt[0],lt[1],lt[2]),ot.specularColorTexture!==void 0&&st.push(nt.assignTexture(rt,"specularColorMap",ot.specularColorTexture,3001)),Promise.all(st)}}class GLTFMaterialsAnisotropyExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_ANISOTROPY}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.anisotropyStrength!==void 0&&(rt.anisotropy=ot.anisotropyStrength),ot.anisotropyRotation!==void 0&&(rt.anisotropyRotation=ot.anisotropyRotation),ot.anisotropyTexture!==void 0&&st.push(nt.assignTexture(rt,"anisotropyMap",ot.anisotropyTexture)),Promise.all(st)}}let GLTFTextureBasisUExtension$1=class{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_TEXTURE_BASISU}loadTexture(_e){const rt=this.parser,nt=rt.json,it=nt.textures[_e];if(!it.extensions||!it.extensions[this.name])return null;const st=it.extensions[this.name],ot=rt.options.ktx2Loader;if(!ot){if(nt.extensionsRequired&&nt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return rt.loadTextureImage(_e,st.source,ot)}},GLTFTextureWebPExtension$1=class{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_e){const rt=this.name,nt=this.parser,it=nt.json,st=it.textures[_e];if(!st.extensions||!st.extensions[rt])return null;const ot=st.extensions[rt],lt=it.images[ot.source];let at=nt.textureLoader;if(lt.uri){const ct=nt.options.manager.getHandler(lt.uri);ct!==null&&(at=ct)}return this.detectSupport().then(function(ct){if(ct)return nt.loadTextureImage(_e,ot.source,at);if(it.extensionsRequired&&it.extensionsRequired.indexOf(rt)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return nt.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const rt=new Image;rt.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",rt.onload=rt.onerror=function(){_e(rt.height===1)}})),this.isSupported}},GLTFTextureAVIFExtension$1=class{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_e){const rt=this.name,nt=this.parser,it=nt.json,st=it.textures[_e];if(!st.extensions||!st.extensions[rt])return null;const ot=st.extensions[rt],lt=it.images[ot.source];let at=nt.textureLoader;if(lt.uri){const ct=nt.options.manager.getHandler(lt.uri);ct!==null&&(at=ct)}return this.detectSupport().then(function(ct){if(ct)return nt.loadTextureImage(_e,ot.source,at);if(it.extensionsRequired&&it.extensionsRequired.indexOf(rt)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return nt.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const rt=new Image;rt.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",rt.onload=rt.onerror=function(){_e(rt.height===1)}})),this.isSupported}},GLTFMeshoptCompression$1=class{constructor(_e){this.name=EXTENSIONS$1.EXT_MESHOPT_COMPRESSION,this.parser=_e}loadBufferView(_e){const rt=this.parser.json,nt=rt.bufferViews[_e];if(nt.extensions&&nt.extensions[this.name]){const it=nt.extensions[this.name],st=this.parser.getDependency("buffer",it.buffer),ot=this.parser.options.meshoptDecoder;if(!ot||!ot.supported){if(rt.extensionsRequired&&rt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return st.then(function(lt){const at=it.byteOffset||0,ct=it.byteLength||0,ut=it.count,ht=it.byteStride,dt=new Uint8Array(lt,at,ct);return ot.decodeGltfBufferAsync?ot.decodeGltfBufferAsync(ut,ht,dt,it.mode,it.filter).then(function(ft){return ft.buffer}):ot.ready.then(function(){const ft=new ArrayBuffer(ut*ht);return ot.decodeGltfBuffer(new Uint8Array(ft),ut,ht,dt,it.mode,it.filter),ft})})}else return null}},GLTFMeshGpuInstancing$1=class{constructor(_e){this.name=EXTENSIONS$1.EXT_MESH_GPU_INSTANCING,this.parser=_e}createNodeMesh(_e){const rt=this.parser.json,nt=rt.nodes[_e];if(!nt.extensions||!nt.extensions[this.name]||nt.mesh===void 0)return null;const it=rt.meshes[nt.mesh];for(const ct of it.primitives)if(ct.mode!==WEBGL_CONSTANTS$1.TRIANGLES&&ct.mode!==WEBGL_CONSTANTS$1.TRIANGLE_STRIP&&ct.mode!==WEBGL_CONSTANTS$1.TRIANGLE_FAN&&ct.mode!==void 0)return null;const ot=nt.extensions[this.name].attributes,lt=[],at={};for(const ct in ot)lt.push(this.parser.getDependency("accessor",ot[ct]).then(ut=>(at[ct]=ut,at[ct])));return lt.length<1?null:(lt.push(this.parser.createNodeMesh(_e)),Promise.all(lt).then(ct=>{const ut=ct.pop(),ht=ut.isGroup?ut.children:[ut],dt=ct[0].count,ft=[];for(const pt of ht){const mt=new Matrix4,gt=new Vector3,vt=new Quaternion,At=new Vector3(1,1,1),yt=new InstancedMesh(pt.geometry,pt.material,dt);for(let xt=0;xt<dt;xt++)at.TRANSLATION&&gt.fromBufferAttribute(at.TRANSLATION,xt),at.ROTATION&&vt.fromBufferAttribute(at.ROTATION,xt),at.SCALE&&At.fromBufferAttribute(at.SCALE,xt),yt.setMatrixAt(xt,mt.compose(gt,vt,At));for(const xt in at)xt!=="TRANSLATION"&&xt!=="ROTATION"&&xt!=="SCALE"&&pt.geometry.setAttribute(xt,at[xt]);Object3D.prototype.copy.call(yt,pt),this.parser.assignFinalMaterial(yt),ft.push(yt)}return ut.isGroup?(ut.clear(),ut.add(...ft),ut):ft[0]}))}};const BINARY_EXTENSION_HEADER_MAGIC$1="glTF",BINARY_EXTENSION_HEADER_LENGTH$1=12,BINARY_EXTENSION_CHUNK_TYPES$1={JSON:1313821514,BIN:5130562};let GLTFBinaryExtension$1=class{constructor(_e){this.name=EXTENSIONS$1.KHR_BINARY_GLTF,this.content=null,this.body=null;const rt=new DataView(_e,0,BINARY_EXTENSION_HEADER_LENGTH$1);if(this.header={magic:LoaderUtils.decodeText(new Uint8Array(_e.slice(0,4))),version:rt.getUint32(4,!0),length:rt.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC$1)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const nt=this.header.length-BINARY_EXTENSION_HEADER_LENGTH$1,it=new DataView(_e,BINARY_EXTENSION_HEADER_LENGTH$1);let st=0;for(;st<nt;){const ot=it.getUint32(st,!0);st+=4;const lt=it.getUint32(st,!0);if(st+=4,lt===BINARY_EXTENSION_CHUNK_TYPES$1.JSON){const at=new Uint8Array(_e,BINARY_EXTENSION_HEADER_LENGTH$1+st,ot);this.content=LoaderUtils.decodeText(at)}else if(lt===BINARY_EXTENSION_CHUNK_TYPES$1.BIN){const at=BINARY_EXTENSION_HEADER_LENGTH$1+st;this.body=_e.slice(at,at+ot)}st+=ot}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},GLTFDracoMeshCompressionExtension$1=class{constructor(_e,rt){if(!rt)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION,this.json=_e,this.dracoLoader=rt,this.dracoLoader.preload()}decodePrimitive(_e,rt){const nt=this.json,it=this.dracoLoader,st=_e.extensions[this.name].bufferView,ot=_e.extensions[this.name].attributes,lt={},at={},ct={};for(const ut in ot){const ht=ATTRIBUTES$1[ut]||ut.toLowerCase();lt[ht]=ot[ut]}for(const ut in _e.attributes){const ht=ATTRIBUTES$1[ut]||ut.toLowerCase();if(ot[ut]!==void 0){const dt=nt.accessors[_e.attributes[ut]],ft=WEBGL_COMPONENT_TYPES$1[dt.componentType];ct[ht]=ft.name,at[ht]=dt.normalized===!0}}return rt.getDependency("bufferView",st).then(function(ut){return new Promise(function(ht){it.decodeDracoFile(ut,function(dt){for(const ft in dt.attributes){const pt=dt.attributes[ft],mt=at[ft];mt!==void 0&&(pt.normalized=mt)}ht(dt)},lt,ct)})})}},GLTFTextureTransformExtension$1=class{constructor(){this.name=EXTENSIONS$1.KHR_TEXTURE_TRANSFORM}extendTexture(_e,rt){return(rt.texCoord===void 0||rt.texCoord===_e.channel)&&rt.offset===void 0&&rt.rotation===void 0&&rt.scale===void 0||(_e=_e.clone(),rt.texCoord!==void 0&&(_e.channel=rt.texCoord),rt.offset!==void 0&&_e.offset.fromArray(rt.offset),rt.rotation!==void 0&&(_e.rotation=rt.rotation),rt.scale!==void 0&&_e.repeat.fromArray(rt.scale),_e.needsUpdate=!0),_e}},GLTFMeshQuantizationExtension$1=class{constructor(){this.name=EXTENSIONS$1.KHR_MESH_QUANTIZATION}},GLTFCubicSplineInterpolant$1=class extends Interpolant{constructor(_e,rt,nt,it){super(_e,rt,nt,it)}copySampleValue_(_e){const rt=this.resultBuffer,nt=this.sampleValues,it=this.valueSize,st=_e*it*3+it;for(let ot=0;ot!==it;ot++)rt[ot]=nt[st+ot];return rt}interpolate_(_e,rt,nt,it){const st=this.resultBuffer,ot=this.sampleValues,lt=this.valueSize,at=lt*2,ct=lt*3,ut=it-rt,ht=(nt-rt)/ut,dt=ht*ht,ft=dt*ht,pt=_e*ct,mt=pt-ct,gt=-2*ft+3*dt,vt=ft-dt,At=1-gt,yt=vt-dt+ht;for(let xt=0;xt!==lt;xt++){const _t=ot[mt+xt+lt],Et=ot[mt+xt+at]*ut,bt=ot[pt+xt+lt],wt=ot[pt+xt]*ut;st[xt]=At*_t+yt*Et+gt*bt+vt*wt}return st}};const _q$1=new Quaternion;let GLTFCubicSplineQuaternionInterpolant$1=class extends GLTFCubicSplineInterpolant$1{interpolate_(_e,rt,nt,it){const st=super.interpolate_(_e,rt,nt,it);return _q$1.fromArray(st).normalize().toArray(st),st}};const WEBGL_CONSTANTS$1={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES$1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS$1={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS$1={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES$1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES$1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...REVISION.replace(/\D+/g,"")>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES$1={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION$1={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES$1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial$1(tt){return tt.DefaultMaterial===void 0&&(tt.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),tt.DefaultMaterial}function addUnknownExtensionsToUserData$1(tt,_e,rt){for(const nt in rt.extensions)tt[nt]===void 0&&(_e.userData.gltfExtensions=_e.userData.gltfExtensions||{},_e.userData.gltfExtensions[nt]=rt.extensions[nt])}function assignExtrasToUserData$1(tt,_e){_e.extras!==void 0&&(typeof _e.extras=="object"?Object.assign(tt.userData,_e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_e.extras))}function addMorphTargets$1(tt,_e,rt){let nt=!1,it=!1,st=!1;for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(ht.POSITION!==void 0&&(nt=!0),ht.NORMAL!==void 0&&(it=!0),ht.COLOR_0!==void 0&&(st=!0),nt&&it&&st)break}if(!nt&&!it&&!st)return Promise.resolve(tt);const ot=[],lt=[],at=[];for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(nt){const dt=ht.POSITION!==void 0?rt.getDependency("accessor",ht.POSITION):tt.attributes.position;ot.push(dt)}if(it){const dt=ht.NORMAL!==void 0?rt.getDependency("accessor",ht.NORMAL):tt.attributes.normal;lt.push(dt)}if(st){const dt=ht.COLOR_0!==void 0?rt.getDependency("accessor",ht.COLOR_0):tt.attributes.color;at.push(dt)}}return Promise.all([Promise.all(ot),Promise.all(lt),Promise.all(at)]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];return nt&&(tt.morphAttributes.position=ut),it&&(tt.morphAttributes.normal=ht),st&&(tt.morphAttributes.color=dt),tt.morphTargetsRelative=!0,tt})}function updateMorphTargets$1(tt,_e){if(tt.updateMorphTargets(),_e.weights!==void 0)for(let rt=0,nt=_e.weights.length;rt<nt;rt++)tt.morphTargetInfluences[rt]=_e.weights[rt];if(_e.extras&&Array.isArray(_e.extras.targetNames)){const rt=_e.extras.targetNames;if(tt.morphTargetInfluences.length===rt.length){tt.morphTargetDictionary={};for(let nt=0,it=rt.length;nt<it;nt++)tt.morphTargetDictionary[rt[nt]]=nt}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey$1(tt){let _e;const rt=tt.extensions&&tt.extensions[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION];if(rt?_e="draco:"+rt.bufferView+":"+rt.indices+":"+createAttributesKey$1(rt.attributes):_e=tt.indices+":"+createAttributesKey$1(tt.attributes)+":"+tt.mode,tt.targets!==void 0)for(let nt=0,it=tt.targets.length;nt<it;nt++)_e+=":"+createAttributesKey$1(tt.targets[nt]);return _e}function createAttributesKey$1(tt){let _e="";const rt=Object.keys(tt).sort();for(let nt=0,it=rt.length;nt<it;nt++)_e+=rt[nt]+":"+tt[rt[nt]]+";";return _e}function getNormalizedComponentScale$1(tt){switch(tt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType$1(tt){return tt.search(/\.jpe?g($|\?)/i)>0||tt.search(/^data\:image\/jpeg/)===0?"image/jpeg":tt.search(/\.webp($|\?)/i)>0||tt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix$1=new Matrix4;let GLTFParser$1=class{constructor(_e={},rt={}){this.json=_e,this.extensions={},this.plugins={},this.options=rt,this.cache=new GLTFRegistry$1,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let nt=!1,it=!1,st=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(nt=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,it=navigator.userAgent.indexOf("Firefox")>-1,st=it?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||nt||it&&st<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_e){this.extensions=_e}setPlugins(_e){this.plugins=_e}parse(_e,rt){const nt=this,it=this.json,st=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(ot){return ot._markDefs&&ot._markDefs()}),Promise.all(this._invokeAll(function(ot){return ot.beforeRoot&&ot.beforeRoot()})).then(function(){return Promise.all([nt.getDependencies("scene"),nt.getDependencies("animation"),nt.getDependencies("camera")])}).then(function(ot){const lt={scene:ot[0][it.scene||0],scenes:ot[0],animations:ot[1],cameras:ot[2],asset:it.asset,parser:nt,userData:{}};addUnknownExtensionsToUserData$1(st,lt,it),assignExtrasToUserData$1(lt,it),Promise.all(nt._invokeAll(function(at){return at.afterRoot&&at.afterRoot(lt)})).then(function(){_e(lt)})}).catch(rt)}_markDefs(){const _e=this.json.nodes||[],rt=this.json.skins||[],nt=this.json.meshes||[];for(let it=0,st=rt.length;it<st;it++){const ot=rt[it].joints;for(let lt=0,at=ot.length;lt<at;lt++)_e[ot[lt]].isBone=!0}for(let it=0,st=_e.length;it<st;it++){const ot=_e[it];ot.mesh!==void 0&&(this._addNodeRef(this.meshCache,ot.mesh),ot.skin!==void 0&&(nt[ot.mesh].isSkinnedMesh=!0)),ot.camera!==void 0&&this._addNodeRef(this.cameraCache,ot.camera)}}_addNodeRef(_e,rt){rt!==void 0&&(_e.refs[rt]===void 0&&(_e.refs[rt]=_e.uses[rt]=0),_e.refs[rt]++)}_getNodeRef(_e,rt,nt){if(_e.refs[rt]<=1)return nt;const it=nt.clone(),st=(ot,lt)=>{const at=this.associations.get(ot);at!=null&&this.associations.set(lt,at);for(const[ct,ut]of ot.children.entries())st(ut,lt.children[ct])};return st(nt,it),it.name+="_instance_"+_e.uses[rt]++,it}_invokeOne(_e){const rt=Object.values(this.plugins);rt.push(this);for(let nt=0;nt<rt.length;nt++){const it=_e(rt[nt]);if(it)return it}return null}_invokeAll(_e){const rt=Object.values(this.plugins);rt.unshift(this);const nt=[];for(let it=0;it<rt.length;it++){const st=_e(rt[it]);st&&nt.push(st)}return nt}getDependency(_e,rt){const nt=_e+":"+rt;let it=this.cache.get(nt);if(!it){switch(_e){case"scene":it=this.loadScene(rt);break;case"node":it=this._invokeOne(function(st){return st.loadNode&&st.loadNode(rt)});break;case"mesh":it=this._invokeOne(function(st){return st.loadMesh&&st.loadMesh(rt)});break;case"accessor":it=this.loadAccessor(rt);break;case"bufferView":it=this._invokeOne(function(st){return st.loadBufferView&&st.loadBufferView(rt)});break;case"buffer":it=this.loadBuffer(rt);break;case"material":it=this._invokeOne(function(st){return st.loadMaterial&&st.loadMaterial(rt)});break;case"texture":it=this._invokeOne(function(st){return st.loadTexture&&st.loadTexture(rt)});break;case"skin":it=this.loadSkin(rt);break;case"animation":it=this._invokeOne(function(st){return st.loadAnimation&&st.loadAnimation(rt)});break;case"camera":it=this.loadCamera(rt);break;default:if(it=this._invokeOne(function(st){return st!=this&&st.getDependency&&st.getDependency(_e,rt)}),!it)throw new Error("Unknown type: "+_e);break}this.cache.add(nt,it)}return it}getDependencies(_e){let rt=this.cache.get(_e);if(!rt){const nt=this,it=this.json[_e+(_e==="mesh"?"es":"s")]||[];rt=Promise.all(it.map(function(st,ot){return nt.getDependency(_e,ot)})),this.cache.add(_e,rt)}return rt}loadBuffer(_e){const rt=this.json.buffers[_e],nt=this.fileLoader;if(rt.type&&rt.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+rt.type+" buffer type is not supported.");if(rt.uri===void 0&&_e===0)return Promise.resolve(this.extensions[EXTENSIONS$1.KHR_BINARY_GLTF].body);const it=this.options;return new Promise(function(st,ot){nt.load(LoaderUtils.resolveURL(rt.uri,it.path),st,void 0,function(){ot(new Error('THREE.GLTFLoader: Failed to load buffer "'+rt.uri+'".'))})})}loadBufferView(_e){const rt=this.json.bufferViews[_e];return this.getDependency("buffer",rt.buffer).then(function(nt){const it=rt.byteLength||0,st=rt.byteOffset||0;return nt.slice(st,st+it)})}loadAccessor(_e){const rt=this,nt=this.json,it=this.json.accessors[_e];if(it.bufferView===void 0&&it.sparse===void 0){const ot=WEBGL_TYPE_SIZES$1[it.type],lt=WEBGL_COMPONENT_TYPES$1[it.componentType],at=it.normalized===!0,ct=new lt(it.count*ot);return Promise.resolve(new BufferAttribute(ct,ot,at))}const st=[];return it.bufferView!==void 0?st.push(this.getDependency("bufferView",it.bufferView)):st.push(null),it.sparse!==void 0&&(st.push(this.getDependency("bufferView",it.sparse.indices.bufferView)),st.push(this.getDependency("bufferView",it.sparse.values.bufferView))),Promise.all(st).then(function(ot){const lt=ot[0],at=WEBGL_TYPE_SIZES$1[it.type],ct=WEBGL_COMPONENT_TYPES$1[it.componentType],ut=ct.BYTES_PER_ELEMENT,ht=ut*at,dt=it.byteOffset||0,ft=it.bufferView!==void 0?nt.bufferViews[it.bufferView].byteStride:void 0,pt=it.normalized===!0;let mt,gt;if(ft&&ft!==ht){const vt=Math.floor(dt/ft),At="InterleavedBuffer:"+it.bufferView+":"+it.componentType+":"+vt+":"+it.count;let yt=rt.cache.get(At);yt||(mt=new ct(lt,vt*ft,it.count*ft/ut),yt=new InterleavedBuffer(mt,ft/ut),rt.cache.add(At,yt)),gt=new InterleavedBufferAttribute(yt,at,dt%ft/ut,pt)}else lt===null?mt=new ct(it.count*at):mt=new ct(lt,dt,it.count*at),gt=new BufferAttribute(mt,at,pt);if(it.sparse!==void 0){const vt=WEBGL_TYPE_SIZES$1.SCALAR,At=WEBGL_COMPONENT_TYPES$1[it.sparse.indices.componentType],yt=it.sparse.indices.byteOffset||0,xt=it.sparse.values.byteOffset||0,_t=new At(ot[1],yt,it.sparse.count*vt),Et=new ct(ot[2],xt,it.sparse.count*at);lt!==null&&(gt=new BufferAttribute(gt.array.slice(),gt.itemSize,gt.normalized));for(let bt=0,wt=_t.length;bt<wt;bt++){const Tt=_t[bt];if(gt.setX(Tt,Et[bt*at]),at>=2&&gt.setY(Tt,Et[bt*at+1]),at>=3&&gt.setZ(Tt,Et[bt*at+2]),at>=4&&gt.setW(Tt,Et[bt*at+3]),at>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return gt})}loadTexture(_e){const rt=this.json,nt=this.options,st=rt.textures[_e].source,ot=rt.images[st];let lt=this.textureLoader;if(ot.uri){const at=nt.manager.getHandler(ot.uri);at!==null&&(lt=at)}return this.loadTextureImage(_e,st,lt)}loadTextureImage(_e,rt,nt){const it=this,st=this.json,ot=st.textures[_e],lt=st.images[rt],at=(lt.uri||lt.bufferView)+":"+ot.sampler;if(this.textureCache[at])return this.textureCache[at];const ct=this.loadImageSource(rt,nt).then(function(ut){ut.flipY=!1,ut.name=ot.name||lt.name||"",ut.name===""&&typeof lt.uri=="string"&&lt.uri.startsWith("data:image/")===!1&&(ut.name=lt.uri);const dt=(st.samplers||{})[ot.sampler]||{};return ut.magFilter=WEBGL_FILTERS$1[dt.magFilter]||LinearFilter,ut.minFilter=WEBGL_FILTERS$1[dt.minFilter]||LinearMipmapLinearFilter,ut.wrapS=WEBGL_WRAPPINGS$1[dt.wrapS]||RepeatWrapping,ut.wrapT=WEBGL_WRAPPINGS$1[dt.wrapT]||RepeatWrapping,it.associations.set(ut,{textures:_e}),ut}).catch(function(){return null});return this.textureCache[at]=ct,ct}loadImageSource(_e,rt){const nt=this,it=this.json,st=this.options;if(this.sourceCache[_e]!==void 0)return this.sourceCache[_e].then(ht=>ht.clone());const ot=it.images[_e],lt=self.URL||self.webkitURL;let at=ot.uri||"",ct=!1;if(ot.bufferView!==void 0)at=nt.getDependency("bufferView",ot.bufferView).then(function(ht){ct=!0;const dt=new Blob([ht],{type:ot.mimeType});return at=lt.createObjectURL(dt),at});else if(ot.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_e+" is missing URI and bufferView");const ut=Promise.resolve(at).then(function(ht){return new Promise(function(dt,ft){let pt=dt;rt.isImageBitmapLoader===!0&&(pt=function(mt){const gt=new Texture(mt);gt.needsUpdate=!0,dt(gt)}),rt.load(LoaderUtils.resolveURL(ht,st.path),pt,void 0,ft)})}).then(function(ht){return ct===!0&&lt.revokeObjectURL(at),ht.userData.mimeType=ot.mimeType||getImageURIMimeType$1(ot.uri),ht}).catch(function(ht){throw console.error("THREE.GLTFLoader: Couldn't load texture",at),ht});return this.sourceCache[_e]=ut,ut}assignTexture(_e,rt,nt,it){const st=this;return this.getDependency("texture",nt.index).then(function(ot){if(!ot)return null;if(nt.texCoord!==void 0&&nt.texCoord>0&&(ot=ot.clone(),ot.channel=nt.texCoord),st.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM]){const lt=nt.extensions!==void 0?nt.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM]:void 0;if(lt){const at=st.associations.get(ot);ot=st.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM].extendTexture(ot,lt),st.associations.set(ot,at)}}return it!==void 0&&("colorSpace"in ot?ot.colorSpace=it===3001?"srgb":"srgb-linear":ot.encoding=it),_e[rt]=ot,ot})}assignFinalMaterial(_e){const rt=_e.geometry;let nt=_e.material;const it=rt.attributes.tangent===void 0,st=rt.attributes.color!==void 0,ot=rt.attributes.normal===void 0;if(_e.isPoints){const lt="PointsMaterial:"+nt.uuid;let at=this.cache.get(lt);at||(at=new PointsMaterial,Material.prototype.copy.call(at,nt),at.color.copy(nt.color),at.map=nt.map,at.sizeAttenuation=!1,this.cache.add(lt,at)),nt=at}else if(_e.isLine){const lt="LineBasicMaterial:"+nt.uuid;let at=this.cache.get(lt);at||(at=new LineBasicMaterial,Material.prototype.copy.call(at,nt),at.color.copy(nt.color),at.map=nt.map,this.cache.add(lt,at)),nt=at}if(it||st||ot){let lt="ClonedMaterial:"+nt.uuid+":";it&&(lt+="derivative-tangents:"),st&&(lt+="vertex-colors:"),ot&&(lt+="flat-shading:");let at=this.cache.get(lt);at||(at=nt.clone(),st&&(at.vertexColors=!0),ot&&(at.flatShading=!0),it&&(at.normalScale&&(at.normalScale.y*=-1),at.clearcoatNormalScale&&(at.clearcoatNormalScale.y*=-1)),this.cache.add(lt,at),this.associations.set(at,this.associations.get(nt))),nt=at}_e.material=nt}getMaterialType(){return MeshStandardMaterial}loadMaterial(_e){const rt=this,nt=this.json,it=this.extensions,st=nt.materials[_e];let ot;const lt={},at=st.extensions||{},ct=[];if(at[EXTENSIONS$1.KHR_MATERIALS_UNLIT]){const ht=it[EXTENSIONS$1.KHR_MATERIALS_UNLIT];ot=ht.getMaterialType(),ct.push(ht.extendParams(lt,st,rt))}else{const ht=st.pbrMetallicRoughness||{};if(lt.color=new Color$1(1,1,1),lt.opacity=1,Array.isArray(ht.baseColorFactor)){const dt=ht.baseColorFactor;lt.color.fromArray(dt),lt.opacity=dt[3]}ht.baseColorTexture!==void 0&&ct.push(rt.assignTexture(lt,"map",ht.baseColorTexture,3001)),lt.metalness=ht.metallicFactor!==void 0?ht.metallicFactor:1,lt.roughness=ht.roughnessFactor!==void 0?ht.roughnessFactor:1,ht.metallicRoughnessTexture!==void 0&&(ct.push(rt.assignTexture(lt,"metalnessMap",ht.metallicRoughnessTexture)),ct.push(rt.assignTexture(lt,"roughnessMap",ht.metallicRoughnessTexture))),ot=this._invokeOne(function(dt){return dt.getMaterialType&&dt.getMaterialType(_e)}),ct.push(Promise.all(this._invokeAll(function(dt){return dt.extendMaterialParams&&dt.extendMaterialParams(_e,lt)})))}st.doubleSided===!0&&(lt.side=DoubleSide);const ut=st.alphaMode||ALPHA_MODES$1.OPAQUE;if(ut===ALPHA_MODES$1.BLEND?(lt.transparent=!0,lt.depthWrite=!1):(lt.transparent=!1,ut===ALPHA_MODES$1.MASK&&(lt.alphaTest=st.alphaCutoff!==void 0?st.alphaCutoff:.5)),st.normalTexture!==void 0&&ot!==MeshBasicMaterial&&(ct.push(rt.assignTexture(lt,"normalMap",st.normalTexture)),lt.normalScale=new Vector2(1,1),st.normalTexture.scale!==void 0)){const ht=st.normalTexture.scale;lt.normalScale.set(ht,ht)}return st.occlusionTexture!==void 0&&ot!==MeshBasicMaterial&&(ct.push(rt.assignTexture(lt,"aoMap",st.occlusionTexture)),st.occlusionTexture.strength!==void 0&&(lt.aoMapIntensity=st.occlusionTexture.strength)),st.emissiveFactor!==void 0&&ot!==MeshBasicMaterial&&(lt.emissive=new Color$1().fromArray(st.emissiveFactor)),st.emissiveTexture!==void 0&&ot!==MeshBasicMaterial&&ct.push(rt.assignTexture(lt,"emissiveMap",st.emissiveTexture,3001)),Promise.all(ct).then(function(){const ht=new ot(lt);return st.name&&(ht.name=st.name),assignExtrasToUserData$1(ht,st),rt.associations.set(ht,{materials:_e}),st.extensions&&addUnknownExtensionsToUserData$1(it,ht,st),ht})}createUniqueName(_e){const rt=PropertyBinding.sanitizeNodeName(_e||"");return rt in this.nodeNamesUsed?rt+"_"+ ++this.nodeNamesUsed[rt]:(this.nodeNamesUsed[rt]=0,rt)}loadGeometries(_e){const rt=this,nt=this.extensions,it=this.primitiveCache;function st(lt){return nt[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(lt,rt).then(function(at){return addPrimitiveAttributes$1(at,lt,rt)})}const ot=[];for(let lt=0,at=_e.length;lt<at;lt++){const ct=_e[lt],ut=createPrimitiveKey$1(ct),ht=it[ut];if(ht)ot.push(ht.promise);else{let dt;ct.extensions&&ct.extensions[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION]?dt=st(ct):dt=addPrimitiveAttributes$1(new BufferGeometry,ct,rt),it[ut]={primitive:ct,promise:dt},ot.push(dt)}}return Promise.all(ot)}loadMesh(_e){const rt=this,nt=this.json,it=this.extensions,st=nt.meshes[_e],ot=st.primitives,lt=[];for(let at=0,ct=ot.length;at<ct;at++){const ut=ot[at].material===void 0?createDefaultMaterial$1(this.cache):this.getDependency("material",ot[at].material);lt.push(ut)}return lt.push(rt.loadGeometries(ot)),Promise.all(lt).then(function(at){const ct=at.slice(0,at.length-1),ut=at[at.length-1],ht=[];for(let ft=0,pt=ut.length;ft<pt;ft++){const mt=ut[ft],gt=ot[ft];let vt;const At=ct[ft];if(gt.mode===WEBGL_CONSTANTS$1.TRIANGLES||gt.mode===WEBGL_CONSTANTS$1.TRIANGLE_STRIP||gt.mode===WEBGL_CONSTANTS$1.TRIANGLE_FAN||gt.mode===void 0)vt=st.isSkinnedMesh===!0?new SkinnedMesh(mt,At):new Mesh(mt,At),vt.isSkinnedMesh===!0&&vt.normalizeSkinWeights(),gt.mode===WEBGL_CONSTANTS$1.TRIANGLE_STRIP?vt.geometry=toTrianglesDrawMode$1(vt.geometry,TriangleStripDrawMode):gt.mode===WEBGL_CONSTANTS$1.TRIANGLE_FAN&&(vt.geometry=toTrianglesDrawMode$1(vt.geometry,TriangleFanDrawMode));else if(gt.mode===WEBGL_CONSTANTS$1.LINES)vt=new LineSegments(mt,At);else if(gt.mode===WEBGL_CONSTANTS$1.LINE_STRIP)vt=new Line(mt,At);else if(gt.mode===WEBGL_CONSTANTS$1.LINE_LOOP)vt=new LineLoop(mt,At);else if(gt.mode===WEBGL_CONSTANTS$1.POINTS)vt=new Points(mt,At);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+gt.mode);Object.keys(vt.geometry.morphAttributes).length>0&&updateMorphTargets$1(vt,st),vt.name=rt.createUniqueName(st.name||"mesh_"+_e),assignExtrasToUserData$1(vt,st),gt.extensions&&addUnknownExtensionsToUserData$1(it,vt,gt),rt.assignFinalMaterial(vt),ht.push(vt)}for(let ft=0,pt=ht.length;ft<pt;ft++)rt.associations.set(ht[ft],{meshes:_e,primitives:ft});if(ht.length===1)return st.extensions&&addUnknownExtensionsToUserData$1(it,ht[0],st),ht[0];const dt=new Group;st.extensions&&addUnknownExtensionsToUserData$1(it,dt,st),rt.associations.set(dt,{meshes:_e});for(let ft=0,pt=ht.length;ft<pt;ft++)dt.add(ht[ft]);return dt})}loadCamera(_e){let rt;const nt=this.json.cameras[_e],it=nt[nt.type];if(!it){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return nt.type==="perspective"?rt=new PerspectiveCamera(MathUtils.radToDeg(it.yfov),it.aspectRatio||1,it.znear||1,it.zfar||2e6):nt.type==="orthographic"&&(rt=new OrthographicCamera(-it.xmag,it.xmag,it.ymag,-it.ymag,it.znear,it.zfar)),nt.name&&(rt.name=this.createUniqueName(nt.name)),assignExtrasToUserData$1(rt,nt),Promise.resolve(rt)}loadSkin(_e){const rt=this.json.skins[_e],nt=[];for(let it=0,st=rt.joints.length;it<st;it++)nt.push(this._loadNodeShallow(rt.joints[it]));return rt.inverseBindMatrices!==void 0?nt.push(this.getDependency("accessor",rt.inverseBindMatrices)):nt.push(null),Promise.all(nt).then(function(it){const st=it.pop(),ot=it,lt=[],at=[];for(let ct=0,ut=ot.length;ct<ut;ct++){const ht=ot[ct];if(ht){lt.push(ht);const dt=new Matrix4;st!==null&&dt.fromArray(st.array,ct*16),at.push(dt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',rt.joints[ct])}return new Skeleton(lt,at)})}loadAnimation(_e){const nt=this.json.animations[_e],it=nt.name?nt.name:"animation_"+_e,st=[],ot=[],lt=[],at=[],ct=[];for(let ut=0,ht=nt.channels.length;ut<ht;ut++){const dt=nt.channels[ut],ft=nt.samplers[dt.sampler],pt=dt.target,mt=pt.node,gt=nt.parameters!==void 0?nt.parameters[ft.input]:ft.input,vt=nt.parameters!==void 0?nt.parameters[ft.output]:ft.output;pt.node!==void 0&&(st.push(this.getDependency("node",mt)),ot.push(this.getDependency("accessor",gt)),lt.push(this.getDependency("accessor",vt)),at.push(ft),ct.push(pt))}return Promise.all([Promise.all(st),Promise.all(ot),Promise.all(lt),Promise.all(at),Promise.all(ct)]).then(function(ut){const ht=ut[0],dt=ut[1],ft=ut[2],pt=ut[3],mt=ut[4],gt=[];for(let vt=0,At=ht.length;vt<At;vt++){const yt=ht[vt],xt=dt[vt],_t=ft[vt],Et=pt[vt],bt=mt[vt];if(yt===void 0)continue;yt.updateMatrix();let wt;switch(PATH_PROPERTIES$1[bt.path]){case PATH_PROPERTIES$1.weights:wt=NumberKeyframeTrack;break;case PATH_PROPERTIES$1.rotation:wt=QuaternionKeyframeTrack;break;case PATH_PROPERTIES$1.position:case PATH_PROPERTIES$1.scale:default:wt=VectorKeyframeTrack;break}const Tt=yt.name?yt.name:yt.uuid,Mt=Et.interpolation!==void 0?INTERPOLATION$1[Et.interpolation]:InterpolateLinear,Pt=[];PATH_PROPERTIES$1[bt.path]===PATH_PROPERTIES$1.weights?yt.traverse(function(Ot){Ot.morphTargetInfluences&&Pt.push(Ot.name?Ot.name:Ot.uuid)}):Pt.push(Tt);let It=_t.array;if(_t.normalized){const Ot=getNormalizedComponentScale$1(It.constructor),Bt=new Float32Array(It.length);for(let Ut=0,Ft=It.length;Ut<Ft;Ut++)Bt[Ut]=It[Ut]*Ot;It=Bt}for(let Ot=0,Bt=Pt.length;Ot<Bt;Ot++){const Ut=new wt(Pt[Ot]+"."+PATH_PROPERTIES$1[bt.path],xt.array,It,Mt);Et.interpolation==="CUBICSPLINE"&&(Ut.createInterpolant=function(jt){const Dt=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant$1:GLTFCubicSplineInterpolant$1;return new Dt(this.times,this.values,this.getValueSize()/3,jt)},Ut.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),gt.push(Ut)}}return new AnimationClip(it,void 0,gt)})}createNodeMesh(_e){const rt=this.json,nt=this,it=rt.nodes[_e];return it.mesh===void 0?null:nt.getDependency("mesh",it.mesh).then(function(st){const ot=nt._getNodeRef(nt.meshCache,it.mesh,st);return it.weights!==void 0&&ot.traverse(function(lt){if(lt.isMesh)for(let at=0,ct=it.weights.length;at<ct;at++)lt.morphTargetInfluences[at]=it.weights[at]}),ot})}loadNode(_e){const rt=this.json,nt=this,it=rt.nodes[_e],st=nt._loadNodeShallow(_e),ot=[],lt=it.children||[];for(let ct=0,ut=lt.length;ct<ut;ct++)ot.push(nt.getDependency("node",lt[ct]));const at=it.skin===void 0?Promise.resolve(null):nt.getDependency("skin",it.skin);return Promise.all([st,Promise.all(ot),at]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];dt!==null&&ut.traverse(function(ft){ft.isSkinnedMesh&&ft.bind(dt,_identityMatrix$1)});for(let ft=0,pt=ht.length;ft<pt;ft++)ut.add(ht[ft]);return ut})}_loadNodeShallow(_e){const rt=this.json,nt=this.extensions,it=this;if(this.nodeCache[_e]!==void 0)return this.nodeCache[_e];const st=rt.nodes[_e],ot=st.name?it.createUniqueName(st.name):"",lt=[],at=it._invokeOne(function(ct){return ct.createNodeMesh&&ct.createNodeMesh(_e)});return at&&lt.push(at),st.camera!==void 0&&lt.push(it.getDependency("camera",st.camera).then(function(ct){return it._getNodeRef(it.cameraCache,st.camera,ct)})),it._invokeAll(function(ct){return ct.createNodeAttachment&&ct.createNodeAttachment(_e)}).forEach(function(ct){lt.push(ct)}),this.nodeCache[_e]=Promise.all(lt).then(function(ct){let ut;if(st.isBone===!0?ut=new Bone:ct.length>1?ut=new Group:ct.length===1?ut=ct[0]:ut=new Object3D,ut!==ct[0])for(let ht=0,dt=ct.length;ht<dt;ht++)ut.add(ct[ht]);if(st.name&&(ut.userData.name=st.name,ut.name=ot),assignExtrasToUserData$1(ut,st),st.extensions&&addUnknownExtensionsToUserData$1(nt,ut,st),st.matrix!==void 0){const ht=new Matrix4;ht.fromArray(st.matrix),ut.applyMatrix4(ht)}else st.translation!==void 0&&ut.position.fromArray(st.translation),st.rotation!==void 0&&ut.quaternion.fromArray(st.rotation),st.scale!==void 0&&ut.scale.fromArray(st.scale);return it.associations.has(ut)||it.associations.set(ut,{}),it.associations.get(ut).nodes=_e,ut}),this.nodeCache[_e]}loadScene(_e){const rt=this.extensions,nt=this.json.scenes[_e],it=this,st=new Group;nt.name&&(st.name=it.createUniqueName(nt.name)),assignExtrasToUserData$1(st,nt),nt.extensions&&addUnknownExtensionsToUserData$1(rt,st,nt);const ot=nt.nodes||[],lt=[];for(let at=0,ct=ot.length;at<ct;at++)lt.push(it.getDependency("node",ot[at]));return Promise.all(lt).then(function(at){for(let ut=0,ht=at.length;ut<ht;ut++)st.add(at[ut]);const ct=ut=>{const ht=new Map;for(const[dt,ft]of it.associations)(dt instanceof Material||dt instanceof Texture)&&ht.set(dt,ft);return ut.traverse(dt=>{const ft=it.associations.get(dt);ft!=null&&ht.set(dt,ft)}),ht};return it.associations=ct(st),st})}};function computeBounds$1(tt,_e,rt){const nt=_e.attributes,it=new Box3;if(nt.POSITION!==void 0){const lt=rt.json.accessors[nt.POSITION],at=lt.min,ct=lt.max;if(at!==void 0&&ct!==void 0){if(it.set(new Vector3(at[0],at[1],at[2]),new Vector3(ct[0],ct[1],ct[2])),lt.normalized){const ut=getNormalizedComponentScale$1(WEBGL_COMPONENT_TYPES$1[lt.componentType]);it.min.multiplyScalar(ut),it.max.multiplyScalar(ut)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const st=_e.targets;if(st!==void 0){const lt=new Vector3,at=new Vector3;for(let ct=0,ut=st.length;ct<ut;ct++){const ht=st[ct];if(ht.POSITION!==void 0){const dt=rt.json.accessors[ht.POSITION],ft=dt.min,pt=dt.max;if(ft!==void 0&&pt!==void 0){if(at.setX(Math.max(Math.abs(ft[0]),Math.abs(pt[0]))),at.setY(Math.max(Math.abs(ft[1]),Math.abs(pt[1]))),at.setZ(Math.max(Math.abs(ft[2]),Math.abs(pt[2]))),dt.normalized){const mt=getNormalizedComponentScale$1(WEBGL_COMPONENT_TYPES$1[dt.componentType]);at.multiplyScalar(mt)}lt.max(at)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}it.expandByVector(lt)}tt.boundingBox=it;const ot=new Sphere;it.getCenter(ot.center),ot.radius=it.min.distanceTo(it.max)/2,tt.boundingSphere=ot}function addPrimitiveAttributes$1(tt,_e,rt){const nt=_e.attributes,it=[];function st(ot,lt){return rt.getDependency("accessor",ot).then(function(at){tt.setAttribute(lt,at)})}for(const ot in nt){const lt=ATTRIBUTES$1[ot]||ot.toLowerCase();lt in tt.attributes||it.push(st(nt[ot],lt))}if(_e.indices!==void 0&&!tt.index){const ot=rt.getDependency("accessor",_e.indices).then(function(lt){tt.setIndex(lt)});it.push(ot)}return assignExtrasToUserData$1(tt,_e),computeBounds$1(tt,_e,rt),Promise.all(it).then(function(){return _e.targets!==void 0?addMorphTargets$1(tt,_e.targets,rt):tt})}const _VRButton=class{static createButton(tt,_e={}){const rt=document.createElement("button");function nt(){let lt=null;async function at(ut){ut.addEventListener("end",ct),await tt.xr.setSession(ut),rt.textContent="EXIT VR",lt=ut}function ct(){lt.removeEventListener("end",ct),rt.textContent="ENTER VR",lt=null}rt.style.display="",rt.style.cursor="pointer",rt.style.left="calc(50% - 50px)",rt.style.width="100px",rt.textContent="ENTER VR",rt.onmouseenter=()=>{rt.style.opacity="1.0"},rt.onmouseleave=()=>{rt.style.opacity="0.5"},rt.onclick=()=>{var ut;if(lt===null){const ht=[_e.optionalFeatures,"local-floor","bounded-floor","hand-tracking"].flat().filter(Boolean);(ut=navigator.xr)==null||ut.requestSession("immersive-vr",{..._e,optionalFeatures:ht}).then(at)}else lt.end()}}function it(){rt.style.display="",rt.style.cursor="auto",rt.style.left="calc(50% - 75px)",rt.style.width="150px",rt.onmouseenter=null,rt.onmouseleave=null,rt.onclick=null}function st(){it(),rt.textContent="VR NOT SUPPORTED"}function ot(lt){lt.style.position="absolute",lt.style.bottom="20px",lt.style.padding="12px 6px",lt.style.border="1px solid #fff",lt.style.borderRadius="4px",lt.style.background="rgba(0,0,0,0.1)",lt.style.color="#fff",lt.style.font="normal 13px sans-serif",lt.style.textAlign="center",lt.style.opacity="0.5",lt.style.outline="none",lt.style.zIndex="999"}if("xr"in navigator)return ot(rt),rt.id="VRButton",rt.style.display="none",navigator.xr.isSessionSupported("immersive-vr").then(lt=>{lt?nt():st(),lt&&_VRButton.xrSessionIsGranted&&rt.click()}),rt;{const lt=document.createElement("a");return window.isSecureContext===!1?(lt.href=document.location.href.replace(/^http:/,"https:"),lt.innerHTML="WEBXR NEEDS HTTPS"):(lt.href="https://immersiveweb.dev/",lt.innerHTML="WEBXR NOT AVAILABLE"),lt.style.left="calc(50% - 90px)",lt.style.width="180px",lt.style.textDecoration="none",ot(lt),lt}}static registerSessionGrantedListener(){"xr"in navigator&&navigator.xr.addEventListener("sessiongranted",()=>{_VRButton.xrSessionIsGranted=!0})}};let VRButton=_VRButton;__publicField(VRButton,"xrSessionIsGranted",!1);const MotionControllerConstants={Handedness:{NONE:"none",LEFT:"left",RIGHT:"right"},ComponentState:{DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"},ComponentProperty:{BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"},ComponentType:{TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"},ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:{TRANSFORM:"transform",VISIBILITY:"visibility"}};async function fetchJsonFile(tt){const _e=await fetch(tt);if(_e.ok)return _e.json();throw new Error(_e.statusText)}async function fetchProfilesList(tt){if(!tt)throw new Error("No basePath supplied");return await fetchJsonFile(`${tt}/profilesList.json`)}async function fetchProfile(tt,_e,rt=null,nt=!0){if(!tt)throw new Error("No xrInputSource supplied");if(!_e)throw new Error("No basePath supplied");const it=await fetchProfilesList(_e);let st;if(tt.profiles.some(at=>{const ct=it[at];return ct&&(st={profileId:at,profilePath:`${_e}/${ct.path}`,deprecated:!!ct.deprecated}),!!st}),!st){if(!rt)throw new Error("No matching profile name found");const at=it[rt];if(!at)throw new Error(`No matching profile name found and default profile "${rt}" missing.`);st={profileId:rt,profilePath:`${_e}/${at.path}`,deprecated:!!at.deprecated}}const ot=await fetchJsonFile(st.profilePath);let lt;if(nt){let at;if(tt.handedness==="any"?at=ot.layouts[Object.keys(ot.layouts)[0]]:at=ot.layouts[tt.handedness],!at)throw new Error(`No matching handedness, ${tt.handedness}, in profile ${st.profileId}`);at.assetPath&&(lt=st.profilePath.replace("profile.json",at.assetPath))}return{profile:ot,assetPath:lt}}const defaultComponentValues={xAxis:0,yAxis:0,button:0,state:MotionControllerConstants.ComponentState.DEFAULT};function normalizeAxes(tt=0,_e=0){let rt=tt,nt=_e;if(Math.sqrt(tt*tt+_e*_e)>1){const ot=Math.atan2(_e,tt);rt=Math.cos(ot),nt=Math.sin(ot)}return{normalizedXAxis:rt*.5+.5,normalizedYAxis:nt*.5+.5}}class VisualResponse{constructor(_e){__publicField(this,"value"),__publicField(this,"componentProperty"),__publicField(this,"states"),__publicField(this,"valueNodeName"),__publicField(this,"valueNodeProperty"),__publicField(this,"minNodeName"),__publicField(this,"maxNodeName"),__publicField(this,"valueNode"),__publicField(this,"minNode"),__publicField(this,"maxNode"),this.componentProperty=_e.componentProperty,this.states=_e.states,this.valueNodeName=_e.valueNodeName,this.valueNodeProperty=_e.valueNodeProperty,this.valueNodeProperty===MotionControllerConstants.VisualResponseProperty.TRANSFORM&&(this.minNodeName=_e.minNodeName,this.maxNodeName=_e.maxNodeName),this.value=0,this.updateFromComponent(defaultComponentValues)}updateFromComponent({xAxis:_e,yAxis:rt,button:nt,state:it}){const{normalizedXAxis:st,normalizedYAxis:ot}=normalizeAxes(_e,rt);switch(this.componentProperty){case MotionControllerConstants.ComponentProperty.X_AXIS:this.value=this.states.includes(it)?st:.5;break;case MotionControllerConstants.ComponentProperty.Y_AXIS:this.value=this.states.includes(it)?ot:.5;break;case MotionControllerConstants.ComponentProperty.BUTTON:this.value=this.states.includes(it)&&nt?nt:0;break;case MotionControllerConstants.ComponentProperty.STATE:this.valueNodeProperty===MotionControllerConstants.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(it):this.value=this.states.includes(it)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class Component{constructor(_e,rt){if(__publicField(this,"id"),__publicField(this,"values"),__publicField(this,"type"),__publicField(this,"gamepadIndices"),__publicField(this,"rootNodeName"),__publicField(this,"visualResponses"),__publicField(this,"touchPointNodeName"),__publicField(this,"touchPointNode"),!_e||!rt||!rt.visualResponses||!rt.gamepadIndices||Object.keys(rt.gamepadIndices).length===0)throw new Error("Invalid arguments supplied");this.id=_e,this.type=rt.type,this.rootNodeName=rt.rootNodeName,this.touchPointNodeName=rt.touchPointNodeName,this.visualResponses={},Object.keys(rt.visualResponses).forEach(nt=>{const it=new VisualResponse(rt.visualResponses[nt]);this.visualResponses[nt]=it}),this.gamepadIndices=Object.assign({},rt.gamepadIndices),this.values={state:MotionControllerConstants.ComponentState.DEFAULT,button:this.gamepadIndices.button!==void 0?0:void 0,xAxis:this.gamepadIndices.xAxis!==void 0?0:void 0,yAxis:this.gamepadIndices.yAxis!==void 0?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(_e){if(this.values.state=MotionControllerConstants.ComponentState.DEFAULT,this.gamepadIndices.button!==void 0&&_e.buttons.length>this.gamepadIndices.button){const rt=_e.buttons[this.gamepadIndices.button];this.values.button=rt.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,rt.pressed||this.values.button===1?this.values.state=MotionControllerConstants.ComponentState.PRESSED:(rt.touched||this.values.button>MotionControllerConstants.ButtonTouchThreshold)&&(this.values.state=MotionControllerConstants.ComponentState.TOUCHED)}this.gamepadIndices.xAxis!==void 0&&_e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=_e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===MotionControllerConstants.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>MotionControllerConstants.AxisTouchThreshold&&(this.values.state=MotionControllerConstants.ComponentState.TOUCHED)),this.gamepadIndices.yAxis!==void 0&&_e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=_e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===MotionControllerConstants.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>MotionControllerConstants.AxisTouchThreshold&&(this.values.state=MotionControllerConstants.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(rt=>{rt.updateFromComponent(this.values)})}}class MotionController{constructor(_e,rt,nt){if(__publicField(this,"xrInputSource"),__publicField(this,"assetUrl"),__publicField(this,"layoutDescription"),__publicField(this,"id"),__publicField(this,"components"),!_e)throw new Error("No xrInputSource supplied");if(!rt)throw new Error("No profile supplied");if(!rt.layouts[_e.handedness])throw new Error("No layout for "+_e.handedness+" handedness");this.xrInputSource=_e,this.assetUrl=nt,this.id=rt.profileId,this.layoutDescription=rt.layouts[_e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(it=>{const st=this.layoutDescription.components[it];this.components[it]=new Component(it,st)}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const _e=[];return Object.values(this.components).forEach(rt=>{_e.push(rt.data)}),_e}updateFromGamepad(){Object.values(this.components).forEach(_e=>{_e.updateFromGamepad(this.xrInputSource.gamepad)})}}class Font{constructor(_e){__publicField(this,"data"),this.data=_e}generateShapes(_e,rt=100,nt){const it=[],st={letterSpacing:0,lineHeight:1,...nt},ot=createPaths(_e,rt,this.data,st);for(let lt=0,at=ot.length;lt<at;lt++)Array.prototype.push.apply(it,ot[lt].toShapes(!1));return it}}__publicField(Font,"isFont");__publicField(Font,"type");function createPaths(tt,_e,rt,nt){const it=Array.from(tt),st=_e/rt.resolution,ot=(rt.boundingBox.yMax-rt.boundingBox.yMin+rt.underlineThickness)*st,lt=[];let at=0,ct=0;for(let ut=0;ut<it.length;ut++){const ht=it[ut];if(ht===`
`)at=0,ct-=ot*nt.lineHeight;else{const dt=createPath(ht,st,at,ct,rt);dt&&(at+=dt.offsetX+nt.letterSpacing,lt.push(dt.path))}}return lt}function createPath(tt,_e,rt,nt,it){const st=it.glyphs[tt]||it.glyphs["?"];if(!st){console.error('THREE.Font: character "'+tt+'" does not exists in font family '+it.familyName+".");return}const ot=new ShapePath;let lt,at,ct,ut,ht,dt,ft,pt;if(st.o){const mt=st._cachedOutline||(st._cachedOutline=st.o.split(" "));for(let gt=0,vt=mt.length;gt<vt;)switch(mt[gt++]){case"m":lt=parseInt(mt[gt++])*_e+rt,at=parseInt(mt[gt++])*_e+nt,ot.moveTo(lt,at);break;case"l":lt=parseInt(mt[gt++])*_e+rt,at=parseInt(mt[gt++])*_e+nt,ot.lineTo(lt,at);break;case"q":ct=parseInt(mt[gt++])*_e+rt,ut=parseInt(mt[gt++])*_e+nt,ht=parseInt(mt[gt++])*_e+rt,dt=parseInt(mt[gt++])*_e+nt,ot.quadraticCurveTo(ht,dt,ct,ut);break;case"b":ct=parseInt(mt[gt++])*_e+rt,ut=parseInt(mt[gt++])*_e+nt,ht=parseInt(mt[gt++])*_e+rt,dt=parseInt(mt[gt++])*_e+nt,ft=parseInt(mt[gt++])*_e+rt,pt=parseInt(mt[gt++])*_e+nt,ot.bezierCurveTo(ht,dt,ft,pt,ct,ut);break}}return{offsetX:st.ha*_e,path:ot}}class Data3DTexture extends Texture{constructor(_e=null,rt=1,nt=1,it=1){super(null),this.isData3DTexture=!0,this.image={data:_e,width:rt,height:nt,depth:it},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}var freeGlobal$1=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$1$1=freeGlobal$1;var freeSelf$1=typeof self=="object"&&self&&self.Object===Object&&self,root$1=freeGlobal$1$1||freeSelf$1||Function("return this")();const root$1$1=root$1;var Symbol$1$1=root$1$1.Symbol;const Symbol$2=Symbol$1$1;var objectProto$j=Object.prototype,hasOwnProperty$g=objectProto$j.hasOwnProperty,nativeObjectToString$1$1=objectProto$j.toString,symToStringTag$1$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag$1(tt){var _e=hasOwnProperty$g.call(tt,symToStringTag$1$1),rt=tt[symToStringTag$1$1];try{tt[symToStringTag$1$1]=void 0;var nt=!0}catch{}var it=nativeObjectToString$1$1.call(tt);return nt&&(_e?tt[symToStringTag$1$1]=rt:delete tt[symToStringTag$1$1]),it}var objectProto$i=Object.prototype,nativeObjectToString$2=objectProto$i.toString;function objectToString$1(tt){return nativeObjectToString$2.call(tt)}var nullTag$1="[object Null]",undefinedTag$1="[object Undefined]",symToStringTag$2=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag$1(tt){return tt==null?tt===void 0?undefinedTag$1:nullTag$1:symToStringTag$2&&symToStringTag$2 in Object(tt)?getRawTag$1(tt):objectToString$1(tt)}function isObjectLike$1(tt){return tt!=null&&typeof tt=="object"}var symbolTag$3="[object Symbol]";function isSymbol(tt){return typeof tt=="symbol"||isObjectLike$1(tt)&&baseGetTag$1(tt)==symbolTag$3}function arrayMap(tt,_e){for(var rt=-1,nt=tt==null?0:tt.length,it=Array(nt);++rt<nt;)it[rt]=_e(tt[rt],rt,tt);return it}var isArray$2=Array.isArray;const isArray$1$1=isArray$2;var INFINITY$3=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(tt){if(typeof tt=="string")return tt;if(isArray$1$1(tt))return arrayMap(tt,baseToString)+"";if(isSymbol(tt))return symbolToString?symbolToString.call(tt):"";var _e=tt+"";return _e=="0"&&1/tt==-INFINITY$3?"-0":_e}var reWhitespace=/\s/;function trimmedEndIndex(tt){for(var _e=tt.length;_e--&&reWhitespace.test(tt.charAt(_e)););return _e}var reTrimStart=/^\s+/;function baseTrim(tt){return tt&&tt.slice(0,trimmedEndIndex(tt)+1).replace(reTrimStart,"")}function isObject$a(tt){var _e=typeof tt;return tt!=null&&(_e=="object"||_e=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(tt){if(typeof tt=="number")return tt;if(isSymbol(tt))return NAN;if(isObject$a(tt)){var _e=typeof tt.valueOf=="function"?tt.valueOf():tt;tt=isObject$a(_e)?_e+"":_e}if(typeof tt!="string")return tt===0?tt:+tt;tt=baseTrim(tt);var rt=reIsBinary.test(tt);return rt||reIsOctal.test(tt)?freeParseInt(tt.slice(2),rt?2:8):reIsBadHex.test(tt)?NAN:+tt}var INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(tt){if(!tt)return tt===0?tt:0;if(tt=toNumber(tt),tt===INFINITY$2||tt===-INFINITY$2){var _e=tt<0?-1:1;return _e*MAX_INTEGER}return tt===tt?tt:0}function toInteger(tt){var _e=toFinite(tt),rt=_e%1;return _e===_e?rt?_e-rt:_e:0}function identity$2(tt){return tt}var asyncTag$1="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag$1="[object Proxy]";function isFunction$1(tt){if(!isObject$a(tt))return!1;var _e=baseGetTag$1(tt);return _e==funcTag$2||_e==genTag$1||_e==asyncTag$1||_e==proxyTag$1}var coreJsData$1=root$1$1["__core-js_shared__"];const coreJsData$1$1=coreJsData$1;var maskSrcKey$1=function(){var tt=/[^.]+$/.exec(coreJsData$1$1&&coreJsData$1$1.keys&&coreJsData$1$1.keys.IE_PROTO||"");return tt?"Symbol(src)_1."+tt:""}();function isMasked$1(tt){return!!maskSrcKey$1&&maskSrcKey$1 in tt}var funcProto$1$1=Function.prototype,funcToString$1$1=funcProto$1$1.toString;function toSource$1(tt){if(tt!=null){try{return funcToString$1$1.call(tt)}catch{}try{return tt+""}catch{}}return""}var reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor$1=/^\[object .+?Constructor\]$/,funcProto$2=Function.prototype,objectProto$h=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$f=objectProto$h.hasOwnProperty,reIsNative$1=RegExp("^"+funcToString$2.call(hasOwnProperty$f).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$1(tt){if(!isObject$a(tt)||isMasked$1(tt))return!1;var _e=isFunction$1(tt)?reIsNative$1:reIsHostCtor$1;return _e.test(toSource$1(tt))}function getValue$3(tt,_e){return tt==null?void 0:tt[_e]}function getNative$1(tt,_e){var rt=getValue$3(tt,_e);return baseIsNative$1(rt)?rt:void 0}var WeakMap$1=getNative$1(root$1$1,"WeakMap");const WeakMap$2=WeakMap$1;var objectCreate=Object.create,baseCreate=function(){function tt(){}return function(_e){if(!isObject$a(_e))return{};if(objectCreate)return objectCreate(_e);tt.prototype=_e;var rt=new tt;return tt.prototype=void 0,rt}}();const baseCreate$1=baseCreate;function apply$1(tt,_e,rt){switch(rt.length){case 0:return tt.call(_e);case 1:return tt.call(_e,rt[0]);case 2:return tt.call(_e,rt[0],rt[1]);case 3:return tt.call(_e,rt[0],rt[1],rt[2])}return tt.apply(_e,rt)}function noop$2(){}function copyArray(tt,_e){var rt=-1,nt=tt.length;for(_e||(_e=Array(nt));++rt<nt;)_e[rt]=tt[rt];return _e}var HOT_COUNT$1=800,HOT_SPAN$1=16,nativeNow$1=Date.now;function shortOut$1(tt){var _e=0,rt=0;return function(){var nt=nativeNow$1(),it=HOT_SPAN$1-(nt-rt);if(rt=nt,it>0){if(++_e>=HOT_COUNT$1)return arguments[0]}else _e=0;return tt.apply(void 0,arguments)}}function constant$1(tt){return function(){return tt}}var defineProperty$1=function(){try{var tt=getNative$1(Object,"defineProperty");return tt({},"",{}),tt}catch{}}();const defineProperty$1$1=defineProperty$1;var baseSetToString$1=defineProperty$1$1?function(tt,_e){return defineProperty$1$1(tt,"toString",{configurable:!0,enumerable:!1,value:constant$1(_e),writable:!0})}:identity$2;const baseSetToString$1$1=baseSetToString$1;var setToString$1=shortOut$1(baseSetToString$1$1);const setToString$1$1=setToString$1;function arrayEach(tt,_e){for(var rt=-1,nt=tt==null?0:tt.length;++rt<nt&&_e(tt[rt],rt,tt)!==!1;);return tt}function baseFindIndex(tt,_e,rt,nt){for(var it=tt.length,st=rt+(nt?1:-1);nt?st--:++st<it;)if(_e(tt[st],st,tt))return st;return-1}function baseIsNaN(tt){return tt!==tt}function strictIndexOf(tt,_e,rt){for(var nt=rt-1,it=tt.length;++nt<it;)if(tt[nt]===_e)return nt;return-1}function baseIndexOf(tt,_e,rt){return _e===_e?strictIndexOf(tt,_e,rt):baseFindIndex(tt,baseIsNaN,rt)}function arrayIncludes(tt,_e){var rt=tt==null?0:tt.length;return!!rt&&baseIndexOf(tt,_e,0)>-1}var MAX_SAFE_INTEGER$1$1=9007199254740991,reIsUint$1=/^(?:0|[1-9]\d*)$/;function isIndex$1(tt,_e){var rt=typeof tt;return _e=_e??MAX_SAFE_INTEGER$1$1,!!_e&&(rt=="number"||rt!="symbol"&&reIsUint$1.test(tt))&&tt>-1&&tt%1==0&&tt<_e}function baseAssignValue$1(tt,_e,rt){_e=="__proto__"&&defineProperty$1$1?defineProperty$1$1(tt,_e,{configurable:!0,enumerable:!0,value:rt,writable:!0}):tt[_e]=rt}function eq$1(tt,_e){return tt===_e||tt!==tt&&_e!==_e}var objectProto$g=Object.prototype,hasOwnProperty$e=objectProto$g.hasOwnProperty;function assignValue$1(tt,_e,rt){var nt=tt[_e];(!(hasOwnProperty$e.call(tt,_e)&&eq$1(nt,rt))||rt===void 0&&!(_e in tt))&&baseAssignValue$1(tt,_e,rt)}function copyObject$1(tt,_e,rt,nt){var it=!rt;rt||(rt={});for(var st=-1,ot=_e.length;++st<ot;){var lt=_e[st],at=nt?nt(rt[lt],tt[lt],lt,rt,tt):void 0;at===void 0&&(at=tt[lt]),it?baseAssignValue$1(rt,lt,at):assignValue$1(rt,lt,at)}return rt}var nativeMax$3=Math.max;function overRest$1(tt,_e,rt){return _e=nativeMax$3(_e===void 0?tt.length-1:_e,0),function(){for(var nt=arguments,it=-1,st=nativeMax$3(nt.length-_e,0),ot=Array(st);++it<st;)ot[it]=nt[_e+it];it=-1;for(var lt=Array(_e+1);++it<_e;)lt[it]=nt[it];return lt[_e]=rt(ot),apply$1(tt,this,lt)}}function baseRest$1(tt,_e){return setToString$1$1(overRest$1(tt,_e,identity$2),tt+"")}var MAX_SAFE_INTEGER$2=9007199254740991;function isLength$1(tt){return typeof tt=="number"&&tt>-1&&tt%1==0&&tt<=MAX_SAFE_INTEGER$2}function isArrayLike$1(tt){return tt!=null&&isLength$1(tt.length)&&!isFunction$1(tt)}function isIterateeCall$1(tt,_e,rt){if(!isObject$a(rt))return!1;var nt=typeof _e;return(nt=="number"?isArrayLike$1(rt)&&isIndex$1(_e,rt.length):nt=="string"&&_e in rt)?eq$1(rt[_e],tt):!1}function createAssigner$1(tt){return baseRest$1(function(_e,rt){var nt=-1,it=rt.length,st=it>1?rt[it-1]:void 0,ot=it>2?rt[2]:void 0;for(st=tt.length>3&&typeof st=="function"?(it--,st):void 0,ot&&isIterateeCall$1(rt[0],rt[1],ot)&&(st=it<3?void 0:st,it=1),_e=Object(_e);++nt<it;){var lt=rt[nt];lt&&tt(_e,lt,nt,st)}return _e})}var objectProto$f=Object.prototype;function isPrototype$1(tt){var _e=tt&&tt.constructor,rt=typeof _e=="function"&&_e.prototype||objectProto$f;return tt===rt}function baseTimes$1(tt,_e){for(var rt=-1,nt=Array(tt);++rt<tt;)nt[rt]=_e(rt);return nt}var argsTag$3="[object Arguments]";function baseIsArguments$1(tt){return isObjectLike$1(tt)&&baseGetTag$1(tt)==argsTag$3}var objectProto$e=Object.prototype,hasOwnProperty$d=objectProto$e.hasOwnProperty,propertyIsEnumerable$1=objectProto$e.propertyIsEnumerable,isArguments$1=baseIsArguments$1(function(){return arguments}())?baseIsArguments$1:function(tt){return isObjectLike$1(tt)&&hasOwnProperty$d.call(tt,"callee")&&!propertyIsEnumerable$1.call(tt,"callee")};const isArguments$1$1=isArguments$1;function stubFalse$1(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root$1$1.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse$1;const isBuffer$1=isBuffer;var argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1$1="[object Function]",mapTag$6="[object Map]",numberTag$3="[object Number]",objectTag$3="[object Object]",regexpTag$4="[object RegExp]",setTag$6="[object Set]",stringTag$4="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags$1={};typedArrayTags$1[float32Tag$2]=typedArrayTags$1[float64Tag$2]=typedArrayTags$1[int8Tag$2]=typedArrayTags$1[int16Tag$2]=typedArrayTags$1[int32Tag$2]=typedArrayTags$1[uint8Tag$2]=typedArrayTags$1[uint8ClampedTag$2]=typedArrayTags$1[uint16Tag$2]=typedArrayTags$1[uint32Tag$2]=!0;typedArrayTags$1[argsTag$2]=typedArrayTags$1[arrayTag$2]=typedArrayTags$1[arrayBufferTag$3]=typedArrayTags$1[boolTag$3]=typedArrayTags$1[dataViewTag$4]=typedArrayTags$1[dateTag$3]=typedArrayTags$1[errorTag$2]=typedArrayTags$1[funcTag$1$1]=typedArrayTags$1[mapTag$6]=typedArrayTags$1[numberTag$3]=typedArrayTags$1[objectTag$3]=typedArrayTags$1[regexpTag$4]=typedArrayTags$1[setTag$6]=typedArrayTags$1[stringTag$4]=typedArrayTags$1[weakMapTag$2]=!1;function baseIsTypedArray$1(tt){return isObjectLike$1(tt)&&isLength$1(tt.length)&&!!typedArrayTags$1[baseGetTag$1(tt)]}function baseUnary$1(tt){return function(_e){return tt(_e)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1$1.process,nodeUtil=function(){try{var tt=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return tt||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}();const nodeUtil$1=nodeUtil;var nodeIsTypedArray$1=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray$1?baseUnary$1(nodeIsTypedArray$1):baseIsTypedArray$1;const isTypedArray$1$1=isTypedArray$1;var objectProto$d=Object.prototype,hasOwnProperty$c=objectProto$d.hasOwnProperty;function arrayLikeKeys$1(tt,_e){var rt=isArray$1$1(tt),nt=!rt&&isArguments$1$1(tt),it=!rt&&!nt&&isBuffer$1(tt),st=!rt&&!nt&&!it&&isTypedArray$1$1(tt),ot=rt||nt||it||st,lt=ot?baseTimes$1(tt.length,String):[],at=lt.length;for(var ct in tt)(_e||hasOwnProperty$c.call(tt,ct))&&!(ot&&(ct=="length"||it&&(ct=="offset"||ct=="parent")||st&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||isIndex$1(ct,at)))&&lt.push(ct);return lt}function overArg$1(tt,_e){return function(rt){return tt(_e(rt))}}var nativeKeys$1=overArg$1(Object.keys,Object);const nativeKeys$1$1=nativeKeys$1;var objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function baseKeys$1(tt){if(!isPrototype$1(tt))return nativeKeys$1$1(tt);var _e=[];for(var rt in Object(tt))hasOwnProperty$b.call(tt,rt)&&rt!="constructor"&&_e.push(rt);return _e}function keys$1(tt){return isArrayLike$1(tt)?arrayLikeKeys$1(tt):baseKeys$1(tt)}var objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty,assign$5=createAssigner$1(function(tt,_e){if(isPrototype$1(_e)||isArrayLike$1(_e)){copyObject$1(_e,keys$1(_e),tt);return}for(var rt in _e)hasOwnProperty$a.call(_e,rt)&&assignValue$1(tt,rt,_e[rt])});const assign$1$1=assign$5;function nativeKeysIn(tt){var _e=[];if(tt!=null)for(var rt in Object(tt))_e.push(rt);return _e}var objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function baseKeysIn(tt){if(!isObject$a(tt))return nativeKeysIn(tt);var _e=isPrototype$1(tt),rt=[];for(var nt in tt)nt=="constructor"&&(_e||!hasOwnProperty$9.call(tt,nt))||rt.push(nt);return rt}function keysIn(tt){return isArrayLike$1(tt)?arrayLikeKeys$1(tt,!0):baseKeysIn(tt)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(tt,_e){if(isArray$1$1(tt))return!1;var rt=typeof tt;return rt=="number"||rt=="symbol"||rt=="boolean"||tt==null||isSymbol(tt)?!0:reIsPlainProp.test(tt)||!reIsDeepProp.test(tt)||_e!=null&&tt in Object(_e)}var nativeCreate=getNative$1(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(tt){var _e=this.has(tt)&&delete this.__data__[tt];return this.size-=_e?1:0,_e}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function hashGet(tt){var _e=this.__data__;if(nativeCreate$1){var rt=_e[tt];return rt===HASH_UNDEFINED$2?void 0:rt}return hasOwnProperty$8.call(_e,tt)?_e[tt]:void 0}var objectProto$8$1=Object.prototype,hasOwnProperty$7=objectProto$8$1.hasOwnProperty;function hashHas(tt){var _e=this.__data__;return nativeCreate$1?_e[tt]!==void 0:hasOwnProperty$7.call(_e,tt)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(tt,_e){var rt=this.__data__;return this.size+=this.has(tt)?0:1,rt[tt]=nativeCreate$1&&_e===void 0?HASH_UNDEFINED$1:_e,this}function Hash(tt){var _e=-1,rt=tt==null?0:tt.length;for(this.clear();++_e<rt;){var nt=tt[_e];this.set(nt[0],nt[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(tt,_e){for(var rt=tt.length;rt--;)if(eq$1(tt[rt][0],_e))return rt;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(tt){var _e=this.__data__,rt=assocIndexOf(_e,tt);if(rt<0)return!1;var nt=_e.length-1;return rt==nt?_e.pop():splice.call(_e,rt,1),--this.size,!0}function listCacheGet(tt){var _e=this.__data__,rt=assocIndexOf(_e,tt);return rt<0?void 0:_e[rt][1]}function listCacheHas(tt){return assocIndexOf(this.__data__,tt)>-1}function listCacheSet(tt,_e){var rt=this.__data__,nt=assocIndexOf(rt,tt);return nt<0?(++this.size,rt.push([tt,_e])):rt[nt][1]=_e,this}function ListCache(tt){var _e=-1,rt=tt==null?0:tt.length;for(this.clear();++_e<rt;){var nt=tt[_e];this.set(nt[0],nt[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative$1(root$1$1,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(tt){var _e=typeof tt;return _e=="string"||_e=="number"||_e=="symbol"||_e=="boolean"?tt!=="__proto__":tt===null}function getMapData(tt,_e){var rt=tt.__data__;return isKeyable(_e)?rt[typeof _e=="string"?"string":"hash"]:rt.map}function mapCacheDelete(tt){var _e=getMapData(this,tt).delete(tt);return this.size-=_e?1:0,_e}function mapCacheGet(tt){return getMapData(this,tt).get(tt)}function mapCacheHas(tt){return getMapData(this,tt).has(tt)}function mapCacheSet(tt,_e){var rt=getMapData(this,tt),nt=rt.size;return rt.set(tt,_e),this.size+=rt.size==nt?0:1,this}function MapCache(tt){var _e=-1,rt=tt==null?0:tt.length;for(this.clear();++_e<rt;){var nt=tt[_e];this.set(nt[0],nt[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$1="Expected a function";function memoize(tt,_e){if(typeof tt!="function"||_e!=null&&typeof _e!="function")throw new TypeError(FUNC_ERROR_TEXT$1);var rt=function(){var nt=arguments,it=_e?_e.apply(this,nt):nt[0],st=rt.cache;if(st.has(it))return st.get(it);var ot=tt.apply(this,nt);return rt.cache=st.set(it,ot)||st,ot};return rt.cache=new(memoize.Cache||MapCache),rt}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(tt){var _e=memoize(tt,function(nt){return rt.size===MAX_MEMOIZE_SIZE&&rt.clear(),nt}),rt=_e.cache;return _e}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(tt){var _e=[];return tt.charCodeAt(0)===46&&_e.push(""),tt.replace(rePropName,function(rt,nt,it,st){_e.push(it?st.replace(reEscapeChar,"$1"):nt||rt)}),_e});const stringToPath$1=stringToPath;function toString$1(tt){return tt==null?"":baseToString(tt)}function castPath(tt,_e){return isArray$1$1(tt)?tt:isKey(tt,_e)?[tt]:stringToPath$1(toString$1(tt))}var INFINITY$1=1/0;function toKey(tt){if(typeof tt=="string"||isSymbol(tt))return tt;var _e=tt+"";return _e=="0"&&1/tt==-INFINITY$1?"-0":_e}function baseGet(tt,_e){_e=castPath(_e,tt);for(var rt=0,nt=_e.length;tt!=null&&rt<nt;)tt=tt[toKey(_e[rt++])];return rt&&rt==nt?tt:void 0}function get$1(tt,_e,rt){var nt=tt==null?void 0:baseGet(tt,_e);return nt===void 0?rt:nt}function arrayPush(tt,_e){for(var rt=-1,nt=_e.length,it=tt.length;++rt<nt;)tt[it+rt]=_e[rt];return tt}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(tt){return isArray$1$1(tt)||isArguments$1$1(tt)||!!(spreadableSymbol&&tt&&tt[spreadableSymbol])}function baseFlatten(tt,_e,rt,nt,it){var st=-1,ot=tt.length;for(rt||(rt=isFlattenable),it||(it=[]);++st<ot;){var lt=tt[st];_e>0&&rt(lt)?_e>1?baseFlatten(lt,_e-1,rt,nt,it):arrayPush(it,lt):nt||(it[it.length]=lt)}return it}function flatten$1(tt){var _e=tt==null?0:tt.length;return _e?baseFlatten(tt,1):[]}var getPrototype=overArg$1(Object.getPrototypeOf,Object);const getPrototype$1=getPrototype;function baseSlice(tt,_e,rt){var nt=-1,it=tt.length;_e<0&&(_e=-_e>it?0:it+_e),rt=rt>it?it:rt,rt<0&&(rt+=it),it=_e>rt?0:rt-_e>>>0,_e>>>=0;for(var st=Array(it);++nt<it;)st[nt]=tt[nt+_e];return st}function arrayReduce(tt,_e,rt,nt){var it=-1,st=tt==null?0:tt.length;for(nt&&st&&(rt=tt[++it]);++it<st;)rt=_e(rt,tt[it],it,tt);return rt}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(tt){var _e=this.__data__,rt=_e.delete(tt);return this.size=_e.size,rt}function stackGet(tt){return this.__data__.get(tt)}function stackHas(tt){return this.__data__.has(tt)}var LARGE_ARRAY_SIZE$2=200;function stackSet(tt,_e){var rt=this.__data__;if(rt instanceof ListCache){var nt=rt.__data__;if(!Map$2||nt.length<LARGE_ARRAY_SIZE$2-1)return nt.push([tt,_e]),this.size=++rt.size,this;rt=this.__data__=new MapCache(nt)}return rt.set(tt,_e),this.size=rt.size,this}function Stack(tt){var _e=this.__data__=new ListCache(tt);this.size=_e.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(tt,_e){return tt&&copyObject$1(_e,keys$1(_e),tt)}function baseAssignIn(tt,_e){return tt&&copyObject$1(_e,keysIn(_e),tt)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer2=moduleExports?root$1$1.Buffer:void 0,allocUnsafe=Buffer2?Buffer2.allocUnsafe:void 0;function cloneBuffer(tt,_e){if(_e)return tt.slice();var rt=tt.length,nt=allocUnsafe?allocUnsafe(rt):new tt.constructor(rt);return tt.copy(nt),nt}function arrayFilter(tt,_e){for(var rt=-1,nt=tt==null?0:tt.length,it=0,st=[];++rt<nt;){var ot=tt[rt];_e(ot,rt,tt)&&(st[it++]=ot)}return st}function stubArray(){return[]}var objectProto$7$1=Object.prototype,propertyIsEnumerable$2=objectProto$7$1.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(tt){return tt==null?[]:(tt=Object(tt),arrayFilter(nativeGetSymbols$1(tt),function(_e){return propertyIsEnumerable$2.call(tt,_e)}))}:stubArray;const getSymbols$1=getSymbols;function copySymbols(tt,_e){return copyObject$1(tt,getSymbols$1(tt),_e)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(tt){for(var _e=[];tt;)arrayPush(_e,getSymbols$1(tt)),tt=getPrototype$1(tt);return _e}:stubArray;const getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(tt,_e){return copyObject$1(tt,getSymbolsIn$1(tt),_e)}function baseGetAllKeys(tt,_e,rt){var nt=_e(tt);return isArray$1$1(tt)?nt:arrayPush(nt,rt(tt))}function getAllKeys(tt){return baseGetAllKeys(tt,keys$1,getSymbols$1)}function getAllKeysIn(tt){return baseGetAllKeys(tt,keysIn,getSymbolsIn$1)}var DataView$1=getNative$1(root$1$1,"DataView");const DataView$2=DataView$1;var Promise$1=getNative$1(root$1$1,"Promise");const Promise$2=Promise$1;var Set$1=getNative$1(root$1$1,"Set");const Set$2=Set$1;var mapTag$5="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$5="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource$1(DataView$2),mapCtorString=toSource$1(Map$2),promiseCtorString=toSource$1(Promise$2),setCtorString=toSource$1(Set$2),weakMapCtorString=toSource$1(WeakMap$2),getTag=baseGetTag$1;(DataView$2&&getTag(new DataView$2(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$5||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$5||WeakMap$2&&getTag(new WeakMap$2)!=weakMapTag$1)&&(getTag=function(tt){var _e=baseGetTag$1(tt),rt=_e==objectTag$2?tt.constructor:void 0,nt=rt?toSource$1(rt):"";if(nt)switch(nt){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$5;case promiseCtorString:return promiseTag;case setCtorString:return setTag$5;case weakMapCtorString:return weakMapTag$1}return _e});const getTag$1=getTag;var objectProto$6$1=Object.prototype,hasOwnProperty$6$1=objectProto$6$1.hasOwnProperty;function initCloneArray(tt){var _e=tt.length,rt=new tt.constructor(_e);return _e&&typeof tt[0]=="string"&&hasOwnProperty$6$1.call(tt,"index")&&(rt.index=tt.index,rt.input=tt.input),rt}var Uint8Array$1=root$1$1.Uint8Array;const Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(tt){var _e=new tt.constructor(tt.byteLength);return new Uint8Array$2(_e).set(new Uint8Array$2(tt)),_e}function cloneDataView(tt,_e){var rt=_e?cloneArrayBuffer(tt.buffer):tt.buffer;return new tt.constructor(rt,tt.byteOffset,tt.byteLength)}var reFlags=/\w*$/;function cloneRegExp(tt){var _e=new tt.constructor(tt.source,reFlags.exec(tt));return _e.lastIndex=tt.lastIndex,_e}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(tt){return symbolValueOf$1?Object(symbolValueOf$1.call(tt)):{}}function cloneTypedArray(tt,_e){var rt=_e?cloneArrayBuffer(tt.buffer):tt.buffer;return new tt.constructor(rt,tt.byteOffset,tt.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$4="[object Map]",numberTag$2="[object Number]",regexpTag$3="[object RegExp]",setTag$4="[object Set]",stringTag$3="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(tt,_e,rt){var nt=tt.constructor;switch(_e){case arrayBufferTag$2:return cloneArrayBuffer(tt);case boolTag$2:case dateTag$2:return new nt(+tt);case dataViewTag$2:return cloneDataView(tt,rt);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(tt,rt);case mapTag$4:return new nt;case numberTag$2:case stringTag$3:return new nt(tt);case regexpTag$3:return cloneRegExp(tt);case setTag$4:return new nt;case symbolTag$2:return cloneSymbol(tt)}}function initCloneObject(tt){return typeof tt.constructor=="function"&&!isPrototype$1(tt)?baseCreate$1(getPrototype$1(tt)):{}}var mapTag$3="[object Map]";function baseIsMap(tt){return isObjectLike$1(tt)&&getTag$1(tt)==mapTag$3}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap=nodeIsMap?baseUnary$1(nodeIsMap):baseIsMap;const isMap$1=isMap;var setTag$3="[object Set]";function baseIsSet(tt){return isObjectLike$1(tt)&&getTag$1(tt)==setTag$3}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet,isSet=nodeIsSet?baseUnary$1(nodeIsSet):baseIsSet;const isSet$1=isSet;var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag$1$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag$3="[object Function]",genTag$2="[object GeneratorFunction]",mapTag$2="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$2="[object RegExp]",setTag$2="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag$3="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$3="[object Float32Array]",float64Tag$3="[object Float64Array]",int8Tag$3="[object Int8Array]",int16Tag$3="[object Int16Array]",int32Tag$3="[object Int32Array]",uint8Tag$3="[object Uint8Array]",uint8ClampedTag$3="[object Uint8ClampedArray]",uint16Tag$3="[object Uint16Array]",uint32Tag$3="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag$3]=cloneableTags[float64Tag$3]=cloneableTags[int8Tag$3]=cloneableTags[int16Tag$3]=cloneableTags[int32Tag$3]=cloneableTags[mapTag$2]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$2]=cloneableTags[setTag$2]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag$3]=cloneableTags[uint8ClampedTag$3]=cloneableTags[uint16Tag$3]=cloneableTags[uint32Tag$3]=!0;cloneableTags[errorTag$1]=cloneableTags[funcTag$3]=cloneableTags[weakMapTag$3]=!1;function baseClone(tt,_e,rt,nt,it,st){var ot,lt=_e&CLONE_DEEP_FLAG,at=_e&CLONE_FLAT_FLAG,ct=_e&CLONE_SYMBOLS_FLAG$1;if(rt&&(ot=it?rt(tt,nt,it,st):rt(tt)),ot!==void 0)return ot;if(!isObject$a(tt))return tt;var ut=isArray$1$1(tt);if(ut){if(ot=initCloneArray(tt),!lt)return copyArray(tt,ot)}else{var ht=getTag$1(tt),dt=ht==funcTag$3||ht==genTag$2;if(isBuffer$1(tt))return cloneBuffer(tt,lt);if(ht==objectTag$1||ht==argsTag$1$1||dt&&!it){if(ot=at||dt?{}:initCloneObject(tt),!lt)return at?copySymbolsIn(tt,baseAssignIn(ot,tt)):copySymbols(tt,baseAssign(ot,tt))}else{if(!cloneableTags[ht])return it?tt:{};ot=initCloneByTag(tt,ht,lt)}}st||(st=new Stack);var ft=st.get(tt);if(ft)return ft;st.set(tt,ot),isSet$1(tt)?tt.forEach(function(gt){ot.add(baseClone(gt,_e,rt,gt,tt,st))}):isMap$1(tt)&&tt.forEach(function(gt,vt){ot.set(vt,baseClone(gt,_e,rt,vt,tt,st))});var pt=ct?at?getAllKeysIn:getAllKeys:at?keysIn:keys$1,mt=ut?void 0:pt(tt);return arrayEach(mt||tt,function(gt,vt){mt&&(vt=gt,gt=tt[vt]),assignValue$1(ot,vt,baseClone(gt,_e,rt,vt,tt,st))}),ot}var CLONE_SYMBOLS_FLAG=4;function clone(tt){return baseClone(tt,CLONE_SYMBOLS_FLAG)}function compact(tt){for(var _e=-1,rt=tt==null?0:tt.length,nt=0,it=[];++_e<rt;){var st=tt[_e];st&&(it[nt++]=st)}return it}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(tt){return this.__data__.set(tt,HASH_UNDEFINED),this}function setCacheHas(tt){return this.__data__.has(tt)}function SetCache(tt){var _e=-1,rt=tt==null?0:tt.length;for(this.__data__=new MapCache;++_e<rt;)this.add(tt[_e])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(tt,_e){for(var rt=-1,nt=tt==null?0:tt.length;++rt<nt;)if(_e(tt[rt],rt,tt))return!0;return!1}function cacheHas(tt,_e){return tt.has(_e)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(tt,_e,rt,nt,it,st){var ot=rt&COMPARE_PARTIAL_FLAG$5,lt=tt.length,at=_e.length;if(lt!=at&&!(ot&&at>lt))return!1;var ct=st.get(tt),ut=st.get(_e);if(ct&&ut)return ct==_e&&ut==tt;var ht=-1,dt=!0,ft=rt&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(st.set(tt,_e),st.set(_e,tt);++ht<lt;){var pt=tt[ht],mt=_e[ht];if(nt)var gt=ot?nt(mt,pt,ht,_e,tt,st):nt(pt,mt,ht,tt,_e,st);if(gt!==void 0){if(gt)continue;dt=!1;break}if(ft){if(!arraySome(_e,function(vt,At){if(!cacheHas(ft,At)&&(pt===vt||it(pt,vt,rt,nt,st)))return ft.push(At)})){dt=!1;break}}else if(!(pt===mt||it(pt,mt,rt,nt,st))){dt=!1;break}}return st.delete(tt),st.delete(_e),dt}function mapToArray(tt){var _e=-1,rt=Array(tt.size);return tt.forEach(function(nt,it){rt[++_e]=[it,nt]}),rt}function setToArray(tt){var _e=-1,rt=Array(tt.size);return tt.forEach(function(nt){rt[++_e]=nt}),rt}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag$4="[object Boolean]",dateTag$4="[object Date]",errorTag$3="[object Error]",mapTag$1="[object Map]",numberTag$4="[object Number]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$4="[object ArrayBuffer]",dataViewTag$5="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(tt,_e,rt,nt,it,st,ot){switch(rt){case dataViewTag$5:if(tt.byteLength!=_e.byteLength||tt.byteOffset!=_e.byteOffset)return!1;tt=tt.buffer,_e=_e.buffer;case arrayBufferTag$4:return!(tt.byteLength!=_e.byteLength||!st(new Uint8Array$2(tt),new Uint8Array$2(_e)));case boolTag$4:case dateTag$4:case numberTag$4:return eq$1(+tt,+_e);case errorTag$3:return tt.name==_e.name&&tt.message==_e.message;case regexpTag$1:case stringTag$1:return tt==_e+"";case mapTag$1:var lt=mapToArray;case setTag$1:var at=nt&COMPARE_PARTIAL_FLAG$4;if(lt||(lt=setToArray),tt.size!=_e.size&&!at)return!1;var ct=ot.get(tt);if(ct)return ct==_e;nt|=COMPARE_UNORDERED_FLAG$2,ot.set(tt,_e);var ut=equalArrays(lt(tt),lt(_e),nt,it,st,ot);return ot.delete(tt),ut;case symbolTag:if(symbolValueOf)return symbolValueOf.call(tt)==symbolValueOf.call(_e)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$5$1=Object.prototype,hasOwnProperty$5$1=objectProto$5$1.hasOwnProperty;function equalObjects(tt,_e,rt,nt,it,st){var ot=rt&COMPARE_PARTIAL_FLAG$3,lt=getAllKeys(tt),at=lt.length,ct=getAllKeys(_e),ut=ct.length;if(at!=ut&&!ot)return!1;for(var ht=at;ht--;){var dt=lt[ht];if(!(ot?dt in _e:hasOwnProperty$5$1.call(_e,dt)))return!1}var ft=st.get(tt),pt=st.get(_e);if(ft&&pt)return ft==_e&&pt==tt;var mt=!0;st.set(tt,_e),st.set(_e,tt);for(var gt=ot;++ht<at;){dt=lt[ht];var vt=tt[dt],At=_e[dt];if(nt)var yt=ot?nt(At,vt,dt,_e,tt,st):nt(vt,At,dt,tt,_e,st);if(!(yt===void 0?vt===At||it(vt,At,rt,nt,st):yt)){mt=!1;break}gt||(gt=dt=="constructor")}if(mt&&!gt){var xt=tt.constructor,_t=_e.constructor;xt!=_t&&"constructor"in tt&&"constructor"in _e&&!(typeof xt=="function"&&xt instanceof xt&&typeof _t=="function"&&_t instanceof _t)&&(mt=!1)}return st.delete(tt),st.delete(_e),mt}var COMPARE_PARTIAL_FLAG$2=1,argsTag$4="[object Arguments]",arrayTag$3="[object Array]",objectTag$4="[object Object]",objectProto$4$1=Object.prototype,hasOwnProperty$4$1=objectProto$4$1.hasOwnProperty;function baseIsEqualDeep(tt,_e,rt,nt,it,st){var ot=isArray$1$1(tt),lt=isArray$1$1(_e),at=ot?arrayTag$3:getTag$1(tt),ct=lt?arrayTag$3:getTag$1(_e);at=at==argsTag$4?objectTag$4:at,ct=ct==argsTag$4?objectTag$4:ct;var ut=at==objectTag$4,ht=ct==objectTag$4,dt=at==ct;if(dt&&isBuffer$1(tt)){if(!isBuffer$1(_e))return!1;ot=!0,ut=!1}if(dt&&!ut)return st||(st=new Stack),ot||isTypedArray$1$1(tt)?equalArrays(tt,_e,rt,nt,it,st):equalByTag(tt,_e,at,rt,nt,it,st);if(!(rt&COMPARE_PARTIAL_FLAG$2)){var ft=ut&&hasOwnProperty$4$1.call(tt,"__wrapped__"),pt=ht&&hasOwnProperty$4$1.call(_e,"__wrapped__");if(ft||pt){var mt=ft?tt.value():tt,gt=pt?_e.value():_e;return st||(st=new Stack),it(mt,gt,rt,nt,st)}}return dt?(st||(st=new Stack),equalObjects(tt,_e,rt,nt,it,st)):!1}function baseIsEqual(tt,_e,rt,nt,it){return tt===_e?!0:tt==null||_e==null||!isObjectLike$1(tt)&&!isObjectLike$1(_e)?tt!==tt&&_e!==_e:baseIsEqualDeep(tt,_e,rt,nt,baseIsEqual,it)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(tt,_e,rt,nt){var it=rt.length,st=it,ot=!nt;if(tt==null)return!st;for(tt=Object(tt);it--;){var lt=rt[it];if(ot&&lt[2]?lt[1]!==tt[lt[0]]:!(lt[0]in tt))return!1}for(;++it<st;){lt=rt[it];var at=lt[0],ct=tt[at],ut=lt[1];if(ot&&lt[2]){if(ct===void 0&&!(at in tt))return!1}else{var ht=new Stack;if(nt)var dt=nt(ct,ut,at,tt,_e,ht);if(!(dt===void 0?baseIsEqual(ut,ct,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,nt,ht):dt))return!1}}return!0}function isStrictComparable(tt){return tt===tt&&!isObject$a(tt)}function getMatchData(tt){for(var _e=keys$1(tt),rt=_e.length;rt--;){var nt=_e[rt],it=tt[nt];_e[rt]=[nt,it,isStrictComparable(it)]}return _e}function matchesStrictComparable(tt,_e){return function(rt){return rt==null?!1:rt[tt]===_e&&(_e!==void 0||tt in Object(rt))}}function baseMatches(tt){var _e=getMatchData(tt);return _e.length==1&&_e[0][2]?matchesStrictComparable(_e[0][0],_e[0][1]):function(rt){return rt===tt||baseIsMatch(rt,tt,_e)}}function baseHasIn(tt,_e){return tt!=null&&_e in Object(tt)}function hasPath(tt,_e,rt){_e=castPath(_e,tt);for(var nt=-1,it=_e.length,st=!1;++nt<it;){var ot=toKey(_e[nt]);if(!(st=tt!=null&&rt(tt,ot)))break;tt=tt[ot]}return st||++nt!=it?st:(it=tt==null?0:tt.length,!!it&&isLength$1(it)&&isIndex$1(ot,it)&&(isArray$1$1(tt)||isArguments$1$1(tt)))}function hasIn(tt,_e){return tt!=null&&hasPath(tt,_e,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(tt,_e){return isKey(tt)&&isStrictComparable(_e)?matchesStrictComparable(toKey(tt),_e):function(rt){var nt=get$1(rt,tt);return nt===void 0&&nt===_e?hasIn(rt,tt):baseIsEqual(_e,nt,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(tt){return function(_e){return _e==null?void 0:_e[tt]}}function basePropertyDeep(tt){return function(_e){return baseGet(_e,tt)}}function property(tt){return isKey(tt)?baseProperty(toKey(tt)):basePropertyDeep(tt)}function baseIteratee(tt){return typeof tt=="function"?tt:tt==null?identity$2:typeof tt=="object"?isArray$1$1(tt)?baseMatchesProperty(tt[0],tt[1]):baseMatches(tt):property(tt)}function arrayAggregator(tt,_e,rt,nt){for(var it=-1,st=tt==null?0:tt.length;++it<st;){var ot=tt[it];_e(nt,ot,rt(ot),tt)}return nt}function createBaseFor(tt){return function(_e,rt,nt){for(var it=-1,st=Object(_e),ot=nt(_e),lt=ot.length;lt--;){var at=ot[tt?lt:++it];if(rt(st[at],at,st)===!1)break}return _e}}var baseFor=createBaseFor();const baseFor$1=baseFor;function baseForOwn(tt,_e){return tt&&baseFor$1(tt,_e,keys$1)}function createBaseEach(tt,_e){return function(rt,nt){if(rt==null)return rt;if(!isArrayLike$1(rt))return tt(rt,nt);for(var it=rt.length,st=_e?it:-1,ot=Object(rt);(_e?st--:++st<it)&&nt(ot[st],st,ot)!==!1;);return rt}}var baseEach=createBaseEach(baseForOwn);const baseEach$1=baseEach;function baseAggregator(tt,_e,rt,nt){return baseEach$1(tt,function(it,st,ot){_e(nt,it,rt(it),ot)}),nt}function createAggregator(tt,_e){return function(rt,nt){var it=isArray$1$1(rt)?arrayAggregator:baseAggregator,st=_e?_e():{};return it(rt,tt,baseIteratee(nt),st)}}var objectProto$3$1=Object.prototype,hasOwnProperty$3$1=objectProto$3$1.hasOwnProperty,defaults=baseRest$1(function(tt,_e){tt=Object(tt);var rt=-1,nt=_e.length,it=nt>2?_e[2]:void 0;for(it&&isIterateeCall$1(_e[0],_e[1],it)&&(nt=1);++rt<nt;)for(var st=_e[rt],ot=keysIn(st),lt=-1,at=ot.length;++lt<at;){var ct=ot[lt],ut=tt[ct];(ut===void 0||eq$1(ut,objectProto$3$1[ct])&&!hasOwnProperty$3$1.call(tt,ct))&&(tt[ct]=st[ct])}return tt});const defaults$1=defaults;function isArrayLikeObject(tt){return isObjectLike$1(tt)&&isArrayLike$1(tt)}function arrayIncludesWith(tt,_e,rt){for(var nt=-1,it=tt==null?0:tt.length;++nt<it;)if(rt(_e,tt[nt]))return!0;return!1}var LARGE_ARRAY_SIZE$1=200;function baseDifference(tt,_e,rt,nt){var it=-1,st=arrayIncludes,ot=!0,lt=tt.length,at=[],ct=_e.length;if(!lt)return at;rt&&(_e=arrayMap(_e,baseUnary$1(rt))),nt?(st=arrayIncludesWith,ot=!1):_e.length>=LARGE_ARRAY_SIZE$1&&(st=cacheHas,ot=!1,_e=new SetCache(_e));e:for(;++it<lt;){var ut=tt[it],ht=rt==null?ut:rt(ut);if(ut=nt||ut!==0?ut:0,ot&&ht===ht){for(var dt=ct;dt--;)if(_e[dt]===ht)continue e;at.push(ut)}else st(_e,ht,nt)||at.push(ut)}return at}var difference=baseRest$1(function(tt,_e){return isArrayLikeObject(tt)?baseDifference(tt,baseFlatten(_e,1,isArrayLikeObject,!0)):[]});const difference$1=difference;function last(tt){var _e=tt==null?0:tt.length;return _e?tt[_e-1]:void 0}function drop(tt,_e,rt){var nt=tt==null?0:tt.length;return nt?(_e=rt||_e===void 0?1:toInteger(_e),baseSlice(tt,_e<0?0:_e,nt)):[]}function dropRight(tt,_e,rt){var nt=tt==null?0:tt.length;return nt?(_e=rt||_e===void 0?1:toInteger(_e),_e=nt-_e,baseSlice(tt,0,_e<0?0:_e)):[]}function castFunction(tt){return typeof tt=="function"?tt:identity$2}function forEach(tt,_e){var rt=isArray$1$1(tt)?arrayEach:baseEach$1;return rt(tt,castFunction(_e))}function arrayEvery(tt,_e){for(var rt=-1,nt=tt==null?0:tt.length;++rt<nt;)if(!_e(tt[rt],rt,tt))return!1;return!0}function baseEvery(tt,_e){var rt=!0;return baseEach$1(tt,function(nt,it,st){return rt=!!_e(nt,it,st),rt}),rt}function every(tt,_e,rt){var nt=isArray$1$1(tt)?arrayEvery:baseEvery;return rt&&isIterateeCall$1(tt,_e,rt)&&(_e=void 0),nt(tt,baseIteratee(_e))}function baseFilter(tt,_e){var rt=[];return baseEach$1(tt,function(nt,it,st){_e(nt,it,st)&&rt.push(nt)}),rt}function filter(tt,_e){var rt=isArray$1$1(tt)?arrayFilter:baseFilter;return rt(tt,baseIteratee(_e))}function createFind(tt){return function(_e,rt,nt){var it=Object(_e);if(!isArrayLike$1(_e)){var st=baseIteratee(rt);_e=keys$1(_e),rt=function(lt){return st(it[lt],lt,it)}}var ot=tt(_e,rt,nt);return ot>-1?it[st?_e[ot]:ot]:void 0}}var nativeMax$2=Math.max;function findIndex(tt,_e,rt){var nt=tt==null?0:tt.length;if(!nt)return-1;var it=rt==null?0:toInteger(rt);return it<0&&(it=nativeMax$2(nt+it,0)),baseFindIndex(tt,baseIteratee(_e),it)}var find=createFind(findIndex);const find$1=find;function head(tt){return tt&&tt.length?tt[0]:void 0}function baseMap(tt,_e){var rt=-1,nt=isArrayLike$1(tt)?Array(tt.length):[];return baseEach$1(tt,function(it,st,ot){nt[++rt]=_e(it,st,ot)}),nt}function map(tt,_e){var rt=isArray$1$1(tt)?arrayMap:baseMap;return rt(tt,baseIteratee(_e))}function flatMap(tt,_e){return baseFlatten(map(tt,_e),1)}var objectProto$2$1=Object.prototype,hasOwnProperty$2$1=objectProto$2$1.hasOwnProperty,groupBy=createAggregator(function(tt,_e,rt){hasOwnProperty$2$1.call(tt,rt)?tt[rt].push(_e):baseAssignValue$1(tt,rt,[_e])});const groupBy$1=groupBy;var objectProto$1$1=Object.prototype,hasOwnProperty$1$1=objectProto$1$1.hasOwnProperty;function baseHas(tt,_e){return tt!=null&&hasOwnProperty$1$1.call(tt,_e)}function has$1(tt,_e){return tt!=null&&hasPath(tt,_e,baseHas)}var stringTag$5="[object String]";function isString$1(tt){return typeof tt=="string"||!isArray$1$1(tt)&&isObjectLike$1(tt)&&baseGetTag$1(tt)==stringTag$5}function baseValues(tt,_e){return arrayMap(_e,function(rt){return tt[rt]})}function values(tt){return tt==null?[]:baseValues(tt,keys$1(tt))}var nativeMax$1=Math.max;function includes(tt,_e,rt,nt){tt=isArrayLike$1(tt)?tt:values(tt),rt=rt&&!nt?toInteger(rt):0;var it=tt.length;return rt<0&&(rt=nativeMax$1(it+rt,0)),isString$1(tt)?rt<=it&&tt.indexOf(_e,rt)>-1:!!it&&baseIndexOf(tt,_e,rt)>-1}var nativeMax$4=Math.max;function indexOf(tt,_e,rt){var nt=tt==null?0:tt.length;if(!nt)return-1;var it=rt==null?0:toInteger(rt);return it<0&&(it=nativeMax$4(nt+it,0)),baseIndexOf(tt,_e,it)}var mapTag$7="[object Map]",setTag$7="[object Set]",objectProto$k=Object.prototype,hasOwnProperty$h=objectProto$k.hasOwnProperty;function isEmpty(tt){if(tt==null)return!0;if(isArrayLike$1(tt)&&(isArray$1$1(tt)||typeof tt=="string"||typeof tt.splice=="function"||isBuffer$1(tt)||isTypedArray$1$1(tt)||isArguments$1$1(tt)))return!tt.length;var _e=getTag$1(tt);if(_e==mapTag$7||_e==setTag$7)return!tt.size;if(isPrototype$1(tt))return!baseKeys$1(tt).length;for(var rt in tt)if(hasOwnProperty$h.call(tt,rt))return!1;return!0}var regexpTag$5="[object RegExp]";function baseIsRegExp(tt){return isObjectLike$1(tt)&&baseGetTag$1(tt)==regexpTag$5}var nodeIsRegExp=nodeUtil$1&&nodeUtil$1.isRegExp,isRegExp=nodeIsRegExp?baseUnary$1(nodeIsRegExp):baseIsRegExp;const isRegExp$1=isRegExp;function isUndefined(tt){return tt===void 0}var FUNC_ERROR_TEXT="Expected a function";function negate(tt){if(typeof tt!="function")throw new TypeError(FUNC_ERROR_TEXT);return function(){var _e=arguments;switch(_e.length){case 0:return!tt.call(this);case 1:return!tt.call(this,_e[0]);case 2:return!tt.call(this,_e[0],_e[1]);case 3:return!tt.call(this,_e[0],_e[1],_e[2])}return!tt.apply(this,_e)}}function baseSet(tt,_e,rt,nt){if(!isObject$a(tt))return tt;_e=castPath(_e,tt);for(var it=-1,st=_e.length,ot=st-1,lt=tt;lt!=null&&++it<st;){var at=toKey(_e[it]),ct=rt;if(at==="__proto__"||at==="constructor"||at==="prototype")return tt;if(it!=ot){var ut=lt[at];ct=nt?nt(ut,at,lt):void 0,ct===void 0&&(ct=isObject$a(ut)?ut:isIndex$1(_e[it+1])?[]:{})}assignValue$1(lt,at,ct),lt=lt[at]}return tt}function basePickBy(tt,_e,rt){for(var nt=-1,it=_e.length,st={};++nt<it;){var ot=_e[nt],lt=baseGet(tt,ot);rt(lt,ot)&&baseSet(st,castPath(ot,tt),lt)}return st}function pickBy(tt,_e){if(tt==null)return{};var rt=arrayMap(getAllKeysIn(tt),function(nt){return[nt]});return _e=baseIteratee(_e),basePickBy(tt,rt,function(nt,it){return _e(nt,it[0])})}function baseReduce(tt,_e,rt,nt,it){return it(tt,function(st,ot,lt){rt=nt?(nt=!1,st):_e(rt,st,ot,lt)}),rt}function reduce(tt,_e,rt){var nt=isArray$1$1(tt)?arrayReduce:baseReduce,it=arguments.length<3;return nt(tt,baseIteratee(_e),rt,it,baseEach$1)}function reject(tt,_e){var rt=isArray$1$1(tt)?arrayFilter:baseFilter;return rt(tt,negate(baseIteratee(_e)))}function baseSome(tt,_e){var rt;return baseEach$1(tt,function(nt,it,st){return rt=_e(nt,it,st),!rt}),!!rt}function some(tt,_e,rt){var nt=isArray$1$1(tt)?arraySome:baseSome;return rt&&isIterateeCall$1(tt,_e,rt)&&(_e=void 0),nt(tt,baseIteratee(_e))}var INFINITY=1/0,createSet=Set$2&&1/setToArray(new Set$2([,-0]))[1]==INFINITY?function(tt){return new Set$2(tt)}:noop$2;const createSet$1=createSet;var LARGE_ARRAY_SIZE=200;function baseUniq(tt,_e,rt){var nt=-1,it=arrayIncludes,st=tt.length,ot=!0,lt=[],at=lt;if(rt)ot=!1,it=arrayIncludesWith;else if(st>=LARGE_ARRAY_SIZE){var ct=_e?null:createSet$1(tt);if(ct)return setToArray(ct);ot=!1,it=cacheHas,at=new SetCache}else at=_e?[]:lt;e:for(;++nt<st;){var ut=tt[nt],ht=_e?_e(ut):ut;if(ut=rt||ut!==0?ut:0,ot&&ht===ht){for(var dt=at.length;dt--;)if(at[dt]===ht)continue e;_e&&at.push(ht),lt.push(ut)}else it(at,ht,rt)||(at!==lt&&at.push(ht),lt.push(ut))}return lt}function uniq(tt){return tt&&tt.length?baseUniq(tt):[]}function PRINT_ERROR(tt){console&&console.error&&console.error(`Error: ${tt}`)}function PRINT_WARNING(tt){console&&console.warn&&console.warn(`Warning: ${tt}`)}function timer$1(tt){const _e=new Date().getTime(),rt=tt();return{time:new Date().getTime()-_e,value:rt}}function toFastProperties(tt){function _e(){}_e.prototype=tt;const rt=new _e;function nt(){return typeof rt.bar}return nt(),nt(),tt}function tokenLabel$1(tt){return hasTokenLabel$1(tt)?tt.LABEL:tt.name}function hasTokenLabel$1(tt){return isString$1(tt.LABEL)&&tt.LABEL!==""}class AbstractProduction{get definition(){return this._definition}set definition(_e){this._definition=_e}constructor(_e){this._definition=_e}accept(_e){_e.visit(this),forEach(this.definition,rt=>{rt.accept(_e)})}}class NonTerminal extends AbstractProduction{constructor(_e){super([]),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}set definition(_e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(_e){_e.visit(this)}}let Rule$1=class extends AbstractProduction{constructor(_e){super(_e.definition),this.orgText="",assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}};class Alternative extends AbstractProduction{constructor(_e){super(_e.definition),this.ignoreAmbiguities=!1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class Option extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class RepetitionMandatory extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class RepetitionMandatoryWithSeparator extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class Repetition extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class RepetitionWithSeparator extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class Alternation extends AbstractProduction{get definition(){return this._definition}set definition(_e){this._definition=_e}constructor(_e){super(_e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class Terminal{constructor(_e){this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}accept(_e){_e.visit(this)}}function serializeGrammar(tt){return map(tt,serializeProduction)}function serializeProduction(tt){function _e(rt){return map(rt,serializeProduction)}if(tt instanceof NonTerminal){const rt={type:"NonTerminal",name:tt.nonTerminalName,idx:tt.idx};return isString$1(tt.label)&&(rt.label=tt.label),rt}else{if(tt instanceof Alternative)return{type:"Alternative",definition:_e(tt.definition)};if(tt instanceof Option)return{type:"Option",idx:tt.idx,definition:_e(tt.definition)};if(tt instanceof RepetitionMandatory)return{type:"RepetitionMandatory",idx:tt.idx,definition:_e(tt.definition)};if(tt instanceof RepetitionMandatoryWithSeparator)return{type:"RepetitionMandatoryWithSeparator",idx:tt.idx,separator:serializeProduction(new Terminal({terminalType:tt.separator})),definition:_e(tt.definition)};if(tt instanceof RepetitionWithSeparator)return{type:"RepetitionWithSeparator",idx:tt.idx,separator:serializeProduction(new Terminal({terminalType:tt.separator})),definition:_e(tt.definition)};if(tt instanceof Repetition)return{type:"Repetition",idx:tt.idx,definition:_e(tt.definition)};if(tt instanceof Alternation)return{type:"Alternation",idx:tt.idx,definition:_e(tt.definition)};if(tt instanceof Terminal){const rt={type:"Terminal",name:tt.terminalType.name,label:tokenLabel$1(tt.terminalType),idx:tt.idx};isString$1(tt.label)&&(rt.terminalLabel=tt.label);const nt=tt.terminalType.PATTERN;return tt.terminalType.PATTERN&&(rt.pattern=isRegExp$1(nt)?nt.source:nt),rt}else{if(tt instanceof Rule$1)return{type:"Rule",name:tt.name,orgText:tt.orgText,definition:_e(tt.definition)};throw Error("non exhaustive match")}}}class GAstVisitor{visit(_e){const rt=_e;switch(rt.constructor){case NonTerminal:return this.visitNonTerminal(rt);case Alternative:return this.visitAlternative(rt);case Option:return this.visitOption(rt);case RepetitionMandatory:return this.visitRepetitionMandatory(rt);case RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(rt);case RepetitionWithSeparator:return this.visitRepetitionWithSeparator(rt);case Repetition:return this.visitRepetition(rt);case Alternation:return this.visitAlternation(rt);case Terminal:return this.visitTerminal(rt);case Rule$1:return this.visitRule(rt);default:throw Error("non exhaustive match")}}visitNonTerminal(_e){}visitAlternative(_e){}visitOption(_e){}visitRepetition(_e){}visitRepetitionMandatory(_e){}visitRepetitionMandatoryWithSeparator(_e){}visitRepetitionWithSeparator(_e){}visitAlternation(_e){}visitTerminal(_e){}visitRule(_e){}}function isSequenceProd(tt){return tt instanceof Alternative||tt instanceof Option||tt instanceof Repetition||tt instanceof RepetitionMandatory||tt instanceof RepetitionMandatoryWithSeparator||tt instanceof RepetitionWithSeparator||tt instanceof Terminal||tt instanceof Rule$1}function isOptionalProd(tt,_e=[]){return tt instanceof Option||tt instanceof Repetition||tt instanceof RepetitionWithSeparator?!0:tt instanceof Alternation?some(tt.definition,nt=>isOptionalProd(nt,_e)):tt instanceof NonTerminal&&includes(_e,tt)?!1:tt instanceof AbstractProduction?(tt instanceof NonTerminal&&_e.push(tt),every(tt.definition,nt=>isOptionalProd(nt,_e))):!1}function isBranchingProd(tt){return tt instanceof Alternation}function getProductionDslName(tt){if(tt instanceof NonTerminal)return"SUBRULE";if(tt instanceof Option)return"OPTION";if(tt instanceof Alternation)return"OR";if(tt instanceof RepetitionMandatory)return"AT_LEAST_ONE";if(tt instanceof RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(tt instanceof RepetitionWithSeparator)return"MANY_SEP";if(tt instanceof Repetition)return"MANY";if(tt instanceof Terminal)return"CONSUME";throw Error("non exhaustive match")}class RestWalker{walk(_e,rt=[]){forEach(_e.definition,(nt,it)=>{const st=drop(_e.definition,it+1);if(nt instanceof NonTerminal)this.walkProdRef(nt,st,rt);else if(nt instanceof Terminal)this.walkTerminal(nt,st,rt);else if(nt instanceof Alternative)this.walkFlat(nt,st,rt);else if(nt instanceof Option)this.walkOption(nt,st,rt);else if(nt instanceof RepetitionMandatory)this.walkAtLeastOne(nt,st,rt);else if(nt instanceof RepetitionMandatoryWithSeparator)this.walkAtLeastOneSep(nt,st,rt);else if(nt instanceof RepetitionWithSeparator)this.walkManySep(nt,st,rt);else if(nt instanceof Repetition)this.walkMany(nt,st,rt);else if(nt instanceof Alternation)this.walkOr(nt,st,rt);else throw Error("non exhaustive match")})}walkTerminal(_e,rt,nt){}walkProdRef(_e,rt,nt){}walkFlat(_e,rt,nt){const it=rt.concat(nt);this.walk(_e,it)}walkOption(_e,rt,nt){const it=rt.concat(nt);this.walk(_e,it)}walkAtLeastOne(_e,rt,nt){const it=[new Option({definition:_e.definition})].concat(rt,nt);this.walk(_e,it)}walkAtLeastOneSep(_e,rt,nt){const it=restForRepetitionWithSeparator(_e,rt,nt);this.walk(_e,it)}walkMany(_e,rt,nt){const it=[new Option({definition:_e.definition})].concat(rt,nt);this.walk(_e,it)}walkManySep(_e,rt,nt){const it=restForRepetitionWithSeparator(_e,rt,nt);this.walk(_e,it)}walkOr(_e,rt,nt){const it=rt.concat(nt);forEach(_e.definition,st=>{const ot=new Alternative({definition:[st]});this.walk(ot,it)})}}function restForRepetitionWithSeparator(tt,_e,rt){return[new Option({definition:[new Terminal({terminalType:tt.separator})].concat(tt.definition)})].concat(_e,rt)}function first$1(tt){if(tt instanceof NonTerminal)return first$1(tt.referencedRule);if(tt instanceof Terminal)return firstForTerminal(tt);if(isSequenceProd(tt))return firstForSequence(tt);if(isBranchingProd(tt))return firstForBranching(tt);throw Error("non exhaustive match")}function firstForSequence(tt){let _e=[];const rt=tt.definition;let nt=0,it=rt.length>nt,st,ot=!0;for(;it&&ot;)st=rt[nt],ot=isOptionalProd(st),_e=_e.concat(first$1(st)),nt=nt+1,it=rt.length>nt;return uniq(_e)}function firstForBranching(tt){const _e=map(tt.definition,rt=>first$1(rt));return uniq(flatten$1(_e))}function firstForTerminal(tt){return[tt.terminalType]}const IN="_~IN~_";class ResyncFollowsWalker extends RestWalker{constructor(_e){super(),this.topProd=_e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(_e,rt,nt){}walkProdRef(_e,rt,nt){const it=buildBetweenProdsFollowPrefix(_e.referencedRule,_e.idx)+this.topProd.name,st=rt.concat(nt),ot=new Alternative({definition:st}),lt=first$1(ot);this.follows[it]=lt}}function computeAllProdsFollows(tt){const _e={};return forEach(tt,rt=>{const nt=new ResyncFollowsWalker(rt).startWalking();assign$1$1(_e,nt)}),_e}function buildBetweenProdsFollowPrefix(tt,_e){return tt.name+_e+IN}function cc(tt){return tt.charCodeAt(0)}function insertToSet(tt,_e){Array.isArray(tt)?tt.forEach(function(rt){_e.push(rt)}):_e.push(tt)}function addFlag(tt,_e){if(tt[_e]===!0)throw"duplicate flag "+_e;tt[_e],tt[_e]=!0}function ASSERT_EXISTS(tt){if(tt===void 0)throw Error("Internal Error - Should never get here!");return!0}function ASSERT_NEVER_REACH_HERE(){throw Error("Internal Error - Should never get here!")}function isCharacter(tt){return tt.type==="Character"}const digitsCharCodes=[];for(let tt=cc("0");tt<=cc("9");tt++)digitsCharCodes.push(tt);const wordCharCodes=[cc("_")].concat(digitsCharCodes);for(let tt=cc("a");tt<=cc("z");tt++)wordCharCodes.push(tt);for(let tt=cc("A");tt<=cc("Z");tt++)wordCharCodes.push(tt);const whitespaceCodes=[cc(" "),cc("\f"),cc(`
`),cc("\r"),cc("	"),cc("\v"),cc("	"),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc("\u2028"),cc("\u2029"),cc(" "),cc(" "),cc("　"),cc("\uFEFF")],hexDigitPattern=/[0-9a-fA-F]/,decimalPattern=/[0-9]/,decimalPatternNoZero=/[1-9]/;class RegExpParser{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(_e){this.idx=_e.idx,this.input=_e.input,this.groupIdx=_e.groupIdx}pattern(_e){this.idx=0,this.input=_e,this.groupIdx=0,this.consumeChar("/");const rt=this.disjunction();this.consumeChar("/");const nt={type:"Flags",loc:{begin:this.idx,end:_e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":addFlag(nt,"global");break;case"i":addFlag(nt,"ignoreCase");break;case"m":addFlag(nt,"multiLine");break;case"u":addFlag(nt,"unicode");break;case"y":addFlag(nt,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:nt,value:rt,loc:this.loc(0)}}disjunction(){const _e=[],rt=this.idx;for(_e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),_e.push(this.alternative());return{type:"Disjunction",value:_e,loc:this.loc(rt)}}alternative(){const _e=[],rt=this.idx;for(;this.isTerm();)_e.push(this.term());return{type:"Alternative",value:_e,loc:this.loc(rt)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const _e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(_e)};case"$":return{type:"EndAnchor",loc:this.loc(_e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(_e)};case"B":return{type:"NonWordBoundary",loc:this.loc(_e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let rt;switch(this.popChar()){case"=":rt="Lookahead";break;case"!":rt="NegativeLookahead";break}ASSERT_EXISTS(rt);const nt=this.disjunction();return this.consumeChar(")"),{type:rt,value:nt,loc:this.loc(_e)}}return ASSERT_NEVER_REACH_HERE()}quantifier(_e=!1){let rt;const nt=this.idx;switch(this.popChar()){case"*":rt={atLeast:0,atMost:1/0};break;case"+":rt={atLeast:1,atMost:1/0};break;case"?":rt={atLeast:0,atMost:1};break;case"{":const it=this.integerIncludingZero();switch(this.popChar()){case"}":rt={atLeast:it,atMost:it};break;case",":let st;this.isDigit()?(st=this.integerIncludingZero(),rt={atLeast:it,atMost:st}):rt={atLeast:it,atMost:1/0},this.consumeChar("}");break}if(_e===!0&&rt===void 0)return;ASSERT_EXISTS(rt);break}if(!(_e===!0&&rt===void 0)&&ASSERT_EXISTS(rt))return this.peekChar(0)==="?"?(this.consumeChar("?"),rt.greedy=!1):rt.greedy=!0,rt.type="Quantifier",rt.loc=this.loc(nt),rt}atom(){let _e;const rt=this.idx;switch(this.peekChar()){case".":_e=this.dotAll();break;case"\\":_e=this.atomEscape();break;case"[":_e=this.characterClass();break;case"(":_e=this.group();break}if(_e===void 0&&this.isPatternCharacter()&&(_e=this.patternCharacter()),ASSERT_EXISTS(_e))return _e.loc=this.loc(rt),this.isQuantifier()&&(_e.quantifier=this.quantifier()),_e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[cc(`
`),cc("\r"),cc("\u2028"),cc("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let _e,rt=!1;switch(this.popChar()){case"d":_e=digitsCharCodes;break;case"D":_e=digitsCharCodes,rt=!0;break;case"s":_e=whitespaceCodes;break;case"S":_e=whitespaceCodes,rt=!0;break;case"w":_e=wordCharCodes;break;case"W":_e=wordCharCodes,rt=!0;break}if(ASSERT_EXISTS(_e))return{type:"Set",value:_e,complement:rt}}controlEscapeAtom(){let _e;switch(this.popChar()){case"f":_e=cc("\f");break;case"n":_e=cc(`
`);break;case"r":_e=cc("\r");break;case"t":_e=cc("	");break;case"v":_e=cc("\v");break}if(ASSERT_EXISTS(_e))return{type:"Character",value:_e}}controlLetterEscapeAtom(){this.consumeChar("c");const _e=this.popChar();if(/[a-zA-Z]/.test(_e)===!1)throw Error("Invalid ");return{type:"Character",value:_e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:cc("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const _e=this.popChar();return{type:"Character",value:cc(_e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const _e=this.popChar();return{type:"Character",value:cc(_e)}}}characterClass(){const _e=[];let rt=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),rt=!0);this.isClassAtom();){const nt=this.classAtom();if(nt.type,isCharacter(nt)&&this.isRangeDash()){this.consumeChar("-");const it=this.classAtom();if(it.type,isCharacter(it)){if(it.value<nt.value)throw Error("Range out of order in character class");_e.push({from:nt.value,to:it.value})}else insertToSet(nt.value,_e),_e.push(cc("-")),insertToSet(it.value,_e)}else insertToSet(nt.value,_e)}return this.consumeChar("]"),{type:"Set",complement:rt,value:_e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:cc("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let _e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),_e=!1;break;default:this.groupIdx++;break}const rt=this.disjunction();this.consumeChar(")");const nt={type:"Group",capturing:_e,value:rt};return _e&&(nt.idx=this.groupIdx),nt}positiveInteger(){let _e=this.popChar();if(decimalPatternNoZero.test(_e)===!1)throw Error("Expecting a positive integer");for(;decimalPattern.test(this.peekChar(0));)_e+=this.popChar();return parseInt(_e,10)}integerIncludingZero(){let _e=this.popChar();if(decimalPattern.test(_e)===!1)throw Error("Expecting an integer");for(;decimalPattern.test(this.peekChar(0));)_e+=this.popChar();return parseInt(_e,10)}patternCharacter(){const _e=this.popChar();switch(_e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:cc(_e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return decimalPattern.test(this.peekChar(0))}isClassAtom(_e=0){switch(this.peekChar(_e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const _e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(_e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(_e){let rt="";for(let it=0;it<_e;it++){const st=this.popChar();if(hexDigitPattern.test(st)===!1)throw Error("Expecting a HexDecimal digits");rt+=st}return{type:"Character",value:parseInt(rt,16)}}peekChar(_e=0){return this.input[this.idx+_e]}popChar(){const _e=this.peekChar(0);return this.consumeChar(void 0),_e}consumeChar(_e){if(_e!==void 0&&this.input[this.idx]!==_e)throw Error("Expected: '"+_e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(_e){return{begin:_e,end:this.idx}}}class BaseRegExpVisitor{visitChildren(_e){for(const rt in _e){const nt=_e[rt];_e.hasOwnProperty(rt)&&(nt.type!==void 0?this.visit(nt):Array.isArray(nt)&&nt.forEach(it=>{this.visit(it)},this))}}visit(_e){switch(_e.type){case"Pattern":this.visitPattern(_e);break;case"Flags":this.visitFlags(_e);break;case"Disjunction":this.visitDisjunction(_e);break;case"Alternative":this.visitAlternative(_e);break;case"StartAnchor":this.visitStartAnchor(_e);break;case"EndAnchor":this.visitEndAnchor(_e);break;case"WordBoundary":this.visitWordBoundary(_e);break;case"NonWordBoundary":this.visitNonWordBoundary(_e);break;case"Lookahead":this.visitLookahead(_e);break;case"NegativeLookahead":this.visitNegativeLookahead(_e);break;case"Character":this.visitCharacter(_e);break;case"Set":this.visitSet(_e);break;case"Group":this.visitGroup(_e);break;case"GroupBackReference":this.visitGroupBackReference(_e);break;case"Quantifier":this.visitQuantifier(_e);break}this.visitChildren(_e)}visitPattern(_e){}visitFlags(_e){}visitDisjunction(_e){}visitAlternative(_e){}visitStartAnchor(_e){}visitEndAnchor(_e){}visitWordBoundary(_e){}visitNonWordBoundary(_e){}visitLookahead(_e){}visitNegativeLookahead(_e){}visitCharacter(_e){}visitSet(_e){}visitGroup(_e){}visitGroupBackReference(_e){}visitQuantifier(_e){}}let regExpAstCache={};const regExpParser=new RegExpParser;function getRegExpAst(tt){const _e=tt.toString();if(regExpAstCache.hasOwnProperty(_e))return regExpAstCache[_e];{const rt=regExpParser.pattern(_e);return regExpAstCache[_e]=rt,rt}}function clearRegExpParserCache(){regExpAstCache={}}const complementErrorMessage="Complement Sets are not supported for first char optimization",failedOptimizationPrefixMsg=`Unable to use "first char" lexer optimizations:
`;function getOptimizedStartCodesIndices(tt,_e=!1){try{const rt=getRegExpAst(tt);return firstCharOptimizedIndices(rt.value,{},rt.flags.ignoreCase)}catch(rt){if(rt.message===complementErrorMessage)_e&&PRINT_WARNING(`${failedOptimizationPrefixMsg}	Unable to optimize: < ${tt.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let nt="";_e&&(nt=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),PRINT_ERROR(`${failedOptimizationPrefixMsg}
	Failed parsing: < ${tt.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+nt)}}return[]}function firstCharOptimizedIndices(tt,_e,rt){switch(tt.type){case"Disjunction":for(let it=0;it<tt.value.length;it++)firstCharOptimizedIndices(tt.value[it],_e,rt);break;case"Alternative":const nt=tt.value;for(let it=0;it<nt.length;it++){const st=nt[it];switch(st.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const ot=st;switch(ot.type){case"Character":addOptimizedIdxToResult(ot.value,_e,rt);break;case"Set":if(ot.complement===!0)throw Error(complementErrorMessage);forEach(ot.value,at=>{if(typeof at=="number")addOptimizedIdxToResult(at,_e,rt);else{const ct=at;if(rt===!0)for(let ut=ct.from;ut<=ct.to;ut++)addOptimizedIdxToResult(ut,_e,rt);else{for(let ut=ct.from;ut<=ct.to&&ut<minOptimizationVal;ut++)addOptimizedIdxToResult(ut,_e,rt);if(ct.to>=minOptimizationVal){const ut=ct.from>=minOptimizationVal?ct.from:minOptimizationVal,ht=ct.to,dt=charCodeToOptimizedIndex(ut),ft=charCodeToOptimizedIndex(ht);for(let pt=dt;pt<=ft;pt++)_e[pt]=pt}}}});break;case"Group":firstCharOptimizedIndices(ot.value,_e,rt);break;default:throw Error("Non Exhaustive Match")}const lt=ot.quantifier!==void 0&&ot.quantifier.atLeast===0;if(ot.type==="Group"&&isWholeOptional(ot)===!1||ot.type!=="Group"&&lt===!1)break}break;default:throw Error("non exhaustive match!")}return values(_e)}function addOptimizedIdxToResult(tt,_e,rt){const nt=charCodeToOptimizedIndex(tt);_e[nt]=nt,rt===!0&&handleIgnoreCase(tt,_e)}function handleIgnoreCase(tt,_e){const rt=String.fromCharCode(tt),nt=rt.toUpperCase();if(nt!==rt){const it=charCodeToOptimizedIndex(nt.charCodeAt(0));_e[it]=it}else{const it=rt.toLowerCase();if(it!==rt){const st=charCodeToOptimizedIndex(it.charCodeAt(0));_e[st]=st}}}function findCode(tt,_e){return find$1(tt.value,rt=>{if(typeof rt=="number")return includes(_e,rt);{const nt=rt;return find$1(_e,it=>nt.from<=it&&it<=nt.to)!==void 0}})}function isWholeOptional(tt){const _e=tt.quantifier;return _e&&_e.atLeast===0?!0:tt.value?isArray$1$1(tt.value)?every(tt.value,isWholeOptional):isWholeOptional(tt.value):!1}class CharCodeFinder extends BaseRegExpVisitor{constructor(_e){super(),this.targetCharCodes=_e,this.found=!1}visitChildren(_e){if(this.found!==!0){switch(_e.type){case"Lookahead":this.visitLookahead(_e);return;case"NegativeLookahead":this.visitNegativeLookahead(_e);return}super.visitChildren(_e)}}visitCharacter(_e){includes(this.targetCharCodes,_e.value)&&(this.found=!0)}visitSet(_e){_e.complement?findCode(_e,this.targetCharCodes)===void 0&&(this.found=!0):findCode(_e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function canMatchCharCode(tt,_e){if(_e instanceof RegExp){const rt=getRegExpAst(_e),nt=new CharCodeFinder(tt);return nt.visit(rt),nt.found}else return find$1(_e,rt=>includes(tt,rt.charCodeAt(0)))!==void 0}const PATTERN="PATTERN",DEFAULT_MODE="defaultMode",MODES="modes";let SUPPORT_STICKY=typeof new RegExp("(?:)").sticky=="boolean";function analyzeTokenTypes(tt,_e){_e=defaults$1(_e,{useSticky:SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(At,yt)=>yt()});const rt=_e.tracer;rt("initCharCodeToOptimizedIndexMap",()=>{initCharCodeToOptimizedIndexMap()});let nt;rt("Reject Lexer.NA",()=>{nt=reject(tt,At=>At[PATTERN]===Lexer.NA)});let it=!1,st;rt("Transform Patterns",()=>{it=!1,st=map(nt,At=>{const yt=At[PATTERN];if(isRegExp$1(yt)){const xt=yt.source;return xt.length===1&&xt!=="^"&&xt!=="$"&&xt!=="."&&!yt.ignoreCase?xt:xt.length===2&&xt[0]==="\\"&&!includes(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],xt[1])?xt[1]:_e.useSticky?addStickyFlag(yt):addStartOfInput(yt)}else{if(isFunction$1(yt))return it=!0,{exec:yt};if(typeof yt=="object")return it=!0,yt;if(typeof yt=="string"){if(yt.length===1)return yt;{const xt=yt.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),_t=new RegExp(xt);return _e.useSticky?addStickyFlag(_t):addStartOfInput(_t)}}else throw Error("non exhaustive match")}})});let ot,lt,at,ct,ut;rt("misc mapping",()=>{ot=map(nt,At=>At.tokenTypeIdx),lt=map(nt,At=>{const yt=At.GROUP;if(yt!==Lexer.SKIPPED){if(isString$1(yt))return yt;if(isUndefined(yt))return!1;throw Error("non exhaustive match")}}),at=map(nt,At=>{const yt=At.LONGER_ALT;if(yt)return isArray$1$1(yt)?map(yt,_t=>indexOf(nt,_t)):[indexOf(nt,yt)]}),ct=map(nt,At=>At.PUSH_MODE),ut=map(nt,At=>has$1(At,"POP_MODE"))});let ht;rt("Line Terminator Handling",()=>{const At=getCharCodes(_e.lineTerminatorCharacters);ht=map(nt,yt=>!1),_e.positionTracking!=="onlyOffset"&&(ht=map(nt,yt=>has$1(yt,"LINE_BREAKS")?!!yt.LINE_BREAKS:checkLineBreaksIssues(yt,At)===!1&&canMatchCharCode(At,yt.PATTERN)))});let dt,ft,pt,mt;rt("Misc Mapping #2",()=>{dt=map(nt,isCustomPattern),ft=map(st,isShortPattern),pt=reduce(nt,(At,yt)=>{const xt=yt.GROUP;return isString$1(xt)&&xt!==Lexer.SKIPPED&&(At[xt]=[]),At},{}),mt=map(st,(At,yt)=>({pattern:st[yt],longerAlt:at[yt],canLineTerminator:ht[yt],isCustom:dt[yt],short:ft[yt],group:lt[yt],push:ct[yt],pop:ut[yt],tokenTypeIdx:ot[yt],tokenType:nt[yt]}))});let gt=!0,vt=[];return _e.safeMode||rt("First Char Optimization",()=>{vt=reduce(nt,(At,yt,xt)=>{if(typeof yt.PATTERN=="string"){const _t=yt.PATTERN.charCodeAt(0),Et=charCodeToOptimizedIndex(_t);addToMapOfArrays(At,Et,mt[xt])}else if(isArray$1$1(yt.START_CHARS_HINT)){let _t;forEach(yt.START_CHARS_HINT,Et=>{const bt=typeof Et=="string"?Et.charCodeAt(0):Et,wt=charCodeToOptimizedIndex(bt);_t!==wt&&(_t=wt,addToMapOfArrays(At,wt,mt[xt]))})}else if(isRegExp$1(yt.PATTERN))if(yt.PATTERN.unicode)gt=!1,_e.ensureOptimizations&&PRINT_ERROR(`${failedOptimizationPrefixMsg}	Unable to analyze < ${yt.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const _t=getOptimizedStartCodesIndices(yt.PATTERN,_e.ensureOptimizations);isEmpty(_t)&&(gt=!1),forEach(_t,Et=>{addToMapOfArrays(At,Et,mt[xt])})}else _e.ensureOptimizations&&PRINT_ERROR(`${failedOptimizationPrefixMsg}	TokenType: <${yt.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),gt=!1;return At},[])}),{emptyGroups:pt,patternIdxToConfig:mt,charCodeToPatternIdxToConfig:vt,hasCustom:it,canBeOptimized:gt}}function validatePatterns(tt,_e){let rt=[];const nt=findMissingPatterns(tt);rt=rt.concat(nt.errors);const it=findInvalidPatterns(nt.valid),st=it.valid;return rt=rt.concat(it.errors),rt=rt.concat(validateRegExpPattern(st)),rt=rt.concat(findInvalidGroupType(st)),rt=rt.concat(findModesThatDoNotExist(st,_e)),rt=rt.concat(findUnreachablePatterns(st)),rt}function validateRegExpPattern(tt){let _e=[];const rt=filter(tt,nt=>isRegExp$1(nt[PATTERN]));return _e=_e.concat(findEndOfInputAnchor(rt)),_e=_e.concat(findStartOfInputAnchor(rt)),_e=_e.concat(findUnsupportedFlags(rt)),_e=_e.concat(findDuplicatePatterns(rt)),_e=_e.concat(findEmptyMatchRegExps(rt)),_e}function findMissingPatterns(tt){const _e=filter(tt,it=>!has$1(it,PATTERN)),rt=map(_e,it=>({message:"Token Type: ->"+it.name+"<- missing static 'PATTERN' property",type:LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[it]})),nt=difference$1(tt,_e);return{errors:rt,valid:nt}}function findInvalidPatterns(tt){const _e=filter(tt,it=>{const st=it[PATTERN];return!isRegExp$1(st)&&!isFunction$1(st)&&!has$1(st,"exec")&&!isString$1(st)}),rt=map(_e,it=>({message:"Token Type: ->"+it.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[it]})),nt=difference$1(tt,_e);return{errors:rt,valid:nt}}const end_of_input=/[^\\][$]/;function findEndOfInputAnchor(tt){class _e extends BaseRegExpVisitor{constructor(){super(...arguments),this.found=!1}visitEndAnchor(st){this.found=!0}}const rt=filter(tt,it=>{const st=it.PATTERN;try{const ot=getRegExpAst(st),lt=new _e;return lt.visit(ot),lt.found}catch{return end_of_input.test(st.source)}});return map(rt,it=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+it.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[it]}))}function findEmptyMatchRegExps(tt){const _e=filter(tt,nt=>nt.PATTERN.test(""));return map(_e,nt=>({message:"Token Type: ->"+nt.name+"<- static 'PATTERN' must not match an empty string",type:LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[nt]}))}const start_of_input=/[^\\[][\^]|^\^/;function findStartOfInputAnchor(tt){class _e extends BaseRegExpVisitor{constructor(){super(...arguments),this.found=!1}visitStartAnchor(st){this.found=!0}}const rt=filter(tt,it=>{const st=it.PATTERN;try{const ot=getRegExpAst(st),lt=new _e;return lt.visit(ot),lt.found}catch{return start_of_input.test(st.source)}});return map(rt,it=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+it.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[it]}))}function findUnsupportedFlags(tt){const _e=filter(tt,nt=>{const it=nt[PATTERN];return it instanceof RegExp&&(it.multiline||it.global)});return map(_e,nt=>({message:"Token Type: ->"+nt.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[nt]}))}function findDuplicatePatterns(tt){const _e=[];let rt=map(tt,st=>reduce(tt,(ot,lt)=>(st.PATTERN.source===lt.PATTERN.source&&!includes(_e,lt)&&lt.PATTERN!==Lexer.NA&&(_e.push(lt),ot.push(lt)),ot),[]));rt=compact(rt);const nt=filter(rt,st=>st.length>1);return map(nt,st=>{const ot=map(st,at=>at.name);return{message:`The same RegExp pattern ->${head(st).PATTERN}<-has been used in all of the following Token Types: ${ot.join(", ")} <-`,type:LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:st}})}function findInvalidGroupType(tt){const _e=filter(tt,nt=>{if(!has$1(nt,"GROUP"))return!1;const it=nt.GROUP;return it!==Lexer.SKIPPED&&it!==Lexer.NA&&!isString$1(it)});return map(_e,nt=>({message:"Token Type: ->"+nt.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[nt]}))}function findModesThatDoNotExist(tt,_e){const rt=filter(tt,it=>it.PUSH_MODE!==void 0&&!includes(_e,it.PUSH_MODE));return map(rt,it=>({message:`Token Type: ->${it.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${it.PUSH_MODE}<-which does not exist`,type:LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[it]}))}function findUnreachablePatterns(tt){const _e=[],rt=reduce(tt,(nt,it,st)=>{const ot=it.PATTERN;return ot===Lexer.NA||(isString$1(ot)?nt.push({str:ot,idx:st,tokenType:it}):isRegExp$1(ot)&&noMetaChar(ot)&&nt.push({str:ot.source,idx:st,tokenType:it})),nt},[]);return forEach(tt,(nt,it)=>{forEach(rt,({str:st,idx:ot,tokenType:lt})=>{if(it<ot&&testTokenType(st,nt.PATTERN)){const at=`Token: ->${lt.name}<- can never be matched.
Because it appears AFTER the Token Type ->${nt.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;_e.push({message:at,type:LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[nt,lt]})}})}),_e}function testTokenType(tt,_e){if(isRegExp$1(_e)){const rt=_e.exec(tt);return rt!==null&&rt.index===0}else{if(isFunction$1(_e))return _e(tt,0,[],{});if(has$1(_e,"exec"))return _e.exec(tt,0,[],{});if(typeof _e=="string")return _e===tt;throw Error("non exhaustive match")}}function noMetaChar(tt){return find$1([".","\\","[","]","|","^","$","(",")","?","*","+","{"],rt=>tt.source.indexOf(rt)!==-1)===void 0}function addStartOfInput(tt){const _e=tt.ignoreCase?"i":"";return new RegExp(`^(?:${tt.source})`,_e)}function addStickyFlag(tt){const _e=tt.ignoreCase?"iy":"y";return new RegExp(`${tt.source}`,_e)}function performRuntimeChecks(tt,_e,rt){const nt=[];return has$1(tt,DEFAULT_MODE)||nt.push({message:"A MultiMode Lexer cannot be initialized without a <"+DEFAULT_MODE+`> property in its definition
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),has$1(tt,MODES)||nt.push({message:"A MultiMode Lexer cannot be initialized without a <"+MODES+`> property in its definition
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),has$1(tt,MODES)&&has$1(tt,DEFAULT_MODE)&&!has$1(tt.modes,tt.defaultMode)&&nt.push({message:`A MultiMode Lexer cannot be initialized with a ${DEFAULT_MODE}: <${tt.defaultMode}>which does not exist
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),has$1(tt,MODES)&&forEach(tt.modes,(it,st)=>{forEach(it,(ot,lt)=>{if(isUndefined(ot))nt.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${st}> at index: <${lt}>
`,type:LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(has$1(ot,"LONGER_ALT")){const at=isArray$1$1(ot.LONGER_ALT)?ot.LONGER_ALT:[ot.LONGER_ALT];forEach(at,ct=>{!isUndefined(ct)&&!includes(it,ct)&&nt.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${ct.name}> on token <${ot.name}> outside of mode <${st}>
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),nt}function performWarningRuntimeChecks(tt,_e,rt){const nt=[];let it=!1;const st=compact(flatten$1(values(tt.modes))),ot=reject(st,at=>at[PATTERN]===Lexer.NA),lt=getCharCodes(rt);return _e&&forEach(ot,at=>{const ct=checkLineBreaksIssues(at,lt);if(ct!==!1){const ht={message:buildLineBreakIssueMessage(at,ct),type:ct.issue,tokenType:at};nt.push(ht)}else has$1(at,"LINE_BREAKS")?at.LINE_BREAKS===!0&&(it=!0):canMatchCharCode(lt,at.PATTERN)&&(it=!0)}),_e&&!it&&nt.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),nt}function cloneEmptyGroups(tt){const _e={},rt=keys$1(tt);return forEach(rt,nt=>{const it=tt[nt];if(isArray$1$1(it))_e[nt]=[];else throw Error("non exhaustive match")}),_e}function isCustomPattern(tt){const _e=tt.PATTERN;if(isRegExp$1(_e))return!1;if(isFunction$1(_e))return!0;if(has$1(_e,"exec"))return!0;if(isString$1(_e))return!1;throw Error("non exhaustive match")}function isShortPattern(tt){return isString$1(tt)&&tt.length===1?tt.charCodeAt(0):!1}const LineTerminatorOptimizedTester={test:function(tt){const _e=tt.length;for(let rt=this.lastIndex;rt<_e;rt++){const nt=tt.charCodeAt(rt);if(nt===10)return this.lastIndex=rt+1,!0;if(nt===13)return tt.charCodeAt(rt+1)===10?this.lastIndex=rt+2:this.lastIndex=rt+1,!0}return!1},lastIndex:0};function checkLineBreaksIssues(tt,_e){if(has$1(tt,"LINE_BREAKS"))return!1;if(isRegExp$1(tt.PATTERN)){try{canMatchCharCode(_e,tt.PATTERN)}catch(rt){return{issue:LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:rt.message}}return!1}else{if(isString$1(tt.PATTERN))return!1;if(isCustomPattern(tt))return{issue:LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function buildLineBreakIssueMessage(tt,_e){if(_e.issue===LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${tt.name}> Token Type
	 Root cause: ${_e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(_e.issue===LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${tt.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function getCharCodes(tt){return map(tt,rt=>isString$1(rt)?rt.charCodeAt(0):rt)}function addToMapOfArrays(tt,_e,rt){tt[_e]===void 0?tt[_e]=[rt]:tt[_e].push(rt)}const minOptimizationVal=256;let charCodeToOptimizedIdxMap=[];function charCodeToOptimizedIndex(tt){return tt<minOptimizationVal?tt:charCodeToOptimizedIdxMap[tt]}function initCharCodeToOptimizedIndexMap(){if(isEmpty(charCodeToOptimizedIdxMap)){charCodeToOptimizedIdxMap=new Array(65536);for(let tt=0;tt<65536;tt++)charCodeToOptimizedIdxMap[tt]=tt>255?255+~~(tt/255):tt}}function tokenStructuredMatcher(tt,_e){const rt=tt.tokenTypeIdx;return rt===_e.tokenTypeIdx?!0:_e.isParent===!0&&_e.categoryMatchesMap[rt]===!0}function tokenStructuredMatcherNoCategories(tt,_e){return tt.tokenTypeIdx===_e.tokenTypeIdx}let tokenShortNameIdx=1;const tokenIdxToClass={};function augmentTokenTypes(tt){const _e=expandCategories(tt);assignTokenDefaultProps(_e),assignCategoriesMapProp(_e),assignCategoriesTokensProp(_e),forEach(_e,rt=>{rt.isParent=rt.categoryMatches.length>0})}function expandCategories(tt){let _e=clone(tt),rt=tt,nt=!0;for(;nt;){rt=compact(flatten$1(map(rt,st=>st.CATEGORIES)));const it=difference$1(rt,_e);_e=_e.concat(it),isEmpty(it)?nt=!1:rt=it}return _e}function assignTokenDefaultProps(tt){forEach(tt,_e=>{hasShortKeyProperty(_e)||(tokenIdxToClass[tokenShortNameIdx]=_e,_e.tokenTypeIdx=tokenShortNameIdx++),hasCategoriesProperty(_e)&&!isArray$1$1(_e.CATEGORIES)&&(_e.CATEGORIES=[_e.CATEGORIES]),hasCategoriesProperty(_e)||(_e.CATEGORIES=[]),hasExtendingTokensTypesProperty(_e)||(_e.categoryMatches=[]),hasExtendingTokensTypesMapProperty(_e)||(_e.categoryMatchesMap={})})}function assignCategoriesTokensProp(tt){forEach(tt,_e=>{_e.categoryMatches=[],forEach(_e.categoryMatchesMap,(rt,nt)=>{_e.categoryMatches.push(tokenIdxToClass[nt].tokenTypeIdx)})})}function assignCategoriesMapProp(tt){forEach(tt,_e=>{singleAssignCategoriesToksMap([],_e)})}function singleAssignCategoriesToksMap(tt,_e){forEach(tt,rt=>{_e.categoryMatchesMap[rt.tokenTypeIdx]=!0}),forEach(_e.CATEGORIES,rt=>{const nt=tt.concat(_e);includes(nt,rt)||singleAssignCategoriesToksMap(nt,rt)})}function hasShortKeyProperty(tt){return has$1(tt,"tokenTypeIdx")}function hasCategoriesProperty(tt){return has$1(tt,"CATEGORIES")}function hasExtendingTokensTypesProperty(tt){return has$1(tt,"categoryMatches")}function hasExtendingTokensTypesMapProperty(tt){return has$1(tt,"categoryMatchesMap")}function isTokenType(tt){return has$1(tt,"tokenTypeIdx")}const defaultLexerErrorProvider={buildUnableToPopLexerModeMessage(tt){return`Unable to pop Lexer Mode after encountering Token ->${tt.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(tt,_e,rt,nt,it){return`unexpected character: ->${tt.charAt(_e)}<- at offset: ${_e}, skipped ${rt} characters.`}};var LexerDefinitionErrorType;(function(tt){tt[tt.MISSING_PATTERN=0]="MISSING_PATTERN",tt[tt.INVALID_PATTERN=1]="INVALID_PATTERN",tt[tt.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",tt[tt.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",tt[tt.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",tt[tt.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",tt[tt.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",tt[tt.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",tt[tt.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",tt[tt.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",tt[tt.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",tt[tt.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",tt[tt.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",tt[tt.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",tt[tt.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",tt[tt.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",tt[tt.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",tt[tt.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(LexerDefinitionErrorType||(LexerDefinitionErrorType={}));const DEFAULT_LEXER_CONFIG={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(DEFAULT_LEXER_CONFIG);class Lexer{constructor(_e,rt=DEFAULT_LEXER_CONFIG){if(this.lexerDefinition=_e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(it,st)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const ot=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${ot}--> <${it}>`);const{time:lt,value:at}=timer$1(st),ct=lt>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&ct(`${ot}<-- <${it}> time: ${lt}ms`),this.traceInitIndent--,at}else return st()},typeof rt=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=assign$1$1({},DEFAULT_LEXER_CONFIG,rt);const nt=this.config.traceInitPerf;nt===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof nt=="number"&&(this.traceInitMaxIdent=nt,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let it,st=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===DEFAULT_LEXER_CONFIG.lineTerminatorsPattern)this.config.lineTerminatorsPattern=LineTerminatorOptimizedTester;else if(this.config.lineTerminatorCharacters===DEFAULT_LEXER_CONFIG.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(rt.safeMode&&rt.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),isArray$1$1(_e)?it={modes:{defaultMode:clone(_e)},defaultMode:DEFAULT_MODE}:(st=!1,it=clone(_e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(performRuntimeChecks(it,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(performWarningRuntimeChecks(it,this.trackStartLines,this.config.lineTerminatorCharacters))})),it.modes=it.modes?it.modes:{},forEach(it.modes,(lt,at)=>{it.modes[at]=reject(lt,ct=>isUndefined(ct))});const ot=keys$1(it.modes);if(forEach(it.modes,(lt,at)=>{this.TRACE_INIT(`Mode: <${at}> processing`,()=>{if(this.modes.push(at),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(validatePatterns(lt,ot))}),isEmpty(this.lexerDefinitionErrors)){augmentTokenTypes(lt);let ct;this.TRACE_INIT("analyzeTokenTypes",()=>{ct=analyzeTokenTypes(lt,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:rt.positionTracking,ensureOptimizations:rt.ensureOptimizations,safeMode:rt.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[at]=ct.patternIdxToConfig,this.charCodeToPatternIdxToConfig[at]=ct.charCodeToPatternIdxToConfig,this.emptyGroups=assign$1$1({},this.emptyGroups,ct.emptyGroups),this.hasCustom=ct.hasCustom||this.hasCustom,this.canModeBeOptimized[at]=ct.canBeOptimized}})}),this.defaultMode=it.defaultMode,!isEmpty(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const at=map(this.lexerDefinitionErrors,ct=>ct.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+at)}forEach(this.lexerDefinitionWarning,lt=>{PRINT_WARNING(lt.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(SUPPORT_STICKY?(this.chopInput=identity$2,this.match=this.matchWithTest):(this.updateLastIndex=noop$2,this.match=this.matchWithExec),st&&(this.handleModes=noop$2),this.trackStartLines===!1&&(this.computeNewColumn=identity$2),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=noop$2),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const lt=reduce(this.canModeBeOptimized,(at,ct,ut)=>(ct===!1&&at.push(ut),at),[]);if(rt.ensureOptimizations&&!isEmpty(lt))throw Error(`Lexer Modes: < ${lt.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{clearRegExpParserCache()}),this.TRACE_INIT("toFastProperties",()=>{toFastProperties(this)})})}tokenize(_e,rt=this.defaultMode){if(!isEmpty(this.lexerDefinitionErrors)){const it=map(this.lexerDefinitionErrors,st=>st.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+it)}return this.tokenizeInternal(_e,rt)}tokenizeInternal(_e,rt){let nt,it,st,ot,lt,at,ct,ut,ht,dt,ft,pt,mt,gt,vt;const At=_e,yt=At.length;let xt=0,_t=0;const Et=this.hasCustom?0:Math.floor(_e.length/10),bt=new Array(Et),wt=[];let Tt=this.trackStartLines?1:void 0,Mt=this.trackStartLines?1:void 0;const Pt=cloneEmptyGroups(this.emptyGroups),It=this.trackStartLines,Ot=this.config.lineTerminatorsPattern;let Bt=0,Ut=[],Ft=[];const jt=[],Dt=[];Object.freeze(Dt);let Gt;function zt(){return Ut}function $t(Kt){const rr=charCodeToOptimizedIndex(Kt),ur=Ft[rr];return ur===void 0?Dt:ur}const Ht=Kt=>{if(jt.length===1&&Kt.tokenType.PUSH_MODE===void 0){const rr=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Kt);wt.push({offset:Kt.startOffset,line:Kt.startLine,column:Kt.startColumn,length:Kt.image.length,message:rr})}else{jt.pop();const rr=last(jt);Ut=this.patternIdxToConfig[rr],Ft=this.charCodeToPatternIdxToConfig[rr],Bt=Ut.length;const ur=this.canModeBeOptimized[rr]&&this.config.safeMode===!1;Ft&&ur?Gt=$t:Gt=zt}};function er(Kt){jt.push(Kt),Ft=this.charCodeToPatternIdxToConfig[Kt],Ut=this.patternIdxToConfig[Kt],Bt=Ut.length,Bt=Ut.length;const rr=this.canModeBeOptimized[Kt]&&this.config.safeMode===!1;Ft&&rr?Gt=$t:Gt=zt}er.call(this,rt);let Zt;const or=this.config.recoveryEnabled;for(;xt<yt;){at=null;const Kt=At.charCodeAt(xt),rr=Gt(Kt),ur=rr.length;for(nt=0;nt<ur;nt++){Zt=rr[nt];const fr=Zt.pattern;ct=null;const dr=Zt.short;if(dr!==!1?Kt===dr&&(at=fr):Zt.isCustom===!0?(vt=fr.exec(At,xt,bt,Pt),vt!==null?(at=vt[0],vt.payload!==void 0&&(ct=vt.payload)):at=null):(this.updateLastIndex(fr,xt),at=this.match(fr,_e,xt)),at!==null){if(lt=Zt.longerAlt,lt!==void 0){const gr=lt.length;for(st=0;st<gr;st++){const Yt=Ut[lt[st]],xr=Yt.pattern;if(ut=null,Yt.isCustom===!0?(vt=xr.exec(At,xt,bt,Pt),vt!==null?(ot=vt[0],vt.payload!==void 0&&(ut=vt.payload)):ot=null):(this.updateLastIndex(xr,xt),ot=this.match(xr,_e,xt)),ot&&ot.length>at.length){at=ot,ct=ut,Zt=Yt;break}}}break}}if(at!==null){if(ht=at.length,dt=Zt.group,dt!==void 0&&(ft=Zt.tokenTypeIdx,pt=this.createTokenInstance(at,xt,ft,Zt.tokenType,Tt,Mt,ht),this.handlePayload(pt,ct),dt===!1?_t=this.addToken(bt,_t,pt):Pt[dt].push(pt)),_e=this.chopInput(_e,ht),xt=xt+ht,Mt=this.computeNewColumn(Mt,ht),It===!0&&Zt.canLineTerminator===!0){let fr=0,dr,gr;Ot.lastIndex=0;do dr=Ot.test(at),dr===!0&&(gr=Ot.lastIndex-1,fr++);while(dr===!0);fr!==0&&(Tt=Tt+fr,Mt=ht-gr,this.updateTokenEndLineColumnLocation(pt,dt,gr,fr,Tt,Mt,ht))}this.handleModes(Zt,Ht,er,pt)}else{const fr=xt,dr=Tt,gr=Mt;let Yt=or===!1;for(;Yt===!1&&xt<yt;)for(_e=this.chopInput(_e,1),xt++,it=0;it<Bt;it++){const xr=Ut[it],vr=xr.pattern,Pr=xr.short;if(Pr!==!1?At.charCodeAt(xt)===Pr&&(Yt=!0):xr.isCustom===!0?Yt=vr.exec(At,xt,bt,Pt)!==null:(this.updateLastIndex(vr,xt),Yt=vr.exec(_e)!==null),Yt===!0)break}if(mt=xt-fr,Mt=this.computeNewColumn(Mt,mt),gt=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(At,fr,mt,dr,gr),wt.push({offset:fr,line:dr,column:gr,length:mt,message:gt}),or===!1)break}}return this.hasCustom||(bt.length=_t),{tokens:bt,groups:Pt,errors:wt}}handleModes(_e,rt,nt,it){if(_e.pop===!0){const st=_e.push;rt(it),st!==void 0&&nt.call(this,st)}else _e.push!==void 0&&nt.call(this,_e.push)}chopInput(_e,rt){return _e.substring(rt)}updateLastIndex(_e,rt){_e.lastIndex=rt}updateTokenEndLineColumnLocation(_e,rt,nt,it,st,ot,lt){let at,ct;rt!==void 0&&(at=nt===lt-1,ct=at?-1:0,it===1&&at===!0||(_e.endLine=st+ct,_e.endColumn=ot-1+-ct))}computeNewColumn(_e,rt){return _e+rt}createOffsetOnlyToken(_e,rt,nt,it){return{image:_e,startOffset:rt,tokenTypeIdx:nt,tokenType:it}}createStartOnlyToken(_e,rt,nt,it,st,ot){return{image:_e,startOffset:rt,startLine:st,startColumn:ot,tokenTypeIdx:nt,tokenType:it}}createFullToken(_e,rt,nt,it,st,ot,lt){return{image:_e,startOffset:rt,endOffset:rt+lt-1,startLine:st,endLine:st,startColumn:ot,endColumn:ot+lt-1,tokenTypeIdx:nt,tokenType:it}}addTokenUsingPush(_e,rt,nt){return _e.push(nt),rt}addTokenUsingMemberAccess(_e,rt,nt){return _e[rt]=nt,rt++,rt}handlePayloadNoCustom(_e,rt){}handlePayloadWithCustom(_e,rt){rt!==null&&(_e.payload=rt)}matchWithTest(_e,rt,nt){return _e.test(rt)===!0?rt.substring(nt,_e.lastIndex):null}matchWithExec(_e,rt){const nt=_e.exec(rt);return nt!==null?nt[0]:null}}Lexer.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Lexer.NA=/NOT_APPLICABLE/;function tokenLabel(tt){return hasTokenLabel(tt)?tt.LABEL:tt.name}function hasTokenLabel(tt){return isString$1(tt.LABEL)&&tt.LABEL!==""}const PARENT="parent",CATEGORIES="categories",LABEL="label",GROUP="group",PUSH_MODE="push_mode",POP_MODE="pop_mode",LONGER_ALT="longer_alt",LINE_BREAKS="line_breaks",START_CHARS_HINT="start_chars_hint";function createToken(tt){return createTokenInternal(tt)}function createTokenInternal(tt){const _e=tt.pattern,rt={};if(rt.name=tt.name,isUndefined(_e)||(rt.PATTERN=_e),has$1(tt,PARENT))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return has$1(tt,CATEGORIES)&&(rt.CATEGORIES=tt[CATEGORIES]),augmentTokenTypes([rt]),has$1(tt,LABEL)&&(rt.LABEL=tt[LABEL]),has$1(tt,GROUP)&&(rt.GROUP=tt[GROUP]),has$1(tt,POP_MODE)&&(rt.POP_MODE=tt[POP_MODE]),has$1(tt,PUSH_MODE)&&(rt.PUSH_MODE=tt[PUSH_MODE]),has$1(tt,LONGER_ALT)&&(rt.LONGER_ALT=tt[LONGER_ALT]),has$1(tt,LINE_BREAKS)&&(rt.LINE_BREAKS=tt[LINE_BREAKS]),has$1(tt,START_CHARS_HINT)&&(rt.START_CHARS_HINT=tt[START_CHARS_HINT]),rt}const EOF=createToken({name:"EOF",pattern:Lexer.NA});augmentTokenTypes([EOF]);function createTokenInstance(tt,_e,rt,nt,it,st,ot,lt){return{image:_e,startOffset:rt,endOffset:nt,startLine:it,endLine:st,startColumn:ot,endColumn:lt,tokenTypeIdx:tt.tokenTypeIdx,tokenType:tt}}function tokenMatcher(tt,_e){return tokenStructuredMatcher(tt,_e)}const defaultParserErrorProvider={buildMismatchTokenMessage({expected:tt,actual:_e,previous:rt,ruleName:nt}){return`Expecting ${hasTokenLabel(tt)?`--> ${tokenLabel(tt)} <--`:`token of type --> ${tt.name} <--`} but found --> '${_e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:tt,ruleName:_e}){return"Redundant input, expecting EOF but found: "+tt.image},buildNoViableAltMessage({expectedPathsPerAlt:tt,actual:_e,previous:rt,customUserDescription:nt,ruleName:it}){const st="Expecting: ",lt=`
but found: '`+head(_e).image+"'";if(nt)return st+nt+lt;{const at=reduce(tt,(dt,ft)=>dt.concat(ft),[]),ct=map(at,dt=>`[${map(dt,ft=>tokenLabel(ft)).join(", ")}]`),ht=`one of these possible Token sequences:
${map(ct,(dt,ft)=>`  ${ft+1}. ${dt}`).join(`
`)}`;return st+ht+lt}},buildEarlyExitMessage({expectedIterationPaths:tt,actual:_e,customUserDescription:rt,ruleName:nt}){const it="Expecting: ",ot=`
but found: '`+head(_e).image+"'";if(rt)return it+rt+ot;{const at=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${map(tt,ct=>`[${map(ct,ut=>tokenLabel(ut)).join(",")}]`).join(" ,")}>`;return it+at+ot}}};Object.freeze(defaultParserErrorProvider);const defaultGrammarResolverErrorProvider={buildRuleNotFoundError(tt,_e){return"Invalid grammar, reference to a rule which is not defined: ->"+_e.nonTerminalName+`<-
inside top level rule: ->`+tt.name+"<-"}},defaultGrammarValidatorErrorProvider={buildDuplicateFoundError(tt,_e){function rt(ut){return ut instanceof Terminal?ut.terminalType.name:ut instanceof NonTerminal?ut.nonTerminalName:""}const nt=tt.name,it=head(_e),st=it.idx,ot=getProductionDslName(it),lt=rt(it),at=st>0;let ct=`->${ot}${at?st:""}<- ${lt?`with argument: ->${lt}<-`:""}
                  appears more than once (${_e.length} times) in the top level rule: ->${nt}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return ct=ct.replace(/[ \t]+/g," "),ct=ct.replace(/\s\s+/g,`
`),ct},buildNamespaceConflictError(tt){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${tt.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(tt){const _e=map(tt.prefixPath,it=>tokenLabel(it)).join(", "),rt=tt.alternation.idx===0?"":tt.alternation.idx;return`Ambiguous alternatives: <${tt.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${rt}> inside <${tt.topLevelRule.name}> Rule,
<${_e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(tt){const _e=map(tt.prefixPath,it=>tokenLabel(it)).join(", "),rt=tt.alternation.idx===0?"":tt.alternation.idx;let nt=`Ambiguous Alternatives Detected: <${tt.ambiguityIndices.join(" ,")}> in <OR${rt}> inside <${tt.topLevelRule.name}> Rule,
<${_e}> may appears as a prefix path in all these alternatives.
`;return nt=nt+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,nt},buildEmptyRepetitionError(tt){let _e=getProductionDslName(tt.repetition);return tt.repetition.idx!==0&&(_e+=tt.repetition.idx),`The repetition <${_e}> within Rule <${tt.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(tt){return"deprecated"},buildEmptyAlternationError(tt){return`Ambiguous empty alternative: <${tt.emptyChoiceIdx+1}> in <OR${tt.alternation.idx}> inside <${tt.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(tt){return`An Alternation cannot have more than 256 alternatives:
<OR${tt.alternation.idx}> inside <${tt.topLevelRule.name}> Rule.
 has ${tt.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(tt){const _e=tt.topLevelRule.name,rt=map(tt.leftRecursionPath,st=>st.name),nt=`${_e} --> ${rt.concat([_e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${_e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${nt}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(tt){return"deprecated"},buildDuplicateRuleNameError(tt){let _e;return tt.topLevelRule instanceof Rule$1?_e=tt.topLevelRule.name:_e=tt.topLevelRule,`Duplicate definition, rule: ->${_e}<- is already defined in the grammar: ->${tt.grammarName}<-`}};function resolveGrammar$1(tt,_e){const rt=new GastRefResolverVisitor(tt,_e);return rt.resolveRefs(),rt.errors}class GastRefResolverVisitor extends GAstVisitor{constructor(_e,rt){super(),this.nameToTopRule=_e,this.errMsgProvider=rt,this.errors=[]}resolveRefs(){forEach(values(this.nameToTopRule),_e=>{this.currTopLevel=_e,_e.accept(this)})}visitNonTerminal(_e){const rt=this.nameToTopRule[_e.nonTerminalName];if(rt)_e.referencedRule=rt;else{const nt=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,_e);this.errors.push({message:nt,type:ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:_e.nonTerminalName})}}}class AbstractNextPossibleTokensWalker extends RestWalker{constructor(_e,rt){super(),this.topProd=_e,this.path=rt,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=clone(this.path.ruleStack).reverse(),this.occurrenceStack=clone(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(_e,rt=[]){this.found||super.walk(_e,rt)}walkProdRef(_e,rt,nt){if(_e.referencedRule.name===this.nextProductionName&&_e.idx===this.nextProductionOccurrence){const it=rt.concat(nt);this.updateExpectedNext(),this.walk(_e.referencedRule,it)}}updateExpectedNext(){isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class NextAfterTokenWalker extends AbstractNextPossibleTokensWalker{constructor(_e,rt){super(_e,rt),this.path=rt,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(_e,rt,nt){if(this.isAtEndOfPath&&_e.terminalType.name===this.nextTerminalName&&_e.idx===this.nextTerminalOccurrence&&!this.found){const it=rt.concat(nt),st=new Alternative({definition:it});this.possibleTokTypes=first$1(st),this.found=!0}}}class AbstractNextTerminalAfterProductionWalker extends RestWalker{constructor(_e,rt){super(),this.topRule=_e,this.occurrence=rt,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class NextTerminalAfterManyWalker extends AbstractNextTerminalAfterProductionWalker{walkMany(_e,rt,nt){if(_e.idx===this.occurrence){const it=head(rt.concat(nt));this.result.isEndOfRule=it===void 0,it instanceof Terminal&&(this.result.token=it.terminalType,this.result.occurrence=it.idx)}else super.walkMany(_e,rt,nt)}}class NextTerminalAfterManySepWalker extends AbstractNextTerminalAfterProductionWalker{walkManySep(_e,rt,nt){if(_e.idx===this.occurrence){const it=head(rt.concat(nt));this.result.isEndOfRule=it===void 0,it instanceof Terminal&&(this.result.token=it.terminalType,this.result.occurrence=it.idx)}else super.walkManySep(_e,rt,nt)}}class NextTerminalAfterAtLeastOneWalker extends AbstractNextTerminalAfterProductionWalker{walkAtLeastOne(_e,rt,nt){if(_e.idx===this.occurrence){const it=head(rt.concat(nt));this.result.isEndOfRule=it===void 0,it instanceof Terminal&&(this.result.token=it.terminalType,this.result.occurrence=it.idx)}else super.walkAtLeastOne(_e,rt,nt)}}class NextTerminalAfterAtLeastOneSepWalker extends AbstractNextTerminalAfterProductionWalker{walkAtLeastOneSep(_e,rt,nt){if(_e.idx===this.occurrence){const it=head(rt.concat(nt));this.result.isEndOfRule=it===void 0,it instanceof Terminal&&(this.result.token=it.terminalType,this.result.occurrence=it.idx)}else super.walkAtLeastOneSep(_e,rt,nt)}}function possiblePathsFrom(tt,_e,rt=[]){rt=clone(rt);let nt=[],it=0;function st(lt){return lt.concat(drop(tt,it+1))}function ot(lt){const at=possiblePathsFrom(st(lt),_e,rt);return nt.concat(at)}for(;rt.length<_e&&it<tt.length;){const lt=tt[it];if(lt instanceof Alternative)return ot(lt.definition);if(lt instanceof NonTerminal)return ot(lt.definition);if(lt instanceof Option)nt=ot(lt.definition);else if(lt instanceof RepetitionMandatory){const at=lt.definition.concat([new Repetition({definition:lt.definition})]);return ot(at)}else if(lt instanceof RepetitionMandatoryWithSeparator){const at=[new Alternative({definition:lt.definition}),new Repetition({definition:[new Terminal({terminalType:lt.separator})].concat(lt.definition)})];return ot(at)}else if(lt instanceof RepetitionWithSeparator){const at=lt.definition.concat([new Repetition({definition:[new Terminal({terminalType:lt.separator})].concat(lt.definition)})]);nt=ot(at)}else if(lt instanceof Repetition){const at=lt.definition.concat([new Repetition({definition:lt.definition})]);nt=ot(at)}else{if(lt instanceof Alternation)return forEach(lt.definition,at=>{isEmpty(at.definition)===!1&&(nt=ot(at.definition))}),nt;if(lt instanceof Terminal)rt.push(lt.terminalType);else throw Error("non exhaustive match")}it++}return nt.push({partialPath:rt,suffixDef:drop(tt,it)}),nt}function nextPossibleTokensAfter(tt,_e,rt,nt){const it="EXIT_NONE_TERMINAL",st=[it],ot="EXIT_ALTERNATIVE";let lt=!1;const at=_e.length,ct=at-nt-1,ut=[],ht=[];for(ht.push({idx:-1,def:tt,ruleStack:[],occurrenceStack:[]});!isEmpty(ht);){const dt=ht.pop();if(dt===ot){lt&&last(ht).idx<=ct&&ht.pop();continue}const ft=dt.def,pt=dt.idx,mt=dt.ruleStack,gt=dt.occurrenceStack;if(isEmpty(ft))continue;const vt=ft[0];if(vt===it){const At={idx:pt,def:drop(ft),ruleStack:dropRight(mt),occurrenceStack:dropRight(gt)};ht.push(At)}else if(vt instanceof Terminal)if(pt<at-1){const At=pt+1,yt=_e[At];if(rt(yt,vt.terminalType)){const xt={idx:At,def:drop(ft),ruleStack:mt,occurrenceStack:gt};ht.push(xt)}}else if(pt===at-1)ut.push({nextTokenType:vt.terminalType,nextTokenOccurrence:vt.idx,ruleStack:mt,occurrenceStack:gt}),lt=!0;else throw Error("non exhaustive match");else if(vt instanceof NonTerminal){const At=clone(mt);At.push(vt.nonTerminalName);const yt=clone(gt);yt.push(vt.idx);const xt={idx:pt,def:vt.definition.concat(st,drop(ft)),ruleStack:At,occurrenceStack:yt};ht.push(xt)}else if(vt instanceof Option){const At={idx:pt,def:drop(ft),ruleStack:mt,occurrenceStack:gt};ht.push(At),ht.push(ot);const yt={idx:pt,def:vt.definition.concat(drop(ft)),ruleStack:mt,occurrenceStack:gt};ht.push(yt)}else if(vt instanceof RepetitionMandatory){const At=new Repetition({definition:vt.definition,idx:vt.idx}),yt=vt.definition.concat([At],drop(ft)),xt={idx:pt,def:yt,ruleStack:mt,occurrenceStack:gt};ht.push(xt)}else if(vt instanceof RepetitionMandatoryWithSeparator){const At=new Terminal({terminalType:vt.separator}),yt=new Repetition({definition:[At].concat(vt.definition),idx:vt.idx}),xt=vt.definition.concat([yt],drop(ft)),_t={idx:pt,def:xt,ruleStack:mt,occurrenceStack:gt};ht.push(_t)}else if(vt instanceof RepetitionWithSeparator){const At={idx:pt,def:drop(ft),ruleStack:mt,occurrenceStack:gt};ht.push(At),ht.push(ot);const yt=new Terminal({terminalType:vt.separator}),xt=new Repetition({definition:[yt].concat(vt.definition),idx:vt.idx}),_t=vt.definition.concat([xt],drop(ft)),Et={idx:pt,def:_t,ruleStack:mt,occurrenceStack:gt};ht.push(Et)}else if(vt instanceof Repetition){const At={idx:pt,def:drop(ft),ruleStack:mt,occurrenceStack:gt};ht.push(At),ht.push(ot);const yt=new Repetition({definition:vt.definition,idx:vt.idx}),xt=vt.definition.concat([yt],drop(ft)),_t={idx:pt,def:xt,ruleStack:mt,occurrenceStack:gt};ht.push(_t)}else if(vt instanceof Alternation)for(let At=vt.definition.length-1;At>=0;At--){const yt=vt.definition[At],xt={idx:pt,def:yt.definition.concat(drop(ft)),ruleStack:mt,occurrenceStack:gt};ht.push(xt),ht.push(ot)}else if(vt instanceof Alternative)ht.push({idx:pt,def:vt.definition.concat(drop(ft)),ruleStack:mt,occurrenceStack:gt});else if(vt instanceof Rule$1)ht.push(expandTopLevelRule(vt,pt,mt,gt));else throw Error("non exhaustive match")}return ut}function expandTopLevelRule(tt,_e,rt,nt){const it=clone(rt);it.push(tt.name);const st=clone(nt);return st.push(1),{idx:_e,def:tt.definition,ruleStack:it,occurrenceStack:st}}var PROD_TYPE;(function(tt){tt[tt.OPTION=0]="OPTION",tt[tt.REPETITION=1]="REPETITION",tt[tt.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",tt[tt.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",tt[tt.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",tt[tt.ALTERNATION=5]="ALTERNATION"})(PROD_TYPE||(PROD_TYPE={}));function getProdType(tt){if(tt instanceof Option||tt==="Option")return PROD_TYPE.OPTION;if(tt instanceof Repetition||tt==="Repetition")return PROD_TYPE.REPETITION;if(tt instanceof RepetitionMandatory||tt==="RepetitionMandatory")return PROD_TYPE.REPETITION_MANDATORY;if(tt instanceof RepetitionMandatoryWithSeparator||tt==="RepetitionMandatoryWithSeparator")return PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR;if(tt instanceof RepetitionWithSeparator||tt==="RepetitionWithSeparator")return PROD_TYPE.REPETITION_WITH_SEPARATOR;if(tt instanceof Alternation||tt==="Alternation")return PROD_TYPE.ALTERNATION;throw Error("non exhaustive match")}function buildLookaheadFuncForOr(tt,_e,rt,nt,it,st){const ot=getLookaheadPathsForOr(tt,_e,rt),lt=areTokenCategoriesNotUsed(ot)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return st(ot,nt,lt,it)}function buildLookaheadFuncForOptionalProd(tt,_e,rt,nt,it,st){const ot=getLookaheadPathsForOptionalProd(tt,_e,it,rt),lt=areTokenCategoriesNotUsed(ot)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return st(ot[0],lt,nt)}function buildAlternativesLookAheadFunc(tt,_e,rt,nt){const it=tt.length,st=every(tt,ot=>every(ot,lt=>lt.length===1));if(_e)return function(ot){const lt=map(ot,at=>at.GATE);for(let at=0;at<it;at++){const ct=tt[at],ut=ct.length,ht=lt[at];if(!(ht!==void 0&&ht.call(this)===!1))e:for(let dt=0;dt<ut;dt++){const ft=ct[dt],pt=ft.length;for(let mt=0;mt<pt;mt++){const gt=this.LA(mt+1);if(rt(gt,ft[mt])===!1)continue e}return at}}};if(st&&!nt){const ot=map(tt,at=>flatten$1(at)),lt=reduce(ot,(at,ct,ut)=>(forEach(ct,ht=>{has$1(at,ht.tokenTypeIdx)||(at[ht.tokenTypeIdx]=ut),forEach(ht.categoryMatches,dt=>{has$1(at,dt)||(at[dt]=ut)})}),at),{});return function(){const at=this.LA(1);return lt[at.tokenTypeIdx]}}else return function(){for(let ot=0;ot<it;ot++){const lt=tt[ot],at=lt.length;e:for(let ct=0;ct<at;ct++){const ut=lt[ct],ht=ut.length;for(let dt=0;dt<ht;dt++){const ft=this.LA(dt+1);if(rt(ft,ut[dt])===!1)continue e}return ot}}}}function buildSingleAlternativeLookaheadFunction(tt,_e,rt){const nt=every(tt,st=>st.length===1),it=tt.length;if(nt&&!rt){const st=flatten$1(tt);if(st.length===1&&isEmpty(st[0].categoryMatches)){const lt=st[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===lt}}else{const ot=reduce(st,(lt,at,ct)=>(lt[at.tokenTypeIdx]=!0,forEach(at.categoryMatches,ut=>{lt[ut]=!0}),lt),[]);return function(){const lt=this.LA(1);return ot[lt.tokenTypeIdx]===!0}}}else return function(){e:for(let st=0;st<it;st++){const ot=tt[st],lt=ot.length;for(let at=0;at<lt;at++){const ct=this.LA(at+1);if(_e(ct,ot[at])===!1)continue e}return!0}return!1}}class RestDefinitionFinderWalker extends RestWalker{constructor(_e,rt,nt){super(),this.topProd=_e,this.targetOccurrence=rt,this.targetProdType=nt}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(_e,rt,nt,it){return _e.idx===this.targetOccurrence&&this.targetProdType===rt?(this.restDef=nt.concat(it),!0):!1}walkOption(_e,rt,nt){this.checkIsTarget(_e,PROD_TYPE.OPTION,rt,nt)||super.walkOption(_e,rt,nt)}walkAtLeastOne(_e,rt,nt){this.checkIsTarget(_e,PROD_TYPE.REPETITION_MANDATORY,rt,nt)||super.walkOption(_e,rt,nt)}walkAtLeastOneSep(_e,rt,nt){this.checkIsTarget(_e,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,rt,nt)||super.walkOption(_e,rt,nt)}walkMany(_e,rt,nt){this.checkIsTarget(_e,PROD_TYPE.REPETITION,rt,nt)||super.walkOption(_e,rt,nt)}walkManySep(_e,rt,nt){this.checkIsTarget(_e,PROD_TYPE.REPETITION_WITH_SEPARATOR,rt,nt)||super.walkOption(_e,rt,nt)}}class InsideDefinitionFinderVisitor extends GAstVisitor{constructor(_e,rt,nt){super(),this.targetOccurrence=_e,this.targetProdType=rt,this.targetRef=nt,this.result=[]}checkIsTarget(_e,rt){_e.idx===this.targetOccurrence&&this.targetProdType===rt&&(this.targetRef===void 0||_e===this.targetRef)&&(this.result=_e.definition)}visitOption(_e){this.checkIsTarget(_e,PROD_TYPE.OPTION)}visitRepetition(_e){this.checkIsTarget(_e,PROD_TYPE.REPETITION)}visitRepetitionMandatory(_e){this.checkIsTarget(_e,PROD_TYPE.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(_e){this.checkIsTarget(_e,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(_e){this.checkIsTarget(_e,PROD_TYPE.REPETITION_WITH_SEPARATOR)}visitAlternation(_e){this.checkIsTarget(_e,PROD_TYPE.ALTERNATION)}}function initializeArrayOfArrays(tt){const _e=new Array(tt);for(let rt=0;rt<tt;rt++)_e[rt]=[];return _e}function pathToHashKeys(tt){let _e=[""];for(let rt=0;rt<tt.length;rt++){const nt=tt[rt],it=[];for(let st=0;st<_e.length;st++){const ot=_e[st];it.push(ot+"_"+nt.tokenTypeIdx);for(let lt=0;lt<nt.categoryMatches.length;lt++){const at="_"+nt.categoryMatches[lt];it.push(ot+at)}}_e=it}return _e}function isUniquePrefixHash(tt,_e,rt){for(let nt=0;nt<tt.length;nt++){if(nt===rt)continue;const it=tt[nt];for(let st=0;st<_e.length;st++){const ot=_e[st];if(it[ot]===!0)return!1}}return!0}function lookAheadSequenceFromAlternatives(tt,_e){const rt=map(tt,ot=>possiblePathsFrom([ot],1)),nt=initializeArrayOfArrays(rt.length),it=map(rt,ot=>{const lt={};return forEach(ot,at=>{const ct=pathToHashKeys(at.partialPath);forEach(ct,ut=>{lt[ut]=!0})}),lt});let st=rt;for(let ot=1;ot<=_e;ot++){const lt=st;st=initializeArrayOfArrays(lt.length);for(let at=0;at<lt.length;at++){const ct=lt[at];for(let ut=0;ut<ct.length;ut++){const ht=ct[ut].partialPath,dt=ct[ut].suffixDef,ft=pathToHashKeys(ht);if(isUniquePrefixHash(it,ft,at)||isEmpty(dt)||ht.length===_e){const mt=nt[at];if(containsPath(mt,ht)===!1){mt.push(ht);for(let gt=0;gt<ft.length;gt++){const vt=ft[gt];it[at][vt]=!0}}}else{const mt=possiblePathsFrom(dt,ot+1,ht);st[at]=st[at].concat(mt),forEach(mt,gt=>{const vt=pathToHashKeys(gt.partialPath);forEach(vt,At=>{it[at][At]=!0})})}}}}return nt}function getLookaheadPathsForOr(tt,_e,rt,nt){const it=new InsideDefinitionFinderVisitor(tt,PROD_TYPE.ALTERNATION,nt);return _e.accept(it),lookAheadSequenceFromAlternatives(it.result,rt)}function getLookaheadPathsForOptionalProd(tt,_e,rt,nt){const it=new InsideDefinitionFinderVisitor(tt,rt);_e.accept(it);const st=it.result,lt=new RestDefinitionFinderWalker(_e,tt,rt).startWalking(),at=new Alternative({definition:st}),ct=new Alternative({definition:lt});return lookAheadSequenceFromAlternatives([at,ct],nt)}function containsPath(tt,_e){e:for(let rt=0;rt<tt.length;rt++){const nt=tt[rt];if(nt.length===_e.length){for(let it=0;it<nt.length;it++){const st=_e[it],ot=nt[it];if((st===ot||ot.categoryMatchesMap[st.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function isStrictPrefixOfPath(tt,_e){return tt.length<_e.length&&every(tt,(rt,nt)=>{const it=_e[nt];return rt===it||it.categoryMatchesMap[rt.tokenTypeIdx]})}function areTokenCategoriesNotUsed(tt){return every(tt,_e=>every(_e,rt=>every(rt,nt=>isEmpty(nt.categoryMatches))))}function validateLookahead(tt){const _e=tt.lookaheadStrategy.validate({rules:tt.rules,tokenTypes:tt.tokenTypes,grammarName:tt.grammarName});return map(_e,rt=>Object.assign({type:ParserDefinitionErrorType.CUSTOM_LOOKAHEAD_VALIDATION},rt))}function validateGrammar$1(tt,_e,rt,nt){const it=flatMap(tt,at=>validateDuplicateProductions(at,rt)),st=checkTerminalAndNoneTerminalsNameSpace(tt,_e,rt),ot=flatMap(tt,at=>validateTooManyAlts(at,rt)),lt=flatMap(tt,at=>validateRuleDoesNotAlreadyExist(at,tt,nt,rt));return it.concat(st,ot,lt)}function validateDuplicateProductions(tt,_e){const rt=new OccurrenceValidationCollector;tt.accept(rt);const nt=rt.allProductions,it=groupBy$1(nt,identifyProductionForDuplicates),st=pickBy(it,lt=>lt.length>1);return map(values(st),lt=>{const at=head(lt),ct=_e.buildDuplicateFoundError(tt,lt),ut=getProductionDslName(at),ht={message:ct,type:ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:tt.name,dslName:ut,occurrence:at.idx},dt=getExtraProductionArgument(at);return dt&&(ht.parameter=dt),ht})}function identifyProductionForDuplicates(tt){return`${getProductionDslName(tt)}_#_${tt.idx}_#_${getExtraProductionArgument(tt)}`}function getExtraProductionArgument(tt){return tt instanceof Terminal?tt.terminalType.name:tt instanceof NonTerminal?tt.nonTerminalName:""}class OccurrenceValidationCollector extends GAstVisitor{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(_e){this.allProductions.push(_e)}visitOption(_e){this.allProductions.push(_e)}visitRepetitionWithSeparator(_e){this.allProductions.push(_e)}visitRepetitionMandatory(_e){this.allProductions.push(_e)}visitRepetitionMandatoryWithSeparator(_e){this.allProductions.push(_e)}visitRepetition(_e){this.allProductions.push(_e)}visitAlternation(_e){this.allProductions.push(_e)}visitTerminal(_e){this.allProductions.push(_e)}}function validateRuleDoesNotAlreadyExist(tt,_e,rt,nt){const it=[];if(reduce(_e,(ot,lt)=>lt.name===tt.name?ot+1:ot,0)>1){const ot=nt.buildDuplicateRuleNameError({topLevelRule:tt,grammarName:rt});it.push({message:ot,type:ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:tt.name})}return it}function validateRuleIsOverridden(tt,_e,rt){const nt=[];let it;return includes(_e,tt)||(it=`Invalid rule override, rule: ->${tt}<- cannot be overridden in the grammar: ->${rt}<-as it is not defined in any of the super grammars `,nt.push({message:it,type:ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:tt})),nt}function validateNoLeftRecursion(tt,_e,rt,nt=[]){const it=[],st=getFirstNoneTerminal(_e.definition);if(isEmpty(st))return[];{const ot=tt.name;includes(st,tt)&&it.push({message:rt.buildLeftRecursionError({topLevelRule:tt,leftRecursionPath:nt}),type:ParserDefinitionErrorType.LEFT_RECURSION,ruleName:ot});const at=difference$1(st,nt.concat([tt])),ct=flatMap(at,ut=>{const ht=clone(nt);return ht.push(ut),validateNoLeftRecursion(tt,ut,rt,ht)});return it.concat(ct)}}function getFirstNoneTerminal(tt){let _e=[];if(isEmpty(tt))return _e;const rt=head(tt);if(rt instanceof NonTerminal)_e.push(rt.referencedRule);else if(rt instanceof Alternative||rt instanceof Option||rt instanceof RepetitionMandatory||rt instanceof RepetitionMandatoryWithSeparator||rt instanceof RepetitionWithSeparator||rt instanceof Repetition)_e=_e.concat(getFirstNoneTerminal(rt.definition));else if(rt instanceof Alternation)_e=flatten$1(map(rt.definition,st=>getFirstNoneTerminal(st.definition)));else if(!(rt instanceof Terminal))throw Error("non exhaustive match");const nt=isOptionalProd(rt),it=tt.length>1;if(nt&&it){const st=drop(tt);return _e.concat(getFirstNoneTerminal(st))}else return _e}class OrCollector extends GAstVisitor{constructor(){super(...arguments),this.alternations=[]}visitAlternation(_e){this.alternations.push(_e)}}function validateEmptyOrAlternative(tt,_e){const rt=new OrCollector;tt.accept(rt);const nt=rt.alternations;return flatMap(nt,st=>{const ot=dropRight(st.definition);return flatMap(ot,(lt,at)=>{const ct=nextPossibleTokensAfter([lt],[],tokenStructuredMatcher,1);return isEmpty(ct)?[{message:_e.buildEmptyAlternationError({topLevelRule:tt,alternation:st,emptyChoiceIdx:at}),type:ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:tt.name,occurrence:st.idx,alternative:at+1}]:[]})})}function validateAmbiguousAlternationAlternatives(tt,_e,rt){const nt=new OrCollector;tt.accept(nt);let it=nt.alternations;return it=reject(it,ot=>ot.ignoreAmbiguities===!0),flatMap(it,ot=>{const lt=ot.idx,at=ot.maxLookahead||_e,ct=getLookaheadPathsForOr(lt,tt,at,ot),ut=checkAlternativesAmbiguities(ct,ot,tt,rt),ht=checkPrefixAlternativesAmbiguities(ct,ot,tt,rt);return ut.concat(ht)})}class RepetitionCollector extends GAstVisitor{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(_e){this.allProductions.push(_e)}visitRepetitionMandatory(_e){this.allProductions.push(_e)}visitRepetitionMandatoryWithSeparator(_e){this.allProductions.push(_e)}visitRepetition(_e){this.allProductions.push(_e)}}function validateTooManyAlts(tt,_e){const rt=new OrCollector;tt.accept(rt);const nt=rt.alternations;return flatMap(nt,st=>st.definition.length>255?[{message:_e.buildTooManyAlternativesError({topLevelRule:tt,alternation:st}),type:ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:tt.name,occurrence:st.idx}]:[])}function validateSomeNonEmptyLookaheadPath(tt,_e,rt){const nt=[];return forEach(tt,it=>{const st=new RepetitionCollector;it.accept(st);const ot=st.allProductions;forEach(ot,lt=>{const at=getProdType(lt),ct=lt.maxLookahead||_e,ut=lt.idx,dt=getLookaheadPathsForOptionalProd(ut,it,at,ct)[0];if(isEmpty(flatten$1(dt))){const ft=rt.buildEmptyRepetitionError({topLevelRule:it,repetition:lt});nt.push({message:ft,type:ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:it.name})}})}),nt}function checkAlternativesAmbiguities(tt,_e,rt,nt){const it=[],st=reduce(tt,(lt,at,ct)=>(_e.definition[ct].ignoreAmbiguities===!0||forEach(at,ut=>{const ht=[ct];forEach(tt,(dt,ft)=>{ct!==ft&&containsPath(dt,ut)&&_e.definition[ft].ignoreAmbiguities!==!0&&ht.push(ft)}),ht.length>1&&!containsPath(it,ut)&&(it.push(ut),lt.push({alts:ht,path:ut}))}),lt),[]);return map(st,lt=>{const at=map(lt.alts,ut=>ut+1);return{message:nt.buildAlternationAmbiguityError({topLevelRule:rt,alternation:_e,ambiguityIndices:at,prefixPath:lt.path}),type:ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:rt.name,occurrence:_e.idx,alternatives:lt.alts}})}function checkPrefixAlternativesAmbiguities(tt,_e,rt,nt){const it=reduce(tt,(ot,lt,at)=>{const ct=map(lt,ut=>({idx:at,path:ut}));return ot.concat(ct)},[]);return compact(flatMap(it,ot=>{if(_e.definition[ot.idx].ignoreAmbiguities===!0)return[];const at=ot.idx,ct=ot.path,ut=filter(it,dt=>_e.definition[dt.idx].ignoreAmbiguities!==!0&&dt.idx<at&&isStrictPrefixOfPath(dt.path,ct));return map(ut,dt=>{const ft=[dt.idx+1,at+1],pt=_e.idx===0?"":_e.idx;return{message:nt.buildAlternationPrefixAmbiguityError({topLevelRule:rt,alternation:_e,ambiguityIndices:ft,prefixPath:dt.path}),type:ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:rt.name,occurrence:pt,alternatives:ft}})}))}function checkTerminalAndNoneTerminalsNameSpace(tt,_e,rt){const nt=[],it=map(_e,st=>st.name);return forEach(tt,st=>{const ot=st.name;if(includes(it,ot)){const lt=rt.buildNamespaceConflictError(st);nt.push({message:lt,type:ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:ot})}}),nt}function resolveGrammar(tt){const _e=defaults$1(tt,{errMsgProvider:defaultGrammarResolverErrorProvider}),rt={};return forEach(tt.rules,nt=>{rt[nt.name]=nt}),resolveGrammar$1(rt,_e.errMsgProvider)}function validateGrammar(tt){return tt=defaults$1(tt,{errMsgProvider:defaultGrammarValidatorErrorProvider}),validateGrammar$1(tt.rules,tt.tokenTypes,tt.errMsgProvider,tt.grammarName)}const MISMATCHED_TOKEN_EXCEPTION="MismatchedTokenException",NO_VIABLE_ALT_EXCEPTION="NoViableAltException",EARLY_EXIT_EXCEPTION="EarlyExitException",NOT_ALL_INPUT_PARSED_EXCEPTION="NotAllInputParsedException",RECOGNITION_EXCEPTION_NAMES=[MISMATCHED_TOKEN_EXCEPTION,NO_VIABLE_ALT_EXCEPTION,EARLY_EXIT_EXCEPTION,NOT_ALL_INPUT_PARSED_EXCEPTION];Object.freeze(RECOGNITION_EXCEPTION_NAMES);function isRecognitionException(tt){return includes(RECOGNITION_EXCEPTION_NAMES,tt.name)}class RecognitionException extends Error{constructor(_e,rt){super(_e),this.token=rt,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class MismatchedTokenException extends RecognitionException{constructor(_e,rt,nt){super(_e,rt),this.previousToken=nt,this.name=MISMATCHED_TOKEN_EXCEPTION}}class NoViableAltException extends RecognitionException{constructor(_e,rt,nt){super(_e,rt),this.previousToken=nt,this.name=NO_VIABLE_ALT_EXCEPTION}}class NotAllInputParsedException extends RecognitionException{constructor(_e,rt){super(_e,rt),this.name=NOT_ALL_INPUT_PARSED_EXCEPTION}}class EarlyExitException extends RecognitionException{constructor(_e,rt,nt){super(_e,rt),this.previousToken=nt,this.name=EARLY_EXIT_EXCEPTION}}const EOF_FOLLOW_KEY={},IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException";class InRuleRecoveryException extends Error{constructor(_e){super(_e),this.name=IN_RULE_RECOVERY_EXCEPTION}}class Recoverable{initRecoverable(_e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=has$1(_e,"recoveryEnabled")?_e.recoveryEnabled:DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=attemptInRepetitionRecovery)}getTokenToInsert(_e){const rt=createTokenInstance(_e,"",NaN,NaN,NaN,NaN,NaN,NaN);return rt.isInsertedInRecovery=!0,rt}canTokenTypeBeInsertedInRecovery(_e){return!0}canTokenTypeBeDeletedInRecovery(_e){return!0}tryInRepetitionRecovery(_e,rt,nt,it){const st=this.findReSyncTokenType(),ot=this.exportLexerState(),lt=[];let at=!1;const ct=this.LA(1);let ut=this.LA(1);const ht=()=>{const dt=this.LA(0),ft=this.errorMessageProvider.buildMismatchTokenMessage({expected:it,actual:ct,previous:dt,ruleName:this.getCurrRuleFullName()}),pt=new MismatchedTokenException(ft,ct,this.LA(0));pt.resyncedTokens=dropRight(lt),this.SAVE_ERROR(pt)};for(;!at;)if(this.tokenMatcher(ut,it)){ht();return}else if(nt.call(this)){ht(),_e.apply(this,rt);return}else this.tokenMatcher(ut,st)?at=!0:(ut=this.SKIP_TOKEN(),this.addToResyncTokens(ut,lt));this.importLexerState(ot)}shouldInRepetitionRecoveryBeTried(_e,rt,nt){return!(nt===!1||this.tokenMatcher(this.LA(1),_e)||this.isBackTracking()||this.canPerformInRuleRecovery(_e,this.getFollowsForInRuleRecovery(_e,rt)))}getFollowsForInRuleRecovery(_e,rt){const nt=this.getCurrentGrammarPath(_e,rt);return this.getNextPossibleTokenTypes(nt)}tryInRuleRecovery(_e,rt){if(this.canRecoverWithSingleTokenInsertion(_e,rt))return this.getTokenToInsert(_e);if(this.canRecoverWithSingleTokenDeletion(_e)){const nt=this.SKIP_TOKEN();return this.consumeToken(),nt}throw new InRuleRecoveryException("sad sad panda")}canPerformInRuleRecovery(_e,rt){return this.canRecoverWithSingleTokenInsertion(_e,rt)||this.canRecoverWithSingleTokenDeletion(_e)}canRecoverWithSingleTokenInsertion(_e,rt){if(!this.canTokenTypeBeInsertedInRecovery(_e)||isEmpty(rt))return!1;const nt=this.LA(1);return find$1(rt,st=>this.tokenMatcher(nt,st))!==void 0}canRecoverWithSingleTokenDeletion(_e){return this.canTokenTypeBeDeletedInRecovery(_e)?this.tokenMatcher(this.LA(2),_e):!1}isInCurrentRuleReSyncSet(_e){const rt=this.getCurrFollowKey(),nt=this.getFollowSetFromFollowKey(rt);return includes(nt,_e)}findReSyncTokenType(){const _e=this.flattenFollowSet();let rt=this.LA(1),nt=2;for(;;){const it=find$1(_e,st=>tokenMatcher(rt,st));if(it!==void 0)return it;rt=this.LA(nt),nt++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return EOF_FOLLOW_KEY;const _e=this.getLastExplicitRuleShortName(),rt=this.getLastExplicitRuleOccurrenceIndex(),nt=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(_e),idxInCallingRule:rt,inRule:this.shortRuleNameToFullName(nt)}}buildFullFollowKeyStack(){const _e=this.RULE_STACK,rt=this.RULE_OCCURRENCE_STACK;return map(_e,(nt,it)=>it===0?EOF_FOLLOW_KEY:{ruleName:this.shortRuleNameToFullName(nt),idxInCallingRule:rt[it],inRule:this.shortRuleNameToFullName(_e[it-1])})}flattenFollowSet(){const _e=map(this.buildFullFollowKeyStack(),rt=>this.getFollowSetFromFollowKey(rt));return flatten$1(_e)}getFollowSetFromFollowKey(_e){if(_e===EOF_FOLLOW_KEY)return[EOF];const rt=_e.ruleName+_e.idxInCallingRule+IN+_e.inRule;return this.resyncFollows[rt]}addToResyncTokens(_e,rt){return this.tokenMatcher(_e,EOF)||rt.push(_e),rt}reSyncTo(_e){const rt=[];let nt=this.LA(1);for(;this.tokenMatcher(nt,_e)===!1;)nt=this.SKIP_TOKEN(),this.addToResyncTokens(nt,rt);return dropRight(rt)}attemptInRepetitionRecovery(_e,rt,nt,it,st,ot,lt){}getCurrentGrammarPath(_e,rt){const nt=this.getHumanReadableRuleStack(),it=clone(this.RULE_OCCURRENCE_STACK);return{ruleStack:nt,occurrenceStack:it,lastTok:_e,lastTokOccurrence:rt}}getHumanReadableRuleStack(){return map(this.RULE_STACK,_e=>this.shortRuleNameToFullName(_e))}}function attemptInRepetitionRecovery(tt,_e,rt,nt,it,st,ot){const lt=this.getKeyForAutomaticLookahead(nt,it);let at=this.firstAfterRepMap[lt];if(at===void 0){const dt=this.getCurrRuleFullName(),ft=this.getGAstProductions()[dt];at=new st(ft,it).startWalking(),this.firstAfterRepMap[lt]=at}let ct=at.token,ut=at.occurrence;const ht=at.isEndOfRule;this.RULE_STACK.length===1&&ht&&ct===void 0&&(ct=EOF,ut=1),!(ct===void 0||ut===void 0)&&this.shouldInRepetitionRecoveryBeTried(ct,ut,ot)&&this.tryInRepetitionRecovery(tt,_e,rt,ct)}const BITS_FOR_METHOD_TYPE=4,BITS_FOR_OCCURRENCE_IDX=8,OR_IDX=1<<BITS_FOR_OCCURRENCE_IDX,OPTION_IDX=2<<BITS_FOR_OCCURRENCE_IDX,MANY_IDX=3<<BITS_FOR_OCCURRENCE_IDX,AT_LEAST_ONE_IDX=4<<BITS_FOR_OCCURRENCE_IDX,MANY_SEP_IDX=5<<BITS_FOR_OCCURRENCE_IDX,AT_LEAST_ONE_SEP_IDX=6<<BITS_FOR_OCCURRENCE_IDX;function getKeyForAutomaticLookahead(tt,_e,rt){return rt|_e|tt}class LLkLookaheadStrategy{constructor(_e){var rt;this.maxLookahead=(rt=_e==null?void 0:_e.maxLookahead)!==null&&rt!==void 0?rt:DEFAULT_PARSER_CONFIG.maxLookahead}validate(_e){const rt=this.validateNoLeftRecursion(_e.rules);if(isEmpty(rt)){const nt=this.validateEmptyOrAlternatives(_e.rules),it=this.validateAmbiguousAlternationAlternatives(_e.rules,this.maxLookahead),st=this.validateSomeNonEmptyLookaheadPath(_e.rules,this.maxLookahead);return[...rt,...nt,...it,...st]}return rt}validateNoLeftRecursion(_e){return flatMap(_e,rt=>validateNoLeftRecursion(rt,rt,defaultGrammarValidatorErrorProvider))}validateEmptyOrAlternatives(_e){return flatMap(_e,rt=>validateEmptyOrAlternative(rt,defaultGrammarValidatorErrorProvider))}validateAmbiguousAlternationAlternatives(_e,rt){return flatMap(_e,nt=>validateAmbiguousAlternationAlternatives(nt,rt,defaultGrammarValidatorErrorProvider))}validateSomeNonEmptyLookaheadPath(_e,rt){return validateSomeNonEmptyLookaheadPath(_e,rt,defaultGrammarValidatorErrorProvider)}buildLookaheadForAlternation(_e){return buildLookaheadFuncForOr(_e.prodOccurrence,_e.rule,_e.maxLookahead,_e.hasPredicates,_e.dynamicTokensEnabled,buildAlternativesLookAheadFunc)}buildLookaheadForOptional(_e){return buildLookaheadFuncForOptionalProd(_e.prodOccurrence,_e.rule,_e.maxLookahead,_e.dynamicTokensEnabled,getProdType(_e.prodType),buildSingleAlternativeLookaheadFunction)}}class LooksAhead{initLooksAhead(_e){this.dynamicTokensEnabled=has$1(_e,"dynamicTokensEnabled")?_e.dynamicTokensEnabled:DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=has$1(_e,"maxLookahead")?_e.maxLookahead:DEFAULT_PARSER_CONFIG.maxLookahead,this.lookaheadStrategy=has$1(_e,"lookaheadStrategy")?_e.lookaheadStrategy:new LLkLookaheadStrategy({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(_e){forEach(_e,rt=>{this.TRACE_INIT(`${rt.name} Rule Lookahead`,()=>{const{alternation:nt,repetition:it,option:st,repetitionMandatory:ot,repetitionMandatoryWithSeparator:lt,repetitionWithSeparator:at}=collectMethods(rt);forEach(nt,ct=>{const ut=ct.idx===0?"":ct.idx;this.TRACE_INIT(`${getProductionDslName(ct)}${ut}`,()=>{const ht=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:ct.idx,rule:rt,maxLookahead:ct.maxLookahead||this.maxLookahead,hasPredicates:ct.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),dt=getKeyForAutomaticLookahead(this.fullRuleNameToShort[rt.name],OR_IDX,ct.idx);this.setLaFuncCache(dt,ht)})}),forEach(it,ct=>{this.computeLookaheadFunc(rt,ct.idx,MANY_IDX,"Repetition",ct.maxLookahead,getProductionDslName(ct))}),forEach(st,ct=>{this.computeLookaheadFunc(rt,ct.idx,OPTION_IDX,"Option",ct.maxLookahead,getProductionDslName(ct))}),forEach(ot,ct=>{this.computeLookaheadFunc(rt,ct.idx,AT_LEAST_ONE_IDX,"RepetitionMandatory",ct.maxLookahead,getProductionDslName(ct))}),forEach(lt,ct=>{this.computeLookaheadFunc(rt,ct.idx,AT_LEAST_ONE_SEP_IDX,"RepetitionMandatoryWithSeparator",ct.maxLookahead,getProductionDslName(ct))}),forEach(at,ct=>{this.computeLookaheadFunc(rt,ct.idx,MANY_SEP_IDX,"RepetitionWithSeparator",ct.maxLookahead,getProductionDslName(ct))})})})}computeLookaheadFunc(_e,rt,nt,it,st,ot){this.TRACE_INIT(`${ot}${rt===0?"":rt}`,()=>{const lt=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:rt,rule:_e,maxLookahead:st||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:it}),at=getKeyForAutomaticLookahead(this.fullRuleNameToShort[_e.name],nt,rt);this.setLaFuncCache(at,lt)})}getKeyForAutomaticLookahead(_e,rt){const nt=this.getLastExplicitRuleShortName();return getKeyForAutomaticLookahead(nt,_e,rt)}getLaFuncFromCache(_e){return this.lookAheadFuncsCache.get(_e)}setLaFuncCache(_e,rt){this.lookAheadFuncsCache.set(_e,rt)}}class DslMethodsCollectorVisitor extends GAstVisitor{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(_e){this.dslMethods.option.push(_e)}visitRepetitionWithSeparator(_e){this.dslMethods.repetitionWithSeparator.push(_e)}visitRepetitionMandatory(_e){this.dslMethods.repetitionMandatory.push(_e)}visitRepetitionMandatoryWithSeparator(_e){this.dslMethods.repetitionMandatoryWithSeparator.push(_e)}visitRepetition(_e){this.dslMethods.repetition.push(_e)}visitAlternation(_e){this.dslMethods.alternation.push(_e)}}const collectorVisitor=new DslMethodsCollectorVisitor;function collectMethods(tt){collectorVisitor.reset(),tt.accept(collectorVisitor);const _e=collectorVisitor.dslMethods;return collectorVisitor.reset(),_e}function setNodeLocationOnlyOffset(tt,_e){isNaN(tt.startOffset)===!0?(tt.startOffset=_e.startOffset,tt.endOffset=_e.endOffset):tt.endOffset<_e.endOffset&&(tt.endOffset=_e.endOffset)}function setNodeLocationFull(tt,_e){isNaN(tt.startOffset)===!0?(tt.startOffset=_e.startOffset,tt.startColumn=_e.startColumn,tt.startLine=_e.startLine,tt.endOffset=_e.endOffset,tt.endColumn=_e.endColumn,tt.endLine=_e.endLine):tt.endOffset<_e.endOffset&&(tt.endOffset=_e.endOffset,tt.endColumn=_e.endColumn,tt.endLine=_e.endLine)}function addTerminalToCst(tt,_e,rt){tt.children[rt]===void 0?tt.children[rt]=[_e]:tt.children[rt].push(_e)}function addNoneTerminalToCst(tt,_e,rt){tt.children[_e]===void 0?tt.children[_e]=[rt]:tt.children[_e].push(rt)}const NAME="name";function defineNameProp(tt,_e){Object.defineProperty(tt,NAME,{enumerable:!1,configurable:!0,writable:!1,value:_e})}function defaultVisit(tt,_e){const rt=keys$1(tt),nt=rt.length;for(let it=0;it<nt;it++){const st=rt[it],ot=tt[st],lt=ot.length;for(let at=0;at<lt;at++){const ct=ot[at];ct.tokenTypeIdx===void 0&&this[ct.name](ct.children,_e)}}}function createBaseSemanticVisitorConstructor(tt,_e){const rt=function(){};defineNameProp(rt,tt+"BaseSemantics");const nt={visit:function(it,st){if(isArray$1$1(it)&&(it=it[0]),!isUndefined(it))return this[it.name](it.children,st)},validateVisitor:function(){const it=validateVisitor(this,_e);if(!isEmpty(it)){const st=map(it,ot=>ot.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${st.join(`

`).replace(/\n/g,`
	`)}`)}}};return rt.prototype=nt,rt.prototype.constructor=rt,rt._RULE_NAMES=_e,rt}function createBaseVisitorConstructorWithDefaults(tt,_e,rt){const nt=function(){};defineNameProp(nt,tt+"BaseSemanticsWithDefaults");const it=Object.create(rt.prototype);return forEach(_e,st=>{it[st]=defaultVisit}),nt.prototype=it,nt.prototype.constructor=nt,nt}var CstVisitorDefinitionError;(function(tt){tt[tt.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",tt[tt.MISSING_METHOD=1]="MISSING_METHOD"})(CstVisitorDefinitionError||(CstVisitorDefinitionError={}));function validateVisitor(tt,_e){return validateMissingCstMethods(tt,_e)}function validateMissingCstMethods(tt,_e){const rt=filter(_e,it=>isFunction$1(tt[it])===!1),nt=map(rt,it=>({msg:`Missing visitor method: <${it}> on ${tt.constructor.name} CST Visitor.`,type:CstVisitorDefinitionError.MISSING_METHOD,methodName:it}));return compact(nt)}class TreeBuilder{initTreeBuilder(_e){if(this.CST_STACK=[],this.outputCst=_e.outputCst,this.nodeLocationTracking=has$1(_e,"nodeLocationTracking")?_e.nodeLocationTracking:DEFAULT_PARSER_CONFIG.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=noop$2,this.cstFinallyStateUpdate=noop$2,this.cstPostTerminal=noop$2,this.cstPostNonTerminal=noop$2,this.cstPostRule=noop$2;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=setNodeLocationFull,this.setNodeLocationFromNode=setNodeLocationFull,this.cstPostRule=noop$2,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=noop$2,this.setNodeLocationFromNode=noop$2,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=setNodeLocationOnlyOffset,this.setNodeLocationFromNode=setNodeLocationOnlyOffset,this.cstPostRule=noop$2,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=noop$2,this.setNodeLocationFromNode=noop$2,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=noop$2,this.setNodeLocationFromNode=noop$2,this.cstPostRule=noop$2,this.setInitialNodeLocation=noop$2;else throw Error(`Invalid <nodeLocationTracking> config option: "${_e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(_e){_e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(_e){_e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(_e){_e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(_e){const rt=this.LA(1);_e.location={startOffset:rt.startOffset,startLine:rt.startLine,startColumn:rt.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(_e){const rt={name:_e,children:Object.create(null)};this.setInitialNodeLocation(rt),this.CST_STACK.push(rt)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(_e){const rt=this.LA(0),nt=_e.location;nt.startOffset<=rt.startOffset?(nt.endOffset=rt.endOffset,nt.endLine=rt.endLine,nt.endColumn=rt.endColumn):(nt.startOffset=NaN,nt.startLine=NaN,nt.startColumn=NaN)}cstPostRuleOnlyOffset(_e){const rt=this.LA(0),nt=_e.location;nt.startOffset<=rt.startOffset?nt.endOffset=rt.endOffset:nt.startOffset=NaN}cstPostTerminal(_e,rt){const nt=this.CST_STACK[this.CST_STACK.length-1];addTerminalToCst(nt,rt,_e),this.setNodeLocationFromToken(nt.location,rt)}cstPostNonTerminal(_e,rt){const nt=this.CST_STACK[this.CST_STACK.length-1];addNoneTerminalToCst(nt,rt,_e),this.setNodeLocationFromNode(nt.location,_e.location)}getBaseCstVisitorConstructor(){if(isUndefined(this.baseCstVisitorConstructor)){const _e=createBaseSemanticVisitorConstructor(this.className,keys$1(this.gastProductionsCache));return this.baseCstVisitorConstructor=_e,_e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(isUndefined(this.baseCstVisitorWithDefaultsConstructor)){const _e=createBaseVisitorConstructorWithDefaults(this.className,keys$1(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=_e,_e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const _e=this.RULE_STACK;return _e[_e.length-1]}getPreviousExplicitRuleShortName(){const _e=this.RULE_STACK;return _e[_e.length-2]}getLastExplicitRuleOccurrenceIndex(){const _e=this.RULE_OCCURRENCE_STACK;return _e[_e.length-1]}}class LexerAdapter{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(_e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=_e,this.tokVectorLength=_e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):END_OF_FILE}LA(_e){const rt=this.currIdx+_e;return rt<0||this.tokVectorLength<=rt?END_OF_FILE:this.tokVector[rt]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(_e){this.currIdx=_e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class RecognizerApi{ACTION(_e){return _e.call(this)}consume(_e,rt,nt){return this.consumeInternal(rt,_e,nt)}subrule(_e,rt,nt){return this.subruleInternal(rt,_e,nt)}option(_e,rt){return this.optionInternal(rt,_e)}or(_e,rt){return this.orInternal(rt,_e)}many(_e,rt){return this.manyInternal(_e,rt)}atLeastOne(_e,rt){return this.atLeastOneInternal(_e,rt)}CONSUME(_e,rt){return this.consumeInternal(_e,0,rt)}CONSUME1(_e,rt){return this.consumeInternal(_e,1,rt)}CONSUME2(_e,rt){return this.consumeInternal(_e,2,rt)}CONSUME3(_e,rt){return this.consumeInternal(_e,3,rt)}CONSUME4(_e,rt){return this.consumeInternal(_e,4,rt)}CONSUME5(_e,rt){return this.consumeInternal(_e,5,rt)}CONSUME6(_e,rt){return this.consumeInternal(_e,6,rt)}CONSUME7(_e,rt){return this.consumeInternal(_e,7,rt)}CONSUME8(_e,rt){return this.consumeInternal(_e,8,rt)}CONSUME9(_e,rt){return this.consumeInternal(_e,9,rt)}SUBRULE(_e,rt){return this.subruleInternal(_e,0,rt)}SUBRULE1(_e,rt){return this.subruleInternal(_e,1,rt)}SUBRULE2(_e,rt){return this.subruleInternal(_e,2,rt)}SUBRULE3(_e,rt){return this.subruleInternal(_e,3,rt)}SUBRULE4(_e,rt){return this.subruleInternal(_e,4,rt)}SUBRULE5(_e,rt){return this.subruleInternal(_e,5,rt)}SUBRULE6(_e,rt){return this.subruleInternal(_e,6,rt)}SUBRULE7(_e,rt){return this.subruleInternal(_e,7,rt)}SUBRULE8(_e,rt){return this.subruleInternal(_e,8,rt)}SUBRULE9(_e,rt){return this.subruleInternal(_e,9,rt)}OPTION(_e){return this.optionInternal(_e,0)}OPTION1(_e){return this.optionInternal(_e,1)}OPTION2(_e){return this.optionInternal(_e,2)}OPTION3(_e){return this.optionInternal(_e,3)}OPTION4(_e){return this.optionInternal(_e,4)}OPTION5(_e){return this.optionInternal(_e,5)}OPTION6(_e){return this.optionInternal(_e,6)}OPTION7(_e){return this.optionInternal(_e,7)}OPTION8(_e){return this.optionInternal(_e,8)}OPTION9(_e){return this.optionInternal(_e,9)}OR(_e){return this.orInternal(_e,0)}OR1(_e){return this.orInternal(_e,1)}OR2(_e){return this.orInternal(_e,2)}OR3(_e){return this.orInternal(_e,3)}OR4(_e){return this.orInternal(_e,4)}OR5(_e){return this.orInternal(_e,5)}OR6(_e){return this.orInternal(_e,6)}OR7(_e){return this.orInternal(_e,7)}OR8(_e){return this.orInternal(_e,8)}OR9(_e){return this.orInternal(_e,9)}MANY(_e){this.manyInternal(0,_e)}MANY1(_e){this.manyInternal(1,_e)}MANY2(_e){this.manyInternal(2,_e)}MANY3(_e){this.manyInternal(3,_e)}MANY4(_e){this.manyInternal(4,_e)}MANY5(_e){this.manyInternal(5,_e)}MANY6(_e){this.manyInternal(6,_e)}MANY7(_e){this.manyInternal(7,_e)}MANY8(_e){this.manyInternal(8,_e)}MANY9(_e){this.manyInternal(9,_e)}MANY_SEP(_e){this.manySepFirstInternal(0,_e)}MANY_SEP1(_e){this.manySepFirstInternal(1,_e)}MANY_SEP2(_e){this.manySepFirstInternal(2,_e)}MANY_SEP3(_e){this.manySepFirstInternal(3,_e)}MANY_SEP4(_e){this.manySepFirstInternal(4,_e)}MANY_SEP5(_e){this.manySepFirstInternal(5,_e)}MANY_SEP6(_e){this.manySepFirstInternal(6,_e)}MANY_SEP7(_e){this.manySepFirstInternal(7,_e)}MANY_SEP8(_e){this.manySepFirstInternal(8,_e)}MANY_SEP9(_e){this.manySepFirstInternal(9,_e)}AT_LEAST_ONE(_e){this.atLeastOneInternal(0,_e)}AT_LEAST_ONE1(_e){return this.atLeastOneInternal(1,_e)}AT_LEAST_ONE2(_e){this.atLeastOneInternal(2,_e)}AT_LEAST_ONE3(_e){this.atLeastOneInternal(3,_e)}AT_LEAST_ONE4(_e){this.atLeastOneInternal(4,_e)}AT_LEAST_ONE5(_e){this.atLeastOneInternal(5,_e)}AT_LEAST_ONE6(_e){this.atLeastOneInternal(6,_e)}AT_LEAST_ONE7(_e){this.atLeastOneInternal(7,_e)}AT_LEAST_ONE8(_e){this.atLeastOneInternal(8,_e)}AT_LEAST_ONE9(_e){this.atLeastOneInternal(9,_e)}AT_LEAST_ONE_SEP(_e){this.atLeastOneSepFirstInternal(0,_e)}AT_LEAST_ONE_SEP1(_e){this.atLeastOneSepFirstInternal(1,_e)}AT_LEAST_ONE_SEP2(_e){this.atLeastOneSepFirstInternal(2,_e)}AT_LEAST_ONE_SEP3(_e){this.atLeastOneSepFirstInternal(3,_e)}AT_LEAST_ONE_SEP4(_e){this.atLeastOneSepFirstInternal(4,_e)}AT_LEAST_ONE_SEP5(_e){this.atLeastOneSepFirstInternal(5,_e)}AT_LEAST_ONE_SEP6(_e){this.atLeastOneSepFirstInternal(6,_e)}AT_LEAST_ONE_SEP7(_e){this.atLeastOneSepFirstInternal(7,_e)}AT_LEAST_ONE_SEP8(_e){this.atLeastOneSepFirstInternal(8,_e)}AT_LEAST_ONE_SEP9(_e){this.atLeastOneSepFirstInternal(9,_e)}RULE(_e,rt,nt=DEFAULT_RULE_CONFIG){if(includes(this.definedRulesNames,_e)){const ot={message:defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:_e,grammarName:this.className}),type:ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:_e};this.definitionErrors.push(ot)}this.definedRulesNames.push(_e);const it=this.defineRule(_e,rt,nt);return this[_e]=it,it}OVERRIDE_RULE(_e,rt,nt=DEFAULT_RULE_CONFIG){const it=validateRuleIsOverridden(_e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(it);const st=this.defineRule(_e,rt,nt);return this[_e]=st,st}BACKTRACK(_e,rt){return function(){this.isBackTrackingStack.push(1);const nt=this.saveRecogState();try{return _e.apply(this,rt),!0}catch(it){if(isRecognitionException(it))return!1;throw it}finally{this.reloadRecogState(nt),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return serializeGrammar(values(this.gastProductionsCache))}}class RecognizerEngine{initRecognizerEngine(_e,rt){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=tokenStructuredMatcherNoCategories,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},has$1(rt,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(isArray$1$1(_e)){if(isEmpty(_e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof _e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(isArray$1$1(_e))this.tokensMap=reduce(_e,(st,ot)=>(st[ot.name]=ot,st),{});else if(has$1(_e,"modes")&&every(flatten$1(values(_e.modes)),isTokenType)){const st=flatten$1(values(_e.modes)),ot=uniq(st);this.tokensMap=reduce(ot,(lt,at)=>(lt[at.name]=at,lt),{})}else if(isObject$a(_e))this.tokensMap=clone(_e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=EOF;const nt=has$1(_e,"modes")?flatten$1(values(_e.modes)):values(_e),it=every(nt,st=>isEmpty(st.categoryMatches));this.tokenMatcher=it?tokenStructuredMatcherNoCategories:tokenStructuredMatcher,augmentTokenTypes(values(this.tokensMap))}defineRule(_e,rt,nt){if(this.selfAnalysisDone)throw Error(`Grammar rule <${_e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const it=has$1(nt,"resyncEnabled")?nt.resyncEnabled:DEFAULT_RULE_CONFIG.resyncEnabled,st=has$1(nt,"recoveryValueFunc")?nt.recoveryValueFunc:DEFAULT_RULE_CONFIG.recoveryValueFunc,ot=this.ruleShortNameIdx<<BITS_FOR_METHOD_TYPE+BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[ot]=_e,this.fullRuleNameToShort[_e]=ot;let lt;return this.outputCst===!0?lt=function(...ut){try{this.ruleInvocationStateUpdate(ot,_e,this.subruleIdx),rt.apply(this,ut);const ht=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(ht),ht}catch(ht){return this.invokeRuleCatch(ht,it,st)}finally{this.ruleFinallyStateUpdate()}}:lt=function(...ut){try{return this.ruleInvocationStateUpdate(ot,_e,this.subruleIdx),rt.apply(this,ut)}catch(ht){return this.invokeRuleCatch(ht,it,st)}finally{this.ruleFinallyStateUpdate()}},Object.assign(lt,{ruleName:_e,originalGrammarAction:rt})}invokeRuleCatch(_e,rt,nt){const it=this.RULE_STACK.length===1,st=rt&&!this.isBackTracking()&&this.recoveryEnabled;if(isRecognitionException(_e)){const ot=_e;if(st){const lt=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(lt))if(ot.resyncedTokens=this.reSyncTo(lt),this.outputCst){const at=this.CST_STACK[this.CST_STACK.length-1];return at.recoveredNode=!0,at}else return nt(_e);else{if(this.outputCst){const at=this.CST_STACK[this.CST_STACK.length-1];at.recoveredNode=!0,ot.partialCstResult=at}throw ot}}else{if(it)return this.moveToTerminatedState(),nt(_e);throw ot}}else throw _e}optionInternal(_e,rt){const nt=this.getKeyForAutomaticLookahead(OPTION_IDX,rt);return this.optionInternalLogic(_e,rt,nt)}optionInternalLogic(_e,rt,nt){let it=this.getLaFuncFromCache(nt),st;if(typeof _e!="function"){st=_e.DEF;const ot=_e.GATE;if(ot!==void 0){const lt=it;it=()=>ot.call(this)&&lt.call(this)}}else st=_e;if(it.call(this)===!0)return st.call(this)}atLeastOneInternal(_e,rt){const nt=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_IDX,_e);return this.atLeastOneInternalLogic(_e,rt,nt)}atLeastOneInternalLogic(_e,rt,nt){let it=this.getLaFuncFromCache(nt),st;if(typeof rt!="function"){st=rt.DEF;const ot=rt.GATE;if(ot!==void 0){const lt=it;it=()=>ot.call(this)&&lt.call(this)}}else st=rt;if(it.call(this)===!0){let ot=this.doSingleRepetition(st);for(;it.call(this)===!0&&ot===!0;)ot=this.doSingleRepetition(st)}else throw this.raiseEarlyExitException(_e,PROD_TYPE.REPETITION_MANDATORY,rt.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[_e,rt],it,AT_LEAST_ONE_IDX,_e,NextTerminalAfterAtLeastOneWalker)}atLeastOneSepFirstInternal(_e,rt){const nt=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_SEP_IDX,_e);this.atLeastOneSepFirstInternalLogic(_e,rt,nt)}atLeastOneSepFirstInternalLogic(_e,rt,nt){const it=rt.DEF,st=rt.SEP;if(this.getLaFuncFromCache(nt).call(this)===!0){it.call(this);const lt=()=>this.tokenMatcher(this.LA(1),st);for(;this.tokenMatcher(this.LA(1),st)===!0;)this.CONSUME(st),it.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[_e,st,lt,it,NextTerminalAfterAtLeastOneSepWalker],lt,AT_LEAST_ONE_SEP_IDX,_e,NextTerminalAfterAtLeastOneSepWalker)}else throw this.raiseEarlyExitException(_e,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,rt.ERR_MSG)}manyInternal(_e,rt){const nt=this.getKeyForAutomaticLookahead(MANY_IDX,_e);return this.manyInternalLogic(_e,rt,nt)}manyInternalLogic(_e,rt,nt){let it=this.getLaFuncFromCache(nt),st;if(typeof rt!="function"){st=rt.DEF;const lt=rt.GATE;if(lt!==void 0){const at=it;it=()=>lt.call(this)&&at.call(this)}}else st=rt;let ot=!0;for(;it.call(this)===!0&&ot===!0;)ot=this.doSingleRepetition(st);this.attemptInRepetitionRecovery(this.manyInternal,[_e,rt],it,MANY_IDX,_e,NextTerminalAfterManyWalker,ot)}manySepFirstInternal(_e,rt){const nt=this.getKeyForAutomaticLookahead(MANY_SEP_IDX,_e);this.manySepFirstInternalLogic(_e,rt,nt)}manySepFirstInternalLogic(_e,rt,nt){const it=rt.DEF,st=rt.SEP;if(this.getLaFuncFromCache(nt).call(this)===!0){it.call(this);const lt=()=>this.tokenMatcher(this.LA(1),st);for(;this.tokenMatcher(this.LA(1),st)===!0;)this.CONSUME(st),it.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[_e,st,lt,it,NextTerminalAfterManySepWalker],lt,MANY_SEP_IDX,_e,NextTerminalAfterManySepWalker)}}repetitionSepSecondInternal(_e,rt,nt,it,st){for(;nt();)this.CONSUME(rt),it.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[_e,rt,nt,it,st],nt,AT_LEAST_ONE_SEP_IDX,_e,st)}doSingleRepetition(_e){const rt=this.getLexerPosition();return _e.call(this),this.getLexerPosition()>rt}orInternal(_e,rt){const nt=this.getKeyForAutomaticLookahead(OR_IDX,rt),it=isArray$1$1(_e)?_e:_e.DEF,ot=this.getLaFuncFromCache(nt).call(this,it);if(ot!==void 0)return it[ot].ALT.call(this);this.raiseNoAltException(rt,_e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const _e=this.LA(1),rt=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:_e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new NotAllInputParsedException(rt,_e))}}subruleInternal(_e,rt,nt){let it;try{const st=nt!==void 0?nt.ARGS:void 0;return this.subruleIdx=rt,it=_e.apply(this,st),this.cstPostNonTerminal(it,nt!==void 0&&nt.LABEL!==void 0?nt.LABEL:_e.ruleName),it}catch(st){throw this.subruleInternalError(st,nt,_e.ruleName)}}subruleInternalError(_e,rt,nt){throw isRecognitionException(_e)&&_e.partialCstResult!==void 0&&(this.cstPostNonTerminal(_e.partialCstResult,rt!==void 0&&rt.LABEL!==void 0?rt.LABEL:nt),delete _e.partialCstResult),_e}consumeInternal(_e,rt,nt){let it;try{const st=this.LA(1);this.tokenMatcher(st,_e)===!0?(this.consumeToken(),it=st):this.consumeInternalError(_e,st,nt)}catch(st){it=this.consumeInternalRecovery(_e,rt,st)}return this.cstPostTerminal(nt!==void 0&&nt.LABEL!==void 0?nt.LABEL:_e.name,it),it}consumeInternalError(_e,rt,nt){let it;const st=this.LA(0);throw nt!==void 0&&nt.ERR_MSG?it=nt.ERR_MSG:it=this.errorMessageProvider.buildMismatchTokenMessage({expected:_e,actual:rt,previous:st,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new MismatchedTokenException(it,rt,st))}consumeInternalRecovery(_e,rt,nt){if(this.recoveryEnabled&&nt.name==="MismatchedTokenException"&&!this.isBackTracking()){const it=this.getFollowsForInRuleRecovery(_e,rt);try{return this.tryInRuleRecovery(_e,it)}catch(st){throw st.name===IN_RULE_RECOVERY_EXCEPTION?nt:st}}else throw nt}saveRecogState(){const _e=this.errors,rt=clone(this.RULE_STACK);return{errors:_e,lexerState:this.exportLexerState(),RULE_STACK:rt,CST_STACK:this.CST_STACK}}reloadRecogState(_e){this.errors=_e.errors,this.importLexerState(_e.lexerState),this.RULE_STACK=_e.RULE_STACK}ruleInvocationStateUpdate(_e,rt,nt){this.RULE_OCCURRENCE_STACK.push(nt),this.RULE_STACK.push(_e),this.cstInvocationStateUpdate(rt)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const _e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[_e]}shortRuleNameToFullName(_e){return this.shortRuleNameToFull[_e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),EOF)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class ErrorHandler{initErrorHandler(_e){this._errors=[],this.errorMessageProvider=has$1(_e,"errorMessageProvider")?_e.errorMessageProvider:DEFAULT_PARSER_CONFIG.errorMessageProvider}SAVE_ERROR(_e){if(isRecognitionException(_e))return _e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:clone(this.RULE_OCCURRENCE_STACK)},this._errors.push(_e),_e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return clone(this._errors)}set errors(_e){this._errors=_e}raiseEarlyExitException(_e,rt,nt){const it=this.getCurrRuleFullName(),st=this.getGAstProductions()[it],lt=getLookaheadPathsForOptionalProd(_e,st,rt,this.maxLookahead)[0],at=[];for(let ut=1;ut<=this.maxLookahead;ut++)at.push(this.LA(ut));const ct=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:lt,actual:at,previous:this.LA(0),customUserDescription:nt,ruleName:it});throw this.SAVE_ERROR(new EarlyExitException(ct,this.LA(1),this.LA(0)))}raiseNoAltException(_e,rt){const nt=this.getCurrRuleFullName(),it=this.getGAstProductions()[nt],st=getLookaheadPathsForOr(_e,it,this.maxLookahead),ot=[];for(let ct=1;ct<=this.maxLookahead;ct++)ot.push(this.LA(ct));const lt=this.LA(0),at=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:st,actual:ot,previous:lt,customUserDescription:rt,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new NoViableAltException(at,this.LA(1),lt))}}class ContentAssist{initContentAssist(){}computeContentAssist(_e,rt){const nt=this.gastProductionsCache[_e];if(isUndefined(nt))throw Error(`Rule ->${_e}<- does not exist in this grammar.`);return nextPossibleTokensAfter([nt],rt,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(_e){const rt=head(_e.ruleStack),it=this.getGAstProductions()[rt];return new NextAfterTokenWalker(it,_e).startWalking()}}const RECORDING_NULL_OBJECT={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(RECORDING_NULL_OBJECT);const HANDLE_SEPARATOR=!0,MAX_METHOD_IDX=Math.pow(2,BITS_FOR_OCCURRENCE_IDX)-1,RFT=createToken({name:"RECORDING_PHASE_TOKEN",pattern:Lexer.NA});augmentTokenTypes([RFT]);const RECORDING_PHASE_TOKEN=createTokenInstance(RFT,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(RECORDING_PHASE_TOKEN);const RECORDING_PHASE_CSTNODE={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class GastRecorder{initGastRecorder(_e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let _e=0;_e<10;_e++){const rt=_e>0?_e:"";this[`CONSUME${rt}`]=function(nt,it){return this.consumeInternalRecord(nt,_e,it)},this[`SUBRULE${rt}`]=function(nt,it){return this.subruleInternalRecord(nt,_e,it)},this[`OPTION${rt}`]=function(nt){return this.optionInternalRecord(nt,_e)},this[`OR${rt}`]=function(nt){return this.orInternalRecord(nt,_e)},this[`MANY${rt}`]=function(nt){this.manyInternalRecord(_e,nt)},this[`MANY_SEP${rt}`]=function(nt){this.manySepFirstInternalRecord(_e,nt)},this[`AT_LEAST_ONE${rt}`]=function(nt){this.atLeastOneInternalRecord(_e,nt)},this[`AT_LEAST_ONE_SEP${rt}`]=function(nt){this.atLeastOneSepFirstInternalRecord(_e,nt)}}this.consume=function(_e,rt,nt){return this.consumeInternalRecord(rt,_e,nt)},this.subrule=function(_e,rt,nt){return this.subruleInternalRecord(rt,_e,nt)},this.option=function(_e,rt){return this.optionInternalRecord(rt,_e)},this.or=function(_e,rt){return this.orInternalRecord(rt,_e)},this.many=function(_e,rt){this.manyInternalRecord(_e,rt)},this.atLeastOne=function(_e,rt){this.atLeastOneInternalRecord(_e,rt)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const _e=this;for(let rt=0;rt<10;rt++){const nt=rt>0?rt:"";delete _e[`CONSUME${nt}`],delete _e[`SUBRULE${nt}`],delete _e[`OPTION${nt}`],delete _e[`OR${nt}`],delete _e[`MANY${nt}`],delete _e[`MANY_SEP${nt}`],delete _e[`AT_LEAST_ONE${nt}`],delete _e[`AT_LEAST_ONE_SEP${nt}`]}delete _e.consume,delete _e.subrule,delete _e.option,delete _e.or,delete _e.many,delete _e.atLeastOne,delete _e.ACTION,delete _e.BACKTRACK,delete _e.LA})}ACTION_RECORD(_e){}BACKTRACK_RECORD(_e,rt){return()=>!0}LA_RECORD(_e){return END_OF_FILE}topLevelRuleRecord(_e,rt){try{const nt=new Rule$1({definition:[],name:_e});return nt.name=_e,this.recordingProdStack.push(nt),rt.call(this),this.recordingProdStack.pop(),nt}catch(nt){if(nt.KNOWN_RECORDER_ERROR!==!0)try{nt.message=nt.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw nt}throw nt}}optionInternalRecord(_e,rt){return recordProd.call(this,Option,_e,rt)}atLeastOneInternalRecord(_e,rt){recordProd.call(this,RepetitionMandatory,rt,_e)}atLeastOneSepFirstInternalRecord(_e,rt){recordProd.call(this,RepetitionMandatoryWithSeparator,rt,_e,HANDLE_SEPARATOR)}manyInternalRecord(_e,rt){recordProd.call(this,Repetition,rt,_e)}manySepFirstInternalRecord(_e,rt){recordProd.call(this,RepetitionWithSeparator,rt,_e,HANDLE_SEPARATOR)}orInternalRecord(_e,rt){return recordOrProd.call(this,_e,rt)}subruleInternalRecord(_e,rt,nt){if(assertMethodIdxIsValid(rt),!_e||has$1(_e,"ruleName")===!1){const lt=new Error(`<SUBRULE${getIdxSuffix(rt)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(_e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw lt.KNOWN_RECORDER_ERROR=!0,lt}const it=last(this.recordingProdStack),st=_e.ruleName,ot=new NonTerminal({idx:rt,nonTerminalName:st,label:nt==null?void 0:nt.LABEL,referencedRule:void 0});return it.definition.push(ot),this.outputCst?RECORDING_PHASE_CSTNODE:RECORDING_NULL_OBJECT}consumeInternalRecord(_e,rt,nt){if(assertMethodIdxIsValid(rt),!hasShortKeyProperty(_e)){const ot=new Error(`<CONSUME${getIdxSuffix(rt)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(_e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw ot.KNOWN_RECORDER_ERROR=!0,ot}const it=last(this.recordingProdStack),st=new Terminal({idx:rt,terminalType:_e,label:nt==null?void 0:nt.LABEL});return it.definition.push(st),RECORDING_PHASE_TOKEN}}function recordProd(tt,_e,rt,nt=!1){assertMethodIdxIsValid(rt);const it=last(this.recordingProdStack),st=isFunction$1(_e)?_e:_e.DEF,ot=new tt({definition:[],idx:rt});return nt&&(ot.separator=_e.SEP),has$1(_e,"MAX_LOOKAHEAD")&&(ot.maxLookahead=_e.MAX_LOOKAHEAD),this.recordingProdStack.push(ot),st.call(this),it.definition.push(ot),this.recordingProdStack.pop(),RECORDING_NULL_OBJECT}function recordOrProd(tt,_e){assertMethodIdxIsValid(_e);const rt=last(this.recordingProdStack),nt=isArray$1$1(tt)===!1,it=nt===!1?tt:tt.DEF,st=new Alternation({definition:[],idx:_e,ignoreAmbiguities:nt&&tt.IGNORE_AMBIGUITIES===!0});has$1(tt,"MAX_LOOKAHEAD")&&(st.maxLookahead=tt.MAX_LOOKAHEAD);const ot=some(it,lt=>isFunction$1(lt.GATE));return st.hasPredicates=ot,rt.definition.push(st),forEach(it,lt=>{const at=new Alternative({definition:[]});st.definition.push(at),has$1(lt,"IGNORE_AMBIGUITIES")?at.ignoreAmbiguities=lt.IGNORE_AMBIGUITIES:has$1(lt,"GATE")&&(at.ignoreAmbiguities=!0),this.recordingProdStack.push(at),lt.ALT.call(this),this.recordingProdStack.pop()}),RECORDING_NULL_OBJECT}function getIdxSuffix(tt){return tt===0?"":`${tt}`}function assertMethodIdxIsValid(tt){if(tt<0||tt>MAX_METHOD_IDX){const _e=new Error(`Invalid DSL Method idx value: <${tt}>
	Idx value must be a none negative value smaller than ${MAX_METHOD_IDX+1}`);throw _e.KNOWN_RECORDER_ERROR=!0,_e}}class PerformanceTracer{initPerformanceTracer(_e){if(has$1(_e,"traceInitPerf")){const rt=_e.traceInitPerf,nt=typeof rt=="number";this.traceInitMaxIdent=nt?rt:1/0,this.traceInitPerf=nt?rt>0:rt}else this.traceInitMaxIdent=0,this.traceInitPerf=DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(_e,rt){if(this.traceInitPerf===!0){this.traceInitIndent++;const nt=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${nt}--> <${_e}>`);const{time:it,value:st}=timer$1(rt),ot=it>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&ot(`${nt}<-- <${_e}> time: ${it}ms`),this.traceInitIndent--,st}else return rt()}}function applyMixins(tt,_e){_e.forEach(rt=>{const nt=rt.prototype;Object.getOwnPropertyNames(nt).forEach(it=>{if(it==="constructor")return;const st=Object.getOwnPropertyDescriptor(nt,it);st&&(st.get||st.set)?Object.defineProperty(tt.prototype,it,st):tt.prototype[it]=rt.prototype[it]})})}const END_OF_FILE=createTokenInstance(EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(END_OF_FILE);const DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var ParserDefinitionErrorType;(function(tt){tt[tt.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",tt[tt.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",tt[tt.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",tt[tt.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",tt[tt.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",tt[tt.LEFT_RECURSION=5]="LEFT_RECURSION",tt[tt.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",tt[tt.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",tt[tt.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",tt[tt.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",tt[tt.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",tt[tt.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",tt[tt.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",tt[tt.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(ParserDefinitionErrorType||(ParserDefinitionErrorType={}));class Parser{static performSelfAnalysis(_e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let _e;this.selfAnalysisDone=!0;const rt=this.className;this.TRACE_INIT("toFastProps",()=>{toFastProperties(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),forEach(this.definedRulesNames,it=>{const ot=this[it].originalGrammarAction;let lt;this.TRACE_INIT(`${it} Rule`,()=>{lt=this.topLevelRuleRecord(it,ot)}),this.gastProductionsCache[it]=lt})}finally{this.disableRecording()}});let nt=[];if(this.TRACE_INIT("Grammar Resolving",()=>{nt=resolveGrammar({rules:values(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(nt)}),this.TRACE_INIT("Grammar Validations",()=>{if(isEmpty(nt)&&this.skipValidations===!1){const it=validateGrammar({rules:values(this.gastProductionsCache),tokenTypes:values(this.tokensMap),errMsgProvider:defaultGrammarValidatorErrorProvider,grammarName:rt}),st=validateLookahead({lookaheadStrategy:this.lookaheadStrategy,rules:values(this.gastProductionsCache),tokenTypes:values(this.tokensMap),grammarName:rt});this.definitionErrors=this.definitionErrors.concat(it,st)}}),isEmpty(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const it=computeAllProdsFollows(values(this.gastProductionsCache));this.resyncFollows=it}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var it,st;(st=(it=this.lookaheadStrategy).initialize)===null||st===void 0||st.call(it,{rules:values(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(values(this.gastProductionsCache))})),!Parser.DEFER_DEFINITION_ERRORS_HANDLING&&!isEmpty(this.definitionErrors))throw _e=map(this.definitionErrors,it=>it.message),new Error(`Parser Definition Errors detected:
 ${_e.join(`
-------------------------------
`)}`)})}constructor(_e,rt){this.definitionErrors=[],this.selfAnalysisDone=!1;const nt=this;if(nt.initErrorHandler(rt),nt.initLexerAdapter(),nt.initLooksAhead(rt),nt.initRecognizerEngine(_e,rt),nt.initRecoverable(rt),nt.initTreeBuilder(rt),nt.initContentAssist(),nt.initGastRecorder(rt),nt.initPerformanceTracer(rt),has$1(rt,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=has$1(rt,"skipValidations")?rt.skipValidations:DEFAULT_PARSER_CONFIG.skipValidations}}Parser.DEFER_DEFINITION_ERRORS_HANDLING=!1;applyMixins(Parser,[Recoverable,LooksAhead,TreeBuilder,LexerAdapter,RecognizerEngine,RecognizerApi,ErrorHandler,ContentAssist,GastRecorder,PerformanceTracer]);class WorkerPool{constructor(_e=4){this.pool=_e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(_e){if(!this.workers[_e]){const rt=this.workerCreator();rt.addEventListener("message",this._onMessage.bind(this,_e)),this.workers[_e]=rt}}_getIdleWorker(){for(let _e=0;_e<this.pool;_e++)if(!(this.workerStatus&1<<_e))return _e;return-1}_onMessage(_e,rt){const nt=this.workersResolve[_e];if(nt&&nt(rt),this.queue.length){const{resolve:it,msg:st,transfer:ot}=this.queue.shift();this.workersResolve[_e]=it,this.workers[_e].postMessage(st,ot)}else this.workerStatus^=1<<_e}setWorkerCreator(_e){this.workerCreator=_e}setWorkerLimit(_e){this.pool=_e}postMessage(_e,rt){return new Promise(nt=>{const it=this._getIdleWorker();it!==-1?(this._initWorker(it),this.workerStatus|=1<<it,this.workersResolve[it]=nt,this.workers[it].postMessage(_e,rt)):this.queue.push({resolve:nt,msg:_e,transfer:rt})})}dispose(){this.workers.forEach(_e=>_e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}class CompressedArrayTexture extends CompressedTexture{constructor(_e,rt,nt,it,st,ot){super(_e,rt,nt,st,ot),this.isCompressedArrayTexture=!0,this.image.depth=it,this.wrapR=ClampToEdgeWrapping}}const _taskCache$3=new WeakMap;let _activeLoaders=0,_zstd;const _KTX2Loader=class extends Loader{constructor(tt){super(tt),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(tt){return this.transcoderPath=tt,this}setWorkerLimit(tt){return this.workerPool.setWorkerLimit(tt),this}detectSupport(tt){return this.workerConfig={astcSupported:tt.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:tt.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:tt.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:tt.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:tt.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:tt.extensions.has("WEBGL_compressed_texture_pvrtc")||tt.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},tt.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const tt=new FileLoader(this.manager);tt.setPath(this.transcoderPath),tt.setWithCredentials(this.withCredentials);const _e=tt.loadAsync("basis_transcoder.js"),rt=new FileLoader(this.manager);rt.setPath(this.transcoderPath),rt.setResponseType("arraybuffer"),rt.setWithCredentials(this.withCredentials);const nt=rt.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([_e,nt]).then(([it,st])=>{const ot=_KTX2Loader.BasisWorker.toString(),lt=["/* constants */","let _EngineFormat = "+JSON.stringify(_KTX2Loader.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(_KTX2Loader.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(_KTX2Loader.BasisFormat),"/* basis_transcoder.js */",it,"/* worker */",ot.substring(ot.indexOf("{")+1,ot.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([lt])),this.transcoderBinary=st,this.workerPool.setWorkerCreator(()=>{const at=new Worker(this.workerSourceURL),ct=this.transcoderBinary.slice(0);return at.postMessage({type:"init",config:this.workerConfig,transcoderBinary:ct},[ct]),at})}),_activeLoaders>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),_activeLoaders++}return this.transcoderPending}load(tt,_e,rt,nt){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const it=new FileLoader(this.manager);it.setResponseType("arraybuffer"),it.setWithCredentials(this.withCredentials),it.load(tt,st=>{if(_taskCache$3.has(st))return _taskCache$3.get(st).promise.then(_e).catch(nt);this._createTexture(st).then(ot=>_e?_e(ot):null).catch(nt)},rt,nt)}_createTextureFrom(tt,_e){const{mipmaps:rt,width:nt,height:it,format:st,type:ot,error:lt,dfdTransferFn:at,dfdFlags:ct}=tt;if(ot==="error")return Promise.reject(lt);const ut=_e.layerCount>1?new CompressedArrayTexture(rt,nt,it,_e.layerCount,st,UnsignedByteType):new CompressedTexture(rt,nt,it,st,UnsignedByteType);return ut.minFilter=rt.length===1?LinearFilter:LinearMipmapLinearFilter,ut.magFilter=LinearFilter,ut.generateMipmaps=!1,ut.needsUpdate=!0,"colorSpace"in ut?ut.colorSpace=at===KHR_DF_TRANSFER_SRGB?"srgb":"srgb-linear":ut.encoding=at===KHR_DF_TRANSFER_SRGB?3001:3e3,ut.premultiplyAlpha=!!(ct&KHR_DF_FLAG_ALPHA_PREMULTIPLIED),ut}async _createTexture(tt,_e={}){const rt=read(new Uint8Array(tt));if(rt.vkFormat!==VK_FORMAT_UNDEFINED)return createDataTexture(rt);const nt=_e,it=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:tt,taskConfig:nt},[tt])).then(st=>this._createTextureFrom(st.data,rt));return _taskCache$3.set(tt,{promise:it}),it}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),_activeLoaders--,this}};let KTX2Loader=_KTX2Loader;__publicField(KTX2Loader,"BasisFormat",{ETC1S:0,UASTC_4x4:1});__publicField(KTX2Loader,"TranscoderFormat",{ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16});__publicField(KTX2Loader,"EngineFormat",{RGBAFormat,RGBA_ASTC_4x4_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format});__publicField(KTX2Loader,"BasisWorker",function(){let tt,_e,rt;const nt=_EngineFormat,it=_TranscoderFormat,st=_BasisFormat;self.addEventListener("message",function(pt){const mt=pt.data;switch(mt.type){case"init":tt=mt.config,ot(mt.transcoderBinary);break;case"transcode":_e.then(()=>{try{const{width:gt,height:vt,hasAlpha:At,mipmaps:yt,format:xt,dfdTransferFn:_t,dfdFlags:Et}=lt(mt.buffer),bt=[];for(let wt=0;wt<yt.length;++wt)bt.push(yt[wt].data.buffer);self.postMessage({type:"transcode",id:mt.id,width:gt,height:vt,hasAlpha:At,mipmaps:yt,format:xt,dfdTransferFn:_t,dfdFlags:Et},bt)}catch(gt){console.error(gt),self.postMessage({type:"error",id:mt.id,error:gt.message})}});break}});function ot(pt){_e=new Promise(mt=>{rt={wasmBinary:pt,onRuntimeInitialized:mt},BASIS(rt)}).then(()=>{rt.initializeBasis(),rt.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function lt(pt){const mt=new rt.KTX2File(new Uint8Array(pt));function gt(){mt.close(),mt.delete()}if(!mt.isValid())throw gt(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const vt=mt.isUASTC()?st.UASTC_4x4:st.ETC1S,At=mt.getWidth(),yt=mt.getHeight(),xt=mt.getLayers()||1,_t=mt.getLevels(),Et=mt.getHasAlpha(),bt=mt.getDFDTransferFunc(),wt=mt.getDFDFlags(),{transcoderFormat:Tt,engineFormat:Mt}=ht(vt,At,yt,Et);if(!At||!yt||!_t)throw gt(),new Error("THREE.KTX2Loader:	Invalid texture");if(!mt.startTranscoding())throw gt(),new Error("THREE.KTX2Loader: .startTranscoding failed");const Pt=[];for(let It=0;It<_t;It++){const Ot=[];let Bt,Ut;for(let Ft=0;Ft<xt;Ft++){const jt=mt.getImageLevelInfo(It,Ft,0);Bt=jt.origWidth<4?jt.origWidth:jt.width,Ut=jt.origHeight<4?jt.origHeight:jt.height;const Dt=new Uint8Array(mt.getImageTranscodedSizeInBytes(It,Ft,0,Tt));if(!mt.transcodeImage(Dt,It,Ft,0,Tt,0,-1,-1))throw gt(),new Error("THREE.KTX2Loader: .transcodeImage failed.");Ot.push(Dt)}Pt.push({data:ft(Ot),width:Bt,height:Ut})}return gt(),{width:At,height:yt,hasAlpha:Et,mipmaps:Pt,format:Mt,dfdTransferFn:bt,dfdFlags:wt}}const at=[{if:"astcSupported",basisFormat:[st.UASTC_4x4],transcoderFormat:[it.ASTC_4x4,it.ASTC_4x4],engineFormat:[nt.RGBA_ASTC_4x4_Format,nt.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.BC7_M5,it.BC7_M5],engineFormat:[nt.RGBA_BPTC_Format,nt.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.BC1,it.BC3],engineFormat:[nt.RGB_S3TC_DXT1_Format,nt.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.ETC1,it.ETC2],engineFormat:[nt.RGB_ETC2_Format,nt.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.ETC1],engineFormat:[nt.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.PVRTC1_4_RGB,it.PVRTC1_4_RGBA],engineFormat:[nt.RGB_PVRTC_4BPPV1_Format,nt.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],ct=at.sort(function(pt,mt){return pt.priorityETC1S-mt.priorityETC1S}),ut=at.sort(function(pt,mt){return pt.priorityUASTC-mt.priorityUASTC});function ht(pt,mt,gt,vt){let At,yt;const xt=pt===st.ETC1S?ct:ut;for(let _t=0;_t<xt.length;_t++){const Et=xt[_t];if(tt[Et.if]&&Et.basisFormat.includes(pt)&&!(vt&&Et.transcoderFormat.length<2)&&!(Et.needsPowerOfTwo&&!(dt(mt)&&dt(gt))))return At=Et.transcoderFormat[vt?1:0],yt=Et.engineFormat[vt?1:0],{transcoderFormat:At,engineFormat:yt}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),At=it.RGBA32,yt=nt.RGBAFormat,{transcoderFormat:At,engineFormat:yt}}function dt(pt){return pt<=2?!0:(pt&pt-1)===0&&pt!==0}function ft(pt){let mt=0;for(let At=0;At<pt.length;At++){const yt=pt[At];mt+=yt.byteLength}const gt=new Uint8Array(mt);let vt=0;for(let At=0;At<pt.length;At++){const yt=pt[At];gt.set(yt,vt),vt+=yt.byteLength}return gt}});const FORMAT_MAP={[VK_FORMAT_R32G32B32A32_SFLOAT]:RGBAFormat,[VK_FORMAT_R16G16B16A16_SFLOAT]:RGBAFormat,[VK_FORMAT_R8G8B8A8_UNORM]:RGBAFormat,[VK_FORMAT_R8G8B8A8_SRGB]:RGBAFormat,[VK_FORMAT_R32G32_SFLOAT]:RGFormat,[VK_FORMAT_R16G16_SFLOAT]:RGFormat,[VK_FORMAT_R8G8_UNORM]:RGFormat,[VK_FORMAT_R8G8_SRGB]:RGFormat,[VK_FORMAT_R32_SFLOAT]:RedFormat,[VK_FORMAT_R16_SFLOAT]:RedFormat,[VK_FORMAT_R8_SRGB]:RedFormat,[VK_FORMAT_R8_UNORM]:RedFormat},TYPE_MAP={[VK_FORMAT_R32G32B32A32_SFLOAT]:FloatType,[VK_FORMAT_R16G16B16A16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8G8B8A8_UNORM]:UnsignedByteType,[VK_FORMAT_R8G8B8A8_SRGB]:UnsignedByteType,[VK_FORMAT_R32G32_SFLOAT]:FloatType,[VK_FORMAT_R16G16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8G8_UNORM]:UnsignedByteType,[VK_FORMAT_R8G8_SRGB]:UnsignedByteType,[VK_FORMAT_R32_SFLOAT]:FloatType,[VK_FORMAT_R16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8_SRGB]:UnsignedByteType,[VK_FORMAT_R8_UNORM]:UnsignedByteType},ENCODING_MAP={[VK_FORMAT_R8G8B8A8_SRGB]:3001,[VK_FORMAT_R8G8_SRGB]:3001,[VK_FORMAT_R8_SRGB]:3001};async function createDataTexture(tt){const{vkFormat:_e,pixelWidth:rt,pixelHeight:nt,pixelDepth:it}=tt;if(FORMAT_MAP[_e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");const st=tt.levels[0];let ot,lt;if(tt.supercompressionScheme===KHR_SUPERCOMPRESSION_NONE)ot=st.levelData;else if(tt.supercompressionScheme===KHR_SUPERCOMPRESSION_ZSTD)_zstd||(_zstd=new Promise(async ct=>{const ut=new Q$1;await ut.init(),ct(ut)})),ot=(await _zstd).decode(st.levelData,st.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");TYPE_MAP[_e]===FloatType?lt=new Float32Array(ot.buffer,ot.byteOffset,ot.byteLength/Float32Array.BYTES_PER_ELEMENT):TYPE_MAP[_e]===HalfFloatType?lt=new Uint16Array(ot.buffer,ot.byteOffset,ot.byteLength/Uint16Array.BYTES_PER_ELEMENT):lt=ot;const at=it===0?new DataTexture(lt,rt,nt):new Data3DTexture(lt,rt,nt,it);return at.type=TYPE_MAP[_e],at.format=FORMAT_MAP[_e],at.encoding=ENCODING_MAP[_e]||3e3,at.needsUpdate=!0,Promise.resolve(at)}class RGBELoader extends DataTextureLoader{constructor(_e){super(_e),this.type=HalfFloatType}parse(_e){const lt=function(yt,xt){switch(yt){case 1:console.error("THREE.RGBELoader Read Error: "+(xt||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(xt||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(xt||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(xt||""))}return-1},ht=`
`,dt=function(yt,xt,_t){xt=xt||1024;let bt=yt.pos,wt=-1,Tt=0,Mt="",Pt=String.fromCharCode.apply(null,new Uint16Array(yt.subarray(bt,bt+128)));for(;0>(wt=Pt.indexOf(ht))&&Tt<xt&&bt<yt.byteLength;)Mt+=Pt,Tt+=Pt.length,bt+=128,Pt+=String.fromCharCode.apply(null,new Uint16Array(yt.subarray(bt,bt+128)));return-1<wt?(_t!==!1&&(yt.pos+=Tt+wt+1),Mt+Pt.slice(0,wt)):!1},ft=function(yt){const xt=/^#\?(\S+)/,_t=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,Et=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,bt=/^\s*FORMAT=(\S+)\s*$/,wt=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Tt={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let Mt,Pt;if(yt.pos>=yt.byteLength||!(Mt=dt(yt)))return lt(1,"no header found");if(!(Pt=Mt.match(xt)))return lt(3,"bad initial token");for(Tt.valid|=1,Tt.programtype=Pt[1],Tt.string+=Mt+`
`;Mt=dt(yt),Mt!==!1;){if(Tt.string+=Mt+`
`,Mt.charAt(0)==="#"){Tt.comments+=Mt+`
`;continue}if((Pt=Mt.match(_t))&&(Tt.gamma=parseFloat(Pt[1])),(Pt=Mt.match(Et))&&(Tt.exposure=parseFloat(Pt[1])),(Pt=Mt.match(bt))&&(Tt.valid|=2,Tt.format=Pt[1]),(Pt=Mt.match(wt))&&(Tt.valid|=4,Tt.height=parseInt(Pt[1],10),Tt.width=parseInt(Pt[2],10)),Tt.valid&2&&Tt.valid&4)break}return Tt.valid&2?Tt.valid&4?Tt:lt(3,"missing image size specifier"):lt(3,"missing format specifier")},pt=function(yt,xt,_t){const Et=xt;if(Et<8||Et>32767||yt[0]!==2||yt[1]!==2||yt[2]&128)return new Uint8Array(yt);if(Et!==(yt[2]<<8|yt[3]))return lt(3,"wrong scanline width");const bt=new Uint8Array(4*xt*_t);if(!bt.length)return lt(4,"unable to allocate buffer space");let wt=0,Tt=0;const Mt=4*Et,Pt=new Uint8Array(4),It=new Uint8Array(Mt);let Ot=_t;for(;Ot>0&&Tt<yt.byteLength;){if(Tt+4>yt.byteLength)return lt(1);if(Pt[0]=yt[Tt++],Pt[1]=yt[Tt++],Pt[2]=yt[Tt++],Pt[3]=yt[Tt++],Pt[0]!=2||Pt[1]!=2||(Pt[2]<<8|Pt[3])!=Et)return lt(3,"bad rgbe scanline format");let Bt=0,Ut;for(;Bt<Mt&&Tt<yt.byteLength;){Ut=yt[Tt++];const jt=Ut>128;if(jt&&(Ut-=128),Ut===0||Bt+Ut>Mt)return lt(3,"bad scanline data");if(jt){const Dt=yt[Tt++];for(let Gt=0;Gt<Ut;Gt++)It[Bt++]=Dt}else It.set(yt.subarray(Tt,Tt+Ut),Bt),Bt+=Ut,Tt+=Ut}const Ft=Et;for(let jt=0;jt<Ft;jt++){let Dt=0;bt[wt]=It[jt+Dt],Dt+=Et,bt[wt+1]=It[jt+Dt],Dt+=Et,bt[wt+2]=It[jt+Dt],Dt+=Et,bt[wt+3]=It[jt+Dt],wt+=4}Ot--}return bt},mt=function(yt,xt,_t,Et){const bt=yt[xt+3],wt=Math.pow(2,bt-128)/255;_t[Et+0]=yt[xt+0]*wt,_t[Et+1]=yt[xt+1]*wt,_t[Et+2]=yt[xt+2]*wt,_t[Et+3]=1},gt=function(yt,xt,_t,Et){const bt=yt[xt+3],wt=Math.pow(2,bt-128)/255;_t[Et+0]=DataUtils.toHalfFloat(Math.min(yt[xt+0]*wt,65504)),_t[Et+1]=DataUtils.toHalfFloat(Math.min(yt[xt+1]*wt,65504)),_t[Et+2]=DataUtils.toHalfFloat(Math.min(yt[xt+2]*wt,65504)),_t[Et+3]=DataUtils.toHalfFloat(1)},vt=new Uint8Array(_e);vt.pos=0;const At=ft(vt);if(At!==-1){const yt=At.width,xt=At.height,_t=pt(vt.subarray(vt.pos),yt,xt);if(_t!==-1){let Et,bt,wt;switch(this.type){case FloatType:wt=_t.length/4;const Tt=new Float32Array(wt*4);for(let Pt=0;Pt<wt;Pt++)mt(_t,Pt*4,Tt,Pt*4);Et=Tt,bt=FloatType;break;case HalfFloatType:wt=_t.length/4;const Mt=new Uint16Array(wt*4);for(let Pt=0;Pt<wt;Pt++)gt(_t,Pt*4,Mt,Pt*4);Et=Mt,bt=HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:yt,height:xt,data:Et,header:At.string,gamma:At.gamma,exposure:At.exposure,type:bt}}}return null}setDataType(_e){return this.type=_e,this}load(_e,rt,nt,it){function st(ot,lt){switch(ot.type){case FloatType:case HalfFloatType:"colorSpace"in ot?ot.colorSpace="srgb-linear":ot.encoding=3e3,ot.minFilter=LinearFilter,ot.magFilter=LinearFilter,ot.generateMipmaps=!1,ot.flipY=!0;break}rt&&rt(ot,lt)}return super.load(_e,st,nt,it)}}const hasColorSpace="colorSpace"in new Texture;class EXRLoader extends DataTextureLoader{constructor(_e){super(_e),this.type=HalfFloatType}parse(_e){const Tt=Math.pow(2.7182818,2.2);function Mt(Wt,kt){for(var Jt=0,ir=0;ir<65536;++ir)(ir==0||Wt[ir>>3]&1<<(ir&7))&&(kt[Jt++]=ir);for(var tr=Jt-1;Jt<65536;)kt[Jt++]=0;return tr}function Pt(Wt){for(var kt=0;kt<16384;kt++)Wt[kt]={},Wt[kt].len=0,Wt[kt].lit=0,Wt[kt].p=null}const It={l:0,c:0,lc:0};function Ot(Wt,kt,Jt,ir,tr){for(;Jt<Wt;)kt=kt<<8|nr(ir,tr),Jt+=8;Jt-=Wt,It.l=kt>>Jt&(1<<Wt)-1,It.c=kt,It.lc=Jt}const Bt=new Array(59);function Ut(Wt){for(var kt=0;kt<=58;++kt)Bt[kt]=0;for(var kt=0;kt<65537;++kt)Bt[Wt[kt]]+=1;for(var Jt=0,kt=58;kt>0;--kt){var ir=Jt+Bt[kt]>>1;Bt[kt]=Jt,Jt=ir}for(var kt=0;kt<65537;++kt){var tr=Wt[kt];tr>0&&(Wt[kt]=tr|Bt[tr]++<<6)}}function Ft(Wt,kt,Jt,ir,tr,ar,Or){for(var Br=Jt,$r=0,Gr=0;tr<=ar;tr++){if(Br.value-Jt.value>ir)return!1;Ot(6,$r,Gr,Wt,Br);var Vr=It.l;if($r=It.c,Gr=It.lc,Or[tr]=Vr,Vr==63){if(Br.value-Jt.value>ir)throw"Something wrong with hufUnpackEncTable";Ot(8,$r,Gr,Wt,Br);var wr=It.l+6;if($r=It.c,Gr=It.lc,tr+wr>ar+1)throw"Something wrong with hufUnpackEncTable";for(;wr--;)Or[tr++]=0;tr--}else if(Vr>=59){var wr=Vr-59+2;if(tr+wr>ar+1)throw"Something wrong with hufUnpackEncTable";for(;wr--;)Or[tr++]=0;tr--}}Ut(Or)}function jt(Wt){return Wt&63}function Dt(Wt){return Wt>>6}function Gt(Wt,kt,Jt,ir){for(;kt<=Jt;kt++){var tr=Dt(Wt[kt]),ar=jt(Wt[kt]);if(tr>>ar)throw"Invalid table entry";if(ar>14){var Or=ir[tr>>ar-14];if(Or.len)throw"Invalid table entry";if(Or.lit++,Or.p){var Br=Or.p;Or.p=new Array(Or.lit);for(var $r=0;$r<Or.lit-1;++$r)Or.p[$r]=Br[$r]}else Or.p=new Array(1);Or.p[Or.lit-1]=kt}else if(ar)for(var Gr=0,$r=1<<14-ar;$r>0;$r--){var Or=ir[(tr<<14-ar)+Gr];if(Or.len||Or.p)throw"Invalid table entry";Or.len=ar,Or.lit=kt,Gr++}}return!0}const zt={c:0,lc:0};function $t(Wt,kt,Jt,ir){Wt=Wt<<8|nr(Jt,ir),kt+=8,zt.c=Wt,zt.lc=kt}const Ht={c:0,lc:0};function er(Wt,kt,Jt,ir,tr,ar,Or,Br,$r,Gr){if(Wt==kt){ir<8&&($t(Jt,ir,tr,Or),Jt=zt.c,ir=zt.lc),ir-=8;var Vr=Jt>>ir,Vr=new Uint8Array([Vr])[0];if($r.value+Vr>Gr)return!1;for(var wr=Br[$r.value-1];Vr-- >0;)Br[$r.value++]=wr}else if($r.value<Gr)Br[$r.value++]=Wt;else return!1;Ht.c=Jt,Ht.lc=ir}function Zt(Wt){return Wt&65535}function or(Wt){var kt=Zt(Wt);return kt>32767?kt-65536:kt}const Kt={a:0,b:0};function rr(Wt,kt){var Jt=or(Wt),ir=or(kt),tr=ir,ar=Jt+(tr&1)+(tr>>1),Or=ar,Br=ar-tr;Kt.a=Or,Kt.b=Br}function ur(Wt,kt){var Jt=Zt(Wt),ir=Zt(kt),tr=Jt-(ir>>1)&65535,ar=ir+tr-32768&65535;Kt.a=ar,Kt.b=tr}function fr(Wt,kt,Jt,ir,tr,ar,Or){for(var Br=Or<16384,$r=Jt>tr?tr:Jt,Gr=1,Vr;Gr<=$r;)Gr<<=1;for(Gr>>=1,Vr=Gr,Gr>>=1;Gr>=1;){for(var wr=0,Zr=wr+ar*(tr-Vr),Kr=ar*Gr,qr=ar*Vr,an=ir*Gr,hn=ir*Vr,ln,en,dn,sn;wr<=Zr;wr+=qr){for(var An=wr,Nn=wr+ir*(Jt-Vr);An<=Nn;An+=hn){var vn=An+an,kn=An+Kr,In=kn+an;Br?(rr(Wt[An+kt],Wt[kn+kt]),ln=Kt.a,dn=Kt.b,rr(Wt[vn+kt],Wt[In+kt]),en=Kt.a,sn=Kt.b,rr(ln,en),Wt[An+kt]=Kt.a,Wt[vn+kt]=Kt.b,rr(dn,sn),Wt[kn+kt]=Kt.a,Wt[In+kt]=Kt.b):(ur(Wt[An+kt],Wt[kn+kt]),ln=Kt.a,dn=Kt.b,ur(Wt[vn+kt],Wt[In+kt]),en=Kt.a,sn=Kt.b,ur(ln,en),Wt[An+kt]=Kt.a,Wt[vn+kt]=Kt.b,ur(dn,sn),Wt[kn+kt]=Kt.a,Wt[In+kt]=Kt.b)}if(Jt&Gr){var kn=An+Kr;Br?rr(Wt[An+kt],Wt[kn+kt]):ur(Wt[An+kt],Wt[kn+kt]),ln=Kt.a,Wt[kn+kt]=Kt.b,Wt[An+kt]=ln}}if(tr&Gr)for(var An=wr,Nn=wr+ir*(Jt-Vr);An<=Nn;An+=hn){var vn=An+an;Br?rr(Wt[An+kt],Wt[vn+kt]):ur(Wt[An+kt],Wt[vn+kt]),ln=Kt.a,Wt[vn+kt]=Kt.b,Wt[An+kt]=ln}Vr=Gr,Gr>>=1}return wr}function dr(Wt,kt,Jt,ir,tr,ar,Or,Br,$r,Gr){for(var Vr=0,wr=0,Zr=Br,Kr=Math.trunc(tr.value+(ar+7)/8);tr.value<Kr;)for($t(Vr,wr,Jt,tr),Vr=zt.c,wr=zt.lc;wr>=14;){var qr=Vr>>wr-14&16383,an=kt[qr];if(an.len)wr-=an.len,er(an.lit,Or,Vr,wr,Jt,ir,tr,$r,Gr,Zr),Vr=Ht.c,wr=Ht.lc;else{if(!an.p)throw"hufDecode issues";var hn;for(hn=0;hn<an.lit;hn++){for(var ln=jt(Wt[an.p[hn]]);wr<ln&&tr.value<Kr;)$t(Vr,wr,Jt,tr),Vr=zt.c,wr=zt.lc;if(wr>=ln&&Dt(Wt[an.p[hn]])==(Vr>>wr-ln&(1<<ln)-1)){wr-=ln,er(an.p[hn],Or,Vr,wr,Jt,ir,tr,$r,Gr,Zr),Vr=Ht.c,wr=Ht.lc;break}}if(hn==an.lit)throw"hufDecode issues"}}var en=8-ar&7;for(Vr>>=en,wr-=en;wr>0;){var an=kt[Vr<<14-wr&16383];if(an.len)wr-=an.len,er(an.lit,Or,Vr,wr,Jt,ir,tr,$r,Gr,Zr),Vr=Ht.c,wr=Ht.lc;else throw"hufDecode issues"}return!0}function gr(Wt,kt,Jt,ir,tr,ar){var Or={value:0},Br=Jt.value,$r=mr(kt,Jt),Gr=mr(kt,Jt);Jt.value+=4;var Vr=mr(kt,Jt);if(Jt.value+=4,$r<0||$r>=65537||Gr<0||Gr>=65537)throw"Something wrong with HUF_ENCSIZE";var wr=new Array(65537),Zr=new Array(16384);Pt(Zr);var Kr=ir-(Jt.value-Br);if(Ft(Wt,kt,Jt,Kr,$r,Gr,wr),Vr>8*(ir-(Jt.value-Br)))throw"Something wrong with hufUncompress";Gt(wr,$r,Gr,Zr),dr(wr,Zr,Wt,kt,Jt,Vr,Gr,ar,tr,Or)}function Yt(Wt,kt,Jt){for(var ir=0;ir<Jt;++ir)kt[ir]=Wt[kt[ir]]}function xr(Wt){for(var kt=1;kt<Wt.length;kt++){var Jt=Wt[kt-1]+Wt[kt]-128;Wt[kt]=Jt}}function vr(Wt,kt){for(var Jt=0,ir=Math.floor((Wt.length+1)/2),tr=0,ar=Wt.length-1;!(tr>ar||(kt[tr++]=Wt[Jt++],tr>ar));)kt[tr++]=Wt[ir++]}function Pr(Wt){for(var kt=Wt.byteLength,Jt=new Array,ir=0,tr=new DataView(Wt);kt>0;){var ar=tr.getInt8(ir++);if(ar<0){var Or=-ar;kt-=Or+1;for(var Br=0;Br<Or;Br++)Jt.push(tr.getUint8(ir++))}else{var Or=ar;kt-=2;for(var $r=tr.getUint8(ir++),Br=0;Br<Or+1;Br++)Jt.push($r)}}return Jt}function Sr(Wt,kt,Jt,ir,tr,ar){var vn=new DataView(ar.buffer),Or=Jt[Wt.idx[0]].width,Br=Jt[Wt.idx[0]].height,$r=3,Gr=Math.floor(Or/8),Vr=Math.ceil(Or/8),wr=Math.ceil(Br/8),Zr=Or-(Vr-1)*8,Kr=Br-(wr-1)*8,qr={value:0},an=new Array($r),hn=new Array($r),ln=new Array($r),en=new Array($r),dn=new Array($r);for(let yn=0;yn<$r;++yn)dn[yn]=kt[Wt.idx[yn]],an[yn]=yn<1?0:an[yn-1]+Vr*wr,hn[yn]=new Float32Array(64),ln[yn]=new Uint16Array(64),en[yn]=new Uint16Array(Vr*64);for(let yn=0;yn<wr;++yn){var sn=8;yn==wr-1&&(sn=Kr);var An=8;for(let On=0;On<Vr;++On){On==Vr-1&&(An=Zr);for(let _n=0;_n<$r;++_n)ln[_n].fill(0),ln[_n][0]=tr[an[_n]++],Qr(qr,ir,ln[_n]),Ir(ln[_n],hn[_n]),Dr(hn[_n]);Ur(hn);for(let _n=0;_n<$r;++_n)Lr(hn[_n],en[_n],On*64)}let Vn=0;for(let On=0;On<$r;++On){const _n=Jt[Wt.idx[On]].type;for(let jn=8*yn;jn<8*yn+sn;++jn){Vn=dn[On][jn];for(let Es=0;Es<Gr;++Es){const Kn=Es*64+(jn&7)*8;vn.setUint16(Vn+0*2*_n,en[On][Kn+0],!0),vn.setUint16(Vn+1*2*_n,en[On][Kn+1],!0),vn.setUint16(Vn+2*2*_n,en[On][Kn+2],!0),vn.setUint16(Vn+3*2*_n,en[On][Kn+3],!0),vn.setUint16(Vn+4*2*_n,en[On][Kn+4],!0),vn.setUint16(Vn+5*2*_n,en[On][Kn+5],!0),vn.setUint16(Vn+6*2*_n,en[On][Kn+6],!0),vn.setUint16(Vn+7*2*_n,en[On][Kn+7],!0),Vn+=8*2*_n}}if(Gr!=Vr)for(let jn=8*yn;jn<8*yn+sn;++jn){const Es=dn[On][jn]+8*Gr*2*_n,Kn=Gr*64+(jn&7)*8;for(let Ts=0;Ts<An;++Ts)vn.setUint16(Es+Ts*2*_n,en[On][Kn+Ts],!0)}}}for(var Nn=new Uint16Array(Or),vn=new DataView(ar.buffer),kn=0;kn<$r;++kn){Jt[Wt.idx[kn]].decoded=!0;var In=Jt[Wt.idx[kn]].type;if(Jt[kn].type==2)for(var Dn=0;Dn<Br;++Dn){const yn=dn[kn][Dn];for(var zn=0;zn<Or;++zn)Nn[zn]=vn.getUint16(yn+zn*2*In,!0);for(var zn=0;zn<Or;++zn)vn.setFloat32(yn+zn*2*In,Rr(Nn[zn]),!0)}}}function Qr(Wt,kt,Jt){for(var ir,tr=1;tr<64;)ir=kt[Wt.value],ir==65280?tr=64:ir>>8==255?tr+=ir&255:(Jt[tr]=ir,tr++),Wt.value++}function Ir(Wt,kt){kt[0]=Rr(Wt[0]),kt[1]=Rr(Wt[1]),kt[2]=Rr(Wt[5]),kt[3]=Rr(Wt[6]),kt[4]=Rr(Wt[14]),kt[5]=Rr(Wt[15]),kt[6]=Rr(Wt[27]),kt[7]=Rr(Wt[28]),kt[8]=Rr(Wt[2]),kt[9]=Rr(Wt[4]),kt[10]=Rr(Wt[7]),kt[11]=Rr(Wt[13]),kt[12]=Rr(Wt[16]),kt[13]=Rr(Wt[26]),kt[14]=Rr(Wt[29]),kt[15]=Rr(Wt[42]),kt[16]=Rr(Wt[3]),kt[17]=Rr(Wt[8]),kt[18]=Rr(Wt[12]),kt[19]=Rr(Wt[17]),kt[20]=Rr(Wt[25]),kt[21]=Rr(Wt[30]),kt[22]=Rr(Wt[41]),kt[23]=Rr(Wt[43]),kt[24]=Rr(Wt[9]),kt[25]=Rr(Wt[11]),kt[26]=Rr(Wt[18]),kt[27]=Rr(Wt[24]),kt[28]=Rr(Wt[31]),kt[29]=Rr(Wt[40]),kt[30]=Rr(Wt[44]),kt[31]=Rr(Wt[53]),kt[32]=Rr(Wt[10]),kt[33]=Rr(Wt[19]),kt[34]=Rr(Wt[23]),kt[35]=Rr(Wt[32]),kt[36]=Rr(Wt[39]),kt[37]=Rr(Wt[45]),kt[38]=Rr(Wt[52]),kt[39]=Rr(Wt[54]),kt[40]=Rr(Wt[20]),kt[41]=Rr(Wt[22]),kt[42]=Rr(Wt[33]),kt[43]=Rr(Wt[38]),kt[44]=Rr(Wt[46]),kt[45]=Rr(Wt[51]),kt[46]=Rr(Wt[55]),kt[47]=Rr(Wt[60]),kt[48]=Rr(Wt[21]),kt[49]=Rr(Wt[34]),kt[50]=Rr(Wt[37]),kt[51]=Rr(Wt[47]),kt[52]=Rr(Wt[50]),kt[53]=Rr(Wt[56]),kt[54]=Rr(Wt[59]),kt[55]=Rr(Wt[61]),kt[56]=Rr(Wt[35]),kt[57]=Rr(Wt[36]),kt[58]=Rr(Wt[48]),kt[59]=Rr(Wt[49]),kt[60]=Rr(Wt[57]),kt[61]=Rr(Wt[58]),kt[62]=Rr(Wt[62]),kt[63]=Rr(Wt[63])}function Dr(Wt){const kt=.5*Math.cos(.7853975),Jt=.5*Math.cos(3.14159/16),ir=.5*Math.cos(3.14159/8),tr=.5*Math.cos(3*3.14159/16),ar=.5*Math.cos(5*3.14159/16),Or=.5*Math.cos(3*3.14159/8),Br=.5*Math.cos(7*3.14159/16);for(var $r=new Array(4),Gr=new Array(4),Vr=new Array(4),wr=new Array(4),Zr=0;Zr<8;++Zr){var Kr=Zr*8;$r[0]=ir*Wt[Kr+2],$r[1]=Or*Wt[Kr+2],$r[2]=ir*Wt[Kr+6],$r[3]=Or*Wt[Kr+6],Gr[0]=Jt*Wt[Kr+1]+tr*Wt[Kr+3]+ar*Wt[Kr+5]+Br*Wt[Kr+7],Gr[1]=tr*Wt[Kr+1]-Br*Wt[Kr+3]-Jt*Wt[Kr+5]-ar*Wt[Kr+7],Gr[2]=ar*Wt[Kr+1]-Jt*Wt[Kr+3]+Br*Wt[Kr+5]+tr*Wt[Kr+7],Gr[3]=Br*Wt[Kr+1]-ar*Wt[Kr+3]+tr*Wt[Kr+5]-Jt*Wt[Kr+7],Vr[0]=kt*(Wt[Kr+0]+Wt[Kr+4]),Vr[3]=kt*(Wt[Kr+0]-Wt[Kr+4]),Vr[1]=$r[0]+$r[3],Vr[2]=$r[1]-$r[2],wr[0]=Vr[0]+Vr[1],wr[1]=Vr[3]+Vr[2],wr[2]=Vr[3]-Vr[2],wr[3]=Vr[0]-Vr[1],Wt[Kr+0]=wr[0]+Gr[0],Wt[Kr+1]=wr[1]+Gr[1],Wt[Kr+2]=wr[2]+Gr[2],Wt[Kr+3]=wr[3]+Gr[3],Wt[Kr+4]=wr[3]-Gr[3],Wt[Kr+5]=wr[2]-Gr[2],Wt[Kr+6]=wr[1]-Gr[1],Wt[Kr+7]=wr[0]-Gr[0]}for(var qr=0;qr<8;++qr)$r[0]=ir*Wt[16+qr],$r[1]=Or*Wt[16+qr],$r[2]=ir*Wt[48+qr],$r[3]=Or*Wt[48+qr],Gr[0]=Jt*Wt[8+qr]+tr*Wt[24+qr]+ar*Wt[40+qr]+Br*Wt[56+qr],Gr[1]=tr*Wt[8+qr]-Br*Wt[24+qr]-Jt*Wt[40+qr]-ar*Wt[56+qr],Gr[2]=ar*Wt[8+qr]-Jt*Wt[24+qr]+Br*Wt[40+qr]+tr*Wt[56+qr],Gr[3]=Br*Wt[8+qr]-ar*Wt[24+qr]+tr*Wt[40+qr]-Jt*Wt[56+qr],Vr[0]=kt*(Wt[qr]+Wt[32+qr]),Vr[3]=kt*(Wt[qr]-Wt[32+qr]),Vr[1]=$r[0]+$r[3],Vr[2]=$r[1]-$r[2],wr[0]=Vr[0]+Vr[1],wr[1]=Vr[3]+Vr[2],wr[2]=Vr[3]-Vr[2],wr[3]=Vr[0]-Vr[1],Wt[0+qr]=wr[0]+Gr[0],Wt[8+qr]=wr[1]+Gr[1],Wt[16+qr]=wr[2]+Gr[2],Wt[24+qr]=wr[3]+Gr[3],Wt[32+qr]=wr[3]-Gr[3],Wt[40+qr]=wr[2]-Gr[2],Wt[48+qr]=wr[1]-Gr[1],Wt[56+qr]=wr[0]-Gr[0]}function Ur(Wt){for(var kt=0;kt<64;++kt){var Jt=Wt[0][kt],ir=Wt[1][kt],tr=Wt[2][kt];Wt[0][kt]=Jt+1.5747*tr,Wt[1][kt]=Jt-.1873*ir-.4682*tr,Wt[2][kt]=Jt+1.8556*ir}}function Lr(Wt,kt,Jt){for(var ir=0;ir<64;++ir)kt[Jt+ir]=DataUtils.toHalfFloat(Wr(Wt[ir]))}function Wr(Wt){return Wt<=1?Math.sign(Wt)*Math.pow(Math.abs(Wt),2.2):Math.sign(Wt)*Math.pow(Tt,Math.abs(Wt)-1)}function Xt(Wt){return new DataView(Wt.array.buffer,Wt.offset.value,Wt.size)}function Qt(Wt){var kt=Wt.viewer.buffer.slice(Wt.offset.value,Wt.offset.value+Wt.size),Jt=new Uint8Array(Pr(kt)),ir=new Uint8Array(Jt.length);return xr(Jt),vr(Jt,ir),new DataView(ir.buffer)}function hr(Wt){var kt=Wt.array.slice(Wt.offset.value,Wt.offset.value+Wt.size),Jt=unzlibSync(kt),ir=new Uint8Array(Jt.length);return xr(Jt),vr(Jt,ir),new DataView(ir.buffer)}function kr(Wt){for(var kt=Wt.viewer,Jt={value:Wt.offset.value},ir=new Uint16Array(Wt.width*Wt.scanlineBlockSize*(Wt.channels*Wt.type)),tr=new Uint8Array(8192),ar=0,Or=new Array(Wt.channels),Br=0;Br<Wt.channels;Br++)Or[Br]={},Or[Br].start=ar,Or[Br].end=Or[Br].start,Or[Br].nx=Wt.width,Or[Br].ny=Wt.lines,Or[Br].size=Wt.type,ar+=Or[Br].nx*Or[Br].ny*Or[Br].size;var $r=br(kt,Jt),Gr=br(kt,Jt);if(Gr>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if($r<=Gr)for(var Br=0;Br<Gr-$r+1;Br++)tr[Br+$r]=Cr(kt,Jt);var Vr=new Uint16Array(65536),wr=Mt(tr,Vr),Zr=mr(kt,Jt);gr(Wt.array,kt,Jt,Zr,ir,ar);for(var Br=0;Br<Wt.channels;++Br)for(var Kr=Or[Br],qr=0;qr<Or[Br].size;++qr)fr(ir,Kr.start+qr,Kr.nx,Kr.size,Kr.ny,Kr.nx*Kr.size,wr);Yt(Vr,ir,ar);for(var an=0,hn=new Uint8Array(ir.buffer.byteLength),ln=0;ln<Wt.lines;ln++)for(var en=0;en<Wt.channels;en++){var Kr=Or[en],dn=Kr.nx*Kr.size,sn=new Uint8Array(ir.buffer,Kr.end*2,dn*2);hn.set(sn,an),an+=dn*2,Kr.end+=dn}return new DataView(hn.buffer)}function yr(Wt){var kt=Wt.array.slice(Wt.offset.value,Wt.offset.value+Wt.size),Jt=unzlibSync(kt);const ir=Wt.lines*Wt.channels*Wt.width,tr=Wt.type==1?new Uint16Array(ir):new Uint32Array(ir);let ar=0,Or=0;const Br=new Array(4);for(let $r=0;$r<Wt.lines;$r++)for(let Gr=0;Gr<Wt.channels;Gr++){let Vr=0;switch(Wt.type){case 1:Br[0]=ar,Br[1]=Br[0]+Wt.width,ar=Br[1]+Wt.width;for(let wr=0;wr<Wt.width;++wr){const Zr=Jt[Br[0]++]<<8|Jt[Br[1]++];Vr+=Zr,tr[Or]=Vr,Or++}break;case 2:Br[0]=ar,Br[1]=Br[0]+Wt.width,Br[2]=Br[1]+Wt.width,ar=Br[2]+Wt.width;for(let wr=0;wr<Wt.width;++wr){const Zr=Jt[Br[0]++]<<24|Jt[Br[1]++]<<16|Jt[Br[2]++]<<8;Vr+=Zr,tr[Or]=Vr,Or++}break}}return new DataView(tr.buffer)}function _r(Wt){var kt=Wt.viewer,Jt={value:Wt.offset.value},ir=new Uint8Array(Wt.width*Wt.lines*(Wt.channels*Wt.type*2)),tr={version:cr(kt,Jt),unknownUncompressedSize:cr(kt,Jt),unknownCompressedSize:cr(kt,Jt),acCompressedSize:cr(kt,Jt),dcCompressedSize:cr(kt,Jt),rleCompressedSize:cr(kt,Jt),rleUncompressedSize:cr(kt,Jt),rleRawSize:cr(kt,Jt),totalAcUncompressedCount:cr(kt,Jt),totalDcUncompressedCount:cr(kt,Jt),acCompression:cr(kt,Jt)};if(tr.version<2)throw"EXRLoader.parse: "+Mn.compression+" version "+tr.version+" is unsupported";for(var ar=new Array,Or=br(kt,Jt)-2;Or>0;){var Br=Hr(kt.buffer,Jt),$r=Cr(kt,Jt),Gr=$r>>2&3,Vr=($r>>4)-1,wr=new Int8Array([Vr])[0],Zr=Cr(kt,Jt);ar.push({name:Br,index:wr,type:Zr,compression:Gr}),Or-=Br.length+3}for(var Kr=Mn.channels,qr=new Array(Wt.channels),an=0;an<Wt.channels;++an){var hn=qr[an]={},ln=Kr[an];hn.name=ln.name,hn.compression=0,hn.decoded=!1,hn.type=ln.pixelType,hn.pLinear=ln.pLinear,hn.width=Wt.width,hn.height=Wt.lines}for(var en={idx:new Array(3)},dn=0;dn<Wt.channels;++dn)for(var hn=qr[dn],an=0;an<ar.length;++an){var sn=ar[an];hn.name==sn.name&&(hn.compression=sn.compression,sn.index>=0&&(en.idx[sn.index]=dn),hn.offset=dn)}if(tr.acCompressedSize>0)switch(tr.acCompression){case 0:var vn=new Uint16Array(tr.totalAcUncompressedCount);gr(Wt.array,kt,Jt,tr.acCompressedSize,vn,tr.totalAcUncompressedCount);break;case 1:var An=Wt.array.slice(Jt.value,Jt.value+tr.totalAcUncompressedCount),Nn=unzlibSync(An),vn=new Uint16Array(Nn.buffer);Jt.value+=tr.totalAcUncompressedCount;break}if(tr.dcCompressedSize>0){var kn={array:Wt.array,offset:Jt,size:tr.dcCompressedSize},In=new Uint16Array(hr(kn).buffer);Jt.value+=tr.dcCompressedSize}if(tr.rleRawSize>0){var An=Wt.array.slice(Jt.value,Jt.value+tr.rleCompressedSize),Nn=unzlibSync(An),Dn=Pr(Nn.buffer);Jt.value+=tr.rleCompressedSize}for(var zn=0,yn=new Array(qr.length),an=0;an<yn.length;++an)yn[an]=new Array;for(var Vn=0;Vn<Wt.lines;++Vn)for(var On=0;On<qr.length;++On)yn[On].push(zn),zn+=qr[On].width*Wt.type*2;Sr(en,yn,qr,vn,In,ir);for(var an=0;an<qr.length;++an){var hn=qr[an];if(!hn.decoded)switch(hn.compression){case 2:for(var _n=0,jn=0,Vn=0;Vn<Wt.lines;++Vn){for(var Es=yn[an][_n],Kn=0;Kn<hn.width;++Kn){for(var Ts=0;Ts<2*hn.type;++Ts)ir[Es++]=Dn[jn+Ts*hn.width*hn.height];jn++}_n++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(ir.buffer)}function Hr(Wt,kt){for(var Jt=new Uint8Array(Wt),ir=0;Jt[kt.value+ir]!=0;)ir+=1;var tr=new TextDecoder().decode(Jt.slice(kt.value,kt.value+ir));return kt.value=kt.value+ir+1,tr}function Er(Wt,kt,Jt){var ir=new TextDecoder().decode(new Uint8Array(Wt).slice(kt.value,kt.value+Jt));return kt.value=kt.value+Jt,ir}function Ar(Wt,kt){var Jt=pr(Wt,kt),ir=mr(Wt,kt);return[Jt,ir]}function qt(Wt,kt){var Jt=mr(Wt,kt),ir=mr(Wt,kt);return[Jt,ir]}function pr(Wt,kt){var Jt=Wt.getInt32(kt.value,!0);return kt.value=kt.value+4,Jt}function mr(Wt,kt){var Jt=Wt.getUint32(kt.value,!0);return kt.value=kt.value+4,Jt}function nr(Wt,kt){var Jt=Wt[kt.value];return kt.value=kt.value+1,Jt}function Cr(Wt,kt){var Jt=Wt.getUint8(kt.value);return kt.value=kt.value+1,Jt}const cr=function(Wt,kt){let Jt;return"getBigInt64"in DataView.prototype?Jt=Number(Wt.getBigInt64(kt.value,!0)):Jt=Wt.getUint32(kt.value+4,!0)+Number(Wt.getUint32(kt.value,!0)<<32),kt.value+=8,Jt};function Jr(Wt,kt){var Jt=Wt.getFloat32(kt.value,!0);return kt.value+=4,Jt}function lr(Wt,kt){return DataUtils.toHalfFloat(Jr(Wt,kt))}function Rr(Wt){var kt=(Wt&31744)>>10,Jt=Wt&1023;return(Wt>>15?-1:1)*(kt?kt===31?Jt?NaN:1/0:Math.pow(2,kt-15)*(1+Jt/1024):6103515625e-14*(Jt/1024))}function br(Wt,kt){var Jt=Wt.getUint16(kt.value,!0);return kt.value+=2,Jt}function jr(Wt,kt){return Rr(br(Wt,kt))}function Yr(Wt,kt,Jt,ir){for(var tr=Jt.value,ar=[];Jt.value<tr+ir-1;){var Or=Hr(kt,Jt),Br=pr(Wt,Jt),$r=Cr(Wt,Jt);Jt.value+=3;var Gr=pr(Wt,Jt),Vr=pr(Wt,Jt);ar.push({name:Or,pixelType:Br,pLinear:$r,xSampling:Gr,ySampling:Vr})}return Jt.value+=1,ar}function mn(Wt,kt){var Jt=Jr(Wt,kt),ir=Jr(Wt,kt),tr=Jr(Wt,kt),ar=Jr(Wt,kt),Or=Jr(Wt,kt),Br=Jr(Wt,kt),$r=Jr(Wt,kt),Gr=Jr(Wt,kt);return{redX:Jt,redY:ir,greenX:tr,greenY:ar,blueX:Or,blueY:Br,whiteX:$r,whiteY:Gr}}function bn(Wt,kt){var Jt=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],ir=Cr(Wt,kt);return Jt[ir]}function fn(Wt,kt){var Jt=mr(Wt,kt),ir=mr(Wt,kt),tr=mr(Wt,kt),ar=mr(Wt,kt);return{xMin:Jt,yMin:ir,xMax:tr,yMax:ar}}function Cn(Wt,kt){var Jt=["INCREASING_Y"],ir=Cr(Wt,kt);return Jt[ir]}function Tn(Wt,kt){var Jt=Jr(Wt,kt),ir=Jr(Wt,kt);return[Jt,ir]}function gn(Wt,kt){var Jt=Jr(Wt,kt),ir=Jr(Wt,kt),tr=Jr(Wt,kt);return[Jt,ir,tr]}function En(Wt,kt,Jt,ir,tr){if(ir==="string"||ir==="stringvector"||ir==="iccProfile")return Er(kt,Jt,tr);if(ir==="chlist")return Yr(Wt,kt,Jt,tr);if(ir==="chromaticities")return mn(Wt,Jt);if(ir==="compression")return bn(Wt,Jt);if(ir==="box2i")return fn(Wt,Jt);if(ir==="lineOrder")return Cn(Wt,Jt);if(ir==="float")return Jr(Wt,Jt);if(ir==="v2f")return Tn(Wt,Jt);if(ir==="v3f")return gn(Wt,Jt);if(ir==="int")return pr(Wt,Jt);if(ir==="rational")return Ar(Wt,Jt);if(ir==="timecode")return qt(Wt,Jt);if(ir==="preview")return Jt.value+=tr,"skipped";Jt.value+=tr}function Xn(Wt,kt,Jt){const ir={};if(Wt.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";ir.version=Wt.getUint8(4);const tr=Wt.getUint8(5);ir.spec={singleTile:!!(tr&2),longName:!!(tr&4),deepFormat:!!(tr&8),multiPart:!!(tr&16)},Jt.value=8;for(var ar=!0;ar;){var Or=Hr(kt,Jt);if(Or==0)ar=!1;else{var Br=Hr(kt,Jt),$r=mr(Wt,Jt),Gr=En(Wt,kt,Jt,Br,$r);Gr===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Br}'.`):ir[Or]=Gr}}if(tr!=0)throw console.error("EXRHeader:",ir),"THREE.EXRLoader: provided file is currently unsupported.";return ir}function $n(Wt,kt,Jt,ir,tr){const ar={size:0,viewer:kt,array:Jt,offset:ir,width:Wt.dataWindow.xMax-Wt.dataWindow.xMin+1,height:Wt.dataWindow.yMax-Wt.dataWindow.yMin+1,channels:Wt.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:Wt.channels[0].pixelType,uncompress:null,getter:null,format:null,[hasColorSpace?"colorSpace":"encoding"]:null};switch(Wt.compression){case"NO_COMPRESSION":ar.lines=1,ar.uncompress=Xt;break;case"RLE_COMPRESSION":ar.lines=1,ar.uncompress=Qt;break;case"ZIPS_COMPRESSION":ar.lines=1,ar.uncompress=hr;break;case"ZIP_COMPRESSION":ar.lines=16,ar.uncompress=hr;break;case"PIZ_COMPRESSION":ar.lines=32,ar.uncompress=kr;break;case"PXR24_COMPRESSION":ar.lines=16,ar.uncompress=yr;break;case"DWAA_COMPRESSION":ar.lines=32,ar.uncompress=_r;break;case"DWAB_COMPRESSION":ar.lines=256,ar.uncompress=_r;break;default:throw"EXRLoader.parse: "+Wt.compression+" is unsupported"}if(ar.scanlineBlockSize=ar.lines,ar.type==1)switch(tr){case FloatType:ar.getter=jr,ar.inputSize=2;break;case HalfFloatType:ar.getter=br,ar.inputSize=2;break}else if(ar.type==2)switch(tr){case FloatType:ar.getter=Jr,ar.inputSize=4;break;case HalfFloatType:ar.getter=lr,ar.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+ar.type+" for "+Wt.compression+".";ar.blockCount=(Wt.dataWindow.yMax+1)/ar.scanlineBlockSize;for(var Or=0;Or<ar.blockCount;Or++)cr(kt,ir);ar.outputChannels=ar.channels==3?4:ar.channels;const Br=ar.width*ar.height*ar.outputChannels;switch(tr){case FloatType:ar.byteArray=new Float32Array(Br),ar.channels<ar.outputChannels&&ar.byteArray.fill(1,0,Br);break;case HalfFloatType:ar.byteArray=new Uint16Array(Br),ar.channels<ar.outputChannels&&ar.byteArray.fill(15360,0,Br);break;default:console.error("THREE.EXRLoader: unsupported type: ",tr);break}return ar.bytesPerLine=ar.width*ar.inputSize*ar.channels,ar.outputChannels==4?ar.format=RGBAFormat:ar.format=RedFormat,hasColorSpace?ar.colorSpace="srgb-linear":ar.encoding=3e3,ar}const wn=new DataView(_e),Bn=new Uint8Array(_e),Qn={value:0},Mn=Xn(wn,_e,Qn),on=$n(Mn,wn,Bn,Qn,this.type),Gn={value:0},_s={R:0,G:1,B:2,A:3,Y:0};for(let Wt=0;Wt<on.height/on.scanlineBlockSize;Wt++){const kt=mr(wn,Qn);on.size=mr(wn,Qn),on.lines=kt+on.scanlineBlockSize>on.height?on.height-kt:on.scanlineBlockSize;const ir=on.size<on.lines*on.bytesPerLine?on.uncompress(on):Xt(on);Qn.value+=on.size;for(let tr=0;tr<on.scanlineBlockSize;tr++){const ar=tr+Wt*on.scanlineBlockSize;if(ar>=on.height)break;for(let Or=0;Or<on.channels;Or++){const Br=_s[Mn.channels[Or].name];for(let $r=0;$r<on.width;$r++){Gn.value=(tr*(on.channels*on.width)+Or*on.width+$r)*on.inputSize;const Gr=(on.height-1-ar)*(on.width*on.outputChannels)+$r*on.outputChannels+Br;on.byteArray[Gr]=on.getter(ir,Gn)}}}}return{header:Mn,width:on.width,height:on.height,data:on.byteArray,format:on.format,[hasColorSpace?"colorSpace":"encoding"]:on[hasColorSpace?"colorSpace":"encoding"],type:this.type}}setDataType(_e){return this.type=_e,this}load(_e,rt,nt,it){function st(ot,lt){hasColorSpace?ot.colorSpace=lt.colorSpace:ot.encoding=lt.encoding,ot.minFilter=LinearFilter,ot.magFilter=LinearFilter,ot.generateMipmaps=!1,ot.flipY=!1,rt&&rt(ot,lt)}return super.load(_e,st,nt,it)}}const _taskCache$2=new WeakMap,_BasisTextureLoader=class extends Loader{constructor(tt){super(tt),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig=null}setTranscoderPath(tt){return this.transcoderPath=tt,this}setWorkerLimit(tt){return this.workerLimit=tt,this}detectSupport(tt){return this.workerConfig={astcSupported:tt.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:tt.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:tt.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:tt.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:tt.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:tt.extensions.has("WEBGL_compressed_texture_pvrtc")||tt.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}load(tt,_e,rt,nt){const it=new FileLoader(this.manager);it.setResponseType("arraybuffer"),it.setWithCredentials(this.withCredentials);const st=new CompressedTexture;return it.load(tt,ot=>{if(_taskCache$2.has(ot))return _taskCache$2.get(ot).promise.then(_e).catch(nt);this._createTexture([ot]).then(function(lt){st.copy(lt),st.needsUpdate=!0,_e&&_e(st)}).catch(nt)},rt,nt),st}parseInternalAsync(tt){const{levels:_e}=tt,rt=new Set;for(let nt=0;nt<_e.length;nt++)rt.add(_e[nt].data.buffer);return this._createTexture(Array.from(rt),{...tt,lowLevel:!0})}_createTexture(tt,_e={}){let rt,nt;const it=_e;let st=0;for(let lt=0;lt<tt.length;lt++)st+=tt[lt].byteLength;const ot=this._allocateWorker(st).then(lt=>(rt=lt,nt=this.workerNextTaskID++,new Promise((at,ct)=>{rt._callbacks[nt]={resolve:at,reject:ct},rt.postMessage({type:"transcode",id:nt,buffers:tt,taskConfig:it},tt)}))).then(lt=>{const{mipmaps:at,width:ct,height:ut,format:ht}=lt,dt=new CompressedTexture(at,ct,ut,ht,UnsignedByteType);return dt.minFilter=at.length===1?LinearFilter:LinearMipmapLinearFilter,dt.magFilter=LinearFilter,dt.generateMipmaps=!1,dt.needsUpdate=!0,dt});return ot.catch(()=>!0).then(()=>{rt&&nt&&(rt._taskLoad-=st,delete rt._callbacks[nt])}),_taskCache$2.set(tt[0],{promise:ot}),ot}_initTranscoder(){if(!this.transcoderPending){const tt=new FileLoader(this.manager);tt.setPath(this.transcoderPath),tt.setWithCredentials(this.withCredentials);const _e=new Promise((it,st)=>{tt.load("basis_transcoder.js",it,void 0,st)}),rt=new FileLoader(this.manager);rt.setPath(this.transcoderPath),rt.setResponseType("arraybuffer"),rt.setWithCredentials(this.withCredentials);const nt=new Promise((it,st)=>{rt.load("basis_transcoder.wasm",it,void 0,st)});this.transcoderPending=Promise.all([_e,nt]).then(([it,st])=>{const ot=_BasisTextureLoader.BasisWorker.toString(),lt=["/* constants */","let _EngineFormat = "+JSON.stringify(_BasisTextureLoader.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(_BasisTextureLoader.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(_BasisTextureLoader.BasisFormat),"/* basis_transcoder.js */",it,"/* worker */",ot.substring(ot.indexOf("{")+1,ot.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([lt])),this.transcoderBinary=st})}return this.transcoderPending}_allocateWorker(tt){return this._initTranscoder().then(()=>{if(this.workerPool.length<this.workerLimit){const rt=new Worker(this.workerSourceURL);rt._callbacks={},rt._taskLoad=0,rt.postMessage({type:"init",config:this.workerConfig,transcoderBinary:this.transcoderBinary}),rt.onmessage=function(nt){const it=nt.data;switch(it.type){case"transcode":rt._callbacks[it.id].resolve(it);break;case"error":rt._callbacks[it.id].reject(it);break;default:console.error('THREE.BasisTextureLoader: Unexpected message, "'+it.type+'"')}},this.workerPool.push(rt)}else this.workerPool.sort(function(rt,nt){return rt._taskLoad>nt._taskLoad?-1:1});const _e=this.workerPool[this.workerPool.length-1];return _e._taskLoad+=tt,_e})}dispose(){for(let tt=0;tt<this.workerPool.length;tt++)this.workerPool[tt].terminate();return this.workerPool.length=0,this}};let BasisTextureLoader=_BasisTextureLoader;__publicField(BasisTextureLoader,"BasisFormat",{ETC1S:0,UASTC_4x4:1});__publicField(BasisTextureLoader,"TranscoderFormat",{ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16});__publicField(BasisTextureLoader,"EngineFormat",{RGBAFormat,RGBA_ASTC_4x4_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format});__publicField(BasisTextureLoader,"BasisWorker",function(){let tt,_e,rt;const nt=_EngineFormat,it=_TranscoderFormat,st=_BasisFormat;onmessage=function(At){const yt=At.data;switch(yt.type){case"init":tt=yt.config,ot(yt.transcoderBinary);break;case"transcode":_e.then(()=>{try{const{width:xt,height:_t,hasAlpha:Et,mipmaps:bt,format:wt}=yt.taskConfig.lowLevel?lt(yt.taskConfig):at(yt.buffers[0]),Tt=[];for(let Mt=0;Mt<bt.length;++Mt)Tt.push(bt[Mt].data.buffer);self.postMessage({type:"transcode",id:yt.id,width:xt,height:_t,hasAlpha:Et,mipmaps:bt,format:wt},Tt)}catch(xt){console.error(xt),self.postMessage({type:"error",id:yt.id,error:xt.message})}});break}};function ot(At){_e=new Promise(yt=>{rt={wasmBinary:At,onRuntimeInitialized:yt},BASIS(rt)}).then(()=>{rt.initializeBasis()})}function lt(At){const{basisFormat:yt,width:xt,height:_t,hasAlpha:Et}=At,{transcoderFormat:bt,engineFormat:wt}=dt(yt,xt,_t,Et),Tt=rt.getBytesPerBlockOrPixel(bt);ft(rt.isFormatSupported(bt),"THREE.BasisTextureLoader: Unsupported format.");const Mt=[];if(yt===st.ETC1S){const Pt=new rt.LowLevelETC1SImageTranscoder,{endpointCount:It,endpointsData:Ot,selectorCount:Bt,selectorsData:Ut,tablesData:Ft}=At.globalData;try{let jt;jt=Pt.decodePalettes(It,Ot,Bt,Ut),ft(jt,"THREE.BasisTextureLoader: decodePalettes() failed."),jt=Pt.decodeTables(Ft),ft(jt,"THREE.BasisTextureLoader: decodeTables() failed.");for(let Dt=0;Dt<At.levels.length;Dt++){const Gt=At.levels[Dt],zt=At.globalData.imageDescs[Dt],$t=gt(bt,Gt.width,Gt.height),Ht=new Uint8Array($t);jt=Pt.transcodeImage(bt,Ht,$t/Tt,Gt.data,pt(bt,Gt.width),mt(bt,Gt.height),Gt.width,Gt.height,Gt.index,zt.rgbSliceByteOffset,zt.rgbSliceByteLength,zt.alphaSliceByteOffset,zt.alphaSliceByteLength,zt.imageFlags,Et,!1,0,0),ft(jt,"THREE.BasisTextureLoader: transcodeImage() failed for level "+Gt.index+"."),Mt.push({data:Ht,width:Gt.width,height:Gt.height})}}finally{Pt.delete()}}else for(let Pt=0;Pt<At.levels.length;Pt++){const It=At.levels[Pt],Ot=gt(bt,It.width,It.height),Bt=new Uint8Array(Ot),Ut=rt.transcodeUASTCImage(bt,Bt,Ot/Tt,It.data,pt(bt,It.width),mt(bt,It.height),It.width,It.height,It.index,0,It.data.byteLength,0,Et,!1,0,0,-1,-1);ft(Ut,"THREE.BasisTextureLoader: transcodeUASTCImage() failed for level "+It.index+"."),Mt.push({data:Bt,width:It.width,height:It.height})}return{width:xt,height:_t,hasAlpha:Et,mipmaps:Mt,format:wt}}function at(At){const yt=new rt.BasisFile(new Uint8Array(At)),xt=yt.isUASTC()?st.UASTC_4x4:st.ETC1S,_t=yt.getImageWidth(0,0),Et=yt.getImageHeight(0,0),bt=yt.getNumLevels(0),wt=yt.getHasAlpha();function Tt(){yt.close(),yt.delete()}const{transcoderFormat:Mt,engineFormat:Pt}=dt(xt,_t,Et,wt);if(!_t||!Et||!bt)throw Tt(),new Error("THREE.BasisTextureLoader:	Invalid texture");if(!yt.startTranscoding())throw Tt(),new Error("THREE.BasisTextureLoader: .startTranscoding failed");const It=[];for(let Ot=0;Ot<bt;Ot++){const Bt=yt.getImageWidth(0,Ot),Ut=yt.getImageHeight(0,Ot),Ft=new Uint8Array(yt.getImageTranscodedSizeInBytes(0,Ot,Mt));if(!yt.transcodeImage(Ft,0,Ot,Mt,0,wt))throw Tt(),new Error("THREE.BasisTextureLoader: .transcodeImage failed.");It.push({data:Ft,width:Bt,height:Ut})}return Tt(),{width:_t,height:Et,hasAlpha:wt,mipmaps:It,format:Pt}}const ct=[{if:"astcSupported",basisFormat:[st.UASTC_4x4],transcoderFormat:[it.ASTC_4x4,it.ASTC_4x4],engineFormat:[nt.RGBA_ASTC_4x4_Format,nt.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.BC7_M5,it.BC7_M5],engineFormat:[nt.RGBA_BPTC_Format,nt.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.BC1,it.BC3],engineFormat:[nt.RGB_S3TC_DXT1_Format,nt.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.ETC1,it.ETC2],engineFormat:[nt.RGB_ETC2_Format,nt.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.ETC1,it.ETC1],engineFormat:[nt.RGB_ETC1_Format,nt.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[it.PVRTC1_4_RGB,it.PVRTC1_4_RGBA],engineFormat:[nt.RGB_PVRTC_4BPPV1_Format,nt.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],ut=ct.sort(function(At,yt){return At.priorityETC1S-yt.priorityETC1S}),ht=ct.sort(function(At,yt){return At.priorityUASTC-yt.priorityUASTC});function dt(At,yt,xt,_t){let Et,bt;const wt=At===st.ETC1S?ut:ht;for(let Tt=0;Tt<wt.length;Tt++){const Mt=wt[Tt];if(tt[Mt.if]&&Mt.basisFormat.includes(At)&&!(Mt.needsPowerOfTwo&&!(vt(yt)&&vt(xt))))return Et=Mt.transcoderFormat[_t?1:0],bt=Mt.engineFormat[_t?1:0],{transcoderFormat:Et,engineFormat:bt}}return console.warn("THREE.BasisTextureLoader: No suitable compressed texture format found. Decoding to RGBA32."),Et=it.RGBA32,bt=nt.RGBAFormat,{transcoderFormat:Et,engineFormat:bt}}function ft(At,yt){if(!At)throw new Error(yt)}function pt(At,yt){return Math.ceil(yt/rt.getFormatBlockWidth(At))}function mt(At,yt){return Math.ceil(yt/rt.getFormatBlockHeight(At))}function gt(At,yt,xt){const _t=rt.getBytesPerBlockOrPixel(At);if(rt.formatIsUncompressed(At))return yt*xt*_t;if(At===it.PVRTC1_4_RGB||At===it.PVRTC1_4_RGBA){const Et=yt+3&-4,bt=xt+3&-4;return(Math.max(8,Et)*Math.max(8,bt)*4+7)/8}return pt(At,yt)*mt(At,xt)*_t}function vt(At){return At<=2?!0:(At&At-1)===0&&At!==0}});const DEFAULT_PROFILES_PATH="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",DEFAULT_PROFILE="generic-trigger";class XRControllerModelFactory{constructor(_e=null,rt=DEFAULT_PROFILES_PATH){this.gltfLoader=_e??new GLTFLoader$1,this.path=rt,this._assetCache={}}initializeControllerModel(_e,rt){return rt.targetRayMode!=="tracked-pointer"||!rt.gamepad?Promise.resolve():fetchProfile(rt,this.path,DEFAULT_PROFILE).then(({profile:nt,assetPath:it})=>{if(!it)throw new Error("no asset path");const st=new MotionController(rt,nt,it);_e.connectMotionController(st);const ot=st.assetUrl,lt=this._assetCache[ot];if(lt){const at=lt.scene.clone();_e.connectModel(at)}else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(ot,at=>{if(!_e.motionController){console.warn("motionController gone while gltf load, bailing...");return}this._assetCache[ot]=at;const ct=at.scene.clone();_e.connectModel(ct)},void 0,()=>{throw new Error(`Asset ${ot} missing or malformed.`)})}}).catch(nt=>{console.warn(nt)})}}const isEnvMapApplicable=tt=>"envMap"in tt,updateEnvMap=(tt,_e)=>{tt.envMap=_e,tt.needsUpdate=!0},applyEnvironmentMap=(tt,_e)=>{_e instanceof Mesh&&(Array.isArray(_e.material)?_e.material.forEach(rt=>isEnvMapApplicable(rt)?updateEnvMap(rt,tt):void 0):isEnvMapApplicable(_e.material)&&updateEnvMap(_e.material,tt))},isEnvMapIntensityApplicable=tt=>"envMapIntensity"in tt,updateEnvMapIntensity=(tt,_e)=>{tt.envMapIntensity=_e,tt.needsUpdate=!0},applyEnvironmentMapIntensity=(tt,_e)=>{_e instanceof Mesh&&(Array.isArray(_e.material)?_e.material.forEach(rt=>isEnvMapIntensityApplicable(rt)?updateEnvMapIntensity(rt,tt):void 0):isEnvMapIntensityApplicable(_e.material)&&updateEnvMapIntensity(_e.material,tt))};function findNodes(tt,_e){Object.values(tt.components).forEach(rt=>{const{type:nt,touchPointNodeName:it,visualResponses:st}=rt;if(nt===MotionControllerConstants.ComponentType.TOUCHPAD&&it)if(rt.touchPointNode=_e.getObjectByName(it),rt.touchPointNode){const ot=new SphereGeometry(.001),lt=new MeshBasicMaterial({color:255}),at=new Mesh(ot,lt);rt.touchPointNode.add(at)}else console.warn(`Could not find touch dot, ${rt.touchPointNodeName}, in touchpad component ${rt.id}`);Object.values(st).forEach(ot=>{const{valueNodeName:lt,minNodeName:at,maxNodeName:ct,valueNodeProperty:ut}=ot;if(ut===MotionControllerConstants.VisualResponseProperty.TRANSFORM&&at&&ct){if(ot.minNode=_e.getObjectByName(at),ot.maxNode=_e.getObjectByName(ct),!ot.minNode){console.warn(`Could not find ${at} in the model`);return}if(!ot.maxNode){console.warn(`Could not find ${ct} in the model`);return}}ot.valueNode=_e.getObjectByName(lt),ot.valueNode||console.warn(`Could not find ${lt} in the model`)})})}function addAssetSceneToControllerModel(tt,_e){findNodes(tt.motionController,_e),(tt.envMap||tt.envMapIntensity!=null)&&_e.traverse(rt=>{tt.envMap&&applyEnvironmentMap(tt.envMap,rt),tt.envMapIntensity!=null&&applyEnvironmentMapIntensity(tt.envMapIntensity,rt)}),tt.add(_e)}class XRControllerModel extends Group{constructor(){super(),this.motionController=null,this.envMap=null,this.envMapIntensity=1,this.scene=null}setEnvironmentMap(_e,rt=1){var nt;return this.envMap===_e&&this.envMapIntensity===rt?this:(this.envMap=_e,this.envMapIntensity=rt,(nt=this.scene)==null||nt.traverse(it=>{applyEnvironmentMap(_e,it),applyEnvironmentMapIntensity(rt,it)}),this)}setEnvironmentMapIntensity(_e){var rt;return this.envMapIntensity===_e?this:(this.envMapIntensity=_e,(rt=this.scene)==null||rt.traverse(nt=>applyEnvironmentMapIntensity(_e,nt)),this)}connectModel(_e){if(!this.motionController){console.warn("scene tried to add, but no motion controller");return}this.scene=_e,addAssetSceneToControllerModel(this,_e),this.dispatchEvent({type:"modelconnected",data:_e})}connectMotionController(_e){this.motionController=_e,this.dispatchEvent({type:"motionconnected",data:_e})}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(rt=>{Object.values(rt.visualResponses).forEach(nt=>{const{valueNode:it,minNode:st,maxNode:ot,value:lt,valueNodeProperty:at}=nt;it&&(at===MotionControllerConstants.VisualResponseProperty.VISIBILITY&&typeof lt=="boolean"?it.visible=lt:at===MotionControllerConstants.VisualResponseProperty.TRANSFORM&&st&&ot&&typeof lt=="number"&&(it.quaternion.slerpQuaternions(st.quaternion,ot.quaternion,lt),it.position.lerpVectors(st.position,ot.position,lt)))})}))}disconnect(){this.dispatchEvent({type:"motiondisconnected",data:this.motionController}),this.dispatchEvent({type:"modeldisconnected",data:this.scene}),this.motionController=null,this.scene&&this.remove(this.scene),this.scene=null}dispose(){this.disconnect()}}const Ray=reactExports.forwardRef(function({target:_e,hideOnBlur:rt=!1,...nt},it){const st=useXR(at=>at.hoverState),ot=reactExports.useRef(null),lt=reactExports.useMemo(()=>new BufferGeometry().setFromPoints([new Vector3(0,0,0),new Vector3(0,0,-1)]),[]);return reactExports.useImperativeHandle(it,()=>ot.current),useFrame(()=>{if(!_e.inputSource)return;let at=1;const ct=st[_e.inputSource.handedness].values().next().value;ct&&_e.inputSource.handedness!=="none"?(at=ct.distance,rt&&(ot.current.visible=!1)):rt&&(ot.current.visible=!0);const ut=-.01;ot.current.scale.z=at+ut}),reactExports.createElement("line",{ref:ot,geometry:lt,"material-opacity":.8,"material-transparent":!0,...nt})}),modelFactory=new XRControllerModelFactory,ControllerModel=({target:tt,envMap:_e,envMapIntensity:rt})=>{const nt=reactExports.useRef(null),it=useCallbackRef$2(at=>{_e!=null&&at.setEnvironmentMap(_e)}),st=useCallbackRef$2(at=>at.setEnvironmentMap(null)),ot=useCallbackRef$2(at=>{rt!=null&&at.setEnvironmentMapIntensity(rt)}),lt=reactExports.useCallback(at=>{var ct,ut,ht;if(nt.current=at,at){if(tt.xrControllerModel=at,(ct=tt.inputSource)!=null&&ct.hand)return;it.current(at),ot.current(at),tt.inputSource?modelFactory.initializeControllerModel(at,tt.inputSource):console.warn("no input source on XRController when handleControllerModel")}else{if((ut=tt.inputSource)!=null&&ut.hand)return;(ht=tt.xrControllerModel)==null||ht.disconnect(),tt.xrControllerModel=null}},[tt,ot,it]);return reactExports.useLayoutEffect(()=>{nt.current&&(_e?it.current(nt.current):st.current(nt.current))},[_e,it,st]),reactExports.useLayoutEffect(()=>{nt.current&&ot.current(nt.current)},[rt,ot]),reactExports.createElement("xRControllerModel",{ref:lt})};function Controllers({rayMaterial:tt={},hideRaysOnBlur:_e=!1,envMap:rt,envMapIntensity:nt}){const it=useXR(lt=>lt.controllers),st=useXR(lt=>lt.isHandTracking),ot=reactExports.useMemo(()=>Object.entries(tt).reduce((lt,[at,ct])=>({...lt,[`material-${at}`]:ct}),{}),[JSON.stringify(tt)]);return reactExports.useMemo(()=>extend$2({XRControllerModel}),[]),reactExports.createElement(reactExports.Fragment,null,it.map((lt,at)=>reactExports.createElement(reactExports.Fragment,{key:at},createPortal(reactExports.createElement(ControllerModel,{target:lt,envMap:rt,envMapIntensity:nt}),lt.grip),createPortal(reactExports.createElement(Ray,{visible:!st,hideOnBlur:_e,target:lt,...ot}),lt.controller))))}const DEFAULT_HAND_PROFILE_PATH="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/generic-hand/";class XRHandMeshModel{constructor(_e,rt,nt=DEFAULT_HAND_PROFILE_PATH,it,st){this.controller=rt,this.handModel=_e,this.bones=[];const ot=new GLTFLoader$1;st||ot.setPath(nt),ot.load(st??`${it}.glb`,lt=>{const at=lt.scene.children[0];this.handModel.add(at),this.scene=at;const ct=at.getObjectByProperty("type","SkinnedMesh");ct.frustumCulled=!1,ct.castShadow=!0,ct.receiveShadow=!0,["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"].forEach(ht=>{const dt=at.getObjectByName(ht);dt!==void 0?dt.jointName=ht:console.warn(`Couldn't find ${ht} in ${it} hand mesh`),this.bones.push(dt)})})}updateMesh(){const _e=this.controller.joints;let rt=!0;for(let nt=0;nt<this.bones.length;nt++){const it=this.bones[nt];if(it){const st=_e[it.jointName];if(st.visible){const ot=st.position;it.position.copy(ot),it.quaternion.copy(st.quaternion),rt=!1}}}rt&&this.scene?this.scene.visible=!1:this.scene&&(this.scene.visible=!0)}dispose(){this.scene&&this.handModel.remove(this.scene)}}const TOUCH_RADIUS=.01,POINTING_JOINT="index-finger-tip";class OculusHandModel extends Object3D{constructor(_e,rt,nt){super(),this._onConnected=it=>{const st=it.data;st.hand&&!this.motionController&&(this.xrInputSource=st,this.motionController=new XRHandMeshModel(this,this.controller,void 0,st.handedness,st.handedness==="left"?this.leftModelPath:this.rightModelPath))},this._onDisconnected=()=>{var it;(it=this.xrInputSource)!=null&&it.hand&&this.motionControllerCleanup()},this.controller=_e,this.motionController=null,this.envMap=null,this.leftModelPath=rt,this.rightModelPath=nt,this.mesh=null,this.xrInputSource=null,_e.addEventListener("connected",this._onConnected),_e.addEventListener("disconnected",this._onDisconnected)}motionControllerCleanup(){var _e;this.clear(),(_e=this.motionController)==null||_e.dispose(),this.motionController=null}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.motionController&&this.motionController.updateMesh()}getPointerPosition(){const _e=this.controller.joints[POINTING_JOINT];return _e?_e.position:null}intersectBoxObject(_e){const rt=this.getPointerPosition();if(rt){const nt=new Sphere(rt,TOUCH_RADIUS),it=new Box3().setFromObject(_e);return nt.intersectsBox(it)}else return!1}checkButton(_e){this.intersectBoxObject(_e)?_e.onPress():_e.onClear(),_e.isPressed()&&_e.whilePressed()}dispose(){this.motionControllerCleanup(),this.controller.removeEventListener("connected",this._onConnected),this.controller.removeEventListener("disconnected",this._onDisconnected)}}function Hands({modelLeft:tt,modelRight:_e}){const rt=useXR(nt=>nt.controllers);return reactExports.useMemo(()=>extend$2({OculusHandModel}),[]),useIsomorphicLayoutEffect(()=>{for(const nt of rt)nt.hand.dispatchEvent({type:"connected",data:nt.inputSource,fake:!0})},[rt,tt,_e]),reactExports.createElement(reactExports.Fragment,null,rt.map(({hand:nt})=>createPortal(reactExports.createElement("oculusHandModel",{args:[nt,tt,_e]}),nt)))}function Polyhedron({polyhedron_shape:tt,color:_e,wireframe:rt,...nt}){const it=reactExports.useRef(),[st,ot]=reactExports.useState(2);return jsxRuntimeExports.jsx("mesh",{...nt,ref:it,onPointerDown:()=>{ot((st+1)%3),console.log(st)},geometry:tt,children:jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_e,wireframe:rt})})}function Floor(){return jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[40,40]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#666"})]})}function clamp$1(tt,_e,rt){return Math.max(_e,Math.min(tt,rt))}const V$2={toVector(tt,_e){return tt===void 0&&(tt=_e),Array.isArray(tt)?tt:[tt,tt]},add(tt,_e){return[tt[0]+_e[0],tt[1]+_e[1]]},sub(tt,_e){return[tt[0]-_e[0],tt[1]-_e[1]]},addTo(tt,_e){tt[0]+=_e[0],tt[1]+=_e[1]},subTo(tt,_e){tt[0]-=_e[0],tt[1]-=_e[1]}};function rubberband(tt,_e,rt){return _e===0||Math.abs(_e)===1/0?Math.pow(tt,rt*5):tt*_e*rt/(_e+rt*tt)}function rubberbandIfOutOfBounds(tt,_e,rt,nt=.15){return nt===0?clamp$1(tt,_e,rt):tt<_e?-rubberband(_e-tt,rt-_e,nt)+_e:tt>rt?+rubberband(tt-rt,rt-_e,nt)+rt:tt}function computeRubberband(tt,[_e,rt],[nt,it]){const[[st,ot],[lt,at]]=tt;return[rubberbandIfOutOfBounds(_e,st,ot,nt),rubberbandIfOutOfBounds(rt,lt,at,it)]}function _toPrimitive(tt,_e){if(typeof tt!="object"||tt===null)return tt;var rt=tt[Symbol.toPrimitive];if(rt!==void 0){var nt=rt.call(tt,_e||"default");if(typeof nt!="object")return nt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(tt)}function _toPropertyKey(tt){var _e=_toPrimitive(tt,"string");return typeof _e=="symbol"?_e:String(_e)}function _defineProperty$4(tt,_e,rt){return _e=_toPropertyKey(_e),_e in tt?Object.defineProperty(tt,_e,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[_e]=rt,tt}function ownKeys$3(tt,_e){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(tt);_e&&(nt=nt.filter(function(it){return Object.getOwnPropertyDescriptor(tt,it).enumerable})),rt.push.apply(rt,nt)}return rt}function _objectSpread2$1(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$3(Object(rt),!0).forEach(function(nt){_defineProperty$4(tt,nt,rt[nt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ownKeys$3(Object(rt)).forEach(function(nt){Object.defineProperty(tt,nt,Object.getOwnPropertyDescriptor(rt,nt))})}return tt}const EVENT_TYPE_MAP={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function capitalize(tt){return tt?tt[0].toUpperCase()+tt.slice(1):""}const actionsWithoutCaptureSupported=["enter","leave"];function hasCapture(tt=!1,_e){return tt&&!actionsWithoutCaptureSupported.includes(_e)}function toHandlerProp(tt,_e="",rt=!1){const nt=EVENT_TYPE_MAP[tt],it=nt&&nt[_e]||_e;return"on"+capitalize(tt)+capitalize(it)+(hasCapture(rt,it)?"Capture":"")}const pointerCaptureEvents=["gotpointercapture","lostpointercapture"];function parseProp(tt){let _e=tt.substring(2).toLowerCase();const rt=!!~_e.indexOf("passive");rt&&(_e=_e.replace("passive",""));const nt=pointerCaptureEvents.includes(_e)?"capturecapture":"capture",it=!!~_e.indexOf(nt);return it&&(_e=_e.replace("capture","")),{device:_e,capture:it,passive:rt}}function toDomEventType(tt,_e=""){const rt=EVENT_TYPE_MAP[tt],nt=rt&&rt[_e]||_e;return tt+nt}function isTouch(tt){return"touches"in tt}function getPointerType(tt){return isTouch(tt)?"touch":"pointerType"in tt?tt.pointerType:"mouse"}function getCurrentTargetTouchList(tt){return Array.from(tt.touches).filter(_e=>{var rt,nt;return _e.target===tt.currentTarget||((rt=tt.currentTarget)===null||rt===void 0||(nt=rt.contains)===null||nt===void 0?void 0:nt.call(rt,_e.target))})}function getTouchList(tt){return tt.type==="touchend"||tt.type==="touchcancel"?tt.changedTouches:tt.targetTouches}function getValueEvent(tt){return isTouch(tt)?getTouchList(tt)[0]:tt}function touchIds(tt){return getCurrentTargetTouchList(tt).map(_e=>_e.identifier)}function pointerId(tt){const _e=getValueEvent(tt);return isTouch(tt)?_e.identifier:_e.pointerId}function pointerValues(tt){const _e=getValueEvent(tt);return[_e.clientX,_e.clientY]}function getEventDetails(tt){const _e={};if("buttons"in tt&&(_e.buttons=tt.buttons),"shiftKey"in tt){const{shiftKey:rt,altKey:nt,metaKey:it,ctrlKey:st}=tt;Object.assign(_e,{shiftKey:rt,altKey:nt,metaKey:it,ctrlKey:st})}return _e}function call$1(tt,..._e){return typeof tt=="function"?tt(..._e):tt}function noop$1(){}function chain(...tt){return tt.length===0?noop$1:tt.length===1?tt[0]:function(){let _e;for(const rt of tt)_e=rt.apply(this,arguments)||_e;return _e}}function assignDefault(tt,_e){return Object.assign({},_e,tt||{})}const BEFORE_LAST_KINEMATICS_DELAY=32;class Engine{constructor(_e,rt,nt){this.ctrl=_e,this.args=rt,this.key=nt,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(_e){this.ctrl.state[this.key]=_e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:_e,shared:rt,ingKey:nt,args:it}=this;rt[nt]=_e._active=_e.active=_e._blocked=_e._force=!1,_e._step=[!1,!1],_e.intentional=!1,_e._movement=[0,0],_e._distance=[0,0],_e._direction=[0,0],_e._delta=[0,0],_e._bounds=[[-1/0,1/0],[-1/0,1/0]],_e.args=it,_e.axis=void 0,_e.memo=void 0,_e.elapsedTime=_e.timeDelta=0,_e.direction=[0,0],_e.distance=[0,0],_e.overflow=[0,0],_e._movementBound=[!1,!1],_e.velocity=[0,0],_e.movement=[0,0],_e.delta=[0,0],_e.timeStamp=0}start(_e){const rt=this.state,nt=this.config;rt._active||(this.reset(),this.computeInitial(),rt._active=!0,rt.target=_e.target,rt.currentTarget=_e.currentTarget,rt.lastOffset=nt.from?call$1(nt.from,rt):rt.offset,rt.offset=rt.lastOffset,rt.startTime=rt.timeStamp=_e.timeStamp)}computeValues(_e){const rt=this.state;rt._values=_e,rt.values=this.config.transform(_e)}computeInitial(){const _e=this.state;_e._initial=_e._values,_e.initial=_e.values}compute(_e){const{state:rt,config:nt,shared:it}=this;rt.args=this.args;let st=0;if(_e&&(rt.event=_e,nt.preventDefault&&_e.cancelable&&rt.event.preventDefault(),rt.type=_e.type,it.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,it.locked=!!document.pointerLockElement,Object.assign(it,getEventDetails(_e)),it.down=it.pressed=it.buttons%2===1||it.touches>0,st=_e.timeStamp-rt.timeStamp,rt.timeStamp=_e.timeStamp,rt.elapsedTime=rt.timeStamp-rt.startTime),rt._active){const Et=rt._delta.map(Math.abs);V$2.addTo(rt._distance,Et)}this.axisIntent&&this.axisIntent(_e);const[ot,lt]=rt._movement,[at,ct]=nt.threshold,{_step:ut,values:ht}=rt;if(nt.hasCustomTransform?(ut[0]===!1&&(ut[0]=Math.abs(ot)>=at&&ht[0]),ut[1]===!1&&(ut[1]=Math.abs(lt)>=ct&&ht[1])):(ut[0]===!1&&(ut[0]=Math.abs(ot)>=at&&Math.sign(ot)*at),ut[1]===!1&&(ut[1]=Math.abs(lt)>=ct&&Math.sign(lt)*ct)),rt.intentional=ut[0]!==!1||ut[1]!==!1,!rt.intentional)return;const dt=[0,0];if(nt.hasCustomTransform){const[Et,bt]=ht;dt[0]=ut[0]!==!1?Et-ut[0]:0,dt[1]=ut[1]!==!1?bt-ut[1]:0}else dt[0]=ut[0]!==!1?ot-ut[0]:0,dt[1]=ut[1]!==!1?lt-ut[1]:0;this.restrictToAxis&&!rt._blocked&&this.restrictToAxis(dt);const ft=rt.offset,pt=rt._active&&!rt._blocked||rt.active;pt&&(rt.first=rt._active&&!rt.active,rt.last=!rt._active&&rt.active,rt.active=it[this.ingKey]=rt._active,_e&&(rt.first&&("bounds"in nt&&(rt._bounds=call$1(nt.bounds,rt)),this.setup&&this.setup()),rt.movement=dt,this.computeOffset()));const[mt,gt]=rt.offset,[[vt,At],[yt,xt]]=rt._bounds;rt.overflow=[mt<vt?-1:mt>At?1:0,gt<yt?-1:gt>xt?1:0],rt._movementBound[0]=rt.overflow[0]?rt._movementBound[0]===!1?rt._movement[0]:rt._movementBound[0]:!1,rt._movementBound[1]=rt.overflow[1]?rt._movementBound[1]===!1?rt._movement[1]:rt._movementBound[1]:!1;const _t=rt._active?nt.rubberband||[0,0]:[0,0];if(rt.offset=computeRubberband(rt._bounds,rt.offset,_t),rt.delta=V$2.sub(rt.offset,ft),this.computeMovement(),pt&&(!rt.last||st>BEFORE_LAST_KINEMATICS_DELAY)){rt.delta=V$2.sub(rt.offset,ft);const Et=rt.delta.map(Math.abs);V$2.addTo(rt.distance,Et),rt.direction=rt.delta.map(Math.sign),rt._direction=rt._delta.map(Math.sign),!rt.first&&st>0&&(rt.velocity=[Et[0]/st,Et[1]/st],rt.timeDelta=st)}}emit(){const _e=this.state,rt=this.shared,nt=this.config;if(_e._active||this.clean(),(_e._blocked||!_e.intentional)&&!_e._force&&!nt.triggerAllEvents)return;const it=this.handler(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({},rt),_e),{},{[this.aliasKey]:_e.values}));it!==void 0&&(_e.memo=it)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function selectAxis([tt,_e],rt){const nt=Math.abs(tt),it=Math.abs(_e);if(nt>it&&nt>rt)return"x";if(it>nt&&it>rt)return"y"}class CoordinatesEngine extends Engine{constructor(..._e){super(..._e),_defineProperty$4(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=V$2.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=V$2.sub(this.state.offset,this.state.lastOffset)}axisIntent(_e){const rt=this.state,nt=this.config;if(!rt.axis&&_e){const it=typeof nt.axisThreshold=="object"?nt.axisThreshold[getPointerType(_e)]:nt.axisThreshold;rt.axis=selectAxis(rt._movement,it)}rt._blocked=(nt.lockDirection||!!nt.axis)&&!rt.axis||!!nt.axis&&nt.axis!==rt.axis}restrictToAxis(_e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":_e[1]=0;break;case"y":_e[0]=0;break}}}const identity$1=tt=>tt,DEFAULT_RUBBERBAND=.15,commonConfigResolver={enabled(tt=!0){return tt},eventOptions(tt,_e,rt){return _objectSpread2$1(_objectSpread2$1({},rt.shared.eventOptions),tt)},preventDefault(tt=!1){return tt},triggerAllEvents(tt=!1){return tt},rubberband(tt=0){switch(tt){case!0:return[DEFAULT_RUBBERBAND,DEFAULT_RUBBERBAND];case!1:return[0,0];default:return V$2.toVector(tt)}},from(tt){if(typeof tt=="function")return tt;if(tt!=null)return V$2.toVector(tt)},transform(tt,_e,rt){const nt=tt||rt.shared.transform;return this.hasCustomTransform=!!nt,nt||identity$1},threshold(tt){return V$2.toVector(tt,0)}},DEFAULT_AXIS_THRESHOLD=0,coordinatesConfigResolver=_objectSpread2$1(_objectSpread2$1({},commonConfigResolver),{},{axis(tt,_e,{axis:rt}){if(this.lockDirection=rt==="lock",!this.lockDirection)return rt},axisThreshold(tt=DEFAULT_AXIS_THRESHOLD){return tt},bounds(tt={}){if(typeof tt=="function")return st=>coordinatesConfigResolver.bounds(tt(st));if("current"in tt)return()=>tt.current;if(typeof HTMLElement=="function"&&tt instanceof HTMLElement)return tt;const{left:_e=-1/0,right:rt=1/0,top:nt=-1/0,bottom:it=1/0}=tt;return[[_e,rt],[nt,it]]}}),KEYS_DELTA_MAP={ArrowRight:(tt,_e=1)=>[tt*_e,0],ArrowLeft:(tt,_e=1)=>[-1*tt*_e,0],ArrowUp:(tt,_e=1)=>[0,-1*tt*_e],ArrowDown:(tt,_e=1)=>[0,tt*_e]};class DragEngine extends CoordinatesEngine{constructor(..._e){super(..._e),_defineProperty$4(this,"ingKey","dragging")}reset(){super.reset();const _e=this.state;_e._pointerId=void 0,_e._pointerActive=!1,_e._keyboardActive=!1,_e._preventScroll=!1,_e._delayed=!1,_e.swipe=[0,0],_e.tap=!1,_e.canceled=!1,_e.cancel=this.cancel.bind(this)}setup(){const _e=this.state;if(_e._bounds instanceof HTMLElement){const rt=_e._bounds.getBoundingClientRect(),nt=_e.currentTarget.getBoundingClientRect(),it={left:rt.left-nt.left+_e.offset[0],right:rt.right-nt.right+_e.offset[0],top:rt.top-nt.top+_e.offset[1],bottom:rt.bottom-nt.bottom+_e.offset[1]};_e._bounds=coordinatesConfigResolver.bounds(it)}}cancel(){const _e=this.state;_e.canceled||(_e.canceled=!0,_e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(_e){const rt=this.config,nt=this.state;if(_e.buttons!=null&&(Array.isArray(rt.pointerButtons)?!rt.pointerButtons.includes(_e.buttons):rt.pointerButtons!==-1&&rt.pointerButtons!==_e.buttons))return;const it=this.ctrl.setEventIds(_e);rt.pointerCapture&&_e.target.setPointerCapture(_e.pointerId),!(it&&it.size>1&&nt._pointerActive)&&(this.start(_e),this.setupPointer(_e),nt._pointerId=pointerId(_e),nt._pointerActive=!0,this.computeValues(pointerValues(_e)),this.computeInitial(),rt.preventScrollAxis&&getPointerType(_e)!=="mouse"?(nt._active=!1,this.setupScrollPrevention(_e)):rt.delay>0?(this.setupDelayTrigger(_e),rt.triggerAllEvents&&(this.compute(_e),this.emit())):this.startPointerDrag(_e))}startPointerDrag(_e){const rt=this.state;rt._active=!0,rt._preventScroll=!0,rt._delayed=!1,this.compute(_e),this.emit()}pointerMove(_e){const rt=this.state,nt=this.config;if(!rt._pointerActive)return;const it=pointerId(_e);if(rt._pointerId!==void 0&&it!==rt._pointerId)return;const st=pointerValues(_e);if(document.pointerLockElement===_e.target?rt._delta=[_e.movementX,_e.movementY]:(rt._delta=V$2.sub(st,rt._values),this.computeValues(st)),V$2.addTo(rt._movement,rt._delta),this.compute(_e),rt._delayed&&rt.intentional){this.timeoutStore.remove("dragDelay"),rt.active=!1,this.startPointerDrag(_e);return}if(nt.preventScrollAxis&&!rt._preventScroll)if(rt.axis)if(rt.axis===nt.preventScrollAxis||nt.preventScrollAxis==="xy"){rt._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(_e);return}else return;this.emit()}pointerUp(_e){this.ctrl.setEventIds(_e);try{this.config.pointerCapture&&_e.target.hasPointerCapture(_e.pointerId)&&_e.target.releasePointerCapture(_e.pointerId)}catch{}const rt=this.state,nt=this.config;if(!rt._active||!rt._pointerActive)return;const it=pointerId(_e);if(rt._pointerId!==void 0&&it!==rt._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(_e);const[st,ot]=rt._distance;if(rt.tap=st<=nt.tapsThreshold&&ot<=nt.tapsThreshold,rt.tap&&nt.filterTaps)rt._force=!0;else{const[lt,at]=rt._delta,[ct,ut]=rt._movement,[ht,dt]=nt.swipe.velocity,[ft,pt]=nt.swipe.distance,mt=nt.swipe.duration;if(rt.elapsedTime<mt){const gt=Math.abs(lt/rt.timeDelta),vt=Math.abs(at/rt.timeDelta);gt>ht&&Math.abs(ct)>ft&&(rt.swipe[0]=Math.sign(lt)),vt>dt&&Math.abs(ut)>pt&&(rt.swipe[1]=Math.sign(at))}}this.emit()}pointerClick(_e){!this.state.tap&&_e.detail>0&&(_e.preventDefault(),_e.stopPropagation())}setupPointer(_e){const rt=this.config,nt=rt.device;rt.pointerLock&&_e.currentTarget.requestPointerLock(),rt.pointerCapture||(this.eventStore.add(this.sharedConfig.window,nt,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,nt,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,nt,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(_e){this.state._preventScroll&&_e.cancelable&&_e.preventDefault()}setupScrollPrevention(_e){this.state._preventScroll=!1,persistEvent(_e);const rt=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",rt),this.eventStore.add(this.sharedConfig.window,"touch","cancel",rt),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,_e)}setupDelayTrigger(_e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(_e)},this.config.delay)}keyDown(_e){const rt=KEYS_DELTA_MAP[_e.key];if(rt){const nt=this.state,it=_e.shiftKey?10:_e.altKey?.1:1;this.start(_e),nt._delta=rt(this.config.keyboardDisplacement,it),nt._keyboardActive=!0,V$2.addTo(nt._movement,nt._delta),this.compute(_e),this.emit()}}keyUp(_e){_e.key in KEYS_DELTA_MAP&&(this.state._keyboardActive=!1,this.setActive(),this.compute(_e),this.emit())}bind(_e){const rt=this.config.device;_e(rt,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(_e(rt,"change",this.pointerMove.bind(this)),_e(rt,"end",this.pointerUp.bind(this)),_e(rt,"cancel",this.pointerUp.bind(this)),_e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(_e("key","down",this.keyDown.bind(this)),_e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&_e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function persistEvent(tt){"persist"in tt&&typeof tt.persist=="function"&&tt.persist()}const isBrowser=typeof window<"u"&&window.document&&window.document.createElement;function supportsTouchEvents(){return isBrowser&&"ontouchstart"in window}function isTouchScreen(){return supportsTouchEvents()||isBrowser&&window.navigator.maxTouchPoints>1}function supportsPointerEvents(){return isBrowser&&"onpointerdown"in window}function supportsPointerLock(){return isBrowser&&"exitPointerLock"in window.document}function supportsGestureEvents(){try{return"constructor"in GestureEvent}catch{return!1}}const SUPPORT={isBrowser,gesture:supportsGestureEvents(),touch:isTouchScreen(),touchscreen:isTouchScreen(),pointer:supportsPointerEvents(),pointerLock:supportsPointerLock()},DEFAULT_PREVENT_SCROLL_DELAY=250,DEFAULT_DRAG_DELAY=180,DEFAULT_SWIPE_VELOCITY=.5,DEFAULT_SWIPE_DISTANCE=50,DEFAULT_SWIPE_DURATION=250,DEFAULT_KEYBOARD_DISPLACEMENT=10,DEFAULT_DRAG_AXIS_THRESHOLD={mouse:0,touch:0,pen:8},dragConfigResolver=_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{device(tt,_e,{pointer:{touch:rt=!1,lock:nt=!1,mouse:it=!1}={}}){return this.pointerLock=nt&&SUPPORT.pointerLock,SUPPORT.touch&&rt?"touch":this.pointerLock?"mouse":SUPPORT.pointer&&!it?"pointer":SUPPORT.touch?"touch":"mouse"},preventScrollAxis(tt,_e,{preventScroll:rt}){if(this.preventScrollDelay=typeof rt=="number"?rt:rt||rt===void 0&&tt?DEFAULT_PREVENT_SCROLL_DELAY:void 0,!(!SUPPORT.touchscreen||rt===!1))return tt||(rt!==void 0?"y":void 0)},pointerCapture(tt,_e,{pointer:{capture:rt=!0,buttons:nt=1,keys:it=!0}={}}){return this.pointerButtons=nt,this.keys=it,!this.pointerLock&&this.device==="pointer"&&rt},threshold(tt,_e,{filterTaps:rt=!1,tapsThreshold:nt=3,axis:it=void 0}){const st=V$2.toVector(tt,rt?nt:it?1:0);return this.filterTaps=rt,this.tapsThreshold=nt,st},swipe({velocity:tt=DEFAULT_SWIPE_VELOCITY,distance:_e=DEFAULT_SWIPE_DISTANCE,duration:rt=DEFAULT_SWIPE_DURATION}={}){return{velocity:this.transform(V$2.toVector(tt)),distance:this.transform(V$2.toVector(_e)),duration:rt}},delay(tt=0){switch(tt){case!0:return DEFAULT_DRAG_DELAY;case!1:return 0;default:return tt}},axisThreshold(tt){return tt?_objectSpread2$1(_objectSpread2$1({},DEFAULT_DRAG_AXIS_THRESHOLD),tt):DEFAULT_DRAG_AXIS_THRESHOLD},keyboardDisplacement(tt=DEFAULT_KEYBOARD_DISPLACEMENT){return tt}});_objectSpread2$1(_objectSpread2$1({},commonConfigResolver),{},{device(tt,_e,{shared:rt,pointer:{touch:nt=!1}={}}){if(rt.target&&!SUPPORT.touch&&SUPPORT.gesture)return"gesture";if(SUPPORT.touch&&nt)return"touch";if(SUPPORT.touchscreen){if(SUPPORT.pointer)return"pointer";if(SUPPORT.touch)return"touch"}},bounds(tt,_e,{scaleBounds:rt={},angleBounds:nt={}}){const it=ot=>{const lt=assignDefault(call$1(rt,ot),{min:-1/0,max:1/0});return[lt.min,lt.max]},st=ot=>{const lt=assignDefault(call$1(nt,ot),{min:-1/0,max:1/0});return[lt.min,lt.max]};return typeof rt!="function"&&typeof nt!="function"?[it(),st()]:ot=>[it(ot),st(ot)]},threshold(tt,_e,rt){return this.lockDirection=rt.axis==="lock",V$2.toVector(tt,this.lockDirection?[.1,3]:0)},modifierKey(tt){return tt===void 0?"ctrlKey":tt},pinchOnWheel(tt=!0){return tt}});_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{mouseOnly:(tt=!0)=>tt});_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{mouseOnly:(tt=!0)=>tt});const EngineMap=new Map,ConfigResolverMap=new Map;function registerAction(tt){EngineMap.set(tt.key,tt.engine),ConfigResolverMap.set(tt.key,tt.resolver)}const dragAction={key:"drag",engine:DragEngine,resolver:dragConfigResolver};function _objectWithoutPropertiesLoose$2(tt,_e){if(tt==null)return{};var rt={},nt=Object.keys(tt),it,st;for(st=0;st<nt.length;st++)it=nt[st],!(_e.indexOf(it)>=0)&&(rt[it]=tt[it]);return rt}function _objectWithoutProperties$2(tt,_e){if(tt==null)return{};var rt=_objectWithoutPropertiesLoose$2(tt,_e),nt,it;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(tt);for(it=0;it<st.length;it++)nt=st[it],!(_e.indexOf(nt)>=0)&&Object.prototype.propertyIsEnumerable.call(tt,nt)&&(rt[nt]=tt[nt])}return rt}const sharedConfigResolver={target(tt){if(tt)return()=>"current"in tt?tt.current:tt},enabled(tt=!0){return tt},window(tt=SUPPORT.isBrowser?window:void 0){return tt},eventOptions({passive:tt=!0,capture:_e=!1}={}){return{passive:tt,capture:_e}},transform(tt){return tt}},_excluded$c=["target","eventOptions","window","enabled","transform"];function resolveWith(tt={},_e){const rt={};for(const[nt,it]of Object.entries(_e))switch(typeof it){case"function":rt[nt]=it.call(rt,tt[nt],nt,tt);break;case"object":rt[nt]=resolveWith(tt[nt],it);break;case"boolean":it&&(rt[nt]=tt[nt]);break}return rt}function parse$1(tt,_e,rt={}){const nt=tt,{target:it,eventOptions:st,window:ot,enabled:lt,transform:at}=nt,ct=_objectWithoutProperties$2(nt,_excluded$c);if(rt.shared=resolveWith({target:it,eventOptions:st,window:ot,enabled:lt,transform:at},sharedConfigResolver),_e){const ut=ConfigResolverMap.get(_e);rt[_e]=resolveWith(_objectSpread2$1({shared:rt.shared},ct),ut)}else for(const ut in ct){const ht=ConfigResolverMap.get(ut);ht&&(rt[ut]=resolveWith(_objectSpread2$1({shared:rt.shared},ct[ut]),ht))}return rt}class EventStore{constructor(_e,rt){_defineProperty$4(this,"_listeners",new Set),this._ctrl=_e,this._gestureKey=rt}add(_e,rt,nt,it,st){const ot=this._listeners,lt=toDomEventType(rt,nt),at=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},ct=_objectSpread2$1(_objectSpread2$1({},at),st);_e.addEventListener(lt,it,ct);const ut=()=>{_e.removeEventListener(lt,it,ct),ot.delete(ut)};return ot.add(ut),ut}clean(){this._listeners.forEach(_e=>_e()),this._listeners.clear()}}class TimeoutStore{constructor(){_defineProperty$4(this,"_timeouts",new Map)}add(_e,rt,nt=140,...it){this.remove(_e),this._timeouts.set(_e,window.setTimeout(rt,nt,...it))}remove(_e){const rt=this._timeouts.get(_e);rt&&window.clearTimeout(rt)}clean(){this._timeouts.forEach(_e=>void window.clearTimeout(_e)),this._timeouts.clear()}}class Controller{constructor(_e){_defineProperty$4(this,"gestures",new Set),_defineProperty$4(this,"_targetEventStore",new EventStore(this)),_defineProperty$4(this,"gestureEventStores",{}),_defineProperty$4(this,"gestureTimeoutStores",{}),_defineProperty$4(this,"handlers",{}),_defineProperty$4(this,"config",{}),_defineProperty$4(this,"pointerIds",new Set),_defineProperty$4(this,"touchIds",new Set),_defineProperty$4(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),resolveGestures(this,_e)}setEventIds(_e){if(isTouch(_e))return this.touchIds=new Set(touchIds(_e)),this.touchIds;if("pointerId"in _e)return _e.type==="pointerup"||_e.type==="pointercancel"?this.pointerIds.delete(_e.pointerId):_e.type==="pointerdown"&&this.pointerIds.add(_e.pointerId),this.pointerIds}applyHandlers(_e,rt){this.handlers=_e,this.nativeHandlers=rt}applyConfig(_e,rt){this.config=parse$1(_e,rt,this.config)}clean(){this._targetEventStore.clean();for(const _e of this.gestures)this.gestureEventStores[_e].clean(),this.gestureTimeoutStores[_e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(..._e){const rt=this.config.shared,nt={};let it;if(!(rt.target&&(it=rt.target(),!it))){if(rt.enabled){for(const ot of this.gestures){const lt=this.config[ot],at=bindToProps(nt,lt.eventOptions,!!it);if(lt.enabled){const ct=EngineMap.get(ot);new ct(this,_e,ot).bind(at)}}const st=bindToProps(nt,rt.eventOptions,!!it);for(const ot in this.nativeHandlers)st(ot,"",lt=>this.nativeHandlers[ot](_objectSpread2$1(_objectSpread2$1({},this.state.shared),{},{event:lt,args:_e})),void 0,!0)}for(const st in nt)nt[st]=chain(...nt[st]);if(!it)return nt;for(const st in nt){const{device:ot,capture:lt,passive:at}=parseProp(st);this._targetEventStore.add(it,ot,"",nt[st],{capture:lt,passive:at})}}}}function setupGesture(tt,_e){tt.gestures.add(_e),tt.gestureEventStores[_e]=new EventStore(tt,_e),tt.gestureTimeoutStores[_e]=new TimeoutStore}function resolveGestures(tt,_e){_e.drag&&setupGesture(tt,"drag"),_e.wheel&&setupGesture(tt,"wheel"),_e.scroll&&setupGesture(tt,"scroll"),_e.move&&setupGesture(tt,"move"),_e.pinch&&setupGesture(tt,"pinch"),_e.hover&&setupGesture(tt,"hover")}const bindToProps=(tt,_e,rt)=>(nt,it,st,ot={},lt=!1)=>{var at,ct;const ut=(at=ot.capture)!==null&&at!==void 0?at:_e.capture,ht=(ct=ot.passive)!==null&&ct!==void 0?ct:_e.passive;let dt=lt?nt:toHandlerProp(nt,it,ut);rt&&ht&&(dt+="Passive"),tt[dt]=tt[dt]||[],tt[dt].push(st)};function useRecognizers(tt,_e={},rt,nt){const it=React.useMemo(()=>new Controller(tt),[]);if(it.applyHandlers(tt,nt),it.applyConfig(_e,rt),React.useEffect(it.effect.bind(it)),React.useEffect(()=>it.clean.bind(it),[]),_e.target===void 0)return it.bind.bind(it)}function useDrag$1(tt,_e){return registerAction(dragAction),useRecognizers({drag:tt},_e||{},"drag")}const subscribeWithSelector=tt=>(_e,rt,nt)=>{const it=nt.subscribe;return nt.subscribe=(ot,lt,at)=>{let ct=ot;if(lt){const ut=(at==null?void 0:at.equalityFn)||Object.is;let ht=ot(nt.getState());ct=dt=>{const ft=ot(dt);if(!ut(ht,ft)){const pt=ht;lt(ht=ft,pt)}},at!=null&&at.fireImmediately&&lt(ht,ht)}return it(ct)},tt(_e,rt,nt)};function shallow(tt,_e){if(Object.is(tt,_e))return!0;if(typeof tt!="object"||tt===null||typeof _e!="object"||_e===null)return!1;const rt=Object.keys(tt);if(rt.length!==Object.keys(_e).length)return!1;for(let nt=0;nt<rt.length;nt++)if(!Object.prototype.hasOwnProperty.call(_e,rt[nt])||!Object.is(tt[rt[nt]],_e[rt[nt]]))return!1;return!0}function workerBootstrap(){var tt=Object.create(null);function _e(it,st){var ot=it.id,lt=it.name,at=it.dependencies;at===void 0&&(at=[]);var ct=it.init;ct===void 0&&(ct=function(){});var ut=it.getTransferables;if(ut===void 0&&(ut=null),!tt[ot])try{at=at.map(function(dt){return dt&&dt.isWorkerModule&&(_e(dt,function(ft){if(ft instanceof Error)throw ft}),dt=tt[dt.id].value),dt}),ct=nt("<"+lt+">.init",ct),ut&&(ut=nt("<"+lt+">.getTransferables",ut));var ht=null;typeof ct=="function"?ht=ct.apply(void 0,at):console.error("worker module init function failed to rehydrate"),tt[ot]={id:ot,value:ht,getTransferables:ut},st(ht)}catch(dt){dt&&dt.noLog||console.error(dt),st(dt)}}function rt(it,st){var ot,lt=it.id,at=it.args;(!tt[lt]||typeof tt[lt].value!="function")&&st(new Error("Worker module "+lt+": not found or its 'init' did not return a function"));try{var ct=(ot=tt[lt]).value.apply(ot,at);ct&&typeof ct.then=="function"?ct.then(ut,function(ht){return st(ht instanceof Error?ht:new Error(""+ht))}):ut(ct)}catch(ht){st(ht)}function ut(ht){try{var dt=tt[lt].getTransferables&&tt[lt].getTransferables(ht);(!dt||!Array.isArray(dt)||!dt.length)&&(dt=void 0),st(ht,dt)}catch(ft){console.error(ft),st(ft)}}}function nt(it,st){var ot=void 0;self.troikaDefine=function(at){return ot=at};var lt=URL.createObjectURL(new Blob(["/** "+it.replace(/\*/g,"")+` **/

troikaDefine(
`+st+`
)`],{type:"application/javascript"}));try{importScripts(lt)}catch(at){console.error(at)}return URL.revokeObjectURL(lt),delete self.troikaDefine,ot}self.addEventListener("message",function(it){var st=it.data,ot=st.messageId,lt=st.action,at=st.data;try{lt==="registerModule"&&_e(at,function(ct){ct instanceof Error?postMessage({messageId:ot,success:!1,error:ct.message}):postMessage({messageId:ot,success:!0,result:{isCallable:typeof ct=="function"}})}),lt==="callModule"&&rt(at,function(ct,ut){ct instanceof Error?postMessage({messageId:ot,success:!1,error:ct.message}):postMessage({messageId:ot,success:!0,result:ct},ut||void 0)})}catch(ct){postMessage({messageId:ot,success:!1,error:ct.stack})}})}function defineMainThreadModule(tt){var _e=function(){for(var rt=[],nt=arguments.length;nt--;)rt[nt]=arguments[nt];return _e._getInitResult().then(function(it){if(typeof it=="function")return it.apply(void 0,rt);throw new Error("Worker module function was called but `init` did not return a callable function")})};return _e._getInitResult=function(){var rt=tt.dependencies,nt=tt.init;rt=Array.isArray(rt)?rt.map(function(st){return st&&st._getInitResult?st._getInitResult():st}):[];var it=Promise.all(rt).then(function(st){return nt.apply(null,st)});return _e._getInitResult=function(){return it},it},_e}var supportsWorkers=function(){var tt=!1;if(typeof window<"u"&&typeof window.document<"u")try{var _e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));_e.terminate(),tt=!0}catch(rt){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+rt.message+"]")}return supportsWorkers=function(){return tt},tt},_workerModuleId=0,_messageId=0,_allowInitAsString=!1,workers=Object.create(null),registeredModules=Object.create(null),openRequests=Object.create(null);function defineWorkerModule(tt){if((!tt||typeof tt.init!="function")&&!_allowInitAsString)throw new Error("requires `options.init` function");var _e=tt.dependencies,rt=tt.init,nt=tt.getTransferables,it=tt.workerId;if(!supportsWorkers())return defineMainThreadModule(tt);it==null&&(it="#default");var st="workerModule"+ ++_workerModuleId,ot=tt.name||st,lt=null;_e=_e&&_e.map(function(ct){return typeof ct=="function"&&!ct.workerModuleData&&(_allowInitAsString=!0,ct=defineWorkerModule({workerId:it,name:"<"+ot+"> function dependency: "+ct.name,init:`function(){return (
`+stringifyFunction(ct)+`
)}`}),_allowInitAsString=!1),ct&&ct.workerModuleData&&(ct=ct.workerModuleData),ct});function at(){for(var ct=[],ut=arguments.length;ut--;)ct[ut]=arguments[ut];if(!lt){lt=callWorker(it,"registerModule",at.workerModuleData);var ht=function(){lt=null,registeredModules[it].delete(ht)};(registeredModules[it]||(registeredModules[it]=new Set)).add(ht)}return lt.then(function(dt){var ft=dt.isCallable;if(ft)return callWorker(it,"callModule",{id:st,args:ct});throw new Error("Worker module function was called but `init` did not return a callable function")})}return at.workerModuleData={isWorkerModule:!0,id:st,name:ot,dependencies:_e,init:stringifyFunction(rt),getTransferables:nt&&stringifyFunction(nt)},at}function terminateWorker(tt){registeredModules[tt]&&registeredModules[tt].forEach(function(_e){_e()}),workers[tt]&&(workers[tt].terminate(),delete workers[tt])}function stringifyFunction(tt){var _e=tt.toString();return!/^function/.test(_e)&&/^\w+\s*\(/.test(_e)&&(_e="function "+_e),_e}function getWorker(tt){var _e=workers[tt];if(!_e){var rt=stringifyFunction(workerBootstrap);_e=workers[tt]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+tt.replace(/\*/g,"")+` **/

;(`+rt+")()"],{type:"application/javascript"}))),_e.onmessage=function(nt){var it=nt.data,st=it.messageId,ot=openRequests[st];if(!ot)throw new Error("WorkerModule response with empty or unknown messageId");delete openRequests[st],ot(it)}}return _e}function callWorker(tt,_e,rt){return new Promise(function(nt,it){var st=++_messageId;openRequests[st]=function(ot){ot.success?nt(ot.result):it(new Error("Error in worker "+_e+" call: "+ot.error))},getWorker(tt).postMessage({messageId:st,action:_e,data:rt})})}function SDFGenerator(){var tt=function(_e){function rt(Gt,zt,$t,Ht,er,Zt,or,Kt){var rr=1-or;Kt.x=rr*rr*Gt+2*rr*or*$t+or*or*er,Kt.y=rr*rr*zt+2*rr*or*Ht+or*or*Zt}function nt(Gt,zt,$t,Ht,er,Zt,or,Kt,rr,ur){var fr=1-rr;ur.x=fr*fr*fr*Gt+3*fr*fr*rr*$t+3*fr*rr*rr*er+rr*rr*rr*or,ur.y=fr*fr*fr*zt+3*fr*fr*rr*Ht+3*fr*rr*rr*Zt+rr*rr*rr*Kt}function it(Gt,zt){for(var $t=/([MLQCZ])([^MLQCZ]*)/g,Ht,er,Zt,or,Kt;Ht=$t.exec(Gt);){var rr=Ht[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(ur){return parseFloat(ur)});switch(Ht[1]){case"M":or=er=rr[0],Kt=Zt=rr[1];break;case"L":(rr[0]!==or||rr[1]!==Kt)&&zt("L",or,Kt,or=rr[0],Kt=rr[1]);break;case"Q":{zt("Q",or,Kt,or=rr[2],Kt=rr[3],rr[0],rr[1]);break}case"C":{zt("C",or,Kt,or=rr[4],Kt=rr[5],rr[0],rr[1],rr[2],rr[3]);break}case"Z":(or!==er||Kt!==Zt)&&zt("L",or,Kt,er,Zt);break}}}function st(Gt,zt,$t){$t===void 0&&($t=16);var Ht={x:0,y:0};it(Gt,function(er,Zt,or,Kt,rr,ur,fr,dr,gr){switch(er){case"L":zt(Zt,or,Kt,rr);break;case"Q":{for(var Yt=Zt,xr=or,vr=1;vr<$t;vr++)rt(Zt,or,ur,fr,Kt,rr,vr/($t-1),Ht),zt(Yt,xr,Ht.x,Ht.y),Yt=Ht.x,xr=Ht.y;break}case"C":{for(var Pr=Zt,Sr=or,Qr=1;Qr<$t;Qr++)nt(Zt,or,ur,fr,dr,gr,Kt,rr,Qr/($t-1),Ht),zt(Pr,Sr,Ht.x,Ht.y),Pr=Ht.x,Sr=Ht.y;break}}})}var ot="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",lt="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",at=new WeakMap,ct={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function ut(Gt,zt){var $t=Gt.getContext?Gt.getContext("webgl",ct):Gt,Ht=at.get($t);if(!Ht){let Pr=function(Lr){var Wr=Zt[Lr];if(!Wr&&(Wr=Zt[Lr]=$t.getExtension(Lr),!Wr))throw new Error(Lr+" not supported");return Wr},Sr=function(Lr,Wr){var Xt=$t.createShader(Wr);return $t.shaderSource(Xt,Lr),$t.compileShader(Xt),Xt},Qr=function(Lr,Wr,Xt,Qt){if(!or[Lr]){var hr={},kr={},yr=$t.createProgram();$t.attachShader(yr,Sr(Wr,$t.VERTEX_SHADER)),$t.attachShader(yr,Sr(Xt,$t.FRAGMENT_SHADER)),$t.linkProgram(yr),or[Lr]={program:yr,transaction:function(Hr){$t.useProgram(yr),Hr({setUniform:function(Ar,qt){for(var pr=[],mr=arguments.length-2;mr-- >0;)pr[mr]=arguments[mr+2];var nr=kr[qt]||(kr[qt]=$t.getUniformLocation(yr,qt));$t["uniform"+Ar].apply($t,[nr].concat(pr))},setAttribute:function(Ar,qt,pr,mr,nr){var Cr=hr[Ar];Cr||(Cr=hr[Ar]={buf:$t.createBuffer(),loc:$t.getAttribLocation(yr,Ar),data:null}),$t.bindBuffer($t.ARRAY_BUFFER,Cr.buf),$t.vertexAttribPointer(Cr.loc,qt,$t.FLOAT,!1,0,0),$t.enableVertexAttribArray(Cr.loc),er?$t.vertexAttribDivisor(Cr.loc,mr):Pr("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Cr.loc,mr),nr!==Cr.data&&($t.bufferData($t.ARRAY_BUFFER,nr,pr),Cr.data=nr)}})}}}or[Lr].transaction(Qt)},Ir=function(Lr,Wr){rr++;try{$t.activeTexture($t.TEXTURE0+rr);var Xt=Kt[Lr];Xt||(Xt=Kt[Lr]=$t.createTexture(),$t.bindTexture($t.TEXTURE_2D,Xt),$t.texParameteri($t.TEXTURE_2D,$t.TEXTURE_MIN_FILTER,$t.NEAREST),$t.texParameteri($t.TEXTURE_2D,$t.TEXTURE_MAG_FILTER,$t.NEAREST)),$t.bindTexture($t.TEXTURE_2D,Xt),Wr(Xt,rr)}finally{rr--}},Dr=function(Lr,Wr,Xt){var Qt=$t.createFramebuffer();ur.push(Qt),$t.bindFramebuffer($t.FRAMEBUFFER,Qt),$t.activeTexture($t.TEXTURE0+Wr),$t.bindTexture($t.TEXTURE_2D,Lr),$t.framebufferTexture2D($t.FRAMEBUFFER,$t.COLOR_ATTACHMENT0,$t.TEXTURE_2D,Lr,0);try{Xt(Qt)}finally{$t.deleteFramebuffer(Qt),$t.bindFramebuffer($t.FRAMEBUFFER,ur[--ur.length-1]||null)}},Ur=function(){Zt={},or={},Kt={},rr=-1,ur.length=0};var fr=Pr,dr=Sr,gr=Qr,Yt=Ir,xr=Dr,vr=Ur,er=typeof WebGL2RenderingContext<"u"&&$t instanceof WebGL2RenderingContext,Zt={},or={},Kt={},rr=-1,ur=[];$t.canvas.addEventListener("webglcontextlost",function(Lr){Ur(),Lr.preventDefault()},!1),at.set($t,Ht={gl:$t,isWebGL2:er,getExtension:Pr,withProgram:Qr,withTexture:Ir,withTextureFramebuffer:Dr,handleContextLoss:Ur})}zt(Ht)}function ht(Gt,zt,$t,Ht,er,Zt,or,Kt){or===void 0&&(or=15),Kt===void 0&&(Kt=null),ut(Gt,function(rr){var ur=rr.gl,fr=rr.withProgram,dr=rr.withTexture;dr("copy",function(gr,Yt){ur.texImage2D(ur.TEXTURE_2D,0,ur.RGBA,er,Zt,0,ur.RGBA,ur.UNSIGNED_BYTE,zt),fr("copy",ot,lt,function(xr){var vr=xr.setUniform,Pr=xr.setAttribute;Pr("aUV",2,ur.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),vr("1i","image",Yt),ur.bindFramebuffer(ur.FRAMEBUFFER,Kt||null),ur.disable(ur.BLEND),ur.colorMask(or&8,or&4,or&2,or&1),ur.viewport($t,Ht,er,Zt),ur.scissor($t,Ht,er,Zt),ur.drawArrays(ur.TRIANGLES,0,3)})})})}function dt(Gt,zt,$t){var Ht=Gt.width,er=Gt.height;ut(Gt,function(Zt){var or=Zt.gl,Kt=new Uint8Array(Ht*er*4);or.readPixels(0,0,Ht,er,or.RGBA,or.UNSIGNED_BYTE,Kt),Gt.width=zt,Gt.height=$t,ht(or,Kt,0,0,Ht,er)})}var ft=Object.freeze({__proto__:null,withWebGLContext:ut,renderImageData:ht,resizeWebGLCanvasWithoutClearing:dt});function pt(Gt,zt,$t,Ht,er,Zt){Zt===void 0&&(Zt=1);var or=new Uint8Array(Gt*zt),Kt=Ht[2]-Ht[0],rr=Ht[3]-Ht[1],ur=[];st($t,function(Pr,Sr,Qr,Ir){ur.push({x1:Pr,y1:Sr,x2:Qr,y2:Ir,minX:Math.min(Pr,Qr),minY:Math.min(Sr,Ir),maxX:Math.max(Pr,Qr),maxY:Math.max(Sr,Ir)})}),ur.sort(function(Pr,Sr){return Pr.maxX-Sr.maxX});for(var fr=0;fr<Gt;fr++)for(var dr=0;dr<zt;dr++){var gr=xr(Ht[0]+Kt*(fr+.5)/Gt,Ht[1]+rr*(dr+.5)/zt),Yt=Math.pow(1-Math.abs(gr)/er,Zt)/2;gr<0&&(Yt=1-Yt),Yt=Math.max(0,Math.min(255,Math.round(Yt*255))),or[dr*Gt+fr]=Yt}return or;function xr(Pr,Sr){for(var Qr=1/0,Ir=1/0,Dr=ur.length;Dr--;){var Ur=ur[Dr];if(Ur.maxX+Ir<=Pr)break;if(Pr+Ir>Ur.minX&&Sr-Ir<Ur.maxY&&Sr+Ir>Ur.minY){var Lr=vt(Pr,Sr,Ur.x1,Ur.y1,Ur.x2,Ur.y2);Lr<Qr&&(Qr=Lr,Ir=Math.sqrt(Qr))}}return vr(Pr,Sr)&&(Ir=-Ir),Ir}function vr(Pr,Sr){for(var Qr=0,Ir=ur.length;Ir--;){var Dr=ur[Ir];if(Dr.maxX<=Pr)break;var Ur=Dr.y1>Sr!=Dr.y2>Sr&&Pr<(Dr.x2-Dr.x1)*(Sr-Dr.y1)/(Dr.y2-Dr.y1)+Dr.x1;Ur&&(Qr+=Dr.y1<Dr.y2?1:-1)}return Qr!==0}}function mt(Gt,zt,$t,Ht,er,Zt,or,Kt,rr,ur){Zt===void 0&&(Zt=1),Kt===void 0&&(Kt=0),rr===void 0&&(rr=0),ur===void 0&&(ur=0),gt(Gt,zt,$t,Ht,er,Zt,or,null,Kt,rr,ur)}function gt(Gt,zt,$t,Ht,er,Zt,or,Kt,rr,ur,fr){Zt===void 0&&(Zt=1),rr===void 0&&(rr=0),ur===void 0&&(ur=0),fr===void 0&&(fr=0);for(var dr=pt(Gt,zt,$t,Ht,er,Zt),gr=new Uint8Array(dr.length*4),Yt=0;Yt<dr.length;Yt++)gr[Yt*4+fr]=dr[Yt];ht(or,gr,rr,ur,Gt,zt,1<<3-fr,Kt)}function vt(Gt,zt,$t,Ht,er,Zt){var or=er-$t,Kt=Zt-Ht,rr=or*or+Kt*Kt,ur=rr?Math.max(0,Math.min(1,((Gt-$t)*or+(zt-Ht)*Kt)/rr)):0,fr=Gt-($t+ur*or),dr=zt-(Ht+ur*Kt);return fr*fr+dr*dr}var At=Object.freeze({__proto__:null,generate:pt,generateIntoCanvas:mt,generateIntoFramebuffer:gt}),yt="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",xt="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",_t="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",Et=new Float32Array([0,0,2,0,0,2]),bt=null,wt=!1,Tt={},Mt=new WeakMap;function Pt(Gt){if(!wt&&!Ut(Gt))throw new Error("WebGL generation not supported")}function It(Gt,zt,$t,Ht,er,Zt,or){if(Zt===void 0&&(Zt=1),or===void 0&&(or=null),!or&&(or=bt,!or)){var Kt=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Kt)throw new Error("OffscreenCanvas or DOM canvas not supported");or=bt=Kt.getContext("webgl",{depth:!1})}Pt(or);var rr=new Uint8Array(Gt*zt*4);ut(or,function(gr){var Yt=gr.gl,xr=gr.withTexture,vr=gr.withTextureFramebuffer;xr("readable",function(Pr,Sr){Yt.texImage2D(Yt.TEXTURE_2D,0,Yt.RGBA,Gt,zt,0,Yt.RGBA,Yt.UNSIGNED_BYTE,null),vr(Pr,Sr,function(Qr){Bt(Gt,zt,$t,Ht,er,Zt,Yt,Qr,0,0,0),Yt.readPixels(0,0,Gt,zt,Yt.RGBA,Yt.UNSIGNED_BYTE,rr)})})});for(var ur=new Uint8Array(Gt*zt),fr=0,dr=0;fr<rr.length;fr+=4)ur[dr++]=rr[fr];return ur}function Ot(Gt,zt,$t,Ht,er,Zt,or,Kt,rr,ur){Zt===void 0&&(Zt=1),Kt===void 0&&(Kt=0),rr===void 0&&(rr=0),ur===void 0&&(ur=0),Bt(Gt,zt,$t,Ht,er,Zt,or,null,Kt,rr,ur)}function Bt(Gt,zt,$t,Ht,er,Zt,or,Kt,rr,ur,fr){Zt===void 0&&(Zt=1),rr===void 0&&(rr=0),ur===void 0&&(ur=0),fr===void 0&&(fr=0),Pt(or);var dr=[];st($t,function(gr,Yt,xr,vr){dr.push(gr,Yt,xr,vr)}),dr=new Float32Array(dr),ut(or,function(gr){var Yt=gr.gl,xr=gr.isWebGL2,vr=gr.getExtension,Pr=gr.withProgram,Sr=gr.withTexture,Qr=gr.withTextureFramebuffer,Ir=gr.handleContextLoss;if(Sr("rawDistances",function(Dr,Ur){(Gt!==Dr._lastWidth||zt!==Dr._lastHeight)&&Yt.texImage2D(Yt.TEXTURE_2D,0,Yt.RGBA,Dr._lastWidth=Gt,Dr._lastHeight=zt,0,Yt.RGBA,Yt.UNSIGNED_BYTE,null),Pr("main",yt,xt,function(Lr){var Wr=Lr.setAttribute,Xt=Lr.setUniform,Qt=!xr&&vr("ANGLE_instanced_arrays"),hr=!xr&&vr("EXT_blend_minmax");Wr("aUV",2,Yt.STATIC_DRAW,0,Et),Wr("aLineSegment",4,Yt.DYNAMIC_DRAW,1,dr),Xt.apply(void 0,["4f","uGlyphBounds"].concat(Ht)),Xt("1f","uMaxDistance",er),Xt("1f","uExponent",Zt),Qr(Dr,Ur,function(kr){Yt.enable(Yt.BLEND),Yt.colorMask(!0,!0,!0,!0),Yt.viewport(0,0,Gt,zt),Yt.scissor(0,0,Gt,zt),Yt.blendFunc(Yt.ONE,Yt.ONE),Yt.blendEquationSeparate(Yt.FUNC_ADD,xr?Yt.MAX:hr.MAX_EXT),Yt.clear(Yt.COLOR_BUFFER_BIT),xr?Yt.drawArraysInstanced(Yt.TRIANGLES,0,3,dr.length/4):Qt.drawArraysInstancedANGLE(Yt.TRIANGLES,0,3,dr.length/4)})}),Pr("post",ot,_t,function(Lr){Lr.setAttribute("aUV",2,Yt.STATIC_DRAW,0,Et),Lr.setUniform("1i","tex",Ur),Yt.bindFramebuffer(Yt.FRAMEBUFFER,Kt),Yt.disable(Yt.BLEND),Yt.colorMask(fr===0,fr===1,fr===2,fr===3),Yt.viewport(rr,ur,Gt,zt),Yt.scissor(rr,ur,Gt,zt),Yt.drawArrays(Yt.TRIANGLES,0,3)})}),Yt.isContextLost())throw Ir(),new Error("webgl context lost")})}function Ut(Gt){var zt=!Gt||Gt===bt?Tt:Gt.canvas||Gt,$t=Mt.get(zt);if($t===void 0){wt=!0;var Ht=null;try{var er=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],Zt=It(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,Gt);$t=Zt&&er.length===Zt.length&&Zt.every(function(or,Kt){return or===er[Kt]}),$t||(Ht="bad trial run results",console.info(er,Zt))}catch(or){$t=!1,Ht=or.message}Ht&&console.warn("WebGL SDF generation not supported:",Ht),wt=!1,Mt.set(zt,$t)}return $t}var Ft=Object.freeze({__proto__:null,generate:It,generateIntoCanvas:Ot,generateIntoFramebuffer:Bt,isSupported:Ut});function jt(Gt,zt,$t,Ht,er,Zt){er===void 0&&(er=Math.max(Ht[2]-Ht[0],Ht[3]-Ht[1])/2),Zt===void 0&&(Zt=1);try{return It.apply(Ft,arguments)}catch(or){return console.info("WebGL SDF generation failed, falling back to JS",or),pt.apply(At,arguments)}}function Dt(Gt,zt,$t,Ht,er,Zt,or,Kt,rr,ur){er===void 0&&(er=Math.max(Ht[2]-Ht[0],Ht[3]-Ht[1])/2),Zt===void 0&&(Zt=1),Kt===void 0&&(Kt=0),rr===void 0&&(rr=0),ur===void 0&&(ur=0);try{return Ot.apply(Ft,arguments)}catch(fr){return console.info("WebGL SDF generation failed, falling back to JS",fr),mt.apply(At,arguments)}}return _e.forEachPathCommand=it,_e.generate=jt,_e.generateIntoCanvas=Dt,_e.javascript=At,_e.pathToLineSegments=st,_e.webgl=Ft,_e.webglUtils=ft,Object.defineProperty(_e,"__esModule",{value:!0}),_e}({});return tt}function bidiFactory(){var tt=function(_e){var rt={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},nt={},it={};nt.L=1,it[1]="L",Object.keys(rt).forEach(function(Ir,Dr){nt[Ir]=1<<Dr+1,it[nt[Ir]]=Ir}),Object.freeze(nt);var st=nt.LRI|nt.RLI|nt.FSI,ot=nt.L|nt.R|nt.AL,lt=nt.B|nt.S|nt.WS|nt.ON|nt.FSI|nt.LRI|nt.RLI|nt.PDI,at=nt.BN|nt.RLE|nt.LRE|nt.RLO|nt.LRO|nt.PDF,ct=nt.S|nt.WS|nt.B|st|nt.PDI|at,ut=null;function ht(){if(!ut){ut=new Map;var Ir=function(Ur){if(rt.hasOwnProperty(Ur)){var Lr=0;rt[Ur].split(",").forEach(function(Wr){var Xt=Wr.split("+"),Qt=Xt[0],hr=Xt[1];Qt=parseInt(Qt,36),hr=hr?parseInt(hr,36):0,ut.set(Lr+=Qt,nt[Ur]);for(var kr=0;kr<hr;kr++)ut.set(++Lr,nt[Ur])})}};for(var Dr in rt)Ir(Dr)}}function dt(Ir){return ht(),ut.get(Ir.codePointAt(0))||nt.L}function ft(Ir){return it[dt(Ir)]}var pt={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function mt(Ir,Dr){var Ur=36,Lr=0,Wr=new Map,Xt=Dr&&new Map,Qt;return Ir.split(",").forEach(function hr(kr){if(kr.indexOf("+")!==-1)for(var yr=+kr;yr--;)hr(Qt);else{Qt=kr;var _r=kr.split(">"),Hr=_r[0],Er=_r[1];Hr=String.fromCodePoint(Lr+=parseInt(Hr,Ur)),Er=String.fromCodePoint(Lr+=parseInt(Er,Ur)),Wr.set(Hr,Er),Dr&&Xt.set(Er,Hr)}}),{map:Wr,reverseMap:Xt}}var gt,vt,At;function yt(){if(!gt){var Ir=mt(pt.pairs,!0),Dr=Ir.map,Ur=Ir.reverseMap;gt=Dr,vt=Ur,At=mt(pt.canonical,!1).map}}function xt(Ir){return yt(),gt.get(Ir)||null}function _t(Ir){return yt(),vt.get(Ir)||null}function Et(Ir){return yt(),At.get(Ir)||null}var bt=nt.L,wt=nt.R,Tt=nt.EN,Mt=nt.ES,Pt=nt.ET,It=nt.AN,Ot=nt.CS,Bt=nt.B,Ut=nt.S,Ft=nt.ON,jt=nt.BN,Dt=nt.NSM,Gt=nt.AL,zt=nt.LRO,$t=nt.RLO,Ht=nt.LRE,er=nt.RLE,Zt=nt.PDF,or=nt.LRI,Kt=nt.RLI,rr=nt.FSI,ur=nt.PDI;function fr(Ir,Dr){for(var Ur=125,Lr=new Uint32Array(Ir.length),Wr=0;Wr<Ir.length;Wr++)Lr[Wr]=dt(Ir[Wr]);var Xt=new Map;function Qt(os,vs){var Zn=Lr[os];Lr[os]=vs,Xt.set(Zn,Xt.get(Zn)-1),Zn&lt&&Xt.set(lt,Xt.get(lt)-1),Xt.set(vs,(Xt.get(vs)||0)+1),vs&lt&&Xt.set(lt,(Xt.get(lt)||0)+1)}for(var hr=new Uint8Array(Ir.length),kr=new Map,yr=[],_r=null,Hr=0;Hr<Ir.length;Hr++)_r||yr.push(_r={start:Hr,end:Ir.length-1,level:Dr==="rtl"?1:Dr==="ltr"?0:No(Hr,!1)}),Lr[Hr]&Bt&&(_r.end=Hr,_r=null);for(var Er=er|Ht|$t|zt|st|ur|Zt|Bt,Ar=function(os){return os+(os&1?1:2)},qt=function(os){return os+(os&1?2:1)},pr=0;pr<yr.length;pr++){_r=yr[pr];var mr=[{_level:_r.level,_override:0,_isolate:0}],nr=void 0,Cr=0,cr=0,Jr=0;Xt.clear();for(var lr=_r.start;lr<=_r.end;lr++){var Rr=Lr[lr];if(nr=mr[mr.length-1],Xt.set(Rr,(Xt.get(Rr)||0)+1),Rr&lt&&Xt.set(lt,(Xt.get(lt)||0)+1),Rr&Er)if(Rr&(er|Ht)){hr[lr]=nr._level;var br=(Rr===er?qt:Ar)(nr._level);br<=Ur&&!Cr&&!cr?mr.push({_level:br,_override:0,_isolate:0}):Cr||cr++}else if(Rr&($t|zt)){hr[lr]=nr._level;var jr=(Rr===$t?qt:Ar)(nr._level);jr<=Ur&&!Cr&&!cr?mr.push({_level:jr,_override:Rr&$t?wt:bt,_isolate:0}):Cr||cr++}else if(Rr&st){Rr&rr&&(Rr=No(lr+1,!0)===1?Kt:or),hr[lr]=nr._level,nr._override&&Qt(lr,nr._override);var Yr=(Rr===Kt?qt:Ar)(nr._level);Yr<=Ur&&Cr===0&&cr===0?(Jr++,mr.push({_level:Yr,_override:0,_isolate:1,_isolInitIndex:lr})):Cr++}else if(Rr&ur){if(Cr>0)Cr--;else if(Jr>0){for(cr=0;!mr[mr.length-1]._isolate;)mr.pop();var mn=mr[mr.length-1]._isolInitIndex;mn!=null&&(kr.set(mn,lr),kr.set(lr,mn)),mr.pop(),Jr--}nr=mr[mr.length-1],hr[lr]=nr._level,nr._override&&Qt(lr,nr._override)}else Rr&Zt?(Cr===0&&(cr>0?cr--:!nr._isolate&&mr.length>1&&(mr.pop(),nr=mr[mr.length-1])),hr[lr]=nr._level):Rr&Bt&&(hr[lr]=_r.level);else hr[lr]=nr._level,nr._override&&Rr!==jt&&Qt(lr,nr._override)}for(var bn=[],fn=null,Cn=_r.start;Cn<=_r.end;Cn++){var Tn=Lr[Cn];if(!(Tn&at)){var gn=hr[Cn],En=Tn&st,Xn=Tn===ur;fn&&gn===fn._level?(fn._end=Cn,fn._endsWithIsolInit=En):bn.push(fn={_start:Cn,_end:Cn,_level:gn,_startsWithPDI:Xn,_endsWithIsolInit:En})}}for(var $n=[],wn=0;wn<bn.length;wn++){var Bn=bn[wn];if(!Bn._startsWithPDI||Bn._startsWithPDI&&!kr.has(Bn._start)){for(var Qn=[fn=Bn],Mn=void 0;fn&&fn._endsWithIsolInit&&(Mn=kr.get(fn._end))!=null;)for(var on=wn+1;on<bn.length;on++)if(bn[on]._start===Mn){Qn.push(fn=bn[on]);break}for(var Gn=[],_s=0;_s<Qn.length;_s++)for(var Wt=Qn[_s],kt=Wt._start;kt<=Wt._end;kt++)Gn.push(kt);for(var Jt=hr[Gn[0]],ir=_r.level,tr=Gn[0]-1;tr>=0;tr--)if(!(Lr[tr]&at)){ir=hr[tr];break}var ar=Gn[Gn.length-1],Or=hr[ar],Br=_r.level;if(!(Lr[ar]&st)){for(var $r=ar+1;$r<=_r.end;$r++)if(!(Lr[$r]&at)){Br=hr[$r];break}}$n.push({_seqIndices:Gn,_sosType:Math.max(ir,Jt)%2?wt:bt,_eosType:Math.max(Br,Or)%2?wt:bt})}}for(var Gr=0;Gr<$n.length;Gr++){var Vr=$n[Gr],wr=Vr._seqIndices,Zr=Vr._sosType,Kr=Vr._eosType,qr=hr[wr[0]]&1?wt:bt;if(Xt.get(Dt))for(var an=0;an<wr.length;an++){var hn=wr[an];if(Lr[hn]&Dt){for(var ln=Zr,en=an-1;en>=0;en--)if(!(Lr[wr[en]]&at)){ln=Lr[wr[en]];break}Qt(hn,ln&(st|ur)?Ft:ln)}}if(Xt.get(Tt))for(var dn=0;dn<wr.length;dn++){var sn=wr[dn];if(Lr[sn]&Tt)for(var An=dn-1;An>=-1;An--){var Nn=An===-1?Zr:Lr[wr[An]];if(Nn&ot){Nn===Gt&&Qt(sn,It);break}}}if(Xt.get(Gt))for(var vn=0;vn<wr.length;vn++){var kn=wr[vn];Lr[kn]&Gt&&Qt(kn,wt)}if(Xt.get(Mt)||Xt.get(Ot))for(var In=1;In<wr.length-1;In++){var Dn=wr[In];if(Lr[Dn]&(Mt|Ot)){for(var zn=0,yn=0,Vn=In-1;Vn>=0&&(zn=Lr[wr[Vn]],!!(zn&at));Vn--);for(var On=In+1;On<wr.length&&(yn=Lr[wr[On]],!!(yn&at));On++);zn===yn&&(Lr[Dn]===Mt?zn===Tt:zn&(Tt|It))&&Qt(Dn,zn)}}if(Xt.get(Tt))for(var _n=0;_n<wr.length;_n++){var jn=wr[_n];if(Lr[jn]&Tt){for(var Es=_n-1;Es>=0&&Lr[wr[Es]]&(Pt|at);Es--)Qt(wr[Es],Tt);for(_n++;_n<wr.length&&Lr[wr[_n]]&(Pt|at|Tt);_n++)Lr[wr[_n]]!==Tt&&Qt(wr[_n],Tt)}}if(Xt.get(Pt)||Xt.get(Mt)||Xt.get(Ot))for(var Kn=0;Kn<wr.length;Kn++){var Ts=wr[Kn];if(Lr[Ts]&(Pt|Mt|Ot)){Qt(Ts,Ft);for(var Js=Kn-1;Js>=0&&Lr[wr[Js]]&at;Js--)Qt(wr[Js],Ft);for(var qs=Kn+1;qs<wr.length&&Lr[wr[qs]]&at;qs++)Qt(wr[qs],Ft)}}if(Xt.get(Tt))for(var Ks=0,vo=Zr;Ks<wr.length;Ks++){var Il=wr[Ks],Qo=Lr[Il];Qo&Tt?vo===bt&&Qt(Il,bt):Qo&ot&&(vo=Qo)}if(Xt.get(lt)){var Zs=wt|Tt|It,Lo=Zs|bt,Hs=[];{for(var oo=[],js=0;js<wr.length;js++)if(Lr[wr[js]]&lt){var Ln=Ir[wr[js]],Wo=void 0;if(xt(Ln)!==null)if(oo.length<63)oo.push({char:Ln,seqIndex:js});else break;else if((Wo=_t(Ln))!==null)for(var eo=oo.length-1;eo>=0;eo--){var Oo=oo[eo].char;if(Oo===Wo||Oo===_t(Et(Ln))||xt(Et(Oo))===Ln){Hs.push([oo[eo].seqIndex,js]),oo.length=eo;break}}}Hs.sort(function(os,vs){return os[0]-vs[0]})}for(var Xo=0;Xo<Hs.length;Xo++){for(var Ll=Hs[Xo],Yn=Ll[0],Ao=Ll[1],Ol=!1,ps=0,Yo=Yn+1;Yo<Ao;Yo++){var yo=wr[Yo];if(Lr[yo]&Lo){Ol=!0;var ws=Lr[yo]&Zs?wt:bt;if(ws===qr){ps=ws;break}}}if(Ol&&!ps){ps=Zr;for(var Jo=Yn-1;Jo>=0;Jo--){var Bl=wr[Jo];if(Lr[Bl]&Lo){var Ms=Lr[Bl]&Zs?wt:bt;Ms!==qr?ps=Ms:ps=qr;break}}}if(ps){if(Lr[wr[Yn]]=Lr[wr[Ao]]=ps,ps!==qr){for(var ms=Yn+1;ms<wr.length;ms++)if(!(Lr[wr[ms]]&at)){dt(Ir[wr[ms]])&Dt&&(Lr[wr[ms]]=ps);break}}if(ps!==qr){for(var Qs=Ao+1;Qs<wr.length;Qs++)if(!(Lr[wr[Qs]]&at)){dt(Ir[wr[Qs]])&Dt&&(Lr[wr[Qs]]=ps);break}}}}for(var Bs=0;Bs<wr.length;Bs++)if(Lr[wr[Bs]]&lt){for(var qo=Bs,Ko=Bs,bs=Zr,_o=Bs-1;_o>=0;_o--)if(Lr[wr[_o]]&at)qo=_o;else{bs=Lr[wr[_o]]&Zs?wt:bt;break}for(var Eo=Kr,bo=Bs+1;bo<wr.length;bo++)if(Lr[wr[bo]]&(lt|at))Ko=bo;else{Eo=Lr[wr[bo]]&Zs?wt:bt;break}for(var gs=qo;gs<=Ko;gs++)Lr[wr[gs]]=bs===Eo?bs:qr;Bs=Ko}}}for(var ss=_r.start;ss<=_r.end;ss++){var Bo=hr[ss],zs=Lr[ss];if(Bo&1?zs&(bt|Tt|It)&&hr[ss]++:zs&wt?hr[ss]++:zs&(It|Tt)&&(hr[ss]+=2),zs&at&&(hr[ss]=ss===0?_r.level:hr[ss-1]),ss===_r.end||dt(Ir[ss])&(Ut|Bt))for(var ao=ss;ao>=0&&dt(Ir[ao])&ct;ao--)hr[ao]=_r.level}}return{levels:hr,paragraphs:yr};function No(os,vs){for(var Zn=os;Zn<Ir.length;Zn++){var _i=Lr[Zn];if(_i&(wt|Gt))return 1;if(_i&(Bt|bt)||vs&&_i===ur)return 0;if(_i&st){var Rs=Nl(Zn);Zn=Rs===-1?Ir.length:Rs}}return 0}function Nl(os){for(var vs=1,Zn=os+1;Zn<Ir.length;Zn++){var _i=Lr[Zn];if(_i&Bt)break;if(_i&ur){if(--vs===0)return Zn}else _i&st&&vs++}return-1}}var dr="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",gr;function Yt(){if(!gr){var Ir=mt(dr,!0),Dr=Ir.map,Ur=Ir.reverseMap;Ur.forEach(function(Lr,Wr){Dr.set(Wr,Lr)}),gr=Dr}}function xr(Ir){return Yt(),gr.get(Ir)||null}function vr(Ir,Dr,Ur,Lr){var Wr=Ir.length;Ur=Math.max(0,Ur==null?0:+Ur),Lr=Math.min(Wr-1,Lr==null?Wr-1:+Lr);for(var Xt=new Map,Qt=Ur;Qt<=Lr;Qt++)if(Dr[Qt]&1){var hr=xr(Ir[Qt]);hr!==null&&Xt.set(Qt,hr)}return Xt}function Pr(Ir,Dr,Ur,Lr){var Wr=Ir.length;Ur=Math.max(0,Ur==null?0:+Ur),Lr=Math.min(Wr-1,Lr==null?Wr-1:+Lr);var Xt=[];return Dr.paragraphs.forEach(function(Qt){var hr=Math.max(Ur,Qt.start),kr=Math.min(Lr,Qt.end);if(hr<kr){for(var yr=Dr.levels.slice(hr,kr+1),_r=kr;_r>=hr&&dt(Ir[_r])&ct;_r--)yr[_r]=Qt.level;for(var Hr=Qt.level,Er=1/0,Ar=0;Ar<yr.length;Ar++){var qt=yr[Ar];qt>Hr&&(Hr=qt),qt<Er&&(Er=qt|1)}for(var pr=Hr;pr>=Er;pr--)for(var mr=0;mr<yr.length;mr++)if(yr[mr]>=pr){for(var nr=mr;mr+1<yr.length&&yr[mr+1]>=pr;)mr++;mr>nr&&Xt.push([nr+hr,mr+hr])}}}),Xt}function Sr(Ir,Dr,Ur,Lr){var Wr=Qr(Ir,Dr,Ur,Lr),Xt=[].concat(Ir);return Wr.forEach(function(Qt,hr){Xt[hr]=(Dr.levels[Qt]&1?xr(Ir[Qt]):null)||Ir[Qt]}),Xt.join("")}function Qr(Ir,Dr,Ur,Lr){for(var Wr=Pr(Ir,Dr,Ur,Lr),Xt=[],Qt=0;Qt<Ir.length;Qt++)Xt[Qt]=Qt;return Wr.forEach(function(hr){for(var kr=hr[0],yr=hr[1],_r=Xt.slice(kr,yr+1),Hr=_r.length;Hr--;)Xt[yr-Hr]=_r[Hr]}),Xt}return _e.closingToOpeningBracket=_t,_e.getBidiCharType=dt,_e.getBidiCharTypeName=ft,_e.getCanonicalBracket=Et,_e.getEmbeddingLevels=fr,_e.getMirroredCharacter=xr,_e.getMirroredCharactersMap=vr,_e.getReorderSegments=Pr,_e.getReorderedIndices=Qr,_e.getReorderedString=Sr,_e.openingToClosingBracket=xt,Object.defineProperty(_e,"__esModule",{value:!0}),_e}({});return tt}const voidMainRegExp=/\bvoid\s+main\s*\(\s*\)\s*{/g;function expandShaderIncludes(tt){const _e=/^[ \t]*#include +<([\w\d./]+)>/gm;function rt(nt,it){let st=ShaderChunk[it];return st?expandShaderIncludes(st):nt}return tt.replace(_e,rt)}const _lut=[];for(let tt=0;tt<256;tt++)_lut[tt]=(tt<16?"0":"")+tt.toString(16);function generateUUID(){const tt=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,rt=Math.random()*4294967295|0,nt=Math.random()*4294967295|0;return(_lut[tt&255]+_lut[tt>>8&255]+_lut[tt>>16&255]+_lut[tt>>24&255]+"-"+_lut[_e&255]+_lut[_e>>8&255]+"-"+_lut[_e>>16&15|64]+_lut[_e>>24&255]+"-"+_lut[rt&63|128]+_lut[rt>>8&255]+"-"+_lut[rt>>16&255]+_lut[rt>>24&255]+_lut[nt&255]+_lut[nt>>8&255]+_lut[nt>>16&255]+_lut[nt>>24&255]).toUpperCase()}const assign$4=Object.assign||function(){let tt=arguments[0];for(let _e=1,rt=arguments.length;_e<rt;_e++){let nt=arguments[_e];if(nt)for(let it in nt)Object.prototype.hasOwnProperty.call(nt,it)&&(tt[it]=nt[it])}return tt},epoch=Date.now(),CONSTRUCTOR_CACHE=new WeakMap,SHADER_UPGRADE_CACHE=new Map;let materialInstanceId=1e10;function createDerivedMaterial(tt,_e){const rt=getKeyForOptions(_e);let nt=CONSTRUCTOR_CACHE.get(tt);if(nt||CONSTRUCTOR_CACHE.set(tt,nt=Object.create(null)),nt[rt])return new nt[rt];const it=`_onBeforeCompile${rt}`,st=function(ct,ut){tt.onBeforeCompile.call(this,ct,ut);const ht=this.customProgramCacheKey()+"|"+ct.vertexShader+"|"+ct.fragmentShader;let dt=SHADER_UPGRADE_CACHE[ht];if(!dt){const ft=upgradeShaders(this,ct,_e,rt);dt=SHADER_UPGRADE_CACHE[ht]=ft}ct.vertexShader=dt.vertexShader,ct.fragmentShader=dt.fragmentShader,assign$4(ct.uniforms,this.uniforms),_e.timeUniform&&(ct.uniforms[_e.timeUniform]={get value(){return Date.now()-epoch}}),this[it]&&this[it](ct)},ot=function(){return lt(_e.chained?tt:tt.clone())},lt=function(ct){const ut=Object.create(ct,at);return Object.defineProperty(ut,"baseMaterial",{value:tt}),Object.defineProperty(ut,"id",{value:materialInstanceId++}),ut.uuid=generateUUID(),ut.uniforms=assign$4({},ct.uniforms,_e.uniforms),ut.defines=assign$4({},ct.defines,_e.defines),ut.defines[`TROIKA_DERIVED_MATERIAL_${rt}`]="",ut.extensions=assign$4({},ct.extensions,_e.extensions),ut._listeners=void 0,ut},at={constructor:{value:ot},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return tt.customProgramCacheKey()+"|"+rt}},onBeforeCompile:{get(){return st},set(ct){this[it]=ct}},copy:{writable:!0,configurable:!0,value:function(ct){return tt.copy.call(this,ct),!tt.isShaderMaterial&&!tt.isDerivedMaterial&&(assign$4(this.extensions,ct.extensions),assign$4(this.defines,ct.defines),assign$4(this.uniforms,UniformsUtils.clone(ct.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const ct=new tt.constructor;return lt(ct).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let ct=this._depthMaterial;return ct||(ct=this._depthMaterial=createDerivedMaterial(tt.isDerivedMaterial?tt.getDepthMaterial():new MeshDepthMaterial({depthPacking:RGBADepthPacking}),_e),ct.defines.IS_DEPTH_MATERIAL="",ct.uniforms=this.uniforms),ct}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let ct=this._distanceMaterial;return ct||(ct=this._distanceMaterial=createDerivedMaterial(tt.isDerivedMaterial?tt.getDistanceMaterial():new MeshDistanceMaterial,_e),ct.defines.IS_DISTANCE_MATERIAL="",ct.uniforms=this.uniforms),ct}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:ct,_distanceMaterial:ut}=this;ct&&ct.dispose(),ut&&ut.dispose(),tt.dispose.call(this)}}};return nt[rt]=ot,new ot}function upgradeShaders(tt,{vertexShader:_e,fragmentShader:rt},nt,it){let{vertexDefs:st,vertexMainIntro:ot,vertexMainOutro:lt,vertexTransform:at,fragmentDefs:ct,fragmentMainIntro:ut,fragmentMainOutro:ht,fragmentColorTransform:dt,customRewriter:ft,timeUniform:pt}=nt;if(st=st||"",ot=ot||"",lt=lt||"",ct=ct||"",ut=ut||"",ht=ht||"",(at||ft)&&(_e=expandShaderIncludes(_e)),(dt||ft)&&(rt=rt.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),rt=expandShaderIncludes(rt)),ft){let mt=ft({vertexShader:_e,fragmentShader:rt});_e=mt.vertexShader,rt=mt.fragmentShader}if(dt){let mt=[];rt=rt.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,gt=>(mt.push(gt),"")),ht=`${dt}
${mt.join(`
`)}
${ht}`}if(pt){const mt=`
uniform float ${pt};
`;st=mt+st,ct=mt+ct}return at&&(_e=`vec3 troika_position_${it};
vec3 troika_normal_${it};
vec2 troika_uv_${it};
${_e}
`,st=`${st}
void troikaVertexTransform${it}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${at}
}
`,ot=`
troika_position_${it} = vec3(position);
troika_normal_${it} = vec3(normal);
troika_uv_${it} = vec2(uv);
troikaVertexTransform${it}(troika_position_${it}, troika_normal_${it}, troika_uv_${it});
${ot}
`,_e=_e.replace(/\b(position|normal|uv)\b/g,(mt,gt,vt,At)=>/\battribute\s+vec[23]\s+$/.test(At.substr(0,vt))?gt:`troika_${gt}_${it}`),tt.map&&tt.map.channel>0||(_e=_e.replace(/\bMAP_UV\b/g,`troika_uv_${it}`))),_e=injectIntoShaderCode(_e,it,st,ot,lt),rt=injectIntoShaderCode(rt,it,ct,ut,ht),{vertexShader:_e,fragmentShader:rt}}function injectIntoShaderCode(tt,_e,rt,nt,it){return(nt||it||rt)&&(tt=tt.replace(voidMainRegExp,`
${rt}
void troikaOrigMain${_e}() {`),tt+=`
void main() {
  ${nt}
  troikaOrigMain${_e}();
  ${it}
}`),tt}function optionsJsonReplacer(tt,_e){return tt==="uniforms"?void 0:typeof _e=="function"?_e.toString():_e}let _idCtr=0;const optionsHashesToIds=new Map;function getKeyForOptions(tt){const _e=JSON.stringify(tt,optionsJsonReplacer);let rt=optionsHashesToIds.get(_e);return rt==null&&optionsHashesToIds.set(_e,rt=++_idCtr),rt}function createTypesetter(tt,_e,rt){const{defaultFontURL:nt}=rt,it=Object.create(null),st=1/0,ot=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,lt="[^\\S\\u00A0]",at=new RegExp(`${lt}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function ct(At,yt){function xt(){const _t=Et=>{console.error(`Failure loading font ${At}${At===nt?"":"; trying fallback"}`,Et),At!==nt&&(At=nt,xt())};try{const Et=new XMLHttpRequest;Et.open("get",At,!0),Et.responseType="arraybuffer",Et.onload=function(){if(Et.status>=400)_t(new Error(Et.statusText));else if(Et.status>0)try{const bt=tt(Et.response);yt(bt)}catch(bt){_t(bt)}},Et.onerror=_t,Et.send()}catch(Et){_t(Et)}}xt()}function ut(At,yt){At||(At=nt);let xt=it[At];xt?xt.pending?xt.pending.push(yt):yt(xt):(it[At]={pending:[yt]},ct(At,_t=>{let Et=it[At].pending;it[At]=_t,Et.forEach(bt=>bt(_t))}))}function ht({text:At="",font:yt=nt,sdfGlyphSize:xt=64,fontSize:_t=1,letterSpacing:Et=0,lineHeight:bt="normal",maxWidth:wt=st,direction:Tt,textAlign:Mt="left",textIndent:Pt=0,whiteSpace:It="normal",overflowWrap:Ot="normal",anchorX:Bt=0,anchorY:Ut=0,includeCaretPositions:Ft=!1,chunkedBoundsSize:jt=8192,colorRanges:Dt=null},Gt,zt=!1){const $t=mt(),Ht={fontLoad:0,typesetting:0};At.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),At=At.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),_t=+_t,Et=+Et,wt=+wt,bt=bt||"normal",Pt=+Pt,ut(yt,er=>{const Zt=isFinite(wt);let or=null,Kt=null,rr=null,ur=null,fr=null,dr=null,gr=null,Yt=0,xr=0,vr=It!=="nowrap";const{ascender:Pr,descender:Sr,unitsPerEm:Qr,lineGap:Ir,capHeight:Dr,xHeight:Ur}=er;Ht.fontLoad=mt()-$t;const Lr=mt(),Wr=_t/Qr;bt==="normal"&&(bt=(Pr-Sr+Ir)/Qr),bt=bt*_t;const Xt=(bt-(Pr-Sr)*Wr)/2,Qt=-(Pr*Wr+Xt),hr=Math.min(bt,(Pr-Sr)*Wr),kr=(Pr+Sr)/2*Wr-hr/2;let yr=Pt,_r=new gt;const Hr=[_r];er.forEachGlyph(At,_t,Et,(qt,pr,mr)=>{const nr=At.charAt(mr),Cr=qt.advanceWidth*Wr,cr=_r.count;let Jr;if("isEmpty"in qt||(qt.isWhitespace=!!nr&&new RegExp(lt).test(nr),qt.canBreakAfter=!!nr&&at.test(nr),qt.isEmpty=qt.xMin===qt.xMax||qt.yMin===qt.yMax||ot.test(nr)),!qt.isWhitespace&&!qt.isEmpty&&xr++,vr&&Zt&&!qt.isWhitespace&&pr+Cr+yr>wt&&cr){if(_r.glyphAt(cr-1).glyphObj.canBreakAfter)Jr=new gt,yr=-pr;else for(let Rr=cr;Rr--;)if(Rr===0&&Ot==="break-word"){Jr=new gt,yr=-pr;break}else if(_r.glyphAt(Rr).glyphObj.canBreakAfter){Jr=_r.splitAt(Rr+1);const br=Jr.glyphAt(0).x;yr-=br;for(let jr=Jr.count;jr--;)Jr.glyphAt(jr).x-=br;break}Jr&&(_r.isSoftWrapped=!0,_r=Jr,Hr.push(_r),Yt=wt)}let lr=_r.glyphAt(_r.count);lr.glyphObj=qt,lr.x=pr+yr,lr.width=Cr,lr.charIndex=mr,nr===`
`&&(_r=new gt,Hr.push(_r),yr=-(pr+Cr+Et*_t)+Pt)}),Hr.forEach(qt=>{for(let pr=qt.count;pr--;){let{glyphObj:mr,x:nr,width:Cr}=qt.glyphAt(pr);if(!mr.isWhitespace){qt.width=nr+Cr,qt.width>Yt&&(Yt=qt.width);return}}});let Er=0,Ar=0;if(Bt&&(typeof Bt=="number"?Er=-Bt:typeof Bt=="string"&&(Er=-Yt*(Bt==="left"?0:Bt==="center"?.5:Bt==="right"?1:ft(Bt)))),Ut){if(typeof Ut=="number")Ar=-Ut;else if(typeof Ut=="string"){let qt=Hr.length*bt;Ar=Ut==="top"?0:Ut==="top-baseline"?-Qt:Ut==="top-cap"?-Qt-Dr*Wr:Ut==="top-ex"?-Qt-Ur*Wr:Ut==="middle"?qt/2:Ut==="bottom"?qt:Ut==="bottom-baseline"?qt-Xt+Sr*Wr:ft(Ut)*qt}}if(!zt){const qt=_e.getEmbeddingLevels(At,Tt);or=new Uint16Array(xr),Kt=new Float32Array(xr*2),rr={},dr=[st,st,-st,-st],gr=[];let pr=Qt;Ft&&(fr=new Float32Array(At.length*3)),Dt&&(ur=new Uint8Array(xr*3));let mr=0,nr=-1,Cr=-1,cr,Jr;if(Hr.forEach((lr,Rr)=>{let{count:br,width:jr}=lr;if(br>0){let Yr=0;for(let gn=br;gn--&&lr.glyphAt(gn).glyphObj.isWhitespace;)Yr++;let mn=0,bn=0;if(Mt==="center")mn=(Yt-jr)/2;else if(Mt==="right")mn=Yt-jr;else if(Mt==="justify"&&lr.isSoftWrapped){let gn=0;for(let En=br-Yr;En--;)lr.glyphAt(En).glyphObj.isWhitespace&&gn++;bn=(Yt-jr)/gn}if(bn||mn){let gn=0;for(let En=0;En<br;En++){let Xn=lr.glyphAt(En);const $n=Xn.glyphObj;Xn.x+=mn+gn,bn!==0&&$n.isWhitespace&&En<br-Yr&&(gn+=bn,Xn.width+=bn)}}const fn=_e.getReorderSegments(At,qt,lr.glyphAt(0).charIndex,lr.glyphAt(lr.count-1).charIndex);for(let gn=0;gn<fn.length;gn++){const[En,Xn]=fn[gn];let $n=1/0,wn=-1/0;for(let Bn=0;Bn<br;Bn++)if(lr.glyphAt(Bn).charIndex>=En){let Qn=Bn,Mn=Bn;for(;Mn<br;Mn++){let on=lr.glyphAt(Mn);if(on.charIndex>Xn)break;Mn<br-Yr&&($n=Math.min($n,on.x),wn=Math.max(wn,on.x+on.width))}for(let on=Qn;on<Mn;on++){const Gn=lr.glyphAt(on);Gn.x=wn-(Gn.x+Gn.width-$n)}break}}let Cn;const Tn=gn=>Cn=gn;for(let gn=0;gn<br;gn++){let En=lr.glyphAt(gn);Cn=En.glyphObj;const Xn=Cn.index,$n=qt.levels[En.charIndex]&1;if($n){const wn=_e.getMirroredCharacter(At[En.charIndex]);wn&&er.forEachGlyph(wn,0,0,Tn)}if(Ft){const{charIndex:wn}=En,Bn=En.x+Er,Qn=En.x+En.width+Er;fr[wn*3]=$n?Qn:Bn,fr[wn*3+1]=$n?Bn:Qn,fr[wn*3+2]=pr+kr+Ar;const Mn=wn-nr;Mn>1&&pt(fr,nr,Mn),nr=wn}if(Dt){const{charIndex:wn}=En;for(;wn>Cr;)Cr++,Dt.hasOwnProperty(Cr)&&(Jr=Dt[Cr])}if(!Cn.isWhitespace&&!Cn.isEmpty){const wn=mr++;rr[Xn]||(rr[Xn]={path:Cn.path,pathBounds:[Cn.xMin,Cn.yMin,Cn.xMax,Cn.yMax]});const Bn=En.x+Er,Qn=pr+Ar;Kt[wn*2]=Bn,Kt[wn*2+1]=Qn;const Mn=Bn+Cn.xMin*Wr,on=Qn+Cn.yMin*Wr,Gn=Bn+Cn.xMax*Wr,_s=Qn+Cn.yMax*Wr;Mn<dr[0]&&(dr[0]=Mn),on<dr[1]&&(dr[1]=on),Gn>dr[2]&&(dr[2]=Gn),_s>dr[3]&&(dr[3]=_s),wn%jt===0&&(cr={start:wn,end:wn,rect:[st,st,-st,-st]},gr.push(cr)),cr.end++;const Wt=cr.rect;if(Mn<Wt[0]&&(Wt[0]=Mn),on<Wt[1]&&(Wt[1]=on),Gn>Wt[2]&&(Wt[2]=Gn),_s>Wt[3]&&(Wt[3]=_s),or[wn]=Xn,Dt){const kt=wn*3;ur[kt]=Jr>>16&255,ur[kt+1]=Jr>>8&255,ur[kt+2]=Jr&255}}}}pr-=bt}),fr){const lr=At.length-nr;lr>1&&pt(fr,nr,lr)}}Ht.typesetting=mt()-Lr,Gt({glyphIds:or,glyphPositions:Kt,glyphData:rr,caretPositions:fr,caretHeight:hr,glyphColors:ur,chunkedBounds:gr,fontSize:_t,unitsPerEm:Qr,ascender:Pr*Wr,descender:Sr*Wr,capHeight:Dr*Wr,xHeight:Ur*Wr,lineHeight:bt,topBaseline:Qt,blockBounds:[Er,Ar-Hr.length*bt,Er+Yt,Ar],visibleBounds:dr,timings:Ht})})}function dt(At,yt){ht(At,xt=>{const[_t,Et,bt,wt]=xt.blockBounds;yt({width:bt-_t,height:wt-Et})},{metricsOnly:!0})}function ft(At){let yt=At.match(/^([\d.]+)%$/),xt=yt?parseFloat(yt[1]):NaN;return isNaN(xt)?0:xt/100}function pt(At,yt,xt){const _t=At[yt*3],Et=At[yt*3+1],bt=At[yt*3+2],wt=(Et-_t)/xt;for(let Tt=0;Tt<xt;Tt++){const Mt=(yt+Tt)*3;At[Mt]=_t+wt*Tt,At[Mt+1]=_t+wt*(Tt+1),At[Mt+2]=bt}}function mt(){return(self.performance||Date).now()}function gt(){this.data=[]}const vt=["glyphObj","x","width","charIndex"];return gt.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/vt.length)},glyphAt(At){let yt=gt.flyweight;return yt.data=this.data,yt.index=At,yt},splitAt(At){let yt=new gt;return yt.data=this.data.splice(At*vt.length),yt}},gt.flyweight=vt.reduce((At,yt,xt,_t)=>(Object.defineProperty(At,yt,{get(){return this.data[this.index*vt.length+xt]},set(Et){this.data[this.index*vt.length+xt]=Et}}),At),{data:null,index:0}),{typeset:ht,measure:dt,loadFont:ut}}const now=()=>(self.performance||Date).now(),mainThreadGenerator=SDFGenerator();let warned;function generateSDF(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut=!0){return ut?generateSDF_GL(tt,_e,rt,nt,it,st,ot,lt,at,ct).then(null,ht=>(warned||(console.warn("WebGL SDF generation failed, falling back to JS",ht),warned=!0),generateSDF_JS_Worker(tt,_e,rt,nt,it,st,ot,lt,at,ct))):generateSDF_JS_Worker(tt,_e,rt,nt,it,st,ot,lt,at,ct)}const queue=[],chunkTimeBudget=5;let timer=0;function nextChunk(){const tt=now();for(;queue.length&&now()-tt<chunkTimeBudget;)queue.shift()();timer=queue.length?setTimeout(nextChunk,0):0}const generateSDF_GL=(...tt)=>new Promise((_e,rt)=>{queue.push(()=>{const nt=now();try{mainThreadGenerator.webgl.generateIntoCanvas(...tt),_e({timing:now()-nt})}catch(it){rt(it)}}),timer||(timer=setTimeout(nextChunk,0))}),threadCount=4,idleTimeout=2e3,threads={};let callNum=0;function generateSDF_JS_Worker(tt,_e,rt,nt,it,st,ot,lt,at,ct){const ut="TroikaTextSDFGenerator_JS_"+callNum++%threadCount;let ht=threads[ut];return ht||(ht=threads[ut]={workerModule:defineWorkerModule({name:ut,workerId:ut,dependencies:[SDFGenerator,now],init(dt,ft){const pt=dt().javascript.generate;return function(...mt){const gt=ft();return{textureData:pt(...mt),timing:ft()-gt}}},getTransferables(dt){return[dt.textureData.buffer]}}),requests:0,idleTimer:null}),ht.requests++,clearTimeout(ht.idleTimer),ht.workerModule(tt,_e,rt,nt,it,st).then(({textureData:dt,timing:ft})=>{const pt=now(),mt=new Uint8Array(dt.length*4);for(let gt=0;gt<dt.length;gt++)mt[gt*4+ct]=dt[gt];return mainThreadGenerator.webglUtils.renderImageData(ot,mt,lt,at,tt,_e,1<<3-ct),ft+=now()-pt,--ht.requests===0&&(ht.idleTimer=setTimeout(()=>{terminateWorker(ut)},idleTimeout)),{timing:ft}})}function warmUpSDFCanvas(tt){tt._warm||(mainThreadGenerator.webgl.isSupported(tt),tt._warm=!0)}const resizeWebGLCanvasWithoutClearing=mainThreadGenerator.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function typrFactory(){return typeof window>"u"&&(self.window=self),function(tt){var _e={parse:function(it){var st=_e._bin,ot=new Uint8Array(it);if(st.readASCII(ot,0,4)=="ttcf"){var lt=4;st.readUshort(ot,lt),lt+=2,st.readUshort(ot,lt),lt+=2;var at=st.readUint(ot,lt);lt+=4;for(var ct=[],ut=0;ut<at;ut++){var ht=st.readUint(ot,lt);lt+=4,ct.push(_e._readFont(ot,ht))}return ct}return[_e._readFont(ot,0)]},_readFont:function(it,st){var ot=_e._bin,lt=st;ot.readFixed(it,st),st+=4;var at=ot.readUshort(it,st);st+=2,ot.readUshort(it,st),st+=2,ot.readUshort(it,st),st+=2,ot.readUshort(it,st),st+=2;for(var ct=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],ut={_data:it,_offset:lt},ht={},dt=0;dt<at;dt++){var ft=ot.readASCII(it,st,4);st+=4,ot.readUint(it,st),st+=4;var pt=ot.readUint(it,st);st+=4;var mt=ot.readUint(it,st);st+=4,ht[ft]={offset:pt,length:mt}}for(dt=0;dt<ct.length;dt++){var gt=ct[dt];ht[gt]&&(ut[gt.trim()]=_e[gt.trim()].parse(it,ht[gt].offset,ht[gt].length,ut))}return ut},_tabOffset:function(it,st,ot){for(var lt=_e._bin,at=lt.readUshort(it,ot+4),ct=ot+12,ut=0;ut<at;ut++){var ht=lt.readASCII(it,ct,4);ct+=4,lt.readUint(it,ct),ct+=4;var dt=lt.readUint(it,ct);if(ct+=4,lt.readUint(it,ct),ct+=4,ht==st)return dt}return 0}};_e._bin={readFixed:function(it,st){return(it[st]<<8|it[st+1])+(it[st+2]<<8|it[st+3])/65540},readF2dot14:function(it,st){return _e._bin.readShort(it,st)/16384},readInt:function(it,st){return _e._bin._view(it).getInt32(st)},readInt8:function(it,st){return _e._bin._view(it).getInt8(st)},readShort:function(it,st){return _e._bin._view(it).getInt16(st)},readUshort:function(it,st){return _e._bin._view(it).getUint16(st)},readUshorts:function(it,st,ot){for(var lt=[],at=0;at<ot;at++)lt.push(_e._bin.readUshort(it,st+2*at));return lt},readUint:function(it,st){return _e._bin._view(it).getUint32(st)},readUint64:function(it,st){return 4294967296*_e._bin.readUint(it,st)+_e._bin.readUint(it,st+4)},readASCII:function(it,st,ot){for(var lt="",at=0;at<ot;at++)lt+=String.fromCharCode(it[st+at]);return lt},readUnicode:function(it,st,ot){for(var lt="",at=0;at<ot;at++){var ct=it[st++]<<8|it[st++];lt+=String.fromCharCode(ct)}return lt},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(it,st,ot){var lt=_e._bin._tdec;return lt&&st==0&&ot==it.length?lt.decode(it):_e._bin.readASCII(it,st,ot)},readBytes:function(it,st,ot){for(var lt=[],at=0;at<ot;at++)lt.push(it[st+at]);return lt},readASCIIArray:function(it,st,ot){for(var lt=[],at=0;at<ot;at++)lt.push(String.fromCharCode(it[st+at]));return lt},_view:function(it){return it._dataView||(it._dataView=it.buffer?new DataView(it.buffer,it.byteOffset,it.byteLength):new DataView(new Uint8Array(it).buffer))}},_e._lctf={},_e._lctf.parse=function(it,st,ot,lt,at){var ct=_e._bin,ut={},ht=st;ct.readFixed(it,st),st+=4;var dt=ct.readUshort(it,st);st+=2;var ft=ct.readUshort(it,st);st+=2;var pt=ct.readUshort(it,st);return st+=2,ut.scriptList=_e._lctf.readScriptList(it,ht+dt),ut.featureList=_e._lctf.readFeatureList(it,ht+ft),ut.lookupList=_e._lctf.readLookupList(it,ht+pt,at),ut},_e._lctf.readLookupList=function(it,st,ot){var lt=_e._bin,at=st,ct=[],ut=lt.readUshort(it,st);st+=2;for(var ht=0;ht<ut;ht++){var dt=lt.readUshort(it,st);st+=2;var ft=_e._lctf.readLookupTable(it,at+dt,ot);ct.push(ft)}return ct},_e._lctf.readLookupTable=function(it,st,ot){var lt=_e._bin,at=st,ct={tabs:[]};ct.ltype=lt.readUshort(it,st),st+=2,ct.flag=lt.readUshort(it,st),st+=2;var ut=lt.readUshort(it,st);st+=2;for(var ht=ct.ltype,dt=0;dt<ut;dt++){var ft=lt.readUshort(it,st);st+=2;var pt=ot(it,ht,at+ft,ct);ct.tabs.push(pt)}return ct},_e._lctf.numOfOnes=function(it){for(var st=0,ot=0;ot<32;ot++)it>>>ot&1&&st++;return st},_e._lctf.readClassDef=function(it,st){var ot=_e._bin,lt=[],at=ot.readUshort(it,st);if(st+=2,at==1){var ct=ot.readUshort(it,st);st+=2;var ut=ot.readUshort(it,st);st+=2;for(var ht=0;ht<ut;ht++)lt.push(ct+ht),lt.push(ct+ht),lt.push(ot.readUshort(it,st)),st+=2}if(at==2){var dt=ot.readUshort(it,st);for(st+=2,ht=0;ht<dt;ht++)lt.push(ot.readUshort(it,st)),st+=2,lt.push(ot.readUshort(it,st)),st+=2,lt.push(ot.readUshort(it,st)),st+=2}return lt},_e._lctf.getInterval=function(it,st){for(var ot=0;ot<it.length;ot+=3){var lt=it[ot],at=it[ot+1];if(it[ot+2],lt<=st&&st<=at)return ot}return-1},_e._lctf.readCoverage=function(it,st){var ot=_e._bin,lt={};lt.fmt=ot.readUshort(it,st),st+=2;var at=ot.readUshort(it,st);return st+=2,lt.fmt==1&&(lt.tab=ot.readUshorts(it,st,at)),lt.fmt==2&&(lt.tab=ot.readUshorts(it,st,3*at)),lt},_e._lctf.coverageIndex=function(it,st){var ot=it.tab;if(it.fmt==1)return ot.indexOf(st);if(it.fmt==2){var lt=_e._lctf.getInterval(ot,st);if(lt!=-1)return ot[lt+2]+(st-ot[lt])}return-1},_e._lctf.readFeatureList=function(it,st){var ot=_e._bin,lt=st,at=[],ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot.readASCII(it,st,4);st+=4;var dt=ot.readUshort(it,st);st+=2;var ft=_e._lctf.readFeatureTable(it,lt+dt);ft.tag=ht.trim(),at.push(ft)}return at},_e._lctf.readFeatureTable=function(it,st){var ot=_e._bin,lt=st,at={},ct=ot.readUshort(it,st);st+=2,ct>0&&(at.featureParams=lt+ct);var ut=ot.readUshort(it,st);st+=2,at.tab=[];for(var ht=0;ht<ut;ht++)at.tab.push(ot.readUshort(it,st+2*ht));return at},_e._lctf.readScriptList=function(it,st){var ot=_e._bin,lt=st,at={},ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot.readASCII(it,st,4);st+=4;var dt=ot.readUshort(it,st);st+=2,at[ht.trim()]=_e._lctf.readScriptTable(it,lt+dt)}return at},_e._lctf.readScriptTable=function(it,st){var ot=_e._bin,lt=st,at={},ct=ot.readUshort(it,st);st+=2,at.default=_e._lctf.readLangSysTable(it,lt+ct);var ut=ot.readUshort(it,st);st+=2;for(var ht=0;ht<ut;ht++){var dt=ot.readASCII(it,st,4);st+=4;var ft=ot.readUshort(it,st);st+=2,at[dt.trim()]=_e._lctf.readLangSysTable(it,lt+ft)}return at},_e._lctf.readLangSysTable=function(it,st){var ot=_e._bin,lt={};ot.readUshort(it,st),st+=2,lt.reqFeature=ot.readUshort(it,st),st+=2;var at=ot.readUshort(it,st);return st+=2,lt.features=ot.readUshorts(it,st,at),lt},_e.CFF={},_e.CFF.parse=function(it,st,ot){var lt=_e._bin;(it=new Uint8Array(it.buffer,st,ot))[st=0],it[++st],it[++st],it[++st],st++;var at=[];st=_e.CFF.readIndex(it,st,at);for(var ct=[],ut=0;ut<at.length-1;ut++)ct.push(lt.readASCII(it,st+at[ut],at[ut+1]-at[ut]));st+=at[at.length-1];var ht=[];st=_e.CFF.readIndex(it,st,ht);var dt=[];for(ut=0;ut<ht.length-1;ut++)dt.push(_e.CFF.readDict(it,st+ht[ut],st+ht[ut+1]));st+=ht[ht.length-1];var ft=dt[0],pt=[];st=_e.CFF.readIndex(it,st,pt);var mt=[];for(ut=0;ut<pt.length-1;ut++)mt.push(lt.readASCII(it,st+pt[ut],pt[ut+1]-pt[ut]));if(st+=pt[pt.length-1],_e.CFF.readSubrs(it,st,ft),ft.CharStrings){st=ft.CharStrings,pt=[],st=_e.CFF.readIndex(it,st,pt);var gt=[];for(ut=0;ut<pt.length-1;ut++)gt.push(lt.readBytes(it,st+pt[ut],pt[ut+1]-pt[ut]));ft.CharStrings=gt}if(ft.ROS){st=ft.FDArray;var vt=[];for(st=_e.CFF.readIndex(it,st,vt),ft.FDArray=[],ut=0;ut<vt.length-1;ut++){var At=_e.CFF.readDict(it,st+vt[ut],st+vt[ut+1]);_e.CFF._readFDict(it,At,mt),ft.FDArray.push(At)}st+=vt[vt.length-1],st=ft.FDSelect,ft.FDSelect=[];var yt=it[st];if(st++,yt!=3)throw yt;var xt=lt.readUshort(it,st);for(st+=2,ut=0;ut<xt+1;ut++)ft.FDSelect.push(lt.readUshort(it,st),it[st+2]),st+=3}return ft.Encoding&&(ft.Encoding=_e.CFF.readEncoding(it,ft.Encoding,ft.CharStrings.length)),ft.charset&&(ft.charset=_e.CFF.readCharset(it,ft.charset,ft.CharStrings.length)),_e.CFF._readFDict(it,ft,mt),ft},_e.CFF._readFDict=function(it,st,ot){var lt;for(var at in st.Private&&(lt=st.Private[1],st.Private=_e.CFF.readDict(it,lt,lt+st.Private[0]),st.Private.Subrs&&_e.CFF.readSubrs(it,lt+st.Private.Subrs,st.Private)),st)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(at)!=-1&&(st[at]=ot[st[at]-426+35])},_e.CFF.readSubrs=function(it,st,ot){var lt=_e._bin,at=[];st=_e.CFF.readIndex(it,st,at);var ct,ut=at.length;ct=ut<1240?107:ut<33900?1131:32768,ot.Bias=ct,ot.Subrs=[];for(var ht=0;ht<at.length-1;ht++)ot.Subrs.push(lt.readBytes(it,st+at[ht],at[ht+1]-at[ht]))},_e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],_e.CFF.glyphByUnicode=function(it,st){for(var ot=0;ot<it.charset.length;ot++)if(it.charset[ot]==st)return ot;return-1},_e.CFF.glyphBySE=function(it,st){return st<0||st>255?-1:_e.CFF.glyphByUnicode(it,_e.CFF.tableSE[st])},_e.CFF.readEncoding=function(it,st,ot){_e._bin;var lt=[".notdef"],at=it[st];if(st++,at!=0)throw"error: unknown encoding format: "+at;var ct=it[st];st++;for(var ut=0;ut<ct;ut++)lt.push(it[st+ut]);return lt},_e.CFF.readCharset=function(it,st,ot){var lt=_e._bin,at=[".notdef"],ct=it[st];if(st++,ct==0)for(var ut=0;ut<ot;ut++){var ht=lt.readUshort(it,st);st+=2,at.push(ht)}else{if(ct!=1&&ct!=2)throw"error: format: "+ct;for(;at.length<ot;){ht=lt.readUshort(it,st),st+=2;var dt=0;for(ct==1?(dt=it[st],st++):(dt=lt.readUshort(it,st),st+=2),ut=0;ut<=dt;ut++)at.push(ht),ht++}}return at},_e.CFF.readIndex=function(it,st,ot){var lt=_e._bin,at=lt.readUshort(it,st)+1,ct=it[st+=2];if(st++,ct==1)for(var ut=0;ut<at;ut++)ot.push(it[st+ut]);else if(ct==2)for(ut=0;ut<at;ut++)ot.push(lt.readUshort(it,st+2*ut));else if(ct==3)for(ut=0;ut<at;ut++)ot.push(16777215&lt.readUint(it,st+3*ut-1));else if(at!=1)throw"unsupported offset size: "+ct+", count: "+at;return(st+=at*ct)-1},_e.CFF.getCharString=function(it,st,ot){var lt=_e._bin,at=it[st],ct=it[st+1];it[st+2],it[st+3],it[st+4];var ut=1,ht=null,dt=null;at<=20&&(ht=at,ut=1),at==12&&(ht=100*at+ct,ut=2),21<=at&&at<=27&&(ht=at,ut=1),at==28&&(dt=lt.readShort(it,st+1),ut=3),29<=at&&at<=31&&(ht=at,ut=1),32<=at&&at<=246&&(dt=at-139,ut=1),247<=at&&at<=250&&(dt=256*(at-247)+ct+108,ut=2),251<=at&&at<=254&&(dt=256*-(at-251)-ct-108,ut=2),at==255&&(dt=lt.readInt(it,st+1)/65535,ut=5),ot.val=dt??"o"+ht,ot.size=ut},_e.CFF.readCharString=function(it,st,ot){for(var lt=st+ot,at=_e._bin,ct=[];st<lt;){var ut=it[st],ht=it[st+1];it[st+2],it[st+3],it[st+4];var dt=1,ft=null,pt=null;ut<=20&&(ft=ut,dt=1),ut==12&&(ft=100*ut+ht,dt=2),ut!=19&&ut!=20||(ft=ut,dt=2),21<=ut&&ut<=27&&(ft=ut,dt=1),ut==28&&(pt=at.readShort(it,st+1),dt=3),29<=ut&&ut<=31&&(ft=ut,dt=1),32<=ut&&ut<=246&&(pt=ut-139,dt=1),247<=ut&&ut<=250&&(pt=256*(ut-247)+ht+108,dt=2),251<=ut&&ut<=254&&(pt=256*-(ut-251)-ht-108,dt=2),ut==255&&(pt=at.readInt(it,st+1)/65535,dt=5),ct.push(pt??"o"+ft),st+=dt}return ct},_e.CFF.readDict=function(it,st,ot){for(var lt=_e._bin,at={},ct=[];st<ot;){var ut=it[st],ht=it[st+1];it[st+2],it[st+3],it[st+4];var dt=1,ft=null,pt=null;if(ut==28&&(pt=lt.readShort(it,st+1),dt=3),ut==29&&(pt=lt.readInt(it,st+1),dt=5),32<=ut&&ut<=246&&(pt=ut-139,dt=1),247<=ut&&ut<=250&&(pt=256*(ut-247)+ht+108,dt=2),251<=ut&&ut<=254&&(pt=256*-(ut-251)-ht-108,dt=2),ut==255)throw pt=lt.readInt(it,st+1)/65535,dt=5,"unknown number";if(ut==30){var mt=[];for(dt=1;;){var gt=it[st+dt];dt++;var vt=gt>>4,At=15&gt;if(vt!=15&&mt.push(vt),At!=15&&mt.push(At),At==15)break}for(var yt="",xt=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],_t=0;_t<mt.length;_t++)yt+=xt[mt[_t]];pt=parseFloat(yt)}ut<=21&&(ft=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][ut],dt=1,ut==12&&(ft=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][ht],dt=2)),ft!=null?(at[ft]=ct.length==1?ct[0]:ct,ct=[]):ct.push(pt),st+=dt}return at},_e.cmap={},_e.cmap.parse=function(it,st,ot){it=new Uint8Array(it.buffer,st,ot),st=0;var lt=_e._bin,at={};lt.readUshort(it,st),st+=2;var ct=lt.readUshort(it,st);st+=2;var ut=[];at.tables=[];for(var ht=0;ht<ct;ht++){var dt=lt.readUshort(it,st);st+=2;var ft=lt.readUshort(it,st);st+=2;var pt=lt.readUint(it,st);st+=4;var mt="p"+dt+"e"+ft,gt=ut.indexOf(pt);if(gt==-1){var vt;gt=at.tables.length,ut.push(pt);var At=lt.readUshort(it,pt);At==0?vt=_e.cmap.parse0(it,pt):At==4?vt=_e.cmap.parse4(it,pt):At==6?vt=_e.cmap.parse6(it,pt):At==12?vt=_e.cmap.parse12(it,pt):console.debug("unknown format: "+At,dt,ft,pt),at.tables.push(vt)}if(at[mt]!=null)throw"multiple tables for one platform+encoding";at[mt]=gt}return at},_e.cmap.parse0=function(it,st){var ot=_e._bin,lt={};lt.format=ot.readUshort(it,st),st+=2;var at=ot.readUshort(it,st);st+=2,ot.readUshort(it,st),st+=2,lt.map=[];for(var ct=0;ct<at-6;ct++)lt.map.push(it[st+ct]);return lt},_e.cmap.parse4=function(it,st){var ot=_e._bin,lt=st,at={};at.format=ot.readUshort(it,st),st+=2;var ct=ot.readUshort(it,st);st+=2,ot.readUshort(it,st),st+=2;var ut=ot.readUshort(it,st);st+=2;var ht=ut/2;at.searchRange=ot.readUshort(it,st),st+=2,at.entrySelector=ot.readUshort(it,st),st+=2,at.rangeShift=ot.readUshort(it,st),st+=2,at.endCount=ot.readUshorts(it,st,ht),st+=2*ht,st+=2,at.startCount=ot.readUshorts(it,st,ht),st+=2*ht,at.idDelta=[];for(var dt=0;dt<ht;dt++)at.idDelta.push(ot.readShort(it,st)),st+=2;for(at.idRangeOffset=ot.readUshorts(it,st,ht),st+=2*ht,at.glyphIdArray=[];st<lt+ct;)at.glyphIdArray.push(ot.readUshort(it,st)),st+=2;return at},_e.cmap.parse6=function(it,st){var ot=_e._bin,lt={};lt.format=ot.readUshort(it,st),st+=2,ot.readUshort(it,st),st+=2,ot.readUshort(it,st),st+=2,lt.firstCode=ot.readUshort(it,st),st+=2;var at=ot.readUshort(it,st);st+=2,lt.glyphIdArray=[];for(var ct=0;ct<at;ct++)lt.glyphIdArray.push(ot.readUshort(it,st)),st+=2;return lt},_e.cmap.parse12=function(it,st){var ot=_e._bin,lt={};lt.format=ot.readUshort(it,st),st+=2,st+=2,ot.readUint(it,st),st+=4,ot.readUint(it,st),st+=4;var at=ot.readUint(it,st);st+=4,lt.groups=[];for(var ct=0;ct<at;ct++){var ut=st+12*ct,ht=ot.readUint(it,ut+0),dt=ot.readUint(it,ut+4),ft=ot.readUint(it,ut+8);lt.groups.push([ht,dt,ft])}return lt},_e.glyf={},_e.glyf.parse=function(it,st,ot,lt){for(var at=[],ct=0;ct<lt.maxp.numGlyphs;ct++)at.push(null);return at},_e.glyf._parseGlyf=function(it,st){var ot=_e._bin,lt=it._data,at=_e._tabOffset(lt,"glyf",it._offset)+it.loca[st];if(it.loca[st]==it.loca[st+1])return null;var ct={};if(ct.noc=ot.readShort(lt,at),at+=2,ct.xMin=ot.readShort(lt,at),at+=2,ct.yMin=ot.readShort(lt,at),at+=2,ct.xMax=ot.readShort(lt,at),at+=2,ct.yMax=ot.readShort(lt,at),at+=2,ct.xMin>=ct.xMax||ct.yMin>=ct.yMax)return null;if(ct.noc>0){ct.endPts=[];for(var ut=0;ut<ct.noc;ut++)ct.endPts.push(ot.readUshort(lt,at)),at+=2;var ht=ot.readUshort(lt,at);if(at+=2,lt.length-at<ht)return null;ct.instructions=ot.readBytes(lt,at,ht),at+=ht;var dt=ct.endPts[ct.noc-1]+1;for(ct.flags=[],ut=0;ut<dt;ut++){var ft=lt[at];if(at++,ct.flags.push(ft),(8&ft)!=0){var pt=lt[at];at++;for(var mt=0;mt<pt;mt++)ct.flags.push(ft),ut++}}for(ct.xs=[],ut=0;ut<dt;ut++){var gt=(2&ct.flags[ut])!=0,vt=(16&ct.flags[ut])!=0;gt?(ct.xs.push(vt?lt[at]:-lt[at]),at++):vt?ct.xs.push(0):(ct.xs.push(ot.readShort(lt,at)),at+=2)}for(ct.ys=[],ut=0;ut<dt;ut++)gt=(4&ct.flags[ut])!=0,vt=(32&ct.flags[ut])!=0,gt?(ct.ys.push(vt?lt[at]:-lt[at]),at++):vt?ct.ys.push(0):(ct.ys.push(ot.readShort(lt,at)),at+=2);var At=0,yt=0;for(ut=0;ut<dt;ut++)At+=ct.xs[ut],yt+=ct.ys[ut],ct.xs[ut]=At,ct.ys[ut]=yt}else{var xt;ct.parts=[];do{xt=ot.readUshort(lt,at),at+=2;var _t={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(ct.parts.push(_t),_t.glyphIndex=ot.readUshort(lt,at),at+=2,1&xt){var Et=ot.readShort(lt,at);at+=2;var bt=ot.readShort(lt,at);at+=2}else Et=ot.readInt8(lt,at),at++,bt=ot.readInt8(lt,at),at++;2&xt?(_t.m.tx=Et,_t.m.ty=bt):(_t.p1=Et,_t.p2=bt),8&xt?(_t.m.a=_t.m.d=ot.readF2dot14(lt,at),at+=2):64&xt?(_t.m.a=ot.readF2dot14(lt,at),at+=2,_t.m.d=ot.readF2dot14(lt,at),at+=2):128&xt&&(_t.m.a=ot.readF2dot14(lt,at),at+=2,_t.m.b=ot.readF2dot14(lt,at),at+=2,_t.m.c=ot.readF2dot14(lt,at),at+=2,_t.m.d=ot.readF2dot14(lt,at),at+=2)}while(32&xt);if(256&xt){var wt=ot.readUshort(lt,at);for(at+=2,ct.instr=[],ut=0;ut<wt;ut++)ct.instr.push(lt[at]),at++}}return ct},_e.GPOS={},_e.GPOS.parse=function(it,st,ot,lt){return _e._lctf.parse(it,st,ot,lt,_e.GPOS.subt)},_e.GPOS.subt=function(it,st,ot,lt){var at=_e._bin,ct=ot,ut={};if(ut.fmt=at.readUshort(it,ot),ot+=2,st==1||st==2||st==3||st==7||st==8&&ut.fmt<=2){var ht=at.readUshort(it,ot);ot+=2,ut.coverage=_e._lctf.readCoverage(it,ht+ct)}if(st==1&&ut.fmt==1){var dt=at.readUshort(it,ot);ot+=2;var ft=_e._lctf.numOfOnes(dt);dt!=0&&(ut.pos=_e.GPOS.readValueRecord(it,ot,dt))}else if(st==2&&ut.fmt>=1&&ut.fmt<=2){dt=at.readUshort(it,ot),ot+=2;var pt=at.readUshort(it,ot);ot+=2,ft=_e._lctf.numOfOnes(dt);var mt=_e._lctf.numOfOnes(pt);if(ut.fmt==1){ut.pairsets=[];var gt=at.readUshort(it,ot);ot+=2;for(var vt=0;vt<gt;vt++){var At=ct+at.readUshort(it,ot);ot+=2;var yt=at.readUshort(it,At);At+=2;for(var xt=[],_t=0;_t<yt;_t++){var Et=at.readUshort(it,At);At+=2,dt!=0&&(It=_e.GPOS.readValueRecord(it,At,dt),At+=2*ft),pt!=0&&(Ot=_e.GPOS.readValueRecord(it,At,pt),At+=2*mt),xt.push({gid2:Et,val1:It,val2:Ot})}ut.pairsets.push(xt)}}if(ut.fmt==2){var bt=at.readUshort(it,ot);ot+=2;var wt=at.readUshort(it,ot);ot+=2;var Tt=at.readUshort(it,ot);ot+=2;var Mt=at.readUshort(it,ot);for(ot+=2,ut.classDef1=_e._lctf.readClassDef(it,ct+bt),ut.classDef2=_e._lctf.readClassDef(it,ct+wt),ut.matrix=[],vt=0;vt<Tt;vt++){var Pt=[];for(_t=0;_t<Mt;_t++){var It=null,Ot=null;dt!=0&&(It=_e.GPOS.readValueRecord(it,ot,dt),ot+=2*ft),pt!=0&&(Ot=_e.GPOS.readValueRecord(it,ot,pt),ot+=2*mt),Pt.push({val1:It,val2:Ot})}ut.matrix.push(Pt)}}}else{if(st==9&&ut.fmt==1){var Bt=at.readUshort(it,ot);ot+=2;var Ut=at.readUint(it,ot);if(ot+=4,lt.ltype==9)lt.ltype=Bt;else if(lt.ltype!=Bt)throw"invalid extension substitution";return _e.GPOS.subt(it,lt.ltype,ct+Ut)}console.debug("unsupported GPOS table LookupType",st,"format",ut.fmt)}return ut},_e.GPOS.readValueRecord=function(it,st,ot){var lt=_e._bin,at=[];return at.push(1&ot?lt.readShort(it,st):0),st+=1&ot?2:0,at.push(2&ot?lt.readShort(it,st):0),st+=2&ot?2:0,at.push(4&ot?lt.readShort(it,st):0),st+=4&ot?2:0,at.push(8&ot?lt.readShort(it,st):0),st+=8&ot?2:0,at},_e.GSUB={},_e.GSUB.parse=function(it,st,ot,lt){return _e._lctf.parse(it,st,ot,lt,_e.GSUB.subt)},_e.GSUB.subt=function(it,st,ot,lt){var at=_e._bin,ct=ot,ut={};if(ut.fmt=at.readUshort(it,ot),ot+=2,st!=1&&st!=4&&st!=5&&st!=6)return null;if(st==1||st==4||st==5&&ut.fmt<=2||st==6&&ut.fmt<=2){var ht=at.readUshort(it,ot);ot+=2,ut.coverage=_e._lctf.readCoverage(it,ct+ht)}if(st==1&&ut.fmt>=1&&ut.fmt<=2){if(ut.fmt==1)ut.delta=at.readShort(it,ot),ot+=2;else if(ut.fmt==2){var dt=at.readUshort(it,ot);ot+=2,ut.newg=at.readUshorts(it,ot,dt),ot+=2*ut.newg.length}}else if(st==4){ut.vals=[],dt=at.readUshort(it,ot),ot+=2;for(var ft=0;ft<dt;ft++){var pt=at.readUshort(it,ot);ot+=2,ut.vals.push(_e.GSUB.readLigatureSet(it,ct+pt))}}else if(st==5&&ut.fmt==2){if(ut.fmt==2){var mt=at.readUshort(it,ot);ot+=2,ut.cDef=_e._lctf.readClassDef(it,ct+mt),ut.scset=[];var gt=at.readUshort(it,ot);for(ot+=2,ft=0;ft<gt;ft++){var vt=at.readUshort(it,ot);ot+=2,ut.scset.push(vt==0?null:_e.GSUB.readSubClassSet(it,ct+vt))}}}else if(st==6&&ut.fmt==3){if(ut.fmt==3){for(ft=0;ft<3;ft++){dt=at.readUshort(it,ot),ot+=2;for(var At=[],yt=0;yt<dt;yt++)At.push(_e._lctf.readCoverage(it,ct+at.readUshort(it,ot+2*yt)));ot+=2*dt,ft==0&&(ut.backCvg=At),ft==1&&(ut.inptCvg=At),ft==2&&(ut.ahedCvg=At)}dt=at.readUshort(it,ot),ot+=2,ut.lookupRec=_e.GSUB.readSubstLookupRecords(it,ot,dt)}}else{if(st==7&&ut.fmt==1){var xt=at.readUshort(it,ot);ot+=2;var _t=at.readUint(it,ot);if(ot+=4,lt.ltype==9)lt.ltype=xt;else if(lt.ltype!=xt)throw"invalid extension substitution";return _e.GSUB.subt(it,lt.ltype,ct+_t)}console.debug("unsupported GSUB table LookupType",st,"format",ut.fmt)}return ut},_e.GSUB.readSubClassSet=function(it,st){var ot=_e._bin.readUshort,lt=st,at=[],ct=ot(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot(it,st);st+=2,at.push(_e.GSUB.readSubClassRule(it,lt+ht))}return at},_e.GSUB.readSubClassRule=function(it,st){var ot=_e._bin.readUshort,lt={},at=ot(it,st),ct=ot(it,st+=2);st+=2,lt.input=[];for(var ut=0;ut<at-1;ut++)lt.input.push(ot(it,st)),st+=2;return lt.substLookupRecords=_e.GSUB.readSubstLookupRecords(it,st,ct),lt},_e.GSUB.readSubstLookupRecords=function(it,st,ot){for(var lt=_e._bin.readUshort,at=[],ct=0;ct<ot;ct++)at.push(lt(it,st),lt(it,st+2)),st+=4;return at},_e.GSUB.readChainSubClassSet=function(it,st){var ot=_e._bin,lt=st,at=[],ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot.readUshort(it,st);st+=2,at.push(_e.GSUB.readChainSubClassRule(it,lt+ht))}return at},_e.GSUB.readChainSubClassRule=function(it,st){for(var ot=_e._bin,lt={},at=["backtrack","input","lookahead"],ct=0;ct<at.length;ct++){var ut=ot.readUshort(it,st);st+=2,ct==1&&ut--,lt[at[ct]]=ot.readUshorts(it,st,ut),st+=2*lt[at[ct]].length}return ut=ot.readUshort(it,st),st+=2,lt.subst=ot.readUshorts(it,st,2*ut),st+=2*lt.subst.length,lt},_e.GSUB.readLigatureSet=function(it,st){var ot=_e._bin,lt=st,at=[],ct=ot.readUshort(it,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=ot.readUshort(it,st);st+=2,at.push(_e.GSUB.readLigature(it,lt+ht))}return at},_e.GSUB.readLigature=function(it,st){var ot=_e._bin,lt={chain:[]};lt.nglyph=ot.readUshort(it,st),st+=2;var at=ot.readUshort(it,st);st+=2;for(var ct=0;ct<at-1;ct++)lt.chain.push(ot.readUshort(it,st)),st+=2;return lt},_e.head={},_e.head.parse=function(it,st,ot){var lt=_e._bin,at={};return lt.readFixed(it,st),st+=4,at.fontRevision=lt.readFixed(it,st),st+=4,lt.readUint(it,st),st+=4,lt.readUint(it,st),st+=4,at.flags=lt.readUshort(it,st),st+=2,at.unitsPerEm=lt.readUshort(it,st),st+=2,at.created=lt.readUint64(it,st),st+=8,at.modified=lt.readUint64(it,st),st+=8,at.xMin=lt.readShort(it,st),st+=2,at.yMin=lt.readShort(it,st),st+=2,at.xMax=lt.readShort(it,st),st+=2,at.yMax=lt.readShort(it,st),st+=2,at.macStyle=lt.readUshort(it,st),st+=2,at.lowestRecPPEM=lt.readUshort(it,st),st+=2,at.fontDirectionHint=lt.readShort(it,st),st+=2,at.indexToLocFormat=lt.readShort(it,st),st+=2,at.glyphDataFormat=lt.readShort(it,st),st+=2,at},_e.hhea={},_e.hhea.parse=function(it,st,ot){var lt=_e._bin,at={};return lt.readFixed(it,st),st+=4,at.ascender=lt.readShort(it,st),st+=2,at.descender=lt.readShort(it,st),st+=2,at.lineGap=lt.readShort(it,st),st+=2,at.advanceWidthMax=lt.readUshort(it,st),st+=2,at.minLeftSideBearing=lt.readShort(it,st),st+=2,at.minRightSideBearing=lt.readShort(it,st),st+=2,at.xMaxExtent=lt.readShort(it,st),st+=2,at.caretSlopeRise=lt.readShort(it,st),st+=2,at.caretSlopeRun=lt.readShort(it,st),st+=2,at.caretOffset=lt.readShort(it,st),st+=2,st+=8,at.metricDataFormat=lt.readShort(it,st),st+=2,at.numberOfHMetrics=lt.readUshort(it,st),st+=2,at},_e.hmtx={},_e.hmtx.parse=function(it,st,ot,lt){for(var at=_e._bin,ct={aWidth:[],lsBearing:[]},ut=0,ht=0,dt=0;dt<lt.maxp.numGlyphs;dt++)dt<lt.hhea.numberOfHMetrics&&(ut=at.readUshort(it,st),st+=2,ht=at.readShort(it,st),st+=2),ct.aWidth.push(ut),ct.lsBearing.push(ht);return ct},_e.kern={},_e.kern.parse=function(it,st,ot,lt){var at=_e._bin,ct=at.readUshort(it,st);if(st+=2,ct==1)return _e.kern.parseV1(it,st-2,ot,lt);var ut=at.readUshort(it,st);st+=2;for(var ht={glyph1:[],rval:[]},dt=0;dt<ut;dt++){st+=2,ot=at.readUshort(it,st),st+=2;var ft=at.readUshort(it,st);st+=2;var pt=ft>>>8;if((pt&=15)!=0)throw"unknown kern table format: "+pt;st=_e.kern.readFormat0(it,st,ht)}return ht},_e.kern.parseV1=function(it,st,ot,lt){var at=_e._bin;at.readFixed(it,st),st+=4;var ct=at.readUint(it,st);st+=4;for(var ut={glyph1:[],rval:[]},ht=0;ht<ct;ht++){at.readUint(it,st),st+=4;var dt=at.readUshort(it,st);st+=2,at.readUshort(it,st),st+=2;var ft=dt>>>8;if((ft&=15)!=0)throw"unknown kern table format: "+ft;st=_e.kern.readFormat0(it,st,ut)}return ut},_e.kern.readFormat0=function(it,st,ot){var lt=_e._bin,at=-1,ct=lt.readUshort(it,st);st+=2,lt.readUshort(it,st),st+=2,lt.readUshort(it,st),st+=2,lt.readUshort(it,st),st+=2;for(var ut=0;ut<ct;ut++){var ht=lt.readUshort(it,st);st+=2;var dt=lt.readUshort(it,st);st+=2;var ft=lt.readShort(it,st);st+=2,ht!=at&&(ot.glyph1.push(ht),ot.rval.push({glyph2:[],vals:[]}));var pt=ot.rval[ot.rval.length-1];pt.glyph2.push(dt),pt.vals.push(ft),at=ht}return st},_e.loca={},_e.loca.parse=function(it,st,ot,lt){var at=_e._bin,ct=[],ut=lt.head.indexToLocFormat,ht=lt.maxp.numGlyphs+1;if(ut==0)for(var dt=0;dt<ht;dt++)ct.push(at.readUshort(it,st+(dt<<1))<<1);if(ut==1)for(dt=0;dt<ht;dt++)ct.push(at.readUint(it,st+(dt<<2)));return ct},_e.maxp={},_e.maxp.parse=function(it,st,ot){var lt=_e._bin,at={},ct=lt.readUint(it,st);return st+=4,at.numGlyphs=lt.readUshort(it,st),st+=2,ct==65536&&(at.maxPoints=lt.readUshort(it,st),st+=2,at.maxContours=lt.readUshort(it,st),st+=2,at.maxCompositePoints=lt.readUshort(it,st),st+=2,at.maxCompositeContours=lt.readUshort(it,st),st+=2,at.maxZones=lt.readUshort(it,st),st+=2,at.maxTwilightPoints=lt.readUshort(it,st),st+=2,at.maxStorage=lt.readUshort(it,st),st+=2,at.maxFunctionDefs=lt.readUshort(it,st),st+=2,at.maxInstructionDefs=lt.readUshort(it,st),st+=2,at.maxStackElements=lt.readUshort(it,st),st+=2,at.maxSizeOfInstructions=lt.readUshort(it,st),st+=2,at.maxComponentElements=lt.readUshort(it,st),st+=2,at.maxComponentDepth=lt.readUshort(it,st),st+=2),at},_e.name={},_e.name.parse=function(it,st,ot){var lt=_e._bin,at={};lt.readUshort(it,st),st+=2;var ct=lt.readUshort(it,st);st+=2,lt.readUshort(it,st);for(var ut,ht=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],dt=st+=2,ft=0;ft<ct;ft++){var pt=lt.readUshort(it,st);st+=2;var mt=lt.readUshort(it,st);st+=2;var gt=lt.readUshort(it,st);st+=2;var vt=lt.readUshort(it,st);st+=2;var At=lt.readUshort(it,st);st+=2;var yt=lt.readUshort(it,st);st+=2;var xt,_t=ht[vt],Et=dt+12*ct+yt;if(pt==0)xt=lt.readUnicode(it,Et,At/2);else if(pt==3&&mt==0)xt=lt.readUnicode(it,Et,At/2);else if(mt==0)xt=lt.readASCII(it,Et,At);else if(mt==1)xt=lt.readUnicode(it,Et,At/2);else if(mt==3)xt=lt.readUnicode(it,Et,At/2);else{if(pt!=1)throw"unknown encoding "+mt+", platformID: "+pt;xt=lt.readASCII(it,Et,At),console.debug("reading unknown MAC encoding "+mt+" as ASCII")}var bt="p"+pt+","+gt.toString(16);at[bt]==null&&(at[bt]={}),at[bt][_t!==void 0?_t:vt]=xt,at[bt]._lang=gt}for(var wt in at)if(at[wt].postScriptName!=null&&at[wt]._lang==1033)return at[wt];for(var wt in at)if(at[wt].postScriptName!=null&&at[wt]._lang==0)return at[wt];for(var wt in at)if(at[wt].postScriptName!=null&&at[wt]._lang==3084)return at[wt];for(var wt in at)if(at[wt].postScriptName!=null)return at[wt];for(var wt in at){ut=wt;break}return console.debug("returning name table with languageID "+at[ut]._lang),at[ut]},_e["OS/2"]={},_e["OS/2"].parse=function(it,st,ot){var lt=_e._bin.readUshort(it,st);st+=2;var at={};if(lt==0)_e["OS/2"].version0(it,st,at);else if(lt==1)_e["OS/2"].version1(it,st,at);else if(lt==2||lt==3||lt==4)_e["OS/2"].version2(it,st,at);else{if(lt!=5)throw"unknown OS/2 table version: "+lt;_e["OS/2"].version5(it,st,at)}return at},_e["OS/2"].version0=function(it,st,ot){var lt=_e._bin;return ot.xAvgCharWidth=lt.readShort(it,st),st+=2,ot.usWeightClass=lt.readUshort(it,st),st+=2,ot.usWidthClass=lt.readUshort(it,st),st+=2,ot.fsType=lt.readUshort(it,st),st+=2,ot.ySubscriptXSize=lt.readShort(it,st),st+=2,ot.ySubscriptYSize=lt.readShort(it,st),st+=2,ot.ySubscriptXOffset=lt.readShort(it,st),st+=2,ot.ySubscriptYOffset=lt.readShort(it,st),st+=2,ot.ySuperscriptXSize=lt.readShort(it,st),st+=2,ot.ySuperscriptYSize=lt.readShort(it,st),st+=2,ot.ySuperscriptXOffset=lt.readShort(it,st),st+=2,ot.ySuperscriptYOffset=lt.readShort(it,st),st+=2,ot.yStrikeoutSize=lt.readShort(it,st),st+=2,ot.yStrikeoutPosition=lt.readShort(it,st),st+=2,ot.sFamilyClass=lt.readShort(it,st),st+=2,ot.panose=lt.readBytes(it,st,10),st+=10,ot.ulUnicodeRange1=lt.readUint(it,st),st+=4,ot.ulUnicodeRange2=lt.readUint(it,st),st+=4,ot.ulUnicodeRange3=lt.readUint(it,st),st+=4,ot.ulUnicodeRange4=lt.readUint(it,st),st+=4,ot.achVendID=[lt.readInt8(it,st),lt.readInt8(it,st+1),lt.readInt8(it,st+2),lt.readInt8(it,st+3)],st+=4,ot.fsSelection=lt.readUshort(it,st),st+=2,ot.usFirstCharIndex=lt.readUshort(it,st),st+=2,ot.usLastCharIndex=lt.readUshort(it,st),st+=2,ot.sTypoAscender=lt.readShort(it,st),st+=2,ot.sTypoDescender=lt.readShort(it,st),st+=2,ot.sTypoLineGap=lt.readShort(it,st),st+=2,ot.usWinAscent=lt.readUshort(it,st),st+=2,ot.usWinDescent=lt.readUshort(it,st),st+=2},_e["OS/2"].version1=function(it,st,ot){var lt=_e._bin;return st=_e["OS/2"].version0(it,st,ot),ot.ulCodePageRange1=lt.readUint(it,st),st+=4,ot.ulCodePageRange2=lt.readUint(it,st),st+=4},_e["OS/2"].version2=function(it,st,ot){var lt=_e._bin;return st=_e["OS/2"].version1(it,st,ot),ot.sxHeight=lt.readShort(it,st),st+=2,ot.sCapHeight=lt.readShort(it,st),st+=2,ot.usDefault=lt.readUshort(it,st),st+=2,ot.usBreak=lt.readUshort(it,st),st+=2,ot.usMaxContext=lt.readUshort(it,st),st+=2},_e["OS/2"].version5=function(it,st,ot){var lt=_e._bin;return st=_e["OS/2"].version2(it,st,ot),ot.usLowerOpticalPointSize=lt.readUshort(it,st),st+=2,ot.usUpperOpticalPointSize=lt.readUshort(it,st),st+=2},_e.post={},_e.post.parse=function(it,st,ot){var lt=_e._bin,at={};return at.version=lt.readFixed(it,st),st+=4,at.italicAngle=lt.readFixed(it,st),st+=4,at.underlinePosition=lt.readShort(it,st),st+=2,at.underlineThickness=lt.readShort(it,st),st+=2,at},_e==null&&(_e={}),_e.U==null&&(_e.U={}),_e.U.codeToGlyph=function(it,st){var ot=it.cmap,lt=-1;if(ot.p0e4!=null?lt=ot.p0e4:ot.p3e1!=null?lt=ot.p3e1:ot.p1e0!=null?lt=ot.p1e0:ot.p0e3!=null&&(lt=ot.p0e3),lt==-1)throw"no familiar platform and encoding!";var at=ot.tables[lt];if(at.format==0)return st>=at.map.length?0:at.map[st];if(at.format==4){for(var ct=-1,ut=0;ut<at.endCount.length;ut++)if(st<=at.endCount[ut]){ct=ut;break}return ct==-1||at.startCount[ct]>st?0:65535&(at.idRangeOffset[ct]!=0?at.glyphIdArray[st-at.startCount[ct]+(at.idRangeOffset[ct]>>1)-(at.idRangeOffset.length-ct)]:st+at.idDelta[ct])}if(at.format==12){if(st>at.groups[at.groups.length-1][1])return 0;for(ut=0;ut<at.groups.length;ut++){var ht=at.groups[ut];if(ht[0]<=st&&st<=ht[1])return ht[2]+(st-ht[0])}return 0}throw"unknown cmap table format "+at.format},_e.U.glyphToPath=function(it,st){var ot={cmds:[],crds:[]};if(it.SVG&&it.SVG.entries[st]){var lt=it.SVG.entries[st];return lt==null?ot:(typeof lt=="string"&&(lt=_e.SVG.toPath(lt),it.SVG.entries[st]=lt),lt)}if(it.CFF){var at={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:it.CFF.Private?it.CFF.Private.defaultWidthX:0,open:!1},ct=it.CFF,ut=it.CFF.Private;if(ct.ROS){for(var ht=0;ct.FDSelect[ht+2]<=st;)ht+=2;ut=ct.FDArray[ct.FDSelect[ht+1]].Private}_e.U._drawCFF(it.CFF.CharStrings[st],at,ct,ut,ot)}else it.glyf&&_e.U._drawGlyf(st,it,ot);return ot},_e.U._drawGlyf=function(it,st,ot){var lt=st.glyf[it];lt==null&&(lt=st.glyf[it]=_e.glyf._parseGlyf(st,it)),lt!=null&&(lt.noc>-1?_e.U._simpleGlyph(lt,ot):_e.U._compoGlyph(lt,st,ot))},_e.U._simpleGlyph=function(it,st){for(var ot=0;ot<it.noc;ot++){for(var lt=ot==0?0:it.endPts[ot-1]+1,at=it.endPts[ot],ct=lt;ct<=at;ct++){var ut=ct==lt?at:ct-1,ht=ct==at?lt:ct+1,dt=1&it.flags[ct],ft=1&it.flags[ut],pt=1&it.flags[ht],mt=it.xs[ct],gt=it.ys[ct];if(ct==lt)if(dt){if(!ft){_e.U.P.moveTo(st,mt,gt);continue}_e.U.P.moveTo(st,it.xs[ut],it.ys[ut])}else ft?_e.U.P.moveTo(st,it.xs[ut],it.ys[ut]):_e.U.P.moveTo(st,(it.xs[ut]+mt)/2,(it.ys[ut]+gt)/2);dt?ft&&_e.U.P.lineTo(st,mt,gt):pt?_e.U.P.qcurveTo(st,mt,gt,it.xs[ht],it.ys[ht]):_e.U.P.qcurveTo(st,mt,gt,(mt+it.xs[ht])/2,(gt+it.ys[ht])/2)}_e.U.P.closePath(st)}},_e.U._compoGlyph=function(it,st,ot){for(var lt=0;lt<it.parts.length;lt++){var at={cmds:[],crds:[]},ct=it.parts[lt];_e.U._drawGlyf(ct.glyphIndex,st,at);for(var ut=ct.m,ht=0;ht<at.crds.length;ht+=2){var dt=at.crds[ht],ft=at.crds[ht+1];ot.crds.push(dt*ut.a+ft*ut.b+ut.tx),ot.crds.push(dt*ut.c+ft*ut.d+ut.ty)}for(ht=0;ht<at.cmds.length;ht++)ot.cmds.push(at.cmds[ht])}},_e.U._getGlyphClass=function(it,st){var ot=_e._lctf.getInterval(st,it);return ot==-1?0:st[ot+2]},_e.U.getPairAdjustment=function(it,st,ot){var lt=!1;if(it.GPOS)for(var at=it.GPOS,ct=at.lookupList,ut=at.featureList,ht=[],dt=0;dt<ut.length;dt++){var ft=ut[dt];if(ft.tag=="kern"){lt=!0;for(var pt=0;pt<ft.tab.length;pt++)if(!ht[ft.tab[pt]]){ht[ft.tab[pt]]=!0;for(var mt=ct[ft.tab[pt]],gt=0;gt<mt.tabs.length;gt++)if(mt.tabs[gt]!=null){var vt,At=mt.tabs[gt];if((!At.coverage||(vt=_e._lctf.coverageIndex(At.coverage,st))!=-1)&&mt.ltype!=1){if(mt.ltype==2){var yt=null;if(At.fmt==1){var xt=At.pairsets[vt];for(dt=0;dt<xt.length;dt++)xt[dt].gid2==ot&&(yt=xt[dt])}else if(At.fmt==2){var _t=_e.U._getGlyphClass(st,At.classDef1),Et=_e.U._getGlyphClass(ot,At.classDef2);yt=At.matrix[_t][Et]}if(yt){var bt=0;return yt.val1&&yt.val1[2]&&(bt+=yt.val1[2]),yt.val2&&yt.val2[0]&&(bt+=yt.val2[0]),bt}}}}}}}if(it.kern&&!lt){var wt=it.kern.glyph1.indexOf(st);if(wt!=-1){var Tt=it.kern.rval[wt].glyph2.indexOf(ot);if(Tt!=-1)return it.kern.rval[wt].vals[Tt]}}return 0},_e.U._applySubs=function(it,st,ot,lt){for(var at=it.length-st-1,ct=0;ct<ot.tabs.length;ct++)if(ot.tabs[ct]!=null){var ut,ht=ot.tabs[ct];if(!ht.coverage||(ut=_e._lctf.coverageIndex(ht.coverage,it[st]))!=-1){if(ot.ltype==1)it[st],ht.fmt==1?it[st]=it[st]+ht.delta:it[st]=ht.newg[ut];else if(ot.ltype==4)for(var dt=ht.vals[ut],ft=0;ft<dt.length;ft++){var pt=dt[ft],mt=pt.chain.length;if(!(mt>at)){for(var gt=!0,vt=0,At=0;At<mt;At++){for(;it[st+vt+(1+At)]==-1;)vt++;pt.chain[At]!=it[st+vt+(1+At)]&&(gt=!1)}if(gt){for(it[st]=pt.nglyph,At=0;At<mt+vt;At++)it[st+At+1]=-1;break}}}else if(ot.ltype==5&&ht.fmt==2)for(var yt=_e._lctf.getInterval(ht.cDef,it[st]),xt=ht.cDef[yt+2],_t=ht.scset[xt],Et=0;Et<_t.length;Et++){var bt=_t[Et],wt=bt.input;if(!(wt.length>at)){for(gt=!0,At=0;At<wt.length;At++){var Tt=_e._lctf.getInterval(ht.cDef,it[st+1+At]);if(yt==-1&&ht.cDef[Tt+2]!=wt[At]){gt=!1;break}}if(gt){var Mt=bt.substLookupRecords;for(ft=0;ft<Mt.length;ft+=2)Mt[ft],Mt[ft+1]}}}else if(ot.ltype==6&&ht.fmt==3){if(!_e.U._glsCovered(it,ht.backCvg,st-ht.backCvg.length)||!_e.U._glsCovered(it,ht.inptCvg,st)||!_e.U._glsCovered(it,ht.ahedCvg,st+ht.inptCvg.length))continue;var Pt=ht.lookupRec;for(Et=0;Et<Pt.length;Et+=2){yt=Pt[Et];var It=lt[Pt[Et+1]];_e.U._applySubs(it,st+yt,It,lt)}}}}},_e.U._glsCovered=function(it,st,ot){for(var lt=0;lt<st.length;lt++)if(_e._lctf.coverageIndex(st[lt],it[ot+lt])==-1)return!1;return!0},_e.U.glyphsToPath=function(it,st,ot){for(var lt={cmds:[],crds:[]},at=0,ct=0;ct<st.length;ct++){var ut=st[ct];if(ut!=-1){for(var ht=ct<st.length-1&&st[ct+1]!=-1?st[ct+1]:0,dt=_e.U.glyphToPath(it,ut),ft=0;ft<dt.crds.length;ft+=2)lt.crds.push(dt.crds[ft]+at),lt.crds.push(dt.crds[ft+1]);for(ot&&lt.cmds.push(ot),ft=0;ft<dt.cmds.length;ft++)lt.cmds.push(dt.cmds[ft]);ot&&lt.cmds.push("X"),at+=it.hmtx.aWidth[ut],ct<st.length-1&&(at+=_e.U.getPairAdjustment(it,ut,ht))}}return lt},_e.U.P={},_e.U.P.moveTo=function(it,st,ot){it.cmds.push("M"),it.crds.push(st,ot)},_e.U.P.lineTo=function(it,st,ot){it.cmds.push("L"),it.crds.push(st,ot)},_e.U.P.curveTo=function(it,st,ot,lt,at,ct,ut){it.cmds.push("C"),it.crds.push(st,ot,lt,at,ct,ut)},_e.U.P.qcurveTo=function(it,st,ot,lt,at){it.cmds.push("Q"),it.crds.push(st,ot,lt,at)},_e.U.P.closePath=function(it){it.cmds.push("Z")},_e.U._drawCFF=function(it,st,ot,lt,at){for(var ct=st.stack,ut=st.nStems,ht=st.haveWidth,dt=st.width,ft=st.open,pt=0,mt=st.x,gt=st.y,vt=0,At=0,yt=0,xt=0,_t=0,Et=0,bt=0,wt=0,Tt=0,Mt=0,Pt={val:0,size:0};pt<it.length;){_e.CFF.getCharString(it,pt,Pt);var It=Pt.val;if(pt+=Pt.size,It=="o1"||It=="o18")ct.length%2!=0&&!ht&&(dt=ct.shift()+lt.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0;else if(It=="o3"||It=="o23")ct.length%2!=0&&!ht&&(dt=ct.shift()+lt.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0;else if(It=="o4")ct.length>1&&!ht&&(dt=ct.shift()+lt.nominalWidthX,ht=!0),ft&&_e.U.P.closePath(at),gt+=ct.pop(),_e.U.P.moveTo(at,mt,gt),ft=!0;else if(It=="o5")for(;ct.length>0;)mt+=ct.shift(),gt+=ct.shift(),_e.U.P.lineTo(at,mt,gt);else if(It=="o6"||It=="o7")for(var Ot=ct.length,Bt=It=="o6",Ut=0;Ut<Ot;Ut++){var Ft=ct.shift();Bt?mt+=Ft:gt+=Ft,Bt=!Bt,_e.U.P.lineTo(at,mt,gt)}else if(It=="o8"||It=="o24"){Ot=ct.length;for(var jt=0;jt+6<=Ot;)vt=mt+ct.shift(),At=gt+ct.shift(),yt=vt+ct.shift(),xt=At+ct.shift(),mt=yt+ct.shift(),gt=xt+ct.shift(),_e.U.P.curveTo(at,vt,At,yt,xt,mt,gt),jt+=6;It=="o24"&&(mt+=ct.shift(),gt+=ct.shift(),_e.U.P.lineTo(at,mt,gt))}else{if(It=="o11")break;if(It=="o1234"||It=="o1235"||It=="o1236"||It=="o1237")It=="o1234"&&(At=gt,yt=(vt=mt+ct.shift())+ct.shift(),Mt=xt=At+ct.shift(),Et=xt,wt=gt,mt=(bt=(_t=(Tt=yt+ct.shift())+ct.shift())+ct.shift())+ct.shift(),_e.U.P.curveTo(at,vt,At,yt,xt,Tt,Mt),_e.U.P.curveTo(at,_t,Et,bt,wt,mt,gt)),It=="o1235"&&(vt=mt+ct.shift(),At=gt+ct.shift(),yt=vt+ct.shift(),xt=At+ct.shift(),Tt=yt+ct.shift(),Mt=xt+ct.shift(),_t=Tt+ct.shift(),Et=Mt+ct.shift(),bt=_t+ct.shift(),wt=Et+ct.shift(),mt=bt+ct.shift(),gt=wt+ct.shift(),ct.shift(),_e.U.P.curveTo(at,vt,At,yt,xt,Tt,Mt),_e.U.P.curveTo(at,_t,Et,bt,wt,mt,gt)),It=="o1236"&&(vt=mt+ct.shift(),At=gt+ct.shift(),yt=vt+ct.shift(),Mt=xt=At+ct.shift(),Et=xt,bt=(_t=(Tt=yt+ct.shift())+ct.shift())+ct.shift(),wt=Et+ct.shift(),mt=bt+ct.shift(),_e.U.P.curveTo(at,vt,At,yt,xt,Tt,Mt),_e.U.P.curveTo(at,_t,Et,bt,wt,mt,gt)),It=="o1237"&&(vt=mt+ct.shift(),At=gt+ct.shift(),yt=vt+ct.shift(),xt=At+ct.shift(),Tt=yt+ct.shift(),Mt=xt+ct.shift(),_t=Tt+ct.shift(),Et=Mt+ct.shift(),bt=_t+ct.shift(),wt=Et+ct.shift(),Math.abs(bt-mt)>Math.abs(wt-gt)?mt=bt+ct.shift():gt=wt+ct.shift(),_e.U.P.curveTo(at,vt,At,yt,xt,Tt,Mt),_e.U.P.curveTo(at,_t,Et,bt,wt,mt,gt));else if(It=="o14"){if(ct.length>0&&!ht&&(dt=ct.shift()+ot.nominalWidthX,ht=!0),ct.length==4){var Dt=ct.shift(),Gt=ct.shift(),zt=ct.shift(),$t=ct.shift(),Ht=_e.CFF.glyphBySE(ot,zt),er=_e.CFF.glyphBySE(ot,$t);_e.U._drawCFF(ot.CharStrings[Ht],st,ot,lt,at),st.x=Dt,st.y=Gt,_e.U._drawCFF(ot.CharStrings[er],st,ot,lt,at)}ft&&(_e.U.P.closePath(at),ft=!1)}else if(It=="o19"||It=="o20")ct.length%2!=0&&!ht&&(dt=ct.shift()+lt.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0,pt+=ut+7>>3;else if(It=="o21")ct.length>2&&!ht&&(dt=ct.shift()+lt.nominalWidthX,ht=!0),gt+=ct.pop(),mt+=ct.pop(),ft&&_e.U.P.closePath(at),_e.U.P.moveTo(at,mt,gt),ft=!0;else if(It=="o22")ct.length>1&&!ht&&(dt=ct.shift()+lt.nominalWidthX,ht=!0),mt+=ct.pop(),ft&&_e.U.P.closePath(at),_e.U.P.moveTo(at,mt,gt),ft=!0;else if(It=="o25"){for(;ct.length>6;)mt+=ct.shift(),gt+=ct.shift(),_e.U.P.lineTo(at,mt,gt);vt=mt+ct.shift(),At=gt+ct.shift(),yt=vt+ct.shift(),xt=At+ct.shift(),mt=yt+ct.shift(),gt=xt+ct.shift(),_e.U.P.curveTo(at,vt,At,yt,xt,mt,gt)}else if(It=="o26")for(ct.length%2&&(mt+=ct.shift());ct.length>0;)vt=mt,At=gt+ct.shift(),mt=yt=vt+ct.shift(),gt=(xt=At+ct.shift())+ct.shift(),_e.U.P.curveTo(at,vt,At,yt,xt,mt,gt);else if(It=="o27")for(ct.length%2&&(gt+=ct.shift());ct.length>0;)At=gt,yt=(vt=mt+ct.shift())+ct.shift(),xt=At+ct.shift(),mt=yt+ct.shift(),gt=xt,_e.U.P.curveTo(at,vt,At,yt,xt,mt,gt);else if(It=="o10"||It=="o29"){var Zt=It=="o10"?lt:ot;if(ct.length==0)console.debug("error: empty stack");else{var or=ct.pop(),Kt=Zt.Subrs[or+Zt.Bias];st.x=mt,st.y=gt,st.nStems=ut,st.haveWidth=ht,st.width=dt,st.open=ft,_e.U._drawCFF(Kt,st,ot,lt,at),mt=st.x,gt=st.y,ut=st.nStems,ht=st.haveWidth,dt=st.width,ft=st.open}}else if(It=="o30"||It=="o31"){var rr=ct.length,ur=(jt=0,It=="o31");for(jt+=rr-(Ot=-3&rr);jt<Ot;)ur?(At=gt,yt=(vt=mt+ct.shift())+ct.shift(),gt=(xt=At+ct.shift())+ct.shift(),Ot-jt==5?(mt=yt+ct.shift(),jt++):mt=yt,ur=!1):(vt=mt,At=gt+ct.shift(),yt=vt+ct.shift(),xt=At+ct.shift(),mt=yt+ct.shift(),Ot-jt==5?(gt=xt+ct.shift(),jt++):gt=xt,ur=!0),_e.U.P.curveTo(at,vt,At,yt,xt,mt,gt),jt+=4}else{if((It+"").charAt(0)=="o")throw console.debug("Unknown operation: "+It,it),It;ct.push(It)}}}st.x=mt,st.y=gt,st.nStems=ut,st.haveWidth=ht,st.width=dt,st.open=ft};var rt=_e,nt={Typr:rt};return tt.Typr=rt,tt.default=nt,Object.defineProperty(tt,"__esModule",{value:!0}),tt}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function woff2otfFactory(){return function(tt){var _e=Uint8Array,rt=Uint16Array,nt=Uint32Array,it=new _e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),st=new _e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ot=new _e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lt=function(It,Ot){for(var Bt=new rt(31),Ut=0;Ut<31;++Ut)Bt[Ut]=Ot+=1<<It[Ut-1];var Ft=new nt(Bt[30]);for(Ut=1;Ut<30;++Ut)for(var jt=Bt[Ut];jt<Bt[Ut+1];++jt)Ft[jt]=jt-Bt[Ut]<<5|Ut;return[Bt,Ft]},at=lt(it,2),ct=at[0],ut=at[1];ct[28]=258,ut[258]=28;for(var ht=lt(st,0)[0],dt=new rt(32768),ft=0;ft<32768;++ft){var pt=(43690&ft)>>>1|(21845&ft)<<1;pt=(61680&(pt=(52428&pt)>>>2|(13107&pt)<<2))>>>4|(3855&pt)<<4,dt[ft]=((65280&pt)>>>8|(255&pt)<<8)>>>1}var mt=function(It,Ot,Bt){for(var Ut=It.length,Ft=0,jt=new rt(Ot);Ft<Ut;++Ft)++jt[It[Ft]-1];var Dt,Gt=new rt(Ot);for(Ft=0;Ft<Ot;++Ft)Gt[Ft]=Gt[Ft-1]+jt[Ft-1]<<1;if(Bt){Dt=new rt(1<<Ot);var zt=15-Ot;for(Ft=0;Ft<Ut;++Ft)if(It[Ft])for(var $t=Ft<<4|It[Ft],Ht=Ot-It[Ft],er=Gt[It[Ft]-1]++<<Ht,Zt=er|(1<<Ht)-1;er<=Zt;++er)Dt[dt[er]>>>zt]=$t}else for(Dt=new rt(Ut),Ft=0;Ft<Ut;++Ft)It[Ft]&&(Dt[Ft]=dt[Gt[It[Ft]-1]++]>>>15-It[Ft]);return Dt},gt=new _e(288);for(ft=0;ft<144;++ft)gt[ft]=8;for(ft=144;ft<256;++ft)gt[ft]=9;for(ft=256;ft<280;++ft)gt[ft]=7;for(ft=280;ft<288;++ft)gt[ft]=8;var vt=new _e(32);for(ft=0;ft<32;++ft)vt[ft]=5;var At=mt(gt,9,1),yt=mt(vt,5,1),xt=function(It){for(var Ot=It[0],Bt=1;Bt<It.length;++Bt)It[Bt]>Ot&&(Ot=It[Bt]);return Ot},_t=function(It,Ot,Bt){var Ut=Ot/8|0;return(It[Ut]|It[Ut+1]<<8)>>(7&Ot)&Bt},Et=function(It,Ot){var Bt=Ot/8|0;return(It[Bt]|It[Bt+1]<<8|It[Bt+2]<<16)>>(7&Ot)},bt=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wt=function(It,Ot,Bt){var Ut=new Error(Ot||bt[It]);if(Ut.code=It,Error.captureStackTrace&&Error.captureStackTrace(Ut,wt),!Bt)throw Ut;return Ut},Tt=function(It,Ot,Bt){var Ut=It.length;if(!Ut||Bt&&!Bt.l&&Ut<5)return Ot||new _e(0);var Ft=!Ot||Bt,jt=!Bt||Bt.i;Bt||(Bt={}),Ot||(Ot=new _e(3*Ut));var Dt,Gt=function(nr){var Cr=Ot.length;if(nr>Cr){var cr=new _e(Math.max(2*Cr,nr));cr.set(Ot),Ot=cr}},zt=Bt.f||0,$t=Bt.p||0,Ht=Bt.b||0,er=Bt.l,Zt=Bt.d,or=Bt.m,Kt=Bt.n,rr=8*Ut;do{if(!er){Bt.f=zt=_t(It,$t,1);var ur=_t(It,$t+1,3);if($t+=3,!ur){var fr=It[(Ur=((Dt=$t)/8|0)+(7&Dt&&1)+4)-4]|It[Ur-3]<<8,dr=Ur+fr;if(dr>Ut){jt&&wt(0);break}Ft&&Gt(Ht+fr),Ot.set(It.subarray(Ur,dr),Ht),Bt.b=Ht+=fr,Bt.p=$t=8*dr;continue}if(ur==1)er=At,Zt=yt,or=9,Kt=5;else if(ur==2){var gr=_t(It,$t,31)+257,Yt=_t(It,$t+10,15)+4,xr=gr+_t(It,$t+5,31)+1;$t+=14;for(var vr=new _e(xr),Pr=new _e(19),Sr=0;Sr<Yt;++Sr)Pr[ot[Sr]]=_t(It,$t+3*Sr,7);$t+=3*Yt;var Qr=xt(Pr),Ir=(1<<Qr)-1,Dr=mt(Pr,Qr,1);for(Sr=0;Sr<xr;){var Ur,Lr=Dr[_t(It,$t,Ir)];if($t+=15&Lr,(Ur=Lr>>>4)<16)vr[Sr++]=Ur;else{var Wr=0,Xt=0;for(Ur==16?(Xt=3+_t(It,$t,3),$t+=2,Wr=vr[Sr-1]):Ur==17?(Xt=3+_t(It,$t,7),$t+=3):Ur==18&&(Xt=11+_t(It,$t,127),$t+=7);Xt--;)vr[Sr++]=Wr}}var Qt=vr.subarray(0,gr),hr=vr.subarray(gr);or=xt(Qt),Kt=xt(hr),er=mt(Qt,or,1),Zt=mt(hr,Kt,1)}else wt(1);if($t>rr){jt&&wt(0);break}}Ft&&Gt(Ht+131072);for(var kr=(1<<or)-1,yr=(1<<Kt)-1,_r=$t;;_r=$t){var Hr=(Wr=er[Et(It,$t)&kr])>>>4;if(($t+=15&Wr)>rr){jt&&wt(0);break}if(Wr||wt(2),Hr<256)Ot[Ht++]=Hr;else{if(Hr==256){_r=$t,er=null;break}var Er=Hr-254;if(Hr>264){var Ar=it[Sr=Hr-257];Er=_t(It,$t,(1<<Ar)-1)+ct[Sr],$t+=Ar}var qt=Zt[Et(It,$t)&yr],pr=qt>>>4;if(qt||wt(3),$t+=15&qt,hr=ht[pr],pr>3&&(Ar=st[pr],hr+=Et(It,$t)&(1<<Ar)-1,$t+=Ar),$t>rr){jt&&wt(0);break}Ft&&Gt(Ht+131072);for(var mr=Ht+Er;Ht<mr;Ht+=4)Ot[Ht]=Ot[Ht-hr],Ot[Ht+1]=Ot[Ht+1-hr],Ot[Ht+2]=Ot[Ht+2-hr],Ot[Ht+3]=Ot[Ht+3-hr];Ht=mr}}Bt.l=er,Bt.p=_r,Bt.b=Ht,er&&(zt=1,Bt.m=or,Bt.d=Zt,Bt.n=Kt)}while(!zt);return Ht==Ot.length?Ot:function(nr,Cr,cr){(Cr==null||Cr<0)&&(Cr=0),(cr==null||cr>nr.length)&&(cr=nr.length);var Jr=new(nr instanceof rt?rt:nr instanceof nt?nt:_e)(cr-Cr);return Jr.set(nr.subarray(Cr,cr)),Jr}(Ot,0,Ht)},Mt=new _e(0),Pt=typeof TextDecoder<"u"&&new TextDecoder;try{Pt.decode(Mt,{stream:!0})}catch{}return tt.convert_streams=function(It){var Ot=new DataView(It),Bt=0;function Ut(){var gr=Ot.getUint16(Bt);return Bt+=2,gr}function Ft(){var gr=Ot.getUint32(Bt);return Bt+=4,gr}function jt(gr){fr.setUint16(dr,gr),dr+=2}function Dt(gr){fr.setUint32(dr,gr),dr+=4}for(var Gt={signature:Ft(),flavor:Ft(),length:Ft(),numTables:Ut(),reserved:Ut(),totalSfntSize:Ft(),majorVersion:Ut(),minorVersion:Ut(),metaOffset:Ft(),metaLength:Ft(),metaOrigLength:Ft(),privOffset:Ft(),privLength:Ft()},zt=0;Math.pow(2,zt)<=Gt.numTables;)zt++;zt--;for(var $t=16*Math.pow(2,zt),Ht=16*Gt.numTables-$t,er=12,Zt=[],or=0;or<Gt.numTables;or++)Zt.push({tag:Ft(),offset:Ft(),compLength:Ft(),origLength:Ft(),origChecksum:Ft()}),er+=16;var Kt,rr=new Uint8Array(12+16*Zt.length+Zt.reduce(function(gr,Yt){return gr+Yt.origLength+4},0)),ur=rr.buffer,fr=new DataView(ur),dr=0;return Dt(Gt.flavor),jt(Gt.numTables),jt($t),jt(zt),jt(Ht),Zt.forEach(function(gr){Dt(gr.tag),Dt(gr.origChecksum),Dt(er),Dt(gr.origLength),gr.outOffset=er,(er+=gr.origLength)%4!=0&&(er+=4-er%4)}),Zt.forEach(function(gr){var Yt,xr=It.slice(gr.offset,gr.offset+gr.compLength);if(gr.compLength!=gr.origLength){var vr=new Uint8Array(gr.origLength);Yt=new Uint8Array(xr,2),Tt(Yt,vr)}else vr=new Uint8Array(xr);rr.set(vr,gr.outOffset);var Pr=0;(er=gr.outOffset+gr.origLength)%4!=0&&(Pr=4-er%4),rr.set(new Uint8Array(Pr).buffer,gr.outOffset+gr.origLength),Kt=er+Pr}),ur.slice(0,Kt)},Object.defineProperty(tt,"__esModule",{value:!0}),tt}({}).convert_streams}function parserFactory(tt,_e){const rt={M:2,L:2,Q:4,C:6,Z:0},nt={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},it=1,st=2,ot=4,lt=8,at=16,ct=32;let ut;function ht(_t){if(!ut){const Et={R:st,L:it,D:ot,C:at,U:ct,T:lt};ut=new Map;for(let bt in nt){let wt=0;nt[bt].split(",").forEach(Tt=>{let[Mt,Pt]=Tt.split("+");Mt=parseInt(Mt,36),Pt=Pt?parseInt(Pt,36):0,ut.set(wt+=Mt,Et[bt]);for(let It=Pt;It--;)ut.set(++wt,Et[bt])})}}return ut.get(_t)||ct}const dt=1,ft=2,pt=3,mt=4,gt=[null,"isol","init","fina","medi"];function vt(_t){const Et=new Uint8Array(_t.length);let bt=ct,wt=dt,Tt=-1;for(let Mt=0;Mt<_t.length;Mt++){const Pt=_t.codePointAt(Mt);let It=ht(Pt)|0,Ot=dt;It&lt||(bt&(it|ot|at)?It&(st|ot|at)?(Ot=pt,(wt===dt||wt===pt)&&Et[Tt]++):It&(it|ct)&&(wt===ft||wt===mt)&&Et[Tt]--:bt&(st|ct)&&(wt===ft||wt===mt)&&Et[Tt]--,wt=Et[Mt]=Ot,bt=It,Tt=Mt,Pt>65535&&Mt++)}return Et}function At(_t,Et){const bt=[];for(let Tt=0;Tt<Et.length;Tt++){const Mt=Et.codePointAt(Tt);Mt>65535&&Tt++,bt.push(tt.U.codeToGlyph(_t,Mt))}const wt=_t.GSUB;if(wt){const{lookupList:Tt,featureList:Mt}=wt;let Pt;const It=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,Ot=[];Mt.forEach(Bt=>{if(It.test(Bt.tag))for(let Ut=0;Ut<Bt.tab.length;Ut++){if(Ot[Bt.tab[Ut]])continue;Ot[Bt.tab[Ut]]=!0;const Ft=Tt[Bt.tab[Ut]],jt=/^(isol|init|fina|medi)$/.test(Bt.tag);jt&&!Pt&&(Pt=vt(Et));for(let Dt=0;Dt<bt.length;Dt++)(!Pt||!jt||gt[Pt[Dt]]===Bt.tag)&&tt.U._applySubs(bt,Dt,Ft,Tt)}})}return bt}function yt(..._t){for(let Et=0;Et<_t.length;Et++)if(typeof _t[Et]=="number")return _t[Et]}function xt(_t){const Et=Object.create(null),bt=_t["OS/2"],wt=_t.hhea,Tt=_t.head.unitsPerEm,Mt=yt(bt&&bt.sTypoAscender,wt&&wt.ascender,Tt),Pt={unitsPerEm:Tt,ascender:Mt,descender:yt(bt&&bt.sTypoDescender,wt&&wt.descender,0),capHeight:yt(bt&&bt.sCapHeight,Mt),xHeight:yt(bt&&bt.sxHeight,Mt),lineGap:yt(bt&&bt.sTypoLineGap,wt&&wt.lineGap),forEachGlyph(It,Ot,Bt,Ut){let Ft=0;const jt=1/Pt.unitsPerEm*Ot,Dt=At(_t,It);let Gt=0,zt=-1;return Dt.forEach(($t,Ht)=>{if($t!==-1){let er=Et[$t];if(!er){const{cmds:Zt,crds:or}=tt.U.glyphToPath(_t,$t);let Kt="",rr=0;for(let Yt=0,xr=Zt.length;Yt<xr;Yt++){const vr=rt[Zt[Yt]];Kt+=Zt[Yt];for(let Pr=1;Pr<=vr;Pr++)Kt+=(Pr>1?",":"")+or[rr++]}let ur,fr,dr,gr;if(or.length){ur=fr=1/0,dr=gr=-1/0;for(let Yt=0,xr=or.length;Yt<xr;Yt+=2){let vr=or[Yt],Pr=or[Yt+1];vr<ur&&(ur=vr),Pr<fr&&(fr=Pr),vr>dr&&(dr=vr),Pr>gr&&(gr=Pr)}}else ur=dr=fr=gr=0;er=Et[$t]={index:$t,advanceWidth:_t.hmtx.aWidth[$t],xMin:ur,yMin:fr,xMax:dr,yMax:gr,path:Kt,pathCommandCount:Zt.length}}zt!==-1&&(Ft+=tt.U.getPairAdjustment(_t,zt,$t)*jt),Ut.call(null,er,Ft,Gt),er.advanceWidth&&(Ft+=er.advanceWidth*jt),Bt&&(Ft+=Bt*Ot),zt=$t}Gt+=It.codePointAt(Gt)>65535?2:1}),Ft}};return Pt}return function(Et){const bt=new Uint8Array(Et,0,4),wt=tt._bin.readASCII(bt,0,4);if(wt==="wOFF")Et=_e(Et);else if(wt==="wOF2")throw new Error("woff2 fonts not supported");return xt(tt.parse(Et)[0])}}const workerModule=defineWorkerModule({name:"Typr Font Parser",dependencies:[typrFactory,woff2otfFactory,parserFactory],init(tt,_e,rt){const nt=tt(),it=_e();return rt(nt,it)}}),CONFIG={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},tempColor=new Color$1;function now$1(){return(self.performance||Date).now()}const atlases=Object.create(null);function getTextRenderInfo(tt,_e){tt=assign$3({},tt);const rt=now$1();if(tt.font=toAbsoluteURL(tt.font||CONFIG.defaultFontURL),tt.text=""+tt.text,tt.sdfGlyphSize=tt.sdfGlyphSize||CONFIG.sdfGlyphSize,tt.colorRanges!=null){let ht={};for(let dt in tt.colorRanges)if(tt.colorRanges.hasOwnProperty(dt)){let ft=tt.colorRanges[dt];typeof ft!="number"&&(ft=tempColor.set(ft).getHex()),ht[dt]=ft}tt.colorRanges=ht}Object.freeze(tt);const{textureWidth:nt,sdfExponent:it}=CONFIG,{sdfGlyphSize:st}=tt,ot=nt/st*4;let lt=atlases[st];if(!lt){const ht=document.createElement("canvas");ht.width=nt,ht.height=st*256/ot,lt=atlases[st]={glyphCount:0,sdfGlyphSize:st,sdfCanvas:ht,sdfTexture:new Texture(ht,void 0,void 0,void 0,LinearFilter,LinearFilter),contextLost:!1,glyphsByFont:new Map},lt.sdfTexture.generateMipmaps=!1,initContextLossHandling(lt)}const{sdfTexture:at,sdfCanvas:ct}=lt;let ut=lt.glyphsByFont.get(tt.font);ut||lt.glyphsByFont.set(tt.font,ut=new Map),typesetInWorker(tt).then(ht=>{const{glyphIds:dt,glyphPositions:ft,fontSize:pt,unitsPerEm:mt,timings:gt}=ht,vt=[],At=new Float32Array(dt.length*4),yt=pt/mt;let xt=0,_t=0;const Et=now$1();dt.forEach((Pt,It)=>{let Ot=ut.get(Pt);if(!Ot){const{path:jt,pathBounds:Dt}=ht.glyphData[Pt],Gt=Math.max(Dt[2]-Dt[0],Dt[3]-Dt[1])/st*(CONFIG.sdfMargin*st+.5),zt=lt.glyphCount++,$t=[Dt[0]-Gt,Dt[1]-Gt,Dt[2]+Gt,Dt[3]+Gt];ut.set(Pt,Ot={path:jt,atlasIndex:zt,sdfViewBox:$t}),vt.push(Ot)}const{sdfViewBox:Bt}=Ot,Ut=ft[_t++],Ft=ft[_t++];At[xt++]=Ut+Bt[0]*yt,At[xt++]=Ft+Bt[1]*yt,At[xt++]=Ut+Bt[2]*yt,At[xt++]=Ft+Bt[3]*yt,dt[It]=Ot.atlasIndex}),gt.quads=(gt.quads||0)+(now$1()-Et);const bt=now$1();gt.sdf={};const wt=ct.height,Tt=Math.ceil(lt.glyphCount/ot),Mt=Math.pow(2,Math.ceil(Math.log2(Tt*st)));Mt>wt&&(console.info(`Increasing SDF texture size ${wt}->${Mt}`),resizeWebGLCanvasWithoutClearing(ct,nt,Mt),at.dispose()),Promise.all(vt.map(Pt=>generateGlyphSDF(Pt,lt,tt.gpuAccelerateSDF).then(({timing:It})=>{gt.sdf[Pt.atlasIndex]=It}))).then(()=>{vt.length&&!lt.contextLost&&(safariPre15Workaround(lt),at.needsUpdate=!0),gt.sdfTotal=now$1()-bt,gt.total=now$1()-rt,_e(Object.freeze({parameters:tt,sdfTexture:at,sdfGlyphSize:st,sdfExponent:it,glyphBounds:At,glyphAtlasIndices:dt,glyphColors:ht.glyphColors,caretPositions:ht.caretPositions,caretHeight:ht.caretHeight,chunkedBounds:ht.chunkedBounds,ascender:ht.ascender,descender:ht.descender,lineHeight:ht.lineHeight,capHeight:ht.capHeight,xHeight:ht.xHeight,topBaseline:ht.topBaseline,blockBounds:ht.blockBounds,visibleBounds:ht.visibleBounds,timings:ht.timings}))})}),Promise.resolve().then(()=>{lt.contextLost||warmUpSDFCanvas(ct)})}function generateGlyphSDF({path:tt,atlasIndex:_e,sdfViewBox:rt},{sdfGlyphSize:nt,sdfCanvas:it,contextLost:st},ot){if(st)return Promise.resolve({timing:-1});const{textureWidth:lt,sdfExponent:at}=CONFIG,ct=Math.max(rt[2]-rt[0],rt[3]-rt[1]),ut=Math.floor(_e/4),ht=ut%(lt/nt)*nt,dt=Math.floor(ut/(lt/nt))*nt,ft=_e%4;return generateSDF(nt,nt,tt,rt,ct,at,it,ht,dt,ft,ot)}function initContextLossHandling(tt){const _e=tt.sdfCanvas;_e.addEventListener("webglcontextlost",rt=>{console.log("Context Lost",rt),rt.preventDefault(),tt.contextLost=!0}),_e.addEventListener("webglcontextrestored",rt=>{console.log("Context Restored",rt),tt.contextLost=!1;const nt=[];tt.glyphsByFont.forEach(it=>{it.forEach(st=>{nt.push(generateGlyphSDF(st,tt,!0))})}),Promise.all(nt).then(()=>{safariPre15Workaround(tt),tt.sdfTexture.needsUpdate=!0})})}function preloadFont({font:tt,characters:_e,sdfGlyphSize:rt},nt){let it=Array.isArray(_e)?_e.join(`
`):""+_e;getTextRenderInfo({font:tt,sdfGlyphSize:rt,text:it},nt)}function assign$3(tt,_e){for(let rt in _e)_e.hasOwnProperty(rt)&&(tt[rt]=_e[rt]);return tt}let linkEl;function toAbsoluteURL(tt){return linkEl||(linkEl=typeof document>"u"?{}:document.createElement("a")),linkEl.href=tt,linkEl.href}function safariPre15Workaround(tt){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:_e,sdfTexture:rt}=tt,{width:nt,height:it}=_e,st=tt.sdfCanvas.getContext("webgl");let ot=rt.image.data;(!ot||ot.length!==nt*it*4)&&(ot=new Uint8Array(nt*it*4),rt.image={width:nt,height:it,data:ot},rt.flipY=!1,rt.isDataTexture=!0),st.readPixels(0,0,nt,it,st.RGBA,st.UNSIGNED_BYTE,ot)}}const typesetterWorkerModule=defineWorkerModule({name:"Typesetter",dependencies:[CONFIG,workerModule,createTypesetter,bidiFactory],init(tt,_e,rt,nt){const{defaultFontURL:it}=tt;return rt(_e,nt(),{defaultFontURL:it})}}),typesetInWorker=defineWorkerModule({name:"Typesetter",dependencies:[typesetterWorkerModule],init(tt){return function(_e){return new Promise(rt=>{tt.typeset(_e,rt)})}},getTransferables(tt){const _e=[tt.glyphPositions.buffer,tt.glyphIds.buffer];return tt.caretPositions&&_e.push(tt.caretPositions.buffer),tt.glyphColors&&_e.push(tt.glyphColors.buffer),_e}}),templateGeometries={};function getTemplateGeometry(tt){let _e=templateGeometries[tt];if(!_e){const rt=new PlaneGeometry(1,1,tt,tt),nt=rt.clone(),it=rt.attributes,st=nt.attributes,ot=new BufferGeometry,lt=it.uv.count;for(let at=0;at<lt;at++)st.position.array[at*3]*=-1,st.normal.array[at*3+2]*=-1;["position","normal","uv"].forEach(at=>{ot.setAttribute(at,new Float32BufferAttribute([...it[at].array,...st[at].array],it[at].itemSize))}),ot.setIndex([...rt.index.array,...nt.index.array.map(at=>at+lt)]),ot.translate(.5,.5,0),_e=templateGeometries[tt]=ot}return _e}const glyphBoundsAttrName="aTroikaGlyphBounds",glyphIndexAttrName="aTroikaGlyphIndex",glyphColorAttrName="aTroikaGlyphColor";class GlyphsGeometry extends InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Sphere,this.boundingBox=new Box3}computeBoundingSphere(){}computeBoundingBox(){}setSide(_e){const rt=this.getIndex().count;this.setDrawRange(_e===BackSide?rt/2:0,_e===DoubleSide?rt:rt/2)}set detail(_e){if(_e!==this._detail){this._detail=_e,(typeof _e!="number"||_e<1)&&(_e=1);let rt=getTemplateGeometry(_e);["position","normal","uv"].forEach(nt=>{this.attributes[nt]=rt.attributes[nt].clone()}),this.setIndex(rt.getIndex().clone())}}get detail(){return this._detail}set curveRadius(_e){_e!==this._curveRadius&&(this._curveRadius=_e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(_e,rt,nt,it,st){updateBufferAttr(this,glyphBoundsAttrName,_e,4),updateBufferAttr(this,glyphIndexAttrName,rt,1),updateBufferAttr(this,glyphColorAttrName,st,3),this._blockBounds=nt,this._chunkedBounds=it,this.instanceCount=rt.length,this._updateBounds()}_updateBounds(){const _e=this._blockBounds;if(_e){const{curveRadius:rt,boundingBox:nt}=this;if(rt){const{PI:it,floor:st,min:ot,max:lt,sin:at,cos:ct}=Math,ut=it/2,ht=it*2,dt=Math.abs(rt),ft=_e[0]/dt,pt=_e[2]/dt,mt=st((ft+ut)/ht)!==st((pt+ut)/ht)?-dt:ot(at(ft)*dt,at(pt)*dt),gt=st((ft-ut)/ht)!==st((pt-ut)/ht)?dt:lt(at(ft)*dt,at(pt)*dt),vt=st((ft+it)/ht)!==st((pt+it)/ht)?dt*2:lt(dt-ct(ft)*dt,dt-ct(pt)*dt);nt.min.set(mt,_e[1],rt<0?-vt:0),nt.max.set(gt,_e[3],rt<0?0:vt)}else nt.min.set(_e[0],_e[1],0),nt.max.set(_e[2],_e[3],0);nt.getBoundingSphere(this.boundingSphere)}}applyClipRect(_e){let rt=this.getAttribute(glyphIndexAttrName).count,nt=this._chunkedBounds;if(nt)for(let it=nt.length;it--;){rt=nt[it].end;let st=nt[it].rect;if(st[1]<_e.w&&st[3]>_e.y&&st[0]<_e.z&&st[2]>_e.x)break}this.instanceCount=rt}}function updateBufferAttr(tt,_e,rt,nt){const it=tt.getAttribute(_e);rt?it&&it.array.length===rt.length?(it.array.set(rt),it.needsUpdate=!0):(tt.setAttribute(_e,new InstancedBufferAttribute(rt,nt)),delete tt._maxInstanceCount,tt.dispose()):it&&tt.deleteAttribute(_e)}const VERTEX_DEFS=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,VERTEX_TRANSFORM=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,FRAGMENT_DEFS=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,FRAGMENT_TRANSFORM=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function createTextDerivedMaterial(tt){const _e=createDerivedMaterial(tt,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Vector4(0,0,0,0)},uTroikaClipRect:{value:new Vector4(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Color$1},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:VERTEX_DEFS,vertexTransform:VERTEX_TRANSFORM,fragmentDefs:FRAGMENT_DEFS,fragmentColorTransform:FRAGMENT_TRANSFORM,customRewriter({vertexShader:rt,fragmentShader:nt}){let it=/\buniform\s+vec3\s+diffuse\b/;return it.test(nt)&&(nt=nt.replace(it,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),it.test(rt)||(rt=rt.replace(voidMainRegExp,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:rt,fragmentShader:nt}}});return _e.transparent=!0,Object.defineProperties(_e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),_e}const defaultMaterial=new MeshBasicMaterial({color:16777215,side:DoubleSide,transparent:!0}),defaultStrokeColor=8421504,tempMat4=new Matrix4,tempVec3a=new Vector3,tempVec3b=new Vector3,tempArray=[],origin=new Vector3,defaultOrient="+x+y";function first(tt){return Array.isArray(tt)?tt[0]:tt}let getFlatRaycastMesh=()=>{const tt=new Mesh(new PlaneGeometry(1,1),defaultMaterial);return getFlatRaycastMesh=()=>tt,tt},getCurvedRaycastMesh=()=>{const tt=new Mesh(new PlaneGeometry(1,1,32,1),defaultMaterial);return getCurvedRaycastMesh=()=>tt,tt};const syncStartEvent={type:"syncstart"},syncCompleteEvent={type:"synccomplete"},SYNCABLE_PROPS=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],COPYABLE_PROPS=SYNCABLE_PROPS.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Text$1=class extends Mesh{constructor(){const _e=new GlyphsGeometry;super(_e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=defaultStrokeColor,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=defaultOrient,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(_e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(_e):(this._isSyncing=!0,this.dispatchEvent(syncStartEvent),getTextRenderInfo({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},rt=>{this._isSyncing=!1,this._textRenderInfo=rt,this.geometry.updateGlyphs(rt.glyphBounds,rt.glyphAtlasIndices,rt.blockBounds,rt.chunkedBounds,rt.glyphColors);const nt=this._queuedSyncs;nt&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{nt.forEach(it=>it&&it())})),this.dispatchEvent(syncCompleteEvent),_e&&_e()})))}onBeforeRender(_e,rt,nt,it,st,ot){this.sync(),st.isTroikaTextMaterial&&this._prepareForRender(st),st._hadOwnSide=st.hasOwnProperty("side"),this.geometry.setSide(st._actualSide=st.side),st.side=FrontSide}onAfterRender(_e,rt,nt,it,st,ot){st._hadOwnSide?st.side=st._actualSide:delete st.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let _e=this._derivedMaterial;const rt=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=defaultMaterial.clone());if((!_e||_e.baseMaterial!==rt)&&(_e=this._derivedMaterial=createTextDerivedMaterial(rt),rt.addEventListener("dispose",function nt(){rt.removeEventListener("dispose",nt),_e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let nt=_e._outlineMtl;return nt||(nt=_e._outlineMtl=Object.create(_e,{id:{value:_e.id+.1}}),nt.isTextOutlineMaterial=!0,nt.depthWrite=!1,nt.map=null,_e.addEventListener("dispose",function it(){_e.removeEventListener("dispose",it),nt.dispose()})),[nt,_e]}else return _e}set material(_e){_e&&_e.isTroikaTextMaterial?(this._derivedMaterial=_e,this._baseMaterial=_e.baseMaterial):this._baseMaterial=_e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(_e){this.geometry.detail=_e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(_e){this.geometry.curveRadius=_e}get customDepthMaterial(){return first(this.material).getDepthMaterial()}get customDistanceMaterial(){return first(this.material).getDistanceMaterial()}_prepareForRender(_e){const rt=_e.isTextOutlineMaterial,nt=_e.uniforms,it=this.textRenderInfo;if(it){const{sdfTexture:lt,blockBounds:at}=it;nt.uTroikaSDFTexture.value=lt,nt.uTroikaSDFTextureSize.value.set(lt.image.width,lt.image.height),nt.uTroikaSDFGlyphSize.value=it.sdfGlyphSize,nt.uTroikaSDFExponent.value=it.sdfExponent,nt.uTroikaTotalBounds.value.fromArray(at),nt.uTroikaUseGlyphColors.value=!rt&&!!it.glyphColors;let ct=0,ut=0,ht=0,dt,ft,pt,mt=0,gt=0;if(rt){let{outlineWidth:At,outlineOffsetX:yt,outlineOffsetY:xt,outlineBlur:_t,outlineOpacity:Et}=this;ct=this._parsePercent(At)||0,ut=Math.max(0,this._parsePercent(_t)||0),dt=Et,mt=this._parsePercent(yt)||0,gt=this._parsePercent(xt)||0}else ht=Math.max(0,this._parsePercent(this.strokeWidth)||0),ht&&(pt=this.strokeColor,nt.uTroikaStrokeColor.value.set(pt??defaultStrokeColor),ft=this.strokeOpacity,ft==null&&(ft=1)),dt=this.fillOpacity;nt.uTroikaDistanceOffset.value=ct,nt.uTroikaPositionOffset.value.set(mt,gt),nt.uTroikaBlurRadius.value=ut,nt.uTroikaStrokeWidth.value=ht,nt.uTroikaStrokeOpacity.value=ft,nt.uTroikaFillOpacity.value=dt??1,nt.uTroikaCurveRadius.value=this.curveRadius||0;let vt=this.clipRect;if(vt&&Array.isArray(vt)&&vt.length===4)nt.uTroikaClipRect.value.fromArray(vt);else{const At=(this.fontSize||.1)*100;nt.uTroikaClipRect.value.set(at[0]-At,at[1]-At,at[2]+At,at[3]+At)}this.geometry.applyClipRect(nt.uTroikaClipRect.value)}nt.uTroikaSDFDebug.value=!!this.debugSDF,_e.polygonOffset=!!this.depthOffset,_e.polygonOffsetFactor=_e.polygonOffsetUnits=this.depthOffset||0;const st=rt?this.outlineColor||0:this.color;if(st==null)delete _e.color;else{const lt=_e.hasOwnProperty("color")?_e.color:_e.color=new Color$1;(st!==lt._input||typeof st=="object")&&lt.set(lt._input=st)}let ot=this.orientation||defaultOrient;if(ot!==_e._orientation){let lt=nt.uTroikaOrient.value;ot=ot.replace(/[^-+xyz]/g,"");let at=ot!==defaultOrient&&ot.match(/^([-+])([xyz])([-+])([xyz])$/);if(at){let[,ct,ut,ht,dt]=at;tempVec3a.set(0,0,0)[ut]=ct==="-"?1:-1,tempVec3b.set(0,0,0)[dt]=ht==="-"?-1:1,tempMat4.lookAt(origin,tempVec3a.cross(tempVec3b),tempVec3b),lt.setFromMatrix4(tempMat4)}else lt.identity();_e._orientation=ot}}_parsePercent(_e){if(typeof _e=="string"){let rt=_e.match(/^(-?[\d.]+)%$/),nt=rt?parseFloat(rt[1]):NaN;_e=(isNaN(nt)?0:nt/100)*this.fontSize}return _e}localPositionToTextCoords(_e,rt=new Vector2){rt.copy(_e);const nt=this.curveRadius;return nt&&(rt.x=Math.atan2(_e.x,Math.abs(nt)-Math.abs(_e.z))*Math.abs(nt)),rt}worldPositionToTextCoords(_e,rt=new Vector2){return tempVec3a.copy(_e),this.localPositionToTextCoords(this.worldToLocal(tempVec3a),rt)}raycast(_e,rt){const{textRenderInfo:nt,curveRadius:it}=this;if(nt){const st=nt.blockBounds,ot=it?getCurvedRaycastMesh():getFlatRaycastMesh(),lt=ot.geometry,{position:at,uv:ct}=lt.attributes;for(let ut=0;ut<ct.count;ut++){let ht=st[0]+ct.getX(ut)*(st[2]-st[0]);const dt=st[1]+ct.getY(ut)*(st[3]-st[1]);let ft=0;it&&(ft=it-Math.cos(ht/it)*it,ht=Math.sin(ht/it)*it),at.setXYZ(ut,ht,dt,ft)}lt.boundingSphere=this.geometry.boundingSphere,lt.boundingBox=this.geometry.boundingBox,ot.matrixWorld=this.matrixWorld,ot.material.side=this.material.side,tempArray.length=0,ot.raycast(_e,tempArray);for(let ut=0;ut<tempArray.length;ut++)tempArray[ut].object=this,rt.push(tempArray[ut])}}copy(_e){const rt=this.geometry;return super.copy(_e),this.geometry=rt,COPYABLE_PROPS.forEach(nt=>{this[nt]=_e[nt]}),this}clone(){return new this.constructor().copy(this)}};SYNCABLE_PROPS.forEach(tt=>{const _e="_private_"+tt;Object.defineProperty(Text$1.prototype,tt,{get(){return this[_e]},set(rt){rt!==this[_e]&&(this[_e]=rt,this._needsSync=!0)}})});const Text=reactExports.forwardRef(({sdfGlyphSize:tt=64,anchorX:_e="center",anchorY:rt="middle",font:nt,fontSize:it=1,children:st,characters:ot,onSync:lt,...at},ct)=>{const ut=useThree(({invalidate:pt})=>pt),[ht]=reactExports.useState(()=>new Text$1),[dt,ft]=reactExports.useMemo(()=>{const pt=[];let mt="";return reactExports.Children.forEach(st,gt=>{typeof gt=="string"||typeof gt=="number"?mt+=gt:pt.push(gt)}),[pt,mt]},[st]);return suspend(()=>new Promise(pt=>preloadFont({font:nt,characters:ot},pt)),["troika-text",nt,ot]),reactExports.useLayoutEffect(()=>void ht.sync(()=>{ut(),lt&&lt(ht)})),reactExports.useEffect(()=>()=>ht.dispose(),[ht]),reactExports.createElement("primitive",_extends$1({object:ht,ref:ct,font:nt,text:ft,anchorX:_e,anchorY:rt,fontSize:it,sdfGlyphSize:tt},at),dt)}),OrbitControls=reactExports.forwardRef(({makeDefault:tt,camera:_e,regress:rt,domElement:nt,enableDamping:it=!0,keyEvents:st=!1,onChange:ot,onStart:lt,onEnd:at,...ct},ut)=>{const ht=useThree(Et=>Et.invalidate),dt=useThree(Et=>Et.camera),ft=useThree(Et=>Et.gl),pt=useThree(Et=>Et.events),mt=useThree(Et=>Et.setEvents),gt=useThree(Et=>Et.set),vt=useThree(Et=>Et.get),At=useThree(Et=>Et.performance),yt=_e||dt,xt=nt||pt.connected||ft.domElement,_t=reactExports.useMemo(()=>new OrbitControls$1(yt),[yt]);return useFrame(()=>{_t.enabled&&_t.update()},-1),reactExports.useEffect(()=>(st&&_t.connect(st===!0?xt:st),_t.connect(xt),()=>void _t.dispose()),[st,xt,rt,_t,ht]),reactExports.useEffect(()=>{const Et=Tt=>{ht(),rt&&At.regress(),ot&&ot(Tt)},bt=Tt=>{lt&&lt(Tt)},wt=Tt=>{at&&at(Tt)};return _t.addEventListener("change",Et),_t.addEventListener("start",bt),_t.addEventListener("end",wt),()=>{_t.removeEventListener("start",bt),_t.removeEventListener("end",wt),_t.removeEventListener("change",Et)}},[ot,lt,at,_t,ht,mt]),reactExports.useEffect(()=>{if(tt){const Et=vt().controls;return gt({controls:_t}),()=>gt({controls:Et})}},[tt,_t]),reactExports.createElement("primitive",_extends$1({ref:ut,object:_t,enableDamping:it},ct))});var stats_min={exports:{}};(function(tt,_e){(function(rt,nt){tt.exports=nt()})(commonjsGlobal$1,function(){var rt=function(){function nt(ft){return ot.appendChild(ft.dom),ft}function it(ft){for(var pt=0;pt<ot.children.length;pt++)ot.children[pt].style.display=pt===ft?"block":"none";st=ft}var st=0,ot=document.createElement("div");ot.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",ot.addEventListener("click",function(ft){ft.preventDefault(),it(++st%ot.children.length)},!1);var lt=(performance||Date).now(),at=lt,ct=0,ut=nt(new rt.Panel("FPS","#0ff","#002")),ht=nt(new rt.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var dt=nt(new rt.Panel("MB","#f08","#201"));return it(0),{REVISION:16,dom:ot,addPanel:nt,showPanel:it,begin:function(){lt=(performance||Date).now()},end:function(){ct++;var ft=(performance||Date).now();if(ht.update(ft-lt,200),ft>at+1e3&&(ut.update(1e3*ct/(ft-at),100),at=ft,ct=0,dt)){var pt=performance.memory;dt.update(pt.usedJSHeapSize/1048576,pt.jsHeapSizeLimit/1048576)}return ft},update:function(){lt=this.end()},domElement:ot,setMode:it}};return rt.Panel=function(nt,it,st){var ot=1/0,lt=0,at=Math.round,ct=at(window.devicePixelRatio||1),ut=80*ct,ht=48*ct,dt=3*ct,ft=2*ct,pt=3*ct,mt=15*ct,gt=74*ct,vt=30*ct,At=document.createElement("canvas");At.width=ut,At.height=ht,At.style.cssText="width:80px;height:48px";var yt=At.getContext("2d");return yt.font="bold "+9*ct+"px Helvetica,Arial,sans-serif",yt.textBaseline="top",yt.fillStyle=st,yt.fillRect(0,0,ut,ht),yt.fillStyle=it,yt.fillText(nt,dt,ft),yt.fillRect(pt,mt,gt,vt),yt.fillStyle=st,yt.globalAlpha=.9,yt.fillRect(pt,mt,gt,vt),{dom:At,update:function(xt,_t){ot=Math.min(ot,xt),lt=Math.max(lt,xt),yt.fillStyle=st,yt.globalAlpha=1,yt.fillRect(0,0,ut,mt),yt.fillStyle=it,yt.fillText(at(xt)+" "+nt+" ("+at(ot)+"-"+at(lt)+")",dt,ft),yt.drawImage(At,pt+ct,mt,gt-ct,vt,pt,mt,gt-ct,vt),yt.fillRect(pt+gt-ct,mt,ct,vt),yt.fillStyle=st,yt.globalAlpha=.9,yt.fillRect(pt+gt-ct,mt,ct,at((1-xt/_t)*vt))}}},rt})})(stats_min);var stats_minExports=stats_min.exports;const StatsImpl=getDefaultExportFromCjs(stats_minExports);function call(tt,_e){typeof tt=="function"?tt(_e):tt!=null&&(tt.current=_e)}function useEffectfulState(tt,_e=[],rt){const[nt,it]=reactExports.useState();return reactExports.useLayoutEffect(()=>{const st=tt();return it(st),call(rt,st),()=>call(rt,null)},_e),nt}function Stats({showPanel:tt=0,className:_e,parent:rt}){const nt=useEffectfulState(()=>new StatsImpl,[]);return reactExports.useEffect(()=>{if(nt){const it=rt&&rt.current||document.body;nt.showPanel(tt),it==null||it.appendChild(nt.dom),_e&&nt.dom.classList.add(..._e.split(" ").filter(lt=>lt));const st=addEffect(()=>nt.begin()),ot=addAfterEffect(()=>nt.end());return()=>{it==null||it.removeChild(nt.dom),st(),ot()}}},[rt,nt,_e,tt]),null}const presetsObj={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},CUBEMAP_ROOT="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",isArray$1=tt=>Array.isArray(tt);function useEnvironment({files:tt=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:_e="",preset:rt=void 0,encoding:nt=void 0,extensions:it}={}){var st;let ot=null,lt=!1,at;if(rt){if(!(rt in presetsObj))throw new Error("Preset must be one of: "+Object.keys(presetsObj).join(", "));tt=presetsObj[rt],_e=CUBEMAP_ROOT}if(lt=isArray$1(tt),at=isArray$1(tt)?"cube":tt.startsWith("data:application/exr")?"exr":tt.startsWith("data:application/hdr")?"hdr":(st=tt.split(".").pop())==null?void 0:st.toLowerCase(),ot=lt?CubeTextureLoader:at==="hdr"?RGBELoader:at==="exr"?EXRLoader:null,!ot)throw new Error("useEnvironment: Unrecognized file extension: "+tt);const ct=useLoader(ot,lt?[tt]:tt,ft=>{ft.setPath==null||ft.setPath(_e),it&&it(ft)}),ut=lt?ct[0]:ct;ut.mapping=lt?CubeReflectionMapping:EquirectangularReflectionMapping;const ht=3001,dt=3e3;return"colorSpace"in ut?ut.colorSpace=nt??lt?"srgb":"srgb-linear":ut.encoding=nt??lt?ht:dt,ut}const isRef=tt=>tt.current&&tt.current.isScene,resolveScene=tt=>isRef(tt)?tt.current:tt;function setEnvProps(tt,_e,rt,nt,it=0){const st=resolveScene(_e||rt),ot=st.background,lt=st.environment,at=st.backgroundBlurriness||0;return tt!=="only"&&(st.environment=nt),tt&&(st.background=nt),tt&&st.backgroundBlurriness!==void 0&&(st.backgroundBlurriness=it),()=>{tt!=="only"&&(st.environment=lt),tt&&(st.background=ot),tt&&st.backgroundBlurriness!==void 0&&(st.backgroundBlurriness=at)}}function EnvironmentMap({scene:tt,background:_e=!1,blur:rt,map:nt}){const it=useThree(st=>st.scene);return reactExports.useLayoutEffect(()=>{if(nt)return setEnvProps(_e,tt,it,nt,rt)},[it,tt,nt,_e,rt]),null}function EnvironmentCube({background:tt=!1,scene:_e,blur:rt,...nt}){const it=useEnvironment(nt),st=useThree(ot=>ot.scene);return reactExports.useLayoutEffect(()=>setEnvProps(tt,_e,st,it,rt),[it,tt,_e,st,rt]),null}function EnvironmentPortal({children:tt,near:_e=1,far:rt=1e3,resolution:nt=256,frames:it=1,map:st,background:ot=!1,blur:lt,scene:at,files:ct,path:ut,preset:ht=void 0,extensions:dt}){const ft=useThree(yt=>yt.gl),pt=useThree(yt=>yt.scene),mt=reactExports.useRef(null),[gt]=reactExports.useState(()=>new Scene),vt=reactExports.useMemo(()=>{const yt=new WebGLCubeRenderTarget(nt);return yt.texture.type=HalfFloatType,yt},[nt]);reactExports.useLayoutEffect(()=>(it===1&&mt.current.update(ft,gt),setEnvProps(ot,at,pt,vt.texture,lt)),[tt,gt,vt.texture,at,pt,ot,it,ft]);let At=1;return useFrame(()=>{(it===1/0||At<it)&&(mt.current.update(ft,gt),At++)}),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(reactExports.Fragment,null,tt,reactExports.createElement("cubeCamera",{ref:mt,args:[_e,rt,vt]}),ct||ht?reactExports.createElement(EnvironmentCube,{background:!0,files:ct,preset:ht,path:ut,extensions:dt}):st?reactExports.createElement(EnvironmentMap,{background:!0,map:st,extensions:dt}):null),gt))}function EnvironmentGround(tt){var _e,rt,nt,it;const st=useEnvironment(tt),ot=tt.map||st;reactExports.useMemo(()=>extend$2({GroundProjectedEnvImpl:GroundProjectedEnv}),[]);const lt=reactExports.useMemo(()=>[ot],[ot]),at=(_e=tt.ground)==null?void 0:_e.height,ct=(rt=tt.ground)==null?void 0:rt.radius,ut=(nt=(it=tt.ground)==null?void 0:it.scale)!==null&&nt!==void 0?nt:1e3;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(EnvironmentMap,_extends$1({},tt,{map:ot})),reactExports.createElement("groundProjectedEnvImpl",{args:lt,scale:ut,height:at,radius:ct}))}function Environment(tt){return tt.ground?reactExports.createElement(EnvironmentGround,tt):tt.map?reactExports.createElement(EnvironmentMap,tt):tt.children?reactExports.createElement(EnvironmentPortal,tt):reactExports.createElement(EnvironmentCube,tt)}function calcPosFromAngles(tt,_e,rt=new Vector3){const nt=Math.PI*(tt-.5),it=2*Math.PI*(_e-.5);return rt.x=Math.cos(it),rt.y=Math.sin(nt),rt.z=Math.sin(it),rt}const Sky=reactExports.forwardRef(({inclination:tt=.6,azimuth:_e=.1,distance:rt=1e3,mieCoefficient:nt=.005,mieDirectionalG:it=.8,rayleigh:st=.5,turbidity:ot=10,sunPosition:lt=calcPosFromAngles(tt,_e),...at},ct)=>{const ut=reactExports.useMemo(()=>new Vector3().setScalar(rt),[rt]),[ht]=reactExports.useState(()=>new Sky$1);return reactExports.createElement("primitive",_extends$1({object:ht,ref:ct,"material-uniforms-mieCoefficient-value":nt,"material-uniforms-mieDirectionalG-value":it,"material-uniforms-rayleigh-value":st,"material-uniforms-sunPosition-value":lt,"material-uniforms-turbidity-value":ot,scale:ut},at))});function Box({color:tt,size:_e,scale:rt,children:nt,...it}){return jsxRuntimeExports.jsxs("mesh",{scale:rt,...it,children:[jsxRuntimeExports.jsx("boxGeometry",{args:_e}),jsxRuntimeExports.jsx("meshPhongMaterial",{color:tt}),nt]})}function Button3D(tt){const[_e,rt]=reactExports.useState(!1),[nt,it]=reactExports.useState(4292273),st=reactExports.useRef(),ot=()=>{it(Math.random()*16777215|0),window.opener&&window.close()};return jsxRuntimeExports.jsx("mesh",{ref:st,onPointerDown:()=>{console.log("click"),window.opener&&window.close()},children:jsxRuntimeExports.jsx(Interactive,{onSelect:ot,onHover:()=>rt(!0),onBlur:()=>rt(!1),children:jsxRuntimeExports.jsx(Box,{color:nt,scale:_e?[7.5,7.5,7.5]:[5,5,5],size:[.6,.1,.05],...tt,children:jsxRuntimeExports.jsx(Text,{position:[0,0,.05],fontSize:.05,color:"#000",anchorX:"center",anchorY:"middle",children:tt.text})})})})}const styles="";function composeRefs$2(...tt){return _e=>tt.forEach(rt=>function(nt,it){typeof nt=="function"?nt(it):nt!=null&&(nt.current=it)}(rt,_e))}const Slot$1=reactExports.forwardRef((tt,_e)=>{const{children:rt,...nt}=tt;return reactExports.Children.toArray(rt).some(l$4)?reactExports.createElement(reactExports.Fragment,null,reactExports.Children.map(rt,it=>l$4(it)?reactExports.createElement(n$4,_extends$1({},nt,{ref:_e}),it.props.children):it)):reactExports.createElement(n$4,_extends$1({},nt,{ref:_e}),rt)});Slot$1.displayName="Slot";const n$4=reactExports.forwardRef((tt,_e)=>{const{children:rt,...nt}=tt;return reactExports.isValidElement(rt)?reactExports.cloneElement(rt,{...o$5(nt,rt.props),ref:composeRefs$2(_e,rt.ref)}):reactExports.Children.count(rt)>1?reactExports.Children.only(null):null});n$4.displayName="SlotClone";const Slottable$1=({children:tt})=>reactExports.createElement(reactExports.Fragment,null,tt);function l$4(tt){return reactExports.isValidElement(tt)&&tt.type===Slottable$1}function o$5(tt,_e){const rt={..._e};for(const nt in _e){const it=tt[nt],st=_e[nt];/^on[A-Z]/.test(nt)?rt[nt]=(...ot)=>{st==null||st(...ot),it==null||it(...ot)}:nt==="style"?rt[nt]={...it,...st}:nt==="className"&&(rt[nt]=[it,st].filter(Boolean).join(" "))}return{...tt,...rt}}const Primitive$1=["a","button","div","h2","h3","img","li","nav","ol","p","span","svg","ul"].reduce((tt,_e)=>({...tt,[_e]:reactExports.forwardRef((rt,nt)=>{const{asChild:it,...st}=rt,ot=it?Slot$1:_e;return reactExports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),reactExports.createElement(ot,_extends$1({},st,{ref:nt}))})}),{}),useLayoutEffect$3=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},Portal$2=reactExports.forwardRef((tt,_e)=>{var rt,nt;const{containerRef:it,style:st,...ot}=tt,lt=(rt=it==null?void 0:it.current)!==null&&rt!==void 0?rt:globalThis==null||(nt=globalThis.document)===null||nt===void 0?void 0:nt.body,[,at]=reactExports.useState({});return useLayoutEffect$3(()=>{at({})},[]),lt?ReactDOM.createPortal(reactExports.createElement(Primitive$1.div,_extends$1({"data-radix-portal":""},ot,{ref:_e,style:lt===document.body?{position:"absolute",top:0,left:0,zIndex:2147483647,...st}:void 0})),lt):null}),Root$4=Portal$2;var has=Object.prototype.hasOwnProperty;function dequal(tt,_e){var rt,nt;if(tt===_e)return!0;if(tt&&_e&&(rt=tt.constructor)===_e.constructor){if(rt===Date)return tt.getTime()===_e.getTime();if(rt===RegExp)return tt.toString()===_e.toString();if(rt===Array){if((nt=tt.length)===_e.length)for(;nt--&&dequal(tt[nt],_e[nt]););return nt===-1}if(!rt||typeof tt=="object"){nt=0;for(rt in tt)if(has.call(tt,rt)&&++nt&&!has.call(_e,rt)||!(rt in _e)||!dequal(tt[rt],_e[rt]))return!1;return Object.keys(_e).length===nt}}return tt!==tt&&_e!==_e}var Rule=function(_e,rt,nt,it){this.name=_e,this.fn=rt,this.args=nt,this.modifiers=it};Rule.prototype._test=function(_e){var rt=this.fn;try{testAux(this.modifiers.slice(),rt,this)(_e)}catch{rt=function(){return!1}}try{return testAux(this.modifiers.slice(),rt,this)(_e)}catch{return!1}};Rule.prototype._check=function(_e){try{testAux(this.modifiers.slice(),this.fn,this)(_e)}catch{if(testAux(this.modifiers.slice(),function(nt){return nt},this)(!1))return}if(!testAux(this.modifiers.slice(),this.fn,this)(_e))throw null};Rule.prototype._testAsync=function(_e){var rt=this;return new Promise(function(nt,it){testAsyncAux(rt.modifiers.slice(),rt.fn,rt)(_e).then(function(st){st?nt(_e):it(null)}).catch(function(st){return it(st)})})};function pickFn(tt,_e){return _e===void 0&&(_e="simple"),typeof tt=="object"?tt[_e]:tt}function testAux(tt,_e,rt){if(tt.length){var nt=tt.shift(),it=testAux(tt,_e,rt);return nt.perform(it,rt)}else return pickFn(_e)}function testAsyncAux(tt,_e,rt){if(tt.length){var nt=tt.shift(),it=testAsyncAux(tt,_e,rt);return nt.performAsync(it,rt)}else return function(st){return Promise.resolve(pickFn(_e,"async")(st))}}var Modifier=function(_e,rt,nt){this.name=_e,this.perform=rt,this.performAsync=nt},ValidationError=function(tt){function _e(rt,nt,it,st){for(var ot=[],lt=arguments.length-4;lt-- >0;)ot[lt]=arguments[lt+4];tt.call(this,ot),tt.captureStackTrace&&tt.captureStackTrace(this,_e),this.rule=rt,this.value=nt,this.cause=it,this.target=st}return tt&&(_e.__proto__=tt),_e.prototype=Object.create(tt&&tt.prototype),_e.prototype.constructor=_e,_e}(Error),Context=function(_e,rt){_e===void 0&&(_e=[]),rt===void 0&&(rt=[]),this.chain=_e,this.nextRuleModifiers=rt};Context.prototype._applyRule=function(_e,rt){var nt=this;return function(){for(var it=[],st=arguments.length;st--;)it[st]=arguments[st];return nt.chain.push(new Rule(rt,_e.apply(nt,it),it,nt.nextRuleModifiers)),nt.nextRuleModifiers=[],nt}};Context.prototype._applyModifier=function(_e,rt){return this.nextRuleModifiers.push(new Modifier(rt,_e.simple,_e.async)),this};Context.prototype._clone=function(){return new Context(this.chain.slice(),this.nextRuleModifiers.slice())};Context.prototype.test=function(_e){return this.chain.every(function(rt){return rt._test(_e)})};Context.prototype.testAll=function(_e){var rt=[];return this.chain.forEach(function(nt){try{nt._check(_e)}catch(it){rt.push(new ValidationError(nt,_e,it))}}),rt};Context.prototype.check=function(_e){this.chain.forEach(function(rt){try{rt._check(_e)}catch(nt){throw new ValidationError(rt,_e,nt)}})};Context.prototype.testAsync=function(_e){var rt=this;return new Promise(function(nt,it){executeAsyncRules(_e,rt.chain.slice(),nt,it)})};function executeAsyncRules(tt,_e,rt,nt){if(_e.length){var it=_e.shift();it._testAsync(tt).then(function(){executeAsyncRules(tt,_e,rt,nt)},function(st){nt(new ValidationError(it,tt,st))})}else rt(tt)}var consideredEmpty=function(tt,_e){return _e&&typeof tt=="string"&&tt.trim().length===0?!0:tt==null};function optional(tt,_e){return _e===void 0&&(_e=!1),{simple:function(rt){return consideredEmpty(rt,_e)||tt.check(rt)===void 0},async:function(rt){return consideredEmpty(rt,_e)||tt.testAsync(rt)}}}function v8n(){return typeof Proxy<"u"?proxyContext(new Context):proxylessContext(new Context)}var customRules={};v8n.extend=function(tt){Object.assign(customRules,tt)};v8n.clearCustomRules=function(){customRules={}};function proxyContext(tt){return new Proxy(tt,{get:function(rt,nt){if(nt in rt)return rt[nt];var it=proxyContext(tt._clone());if(nt in availableModifiers)return it._applyModifier(availableModifiers[nt],nt);if(nt in customRules)return it._applyRule(customRules[nt],nt);if(nt in availableRules)return it._applyRule(availableRules[nt],nt)}})}function proxylessContext(tt){var _e=function(it,st){return Object.keys(it).forEach(function(ot){st[ot]=function(){for(var lt=[],at=arguments.length;at--;)lt[at]=arguments[at];var ct=proxylessContext(st._clone()),ut=ct._applyRule(it[ot],ot).apply(void 0,lt);return ut}}),st},rt=_e(availableRules,tt),nt=_e(customRules,rt);return Object.keys(availableModifiers).forEach(function(it){Object.defineProperty(nt,it,{get:function(){var st=proxylessContext(nt._clone());return st._applyModifier(availableModifiers[it],it)}})}),nt}var availableModifiers={not:{simple:function(tt){return function(_e){return!tt(_e)}},async:function(tt){return function(_e){return Promise.resolve(tt(_e)).then(function(rt){return!rt}).catch(function(){return!0})}}},some:{simple:function(tt){return function(_e){return split$1(_e).some(function(rt){try{return tt(rt)}catch{return!1}})}},async:function(tt){return function(_e){return Promise.all(split$1(_e).map(function(rt){try{return tt(rt).catch(function(){return!1})}catch{return!1}})).then(function(rt){return rt.some(Boolean)})}}},every:{simple:function(tt){return function(_e){return _e!==!1&&split$1(_e).every(tt)}},async:function(tt){return function(_e){return Promise.all(split$1(_e).map(tt)).then(function(rt){return rt.every(Boolean)})}}},strict:{simple:function(tt,_e){return function(rt){return isSchemaRule(_e)&&rt&&typeof rt=="object"?Object.keys(_e.args[0]).length===Object.keys(rt).length&&tt(rt):tt(rt)}},async:function(tt,_e){return function(rt){return Promise.resolve(tt(rt)).then(function(nt){return isSchemaRule(_e)&&rt&&typeof rt=="object"?Object.keys(_e.args[0]).length===Object.keys(rt).length&&nt:nt}).catch(function(){return!1})}}}};function isSchemaRule(tt){return tt&&tt.name==="schema"&&tt.args.length>0&&typeof tt.args[0]=="object"}function split$1(tt){return typeof tt=="string"?tt.split(""):tt}var availableRules={equal:function(tt){return function(_e){return _e==tt}},exact:function(tt){return function(_e){return _e===tt}},number:function(tt){return tt===void 0&&(tt=!0),function(_e){return typeof _e=="number"&&(tt||isFinite(_e))}},integer:function(){return function(tt){var _e=Number.isInteger||isIntegerPolyfill;return _e(tt)}},numeric:function(){return function(tt){return!isNaN(parseFloat(tt))&&isFinite(tt)}},string:function(){return testType("string")},boolean:function(){return testType("boolean")},undefined:function(){return testType("undefined")},null:function(){return testType("null")},array:function(){return testType("array")},object:function(){return testType("object")},instanceOf:function(tt){return function(_e){return _e instanceof tt}},pattern:function(tt){return function(_e){return tt.test(_e)}},lowercase:function(){return function(tt){return typeof tt=="boolean"||tt===tt.toLowerCase()&&tt.trim()!==""}},uppercase:function(){return function(tt){return tt===tt.toUpperCase()&&tt.trim()!==""}},vowel:function(){return function(tt){return/^[aeiou]+$/i.test(tt)}},consonant:function(){return function(tt){return/^(?=[^aeiou])([a-z]+)$/i.test(tt)}},first:function(tt){return function(_e){return _e[0]==tt}},last:function(tt){return function(_e){return _e[_e.length-1]==tt}},empty:function(){return function(tt){return tt.length===0}},length:function(tt,_e){return function(rt){return rt.length>=tt&&rt.length<=(_e||tt)}},minLength:function(tt){return function(_e){return _e.length>=tt}},maxLength:function(tt){return function(_e){return _e.length<=tt}},negative:function(){return function(tt){return tt<0}},positive:function(){return function(tt){return tt>=0}},between:function(tt,_e){return function(rt){return rt>=tt&&rt<=_e}},range:function(tt,_e){return function(rt){return rt>=tt&&rt<=_e}},lessThan:function(tt){return function(_e){return _e<tt}},lessThanOrEqual:function(tt){return function(_e){return _e<=tt}},greaterThan:function(tt){return function(_e){return _e>tt}},greaterThanOrEqual:function(tt){return function(_e){return _e>=tt}},even:function(){return function(tt){return tt%2===0}},odd:function(){return function(tt){return tt%2!==0}},includes:function(tt){return function(_e){return~_e.indexOf(tt)}},schema:function(tt){return testSchema(tt)},passesAnyOf:function(){for(var tt=[],_e=arguments.length;_e--;)tt[_e]=arguments[_e];return function(rt){return tt.some(function(nt){return nt.test(rt)})}},optional};function testType(tt){return function(_e){return Array.isArray(_e)&&tt==="array"||_e===null&&tt==="null"||typeof _e===tt}}function isIntegerPolyfill(tt){return typeof tt=="number"&&isFinite(tt)&&Math.floor(tt)===tt}function testSchema(tt){return{simple:function(_e){var rt=[];if(Object.keys(tt).forEach(function(nt){var it=tt[nt];try{it.check((_e||{})[nt])}catch(st){st.target=nt,rt.push(st)}}),rt.length>0)throw rt;return!0},async:function(_e){var rt=[],nt=Object.keys(tt).map(function(it){var st=tt[it];return st.testAsync((_e||{})[it]).catch(function(ot){ot.target=it,rt.push(ot)})});return Promise.all(nt).then(function(){if(rt.length>0)throw rt;return!0})}}}var e$3="colors",t$4="sizes",r$4="space",n$3={gap:r$4,gridGap:r$4,columnGap:r$4,gridColumnGap:r$4,rowGap:r$4,gridRowGap:r$4,inset:r$4,insetBlock:r$4,insetBlockEnd:r$4,insetBlockStart:r$4,insetInline:r$4,insetInlineEnd:r$4,insetInlineStart:r$4,margin:r$4,marginTop:r$4,marginRight:r$4,marginBottom:r$4,marginLeft:r$4,marginBlock:r$4,marginBlockEnd:r$4,marginBlockStart:r$4,marginInline:r$4,marginInlineEnd:r$4,marginInlineStart:r$4,padding:r$4,paddingTop:r$4,paddingRight:r$4,paddingBottom:r$4,paddingLeft:r$4,paddingBlock:r$4,paddingBlockEnd:r$4,paddingBlockStart:r$4,paddingInline:r$4,paddingInlineEnd:r$4,paddingInlineStart:r$4,top:r$4,right:r$4,bottom:r$4,left:r$4,scrollMargin:r$4,scrollMarginTop:r$4,scrollMarginRight:r$4,scrollMarginBottom:r$4,scrollMarginLeft:r$4,scrollMarginX:r$4,scrollMarginY:r$4,scrollMarginBlock:r$4,scrollMarginBlockEnd:r$4,scrollMarginBlockStart:r$4,scrollMarginInline:r$4,scrollMarginInlineEnd:r$4,scrollMarginInlineStart:r$4,scrollPadding:r$4,scrollPaddingTop:r$4,scrollPaddingRight:r$4,scrollPaddingBottom:r$4,scrollPaddingLeft:r$4,scrollPaddingX:r$4,scrollPaddingY:r$4,scrollPaddingBlock:r$4,scrollPaddingBlockEnd:r$4,scrollPaddingBlockStart:r$4,scrollPaddingInline:r$4,scrollPaddingInlineEnd:r$4,scrollPaddingInlineStart:r$4,fontSize:"fontSizes",background:e$3,backgroundColor:e$3,backgroundImage:e$3,borderImage:e$3,border:e$3,borderBlock:e$3,borderBlockEnd:e$3,borderBlockStart:e$3,borderBottom:e$3,borderBottomColor:e$3,borderColor:e$3,borderInline:e$3,borderInlineEnd:e$3,borderInlineStart:e$3,borderLeft:e$3,borderLeftColor:e$3,borderRight:e$3,borderRightColor:e$3,borderTop:e$3,borderTopColor:e$3,caretColor:e$3,color:e$3,columnRuleColor:e$3,fill:e$3,outline:e$3,outlineColor:e$3,stroke:e$3,textDecorationColor:e$3,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:t$4,minBlockSize:t$4,maxBlockSize:t$4,inlineSize:t$4,minInlineSize:t$4,maxInlineSize:t$4,width:t$4,minWidth:t$4,maxWidth:t$4,height:t$4,minHeight:t$4,maxHeight:t$4,flexBasis:t$4,gridTemplateColumns:t$4,gridTemplateRows:t$4,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},i$4=(tt,_e)=>typeof _e=="function"?{"()":Function.prototype.toString.call(_e)}:_e,o$4=()=>{const tt=Object.create(null);return(_e,rt,...nt)=>{const it=(st=>JSON.stringify(st,i$4))(_e);return it in tt?tt[it]:tt[it]=rt(_e,...nt)}},l$3=Symbol.for("sxs.internal"),s$3=(tt,_e)=>Object.defineProperties(tt,Object.getOwnPropertyDescriptors(_e)),a$2=tt=>{for(const _e in tt)return!0;return!1},{hasOwnProperty:c$4}=Object.prototype,d$3=tt=>tt.includes("-")?tt:tt.replace(/[A-Z]/g,_e=>"-"+_e.toLowerCase()),g$3=/\s+(?![^()]*\))/,p$3=tt=>_e=>tt(...typeof _e=="string"?String(_e).split(g$3):[_e]),u$3={appearance:tt=>({WebkitAppearance:tt,appearance:tt}),backfaceVisibility:tt=>({WebkitBackfaceVisibility:tt,backfaceVisibility:tt}),backdropFilter:tt=>({WebkitBackdropFilter:tt,backdropFilter:tt}),backgroundClip:tt=>({WebkitBackgroundClip:tt,backgroundClip:tt}),boxDecorationBreak:tt=>({WebkitBoxDecorationBreak:tt,boxDecorationBreak:tt}),clipPath:tt=>({WebkitClipPath:tt,clipPath:tt}),content:tt=>({content:tt.includes('"')||tt.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(tt)?tt:`"${tt}"`}),hyphens:tt=>({WebkitHyphens:tt,hyphens:tt}),maskImage:tt=>({WebkitMaskImage:tt,maskImage:tt}),maskSize:tt=>({WebkitMaskSize:tt,maskSize:tt}),tabSize:tt=>({MozTabSize:tt,tabSize:tt}),textSizeAdjust:tt=>({WebkitTextSizeAdjust:tt,textSizeAdjust:tt}),userSelect:tt=>({WebkitUserSelect:tt,userSelect:tt}),marginBlock:p$3((tt,_e)=>({marginBlockStart:tt,marginBlockEnd:_e||tt})),marginInline:p$3((tt,_e)=>({marginInlineStart:tt,marginInlineEnd:_e||tt})),maxSize:p$3((tt,_e)=>({maxBlockSize:tt,maxInlineSize:_e||tt})),minSize:p$3((tt,_e)=>({minBlockSize:tt,minInlineSize:_e||tt})),paddingBlock:p$3((tt,_e)=>({paddingBlockStart:tt,paddingBlockEnd:_e||tt})),paddingInline:p$3((tt,_e)=>({paddingInlineStart:tt,paddingInlineEnd:_e||tt}))},h$3=/([\d.]+)([^]*)/,f$3=(tt,_e)=>tt.length?tt.reduce((rt,nt)=>(rt.push(..._e.map(it=>it.includes("&")?it.replace(/&/g,/[ +>|~]/.test(nt)&&/&.*&/.test(it)?`:is(${nt})`:nt):nt+" "+it)),rt),[]):_e,m$3=(tt,_e)=>tt in b$3&&typeof _e=="string"?_e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(rt,nt,it,st)=>nt+(it==="stretch"?`-moz-available${st};${d$3(tt)}:${nt}-webkit-fill-available`:`-moz-fit-content${st};${d$3(tt)}:${nt}fit-content`)+st):String(_e),b$3={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},S$2=tt=>tt?tt+"-":"",k$3=(tt,_e,rt)=>tt.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(nt,it,st,ot,lt)=>ot=="$"==!!st?nt:(it||ot=="--"?"calc(":"")+"var(--"+(ot==="$"?S$2(_e)+(lt.includes("$")?"":S$2(rt))+lt.replace(/\$/g,"-"):lt)+")"+(it||ot=="--"?"*"+(it||"")+(st||"1")+")":"")),y$3=/\s*,\s*(?![^()]*\))/,B=Object.prototype.toString,$$2=(tt,_e,rt,nt,it)=>{let st,ot,lt;const at=(ct,ut,ht)=>{let dt,ft;const pt=mt=>{for(dt in mt){const At=dt.charCodeAt(0)===64,yt=At&&Array.isArray(mt[dt])?mt[dt]:[mt[dt]];for(ft of yt){const xt=/[A-Z]/.test(vt=dt)?vt:vt.replace(/-[^]/g,Et=>Et[1].toUpperCase()),_t=typeof ft=="object"&&ft&&ft.toString===B&&(!nt.utils[xt]||!ut.length);if(xt in nt.utils&&!_t){const Et=nt.utils[xt];if(Et!==ot){ot=Et,pt(Et(ft)),ot=null;continue}}else if(xt in u$3){const Et=u$3[xt];if(Et!==lt){lt=Et,pt(Et(ft)),lt=null;continue}}if(At&&(gt=dt.slice(1)in nt.media?"@media "+nt.media[dt.slice(1)]:dt,dt=gt.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(Et,bt,wt,Tt,Mt,Pt)=>{const It=h$3.test(bt),Ot=.0625*(It?-1:1),[Bt,Ut]=It?[Tt,bt]:[bt,Tt];return"("+(wt[0]==="="?"":wt[0]===">"===It?"max-":"min-")+Bt+":"+(wt[0]!=="="&&wt.length===1?Ut.replace(h$3,(Ft,jt,Dt)=>Number(jt)+Ot*(wt===">"?1:-1)+Dt):Ut)+(Mt?") and ("+(Mt[0]===">"?"min-":"max-")+Bt+":"+(Mt.length===1?Pt.replace(h$3,(Ft,jt,Dt)=>Number(jt)+Ot*(Mt===">"?-1:1)+Dt):Pt):"")+")"})),_t){const Et=At?ht.concat(dt):[...ht],bt=At?[...ut]:f$3(ut,dt.split(y$3));st!==void 0&&it(x$2(...st)),st=void 0,at(ft,bt,Et)}else st===void 0&&(st=[[],ut,ht]),dt=At||dt.charCodeAt(0)!==36?dt:`--${S$2(nt.prefix)}${dt.slice(1).replace(/\$/g,"-")}`,ft=_t?ft:typeof ft=="number"?ft&&xt in I$2?String(ft)+"px":String(ft):k$3(m$3(xt,ft??""),nt.prefix,nt.themeMap[xt]),st[0].push(`${At?`${dt} `:`${d$3(dt)}:`}${ft}`)}}var gt,vt};pt(ct),st!==void 0&&it(x$2(...st)),st=void 0};at(tt,_e,rt)},x$2=(tt,_e,rt)=>`${rt.map(nt=>`${nt}{`).join("")}${_e.length?`${_e.join(",")}{`:""}${tt.join(";")}${_e.length?"}":""}${Array(rt.length?rt.length+1:0).join("}")}`,I$2={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},R=tt=>String.fromCharCode(tt+(tt>25?39:97)),z=tt=>(_e=>{let rt,nt="";for(rt=Math.abs(_e);rt>52;rt=rt/52|0)nt=R(rt%52)+nt;return R(rt%52)+nt})(((_e,rt)=>{let nt=rt.length;for(;nt;)_e=33*_e^rt.charCodeAt(--nt);return _e})(5381,JSON.stringify(tt))>>>0),W=["themed","global","styled","onevar","resonevar","allvar","inline"],j$1=tt=>{if(tt.href&&!tt.href.startsWith(location.origin))return!1;try{return!!tt.cssRules}catch{return!1}},E$1=tt=>{let _e;const rt=()=>{const{cssRules:it}=_e.sheet;return[].map.call(it,(st,ot)=>{const{cssText:lt}=st;let at="";if(lt.startsWith("--sxs"))return"";if(it[ot-1]&&(at=it[ot-1].cssText).startsWith("--sxs")){if(!st.cssRules.length)return"";for(const ct in _e.rules)if(_e.rules[ct].group===st)return`--sxs{--sxs:${[..._e.rules[ct].cache].join(" ")}}${lt}`;return st.cssRules.length?`${at}${lt}`:""}return lt}).join("")},nt=()=>{if(_e){const{rules:lt,sheet:at}=_e;if(!at.deleteRule){for(;Object(Object(at.cssRules)[0]).type===3;)at.cssRules.splice(0,1);at.cssRules=[]}for(const ct in lt)delete lt[ct]}const it=Object(tt).styleSheets||[];for(const lt of it)if(j$1(lt)){for(let at=0,ct=lt.cssRules;ct[at];++at){const ut=Object(ct[at]);if(ut.type!==1)continue;const ht=Object(ct[at+1]);if(ht.type!==4)continue;++at;const{cssText:dt}=ut;if(!dt.startsWith("--sxs"))continue;const ft=dt.slice(14,-3).trim().split(/\s+/),pt=W[ft[0]];pt&&(_e||(_e={sheet:lt,reset:nt,rules:{},toString:rt}),_e.rules[pt]={group:ht,index:at,cache:new Set(ft)})}if(_e)break}if(!_e){const lt=(at,ct)=>({type:ct,cssRules:[],insertRule(ut,ht){this.cssRules.splice(ht,0,lt(ut,{import:3,undefined:1}[(ut.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return at==="@media{}"?`@media{${[].map.call(this.cssRules,ut=>ut.cssText).join("")}}`:at}});_e={sheet:tt?(tt.head||tt).appendChild(document.createElement("style")).sheet:lt("","text/css"),rules:{},reset:nt,toString:rt}}const{sheet:st,rules:ot}=_e;for(let lt=W.length-1;lt>=0;--lt){const at=W[lt];if(!ot[at]){const ct=W[lt+1],ut=ot[ct]?ot[ct].index:st.cssRules.length;st.insertRule("@media{}",ut),st.insertRule(`--sxs{--sxs:${lt}}`,ut),ot[at]={group:st.cssRules[ut+1],index:ut,cache:new Set([lt])}}v$3(ot[at])}};return nt(),_e},v$3=tt=>{const _e=tt.group;let rt=_e.cssRules.length;tt.apply=nt=>{try{_e.insertRule(nt,rt),++rt}catch{}}},T$1=Symbol(),w$2=o$4(),M$1=(tt,_e)=>w$2(tt,()=>(...rt)=>{let nt={type:null,composers:new Set};for(const it of rt)if(it!=null)if(it[l$3]){nt.type==null&&(nt.type=it[l$3].type);for(const st of it[l$3].composers)nt.composers.add(st)}else it.constructor!==Object||it.$$typeof?nt.type==null&&(nt.type=it):nt.composers.add(C(it,tt));return nt.type==null&&(nt.type="span"),nt.composers.size||nt.composers.add(["PJLV",{},[],[],{},[]]),P(tt,nt,_e)}),C=({variants:tt,compoundVariants:_e,defaultVariants:rt,...nt},it)=>{const st=`${S$2(it.prefix)}c-${z(nt)}`,ot=[],lt=[],at=Object.create(null),ct=[];for(const dt in rt)at[dt]=String(rt[dt]);if(typeof tt=="object"&&tt)for(const dt in tt){ut=at,ht=dt,c$4.call(ut,ht)||(at[dt]="undefined");const ft=tt[dt];for(const pt in ft){const mt={[dt]:String(pt)};String(pt)==="undefined"&&ct.push(dt);const gt=ft[pt],vt=[mt,gt,!a$2(gt)];ot.push(vt)}}var ut,ht;if(typeof _e=="object"&&_e)for(const dt of _e){let{css:ft,...pt}=dt;ft=typeof ft=="object"&&ft||{};for(const gt in pt)pt[gt]=String(pt[gt]);const mt=[pt,ft,!a$2(ft)];lt.push(mt)}return[st,nt,ot,lt,at,ct]},P=(tt,_e,rt)=>{const[nt,it,st,ot]=L$1(_e.composers),lt=typeof _e.type=="function"||_e.type.$$typeof?(ht=>{function dt(){for(let ft=0;ft<dt[T$1].length;ft++){const[pt,mt]=dt[T$1][ft];ht.rules[pt].apply(mt)}return dt[T$1]=[],null}return dt[T$1]=[],dt.rules={},W.forEach(ft=>dt.rules[ft]={apply:pt=>dt[T$1].push([ft,pt])}),dt})(rt):null,at=(lt||rt).rules,ct=`.${nt}${it.length>1?`:where(.${it.slice(1).join(".")})`:""}`,ut=ht=>{ht=typeof ht=="object"&&ht||A;const{css:dt,...ft}=ht,pt={};for(const vt in st)if(delete ft[vt],vt in ht){let At=ht[vt];typeof At=="object"&&At?pt[vt]={"@initial":st[vt],...At}:(At=String(At),pt[vt]=At!=="undefined"||ot.has(vt)?At:st[vt])}else pt[vt]=st[vt];const mt=new Set([...it]);for(const[vt,At,yt,xt]of _e.composers){rt.rules.styled.cache.has(vt)||(rt.rules.styled.cache.add(vt),$$2(At,[`.${vt}`],[],tt,bt=>{at.styled.apply(bt)}));const _t=O(yt,pt,tt.media),Et=O(xt,pt,tt.media,!0);for(const bt of _t)if(bt!==void 0)for(const[wt,Tt,Mt]of bt){const Pt=`${vt}-${z(Tt)}-${wt}`;mt.add(Pt);const It=(Mt?rt.rules.resonevar:rt.rules.onevar).cache,Ot=Mt?at.resonevar:at.onevar;It.has(Pt)||(It.add(Pt),$$2(Tt,[`.${Pt}`],[],tt,Bt=>{Ot.apply(Bt)}))}for(const bt of Et)if(bt!==void 0)for(const[wt,Tt]of bt){const Mt=`${vt}-${z(Tt)}-${wt}`;mt.add(Mt),rt.rules.allvar.cache.has(Mt)||(rt.rules.allvar.cache.add(Mt),$$2(Tt,[`.${Mt}`],[],tt,Pt=>{at.allvar.apply(Pt)}))}}if(typeof dt=="object"&&dt){const vt=`${nt}-i${z(dt)}-css`;mt.add(vt),rt.rules.inline.cache.has(vt)||(rt.rules.inline.cache.add(vt),$$2(dt,[`.${vt}`],[],tt,At=>{at.inline.apply(At)}))}for(const vt of String(ht.className||"").trim().split(/\s+/))vt&&mt.add(vt);const gt=ft.className=[...mt].join(" ");return{type:_e.type,className:gt,selector:ct,props:ft,toString:()=>gt,deferredInjector:lt}};return s$3(ut,{className:nt,selector:ct,[l$3]:_e,toString:()=>(rt.rules.styled.cache.has(nt)||ut(),nt)})},L$1=tt=>{let _e="";const rt=[],nt={},it=[];for(const[st,,,,ot,lt]of tt){_e===""&&(_e=st),rt.push(st),it.push(...lt);for(const at in ot){const ct=ot[at];(nt[at]===void 0||ct!=="undefined"||lt.includes(ct))&&(nt[at]=ct)}}return[_e,rt,nt,new Set(it)]},O=(tt,_e,rt,nt)=>{const it=[];e:for(let[st,ot,lt]of tt){if(lt)continue;let at,ct=0,ut=!1;for(at in st){const ht=st[at];let dt=_e[at];if(dt!==ht){if(typeof dt!="object"||!dt)continue e;{let ft,pt,mt=0;for(const gt in dt){if(ht===String(dt[gt])){if(gt!=="@initial"){const vt=gt.slice(1);(pt=pt||[]).push(vt in rt?rt[vt]:gt.replace(/^@media ?/,"")),ut=!0}ct+=mt,ft=!0}++mt}if(pt&&pt.length&&(ot={["@media "+pt.join(", ")]:ot}),!ft)continue e}}}(it[ct]=it[ct]||[]).push([nt?"cv":`${at}-${st[at]}`,ot,ut])}return it},A={},N$1=o$4(),D=(tt,_e)=>N$1(tt,()=>(...rt)=>{const nt=()=>{for(let it of rt){it=typeof it=="object"&&it||{};let st=z(it);if(!_e.rules.global.cache.has(st)){if(_e.rules.global.cache.add(st),"@import"in it){let ot=[].indexOf.call(_e.sheet.cssRules,_e.rules.themed.group)-1;for(let lt of[].concat(it["@import"]))lt=lt.includes('"')||lt.includes("'")?lt:`"${lt}"`,_e.sheet.insertRule(`@import ${lt};`,ot++);delete it["@import"]}$$2(it,[],[],tt,ot=>{_e.rules.global.apply(ot)})}}return""};return s$3(nt,{toString:nt})}),H$1=o$4(),V$1=(tt,_e)=>H$1(tt,()=>rt=>{const nt=`${S$2(tt.prefix)}k-${z(rt)}`,it=()=>{if(!_e.rules.global.cache.has(nt)){_e.rules.global.cache.add(nt);const st=[];$$2(rt,[],[],tt,lt=>st.push(lt));const ot=`@keyframes ${nt}{${st.join("")}}`;_e.rules.global.apply(ot)}return nt};return s$3(it,{get name(){return it()},toString:it})}),G=class{constructor(tt,_e,rt,nt){this.token=tt==null?"":String(tt),this.value=_e==null?"":String(_e),this.scale=rt==null?"":String(rt),this.prefix=nt==null?"":String(nt)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+S$2(this.prefix)+S$2(this.scale)+this.token}toString(){return this.computedValue}},F$1=o$4(),J$1=(tt,_e)=>F$1(tt,()=>(rt,nt)=>{nt=typeof rt=="object"&&rt||Object(nt);const it=`.${rt=(rt=typeof rt=="string"?rt:"")||`${S$2(tt.prefix)}t-${z(nt)}`}`,st={},ot=[];for(const at in nt){st[at]={};for(const ct in nt[at]){const ut=`--${S$2(tt.prefix)}${at}-${ct}`,ht=k$3(String(nt[at][ct]),tt.prefix,at);st[at][ct]=new G(ct,ht,at,tt.prefix),ot.push(`${ut}:${ht}`)}}const lt=()=>{if(ot.length&&!_e.rules.themed.cache.has(rt)){_e.rules.themed.cache.add(rt);const at=`${nt===tt.theme?":root,":""}.${rt}{${ot.join(";")}}`;_e.rules.themed.apply(at)}return rt};return{...st,get className(){return lt()},selector:it,toString:lt}}),U$1=o$4(),Y$1=o$4(),q$1=tt=>{const _e=(rt=>{let nt=!1;const it=U$1(rt,st=>{nt=!0;const ot="prefix"in(st=typeof st=="object"&&st||{})?String(st.prefix):"",lt=typeof st.media=="object"&&st.media||{},at=typeof st.root=="object"?st.root||null:globalThis.document||null,ct=typeof st.theme=="object"&&st.theme||{},ut={prefix:ot,media:lt,theme:ct,themeMap:typeof st.themeMap=="object"&&st.themeMap||{...n$3},utils:typeof st.utils=="object"&&st.utils||{}},ht=E$1(at),dt={css:M$1(ut,ht),globalCss:D(ut,ht),keyframes:V$1(ut,ht),createTheme:J$1(ut,ht),reset(){ht.reset(),dt.theme.toString()},theme:{},sheet:ht,config:ut,prefix:ot,getCssText:ht.toString,toString:ht.toString};return String(dt.theme=dt.createTheme(ct)),dt});return nt||it.reset(),it})(tt);return _e.styled=(({config:rt,sheet:nt})=>Y$1(rt,()=>{const it=M$1(rt,nt);return(...st)=>{const ot=it(...st),lt=ot[l$3].type,at=React.forwardRef((ct,ut)=>{const ht=ct&&ct.as||lt,{props:dt,deferredInjector:ft}=ot(ct);return delete dt.as,dt.ref=ut,ft?React.createElement(React.Fragment,null,React.createElement(ht,dt),React.createElement(ft,null)):React.createElement(ht,dt)});return at.className=ot.className,at.displayName=`Styled.${lt.displayName||lt.name||lt}`,at.selector=ot.selector,at.toString=()=>ot.selector,at[l$3]=ot[l$3],at}}))(_e),_e};const useLayoutEffect$2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},r$3=t$5["useId".toString()]||(()=>{});let i$3=0;function useId(tt){const[_e,rt]=reactExports.useState(r$3());return useLayoutEffect$2(()=>{tt||rt(nt=>nt??String(i$3++))},[tt]),tt||(_e?`radix-${_e}`:"")}function composeRefs$1(...tt){return _e=>tt.forEach(rt=>function(nt,it){typeof nt=="function"?nt(it):nt!=null&&(nt.current=it)}(rt,_e))}function useComposedRefs$1(...tt){return reactExports.useCallback(composeRefs$1(...tt),tt)}const Slot=reactExports.forwardRef((tt,_e)=>{const{children:rt,...nt}=tt;return reactExports.Children.toArray(rt).some(l$2)?reactExports.createElement(reactExports.Fragment,null,reactExports.Children.map(rt,it=>l$2(it)?reactExports.createElement(n$2,_extends$1({},nt,{ref:_e}),it.props.children):it)):reactExports.createElement(n$2,_extends$1({},nt,{ref:_e}),rt)});Slot.displayName="Slot";const n$2=reactExports.forwardRef((tt,_e)=>{const{children:rt,...nt}=tt;return reactExports.isValidElement(rt)?reactExports.cloneElement(rt,{...o$3(nt,rt.props),ref:composeRefs$1(_e,rt.ref)}):reactExports.Children.count(rt)>1?reactExports.Children.only(null):null});n$2.displayName="SlotClone";const Slottable=({children:tt})=>reactExports.createElement(reactExports.Fragment,null,tt);function l$2(tt){return reactExports.isValidElement(tt)&&tt.type===Slottable}function o$3(tt,_e){const rt={..._e};for(const nt in _e){const it=tt[nt],st=_e[nt];/^on[A-Z]/.test(nt)?rt[nt]=(...ot)=>{st==null||st(...ot),it==null||it(...ot)}:nt==="style"?rt[nt]={...it,...st}:nt==="className"&&(rt[nt]=[it,st].filter(Boolean).join(" "))}return{...tt,...rt}}const Primitive=["a","button","div","h2","h3","img","li","nav","p","span","svg","ul"].reduce((tt,_e)=>({...tt,[_e]:reactExports.forwardRef((rt,nt)=>{const{asChild:it,...st}=rt,ot=it?Slot:_e;return reactExports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),rt.as&&console.error(o$2),reactExports.createElement(ot,_extends$1({},st,{ref:nt}))})}),{}),o$2="Warning: The `as` prop has been removed in favour of `asChild`. For details, see https://radix-ui.com/docs/primitives/overview/styling#changing-the-rendered-element",VisuallyHidden=reactExports.forwardRef((tt,_e)=>reactExports.createElement(Primitive.span,_extends$1({},tt,{ref:_e,style:{...tt.style,position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}}))),Root$3=VisuallyHidden,useLayoutEffect$1=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},Portal$1=reactExports.forwardRef((tt,_e)=>{var rt,nt;const{containerRef:it,style:st,...ot}=tt,lt=(rt=it==null?void 0:it.current)!==null&&rt!==void 0?rt:globalThis==null||(nt=globalThis.document)===null||nt===void 0?void 0:nt.body,[,at]=reactExports.useState({});return useLayoutEffect$1(()=>{at({})},[]),lt?ReactDOM.createPortal(reactExports.createElement(Primitive.div,_extends$1({"data-radix-portal":""},ot,{ref:_e,style:lt===document.body?{position:"absolute",top:0,left:0,zIndex:2147483647,...st}:void 0})),lt):null}),Arrow$2=reactExports.forwardRef((tt,_e)=>{const{children:rt,width:nt=10,height:it=5,...st}=tt;return reactExports.createElement(Primitive.svg,_extends$1({},st,{ref:_e,width:nt,height:it,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),tt.asChild?rt:reactExports.createElement("polygon",{points:"0,0 30,0 15,10"}))}),Root$2=Arrow$2;function useSize(tt){const[_e,rt]=reactExports.useState(void 0);return reactExports.useEffect(()=>{if(tt){const nt=new ResizeObserver(it=>{if(!Array.isArray(it)||!it.length)return;const st=it[0];let ot,lt;if("borderBoxSize"in st){const at=st.borderBoxSize,ct=Array.isArray(at)?at[0]:at;ot=ct.inlineSize,lt=ct.blockSize}else{const at=tt.getBoundingClientRect();ot=at.width,lt=at.height}rt({width:ot,height:lt})});return nt.observe(tt,{box:"border-box"}),()=>{rt(void 0),nt.unobserve(tt)}}},[tt]),_e}function observeElementRect(tt,_e){const rt=e$2.get(tt);return rt===void 0?(e$2.set(tt,{rect:{},callbacks:[_e]}),e$2.size===1&&(t$3=requestAnimationFrame(c$3))):(rt.callbacks.push(_e),_e(tt.getBoundingClientRect())),()=>{const nt=e$2.get(tt);if(nt===void 0)return;const it=nt.callbacks.indexOf(_e);it>-1&&nt.callbacks.splice(it,1),nt.callbacks.length===0&&(e$2.delete(tt),e$2.size===0&&cancelAnimationFrame(t$3))}}let t$3;const e$2=new Map;function c$3(){const tt=[];e$2.forEach((_e,rt)=>{const nt=rt.getBoundingClientRect();var it,st;it=_e.rect,st=nt,(it.width!==st.width||it.height!==st.height||it.top!==st.top||it.right!==st.right||it.bottom!==st.bottom||it.left!==st.left)&&(_e.rect=nt,tt.push(_e))}),tt.forEach(_e=>{_e.callbacks.forEach(rt=>rt(_e.rect))}),t$3=requestAnimationFrame(c$3)}function useRect(tt){const[_e,rt]=reactExports.useState();return reactExports.useEffect(()=>{if(tt){const nt=observeElementRect(tt,rt);return()=>{rt(void 0),nt()}}},[tt]),_e}function createContextScope(tt,_e=[]){let rt=[];const nt=()=>{const it=rt.map(st=>reactExports.createContext(st));return function(st){const ot=(st==null?void 0:st[tt])||it;return reactExports.useMemo(()=>({[`__scope${tt}`]:{...st,[tt]:ot}}),[st,ot])}};return nt.scopeName=tt,[function(it,st){const ot=reactExports.createContext(st),lt=rt.length;function at(ct){const{scope:ut,children:ht,...dt}=ct,ft=(ut==null?void 0:ut[tt][lt])||ot,pt=reactExports.useMemo(()=>dt,Object.values(dt));return reactExports.createElement(ft.Provider,{value:pt},ht)}return rt=[...rt,st],at.displayName=it+"Provider",[at,function(ct,ut){const ht=(ut==null?void 0:ut[tt][lt])||ot,dt=reactExports.useContext(ht);if(dt)return dt;if(st!==void 0)return st;throw new Error(`\`${ct}\` must be used within \`${it}\``)}]},t$2(nt,..._e)]}function t$2(...tt){const _e=tt[0];if(tt.length===1)return _e;const rt=()=>{const nt=tt.map(it=>({useScope:it(),scopeName:it.scopeName}));return function(it){const st=nt.reduce((ot,{useScope:lt,scopeName:at})=>({...ot,...lt(it)[`__scope${at}`]}),{});return reactExports.useMemo(()=>({[`__scope${_e.scopeName}`]:st}),[st])}};return rt.scopeName=_e.scopeName,rt}function getPlacementData({anchorRect:tt,popperSize:_e,arrowSize:rt,arrowOffset:nt=0,side:it,sideOffset:st=0,align:ot,alignOffset:lt=0,shouldAvoidCollisions:at=!0,collisionBoundariesRect:ct,collisionTolerance:ut=0}){if(!tt||!_e||!ct)return{popperStyles:o$1,arrowStyles:n$1};const ht=function(bt,wt,Tt=0,Mt=0,Pt){const It=Pt?Pt.height:0,Ot=t$1(wt,bt,"x"),Bt=t$1(wt,bt,"y"),Ut=Bt.before-Tt-It,Ft=Bt.after+Tt+It,jt=Ot.before-Tt-It,Dt=Ot.after+Tt+It;return{top:{start:{x:Ot.start+Mt,y:Ut},center:{x:Ot.center,y:Ut},end:{x:Ot.end-Mt,y:Ut}},right:{start:{x:Dt,y:Bt.start+Mt},center:{x:Dt,y:Bt.center},end:{x:Dt,y:Bt.end-Mt}},bottom:{start:{x:Ot.start+Mt,y:Ft},center:{x:Ot.center,y:Ft},end:{x:Ot.end-Mt,y:Ft}},left:{start:{x:jt,y:Bt.start+Mt},center:{x:jt,y:Bt.center},end:{x:jt,y:Bt.end-Mt}}}}(_e,tt,st,lt,rt),dt=ht[it][ot];if(at===!1){const bt=e$1(dt);let wt=n$1;return rt&&(wt=i$2({popperSize:_e,arrowSize:rt,arrowOffset:nt,side:it,align:ot})),{popperStyles:{...bt,"--radix-popper-transform-origin":r$2(_e,it,ot,nt,rt)},arrowStyles:wt,placedSide:it,placedAlign:ot}}const ft=DOMRect.fromRect({..._e,...dt}),pt=(mt=ct,gt=ut,DOMRect.fromRect({width:mt.width-2*gt,height:mt.height-2*gt,x:mt.left+gt,y:mt.top+gt}));var mt,gt;const vt=s$2(ft,pt),At=ht[a$1(it)][ot],yt=function(bt,wt,Tt){const Mt=a$1(bt);return wt[bt]&&!Tt[Mt]?Mt:bt}(it,vt,s$2(DOMRect.fromRect({..._e,...At}),pt)),xt=function(bt,wt,Tt,Mt,Pt){const It=Tt==="top"||Tt==="bottom",Ot=It?"left":"top",Bt=It?"right":"bottom",Ut=It?"width":"height",Ft=wt[Ut]>bt[Ut];return(Mt==="start"||Mt==="center")&&(Pt[Ot]&&Ft||Pt[Bt]&&!Ft)?"end":(Mt==="end"||Mt==="center")&&(Pt[Bt]&&Ft||Pt[Ot]&&!Ft)?"start":Mt}(_e,tt,it,ot,vt),_t=e$1(ht[yt][xt]);let Et=n$1;return rt&&(Et=i$2({popperSize:_e,arrowSize:rt,arrowOffset:nt,side:yt,align:xt})),{popperStyles:{..._t,"--radix-popper-transform-origin":r$2(_e,yt,xt,nt,rt)},arrowStyles:Et,placedSide:yt,placedAlign:xt}}function t$1(tt,_e,rt){const nt=tt[rt==="x"?"left":"top"],it=rt==="x"?"width":"height",st=tt[it],ot=_e[it];return{before:nt-ot,start:nt,center:nt+(st-ot)/2,end:nt+st-ot,after:nt+st}}function e$1(tt){return{position:"absolute",top:0,left:0,minWidth:"max-content",willChange:"transform",transform:`translate3d(${Math.round(tt.x+window.scrollX)}px, ${Math.round(tt.y+window.scrollY)}px, 0)`}}function r$2(tt,_e,rt,nt,it){const st=_e==="top"||_e==="bottom",ot=it?it.width:0,lt=it?it.height:0,at=ot/2+nt;let ct="",ut="";return st?(ct={start:`${at}px`,center:"center",end:tt.width-at+"px"}[rt],ut=_e==="top"?`${tt.height+lt}px`:-lt+"px"):(ct=_e==="left"?`${tt.width+lt}px`:-lt+"px",ut={start:`${at}px`,center:"center",end:tt.height-at+"px"}[rt]),`${ct} ${ut}`}const o$1={position:"fixed",top:0,left:0,opacity:0,transform:"translate3d(0, -200%, 0)"},n$1={position:"absolute",opacity:0};function i$2({popperSize:tt,arrowSize:_e,arrowOffset:rt,side:nt,align:it}){const st=(tt.width-_e.width)/2,ot=(tt.height-_e.width)/2,lt={top:0,right:90,bottom:180,left:-90}[nt],at=Math.max(_e.width,_e.height),ct={width:`${at}px`,height:`${at}px`,transform:`rotate(${lt}deg)`,willChange:"transform",position:"absolute",[nt]:"100%",direction:p$2(nt,it)};return nt!=="top"&&nt!=="bottom"||(it==="start"&&(ct.left=`${rt}px`),it==="center"&&(ct.left=`${st}px`),it==="end"&&(ct.right=`${rt}px`)),nt!=="left"&&nt!=="right"||(it==="start"&&(ct.top=`${rt}px`),it==="center"&&(ct.top=`${ot}px`),it==="end"&&(ct.bottom=`${rt}px`)),ct}function p$2(tt,_e){return(tt!=="top"&&tt!=="right"||_e!=="end")&&(tt!=="bottom"&&tt!=="left"||_e==="end")?"ltr":"rtl"}function a$1(tt){return{top:"bottom",right:"left",bottom:"top",left:"right"}[tt]}function s$2(tt,_e){return{top:tt.top<_e.top,right:tt.right>_e.right,bottom:tt.bottom>_e.bottom,left:tt.left<_e.left}}const[c$2,l$1]=createContextScope("Popper"),[f$2,d$2]=c$2("Popper"),Popper=tt=>{const{__scopePopper:_e,children:rt}=tt,[nt,it]=reactExports.useState(null);return reactExports.createElement(f$2,{scope:_e,anchor:nt,onAnchorChange:it},rt)},PopperAnchor=reactExports.forwardRef((tt,_e)=>{const{__scopePopper:rt,virtualRef:nt,...it}=tt,st=d$2("PopperAnchor",rt),ot=reactExports.useRef(null),lt=useComposedRefs$1(_e,ot);return reactExports.useEffect(()=>{st.onAnchorChange((nt==null?void 0:nt.current)||ot.current)}),nt?null:reactExports.createElement(Primitive.div,_extends$1({},it,{ref:lt}))}),[u$2,m$2]=c$2("PopperContent"),PopperContent=reactExports.forwardRef((tt,_e)=>{const{__scopePopper:rt,side:nt="bottom",sideOffset:it,align:st="center",alignOffset:ot,collisionTolerance:lt,avoidCollisions:at=!0,...ct}=tt,ut=d$2("PopperContent",rt),[ht,dt]=reactExports.useState(),ft=useRect(ut.anchor),[pt,mt]=reactExports.useState(null),gt=useSize(pt),[vt,At]=reactExports.useState(null),yt=useSize(vt),xt=useComposedRefs$1(_e,It=>mt(It)),_t=function(){const[It,Ot]=reactExports.useState(void 0);return reactExports.useEffect(()=>{let Bt;function Ut(){Ot({width:window.innerWidth,height:window.innerHeight})}function Ft(){window.clearTimeout(Bt),Bt=window.setTimeout(Ut,100)}return Ut(),window.addEventListener("resize",Ft),()=>window.removeEventListener("resize",Ft)},[]),It}(),Et=_t?DOMRect.fromRect({..._t,x:0,y:0}):void 0,{popperStyles:bt,arrowStyles:wt,placedSide:Tt,placedAlign:Mt}=getPlacementData({anchorRect:ft,popperSize:gt,arrowSize:yt,arrowOffset:ht,side:nt,sideOffset:it,align:st,alignOffset:ot,shouldAvoidCollisions:at,collisionBoundariesRect:Et,collisionTolerance:lt}),Pt=Tt!==void 0;return reactExports.createElement("div",{style:bt,"data-radix-popper-content-wrapper":""},reactExports.createElement(u$2,{scope:rt,arrowStyles:wt,onArrowChange:At,onArrowOffsetChange:dt},reactExports.createElement(Primitive.div,_extends$1({"data-side":Tt,"data-align":Mt},ct,{style:{...ct.style,animation:Pt?void 0:"none"},ref:xt}))))}),PopperArrow=reactExports.forwardRef(function(tt,_e){const{__scopePopper:rt,offset:nt,...it}=tt,st=m$2("PopperArrow",rt),{onArrowOffsetChange:ot}=st;return reactExports.useEffect(()=>ot(nt),[ot,nt]),reactExports.createElement("span",{style:{...st.arrowStyles,pointerEvents:"none"}},reactExports.createElement("span",{ref:st.onArrowChange,style:{display:"inline-block",verticalAlign:"top",pointerEvents:"auto"}},reactExports.createElement(Root$2,_extends$1({},it,{ref:_e,style:{...it.style,display:"block"}}))))}),Root$1=Popper,Anchor=PopperAnchor,Content$1=PopperContent,Arrow$1=PopperArrow,useLayoutEffect=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{};function composeRefs(...tt){return _e=>tt.forEach(rt=>function(nt,it){typeof nt=="function"?nt(it):nt!=null&&(nt.current=it)}(rt,_e))}function useComposedRefs(...tt){return reactExports.useCallback(composeRefs(...tt),tt)}const Presence=tt=>{const{present:_e,children:rt}=tt,nt=function(ot){const[lt,at]=reactExports.useState(),ct=reactExports.useRef({}),ut=reactExports.useRef(ot),ht=reactExports.useRef("none"),dt=ot?"mounted":"unmounted",[ft,pt]=function(mt,gt){return reactExports.useReducer((vt,At)=>{const yt=gt[vt][At];return yt??vt},mt)}(dt,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const mt=r$1(ct.current);ht.current=ft==="mounted"?mt:"none"},[ft]),useLayoutEffect(()=>{const mt=ct.current,gt=ut.current;if(gt!==ot){const vt=ht.current,At=r$1(mt);ot?pt("MOUNT"):At==="none"||(mt==null?void 0:mt.display)==="none"?pt("UNMOUNT"):pt(gt&&vt!==At?"ANIMATION_OUT":"UNMOUNT"),ut.current=ot}},[ot,pt]),useLayoutEffect(()=>{if(lt){const mt=vt=>{const At=r$1(ct.current).includes(vt.animationName);vt.target===lt&&At&&pt("ANIMATION_END")},gt=vt=>{vt.target===lt&&(ht.current=r$1(ct.current))};return lt.addEventListener("animationstart",gt),lt.addEventListener("animationcancel",mt),lt.addEventListener("animationend",mt),()=>{lt.removeEventListener("animationstart",gt),lt.removeEventListener("animationcancel",mt),lt.removeEventListener("animationend",mt)}}},[lt,pt]),{isPresent:["mounted","unmountSuspended"].includes(ft),ref:reactExports.useCallback(mt=>{mt&&(ct.current=getComputedStyle(mt)),at(mt)},[])}}(_e),it=typeof rt=="function"?rt({present:nt.isPresent}):reactExports.Children.only(rt),st=useComposedRefs(nt.ref,it.ref);return typeof rt=="function"||nt.isPresent?reactExports.cloneElement(it,{ref:st}):null};function r$1(tt){return(tt==null?void 0:tt.animationName)||"none"}Presence.displayName="Presence";function usePrevious(tt){const _e=reactExports.useRef(tt);return reactExports.useEffect(()=>{_e.current=tt},[tt]),_e.current}function useCallbackRef$1(tt){const _e=reactExports.useRef(tt);return reactExports.useEffect(()=>{_e.current=tt}),reactExports.useMemo(()=>(...rt)=>{var nt;return(nt=_e.current)===null||nt===void 0?void 0:nt.call(_e,...rt)},[])}function useEscapeKeydown(tt){const _e=useCallbackRef$1(tt);reactExports.useEffect(()=>{const rt=nt=>{nt.key==="Escape"&&_e(nt)};return document.addEventListener("keydown",rt),()=>document.removeEventListener("keydown",rt)},[_e])}function useCallbackRef(tt){const _e=reactExports.useRef(tt);return reactExports.useEffect(()=>{_e.current=tt}),reactExports.useMemo(()=>(...rt)=>{var nt;return(nt=_e.current)===null||nt===void 0?void 0:nt.call(_e,...rt)},[])}function useControllableState({prop:tt,defaultProp:_e,onChange:rt=()=>{}}){const[nt,it]=function({defaultProp:at,onChange:ct}){const ut=reactExports.useState(at),[ht]=ut,dt=reactExports.useRef(ht),ft=useCallbackRef(ct);return reactExports.useEffect(()=>{dt.current!==ht&&(ft(ht),dt.current=ht)},[ht,dt,ft]),ut}({defaultProp:_e,onChange:rt}),st=tt!==void 0,ot=st?tt:nt,lt=useCallbackRef(rt);return[ot,reactExports.useCallback(at=>{if(st){const ct=at,ut=typeof at=="function"?ct(tt):at;ut!==tt&&lt(ut)}else it(at)},[st,tt,it,lt])]}function composeEventHandlers$1(tt,_e,{checkForDefaultPrevented:rt=!0}={}){return function(nt){if(tt==null||tt(nt),rt===!1||!nt.defaultPrevented)return _e==null?void 0:_e(nt)}}const[w$1,x$1]=createContextScope("Tooltip",[l$1]),g$2=l$1(),E=700,[v$2,b$2]=w$1("TooltipProvider",{isOpenDelayed:!0,delayDuration:E,onOpen:()=>{},onClose:()=>{}}),[y$2,_]=w$1("Tooltip"),Tooltip=tt=>{const{__scopeTooltip:_e,children:rt,open:nt,defaultOpen:it=!1,onOpenChange:st,delayDuration:ot}=tt,lt=b$2("Tooltip",_e),at=g$2(_e),[ct,ut]=reactExports.useState(null),ht=useId(),dt=reactExports.useRef(0),ft=ot??lt.delayDuration,pt=reactExports.useRef(!1),{onOpen:mt,onClose:gt}=lt,[vt=!1,At]=useControllableState({prop:nt,defaultProp:it,onChange:Et=>{Et&&(document.dispatchEvent(new CustomEvent("tooltip.open")),mt()),st==null||st(Et)}}),yt=reactExports.useMemo(()=>vt?pt.current?"delayed-open":"instant-open":"closed",[vt]),xt=reactExports.useCallback(()=>{window.clearTimeout(dt.current),pt.current=!1,At(!0)},[At]),_t=reactExports.useCallback(()=>{window.clearTimeout(dt.current),dt.current=window.setTimeout(()=>{pt.current=!0,At(!0)},ft)},[ft,At]);return reactExports.useEffect(()=>()=>window.clearTimeout(dt.current),[]),reactExports.createElement(Root$1,at,reactExports.createElement(y$2,{scope:_e,contentId:ht,open:vt,stateAttribute:yt,trigger:ct,onTriggerChange:ut,onTriggerEnter:reactExports.useCallback(()=>{lt.isOpenDelayed?_t():xt()},[lt.isOpenDelayed,_t,xt]),onOpen:reactExports.useCallback(xt,[xt]),onClose:reactExports.useCallback(()=>{window.clearTimeout(dt.current),At(!1),gt()},[At,gt])},rt))},TooltipTrigger=reactExports.forwardRef((tt,_e)=>{const{__scopeTooltip:rt,...nt}=tt,it=_("TooltipTrigger",rt),st=g$2(rt),ot=useComposedRefs$1(_e,it.onTriggerChange),lt=reactExports.useRef(!1),at=reactExports.useCallback(()=>lt.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("mouseup",at),[at]),reactExports.createElement(Anchor,_extends$1({asChild:!0},st),reactExports.createElement(Primitive.button,_extends$1({"aria-describedby":it.open?it.contentId:void 0,"data-state":it.stateAttribute},nt,{ref:ot,onMouseEnter:composeEventHandlers$1(tt.onMouseEnter,it.onTriggerEnter),onMouseLeave:composeEventHandlers$1(tt.onMouseLeave,it.onClose),onMouseDown:composeEventHandlers$1(tt.onMouseDown,()=>{it.onClose(),lt.current=!0,document.addEventListener("mouseup",at,{once:!0})}),onFocus:composeEventHandlers$1(tt.onFocus,()=>{lt.current||it.onOpen()}),onBlur:composeEventHandlers$1(tt.onBlur,it.onClose),onClick:composeEventHandlers$1(tt.onClick,it.onClose)})))}),TooltipContent=reactExports.forwardRef((tt,_e)=>{const{forceMount:rt,...nt}=tt,it=_("TooltipContent",tt.__scopeTooltip);return reactExports.createElement(Presence,{present:rt||it.open},reactExports.createElement(h$2,_extends$1({ref:_e},nt)))}),h$2=reactExports.forwardRef((tt,_e)=>{const{__scopeTooltip:rt,children:nt,"aria-label":it,portalled:st=!0,...ot}=tt,lt=_("TooltipContent",rt),at=g$2(rt),ct=st?Portal$1:reactExports.Fragment,{onClose:ut}=lt;return useEscapeKeydown(()=>ut()),reactExports.useEffect(()=>(document.addEventListener("tooltip.open",ut),()=>document.removeEventListener("tooltip.open",ut)),[ut]),reactExports.createElement(ct,null,reactExports.createElement(k$2,{__scopeTooltip:rt}),reactExports.createElement(Content$1,_extends$1({"data-state":lt.stateAttribute},at,ot,{ref:_e,style:{...ot.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)"}}),reactExports.createElement(Slottable,null,nt),reactExports.createElement(Root$3,{id:lt.contentId,role:"tooltip"},it||nt)))}),TooltipArrow=reactExports.forwardRef((tt,_e)=>{const{__scopeTooltip:rt,...nt}=tt,it=g$2(rt);return reactExports.createElement(Arrow$1,_extends$1({},it,nt,{ref:_e}))});function k$2(tt){const{__scopeTooltip:_e}=tt,rt=_("CheckTriggerMoved",_e),nt=useRect(rt.trigger),it=nt==null?void 0:nt.left,st=usePrevious(it),ot=nt==null?void 0:nt.top,lt=usePrevious(ot),at=rt.onClose;return reactExports.useEffect(()=>{(st!==void 0&&st!==it||lt!==void 0&&lt!==ot)&&at()},[at,st,lt,it,ot]),null}const Root=Tooltip,Trigger=TooltipTrigger,Content=TooltipContent,Arrow=TooltipArrow;function _objectWithoutPropertiesLoose$1(tt,_e){if(tt==null)return{};var rt={},nt=Object.keys(tt),it,st;for(st=0;st<nt.length;st++)it=nt[st],!(_e.indexOf(it)>=0)&&(rt[it]=tt[it]);return rt}function _objectWithoutProperties$1(tt,_e){if(tt==null)return{};var rt=_objectWithoutPropertiesLoose$1(tt,_e),nt,it;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(tt);for(it=0;it<st.length;it++)nt=st[it],!(_e.indexOf(nt)>=0)&&Object.prototype.propertyIsEnumerable.call(tt,nt)&&(rt[nt]=tt[nt])}return rt}let LevaErrors;(function(tt){tt[tt.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",tt[tt.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",tt[tt.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",tt[tt.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",tt[tt.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",tt[tt.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",tt[tt.THEME_ERROR=6]="THEME_ERROR",tt[tt.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",tt[tt.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",tt[tt.EMPTY_KEY=9]="EMPTY_KEY"})(LevaErrors||(LevaErrors={}));const ErrorList={[LevaErrors.UNSUPPORTED_INPUT]:(tt,_e)=>[`An input with type \`${tt}\` input was found at path \`${_e}\` but it's not supported yet.`],[LevaErrors.NO_COMPONENT_FOR_TYPE]:(tt,_e)=>[`Type \`${tt}\` found at path \`${_e}\` can't be displayed in panel because no component supports it yet.`],[LevaErrors.UNKNOWN_INPUT]:(tt,_e)=>[`input at path \`${tt}\` is not recognized.`,_e],[LevaErrors.DUPLICATE_KEYS]:(tt,_e,rt)=>[`Key \`${tt}\` of path \`${_e}\` already exists at path \`${rt}\`. Even nested keys need to be unique. Rename one of the keys.`],[LevaErrors.ALREADY_REGISTERED_TYPE]:tt=>[`Type ${tt} has already been registered. You can't register a component with the same type.`],[LevaErrors.CLIPBOARD_ERROR]:tt=>["Error copying the value",tt],[LevaErrors.THEME_ERROR]:(tt,_e)=>[`Error accessing the theme \`${tt}.${_e}\` value.`],[LevaErrors.PATH_DOESNT_EXIST]:tt=>[`Error getting the value at path \`${tt}\`. There is probably an error in your \`render\` function.`],[LevaErrors.PATH_DOESNT_EXIST]:tt=>[`Error accessing the value at path \`${tt}\``],[LevaErrors.INPUT_TYPE_OVERRIDE]:(tt,_e,rt)=>[`Input at path \`${tt}\` already exists with type: \`${_e}\`. Its type cannot be overridden with type \`${rt}\`.`],[LevaErrors.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function _log(tt,_e,...rt){const[nt,...it]=ErrorList[_e](...rt);console[tt]("LEVA: "+nt,...it)}const warn=_log.bind(null,"warn"),log=_log.bind(null,"log"),_excluded$a=["value"],_excluded2$4=["schema"],_excluded3$1=["value"],Schemas=[],Plugins={};function getValueType(tt){let{value:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$a);for(let nt of Schemas){const it=nt(_e,rt);if(it)return it}}function register(tt,_e){let{schema:rt}=_e,nt=_objectWithoutProperties$1(_e,_excluded2$4);if(tt in Plugins){warn(LevaErrors.ALREADY_REGISTERED_TYPE,tt);return}Schemas.push((it,st)=>rt(it,st)&&tt),Plugins[tt]=nt}function createInternalPlugin(tt){return tt}function normalize$3$1(tt,_e,rt,nt){const{normalize:it}=Plugins[tt];if(it)return it(_e,rt,nt);if(typeof _e!="object"||!("value"in _e))return{value:_e};const{value:st}=_e,ot=_objectWithoutProperties$1(_e,_excluded3$1);return{value:st,settings:ot}}function sanitize$4(tt,_e,rt,nt,it,st){const{sanitize:ot}=Plugins[tt];return ot?ot(_e,rt,nt,it,st):_e}function format$2(tt,_e,rt){const{format:nt}=Plugins[tt];return nt?nt(_e,rt):_e}function _defineProperty$3(tt,_e,rt){return _e in tt?Object.defineProperty(tt,_e,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[_e]=rt,tt}function ownKeys$2(tt,_e){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(tt);_e&&(nt=nt.filter(function(it){return Object.getOwnPropertyDescriptor(tt,it).enumerable})),rt.push.apply(rt,nt)}return rt}function _objectSpread2(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$2(Object(rt),!0).forEach(function(nt){_defineProperty$3(tt,nt,rt[nt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ownKeys$2(Object(rt)).forEach(function(nt){Object.defineProperty(tt,nt,Object.getOwnPropertyDescriptor(rt,nt))})}return tt}const clamp=(tt,_e,rt)=>tt>rt?rt:tt<_e?_e:tt,parseNumber=tt=>{if(tt===""||typeof tt=="number")return tt;try{const _e=evaluate(tt);if(!isNaN(_e))return _e}catch{}return parseFloat(tt)},log10=Math.log(10);function getStep(tt){let _e=Math.abs(+String(tt).replace(".",""));if(_e===0)return .01;for(;_e!==0&&_e%10===0;)_e/=10;const rt=Math.floor(Math.log(_e)/log10)+1,nt=Math.floor(Math.log10(Math.abs(tt))),it=Math.pow(10,nt-rt);return Math.max(it,.001)}const range=(tt,_e,rt)=>rt===_e?0:(clamp(tt,_e,rt)-_e)/(rt-_e),invertedRange=(tt,_e,rt)=>tt*(rt-_e)+_e,getUid=()=>"_"+Math.random().toString(36).substr(2,9),parens=/\(([0-9+\-*/^ .]+)\)/,exp=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,mul=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,div=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,add=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,sub=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function evaluate(tt){if(isNaN(Number(tt)))if(parens.test(tt)){const _e=tt.replace(parens,(rt,nt)=>String(evaluate(nt)));return evaluate(_e)}else if(exp.test(tt)){const _e=tt.replace(exp,(rt,nt,it)=>String(Math.pow(Number(nt),Number(it))));return evaluate(_e)}else if(mul.test(tt)){const _e=tt.replace(mul,(rt,nt,it)=>String(Number(nt)*Number(it)));return evaluate(_e)}else if(div.test(tt)){const _e=tt.replace(div,(rt,nt,it)=>{if(it!=0)return String(Number(nt)/Number(it));throw new Error("Division by zero")});return evaluate(_e)}else if(add.test(tt)){const _e=tt.replace(add,(rt,nt,it)=>String(Number(nt)+Number(it)));return evaluate(_e)}else if(sub.test(tt)){const _e=tt.replace(sub,(rt,nt,it)=>String(Number(nt)-Number(it)));return evaluate(_e)}else return Number(tt);return Number(tt)}function pick(tt,_e){return _e.reduce((rt,nt)=>(tt&&tt.hasOwnProperty(nt)&&(rt[nt]=tt[nt]),rt),{})}function omit(tt,_e){const rt=_objectSpread2({},tt);return _e.forEach(nt=>nt in tt&&delete rt[nt]),rt}function mapArrayToKeys(tt,_e){return tt.reduce((rt,nt,it)=>Object.assign(rt,{[_e[it]]:nt}),{})}function isObject$9(tt){return Object.prototype.toString.call(tt)==="[object Object]"}const isEmptyObject=tt=>isObject$9(tt)&&Object.keys(tt).length===0;let SpecialInputs;(function(tt){tt.BUTTON="BUTTON",tt.BUTTON_GROUP="BUTTON_GROUP",tt.MONITOR="MONITOR",tt.FOLDER="FOLDER"})(SpecialInputs||(SpecialInputs={}));let LevaInputs;(function(tt){tt.SELECT="SELECT",tt.IMAGE="IMAGE",tt.NUMBER="NUMBER",tt.COLOR="COLOR",tt.STRING="STRING",tt.BOOLEAN="BOOLEAN",tt.INTERVAL="INTERVAL",tt.VECTOR3D="VECTOR3D",tt.VECTOR2D="VECTOR2D"})(LevaInputs||(LevaInputs={}));const _excluded$9=["type","__customInput"],_excluded2$3=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],_excluded3$2=["type"];function parseOptions(tt,_e,rt={},nt){var it,st;if(typeof tt!="object"||Array.isArray(tt))return{type:nt,input:tt,options:_objectSpread2({key:_e,label:_e,optional:!1,disabled:!1,order:0},rt)};if("__customInput"in tt){const{type:_t,__customInput:Et}=tt,bt=_objectWithoutProperties$1(tt,_excluded$9);return parseOptions(Et,_e,bt,_t)}const{render:ot,label:lt,optional:at,order:ct=0,disabled:ut,hint:ht,onChange:dt,onEditStart:ft,onEditEnd:pt,transient:mt}=tt,gt=_objectWithoutProperties$1(tt,_excluded2$3),vt=_objectSpread2({render:ot,key:_e,label:lt??_e,hint:ht,transient:mt??!!dt,onEditStart:ft,onEditEnd:pt,disabled:ut,optional:at,order:ct},rt);let{type:At}=gt,yt=_objectWithoutProperties$1(gt,_excluded3$2);if(At=nt??At,At in SpecialInputs)return{type:At,input:yt,options:vt};let xt;return nt&&isObject$9(yt)&&"value"in yt?xt=yt.value:xt=isEmptyObject(yt)?void 0:yt,{type:At,input:xt,options:_objectSpread2(_objectSpread2({},vt),{},{onChange:dt,optional:(it=vt.optional)!==null&&it!==void 0?it:!1,disabled:(st=vt.disabled)!==null&&st!==void 0?st:!1})}}function normalizeInput(tt,_e,rt,nt){const it=parseOptions(tt,_e),{type:st,input:ot,options:lt}=it;if(st)return st in SpecialInputs?it:{type:st,input:normalize$3$1(st,ot,rt,nt),options:lt};let at=getValueType(ot);return at?{type:at,input:normalize$3$1(at,ot,rt,nt),options:lt}:(at=getValueType({value:ot}),at?{type:at,input:normalize$3$1(at,{value:ot},rt,nt),options:lt}:!1)}function updateInput(tt,_e,rt,nt,it){const{value:st,type:ot,settings:lt}=tt;tt.value=sanitizeValue({type:ot,value:st,settings:lt},_e,rt,nt),tt.fromPanel=it}const ValueError=function(_e,rt,nt){this.type="LEVA_ERROR",this.message="LEVA: "+_e,this.previousValue=rt,this.error=nt};function sanitizeValue({type:tt,value:_e,settings:rt},nt,it,st){const ot=tt!=="SELECT"&&typeof nt=="function"?nt(_e):nt;let lt;try{lt=sanitize$4(tt,ot,rt,_e,it,st)}catch(at){throw new ValueError(`The value \`${nt}\` did not result in a correct value.`,_e,at)}return dequal(lt,_e)?_e:lt}const debounce=(tt,_e,rt=!1)=>{let nt=0;return function(){const it=arguments,st=rt&&!nt,ot=()=>tt.apply(this,it);window.clearTimeout(nt),nt=window.setTimeout(ot,_e),st&&ot()}},multiplyStep=tt=>tt.shiftKey?5:tt.altKey?1/5:1;function render(tt,_e){const rt=console.error;console.error=()=>{},ReactDOM.render(tt,_e),console.error=rt}const _excluded$8=["value"],_excluded2$2$1=["min","max"],schema$3=tt=>{if(typeof tt=="number")return!0;if(typeof tt=="string"){const _e=parseFloat(tt);return isNaN(_e)?!1:tt.substring((""+_e).length).trim().length<4}return!1},sanitize$3=(tt,{min:_e=-1/0,max:rt=1/0,suffix:nt})=>{const it=parseFloat(tt);if(tt===""||isNaN(it))throw Error("Invalid number");const st=clamp(it,_e,rt);return nt?st+nt:st},format$1$1=(tt,{pad:_e=0,suffix:rt})=>{const nt=parseFloat(tt).toFixed(_e);return rt?nt+rt:nt},normalize$2$1=tt=>{let{value:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$8);const{min:nt=-1/0,max:it=1/0}=rt,st=_objectWithoutProperties$1(rt,_excluded2$2$1);let ot=parseFloat(_e);const lt=typeof _e=="string"?_e.substring((""+ot).length):void 0;ot=clamp(ot,nt,it);let at=rt.step;at||(Number.isFinite(nt)?Number.isFinite(it)?at=+(Math.abs(it-nt)/100).toPrecision(1):at=+(Math.abs(ot-nt)/100).toPrecision(1):Number.isFinite(it)&&(at=+(Math.abs(it-ot)/100).toPrecision(1)));const ct=at?getStep(at)*10:getStep(ot);at=at||ct/10;const ut=Math.round(clamp(Math.log10(1/ct),0,2));return{value:lt?ot+lt:ot,settings:_objectSpread2({initialValue:ot,step:at,pad:ut,min:nt,max:it,suffix:lt},st)}},sanitizeStep$1=(tt,{step:_e,initialValue:rt})=>{const nt=Math.round((tt-rt)/_e);return rt+nt*_e};var props$3=Object.freeze({__proto__:null,schema:schema$3,sanitize:sanitize$3,format:format$1$1,normalize:normalize$2$1,sanitizeStep:sanitizeStep$1});function _extends(){return _extends=Object.assign?Object.assign.bind():function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(tt[nt]=rt[nt])}return tt},_extends.apply(this,arguments)}const InputContext=reactExports.createContext({});function useInputContext(){return reactExports.useContext(InputContext)}const ThemeContext=reactExports.createContext(null),StoreContext=reactExports.createContext(null),PanelSettingsContext=reactExports.createContext(null);function useStoreContext(){return reactExports.useContext(StoreContext)}function usePanelSettingsContext(){return reactExports.useContext(PanelSettingsContext)}const getDefaultTheme=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function createStateClass(tt,_e){const[rt,nt]=tt.split(" "),it={};return rt!=="none"&&(it.boxShadow=`${_e.inset?"inset ":""}0 0 0 $borderWidths${[_e.key]} $colors${rt!=="default"&&rt||_e.borderColor}`),nt&&(it.backgroundColor=nt),it}const utils={$inputStyle:()=>tt=>createStateClass(tt,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>tt=>createStateClass(tt,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>tt=>createStateClass(tt,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>tt=>createStateClass(tt,{key:"$active",borderColor:"$accent1",inset:!0})},{styled,css,createTheme,globalCss,keyframes}=q$1({prefix:"leva",theme:getDefaultTheme(),utils:_objectSpread2(_objectSpread2({},utils),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:tt=>({"&:focus":utils.$focusStyle()(tt)}),$focusWithin:tt=>({"&:focus-within":utils.$focusStyle()(tt)}),$hover:tt=>({"&:hover":utils.$hoverStyle()(tt)}),$active:tt=>({"&:active":utils.$activeStyle()(tt)})})}),globalStyles=globalCss({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function mergeTheme(tt){const _e=getDefaultTheme();if(!tt)return{theme:_e,className:""};Object.keys(tt).forEach(nt=>{Object.assign(_e[nt],tt[nt])});const rt=createTheme(_e);return{theme:_e,className:rt.className}}function useTh(tt,_e){const{theme:rt}=reactExports.useContext(ThemeContext);if(!(tt in rt)||!(_e in rt[tt]))return warn(LevaErrors.THEME_ERROR,tt,_e),"";let nt=_e;for(;;){let it=rt[tt][nt];if(typeof it=="string"&&it.charAt(0)==="$")nt=it.substr(1);else return it}}const StyledInput=styled("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),InnerLabel=styled("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${StyledInput}`]:{paddingLeft:0}}),InnerNumberLabel=styled(InnerLabel,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),InputContainer=styled("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),_excluded$7$1=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],_excluded2$1$1=["onUpdate"];function ValueInput(tt){let{innerLabel:_e,value:rt,onUpdate:nt,onChange:it,onKeyDown:st,type:ot,id:lt,inputType:at="text",rows:ct=0}=tt,ut=_objectWithoutProperties$1(tt,_excluded$7$1);const{id:ht,emitOnEditStart:dt,emitOnEditEnd:ft,disabled:pt}=useInputContext(),mt=lt||ht,gt=reactExports.useRef(null),vt=ct>0,At=vt?"textarea":"input",yt=reactExports.useCallback(Et=>bt=>{const wt=bt.currentTarget.value;Et(wt)},[]);React.useEffect(()=>{const Et=gt.current,bt=yt(wt=>{nt(wt),ft()});return Et==null||Et.addEventListener("blur",bt),()=>Et==null?void 0:Et.removeEventListener("blur",bt)},[yt,nt,ft]);const xt=reactExports.useCallback(Et=>{Et.key==="Enter"&&yt(nt)(Et)},[yt,nt]),_t=Object.assign({as:At},vt?{rows:ct}:{},ut);return React.createElement(InputContainer,{textArea:vt},_e&&typeof _e=="string"?React.createElement(InnerLabel,null,_e):_e,React.createElement(StyledInput,_extends({levaType:ot,ref:gt,id:mt,type:at,autoComplete:"off",spellCheck:"false",value:rt,onChange:yt(it),onFocus:()=>dt(),onKeyPress:xt,onKeyDown:st,disabled:pt},_t)))}function NumberInput(tt){let{onUpdate:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded2$1$1);const nt=reactExports.useCallback(st=>_e(parseNumber(st)),[_e]),it=reactExports.useCallback(st=>{const ot=st.key==="ArrowUp"?1:st.key==="ArrowDown"?-1:0;if(ot){st.preventDefault();const lt=st.altKey?.1:st.shiftKey?10:1;_e(at=>parseFloat(at)+ot*lt)}},[_e]);return React.createElement(ValueInput,_extends({},rt,{onUpdate:nt,onKeyDown:it,type:"number"}))}const StyledFolder=styled("div",{}),StyledWrapper=styled("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),StyledTitle=styled("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & > svg`]:{opacity:1}}),StyledContent=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${StyledFolder}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),StyledRow=styled("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${StyledContent} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),StyledInputRow=styled(StyledRow,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),CopyLabelContainer=styled("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),StyledOptionalToggle=styled("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),StyledLabel=styled("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),StyledInputWrapper$1=styled("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${StyledLabel}`]:{pointerEvents:"auto"}}}}}),Overlay=styled("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),StyledToolTipContent=styled("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),ToolTipArrow=styled(Arrow,{fill:"$toolTipBackground"});function Portal({children:tt}){const{className:_e}=reactExports.useContext(ThemeContext);return React.createElement(Root$4,{className:_e},tt)}const _excluded$6$1=["align"];function OptionalToggle(){const{id:tt,disable:_e,disabled:rt}=useInputContext();return React.createElement(React.Fragment,null,React.createElement(StyledOptionalToggle,{id:tt+"__disable",type:"checkbox",checked:!rt,onChange:()=>_e(!rt)}),React.createElement("label",{htmlFor:tt+"__disable"}))}function RawLabel(tt){const{id:_e,optional:rt,hint:nt}=useInputContext(),it=tt.htmlFor||(_e?{htmlFor:_e}:null),st=!nt&&typeof tt.children=="string"?{title:tt.children}:null;return React.createElement(React.Fragment,null,rt&&React.createElement(OptionalToggle,null),nt!==void 0?React.createElement(Root,null,React.createElement(Trigger,{asChild:!0},React.createElement(StyledLabel,_extends({},it,tt))),React.createElement(Content,{side:"top",sideOffset:2},React.createElement(StyledToolTipContent,null,nt,React.createElement(ToolTipArrow,null)))):React.createElement(StyledLabel,_extends({},it,st,tt)))}function Label(tt){let{align:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$6$1);const{value:nt,label:it,key:st,disabled:ot}=useInputContext(),{hideCopyButton:lt}=usePanelSettingsContext(),at=!lt&&st!==void 0,[ct,ut]=reactExports.useState(!1),ht=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[st]:nt??""})),ut(!0)}catch{warn(LevaErrors.CLIPBOARD_ERROR,{[st]:nt})}};return React.createElement(CopyLabelContainer,{align:_e,onPointerLeave:()=>ut(!1)},React.createElement(RawLabel,rt),at&&!ot&&React.createElement("div",{title:`Click to copy ${typeof it=="string"?it:st} value`},ct?React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),React.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):React.createElement("svg",{onClick:ht,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),React.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const _excluded$5$1=["toggled"],Svg=styled("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function Chevron(tt){let{toggled:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$5$1);return React.createElement(Svg,_extends({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${_e?0:-90}deg)`}},rt),React.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const _excluded$4$1=["input"];function Row(tt){let{input:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$4$1);return _e?React.createElement(StyledInputRow,rt):React.createElement(StyledRow,rt)}function useInputSetters({value:tt,type:_e,settings:rt,setValue:nt}){const[it,st]=reactExports.useState(format$2(_e,tt,rt)),ot=reactExports.useRef(tt),lt=reactExports.useRef(rt);lt.current=rt;const at=reactExports.useCallback(ut=>st(format$2(_e,ut,lt.current)),[_e]),ct=reactExports.useCallback(ut=>{try{nt(ut)}catch(ht){const{type:dt,previousValue:ft}=ht;if(dt!=="LEVA_ERROR")throw ht;at(ft)}},[at,nt]);return reactExports.useEffect(()=>{dequal(tt,ot.current)||at(tt),ot.current=tt},[tt,at]),{displayValue:it,onChange:st,onUpdate:ct}}function useDrag(tt,_e){const{emitOnEditStart:rt,emitOnEditEnd:nt}=useInputContext();return useDrag$1(it=>{it.first&&(document.body.classList.add("leva__panel__dragged"),rt==null||rt());const st=tt(it);return it.last&&(document.body.classList.remove("leva__panel__dragged"),nt==null||nt()),st},_e)}function useCanvas2d(tt){const _e=reactExports.useRef(null),rt=reactExports.useRef(null),nt=reactExports.useRef(!1);return reactExports.useEffect(()=>{const it=debounce(()=>{_e.current.width=_e.current.offsetWidth*window.devicePixelRatio,_e.current.height=_e.current.offsetHeight*window.devicePixelRatio,tt(_e.current,rt.current)},250);return window.addEventListener("resize",it),nt.current||(it(),nt.current=!0),()=>window.removeEventListener("resize",it)},[tt]),reactExports.useEffect(()=>{rt.current=_e.current.getContext("2d")},[]),[_e,rt]}function useTransform(){const tt=reactExports.useRef(null),_e=reactExports.useRef({x:0,y:0}),rt=reactExports.useCallback(nt=>{Object.assign(_e.current,nt),tt.current&&(tt.current.style.transform=`translate3d(${_e.current.x}px, ${_e.current.y}px, 0)`)},[]);return[tt,rt]}const _excluded$3$1=["__refCount"],getInputAtPath=(tt,_e)=>{if(!tt[_e])return null;const rt=tt[_e];return _objectWithoutProperties$1(rt,_excluded$3$1)};function useInput(tt){const _e=useStoreContext(),[rt,nt]=reactExports.useState(getInputAtPath(_e.getData(),tt)),it=reactExports.useCallback(ct=>_e.setValueAtPath(tt,ct,!0),[tt,_e]),st=reactExports.useCallback(ct=>_e.setSettingsAtPath(tt,ct),[tt,_e]),ot=reactExports.useCallback(ct=>_e.disableInputAtPath(tt,ct),[tt,_e]),lt=reactExports.useCallback(()=>_e.emitOnEditStart(tt),[tt,_e]),at=reactExports.useCallback(()=>_e.emitOnEditEnd(tt),[tt,_e]);return reactExports.useEffect(()=>{nt(getInputAtPath(_e.getData(),tt));const ct=_e.useStore.subscribe(ut=>getInputAtPath(ut.data,tt),nt,{equalityFn:shallow});return()=>ct()},[_e,tt]),[rt,{set:it,setSettings:st,disable:ot,storeId:_e.storeId,emitOnEditStart:lt,emitOnEditEnd:at}]}const RangeGrid=styled("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),Range=styled("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),Scrubber=styled("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),RangeWrapper=styled("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),Indicator=styled("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function RangeSlider({value:tt,min:_e,max:rt,onDrag:nt,step:it,initialValue:st}){const ot=reactExports.useRef(null),lt=reactExports.useRef(null),at=reactExports.useRef(0),ct=useTh("sizes","scrubberWidth"),ut=useDrag(({event:dt,first:ft,xy:[pt],movement:[mt],memo:gt})=>{if(ft){const{width:At,left:yt}=ot.current.getBoundingClientRect();at.current=At-parseFloat(ct),gt=(dt==null?void 0:dt.target)===lt.current?tt:invertedRange((pt-yt)/At,_e,rt)}const vt=gt+invertedRange(mt/at.current,0,rt-_e);return nt(sanitizeStep$1(vt,{step:it,initialValue:st})),gt}),ht=range(tt,_e,rt);return React.createElement(RangeWrapper,_extends({ref:ot},ut()),React.createElement(Range,null,React.createElement(Indicator,{style:{left:0,right:`${(1-ht)*100}%`}})),React.createElement(Scrubber,{ref:lt,style:{left:`calc(${ht} * (100% - ${ct}))`}}))}const DraggableLabel=React.memo(({label:tt,onUpdate:_e,step:rt,innerLabelTrim:nt})=>{const[it,st]=reactExports.useState(!1),ot=useDrag(({active:lt,delta:[at],event:ct,memo:ut=0})=>(st(lt),ut+=at/2,Math.abs(ut)>=1&&(_e(ht=>parseFloat(ht)+Math.floor(ut)*rt*multiplyStep(ct)),ut=0),ut));return React.createElement(InnerNumberLabel,_extends({dragging:it,title:tt.length>1?tt:""},ot()),tt.slice(0,nt))});function Number$1({label:tt,id:_e,displayValue:rt,onUpdate:nt,onChange:it,settings:st,innerLabelTrim:ot=1}){const lt=ot>0&&React.createElement(DraggableLabel,{label:tt,step:st.step,onUpdate:nt,innerLabelTrim:ot});return React.createElement(NumberInput,{id:_e,value:String(rt),onUpdate:nt,onChange:it,innerLabel:lt})}function NumberComponent(){const tt=useInputContext(),{label:_e,value:rt,onUpdate:nt,settings:it,id:st}=tt,{min:ot,max:lt}=it,at=lt!==1/0&&ot!==-1/0;return React.createElement(Row,{input:!0},React.createElement(Label,null,_e),React.createElement(RangeGrid,{hasRange:at},at&&React.createElement(RangeSlider,_extends({value:parseFloat(rt),onDrag:nt},it)),React.createElement(Number$1,_extends({},tt,{id:st,label:"value",innerLabelTrim:at?0:1}))))}const{sanitizeStep}=props$3,rest=_objectWithoutProperties$1(props$3,["sanitizeStep"]);var number$1=_objectSpread2({component:NumberComponent},rest);const schema$2$1=(tt,_e)=>v8n().schema({options:v8n().passesAnyOf(v8n().object(),v8n().array())}).test(_e),sanitize$2$1=(tt,{values:_e})=>{if(_e.indexOf(tt)<0)throw Error("Selected value doesn't match Select options");return tt},format$3=(tt,{values:_e})=>_e.indexOf(tt),normalize$1$1=tt=>{let{value:_e,options:rt}=tt,nt,it;return Array.isArray(rt)?(it=rt,nt=rt.map(st=>String(st))):(it=Object.values(rt),nt=Object.keys(rt)),"value"in tt?it.includes(_e)||(nt.unshift(String(_e)),it.unshift(_e)):_e=it[0],Object.values(rt).includes(_e)||(rt[String(_e)]=_e),{value:_e,settings:{keys:nt,values:it}}};var props$2$1=Object.freeze({__proto__:null,schema:schema$2$1,sanitize:sanitize$2$1,format:format$3,normalize:normalize$1$1});const SelectContainer=styled("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),NativeSelect=styled("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),PresentationalSelect=styled("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${NativeSelect}:focus + &`]:{$focusStyle:""},[`${NativeSelect}:hover + &`]:{$hoverStyle:""}});function Select({displayValue:tt,value:_e,onUpdate:rt,id:nt,settings:it,disabled:st}){const{keys:ot,values:lt}=it,at=reactExports.useRef();return _e===lt[tt]&&(at.current=ot[tt]),React.createElement(SelectContainer,null,React.createElement(NativeSelect,{id:nt,value:tt,onChange:ct=>rt(lt[Number(ct.currentTarget.value)]),disabled:st},ot.map((ct,ut)=>React.createElement("option",{key:ct,value:ut},ct))),React.createElement(PresentationalSelect,null,at.current),React.createElement(Chevron,{toggled:!0}))}function SelectComponent(){const{label:tt,value:_e,displayValue:rt,onUpdate:nt,id:it,disabled:st,settings:ot}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Select,{id:it,value:_e,displayValue:rt,onUpdate:nt,settings:ot,disabled:st}))}var select=_objectSpread2({component:SelectComponent},props$2$1);const schema$1$1=tt=>v8n().string().test(tt),sanitize$1$1=tt=>{if(typeof tt!="string")throw Error("Invalid string");return tt},normalize$4=({value:tt,editable:_e=!0,rows:rt=!1})=>({value:tt,settings:{editable:_e,rows:typeof rt=="number"?rt:rt?5:0}});var props$1$1=Object.freeze({__proto__:null,schema:schema$1$1,sanitize:sanitize$1$1,normalize:normalize$4});const _excluded$2$1=["displayValue","onUpdate","onChange","editable"],NonEditableString=styled("div",{whiteSpace:"pre-wrap"});function String$1(tt){let{displayValue:_e,onUpdate:rt,onChange:nt,editable:it=!0}=tt,st=_objectWithoutProperties$1(tt,_excluded$2$1);return it?React.createElement(ValueInput,_extends({value:_e,onUpdate:rt,onChange:nt},st)):React.createElement(NonEditableString,null,_e)}function StringComponent(){const{label:tt,settings:_e,displayValue:rt,onUpdate:nt,onChange:it}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(String$1,_extends({displayValue:rt,onUpdate:nt,onChange:it},_e)))}var string=_objectSpread2({component:StringComponent},props$1$1);const schema$4=tt=>v8n().boolean().test(tt),sanitize$5=tt=>{if(typeof tt!="boolean")throw Error("Invalid boolean");return tt};var props$4=Object.freeze({__proto__:null,schema:schema$4,sanitize:sanitize$5});const StyledInputWrapper=styled("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function Boolean$1({value:tt,onUpdate:_e,id:rt,disabled:nt}){return React.createElement(StyledInputWrapper,null,React.createElement("input",{id:rt,type:"checkbox",checked:tt,onChange:it=>_e(it.currentTarget.checked),disabled:nt}),React.createElement("label",{htmlFor:rt},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function BooleanComponent(){const{label:tt,value:_e,onUpdate:rt,disabled:nt,id:it}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Boolean$1,{value:_e,onUpdate:rt,id:it,disabled:nt}))}var boolean=_objectSpread2({component:BooleanComponent},props$4);const _excluded$1$1=["locked"];function Coordinate({value:tt,id:_e,valueKey:rt,settings:nt,onUpdate:it,innerLabelTrim:st}){const ot=reactExports.useRef(tt[rt]);ot.current=tt[rt];const lt=reactExports.useCallback(ct=>it({[rt]:sanitizeValue({type:"NUMBER",value:ot.current,settings:nt},ct)}),[it,nt,rt]),at=useInputSetters({type:"NUMBER",value:tt[rt],settings:nt,setValue:lt});return React.createElement(Number$1,{id:_e,label:rt,value:tt[rt],displayValue:at.displayValue,onUpdate:at.onUpdate,onChange:at.onChange,settings:nt,innerLabelTrim:st})}const Container$2=styled("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function Lock(tt){let{locked:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$1$1);return React.createElement("svg",_extends({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},rt),_e?React.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):React.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function Vector({value:tt,onUpdate:_e,settings:rt,innerLabelTrim:nt}){const{id:it,setSettings:st}=useInputContext(),{lock:ot,locked:lt}=rt;return React.createElement(Container$2,{withLock:ot},ot&&React.createElement(Lock,{locked:lt,onClick:()=>st({locked:!lt})}),Object.keys(tt).map((at,ct)=>React.createElement(Coordinate,{id:ct===0?it:`${it}.${at}`,key:at,valueKey:at,value:tt,settings:rt[at],onUpdate:_e,innerLabelTrim:nt})))}const normalizeKeyedNumberSettings=(tt,_e)=>{const rt={};let nt=0,it=1/0;Object.entries(tt).forEach(([st,ot])=>{rt[st]=normalize$2$1(_objectSpread2({value:ot},_e[st])).settings,nt=Math.max(nt,rt[st].step),it=Math.min(it,rt[st].pad)});for(let st in rt){const{step:ot,min:lt,max:at}=_e[st]||{};!isFinite(ot)&&(!isFinite(lt)||!isFinite(at))&&(rt[st].step=nt,rt[st].pad=it)}return rt},_excluded$b=["lock"],_excluded2$5=["value"];function getVectorSchema(tt){const _e=v8n().array().length(tt).every.number(),rt=nt=>{if(!nt||typeof nt!="object")return!1;const it=Object.values(nt);return it.length===tt&&it.every(st=>isFinite(st))};return nt=>_e.test(nt)||rt(nt)}function getVectorType(tt){return Array.isArray(tt)?"array":"object"}function convert$1(tt,_e,rt){return getVectorType(tt)===_e?tt:_e==="array"?Object.values(tt):mapArrayToKeys(tt,rt)}const sanitizeVector=(tt,_e,rt)=>{const nt=convert$1(tt,"object",_e.keys);for(let ot in nt)nt[ot]=sanitize$3(nt[ot],_e[ot]);const it=Object.keys(nt);let st={};if(it.length===_e.keys.length)st=nt;else{const ot=convert$1(rt,"object",_e.keys);if(it.length===1&&_e.locked){const lt=it[0],at=nt[lt],ct=ot[lt],ut=ct!==0?at/ct:1;for(let ht in ot)ht===lt?st[lt]=at:st[ht]=ot[ht]*ut}else st=_objectSpread2(_objectSpread2({},ot),nt)}return convert$1(st,_e.format,_e.keys)},formatVector=(tt,_e)=>convert$1(tt,"object",_e.keys),isNumberSettings=tt=>!!tt&&("step"in tt||"min"in tt||"max"in tt);function normalizeVector(tt,_e,rt=[]){const{lock:nt=!1}=_e,it=_objectWithoutProperties$1(_e,_excluded$b),st=Array.isArray(tt)?"array":"object",ot=st==="object"?Object.keys(tt):rt,lt=convert$1(tt,"object",ot),at=isNumberSettings(it)?ot.reduce((ut,ht)=>Object.assign(ut,{[ht]:it}),{}):it,ct=normalizeKeyedNumberSettings(lt,at);return{value:st==="array"?tt:lt,settings:_objectSpread2(_objectSpread2({},ct),{},{format:st,keys:ot,lock:nt,locked:!1})}}function getVectorPlugin(tt){return{schema:getVectorSchema(tt.length),normalize:_e=>{let{value:rt}=_e,nt=_objectWithoutProperties$1(_e,_excluded2$5);return normalizeVector(rt,nt,tt)},format:(_e,rt)=>formatVector(_e,rt),sanitize:(_e,rt,nt)=>sanitizeVector(_e,rt,nt)}}var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(tt){return typeof tt=="string"?tt.length>0:typeof tt=="number"},n=function(tt,_e,rt){return _e===void 0&&(_e=0),rt===void 0&&(rt=Math.pow(10,_e)),Math.round(rt*tt)/rt+0},e=function(tt,_e,rt){return _e===void 0&&(_e=0),rt===void 0&&(rt=1),tt>rt?rt:tt>_e?tt:_e},u$1=function(tt){return(tt=isFinite(tt)?tt%360:0)>0?tt:tt+360},a=function(tt){return{r:e(tt.r,0,255),g:e(tt.g,0,255),b:e(tt.b,0,255),a:e(tt.a)}},o=function(tt){return{r:n(tt.r),g:n(tt.g),b:n(tt.b),a:n(tt.a,3)}},i$1=/^#([0-9a-f]{3,8})$/i,s$1=function(tt){var _e=tt.toString(16);return _e.length<2?"0"+_e:_e},h$1=function(tt){var _e=tt.r,rt=tt.g,nt=tt.b,it=tt.a,st=Math.max(_e,rt,nt),ot=st-Math.min(_e,rt,nt),lt=ot?st===_e?(rt-nt)/ot:st===rt?2+(nt-_e)/ot:4+(_e-rt)/ot:0;return{h:60*(lt<0?lt+6:lt),s:st?ot/st*100:0,v:st/255*100,a:it}},b$1=function(tt){var _e=tt.h,rt=tt.s,nt=tt.v,it=tt.a;_e=_e/360*6,rt/=100,nt/=100;var st=Math.floor(_e),ot=nt*(1-rt),lt=nt*(1-(_e-st)*rt),at=nt*(1-(1-_e+st)*rt),ct=st%6;return{r:255*[nt,lt,ot,ot,at,nt][ct],g:255*[at,nt,nt,lt,ot,ot][ct],b:255*[ot,ot,at,nt,nt,lt][ct],a:it}},g$1=function(tt){return{h:u$1(tt.h),s:e(tt.s,0,100),l:e(tt.l,0,100),a:e(tt.a)}},d$1=function(tt){return{h:n(tt.h),s:n(tt.s),l:n(tt.l),a:n(tt.a,3)}},f$1=function(tt){return b$1((rt=(_e=tt).s,{h:_e.h,s:(rt*=((nt=_e.l)<50?nt:100-nt)/100)>0?2*rt/(nt+rt)*100:0,v:nt+rt,a:_e.a}));var _e,rt,nt},c$1=function(tt){return{h:(_e=h$1(tt)).h,s:(it=(200-(rt=_e.s))*(nt=_e.v)/100)>0&&it<200?rt*nt/100/(it<=100?it:200-it)*100:0,l:it/2,a:_e.a};var _e,rt,nt,it},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p$1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y$1={string:[[function(tt){var _e=i$1.exec(tt);return _e?(tt=_e[1]).length<=4?{r:parseInt(tt[0]+tt[0],16),g:parseInt(tt[1]+tt[1],16),b:parseInt(tt[2]+tt[2],16),a:tt.length===4?n(parseInt(tt[3]+tt[3],16)/255,2):1}:tt.length===6||tt.length===8?{r:parseInt(tt.substr(0,2),16),g:parseInt(tt.substr(2,2),16),b:parseInt(tt.substr(4,2),16),a:tt.length===8?n(parseInt(tt.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(tt){var _e=v$1.exec(tt)||m$1.exec(tt);return _e?_e[2]!==_e[4]||_e[4]!==_e[6]?null:a({r:Number(_e[1])/(_e[2]?100/255:1),g:Number(_e[3])/(_e[4]?100/255:1),b:Number(_e[5])/(_e[6]?100/255:1),a:_e[7]===void 0?1:Number(_e[7])/(_e[8]?100:1)}):null},"rgb"],[function(tt){var _e=l.exec(tt)||p$1.exec(tt);if(!_e)return null;var rt,nt,it=g$1({h:(rt=_e[1],nt=_e[2],nt===void 0&&(nt="deg"),Number(rt)*(r[nt]||1)),s:Number(_e[3]),l:Number(_e[4]),a:_e[5]===void 0?1:Number(_e[5])/(_e[6]?100:1)});return f$1(it)},"hsl"]],object:[[function(tt){var _e=tt.r,rt=tt.g,nt=tt.b,it=tt.a,st=it===void 0?1:it;return t(_e)&&t(rt)&&t(nt)?a({r:Number(_e),g:Number(rt),b:Number(nt),a:Number(st)}):null},"rgb"],[function(tt){var _e=tt.h,rt=tt.s,nt=tt.l,it=tt.a,st=it===void 0?1:it;if(!t(_e)||!t(rt)||!t(nt))return null;var ot=g$1({h:Number(_e),s:Number(rt),l:Number(nt),a:Number(st)});return f$1(ot)},"hsl"],[function(tt){var _e=tt.h,rt=tt.s,nt=tt.v,it=tt.a,st=it===void 0?1:it;if(!t(_e)||!t(rt)||!t(nt))return null;var ot=function(lt){return{h:u$1(lt.h),s:e(lt.s,0,100),v:e(lt.v,0,100),a:e(lt.a)}}({h:Number(_e),s:Number(rt),v:Number(nt),a:Number(st)});return b$1(ot)},"hsv"]]},N=function(tt,_e){for(var rt=0;rt<_e.length;rt++){var nt=_e[rt][0](tt);if(nt)return[nt,_e[rt][1]]}return[null,void 0]},x=function(tt){return typeof tt=="string"?N(tt.trim(),y$1.string):typeof tt=="object"&&tt!==null?N(tt,y$1.object):[null,void 0]},I$1=function(tt){return x(tt)[1]},M=function(tt,_e){var rt=c$1(tt);return{h:rt.h,s:e(rt.s+100*_e,0,100),l:rt.l,a:rt.a}},H=function(tt){return(299*tt.r+587*tt.g+114*tt.b)/1e3/255},$$1=function(tt,_e){var rt=c$1(tt);return{h:rt.h,s:rt.s,l:e(rt.l+100*_e,0,100),a:rt.a}},j=function(){function tt(_e){this.parsed=x(_e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return tt.prototype.isValid=function(){return this.parsed!==null},tt.prototype.brightness=function(){return n(H(this.rgba),2)},tt.prototype.isDark=function(){return H(this.rgba)<.5},tt.prototype.isLight=function(){return H(this.rgba)>=.5},tt.prototype.toHex=function(){return _e=o(this.rgba),rt=_e.r,nt=_e.g,it=_e.b,ot=(st=_e.a)<1?s$1(n(255*st)):"","#"+s$1(rt)+s$1(nt)+s$1(it)+ot;var _e,rt,nt,it,st,ot},tt.prototype.toRgb=function(){return o(this.rgba)},tt.prototype.toRgbString=function(){return _e=o(this.rgba),rt=_e.r,nt=_e.g,it=_e.b,(st=_e.a)<1?"rgba("+rt+", "+nt+", "+it+", "+st+")":"rgb("+rt+", "+nt+", "+it+")";var _e,rt,nt,it,st},tt.prototype.toHsl=function(){return d$1(c$1(this.rgba))},tt.prototype.toHslString=function(){return _e=d$1(c$1(this.rgba)),rt=_e.h,nt=_e.s,it=_e.l,(st=_e.a)<1?"hsla("+rt+", "+nt+"%, "+it+"%, "+st+")":"hsl("+rt+", "+nt+"%, "+it+"%)";var _e,rt,nt,it,st},tt.prototype.toHsv=function(){return _e=h$1(this.rgba),{h:n(_e.h),s:n(_e.s),v:n(_e.v),a:n(_e.a,3)};var _e},tt.prototype.invert=function(){return w({r:255-(_e=this.rgba).r,g:255-_e.g,b:255-_e.b,a:_e.a});var _e},tt.prototype.saturate=function(_e){return _e===void 0&&(_e=.1),w(M(this.rgba,_e))},tt.prototype.desaturate=function(_e){return _e===void 0&&(_e=.1),w(M(this.rgba,-_e))},tt.prototype.grayscale=function(){return w(M(this.rgba,-1))},tt.prototype.lighten=function(_e){return _e===void 0&&(_e=.1),w($$1(this.rgba,_e))},tt.prototype.darken=function(_e){return _e===void 0&&(_e=.1),w($$1(this.rgba,-_e))},tt.prototype.rotate=function(_e){return _e===void 0&&(_e=15),this.hue(this.hue()+_e)},tt.prototype.alpha=function(_e){return typeof _e=="number"?w({r:(rt=this.rgba).r,g:rt.g,b:rt.b,a:_e}):n(this.rgba.a,3);var rt},tt.prototype.hue=function(_e){var rt=c$1(this.rgba);return typeof _e=="number"?w({h:_e,s:rt.s,l:rt.l,a:rt.a}):n(rt.h)},tt.prototype.isEqual=function(_e){return this.toHex()===w(_e).toHex()},tt}(),w=function(tt){return tt instanceof j?tt:new j(tt)},S$1=[],k$1=function(tt){tt.forEach(function(_e){S$1.indexOf(_e)<0&&(_e(j,y$1),S$1.push(_e))})};function namesPlugin(tt,_e){var rt={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},nt={};for(var it in rt)nt[rt[it]]=it;var st={};tt.prototype.toName=function(ot){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var lt,at,ct=nt[this.toHex()];if(ct)return ct;if(ot!=null&&ot.closest){var ut=this.toRgb(),ht=1/0,dt="black";if(!st.length)for(var ft in rt)st[ft]=new tt(rt[ft]).toRgb();for(var pt in rt){var mt=(lt=ut,at=st[pt],Math.pow(lt.r-at.r,2)+Math.pow(lt.g-at.g,2)+Math.pow(lt.b-at.b,2));mt<ht&&(ht=mt,dt=pt)}return dt}},_e.string.push([function(ot){var lt=ot.toLowerCase(),at=lt==="transparent"?"#0000":rt[lt];return at?new tt(at).toRgb():null},"name"])}function u(){return(u=Object.assign||function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(tt[nt]=rt[nt])}return tt}).apply(this,arguments)}function c(tt,_e){if(tt==null)return{};var rt,nt,it={},st=Object.keys(tt);for(nt=0;nt<st.length;nt++)_e.indexOf(rt=st[nt])>=0||(it[rt]=tt[rt]);return it}function i(tt){var _e=reactExports.useRef(tt),rt=reactExports.useRef(function(nt){_e.current&&_e.current(nt)});return _e.current=tt,rt.current}var s=function(tt,_e,rt){return _e===void 0&&(_e=0),rt===void 0&&(rt=1),tt>rt?rt:tt<_e?_e:tt},f=function(tt){return"touches"in tt},v=function(tt){return tt&&tt.ownerDocument.defaultView||self},d=function(tt,_e,rt){var nt=tt.getBoundingClientRect(),it=f(_e)?function(st,ot){for(var lt=0;lt<st.length;lt++)if(st[lt].identifier===ot)return st[lt];return st[0]}(_e.touches,rt):_e;return{left:s((it.pageX-(nt.left+v(tt).pageXOffset))/nt.width),top:s((it.pageY-(nt.top+v(tt).pageYOffset))/nt.height)}},h=function(tt){!f(tt)&&tt.preventDefault()},m=React.memo(function(tt){var _e=tt.onMove,rt=tt.onKey,nt=c(tt,["onMove","onKey"]),it=reactExports.useRef(null),st=i(_e),ot=i(rt),lt=reactExports.useRef(null),at=reactExports.useRef(!1),ct=reactExports.useMemo(function(){var ft=function(gt){h(gt),(f(gt)?gt.touches.length>0:gt.buttons>0)&&it.current?st(d(it.current,gt,lt.current)):mt(!1)},pt=function(){return mt(!1)};function mt(gt){var vt=at.current,At=v(it.current),yt=gt?At.addEventListener:At.removeEventListener;yt(vt?"touchmove":"mousemove",ft),yt(vt?"touchend":"mouseup",pt)}return[function(gt){var vt=gt.nativeEvent,At=it.current;if(At&&(h(vt),!function(xt,_t){return _t&&!f(xt)}(vt,at.current)&&At)){if(f(vt)){at.current=!0;var yt=vt.changedTouches||[];yt.length&&(lt.current=yt[0].identifier)}At.focus(),st(d(At,vt,lt.current)),mt(!0)}},function(gt){var vt=gt.which||gt.keyCode;vt<37||vt>40||(gt.preventDefault(),ot({left:vt===39?.05:vt===37?-.05:0,top:vt===40?.05:vt===38?-.05:0}))},mt]},[ot,st]),ut=ct[0],ht=ct[1],dt=ct[2];return reactExports.useEffect(function(){return dt},[dt]),React.createElement("div",u({},nt,{onTouchStart:ut,onMouseDown:ut,className:"react-colorful__interactive",ref:it,onKeyDown:ht,tabIndex:0,role:"slider"}))}),g=function(tt){return tt.filter(Boolean).join(" ")},p=function(tt){var _e=tt.color,rt=tt.left,nt=tt.top,it=nt===void 0?.5:nt,st=g(["react-colorful__pointer",tt.className]);return React.createElement("div",{className:st,style:{top:100*it+"%",left:100*rt+"%"}},React.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:_e}}))},b=function(tt,_e,rt){return _e===void 0&&(_e=0),rt===void 0&&(rt=Math.pow(10,_e)),Math.round(rt*tt)/rt},y=function(tt){var _e=tt.s,rt=tt.v,nt=tt.a,it=(200-_e)*rt/100;return{h:b(tt.h),s:b(it>0&&it<200?_e*rt/100/(it<=100?it:200-it)*100:0),l:b(it/2),a:b(nt,2)}},q=function(tt){var _e=y(tt);return"hsl("+_e.h+", "+_e.s+"%, "+_e.l+"%)"},k=function(tt){var _e=y(tt);return"hsla("+_e.h+", "+_e.s+"%, "+_e.l+"%, "+_e.a+")"},I=function(tt){var _e=tt.h,rt=tt.s,nt=tt.v,it=tt.a;_e=_e/360*6,rt/=100,nt/=100;var st=Math.floor(_e),ot=nt*(1-rt),lt=nt*(1-(_e-st)*rt),at=nt*(1-(1-_e+st)*rt),ct=st%6;return{r:b(255*[nt,lt,ot,ot,at,nt][ct]),g:b(255*[at,nt,nt,lt,ot,ot][ct]),b:b(255*[ot,ot,at,nt,nt,lt][ct]),a:b(it,2)}},L=function(tt){var _e=tt.r,rt=tt.g,nt=tt.b,it=tt.a,st=Math.max(_e,rt,nt),ot=st-Math.min(_e,rt,nt),lt=ot?st===_e?(rt-nt)/ot:st===rt?2+(nt-_e)/ot:4+(_e-rt)/ot:0;return{h:b(60*(lt<0?lt+6:lt)),s:b(st?ot/st*100:0),v:b(st/255*100),a:it}},S=React.memo(function(tt){var _e=tt.hue,rt=tt.onChange,nt=g(["react-colorful__hue",tt.className]);return React.createElement("div",{className:nt},React.createElement(m,{onMove:function(it){rt({h:360*it.left})},onKey:function(it){rt({h:s(_e+360*it.left,0,360)})},"aria-label":"Hue","aria-valuenow":b(_e),"aria-valuemax":"360","aria-valuemin":"0"},React.createElement(p,{className:"react-colorful__hue-pointer",left:_e/360,color:q({h:_e,s:100,v:100,a:1})})))}),T=React.memo(function(tt){var _e=tt.hsva,rt=tt.onChange,nt={backgroundColor:q({h:_e.h,s:100,v:100,a:1})};return React.createElement("div",{className:"react-colorful__saturation",style:nt},React.createElement(m,{onMove:function(it){rt({s:100*it.left,v:100-100*it.top})},onKey:function(it){rt({s:s(_e.s+100*it.left,0,100),v:s(_e.v-100*it.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+b(_e.s)+"%, Brightness "+b(_e.v)+"%"},React.createElement(p,{className:"react-colorful__saturation-pointer",top:1-_e.v/100,left:_e.s/100,color:q(_e)})))}),F=function(tt,_e){if(tt===_e)return!0;for(var rt in tt)if(tt[rt]!==_e[rt])return!1;return!0};function Y(tt,_e,rt){var nt=i(rt),it=reactExports.useState(function(){return tt.toHsva(_e)}),st=it[0],ot=it[1],lt=reactExports.useRef({color:_e,hsva:st});reactExports.useEffect(function(){if(!tt.equal(_e,lt.current.color)){var ct=tt.toHsva(_e);lt.current={hsva:ct,color:_e},ot(ct)}},[_e,tt]),reactExports.useEffect(function(){var ct;F(st,lt.current.hsva)||tt.equal(ct=tt.fromHsva(st),lt.current.color)||(lt.current={hsva:st,color:ct},nt(ct))},[st,tt,nt]);var at=reactExports.useCallback(function(ct){ot(function(ut){return Object.assign({},ut,ct)})},[]);return[st,at]}var V=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,$=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},J=new Map,Q=function(tt){V(function(){var _e=tt.current?tt.current.ownerDocument:document;if(_e!==void 0&&!J.has(_e)){var rt=_e.createElement("style");rt.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,J.set(_e,rt);var nt=$();nt&&rt.setAttribute("nonce",nt),_e.head.appendChild(rt)}},[])},U=function(tt){var _e=tt.className,rt=tt.colorModel,nt=tt.color,it=nt===void 0?rt.defaultColor:nt,st=tt.onChange,ot=c(tt,["className","colorModel","color","onChange"]),lt=reactExports.useRef(null);Q(lt);var at=Y(rt,it,st),ct=at[0],ut=at[1],ht=g(["react-colorful",_e]);return React.createElement("div",u({},ot,{ref:lt,className:ht}),React.createElement(T,{hsva:ct,onChange:ut}),React.createElement(S,{hue:ct.h,onChange:ut,className:"react-colorful__last-control"}))},ee=function(tt){var _e=tt.className,rt=tt.hsva,nt=tt.onChange,it={backgroundImage:"linear-gradient(90deg, "+k(Object.assign({},rt,{a:0}))+", "+k(Object.assign({},rt,{a:1}))+")"},st=g(["react-colorful__alpha",_e]),ot=b(100*rt.a);return React.createElement("div",{className:st},React.createElement("div",{className:"react-colorful__alpha-gradient",style:it}),React.createElement(m,{onMove:function(lt){nt({a:lt.left})},onKey:function(lt){nt({a:s(rt.a+lt.left)})},"aria-label":"Alpha","aria-valuetext":ot+"%","aria-valuenow":ot,"aria-valuemin":"0","aria-valuemax":"100"},React.createElement(p,{className:"react-colorful__alpha-pointer",left:rt.a,color:k(rt)})))},re=function(tt){var _e=tt.className,rt=tt.colorModel,nt=tt.color,it=nt===void 0?rt.defaultColor:nt,st=tt.onChange,ot=c(tt,["className","colorModel","color","onChange"]),lt=reactExports.useRef(null);Q(lt);var at=Y(rt,it,st),ct=at[0],ut=at[1],ht=g(["react-colorful",_e]);return React.createElement("div",u({},ot,{ref:lt,className:ht}),React.createElement(T,{hsva:ct,onChange:ut}),React.createElement(S,{hue:ct.h,onChange:ut}),React.createElement(ee,{hsva:ct,onChange:ut,className:"react-colorful__last-control"}))},xe={defaultColor:{r:0,g:0,b:0,a:1},toHsva:L,fromHsva:I,equal:F},Ce=function(tt){return React.createElement(re,u({},tt,{colorModel:xe}))},Me={defaultColor:{r:0,g:0,b:0},toHsva:function(tt){return L({r:tt.r,g:tt.g,b:tt.b,a:1})},fromHsva:function(tt){return{r:(_e=I(tt)).r,g:_e.g,b:_e.b};var _e},equal:F},Ne=function(tt){return React.createElement(U,u({},tt,{colorModel:Me}))};function __awaiter(tt,_e,rt,nt){function it(st){return st instanceof rt?st:new rt(function(ot){ot(st)})}return new(rt||(rt=Promise))(function(st,ot){function lt(ut){try{ct(nt.next(ut))}catch(ht){ot(ht)}}function at(ut){try{ct(nt.throw(ut))}catch(ht){ot(ht)}}function ct(ut){ut.done?st(ut.value):it(ut.value).then(lt,at)}ct((nt=nt.apply(tt,_e||[])).next())})}function __generator(tt,_e){var rt={label:0,sent:function(){if(st[0]&1)throw st[1];return st[1]},trys:[],ops:[]},nt,it,st,ot;return ot={next:lt(0),throw:lt(1),return:lt(2)},typeof Symbol=="function"&&(ot[Symbol.iterator]=function(){return this}),ot;function lt(ct){return function(ut){return at([ct,ut])}}function at(ct){if(nt)throw new TypeError("Generator is already executing.");for(;ot&&(ot=0,ct[0]&&(rt=0)),rt;)try{if(nt=1,it&&(st=ct[0]&2?it.return:ct[0]?it.throw||((st=it.return)&&st.call(it),0):it.next)&&!(st=st.call(it,ct[1])).done)return st;switch(it=0,st&&(ct=[ct[0]&2,st.value]),ct[0]){case 0:case 1:st=ct;break;case 4:return rt.label++,{value:ct[1],done:!1};case 5:rt.label++,it=ct[1],ct=[0];continue;case 7:ct=rt.ops.pop(),rt.trys.pop();continue;default:if(st=rt.trys,!(st=st.length>0&&st[st.length-1])&&(ct[0]===6||ct[0]===2)){rt=0;continue}if(ct[0]===3&&(!st||ct[1]>st[0]&&ct[1]<st[3])){rt.label=ct[1];break}if(ct[0]===6&&rt.label<st[1]){rt.label=st[1],st=ct;break}if(st&&rt.label<st[2]){rt.label=st[2],rt.ops.push(ct);break}st[2]&&rt.ops.pop(),rt.trys.pop();continue}ct=_e.call(tt,rt)}catch(ut){ct=[6,ut],it=0}finally{nt=st=0}if(ct[0]&5)throw ct[1];return{value:ct[0]?ct[1]:void 0,done:!0}}}function __read(tt,_e){var rt=typeof Symbol=="function"&&tt[Symbol.iterator];if(!rt)return tt;var nt=rt.call(tt),it,st=[],ot;try{for(;(_e===void 0||_e-- >0)&&!(it=nt.next()).done;)st.push(it.value)}catch(lt){ot={error:lt}}finally{try{it&&!it.done&&(rt=nt.return)&&rt.call(nt)}finally{if(ot)throw ot.error}}return st}function __spread(){for(var tt=[],_e=0;_e<arguments.length;_e++)tt=tt.concat(__read(arguments[_e]));return tt}typeof SuppressedError=="function"&&SuppressedError;var COMMON_MIME_TYPES=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function toFileWithPath(tt,_e){var rt=withMimeType(tt);if(typeof rt.path!="string"){var nt=tt.webkitRelativePath;Object.defineProperty(rt,"path",{value:typeof _e=="string"?_e:typeof nt=="string"&&nt.length>0?nt:tt.name,writable:!1,configurable:!1,enumerable:!0})}return rt}function withMimeType(tt){var _e=tt.name,rt=_e&&_e.lastIndexOf(".")!==-1;if(rt&&!tt.type){var nt=_e.split(".").pop().toLowerCase(),it=COMMON_MIME_TYPES.get(nt);it&&Object.defineProperty(tt,"type",{value:it,writable:!1,configurable:!1,enumerable:!0})}return tt}var FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(tt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return isObject$8(tt)&&isDataTransfer(tt)?[2,getDataTransferFiles(tt.dataTransfer,tt.type)]:isChangeEvt(tt)?[2,getInputFiles(tt)]:Array.isArray(tt)&&tt.every(function(rt){return"getFile"in rt&&typeof rt.getFile=="function"})?[2,getFsHandleFiles(tt)]:[2,[]]})})}function isDataTransfer(tt){return isObject$8(tt.dataTransfer)}function isChangeEvt(tt){return isObject$8(tt)&&isObject$8(tt.target)}function isObject$8(tt){return typeof tt=="object"&&tt!==null}function getInputFiles(tt){return fromList(tt.target.files).map(function(_e){return toFileWithPath(_e)})}function getFsHandleFiles(tt){return __awaiter(this,void 0,void 0,function(){var _e;return __generator(this,function(rt){switch(rt.label){case 0:return[4,Promise.all(tt.map(function(nt){return nt.getFile()}))];case 1:return _e=rt.sent(),[2,_e.map(function(nt){return toFileWithPath(nt)})]}})})}function getDataTransferFiles(tt,_e){return __awaiter(this,void 0,void 0,function(){var rt,nt;return __generator(this,function(it){switch(it.label){case 0:return tt===null?[2,[]]:tt.items?(rt=fromList(tt.items).filter(function(st){return st.kind==="file"}),_e!=="drop"?[2,rt]:[4,Promise.all(rt.map(toFilePromises))]):[3,2];case 1:return nt=it.sent(),[2,noIgnoredFiles(flatten(nt))];case 2:return[2,noIgnoredFiles(fromList(tt.files).map(function(st){return toFileWithPath(st)}))]}})})}function noIgnoredFiles(tt){return tt.filter(function(_e){return FILES_TO_IGNORE.indexOf(_e.name)===-1})}function fromList(tt){if(tt===null)return[];for(var _e=[],rt=0;rt<tt.length;rt++){var nt=tt[rt];_e.push(nt)}return _e}function toFilePromises(tt){if(typeof tt.webkitGetAsEntry!="function")return fromDataTransferItem(tt);var _e=tt.webkitGetAsEntry();return _e&&_e.isDirectory?fromDirEntry(_e):fromDataTransferItem(tt)}function flatten(tt){return tt.reduce(function(_e,rt){return __spread(_e,Array.isArray(rt)?flatten(rt):[rt])},[])}function fromDataTransferItem(tt){var _e=tt.getAsFile();if(!_e)return Promise.reject(tt+" is not a File");var rt=toFileWithPath(_e);return Promise.resolve(rt)}function fromEntry(tt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return[2,tt.isDirectory?fromDirEntry(tt):fromFileEntry(tt)]})})}function fromDirEntry(tt){var _e=tt.createReader();return new Promise(function(rt,nt){var it=[];function st(){var ot=this;_e.readEntries(function(lt){return __awaiter(ot,void 0,void 0,function(){var at,ct,ut;return __generator(this,function(ht){switch(ht.label){case 0:if(lt.length)return[3,5];ht.label=1;case 1:return ht.trys.push([1,3,,4]),[4,Promise.all(it)];case 2:return at=ht.sent(),rt(at),[3,4];case 3:return ct=ht.sent(),nt(ct),[3,4];case 4:return[3,6];case 5:ut=Promise.all(lt.map(fromEntry)),it.push(ut),st(),ht.label=6;case 6:return[2]}})})},function(lt){nt(lt)})}st()})}function fromFileEntry(tt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return[2,new Promise(function(rt,nt){tt.file(function(it){var st=toFileWithPath(it,tt.fullPath);rt(st)},function(it){nt(it)})})]})})}var _default=function(tt,_e){if(tt&&_e){var rt=Array.isArray(_e)?_e:_e.split(","),nt=tt.name||"",it=(tt.type||"").toLowerCase(),st=it.replace(/\/.*$/,"");return rt.some(function(ot){var lt=ot.trim().toLowerCase();return lt.charAt(0)==="."?nt.toLowerCase().endsWith(lt):lt.endsWith("/*")?st===lt.replace(/\/.*$/,""):it===lt})}return!0};function ownKeys$1(tt,_e){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(tt);_e&&(nt=nt.filter(function(it){return Object.getOwnPropertyDescriptor(tt,it).enumerable})),rt.push.apply(rt,nt)}return rt}function _objectSpread$1(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$1(Object(rt),!0).forEach(function(nt){_defineProperty$2(tt,nt,rt[nt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ownKeys$1(Object(rt)).forEach(function(nt){Object.defineProperty(tt,nt,Object.getOwnPropertyDescriptor(rt,nt))})}return tt}function _defineProperty$2(tt,_e,rt){return _e in tt?Object.defineProperty(tt,_e,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[_e]=rt,tt}function _slicedToArray$1(tt,_e){return _arrayWithHoles$1(tt)||_iterableToArrayLimit$1(tt,_e)||_unsupportedIterableToArray$1(tt,_e)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(tt,_e){if(tt){if(typeof tt=="string")return _arrayLikeToArray$1(tt,_e);var rt=Object.prototype.toString.call(tt).slice(8,-1);if(rt==="Object"&&tt.constructor&&(rt=tt.constructor.name),rt==="Map"||rt==="Set")return Array.from(tt);if(rt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rt))return _arrayLikeToArray$1(tt,_e)}}function _arrayLikeToArray$1(tt,_e){(_e==null||_e>tt.length)&&(_e=tt.length);for(var rt=0,nt=new Array(_e);rt<_e;rt++)nt[rt]=tt[rt];return nt}function _iterableToArrayLimit$1(tt,_e){var rt=tt==null?null:typeof Symbol<"u"&&tt[Symbol.iterator]||tt["@@iterator"];if(rt!=null){var nt=[],it=!0,st=!1,ot,lt;try{for(rt=rt.call(tt);!(it=(ot=rt.next()).done)&&(nt.push(ot.value),!(_e&&nt.length===_e));it=!0);}catch(at){st=!0,lt=at}finally{try{!it&&rt.return!=null&&rt.return()}finally{if(st)throw lt}}return nt}}function _arrayWithHoles$1(tt){if(Array.isArray(tt))return tt}var FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function(_e){_e=Array.isArray(_e)&&_e.length===1?_e[0]:_e;var rt=Array.isArray(_e)?"one of ".concat(_e.join(", ")):_e;return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(rt)}},getTooLargeRejectionErr=function(_e){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(_e," ").concat(_e===1?"byte":"bytes")}},getTooSmallRejectionErr=function(_e){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(_e," ").concat(_e===1?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(tt,_e){var rt=tt.type==="application/x-moz-file"||_default(tt,_e);return[rt,rt?null:getInvalidTypeRejectionErr(_e)]}function fileMatchSize(tt,_e,rt){if(isDefined(tt.size))if(isDefined(_e)&&isDefined(rt)){if(tt.size>rt)return[!1,getTooLargeRejectionErr(rt)];if(tt.size<_e)return[!1,getTooSmallRejectionErr(_e)]}else{if(isDefined(_e)&&tt.size<_e)return[!1,getTooSmallRejectionErr(_e)];if(isDefined(rt)&&tt.size>rt)return[!1,getTooLargeRejectionErr(rt)]}return[!0,null]}function isDefined(tt){return tt!=null}function allFilesAccepted(tt){var _e=tt.files,rt=tt.accept,nt=tt.minSize,it=tt.maxSize,st=tt.multiple,ot=tt.maxFiles;return!st&&_e.length>1||st&&ot>=1&&_e.length>ot?!1:_e.every(function(lt){var at=fileAccepted(lt,rt),ct=_slicedToArray$1(at,1),ut=ct[0],ht=fileMatchSize(lt,nt,it),dt=_slicedToArray$1(ht,1),ft=dt[0];return ut&&ft})}function isPropagationStopped(tt){return typeof tt.isPropagationStopped=="function"?tt.isPropagationStopped():typeof tt.cancelBubble<"u"?tt.cancelBubble:!1}function isEvtWithFiles(tt){return tt.dataTransfer?Array.prototype.some.call(tt.dataTransfer.types,function(_e){return _e==="Files"||_e==="application/x-moz-file"}):!!tt.target&&!!tt.target.files}function onDocumentDragOver(tt){tt.preventDefault()}function isIe(tt){return tt.indexOf("MSIE")!==-1||tt.indexOf("Trident/")!==-1}function isEdge(tt){return tt.indexOf("Edge/")!==-1}function isIeOrEdge(){var tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return isIe(tt)||isEdge(tt)}function composeEventHandlers(){for(var tt=arguments.length,_e=new Array(tt),rt=0;rt<tt;rt++)_e[rt]=arguments[rt];return function(nt){for(var it=arguments.length,st=new Array(it>1?it-1:0),ot=1;ot<it;ot++)st[ot-1]=arguments[ot];return _e.some(function(lt){return!isPropagationStopped(nt)&&lt&&lt.apply(void 0,[nt].concat(st)),isPropagationStopped(nt)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function filePickerOptionsTypes(tt){return tt=typeof tt=="string"?tt.split(","):tt,[{description:"everything",accept:Array.isArray(tt)?tt.filter(function(_e){return _e==="audio/*"||_e==="video/*"||_e==="image/*"||_e==="text/*"||/\w+\/[-+.\w]+/g.test(_e)}).reduce(function(_e,rt){return _objectSpread$1(_objectSpread$1({},_e),{},_defineProperty$2({},rt,[]))},{}):{}}]}function isAbort(tt){return tt instanceof DOMException&&(tt.name==="AbortError"||tt.code===tt.ABORT_ERR)}function isSecurityError(tt){return tt instanceof DOMException&&(tt.name==="SecurityError"||tt.code===tt.SECURITY_ERR)}var _excluded=["children"],_excluded2$2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray(tt){return _arrayWithoutHoles(tt)||_iterableToArray(tt)||_unsupportedIterableToArray(tt)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(tt){if(typeof Symbol<"u"&&tt[Symbol.iterator]!=null||tt["@@iterator"]!=null)return Array.from(tt)}function _arrayWithoutHoles(tt){if(Array.isArray(tt))return _arrayLikeToArray(tt)}function _slicedToArray(tt,_e){return _arrayWithHoles(tt)||_iterableToArrayLimit(tt,_e)||_unsupportedIterableToArray(tt,_e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(tt,_e){if(tt){if(typeof tt=="string")return _arrayLikeToArray(tt,_e);var rt=Object.prototype.toString.call(tt).slice(8,-1);if(rt==="Object"&&tt.constructor&&(rt=tt.constructor.name),rt==="Map"||rt==="Set")return Array.from(tt);if(rt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rt))return _arrayLikeToArray(tt,_e)}}function _arrayLikeToArray(tt,_e){(_e==null||_e>tt.length)&&(_e=tt.length);for(var rt=0,nt=new Array(_e);rt<_e;rt++)nt[rt]=tt[rt];return nt}function _iterableToArrayLimit(tt,_e){var rt=tt==null?null:typeof Symbol<"u"&&tt[Symbol.iterator]||tt["@@iterator"];if(rt!=null){var nt=[],it=!0,st=!1,ot,lt;try{for(rt=rt.call(tt);!(it=(ot=rt.next()).done)&&(nt.push(ot.value),!(_e&&nt.length===_e));it=!0);}catch(at){st=!0,lt=at}finally{try{!it&&rt.return!=null&&rt.return()}finally{if(st)throw lt}}return nt}}function _arrayWithHoles(tt){if(Array.isArray(tt))return tt}function ownKeys(tt,_e){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(tt);_e&&(nt=nt.filter(function(it){return Object.getOwnPropertyDescriptor(tt,it).enumerable})),rt.push.apply(rt,nt)}return rt}function _objectSpread(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys(Object(rt),!0).forEach(function(nt){_defineProperty$1(tt,nt,rt[nt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ownKeys(Object(rt)).forEach(function(nt){Object.defineProperty(tt,nt,Object.getOwnPropertyDescriptor(rt,nt))})}return tt}function _defineProperty$1(tt,_e,rt){return _e in tt?Object.defineProperty(tt,_e,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[_e]=rt,tt}function _objectWithoutProperties(tt,_e){if(tt==null)return{};var rt=_objectWithoutPropertiesLoose(tt,_e),nt,it;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(tt);for(it=0;it<st.length;it++)nt=st[it],!(_e.indexOf(nt)>=0)&&Object.prototype.propertyIsEnumerable.call(tt,nt)&&(rt[nt]=tt[nt])}return rt}function _objectWithoutPropertiesLoose(tt,_e){if(tt==null)return{};var rt={},nt=Object.keys(tt),it,st;for(st=0;st<nt.length;st++)it=nt[st],!(_e.indexOf(it)>=0)&&(rt[it]=tt[it]);return rt}var Dropzone=reactExports.forwardRef(function(tt,_e){var rt=tt.children,nt=_objectWithoutProperties(tt,_excluded),it=useDropzone(nt),st=it.open,ot=_objectWithoutProperties(it,_excluded2$2);return reactExports.useImperativeHandle(_e,function(){return{open:st}},[st]),React.createElement(reactExports.Fragment,null,rt(_objectSpread(_objectSpread({},ot),{},{open:st})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};Dropzone.defaultProps=defaultProps;Dropzone.propTypes={children:PropTypes.func,accept:PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,validator:PropTypes.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function useDropzone(){var tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_e=_objectSpread(_objectSpread({},defaultProps),tt),rt=_e.accept,nt=_e.disabled,it=_e.getFilesFromEvent,st=_e.maxSize,ot=_e.minSize,lt=_e.multiple,at=_e.maxFiles,ct=_e.onDragEnter,ut=_e.onDragLeave,ht=_e.onDragOver,dt=_e.onDrop,ft=_e.onDropAccepted,pt=_e.onDropRejected,mt=_e.onFileDialogCancel,gt=_e.onFileDialogOpen,vt=_e.useFsAccessApi,At=_e.preventDropOnDocument,yt=_e.noClick,xt=_e.noKeyboard,_t=_e.noDrag,Et=_e.noDragEventsBubbling,bt=_e.validator,wt=reactExports.useMemo(function(){return typeof gt=="function"?gt:noop},[gt]),Tt=reactExports.useMemo(function(){return typeof mt=="function"?mt:noop},[mt]),Mt=reactExports.useRef(null),Pt=reactExports.useRef(null),It=reactExports.useReducer(reducer,initialState),Ot=_slicedToArray(It,2),Bt=Ot[0],Ut=Ot[1],Ft=Bt.isFocused,jt=Bt.isFileDialogActive,Dt=Bt.draggedFiles,Gt=reactExports.useRef(typeof window<"u"&&window.isSecureContext&&vt&&canUseFileSystemAccessAPI()),zt=function(){!Gt.current&&jt&&setTimeout(function(){if(Pt.current){var Qt=Pt.current.files;Qt.length||(Ut({type:"closeDialog"}),Tt())}},300)};reactExports.useEffect(function(){return window.addEventListener("focus",zt,!1),function(){window.removeEventListener("focus",zt,!1)}},[Pt,jt,Tt,Gt]);var $t=reactExports.useRef([]),Ht=function(Qt){Mt.current&&Mt.current.contains(Qt.target)||(Qt.preventDefault(),$t.current=[])};reactExports.useEffect(function(){return At&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",Ht,!1)),function(){At&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",Ht))}},[Mt,At]);var er=reactExports.useCallback(function(Xt){Xt.preventDefault(),Xt.persist(),Sr(Xt),$t.current=[].concat(_toConsumableArray($t.current),[Xt.target]),isEvtWithFiles(Xt)&&Promise.resolve(it(Xt)).then(function(Qt){isPropagationStopped(Xt)&&!Et||(Ut({draggedFiles:Qt,isDragActive:!0,type:"setDraggedFiles"}),ct&&ct(Xt))})},[it,ct,Et]),Zt=reactExports.useCallback(function(Xt){Xt.preventDefault(),Xt.persist(),Sr(Xt);var Qt=isEvtWithFiles(Xt);if(Qt&&Xt.dataTransfer)try{Xt.dataTransfer.dropEffect="copy"}catch{}return Qt&&ht&&ht(Xt),!1},[ht,Et]),or=reactExports.useCallback(function(Xt){Xt.preventDefault(),Xt.persist(),Sr(Xt);var Qt=$t.current.filter(function(kr){return Mt.current&&Mt.current.contains(kr)}),hr=Qt.indexOf(Xt.target);hr!==-1&&Qt.splice(hr,1),$t.current=Qt,!(Qt.length>0)&&(Ut({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),isEvtWithFiles(Xt)&&ut&&ut(Xt))},[Mt,ut,Et]),Kt=reactExports.useCallback(function(Xt,Qt){var hr=[],kr=[];Xt.forEach(function(yr){var _r=fileAccepted(yr,rt),Hr=_slicedToArray(_r,2),Er=Hr[0],Ar=Hr[1],qt=fileMatchSize(yr,ot,st),pr=_slicedToArray(qt,2),mr=pr[0],nr=pr[1],Cr=bt?bt(yr):null;if(Er&&mr&&!Cr)hr.push(yr);else{var cr=[Ar,nr];Cr&&(cr=cr.concat(Cr)),kr.push({file:yr,errors:cr.filter(function(Jr){return Jr})})}}),(!lt&&hr.length>1||lt&&at>=1&&hr.length>at)&&(hr.forEach(function(yr){kr.push({file:yr,errors:[TOO_MANY_FILES_REJECTION]})}),hr.splice(0)),Ut({acceptedFiles:hr,fileRejections:kr,type:"setFiles"}),dt&&dt(hr,kr,Qt),kr.length>0&&pt&&pt(kr,Qt),hr.length>0&&ft&&ft(hr,Qt)},[Ut,lt,rt,ot,st,at,dt,ft,pt,bt]),rr=reactExports.useCallback(function(Xt){Xt.preventDefault(),Xt.persist(),Sr(Xt),$t.current=[],isEvtWithFiles(Xt)&&Promise.resolve(it(Xt)).then(function(Qt){isPropagationStopped(Xt)&&!Et||Kt(Qt,Xt)}),Ut({type:"reset"})},[it,Kt,Et]),ur=reactExports.useCallback(function(){if(Gt.current){Ut({type:"openDialog"}),wt();var Xt={multiple:lt,types:filePickerOptionsTypes(rt)};window.showOpenFilePicker(Xt).then(function(Qt){return it(Qt)}).then(function(Qt){Kt(Qt,null),Ut({type:"closeDialog"})}).catch(function(Qt){isAbort(Qt)?(Tt(Qt),Ut({type:"closeDialog"})):isSecurityError(Qt)&&(Gt.current=!1,Pt.current&&(Pt.current.value=null,Pt.current.click()))});return}Pt.current&&(Ut({type:"openDialog"}),wt(),Pt.current.value=null,Pt.current.click())},[Ut,wt,Tt,vt,Kt,rt,lt]),fr=reactExports.useCallback(function(Xt){!Mt.current||!Mt.current.isEqualNode(Xt.target)||(Xt.key===" "||Xt.key==="Enter"||Xt.keyCode===32||Xt.keyCode===13)&&(Xt.preventDefault(),ur())},[Mt,ur]),dr=reactExports.useCallback(function(){Ut({type:"focus"})},[]),gr=reactExports.useCallback(function(){Ut({type:"blur"})},[]),Yt=reactExports.useCallback(function(){yt||(isIeOrEdge()?setTimeout(ur,0):ur())},[yt,ur]),xr=function(Qt){return nt?null:Qt},vr=function(Qt){return xt?null:xr(Qt)},Pr=function(Qt){return _t?null:xr(Qt)},Sr=function(Qt){Et&&Qt.stopPropagation()},Qr=reactExports.useMemo(function(){return function(){var Xt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qt=Xt.refKey,hr=Qt===void 0?"ref":Qt,kr=Xt.role,yr=Xt.onKeyDown,_r=Xt.onFocus,Hr=Xt.onBlur,Er=Xt.onClick,Ar=Xt.onDragEnter,qt=Xt.onDragOver,pr=Xt.onDragLeave,mr=Xt.onDrop,nr=_objectWithoutProperties(Xt,_excluded3);return _objectSpread(_objectSpread(_defineProperty$1({onKeyDown:vr(composeEventHandlers(yr,fr)),onFocus:vr(composeEventHandlers(_r,dr)),onBlur:vr(composeEventHandlers(Hr,gr)),onClick:xr(composeEventHandlers(Er,Yt)),onDragEnter:Pr(composeEventHandlers(Ar,er)),onDragOver:Pr(composeEventHandlers(qt,Zt)),onDragLeave:Pr(composeEventHandlers(pr,or)),onDrop:Pr(composeEventHandlers(mr,rr)),role:typeof kr=="string"&&kr!==""?kr:"button"},hr,Mt),!nt&&!xt?{tabIndex:0}:{}),nr)}},[Mt,fr,dr,gr,Yt,er,Zt,or,rr,xt,_t,nt]),Ir=reactExports.useCallback(function(Xt){Xt.stopPropagation()},[]),Dr=reactExports.useMemo(function(){return function(){var Xt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qt=Xt.refKey,hr=Qt===void 0?"ref":Qt,kr=Xt.onChange,yr=Xt.onClick,_r=_objectWithoutProperties(Xt,_excluded4),Hr=_defineProperty$1({accept:rt,multiple:lt,type:"file",style:{display:"none"},onChange:xr(composeEventHandlers(kr,rr)),onClick:xr(composeEventHandlers(yr,Ir)),tabIndex:-1},hr,Pt);return _objectSpread(_objectSpread({},Hr),_r)}},[Pt,rt,lt,rr,nt]),Ur=Dt.length,Lr=Ur>0&&allFilesAccepted({files:Dt,accept:rt,minSize:ot,maxSize:st,multiple:lt,maxFiles:at}),Wr=Ur>0&&!Lr;return _objectSpread(_objectSpread({},Bt),{},{isDragAccept:Lr,isDragReject:Wr,isFocused:Ft&&!nt,getRootProps:Qr,getInputProps:Dr,rootRef:Mt,inputRef:Pt,open:xr(ur)})}function reducer(tt,_e){switch(_e.type){case"focus":return _objectSpread(_objectSpread({},tt),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},tt),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},tt),{},{isFileDialogActive:!1});case"setDraggedFiles":var rt=_e.isDragActive,nt=_e.draggedFiles;return _objectSpread(_objectSpread({},tt),{},{draggedFiles:nt,isDragActive:rt});case"setFiles":return _objectSpread(_objectSpread({},tt),{},{acceptedFiles:_e.acceptedFiles,fileRejections:_e.fileRejections});case"reset":return _objectSpread({},initialState);default:return tt}}function noop(){}/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isobject=function(_e){return _e!=null&&typeof _e=="object"&&Array.isArray(_e)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isObject$7=isobject;function isObjectObject(tt){return isObject$7(tt)===!0&&Object.prototype.toString.call(tt)==="[object Object]"}var isPlainObject$2=function(_e){var rt,nt;return!(isObjectObject(_e)===!1||(rt=_e.constructor,typeof rt!="function")||(nt=rt.prototype,isObjectObject(nt)===!1)||nt.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isPlainObject$1=isPlainObject$2,isExtendable$4=function(_e){return isPlainObject$1(_e)||typeof _e=="function"||Array.isArray(_e)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var forIn$1=function(_e,rt,nt){for(var it in _e)if(rt.call(nt,_e[it],it,_e)===!1)break},isExtendable$3=isExtendable$4,forIn=forIn$1;function mixinDeep(tt,_e){for(var rt=arguments.length,nt=0;++nt<rt;){var it=arguments[nt];isObject$6(it)&&forIn(it,copy,tt)}return tt}function copy(tt,_e){if(isValidKey$1(_e)){var rt=this[_e];isObject$6(tt)&&isObject$6(rt)?mixinDeep(rt,tt):this[_e]=tt}}function isObject$6(tt){return isExtendable$3(tt)&&!Array.isArray(tt)}function isValidKey$1(tt){return tt!=="__proto__"&&tt!=="constructor"&&tt!=="prototype"}var mixinDeep_1=mixinDeep;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var getValue$2=function(tt,_e,rt,nt,it){if(!isObject$5(tt)||!_e)return tt;if(_e=toString(_e),rt&&(_e+="."+toString(rt)),nt&&(_e+="."+toString(nt)),it&&(_e+="."+toString(it)),_e in tt)return tt[_e];for(var st=_e.split("."),ot=st.length,lt=-1;tt&&++lt<ot;){for(var at=st[lt];at[at.length-1]==="\\";)at=at.slice(0,-1)+"."+st[++lt];tt=tt[at]}return tt};function isObject$5(tt){return tt!==null&&(typeof tt=="object"||typeof tt=="function")}function toString(tt){return tt?Array.isArray(tt)?tt.join("."):tt:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var assignSymbols$1=function(tt,_e){if(tt===null||typeof tt>"u")throw new TypeError("expected first argument to be an object.");if(typeof _e>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return tt;for(var rt=Object.prototype.propertyIsEnumerable,nt=Object(tt),it=arguments.length,st=0;++st<it;)for(var ot=Object(arguments[st]),lt=Object.getOwnPropertySymbols(ot),at=0;at<lt.length;at++){var ct=lt[at];rt.call(ot,ct)&&(nt[ct]=ot[ct])}return nt},isExtendable$2=isExtendable$4,assignSymbols=assignSymbols$1,extendShallow$1=Object.assign||function(tt){if(tt===null||typeof tt>"u")throw new TypeError("Cannot convert undefined or null to object");isObject$4(tt)||(tt={});for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];isString(rt)&&(rt=toObject(rt)),isObject$4(rt)&&(assign$2(tt,rt),assignSymbols(tt,rt))}return tt};function assign$2(tt,_e){for(var rt in _e)hasOwn$1(_e,rt)&&(tt[rt]=_e[rt])}function isString(tt){return tt&&typeof tt=="string"}function toObject(tt){var _e={};for(var rt in tt)_e[rt]=tt[rt];return _e}function isObject$4(tt){return tt&&typeof tt=="object"||isExtendable$2(tt)}function hasOwn$1(tt,_e){return Object.prototype.hasOwnProperty.call(tt,_e)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var extend$1=extendShallow$1,splitString=function(tt,_e,rt){if(typeof tt!="string")throw new TypeError("expected a string");typeof _e=="function"&&(rt=_e,_e=null),typeof _e=="string"&&(_e={sep:_e});var nt=extend$1({sep:"."},_e),it=nt.quotes||['"',"'","`"],st;nt.brackets===!0?st={"<":">","(":")","[":"]","{":"}"}:nt.brackets&&(st=nt.brackets);var ot=[],lt=[],at=[""],ct=nt.sep,ut=tt.length,ht=-1,dt;function ft(){if(st&&lt.length)return st[lt[lt.length-1]]}for(;++ht<ut;){var pt=tt[ht],mt=tt[ht+1],gt={val:pt,idx:ht,arr:at,str:tt};if(ot.push(gt),pt==="\\"){gt.val=keepEscaping(nt,tt,ht)===!0?pt+mt:mt,gt.escaped=!0,typeof rt=="function"&&rt(gt),at[at.length-1]+=gt.val,ht++;continue}if(st&&st[pt]){lt.push(pt);var vt=ft(),At=ht+1;if(tt.indexOf(vt,At+1)!==-1)for(;lt.length&&At<ut;){var yt=tt[++At];if(yt==="\\"){yt++;continue}if(it.indexOf(yt)!==-1){At=getClosingQuote(tt,yt,At+1);continue}if(vt=ft(),lt.length&&tt.indexOf(vt,At+1)===-1)break;if(st[yt]){lt.push(yt);continue}vt===yt&&lt.pop()}if(dt=At,dt===-1){at[at.length-1]+=pt;continue}pt=tt.slice(ht,dt+1),gt.val=pt,gt.idx=ht=dt}if(it.indexOf(pt)!==-1){if(dt=getClosingQuote(tt,pt,ht+1),dt===-1){at[at.length-1]+=pt;continue}keepQuotes(pt,nt)===!0?pt=tt.slice(ht,dt+1):pt=tt.slice(ht+1,dt),gt.val=pt,gt.idx=ht=dt}if(typeof rt=="function"&&(rt(gt,ot),pt=gt.val,ht=gt.idx),gt.val===ct&&gt.split!==!1){at.push("");continue}at[at.length-1]+=gt.val}return at};function getClosingQuote(tt,_e,rt,nt){var it=tt.indexOf(_e,rt);return tt.charAt(it-1)==="\\"?getClosingQuote(tt,_e,it+1):it}function keepQuotes(tt,_e){return _e.keepDoubleQuotes===!0&&tt==='"'||_e.keepSingleQuotes===!0&&tt==="'"?!0:_e.keepQuotes}function keepEscaping(tt,_e,rt){return typeof tt.keepEscaping=="function"?tt.keepEscaping(_e,rt):tt.keepEscaping===!0||_e[rt+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable$1=function(_e){return typeof _e<"u"&&_e!==null&&(typeof _e=="object"||typeof _e=="function")},isObject$3=isExtendable$1,extendShallow=function(_e){isObject$3(_e)||(_e={});for(var rt=arguments.length,nt=1;nt<rt;nt++){var it=arguments[nt];isObject$3(it)&&assign$1(_e,it)}return _e};function assign$1(tt,_e){for(var rt in _e)hasOwn(_e,rt)&&(tt[rt]=_e[rt])}function hasOwn(tt,_e){return Object.prototype.hasOwnProperty.call(tt,_e)}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable=function(_e){return typeof _e<"u"&&_e!==null&&(typeof _e=="object"||typeof _e=="function")};/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var split=splitString,extend=extendShallow,isPlainObject=isPlainObject$2,isObject$2=isExtendable,setValue=function(tt,_e,rt){if(!isObject$2(tt)||(Array.isArray(_e)&&(_e=[].concat.apply([],_e).join(".")),typeof _e!="string"))return tt;for(var nt=split(_e,{sep:".",brackets:!0}).filter(isValidKey),it=nt.length,st=-1,ot=tt;++st<it;){var lt=nt[st];if(st!==it-1){isObject$2(ot[lt])||(ot[lt]={}),ot=ot[lt];continue}isPlainObject(ot[lt])&&isPlainObject(rt)?ot[lt]=extend({},ot[lt],rt):ot[lt]=rt}return tt};function isValidKey(tt){return tt!=="__proto__"&&tt!=="constructor"&&tt!=="prototype"}var isObject$1=isExtendable$4,merge=mixinDeep_1,get=getValue$2,set=setValue,mergeValue=function(_e,rt,nt){if(!isObject$1(_e))throw new TypeError("expected an object");if(typeof rt!="string"||nt==null)return merge.apply(null,arguments);if(typeof nt=="string")return set(_e,rt,nt),_e;var it=get(_e,rt);return isObject$1(nt)&&isObject$1(it)&&(nt=merge({},it,nt)),set(_e,rt,nt),_e};const merge$1=getDefaultExportFromCjs(mergeValue),join=(...tt)=>tt.filter(Boolean).join(".");function getKeyPath(tt){const _e=tt.split(".");return[_e.pop(),_e.join(".")||void 0]}function getValuesForPaths(tt,_e){return Object.entries(pick(tt,_e)).reduce((rt,[,{value:nt,disabled:it,key:st}])=>(rt[st]=it?void 0:nt,rt),{})}function useCompareMemoize(tt,_e){const rt=reactExports.useRef();return(_e?dequal:shallow)(tt,rt.current)||(rt.current=tt),rt.current}function useDeepMemo(tt,_e){return reactExports.useMemo(tt,useCompareMemoize(_e,!0))}function useToggle(tt){const _e=reactExports.useRef(null),rt=reactExports.useRef(null),nt=reactExports.useRef(!0);return reactExports.useLayoutEffect(()=>{tt||(_e.current.style.height="0px",_e.current.style.overflow="hidden")},[]),reactExports.useEffect(()=>{if(nt.current){nt.current=!1;return}let it;const st=_e.current,ot=()=>{tt&&(st.style.removeProperty("height"),st.style.removeProperty("overflow"),rt.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};st.addEventListener("transitionend",ot,{once:!0});const{height:lt}=rt.current.getBoundingClientRect();return st.style.height=lt+"px",tt||(st.style.overflow="hidden",it=window.setTimeout(()=>st.style.height="0px",50)),()=>{st.removeEventListener("transitionend",ot),clearTimeout(it)}},[tt]),{wrapperRef:_e,contentRef:rt}}const useVisiblePaths=tt=>{const[_e,rt]=reactExports.useState(tt.getVisiblePaths());return reactExports.useEffect(()=>{rt(tt.getVisiblePaths());const nt=tt.useStore.subscribe(tt.getVisiblePaths,rt,{equalityFn:shallow});return()=>nt()},[tt]),_e};function useValuesForPath(tt,_e,rt){return tt.useStore(it=>{const st=_objectSpread2(_objectSpread2({},rt),it.data);return getValuesForPaths(st,_e)},shallow)}function usePopin(tt=3){const _e=reactExports.useRef(null),rt=reactExports.useRef(null),[nt,it]=reactExports.useState(!1),st=reactExports.useCallback(()=>it(!0),[]),ot=reactExports.useCallback(()=>it(!1),[]);return reactExports.useLayoutEffect(()=>{if(nt){const{bottom:lt,top:at,left:ct}=_e.current.getBoundingClientRect(),{height:ut}=rt.current.getBoundingClientRect(),ht=lt+ut>window.innerHeight-40?"up":"down";rt.current.style.position="fixed",rt.current.style.zIndex="10000",rt.current.style.left=ct+"px",ht==="down"?rt.current.style.top=lt+tt+"px":rt.current.style.bottom=window.innerHeight-at+tt+"px"}},[tt,nt]),{popinRef:_e,wrapperRef:rt,shown:nt,show:st,hide:ot}}k$1([namesPlugin]);const convertMap={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};v8n.extend({color:()=>tt=>w(tt).isValid()});const schema$2=tt=>v8n().color().test(tt);function convert(tt,{format:_e,hasAlpha:rt,isString:nt}){const it=convertMap[_e]+(nt&&_e!=="hex"?"String":""),st=tt[it]();return typeof st=="object"&&!rt?omit(st,["a"]):st}const sanitize$2=(tt,_e)=>{const rt=w(tt);if(!rt.isValid())throw Error("Invalid color");return convert(rt,_e)},format$1=(tt,_e)=>convert(w(tt),_objectSpread2(_objectSpread2({},_e),{},{isString:!0,format:"hex"})),normalize$3=({value:tt})=>{const _e=I$1(tt),rt=_e==="name"?"hex":_e,nt=typeof tt=="object"?"a"in tt:_e==="hex"&&tt.length===8||/^(rgba)|(hsla)|(hsva)/.test(tt),it={format:rt,hasAlpha:nt,isString:typeof tt=="string"};return{value:sanitize$2(tt,it),settings:it}};var props$2=Object.freeze({__proto__:null,schema:schema$2,sanitize:sanitize$2,format:format$1,normalize:normalize$3});const ColorPreview=styled("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),PickerContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),PickerWrapper=styled("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function convertToRgb(tt,_e){return _e!=="rgb"?w(tt).toRgb():tt}function Color({value:tt,displayValue:_e,settings:rt,onUpdate:nt}){const{emitOnEditStart:it,emitOnEditEnd:st}=useInputContext(),{format:ot,hasAlpha:lt}=rt,{popinRef:at,wrapperRef:ct,shown:ut,show:ht,hide:dt}=usePopin(),ft=reactExports.useRef(0),[pt,mt]=reactExports.useState(()=>convertToRgb(tt,ot)),gt=lt?Ce:Ne,vt=()=>{mt(convertToRgb(tt,ot)),ht(),it()},At=()=>{dt(),st(),window.clearTimeout(ft.current)},yt=()=>{ft.current=window.setTimeout(At,500)};return reactExports.useEffect(()=>()=>window.clearTimeout(ft.current),[]),React.createElement(React.Fragment,null,React.createElement(ColorPreview,{ref:at,active:ut,onClick:()=>vt(),style:{color:_e}}),ut&&React.createElement(Portal,null,React.createElement(Overlay,{onPointerUp:At}),React.createElement(PickerWrapper,{ref:ct,onMouseEnter:()=>window.clearTimeout(ft.current),onMouseLeave:xt=>xt.buttons===0&&yt()},React.createElement(gt,{color:pt,onChange:nt}))))}function ColorComponent(){const{value:tt,displayValue:_e,label:rt,onChange:nt,onUpdate:it,settings:st}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(PickerContainer,null,React.createElement(Color,{value:tt,displayValue:_e,onChange:nt,onUpdate:it,settings:st}),React.createElement(ValueInput,{value:_e,onChange:nt,onUpdate:it})))}var color=_objectSpread2({component:ColorComponent},props$2);function Vector3dComponent(){const{label:tt,displayValue:_e,onUpdate:rt,settings:nt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Vector,{value:_e,settings:nt,onUpdate:rt}))}var vector3d=_objectSpread2({component:Vector3dComponent},getVectorPlugin(["x","y","z"]));const JoystickTrigger=styled("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),JoystickPlayground=styled("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function Joystick({value:tt,settings:_e,onUpdate:rt}){const nt=reactExports.useRef(),it=reactExports.useRef(0),st=reactExports.useRef(0),ot=reactExports.useRef(1),[lt,at]=reactExports.useState(!1),[ct,ut]=reactExports.useState(!1),[ht,dt]=useTransform(),ft=reactExports.useRef(null),pt=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{if(lt){const{top:It,left:Ot,width:Bt,height:Ut}=ft.current.getBoundingClientRect();pt.current.style.left=Ot+Bt/2+"px",pt.current.style.top=It+Ut/2+"px"}},[lt]);const{keys:[mt,gt],joystick:vt}=_e,At=vt==="invertY"?1:-1,{[mt]:{step:yt},[gt]:{step:xt}}=_e,_t=useTh("sizes","joystickWidth"),Et=useTh("sizes","joystickHeight"),bt=parseFloat(_t)*.8/2,wt=parseFloat(Et)*.8/2,Tt=reactExports.useCallback(()=>{nt.current||(ut(!0),it.current&&dt({x:it.current*bt}),st.current&&dt({y:st.current*-wt}),nt.current=window.setInterval(()=>{rt(It=>{const Ot=yt*it.current*ot.current,Bt=At*xt*st.current*ot.current;return Array.isArray(It)?{[mt]:It[0]+Ot,[gt]:It[1]+Bt}:{[mt]:It[mt]+Ot,[gt]:It[gt]+Bt}})},16))},[bt,wt,rt,dt,yt,xt,mt,gt,At]),Mt=reactExports.useCallback(()=>{window.clearTimeout(nt.current),nt.current=void 0,ut(!1)},[]);reactExports.useEffect(()=>{function It(Ot){ot.current=multiplyStep(Ot)}return window.addEventListener("keydown",It),window.addEventListener("keyup",It),()=>{window.clearTimeout(nt.current),window.removeEventListener("keydown",It),window.removeEventListener("keyup",It)}},[]);const Pt=useDrag(({first:It,active:Ot,delta:[Bt,Ut],movement:[Ft,jt]})=>{It&&at(!0);const Dt=clamp(Ft,-bt,bt),Gt=clamp(jt,-wt,wt);it.current=Math.abs(Ft)>Math.abs(Dt)?Math.sign(Ft-Dt):0,st.current=Math.abs(jt)>Math.abs(Gt)?Math.sign(Gt-jt):0;let zt=tt[mt],$t=tt[gt];Ot?(it.current||(zt+=Bt*yt*ot.current,dt({x:Dt})),st.current||($t-=At*Ut*xt*ot.current,dt({y:Gt})),it.current||st.current?Tt():Mt(),rt({[mt]:zt,[gt]:$t})):(at(!1),it.current=0,st.current=0,dt({x:0,y:0}),Mt())});return React.createElement(JoystickTrigger,_extends({ref:ft},Pt()),lt&&React.createElement(Portal,null,React.createElement(JoystickPlayground,{ref:pt,isOutOfBounds:ct},React.createElement("div",null),React.createElement("span",{ref:ht}))))}const Container$1=styled("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function Vector2dComponent(){const{label:tt,displayValue:_e,onUpdate:rt,settings:nt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Container$1,{withJoystick:!!nt.joystick},nt.joystick&&React.createElement(Joystick,{value:_e,settings:nt,onUpdate:rt}),React.createElement(Vector,{value:_e,settings:nt,onUpdate:rt})))}const _excluded$7=["joystick"],plugin=getVectorPlugin(["x","y"]),normalize$2=tt=>{let{joystick:_e=!0}=tt,rt=_objectWithoutProperties$1(tt,_excluded$7);const{value:nt,settings:it}=plugin.normalize(rt);return{value:nt,settings:_objectSpread2(_objectSpread2({},it),{},{joystick:_e})}};var vector2d=_objectSpread2(_objectSpread2({component:Vector2dComponent},plugin),{},{normalize:normalize$2});const sanitize$1=tt=>{if(tt!==void 0){if(tt instanceof File)try{return URL.createObjectURL(tt)}catch{return}if(typeof tt=="string"&&tt.indexOf("blob:")===0)return tt;throw Error("Invalid image format [undefined | blob | File].")}},schema$1=(tt,_e)=>typeof _e=="object"&&"image"in _e,normalize$1=({image:tt})=>({value:tt});var props$1=Object.freeze({__proto__:null,sanitize:sanitize$1,schema:schema$1,normalize:normalize$1});const ImageContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),DropZone=styled("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),ImagePreview=styled("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),ImageLargePreview=styled("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),Instructions=styled("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),Remove=styled("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function ImageComponent(){const{label:tt,value:_e,onUpdate:rt,disabled:nt}=useInputContext(),{popinRef:it,wrapperRef:st,shown:ot,show:lt,hide:at}=usePopin(),ct=reactExports.useCallback(pt=>{pt.length&&rt(pt[0])},[rt]),ut=reactExports.useCallback(pt=>{pt.stopPropagation(),rt(void 0)},[rt]),{getRootProps:ht,getInputProps:dt,isDragAccept:ft}=useDropzone({maxFiles:1,accept:"image/*",onDrop:ct,disabled:nt});return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(ImageContainer,null,React.createElement(ImagePreview,{ref:it,hasImage:!!_e,onPointerDown:()=>!!_e&&lt(),onPointerUp:at,style:{backgroundImage:_e?`url(${_e})`:"none"}}),ot&&!!_e&&React.createElement(Portal,null,React.createElement(Overlay,{onPointerUp:at,style:{cursor:"pointer"}}),React.createElement(ImageLargePreview,{ref:st,style:{backgroundImage:`url(${_e})`}})),React.createElement(DropZone,ht({isDragAccept:ft}),React.createElement("input",dt()),React.createElement(Instructions,null,ft?"drop image":"click or drop")),React.createElement(Remove,{onClick:ut,disabled:!_e})))}var image=_objectSpread2({component:ImageComponent},props$1);const number=v8n().number(),schema=(tt,_e)=>v8n().array().length(2).every.number().test(tt)&&v8n().schema({min:number,max:number}).test(_e),format=tt=>({min:tt[0],max:tt[1]}),sanitize=(tt,{bounds:[_e,rt]},nt)=>{const it=Array.isArray(tt)?format(tt):tt,st={min:nt[0],max:nt[1]},{min:ot,max:lt}=_objectSpread2(_objectSpread2({},st),it);return[clamp(Number(ot),_e,Math.max(_e,lt)),clamp(Number(lt),Math.min(rt,ot),rt)]},normalize=({value:tt,min:_e,max:rt})=>{const nt={min:_e,max:rt},it=normalizeKeyedNumberSettings(format(tt),{min:nt,max:nt}),st=[_e,rt],ot=_objectSpread2(_objectSpread2({},it),{},{bounds:st});return{value:sanitize(format(tt),ot,tt),settings:ot}};var props=Object.freeze({__proto__:null,schema,format,sanitize,normalize});const _excluded$6=["value","bounds","onDrag"],_excluded2$1=["bounds"],Container=styled("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function IntervalSlider(tt){let{value:_e,bounds:[rt,nt],onDrag:it}=tt,st=_objectWithoutProperties$1(tt,_excluded$6);const ot=reactExports.useRef(null),lt=reactExports.useRef(null),at=reactExports.useRef(null),ct=reactExports.useRef(0),ut=useTh("sizes","scrubberWidth"),ht=useDrag(({event:pt,first:mt,xy:[gt],movement:[vt],memo:At={}})=>{if(mt){const{width:xt,left:_t}=ot.current.getBoundingClientRect();ct.current=xt-parseFloat(ut);const Et=(pt==null?void 0:pt.target)===lt.current||(pt==null?void 0:pt.target)===at.current;At.pos=invertedRange((gt-_t)/xt,rt,nt);const bt=Math.abs(At.pos-_e.min)-Math.abs(At.pos-_e.max);At.key=bt<0||bt===0&&At.pos<=_e.min?"min":"max",Et&&(At.pos=_e[At.key])}const yt=At.pos+invertedRange(vt/ct.current,0,nt-rt);return it({[At.key]:sanitizeStep(yt,st[At.key])}),At}),dt=`calc(${range(_e.min,rt,nt)} * (100% - ${ut} - 8px) + 4px)`,ft=`calc(${1-range(_e.max,rt,nt)} * (100% - ${ut} - 8px) + 4px)`;return React.createElement(RangeWrapper,_extends({ref:ot},ht()),React.createElement(Range,null,React.createElement(Indicator,{style:{left:dt,right:ft}})),React.createElement(Scrubber,{position:"left",ref:lt,style:{left:dt}}),React.createElement(Scrubber,{position:"right",ref:at,style:{right:ft}}))}function IntervalComponent(){const{label:tt,displayValue:_e,onUpdate:rt,settings:nt}=useInputContext(),it=_objectWithoutProperties$1(nt,_excluded2$1);return React.createElement(React.Fragment,null,React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Container,null,React.createElement(IntervalSlider,_extends({value:_e},nt,{onDrag:rt})),React.createElement(Vector,{value:_e,settings:it,onUpdate:rt,innerLabelTrim:0}))))}var interval=_objectSpread2({component:IntervalComponent},props);const createEventEmitter=()=>{const tt=new Map;return{on:(_e,rt)=>{let nt=tt.get(_e);nt===void 0&&(nt=new Set,tt.set(_e,nt)),nt.add(rt)},off:(_e,rt)=>{const nt=tt.get(_e);nt!==void 0&&(nt.delete(rt),nt.size===0&&tt.delete(_e))},emit:(_e,...rt)=>{const nt=tt.get(_e);if(nt!==void 0)for(const it of nt)it(...rt)}}},_excluded$5=["type","value"],_excluded2=["onChange","transient","onEditStart","onEditEnd"],Store=function(){const _e=create(subscribeWithSelector(()=>({data:{}}))),rt=createEventEmitter();this.storeId=getUid(),this.useStore=_e;const nt={},it=new Set;this.getVisiblePaths=()=>{const ot=this.getData(),lt=Object.keys(ot),at=[];Object.entries(nt).forEach(([ut,ht])=>{ht.render&&lt.some(dt=>dt.indexOf(ut)===0)&&!ht.render(this.get)&&at.push(ut+".")});const ct=[];return it.forEach(ut=>{ut in ot&&ot[ut].__refCount>0&&at.every(ht=>ut.indexOf(ht)===-1)&&(!ot[ut].render||ot[ut].render(this.get))&&ct.push(ut)}),ct},this.setOrderedPaths=ot=>{ot.forEach(lt=>it.add(lt))},this.orderPaths=ot=>(this.setOrderedPaths(ot),ot),this.disposePaths=ot=>{_e.setState(lt=>{const at=lt.data;return ot.forEach(ct=>{if(ct in at){const ut=at[ct];ut.__refCount--,ut.__refCount===0&&ut.type in SpecialInputs&&delete at[ct]}}),{data:at}})},this.dispose=()=>{_e.setState(()=>({data:{}}))},this.getFolderSettings=ot=>nt[ot]||{},this.getData=()=>_e.getState().data,this.addData=(ot,lt)=>{_e.setState(at=>{const ct=at.data;return Object.entries(ot).forEach(([ut,ht])=>{let dt=ct[ut];if(dt){const{type:ft,value:pt}=ht,mt=_objectWithoutProperties$1(ht,_excluded$5);ft!==dt.type?warn(LevaErrors.INPUT_TYPE_OVERRIDE,ft):((dt.__refCount===0||lt)&&Object.assign(dt,mt),dt.__refCount++)}else ct[ut]=_objectSpread2(_objectSpread2({},ht),{},{__refCount:1})}),{data:ct}})},this.setValueAtPath=(ot,lt,at)=>{_e.setState(ct=>{const ut=ct.data;return updateInput(ut[ot],lt,ot,this,at),{data:ut}})},this.setSettingsAtPath=(ot,lt)=>{_e.setState(at=>{const ct=at.data;return ct[ot].settings=_objectSpread2(_objectSpread2({},ct[ot].settings),lt),{data:ct}})},this.disableInputAtPath=(ot,lt)=>{_e.setState(at=>{const ct=at.data;return ct[ot].disabled=lt,{data:ct}})},this.set=(ot,lt)=>{_e.setState(at=>{const ct=at.data;return Object.entries(ot).forEach(([ut,ht])=>{try{updateInput(ct[ut],ht,void 0,void 0,lt)}catch{}}),{data:ct}})},this.getInput=ot=>{try{return this.getData()[ot]}catch{warn(LevaErrors.PATH_DOESNT_EXIST,ot)}},this.get=ot=>{var lt;return(lt=this.getInput(ot))===null||lt===void 0?void 0:lt.value},this.emitOnEditStart=ot=>{rt.emit(`onEditStart:${ot}`,this.get(ot),ot,_objectSpread2(_objectSpread2({},this.getInput(ot)),{},{get:this.get}))},this.emitOnEditEnd=ot=>{rt.emit(`onEditEnd:${ot}`,this.get(ot),ot,_objectSpread2(_objectSpread2({},this.getInput(ot)),{},{get:this.get}))},this.subscribeToEditStart=(ot,lt)=>{const at=`onEditStart:${ot}`;return rt.on(at,lt),()=>rt.off(at,lt)},this.subscribeToEditEnd=(ot,lt)=>{const at=`onEditEnd:${ot}`;return rt.on(at,lt),()=>rt.off(at,lt)};const st=(ot,lt,at)=>{const ct={};return Object.entries(ot).forEach(([ut,ht])=>{if(ut==="")return warn(LevaErrors.EMPTY_KEY);let dt=join(lt,ut);if(ht.type===SpecialInputs.FOLDER){const ft=st(ht.schema,dt,at);Object.assign(ct,ft),dt in nt||(nt[dt]=ht.settings)}else if(ut in at)warn(LevaErrors.DUPLICATE_KEYS,ut,dt,at[ut].path);else{const ft=normalizeInput(ht,ut,dt,ct);if(ft){const{type:pt,options:mt,input:gt}=ft,{onChange:vt,transient:At,onEditStart:yt,onEditEnd:xt}=mt,_t=_objectWithoutProperties$1(mt,_excluded2);ct[dt]=_objectSpread2(_objectSpread2(_objectSpread2({type:pt},_t),gt),{},{fromPanel:!0}),at[ut]={path:dt,onChange:vt,transient:At,onEditStart:yt,onEditEnd:xt}}else warn(LevaErrors.UNKNOWN_INPUT,dt,ht)}}),ct};this.getDataFromSchema=ot=>{const lt={};return[st(ot,"",lt),lt]}},levaStore=new Store,defaultSettings$2={collapsed:!1};function folder(tt,_e){return{type:SpecialInputs.FOLDER,schema:tt,settings:_objectSpread2(_objectSpread2({},defaultSettings$2),_e)}}const defaultSettings$1={disabled:!1};function button(tt,_e){return{type:SpecialInputs.BUTTON,onClick:tt,settings:_objectSpread2(_objectSpread2({},defaultSettings$1),_e)}}const isInput=tt=>"__levaInput"in tt,buildTree=(tt,_e)=>{const rt={},nt=_e?_e.toLowerCase():null;return tt.forEach(it=>{const[st,ot]=getKeyPath(it);(!nt||st.toLowerCase().indexOf(nt)>-1)&&merge$1(rt,ot,{[st]:{__levaInput:!0,path:it}})}),rt},_excluded$4=["type","label","path","valueKey","value","settings","setValue","disabled"];function ControlInput(tt){let{type:_e,label:rt,path:nt,valueKey:it,value:st,settings:ot,setValue:lt,disabled:at}=tt,ct=_objectWithoutProperties$1(tt,_excluded$4);const{displayValue:ut,onChange:ht,onUpdate:dt}=useInputSetters({type:_e,value:st,settings:ot,setValue:lt}),ft=Plugins[_e].component;return ft?React.createElement(InputContext.Provider,{value:_objectSpread2({key:it,path:nt,id:""+nt,label:rt,displayValue:ut,value:st,onChange:ht,onUpdate:dt,settings:ot,setValue:lt,disabled:at},ct)},React.createElement(StyledInputWrapper$1,{disabled:at},React.createElement(ft,null))):(warn(LevaErrors.NO_COMPONENT_FOR_TYPE,_e,nt),null)}const StyledButton=styled("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function Button$1({onClick:tt,settings:_e,label:rt}){const nt=useStoreContext();return React.createElement(Row,null,React.createElement(StyledButton,{disabled:_e.disabled,onClick:()=>tt(nt.get)},rt))}const StyledButtonGroup=styled("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),StyledButtonGroupButton=styled("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),getOpts=({label:tt,opts:_e})=>{let rt=typeof tt=="string"&&tt.trim()===""?null:tt,nt=_e;return typeof _e.opts=="object"&&(nt.label!==void 0&&(rt=_e.label),nt=_e.opts),{label:rt,opts:nt}};function ButtonGroup(tt){const{label:_e,opts:rt}=getOpts(tt),nt=useStoreContext();return React.createElement(Row,{input:!!_e},_e&&React.createElement(Label,null,_e),React.createElement(StyledButtonGroup,null,Object.entries(rt).map(([it,st])=>React.createElement(StyledButtonGroupButton,{key:it,onClick:()=>st(nt.get)},it))))}const Canvas=styled("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),POINTS=100;function push(tt,_e){tt.push(_e),tt.length>POINTS&&tt.shift()}const MonitorCanvas=reactExports.forwardRef(function({initialValue:tt},_e){const rt=useTh("colors","highlight3"),nt=useTh("colors","elevation2"),it=useTh("colors","highlight1"),[st,ot]=reactExports.useMemo(()=>[w(it).alpha(.4).toRgbString(),w(it).alpha(.1).toRgbString()],[it]),lt=reactExports.useRef([tt]),at=reactExports.useRef(tt),ct=reactExports.useRef(tt),ut=reactExports.useRef(),ht=reactExports.useCallback((pt,mt)=>{if(!pt)return;const{width:gt,height:vt}=pt,At=new Path2D,yt=gt/POINTS,xt=vt*.05;for(let bt=0;bt<lt.current.length;bt++){const wt=range(lt.current[bt],at.current,ct.current),Tt=yt*bt,Mt=vt-wt*(vt-xt*2)-xt;At.lineTo(Tt,Mt)}mt.clearRect(0,0,gt,vt);const _t=new Path2D(At);_t.lineTo(yt*(lt.current.length+1),vt),_t.lineTo(0,vt),_t.lineTo(0,0);const Et=mt.createLinearGradient(0,0,0,vt);Et.addColorStop(0,st),Et.addColorStop(1,ot),mt.fillStyle=Et,mt.fill(_t),mt.strokeStyle=nt,mt.lineJoin="round",mt.lineWidth=14,mt.stroke(At),mt.strokeStyle=rt,mt.lineWidth=2,mt.stroke(At)},[rt,nt,st,ot]),[dt,ft]=useCanvas2d(ht);return reactExports.useImperativeHandle(_e,()=>({frame:pt=>{(at.current===void 0||pt<at.current)&&(at.current=pt),(ct.current===void 0||pt>ct.current)&&(ct.current=pt),push(lt.current,pt),ut.current=requestAnimationFrame(()=>ht(dt.current,ft.current))}}),[dt,ft,ht]),reactExports.useEffect(()=>()=>cancelAnimationFrame(ut.current),[]),React.createElement(Canvas,{ref:dt})}),parse=tt=>Number.isFinite(tt)?tt.toPrecision(2):tt.toString(),MonitorLog=reactExports.forwardRef(function({initialValue:tt},_e){const[rt,nt]=reactExports.useState(parse(tt));return reactExports.useImperativeHandle(_e,()=>({frame:it=>nt(parse(it))}),[]),React.createElement("div",null,rt)});function getValue$1(tt){return typeof tt=="function"?tt():tt.current}function Monitor({label:tt,objectOrFn:_e,settings:rt}){const nt=reactExports.useRef(),it=reactExports.useRef(getValue$1(_e));return reactExports.useEffect(()=>{const st=window.setInterval(()=>{var ot;document.hidden||(ot=nt.current)===null||ot===void 0||ot.frame(getValue$1(_e))},rt.interval);return()=>window.clearInterval(st)},[_e,rt.interval]),React.createElement(Row,{input:!0},React.createElement(Label,{align:"top"},tt),rt.graph?React.createElement(MonitorCanvas,{ref:nt,initialValue:it.current}):React.createElement(MonitorLog,{ref:nt,initialValue:it.current}))}const _excluded$3=["type","label","key"],specialComponents={[SpecialInputs.BUTTON]:Button$1,[SpecialInputs.BUTTON_GROUP]:ButtonGroup,[SpecialInputs.MONITOR]:Monitor},Control=React.memo(({path:tt})=>{const[_e,{set:rt,setSettings:nt,disable:it,storeId:st,emitOnEditStart:ot,emitOnEditEnd:lt}]=useInput(tt);if(!_e)return null;const{type:at,label:ct,key:ut}=_e,ht=_objectWithoutProperties$1(_e,_excluded$3);if(at in SpecialInputs){const dt=specialComponents[at];return React.createElement(dt,_extends({label:ct,path:tt},ht))}return at in Plugins?React.createElement(ControlInput,_extends({key:st+tt,type:at,label:ct,storeId:st,path:tt,valueKey:ut,setValue:rt,setSettings:nt,disable:it,emitOnEditStart:ot,emitOnEditEnd:lt},ht)):(log(LevaErrors.UNSUPPORTED_INPUT,at,tt),null)});function FolderTitle({toggle:tt,toggled:_e,name:rt}){return React.createElement(StyledTitle,{onClick:()=>tt()},React.createElement(Chevron,{toggled:_e}),React.createElement("div",null,rt))}const Folder=({name:tt,path:_e,tree:rt})=>{const nt=useStoreContext(),it=join(_e,tt),{collapsed:st,color:ot}=nt.getFolderSettings(it),[lt,at]=reactExports.useState(!st),ct=reactExports.useRef(null),ut=useTh("colors","folderWidgetColor"),ht=useTh("colors","folderTextColor");return reactExports.useLayoutEffect(()=>{ct.current.style.setProperty("--leva-colors-folderWidgetColor",ot||ut),ct.current.style.setProperty("--leva-colors-folderTextColor",ot||ht)},[ot,ut,ht]),React.createElement(StyledFolder,{ref:ct},React.createElement(FolderTitle,{name:tt,toggled:lt,toggle:()=>at(dt=>!dt)}),React.createElement(TreeWrapper,{parent:it,tree:rt,toggled:lt}))},TreeWrapper=React.memo(({isRoot:tt=!1,fill:_e=!1,flat:rt=!1,parent:nt,tree:it,toggled:st})=>{const{wrapperRef:ot,contentRef:lt}=useToggle(st),at=useStoreContext(),ct=([ht,dt])=>{var ft;return(isInput(dt)?(ft=at.getInput(dt.path))===null||ft===void 0?void 0:ft.order:at.getFolderSettings(join(nt,ht)).order)||0},ut=Object.entries(it).sort((ht,dt)=>ct(ht)-ct(dt));return React.createElement(StyledWrapper,{ref:ot,isRoot:tt,fill:_e,flat:rt},React.createElement(StyledContent,{ref:lt,isRoot:tt,toggled:st},ut.map(([ht,dt])=>isInput(dt)?React.createElement(Control,{key:dt.path,valueKey:dt.valueKey,path:dt.path}):React.createElement(Folder,{key:ht,name:ht,path:nt,tree:dt}))))}),StyledRoot=styled("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${StyledInputRow}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),iconWidth=40,Icon=styled("i",{$flexCenter:"",width:iconWidth,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),StyledTitleWithFilter=styled("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),FilterWrapper=styled("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${Icon}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),StyledFilterInput=styled("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),TitleContainer=styled("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:iconWidth}}}}),FilterInput=React.forwardRef(({setFilter:tt,toggle:_e},rt)=>{const[nt,it]=reactExports.useState(""),st=reactExports.useMemo(()=>debounce(tt,250),[tt]),ot=()=>{tt(""),it("")},lt=at=>{const ct=at.currentTarget.value;_e(!0),it(ct)};return reactExports.useEffect(()=>{st(nt)},[nt,st]),React.createElement(React.Fragment,null,React.createElement(StyledFilterInput,{ref:rt,value:nt,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:at=>at.stopPropagation(),onChange:lt}),React.createElement(Icon,{onClick:()=>ot(),style:{visibility:nt?"visible":"hidden"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function TitleWithFilter({setFilter:tt,onDrag:_e,onDragStart:rt,onDragEnd:nt,toggle:it,toggled:st,title:ot,drag:lt,filterEnabled:at,from:ct}){const[ut,ht]=reactExports.useState(!1),dt=reactExports.useRef(null);reactExports.useEffect(()=>{var pt,mt;ut?(pt=dt.current)===null||pt===void 0||pt.focus():(mt=dt.current)===null||mt===void 0||mt.blur()},[ut]);const ft=useDrag(({offset:[pt,mt],first:gt,last:vt})=>{_e({x:pt,y:mt}),gt&&rt({x:pt,y:mt}),vt&&nt({x:pt,y:mt})},{filterTaps:!0,from:({offset:[pt,mt]})=>[(ct==null?void 0:ct.x)||pt,(ct==null?void 0:ct.y)||mt]});return reactExports.useEffect(()=>{const pt=mt=>{mt.key==="L"&&mt.shiftKey&&mt.metaKey&&ht(gt=>!gt)};return window.addEventListener("keydown",pt),()=>window.removeEventListener("keydown",pt)},[]),React.createElement(React.Fragment,null,React.createElement(StyledTitleWithFilter,{mode:lt?"drag":void 0},React.createElement(Icon,{active:!st,onClick:()=>it()},React.createElement(Chevron,{toggled:st,width:12,height:8})),React.createElement(TitleContainer,_extends({},lt?ft():{},{drag:lt,filterEnabled:at}),ot===void 0&&lt?React.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},React.createElement("circle",{cx:"2",cy:"2",r:"2"}),React.createElement("circle",{cx:"14",cy:"2",r:"2"}),React.createElement("circle",{cx:"26",cy:"2",r:"2"}),React.createElement("circle",{cx:"2",cy:"12",r:"2"}),React.createElement("circle",{cx:"14",cy:"12",r:"2"}),React.createElement("circle",{cx:"26",cy:"12",r:"2"})):ot),at&&React.createElement(Icon,{active:ut,onClick:()=>ht(pt=>!pt)},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},React.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),React.createElement(FilterWrapper,{toggled:ut},React.createElement(FilterInput,{ref:dt,setFilter:tt,toggle:it})))}const _excluded$2=["store","hidden","theme","collapsed"];function LevaRoot(tt){let{store:_e,hidden:rt=!1,theme:nt,collapsed:it=!1}=tt,st=_objectWithoutProperties$1(tt,_excluded$2);const ot=useDeepMemo(()=>mergeTheme(nt),[nt]),[lt,at]=reactExports.useState(!it),ct=typeof it=="object"?!it.collapsed:lt,ut=reactExports.useMemo(()=>typeof it=="object"?ht=>{typeof ht=="function"?it.onChange(!ht(!it.collapsed)):it.onChange(!ht)}:at,[it]);return!_e||rt?null:React.createElement(ThemeContext.Provider,{value:ot},React.createElement(LevaCore,_extends({store:_e},st,{toggled:ct,setToggle:ut,rootClass:ot.className})))}const LevaCore=React.memo(({store:tt,rootClass:_e,fill:rt=!1,flat:nt=!1,neverHide:it=!1,oneLineLabels:st=!1,titleBar:ot={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:lt=!1,toggled:at,setToggle:ct})=>{var ut,ht;const dt=useVisiblePaths(tt),[ft,pt]=reactExports.useState(""),mt=reactExports.useMemo(()=>buildTree(dt,ft),[dt,ft]),[gt,vt]=useTransform(),At=it||dt.length>0,yt=typeof ot=="object"&&ot.title||void 0,xt=typeof ot=="object"&&(ut=ot.drag)!==null&&ut!==void 0?ut:!0,_t=typeof ot=="object"&&(ht=ot.filter)!==null&&ht!==void 0?ht:!0,Et=typeof ot=="object"&&ot.position||void 0,bt=typeof ot=="object"&&ot.onDrag||void 0,wt=typeof ot=="object"&&ot.onDragStart||void 0,Tt=typeof ot=="object"&&ot.onDragEnd||void 0;return React.useEffect(()=>{vt({x:Et==null?void 0:Et.x,y:Et==null?void 0:Et.y})},[Et,vt]),globalStyles(),React.createElement(PanelSettingsContext.Provider,{value:{hideCopyButton:lt}},React.createElement(StyledRoot,{ref:gt,className:_e,fill:rt,flat:nt,oneLineLabels:st,hideTitleBar:!ot,style:{display:At?"block":"none"}},ot&&React.createElement(TitleWithFilter,{onDrag:Mt=>{vt(Mt),bt==null||bt(Mt)},onDragStart:Mt=>wt==null?void 0:wt(Mt),onDragEnd:Mt=>Tt==null?void 0:Tt(Mt),setFilter:pt,toggle:Mt=>ct(Pt=>Mt??!Pt),toggled:at,title:yt,drag:xt,filterEnabled:_t,from:Et}),At&&React.createElement(StoreContext.Provider,{value:tt},React.createElement(TreeWrapper,{isRoot:!0,fill:rt,flat:nt,tree:mt,toggled:at}))))}),_excluded$1=["isRoot"];let rootInitialized=!1,rootEl=null;function Leva(tt){let{isRoot:_e=!1}=tt,rt=_objectWithoutProperties$1(tt,_excluded$1);return reactExports.useEffect(()=>(rootInitialized=!0,!_e&&rootEl&&(rootEl.remove(),rootEl=null),()=>{_e||(rootInitialized=!1)}),[_e]),React.createElement(LevaRoot,_extends({store:levaStore},rt))}function useRenderRoot(tt){reactExports.useEffect(()=>{tt&&!rootInitialized&&(rootEl||(rootEl=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(rootEl),render(React.createElement(Leva,{isRoot:!0}),rootEl))),rootInitialized=!0)},[tt])}function parseArgs(tt,_e,rt,nt,it){let st,ot,lt,at,ct;return typeof tt=="string"?(ot=tt,st=_e,Array.isArray(rt)?ct=rt:rt&&("store"in rt?(at=rt,ct=nt):(lt=rt,Array.isArray(nt)?ct=nt:(at=nt,ct=it)))):(st=tt,Array.isArray(_e)?ct=_e:(at=_e,ct=rt)),{schema:st,folderName:ot,folderSettings:lt,hookSettings:at,deps:ct||[]}}function useControls(tt,_e,rt,nt,it){const{folderName:st,schema:ot,folderSettings:lt,hookSettings:at,deps:ct}=parseArgs(tt,_e,rt,nt,it),ut=typeof ot=="function",ht=reactExports.useRef(!1),dt=reactExports.useRef(!0),ft=useDeepMemo(()=>{ht.current=!0;const Pt=typeof ot=="function"?ot():ot;return st?{[st]:folder(Pt,lt)}:Pt},ct),pt=!(at!=null&&at.store);useRenderRoot(pt);const[mt]=reactExports.useState(()=>(at==null?void 0:at.store)||levaStore),[gt,vt]=reactExports.useMemo(()=>mt.getDataFromSchema(ft),[mt,ft]),[At,yt,xt,_t,Et]=reactExports.useMemo(()=>{const Pt=[],It=[],Ot={},Bt={},Ut={};return Object.values(vt).forEach(({path:Ft,onChange:jt,onEditStart:Dt,onEditEnd:Gt,transient:zt})=>{Pt.push(Ft),jt?(Ot[Ft]=jt,zt||It.push(Ft)):It.push(Ft),Dt&&(Bt[Ft]=Dt),Gt&&(Ut[Ft]=Gt)}),[Pt,It,Ot,Bt,Ut]},[vt]),bt=reactExports.useMemo(()=>mt.orderPaths(At),[At,mt]),wt=useValuesForPath(mt,yt,gt),Tt=reactExports.useCallback(Pt=>{const It=Object.entries(Pt).reduce((Ot,[Bt,Ut])=>Object.assign(Ot,{[vt[Bt].path]:Ut}),{});mt.set(It,!1)},[mt,vt]),Mt=reactExports.useCallback(Pt=>mt.get(vt[Pt].path),[mt,vt]);return reactExports.useEffect(()=>{const Pt=!dt.current&&ht.current;return mt.addData(gt,Pt),dt.current=!1,ht.current=!1,()=>mt.disposePaths(bt)},[mt,bt,gt]),reactExports.useEffect(()=>{const Pt=[];return Object.entries(xt).forEach(([It,Ot])=>{Ot(mt.get(It),It,_objectSpread2({initial:!0,get:mt.get},mt.getInput(It)));const Bt=mt.useStore.subscribe(Ut=>{const Ft=Ut.data[It];return[Ft.disabled?void 0:Ft.value,Ft]},([Ut,Ft])=>Ot(Ut,It,_objectSpread2({initial:!1,get:mt.get},Ft)),{equalityFn:shallow});Pt.push(Bt)}),()=>Pt.forEach(It=>It())},[mt,xt]),reactExports.useEffect(()=>{const Pt=[];return Object.entries(_t).forEach(([It,Ot])=>Pt.push(mt.subscribeToEditStart(It,Ot))),Object.entries(Et).forEach(([It,Ot])=>Pt.push(mt.subscribeToEditEnd(It,Ot))),()=>Pt.forEach(It=>It())},[_t,Et,mt]),ut?[wt,Tt,Mt]:wt}register(LevaInputs.SELECT,select);register(LevaInputs.IMAGE,image);register(LevaInputs.NUMBER,number$1);register(LevaInputs.COLOR,color);register(LevaInputs.STRING,string);register(LevaInputs.BOOLEAN,boolean);register(LevaInputs.INTERVAL,interval);register(LevaInputs.VECTOR3D,vector3d);register(LevaInputs.VECTOR2D,vector2d);function Button(){const tt=useControls({"Exit Room!":button(_e=>{window.confirm("Are you sure to exit XR Room?")?(window.opener&&window.close(),console.log("User confirmed")):console.log("User cancelled")})});return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("pre",{children:JSON.stringify(tt,null,"  ")})})}const my_polyhedron={Box:new BoxGeometry,Sphere:new SphereGeometry(.785398),Dodecahedron:new DodecahedronGeometry(.785398)},options={x:{value:0,min:0,max:Math.PI*2,step:.01},y:{value:0,min:0,max:Math.PI*2,step:.01},z:{value:0,min:0,max:Math.PI*2,step:.01},visible:!0,color:{value:"lime"},wireframe:!1,model:{value:"Box",options:Object.keys(my_polyhedron)}};function PlayerExample(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Environment,{preset:"sunset",background:!0})})}function VRApp(){const tt=useControls("Polyhedron A",options),_e=useControls("Polyhedron B",options);return Button(),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(VRButton$1,{}),jsxRuntimeExports.jsx(Canvas$1,{camera:{position:[-10,10,10],fov:50},shadows:!0,children:jsxRuntimeExports.jsxs(XR,{children:[jsxRuntimeExports.jsx(Sky,{sunPosition:[0,1,0]}),jsxRuntimeExports.jsx(Floor,{}),jsxRuntimeExports.jsx("ambientLight",{intensity:.5}),jsxRuntimeExports.jsx("pointLight",{position:[5,5,5]}),jsxRuntimeExports.jsx(Hands,{}),jsxRuntimeExports.jsx(RayGrab,{children:jsxRuntimeExports.jsx(Polyhedron,{position:[-2,2,2],rotation:[tt.x,tt.y,tt.z],visible:tt.visible,color:tt.color,wireframe:tt.wireframe,polyhedron_shape:my_polyhedron[tt.model]},"polyhedronA")}),jsxRuntimeExports.jsx(RayGrab,{children:jsxRuntimeExports.jsx(Polyhedron,{position:[2,2,2],rotation:[_e.x,_e.y,_e.z],visible:_e.visible,color:_e.color,wireframe:_e.wireframe,polyhedron_shape:my_polyhedron[_e.model]},"polyhedronB")}),jsxRuntimeExports.jsx(Controllers,{}),jsxRuntimeExports.jsx(Button3D,{position:[0,.8,-4]}),jsxRuntimeExports.jsx(PlayerExample,{}),jsxRuntimeExports.jsx(OrbitControls,{"target-y":1}),jsxRuntimeExports.jsx("axesHelper",{args:[5]}),jsxRuntimeExports.jsx("gridHelper",{}),jsxRuntimeExports.jsx(Stats,{})]})})]})}var commonjsGlobal=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function createCommonjsModule(tt,_e){return _e={exports:{}},tt(_e,_e.exports),_e.exports}var freeGlobal=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")(),_root=root,Symbol$1=_root.Symbol,_Symbol=Symbol$1,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(tt){var _e=hasOwnProperty.call(tt,symToStringTag),rt=tt[symToStringTag];try{tt[symToStringTag]=void 0}catch{}var nt=nativeObjectToString.call(tt);return _e?tt[symToStringTag]=rt:delete tt[symToStringTag],nt}var _getRawTag=getRawTag,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(tt){return nativeObjectToString$1.call(tt)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(tt){return tt==null?tt===void 0?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(tt)?_getRawTag(tt):_objectToString(tt)}var _baseGetTag=baseGetTag;function isObject(tt){var _e=typeof tt;return tt!=null&&(_e=="object"||_e=="function")}var isObject_1=isObject,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(tt){if(!isObject_1(tt))return!1;var _e=_baseGetTag(tt);return _e==funcTag||_e==genTag||_e==asyncTag||_e==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=function(){var tt=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||"");return tt?"Symbol(src)_1."+tt:""}();function isMasked(tt){return!!maskSrcKey&&maskSrcKey in tt}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(tt){if(tt!=null){try{return funcToString.call(tt)}catch{}try{return tt+""}catch{}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(tt){if(!isObject_1(tt)||_isMasked(tt))return!1;var _e=isFunction_1(tt)?reIsNative:reIsHostCtor;return _e.test(_toSource(tt))}var _baseIsNative=baseIsNative;function getValue(tt,_e){return tt==null?void 0:tt[_e]}var _getValue=getValue;function getNative(tt,_e){var rt=_getValue(tt,_e);return _baseIsNative(rt)?rt:void 0}var _getNative=getNative,defineProperty=function(){try{var tt=_getNative(Object,"defineProperty");return tt({},"",{}),tt}catch{}}(),_defineProperty=defineProperty;function baseAssignValue(tt,_e,rt){_e=="__proto__"&&_defineProperty?_defineProperty(tt,_e,{configurable:!0,enumerable:!0,value:rt,writable:!0}):tt[_e]=rt}var _baseAssignValue=baseAssignValue;function eq(tt,_e){return tt===_e||tt!==tt&&_e!==_e}var eq_1=eq,objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty;function assignValue(tt,_e,rt){var nt=tt[_e];(!(hasOwnProperty$2.call(tt,_e)&&eq_1(nt,rt))||rt===void 0&&!(_e in tt))&&_baseAssignValue(tt,_e,rt)}var _assignValue=assignValue;function copyObject(tt,_e,rt,nt){var it=!rt;rt||(rt={});for(var st=-1,ot=_e.length;++st<ot;){var lt=_e[st],at=nt?nt(rt[lt],tt[lt],lt,rt,tt):void 0;at===void 0&&(at=tt[lt]),it?_baseAssignValue(rt,lt,at):_assignValue(rt,lt,at)}return rt}var _copyObject=copyObject;function identity(tt){return tt}var identity_1=identity;function apply(tt,_e,rt){switch(rt.length){case 0:return tt.call(_e);case 1:return tt.call(_e,rt[0]);case 2:return tt.call(_e,rt[0],rt[1]);case 3:return tt.call(_e,rt[0],rt[1],rt[2])}return tt.apply(_e,rt)}var _apply=apply,nativeMax=Math.max;function overRest(tt,_e,rt){return _e=nativeMax(_e===void 0?tt.length-1:_e,0),function(){for(var nt=arguments,it=-1,st=nativeMax(nt.length-_e,0),ot=Array(st);++it<st;)ot[it]=nt[_e+it];it=-1;for(var lt=Array(_e+1);++it<_e;)lt[it]=nt[it];return lt[_e]=rt(ot),_apply(tt,this,lt)}}var _overRest=overRest;function constant(tt){return function(){return tt}}var constant_1=constant,baseSetToString=_defineProperty?function(tt,_e){return _defineProperty(tt,"toString",{configurable:!0,enumerable:!1,value:constant_1(_e),writable:!0})}:identity_1,_baseSetToString=baseSetToString,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(tt){var _e=0,rt=0;return function(){var nt=nativeNow(),it=HOT_SPAN-(nt-rt);if(rt=nt,it>0){if(++_e>=HOT_COUNT)return arguments[0]}else _e=0;return tt.apply(void 0,arguments)}}var _shortOut=shortOut,setToString=_shortOut(_baseSetToString),_setToString=setToString;function baseRest(tt,_e){return _setToString(_overRest(tt,_e,identity_1),tt+"")}var _baseRest=baseRest,MAX_SAFE_INTEGER=9007199254740991;function isLength(tt){return typeof tt=="number"&&tt>-1&&tt%1==0&&tt<=MAX_SAFE_INTEGER}var isLength_1=isLength;function isArrayLike(tt){return tt!=null&&isLength_1(tt.length)&&!isFunction_1(tt)}var isArrayLike_1=isArrayLike,MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(tt,_e){var rt=typeof tt;return _e=_e??MAX_SAFE_INTEGER$1,!!_e&&(rt=="number"||rt!="symbol"&&reIsUint.test(tt))&&tt>-1&&tt%1==0&&tt<_e}var _isIndex=isIndex;function isIterateeCall(tt,_e,rt){if(!isObject_1(rt))return!1;var nt=typeof _e;return(nt=="number"?isArrayLike_1(rt)&&_isIndex(_e,rt.length):nt=="string"&&_e in rt)?eq_1(rt[_e],tt):!1}var _isIterateeCall=isIterateeCall;function createAssigner(tt){return _baseRest(function(_e,rt){var nt=-1,it=rt.length,st=it>1?rt[it-1]:void 0,ot=it>2?rt[2]:void 0;for(st=tt.length>3&&typeof st=="function"?(it--,st):void 0,ot&&_isIterateeCall(rt[0],rt[1],ot)&&(st=it<3?void 0:st,it=1),_e=Object(_e);++nt<it;){var lt=rt[nt];lt&&tt(_e,lt,nt,st)}return _e})}var _createAssigner=createAssigner,objectProto$4=Object.prototype;function isPrototype(tt){var _e=tt&&tt.constructor,rt=typeof _e=="function"&&_e.prototype||objectProto$4;return tt===rt}var _isPrototype=isPrototype;function baseTimes(tt,_e){for(var rt=-1,nt=Array(tt);++rt<tt;)nt[rt]=_e(rt);return nt}var _baseTimes=baseTimes;function isObjectLike(tt){return tt!=null&&typeof tt=="object"}var isObjectLike_1=isObjectLike,argsTag="[object Arguments]";function baseIsArguments(tt){return isObjectLike_1(tt)&&_baseGetTag(tt)==argsTag}var _baseIsArguments=baseIsArguments,objectProto$5=Object.prototype,hasOwnProperty$3=objectProto$5.hasOwnProperty,propertyIsEnumerable=objectProto$5.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(tt){return isObjectLike_1(tt)&&hasOwnProperty$3.call(tt,"callee")&&!propertyIsEnumerable.call(tt,"callee")},isArguments_1=isArguments,isArray=Array.isArray,isArray_1=isArray;function stubFalse(){return!1}var stubFalse_1=stubFalse,isBuffer_1=createCommonjsModule(function(tt,_e){var rt=_e&&!_e.nodeType&&_e,nt=rt&&!0&&tt&&!tt.nodeType&&tt,it=nt&&nt.exports===rt,st=it?_root.Buffer:void 0,ot=st?st.isBuffer:void 0,lt=ot||stubFalse_1;tt.exports=lt}),argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;function baseIsTypedArray(tt){return isObjectLike_1(tt)&&isLength_1(tt.length)&&!!typedArrayTags[_baseGetTag(tt)]}var _baseIsTypedArray=baseIsTypedArray;function baseUnary(tt){return function(_e){return tt(_e)}}var _baseUnary=baseUnary,_nodeUtil=createCommonjsModule(function(tt,_e){var rt=_e&&!_e.nodeType&&_e,nt=rt&&!0&&tt&&!tt.nodeType&&tt,it=nt&&nt.exports===rt,st=it&&_freeGlobal.process,ot=function(){try{var lt=nt&&nt.require&&nt.require("util").types;return lt||st&&st.binding&&st.binding("util")}catch{}}();tt.exports=ot}),nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray,isTypedArray_1=isTypedArray,objectProto$6=Object.prototype,hasOwnProperty$4=objectProto$6.hasOwnProperty;function arrayLikeKeys(tt,_e){var rt=isArray_1(tt),nt=!rt&&isArguments_1(tt),it=!rt&&!nt&&isBuffer_1(tt),st=!rt&&!nt&&!it&&isTypedArray_1(tt),ot=rt||nt||it||st,lt=ot?_baseTimes(tt.length,String):[],at=lt.length;for(var ct in tt)(_e||hasOwnProperty$4.call(tt,ct))&&!(ot&&(ct=="length"||it&&(ct=="offset"||ct=="parent")||st&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||_isIndex(ct,at)))&&lt.push(ct);return lt}var _arrayLikeKeys=arrayLikeKeys;function overArg(tt,_e){return function(rt){return tt(_e(rt))}}var _overArg=overArg,nativeKeys=_overArg(Object.keys,Object),_nativeKeys=nativeKeys,objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function baseKeys(tt){if(!_isPrototype(tt))return _nativeKeys(tt);var _e=[];for(var rt in Object(tt))hasOwnProperty$5.call(tt,rt)&&rt!="constructor"&&_e.push(rt);return _e}var _baseKeys=baseKeys;function keys(tt){return isArrayLike_1(tt)?_arrayLikeKeys(tt):_baseKeys(tt)}var keys_1=keys,objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty,assign=_createAssigner(function(tt,_e){if(_isPrototype(_e)||isArrayLike_1(_e)){_copyObject(_e,keys_1(_e),tt);return}for(var rt in _e)hasOwnProperty$6.call(_e,rt)&&_assignValue(tt,rt,_e[rt])}),assign_1=assign,jsxgraphcore=createCommonjsModule(function(module,exports){(function(tt,_e){module.exports?module.exports=_e():tt.returnExports=_e()})(commonjsGlobal,function(){var requirejs,require,define;return function(tt){function _e(_t,Et){return At.call(_t,Et)}function rt(_t,Et){var bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt,Dt,Gt=Et&&Et.split("/"),zt=gt.map,$t=zt&&zt["*"]||{};if(_t){for(_t=_t.split("/"),Pt=_t.length-1,gt.nodeIdCompat&&xt.test(_t[Pt])&&(_t[Pt]=_t[Pt].replace(xt,"")),_t[0].charAt(0)==="."&&Gt&&(Dt=Gt.slice(0,Gt.length-1),_t=Dt.concat(_t)),Ut=0;Ut<_t.length;Ut++)if((jt=_t[Ut])===".")_t.splice(Ut,1),Ut-=1;else if(jt===".."){if(Ut===0||Ut===1&&_t[2]===".."||_t[Ut-1]==="..")continue;Ut>0&&(_t.splice(Ut-1,2),Ut-=2)}_t=_t.join("/")}if((Gt||$t)&&zt){for(bt=_t.split("/"),Ut=bt.length;Ut>0;Ut-=1){if(wt=bt.slice(0,Ut).join("/"),Gt){for(Ft=Gt.length;Ft>0;Ft-=1)if((Tt=zt[Gt.slice(0,Ft).join("/")])&&(Tt=Tt[wt])){Mt=Tt,It=Ut;break}}if(Mt)break;!Ot&&$t&&$t[wt]&&(Ot=$t[wt],Bt=Ut)}!Mt&&Ot&&(Mt=Ot,It=Bt),Mt&&(bt.splice(0,It,Mt),_t=bt.join("/"))}return _t}function nt(_t,Et){return function(){var bt=yt.call(arguments,0);return typeof bt[0]!="string"&&bt.length===1&&bt.push(null),ht.apply(tt,bt.concat([_t,Et]))}}function it(_t){return function(Et){return rt(Et,_t)}}function st(_t){return function(Et){pt[_t]=Et}}function ot(_t){if(_e(mt,_t)){var Et=mt[_t];delete mt[_t],vt[_t]=!0,ut.apply(tt,Et)}if(!_e(pt,_t)&&!_e(vt,_t))throw new Error("No "+_t);return pt[_t]}function lt(_t){var Et,bt=_t?_t.indexOf("!"):-1;return bt>-1&&(Et=_t.substring(0,bt),_t=_t.substring(bt+1,_t.length)),[Et,_t]}function at(_t){return _t?lt(_t):[]}function ct(_t){return function(){return gt&&gt.config&&gt.config[_t]||{}}}var ut,ht,dt,ft,pt={},mt={},gt={},vt={},At=Object.prototype.hasOwnProperty,yt=[].slice,xt=/\.js$/;dt=function(_t,Et){var bt,wt=lt(_t),Tt=wt[0],Mt=Et[1];return _t=wt[1],Tt&&(Tt=rt(Tt,Mt),bt=ot(Tt)),Tt?_t=bt&&bt.normalize?bt.normalize(_t,it(Mt)):rt(_t,Mt):(_t=rt(_t,Mt),wt=lt(_t),Tt=wt[0],_t=wt[1],Tt&&(bt=ot(Tt))),{f:Tt?Tt+"!"+_t:_t,n:_t,pr:Tt,p:bt}},ft={require:function(_t){return nt(_t)},exports:function(_t){var Et=pt[_t];return Et!==void 0?Et:pt[_t]={}},module:function(_t){return{id:_t,uri:"",exports:pt[_t],config:ct(_t)}}},ut=function(_t,Et,bt,wt){var Tt,Mt,Pt,It,Ot,Bt,Ut,Ft=[],jt=typeof bt;if(wt=wt||_t,Bt=at(wt),jt==="undefined"||jt==="function"){for(Et=!Et.length&&bt.length?["require","exports","module"]:Et,Ot=0;Ot<Et.length;Ot+=1)if(It=dt(Et[Ot],Bt),(Mt=It.f)==="require")Ft[Ot]=ft.require(_t);else if(Mt==="exports")Ft[Ot]=ft.exports(_t),Ut=!0;else if(Mt==="module")Tt=Ft[Ot]=ft.module(_t);else if(_e(pt,Mt)||_e(mt,Mt)||_e(vt,Mt))Ft[Ot]=ot(Mt);else{if(!It.p)throw new Error(_t+" missing "+Mt);It.p.load(It.n,nt(wt,!0),st(Mt),{}),Ft[Ot]=pt[Mt]}Pt=bt?bt.apply(pt[_t],Ft):void 0,_t&&(Tt&&Tt.exports!==tt&&Tt.exports!==pt[_t]?pt[_t]=Tt.exports:Pt===tt&&Ut||(pt[_t]=Pt))}else _t&&(pt[_t]=bt)},requirejs=require=ht=function(_t,Et,bt,wt,Tt){if(typeof _t=="string")return ft[_t]?ft[_t](Et):ot(dt(_t,at(Et)).f);if(!_t.splice){if(gt=_t,gt.deps&&ht(gt.deps,gt.callback),!Et)return;Et.splice?(_t=Et,Et=bt,bt=null):_t=tt}return Et=Et||function(){},typeof bt=="function"&&(bt=wt,wt=Tt),wt?ut(tt,_t,Et,bt):setTimeout(function(){ut(tt,_t,Et,bt)},4),ht},ht.config=function(_t){return ht(_t)},requirejs._defined=pt,define=function(_t,Et,bt){if(typeof _t!="string")throw new Error("See almond README: incorrect module build, no module name");Et.splice||(bt=Et,Et=[]),_e(pt,_t)||_e(mt,_t)||(mt[_t]=[_t,Et,bt])},define.amd={jQuery:!0}}(),define("../node_modules/almond/almond",function(){}),define("jxg",[],function(){var tt={};return typeof JXG!="object"||JXG.extend||(tt=JXG),tt.extend=function(_e,rt,nt,it){var st,ot;nt=nt||!1,it=it||!1;for(st in rt)(!nt||nt&&rt.hasOwnProperty(st))&&(ot=it?st.toLowerCase():st,_e[ot]=rt[st])},tt.extend(tt,{boards:{},readers:{},elements:{},registerElement:function(_e,rt){_e=_e.toLowerCase(),this.elements[_e]=rt},registerReader:function(_e,rt){var nt,it;for(nt=0;nt<rt.length;nt++)it=rt[nt].toLowerCase(),typeof this.readers[it]!="function"&&(this.readers[it]=_e)},shortcut:function(_e,rt){return function(){return _e[rt].apply(this,arguments)}},getRef:function(_e,rt){return tt.deprecated("JXG.getRef()","Board.select()"),_e.select(rt)},getReference:function(_e,rt){return tt.deprecated("JXG.getReference()","Board.select()"),_e.select(rt)},getBoardByContainerId:function(_e){var rt;for(rt in JXG.boards)if(JXG.boards.hasOwnProperty(rt)&&JXG.boards[rt].container===_e)return JXG.boards[rt];return null},deprecated:function(_e,rt){var nt=_e+" is deprecated.";rt&&(nt+=" Please use "+rt+" instead."),tt.warn(nt)},warn:function(_e){typeof window=="object"&&window.console&&console.warn?console.warn("WARNING:",_e):typeof document=="object"&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+_e+"<br />")},debugInt:function(_e){var rt,nt;for(rt=0;rt<arguments.length;rt++)nt=arguments[rt],typeof window=="object"&&window.console&&console.log?console.log(nt):typeof document=="object"&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=nt+"<br/>")},debugWST:function(_e){var rt=new Error;tt.debugInt.apply(this,arguments),rt&&rt.stack&&(tt.debugInt("stacktrace"),tt.debugInt(rt.stack.split(`
`).slice(1).join(`
`)))},debugLine:function(_e){var rt=new Error;tt.debugInt.apply(this,arguments),rt&&rt.stack&&tt.debugInt("Called from",rt.stack.split(`
`).slice(2,3).join(`
`))},debug:function(_e){tt.debugInt.apply(this,arguments)}}),tt}),define("base/constants",["jxg"],function(tt){var _e;return _e={version:"0.99.7",licenseText:"JSXGraph v0.99.7 Copyright (C) see http://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82},tt.extend(tt,_e),_e}),define("utils/type",["jxg","base/constants"],function(tt,_e){return tt.extend(tt,{isId:function(rt,nt){return typeof nt=="string"&&!!rt.objects[nt]},isName:function(rt,nt){return typeof nt=="string"&&!!rt.elementsByName[nt]},isGroup:function(rt,nt){return typeof nt=="string"&&!!rt.groups[nt]},isString:function(rt){return typeof rt=="string"},isNumber:function(rt){return typeof rt=="number"||Object.prototype.toString.call(rt)==="[Object Number]"},isFunction:function(rt){return typeof rt=="function"},isArray:function(rt){return Array.isArray?Array.isArray(rt):rt!==null&&typeof rt=="object"&&typeof rt.splice=="function"&&typeof rt.join=="function"},isObject:function(rt){return typeof rt=="object"&&!this.isArray(rt)},isPoint:function(rt){return rt!==null&&typeof rt=="object"&&rt.elementClass===_e.OBJECT_CLASS_POINT},isPointType:function(rt,nt){var it,st;return!!this.isArray(nt)||!!(this.isFunction(nt)&&(it=nt(),this.isArray(it)&&it.length>1))||(st=rt.select(nt),this.isPoint(st))},isTransformationOrArray:function(rt){if(rt!==null){if(this.isArray(rt)&&rt.length>0)return this.isTransformationOrArray(rt[0]);if(typeof rt=="object")return rt.type===_e.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(rt){return function(nt){return nt!=null}}(),def:function(rt,nt){return this.exists(rt)?rt:nt},str2Bool:function(rt){return!this.exists(rt)||(typeof rt=="boolean"?rt:!!this.isString(rt)&&rt.toLowerCase()==="true")},createEvalFunction:function(rt,nt,it){var st,ot=[];for(st=0;st<it;st++)ot[st]=tt.createFunction(nt[st],rt,"",!0);return function(lt){return ot[lt]()}},createFunction:function(rt,nt,it,st){var ot=null;return this.exists(st)&&!st||!this.isString(rt)?this.isFunction(rt)?ot=rt:this.isNumber(rt)?ot=function(){return rt}:this.isString(rt)&&(ot=function(){return rt}):ot=nt.jc.snippet(rt,!0,it,!0),ot!==null&&(ot.origin=rt),ot},providePoints:function(rt,nt,it,st,ot){var lt,at,ct,ut,ht,dt=0,ft=[];for(this.isArray(nt)||(nt=[nt]),ct=nt.length,this.exists(ot)&&(dt=ot.length),dt===0&&(ut=this.copyAttributes(it,rt.options,st)),lt=0;lt<ct;++lt)if(dt>0&&(at=Math.min(lt,dt-1),ut=this.copyAttributes(it,rt.options,st,ot[at])),this.isArray(nt[lt])&&nt[lt].length>1?ft.push(rt.create("point",nt[lt],ut)):this.isFunction(nt[lt])?(ht=nt[lt](),this.isArray(ht)&&ht.length>1&&ft.push(rt.create("point",[nt[lt]],ut))):ft.push(rt.select(nt[lt])),!this.isPoint(ft[lt]))return!1;return ft},bind:function(rt,nt){return function(){return rt.apply(nt,arguments)}},evaluate:function(rt){return this.isFunction(rt)?rt():rt},indexOf:function(rt,nt,it){var st,ot=this.exists(it);if(Array.indexOf&&!ot)return rt.indexOf(nt);for(st=0;st<rt.length;st++)if(ot&&rt[st][it]===nt||!ot&&rt[st]===nt)return st;return-1},eliminateDuplicates:function(rt){var nt,it=rt.length,st=[],ot={};for(nt=0;nt<it;nt++)ot[rt[nt]]=0;for(nt in ot)ot.hasOwnProperty(nt)&&st.push(nt);return st},swap:function(rt,nt,it){var st;return st=rt[nt],rt[nt]=rt[it],rt[it]=st,rt},uniqueArray:function(rt){var nt,it,st,ot=[];if(rt.length===0)return[];for(nt=0;nt<rt.length;nt++)if(st=this.isArray(rt[nt]),this.exists(rt[nt]))for(it=nt+1;it<rt.length;it++)st&&tt.cmpArrays(rt[nt],rt[it])?rt[nt]=[]:st||rt[nt]!==rt[it]||(rt[nt]="");else rt[nt]="";for(it=0,nt=0;nt<rt.length;nt++)st=this.isArray(rt[nt]),st||rt[nt]===""?st&&rt[nt].length!==0&&(ot[it]=rt[nt].slice(0),it++):(ot[it]=rt[nt],it++);return rt=ot,ot},isInArray:function(rt,nt){return tt.indexOf(rt,nt)>-1},coordsArrayToMatrix:function(rt,nt){var it,st=[],ot=[];for(it=0;it<rt.length;it++)nt?(st.push(rt[it].usrCoords[1]),ot.push(rt[it].usrCoords[2])):ot.push([rt[it].usrCoords[1],rt[it].usrCoords[2]]);return nt&&(ot=[st,ot]),ot},cmpArrays:function(rt,nt){var it;if(rt===nt)return!0;if(rt.length!==nt.length)return!1;for(it=0;it<rt.length;it++)if(this.isArray(rt[it])&&this.isArray(nt[it])){if(!this.cmpArrays(rt[it],nt[it]))return!1}else if(rt[it]!==nt[it])return!1;return!0},removeElementFromArray:function(rt,nt){var it;for(it=0;it<rt.length;it++)if(rt[it]===nt)return rt.splice(it,1),rt;return rt},trunc:function(rt,nt){return nt=tt.def(nt,0),this.toFixed(rt,nt)},_decimalAdjust:function(rt,nt,it){return it===void 0||+it==0?Math[rt](nt):(nt=+nt,it=+it,isNaN(nt)||typeof it!="number"||it%1!=0?NaN:(nt=nt.toString().split("e"),nt=Math[rt](+(nt[0]+"e"+(nt[1]?+nt[1]-it:-it))),nt=nt.toString().split("e"),+(nt[0]+"e"+(nt[1]?+nt[1]+it:it))))},_round10:function(rt,nt){return this._decimalAdjust("round",rt,nt)},_floor10:function(rt,nt){return this._decimalAdjust("floor",rt,nt)},_ceil10:function(rt,nt){return this._decimalAdjust("ceil",rt,nt)},toFixed:function(rt,nt){return this._round10(rt,-nt).toFixed(nt)},autoDigits:function(rt){var nt=Math.abs(rt);return nt>.1?this.toFixed(rt,2):nt>=.01?this.toFixed(rt,4):nt>=1e-4?this.toFixed(rt,6):rt},keys:function(rt,nt){var it,st=[];for(it in rt)nt?rt.hasOwnProperty(it)&&st.push(it):st.push(it);return st},clone:function(rt){var nt={};return nt.prototype=rt,nt},cloneAndCopy:function(rt,nt){var it,st=function(){};st.prototype=rt;for(it in nt)st[it]=nt[it];return st},merge:function(rt,nt){var it,st;for(it in nt)if(nt.hasOwnProperty(it))if(this.isArray(nt[it]))for(rt[it]||(rt[it]=[]),st=0;st<nt[it].length;st++)typeof nt[it][st]=="object"?rt[it][st]=this.merge(rt[it][st],nt[it][st]):rt[it][st]=nt[it][st];else typeof nt[it]=="object"?(rt[it]||(rt[it]={}),rt[it]=this.merge(rt[it],nt[it])):rt[it]=nt[it];return rt},deepCopy:function(rt,nt,it){var st,ot,lt,at;if(it=it||!1,typeof rt!="object"||rt===null)return rt;if(this.isArray(rt))for(st=[],ot=0;ot<rt.length;ot++)lt=rt[ot],typeof lt=="object"?this.exists(lt.board)?st[ot]=lt.id:st[ot]=this.deepCopy(lt):st[ot]=lt;else{st={};for(ot in rt)rt.hasOwnProperty(ot)&&(at=it?ot.toLowerCase():ot,lt=rt[ot],lt!==null&&typeof lt=="object"?this.exists(lt.board)?st[at]=lt.id:st[at]=this.deepCopy(lt):st[at]=lt);for(ot in nt)nt.hasOwnProperty(ot)&&(at=it?ot.toLowerCase():ot,lt=nt[ot],typeof lt=="object"?this.isArray(lt)||!this.exists(st[at])?st[at]=this.deepCopy(lt):st[at]=this.deepCopy(st[at],lt,it):st[at]=lt)}return st},copyAttributes:function(rt,nt,it){var st,ot,lt,at,ct,ut={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(lt=arguments.length,st=lt<3||ut[it]?tt.deepCopy(nt.elements,null,!0):{},lt<4&&this.exists(it)&&this.exists(nt.layer[it])&&(st.layer=nt.layer[it]),at=nt,ct=!0,ot=2;ot<lt;ot++){if(!this.exists(at[arguments[ot]])){ct=!1;break}at=at[arguments[ot]]}for(ct&&(st=tt.deepCopy(st,at,!0)),at=rt,ct=!0,ot=3;ot<lt;ot++){if(!this.exists(at[arguments[ot]])){ct=!1;break}at=at[arguments[ot]]}for(ct&&this.extend(st,at,null,!0),at=nt,ct=!0,ot=2;ot<lt;ot++){if(!this.exists(at[arguments[ot]])){ct=!1;break}at=at[arguments[ot]]}return ct&&this.exists(at.label)&&(st.label=tt.deepCopy(at.label,st.label)),st.label=tt.deepCopy(nt.label,st.label),st},copyPrototypeMethods:function(rt,nt,it){var st;rt.prototype[it]=nt.prototype.constructor;for(st in nt.prototype)nt.prototype.hasOwnProperty(st)&&(rt.prototype[st]=nt.prototype[st])},toJSON:function(rt,nt){var it,st,ot,lt;if(nt=tt.def(nt,!1),JSON.stringify&&!nt)try{return JSON.stringify(rt)}catch{}switch(typeof rt){case"object":if(rt){if(it=[],this.isArray(rt)){for(ot=0;ot<rt.length;ot++)it.push(tt.toJSON(rt[ot],nt));return"["+it.join(",")+"]"}for(st in rt)if(rt.hasOwnProperty(st)){try{lt=tt.toJSON(rt[st],nt)}catch{lt=""}nt?it.push(st+":"+lt):it.push('"'+st+'":'+lt)}return"{"+it.join(",")+"} "}return"null";case"string":return"'"+rt.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return rt.toString()}return"0"},clearVisPropOld:function(rt){return rt.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",transitionduration:0,top:-1e5,visible:null},rt},isInObject:function(rt,nt){var it;for(it in rt)if(rt.hasOwnProperty(it)&&rt[it]===nt)return!0;return!1},escapeHTML:function(rt){return rt.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(rt){return rt.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(rt){return rt.charAt(0).toUpperCase()+rt.substring(1).toLowerCase()},trimNumber:function(rt){return rt=rt.replace(/^0+/,""),rt=rt.replace(/0+$/,""),rt[rt.length-1]!=="."&&rt[rt.length-1]!==","||(rt=rt.slice(0,-1)),rt[0]!=="."&&rt[0]!==","||(rt="0"+rt),rt},filterElements:function(rt,nt){var it,st,ot,lt,at,ct,ut,ht=rt.length,dt=[];if(typeof nt!="function"&&typeof nt!="object")return dt;for(it=0;it<ht;it++){if(ut=!0,ot=rt[it],typeof nt=="object"){for(st in nt)if(nt.hasOwnProperty(st)&&(lt=st.toLowerCase(),at=typeof ot[st]=="function"?ot[st]():ot[st],ct=ot.visProp&&typeof ot.visProp[lt]=="function"?ot.visProp[lt]():ot.visProp&&ot.visProp[lt],!(ut=typeof nt[st]=="function"?nt[st](at)||nt[st](ct):at===nt[st]||ct===nt[st])))break}else typeof nt=="function"&&(ut=nt(ot));ut&&dt.push(ot)}return dt},trim:function(rt){return rt.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(rt,nt){return typeof html_sanitize=="function"&&nt?html_sanitize(rt,function(){},function(it){return it}):(rt&&(rt=rt.replace(/</g,"&lt;").replace(/>/g,"&gt;")),rt)},evalSlider:function(rt){return rt&&rt.type===_e.OBJECT_TYPE_GLIDER&&typeof rt.Value=="function"?rt.Value():rt}}),tt}),define("utils/env",["jxg","utils/type"],function(tt,_e){return tt.extend(tt,{touchProperty:"touches",isBrowser:typeof window=="object"&&typeof document=="object",supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var rt,nt=!1;if(this.isNode())try{rt=module.require("canvas"),nt=!!rt}catch{}return nt||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&(!!module.exports||typeof commonjsGlobal=="object"&&commonjsGlobal.requirejsVars&&!commonjsGlobal.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&typeof self=="object"&&typeof self.postMessage=="function"},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&window.ontouchstart!==void 0},isAndroid:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return _e.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z\.]*Safari/)>-1},isMetroApp:function(){return typeof window=="object"&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1},isFirefoxOS:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")===-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var rt,nt,it=3;if(typeof document!="object")return 0;rt=document.createElement("div"),nt=rt.getElementsByTagName("i");do rt.innerHTML="<!--[if gt IE "+ ++it+"]><i></i><![endif]-->";while(nt[0]);return it>4?it:void 0}(),getDimensions:function(rt,nt){var it,st,ot,lt,at,ct,ut,ht,dt,ft=/\d+(\.\d*)?px/;if(!this.isBrowser||rt===null)return{width:500,height:500};if(nt=nt||document,it=nt.getElementById(rt),!_e.exists(it))throw new Error(`
JSXGraph: HTML container element '`+rt+"' not found.");return(st=it.style.display)!=="none"&&st!==null?it.clientWidth>0&&it.clientHeight>0?{width:it.clientWidth,height:it.clientHeight}:(dt=window.getComputedStyle?window.getComputedStyle(it):it.style,{width:ft.test(dt.width)?parseFloat(dt.width):0,height:ft.test(dt.height)?parseFloat(dt.height):0}):(ot=it.style,lt=ot.visibility,at=ot.position,ct=ot.display,ot.visibility="hidden",ot.position="absolute",ot.display="block",ut=it.clientWidth,ht=it.clientHeight,ot.display=ct,ot.position=at,ot.visibility=lt,{width:ut,height:ht})},addEvent:function(rt,nt,it,st){var ot=function(){return it.apply(st,arguments)};ot.origin=it,st["x_internal"+nt]=st["x_internal"+nt]||[],st["x_internal"+nt].push(ot),_e.exists(rt)&&_e.exists(rt.addEventListener)&&rt.addEventListener(nt,ot,!1),_e.exists(rt)&&_e.exists(rt.attachEvent)&&rt.attachEvent("on"+nt,ot)},removeEvent:function(rt,nt,it,st){var ot;if(!_e.exists(st))return void tt.debug("no such owner");if(!_e.exists(st["x_internal"+nt]))return void tt.debug("no such type: "+nt);if(!_e.isArray(st["x_internal"+nt]))return void tt.debug("owner[x_internal + "+nt+"] is not an array");if((ot=_e.indexOf(st["x_internal"+nt],it,"origin"))===-1)return void tt.debug("no such event function in internal list: "+it);try{_e.exists(rt)&&_e.exists(rt.removeEventListener)&&rt.removeEventListener(nt,st["x_internal"+nt][ot],!1),_e.exists(rt)&&_e.exists(rt.detachEvent)&&rt.detachEvent("on"+nt,st["x_internal"+nt][ot])}catch{tt.debug("event not registered in browser: ("+nt+" -- "+it+")")}st["x_internal"+nt].splice(ot,1)},removeAllEvents:function(rt,nt,it){var st,ot;if(it["x_internal"+nt]){for(ot=it["x_internal"+nt].length,st=ot-1;st>=0;st--)tt.removeEvent(rt,nt,it["x_internal"+nt][st].origin,it);it["x_internal"+nt].length>0&&tt.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(rt,nt,it){var st,ot,lt,at=0,ct=0;if(rt||(rt=window.event),lt=rt[tt.touchProperty],_e.exists(lt)&&lt.length===0&&(lt=rt.changedTouches),_e.exists(nt)&&_e.exists(lt))if(nt===-1){for(ot=lt.length,st=0;st<ot;st++)if(lt[st]){rt=lt[st];break}}else rt=lt[nt];return rt.clientX&&(at=rt.clientX,ct=rt.clientY),[at,ct]},getOffset:function(rt){var nt,it=rt,st=rt,ot=it.offsetLeft-it.scrollLeft,lt=it.offsetTop-it.scrollTop;for(nt=this.getCSSTransform([ot,lt],it),ot=nt[0],lt=nt[1],it=it.offsetParent;it;){for(ot+=it.offsetLeft,lt+=it.offsetTop,it.offsetParent&&(ot+=it.clientLeft-it.scrollLeft,lt+=it.clientTop-it.scrollTop),nt=this.getCSSTransform([ot,lt],it),ot=nt[0],lt=nt[1],st=st.parentNode;st!==it;)ot+=st.clientLeft-st.scrollLeft,lt+=st.clientTop-st.scrollTop,nt=this.getCSSTransform([ot,lt],st),ot=nt[0],lt=nt[1],st=st.parentNode;it=it.offsetParent}return[ot,lt]},getStyle:function(rt,nt){var it,st=rt.ownerDocument;return st.defaultView&&st.defaultView.getComputedStyle?it=st.defaultView.getComputedStyle(rt,null).getPropertyValue(nt):rt.currentStyle&&tt.ieVersion>=9?it=rt.currentStyle[nt]:rt.style&&(nt=nt.replace(/-([a-z]|[0-9])/gi,function(ot,lt){return lt.toUpperCase()}),it=rt.style[nt]),it},getProp:function(rt,nt){var it=parseInt(this.getStyle(rt,nt),10);return isNaN(it)?0:it},getCSSTransform:function(rt,nt){var it,st,ot,lt,at,ct,ut,ht,dt=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(ct=dt.length,it=0,ot="";it<ct;it++)if(_e.exists(nt.style[dt[it]])){ot=nt.style[dt[it]];break}if(ot!==""&&(at=ot.indexOf("("))>0){for(ct=ot.length,lt=ot.substring(at+1,ct-1),ht=lt.split(","),st=0,ut=ht.length;st<ut;st++)ht[st]=parseFloat(ht[st]);ot.indexOf("matrix")===0?(rt[0]+=ht[4],rt[1]+=ht[5]):ot.indexOf("translateX")===0?rt[0]+=ht[0]:ot.indexOf("translateY")===0?rt[1]+=ht[0]:ot.indexOf("translate")===0&&(rt[0]+=ht[0],rt[1]+=ht[1])}return _e.exists(nt.style.zoom)&&(ot=nt.style.zoom)!==""&&(rt[0]*=parseFloat(ot),rt[1]*=parseFloat(ot)),rt},getCSSTransformMatrix:function(rt){var nt,it,st,ot,lt,at,ct,ut,ht,dt=rt.ownerDocument,ft=["transform","webkitTransform","MozTransform","msTransform","oTransform"],pt=[[1,0,0],[0,1,0],[0,0,1]];if(dt.defaultView&&dt.defaultView.getComputedStyle)ht=dt.defaultView.getComputedStyle(rt,null),st=ht.getPropertyValue("-webkit-transform")||ht.getPropertyValue("-moz-transform")||ht.getPropertyValue("-ms-transform")||ht.getPropertyValue("-o-transform")||ht.getPropertyValue("transform");else for(at=ft.length,nt=0,st="";nt<at;nt++)if(_e.exists(rt.style[ft[nt]])){st=rt.style[ft[nt]];break}if(st!==""&&(lt=st.indexOf("("))>0){for(at=st.length,ot=st.substring(lt+1,at-1),ut=ot.split(","),it=0,ct=ut.length;it<ct;it++)ut[it]=parseFloat(ut[it]);st.indexOf("matrix")===0?pt=[[1,0,0],[0,ut[0],ut[1]],[0,ut[2],ut[3]]]:st.indexOf("scaleX")===0?pt[1][1]=ut[0]:st.indexOf("scaleY")===0?pt[2][2]=ut[0]:st.indexOf("scale")===0&&(pt[1][1]=ut[0],pt[2][2]=ut[1])}return _e.exists(rt.style.zoom)&&(st=rt.style.zoom)!==""&&(pt[1][1]*=parseFloat(st),pt[2][2]*=parseFloat(st)),pt},timedChunk:function(rt,nt,it,st){var ot=rt.concat(),lt=function(){var at=+new Date;do nt.call(it,ot.shift());while(ot.length>0&&+new Date-at<300);ot.length>0?window.setTimeout(lt,1):st(rt)};window.setTimeout(lt,1)}}),tt}),define("utils/xml",["jxg","utils/type"],function(tt,_e){return tt.XML={cleanWhitespace:function(rt){for(var nt=rt.firstChild;_e.exists(nt);)nt.nodeType!==3||/\S/.test(nt.nodeValue)?nt.nodeType===1&&this.cleanWhitespace(nt):rt.removeChild(nt),nt=nt.nextSibling},parse:function(rt){var nt,it,st;return st=typeof DOMParser=="function"||typeof DOMParser=="object"?DOMParser:function(){this.parseFromString=function(ot){var lt;return typeof ActiveXObject=="function"&&(lt=new ActiveXObject("MSXML.DomDocument"),lt.loadXML(ot)),lt}},nt=new st,it=nt.parseFromString(rt,"text/xml"),this.cleanWhitespace(it),it}},tt.XML}),define("utils/event",["jxg","utils/type"],function(tt,_e){return tt.EventEmitter={eventHandlers:{},suspended:{},trigger:function(rt,nt){var it,st,ot,lt,at,ct;for(at=rt.length,st=0;st<at;st++)if(lt=this.eventHandlers[rt[st]],!this.suspended[rt[st]]){if(this.suspended[rt[st]]=!0,lt)for(ct=lt.length,it=0;it<ct;it++)ot=lt[it],ot.handler.apply(ot.context,nt);this.suspended[rt[st]]=!1}return this},on:function(rt,nt,it){return _e.isArray(this.eventHandlers[rt])||(this.eventHandlers[rt]=[]),it=_e.def(it,this),this.eventHandlers[rt].push({handler:nt,context:it}),this},off:function(rt,nt){var it;return rt&&_e.isArray(this.eventHandlers[rt])?(nt?(it=_e.indexOf(this.eventHandlers[rt],nt,"handler"),it>-1&&this.eventHandlers[rt].splice(it,1),this.eventHandlers[rt].length===0&&delete this.eventHandlers[rt]):delete this.eventHandlers[rt],this):this},eventify:function(rt){rt.eventHandlers={},rt.on=this.on,rt.off=this.off,rt.triggerEventHandlers=this.trigger,rt.trigger=this.trigger,rt.suspended={}}},tt.EventEmitter}),define("math/math",["jxg","utils/type"],function(tt,_e){var rt=function(nt){var it,st;return nt.memo||(it={},st=Array.prototype.join,nt.memo=function(){var ot=st.call(arguments);return it[ot]!==void 0?it[ot]:it[ot]=nt.apply(this,arguments)}),nt.memo};return tt.Math={eps:1e-6,relDif:function(nt,it){var st=Math.abs(nt),ot=Math.abs(it);return ot=Math.max(st,ot),ot===0?0:Math.abs(nt-it)/ot},mod:function(nt,it){return nt-Math.floor(nt/it)*it},vector:function(nt,it){var st,ot;for(it=it||0,st=[],ot=0;ot<nt;ot++)st[ot]=it;return st},matrix:function(nt,it,st){var ot,lt,at;for(st=st||0,it=it||nt,ot=[],lt=0;lt<nt;lt++)for(ot[lt]=[],at=0;at<it;at++)ot[lt][at]=st;return ot},identity:function(nt,it){var st,ot;for(it===void 0&&typeof it!="number"&&(it=nt),st=this.matrix(nt,it),ot=0;ot<Math.min(nt,it);ot++)st[ot][ot]=1;return st},frustum:function(nt,it,st,ot,lt,at){var ct=this.matrix(4,4);return ct[0][0]=2*lt/(it-nt),ct[0][1]=0,ct[0][2]=(it+nt)/(it-nt),ct[0][3]=0,ct[1][0]=0,ct[1][1]=2*lt/(ot-st),ct[1][2]=(ot+st)/(ot-st),ct[1][3]=0,ct[2][0]=0,ct[2][1]=0,ct[2][2]=-(at+lt)/(at-lt),ct[2][3]=-at*lt*2/(at-lt),ct[3][0]=0,ct[3][1]=0,ct[3][2]=-1,ct[3][3]=0,ct},projection:function(nt,it,st,ot){var lt=st*Math.tan(nt/2),at=lt*it;return this.frustum(-at,at,-lt,lt,st,ot)},matVecMult:function(nt,it){var st,ot,lt,at=nt.length,ct=it.length,ut=[];if(ct===3)for(st=0;st<at;st++)ut[st]=nt[st][0]*it[0]+nt[st][1]*it[1]+nt[st][2]*it[2];else for(st=0;st<at;st++){for(ot=0,lt=0;lt<ct;lt++)ot+=nt[st][lt]*it[lt];ut[st]=ot}return ut},matMatMult:function(nt,it){var st,ot,lt,at,ct=nt.length,ut=ct>0?it[0].length:0,ht=it.length,dt=this.matrix(ct,ut);for(st=0;st<ct;st++)for(ot=0;ot<ut;ot++){for(lt=0,at=0;at<ht;at++)lt+=nt[st][at]*it[at][ot];dt[st][ot]=lt}return dt},transpose:function(nt){var it,st,ot,lt,at;for(lt=nt.length,at=nt.length>0?nt[0].length:0,it=this.matrix(at,lt),st=0;st<at;st++)for(ot=0;ot<lt;ot++)it[st][ot]=nt[ot][st];return it},inverse:function(nt){var it,st,ot,lt,at,ct,ut,ht=nt.length,dt=[],ft=[],pt=[];for(it=0;it<ht;it++){for(dt[it]=[],st=0;st<ht;st++)dt[it][st]=nt[it][st];ft[it]=it}for(st=0;st<ht;st++){for(at=Math.abs(dt[st][st]),ct=st,it=st+1;it<ht;it++)Math.abs(dt[it][st])>at&&(at=Math.abs(dt[it][st]),ct=it);if(at<=this.eps)return[];if(ct>st){for(ot=0;ot<ht;ot++)ut=dt[st][ot],dt[st][ot]=dt[ct][ot],dt[ct][ot]=ut;ut=ft[st],ft[st]=ft[ct],ft[ct]=ut}for(lt=1/dt[st][st],it=0;it<ht;it++)dt[it][st]*=lt;for(dt[st][st]=lt,ot=0;ot<ht;ot++)if(ot!==st){for(it=0;it<ht;it++)it!==st&&(dt[it][ot]-=dt[it][st]*dt[st][ot]);dt[st][ot]=-lt*dt[st][ot]}}for(it=0;it<ht;it++){for(ot=0;ot<ht;ot++)pt[ft[ot]]=dt[it][ot];for(ot=0;ot<ht;ot++)dt[it][ot]=pt[ot]}return dt},innerProduct:function(nt,it,st){var ot,lt=0;for(st!==void 0&&_e.isNumber(st)||(st=nt.length),ot=0;ot<st;ot++)lt+=nt[ot]*it[ot];return lt},crossProduct:function(nt,it){return[nt[1]*it[2]-nt[2]*it[1],nt[2]*it[0]-nt[0]*it[2],nt[0]*it[1]-nt[1]*it[0]]},factorial:rt(function(nt){return nt<0?NaN:(nt=Math.floor(nt),nt===0||nt===1?1:nt*this.factorial(nt-1))}),binomial:rt(function(nt,it){var st,ot;if(it>nt||it<0)return NaN;if(it=Math.round(it),nt=Math.round(nt),it===0||it===nt)return 1;for(st=1,ot=0;ot<it;ot++)st*=nt-ot,st/=ot+1;return st}),cosh:function(nt){return .5*(Math.exp(nt)+Math.exp(-nt))},sinh:function(nt){return .5*(Math.exp(nt)-Math.exp(-nt))},pow:function(nt,it){return nt===0?it===0?1:0:Math.floor(it)===it?Math.pow(nt,it):nt>0?Math.exp(it*Math.log(Math.abs(nt))):NaN},log10:function(nt){return Math.log(nt)/Math.log(10)},log2:function(nt){return Math.log(nt)/Math.log(2)},log:function(nt,it){return it!==void 0&&_e.isNumber(it)?Math.log(nt)/Math.log(it):Math.log(nt)},sign:Math.sign||function(nt){return nt=+nt,nt===0||isNaN(nt)?nt:nt>0?1:-1},squampow:function(nt,it){var st;if(Math.floor(it)===it){for(st=1,it<0&&(nt=1/nt,it*=-1);it!==0;)1&it&&(st*=nt),it>>=1,nt*=nt;return st}return this.pow(nt,it)},gcd:function(nt,it){if(nt=Math.abs(nt),it=Math.abs(it),!_e.isNumber(nt)||!_e.isNumber(it))return NaN;if(it>nt){var st=nt;nt=it,it=st}for(;;){if((nt%=it)===0)return it;if((it%=nt)===0)return nt}},lcm:function(nt,it){var st;return _e.isNumber(nt)&&_e.isNumber(it)?(st=nt*it,st!==0?st/this.gcd(nt,it):0):NaN},normalize:function(nt){var it,st,ot=2*nt[3],lt=nt[4]/ot;return nt[5]=lt,nt[6]=-nt[1]/ot,nt[7]=-nt[2]/ot,isFinite(lt)?Math.abs(lt)>=1?(nt[0]=(nt[6]*nt[6]+nt[7]*nt[7]-lt*lt)/(2*lt),nt[1]=-nt[6]/lt,nt[2]=-nt[7]/lt,nt[3]=1/(2*lt),nt[4]=1):(st=lt<=0?-1:1,nt[0]=st*(nt[6]*nt[6]+nt[7]*nt[7]-lt*lt)*.5,nt[1]=-st*nt[6],nt[2]=-st*nt[7],nt[3]=st/2,nt[4]=st*lt):(it=Math.sqrt(nt[1]*nt[1]+nt[2]*nt[2]),nt[0]/=it,nt[1]/=it,nt[2]/=it,nt[3]=0,nt[4]=1),nt},toGL:function(nt){var it,st,ot;if(it=typeof Float32Array=="function"?new Float32Array(16):new Array(16),nt.length!==4&&nt[0].length!==4)return it;for(st=0;st<4;st++)for(ot=0;ot<4;ot++)it[st+4*ot]=nt[st][ot];return it}},tt.Math}),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],function(tt,_e,rt,nt,it){return tt.Coords=function(st,ot,lt,at){this.board=lt,this.usrCoords=[],this.scrCoords=[],this.emitter=!nt.exists(at)||at,this.emitter&&rt.eventify(this),this.setCoordinates(st,ot,!0,!0)},tt.extend(tt.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>it.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(st){var ot=Math.round,lt=this.board,at=this.usrCoords,ct=lt.origin.scrCoords;st===!0?(this.scrCoords[0]=ot(at[0]),this.scrCoords[1]=ot(at[0]*ct[1]+at[1]*lt.unitX),this.scrCoords[2]=ot(at[0]*ct[2]-at[2]*lt.unitY)):(this.scrCoords[0]=at[0],this.scrCoords[1]=at[0]*ct[1]+at[1]*lt.unitX,this.scrCoords[2]=at[0]*ct[2]-at[2]*lt.unitY)},screen2usr:function(){var st=this.board.origin.scrCoords,ot=this.scrCoords,lt=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(ot[1]-st[1])/lt.unitX,this.usrCoords[2]=(st[2]-ot[2])/lt.unitY},distance:function(st,ot){var lt,at,ct=0,ut=this.usrCoords,ht=this.scrCoords;if(st===_e.COORDS_BY_USER){if(lt=ot.usrCoords,at=ut[0]-lt[0],(ct=at*at)>it.eps*it.eps)return Number.POSITIVE_INFINITY;at=ut[1]-lt[1],ct+=at*at,at=ut[2]-lt[2],ct+=at*at}else lt=ot.scrCoords,at=ht[1]-lt[1],ct+=at*at,at=ht[2]-lt[2],ct+=at*at;return Math.sqrt(ct)},setCoordinates:function(st,ot,lt,at){var ct=this.usrCoords,ut=this.scrCoords,ht=[ct[0],ct[1],ct[2]],dt=[ut[0],ut[1],ut[2]];return st===_e.COORDS_BY_USER?(ot.length===2?(ct[0]=1,ct[1]=ot[0],ct[2]=ot[1]):(ct[0]=ot[0],ct[1]=ot[1],ct[2]=ot[2],this.normalizeUsrCoords()),this.usr2screen(lt)):(ot.length===2?(ut[1]=ot[0],ut[2]=ot[1]):(ut[1]=ot[1],ut[2]=ot[2]),this.screen2usr()),!this.emitter||at||dt[1]===ut[1]&&dt[2]===ut[2]||this.triggerEventHandlers(["update"],[ht,dt]),this},copy:function(st,ot){return ot===void 0&&(ot=0),this[st].slice(ot)},__evt__update:function(st,ot){},__evt:function(){}}),tt.Coords}),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],function(tt,_e,rt,nt){var it={each:function(st,ot,lt){var at,ct,ut=[];if(_e.exists(st.length))for(ct=st.length,at=0;at<ct;at++)ut.push(ot.call(this,st[at],lt));return ut},coords:function(st,ot){var lt=st;return st&&st.elementClass===rt.OBJECT_CLASS_POINT?lt=st.coords:st.usrCoords&&st.scrCoords&&st.usr2screen&&(lt=st),ot&&(lt=new nt(rt.COORDS_BY_USER,lt.usrCoords,lt.board)),lt},coordsArray:function(st,ot){var lt;return lt=_e.isArray(st)?st:this.coords(st).usrCoords,lt.length<3&&lt.unshift(1),ot&&(lt=[lt[0],lt[1],lt[2]]),lt}};return tt.Expect=it,it}),define("math/qdt",["math/math","utils/type"],function(tt,_e){var rt=function(nt){this.capacity=10,this.points=[],this.xlb=nt[0],this.xub=nt[2],this.ylb=nt[3],this.yub=nt[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null};return _e.extend(rt.prototype,{contains:function(nt,it){return this.xlb<nt&&nt<=this.xub&&this.ylb<it&&it<=this.yub},insert:function(nt){return!!this.contains(nt.usrCoords[1],nt.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(nt),!0):(this.northWest===null&&this.subdivide(),!!this.northWest.insert(nt)||!!this.northEast.insert(nt)||!!this.southEast.insert(nt)||!!this.southWest.insert(nt)))},subdivide:function(){var nt,it=this.points.length,st=this.xlb+(this.xub-this.xlb)/2,ot=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new rt([this.xlb,this.yub,st,ot]),this.northEast=new rt([st,this.yub,this.xub,ot]),this.southEast=new rt([this.xlb,ot,st,this.ylb]),this.southWest=new rt([st,ot,this.xub,this.ylb]),nt=0;nt<it;nt+=1)this.northWest.insert(this.points[nt]),this.northEast.insert(this.points[nt]),this.southEast.insert(this.points[nt]),this.southWest.insert(this.points[nt])},_query:function(nt,it){var st;if(this.contains(nt,it)){if(this.northWest===null)return this;if((st=this.northWest._query(nt,it))||(st=this.northEast._query(nt,it))||(st=this.southEast._query(nt,it))||(st=this.southWest._query(nt,it)))return st}return!1},query:function(nt,it){var st,ot;return _e.exists(it)?(st=nt,ot=it):(st=nt.usrCoords[1],ot=nt.usrCoords[2]),this._query(st,ot)}}),tt.Quadtree=rt,rt}),define("math/numerics",["jxg","utils/type","math/math"],function(tt,_e,rt){var nt={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[.16666666666666666,.3333333333333333,.3333333333333333,.16666666666666666],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return rt.Numerics={Gauss:function(it,st){var ot,lt,at,ct,ut,ht=rt.eps,dt=it.length>0?it[0].length:0;if(dt!==st.length||dt!==it.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(ct=[],ut=st.slice(0,dt),ot=0;ot<dt;ot++)ct[ot]=it[ot].slice(0,dt);for(lt=0;lt<dt;lt++){for(ot=dt-1;ot>lt;ot--)if(Math.abs(ct[ot][lt])>ht)if(Math.abs(ct[lt][lt])<ht)_e.swap(ct,ot,lt),_e.swap(ut,ot,lt);else for(ct[ot][lt]/=ct[lt][lt],ut[ot]-=ct[ot][lt]*ut[lt],at=lt+1;at<dt;at++)ct[ot][at]-=ct[ot][lt]*ct[lt][at];if(Math.abs(ct[lt][lt])<ht)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(ct,ut,!0),ut},backwardSolve:function(it,st,ot){var lt,at,ct,ut,ht;for(lt=ot?st:st.slice(0,st.length),at=it.length,ct=it.length>0?it[0].length:0,ut=at-1;ut>=0;ut--){for(ht=ct-1;ht>ut;ht--)lt[ut]-=it[ut][ht]*lt[ht];lt[ut]/=it[ut][ut]}return lt},gaussBareiss:function(it){var st,ot,lt,at,ct,ut,ht,dt,ft,pt=rt.eps;if((ht=it.length)<=0)return 0;for(it[0].length<ht&&(ht=it[0].length),dt=[],at=0;at<ht;at++)dt[at]=it[at].slice(0,ht);for(ot=1,lt=1,st=0;st<ht-1;st++){if(ut=dt[st][st],Math.abs(ut)<pt){for(at=st+1;at<ht&&!(Math.abs(dt[at][st])>=pt);at++);if(at===ht)return 0;for(ct=st;ct<ht;ct++)ft=dt[at][ct],dt[at][ct]=dt[st][ct],dt[st][ct]=ft;lt=-lt,ut=dt[st][st]}for(at=st+1;at<ht;at++)for(ct=st+1;ct<ht;ct++)ft=ut*dt[at][ct]-dt[at][st]*dt[st][ct],dt[at][ct]=ft/ot;ot=ut}return lt*dt[ht-1][ht-1]},det:function(it){return it.length===2&&it[0].length===2?it[0][0]*it[1][1]-it[1][0]*it[0][1]:this.gaussBareiss(it)},Jacobi:function(it){var st,ot,lt,at,ct,ut,ht,dt,ft=rt.eps,pt=0,mt=it.length,gt=[[0,0,0],[0,0,0],[0,0,0]],vt=[[0,0,0],[0,0,0],[0,0,0]],At=0;for(st=0;st<mt;st++){for(ot=0;ot<mt;ot++)gt[st][ot]=0,vt[st][ot]=it[st][ot],pt+=Math.abs(vt[st][ot]);gt[st][st]=1}if(mt===1)return[vt,gt];if(pt<=0)return[vt,gt];pt/=mt*mt;do{for(dt=0,ot=1;ot<mt;ot++)for(st=0;st<ot;st++)if(at=Math.abs(vt[st][ot]),dt+=at,at>=ft){for(at=.5*Math.atan2(2*vt[st][ot],vt[st][st]-vt[ot][ot]),ct=Math.sin(at),ut=Math.cos(at),lt=0;lt<mt;lt++)ht=vt[lt][st],vt[lt][st]=ut*ht+ct*vt[lt][ot],vt[lt][ot]=-ct*ht+ut*vt[lt][ot],ht=gt[lt][st],gt[lt][st]=ut*ht+ct*gt[lt][ot],gt[lt][ot]=-ct*ht+ut*gt[lt][ot];for(vt[st][st]=ut*vt[st][st]+ct*vt[ot][st],vt[ot][ot]=-ct*vt[st][ot]+ut*vt[ot][ot],vt[st][ot]=0,lt=0;lt<mt;lt++)vt[st][lt]=vt[lt][st],vt[ot][lt]=vt[lt][ot]}At+=1}while(Math.abs(dt)/pt>ft&&At<2e3);return[vt,gt]},NewtonCotes:function(it,st,ot){var lt,at,ct,ut=0,ht=ot&&_e.isNumber(ot.number_of_nodes)?ot.number_of_nodes:28,dt={trapez:!0,simpson:!0,milne:!0},ft=ot&&ot.integration_type&&dt.hasOwnProperty(ot.integration_type)&&dt[ot.integration_type]?ot.integration_type:"milne",pt=(it[1]-it[0])/ht;switch(ft){case"trapez":for(ut=.5*(st(it[0])+st(it[1])),lt=it[0],at=0;at<ht-1;at++)lt+=pt,ut+=st(lt);ut*=pt;break;case"simpson":if(ht%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(ct=ht/2,ut=st(it[0])+st(it[1]),lt=it[0],at=0;at<ct-1;at++)lt+=2*pt,ut+=2*st(lt);for(lt=it[0]-pt,at=0;at<ct;at++)lt+=2*pt,ut+=4*st(lt);ut*=pt/3;break;default:if(ht%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(ct=.25*ht,ut=7*(st(it[0])+st(it[1])),lt=it[0],at=0;at<ct-1;at++)lt+=4*pt,ut+=14*st(lt);for(lt=it[0]-3*pt,at=0;at<ct;at++)lt+=4*pt,ut+=32*(st(lt)+st(lt+2*pt));for(lt=it[0]-2*pt,at=0;at<ct;at++)lt+=4*pt,ut+=12*st(lt);ut*=2*pt/45}return ut},Romberg:function(it,st,ot){var lt,at,ct,ut,ht,dt,ft,pt,mt=[],gt=0,vt=1/0,At=ot&&_e.isNumber(ot.max_iterations)?ot.max_iterations:20,yt=ot&&_e.isNumber(ot.eps)?ot.eps:ot.eps||1e-7;for(lt=it[0],at=it[1],ct=at-lt,ht=1,mt[0]=.5*ct*(st(lt)+st(at)),dt=0;dt<At;++dt){for(ut=0,ct*=.5,ht*=2,pt=1,ft=1;ft<ht;ft+=2)ut+=st(lt+ft*ct);for(mt[dt+1]=.5*mt[dt]+ut*ct,gt=mt[dt+1],ft=dt-1;ft>=0;--ft)pt*=4,mt[ft]=mt[ft+1]+(mt[ft+1]-mt[ft])/(pt-1),gt=mt[ft];if(Math.abs(gt-vt)<yt*Math.abs(gt))break;vt=gt}return gt},GaussLegendre:function(it,st,ot){var lt,at,ct,ut,ht,dt,ft,pt,mt=0,gt=[],vt=[],At=ot&&_e.isNumber(ot.n)?ot.n:12;if(At>18&&(At=18),gt[2]=[.5773502691896257],vt[2]=[1],gt[4]=[.33998104358485626,.8611363115940526],vt[4]=[.6521451548625461,.34785484513745385],gt[6]=[.2386191860831969,.6612093864662645,.932469514203152],vt[6]=[.46791393457269104,.3607615730481386,.17132449237917036],gt[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],vt[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],gt[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],vt[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],gt[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],vt[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],gt[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],vt[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],gt[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],vt[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],gt[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],vt[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],gt[3]=[0,.7745966692414834],vt[3]=[.8888888888888888,.5555555555555556],gt[5]=[0,.5384693101056831,.906179845938664],vt[5]=[.5688888888888889,.47862867049936647,.23692688505618908],gt[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],vt[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],gt[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],vt[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],gt[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],vt[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],gt[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],vt[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],gt[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],vt[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],gt[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],vt[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],lt=it[0],at=it[1],ut=At+1>>1,ft=gt[At],pt=vt[At],dt=.5*(at-lt),ht=.5*(at+lt),!0&At)for(mt=pt[0]*st(ht),ct=1;ct<ut;++ct)mt+=pt[ct]*(st(ht+dt*ft[ct])+st(ht-dt*ft[ct]));else for(mt=0,ct=0;ct<ut;++ct)mt+=pt[ct]*(st(ht+dt*ft[ct])+st(ht-dt*ft[ct]));return dt*mt},_rescale_error:function(it,st,ot){var lt,at;return it=Math.abs(it),ot!==0&&it!==0&&(lt=Math.pow(200*it/ot,1.5),it=lt<1?ot*lt:ot),st>20041683600089728e-310&&(at=11102230246251565e-30*st)>it&&(it=at),it},_gaussKronrod:function(it,st,ot,lt,at,ct,ut){var ht,dt,ft,pt,mt,gt,vt,At,yt,xt=it[0],_t=it[1],Et=.5*(xt+_t),bt=.5*(_t-xt),wt=Math.abs(bt),Tt=st(Et),Mt=0,Pt=Tt*ct[ot-1],It=Math.abs(Pt),Ot=0,Bt=0,Ut=0,Ft=[],jt=[];for(ot%2==0&&(Mt=Tt*at[ot/2-1]),ht=Math.floor((ot-1)/2),ft=0;ft<ht;ft++)pt=2*ft+1,mt=bt*lt[pt],gt=st(Et-mt),vt=st(Et+mt),At=gt+vt,Ft[pt]=gt,jt[pt]=vt,Mt+=at[ft]*At,Pt+=ct[pt]*At,It+=ct[pt]*(Math.abs(gt)+Math.abs(vt));for(ht=Math.floor(ot/2),ft=0;ft<ht;ft++)yt=2*ft,mt=bt*lt[yt],gt=st(Et-mt),vt=st(Et+mt),Ft[yt]=gt,jt[yt]=vt,Pt+=ct[yt]*(gt+vt),It+=ct[yt]*(Math.abs(gt)+Math.abs(vt));for(Bt=.5*Pt,Ot=ct[ot-1]*Math.abs(Tt-Bt),ft=0;ft<ot-1;ft++)Ot+=ct[ft]*(Math.abs(Ft[ft]-Bt)+Math.abs(jt[ft]-Bt));return Ut=(Pt-Mt)*bt,Pt*=bt,It*=wt,Ot*=wt,dt=Pt,ut.abserr=this._rescale_error(Ut,It,Ot),ut.resabs=It,ut.resasc=Ot,dt},GaussKronrod15:function(it,st,ot){var lt=[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],at=[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],ct=[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782];return this._gaussKronrod(it,st,8,lt,at,ct,ot)},GaussKronrod21:function(it,st,ot){var lt=[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],at=[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],ct=[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169];return this._gaussKronrod(it,st,11,lt,at,ct,ot)},GaussKronrod31:function(it,st,ot){var lt=[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],at=[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],ct=[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154];return this._gaussKronrod(it,st,16,lt,at,ct,ot)},_workspace:function(it,st){return{limit:st,size:0,nrmax:0,i:0,alist:[it[0]],blist:[it[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var ot,lt,at,ct,ut,ht=this.size-1,dt=this.limit,ft=this.nrmax,pt=this.order[ft];if(ht<2)return this.order[0]=0,this.order[1]=1,void(this.i=pt);for(ot=this.elist[pt];ft>0&&ot>this.elist[this.order[ft-1]];)this.order[ft]=this.order[ft-1],ft--;for(ut=ht<dt/2+2?ht:dt-ht+1,at=ft+1;at<ut&&ot<this.elist[this.order[at]];)this.order[at-1]=this.order[at],at++;for(this.order[at-1]=pt,lt=this.elist[ht],ct=ut-1;ct>at-2&&lt>=this.elist[this.order[ct]];)this.order[ct+1]=this.order[ct],ct--;this.order[ct+1]=ht,pt=this.order[ft],this.i=pt,this.nrmax=ft},set_initial_result:function(ot,lt){this.size=1,this.rlist[0]=ot,this.elist[0]=lt},update:function(ot,lt,at,ct,ut,ht,dt,ft){var pt=this.i,mt=this.size,gt=this.level[this.i]+1;ft>ct?(this.alist[pt]=ut,this.rlist[pt]=dt,this.elist[pt]=ft,this.level[pt]=gt,this.alist[mt]=ot,this.blist[mt]=lt,this.rlist[mt]=at,this.elist[mt]=ct,this.level[mt]=gt):(this.blist[pt]=lt,this.rlist[pt]=at,this.elist[pt]=ct,this.level[pt]=gt,this.alist[mt]=ut,this.blist[mt]=ht,this.rlist[mt]=dt,this.elist[mt]=ft,this.level[mt]=gt),this.size++,gt>this.maximum_level&&(this.maximum_level=gt),this.qpsrt()},retrieve:function(){var ot=this.i;return{a:this.alist[ot],b:this.blist[ot],r:this.rlist[ot],e:this.elist[ot]}},sum_results:function(){var ot,lt=this.size,at=0;for(ot=0;ot<lt;ot++)at+=this.rlist[ot];return at},subinterval_too_small:function(ot,lt,at){var ct=1.0000000000000222*(Math.abs(lt)+22250738585072014e-321);return Math.abs(ot)<=ct&&Math.abs(at)<=ct}}},Qag:function(it,st,ot){var lt,at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt,Pt,It=this._workspace(it,1e3),Ot=ot&&_e.isNumber(ot.limit)?ot.limit:15,Bt=ot&&_e.isNumber(ot.epsrel)?ot.epsrel:1e-7,Ut=ot&&_e.isNumber(ot.epsabs)?ot.epsabs:1e-7,Ft=ot&&_e.isFunction(ot.q)?ot.q:this.GaussKronrod15,jt={},Dt=0,Gt=0,zt=0,$t=0,Ht=0,er=0,Zt=0,or=0,Kt=0,rr=0;if(Ot>It.limit&&tt.warn("iteration limit exceeds available workspace"),Ut<=0&&(Bt<50*rt.eps||Bt<5e-29)&&tt.warn("tolerance cannot be acheived with given epsabs and epsrel"),ct=Ft.apply(this,[it,st,jt]),ut=jt.abserr,ht=jt.resabs,dt=jt.resasc,It.set_initial_result(ct,ut),pt=Math.max(Ut,Bt*Math.abs(ct)),mt=11102230246251565e-30*ht,ut<=mt&&ut>pt)return ft=ct,tt.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(ut<=pt&&ut!==dt||ut===0)return ft=ct,ft;if(Ot===1)return ft=ct,tt.warn("a maximum of one iteration was insufficient"),-1/0;lt=ct,at=ut,Dt=1;do Ht=0,er=0,Zt=0,or=0,Kt=0,rr=0,Mt=It.retrieve(),xt=Mt.a,_t=Mt.b,Et=Mt.r,bt=Mt.e,gt=xt,vt=.5*(xt+_t),At=vt,yt=_t,Ht=Ft.apply(this,[[gt,vt],st,jt]),or=jt.abserr,wt=jt.resasc,er=Ft.apply(this,[[At,yt],st,jt]),Kt=jt.abserr,Tt=jt.resasc,Zt=Ht+er,rr=or+Kt,at+=rr-bt,lt+=Zt-Et,wt!==or&&Tt!==Kt&&(Pt=Et-Zt,Math.abs(Pt)<=1e-5*Math.abs(Zt)&&rr>=.99*bt&&Gt++,Dt>=10&&rr>bt&&zt++),pt=Math.max(Ut,Bt*Math.abs(lt)),at>pt&&((Gt>=6||zt>=20)&&($t=2),It.subinterval_too_small(gt,At,yt)&&($t=3)),It.update(gt,vt,Ht,or,At,yt,er,Kt),Mt=It.retrieve(),xt=Mt.a_i,_t=Mt.b_i,Et=Mt.r_i,bt=Mt.e_i,Dt++;while(Dt<Ot&&!$t&&at>pt);return ft=It.sum_results(),ft},I:function(it,st){return this.Qag(it,st,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(it,st,ot){var lt,at=0,ct=rt.eps,ut=it.apply(ot,[st]);for(_e.isArray(st)&&(st=st[0]);at<50&&Math.abs(ut)>ct;)lt=this.D(it,ot)(st),Math.abs(lt)>ct?st-=ut/lt:st+=.2*Math.random()-1,ut=it.apply(ot,[st]),at+=1;return st},root:function(it,st,ot){return this.fzero(it,st,ot)},generalizedNewton:function(it,st,ot,lt){var at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et=0;for(this.generalizedNewton.t1memo?(at=this.generalizedNewton.t1memo,ct=this.generalizedNewton.t2memo):(at=ot,ct=lt),mt=it.X(at)-st.X(ct),gt=it.Y(at)-st.Y(ct),vt=mt*mt+gt*gt,At=this.D(it.X,it),yt=this.D(st.X,st),xt=this.D(it.Y,it),_t=this.D(st.Y,st);vt>rt.eps&&Et<10;)ut=At(at),ht=-yt(ct),dt=xt(at),ft=-_t(ct),pt=ut*ft-ht*dt,at-=(ft*mt-ht*gt)/pt,ct-=(ut*gt-dt*mt)/pt,mt=it.X(at)-st.X(ct),gt=it.Y(at)-st.Y(ct),vt=mt*mt+gt*gt,Et+=1;return this.generalizedNewton.t1memo=at,this.generalizedNewton.t2memo=ct,Math.abs(at)<Math.abs(ct)?[it.X(at),it.Y(at)]:[st.X(ct),st.Y(ct)]},Neville:function(it){var st=[],ot=function(lt){return function(at,ct){var ut,ht,dt,ft=rt.binomial,pt=it.length,mt=pt-1,gt=0,vt=0;if(!ct)for(dt=1,ut=0;ut<pt;ut++)st[ut]=ft(mt,ut)*dt,dt*=-1;for(ht=at,ut=0;ut<pt;ut++){if(ht===0)return it[ut][lt]();dt=st[ut]/ht,ht-=1,gt+=it[ut][lt]()*dt,vt+=dt}return gt/vt}};return[ot("X"),ot("Y"),0,function(){return it.length-1}]},splineDef:function(it,st){var ot,lt,at,ct=Math.min(it.length,st.length),ut=[],ht=[],dt=[],ft=[],pt=[],mt=[];if(ct===2)return[0,0];for(lt=0;lt<ct;lt++)ot={X:it[lt],Y:st[lt]},dt.push(ot);for(dt.sort(function(gt,vt){return gt.X-vt.X}),lt=0;lt<ct;lt++)it[lt]=dt[lt].X,st[lt]=dt[lt].Y;for(lt=0;lt<ct-1;lt++)ft.push(it[lt+1]-it[lt]);for(lt=0;lt<ct-2;lt++)pt.push(6*(st[lt+2]-st[lt+1])/ft[lt+1]-6*(st[lt+1]-st[lt])/ft[lt]);for(ut.push(2*(ft[0]+ft[1])),ht.push(pt[0]),lt=0;lt<ct-3;lt++)at=ft[lt+1]/ut[lt],ut.push(2*(ft[lt+1]+ft[lt+2])-at*ft[lt+1]),ht.push(pt[lt+1]-at*ht[lt]);for(mt[ct-3]=ht[ct-3]/ut[ct-3],lt=ct-4;lt>=0;lt--)mt[lt]=(ht[lt]-ft[lt+1]*mt[lt+1])/ut[lt];for(lt=ct-3;lt>=0;lt--)mt[lt+1]=mt[lt];return mt[0]=0,mt[ct-1]=0,mt},splineEval:function(it,st,ot,lt){var at,ct,ut,ht,dt,ft,pt,mt=Math.min(st.length,ot.length),gt=1,vt=!1,At=[];for(_e.isArray(it)?(gt=it.length,vt=!0):it=[it],at=0;at<gt;at++){if(it[at]<st[0]||st[at]>st[mt-1])return NaN;for(ct=1;ct<mt&&!(it[at]<=st[ct]);ct++);ct-=1,ut=ot[ct],ht=(ot[ct+1]-ot[ct])/(st[ct+1]-st[ct])-(st[ct+1]-st[ct])/6*(lt[ct+1]+2*lt[ct]),dt=lt[ct]/2,ft=(lt[ct+1]-lt[ct])/(6*(st[ct+1]-st[ct])),pt=it[at]-st[ct],At.push(ut+(ht+(dt+ft*pt)*pt)*pt)}return vt?At:At[0]},generatePolynomialTerm:function(it,st,ot,lt){var at,ct=[];for(at=st;at>=0;at--)ct=ct.concat(["(",it[at].toPrecision(lt),")"]),at>1?ct=ct.concat(["*",ot,"<sup>",at,"<","/sup> + "]):at===1&&(ct=ct.concat(["*",ot," + "]));return ct.join("")},lagrangePolynomial:function(it){var st=[],ot=function(lt,at){var ct,ut,ht,dt,ft=it.length,pt=0,mt=0;if(!at)for(ct=0;ct<ft;ct++){for(st[ct]=1,ht=it[ct].X(),ut=0;ut<ft;ut++)ut!==ct&&(st[ct]*=ht-it[ut].X());st[ct]=1/st[ct]}for(ct=0;ct<ft;ct++){if(ht=it[ct].X(),lt===ht)return it[ct].Y();dt=st[ct]/(lt-ht),mt+=dt,pt+=dt*it[ct].Y()}return pt/mt};return ot.getTerm=function(){return""},ot},_initCubicPoly:function(it,st,ot,lt){return[it,ot,-3*it+3*st-2*ot-lt,2*it-2*st+ot+lt]},CardinalSpline:function(it,st,ot){var lt,at,ct,ut,ht=[],dt=this;return ut=_e.isFunction(st)?st:function(){return st},ot===void 0&&(ot="uniform"),at=function(ft){return function(pt,mt){var gt,vt,At,yt,xt,_t,Et,bt,wt,Tt;if(it.length<2)return NaN;if(!mt)for(ct=ut(),At={X:function(){return 2*it[0].X()-it[1].X()},Y:function(){return 2*it[0].Y()-it[1].Y()},Dist:function(Mt){var Pt=this.X()-Mt.X(),It=this.Y()-Mt.Y();return Math.sqrt(Pt*Pt+It*It)}},yt={X:function(){return 2*it[it.length-1].X()-it[it.length-2].X()},Y:function(){return 2*it[it.length-1].Y()-it[it.length-2].Y()},Dist:function(Mt){var Pt=this.X()-Mt.X(),It=this.Y()-Mt.Y();return Math.sqrt(Pt*Pt+It*It)}},lt=[At].concat(it,[yt]),Tt=lt.length,ht[ft]=[],gt=0;gt<Tt-3;gt++)ot==="centripetal"?(Et=lt[gt].Dist(lt[gt+1]),bt=lt[gt+2].Dist(lt[gt+1]),wt=lt[gt+3].Dist(lt[gt+2]),Et=Math.sqrt(Et),bt=Math.sqrt(bt),wt=Math.sqrt(wt),bt<rt.eps&&(bt=1),Et<rt.eps&&(Et=bt),wt<rt.eps&&(wt=bt),xt=(lt[gt+1][ft]()-lt[gt][ft]())/Et-(lt[gt+2][ft]()-lt[gt][ft]())/(bt+Et)+(lt[gt+2][ft]()-lt[gt+1][ft]())/bt,_t=(lt[gt+2][ft]()-lt[gt+1][ft]())/bt-(lt[gt+3][ft]()-lt[gt+1][ft]())/(wt+bt)+(lt[gt+3][ft]()-lt[gt+2][ft]())/wt,xt*=bt,_t*=bt,ht[ft][gt]=dt._initCubicPoly(lt[gt+1][ft](),lt[gt+2][ft](),ct*xt,ct*_t)):ht[ft][gt]=dt._initCubicPoly(lt[gt+1][ft](),lt[gt+2][ft](),ct*(lt[gt+2][ft]()-lt[gt][ft]()),ct*(lt[gt+3][ft]()-lt[gt+1][ft]()));return isNaN(pt)?NaN:(Tt=it.length,pt<=0?it[0][ft]():pt>=Tt?it[Tt-1][ft]():(gt=Math.floor(pt))===pt?it[gt][ft]():(pt-=gt,vt=ht[ft][gt],vt===void 0?NaN:((vt[3]*pt+vt[2])*pt+vt[1])*pt+vt[0]))}},[at("X"),at("Y"),0,function(){return it.length-1}]},CatmullRomSpline:function(it,st){return this.CardinalSpline(it,.5,st)},regressionPolynomial:function(it,st,ot){var lt,at,ct,ut,ht,dt,ft="";if(_e.isPoint(it)&&_e.isFunction(it.Value))at=function(){return it.Value()};else if(_e.isFunction(it))at=it;else{if(!_e.isNumber(it))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof it+"'.");at=function(){return it}}if(arguments.length===3&&_e.isArray(st)&&_e.isArray(ot))ht=0;else if(arguments.length===2&&_e.isArray(st)&&st.length>0&&_e.isPoint(st[0]))ht=1;else{if(!(arguments.length===2&&_e.isArray(st)&&st.length>0&&st[0].usrCoords&&st[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");ht=2}return dt=function(pt,mt){var gt,vt,At,yt,xt,_t,Et,bt,wt,Tt=st.length;if(wt=Math.floor(at()),!mt){if(ht===1)for(ct=[],ut=[],gt=0;gt<Tt;gt++)ct[gt]=st[gt].X(),ut[gt]=st[gt].Y();if(ht===2)for(ct=[],ut=[],gt=0;gt<Tt;gt++)ct[gt]=st[gt].usrCoords[1],ut[gt]=st[gt].usrCoords[2];if(ht===0)for(ct=[],ut=[],gt=0;gt<Tt;gt++)_e.isFunction(st[gt])?ct.push(st[gt]()):ct.push(st[gt]),_e.isFunction(ot[gt])?ut.push(ot[gt]()):ut.push(ot[gt]);for(At=[],vt=0;vt<Tt;vt++)At.push([1]);for(gt=1;gt<=wt;gt++)for(vt=0;vt<Tt;vt++)At[vt][gt]=At[vt][gt-1]*ct[vt];xt=ut,yt=rt.transpose(At),_t=rt.matMatMult(yt,At),Et=rt.matVecMult(yt,xt),lt=rt.Numerics.Gauss(_t,Et),ft=rt.Numerics.generatePolynomialTerm(lt,wt,"x",3)}for(bt=lt[wt],gt=wt-1;gt>=0;gt--)bt=bt*pt+lt[gt];return bt},dt.getTerm=function(){return ft},dt},bezier:function(it){var st,ot,lt=function(at){return function(ct,ut){var ht=3*Math.floor(ct),dt=ct%1,ft=1-dt;return ut||(ot=3*Math.floor((it.length-1)/3),st=Math.floor(ot/3)),ct<0?it[0][at]():ct>=st?it[ot][at]():isNaN(ct)?NaN:ft*ft*(ft*it[ht][at]()+3*dt*it[ht+1][at]())+(3*ft*it[ht+2][at]()+dt*it[ht+3][at]())*dt*dt}};return[lt("X"),lt("Y"),0,function(){return Math.floor(it.length/3)}]},bspline:function(it,st){var ot,lt=[],at=function(ht,dt){var ft,pt=[];for(ft=0;ft<ht+dt+1;ft++)pt[ft]=ft<dt?0:ft<=ht?ft-dt+1:ht-dt+2;return pt},ct=function(ht,dt,ft,pt,mt){var gt,vt,At,yt,xt,_t=[];for(dt[mt]<=ht&&ht<dt[mt+1]?_t[mt]=1:_t[mt]=0,gt=2;gt<=pt;gt++)for(vt=mt-gt+1;vt<=mt;vt++)At=vt<=mt-gt+1||vt<0?0:_t[vt],yt=vt>=mt?0:_t[vt+1],xt=dt[vt+gt-1]-dt[vt],_t[vt]=xt===0?0:(ht-dt[vt])/xt*At,(xt=dt[vt+gt]-dt[vt+1])!==0&&(_t[vt]+=(dt[vt+gt]-ht)/xt*yt);return _t},ut=function(ht){return function(dt,ft){var pt,mt,gt,vt=it.length,At=vt-1,yt=st;if(At<=0)return NaN;if(At+2<=yt&&(yt=At+1),dt<=0)return it[0][ht]();if(dt>=At-yt+2)return it[At][ht]();for(gt=Math.floor(dt)+yt-1,ot=at(At,yt),lt=ct(dt,ot,0,yt,gt),pt=0,mt=gt-yt+1;mt<=gt;mt++)mt<vt&&mt>=0&&(pt+=it[mt][ht]()*lt[mt]);return pt}};return[ut("X"),ut("Y"),0,function(){return it.length-1}]},D:function(it,st){return _e.exists(st)?function(ot,lt){var at=1e-5;return(it.apply(st,[ot+at,lt])-it.apply(st,[ot-at,lt]))/2e-5}:function(ot,lt){var at=1e-5;return(it(ot+at,lt)-it(ot-at,lt))/2e-5}},_riemannValue:function(it,st,ot,lt){var at,ct,ut,ht;if(lt<0&&(ot!=="trapezoidal"&&(it+=lt),lt*=-1,ot==="lower"?ot="upper":ot==="upper"&&(ot="lower")),ht=.01*lt,ot==="right")at=st(it+lt);else if(ot==="middle")at=st(it+.5*lt);else if(ot==="left"||ot==="trapezoidal")at=st(it);else if(ot==="lower"){for(at=st(it),ut=it+ht;ut<=it+lt;ut+=ht)(ct=st(ut))<at&&(at=ct);ct=st(it+lt),ct<at&&(at=ct)}else if(ot==="upper"){for(at=st(it),ut=it+ht;ut<=it+lt;ut+=ht)(ct=st(ut))>at&&(at=ct);ct=st(it+lt),ct>at&&(at=ct)}else at=ot==="random"?st(it+lt*Math.random()):ot==="simpson"?(st(it)+4*st(it+.5*lt)+st(it+lt))/6:st(it);return at},riemann:function(it,st,ot,lt,at){var ct,ut,ht,dt,ft,pt,mt,gt=[],vt=[],At=0,yt=lt,xt=0;if(_e.isArray(it)?(ft=it[0],dt=it[1]):dt=it,(st=Math.floor(st))<=0)return[gt,vt,xt];for(ut=(at-lt)/st,ct=0;ct<st;ct++)ht=this._riemannValue(yt,dt,ot,ut),gt[At]=yt,vt[At]=ht,At+=1,yt+=ut,ot==="trapezoidal"&&(ht=dt(yt)),gt[At]=yt,vt[At]=ht,At+=1;for(ct=0;ct<st;ct++)ht=ft?this._riemannValue(yt,ft,ot,-ut):0,gt[At]=yt,vt[At]=ht,At+=1,yt-=ut,ot==="trapezoidal"&&ft&&(ht=ft(yt)),gt[At]=yt,vt[At]=ht,ot!=="trapezoidal"?(pt=ht,mt=vt[2*(st-1)-2*ct]):(mt=.5*(dt(yt+ut)+dt(yt)),pt=ft?.5*(ft(yt+ut)+ft(yt)):0),xt+=(mt-pt)*ut,At+=1,gt[At]=yt,vt[At]=vt[2*(st-1)-2*ct],At+=1;return[gt,vt,xt]},riemannsum:function(it,st,ot,lt,at){return tt.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(it,st,ot,lt,at)[2]},rungeKutta:function(it,st,ot,lt,at){var ct,ut,ht,dt,ft,pt,mt=[],gt=[],vt=(ot[1]-ot[0])/lt,At=ot[0],yt=st.length,xt=[],_t=0;for(_e.isString(it)&&(it=nt[it]||nt.euler),pt=it.s,ct=0;ct<yt;ct++)mt[ct]=st[ct];for(ut=0;ut<lt;ut++){for(xt[_t]=[],ct=0;ct<yt;ct++)xt[_t][ct]=mt[ct];for(_t+=1,dt=[],ht=0;ht<pt;ht++){for(ct=0;ct<yt;ct++)gt[ct]=0;for(ft=0;ft<ht;ft++)for(ct=0;ct<yt;ct++)gt[ct]+=it.A[ht][ft]*vt*dt[ft][ct];for(ct=0;ct<yt;ct++)gt[ct]+=mt[ct];dt.push(at(At+it.c[ht]*vt,gt))}for(ct=0;ct<yt;ct++)gt[ct]=0;for(ft=0;ft<pt;ft++)for(ct=0;ct<yt;ct++)gt[ct]+=it.b[ft]*dt[ft][ct];for(ct=0;ct<yt;ct++)mt[ct]=mt[ct]+vt*gt[ct];At+=vt}return xt},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function(it,st,ot){var lt,at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt,Pt=rt.eps,It=this.maxIterationsRoot,Ot=0;if(_e.isArray(st)){if(st.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");lt=st[0],ut=it.call(ot,lt),at=st[1],ht=it.call(ot,at)}else{for(lt=st,ut=it.call(ot,lt),ft=lt===0?1:lt,pt=[.9*ft,1.1*ft,ft-1,ft+1,.5*ft,1.5*ft,-ft,2*ft,-10*ft,10*ft],gt=pt.length,mt=0;mt<gt&&(at=pt[mt],ht=it.call(ot,at),!(ut*ht<=0));mt++);at<lt&&(vt=lt,lt=at,at=vt,At=ut,ut=ht,ht=At)}if(ut*ht>0)return _e.isArray(st)?this.fminbr(it,[lt,at],ot):this.Newton(it,lt,ot);for(ct=lt,dt=ut;Ot<It;){if(yt=at-lt,Math.abs(dt)<Math.abs(ht)&&(lt=at,at=ct,ct=lt,ut=ht,ht=dt,dt=ut),bt=2*Pt*Math.abs(at)+.5*Pt,Mt=.5*(ct-at),Math.abs(Mt)<=bt&&Math.abs(ht)<=Pt)return at;Math.abs(yt)>=bt&&Math.abs(ut)>Math.abs(ht)&&(_t=ct-at,lt===ct?(xt=ht/ut,wt=_t*xt,Tt=1-xt):(Tt=ut/dt,xt=ht/dt,Et=ht/ut,wt=Et*(_t*Tt*(Tt-xt)-(at-lt)*(xt-1)),Tt=(Tt-1)*(xt-1)*(Et-1)),wt>0?Tt=-Tt:wt=-wt,wt<.75*_t*Tt-.5*Math.abs(bt*Tt)&&wt<Math.abs(yt*Tt*.5)&&(Mt=wt/Tt)),Math.abs(Mt)<bt&&(Mt=Mt>0?bt:-bt),lt=at,ut=ht,at+=Mt,ht=it.call(ot,at),(ht>0&&dt>0||ht<0&&dt<0)&&(ct=lt,dt=ut),Ot++}return at},fminbr:function(it,st,ot){var lt,at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt=.5*(3-Math.sqrt(5)),wt=rt.eps,Tt=rt.eps,Mt=this.maxIterationsMinimize,Pt=0;if(!_e.isArray(st)||st.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(lt=st[0],at=st[1],ut=lt+bt*(at-lt),ft=it.call(ot,ut),ct=ut,ht=ut,dt=ft,pt=ft;Pt<Mt;){if(mt=at-lt,gt=.5*(lt+at),vt=Tt*Math.abs(ct)+wt/3,Math.abs(ct-gt)+.5*mt<=2*vt)return ct;At=bt*(ct<gt?at-ct:lt-ct),Math.abs(ct-ht)>=vt&&(_t=(ct-ht)*(dt-ft),xt=(ct-ut)*(dt-pt),yt=(ct-ut)*xt-(ct-ht)*_t,xt=2*(xt-_t),xt>0?yt=-yt:xt=-xt,Math.abs(yt)<Math.abs(At*xt)&&yt>xt*(lt-ct+2*vt)&&yt<xt*(at-ct-2*vt)&&(At=yt/xt)),Math.abs(At)<vt&&(At=At>0?vt:-vt),_t=ct+At,Et=it.call(ot,_t),Et<=dt?(_t<ct?at=ct:lt=ct,ut=ht,ht=ct,ct=_t,ft=pt,pt=dt,dt=Et):(_t<ct?lt=_t:at=_t,Et<=pt||ht===ct?(ut=ht,ht=_t,ft=pt,pt=Et):(Et<=ft||ut===ct||ut===ht)&&(ut=_t,ft=Et)),Pt+=1}return ct},RamerDouglasPeucker:function(it,st){var ot,lt,at,ct=[],ut=function(dt,ft,pt){var mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt=0,Pt=ft;if(pt-ft<2)return[-1,0];if(vt=dt[ft].scrCoords,At=dt[pt].scrCoords,isNaN(vt[1]+vt[2]))return[NaN,ft];if(isNaN(At[1]+At[2]))return[NaN,pt];for(gt=ft+1;gt<pt;gt++){if(yt=dt[gt].scrCoords,isNaN(yt[1]+yt[2]))return[NaN,gt];xt=yt[1]-vt[1],_t=yt[2]-vt[2],Et=At[1]-vt[1],bt=At[2]-vt[2],wt=Et*Et+bt*bt,wt>=rt.eps?(Tt=(xt*Et+_t*bt)/wt,Tt<0?Tt=0:Tt>1&&(Tt=1),xt-=Tt*Et,_t-=Tt*bt,mt=xt*xt+_t*_t):(Tt=0,mt=xt*xt+_t*_t),mt>Mt&&(Mt=mt,Pt=gt)}return[Math.sqrt(Mt),Pt]},ht=function(dt,ft,pt,mt,gt){var vt=ut(dt,ft,pt),At=vt[1];if(isNaN(vt[0])){ht(dt,ft,At-1,mt,gt),gt.push(dt[At]);do++At;while(At<=pt&&isNaN(dt[At].scrCoords[1]+dt[At].scrCoords[2]));At<=pt&&gt.push(dt[At]),ht(dt,At+1,pt,mt,gt)}else vt[0]>mt?(ht(dt,ft,At,mt,gt),ht(dt,At,pt,mt,gt)):gt.push(dt[pt])};for(at=it.length,ot=0;ot<at&&isNaN(it[ot].scrCoords[1]+it[ot].scrCoords[2]);)ot+=1;for(lt=at-1;lt>ot&&isNaN(it[lt].scrCoords[1]+it[lt].scrCoords[2]);)lt-=1;return ot>lt||ot===at||(ct[0]=it[ot],ht(it,ot,lt,st,ct)),ct},RamerDouglasPeuker:function(it,st){return tt.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(it,st)},Visvalingam:function(it,st){var ot,lt,at,ct,ut,ht,dt,ft,pt,mt=[],gt=[],vt=[];if((lt=it.length)<=2)return it;for(mt[0]={used:!0,lft:null,node:null},ut=0,ot=1;ot<lt-1;ot++)at=Math.abs(tt.Math.Numerics.det([it[ot-1].usrCoords,it[ot].usrCoords,it[ot+1].usrCoords])),isNaN(at)||(pt={v:at,idx:ot},gt.push(pt),mt[ot]={used:!0,lft:ut,node:pt},mt[ut].rt=ot,ut=ot);for(mt[lt-1]={used:!0,rt:null,lft:ut,node:null},mt[ut].rt=lt-1,ct=-1/0;gt.length>st;)gt.sort(function(At,yt){return yt.v-At.v}),ot=gt.pop().idx,mt[ot].used=!1,ct=mt[ot].node.v,ut=mt[ot].lft,ht=mt[ot].rt,mt[ut].rt=ht,mt[ht].lft=ut,dt=mt[ut].lft,dt!==null&&(at=Math.abs(tt.Math.Numerics.det([it[dt].usrCoords,it[ut].usrCoords,it[ht].usrCoords])),mt[ut].node.v=at>=ct?at:ct),(ft=mt[ht].rt)!==null&&(at=Math.abs(tt.Math.Numerics.det([it[ut].usrCoords,it[ht].usrCoords,it[ft].usrCoords])),mt[ht].node.v=at>=ct?at:ct);ot=0,vt=[it[ot]];do ot=mt[ot].rt,vt.push(it[ot]);while(mt[ot].rt!==null);return vt}},rt.Numerics}),define("math/statistics",["jxg","math/math","utils/type"],function(tt,_e,rt){return _e.Statistics={sum:function(nt){var it,st=nt.length,ot=0;for(it=0;it<st;it++)ot+=nt[it];return ot},prod:function(nt){var it,st=nt.length,ot=1;for(it=0;it<st;it++)ot*=nt[it];return ot},mean:function(nt){return nt.length>0?this.sum(nt)/nt.length:0},median:function(nt){var it,st;return nt.length>0?(it=nt.slice(0),it.sort(function(ot,lt){return ot-lt}),st=it.length,st%2==1?it[parseInt(.5*st,10)]:.5*(it[.5*st-1]+it[.5*st])):0},variance:function(nt){var it,st,ot,lt=nt.length;if(lt>1){for(it=this.mean(nt),st=0,ot=0;ot<lt;ot++)st+=(nt[ot]-it)*(nt[ot]-it);return st/(nt.length-1)}return 0},sd:function(nt){return Math.sqrt(this.variance(nt))},weightedMean:function(nt,it){if(nt.length!==it.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return nt.length>0?this.mean(this.multiply(nt,it)):0},max:function(nt){return Math.max.apply(this,nt)},min:function(nt){return Math.min.apply(this,nt)},range:function(nt){return[this.min(nt),this.max(nt)]},abs:function(nt){var it,st,ot;if(rt.isArray(nt))for(st=nt.length,ot=[],it=0;it<st;it++)ot[it]=Math.abs(nt[it]);else ot=Math.abs(nt);return ot},add:function(nt,it){var st,ot,lt=[];if(nt=rt.evalSlider(nt),it=rt.evalSlider(it),rt.isArray(nt)&&rt.isNumber(it))for(ot=nt.length,st=0;st<ot;st++)lt[st]=nt[st]+it;else if(rt.isNumber(nt)&&rt.isArray(it))for(ot=it.length,st=0;st<ot;st++)lt[st]=nt+it[st];else if(rt.isArray(nt)&&rt.isArray(it))for(ot=Math.min(nt.length,it.length),st=0;st<ot;st++)lt[st]=nt[st]+it[st];else lt=nt+it;return lt},div:function(nt,it){var st,ot,lt=[];if(nt=rt.evalSlider(nt),it=rt.evalSlider(it),rt.isArray(nt)&&rt.isNumber(it))for(ot=nt.length,st=0;st<ot;st++)lt[st]=nt[st]/it;else if(rt.isNumber(nt)&&rt.isArray(it))for(ot=it.length,st=0;st<ot;st++)lt[st]=nt/it[st];else if(rt.isArray(nt)&&rt.isArray(it))for(ot=Math.min(nt.length,it.length),st=0;st<ot;st++)lt[st]=nt[st]/it[st];else lt=nt/it;return lt},divide:function(){tt.deprecated("Statistics.divide()","Statistics.div()"),_e.Statistics.div.apply(_e.Statistics,arguments)},mod:function(nt,it,st){var ot,lt,at=[],ct=function(ut,ht){return ut%ht};if(st=rt.def(st,!1),st&&(ct=_e.mod),nt=rt.evalSlider(nt),it=rt.evalSlider(it),rt.isArray(nt)&&rt.isNumber(it))for(lt=nt.length,ot=0;ot<lt;ot++)at[ot]=ct(nt[ot],it);else if(rt.isNumber(nt)&&rt.isArray(it))for(lt=it.length,ot=0;ot<lt;ot++)at[ot]=ct(nt,it[ot]);else if(rt.isArray(nt)&&rt.isArray(it))for(lt=Math.min(nt.length,it.length),ot=0;ot<lt;ot++)at[ot]=ct(nt[ot],it[ot]);else at=ct(nt,it);return at},multiply:function(nt,it){var st,ot,lt=[];if(nt=rt.evalSlider(nt),it=rt.evalSlider(it),rt.isArray(nt)&&rt.isNumber(it))for(ot=nt.length,st=0;st<ot;st++)lt[st]=nt[st]*it;else if(rt.isNumber(nt)&&rt.isArray(it))for(ot=it.length,st=0;st<ot;st++)lt[st]=nt*it[st];else if(rt.isArray(nt)&&rt.isArray(it))for(ot=Math.min(nt.length,it.length),st=0;st<ot;st++)lt[st]=nt[st]*it[st];else lt=nt*it;return lt},subtract:function(nt,it){var st,ot,lt=[];if(nt=rt.evalSlider(nt),it=rt.evalSlider(it),rt.isArray(nt)&&rt.isNumber(it))for(ot=nt.length,st=0;st<ot;st++)lt[st]=nt[st]-it;else if(rt.isNumber(nt)&&rt.isArray(it))for(ot=it.length,st=0;st<ot;st++)lt[st]=nt-it[st];else if(rt.isArray(nt)&&rt.isArray(it))for(ot=Math.min(nt.length,it.length),st=0;st<ot;st++)lt[st]=nt[st]-it[st];else lt=nt-it;return lt},TheilSenRegression:function(nt){var it,st,ot=[],lt=[],at=[];for(it=0;it<nt.length;it++){for(lt.length=0,st=0;st<nt.length;st++)Math.abs(nt[st].usrCoords[1]-nt[it].usrCoords[1])>_e.eps&&(lt[st]=(nt[st].usrCoords[2]-nt[it].usrCoords[2])/(nt[st].usrCoords[1]-nt[it].usrCoords[1]));ot[it]=this.median(lt),at.push(nt[it].usrCoords[2]-ot[it]*nt[it].usrCoords[1])}return[this.median(at),this.median(ot),-1]}},_e.Statistics}),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],function(tt,_e,rt,nt,it,st,ot){return nt.Geometry={},tt.extend(nt.Geometry,{angle:function(lt,at,ct){var ut,ht,dt,ft,pt=[],mt=[],gt=[];return tt.deprecated("Geometry.angle()","Geometry.rad()"),lt.coords?(pt[0]=lt.coords.usrCoords[1],pt[1]=lt.coords.usrCoords[2]):(pt[0]=lt[0],pt[1]=lt[1]),at.coords?(mt[0]=at.coords.usrCoords[1],mt[1]=at.coords.usrCoords[2]):(mt[0]=at[0],mt[1]=at[1]),ct.coords?(gt[0]=ct.coords.usrCoords[1],gt[1]=ct.coords.usrCoords[2]):(gt[0]=ct[0],gt[1]=ct[1]),ut=pt[0]-mt[0],ht=pt[1]-mt[1],dt=gt[0]-mt[0],ft=gt[1]-mt[1],Math.atan2(ut*ft-ht*dt,ut*dt+ht*ft)},trueAngle:function(lt,at,ct){return 57.29577951308232*this.rad(lt,at,ct)},rad:function(lt,at,ct){var ut,ht,dt,ft,pt,mt,gt;return lt.coords?(ut=lt.coords.usrCoords[1],ht=lt.coords.usrCoords[2]):(ut=lt[0],ht=lt[1]),at.coords?(dt=at.coords.usrCoords[1],ft=at.coords.usrCoords[2]):(dt=at[0],ft=at[1]),ct.coords?(pt=ct.coords.usrCoords[1],mt=ct.coords.usrCoords[2]):(pt=ct[0],mt=ct[1]),gt=Math.atan2(mt-ft,pt-dt)-Math.atan2(ht-ft,ut-dt),gt<0&&(gt+=6.283185307179586),gt},angleBisector:function(lt,at,ct,ut){var ht,dt,ft,pt,mt,gt=lt.coords.usrCoords,vt=at.coords.usrCoords,At=ct.coords.usrCoords;return st.exists(ut)||(ut=lt.board),vt[0]===0?new rt(_e.COORDS_BY_USER,[1,.5*(gt[1]+At[1]),.5*(gt[2]+At[2])],ut):(pt=gt[1]-vt[1],mt=gt[2]-vt[2],ht=Math.atan2(mt,pt),pt=At[1]-vt[1],mt=At[2]-vt[2],dt=Math.atan2(mt,pt),ft=.5*(ht+dt),ht>dt&&(ft+=Math.PI),pt=Math.cos(ft)+vt[1],mt=Math.sin(ft)+vt[2],new rt(_e.COORDS_BY_USER,[1,pt,mt],ut))},reflection:function(lt,at,ct){var ut,ht,dt,ft,pt,mt,gt,vt=at.coords.usrCoords,At=lt.point1.coords.usrCoords,yt=lt.point2.coords.usrCoords;return st.exists(ct)||(ct=at.board),pt=yt[1]-At[1],mt=yt[2]-At[2],ut=vt[1]-At[1],ht=vt[2]-At[2],gt=(pt*ht-mt*ut)/(pt*pt+mt*mt),dt=vt[1]+2*gt*mt,ft=vt[2]-2*gt*pt,new rt(_e.COORDS_BY_USER,[dt,ft],ct)},rotation:function(lt,at,ct,ut){var ht,dt,ft,pt,mt,gt,vt=at.coords.usrCoords,At=lt.coords.usrCoords;return st.exists(ut)||(ut=at.board),ht=vt[1]-At[1],dt=vt[2]-At[2],ft=Math.cos(ct),pt=Math.sin(ct),mt=ht*ft-dt*pt+At[1],gt=ht*pt+dt*ft+At[2],new rt(_e.COORDS_BY_USER,[mt,gt],ut)},perpendicular:function(lt,at,ct){var ut,ht,dt,ft,pt,mt=lt.point1.coords.usrCoords,gt=lt.point2.coords.usrCoords,vt=at.coords.usrCoords;return st.exists(ct)||(ct=at.board),at===lt.point1?(ut=mt[1]+gt[2]-mt[2],ht=mt[2]-gt[1]+mt[1],pt=mt[0]*gt[0],Math.abs(pt)<nt.eps&&(ut=gt[2],ht=-gt[1]),ft=[pt,ut,ht],dt=!0):at===lt.point2?(ut=gt[1]+mt[2]-gt[2],ht=gt[2]-mt[1]+gt[1],pt=mt[0]*gt[0],Math.abs(pt)<nt.eps&&(ut=mt[2],ht=-mt[1]),ft=[pt,ut,ht],dt=!1):Math.abs(nt.innerProduct(vt,lt.stdform,3))<nt.eps?(ut=vt[1]+gt[2]-vt[2],ht=vt[2]-gt[1]+vt[1],pt=gt[0],Math.abs(pt)<nt.eps&&(ut=gt[2],ht=-gt[1]),dt=!0,Math.abs(pt)>nt.eps&&Math.abs(ut-vt[1])<nt.eps&&Math.abs(ht-vt[2])<nt.eps&&(ut=vt[1]+mt[2]-vt[2],ht=vt[2]-mt[1]+vt[1],dt=!1),ft=[pt,ut,ht]):(ft=[0,lt.stdform[1],lt.stdform[2]],ft=nt.crossProduct(ft,vt),ft=nt.crossProduct(ft,lt.stdform),dt=!0),[new rt(_e.COORDS_BY_USER,ft,ct),dt]},circumcenterMidpoint:function(){tt.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(lt,at,ct,ut){var ht,dt,ft,pt,mt=lt.coords.usrCoords,gt=at.coords.usrCoords,vt=ct.coords.usrCoords;return st.exists(ut)||(ut=lt.board),ht=[gt[0]-mt[0],-gt[2]+mt[2],gt[1]-mt[1]],dt=[.5*(mt[0]+gt[0]),.5*(mt[1]+gt[1]),.5*(mt[2]+gt[2])],ft=nt.crossProduct(ht,dt),ht=[vt[0]-gt[0],-vt[2]+gt[2],vt[1]-gt[1]],dt=[.5*(gt[0]+vt[0]),.5*(gt[1]+vt[1]),.5*(gt[2]+vt[2])],pt=nt.crossProduct(ht,dt),new rt(_e.COORDS_BY_USER,nt.crossProduct(ft,pt),ut)},distance:function(lt,at,ct){var ut,ht=0;for(ct||(ct=Math.min(lt.length,at.length)),ut=0;ut<ct;ut++)ht+=(lt[ut]-at[ut])*(lt[ut]-at[ut]);return Math.sqrt(ht)},affineDistance:function(lt,at,ct){var ut;return ut=this.distance(lt,at,ct),ut>nt.eps&&(Math.abs(lt[0])<nt.eps||Math.abs(at[0])<nt.eps)?1/0:ut},sortVertices:function(lt){var at,ct,ut=ot.each(lt,ot.coordsArray),ht=ut.length;for(at=1;at<ht;at++)(ut[at][2]<ut[0][2]||Math.abs(ut[at][2]-ut[0][2])<nt.eps&&ut[at][1]<ut[0][1])&&(ut=st.swap(ut,at,0));return ct=ut.shift(),ut.sort(function(dt,ft){return Math.atan2(dt[2]-ct[2],dt[1]-ct[1])-Math.atan2(ft[2]-ct[2],ft[1]-ct[1])}),ut.unshift(ct),ut.unshift(ut[ut.length-1]),ut},signedTriangle:function(lt,at,ct){var ut=ot.coordsArray(lt),ht=ot.coordsArray(at),dt=ot.coordsArray(ct);return .5*((ht[1]-ut[1])*(dt[2]-ut[2])-(ht[2]-ut[2])*(dt[1]-ut[1]))},signedPolygon:function(lt,at){var ct,ut,ht=0,dt=ot.each(lt,ot.coordsArray);for(at===void 0&&(at=!0),at?dt.unshift(dt[dt.length-1]):dt=this.sortVertices(dt),ut=dt.length,ct=1;ct<ut;ct++)ht+=dt[ct-1][1]*dt[ct][2]-dt[ct][1]*dt[ct-1][2];return .5*ht},GrahamScan:function(lt){var at,ct=1,ut=ot.each(lt,ot.coordsArray),ht=ut.length;for(ut=this.sortVertices(ut),ht=ut.length,at=2;at<ht;at++){for(;this.signedTriangle(ut[ct-1],ut[ct],ut[at])<=0;)if(ct>1)ct-=1;else{if(at===ht-1)break;at+=1}ct+=1,ut=st.swap(ut,ct,at)}return ut.slice(0,ct)},calcStraight:function(lt,at,ct,ut){var ht,dt,ft,pt,mt,gt,vt,At,yt,xt;if(st.exists(ut)||(ut=10),gt=st.evaluate(lt.visProp.straightfirst),vt=st.evaluate(lt.visProp.straightlast),Math.abs(at.scrCoords[0])<nt.eps&&(gt=!0),Math.abs(ct.scrCoords[0])<nt.eps&&(vt=!0),(gt||vt)&&(At=[],At[0]=lt.stdform[0]-lt.stdform[1]*lt.board.origin.scrCoords[1]/lt.board.unitX+lt.stdform[2]*lt.board.origin.scrCoords[2]/lt.board.unitY,At[1]=lt.stdform[1]/lt.board.unitX,At[2]=-lt.stdform[2]/lt.board.unitY,!isNaN(At[0]+At[1]+At[2]))){if(ht=!1,dt=!1,ht=!gt&&Math.abs(at.usrCoords[0])>=nt.eps&&at.scrCoords[1]>=0&&at.scrCoords[1]<=lt.board.canvasWidth&&at.scrCoords[2]>=0&&at.scrCoords[2]<=lt.board.canvasHeight,dt=!vt&&Math.abs(ct.usrCoords[0])>=nt.eps&&ct.scrCoords[1]>=0&&ct.scrCoords[1]<=lt.board.canvasWidth&&ct.scrCoords[2]>=0&&ct.scrCoords[2]<=lt.board.canvasHeight,ft=this.meetLineBoard(At,lt.board,ut),pt=ft[0],mt=ft[1],!ht&&!dt&&(!gt&&vt&&!this.isSameDirection(at,ct,pt)&&!this.isSameDirection(at,ct,mt)||gt&&!vt&&!this.isSameDirection(ct,at,pt)&&!this.isSameDirection(ct,at,mt)))return;ht?dt||(xt=this.isSameDir(at,ct,pt,mt)?mt:pt):dt?yt=this.isSameDir(at,ct,pt,mt)?pt:mt:this.isSameDir(at,ct,pt,mt)?(yt=pt,xt=mt):(xt=pt,yt=mt),yt&&at.setCoordinates(_e.COORDS_BY_USER,yt.usrCoords),xt&&ct.setCoordinates(_e.COORDS_BY_USER,xt.usrCoords)}},calcLineDelimitingPoints:function(lt,at,ct){var ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt=!1,_t=!1;if(mt=st.evaluate(lt.visProp.straightfirst),gt=st.evaluate(lt.visProp.straightlast),Math.abs(at.scrCoords[0])<nt.eps&&(mt=!0),Math.abs(ct.scrCoords[0])<nt.eps&&(gt=!0),vt=[],vt[0]=lt.stdform[0]-lt.stdform[1]*lt.board.origin.scrCoords[1]/lt.board.unitX+lt.stdform[2]*lt.board.origin.scrCoords[2]/lt.board.unitY,vt[1]=lt.stdform[1]/lt.board.unitX,vt[2]=-lt.stdform[2]/lt.board.unitY,!isNaN(vt[0]+vt[1]+vt[2])){if(xt=!mt,_t=!gt,ht=lt.board.getBoundingBox(),dt=lt.getSlope(),dt>=0?(ft=this.projectPointToLine({coords:{usrCoords:[1,ht[2],ht[1]]}},lt,lt.board),pt=this.projectPointToLine({coords:{usrCoords:[1,ht[0],ht[3]]}},lt,lt.board)):(ft=this.projectPointToLine({coords:{usrCoords:[1,ht[0],ht[1]]}},lt,lt.board),pt=this.projectPointToLine({coords:{usrCoords:[1,ht[2],ht[3]]}},lt,lt.board)),!xt&&!_t&&(!mt&&!gt&&(ut=at.distance(_e.COORDS_BY_USER,ct),Math.abs(at.distance(_e.COORDS_BY_USER,ft)+ft.distance(_e.COORDS_BY_USER,ct)-ut)>nt.eps||Math.abs(at.distance(_e.COORDS_BY_USER,pt)+pt.distance(_e.COORDS_BY_USER,ct)-ut)>nt.eps)||!mt&&gt&&!this.isSameDirection(at,ct,ft)&&!this.isSameDirection(at,ct,pt)||mt&&!gt&&!this.isSameDirection(ct,at,ft)&&!this.isSameDirection(ct,at,pt)))return;xt?_t||(yt=this.isSameDir(at,ct,ft,pt)?pt:ft):_t?At=this.isSameDir(at,ct,ft,pt)?ft:pt:this.isSameDir(at,ct,ft,pt)?(At=ft,yt=pt):(yt=ft,At=pt),At&&at.setCoordinates(_e.COORDS_BY_USER,At.usrCoords),yt&&ct.setCoordinates(_e.COORDS_BY_USER,yt.usrCoords)}},calcLabelQuadrant:function(lt){var at;return lt<0&&(lt+=2*Math.PI),at=Math.floor((lt+Math.PI/8)/(Math.PI/4))%8,["rt","urt","top","ulft","lft","llft","lrt"][at]},isSameDir:function(lt,at,ct,ut){var ht=at.usrCoords[1]-lt.usrCoords[1],dt=at.usrCoords[2]-lt.usrCoords[2],ft=ut.usrCoords[1]-ct.usrCoords[1],pt=ut.usrCoords[2]-ct.usrCoords[2];return Math.abs(at.usrCoords[0])<nt.eps&&(ht=at.usrCoords[1],dt=at.usrCoords[2]),Math.abs(lt.usrCoords[0])<nt.eps&&(ht=-lt.usrCoords[1],dt=-lt.usrCoords[2]),ht*ft+dt*pt>=0},isSameDirection:function(lt,at,ct){var ut,ht,dt,ft,pt=!1;return ut=at.usrCoords[1]-lt.usrCoords[1],ht=at.usrCoords[2]-lt.usrCoords[2],dt=ct.usrCoords[1]-lt.usrCoords[1],ft=ct.usrCoords[2]-lt.usrCoords[2],Math.abs(ut)<nt.eps&&(ut=0),Math.abs(ht)<nt.eps&&(ht=0),Math.abs(dt)<nt.eps&&(dt=0),Math.abs(ft)<nt.eps&&(ft=0),(ut>=0&&dt>=0||ut<=0&&dt<=0)&&(pt=ht>=0&&ft>=0||ht<=0&&ft<=0),pt},intersectionFunction:function(lt,at,ct,ut,ht,dt){var ft=this;return at.elementClass===_e.OBJECT_CLASS_CURVE&&ct.elementClass===_e.OBJECT_CLASS_CURVE?function(){return ft.meetCurveCurve(at,ct,ut,ht,at.board)}:at.elementClass===_e.OBJECT_CLASS_CURVE&&ct.elementClass===_e.OBJECT_CLASS_LINE||ct.elementClass===_e.OBJECT_CLASS_CURVE&&at.elementClass===_e.OBJECT_CLASS_LINE?function(){return ft.meetCurveLine(at,ct,ut,at.board,dt)}:at.elementClass===_e.OBJECT_CLASS_LINE&&ct.elementClass===_e.OBJECT_CLASS_LINE?function(){var pt,mt,gt,vt,At,yt;return gt=vt=st.evaluate(at.visProp.straightfirst),At=yt=st.evaluate(at.visProp.straightlast),st.evaluate(dt)||gt&&At&&vt&&yt?ft.meet(at.stdform,ct.stdform,ut,at.board):(pt=ft.meetSegmentSegment(at.point1.coords.usrCoords,at.point2.coords.usrCoords,ct.point1.coords.usrCoords,ct.point2.coords.usrCoords,at.board),mt=!gt&&pt[1]<0||!At&&pt[1]>1||!vt&&pt[2]<0||!yt&&pt[2]>1?[0,NaN,NaN]:pt[0],new rt(_e.COORDS_BY_USER,mt,at.board))}:function(){return ft.meet(at.stdform,ct.stdform,ut,at.board)}},meet:function(lt,at,ct,ut){var ht=nt.eps;return Math.abs(lt[3])<ht&&Math.abs(at[3])<ht?this.meetLineLine(lt,at,ct,ut):Math.abs(lt[3])>=ht&&Math.abs(at[3])<ht?this.meetLineCircle(at,lt,ct,ut):Math.abs(lt[3])<ht&&Math.abs(at[3])>=ht?this.meetLineCircle(lt,at,ct,ut):this.meetCircleCircle(lt,at,ct,ut)},meetLineBoard:function(lt,at,ct){var ut,ht,dt,ft,pt=[];for(st.exists(ct)||(ct=0),pt[0]=nt.crossProduct(lt,[ct,0,1]),pt[1]=nt.crossProduct(lt,[ct,1,0]),pt[2]=nt.crossProduct(lt,[-ct-at.canvasHeight,0,1]),pt[3]=nt.crossProduct(lt,[-ct-at.canvasWidth,1,0]),dt=0;dt<4;dt++)if(Math.abs(pt[dt][0])>nt.eps){for(ft=2;ft>0;ft--)pt[dt][ft]/=pt[dt][0];pt[dt][0]=1}return Math.abs(pt[1][0])<nt.eps?(ut=pt[0],ht=pt[2]):Math.abs(pt[0][0])<nt.eps?(ut=pt[1],ht=pt[3]):pt[1][2]<0?(ut=pt[0],ht=pt[3][2]>at.canvasHeight?pt[2]:pt[3]):pt[1][2]>at.canvasHeight?(ut=pt[2],ht=pt[3][2]<0?pt[0]:pt[3]):(ut=pt[1],ht=pt[3][2]<0?pt[0]:pt[3][2]>at.canvasHeight?pt[2]:pt[3]),ut=new rt(_e.COORDS_BY_SCREEN,ut.slice(1),at),ht=new rt(_e.COORDS_BY_SCREEN,ht.slice(1),at),[ut,ht]},meetLineLine:function(lt,at,ct,ut){var ht=isNaN(lt[5]+at[5])?[0,0,0]:nt.crossProduct(lt,at);return new rt(_e.COORDS_BY_USER,ht,ut)},meetLineCircle:function(lt,at,ct,ut){var ht,dt,ft,pt,mt,gt,vt,At,yt,xt;return at[4]<nt.eps?Math.abs(nt.innerProduct([1,at[6],at[7]],lt,3))<nt.eps?new rt(_e.COORDS_BY_USER,at.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[NaN,NaN],ut):(ft=at[0],dt=at.slice(1,3),ht=at[3],pt=lt[0],mt=lt.slice(1,3),gt=ht,vt=dt[0]*mt[1]-dt[1]*mt[0],At=ht*pt*pt-(dt[0]*mt[0]+dt[1]*mt[1])*pt+ft,yt=vt*vt-4*gt*At,yt>-nt.eps*nt.eps?(yt=Math.sqrt(Math.abs(yt)),xt=[(-vt+yt)/(2*gt),(-vt-yt)/(2*gt)],ct===0?new rt(_e.COORDS_BY_USER,[-xt[0]*-mt[1]-pt*mt[0],-xt[0]*mt[0]-pt*mt[1]],ut):new rt(_e.COORDS_BY_USER,[-xt[1]*-mt[1]-pt*mt[0],-xt[1]*mt[0]-pt*mt[1]],ut)):new rt(_e.COORDS_BY_USER,[0,0,0],ut))},meetCircleCircle:function(lt,at,ct,ut){var ht;return lt[4]<nt.eps?Math.abs(this.distance(lt.slice(6,2),at.slice(6,8))-at[4])<nt.eps?new rt(_e.COORDS_BY_USER,lt.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[0,0,0],ut):at[4]<nt.eps?Math.abs(this.distance(at.slice(6,2),lt.slice(6,8))-lt[4])<nt.eps?new rt(_e.COORDS_BY_USER,at.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[0,0,0],ut):(ht=[at[3]*lt[0]-lt[3]*at[0],at[3]*lt[1]-lt[3]*at[1],at[3]*lt[2]-lt[3]*at[2],0,1,1/0,1/0,1/0],ht=nt.normalize(ht),this.meetLineCircle(ht,lt,ct,ut))},meetCurveCurve:function(lt,at,ct,ut,ht,dt){var ft;return ft=st.exists(dt)&&dt==="newton"?it.generalizedNewton(lt,at,ct,ut):lt.bezierDegree===3&&at.bezierDegree===3?this.meetBezierCurveRedBlueSegments(lt,at,ct):this.meetCurveRedBlueSegments(lt,at,ct),new rt(_e.COORDS_BY_USER,ft,ht)},meetCurveLine:function(lt,at,ct,ut,ht){var dt,ft;return st.exists(ut)||(ut=lt.board),lt.elementClass===_e.OBJECT_CLASS_CURVE?(dt=lt,ft=at):(dt=at,ft=lt),this.meetCurveLineDiscrete(dt,ft,ct,ut,!ht)},meetCurveLineContinuous:function(lt,at,ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt=nt.eps,Pt=nt.eps;for(mt=this.meetCurveLineDiscrete(lt,at,ct,ut,ht),gt=mt.usrCoords[1],vt=mt.usrCoords[2],ft=function(It){var Ot,Bt;return It>lt.maxX()||It<lt.minX()?1/0:(Ot=gt-lt.X(It),Bt=vt-lt.Y(It),Ot*Ot+Bt*Bt)},pt=function(It){var Ot=at.stdform[0]+at.stdform[1]*lt.X(It)+at.stdform[2]*lt.Y(It);return Ot*Ot},yt=50,xt=(lt.maxX()-lt.minX())/yt,_t=lt.minX(),wt=1e-4,bt=NaN,Et=0;Et<yt&&(dt=it.root(ft,[Math.max(_t,lt.minX()),Math.min(_t+xt,lt.maxX())]),!((Tt=Math.abs(ft(dt)))<=wt&&(wt=Tt,bt=dt,wt<Mt)));Et++)_t+=xt;return dt=bt,dt=it.root(pt,[Math.max(dt-xt,lt.minX()),Math.min(dt+xt,lt.maxX())]),Tt=pt(dt),At=isNaN(Tt)||Math.abs(Tt)>Pt?0:1,new rt(_e.COORDS_BY_USER,[At,lt.X(dt),lt.Y(dt)],ut)},meetCurveLineContinuousOld:function(lt,at,ct,ut){var ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt=10*nt.eps;if(tt.deprecated("Geometry.meetCurveLineContinuousOld()","Geometry.meetCurveLineContinuous()"),pt=function(wt){var Tt=at.stdform[0]+at.stdform[1]*lt.X(wt)+at.stdform[2]*lt.Y(wt);return Tt*Tt},this.meetCurveLineContinuous.t1memo?(yt=this.meetCurveLineContinuous.t1memo,ht=it.root(pt,yt)):(yt=lt.minX(),xt=lt.maxX(),ht=it.root(pt,[yt,xt])),this.meetCurveLineContinuous.t1memo=ht,_t=lt.X(ht),Et=lt.Y(ht),ct===1){if(this.meetCurveLineContinuous.t2memo&&(yt=this.meetCurveLineContinuous.t2memo),dt=it.root(pt,yt),!(Math.abs(dt-ht)>.1&&Math.abs(_t-lt.X(dt))>.1&&Math.abs(Et-lt.Y(dt))>.1))for(vt=20,At=(lt.maxX()-lt.minX())/vt,gt=lt.minX(),ft=0;ft<vt&&(dt=it.root(pt,[gt,gt+At]),!(Math.abs(pt(dt))<=bt&&Math.abs(dt-ht)>.1&&Math.abs(_t-lt.X(dt))>.1&&Math.abs(Et-lt.Y(dt))>.1));ft++)gt+=At;ht=dt,this.meetCurveLineContinuous.t2memo=ht}return mt=Math.abs(pt(ht))>bt?NaN:1,new rt(_e.COORDS_BY_USER,[mt,lt.X(ht),lt.Y(ht)],ut)},meetCurveLineDiscrete:function(lt,at,ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt=at.point1.coords.usrCoords,xt=at.point2.coords.usrCoords,_t=0,Et=lt.numberPoints,bt=st.evaluate(at.visProp.straightfirst),wt=st.evaluate(at.visProp.straightlast);for(vt=new rt(_e.COORDS_BY_USER,[0,NaN,NaN],ut),yt[0]===0?yt=[1,xt[1]+at.stdform[2],xt[2]-at.stdform[1]]:xt[0]===0&&(xt=[1,yt[1]+at.stdform[2],yt[2]-at.stdform[1]]),mt=lt.points[0].usrCoords,dt=1;dt<Et;dt++)if(pt=mt.slice(0),mt=lt.points[dt].usrCoords,this.distance(pt,mt)>nt.eps){for(lt.bezierDegree===3?(At=this.meetBeziersegmentBeziersegment([lt.points[dt-1].usrCoords.slice(1),lt.points[dt].usrCoords.slice(1),lt.points[dt+1].usrCoords.slice(1),lt.points[dt+2].usrCoords.slice(1)],[yt.slice(1),xt.slice(1)],ht),dt+=2):At=[this.meetSegmentSegment(pt,mt,yt,xt)],ft=0;ft<At.length;ft++)if(gt=At[ft],0<=gt[1]&&gt[1]<=1){if(_t===ct)return ht&&(!bt&&gt[2]<0||!wt&&gt[2]>1)?vt:vt=new rt(_e.COORDS_BY_USER,gt[0],ut);_t+=1}}return vt},meetCurveRedBlueSegments:function(lt,at,ct){var ut,ht,dt,ft,pt,mt,gt,vt,At,yt=0,xt=at.numberPoints,_t=lt.numberPoints;if(xt<=1||_t<=1)return[0,NaN,NaN];for(ut=1;ut<_t;ut++)for(dt=lt.points[ut-1].usrCoords,ft=lt.points[ut].usrCoords,vt=Math.min(dt[1],ft[1]),At=Math.max(dt[1],ft[1]),mt=at.points[0].usrCoords,ht=1;ht<xt;ht++)if(pt=mt,mt=at.points[ht].usrCoords,Math.min(pt[1],mt[1])<At&&Math.max(pt[1],mt[1])>vt&&(gt=this.meetSegmentSegment(dt,ft,pt,mt),gt[1]>=0&&gt[2]>=0&&(gt[1]<1&&gt[2]<1||ut===_t-1&&gt[1]===1||ht===xt-1&&gt[2]===1))){if(yt===ct)return gt[0];yt++}return[0,NaN,NaN]},meetSegmentSegment:function(lt,at,ct,ut){var ht,dt,ft,pt=nt.crossProduct(lt,at),mt=nt.crossProduct(ct,ut),gt=nt.crossProduct(pt,mt),vt=gt[0];return Math.abs(vt)<nt.eps?[gt,1/0,1/0]:(ft=[ct[1]-lt[1],ct[2]-lt[2]],ht=(ft[0]*(ut[2]-ct[2])-ft[1]*(ut[1]-ct[1]))/vt,dt=(ft[0]*(at[2]-lt[2])-ft[1]*(at[1]-lt[1]))/vt,[gt,ht,dt])},_bezierSplit:function(lt){var at,ct,ut,ht,dt,ft;return at=[.5*(lt[0][0]+lt[1][0]),.5*(lt[0][1]+lt[1][1])],ct=[.5*(lt[1][0]+lt[2][0]),.5*(lt[1][1]+lt[2][1])],ut=[.5*(lt[2][0]+lt[3][0]),.5*(lt[2][1]+lt[3][1])],ht=[.5*(at[0]+ct[0]),.5*(at[1]+ct[1])],dt=[.5*(ct[0]+ut[0]),.5*(ct[1]+ut[1])],ft=[.5*(ht[0]+dt[0]),.5*(ht[1]+dt[1])],[[lt[0],at,ht,ft],[ft,dt,ut,lt[3]]]},_bezierBbox:function(lt){var at=[];return lt.length===4?(at[0]=Math.min(lt[0][0],lt[1][0],lt[2][0],lt[3][0]),at[1]=Math.max(lt[0][1],lt[1][1],lt[2][1],lt[3][1]),at[2]=Math.max(lt[0][0],lt[1][0],lt[2][0],lt[3][0]),at[3]=Math.min(lt[0][1],lt[1][1],lt[2][1],lt[3][1])):(at[0]=Math.min(lt[0][0],lt[1][0]),at[1]=Math.max(lt[0][1],lt[1][1]),at[2]=Math.max(lt[0][0],lt[1][0]),at[3]=Math.min(lt[0][1],lt[1][1])),at},_bezierOverlap:function(lt,at){return lt[2]>=at[0]&&lt[0]<=at[2]&&lt[1]>=at[3]&&lt[3]<=at[1]},_bezierListConcat:function(lt,at,ct,ut){var ht,dt=st.exists(ut),ft=0,pt=at.length,mt=lt.length;for(mt>0&&pt>0&&(lt[mt-1][1]===1&&at[0][1]===0||dt&&lt[mt-1][2]===1&&at[0][2]===0)&&(ft=1),ht=ft;ht<pt;ht++)dt&&(at[ht][2]*=.5,at[ht][2]+=ut),at[ht][1]*=.5,at[ht][1]+=ct,lt.push(at[ht])},_bezierMeetSubdivision:function(lt,at,ct){var ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et=[];return ht=this._bezierBbox(at),ut=this._bezierBbox(lt),this._bezierOverlap(ht,ut)?ct<5?(dt=this._bezierSplit(lt),mt=dt[0],gt=dt[1],dt=this._bezierSplit(at),ft=dt[0],pt=dt[1],this._bezierListConcat(Et,this._bezierMeetSubdivision(mt,ft,ct+1),0,0),this._bezierListConcat(Et,this._bezierMeetSubdivision(mt,pt,ct+1),0,.5),this._bezierListConcat(Et,this._bezierMeetSubdivision(gt,ft,ct+1),.5,0),this._bezierListConcat(Et,this._bezierMeetSubdivision(gt,pt,ct+1),.5,.5),Et):(xt=[1].concat(lt[0]),_t=[1].concat(lt[3]),At=[1].concat(at[0]),yt=[1].concat(at[3]),vt=this.meetSegmentSegment(xt,_t,At,yt),vt[1]>=0&&vt[2]>=0&&vt[1]<=1&&vt[2]<=1?[vt]:[]):[]},_bezierLineMeetSubdivision:function(lt,at,ct,ut){var ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t=[];return ht=this._bezierBbox(at),dt=this._bezierBbox(lt),ut&&!this._bezierOverlap(dt,ht)?[]:ct<5?(ft=this._bezierSplit(lt),pt=ft[0],mt=ft[1],this._bezierListConcat(_t,this._bezierLineMeetSubdivision(pt,at,ct+1),0),this._bezierListConcat(_t,this._bezierLineMeetSubdivision(mt,at,ct+1),.5),_t):(yt=[1].concat(lt[0]),xt=[1].concat(lt[3]),vt=[1].concat(at[0]),At=[1].concat(at[1]),gt=this.meetSegmentSegment(yt,xt,vt,At),gt[1]>=0&&gt[1]<=1&&(!ut||gt[2]>=0&&gt[2]<=1)?[gt]:[])},meetBeziersegmentBeziersegment:function(lt,at,ct){var ut,ht,dt;for(ut=lt.length===4&&at.length===4?this._bezierMeetSubdivision(lt,at,0):this._bezierLineMeetSubdivision(lt,at,0,ct),ut.sort(function(ft,pt){return 1e7*(ft[1]-pt[1])+(ft[2]-pt[2])}),ht=[],dt=0;dt<ut.length;dt++)dt!==0&&ut[dt][1]===ut[dt-1][1]&&ut[dt][2]===ut[dt-1][2]||ht.push(ut[dt]);return ht},meetBezierCurveRedBlueSegments:function(lt,at,ct){var ut,ht,dt,ft,pt,mt,gt,vt=at.numberPoints,At=lt.numberPoints,yt=[];if(vt<4||At<4)return[0,NaN,NaN];for(ht=0;ht<At-3;ht+=3)for(ut=lt.points,ft=[[ut[ht].usrCoords[1],ut[ht].usrCoords[2]],[ut[ht+1].usrCoords[1],ut[ht+1].usrCoords[2]],[ut[ht+2].usrCoords[1],ut[ht+2].usrCoords[2]],[ut[ht+3].usrCoords[1],ut[ht+3].usrCoords[2]]],mt=this._bezierBbox(ft),dt=0;dt<vt-3;dt+=3)if(ut=at.points,pt=[[ut[dt].usrCoords[1],ut[dt].usrCoords[2]],[ut[dt+1].usrCoords[1],ut[dt+1].usrCoords[2]],[ut[dt+2].usrCoords[1],ut[dt+2].usrCoords[2]],[ut[dt+3].usrCoords[1],ut[dt+3].usrCoords[2]]],gt=this._bezierBbox(pt),this._bezierOverlap(mt,gt)&&(yt=yt.concat(this.meetBeziersegmentBeziersegment(ft,pt)),yt.length>ct))return yt[ct][0];return yt.length>ct?yt[ct][0]:[0,NaN,NaN]},bezierSegmentEval:function(lt,at){var ct,ut,ht,dt=1-lt;return ut=0,ht=0,ct=dt*dt*dt,ut+=ct*at[0][0],ht+=ct*at[0][1],ct=3*lt*dt*dt,ut+=ct*at[1][0],ht+=ct*at[1][1],ct=3*lt*lt*dt,ut+=ct*at[2][0],ht+=ct*at[2][1],ct=lt*lt*lt,ut+=ct*at[3][0],ht+=ct*at[3][1],[1,ut,ht]},bezierArc:function(lt,at,ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt,Pt,It,Ot=.5*Math.PI,Bt=at[1],Ut=at[2],Ft=at[0],jt=[],Dt=[];for(gt=this.distance(at,lt),Bt/=Ft,Ut/=Ft,vt=this.rad(lt.slice(1),at.slice(1),ct.slice(1)),ht===-1&&(vt=2*Math.PI-vt),dt=lt,dt[1]/=dt[0],dt[2]/=dt[0],dt[0]/=dt[0],mt=dt.slice(0),ut?(jt=[Bt,Bt+.333*(dt[1]-Bt),Bt+.666*(dt[1]-Bt),dt[1]],Dt=[Ut,Ut+.333*(dt[2]-Ut),Ut+.666*(dt[2]-Ut),dt[2]]):(jt=[dt[1]],Dt=[dt[2]]);vt>nt.eps;)vt>Ot?(At=Ot,vt-=Ot):(At=vt,vt=0),yt=Math.cos(ht*At),xt=Math.sin(ht*At),It=[[1,0,0],[Bt*(1-yt)+Ut*xt,yt,-xt],[Ut*(1-yt)-Bt*xt,xt,yt]],Mt=nt.matVecMult(It,dt),mt=[Mt[0]/Mt[0],Mt[1]/Mt[0],Mt[2]/Mt[0]],_t=dt[1]-Bt,Et=dt[2]-Ut,bt=mt[1]-Bt,wt=mt[2]-Ut,Pt=Math.sqrt((_t+bt)*(_t+bt)+(Et+wt)*(Et+wt)),Tt=Math.abs(wt-Et)>nt.eps?(_t+bt)*(gt/Pt-.5)/(wt-Et)*8/3:(Et+wt)*(gt/Pt-.5)/(_t-bt)*8/3,ft=[1,dt[1]-Tt*Et,dt[2]+Tt*_t],pt=[1,mt[1]+Tt*wt,mt[2]-Tt*bt],jt=jt.concat([ft[1],pt[1],mt[1]]),Dt=Dt.concat([ft[2],pt[2],mt[2]]),dt=mt.slice(0);return ut&&(jt=jt.concat([mt[1]+.333*(Bt-mt[1]),mt[1]+.666*(Bt-mt[1]),Bt]),Dt=Dt.concat([mt[2]+.333*(Ut-mt[2]),mt[2]+.666*(Ut-mt[2]),Ut])),[jt,Dt]},projectPointToCircle:function(lt,at,ct){var ut,ht,dt,ft,pt,mt=at.center.coords.usrCoords;return st.exists(ct)||(ct=lt.board),st.isPoint(lt)?(ut=lt.coords.distance(_e.COORDS_BY_USER,at.center.coords),ht=lt.coords.usrCoords):(ut=lt.distance(_e.COORDS_BY_USER,at.center.coords),ht=lt.usrCoords),Math.abs(ut)<nt.eps&&(ut=nt.eps),pt=at.Radius()/ut,dt=mt[1]+pt*(ht[1]-mt[1]),ft=mt[2]+pt*(ht[2]-mt[2]),new rt(_e.COORDS_BY_USER,[dt,ft],ct)},projectPointToLine:function(lt,at,ct){var ut=[0,at.stdform[1],at.stdform[2]];return st.exists(ct)||(ct=lt.board),ut=nt.crossProduct(ut,lt.coords.usrCoords),new rt(_e.COORDS_BY_USER,nt.crossProduct(ut,at.stdform),ct)},projectCoordsToSegment:function(lt,at,ct){var ut,ht,dt=[ct[1]-at[1],ct[2]-at[2]],ft=[lt[1]-at[1],lt[2]-at[2]];return Math.abs(dt[0])<nt.eps&&Math.abs(dt[1])<nt.eps?[at,0]:(ut=nt.innerProduct(ft,dt),ht=nt.innerProduct(dt,dt),ut/=ht,[[1,ut*dt[0]+at[1],ut*dt[1]+at[2]],ut])},projectCoordsToBeziersegment:function(lt,at,ct){var ut,ht=function(dt){var ft=[1,at.X(ct+dt),at.Y(ct+dt)];return ft[1]-=lt[1],ft[2]-=lt[2],ft[1]*ft[1]+ft[2]*ft[2]};return ut=tt.Math.Numerics.fminbr(ht,[0,1]),[[1,at.X(ut+ct),at.Y(ut+ct)],ut]},projectPointToCurve:function(lt,at,ct){st.exists(ct)||(ct=lt.board);var ut=lt.X(),ht=lt.Y(),dt=lt.position||0,ft=this.projectCoordsToCurve(ut,ht,dt,at,ct);return lt.position=ft[1],ft[0]},projectCoordsToCurve:function(lt,at,ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt=Number.POSITIVE_INFINITY;if(st.exists(ht)||(ht=ut.board),st.evaluate(ut.visProp.curvetype)==="plot"){if(ct=0,gt=jt,dt=ut.numberPoints===0?[0,1,1]:[ut.Z(0),ut.X(0),ut.Y(0)],ut.numberPoints>1)for(yt=[1,lt,at],ut.bezierDegree===3?mt=0:Et=[ut.Z(0),ut.X(0),ut.Y(0)],pt=0;pt<ut.numberPoints-1;pt++)ut.bezierDegree===3?wt=this.projectCoordsToBeziersegment(yt,ut,mt):(bt=[ut.Z(pt+1),ut.X(pt+1),ut.Y(pt+1)],wt=this.projectCoordsToSegment(yt,Et,bt)),At=wt[1],xt=wt[0],0<=At&&At<=1?(vt=this.distance(xt,yt),_t=pt+At):At<0?(xt=Et,vt=this.distance(Et,yt),_t=pt):At>1&&pt===ut.numberPoints-2&&(xt=bt,vt=this.distance(xt,yt),_t=ut.numberPoints-1),vt<gt&&(gt=vt,ct=_t,dt=xt),ut.bezierDegree===3?(mt++,pt+=2):Et=bt;ft=new rt(_e.COORDS_BY_USER,dt,ht)}else{for(Tt=function(Dt){var Gt,zt;return Dt<ut.minX()||Dt>ut.maxX()?NaN:(Gt=lt-ut.X(Dt),zt=at-ut.Y(Dt),Gt*Gt+zt*zt)},It=Tt(ct),Bt=50,Ot=(ut.maxX()-ut.minX())/Bt,Mt=ut.minX(),pt=0;pt<Bt;pt++)Pt=Tt(Mt),(Pt<It||isNaN(It))&&(ct=Mt,It=Pt),Mt+=Ot;ct=it.fminbr(Tt,[ct-Ot,ct+Ot]),Ut=ut.minX(),Ft=ut.maxX(),ct=ct<Ut?Ut:ct,ct=ct>Ft?Ft:ct,ft=new rt(_e.COORDS_BY_USER,[ut.X(ct),ut.Y(ct)],ht)}return[ut.updateTransform(ft),ct]},projectCoordsToPolygon:function(lt,at){var ct,ut,ht,dt,ft=at.vertices.length,pt=1/0;for(ct=0;ct<ft;ct++)ht=tt.Math.Geometry.projectCoordsToSegment(lt,at.vertices[ct].coords.usrCoords,at.vertices[(ct+1)%ft].coords.usrCoords),ut=tt.Math.Geometry.distance(ht[0],lt,3),0<=ht[1]&&ht[1]<=1&&ut<pt&&(dt=ht[0].slice(0),pt=ut);return dt},projectPointToTurtle:function(lt,at,ct){var ut,ht,dt,ft,pt,mt,gt,vt,At=0,yt=0,xt=Number.POSITIVE_INFINITY,_t=at.objects.length;for(st.exists(ct)||(ct=lt.board),pt=0;pt<_t;pt++)gt=at.objects[pt],gt.elementClass===_e.OBJECT_CLASS_CURVE&&(ut=this.projectPointToCurve(lt,gt),mt=this.distance(ut.usrCoords,lt.coords.usrCoords),mt<xt&&(dt=ut.usrCoords[1],ft=ut.usrCoords[2],ht=lt.position,xt=mt,vt=gt,yt=At),At+=gt.numberPoints);return ut=new rt(_e.COORDS_BY_USER,[dt,ft],ct),lt.position=ht+yt,vt.updateTransform(ut)},projectPointToPoint:function(lt,at){return at.coords},projectPointToBoard:function(lt,at){var ct,ut,ht,dt=at||lt.board,ft=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],pt=lt.coords||lt,mt=dt.getBoundingBox();for(ct=0;ct<4;ct++)ht=ft[ct],ht[0]*pt.usrCoords[ht[1]]<ht[0]*mt[ht[2]]&&(ut=nt.crossProduct([1,mt[ht[3]],mt[ht[4]]],[1,mt[ht[5]],mt[ht[6]]]),ut[3]=0,ut=nt.normalize(ut),pt=this.projectPointToLine({coords:pt},{stdform:ut},dt));return pt},distPointLine:function(lt,at){var ct,ut=at[1],ht=at[2],dt=at[0];return Math.abs(ut)+Math.abs(ht)<nt.eps?Number.POSITIVE_INFINITY:(ct=ut*lt[1]+ht*lt[2]+dt,ut*=ut,ht*=ht,Math.abs(ct)/Math.sqrt(ut+ht))},reuleauxPolygon:function(lt,at){var ct,ut=2*Math.PI,ht=ut/at,dt=(at-1)/2,ft=0,pt=function(mt,gt){return function(vt,At){var yt=(vt%ut+ut)%ut,xt=Math.floor(yt/ht)%at;return At||(ft=lt[0].Dist(lt[dt]),ct=nt.Geometry.rad([lt[0].X()+1,lt[0].Y()],lt[0],lt[dt%at])),isNaN(xt)?xt:(yt=.5*yt+xt*ht*.5+ct,lt[xt][mt]()+ft*Math[gt](yt))}};return[pt("X","cos"),pt("Y","sin"),0,ut]}}),nt.Geometry}),define("utils/zip",["jxg"],function(tt){var _e=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],rt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],nt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],it=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],st=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ot=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],lt=256;return tt.Util=tt.Util||{},tt.Util.Unzip=function(at){function ct(){return jt<Ft?at[jt++]:-1}function ut(){Dt=1}function ht(){var Kt;try{return Kt=1&Dt,Dt>>=1,Dt===0&&(Dt=ct(),Kt=1&Dt,Dt=Dt>>1|128),Kt}catch(rr){throw rr}}function dt(Kt){var rr=0,ur=Kt;try{for(;ur--;)rr=rr<<1|ht();Kt&&(rr=_e[rr]>>8-Kt)}catch(fr){throw fr}return rr}function ft(){Bt=0}function pt(Kt){Ot[Bt++]=Kt,Mt.push(String.fromCharCode(Kt)),Bt===32768&&(Bt=0)}function mt(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function gt(){for(;;){if(Zt[er]>=wt)return-1;if(bt[Zt[er]]===er)return Zt[er]++;Zt[er]++}}function vt(){var Kt,rr=Ht[$t];if(er===17)return-1;if($t++,er++,(Kt=gt())>=0)rr.b0=Kt;else if(rr.b0=32768,vt())return-1;if((Kt=gt())>=0)rr.b1=Kt,rr.jump=null;else if(rr.b1=32768,rr.jump=Ht[$t],rr.jumppos=$t,vt())return-1;return er--,0}function At(Kt,rr,ur,fr){var dr;for(Ht=Kt,$t=0,bt=ur,wt=rr,dr=0;dr<17;dr++)Zt[dr]=0;return er=0,vt()?-1:0}function yt(Kt){for(var rr,ur,fr=0,dr=Kt[fr];;)if(ht()){if(!(32768&dr.b1))return dr.b1;for(dr=dr.jump,rr=Kt.length,ur=0;ur<rr;ur++)if(Kt[ur]===dr){fr=ur;break}}else{if(!(32768&dr.b0))return dr.b0;fr++,dr=Kt[fr]}}function xt(){var Kt,rr,ur,fr,dr,gr,Yt,xr,vr,Pr,Sr,Qr,Ir,Dr,Ur,Lr;do if(Kt=ht(),(ur=dt(2))===0)for(ut(),Pr=ct(),Pr|=ct()<<8,Qr=ct(),Qr|=ct()<<8,65535&(Pr^~Qr)&&tt.debug(`BlockLen checksum mismatch
`);Pr--;)rr=ct(),pt(rr);else if(ur===1)for(;;)if(dr=_e[dt(7)]>>1,dr>23?(dr=dr<<1|ht(),dr>199?(dr-=128,dr=dr<<1|ht()):(dr-=48)>143&&(dr+=136)):dr+=256,dr<256)pt(dr);else{if(dr===256)break;for(dr-=257,vr=dt(nt[dr])+rt[dr],dr=_e[dt(5)]>>3,st[dr]>8?(Sr=dt(8),Sr|=dt(st[dr]-8)<<8):Sr=dt(st[dr]),Sr+=it[dr],dr=0;dr<vr;dr++)rr=Ot[Bt-Sr&32767],pt(rr)}else if(ur===2){for(Yt=new Array(320),Dr=257+dt(5),Ur=1+dt(5),Lr=4+dt(4),dr=0;dr<19;dr++)Yt[dr]=0;for(dr=0;dr<Lr;dr++)Yt[ot[dr]]=dt(3);for(vr=zt.length,fr=0;fr<vr;fr++)zt[fr]=new mt;if(At(zt,19,Yt))return ft(),1;for(Ir=Dr+Ur,fr=0,-1;fr<Ir;)if((dr=yt(zt))<16)Yt[fr++]=dr;else if(dr===16){if(dr=3+dt(2),fr+dr>Ir)return ft(),1;for(gr=fr?Yt[fr-1]:0;dr--;)Yt[fr++]=gr}else{if(dr=dr===17?3+dt(3):11+dt(7),fr+dr>Ir)return ft(),1;for(;dr--;)Yt[fr++]=0}for(vr=Gt.length,fr=0;fr<vr;fr++)Gt[fr]=new mt;if(At(Gt,Dr,Yt))return ft(),1;for(vr=Gt.length,fr=0;fr<vr;fr++)zt[fr]=new mt;for(xr=[],fr=Dr;fr<Yt.length;fr++)xr[fr-Dr]=Yt[fr];if(At(zt,Ur,xr))return ft(),1;for(;;)if((dr=yt(Gt))>=256){if((dr-=256)===0)break;for(dr-=1,vr=dt(nt[dr])+rt[dr],dr=yt(zt),st[dr]>8?(Sr=dt(8),Sr|=dt(st[dr]-8)<<8):Sr=dt(st[dr]),Sr+=it[dr];vr--;)rr=Ot[Bt-Sr&32767],pt(rr)}else pt(dr)}while(!Kt);return ft(),ut(),0}function _t(){var Kt,rr,ur,fr,dr,gr,Yt,xr,vr=[];try{if(Mt=[],Ut=!1,vr[0]=ct(),vr[1]=ct(),vr[0]===120&&vr[1]===218&&(xt(),It[Pt]=[Mt.join(""),"geonext.gxt"],Pt++),vr[0]===31&&vr[1]===139&&(Tt(),It[Pt]=[Mt.join(""),"file"],Pt++),vr[0]===80&&vr[1]===75&&(Ut=!0,vr[2]=ct(),vr[3]=ct(),vr[2]===3&&vr[3]===4)){for(vr[0]=ct(),vr[1]=ct(),Et=ct(),Et|=ct()<<8,xr=ct(),xr|=ct()<<8,ct(),ct(),ct(),ct(),Yt=ct(),Yt|=ct()<<8,Yt|=ct()<<16,Yt|=ct()<<24,gr=ct(),gr|=ct()<<8,gr|=ct()<<16,gr|=ct()<<24,dr=ct(),dr|=ct()<<8,dr|=ct()<<16,dr|=ct()<<24,fr=ct(),fr|=ct()<<8,ur=ct(),ur|=ct()<<8,Kt=0,or=[];fr--;)rr=ct(),rr==="/"|rr===":"?Kt=0:Kt<lt-1&&(or[Kt++]=String.fromCharCode(rr));for(Kt=0;Kt<ur;)rr=ct(),Kt++;xr===8&&(xt(),It[Pt]=new Array(2),It[Pt][0]=Mt.join(""),It[Pt][1]=or.join(""),Pt++),Tt()}}catch(Pr){throw Pr}}var Et,bt,wt,Tt,Mt=[],Pt=0,It=[],Ot=new Array(32768),Bt=0,Ut=!1,Ft=at.length,jt=0,Dt=1,Gt=new Array(288),zt=new Array(32),$t=0,Ht=null,er=0,Zt=new Array(17),or=[];Zt[0]=0,Tt=function(){var Kt,rr,ur,fr,dr,gr=[];if(8&Et&&(gr[0]=ct(),gr[1]=ct(),gr[2]=ct(),gr[3]=ct(),gr[0]===80&&gr[1]===75&&gr[2]===7&&gr[3]===8?(Kt=ct(),Kt|=ct()<<8,Kt|=ct()<<16,Kt|=ct()<<24):Kt=gr[0]|gr[1]<<8|gr[2]<<16|gr[3]<<24,rr=ct(),rr|=ct()<<8,rr|=ct()<<16,rr|=ct()<<24,ur=ct(),ur|=ct()<<8,ur|=ct()<<16,ur|=ct()<<24),Ut&&_t(),gr[0]=ct(),gr[0]===8){if(Et=ct(),ct(),ct(),ct(),ct(),ct(),ct(),4&Et)for(gr[0]=ct(),gr[2]=ct(),er=gr[0]+256*gr[1],fr=0;fr<er;fr++)ct();if(8&Et)for(fr=0,or=[],dr=ct();dr;)dr!=="7"&&dr!==":"||(fr=0),fr<lt-1&&(or[fr++]=dr),dr=ct();if(16&Et)for(dr=ct();dr;)dr=ct();2&Et&&(ct(),ct()),xt(),Kt=ct(),Kt|=ct()<<8,Kt|=ct()<<16,Kt|=ct()<<24,ur=ct(),ur|=ct()<<8,ur|=ct()<<16,ur|=ct()<<24,Ut&&_t()}},tt.Util.Unzip.prototype.unzipFile=function(Kt){var rr;for(this.unzip(),rr=0;rr<It.length;rr++)if(It[rr][1]===Kt)return It[rr][0];return""},tt.Util.Unzip.prototype.unzip=function(){return _t(),It}},tt.Util}),define("utils/encoding",["jxg"],function(tt){var _e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return tt.Util=tt.Util||{},tt.Util.UTF8={encode:function(rt){var nt,it,st="",ot=rt.length;if(rt=rt.replace(/\r\n/g,`
`),typeof unescape=="function"&&typeof encodeURIComponent=="function")return unescape(encodeURIComponent(rt));for(nt=0;nt<ot;nt++)it=rt.charCodeAt(nt),it<128?st+=String.fromCharCode(it):it>127&&it<2048?(st+=String.fromCharCode(it>>6|192),st+=String.fromCharCode(63&it|128)):(st+=String.fromCharCode(it>>12|224),st+=String.fromCharCode(it>>6&63|128),st+=String.fromCharCode(63&it|128));return st},decode:function(rt){var nt,it,st,ot=0,lt=0,at=0,ct=[],ut=rt.length,ht=[];for(nt=0;nt<ut;nt++)it=rt.charCodeAt(nt),st=_e[it],lt=at!==0?63&it|lt<<6:255>>st&it,(at=_e[256+at+st])===0&&(lt>65535?ct.push(55232+(lt>>10),56320+(1023&lt)):ct.push(lt),++ot%1e4==0&&(ht.push(String.fromCharCode.apply(null,ct)),ct=[]));return ht.push(String.fromCharCode.apply(null,ct)),ht.join("")},asciiCharCodeAt:function(rt,nt){var it=rt.charCodeAt(nt);if(it>255)switch(it){case 8364:it=128;break;case 8218:it=130;break;case 402:it=131;break;case 8222:it=132;break;case 8230:it=133;break;case 8224:it=134;break;case 8225:it=135;break;case 710:it=136;break;case 8240:it=137;break;case 352:it=138;break;case 8249:it=139;break;case 338:it=140;break;case 381:it=142;break;case 8216:it=145;break;case 8217:it=146;break;case 8220:it=147;break;case 8221:it=148;break;case 8226:it=149;break;case 8211:it=150;break;case 8212:it=151;break;case 732:it=152;break;case 8482:it=153;break;case 353:it=154;break;case 8250:it=155;break;case 339:it=156;break;case 382:it=158;break;case 376:it=159}return it}},tt.Util.UTF8}),define("utils/base64",["jxg","utils/encoding"],function(tt,_e){function rt(st,ot){return 255&st.charCodeAt(ot)}function nt(st,ot){return it.indexOf(st.charAt(ot))}var it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return tt.Util=tt.Util||{},tt.Util.Base64={encode:function(st){var ot,lt,at,ct,ut,ht=[];for(ut=_e.encode(st),at=ut.length,ct=at%3,ot=0;ot<at-ct;ot+=3)lt=rt(ut,ot)<<16|rt(ut,ot+1)<<8|rt(ut,ot+2),ht.push(it.charAt(lt>>18),it.charAt(lt>>12&63),it.charAt(lt>>6&63),it.charAt(63&lt));switch(ct){case 1:lt=rt(ut,at-1),ht.push(it.charAt(lt>>2),it.charAt(lt<<4&63),"=","=");break;case 2:lt=rt(ut,at-2)<<8|rt(ut,at-1),ht.push(it.charAt(lt>>10),it.charAt(lt>>4&63),it.charAt(lt<<2&63),"=")}return ht.join("")},decode:function(st,ot){var lt,at,ct,ut,ht,dt,ft=[],pt=[];if(lt=st.replace(/[^A-Za-z0-9\+\/=]/g,""),(ct=lt.length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for(lt.charAt(ct-1)==="="&&(ut=1,lt.charAt(ct-2)==="="&&(ut=2),ct-=4),at=0;at<ct;at+=4)ht=nt(lt,at)<<18|nt(lt,at+1)<<12|nt(lt,at+2)<<6|nt(lt,at+3),pt.push(ht>>16,ht>>8&255,255&ht),at%1e4==0&&(ft.push(String.fromCharCode.apply(null,pt)),pt=[]);switch(ut){case 1:ht=nt(lt,ct)<<12|nt(lt,ct+1)<<6|nt(lt,ct+2),pt.push(ht>>10,ht>>2&255);break;case 2:ht=nt(lt,at)<<6|nt(lt,at+1),pt.push(ht>>4)}return ft.push(String.fromCharCode.apply(null,pt)),dt=ft.join(""),ot&&(dt=_e.decode(dt)),dt},decodeAsArray:function(st){var ot,lt=this.decode(st),at=[],ct=lt.length;for(ot=0;ot<ct;ot++)at[ot]=lt.charCodeAt(ot);return at}},tt.Util.Base64}),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],function(tt,_e,rt,nt){return tt.Server={modules:{},runningCalls:{},handleError:function(it){tt.debug("error occured, server says: "+it.message)},callServer:function(it,st,ot,lt){var at,ct,ut,ht,dt,ft,pt;lt=lt||!1,ht="";for(pt in ot)ot.hasOwnProperty(pt)&&(ht+="&"+escape(pt)+"="+escape(ot[pt]));ft=nt.toJSON(ot);do dt=it+Math.floor(4096*Math.random());while(nt.exists(this.runningCalls[dt]));return this.runningCalls[dt]={action:it},nt.exists(ot.module)&&(this.runningCalls[dt].module=ot.module),at=tt.serverBase+"JXGServer.py",ct="action="+escape(it)+"&id="+dt+"&dataJSON="+escape(rt.encode(ft)),this.cbp=function(mt){var gt,vt,At,yt,xt,_t,Et,bt;if(gt=new _e.Unzip(rt.decodeAsArray(mt)).unzip(),nt.isArray(gt)&&gt.length>0&&(gt=gt[0][0]),nt.exists(gt)){if(vt=window.JSON&&window.JSON.parse?window.JSON.parse(gt):new Function("return "+gt)(),vt.type==="error")this.handleError(vt);else if(vt.type==="response"){for(_t=vt.id,Et=0;Et<vt.fields.length;Et++)At=vt.fields[Et],yt=At.namespace+(typeof new Function("return "+At.namespace)()=="object"?".":".prototype.")+At.name+" = "+At.value,new Function(yt)();for(Et=0;Et<vt.handler.length;Et++){for(At=vt.handler[Et],xt=[],bt=0;bt<At.parameters.length;bt++)xt[bt]='"'+At.parameters[bt]+'": '+At.parameters[bt];yt="if(typeof JXG.Server.modules."+this.runningCalls[_t].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[_t].module+" = {};",yt+="JXG.Server.modules."+this.runningCalls[_t].module+"."+At.name+"_cb = "+At.callback+";",yt+="JXG.Server.modules."+this.runningCalls[_t].module+"."+At.name+" = function ("+At.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[_t].module+"."+At.name+"_cb;var __JXGSERVER_PAR__ = {"+xt.join(",")+', "module": "'+this.runningCalls[_t].module+'", "handler": "'+At.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(yt)()}delete this.runningCalls[_t],st(vt.data)}}},this.cb=tt.bind(this.cbp,this),window.XMLHttpRequest?(ut=new XMLHttpRequest,ut.overrideMimeType("text/plain; charset=iso-8859-1")):ut=new ActiveXObject("Microsoft.XMLHTTP"),!(!ut||(ut.open("POST",at,!lt),ut.setRequestHeader("Content-type","application/x-www-form-urlencoded"),lt||(ut.onreadystatechange=function(mt){return function(){return ut.readyState===4&&ut.status===200&&(mt(ut.responseText),!0)}}(this.cb)),ut.send(ct),!lt))&&(this.cb(ut.responseText),!0)},loadModule_cb:function(it){var st;for(st=0;st<it.length;st++)tt.debug(it[st].name+": "+it[st].value)},loadModule:function(it){return tt.Server.callServer("load",tt.Server.loadModule_cb,{module:it},!0)}},tt.Server.load=tt.Server.loadModule,tt.Server}),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],function(tt,_e,rt,nt,it,st){return rt.Symbolic={generateSymbolicCoordinatesPartial:function(ot,lt,at,ct){var ut,ht,dt,ft=lt.ancestors,pt=0,mt=function(gt){return ct==="underscore"?at+"_{"+gt+"}":ct==="brace"?at+"["+gt+"]":at+gt};ot.listOfFreePoints=[],ot.listOfDependantPoints=[];for(ht in ft)if(ft.hasOwnProperty(ht)&&(ut=0,st.isPoint(ft[ht]))){for(dt in ft[ht].ancestors)ft[ht].ancestors.hasOwnProperty(dt)&&ut++;ut===0?(ft[ht].symbolic.x=ft[ht].coords.usrCoords[1],ft[ht].symbolic.y=ft[ht].coords.usrCoords[2],ot.listOfFreePoints.push(ft[ht])):(pt+=1,ft[ht].symbolic.x=mt(pt),pt+=1,ft[ht].symbolic.y=mt(pt),ot.listOfDependantPoints.push(ft[ht]))}return st.isPoint(lt)&&(lt.symbolic.x="x",lt.symbolic.y="y"),pt},clearSymbolicCoordinates:function(ot){var lt=function(at){var ct,ut=at&&at.length||0;for(ct=0;ct<ut;ct++)st.isPoint(at[ct])&&(at[ct].symbolic.x="",at[ct].symbolic.y="")};lt(ot.listOfFreePoints),lt(ot.listOfDependantPoints),delete ot.listOfFreePoints,delete ot.listOfDependantPoints},generatePolynomials:function(ot,lt,at){var ct,ut,ht,dt,ft=lt.ancestors,pt=[],mt=[];at&&this.generateSymbolicCoordinatesPartial(ot,lt,"u","brace"),ft[lt.id]=lt;for(ct in ft)if(ft.hasOwnProperty(ct)&&(dt=0,pt=[],st.isPoint(ft[ct]))){for(ut in ft[ct].ancestors)ft[ct].ancestors.hasOwnProperty(ut)&&dt++;if(dt>0)for(pt=ft[ct].generatePolynomial(),ht=0;ht<pt.length;ht++)mt.push(pt[ht])}return at&&this.clearSymbolicCoordinates(ot),mt},geometricLocusByGroebnerBase:function(ot,lt){var at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t=ot.options.locus,Et={},bt=this.generateSymbolicCoordinatesPartial(ot,lt,"u","brace"),wt=new _e(tt.COORDS_BY_USR,[0,0],ot),Tt=new _e(tt.COORDS_BY_USR,[ot.canvasWidth,ot.canvasHeight],ot),Mt=1,Pt=0,It=0,Ot=0;if(it.modules.geoloci===void 0&&it.loadModule("geoloci"),it.modules.geoloci===void 0)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(pt=wt.usrCoords[1],mt=Tt.usrCoords[1],gt=Tt.usrCoords[2],vt=wt.usrCoords[2],_t.translateToOrigin&&ot.listOfFreePoints.length>0){for(ht=_t.toOrigin!==void 0&&_t.toOrigin!==null&&st.isInArray(ot.listOfFreePoints,_t.toOrigin.id)?_t.toOrigin:ot.listOfFreePoints[0],Pt=ht.symbolic.x,It=ht.symbolic.y,ft=0;ft<ot.listOfFreePoints.length;ft++)ot.listOfFreePoints[ft].symbolic.x-=Pt,ot.listOfFreePoints[ft].symbolic.y-=It;if(pt-=Pt,mt-=Pt,gt-=It,vt-=It,_t.translateTo10&&ot.listOfFreePoints.length>1){for(dt=_t.to10!==void 0&&_t.to10!==null&&_t.to10.id!==_t.toOrigin.id&&st.isInArray(ot.listOfFreePoints,_t.to10.id)?_t.to10:ot.listOfFreePoints[0].id===ht.id?ot.listOfFreePoints[1]:ot.listOfFreePoints[0],Ot=nt.rad([1,0],[0,0],[dt.symbolic.x,dt.symbolic.y]),At=Math.cos(-Ot),yt=Math.sin(-Ot),ft=0;ft<ot.listOfFreePoints.length;ft++)xt=ot.listOfFreePoints[ft].symbolic.x,ot.listOfFreePoints[ft].symbolic.x=At*ot.listOfFreePoints[ft].symbolic.x-yt*ot.listOfFreePoints[ft].symbolic.y,ot.listOfFreePoints[ft].symbolic.y=yt*xt+At*ot.listOfFreePoints[ft].symbolic.y;if(dt.symbolic.y=0,xt=pt,pt=At*pt-yt*gt,gt=yt*xt+At*gt,xt=mt,mt=At*mt-yt*vt,vt=yt*xt+At*vt,_t.stretch&&Math.abs(dt.symbolic.x)>rt.eps){for(Mt=dt.symbolic.x,ft=0;ft<ot.listOfFreePoints.length;ft++)ot.listOfFreePoints[ft].symbolic.x/=Mt,ot.listOfFreePoints[ft].symbolic.y/=Mt;for(ft=0;ft<ot.objectsList.length;ft++)ot.objectsList[ft].elementClass===tt.OBJECT_CLASS_CIRCLE&&ot.objectsList[ft].method==="pointRadius"&&(Et[ft]=ot.objectsList[ft].radius,ot.objectsList[ft].radius/=Mt);pt/=Mt,mt/=Mt,gt/=Mt,vt/=Mt,dt.symbolic.x=1}}for(ft=0;ft<ot.listOfFreePoints.length;ft++)xt=ot.listOfFreePoints[ft].symbolic.x,Math.abs(xt)<rt.eps&&(ot.listOfFreePoints[ft].symbolic.x=0),Math.abs(xt-Math.round(xt))<rt.eps&&(ot.listOfFreePoints[ft].symbolic.x=Math.round(xt)),xt=ot.listOfFreePoints[ft].symbolic.y,Math.abs(xt)<rt.eps&&(ot.listOfFreePoints[ft].symbolic.y=0),Math.abs(xt-Math.round(xt))<rt.eps&&(ot.listOfFreePoints[ft].symbolic.y=Math.round(xt))}at=this.generatePolynomials(ot,lt),ct=at.join(","),this.cbp=function(Bt){ut=Bt},this.cb=st.bind(this.cbp,this),it.modules.geoloci.lociCoCoA(pt,mt,gt,vt,bt,ct,Mt,Ot,Pt,It,this.cb,!0),this.clearSymbolicCoordinates(ot);for(ft in Et)Et.hasOwnProperty(ft)&&(ot.objects[ft].radius=Et[ft]);return ut}},rt.Symbolic}),define("math/poly",["jxg","math/math","utils/type"],function(tt,_e,rt){return _e.Poly={},_e.Poly.Ring=function(nt){this.vars=nt},tt.extend(_e.Poly.Ring.prototype,{}),_e.Poly.Monomial=function(nt,it,st){var ot;if(!rt.exists(nt))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(rt.isArray(st)||(st=[]),st=st.slice(0,nt.vars.length),ot=st.length;ot<nt.vars.length;ot++)st.push(0);this.ring=nt,this.coefficient=it||0,this.exponents=rt.deepCopy(st)},tt.extend(_e.Poly.Monomial.prototype,{copy:function(){return new _e.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var nt,it=[];for(nt=0;nt<this.ring.vars.length;nt++)it.push(this.ring.vars[nt]+"^"+this.exponents[nt]);return this.coefficient+"*"+it.join("*")}}),_e.Poly.Polynomial=function(nt,it){var st;if(!rt.exists(nt))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");st=rt.exists(it)&&rt.isString(it)?void 0:[],this.ring=nt,this.monomials=st},tt.extend(_e.Poly.Polynomial.prototype,{findSignature:function(nt){var it;for(it=0;it<this.monomials.length;it++)if(rt.cmpArrays(this.monomials[it].exponents,nt))return it;return-1},addSubMonomial:function(nt,it){var st;st=this.findSignature(nt.exponents),st>-1?this.monomials[st].coefficient+=it*nt.coefficient:(nt.coefficient*=it,this.monomials.push(nt))},add:function(nt){var it;if(!rt.exists(nt)||nt.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(rt.isArray(nt.exponents))this.addSubMonomial(nt,1);else for(it=0;it<nt.monomials.length;it++)this.addSubMonomial(nt.monomials[it],1)},sub:function(nt){var it;if(!rt.exists(nt)||nt.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(rt.isArray(nt.exponents))this.addSubMonomial(nt,-1);else for(it=0;it<nt.monomials.length;it++)this.addSubMonomial(nt.monomials[it],-1)},copy:function(){var nt,it;for(it=new _e.Poly.Polynomial(this.ring),nt=0;nt<this.monomials.length;nt++)it.monomials.push(this.monomials[nt].copy());return it},print:function(){var nt,it=[];for(nt=0;nt<this.monomials.length;nt++)it.push("("+this.monomials[nt].print()+")");return it.join("+")}}),_e.Poly}),define("math/complex",["jxg","utils/type"],function(tt,_e){return tt.Complex=function(rt,nt){this.isComplex=!0,rt&&rt.isComplex&&(nt=rt.imaginary,rt=rt.real),this.real=rt||0,this.imaginary=nt||0,this.absval=0,this.angle=0},tt.extend(tt.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(rt){return _e.isNumber(rt)?this.real+=rt:(this.real+=rt.real,this.imaginary+=rt.imaginary),this},sub:function(rt){return _e.isNumber(rt)?this.real-=rt:(this.real-=rt.real,this.imaginary-=rt.imaginary),this},mult:function(rt){var nt,it;return _e.isNumber(rt)?(this.real*=rt,this.imaginary*=rt):(nt=this.real,it=this.imaginary,this.real=nt*rt.real-it*rt.imaginary,this.imaginary=nt*rt.imaginary+it*rt.real),this},div:function(rt){var nt,it,st;if(_e.isNumber(rt)){if(Math.abs(rt)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=rt,this.imaginary/=rt}else{if(Math.abs(rt.real)<Math.eps&&Math.abs(rt.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;nt=rt.real*rt.real+rt.imaginary*rt.imaginary,st=this.real,it=this.imaginary,this.real=(st*rt.real+it*rt.imaginary)/nt,this.imaginary=(it*rt.real-st*rt.imaginary)/nt}return this},conj:function(){return this.imaginary*=-1,this}}),tt.C={},tt.C.add=function(rt,nt){var it=new tt.Complex(rt);return it.add(nt),it},tt.C.sub=function(rt,nt){var it=new tt.Complex(rt);return it.sub(nt),it},tt.C.mult=function(rt,nt){var it=new tt.Complex(rt);return it.mult(nt),it},tt.C.div=function(rt,nt){var it=new tt.Complex(rt);return it.div(nt),it},tt.C.conj=function(rt){var nt=new tt.Complex(rt);return nt.conj(),nt},tt.C.abs=function(rt){var nt=new tt.Complex(rt);return nt.conj(),nt.mult(rt),Math.sqrt(nt.real)},tt.Complex.C=tt.C,tt.Complex}),define("utils/color",["jxg","utils/type","math/math"],function(tt,_e,rt){var nt={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},it=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(st){return[parseInt(st[1],10),parseInt(st[2],10),parseInt(st[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(st){return[parseInt(st[1],10),parseInt(st[2],10),parseInt(st[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(st){return[parseInt(st[1],16),parseInt(st[2],16),parseInt(st[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(st){return[parseInt(st[1]+st[1],16),parseInt(st[2]+st[2],16),parseInt(st[3]+st[3],16)]}}];return tt.rgbParser=function(st,ot,lt){var at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At=st;if(!_e.exists(st))return[];if(_e.exists(ot)&&_e.exists(lt)&&(At=[st,ot,lt]),at=At,vt=!1,_e.isArray(at)){for(ft=0;ft<3;ft++)vt=vt||/\./.test(At[ft].toString());for(ft=0;ft<3;ft++)vt=vt&&At[ft]>=0&&At[ft]<=1;return vt?[Math.ceil(255*At[0]),Math.ceil(255*At[1]),Math.ceil(255*At[2])]:At}for(typeof At=="string"&&(at=At),at.charAt(0)==="#"&&(at=at.substr(1,6)),at=at.replace(/ /g,"").toLowerCase(),at=nt[at]||at,ft=0;ft<it.length;ft++)ut=it[ft].re,ht=it[ft].process,(dt=ut.exec(at))&&(ct=ht(dt),pt=ct[0],mt=ct[1],gt=ct[2]);return isNaN(pt)||isNaN(mt)||isNaN(gt)?[]:(pt=pt<0||isNaN(pt)?0:pt>255?255:pt,mt=mt<0||isNaN(mt)?0:mt>255?255:mt,gt=gt<0||isNaN(gt)?0:gt>255?255:gt,[pt,mt,gt])},tt.rgb2css=function(st,ot,lt){var at;return at=tt.rgbParser(st,ot,lt),"rgb("+at[0]+", "+at[1]+", "+at[2]+")"},tt.rgb2hex=function(st,ot,lt){var at,ct,ut;return at=tt.rgbParser(st,ot,lt),ct=at[1],ut=at[2],at=at[0],at=at.toString(16),ct=ct.toString(16),ut=ut.toString(16),at.length===1&&(at="0"+at),ct.length===1&&(ct="0"+ct),ut.length===1&&(ut="0"+ut),"#"+at+ct+ut},tt.hex2rgb=function(st){return tt.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),tt.rgb2css(st)},tt.hsv2rgb=function(st,ot,lt){var at,ct,ut,ht,dt,ft,pt,mt,gt;if(st=(st%360+360)%360,ot===0){if(!(isNaN(st)||st<rt.eps))return"#ffffff";at=lt,ct=lt,ut=lt}else switch(ft=st>=360?0:st,ft/=60,dt=Math.floor(ft),ht=ft-dt,pt=lt*(1-ot),mt=lt*(1-ot*ht),gt=lt*(1-ot*(1-ht)),dt){case 0:at=lt,ct=gt,ut=pt;break;case 1:at=mt,ct=lt,ut=pt;break;case 2:at=pt,ct=lt,ut=gt;break;case 3:at=pt,ct=mt,ut=lt;break;case 4:at=gt,ct=pt,ut=lt;break;case 5:at=lt,ct=pt,ut=mt}return at=Math.round(255*at).toString(16),at=at.length===2?at:at.length===1?"0"+at:"00",ct=Math.round(255*ct).toString(16),ct=ct.length===2?ct:ct.length===1?"0"+ct:"00",ut=Math.round(255*ut).toString(16),ut=ut.length===2?ut:ut.length===1?"0"+ut:"00",["#",at,ct,ut].join("")},tt.rgb2hsv=function(st,ot,lt){var at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt;return at=tt.rgbParser(st,ot,lt),ct=at[1],ut=at[2],at=at[0],ht=at/255,dt=ct/255,ft=ut/255,yt=Math.max(at,ct,ut),xt=Math.min(at,ct,ut),pt=yt/255,mt=xt/255,At=pt,vt=0,At>0&&(vt=(At-mt)/At),gt=1/(pt-mt),vt>0&&(yt===at?gt*=dt-ft:gt=yt===ct?2+(ft-ht)*gt:4+(ht-dt)*gt),gt*=60,gt<0&&(gt+=360),yt===xt&&(gt=0),[gt,vt,At]},tt.rgb2LMS=function(st,ot,lt){var at,ct,ut,ht,dt,ft,pt,mt=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return at=tt.rgbParser(st,ot,lt),ct=at[1],ut=at[2],at=at[0],at=Math.pow(at,.476190476),ct=Math.pow(ct,.476190476),ut=Math.pow(ut,.476190476),ht=at*mt[0][0]+ct*mt[0][1]+ut*mt[0][2],dt=at*mt[1][0]+ct*mt[1][1]+ut*mt[1][2],ft=at*mt[2][0]+ct*mt[2][1]+ut*mt[2][2],pt=[ht,dt,ft],pt.l=ht,pt.m=dt,pt.s=ft,pt},tt.LMS2rgb=function(st,ot,lt){var at,ct,ut,ht,dt=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],ft=function(pt){for(var mt=127,gt=64;gt>0;){if(Math.pow(mt,.476190476)>pt)mt-=gt;else{if(Math.pow(mt+1,.476190476)>pt)return mt;mt+=gt}gt/=2}return mt===254&&13.994955247<pt?255:mt};return at=st*dt[0][0]+ot*dt[0][1]+lt*dt[0][2],ct=st*dt[1][0]+ot*dt[1][1]+lt*dt[1][2],ut=st*dt[2][0]+ot*dt[2][1]+lt*dt[2][2],at=ft(at),ct=ft(ct),ut=ft(ut),ht=[at,ct,ut],ht.r=at,ht.g=ct,ht.b=ut,ht},tt.rgba2rgbo=function(st){var ot;return st.length===9&&st.charAt(0)==="#"?(ot=parseInt(st.substr(7,2).toUpperCase(),16)/255,st=st.substr(0,7)):ot=1,[st,ot]},tt.rgbo2rgba=function(st,ot){var lt;return st==="none"?st:(lt=Math.round(255*ot).toString(16),lt.length===1&&(lt="0"+lt),st+lt)},tt.rgb2bw=function(st){var ot,lt,at,ct="0123456789ABCDEF";return st==="none"?st:(at=tt.rgbParser(st),ot=Math.floor(.3*at[0]+.59*at[1]+.11*at[2]),lt=ct.charAt(ot>>4&15)+ct.charAt(15&ot),st="#"+lt+lt+lt)},tt.rgb2cb=function(st,ot){var lt,at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt="0123456789ABCDEF";if(st==="none")return st;switch(ht=tt.rgb2LMS(st),at=ht[0],ct=ht[1],ut=ht[2],ot=ot.toLowerCase()){case"protanopia":ft=-.06150039994295001,pt=.08277001656812001,mt=-.013200141220000003,gt=.05858939668799999,vt=-.07934519995360001,At=.013289415272000003,yt=.6903216543277437,dt=ut/ct,at=dt<yt?-(pt*ct+mt*ut)/ft:-(vt*ct+At*ut)/gt;break;case"tritanopia":ft=-.00058973116217,pt=.007690316482,mt=-.01011703519052,gt=.025495080838999994,vt=-.0422740347,At=.017005316784,yt=.8349489908460004,dt=ct/at,ut=dt<yt?-(ft*at+pt*ct)/mt:-(gt*at+vt*ct)/At;break;default:ft=-.06150039994295001,pt=.08277001656812001,mt=-.013200141220000003,gt=.05858939668799999,vt=-.07934519995360001,At=.013289415272000003,yt=.5763833686400911,dt=ut/at,ct=dt<yt?-(ft*at+mt*ut)/pt:-(gt*at+At*ut)/vt}return lt=tt.LMS2rgb(at,ct,ut),dt=xt.charAt(lt[0]>>4&15)+xt.charAt(15&lt[0]),st="#"+dt,dt=xt.charAt(lt[1]>>4&15)+xt.charAt(15&lt[1]),st+=dt,dt=xt.charAt(lt[2]>>4&15)+xt.charAt(15&lt[2]),st+=dt},tt.autoHighlight=function(st){var ot=tt.rgba2rgbo(st),lt=ot[0],at=ot[1];return st.charAt(0)==="#"?(at*=at<.3?1.8:.4,tt.rgbo2rgba(lt,at)):st},tt}),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],function(tt,_e,rt,nt,it){return tt.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],zoomFactor:1,zoomX:1,zoomY:1,showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"⌘",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,registerEvents:!0,minimizeReflow:"svg",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1}},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888",visible:"inherit",includeBoundaries:!1},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",strokeWidth:2,strokeColor:"blue",ticksDistance:.2},precision:{touch:15,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"},arc:{visible:!1}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1,center:{},radiuspoint:{},anglepoint:{}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},button:{disabled:!1},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:13,doAdvancedPlotOld:!1,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"black",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},inequality:{fillColor:"red",fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"black",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"black",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1,visible:"inherit"},label:{offset:[0,0]}},prescribedangle:{anglepoint:{size:2,visible:!1,withLabel:!1}},regularpolygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiuspoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglepoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,fixed:!0,scalable:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,precision:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,fixed:!0,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"black",highlightStrokeColor:"black",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},tt.Validator=function(){var st,ot=function(vt){return/^[0-9]+px$/.test(vt)},lt=function(vt){return vt==="html"||vt==="internal"},at=function(vt){return it.isString(vt)},ct=function(vt){return it.exists(tt.normalizePointFace(vt))},ut=function(vt){return Math.abs(vt-Math.round(vt))<rt.eps},ht=function(vt){return ut(vt)&&vt>0},dt=function(vt){return vt==="vml"||vt==="svg"||vt==="canvas"||vt==="no"},ft=function(vt){return vt>0},pt=function(vt){return vt>=0},mt={},gt={attractorDistance:pt,color:at,defaultDistance:it.isNumber,display:lt,doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:ct,factor:it.isNumber,fillColor:at,fillOpacity:it.isNumber,firstArrow:!1,fontSize:ut,dash:ut,gridX:it.isNumber,gridY:it.isNumber,hasGrid:!1,highlightFillColor:at,highlightFillOpacity:it.isNumber,highlightStrokeColor:at,highlightStrokeOpacity:it.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:ut,minorHeight:ut,minorTicks:pt,minTicksDistance:ht,numberPointsHigh:ht,numberPointsLow:ht,opacity:it.isNumber,radius:it.isNumber,RDPsmoothing:!1,renderer:dt,right:ot,showCopyright:!1,showInfobox:!1,showNavigation:!1,size:ut,snapSizeX:ft,snapSizeY:ft,snapWidth:it.isNumber,snapToGrid:!1,snatchDistance:pt,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:at,strokeOpacity:it.isNumber,strokeWidth:ut,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(st in gt)gt.hasOwnProperty(st)&&(mt[st.toLowerCase()]=gt[st]);return mt}(),tt.normalizePointFace=function(st){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[st]},tt.useStandardOptions=function(st){var ot,lt,at,ct,ut=tt.Options,ht=st.hasGrid;st.options.grid.hasGrid=ut.grid.hasGrid,st.options.grid.gridX=ut.grid.gridX,st.options.grid.gridY=ut.grid.gridY,st.options.grid.gridColor=ut.grid.gridColor,st.options.grid.gridOpacity=ut.grid.gridOpacity,st.options.grid.gridDash=ut.grid.gridDash,st.options.grid.snapToGrid=ut.grid.snapToGrid,st.options.grid.snapSizeX=ut.grid.SnapSizeX,st.options.grid.snapSizeY=ut.grid.SnapSizeY,st.takeSizeFromFile=ut.takeSizeFromFile,ct=function(dt,ft){dt.visProp.fillcolor=ft.fillColor,dt.visProp.highlightfillcolor=ft.highlightFillColor,dt.visProp.strokecolor=ft.strokeColor,dt.visProp.highlightstrokecolor=ft.highlightStrokeColor};for(ot in st.objects)if(st.objects.hasOwnProperty(ot))if(at=st.objects[ot],at.elementClass===_e.OBJECT_CLASS_POINT)ct(at,ut.point);else if(at.elementClass===_e.OBJECT_CLASS_LINE)for(ct(at,ut.line),lt=0;lt<at.ticks.length;lt++)at.ticks[lt].majorTicks=ut.line.ticks.majorTicks,at.ticks[lt].minTicksDistance=ut.line.ticks.minTicksDistance,at.ticks[lt].visProp.minorheight=ut.line.ticks.minorHeight,at.ticks[lt].visProp.majorheight=ut.line.ticks.majorHeight;else at.elementClass===_e.OBJECT_CLASS_CIRCLE?ct(at,ut.circle):at.type===_e.OBJECT_TYPE_ANGLE?ct(at,ut.angle):at.type===_e.OBJECT_TYPE_ARC?ct(at,ut.arc):at.type===_e.OBJECT_TYPE_POLYGON?ct(at,ut.polygon):at.type===_e.OBJECT_TYPE_CONIC?ct(at,ut.conic):at.type===_e.OBJECT_TYPE_CURVE?ct(at,ut.curve):at.type===_e.OBJECT_TYPE_SECTOR&&(at.arc.visProp.fillcolor=ut.sector.fillColor,at.arc.visProp.highlightfillcolor=ut.sector.highlightFillColor,at.arc.visProp.fillopacity=ut.sector.fillOpacity,at.arc.visProp.highlightfillopacity=ut.sector.highlightFillOpacity);st.fullUpdate(),ht&&!st.hasGrid?st.removeGrids(st):!ht&&st.hasGrid&&st.create("grid",[])},tt.useBlackWhiteOptions=function(st){var ot=tt.Options;ot.point.fillColor=nt.rgb2bw(ot.point.fillColor),ot.point.highlightFillColor=nt.rgb2bw(ot.point.highlightFillColor),ot.point.strokeColor=nt.rgb2bw(ot.point.strokeColor),ot.point.highlightStrokeColor=nt.rgb2bw(ot.point.highlightStrokeColor),ot.line.fillColor=nt.rgb2bw(ot.line.fillColor),ot.line.highlightFillColor=nt.rgb2bw(ot.line.highlightFillColor),ot.line.strokeColor=nt.rgb2bw(ot.line.strokeColor),ot.line.highlightStrokeColor=nt.rgb2bw(ot.line.highlightStrokeColor),ot.circle.fillColor=nt.rgb2bw(ot.circle.fillColor),ot.circle.highlightFillColor=nt.rgb2bw(ot.circle.highlightFillColor),ot.circle.strokeColor=nt.rgb2bw(ot.circle.strokeColor),ot.circle.highlightStrokeColor=nt.rgb2bw(ot.circle.highlightStrokeColor),ot.arc.fillColor=nt.rgb2bw(ot.arc.fillColor),ot.arc.highlightFillColor=nt.rgb2bw(ot.arc.highlightFillColor),ot.arc.strokeColor=nt.rgb2bw(ot.arc.strokeColor),ot.arc.highlightStrokeColor=nt.rgb2bw(ot.arc.highlightStrokeColor),ot.polygon.fillColor=nt.rgb2bw(ot.polygon.fillColor),ot.polygon.highlightFillColor=nt.rgb2bw(ot.polygon.highlightFillColor),ot.sector.fillColor=nt.rgb2bw(ot.sector.fillColor),ot.sector.highlightFillColor=nt.rgb2bw(ot.sector.highlightFillColor),ot.curve.strokeColor=nt.rgb2bw(ot.curve.strokeColor),ot.grid.gridColor=nt.rgb2bw(ot.grid.gridColor),tt.useStandardOptions(st)},tt.Options.normalizePointFace=tt.normalizePointFace,tt.Options}),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],function(tt,_e,rt,nt,it,st,ot,lt){return tt.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},tt.extend(tt.AbstractRenderer.prototype,{_updateVisual:function(at,ct,ut){(ut||this.enhancedRendering)&&(ct=ct||{},this.setObjectTransition(at),ot.evaluate(at.visProp.draft)?this.setDraft(at):(ct.stroke||(at.highlighted?(this.setObjectStrokeColor(at,at.visProp.highlightstrokecolor,at.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(at,at.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(at,at.visProp.strokecolor,at.visProp.strokeopacity),this.setObjectStrokeWidth(at,at.visProp.strokewidth))),ct.fill||(at.highlighted?this.setObjectFillColor(at,at.visProp.highlightfillcolor,at.visProp.highlightfillopacity):this.setObjectFillColor(at,at.visProp.fillcolor,at.visProp.fillopacity)),ct.dash||this.setDashStyle(at,at.visProp),ct.shadow||this.setShadow(at),ct.gradient||this.setShadow(at)))},drawPoint:function(at){var ct,ut=_e.normalizePointFace(ot.evaluate(at.visProp.face));ct=ut==="o"?"ellipse":ut==="[]"?"rect":"path",at.rendNode=this.appendChildPrim(this.createPrim(ct,at.id),ot.evaluate(at.visProp.layer)),this.appendNodesToElement(at,ct),this._updateVisual(at,{dash:!0,shadow:!0},!0),this.updatePoint(at)},updatePoint:function(at){var ct,ut=ot.evaluate(at.visProp.size),ht=_e.normalizePointFace(ot.evaluate(at.visProp.face)),dt=ot.evaluate(at.visProp.sizeunit),ft=ot.evaluate(at.visProp.zoom);isNaN(at.coords.scrCoords[2]+at.coords.scrCoords[1])||(dt==="user"&&(ut*=Math.sqrt(at.board.unitX*at.board.unitY)),ut*=at.board&&ft?Math.sqrt(at.board.zoomX*at.board.zoomY):1,ct=ut===0?0:ut+1,ht==="o"?this.updateEllipsePrim(at.rendNode,at.coords.scrCoords[1],at.coords.scrCoords[2],ct,ct):ht==="[]"?this.updateRectPrim(at.rendNode,at.coords.scrCoords[1]-ut,at.coords.scrCoords[2]-ut,2*ut,2*ut):this.updatePathPrim(at.rendNode,this.updatePathStringPoint(at,ut,ht),at.board),this._updateVisual(at,{dash:!1,shadow:!1}),this.setShadow(at))},changePointStyle:function(at){var ct=this.getElementById(at.id);ot.exists(ct)&&this.remove(ct),this.drawPoint(at),ot.clearVisPropOld(at),at.visPropCalc.visible||this.hide(at),ot.evaluate(at.visProp.draft)&&this.setDraft(at)},drawLine:function(at){at.rendNode=this.appendChildPrim(this.createPrim("line",at.id),ot.evaluate(at.visProp.layer)),this.appendNodesToElement(at,"lines"),this.updateLine(at)},updateLineEndings:function(at,ct){var ut,ht=new rt(nt.COORDS_BY_USER,at.point1.coords.usrCoords,at.board),dt=new rt(nt.COORDS_BY_USER,at.point2.coords.usrCoords,at.board),ft=null;return ft=ot.evaluate(at.visProp.margin),st.calcStraight(at,ht,dt,ft),ut=this.getPositionArrowHead(at,ht,dt,ct),this.updateLinePrim(at.rendNode,ut.c1.scrCoords[1]+ut.d1x,ut.c1.scrCoords[2]+ut.d1y,ut.c2.scrCoords[1]-ut.d2x,ut.c2.scrCoords[2]-ut.d2y,at.board),ut},updateArrowSize:function(at,ct){var ut,ht,dt;return ht=ot.evaluate(at.visProp.firstarrow),ht&&(ut=ot.exists(ht.size)?ot.evaluate(ht.size):3,this._setArrowWidth(at.rendNodeTriangleStart,ct.sFirst,at.rendNode,ut)),dt=ot.evaluate(at.visProp.lastarrow),dt&&(ut=ot.exists(dt.size)?ot.evaluate(dt.size):3,this._setArrowWidth(at.rendNodeTriangleEnd,ct.sLast,at.rendNode,ut)),this},updateLine:function(at){var ct;ct=this.updateLineEndings(at,ot.evaluate(at.visProp.strokewidth)),this.makeArrows(at),this._updateVisual(at),this.updateArrowSize(at,ct),this.setLineCap(at)},getPositionArrowHead:function(at,ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt=it.eps,wt=0,Tt=0,Mt=ot.evaluate(at.visProp.firstarrow),Pt=ot.evaluate(at.visProp.lastarrow);return gt=vt=At=yt=0,(Mt||Pt)&&(ft=ot.evaluate(at.point1.visProp.size)+ot.evaluate(at.point1.visProp.strokewidth),pt=ot.evaluate(at.point2.visProp.size)+ot.evaluate(at.point2.visProp.strokewidth),dt=ft+pt,Pt&&ot.evaluate(at.visProp.touchlastpoint)&&(mt=ct.distance(nt.COORDS_BY_SCREEN,ut))>dt&&(At=(ut.scrCoords[1]-ct.scrCoords[1])*pt/mt,yt=(ut.scrCoords[2]-ct.scrCoords[2])*pt/mt,ut=new rt(nt.COORDS_BY_SCREEN,[ut.scrCoords[1]-At,ut.scrCoords[2]-yt],at.board)),Mt&&ot.evaluate(at.visProp.touchfirstpoint)&&(mt=ct.distance(nt.COORDS_BY_SCREEN,ut))>dt&&(gt=(ut.scrCoords[1]-ct.scrCoords[1])*ft/mt,vt=(ut.scrCoords[2]-ct.scrCoords[2])*ft/mt,ct=new rt(nt.COORDS_BY_SCREEN,[ct.scrCoords[1]+gt,ct.scrCoords[2]+vt],at.board)),gt=vt=At=yt=0,mt=ct.distance(nt.COORDS_BY_SCREEN,ut),ot.exists(Mt.type)&&(xt=ot.evaluate(Mt.type)),ot.exists(Pt.type)&&(_t=ot.evaluate(Pt.type)),Mt&&(Et=ot.exists(Mt.size)?ot.evaluate(Mt.size):3,wt=ht*Et,xt===2?(wt*=.5,bt+=ht*Et):xt===3?(wt=ht,bt+=ht):bt+=ht*Et),Pt&&(Et=ot.exists(Pt.size)?ot.evaluate(Pt.size):3,Tt=ht*Et,_t===2?(Tt*=.5,bt+=ht*Et):_t===3?(Tt=ht,bt+=ht):bt+=ht*Et),Mt&&at.board.renderer.type!=="vml"&&(mt>=bt?(gt=(ut.scrCoords[1]-ct.scrCoords[1])*wt/mt,vt=(ut.scrCoords[2]-ct.scrCoords[2])*wt/mt):wt=0),Pt&&at.board.renderer.type!=="vml"&&(mt>=bt?(At=(ut.scrCoords[1]-ct.scrCoords[1])*Tt/mt,yt=(ut.scrCoords[2]-ct.scrCoords[2])*Tt/mt):Tt=0)),{c1:ct,c2:ut,d1x:gt,d1y:vt,d2x:At,d2y:yt,sFirst:wt,sLast:Tt}},setLineCap:function(at){},drawTicks:function(at){at.rendNode=this.appendChildPrim(this.createPrim("path",at.id),ot.evaluate(at.visProp.layer)),this.appendNodesToElement(at,"path")},updateTicks:function(at){},drawCurve:function(at){at.rendNode=this.appendChildPrim(this.createPrim("path",at.id),ot.evaluate(at.visProp.layer)),this.appendNodesToElement(at,"path"),at.numberPoints>1&&this.makeArrows(at),this._updateVisual(at,{shadow:!0},!0),this.updateCurve(at)},updateCurve:function(at){var ct,ut,ht,dt=ot.evaluate(at.visProp.strokewidth);ot.evaluate(at.visProp.handdrawing)?this.updatePathPrim(at.rendNode,this.updatePathStringBezierPrim(at),at.board):this.updatePathPrim(at.rendNode,this.updatePathStringPrim(at),at.board),at.numberPoints>1&&(this.makeArrows(at),ut=ot.evaluate(at.visProp.firstarrow),ut&&(ct=ot.exists(ut.size)?ot.evaluate(ut.size):3,this._setArrowWidth(at.rendNodeTriangleStart,dt,at.rendNode,ct)),(ht=ot.evaluate(at.visProp.lastarrow))&&(ct=ot.exists(ht.size)?ot.evaluate(ht.size):3,this._setArrowWidth(at.rendNodeTriangleEnd,dt,at.rendNode,ct))),this._updateVisual(at)},drawEllipse:function(at){at.rendNode=this.appendChildPrim(this.createPrim("ellipse",at.id),ot.evaluate(at.visProp.layer)),this.appendNodesToElement(at,"ellipse"),this.updateEllipse(at)},updateEllipse:function(at){this._updateVisual(at);var ct=at.Radius();ct>0&&Math.abs(at.center.coords.usrCoords[0])>it.eps&&!isNaN(ct+at.center.coords.scrCoords[1]+at.center.coords.scrCoords[2])&&ct*at.board.unitX<2e6&&this.updateEllipsePrim(at.rendNode,at.center.coords.scrCoords[1],at.center.coords.scrCoords[2],ct*at.board.unitX,ct*at.board.unitY)},drawPolygon:function(at){at.rendNode=this.appendChildPrim(this.createPrim("polygon",at.id),ot.evaluate(at.visProp.layer)),this.appendNodesToElement(at,"polygon"),this.updatePolygon(at)},updatePolygon:function(at){this._updateVisual(at,{stroke:!0,dash:!0}),this.updatePolygonPrim(at.rendNode,at)},displayCopyright:function(at,ct){},drawInternalText:function(at){},updateInternalText:function(at){},drawText:function(at){var ct,ut,ht;ot.evaluate(at.visProp.display)==="html"&&lt.isBrowser&&this.type!=="no"?(ct=this.container.ownerDocument.createElement("div"),ct.style.position="absolute",ct.className=ot.evaluate(at.visProp.cssclass),ht=ot.evaluate(at.visProp.layer),ot.exists(ht)||(ht=0),ut=this.container.style.zIndex===""?0:parseInt(this.container.style.zIndex,10),ct.style.zIndex=ut+ht,this.container.appendChild(ct),ct.setAttribute("id",this.container.id+"_"+at.id)):ct=this.drawInternalText(at),at.rendNode=ct,at.htmlStr="",this.updateText(at)},updateText:function(at){var ct,ut,ht,dt,ft,pt=at.plaintext;if(at.visPropCalc.visible)if(this.updateTextStyle(at,!1),ot.evaluate(at.visProp.display)==="html"&&this.type!=="no"){if(isNaN(at.coords.scrCoords[1]+at.coords.scrCoords[2])||(ut=at.coords.scrCoords[1],ut=Math.abs(ut)<1e6?ut:1e6,dt=at.getAnchorX(),ct=Math.floor(dt==="right"?at.board.canvasWidth-ut:dt==="middle"?ut-.5*at.size[0]:ut),at.visPropOld.left!==dt+ct&&(dt==="right"?(at.rendNode.style.right=ct+"px",at.rendNode.style.left="auto"):(at.rendNode.style.left=ct+"px",at.rendNode.style.right="auto"),at.visPropOld.left=dt+ct),ut=at.coords.scrCoords[2]+this.vOffsetText,ut=Math.abs(ut)<1e6?ut:1e6,ft=at.getAnchorY(),ct=Math.floor(ft==="bottom"?at.board.canvasHeight-ut:ft==="middle"?ut-.5*at.size[1]:ut),at.visPropOld.top!==ft+ct&&(ft==="bottom"?(at.rendNode.style.top="auto",at.rendNode.style.bottom=ct+"px"):(at.rendNode.style.bottom="auto",at.rendNode.style.top=ct+"px"),at.visPropOld.top=ft+ct)),at.htmlStr!==pt){try{at.rendNode.innerHTML=pt}catch{ht=at.rendNode.parentNode,at.rendNode.parentNode.removeChild(at.rendNode),at.rendNode.innerHTML=pt,ht.appendChild(at.rendNode)}if(at.htmlStr=pt,ot.evaluate(at.visProp.usemathjax))try{MathJax.Hub.Queue(["Typeset",MathJax.Hub,at.rendNode])}catch{tt.debug("MathJax (not yet) loaded")}else if(ot.evaluate(at.visProp.useasciimathml))try{AMprocessNode(at.rendNode,!1)}catch{tt.debug("AsciiMathML (not yet) loaded")}}this.transformImage(at,at.transformations)}else this.updateInternalText(at)},_css2js:function(at){var ct,ut,ht,dt,ft,pt=[],mt=ot.trim(at).replace(/;$/,"").split(";");for(ut=mt.length,ct=0;ct<ut;++ct)ot.trim(mt[ct])!==""&&(ft=mt[ct].split(":"),ht=ot.trim(ft[0].replace(/-([a-z])/gi,function(gt,vt){return vt.toUpperCase()})),dt=ot.trim(ft[1]),pt.push({key:ht,val:dt}));return pt},updateTextStyle:function(at,ct){var ut,ht,dt,ft,pt,mt,gt,vt,At,yt=at.visProp,xt=lt.isBrowser?yt.display:"internal",_t=["rendNode","rendNodeTag","rendNodeLabel"],Et=_t.length,bt=["cssdefaultstyle","cssstyle"],wt=bt.length;if(ct?(dt=yt.highlightstrokecolor,ht=yt.highlightstrokeopacity,ft=yt.highlightcssclass):(dt=yt.strokecolor,ht=yt.strokeopacity,ft=yt.cssclass),this.type!=="no"&&(xt==="html"||this.type!=="canvas")){for(vt=0;vt<wt;vt++)if((At=ot.evaluate(yt[(ct?"highlight":"")+bt[vt]]))!==""&&at.visPropOld[bt[vt]]!==At){for(mt=this._css2js(At),pt=0;pt<Et;pt++)if(ot.exists(at[_t[pt]]))for(gt in mt)mt.hasOwnProperty(gt)&&(at[_t[pt]].style[mt[gt].key]=mt[gt].val);at.visPropOld[bt[vt]]=At}if(ut=ot.evaluate(yt.fontsize),at.visPropOld.fontsize!==ut){at.needsSizeUpdate=!0;try{for(pt=0;pt<Et;pt++)ot.exists(at[_t[pt]])&&(at[_t[pt]].style.fontSize=ut+"px")}catch{for(pt=0;pt<Et;pt++)ot.exists(at[_t[pt]])&&(at[_t[pt]].style.fontSize=ut)}at.visPropOld.fontsize=ut}}return this.setObjectTransition(at),xt==="html"&&this.type!=="no"?(at.visPropOld.cssclass!==ft&&(at.rendNode.className=ft,at.visPropOld.cssclass=ft,at.needsSizeUpdate=!0),this.setObjectStrokeColor(at,dt,ht)):this.updateInternalTextStyle(at,dt,ht),this},updateInternalTextStyle:function(at,ct,ut){this.setObjectStrokeColor(at,ct,ut)},drawImage:function(at){},updateImage:function(at){this.updateRectPrim(at.rendNode,at.coords.scrCoords[1],at.coords.scrCoords[2]-at.size[1],at.size[0],at.size[1]),this.updateImageURL(at),this.transformImage(at,at.transformations),this._updateVisual(at,{stroke:!0,dash:!0},!0)},joinTransforms:function(at,ct){var ut,ht=at.board.origin.scrCoords[1],dt=at.board.origin.scrCoords[2],ft=at.board.unitX,pt=at.board.unitY,mt=ct.length,gt=[[1,0,0],[-ht/ft,1/ft,0],[dt/pt,0,-1/pt]];for(ut=0;ut<mt;ut++)gt=it.matMatMult(ct[ut].matrix,gt);return gt=it.matMatMult([[1,0,0],[ht,ft,0],[dt,0,-pt]],gt)},transformImage:function(at,ct){},updateImageURL:function(at){},updateImageStyle:function(at,ct){at.rendNode.className=ot.evaluate(ct?at.visProp.highlightcssclass:at.visProp.cssclass)},appendChildPrim:function(at,ct){},appendNodesToElement:function(at,ct){},createPrim:function(at,ct){return null},remove:function(at){},makeArrows:function(at){},_setArrowWidth:function(at,ct,ut){},updateEllipsePrim:function(at,ct,ut,ht,dt){},updateLinePrim:function(at,ct,ut,ht,dt,ft){},updatePathPrim:function(at,ct,ut){},updatePathStringPoint:function(at,ct,ut){},updatePathStringPrim:function(at){},updatePathStringBezierPrim:function(at){},updatePolygonPrim:function(at,ct){},updateRectPrim:function(at,ct,ut,ht,dt){},setPropertyPrim:function(at,ct,ut){},display:function(at,ct){at&&(at.visPropOld.visible=ct)},show:function(at){},hide:function(at){},setBuffering:function(at,ct){},setDashStyle:function(at){},setDraft:function(at){if(ot.evaluate(at.visProp.draft)){var ct=at.board.options.elements.draft.color,ut=at.board.options.elements.draft.opacity;this.setObjectTransition(at),at.type===nt.OBJECT_TYPE_POLYGON?this.setObjectFillColor(at,ct,ut):(at.elementClass===nt.OBJECT_CLASS_POINT?this.setObjectFillColor(at,ct,ut):this.setObjectFillColor(at,"none",0),this.setObjectStrokeColor(at,ct,ut),this.setObjectStrokeWidth(at,at.board.options.elements.draft.strokeWidth))}},removeDraft:function(at){this.setObjectTransition(at),at.type===nt.OBJECT_TYPE_POLYGON?this.setObjectFillColor(at,at.visProp.fillcolor,at.visProp.fillopacity):(at.type===nt.OBJECT_CLASS_POINT&&this.setObjectFillColor(at,at.visProp.fillcolor,at.visProp.fillopacity),this.setObjectStrokeColor(at,at.visProp.strokecolor,at.visProp.strokeopacity),this.setObjectStrokeWidth(at,at.visProp.strokewidth))},setGradient:function(at){},updateGradient:function(at){},setObjectTransition:function(at,ct){},setObjectFillColor:function(at,ct,ut){},setObjectStrokeColor:function(at,ct,ut){},setObjectStrokeWidth:function(at,ct){},setShadow:function(at){},highlight:function(at){var ct,ut,ht,dt=at.visProp;if(this.setObjectTransition(at),!dt.draft){if(at.type===nt.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(at,dt.highlightfillcolor,dt.highlightfillopacity),ct=0;ct<at.borders.length;ct++)this.setObjectStrokeColor(at.borders[ct],at.borders[ct].visProp.highlightstrokecolor,at.borders[ct].visProp.highlightstrokeopacity);else at.elementClass===nt.OBJECT_CLASS_TEXT?this.updateTextStyle(at,!0):at.type===nt.OBJECT_TYPE_IMAGE?(this.updateImageStyle(at,!0),this.setObjectFillColor(at,dt.highlightfillcolor,dt.highlightfillopacity)):(this.setObjectStrokeColor(at,dt.highlightstrokecolor,dt.highlightstrokeopacity),this.setObjectFillColor(at,dt.highlightfillcolor,dt.highlightfillopacity));dt.highlightstrokewidth&&(ut=Math.max(ot.evaluate(dt.highlightstrokewidth),ot.evaluate(dt.strokewidth)),this.setObjectStrokeWidth(at,ut),at.elementClass===nt.OBJECT_CLASS_LINE&&(ht=this.updateLineEndings(at,ut),this.makeArrows(at),this.updateArrowSize(at,ht)))}return this},noHighlight:function(at){var ct,ut,ht,dt=at.visProp;if(this.setObjectTransition(at),!ot.evaluate(at.visProp.draft)){if(at.type===nt.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(at,dt.fillcolor,dt.fillopacity),ct=0;ct<at.borders.length;ct++)this.setObjectStrokeColor(at.borders[ct],at.borders[ct].visProp.strokecolor,at.borders[ct].visProp.strokeopacity);else at.elementClass===nt.OBJECT_CLASS_TEXT?this.updateTextStyle(at,!1):at.type===nt.OBJECT_TYPE_IMAGE?(this.updateImageStyle(at,!1),this.setObjectFillColor(at,dt.fillcolor,dt.fillopacity)):(this.setObjectStrokeColor(at,dt.strokecolor,dt.strokeopacity),this.setObjectFillColor(at,dt.fillcolor,dt.fillopacity));ht=ot.evaluate(dt.strokewidth),this.setObjectStrokeWidth(at,ht),at.elementClass===nt.OBJECT_CLASS_LINE&&(ut=this.updateLineEndings(at,ht),this.makeArrows(at),this.updateArrowSize(at,ut))}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(at,ct){var ut,ht,dt=function(pt){pt||(pt=window.event),pt.stopPropagation?pt.stopPropagation():pt.cancelBubble=!0},ft=function(pt,mt){var gt;gt=ut.createElement("span"),ht.appendChild(gt),gt.appendChild(ut.createTextNode(pt)),gt.style.paddingLeft="7px",gt.style.paddingRight="7px",lt.addEvent(gt,"mouseover",function(){this.style.backgroundColor=ct.highlightfillcolor},gt),lt.addEvent(gt,"mouseover",function(){this.style.backgroundColor=ct.highlightfillcolor},gt),lt.addEvent(gt,"mouseout",function(){this.style.backgroundColor=ct.fillcolor},gt),lt.addEvent(gt,"click",function(vt){return ot.bind(mt,at)(),!1},at),lt.addEvent(gt,"mouseup",dt,at),lt.addEvent(gt,"mousedown",dt,at),lt.addEvent(gt,"touchend",dt,at),lt.addEvent(gt,"touchstart",dt,at)};lt.isBrowser&&this.type!=="no"&&(ut=at.containerObj.ownerDocument,ht=ut.createElement("div"),ht.setAttribute("id",at.containerObj.id+"_navigationbar"),ht.style.color=ct.strokecolor,ht.style.backgroundColor=ct.fillcolor,ht.style.padding=ct.padding,ht.style.position=ct.position,ht.style.fontSize=ct.fontsize,ht.style.cursor=ct.cursor,ht.style.zIndex=ct.zindex,at.containerObj.appendChild(ht),ht.style.right=ct.right,ht.style.bottom=ct.bottom,at.attr.showscreenshot&&ft(at.attr.screenshot.symbol,function(){setTimeout(function(){at.renderer.screenshot(at,"",!1)},330)}),at.attr.showreload&&ft("↻",function(){at.reload()}),at.attr.showcleartraces&&ft("⊗",function(){at.clearTraces()}),at.attr.shownavigation&&(at.attr.showzoom&&(ft("–",at.zoomOut),ft("o",at.zoom100),ft("+",at.zoomIn)),ft("←",at.clickLeftArrow),ft("↓",at.clickUpArrow),ft("↑",at.clickDownArrow),ft("→",at.clickRightArrow)))},getElementById:function(at){return ot.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+at):""},removeToInsertLater:function(at){var ct=at.parentNode,ut=at.nextSibling;return ct.removeChild(at),function(){ut?ct.insertBefore(at,ut):ct.appendChild(at)}},resize:function(at,ct){},createTouchpoints:function(at){},showTouchpoint:function(at){},hideTouchpoint:function(at){},updateTouchpoint:function(at,ct){},dumpToCanvas:function(at){},screenshot:function(at){}}),tt.AbstractRenderer}),define("renderer/no",["jxg","renderer/abstract"],function(tt,_e){return tt.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},tt.extend(tt.NoRenderer.prototype,{drawPoint:function(rt){},updatePoint:function(rt){},changePointStyle:function(rt){},drawLine:function(rt){},updateLine:function(rt){},drawTicks:function(rt){},updateTicks:function(rt){},drawCurve:function(rt){},updateCurve:function(rt){},drawEllipse:function(rt){},updateEllipse:function(rt){},drawPolygon:function(rt){},updatePolygon:function(rt){},displayCopyright:function(rt,nt){},drawInternalText:function(rt){},updateInternalText:function(rt){},drawText:function(rt){},updateText:function(rt){},updateTextStyle:function(rt,nt){},updateInternalTextStyle:function(rt,nt,it){},drawImage:function(rt){},updateImage:function(rt){},transformImage:function(rt,nt){},updateImageURL:function(rt){},appendChildPrim:function(rt,nt){},appendNodesToElement:function(rt,nt){},createPrim:function(rt,nt){return null},remove:function(rt){},makeArrows:function(rt){},updateEllipsePrim:function(rt,nt,it,st,ot){},updateLinePrim:function(rt,nt,it,st,ot,lt){},updatePathPrim:function(rt,nt,it){},updatePathStringPoint:function(rt,nt,it){},updatePathStringPrim:function(rt){},updatePathStringBezierPrim:function(rt){},updatePolygonPrim:function(rt,nt){},updateRectPrim:function(rt,nt,it,st,ot){},setPropertyPrim:function(rt,nt,it){},display:function(rt,nt){rt&&(rt.visPropOld.visible=nt)},show:function(rt){},hide:function(rt){},setBuffering:function(rt,nt){},setDashStyle:function(rt){},setDraft:function(rt){},removeDraft:function(rt){},setGradient:function(rt){},updateGradient:function(rt){},setObjectTransition:function(rt,nt){},setObjectFillColor:function(rt,nt,it){},setObjectStrokeColor:function(rt,nt,it){},setObjectStrokeWidth:function(rt,nt){},setShadow:function(rt){},highlight:function(rt){},noHighlight:function(rt){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(rt){},getElementById:function(rt){return null},resize:function(rt,nt){},removeToInsertLater:function(){return function(){}}}),tt.NoRenderer.prototype=new _e,tt.NoRenderer}),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],function(tt,_e,rt,nt,it){return tt.FileReader={parseFileContent:function(st,ot,lt,at,ct){var ut=!1;rt.exists(at)||(at=!0);try{ut=new XMLHttpRequest,lt.toLowerCase()==="raw"?ut.overrideMimeType("text/plain; charset=iso-8859-1"):ut.overrideMimeType("text/xml; charset=iso-8859-1")}catch{try{ut=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{ut=new ActiveXObject("Microsoft.XMLHTTP")}catch{ut=!1}}}if(!ut)return void tt.debug("AJAX not activated!");ut.open("GET",st,at),lt.toLowerCase()==="raw"?this.cbp=function(){var ht=ut;ht.readyState===4&&ot(ht.responseText)}:this.cbp=function(){var ht=ut,dt="";ht.readyState===4&&(dt=!rt.exists(ht.responseStream)||ht.responseText.slice(0,2)!=="PK"&&nt.asciiCharCodeAt(ht.responseText.slice(0,1),0)!==31?ht.responseText:it.decode(jxgBinFileReader(ht)),this.parseString(dt,ot,lt,ct))},this.cb=rt.bind(this.cbp,this),ut.onreadystatechange=this.cb;try{ut.send(null)}catch{throw new Error("JSXGraph: A problem occurred while trying to read '"+st+"'.")}},parseString:function(st,ot,lt,at){var ct,ut;if(lt=lt.toLowerCase(),ct=tt.readers[lt],!rt.exists(ct))throw new Error("JSXGraph: There is no reader available for '"+lt+"'.");ut=new ct(ot,st),ut.read(),rt.isFunction(at)&&at(ot)}},!_e.isMetroApp()&&_e.isBrowser&&typeof navigator=="object"&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write(`<script type="text/vbscript">
Function Base64Encode(inData)
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim cOut, sOut, I
  For I = 1 To LenB(inData) Step 3
    Dim nGroup, pOut, sGroup
    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _
      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))
    nGroup = Oct(nGroup)
    nGroup = String(8 - Len(nGroup), "0") & nGroup
    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)
    sOut = sOut + pOut
  Next
  Select Case LenB(inData) Mod 3
    Case 1: '8 bit final
      sOut = Left(sOut, Len(sOut) - 2) + "=="
    Case 2: '16 bit final
      sOut = Left(sOut, Len(sOut) - 1) + "="
  End Select
  Base64Encode = sOut
End Function

Function MyASC(OneChar)
  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)
End Function

Function jxgBinFileReader(xhr)
    Dim byteString
    Dim b64String
    Dim i
    byteString = xhr.responseBody
    ReDim byteArray(LenB(byteString))
    For i = 1 To LenB(byteString)
        byteArray(i-1) = AscB(MidB(byteString, i, 1))
    Next
    b64String = Base64Encode(byteString)
    jxgBinFileReader = b64String
End Function
<\/script>
`),tt.FileReader}),define("parser/geonext",["jxg","base/constants","utils/type"],function(tt,_e,rt){return tt.GeonextParser={replacePow:function(nt){var it,st,ot,lt,at,ct,ut,ht,dt,ft,pt,mt;for(nt=nt.replace(/(\s*)\^(\s*)/g,"^"),ft=nt.indexOf("^"),lt=-1;ft>=0&&ft<nt.length-1;){if(lt===ft)throw new Error("JSXGraph: Error while parsing expression '"+nt+"'");if(lt=ft,dt=nt.slice(0,ft),pt=nt.slice(ft+1),dt.charAt(dt.length-1)===")"){for(it=1,st=dt.length-2;st>=0&&it>0;)ot=dt.charAt(st),ot===")"?it++:ot==="("&&(it-=1),st-=1;if(it!==0)throw new Error("JSXGraph: Missing '(' in expression");for(at="",ut=dt.substring(0,st+1),ht=st;ht>=0&&ut.substr(ht,1).match(/([\w\.]+)/);)at=RegExp.$1+at,ht-=1;at+=dt.substring(st+1,dt.length),at=at.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else at="[\\w\\.]+";if(pt.match(/^([\w\.]*\()/)){for(it=1,st=RegExp.$1.length;st<pt.length&&it>0;)ot=pt.charAt(st),ot===")"?it-=1:ot==="("&&(it+=1),st+=1;if(it!==0)throw new Error("JSXGraph: Missing ')' in expression");ct=pt.substring(0,st),ct=ct.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else ct="[\\w\\.]+";mt=new RegExp("("+at+")\\^("+ct+")"),nt=nt.replace(mt,"pow($1,$2)"),ft=nt.indexOf("^")}return nt},replaceIf:function(nt){var it,st,ot,lt,at,ct,ut,ht,dt,ft="",pt=null,mt=null,gt=null;if((ot=nt.indexOf("If("))<0)return nt;for(nt=nt.replace(/""/g,"0");ot>=0;){for(it=nt.slice(0,ot),st=nt.slice(ot+3),at=1,lt=0,ct=-1,ut=-1;lt<st.length&&at>0;)ht=st.charAt(lt),ht===")"?at-=1:ht==="("?at+=1:ht===","&&at===1&&(ct<0?ct=lt:ut=lt),lt+=1;if(dt=st.slice(0,lt-1),st=st.slice(lt),ct<0||ut<0)return"";pt=dt.slice(0,ct),mt=dt.slice(ct+1,ut),gt=dt.slice(ut+1),pt=this.replaceIf(pt),mt=this.replaceIf(mt),gt=this.replaceIf(gt),ft+=it+"(("+pt+")?("+mt+"):("+gt+"))",nt=st,pt=null,mt=null,ot=nt.indexOf("If(")}return ft+=st},replaceNameById:function(nt,it,st){var ot,lt,at,ct,ut=0,ht=["X","Y","L","V"],dt=function(ft){return st?"$('"+ft+"')":ft};for(ct=0;ct<ht.length;ct++)for(ut=nt.indexOf(ht[ct]+"(");ut>=0;)ut>=0&&(ot=nt.indexOf(")",ut+2))>=0&&(lt=nt.slice(ut+2,ot),lt=lt.replace(/\\(['"])?/g,"$1"),(at=it.elementsByName[lt])&&(nt=nt.slice(0,ut+2)+(st?"$('":"")+dt(at.id)+nt.slice(ot))),ot=nt.indexOf(")",ut+2),ut=nt.indexOf(ht[ct]+"(",ot);for(ut=nt.indexOf("Dist(");ut>=0;)ut>=0&&(ot=nt.indexOf(",",ut+5))>=0&&(lt=nt.slice(ut+5,ot),lt=lt.replace(/\\(['"])?/g,"$1"),(at=it.elementsByName[lt])&&(nt=nt.slice(0,ut+5)+dt(at.id)+nt.slice(ot))),ot=nt.indexOf(",",ut+5),ut=nt.indexOf(",",ot),ot=nt.indexOf(")",ut+1),ot>=0&&(lt=nt.slice(ut+1,ot),lt=lt.replace(/\\(['"])?/g,"$1"),(at=it.elementsByName[lt])&&(nt=nt.slice(0,ut+1)+dt(at.id)+nt.slice(ot))),ot=nt.indexOf(")",ut+1),ut=nt.indexOf("Dist(",ot);for(ht=["Deg","Rad"],ct=0;ct<ht.length;ct++)for(ut=nt.indexOf(ht[ct]+"(");ut>=0;)ut>=0&&(ot=nt.indexOf(",",ut+4))>=0&&(lt=nt.slice(ut+4,ot),lt=lt.replace(/\\(['"])?/g,"$1"),(at=it.elementsByName[lt])&&(nt=nt.slice(0,ut+4)+dt(at.id)+nt.slice(ot))),ot=nt.indexOf(",",ut+4),ut=nt.indexOf(",",ot),ot=nt.indexOf(",",ut+1),ot>=0&&(lt=nt.slice(ut+1,ot),lt=lt.replace(/\\(['"])?/g,"$1"),(at=it.elementsByName[lt])&&(nt=nt.slice(0,ut+1)+dt(at.id)+nt.slice(ot))),ot=nt.indexOf(",",ut+1),ut=nt.indexOf(",",ot),ot=nt.indexOf(")",ut+1),ot>=0&&(lt=nt.slice(ut+1,ot),lt=lt.replace(/\\(['"])?/g,"$1"),(at=it.elementsByName[lt])&&(nt=nt.slice(0,ut+1)+dt(at.id)+nt.slice(ot))),ot=nt.indexOf(")",ut+1),ut=nt.indexOf(ht[ct]+"(",ot);return nt},replaceIdByObj:function(nt){var it=/(X|Y|L)\(([\w_]+)\)/g;return nt=nt.replace(it,"$('$2').$1()"),it=/(V)\(([\w_]+)\)/g,nt=nt.replace(it,"$('$2').Value()"),it=/(Dist)\(([\w_]+),([\w_]+)\)/g,nt=nt.replace(it,"dist($('$2'), $('$3'))"),it=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g,nt=nt.replace(it,"deg($('$2'),$('$3'),$('$4'))"),it=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,nt=nt.replace(it,"rad($('$1'),$('$2'),$('$3'))"),it=/N\((.+)\)/g,nt=nt.replace(it,"($1)")},geonext2JS:function(nt,it){var st,ot,lt,at=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],ct=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(nt=nt.replace(/&lt;/g,"<"),nt=nt.replace(/&gt;/g,">"),nt=nt.replace(/&amp;/g,"&"),ot=nt,ot=this.replaceNameById(ot,it),ot=this.replaceIf(ot),ot=this.replacePow(ot),ot=this.replaceIdByObj(ot),lt=0;lt<at.length;lt++)st=new RegExp(["(\\W|^)(",at[lt],")"].join(""),"ig"),ot=ot.replace(st,["$1",ct[lt]].join(""));return ot=ot.replace(/True/g,"true"),ot=ot.replace(/False/g,"false"),ot=ot.replace(/fasle/g,"false"),ot=ot.replace(/Pi/g,"PI"),ot=ot.replace(/"/g,"'")},findDependencies:function(nt,it,st){var ot,lt,at,ct;rt.exists(st)||(st=nt.board),ot=st.elementsByName;for(lt in ot)ot.hasOwnProperty(lt)&&lt!==nt.name&&(ot[lt].elementClass===_e.OBJECT_CLASS_TEXT?rt.evaluate(ot[lt].visProp.islabel)||(ct=lt.replace(/\[/g,"\\["),ct=ct.replace(/\]/g,"\\]"),at=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+ct+")(,[\\w\\[\\]'_ ]+)*\\)","g"),it.search(at)>=0&&ot[lt].addChild(nt)):(ct=lt.replace(/\[/g,"\\["),ct=ct.replace(/\]/g,"\\]"),at=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+ct+")(,[\\w\\[\\]'_ ]+)*\\)","g"),it.search(at)>=0&&ot[lt].addChild(nt)))},gxt2jc:function(nt,it){var st;return nt=nt.replace(/&lt;/g,"<"),nt=nt.replace(/&gt;/g,">"),nt=nt.replace(/&amp;/g,"&"),st=nt,st=this.replaceNameById(st,it,!0),st=st.replace(/True/g,"true"),st=st.replace(/False/g,"false"),st=st.replace(/fasle/g,"false")}},tt.GeonextParser}),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","parser/geonext","utils/event","utils/color","utils/type"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct){return tt.GeometryElement=function(ut,ht,dt,ft){var pt,mt,gt;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},lt.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){this.board=ut,this.type=dt,this._org_type=dt,this.elementClass=ft||_e.OBJECT_CLASS_OTHER,this.id=ht.id,pt=ht.name,ct.exists(pt)||(pt=this.board.generateName(this)),pt!==""&&(this.board.elementsByName[pt]=this),this.name=pt,this.needsRegularUpdate=ht.needsregularupdate,ct.clearVisPropOld(this),gt=this.resolveShortcuts(ht);for(mt in gt)gt.hasOwnProperty(mt)&&this._set(mt,gt[mt]);this.visProp.draft=gt.draft&&gt.draft.draft,this.visProp.gradientangle="270",this.visProp.gradientsecondopacity=ct.evaluate(this.visProp.fillopacity),this.visProp.gradientpositionx=.5,this.visProp.gradientpositiony=.5}},tt.extend(tt.GeometryElement.prototype,{addChild:function(ut){var ht,dt;this.childElements[ut.id]=ut,this.addDescendants(ut),ut.ancestors[this.id]=this;for(ht in this.descendants)if(this.descendants.hasOwnProperty(ht)){this.descendants[ht].ancestors[this.id]=this;for(dt in this.ancestors)this.ancestors.hasOwnProperty(dt)&&(this.descendants[ht].ancestors[this.ancestors[dt].id]=this.ancestors[dt])}for(ht in this.ancestors)if(this.ancestors.hasOwnProperty(ht))for(dt in this.descendants)this.descendants.hasOwnProperty(dt)&&(this.ancestors[ht].descendants[this.descendants[dt].id]=this.descendants[dt]);return this},addDescendants:function(ut){var ht;this.descendants[ut.id]=ut;for(ht in ut.childElements)ut.childElements.hasOwnProperty(ht)&&this.addDescendants(ut.childElements[ht]);return this},addParents:function(ut){var ht,dt,ft;for(ft=ct.isArray(ut)?ut:arguments,dt=ft.length,ht=0;ht<dt;++ht)ct.exists(ft[ht])&&(ct.isId(this.board,ft[ht])?this.parents.push(ft[ht]):ct.exists(ft[ht].id)&&this.parents.push(ft[ht].id));this.parents=ct.uniqueArray(this.parents)},setParents:function(ut){this.parents=[],this.addParents(ut)},removeChild:function(ut){return delete this.childElements[ut.id],this.removeDescendants(ut),delete ut.ancestors[this.id],this},removeDescendants:function(ut){var ht;delete this.descendants[ut.id];for(ht in ut.childElements)ut.childElements.hasOwnProperty(ht)&&this.removeDescendants(ut.childElements[ht]);return this},countChildren:function(){var ut,ht,dt=0;ht=this.childElements;for(ut in ht)ht.hasOwnProperty(ut)&&ut.indexOf("Label")<0&&dt++;return dt},getName:function(){return this.name},addTransform:function(ut){return this},draggable:function(){return this.isDraggable&&!ct.evaluate(this.visProp.fixed)&&this.type!==_e.OBJECT_TYPE_GLIDER},setPosition:function(ut,ht){var dt,ft,pt,mt,gt=[];if(!ct.exists(this.parents))return this;for(pt=this.parents.length,ft=0;ft<pt;++ft)if(dt=this.board.select(this.parents[ft]),ct.isPoint(dt)){if(!dt.draggable())return this;gt.push(dt)}for(ht.length===3&&(ht=ht.slice(1)),mt=this.board.create("transform",ht,{type:"translate"}),pt=gt.length,pt>0?mt.applyOnce(gt):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(mt):this.addTransform(mt),ft=0;ft<pt;++ft)gt[ft].type===_e.OBJECT_TYPE_GLIDER&&gt[ft].updateGlider();return this},setPositionDirectly:function(ut,ht,dt){var ft=new rt(ut,ht,this.board,!1),pt=new rt(ut,dt,this.board,!1),mt=it.subtract(ft.usrCoords,pt.usrCoords);return this.setPosition(_e.COORDS_BY_USER,mt),this},generatePolynomial:function(){return[]},animate:function(ut,ht,dt){dt=dt||{};var ft,pt,mt,gt=this.board.attr.animationdelay,vt=Math.ceil(ht/gt),At=this,yt=function(xt,_t,Et,bt){var wt,Tt;if(xt=parseFloat(xt),_t=parseFloat(_t),!isNaN(xt)&&!isNaN(_t))for(Tt=(_t-xt)/vt,At.animationData[Et]=[],mt=0;mt<vt;mt++)wt=xt+(mt+1)*Tt,At.animationData[Et][vt-mt-1]=bt?Math.floor(wt):wt};this.animationData={};for(ft in ut)if(ut.hasOwnProperty(ft))switch(pt=ft.toLowerCase()){case"strokecolor":case"fillcolor":(function(xt,_t,Et){var bt,wt,Tt,Mt,Pt;for(bt=at.rgb2hsv(xt),wt=at.rgb2hsv(_t),Tt=(wt[0]-bt[0])/vt,Mt=(wt[1]-bt[1])/vt,Pt=(wt[2]-bt[2])/vt,At.animationData[Et]=[],mt=0;mt<vt;mt++)At.animationData[Et][vt-mt-1]=at.hsv2rgb(bt[0]+(mt+1)*Tt,bt[1]+(mt+1)*Mt,bt[2]+(mt+1)*Pt)})(this.visProp[pt],ut[ft],pt);break;case"size":if(!ct.isPoint(this))break;yt(this.visProp[pt],ut[ft],pt,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":yt(this.visProp[pt],ut[ft],pt,!1)}return this.animationCallback=dt.callback,this.board.addAnimation(this),this},update:function(){return ct.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(ut){return this.prepareUpdate().update().updateVisibility(ut).updateRenderer()},setDisplayRendNode:function(ut){var ht,dt,ft,pt,mt;if(ut===void 0&&(ut=this.visPropCalc.visible),ut===this.visPropOld.visible)return this;for(this.board.renderer.display(this,ut),dt=this.inherits.length,ft=0;ft<dt;ft++)if(mt=this.inherits[ft],ct.isArray(mt))for(pt=mt.length,ht=0;ht<pt;ht++)ct.exists(mt[ht])&&ct.exists(mt[ht].rendNode)&&ct.evaluate(mt[ht].visProp.visible)==="inherit"&&mt[ht].setDisplayRendNode(ut);else ct.exists(mt)&&ct.exists(mt.rendNode)&&ct.evaluate(mt.visProp.visible)==="inherit"&&mt.setDisplayRendNode(ut);return this.hasLabel&&ct.exists(this.label)&&ct.exists(this.label.rendNode)&&ct.evaluate(this.label.visProp.visible)==="inherit"&&this.label.setDisplayRendNode(ut),this},hideElement:function(){return tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!1,this.board.renderer.display(this,!1),ct.exists(this.label)&&this.hasLabel&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement()),this},showElement:function(){return tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!0,this.board.renderer.display(this,!0),ct.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},updateVisibility:function(ut){var ht,dt,ft,pt,mt,gt;if(this.needsUpdate){for(ut!==void 0?this.visPropCalc.visible=ut:(gt=ct.evaluate(this.visProp.visible),ct.exists(this.hiddenByParent)&&this.hiddenByParent&&(gt=!1),gt!=="inherit"&&(this.visPropCalc.visible=gt)),dt=this.inherits.length,ft=0;ft<dt;ft++)if(mt=this.inherits[ft],ct.isArray(mt))for(pt=mt.length,ht=0;ht<pt;ht++)ct.exists(mt[ht])&&ct.evaluate(mt[ht].visProp.visible)==="inherit"&&mt[ht].prepareUpdate().updateVisibility(this.visPropCalc.visible);else ct.exists(mt)&&ct.evaluate(mt.visProp.visible)==="inherit"&&mt.prepareUpdate().updateVisibility(this.visPropCalc.visible);ct.exists(this.label)&&ct.exists(this.label.visProp)&&ct.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(ut,ht){ut=ut.toLocaleLowerCase(),this.visProp.hasOwnProperty(ut)&&ut.indexOf("color")>=0&&ct.isString(ht)&&ht.length===9&&ht.charAt(0)==="#"?(ht=at.rgba2rgbo(ht),this.visProp[ut]=ht[0],this.visProp[ut.replace("color","opacity")]=ht[1]):this.visProp[ut]=ht},resolveShortcuts:function(ut){var ht,dt;for(ht in st.shortcuts)if(st.shortcuts.hasOwnProperty(ht)&&ct.exists(ut[ht]))for(dt=0;dt<st.shortcuts[ht].length;dt++)ct.exists(ut[st.shortcuts[ht][dt]])||(ut[st.shortcuts[ht][dt]]=ut[ht]);return ut},setLabel:function(ut){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(ut)},setLabelText:function(ut){return ct.exists(this.label)&&(ut=ut.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(ut)),this},setName:function(ut){ut=ut.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.elType!=="slider"&&this.setLabelText(ut),this.setAttribute({name:ut})},setProperty:function(){tt.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(ut){var ht,dt,ft,pt,mt,gt,vt,At,yt,xt={};for(ht=0;ht<arguments.length;ht++)gt=arguments[ht],ct.isString(gt)?(At=gt.split(":"),xt[ct.trim(At[0])]=ct.trim(At[1])):ct.isArray(gt)?xt[gt[0]]=gt[1]:tt.extend(xt,gt);xt=this.resolveShortcuts(xt);for(ht in xt)if(xt.hasOwnProperty(ht)){if(pt=ht.replace(/\s+/g,"").toLowerCase(),mt=xt[ht],yt=this.visProp[pt],ct.isObject(mt)&&ct.exists(this.visProp[pt])){if(this.visProp[pt]=ct.merge(this.visProp[pt],mt),this.type===_e.OBJECT_TYPE_TICKS&&ct.exists(this.labels))for(ft=this.labels.length,dt=0;dt<ft;dt++)this.labels[dt].setAttribute(mt);continue}switch(pt){case"name":yt=this.name,delete this.board.elementsByName[this.name],this.name=mt,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!(mt==="false"||mt===!1),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":mt=at.rgba2rgbo(mt),vt=mt[1],mt=mt[0],vt===0&&ct.exists(this.label)&&this.hasLabel&&this.label.hideElement(),ct.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=mt,this.board.renderer.setObjectStrokeColor(this.label,mt,vt)),this.elementClass===_e.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=mt,this.visProp.strokeopacity=vt,this.board.renderer.setObjectStrokeColor(this,mt,vt));break;case"infoboxtext":ct.isString(mt)?this.infoboxText=mt:this.infoboxText=!1;break;case"visible":this.visProp.visible=mt!=="false"&&(mt==="true"||mt),this.setDisplayRendNode(ct.evaluate(this.visProp.visible));break;case"face":ct.isPoint(this)&&(this.visProp.face=mt,this.board.renderer.changePointStyle(this));break;case"trace":mt==="false"||mt===!1?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=!0;break;case"gradient":this.visProp.gradient=mt,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":mt=at.rgba2rgbo(mt),this.visProp.gradientsecondcolor=mt[0],this.visProp.gradientsecondopacity=mt[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=mt,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=mt,ct.evaluate(mt)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=mt;break;case"radius":this.type!==_e.OBJECT_TYPE_ANGLE&&this.type!==_e.OBJECT_TYPE_SECTOR||this.setRadius(mt);break;case"rotate":(this.elementClass===_e.OBJECT_CLASS_TEXT&&ct.evaluate(this.visProp.display)==="internal"||this.type===_e.OBJECT_TYPE_IMAGE)&&this.addRotation(mt);break;case"ticksdistance":this.type===_e.OBJECT_TYPE_TICKS&&ct.isNumber(mt)&&(this.ticksFunction=this.makeTicksFunction(mt));break;case"generatelabelvalue":this.type===_e.OBJECT_TYPE_TICKS&&ct.isFunction(mt)&&(this.generateLabelValue=mt);break;case"onpolygon":this.type===_e.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!mt);break;case"disabled":ct.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!mt);break;case"checked":ct.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!mt);break;case"maxlength":ct.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!mt);break;default:ct.exists(this.visProp[pt])&&(!tt.Validator[pt]||tt.Validator[pt]&&tt.Validator[pt](mt)||tt.Validator[pt]&&ct.isFunction(mt)&&tt.Validator[pt](mt()))&&(mt=(!mt.toLowerCase||mt.toLowerCase()!=="false")&&mt,this._set(pt,mt))}this.triggerEventHandlers(["attribute:"+pt],[yt,mt,this])}return this.triggerEventHandlers(["attribute"],[xt,this]),ct.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){tt.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(ut){var ht;switch(ut=ut.toLowerCase()){case"needsregularupdate":ht=this.needsRegularUpdate;break;case"labelcolor":ht=this.label.visProp.strokecolor;break;case"infoboxtext":ht=this.infoboxText;break;case"withlabel":ht=this.hasLabel;break;default:ht=this.visProp[ut]}return ht},setDash:function(ut){return this.setAttribute({dash:ut}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new rt(_e.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new rt(_e.COORDS_BY_USER,[0,0],this.board)},setArrow:function(ut,ht){return this.visProp.firstarrow=ut,this.visProp.lastarrow=ht,ht&&(this.type=_e.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var ut=ct.evaluate(this.visProp.gradient);ut!=="linear"&&ut!=="radial"||this.board.renderer.setGradient(this)},createLabel:function(){var ut,ht=this;return tt.elements.text?(ut=ct.deepCopy(this.visProp.label,null),ut.id=this.id+"Label",ut.isLabel=!0,ut.anchor=this,ut.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=tt.elements.text(this.board,[0,0,function(){return ct.isFunction(ht.name)?ht.name():ht.name}],ut),this.label.needsUpdate=!0,this.label.dump=!1,this.label.update(),this.hasLabel=!0)):tt.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(ut){return ut=ct.def(ut,!1),!ct.evaluate(this.visProp.highlight)||this.highlighted&&!ut||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var ut;for(ut in this.traces)this.traces.hasOwnProperty(ut)&&this.board.renderer.remove(this.traces[ut]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=nt.normalize(this.stdform),this},toJSON:function(){var ut,ht,dt=['{"name":',this.name];dt.push(', "id":'+this.id),ut=[];for(ht in this.visProp)this.visProp.hasOwnProperty(ht)&&ct.exists(this.visProp[ht])&&ut.push('"'+ht+'":'+this.visProp[ht]);return dt.push(', "visProp":{'+ut.toString()+"}"),dt.push("}"),dt.join("")},addRotation:function(ut){var ht,dt,ft,pt,mt,gt=this;return(this.elementClass===_e.OBJECT_CLASS_TEXT&&ct.evaluate(this.visProp.display)==="internal"||this.type===_e.OBJECT_TYPE_IMAGE)&&ut!==0&&(ht=this.board.create("transform",[function(){return-gt.X()},function(){return-gt.Y()}],{type:"translate"}),dt=this.board.create("transform",[function(){return gt.X()},function(){return gt.Y()}],{type:"translate"}),ft=this.board.create("transform",[function(){return gt.board.unitX/gt.board.unitY},function(){return 1}],{type:"scale"}),pt=this.board.create("transform",[function(){return gt.board.unitY/gt.board.unitX},function(){return 1}],{type:"scale"}),mt=this.board.create("transform",[ut*Math.PI/180],{type:"rotate"}),ht.bindTo(this),ft.bindTo(this),mt.bindTo(this),pt.bindTo(this),dt.bindTo(this)),this},highlightStrokeColor:function(ut){return tt.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:ut}),this},strokeColor:function(ut){return tt.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:ut}),this},strokeWidth:function(ut){return tt.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:ut}),this},fillColor:function(ut){return tt.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:ut}),this},highlightFillColor:function(ut){return tt.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:ut}),this},labelColor:function(ut){return tt.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:ut}),this},dash:function(ut){return tt.deprecated("dash()","setAttribute()"),this.setAttribute({dash:ut}),this},visible:function(ut){return tt.deprecated("visible()","setAttribute()"),this.setAttribute({visible:ut}),this},shadow:function(ut){return tt.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:ut}),this},getType:function(){return this.elType},getParents:function(){return ct.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var ut,ht=ct.deepCopy(this.visProp),dt=[],ft=dt.length;for(ht.id=this.id,ht.name=this.name,ut=0;ut<ft;ut++)delete ht[dt[ut]];return ht},hasPoint:function(ut,ht){return!1},handleSnapToGrid:function(ut,ht){var dt,ft,pt,mt,gt=!1,vt=ct.evaluate(this.visProp.snapsizex),At=ct.evaluate(this.visProp.snapsizey);return ct.exists(this.coords)?(gt=ct.evaluate(this.visProp.snaptogrid)||ut===!0,gt&&(dt=this.coords.usrCoords[1],ft=this.coords.usrCoords[2],vt<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(pt=this.board.defaultAxes.x.defaultTicks,vt=pt.ticksDelta*(ct.evaluate(pt.visProp.minorticks)+1)),At<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(pt=this.board.defaultAxes.y.defaultTicks,At=pt.ticksDelta*(ct.evaluate(pt.visProp.minorticks)+1)),vt>0&&At>0&&(mt=this.board.getBoundingBox(),dt=Math.round(dt/vt)*vt,ft=Math.round(ft/At)*At,ht||(dt<mt[0]?dt+=vt:dt>mt[2]&&(dt-=vt),ft<mt[3]?ft+=At:ft>mt[1]&&(ft-=At)),this.coords.setCoordinates(_e.COORDS_BY_USER,[dt,ft]))),this):this},addEvent:tt.shortcut(tt.GeometryElement.prototype,"on"),removeEvent:tt.shortcut(tt.GeometryElement.prototype,"off"),__evt__over:function(ut){},__evt__mouseover:function(ut){},__evt__out:function(ut){},__evt__mouseout:function(ut){},__evt__move:function(ut){},__evt__mousemove:function(ut){},__evt__drag:function(ut){},__evt__mousedrag:function(ut){},__evt__touchdrag:function(ut){},__evt__down:function(ut){},__evt__mousedown:function(ut){},__evt__touchdown:function(ut){},__evt__up:function(ut){},__evt__mouseup:function(ut){},__evt__touchup:function(ut){},__evt__attribute:function(ut,ht){},__evt__attribute_:function(ut,ht,dt){},__evt:function(){}}),tt.GeometryElement}),define("base/transformation",["jxg","base/constants","math/math","utils/type"],function(tt,_e,rt,nt){return tt.Transformation=function(it,st,ot){this.elementClass=_e.OBJECT_CLASS_OTHER,this.type=_e.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=it,this.isNumericMatrix=!1,this.setMatrix(it,st,ot),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bind",melt:"melt"}},tt.Transformation.prototype={},tt.extend(tt.Transformation.prototype,{update:function(){return this},setMatrix:function(it,st,ot){var lt;for(this.isNumericMatrix=!0,lt=0;lt<ot.length;lt++)if(typeof ot[lt]!="number"){this.isNumericMatrix=!1;break}if(st==="translate"){if(ot.length!==2)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=nt.createEvalFunction(it,ot,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if(st==="scale"){if(ot.length!==2)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=nt.createEvalFunction(it,ot,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if(st==="reflect")ot.length<4&&(ot[0]=it.select(ot[0])),ot.length===2&&(ot[1]=it.select(ot[1])),ot.length===4&&(this.evalParam=nt.createEvalFunction(it,ot,4)),this.update=function(){var at,ct,ut,ht,dt,ft,pt,mt;ot.length===1?pt=ot[0].stdform:ot.length===2?pt=rt.crossProduct(ot[1].coords.usrCoords,ot[0].coords.usrCoords):ot.length===4&&(pt=rt.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),at=pt[1],ct=pt[2],ut=pt[0],mt=[-ut*at,-ut*ct,at*at+ct*ct],ft=mt[2],ht=mt[0]/mt[2],dt=mt[1]/mt[2],at=-pt[2],ct=pt[1],this.matrix[1][1]=(at*at-ct*ct)/ft,this.matrix[1][2]=2*at*ct/ft,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=ht*(1-this.matrix[1][1])-dt*this.matrix[1][2],this.matrix[2][0]=dt*(1-this.matrix[2][2])-ht*this.matrix[2][1]};else if(st==="rotate")ot.length===3?this.evalParam=nt.createEvalFunction(it,ot,3):ot.length>0&&ot.length<=2&&(this.evalParam=nt.createEvalFunction(it,ot,1),ot.length!==2||nt.isArray(ot[1])||(ot[1]=it.select(ot[1]))),this.update=function(){var at,ct,ut=this.evalParam(0),ht=Math.cos(ut),dt=Math.sin(ut);this.matrix[1][1]=ht,this.matrix[1][2]=-dt,this.matrix[2][1]=dt,this.matrix[2][2]=ht,ot.length>1&&(ot.length===3?(at=this.evalParam(1),ct=this.evalParam(2)):nt.isArray(ot[1])?(at=ot[1][0],ct=ot[1][1]):(at=ot[1].X(),ct=ot[1].Y()),this.matrix[1][0]=at*(1-ht)+ct*dt,this.matrix[2][0]=ct*(1-ht)-at*dt)};else if(st==="shear"){if(ot.length!==2)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=nt.createEvalFunction(it,ot,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if(st==="generic"){if(ot.length!==9)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=nt.createEvalFunction(it,ot,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(it,st){return this.update(),nt.exists(st)?rt.matVecMult(this.matrix,it.initialCoords.usrCoords):rt.matVecMult(this.matrix,it.coords.usrCoords)},applyOnce:function(it){var st,ot,lt;for(nt.isArray(it)||(it=[it]),ot=it.length,lt=0;lt<ot;lt++)this.update(),st=rt.matVecMult(this.matrix,it[lt].coords.usrCoords),it[lt].coords.setCoordinates(_e.COORDS_BY_USER,st)},bindTo:function(it){var st,ot;if(nt.isArray(it))for(ot=it.length,st=0;st<ot;st++)it[st].transformations.push(this);else it.transformations.push(this)},setProperty:function(it){tt.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(it){},melt:function(it){var st,ot,lt,at,ct,ut,ht=[];for(ot=it.matrix.length,lt=this.matrix[0].length,st=0;st<ot;st++)ht[st]=[];for(this.update(),it.update(),st=0;st<ot;st++)for(ut=0;ut<lt;ut++){for(ct=0,at=0;at<ot;at++)ct+=it.matrix[st][at]*this.matrix[at][ut];ht[st][ut]=ct}return this.update=function(){var dt=this.matrix.length,ft=this.matrix[0].length;for(st=0;st<dt;st++)for(ut=0;ut<ft;ut++)this.matrix[st][ut]=ht[st][ut]},this},getParents:function(){var it=[[].concat.apply([],this.matrix)];return this.parents.length!==0&&(it=this.parents),it}}),tt.createTransform=function(it,st,ot){return new tt.Transformation(it,ot.type,st)},tt.registerElement("transform",tt.createTransform),{Transformation:tt.Transformation,createTransform:tt.createTransform}}),define("base/coordselement",["jxg","options","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut,ht){return tt.CoordsElement=function(dt,ft){var pt;for(ut.exists(dt)||(dt=[1,0,0]),pt=0;pt<dt.length;++pt)dt[pt]=parseFloat(dt[pt]);this.coords=new ot(lt.COORDS_BY_USER,dt,this.board),this.initialCoords=new ot(lt.COORDS_BY_USER,dt,this.board),this.position=null,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.updateConstraint=function(){return this},this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=ut.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),ut.exists(this.element)&&this.addAnchor(dt,ft),this.isDraggable=!0},tt.extend(tt.CoordsElement.prototype,{updateCoords:function(dt){return this.needsUpdate?(ut.exists(dt)||(dt=!1),this.type===lt.OBJECT_TYPE_GLIDER&&(dt?this.updateGliderFromParent():this.updateGlider()),ut.evaluate(this.visProp.frozen)||this.updateConstraint(),this.updateTransform(),this):this},updateGlider:function(){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt=2*Math.PI,Ut=!1,Ft=this.slideObject;if(this.needsUpdateFromParent=!1,Ft.elementClass===lt.OBJECT_CLASS_CIRCLE)ut.evaluate(this.visProp.isgeonext)&&(Bt=1),Pt=nt.projectPointToCircle(this,Ft,this.board),It=nt.rad([Ft.center.X()+1,Ft.center.Y()],Ft.center,this)/Bt;else if(Ft.elementClass===lt.OBJECT_CLASS_LINE){if(this.onPolygon){if(ft=Ft.point1.coords.usrCoords,pt=Ft.point2.coords.usrCoords,dt=1,mt=pt[dt]-ft[dt],Math.abs(mt)<rt.eps&&(dt=2,mt=pt[dt]-ft[dt]),At=nt.projectPointToLine(this,Ft,this.board),yt=(At.usrCoords[dt]-ft[dt])/mt,vt=Ft.parentPolygon,yt<0){for(dt=0;dt<vt.borders.length;dt++)if(Ft===vt.borders[dt]){Ft=vt.borders[(dt-1+vt.borders.length)%vt.borders.length];break}}else if(yt>1){for(dt=0;dt<vt.borders.length;dt++)if(Ft===vt.borders[dt]){Ft=vt.borders[(dt+1+vt.borders.length)%vt.borders.length];break}}Ft.id!==this.slideObject.id&&(this.slideObject=Ft)}ft=Ft.point1.coords,pt=Ft.point2.coords,mt=ft.distance(lt.COORDS_BY_USER,pt),mt<rt.eps?(Pt=ft,Ut=!0,It=0):(Pt=nt.projectPointToLine(this,Ft,this.board),ft=ft.usrCoords.slice(0),pt=pt.usrCoords.slice(0),Math.abs(pt[0])<rt.eps?(dt=1,mt=pt[dt],Math.abs(mt)<rt.eps&&(dt=2,mt=pt[dt]),mt=(Pt.usrCoords[dt]-ft[dt])/mt,xt=mt>=0?1:-1,mt=Math.abs(mt),It=xt*mt/(mt+1)):Math.abs(ft[0])<rt.eps?(dt=1,mt=ft[dt],Math.abs(mt)<rt.eps&&(dt=2,mt=ft[dt]),mt=(Pt.usrCoords[dt]-pt[dt])/mt,It=mt<0?(1-2*mt)/(1-mt):1/(mt+1)):(dt=1,mt=pt[dt]-ft[dt],Math.abs(mt)<rt.eps&&(dt=2,mt=pt[dt]-ft[dt]),It=(Pt.usrCoords[dt]-ft[dt])/mt)),Ot=ut.evaluate(this.visProp.snapwidth),ut.evaluate(Ot)>0&&Math.abs(this._smax-this._smin)>=rt.eps&&(It=Math.max(Math.min(It,1),0),gt=It*(this._smax-this._smin)+this._smin,gt=Math.round(gt/Ot)*Ot,It=(gt-this._smin)/(this._smax-this._smin),this.update(!0)),ft=Ft.point1.coords,!ut.evaluate(Ft.visProp.straightfirst)&&Math.abs(ft.usrCoords[0])>rt.eps&&It<0&&(Pt=ft,Ut=!0,It=0),pt=Ft.point2.coords,!ut.evaluate(Ft.visProp.straightlast)&&Math.abs(pt.usrCoords[0])>rt.eps&&It>1&&(Pt=pt,Ut=!0,It=1)}else Ft.type===lt.OBJECT_TYPE_TURTLE?(this.updateConstraint(),Pt=nt.projectPointToTurtle(this,Ft,this.board),It=this.position):Ft.elementClass===lt.OBJECT_CLASS_CURVE?Ft.type===lt.OBJECT_TYPE_ARC||Ft.type===lt.OBJECT_TYPE_SECTOR?(Pt=nt.projectPointToCircle(this,Ft,this.board),bt=nt.rad(Ft.radiuspoint,Ft.center,this),_t=0,Et=nt.rad(Ft.radiuspoint,Ft.center,Ft.anglepoint),It=bt,Ot=ut.evaluate(Ft.visProp.selection),(Ot==="minor"&&Et>Math.PI||Ot==="major"&&Et<Math.PI)&&(_t=Et,Et=2*Math.PI),(bt<_t||bt>Et)&&(It=Et,(bt<_t&&bt>.5*_t||bt>Et&&bt>.5*Et+Math.PI)&&(It=_t),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),Bt=Et-_t,this.visProp.isgeonext&&(Bt=1),Math.abs(Bt)>rt.eps&&(It/=Bt)):(this.updateConstraint(),Ft.transformations.length>0?(Ft.updateTransformMatrix(),Mt=rt.inverse(Ft.transformMat),Tt=rt.matVecMult(Mt,this.coords.usrCoords),wt=new ot(lt.COORDS_BY_USER,Tt,this.board).usrCoords,Tt=nt.projectCoordsToCurve(wt[1],wt[2],this.position||0,Ft,this.board),Pt=Tt[0],It=Tt[1]):(Pt=nt.projectPointToCurve(this,Ft,this.board),It=this.position)):ut.isPoint(Ft)&&(Pt=nt.projectPointToPoint(this,Ft,this.board),It=this.position);this.coords.setCoordinates(lt.COORDS_BY_USER,Pt.usrCoords,Ut),this.position=It},updateGliderFromParent:function(){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t=this.slideObject,Et=2*Math.PI;if(!this.needsUpdateFromParent)return void(this.needsUpdateFromParent=!0);_t.elementClass===lt.OBJECT_CLASS_CIRCLE?(pt=_t.Radius(),ut.evaluate(this.visProp.isgeonext)&&(Et=1),gt=[_t.center.X()+pt*Math.cos(this.position*Et),_t.center.Y()+pt*Math.sin(this.position*Et)]):_t.elementClass===lt.OBJECT_CLASS_LINE?(dt=_t.point1.coords.usrCoords,ft=_t.point2.coords.usrCoords,dt[0]===0&&dt[1]===0&&dt[2]===0||ft[0]===0&&ft[1]===0&&ft[2]===0?gt=[0,0,0]:Math.abs(ft[0])<rt.eps?(mt=Math.min(Math.abs(this.position),1-rt.eps),mt/=1-mt,this.position<0&&(mt=-mt),gt=[dt[0]+mt*ft[0],dt[1]+mt*ft[1],dt[2]+mt*ft[2]]):Math.abs(dt[0])<rt.eps?(mt=Math.max(this.position,rt.eps),mt=Math.min(mt,2-rt.eps),mt=mt>1?(mt-1)/(mt-2):(1-mt)/mt,gt=[ft[0]+mt*dt[0],ft[1]+mt*dt[1],ft[2]+mt*dt[2]]):(mt=this.position,gt=[dt[0]+mt*(ft[0]-dt[0]),dt[1]+mt*(ft[1]-dt[1]),dt[2]+mt*(ft[2]-dt[2])])):_t.type===lt.OBJECT_TYPE_TURTLE?(this.coords.setCoordinates(lt.COORDS_BY_USER,[_t.Z(this.position),_t.X(this.position),_t.Y(this.position)]),this.updateConstraint(),gt=nt.projectPointToTurtle(this,_t,this.board).usrCoords):_t.elementClass===lt.OBJECT_CLASS_CURVE?(this.coords.setCoordinates(lt.COORDS_BY_USER,[_t.Z(this.position),_t.X(this.position),_t.Y(this.position)]),_t.type===lt.OBJECT_TYPE_ARC||_t.type===lt.OBJECT_TYPE_SECTOR?(vt=nt.rad([_t.center.X()+1,_t.center.Y()],_t.center,_t.radiuspoint),At=0,xt=nt.rad(_t.radiuspoint,_t.center,_t.anglepoint),(_t.visProp.selection==="minor"&&xt>Math.PI||_t.visProp.selection==="major"&&xt<Math.PI)&&(At=xt,xt=2*Math.PI),Et=xt-At,ut.evaluate(this.visProp.isgeonext)&&(Et=1),yt=this.position*Et,(yt<At||yt>xt)&&(yt=xt,(yt<At&&yt>.5*At||yt>xt&&yt>.5*xt+Math.PI)&&(yt=At),this.position=yt,Math.abs(Et)>rt.eps&&(this.position/=Et)),pt=_t.Radius(),gt=[_t.center.X()+pt*Math.cos(this.position*Et+vt),_t.center.Y()+pt*Math.sin(this.position*Et+vt)]):(this.updateConstraint(),gt=nt.projectPointToCurve(this,_t,this.board).usrCoords)):ut.isPoint(_t)&&(gt=nt.projectPointToPoint(this,_t,this.board).usrCoords),this.coords.setCoordinates(lt.COORDS_BY_USER,gt,!1)},updateRendererGeneric:function(dt){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>rt.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[dt](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(dt){return this.isReal&&dt.isReal?this.coords.distance(lt.COORDS_BY_USER,dt.coords):NaN},snapToGrid:function(dt){return this.handleSnapToGrid(dt)},handleSnapToPoints:function(dt){var ft,pt,mt,gt,vt,At,yt,xt,_t=0,Et=1/0,bt=null,wt=ut.evaluate(this.visProp.ignoredsnaptopoints),Tt=!1;if(gt=this.board.objectsList.length,wt&&(yt=wt.length),ut.evaluate(this.visProp.snaptopoints)||dt){for(vt=ut.evaluate(this.visProp.attractorunit),At=ut.evaluate(this.visProp.attractordistance),ft=0;ft<gt;ft++){if(pt=this.board.objectsList[ft],wt){for(Tt=!1,xt=0;xt<yt;xt++)if(pt==this.board.select(wt[xt])){Tt=!0;break}if(Tt)continue}ut.isPoint(pt)&&pt!==this&&pt.visPropCalc.visible&&(mt=nt.projectPointToPoint(this,pt,this.board),(_t=vt==="screen"?mt.distance(lt.COORDS_BY_SCREEN,this.coords):mt.distance(lt.COORDS_BY_USER,this.coords))<At&&_t<Et&&(Et=_t,bt=mt))}bt!==null&&this.coords.setCoordinates(lt.COORDS_BY_USER,bt.usrCoords)}return this},snapToPoints:function(dt){return this.handleSnapToPoints(dt)},handleAttractors:function(){var dt,ft,pt,mt,gt=0,vt=ut.evaluate(this.visProp.attractorunit),At=ut.evaluate(this.visProp.attractordistance),yt=ut.evaluate(this.visProp.snatchdistance),xt=ut.evaluate(this.visProp.attractors),_t=xt.length;if(At!==0){for(dt=0;dt<_t;dt++)if(ft=this.board.select(xt[dt]),ut.exists(ft)&&ft!==this){if(ut.isPoint(ft)?pt=nt.projectPointToPoint(this,ft,this.board):ft.elementClass===lt.OBJECT_CLASS_LINE?(mt=nt.projectCoordsToSegment(this.coords.usrCoords,ft.point1.coords.usrCoords,ft.point2.coords.usrCoords),pt=!ut.evaluate(ft.visProp.straightfirst)&&mt[1]<0?ft.point1.coords:!ut.evaluate(ft.visProp.straightlast)&&mt[1]>1?ft.point2.coords:new ot(lt.COORDS_BY_USER,mt[0],this.board)):ft.elementClass===lt.OBJECT_CLASS_CIRCLE?pt=nt.projectPointToCircle(this,ft,this.board):ft.elementClass===lt.OBJECT_CLASS_CURVE?pt=nt.projectPointToCurve(this,ft,this.board):ft.type===lt.OBJECT_TYPE_TURTLE&&(pt=nt.projectPointToTurtle(this,ft,this.board)),(gt=vt==="screen"?pt.distance(lt.COORDS_BY_SCREEN,this.coords):pt.distance(lt.COORDS_BY_USER,this.coords))<At){this.type===lt.OBJECT_TYPE_GLIDER&&this.slideObject===ft||this.makeGlider(ft);break}ft===this.slideObject&&gt>=yt&&this.popSlideObject()}return this}},setPositionDirectly:function(dt,ft){var pt,mt,gt,vt,At=this.coords;if(this.relativeCoords)return mt=new ot(dt,ft,this.board),ut.evaluate(this.visProp.islabel)?(gt=st.subtract(mt.scrCoords,At.scrCoords),this.relativeCoords.scrCoords[1]+=gt[1],this.relativeCoords.scrCoords[2]+=gt[2]):(gt=st.subtract(mt.usrCoords,At.usrCoords),this.relativeCoords.usrCoords[1]+=gt[1],this.relativeCoords.usrCoords[2]+=gt[2]),this;for(this.coords.setCoordinates(dt,ft),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),pt=this.transformations.length-1;pt>=0;pt--)dt===lt.COORDS_BY_SCREEN?vt=new ot(dt,ft,this.board).usrCoords:(ft.length===2&&(ft=[1].concat(ft)),vt=ft),this.initialCoords.setCoordinates(lt.COORDS_BY_USER,rt.matVecMult(rt.inverse(this.transformations[pt].matrix),vt));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===lt.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(dt,ft){var pt;return ft=new ot(dt,ft,this.board),pt=this.board.create("transform",ft.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(pt):this.addTransform(this,pt),this.prepareUpdate().update(),this},setPosition:function(dt,ft){return this.setPositionDirectly(dt,ft)},setGliderPosition:function(dt){return this.type===lt.OBJECT_TYPE_GLIDER&&(this.position=dt,this.board.update()),this},makeGlider:function(dt){var ft,pt,mt,gt=this.board.select(dt),vt=!1;if(gt.type===lt.OBJECT_TYPE_POLYGON){for(ft=Number.MAX_VALUE,pt=0;pt<gt.borders.length;pt++)(mt=tt.Math.Geometry.distPointLine(this.coords.usrCoords,gt.borders[pt].stdform))<ft&&(ft=mt,dt=gt.borders[pt]);gt=this.board.select(dt),vt=!0}if(!ut.exists(gt))throw new Error("JSXGraph: slide object undefined.");if(gt.type===lt.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(dt),this.slideObjects.push(this.slideObject),this.addParents(dt),this.type=lt.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=vt,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),this.slideObjects.length===0?(this.type=this._org_type,this.type===lt.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===lt.OBJECT_CLASS_TEXT?this.elType="text":this.type===lt.OBJECT_TYPE_IMAGE&&(this.elType="image"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var dt,ft;if(this.type!==lt.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,this.isDraggable)return;this.isDraggable=!0,this.elementClass===lt.OBJECT_CLASS_POINT&&(this.type=lt.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(dt in this.board.objects)this.board.objects.hasOwnProperty(dt)&&(ft=this.board.objects[dt],ft.descendants&&(delete ft.descendants[this.id],delete ft.childElements[this.id],this.hasLabel&&(delete ft.descendants[this.label.id],delete ft.childElements[this.label.id])));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===lt.OBJECT_CLASS_POINT?(this.type=lt.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===lt.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===lt.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(dt){var ft,pt,mt=[],gt=["X","Y"];for(this.elementClass===lt.OBJECT_CLASS_POINT&&(this.type=lt.OBJECT_TYPE_CAS),this.isDraggable=!1,ft=0;ft<dt.length;ft++)pt=dt[ft],ut.isString(pt)?(mt[ft]=this.board.jc.snippet(pt,!0,null,!0),dt.length===2&&(this[gt[ft]+"jc"]=dt[ft])):ut.isFunction(pt)?mt[ft]=pt:ut.isNumber(pt)?mt[ft]=function(vt){return function(){return vt}}(pt):ut.isObject(pt)&&ut.isFunction(pt.Value)&&(mt[ft]=function(vt){return function(){return vt.Value()}}(pt)),mt[ft].origin=pt;return dt.length===1?this.updateConstraint=function(){var vt=mt[0]();ut.isArray(vt)?this.coords.setCoordinates(lt.COORDS_BY_USER,vt):this.coords=vt}:dt.length===2?(this.XEval=mt[0],this.YEval=mt[1],this.setParents([mt[0].origin,mt[1].origin]),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.XEval(),this.YEval()])}):(this.ZEval=mt[0],this.XEval=mt[1],this.YEval=mt[2],this.setParents([mt[0].origin,mt[1].origin,mt[2].origin]),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])}),this.prepareUpdate().update(),this.board.isSuspendedUpdate||this.updateVisibility().updateRenderer(),this},addAnchor:function(dt,ft){this.relativeCoords=ft?new ot(lt.COORDS_BY_SCREEN,dt.slice(0,2),this.board):new ot(lt.COORDS_BY_USER,dt,this.board),this.element.addChild(this),ft&&this.addParents(this.element),this.XEval=function(){var pt,mt,gt,vt=ut.evaluate(this.visProp.offset);return ut.evaluate(this.visProp.islabel)?(pt=parseFloat(vt[0]),gt=this.element.getLabelAnchor(),mt=new ot(lt.COORDS_BY_SCREEN,[pt+this.relativeCoords.scrCoords[1]+gt.scrCoords[1],0],this.board),mt.usrCoords[1]):(gt=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+gt.usrCoords[1])},this.YEval=function(){var pt,mt,gt,vt=ut.evaluate(this.visProp.offset);return ut.evaluate(this.visProp.islabel)?(pt=-parseFloat(vt[1]),gt=this.element.getLabelAnchor(),mt=new ot(lt.COORDS_BY_SCREEN,[0,pt+this.relativeCoords.scrCoords[2]+gt.scrCoords[2]],this.board),mt.usrCoords[2]):(gt=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+gt.usrCoords[2])},this.ZEval=ut.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.coords=new ot(lt.COORDS_BY_SCREEN,[0,0],this.board)},updateTransform:function(){var dt;if(this.transformations.length===0)return this;for(dt=0;dt<this.transformations.length;dt++)this.transformations[dt].update();return this},addTransform:function(dt,ft){var pt,mt=ut.isArray(ft)?ft:[ft],gt=mt.length;for(this.transformations.length===0&&(this.baseElement=dt),pt=0;pt<gt;pt++)this.transformations.push(mt[pt]);return this},startAnimation:function(dt,ft){var pt=this;return this.type!==lt.OBJECT_TYPE_GLIDER||ut.exists(this.intervalCode)||(this.intervalCode=window.setInterval(function(){pt._anim(dt,ft)},250),ut.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return ut.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(dt,ft,pt){pt=pt||{};var mt,gt,vt,At,yt,xt=[],_t=[],Et=this.board.attr.animationdelay,bt=ft/Et,wt=function(Tt,Mt){return function(){return dt[Tt][Mt]}};if(ut.isArray(dt)){for(vt=dt.length,mt=0;mt<vt;mt++)ut.isPoint(dt[mt])?_t[mt]=dt[mt]:_t[mt]={elementClass:lt.OBJECT_CLASS_POINT,X:wt(mt,0),Y:wt(mt,1)};if((ft=ft||0)===0)return this.setPosition(lt.COORDS_BY_USER,[_t[_t.length-1].X(),_t[_t.length-1].Y()]),this.board.update(this);if(!ut.exists(pt.interpolate)||pt.interpolate)for(gt=it.Neville(_t),mt=0;mt<bt;mt++)xt[mt]=[],xt[mt][0]=gt[0]((bt-mt)/bt*gt[3]()),xt[mt][1]=gt[1]((bt-mt)/bt*gt[3]());else{for(vt=dt.length-1,mt=0;mt<bt;++mt)At=Math.floor(mt/bt*vt),yt=mt/bt*vt-At,xt[mt]=[],xt[mt][0]=(1-yt)*_t[At].X()+yt*_t[At+1].X(),xt[mt][1]=(1-yt)*_t[At].Y()+yt*_t[At+1].Y();xt.push([_t[vt].X(),_t[vt].Y()]),xt.reverse()}this.animationPath=xt}else ut.isFunction(dt)&&(this.animationPath=dt,this.animationStart=new Date().getTime());return this.animationCallback=pt.callback,this.board.addAnimation(this),this},moveTo:function(dt,ft,pt){pt=pt||{},dt=new ot(lt.COORDS_BY_USER,dt,this.board);var mt,gt=this.board.attr.animationdelay,vt=Math.ceil(ft/gt),At=[],yt=this.coords.usrCoords[1],xt=this.coords.usrCoords[2],_t=dt.usrCoords[1]-yt,Et=dt.usrCoords[2]-xt,bt=function(wt){return pt.effect&&pt.effect==="<>"?Math.pow(Math.sin(wt/vt*Math.PI/2),2):wt/vt};if(!ut.exists(ft)||ft===0||Math.abs(dt.usrCoords[0]-this.coords.usrCoords[0])>rt.eps)return this.setPosition(lt.COORDS_BY_USER,dt.usrCoords),this.board.update(this);if(!ut.exists(pt.callback)&&Math.abs(_t)<rt.eps&&Math.abs(Et)<rt.eps)return this;for(mt=vt;mt>=0;mt--)At[vt-mt]=[dt.usrCoords[0],yt+_t*bt(mt),xt+Et*bt(mt)];return this.animationPath=At,this.animationCallback=pt.callback,this.board.addAnimation(this),this},visit:function(dt,ft,pt){dt=new ot(lt.COORDS_BY_USER,dt,this.board);var mt,gt,vt,At=this.board.attr.animationdelay,yt=[],xt=this.coords.usrCoords[1],_t=this.coords.usrCoords[2],Et=dt.usrCoords[1]-xt,bt=dt.usrCoords[2]-_t,wt=function(Tt){var Mt=Tt<vt/2?2*Tt/vt:2*(vt-Tt)/vt;return pt.effect&&pt.effect==="<>"?Math.pow(Math.sin(Mt*Math.PI/2),2):Mt};for(ut.isNumber(pt)?pt={repeat:pt}:(pt=pt||{},ut.exists(pt.repeat)||(pt.repeat=1)),vt=Math.ceil(ft/(At*pt.repeat)),gt=0;gt<pt.repeat;gt++)for(mt=vt;mt>=0;mt--)yt[gt*(vt+1)+vt-mt]=[dt.usrCoords[0],xt+Et*wt(mt),_t+bt*wt(mt)];return this.animationPath=yt,this.animationCallback=pt.callback,this.board.addAnimation(this),this},_anim:function(dt,ft){var pt,mt,gt,vt,At,yt,xt,_t,Et=1;return this.intervalCount+=1,this.intervalCount>ft&&(this.intervalCount=0),this.slideObject.elementClass===lt.OBJECT_CLASS_LINE?(pt=this.slideObject.point1.coords.distance(lt.COORDS_BY_SCREEN,this.slideObject.point2.coords),mt=this.slideObject.getSlope(),mt!==1/0?(At=Math.atan(mt),gt=Math.round(this.intervalCount/ft*pt*Math.cos(At)),vt=Math.round(this.intervalCount/ft*pt*Math.sin(At))):(gt=0,vt=Math.round(this.intervalCount/ft*pt)),dt<0?(yt=this.slideObject.point2,(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0||this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]==0&&this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0)&&(Et=-1)):(yt=this.slideObject.point1,(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0||this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]==0&&this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0)&&(Et=-1)),this.coords.setCoordinates(lt.COORDS_BY_SCREEN,[yt.coords.scrCoords[1]+Et*gt,yt.coords.scrCoords[2]+Et*vt])):this.slideObject.elementClass===lt.OBJECT_CLASS_CURVE?(xt=dt>0?Math.round(this.intervalCount/ft*this.board.canvasWidth):Math.round((ft-this.intervalCount)/ft*this.board.canvasWidth),this.coords.setCoordinates(lt.COORDS_BY_SCREEN,[xt,0]),this.coords=nt.projectPointToCurve(this,this.slideObject,this.board)):this.slideObject.elementClass===lt.OBJECT_CLASS_CIRCLE&&(At=dt<0?this.intervalCount/ft*2*Math.PI:(ft-this.intervalCount)/ft*2*Math.PI,_t=this.slideObject.Radius(),this.coords.setCoordinates(lt.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+_t*Math.cos(At),this.slideObject.center.coords.usrCoords[2]+_t*Math.sin(At)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var dt=[this.Z(),this.X(),this.Y()];return this.parents.length!==0&&(dt=this.parents),this.type===lt.OBJECT_TYPE_GLIDER&&(dt=[this.X(),this.Y(),this.slideObject.id]),dt}}),tt.CoordsElement.create=function(dt,ft,pt,mt,gt,vt){var At,yt,xt=!1;for(yt=0;yt<pt.length;yt++)(ut.isFunction(pt[yt])||ut.isString(pt[yt]))&&(xt=!0);if(xt)At=new dt(ft,[0,0],mt,gt,vt),At.addConstraint(pt);else if(ut.isNumber(pt[0])&&ut.isNumber(pt[1]))At=new dt(ft,pt,mt,gt,vt),ut.exists(mt.slideobject)?At.makeGlider(mt.slideobject):At.baseElement=At,At.isDraggable=!0;else{if(!ut.isObject(pt[0])||!ut.isTransformationOrArray(pt[1]))return!1;At=new dt(ft,[0,0],mt,gt,vt),At.addTransform(pt[0],pt[1]),At.isDraggable=!1}return At.handleSnapToGrid(),At.handleSnapToPoints(),At.handleAttractors(),At.addParents(pt),At},tt.CoordsElement}),define("base/text",["jxg","base/constants","base/coords","base/element","parser/geonext","math/statistics","utils/env","utils/type","math/math","base/coordselement"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct){var ut={HTMLSliderInputEventHandler:function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()}};return tt.Text=function(ht,dt,ft,pt){this.constructor(ht,ft,_e.OBJECT_TYPE_TEXT,_e.OBJECT_CLASS_TEXT),this.element=this.board.select(ft.anchor),this.coordsConstructor(dt,lt.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this._setUpdateText(pt),this.updateText(),this.board.renderer.drawText(this),this.board.finalizeAdding(this),lt.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=lt.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},tt.Text.prototype=new nt,lt.copyPrototypeMethods(tt.Text,ct,"coordsConstructor"),tt.extend(tt.Text.prototype,{hasPoint:function(ht,dt){var ft,pt,mt,gt,vt,At,yt=this.board.options.precision.hasPoint;return this.transformations.length>0&&(ft=at.matVecMult(at.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,ht,dt]),ht=ft[1],dt=ft[2]),vt=this.getAnchorX(),ft=vt==="right"?this.coords.scrCoords[1]-this.size[0]:vt==="middle"?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1],pt=ft+this.size[0],At=this.getAnchorY(),gt=At==="top"?this.coords.scrCoords[2]+this.size[1]:At==="middle"?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2],mt=gt-this.size[1],lt.evaluate(this.visProp.dragarea)==="all"?ht>=ft-yt&&ht<pt+yt&&dt>=mt-yt&&dt<=gt+yt:dt>=mt-yt&&dt<=gt+yt&&(ht>=ft-yt&&ht<=ft+2*yt||ht>=pt-2*yt&&ht<=pt+yt)},_setUpdateText:function(ht){var dt,ft,pt=lt.evaluate(this.visProp.parse),mt=lt.evaluate(this.visProp.usemathjax);this.orgText=ht,lt.isFunction(ht)?this.updateText=function(){ft=ht().toString(),this.plaintext=pt&&!mt?this.replaceSub(this.replaceSup(this.convertGeonext2CSS(ft))):ft}:lt.isString(ht)&&!pt?this.updateText=function(){this.plaintext=ht}:(lt.isNumber(ht)?this.content=lt.toFixed(ht,lt.evaluate(this.visProp.digits)):lt.evaluate(this.visProp.useasciimathml)?this.content="'`"+ht+"`'":this.content=mt?"'"+ht+"'":this.generateTerm(ht,!0,!0),dt=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=dt()})},_setText:function(ht){return this._setUpdateText(ht),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(ht){var dt;return this.visProp.castext=ht,dt=lt.isFunction(ht)?function(){return lt.sanitizeHTML(ht())}:lt.isNumber(ht)?ht:lt.sanitizeHTML(ht),this._setText(dt)},setText:function(ht){return this._setText(ht)},updateSize:function(){var ht,dt,ft,pt,mt=lt.evaluate(this.visProp.display);if(!ot.isBrowser||this.board.renderer.type==="no")return this;if(pt=this.rendNode,mt==="html"||this.board.renderer.type==="vml")lt.exists(pt.offsetWidth)?(dt=[pt.offsetWidth,pt.offsetHeight],dt[0]===0&&dt[1]===0?(ft=this,window.setTimeout(function(){ft.size=[pt.offsetWidth,pt.offsetHeight],ft.needsUpdate=!0,ft.updateRenderer()},0)):this.size=dt):this.size=this.crudeSizeEstimate();else if(mt==="internal")if(this.board.renderer.type==="svg")try{ht=pt.getBBox(),this.size=[ht.width,ht.height]}catch{}else this.board.renderer.type==="canvas"&&(this.size=this.crudeSizeEstimate());return this},crudeSizeEstimate:function(){var ht=parseFloat(lt.evaluate(this.visProp.fontsize));return[ht*this.plaintext.length*.45,.9*ht]},utf8_decode:function(ht){return ht.replace(/&#x(\w+);/g,function(dt,ft){return String.fromCharCode(parseInt(ft,16))})},replaceSub:function(ht){if(!ht.indexOf)return ht;for(var dt,ft=ht.indexOf("_{");ft>=0;)ht=ht.substr(0,ft)+ht.substr(ft).replace(/_\{/,"<sub>"),dt=ht.substr(ft).indexOf("}"),dt>=0&&(ht=ht.substr(0,dt)+ht.substr(dt).replace(/\}/,"</sub>")),ft=ht.indexOf("_{");for(ft=ht.indexOf("_");ft>=0;)ht=ht.substr(0,ft)+ht.substr(ft).replace(/_(.?)/,"<sub>$1</sub>"),ft=ht.indexOf("_");return ht},replaceSup:function(ht){if(!ht.indexOf)return ht;for(var dt,ft=ht.indexOf("^{");ft>=0;)ht=ht.substr(0,ft)+ht.substr(ft).replace(/\^\{/,"<sup>"),dt=ht.substr(ft).indexOf("}"),dt>=0&&(ht=ht.substr(0,dt)+ht.substr(dt).replace(/\}/,"</sup>")),ft=ht.indexOf("^{");for(ft=ht.indexOf("^");ft>=0;)ht=ht.substr(0,ft)+ht.substr(ft).replace(/\^(.?)/,"<sup>$1</sup>"),ft=ht.indexOf("^");return ht},getSize:function(){return this.size},setCoords:function(ht,dt){var ft,pt,mt;return lt.isArray(ht)&&ht.length>1&&(dt=ht[1],ht=ht[0]),lt.evaluate(this.visProp.islabel)&&lt.exists(this.element)?(ft=this.element.getLabelAnchor(),pt=(ht-ft.usrCoords[1])*this.board.unitX,mt=-(dt-ft.usrCoords[2])*this.board.unitY,this.relativeCoords.setCoordinates(_e.COORDS_BY_SCREEN,[pt,mt])):this.coords.setCoordinates(_e.COORDS_BY_USER,[ht,dt]),this.fullUpdate(),this},update:function(ht){return this.needsUpdate?(this.updateCoords(ht),this.updateText(),lt.evaluate(this.visProp.display)==="internal"&&lt.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return this.updateRendererGeneric("updateText")},expandShortMath:function(ht){var dt=/([\)0-9\.])\s*([\(a-zA-Z_])/g;return ht.replace(dt,"$1*$2")},generateTerm:function(ht,dt,ft){var pt,mt,gt,vt,At='""';if(ht=ht||"",ht=ht.replace(/\r/g,""),ht=ht.replace(/\n/g,""),ht=ht.replace(/"/g,"'"),ht=ht.replace(/'/g,"\\'"),ht=ht.replace(/&amp;arc;/g,"&ang;"),ht=ht.replace(/<arc\s*\/>/g,"&ang;"),ht=ht.replace(/&lt;arc\s*\/&gt;/g,"&ang;"),ht=ht.replace(/&lt;sqrt\s*\/&gt;/g,"&radic;"),ht=ht.replace(/&lt;value&gt;/g,"<value>"),ht=ht.replace(/&lt;\/value&gt;/g,"</value>"),gt=ht.indexOf("<value>"),vt=ht.indexOf("</value>"),gt>=0)for(;gt>=0;)At+=' + "'+this.replaceSub(this.replaceSup(ht.slice(0,gt)))+'"',mt=ht.slice(gt+7,vt),mt=mt.replace(/\s+/g,""),dt===!0&&(mt=this.expandShortMath(mt)),pt=ft?mt:it.geonext2JS(mt,this.board),pt=pt.replace(/\\"/g,"'"),pt=pt.replace(/\\'/g,"'"),pt.indexOf("toFixed")<0&&lt.isNumber(lt.bind(this.board.jc.snippet(pt,!0,"",!1),this)())?At+="+("+pt+").toFixed("+lt.evaluate(this.visProp.digits)+")":At+="+("+pt+")",ht=ht.slice(vt+8),gt=ht.indexOf("<value>"),vt=ht.indexOf("</value>");return At+=' + "'+this.replaceSub(this.replaceSup(ht))+'"',At=this.convertGeonext2CSS(At),At=At.replace(/&amp;/g,"&"),At=At.replace(/"/g,"'")},convertGeonext2CSS:function(ht){return lt.isString(ht)&&(ht=ht.replace(/<overline>/g,"<span style=text-decoration:overline>"),ht=ht.replace(/&lt;overline&gt;/g,"<span style=text-decoration:overline>"),ht=ht.replace(/<\/overline>/g,"</span>"),ht=ht.replace(/&lt;\/overline&gt;/g,"</span>"),ht=ht.replace(/<arrow>/g,"<span style=text-decoration:overline>"),ht=ht.replace(/&lt;arrow&gt;/g,"<span style=text-decoration:overline>"),ht=ht.replace(/<\/arrow>/g,"</span>"),ht=ht.replace(/&lt;\/arrow&gt;/g,"</span>")),ht},notifyParents:function(ht){var dt,ft=null;ht=ht.replace(/&lt;value&gt;/g,"<value>"),ht=ht.replace(/&lt;\/value&gt;/g,"</value>");do dt=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/,(ft=dt.exec(ht))!==null&&(it.findDependencies(this,ft[1],this.board),ht=ht.substr(ft.index),ht=ht.replace(dt,""));while(ft!==null);return this},getParents:function(){var ht;return ht=this.relativeCoords!==void 0?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],this.parents.length!==0&&(ht=this.parents),ht},bounds:function(){var ht=this.coords.usrCoords;return lt.evaluate(this.visProp.islabel)||this.board.unitY===0||this.board.unitX===0?[0,0,0,0]:[ht[1],ht[2]+this.size[1]/this.board.unitY,ht[1]+this.size[0]/this.board.unitX,ht[2]]},getAnchorX:function(){var ht=lt.evaluate(this.visProp.anchorx);if(ht=="auto")switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";case"lft":case"llft":case"ulft":default:return"right"}return ht},getAnchorY:function(){var ht=lt.evaluate(this.visProp.anchory);if(ht=="auto")switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";case"rt":case"lft":default:return"middle"}return ht}}),tt.createText=function(ht,dt,ft){var pt,mt=lt.copyAttributes(ft,ht.options,"text"),gt=dt.slice(0,-1),vt=dt[dt.length-1];if(mt.anchor=mt.parent||mt.anchor,!(pt=ct.create(tt.Text,ht,gt,mt,vt)))throw new Error("JSXGraph: Can't create text with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return lt.evaluate(mt.rotate)!==0&&mt.display==="internal"&&pt.addRotation(lt.evaluate(mt.rotate)),pt},tt.registerElement("text",tt.createText),tt.createHTMLSlider=function(ht,dt,ft){var pt,mt,gt=lt.copyAttributes(ft,ht.options,"htmlslider");if(dt.length!==2||dt[0].length!==2||dt[1].length!==3)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+`'.
Possible parents are: [[x,y], [min, start, max]]`);gt.anchor=gt.parent||gt.anchor,gt.fixed=gt.fixed||!0,mt=[dt[0][0],dt[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],pt=tt.createText(ht,mt,gt),pt.type=lt.OBJECT_TYPE_HTMLSLIDER,pt.rendNodeForm=pt.rendNode.childNodes[0],pt.rendNodeRange=pt.rendNodeForm.childNodes[0],pt.rendNodeRange.min=dt[1][0],pt.rendNodeRange.max=dt[1][2],pt.rendNodeRange.step=gt.step,pt.rendNodeRange.value=dt[1][1],pt.rendNodeLabel=pt.rendNodeForm.childNodes[1],pt.rendNodeLabel.id=pt.rendNode.id+"_label",gt.withlabel&&(pt.rendNodeLabel.innerHTML=pt.name+"="),pt.rendNodeOut=pt.rendNodeForm.childNodes[2],pt.rendNodeOut.value=dt[1][1];try{pt.rendNodeForm.id=pt.rendNode.id+"_form",pt.rendNodeRange.id=pt.rendNode.id+"_range",pt.rendNodeOut.id=pt.rendNode.id+"_out"}catch(vt){tt.debug(vt)}return pt.rendNodeRange.style.width=gt.widthrange+"px",pt.rendNodeRange.style.verticalAlign="middle",pt.rendNodeOut.style.width=gt.widthout+"px",pt._val=dt[1][1],tt.supportsVML()?ot.addEvent(pt.rendNodeForm,"change",ut.HTMLSliderInputEventHandler,pt):ot.addEvent(pt.rendNodeForm,"input",ut.HTMLSliderInputEventHandler,pt),pt.Value=function(){return this._val},pt},tt.registerElement("htmlslider",tt.createHTMLSlider),{Text:tt.Text,createText:tt.createText,createHTMLSlider:tt.createHTMLSlider}}),define("utils/uuid",["jxg"],function(tt){var _e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",rt=_e.split("");return tt.Util=tt.Util||{},tt.Util.genUUID=function(){var nt,it,st=[],ot=0;for(it=0;it<36;it++)it===8||it===13||it===18||it===23?st[it]="-":it===14?st[it]="4":(ot<=2&&(ot=33554432+16777216*Math.random()|0),nt=15&ot,ot>>=4,st[it]=rt[it===19?3&nt|8:nt]);return st.join("")},tt.Util}),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],function(JXG,Const,Text,Mat,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(tt,_e){function rt(){}if(typeof tt!="object"&&typeof tt!="function")throw new TypeError("Object prototype may only be an Object: "+tt);if(tt===null)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(_e!==void 0)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");return rt.prototype=tt,new rt});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}};JXG.JessieCode=function(tt,_e){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="",typeof tt=="string"&&this.parse(tt,_e)},JXG.extend(JXG.JessieCode.prototype,{node:function(tt,_e,rt){return{type:tt,value:_e,children:rt}},createNode:function(tt,_e,rt){var nt,it=this.node(tt,_e,[]);for(nt=2;nt<arguments.length;nt++)it.children.push(arguments[nt]);return it.type=="node_const"&&Type.isNumber(it.value)&&(it.isMath=!0),it.line=this.parCurLine,it.col=this.parCurColumn,it},pushScope:function(tt){var _e={args:tt,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=_e,_e.id=this.scopes.push(_e)-1,_e},popScope:function(){var tt=this.scope.previous;return this.scope=tt!==null?tt:this.scope,this.scope},getElementById:function(tt){return this.board.objects[tt]},log:function(){this.$log.push(arguments),typeof console=="object"&&console.log&&console.log.apply(console,arguments)},creator:function(){var tt,_e={};return tt=function(rt){var nt;return typeof _e[this.board.id+rt]=="function"?nt=_e[this.board.id+rt]:(nt=function(it){return function(st,ot){var lt;return lt=Type.exists(ot)?ot:{name:it.lhs[it.scope]!==0?it.lhs[it.scope]:""},it.board.create(rt,st,lt)}}(this),nt.creator=!0,_e[this.board.id+rt]=nt),nt},tt.clearCache=function(){_e={}},tt}(),letvar:function(tt,_e){this.builtIn[tt]&&this._warn('"'+tt+'" is a predefined value.'),this.scope.locals[tt]=_e},isLocalVariable:function(tt){for(var _e=this.scope;_e!==null;){if(Type.exists(_e.locals[tt]))return _e;_e=_e.previous}return null},isParameter:function(tt){for(var _e=this.scope;_e!==null;){if(Type.indexOf(_e.args,tt)>-1)return _e;_e=_e.previous}return null},isCreator:function(tt){return!!JXG.elements[tt]},isMathMethod:function(tt){return tt!=="E"&&!!Math[tt]},isBuiltIn:function(tt){return!!this.builtIn[tt]},getvar:function(tt,_e){var rt;return _e=Type.def(_e,!1),rt=this.isLocalVariable(tt),rt!==null?rt.locals[tt]:this.isCreator(tt)?this.creator(tt):this.isBuiltIn(tt)?this.builtIn[tt]:this.isMathMethod(tt)?Math[tt]:_e||(rt=this.board.select(tt))===tt?void 0:rt},resolve:function(tt){for(var _e=this.scope;_e!==null;){if(Type.exists(_e.locals[tt]))return _e.locals[tt];_e=_e.previous}},getvarJS:function(tt,_e,rt){var nt="";return _e=Type.def(_e,!1),rt=Type.def(rt,!1),this.isParameter(tt)!==null?tt:this.isLocalVariable(tt)===null||rt?this.isCreator(tt)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(rt?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+tt+"'].concat([a, props])); })":(rt&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(tt)?this.builtIn[tt].src||this.builtIn[tt]:this.isMathMethod(tt)?"Math."+tt:_e?"":(Type.isId(this.board,tt)?nt="$jc$.board.objects['"+tt+"']":Type.isName(this.board,tt)?nt="$jc$.board.elementsByName['"+tt+"']":Type.isGroup(this.board,tt)&&(nt="$jc$.board.groups['"+tt+"']"),nt)):"$jc$.resolve('"+tt+"')"},makeMap:function(tt){return tt.isMap=!0,tt},functionCodeJS:function(tt){var _e=tt.children[0].join(", "),rt="",nt="";return tt.value==="op_map"&&(rt="{ return  ",nt=" }"),"function ("+_e+`) {
var $oldscope$ = $jc$.scope;
$jc$.scope = $jc$.scopes[`+this.scope.id+`];
var r = (function () `+rt+this.compile(tt.children[1],!0)+nt+`)();
$jc$.scope = $oldscope$;
return r;
}`},defineFunction:function(node){var fun,i,list=node.children[0],scope=this.pushScope(list);if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{return fun=eval(str)}catch(tt){return $jc$._warn(`error compiling function

`+str+`

`+tt.toString()),function(){}}}(this),this.popScope()}else fun=function(tt,_e,rt){return function(){var nt,it;for(it=_e.scope,_e.scope=_e.scopes[rt],nt=0;nt<tt.length;nt++)_e.scope.locals[tt[nt]]=arguments[nt];return nt=_e.execute(node.children[1]),_e.scope=it,nt}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=function(tt){return function(){return tt.compile(tt.replaceIDs(Type.deepCopy(node)))}}(this),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(tt){var _e,rt={};for(_e=0;_e<arguments.length;_e++)rt=Type.deepCopy(rt,arguments[_e],!0);return rt},setProp:function(tt,_e,rt){var nt,it,st={};tt.elementClass!==Const.OBJECT_CLASS_POINT||_e!=="X"&&_e!=="Y"?tt.elementClass!==Const.OBJECT_CLASS_TEXT||_e!=="X"&&_e!=="Y"?tt.type&&tt.elementClass&&tt.visProp?Type.exists(tt[tt.methodMap[_e]])&&typeof tt[tt.methodMap[_e]]!="function"?tt[tt.methodMap[_e]]=rt:(st[_e]=rt,tt.setAttribute(st)):tt[_e]=rt:(typeof rt=="number"?tt[_e]=function(){return rt}:typeof rt=="function"?(tt.isDraggable=!1,tt[_e]=rt):typeof rt=="string"&&(tt.isDraggable=!1,tt[_e]=Type.createFunction(rt,this.board,null,!0),tt[_e+"jc"]=rt),tt[_e].origin=rt,this.board.update()):(_e=_e.toLowerCase(),tt.isDraggable&&typeof rt=="number"?(nt=_e==="x"?rt:tt.X(),it=_e==="y"?rt:tt.Y(),tt.setPosition(Const.COORDS_BY_USER,[nt,it])):!tt.isDraggable||typeof rt!="function"&&typeof rt!="string"?tt.isDraggable||(nt=_e==="x"?rt:tt.XEval.origin,it=_e==="y"?rt:tt.YEval.origin,tt.addConstraint([nt,it])):(nt=_e==="x"?rt:tt.coords.usrCoords[1],it=_e==="y"?rt:tt.coords.usrCoords[2],tt.addConstraint([nt,it])),this.board.update())},_genericParse:function(tt,_e,rt,nt){var it,st,ot,lt,at=tt.replace(/\r\n/g,`
`).split(`
`),ct=[];nt||(this.code+=tt+`
`),Text&&(st=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(rt)||(rt=!1),it=0;it<at.length;it++)rt&&(at[it]=JXG.GeonextParser.geonext2JS(at[it],this.board)),ct.push(at[it]);switch(tt=ct.join(`
`),ot=parser.parse(tt),this.CA&&(ot=this.CA.expandDerivatives(ot,null,ot),ot=this.CA.removeTrivialNodes(ot)),_e){case"parse":lt=this.execute(ot);break;case"manipulate":lt=this.compile(ot);break;case"getAst":lt=ot;break;default:lt=!1}}catch(ut){console.log(ut)}finally{Text&&(Text.Text.prototype.setText=st)}return lt},parse:function(tt,_e,rt){return this._genericParse(tt,"parse",_e,rt)},manipulate:function(tt,_e,rt){return this._genericParse(tt,"manipulate",_e,rt)},getAST:function(tt,_e,rt){return this._genericParse(tt,"getAst",_e,rt)},snippet:function(tt,_e,rt,nt){var it;return _e=Type.def(_e,!0),rt=Type.def(rt,""),nt=Type.def(nt,!1),it=(_e?" function ("+rt+") { return ":"")+tt+(_e?"; }":"")+";",this.parse(it,nt,!0)},replaceIDs:function(tt){var _e,rt;if(tt.replaced&&(rt=this.board.objects[tt.children[1][0].value],Type.exists(rt)&&rt.name!==""&&(tt.type="node_var",tt.value=rt.name,tt.children.length=0,delete tt.replaced)),tt.children)for(_e=tt.children.length;_e>0;_e--)Type.exists(tt.children[_e-1])&&(tt.children[_e-1]=this.replaceIDs(tt.children[_e-1]));return tt},replaceNames:function(tt){var _e,rt;if(rt=tt.value,tt.type==="node_op"&&rt==="op_lhs"&&tt.children.length===1?this.isLHS=!0:tt.type==="node_var"&&(this.isLHS?this.letvar(rt,!0):!Type.exists(this.getvar(rt,!0))&&Type.exists(this.board.elementsByName[rt])&&(tt=this.createReplacementNode(tt))),tt.children)for(_e=tt.children.length;_e>0;_e--)Type.exists(tt.children[_e-1])&&(tt.children[_e-1]=this.replaceNames(tt.children[_e-1]));return tt.type==="node_op"&&tt.value==="op_lhs"&&tt.children.length===1&&(this.isLHS=!1),tt},createReplacementNode:function(tt){var _e=tt.value,rt=this.board.elementsByName[_e];return tt=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",rt.id)]),tt.replaced=!0,tt},collectDependencies:function(tt,_e){var rt,nt,it,st;if(Type.isArray(tt))for(st=tt.length,rt=0;rt<st;rt++)this.collectDependencies(tt[rt],_e);else if(nt=tt.value,tt.type==="node_var"&&(it=this.getvar(nt))&&it.visProp&&it.type&&it.elementClass&&it.id&&(_e[it.id]=it),tt.type==="node_op"&&tt.value==="op_execfun"&&tt.children.length>1&&tt.children[0].value==="$"&&tt.children[1].length>0&&(it=tt.children[1][0].value,_e[it]=this.board.objects[it]),tt.children)for(rt=tt.children.length;rt>0;rt--)Type.exists(tt.children[rt-1])&&this.collectDependencies(tt.children[rt-1],_e)},resolveProperty:function(tt,_e,rt){return rt=Type.def(rt,!1),tt&&tt.methodMap&&(Type.exists(tt.subs)&&Type.exists(tt.subs[_e])?tt=tt.subs:Type.exists(tt.methodMap[_e])?_e=tt.methodMap[_e]:(tt=tt.visProp,_e=_e.toLowerCase())),Type.isFunction(tt)&&this._error("Accessing function properties is not allowed."),Type.exists(tt)||this._error(tt+" is not an object"),Type.exists(tt[_e])||this._error("unknown property "+_e),rt&&typeof tt[_e]=="function"?function(){return tt[_e].apply(tt,arguments)}:tt[_e]},getLHS:function(tt){var _e;if(tt.type==="node_var")_e={o:this.scope.locals,what:tt.value};else if(tt.type==="node_op"&&tt.value==="op_property")_e={o:this.execute(tt.children[0]),what:tt.children[1]};else{if(tt.type!=="node_op"||tt.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");_e={o:this.execute(tt.children[0]),what:this.execute(tt.children[1])}}return _e},getLHSCompiler:function(tt,_e){var rt;if(tt.type==="node_var")rt=tt.value;else if(tt.type==="node_op"&&tt.value==="op_property")rt=[this.compile(tt.children[0],_e),"'"+tt.children[1]+"'"];else{if(tt.type!=="node_op"||tt.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");rt=[this.compile(tt.children[0],_e),tt.children[1].type==="node_const"?tt.children[1].value:this.compile(tt.children[1],_e)]}return rt},execute:function(tt){var _e,rt,nt,it,st,ot,lt,at,ct,ut,ht=[];if(_e=0,!tt)return _e;switch(this.line=tt.line,this.col=tt.col,tt.type){case"node_op":switch(tt.value){case"op_none":tt.children[0]&&this.execute(tt.children[0]),tt.children[1]&&(_e=this.execute(tt.children[1]));break;case"op_assign":rt=this.getLHS(tt.children[0]),this.lhs[this.scope.id]=rt[1],rt.o.type&&rt.o.elementClass&&rt.o.methodMap&&rt.what==="label"&&this._error("Left-hand side of assignment is read-only."),_e=this.execute(tt.children[1]),rt.o!==this.scope.locals||Type.isArray(rt.o)&&typeof rt.what=="number"?this.setProp(rt.o,rt.what,_e):this.letvar(rt.what,_e),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(tt.children[0])&&(_e=this.execute(tt.children[1]));break;case"op_conditional":case"op_if_else":_e=this.execute(tt.children[0])?this.execute(tt.children[1]):this.execute(tt.children[2]);break;case"op_while":for(;this.execute(tt.children[0]);)this.execute(tt.children[1]);break;case"op_do":do this.execute(tt.children[0]);while(this.execute(tt.children[1]));break;case"op_for":for(this.execute(tt.children[0]);this.execute(tt.children[1]);this.execute(tt.children[2]))this.execute(tt.children[3]);break;case"op_proplst":tt.children[0]&&this.execute(tt.children[0]),tt.children[1]&&this.execute(tt.children[1]);break;case"op_emptyobject":_e={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(tt.children[0]),_e=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][tt.children[0]]=this.execute(tt.children[1]);break;case"op_array":for(_e=[],st=tt.children[0].length,nt=0;nt<st;nt++)_e.push(this.execute(tt.children[0][nt]));break;case"op_extvalue":_e=this.execute(tt.children[0]),nt=this.execute(tt.children[1]),_e=typeof nt=="number"&&Math.abs(Math.round(nt)-nt)<Mat.eps?_e[nt]:void 0;break;case"op_return":if(this.scope!==0)return this.execute(tt.children[0]);this._error("Unexpected return.");break;case"op_map":tt.children[1].isMath||tt.children[1].type==="node_var"||this._error("execute: In a map only function calls and mathematical expressions are allowed."),at=this.defineFunction(tt),at.isMap=!0,_e=at;break;case"op_function":at=this.defineFunction(tt),at.isMap=!1,_e=at;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,ot=tt.children[1],Type.exists(tt.children[2]))if(tt.children[3])for(lt=tt.children[2],ct={},nt=0;nt<lt.length;nt++)ct=Type.deepCopy(ct,this.execute(lt[nt]),!0);else ct=this.execute(tt.children[2]);for(at=this.execute(tt.children[0]),ut=at&&at.sc?at.sc:this,!at.creator&&Type.exists(tt.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),nt=0;nt<ot.length;nt++)ht[nt]=this.execute(ot[nt]),this.dpstack[this.pscope].push({line:tt.children[1][nt].line,col:tt.children[1][nt].ecol});if(typeof at!="function"||at.creator)if(typeof at=="function"&&at.creator){it=this.line;try{for(_e=at(ht,ct),_e.jcLineStart=it,_e.jcLineEnd=tt.eline,nt=it;nt<=tt.line;nt++)this.lineToElement[nt]=_e;_e.debugParents=this.dpstack[this.pscope]}catch(dt){this._error(dt.toString())}}else this._error("Function '"+at+"' is undefined.");else _e=at.apply(ut,ht);this.dpstack.pop(),this.pscope--;break;case"op_property":it=this.execute(tt.children[0]),rt=tt.children[1],_e=this.resolveProperty(it,rt,!1),Type.exists(_e)&&(_e.sc=it);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(tt.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),rt=this.getvar(tt.children[0]),_e=this.del(rt);break;case"op_equ":_e=this.execute(tt.children[0])==this.execute(tt.children[1]);break;case"op_neq":_e=this.execute(tt.children[0])!=this.execute(tt.children[1]);break;case"op_approx":_e=Math.abs(this.execute(tt.children[0])-this.execute(tt.children[1]))<Mat.eps;break;case"op_grt":_e=this.execute(tt.children[0])>this.execute(tt.children[1]);break;case"op_lot":_e=this.execute(tt.children[0])<this.execute(tt.children[1]);break;case"op_gre":_e=this.execute(tt.children[0])>=this.execute(tt.children[1]);break;case"op_loe":_e=this.execute(tt.children[0])<=this.execute(tt.children[1]);break;case"op_or":_e=this.execute(tt.children[0])||this.execute(tt.children[1]);break;case"op_and":_e=this.execute(tt.children[0])&&this.execute(tt.children[1]);break;case"op_not":_e=!this.execute(tt.children[0]);break;case"op_add":_e=this.add(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_sub":_e=this.sub(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_div":_e=this.div(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_mod":_e=this.mod(this.execute(tt.children[0]),this.execute(tt.children[1]),!0);break;case"op_mul":_e=this.mul(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_exp":_e=this.pow(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_neg":_e=this.neg(this.execute(tt.children[0]))}break;case"node_var":_e=this.getvar(tt.value);break;case"node_const":_e=Number(tt.value);break;case"node_const_bool":_e=tt.value;break;case"node_str":_e=tt.value.replace(/\\(.)/,"$1")}return _e},compile:function(tt,_e){var rt,nt,it,st="";if(Type.exists(_e)||(_e=!1),!tt)return st;switch(tt.type){case"node_op":switch(tt.value){case"op_none":tt.children[0]&&(st=this.compile(tt.children[0],_e)),tt.children[1]&&(st+=this.compile(tt.children[1],_e));break;case"op_assign":_e?(rt=this.getLHSCompiler(tt.children[0],_e),Type.isArray(rt)?st="$jc$.setProp("+rt[0]+", "+rt[1]+", "+this.compile(tt.children[1],_e)+`);
`:(this.isLocalVariable(rt)!==this.scope&&(this.scope.locals[rt]=!0),st="$jc$.scopes["+this.scope.id+"].locals['"+rt+"'] = "+this.compile(tt.children[1],_e)+`;
`)):(rt=this.compile(tt.children[0]),st=rt+" = "+this.compile(tt.children[1],_e)+`;
`);break;case"op_if":st=" if ("+this.compile(tt.children[0],_e)+") "+this.compile(tt.children[1],_e);break;case"op_if_else":st=" if ("+this.compile(tt.children[0],_e)+")"+this.compile(tt.children[1],_e),st+=" else "+this.compile(tt.children[2],_e);break;case"op_conditional":st="(("+this.compile(tt.children[0],_e)+")?("+this.compile(tt.children[1],_e),st+="):("+this.compile(tt.children[2],_e)+"))";break;case"op_while":st=" while ("+this.compile(tt.children[0],_e)+`) {
`+this.compile(tt.children[1],_e)+`}
`;break;case"op_do":st=` do {
`+this.compile(tt.children[0],_e)+"} while ("+this.compile(tt.children[1],_e)+`);
`;break;case"op_for":st=" for ("+this.compile(tt.children[0],_e)+"; "+this.compile(tt.children[1],_e)+"; "+this.compile(tt.children[2],_e)+`) {
`+this.compile(tt.children[3],_e)+`
}
`;break;case"op_proplst":tt.children[0]&&(st=this.compile(tt.children[0],_e)+", "),st+=this.compile(tt.children[1],_e);break;case"op_prop":st=tt.children[0]+": "+this.compile(tt.children[1],_e);break;case"op_emptyobject":st=_e?"{}":"<< >>";break;case"op_proplst_val":st=this.compile(tt.children[0],_e);break;case"op_array":for(it=[],nt=0;nt<tt.children[0].length;nt++)it.push(this.compile(tt.children[0][nt],_e));st="["+it.join(", ")+"]";break;case"op_extvalue":st=this.compile(tt.children[0],_e)+"["+this.compile(tt.children[1],_e)+"]";break;case"op_return":st=" return "+this.compile(tt.children[0],_e)+`;
`;break;case"op_map":tt.children[1].isMath||tt.children[1].type==="node_var"||this._error("compile: In a map only function calls and mathematical expressions are allowed."),it=tt.children[0],st=_e?" $jc$.makeMap(function ("+it.join(", ")+") { return "+this.compile(tt.children[1],_e)+"; })":"map ("+it.join(", ")+") -> "+this.compile(tt.children[1],_e);break;case"op_function":it=tt.children[0],this.pushScope(it),st=_e?this.functionCodeJS(tt):" function ("+it.join(", ")+") "+this.compile(tt.children[1],_e),this.popScope();break;case"op_execfunmath":console.log("TODO"),st="-1";break;case"op_execfun":if(tt.children[2]){for(it=[],nt=0;nt<tt.children[2].length;nt++)it.push(this.compile(tt.children[2][nt],_e));_e&&(rt="$jc$.mergeAttributes("+it.join(", ")+")")}for(tt.children[0].withProps=!!tt.children[2],it=[],nt=0;nt<tt.children[1].length;nt++)it.push(this.compile(tt.children[1][nt],_e));st=this.compile(tt.children[0],_e)+"("+it.join(", ")+(tt.children[2]&&_e?", "+rt:"")+")"+(tt.children[2]&&!_e?rt:""),_e&&tt.children[0].value==="$"&&(st="$jc$.board.objects["+this.compile(tt.children[1][0],_e)+"]");break;case"op_property":st=_e&&tt.children[1]!=="X"&&tt.children[1]!=="Y"?"$jc$.resolveProperty("+this.compile(tt.children[0],_e)+", '"+tt.children[1]+"', true)":this.compile(tt.children[0],_e)+"."+tt.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),st=_e?"$jc$.use('":"use('",st+=tt.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),st=_e?"$jc$.del(":"remove(",st+=this.compile(tt.children[0],_e)+")";break;case"op_equ":st="("+this.compile(tt.children[0],_e)+" == "+this.compile(tt.children[1],_e)+")";break;case"op_neq":st="("+this.compile(tt.children[0],_e)+" != "+this.compile(tt.children[1],_e)+")";break;case"op_approx":st="("+this.compile(tt.children[0],_e)+" ~= "+this.compile(tt.children[1],_e)+")";break;case"op_grt":st="("+this.compile(tt.children[0],_e)+" > "+this.compile(tt.children[1],_e)+")";break;case"op_lot":st="("+this.compile(tt.children[0],_e)+" < "+this.compile(tt.children[1],_e)+")";break;case"op_gre":st="("+this.compile(tt.children[0],_e)+" >= "+this.compile(tt.children[1],_e)+")";break;case"op_loe":st="("+this.compile(tt.children[0],_e)+" <= "+this.compile(tt.children[1],_e)+")";break;case"op_or":st="("+this.compile(tt.children[0],_e)+" || "+this.compile(tt.children[1],_e)+")";break;case"op_and":st="("+this.compile(tt.children[0],_e)+" && "+this.compile(tt.children[1],_e)+")";break;case"op_not":st="!("+this.compile(tt.children[0],_e)+")";break;case"op_add":st=_e?"$jc$.add("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" + "+this.compile(tt.children[1],_e)+")";break;case"op_sub":st=_e?"$jc$.sub("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" - "+this.compile(tt.children[1],_e)+")";break;case"op_div":st=_e?"$jc$.div("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" / "+this.compile(tt.children[1],_e)+")";break;case"op_mod":st=_e?"$jc$.mod("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+", true)":"("+this.compile(tt.children[0],_e)+" % "+this.compile(tt.children[1],_e)+")";break;case"op_mul":st=_e?"$jc$.mul("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" * "+this.compile(tt.children[1],_e)+")";break;case"op_exp":st=_e?"$jc$.pow("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+"^"+this.compile(tt.children[1],_e)+")";break;case"op_neg":st=_e?"$jc$.neg("+this.compile(tt.children[0],_e)+")":"(-"+this.compile(tt.children[0],_e)+")"}break;case"node_var":st=_e?this.getvarJS(tt.value,!1,tt.withProps):tt.value;break;case"node_const":case"node_const_bool":st=tt.value;break;case"node_str":st="'"+tt.value+"'"}return tt.needsBrackets&&(st=`{
`+st+`}
`),st},X:function(tt){return tt.X()},Y:function(tt){return tt.Y()},V:function(tt){return tt.Value()},L:function(tt){return tt.L()},dist:function(tt,_e){return Type.exists(tt)&&Type.exists(tt.Dist)||this._error("Error: Can't calculate distance."),tt.Dist(_e)},add:function(tt,_e){var rt,nt,it;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isArray(_e))for(nt=Math.min(tt.length,_e.length),it=[],rt=0;rt<nt;rt++)it[rt]=tt[rt]+_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?it=tt+_e:Type.isString(tt)||Type.isString(_e)?it=tt.toString()+_e.toString():this._error("Operation + not defined on operands "+typeof tt+" and "+typeof _e);return it},sub:function(tt,_e){var rt,nt,it;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isArray(_e))for(nt=Math.min(tt.length,_e.length),it=[],rt=0;rt<nt;rt++)it[rt]=tt[rt]-_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?it=tt-_e:this._error("Operation - not defined on operands "+typeof tt+" and "+typeof _e);return it},neg:function(tt){var _e,rt,nt;if(tt=Type.evalSlider(tt),Type.isArray(tt))for(rt=tt.length,nt=[],_e=0;_e<rt;_e++)nt[_e]=-tt[_e];else Type.isNumber(tt)?nt=-tt:this._error("Unary operation - not defined on operand "+typeof tt);return nt},mul:function(tt,_e){var rt,nt,it;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e)&&(rt=tt,tt=_e,_e=tt),Type.isArray(tt)&&Type.isArray(_e))nt=Math.min(tt.length,_e.length),it=Mat.innerProduct(tt,_e,nt);else if(Type.isNumber(tt)&&Type.isArray(_e))for(nt=_e.length,it=[],rt=0;rt<nt;rt++)it[rt]=tt*_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?it=tt*_e:this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return it},div:function(tt,_e){var rt,nt,it;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e))for(nt=tt.length,it=[],rt=0;rt<nt;rt++)it[rt]=tt[rt]/_e;else Type.isNumber(tt)&&Type.isNumber(_e)?it=tt/_e:this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return it},mod:function(tt,_e){var rt,nt,it;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e))for(nt=tt.length,it=[],rt=0;rt<nt;rt++)it[rt]=Mat.mod(tt[rt],_e,!0);else Type.isNumber(tt)&&Type.isNumber(_e)?it=Mat.mod(tt,_e,!0):this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return it},pow:function(tt,_e){return tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Math.pow(tt,_e)},DDD:function(tt){console.log("Dummy derivative function. This should never appear!")},ifthen:function(tt,_e,rt){return tt?_e:rt},del:function(tt){typeof tt=="object"&&JXG.exists(tt.type)&&JXG.exists(tt.elementClass)&&this.board.removeObject(tt)},use:function(tt){var _e,rt,nt=!1;if(typeof tt=="string"){for(_e in JXG.boards)if(JXG.boards.hasOwnProperty(_e)&&JXG.boards[_e].container===tt){rt=JXG.boards[_e],nt=!0;break}}else rt=tt,nt=!0;nt?(this.board=rt,this.builtIn.$board=rt,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+tt+"' not found!")},findSymbol:function(tt,_e){var rt,nt;for(_e=Type.def(_e,-1),nt=_e===-1?this.scope:this.scopes[_e];nt!==null;){for(rt in nt.locals)if(nt.locals.hasOwnProperty(rt)&&nt.locals[rt]===tt)return[rt,nt];nt=nt.previous}return[]},importModule:function(tt){return priv.modules[tt.toLowerCase()]},defineBuiltIn:function(){var tt=this,_e={PI:Math.PI,EULER:Math.E,X:tt.X,Y:tt.Y,V:tt.V,L:tt.L,dist:tt.dist,rad:Geometry.rad,deg:Geometry.trueAngle,factorial:Mat.factorial,trunc:Type.trunc,log:Mat.log,ln:Math.log,log10:Mat.log10,lg:Mat.log10,log2:Mat.log2,lb:Mat.log2,ld:Mat.log2,cosh:Mat.cosh,sinh:Mat.sinh,IfThen:tt.ifthen,import:tt.importModule,use:tt.use,remove:tt.del,$:tt.getElementById,$board:tt.board,$log:tt.log,D:tt.DDD};return _e.rad.sc=Geometry,_e.deg.sc=Geometry,_e.factorial.sc=Mat,_e.X.src="$jc$.X",_e.Y.src="$jc$.Y",_e.V.src="$jc$.V",_e.L.src="$jc$.L",_e.dist.src="$jc$.dist",_e.rad.src="JXG.Math.Geometry.rad",_e.deg.src="JXG.Math.Geometry.trueAngle",_e.factorial.src="JXG.Math.factorial",_e.trunc.src="JXG.trunc",_e.ln.src="Math.log",_e.log10.src="JXG.Math.log10",_e.lg.src="JXG.Math.log10",_e.log2.src="JXG.Math.log2",_e.lb.src="JXG.Math.log2",_e.ld.src="JXG.Math.log2",_e.cosh.src="JXG.Math.cosh",_e.sinh.src="JXG.Math.sinh",_e.import.src="$jc$.importModule",_e.use.src="$jc$.use",_e.remove.src="$jc$.del",_e.IfThen.src="$jc$.ifthen",_e.$.src="(function (n) { return $jc$.board.select(n); })",_e.$board&&(_e.$board.src="$jc$.board"),_e.$log.src="$jc$.log",_e},_debug:function(tt){typeof console=="object"?console.log(tt):Env.isBrowser&&document&&document.getElementById("debug")!==null&&(document.getElementById("debug").innerHTML+=tt+"<br />")},_error:function(tt){var _e=new Error("Error("+this.line+"): "+tt);throw _e.line=this.line,_e},_warn:function(tt){typeof console=="object"?console.log("Warning("+this.line+"): "+tt):Env.isBrowser&&document&&document.getElementById(this.warnLog)!==null&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+tt+"<br />")},_log:function(tt){typeof window!="object"&&typeof self=="object"&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+tt.toString()}):console.log("Log: ",arguments)}});var parser=function(){function tt(){this.yy={}}var _e=function(Er,Ar,qt,pr){for(qt=qt||{},pr=Er.length;pr--;qt[Er[pr]]=Ar);return qt},rt=[2,14],nt=[1,13],it=[1,37],st=[1,14],ot=[1,15],lt=[1,21],at=[1,16],ct=[1,17],ut=[1,33],ht=[1,18],dt=[1,19],ft=[1,12],pt=[1,59],mt=[1,60],gt=[1,58],vt=[1,46],At=[1,48],yt=[1,49],xt=[1,50],_t=[1,51],Et=[1,52],bt=[1,53],wt=[1,54],Tt=[1,45],Mt=[1,38],Pt=[1,39],It=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],Ot=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],Bt=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Ut=[2,48],Ft=[1,72],jt=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],Dt=[1,78],Gt=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],zt=[1,82],$t=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Ht=[1,83],er=[1,84],Zt=[1,85],or=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],Kt=[1,89],rr=[1,90],ur=[1,91],fr=[1,92],dr=[1,97],gr=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],Yt=[1,103],xr=[1,104],vr=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],Pr=[1,105],Sr=[1,106],Qr=[1,107],Ir=[1,126],Dr=[1,139],Ur=[83,86],Lr=[1,149],Wr=[10,66,86],Xt=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],Qt=[1,166],hr=[10,86],kr={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,6],[92,1],[92,3]],performAction:function(Er,Ar,qt,pr,mr,nr,Cr){var cr=nr.length-1;switch(mr){case 1:return nr[cr-1];case 2:this.$=yr.createNode(_r(Cr[cr-4]),"node_op","op_if",nr[cr-2],nr[cr]);break;case 3:this.$=yr.createNode(_r(Cr[cr-6]),"node_op","op_if_else",nr[cr-4],nr[cr-2],nr[cr]);break;case 4:this.$=yr.createNode(_r(Cr[cr-4]),"node_op","op_while",nr[cr-2],nr[cr]);break;case 5:this.$=yr.createNode(_r(Cr[cr-8]),"node_op","op_for",nr[cr-6],nr[cr-4],nr[cr-2],nr[cr]);break;case 6:this.$=yr.createNode(_r(Cr[cr-6]),"node_op","op_do",nr[cr-5],nr[cr-2]);break;case 7:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_use",nr[cr]);break;case 8:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_delete",nr[cr]);break;case 9:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_return",void 0);break;case 10:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_return",nr[cr-1]);break;case 11:case 14:this.$=yr.createNode(_r(Cr[cr]),"node_op","op_none");break;case 12:this.$=nr[cr-1],this.$.needsBrackets=!0;break;case 13:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_none",nr[cr-1],nr[cr]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=nr[cr];break;case 22:case 65:case 93:this.$=nr[cr-1];break;case 25:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_assign",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 27:this.$=yr.createNode(_r(Cr[cr-4]),"node_op","op_conditional",nr[cr-4],nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 29:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_or",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 31:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_and",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 33:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_equ",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 34:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_neq",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 35:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_approx",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 37:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_lot",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 38:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_grt",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 39:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_loe",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 40:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_gre",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 42:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_add",nr[cr-2],nr[cr]),this.$.isMath=!0;break;case 43:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_sub",nr[cr-2],nr[cr]),this.$.isMath=!0;break;case 45:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_mul",nr[cr-2],nr[cr]),this.$.isMath=!0;break;case 46:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_div",nr[cr-2],nr[cr]),this.$.isMath=!0;break;case 47:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_mod",nr[cr-2],nr[cr]),this.$.isMath=!0;break;case 49:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_exp",nr[cr-2],nr[cr]),this.$.isMath=!0;break;case 51:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_not",nr[cr]),this.$.isMath=!1;break;case 53:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_neg",nr[cr]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=nr[cr],this.$.isMath=!1;break;case 59:case 91:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_property",nr[cr-2],nr[cr]),this.$.isMath=!0;break;case 60:case 90:this.$=yr.createNode(_r(Cr[cr-3]),"node_op","op_extvalue",nr[cr-3],nr[cr-1]),this.$.isMath=!0;break;case 61:this.$=yr.createNode(_r(Cr[cr]),"node_var",nr[cr]);break;case 69:this.$=nr[cr],this.$.isMath=!0;break;case 70:this.$=yr.createNode(_r(Cr[cr]),"node_const",null);break;case 71:this.$=yr.createNode(_r(Cr[cr]),"node_const_bool",!0);break;case 72:this.$=yr.createNode(_r(Cr[cr]),"node_const_bool",!1);break;case 73:this.$=yr.createNode(_r(Cr[cr]),"node_str",nr[cr].substring(1,nr[cr].length-1));break;case 74:this.$=yr.createNode(_r(Cr[cr]),"node_const",parseFloat(nr[cr]));break;case 75:this.$=yr.createNode(_r(Cr[cr]),"node_const",NaN);break;case 76:this.$=yr.createNode(_r(Cr[cr]),"node_const",1/0);break;case 77:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_array",[]);break;case 78:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_array",nr[cr-1]);break;case 79:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_emptyobject",{});break;case 80:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_proplst_val",nr[cr-1]);break;case 82:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_proplst",nr[cr-2],nr[cr]);break;case 83:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_prop",nr[cr-2],nr[cr]);break;case 87:case 89:this.$=yr.createNode(_r(Cr[cr-1]),"node_op","op_execfun",nr[cr-1],nr[cr]),this.$.isMath=!0;break;case 88:this.$=yr.createNode(_r(Cr[cr-2]),"node_op","op_execfun",nr[cr-2],nr[cr-1],nr[cr],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 103:this.$=[nr[cr]];break;case 95:case 99:case 104:this.$=nr[cr-2].concat(nr[cr]);break;case 96:this.$=yr.createNode(_r(Cr[cr]),"node_var",nr[cr]),this.$.isMath=!0;break;case 100:this.$=yr.createNode(_r(Cr[cr-3]),"node_op","op_function",[],nr[cr]),this.$.isMath=!1;break;case 101:this.$=yr.createNode(_r(Cr[cr-4]),"node_op","op_function",nr[cr-2],nr[cr]),this.$.isMath=!1;break;case 102:this.$=yr.createNode(_r(Cr[cr-5]),"node_op","op_map",nr[cr-3],nr[cr])}},table:[_e([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],rt,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:nt,8:it,9:20,11:4,13:7,14:st,15:ot,16:lt,17:at,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:ft,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{1:[2,1]},_e(It,[2,13]),_e(Ot,[2,15]),_e(Ot,[2,16]),_e(Ot,[2,17]),_e(Ot,[2,18]),_e(Ot,[2,19]),_e(Ot,[2,20]),_e(Ot,[2,21]),_e([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],rt,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:nt,8:it,9:20,11:65,13:7,14:st,15:ot,16:lt,17:at,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:ft,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{20:[1,66]},{20:[1,67]},{8:it,9:69,16:[1,68],20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{16:[1,70]},_e(Ot,[2,11]),_e(Bt,[2,23]),_e(Bt,[2,24]),_e([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],Ut,{32:[1,71],57:Ft}),_e([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),_e(jt,[2,54],{88:77,8:Dt,64:[1,75],65:[1,76]}),_e(jt,[2,55],{88:79,8:Dt,64:[1,81],65:[1,80]}),_e(Gt,[2,28],{39:zt}),_e(Bt,[2,56]),_e(Bt,[2,57]),_e(Bt,[2,58]),_e($t,[2,30],{41:Ht,42:er,43:Zt}),_e(Bt,[2,61]),_e(Bt,[2,62]),_e(Bt,[2,63]),_e(Bt,[2,64]),{8:it,9:86,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:[1,87]},{8:[1,88]},_e(or,[2,32],{45:Kt,46:rr,47:ur,48:fr}),_e(Bt,[2,66]),_e(Bt,[2,67]),_e(Bt,[2,68]),_e(Bt,[2,69]),{20:dr,72:98,73:99,77:_t,78:Et,79:bt,80:wt,83:[1,93],84:94,85:95,87:96},{8:it,20:ut,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,81:101,82:Tt,91:Mt,93:Pt},_e(gr,[2,36],{50:Yt,51:xr}),_e(Bt,[2,70]),_e(Bt,[2,71]),_e(Bt,[2,72]),_e(Bt,[2,73]),_e(Bt,[2,74]),_e(Bt,[2,75]),_e(Bt,[2,76]),_e(vr,[2,41],{53:Pr,54:Sr,55:Qr}),_e(Bt,[2,44]),_e(Bt,[2,50]),{8:it,20:ut,31:109,50:pt,51:mt,52:108,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,50:pt,51:mt,52:110,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,50:pt,51:mt,52:111,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{6:6,7:nt,8:it,9:20,11:4,13:7,14:st,15:ot,16:lt,17:at,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:ft,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,9:113,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,9:114,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,9:115,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{14:[1,116]},_e(Ot,[2,7]),_e(Ot,[2,8]),_e(Ot,[2,9]),{16:[1,117]},_e(Ot,[2,22]),{8:it,20:ut,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,50:pt,51:mt,52:119,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,36:121,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{20:[1,122]},{8:it,9:123,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},_e(Bt,[2,87],{89:124,90:125,68:127,20:Ir,82:Tt}),{8:it,10:[1,128],20:ut,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,81:129,82:Tt,91:Mt,93:Pt},_e(Bt,[2,89]),{8:it,9:130,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{20:[1,131]},{8:it,20:ut,31:109,38:132,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,40:133,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,40:134,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,40:135,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{10:[1,136]},{10:[1,137],20:Dr,92:138},{20:Dr,92:140},{8:it,20:ut,31:109,44:141,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,44:142,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,44:143,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,44:144,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},_e(Bt,[2,79]),{83:[1,145],86:[1,146]},_e(Ur,[2,81]),{35:[1,147]},{35:[2,84]},{35:[2,85]},{35:[2,86]},_e(Bt,[2,77]),{66:[1,148],86:Lr},_e(Wr,[2,98]),{8:it,20:ut,31:109,49:150,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,49:151,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,50:pt,51:mt,52:152,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,50:pt,51:mt,52:153,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,31:109,50:pt,51:mt,52:154,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},_e(Bt,[2,51]),_e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],Ut,{57:Ft}),_e(Bt,[2,52]),_e(Bt,[2,53]),_e([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,155]},{10:[1,156]},{16:[1,157]},{8:[1,158]},_e(Ot,[2,10]),_e(Bt,[2,25]),_e(Bt,[2,49]),{35:[1,159]},_e(Gt,[2,29],{39:zt}),_e(Bt,[2,59]),{66:[1,160]},_e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,161]}),_e(Bt,[2,94]),_e(Bt,[2,96]),_e(Bt,[2,97]),_e(Xt,[2,92]),{10:[1,162],86:Lr},{66:[1,163]},_e(Bt,[2,91]),_e($t,[2,31],{41:Ht,42:er,43:Zt}),_e(or,[2,33],{45:Kt,46:rr,47:ur,48:fr}),_e(or,[2,34],{45:Kt,46:rr,47:ur,48:fr}),_e(or,[2,35],{45:Kt,46:rr,47:ur,48:fr}),_e(Bt,[2,65]),{25:164,26:ft},{10:[1,165],86:Qt},_e(hr,[2,103]),{10:[1,167],86:Qt},_e(gr,[2,37],{50:Yt,51:xr}),_e(gr,[2,38],{50:Yt,51:xr}),_e(gr,[2,39],{50:Yt,51:xr}),_e(gr,[2,40],{50:Yt,51:xr}),_e(Bt,[2,80]),{20:dr,72:98,73:99,77:_t,78:Et,79:bt,80:wt,85:168,87:96},{8:it,20:ut,29:169,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},_e(Bt,[2,78]),{8:it,20:ut,29:170,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},_e(vr,[2,42],{53:Pr,54:Sr,55:Qr}),_e(vr,[2,43],{53:Pr,54:Sr,55:Qr}),_e(Bt,[2,45]),_e(Bt,[2,46]),_e(Bt,[2,47]),{6:6,7:nt,8:it,9:20,11:171,13:7,14:st,15:ot,16:lt,17:at,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:ft,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{6:6,7:nt,8:it,9:20,11:172,13:7,14:st,15:ot,16:lt,17:at,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:ft,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,9:173,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,9:174,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,20:ut,29:175,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},_e(Bt,[2,60]),{20:Ir,68:127,82:Tt,90:176},_e(Xt,[2,93]),_e(Bt,[2,90]),_e(Bt,[2,100]),{25:177,26:ft},{20:[1,178]},{94:[1,179]},_e(Ur,[2,82]),_e(Ur,[2,83]),_e(Wr,[2,99]),_e(It,[2,2],{12:[1,180]}),_e(Ot,[2,4]),{16:[1,181]},{10:[1,182]},_e(Bt,[2,27]),_e(Bt,[2,95]),_e(Bt,[2,101]),_e(hr,[2,104]),{8:it,9:183,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{6:6,7:nt,8:it,9:20,11:184,13:7,14:st,15:ot,16:lt,17:at,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:ft,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{8:it,9:185,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},{16:[1,186]},_e(Bt,[2,102]),_e(Ot,[2,3]),{10:[1,187]},_e(Ot,[2,6]),{6:6,7:nt,8:it,9:20,11:188,13:7,14:st,15:ot,16:lt,17:at,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:ft,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:pt,51:mt,52:56,56:57,58:gt,59:26,60:27,61:29,62:30,63:31,65:vt,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:At,75:yt,76:xt,77:_t,78:Et,79:bt,80:wt,82:Tt,91:Mt,93:Pt},_e(Ot,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(Er,Ar){if(!Ar.recoverable){var qt=new Error(Er);throw qt.hash=Ar,qt}this.trace(Er)},parse:function(Er){var Ar=this,qt=[0],pr=[null],mr=[],nr=this.table,Cr="",cr=0,Jr=0,lr=0,Rr=mr.slice.call(arguments,1),br=Object.create(this.lexer),jr={yy:{}};for(var Yr in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Yr)&&(jr.yy[Yr]=this.yy[Yr]);br.setInput(Er,jr.yy),jr.yy.lexer=br,jr.yy.parser=this,br.yylloc===void 0&&(br.yylloc={});var mn=br.yylloc;mr.push(mn);var bn=br.options&&br.options.ranges;typeof jr.yy.parseError=="function"?this.parseError=jr.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var fn,Cn,Tn,gn,En,Xn,$n,wn,Bn,Qn=function(){var Gn;return Gn=br.lex()||1,typeof Gn!="number"&&(Gn=Ar.symbols_[Gn]||Gn),Gn},Mn={};;){if(Tn=qt[qt.length-1],this.defaultActions[Tn]?gn=this.defaultActions[Tn]:(fn!=null||(fn=Qn()),gn=nr[Tn]&&nr[Tn][fn]),gn===void 0||!gn.length||!gn[0]){var on="";Bn=[];for(Xn in nr[Tn])this.terminals_[Xn]&&Xn>2&&Bn.push("'"+this.terminals_[Xn]+"'");on=br.showPosition?"Parse error on line "+(cr+1)+`:
`+br.showPosition()+`
Expecting `+Bn.join(", ")+", got '"+(this.terminals_[fn]||fn)+"'":"Parse error on line "+(cr+1)+": Unexpected "+(fn==1?"end of input":"'"+(this.terminals_[fn]||fn)+"'"),this.parseError(on,{text:br.match,token:this.terminals_[fn]||fn,line:br.yylineno,loc:mn,expected:Bn})}if(gn[0]instanceof Array&&gn.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Tn+", token: "+fn);switch(gn[0]){case 1:qt.push(fn),pr.push(br.yytext),mr.push(br.yylloc),qt.push(gn[1]),fn=null,Cn?(fn=Cn,Cn=null):(Jr=br.yyleng,Cr=br.yytext,cr=br.yylineno,mn=br.yylloc,lr>0);break;case 2:if($n=this.productions_[gn[1]][1],Mn.$=pr[pr.length-$n],Mn._$={first_line:mr[mr.length-($n||1)].first_line,last_line:mr[mr.length-1].last_line,first_column:mr[mr.length-($n||1)].first_column,last_column:mr[mr.length-1].last_column},bn&&(Mn._$.range=[mr[mr.length-($n||1)].range[0],mr[mr.length-1].range[1]]),(En=this.performAction.apply(Mn,[Cr,Jr,cr,jr.yy,gn[1],pr,mr].concat(Rr)))!==void 0)return En;$n&&(qt=qt.slice(0,-1*$n*2),pr=pr.slice(0,-1*$n),mr=mr.slice(0,-1*$n)),qt.push(this.productions_[gn[1]][0]),pr.push(Mn.$),mr.push(Mn._$),wn=nr[qt[qt.length-2]][qt[qt.length-1]],qt.push(wn);break;case 3:return!0}}return!0}},yr={node:function(Er,Ar,qt){return{type:Er,value:Ar,children:qt}},createNode:function(Er,Ar,qt,pr){var mr,nr=this.node(Ar,qt,[]);for(mr=3;mr<arguments.length;mr++)nr.children.push(arguments[mr]);return nr.line=Er[0],nr.col=Er[1],nr.eline=Er[2],nr.ecol=Er[3],nr}},_r=function(Er){return[Er.first_line,Er.first_column,Er.last_line,Er.last_column]},Hr=function(){return{EOF:1,parseError:function(Er,Ar){if(!this.yy.parser)throw new Error(Er);this.yy.parser.parseError(Er,Ar)},setInput:function(Er,Ar){return this.yy=Ar||this.yy||{},this._input=Er,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Er=this._input[0];return this.yytext+=Er,this.yyleng++,this.offset++,this.match+=Er,this.matched+=Er,Er.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Er},unput:function(Er){var Ar=Er.length,qt=Er.split(/(?:\r\n?|\n)/g);this._input=Er+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Ar),this.offset-=Ar;var pr=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),qt.length-1&&(this.yylineno-=qt.length-1);var mr=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:qt?(qt.length===pr.length?this.yylloc.first_column:0)+pr[pr.length-qt.length].length-qt[0].length:this.yylloc.first_column-Ar},this.options.ranges&&(this.yylloc.range=[mr[0],mr[0]+this.yyleng-Ar]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(Er){this.unput(this.match.slice(Er))},pastInput:function(){var Er=this.matched.substr(0,this.matched.length-this.match.length);return(Er.length>20?"...":"")+Er.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Er=this.match;return Er.length<20&&(Er+=this._input.substr(0,20-Er.length)),(Er.substr(0,20)+(Er.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Er=this.pastInput(),Ar=new Array(Er.length+1).join("-");return Er+this.upcomingInput()+`
`+Ar+"^"},test_match:function(Er,Ar){var qt,pr,mr;if(this.options.backtrack_lexer&&(mr={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(mr.yylloc.range=this.yylloc.range.slice(0))),pr=Er[0].match(/(?:\r\n?|\n).*/g),pr&&(this.yylineno+=pr.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:pr?pr[pr.length-1].length-pr[pr.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Er[0].length},this.yytext+=Er[0],this.match+=Er[0],this.matches=Er,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Er[0].length),this.matched+=Er[0],qt=this.performAction.call(this,this.yy,this,Ar,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),qt)return qt;if(this._backtrack){for(var nr in mr)this[nr]=mr[nr];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Er,Ar,qt,pr;this._more||(this.yytext="",this.match="");for(var mr=this._currentRules(),nr=0;nr<mr.length;nr++)if((qt=this._input.match(this.rules[mr[nr]]))&&(!Ar||qt[0].length>Ar[0].length)){if(Ar=qt,pr=nr,this.options.backtrack_lexer){if((Er=this.test_match(qt,mr[nr]))!==!1)return Er;if(this._backtrack){Ar=!1;continue}return!1}if(!this.options.flex)break}return Ar?(Er=this.test_match(Ar,mr[pr]))!==!1&&Er:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Er=this.next();return Er||this.lex()},begin:function(Er){this.conditionStack.push(Er)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Er){return Er=this.conditionStack.length-1-Math.abs(Er||0),Er>=0?this.conditionStack[Er]:"INITIAL"},pushState:function(Er){this.begin(Er)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Er,Ar,qt,pr){switch(qt){case 0:break;case 1:case 2:return 78;case 3:case 4:return 77;case 5:case 6:break;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:return 94;case 22:return 82;case 23:return 83;case 24:return 26;case 25:return 27;case 26:return 16;case 27:return"#";case 28:return 34;case 29:return 35;case 30:return 79;case 31:return 64;case 32:return 65;case 33:return 66;case 34:return 8;case 35:return 10;case 36:return 58;case 37:return 57;case 38:return 53;case 39:return 54;case 40:return 55;case 41:return 50;case 42:return 51;case 43:return 47;case 44:return 45;case 45:return 48;case 46:return 46;case 47:return 41;case 48:return 43;case 49:return 42;case 50:return 39;case 51:return 37;case 52:return 32;case 53:return 86;case 54:return 5;case 55:return 20;case 56:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],inclusive:!0}}}}();return kr.lexer=Hr,tt.prototype=kr,kr.Parser=tt,new tt}();return require!==void 0&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(tt){tt[1]||(console.log("Usage: "+tt[0]+" FILE"),process.exit(1));var _e=require("fs").readFileSync(require("path").normalize(tt[1]),"utf8");return exports.parser.parse(_e)},require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode}),define("base/point",["jxg","options","math/math","math/geometry","math/numerics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation","base/coordselement"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut,ht){return tt.Point=function(dt,ft,pt){this.constructor(dt,pt,ot.OBJECT_TYPE_POINT,ot.OBJECT_CLASS_POINT),this.element=this.board.select(pt.anchor),this.coordsConstructor(ft),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createLabel()},tt.Point.prototype=new lt,ct.copyPrototypeMethods(tt.Point,ht,"coordsConstructor"),tt.extend(tt.Point.prototype,{hasPoint:function(dt,ft){var pt,mt=this.coords.scrCoords,gt=ct.evaluate(this.visProp.sizeunit);return pt=parseFloat(ct.evaluate(this.visProp.size)),gt==="user"&&(pt*=Math.sqrt(this.board.unitX*this.board.unitY)),pt+=.5*parseFloat(ct.evaluate(this.visProp.strokewidth)),pt<this.board.options.precision.hasPoint&&(pt=this.board.options.precision.hasPoint),Math.abs(mt[1]-dt)<pt+2&&Math.abs(mt[2]-ft)<pt+2},update:function(dt){return this.needsUpdate?(this.updateCoords(dt),ct.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(){var dt,ft;if(this.transformations.length===0||this.baseElement===null)return this;for(dt=this===this.baseElement?this.transformations[0].apply(this.baseElement,"self"):this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(ot.COORDS_BY_USER,dt),ft=1;ft<this.transformations.length;ft++)this.coords.setCoordinates(ot.COORDS_BY_USER,this.transformations[ft].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(dt,ft,pt,mt){var gt;dt=this.board.select(dt),ft=this.board.select(ft),gt=nt.intersectionFunction(this.board,dt,ft,pt,mt,ct.evaluate(this.visProp.alwaysintersect)),this.addConstraint([gt]);try{dt.addChild(this),ft.addChild(this)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof dt+"' and '"+typeof ft+"'.")}this.type=ot.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[dt.id,ft.id,pt,mt],this.generatePolynomial=function(){var vt=dt.generatePolynomial(this),At=ft.generatePolynomial(this);return vt.length===0||At.length===0?[]:[vt[0],At[0]]},this.prepareUpdate().update()},setStyle:function(dt){var ft=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"],pt=[2,3,4,1,2,3,4,2,3,4,2,3,4];return this.visProp.face=ft[dt],this.visProp.size=pt[dt],this.board.renderer.changePointStyle(this),this},normalizeFace:function(dt){return tt.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),_e.normalizePointFace(dt)},face:function(dt){tt.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:dt})},size:function(dt){tt.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:dt})},cloneToBackground:function(){var dt={};return dt.id=this.id+"T"+this.numTraces,this.numTraces+=1,dt.coords=this.coords,dt.visProp=ct.deepCopy(this.visProp,this.visProp.traceattributes,!0),dt.visProp.layer=this.board.options.layer.trace,dt.elementClass=ot.OBJECT_CLASS_POINT,dt.board=this.board,ct.clearVisPropOld(dt),dt.visPropCalc={visible:ct.evaluate(dt.visProp.visible)},this.board.renderer.drawPoint(dt),this.traces[dt.id]=dt.rendNode,this}}),tt.createPoint=function(dt,ft,pt){var mt,gt;if(gt=ct.copyAttributes(pt,dt.options,"point"),!(mt=ht.create(tt.Point,dt,ft,gt)))throw new Error("JSXGraph: Can't create point with parent types '"+typeof ft[0]+"' and '"+typeof ft[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return mt},tt.createGlider=function(dt,ft,pt){var mt,gt,vt=ct.copyAttributes(pt,dt.options,"glider");return gt=ft.length===1?[0,0]:ft.slice(0,2),mt=dt.create("point",gt,vt),mt.makeGlider(ft[ft.length-1]),mt},tt.createIntersectionPoint=function(dt,ft,pt){var mt,gt,vt,At,yt,xt,_t=ct.copyAttributes(pt,dt.options,"intersection");ft.push(0,0),gt=dt.select(ft[0]),vt=dt.select(ft[1]),yt=ft[2]||0,xt=ft[3]||0,mt=dt.create("point",[0,0,0],_t),At=nt.intersectionFunction(dt,gt,vt,yt,xt,mt.visProp.alwaysintersect),mt.addConstraint([At]);try{gt.addChild(mt),vt.addChild(mt)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof ft[0]+"' and '"+typeof ft[1]+"'.")}return mt.type=ot.OBJECT_TYPE_INTERSECTION,mt.elType="intersection",mt.setParents([gt.id,vt.id]),mt.intersectionNumbers=[yt,xt],mt.getParents=function(){return this.parents.concat(this.intersectionNumbers)},mt.generatePolynomial=function(){var Et=gt.generatePolynomial(mt),bt=vt.generatePolynomial(mt);return Et.length===0||bt.length===0?[]:[Et[0],bt[0]]},mt},tt.createOtherIntersectionPoint=function(dt,ft,pt){var mt,gt,vt,At;if(ft.length!==3||!ct.isPoint(ft[2])||ft[0].elementClass!==ot.OBJECT_CLASS_LINE&&ft[0].elementClass!==ot.OBJECT_CLASS_CIRCLE||ft[1].elementClass!==ot.OBJECT_CLASS_LINE&&ft[1].elementClass!==ot.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof ft[0]+"',  '"+typeof ft[1]+"'and  '"+typeof ft[2]+`'.
Possible parent types: [circle|line,circle|line,point]`);return gt=dt.select(ft[0]),vt=dt.select(ft[1]),At=dt.select(ft[2]),mt=dt.create("point",[function(){var yt=nt.meet(gt.stdform,vt.stdform,0,gt.board);return Math.abs(At.X()-yt.usrCoords[1])>rt.eps||Math.abs(At.Y()-yt.usrCoords[2])>rt.eps||Math.abs(At.Z()-yt.usrCoords[0])>rt.eps?yt:nt.meet(gt.stdform,vt.stdform,1,gt.board)}],pt),mt.type=ot.OBJECT_TYPE_INTERSECTION,mt.elType="otherintersection",mt.setParents([gt.id,vt.id,At]),gt.addChild(mt),vt.addChild(mt),mt.generatePolynomial=function(){var yt=gt.generatePolynomial(mt),xt=vt.generatePolynomial(mt);return yt.length===0||xt.length===0?[]:[yt[0],xt[0]]},mt},tt.createPolePoint=function(dt,ft,pt){var mt,gt,vt,At,yt,xt,_t;if(ft.length>1&&(At=ft[0].type===ot.OBJECT_TYPE_CONIC||ft[0].elementClass===ot.OBJECT_CLASS_CIRCLE,yt=ft[1].type===ot.OBJECT_TYPE_CONIC||ft[1].elementClass===ot.OBJECT_CLASS_CIRCLE,xt=ft[0].elementClass===ot.OBJECT_CLASS_LINE,_t=ft[1].elementClass===ot.OBJECT_CLASS_LINE),ft.length!==2||!(At&&_t||xt&&yt))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof ft[0]+"' and '"+typeof ft[1]+`'.
Possible parent type: [conic|circle,line], [line,conic|circle]`);return _t?(gt=dt.select(ft[0]),vt=dt.select(ft[1])):(gt=dt.select(ft[1]),vt=dt.select(ft[0])),mt=dt.create("point",[function(){var Et=gt.quadraticform,bt=vt.stdform.slice(0,3);return[tt.Math.Numerics.det([bt,Et[1],Et[2]]),tt.Math.Numerics.det([Et[0],bt,Et[2]]),tt.Math.Numerics.det([Et[0],Et[1],bt])]}],pt),mt.elType="polepoint",mt.setParents([gt.id,vt.id]),gt.addChild(mt),vt.addChild(mt),mt},tt.registerElement("point",tt.createPoint),tt.registerElement("glider",tt.createGlider),tt.registerElement("intersection",tt.createIntersectionPoint),tt.registerElement("otherintersection",tt.createOtherIntersectionPoint),tt.registerElement("polepoint",tt.createPolePoint),{Point:tt.Point,createPoint:tt.createPoint,createGlider:tt.createGlider,createIntersection:tt.createIntersectionPoint,createOtherIntersection:tt.createOtherIntersectionPoint,createPolePoint:tt.createPolePoint}}),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct){return tt.Line=function(ut,ht,dt,ft){this.constructor(ut,ft,st.OBJECT_TYPE_LINE,st.OBJECT_CLASS_LINE),this.point1=this.board.select(ht),this.point2=this.board.select(dt),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1.addChild(this),this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=tt.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"})},tt.Line.prototype=new lt,tt.extend(tt.Line.prototype,{hasPoint:function(ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt=[],_t=[1,ut,ht],Et=at.evaluate(this.visProp.strokewidth);return yt=this.board.options.precision.hasPoint+.5*Et,xt[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,xt[1]=this.stdform[1]/this.board.unitX,xt[2]=this.stdform[2]/-this.board.unitY,dt=rt.distPointLine(_t,xt),!(isNaN(dt)||dt>yt)&&(!(!at.evaluate(this.visProp.straightfirst)||!at.evaluate(this.visProp.straightlast))||(pt=this.point1.coords,mt=this.point2.coords,ft=[0,xt[1],xt[2]],ft=_e.crossProduct(ft,_t),ft=_e.crossProduct(ft,xt),ft[1]/=ft[0],ft[2]/=ft[0],ft[0]=1,ft=new ot(st.COORDS_BY_SCREEN,ft.slice(1),this.board).usrCoords,gt=pt.distance(st.COORDS_BY_USER,mt),pt=pt.usrCoords.slice(0),mt=mt.usrCoords.slice(0),gt<_e.eps?vt=0:(gt===Number.POSITIVE_INFINITY&&(gt=1/_e.eps,Math.abs(mt[0])<_e.eps?(gt/=rt.distance([0,0,0],mt),mt=[1,pt[1]+mt[1]*gt,pt[2]+mt[2]*gt]):(gt/=rt.distance([0,0,0],pt),pt=[1,mt[1]+pt[1]*gt,mt[2]+pt[2]*gt])),At=1,gt=mt[At]-pt[At],Math.abs(gt)<_e.eps&&(At=2,gt=mt[At]-pt[At]),vt=(ft[At]-pt[At])/gt),!(!at.evaluate(this.visProp.straightfirst)&&vt<0)&&!(!at.evaluate(this.visProp.straightlast)&&vt>1)))},update:function(){var ut;return this.needsUpdate?(this.constrained&&(at.isFunction(this.funps)?(ut=this.funps())&&ut.length&&ut.length===2&&(this.point1=ut[0],this.point2=ut[1]):(at.isFunction(this.funp1)&&(ut=this.funp1(),at.isPoint(ut)?this.point1=ut:ut&&ut.length&&ut.length===2&&this.point1.setPositionDirectly(st.COORDS_BY_USER,ut)),at.isFunction(this.funp2)&&(ut=this.funp2(),at.isPoint(ut)?this.point2=ut:ut&&ut.length&&ut.length===2&&this.point2.setPositionDirectly(st.COORDS_BY_USER,ut)))),this.updateSegmentFixedLength(),this.updateStdform(),at.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var ut,ht,dt,ft,pt,mt,gt,vt;return this.hasFixedLength?(ut=this.point1.Dist(this.point2),ht=this.fixedLength(),dt=this.fixedLengthOldCoords[0].distance(st.COORDS_BY_USER,this.point1.coords),ft=this.fixedLengthOldCoords[1].distance(st.COORDS_BY_USER,this.point2.coords),(dt>_e.eps||ft>_e.eps||ut!==ht)&&(pt=this.point1.isDraggable&&this.point1.type!==st.OBJECT_TYPE_GLIDER&&!at.evaluate(this.point1.visProp.fixed),mt=this.point2.isDraggable&&this.point2.type!==st.OBJECT_TYPE_GLIDER&&!at.evaluate(this.point2.visProp.fixed),ut>_e.eps?dt>ft&&mt||dt<=ft&&mt&&!pt?(this.point2.setPositionDirectly(st.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*ht/ut,this.point1.Y()+(this.point2.Y()-this.point1.Y())*ht/ut]),this.point2.fullUpdate()):(dt<=ft&&pt||dt>ft&&pt&&!mt)&&(this.point1.setPositionDirectly(st.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*ht/ut,this.point2.Y()+(this.point1.Y()-this.point2.Y())*ht/ut]),this.point1.fullUpdate()):(gt=Math.random()-.5,vt=Math.random()-.5,ut=Math.sqrt(gt*gt+vt*vt),mt?(this.point2.setPositionDirectly(st.COORDS_BY_USER,[this.point1.X()+gt*ht/ut,this.point1.Y()+vt*ht/ut]),this.point2.fullUpdate()):pt&&(this.point1.setPositionDirectly(st.COORDS_BY_USER,[this.point2.X()+gt*ht/ut,this.point2.Y()+vt*ht/ut]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(st.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(st.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var ut=_e.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=ut[0],this.stdform[1]=ut[1],this.stdform[2]=ut[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&_e.innerProduct(this.stdform,this.stdform,3)>=_e.eps*_e.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(ut){var ht=this.point1.symbolic.x,dt=this.point1.symbolic.y,ft=this.point2.symbolic.x,pt=this.point2.symbolic.y,mt=ut.symbolic.x,gt=ut.symbolic.y;return[["(",dt,")*(",mt,")-(",dt,")*(",ft,")+(",gt,")*(",ft,")-(",ht,")*(",gt,")+(",ht,")*(",pt,")-(",mt,")*(",pt,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=_e.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=_e.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(ut,ht){return this.visProp.straightfirst=ut,this.visProp.straightlast=ht,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new ot(st.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(ut){at.exists(this.label)&&(this.label.relativeCoords=new ot(st.COORDS_BY_SCREEN,[ut[0],-ut[1]],this.board))},getLabelAnchor:function(){var ut,ht,dt=0,ft=new ot(st.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),pt=new ot(st.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),mt=at.evaluate(this.visProp.straightfirst),gt=at.evaluate(this.visProp.straightlast);if((mt||gt)&&rt.calcStraight(this,ft,pt,0),ft=ft.scrCoords,pt=pt.scrCoords,!at.exists(this.label))return new ot(st.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(at.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":ft[1]<=pt[1]?(ut=ft[1],ht=ft[2]):(ut=pt[1],ht=pt[2]);break;case"rt":case"lrt":case"urt":ft[1]>pt[1]?(ut=ft[1],ht=ft[2]):(ut=pt[1],ht=pt[2]);break;default:ut=.5*(ft[1]+pt[1]),ht=.5*(ft[2]+pt[2])}return(mt||gt)&&(at.exists(this.label)&&(dt=at.evaluate(this.label.visProp.fontsize)),Math.abs(ut)<_e.eps?ut=dt+0:this.board.canvasWidth+_e.eps>ut&&ut>this.board.canvasWidth-dt-_e.eps&&(ut=this.board.canvasWidth-dt),_e.eps+dt>ht&&ht>-_e.eps?ht=dt:this.board.canvasHeight+_e.eps>ht&&ht>this.board.canvasHeight-dt-_e.eps&&(ht=this.board.canvasHeight-dt)),new ot(st.COORDS_BY_SCREEN,[ut,ht],this.board)},cloneToBackground:function(){var ut,ht,dt,ft={};return ft.id=this.id+"T"+this.numTraces,ft.elementClass=st.OBJECT_CLASS_LINE,this.numTraces++,ft.point1=this.point1,ft.point2=this.point2,ft.stdform=this.stdform,ft.board=this.board,ft.visProp=at.deepCopy(this.visProp,this.visProp.traceattributes,!0),ft.visProp.layer=this.board.options.layer.trace,at.clearVisPropOld(ft),ft.visPropCalc={visible:at.evaluate(ft.visProp.visible)},ht=this.getSlope(),ut=this.getRise(),ft.getSlope=function(){return ht},ft.getRise=function(){return ut},dt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(ft),this.board.renderer.enhancedRendering=dt,this.traces[ft.id]=ft.rendNode,this},addTransform:function(ut){var ht,dt=at.isArray(ut)?ut:[ut],ft=dt.length;for(ht=0;ht<ft;ht++)this.point1.transformations.push(dt[ht]),this.point2.transformations.push(dt[ht]);return this},snapToGrid:function(ut){var ht,dt,ft,pt,mt,gt,vt,At,yt;return at.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):at.exists(ut)&&(At=at.evaluate(this.visProp.snapsizex),yt=at.evaluate(this.visProp.snapsizey),ht=new ot(st.COORDS_BY_SCREEN,[ut.Xprev,ut.Yprev],this.board),gt=ht.usrCoords[1],vt=ht.usrCoords[2],At<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(mt=this.board.defaultAxes.x.defaultTicks,At=mt.ticksDelta*(at.evaluate(mt.visProp.minorticks)+1)),yt<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(mt=this.board.defaultAxes.y.defaultTicks,yt=mt.ticksDelta*(at.evaluate(mt.visProp.minorticks)+1)),At>0&&yt>0&&(dt=rt.projectPointToLine({coords:ht},this,this.board),ft=it.subtract([1,Math.round(gt/At)*At,Math.round(vt/yt)*yt],dt.usrCoords),pt=this.board.create("transform",ft.slice(1),{type:"translate"}),pt.applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var ut=at.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(ut),this.point2.handleSnapToPoints(ut)),this},X:function(ut){var ht,dt=this.stdform[2];return ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],ut=2*(ut-.5),(1-Math.abs(ut))*ht-ut*dt},Y:function(ut){var ht,dt=this.stdform[1];return ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],ut=2*(ut-.5),(1-Math.abs(ut))*ht+ut*dt},Z:function(ut){var ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return ut=2*(ut-.5),(1-Math.abs(ut))*ht},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var ut=this.point1.coords.usrCoords,ht=this.point2.coords.usrCoords;return[Math.min(ut[1],ht[1]),Math.max(ut[2],ht[2]),Math.max(ut[1],ht[1]),Math.min(ut[2],ht[2])]},addTicks:function(ut){return ut.id!==""&&at.exists(ut.id)||(ut.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(ut),this.ticks.push(ut),ut.id},remove:function(){this.removeAllTicks(),lt.prototype.remove.call(this)},removeAllTicks:function(){var ut;for(ut=this.ticks.length;ut>0;ut--)this.removeTicks(this.ticks[ut-1]);this.ticks=[],this.board.update()},removeTicks:function(ut){var ht,dt;for(at.exists(this.defaultTicks)&&this.defaultTicks===ut&&(this.defaultTicks=null),ht=this.ticks.length;ht>0;ht--)if(this.ticks[ht-1]===ut){if(this.board.removeObject(this.ticks[ht-1]),this.ticks[ht-1].ticks)for(dt=0;dt<this.ticks[ht-1].ticks.length;dt++)at.exists(this.ticks[ht-1].labels[dt])&&this.board.removeObject(this.ticks[ht-1].labels[dt]);delete this.ticks[ht-1];break}}}),tt.createLine=function(ut,ht,dt){var ft,pt,mt,gt,vt,At,yt,xt=[],_t=!1,Et=!1;if(ht.length===2){if(at.isArray(ht[0])&&ht[0].length>1)At=at.copyAttributes(dt,ut.options,"line","point1"),mt=ut.create("point",ht[0],At);else if(at.isString(ht[0])||at.isPoint(ht[0]))mt=ut.select(ht[0]);else if(at.isFunction(ht[0])&&at.isPoint(ht[0]()))mt=ht[0](),Et=!0;else if(at.isFunction(ht[0])&&ht[0]().length&&ht[0]().length>=2)At=at.copyAttributes(dt,ut.options,"line","point1"),mt=ct.createPoint(ut,ht[0](),At),Et=!0;else{if(!at.isObject(ht[0])||!at.isTransformationOrArray(ht[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);_t=!0,At=at.copyAttributes(dt,ut.options,"line","point1"),mt=ut.create("point",[ht[0].point1,ht[1]],At)}if(_t)At=at.copyAttributes(dt,ut.options,"line","point2"),gt=ut.create("point",[ht[0].point2,ht[1]],At);else if(at.isArray(ht[1])&&ht[1].length>1)At=at.copyAttributes(dt,ut.options,"line","point2"),gt=ut.create("point",ht[1],At);else if(at.isString(ht[1])||at.isPoint(ht[1]))gt=ut.select(ht[1]);else if(at.isFunction(ht[1])&&at.isPoint(ht[1]()))gt=ht[1](),Et=!0;else{if(!(at.isFunction(ht[1])&&ht[1]().length&&ht[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);At=at.copyAttributes(dt,ut.options,"line","point2"),gt=ct.createPoint(ut,ht[1](),At),Et=!0}At=at.copyAttributes(dt,ut.options,"line"),pt=new tt.Line(ut,mt,gt,At),Et?(pt.constrained=!0,pt.funp1=ht[0],pt.funp2=ht[1]):_t||(pt.isDraggable=!0),pt.setParents([mt.id,gt.id])}else if(ht.length===3){for(yt=!0,vt=0;vt<3;vt++)if(at.isNumber(ht[vt]))xt[vt]=at.createFunction(ht[vt]);else{if(!at.isFunction(ht[vt]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+"' and '"+typeof ht[2]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);xt[vt]=ht[vt],yt=!1}At=at.copyAttributes(dt,ut.options,"line","point1"),mt=yt?ut.create("point",[xt[2]()*xt[2]()+xt[1]()*xt[1](),xt[2]()-xt[1]()*xt[0]()+xt[2](),-xt[1]()-xt[2]()*xt[0]()-xt[1]()],At):ut.create("point",[function(){return .5*(xt[2]()*xt[2]()+xt[1]()*xt[1]())},function(){return .5*(xt[2]()-xt[1]()*xt[0]()+xt[2]())},function(){return .5*(-xt[1]()-xt[2]()*xt[0]()-xt[1]())}],At),At=at.copyAttributes(dt,ut.options,"line","point2"),gt=yt?ut.create("point",[xt[2]()*xt[2]()+xt[1]()*xt[1](),-xt[1]()*xt[0]()+xt[2](),-xt[2]()*xt[0]()-xt[1]()],At):ut.create("point",[function(){return xt[2]()*xt[2]()+xt[1]()*xt[1]()},function(){return-xt[1]()*xt[0]()+xt[2]()},function(){return-xt[2]()*xt[0]()-xt[1]()}],At),mt.prepareUpdate().update(),gt.prepareUpdate().update(),At=at.copyAttributes(dt,ut.options,"line"),pt=new tt.Line(ut,mt,gt,At),pt.isDraggable=yt,pt.setParents([mt,gt])}else if(ht.length===1&&at.isFunction(ht[0])&&ht[0]().length===2&&at.isPoint(ht[0]()[0])&&at.isPoint(ht[0]()[1]))ft=ht[0](),At=at.copyAttributes(dt,ut.options,"line"),pt=new tt.Line(ut,ft[0],ft[1],At),pt.constrained=!0,pt.funps=ht[0],pt.setParents(ft);else{if(!(ht.length===1&&at.isFunction(ht[0])&&ht[0]().length===3&&at.isNumber(ht[0]()[0])&&at.isNumber(ht[0]()[1])&&at.isNumber(ht[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);ft=ht[0],At=at.copyAttributes(dt,ut.options,"line","point1"),mt=ut.create("point",[function(){var bt=ft();return[.5*(bt[2]*bt[2]+bt[1]*bt[1]),.5*(bt[2]-bt[1]*bt[0]+bt[2]),.5*(-bt[1]-bt[2]*bt[0]-bt[1])]}],At),At=at.copyAttributes(dt,ut.options,"line","point2"),gt=ut.create("point",[function(){var bt=ft();return[bt[2]*bt[2]+bt[1]*bt[1],-bt[1]*bt[0]+bt[2],-bt[2]*bt[0]-bt[1]]}],At),At=at.copyAttributes(dt,ut.options,"line"),pt=new tt.Line(ut,mt,gt,At),pt.constrained=!0,pt.funps=ht[0],pt.setParents([mt,gt])}return pt},tt.registerElement("line",tt.createLine),tt.createSegment=function(ut,ht,dt){var ft,pt;if(dt.straightFirst=!1,dt.straightLast=!1,pt=at.copyAttributes(dt,ut.options,"segment"),ft=ut.create("line",ht.slice(0,2),pt),ht.length===3){if(ft.hasFixedLength=!0,at.isNumber(ht[2]))ft.fixedLength=function(){return ht[2]};else{if(!at.isFunction(ht[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof ht[2]+`'.
Possible third parent types: number or function`);ft.fixedLength=ht[2]}ft.getParents=function(){return this.parents.concat(this.fixedLength())},ft.fixedLengthOldCoords=[],ft.fixedLengthOldCoords[0]=new ot(st.COORDS_BY_USER,ft.point1.coords.usrCoords.slice(1,3),ut),ft.fixedLengthOldCoords[1]=new ot(st.COORDS_BY_USER,ft.point2.coords.usrCoords.slice(1,3),ut)}return ft.elType="segment",ft},tt.registerElement("segment",tt.createSegment),tt.createArrow=function(ut,ht,dt){var ft;return dt.firstArrow=!1,dt.lastArrow=!0,ft=ut.create("line",ht,dt).setStraight(!1,!1),ft.type=st.OBJECT_TYPE_VECTOR,ft.elType="arrow",ft},tt.registerElement("arrow",tt.createArrow),tt.createAxis=function(ut,ht,dt){var ft,pt,mt,gt,vt;if(!at.isArray(ht[0])&&!at.isPoint(ht[0])||!at.isArray(ht[1])&&!at.isPoint(ht[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);ft=at.copyAttributes(dt,ut.options,"axis"),mt=ut.create("line",ht,ft),mt.type=st.OBJECT_TYPE_AXIS,mt.isDraggable=!1,mt.point1.isDraggable=!1,mt.point2.isDraggable=!1;for(gt in mt.ancestors)mt.ancestors.hasOwnProperty(gt)&&(mt.ancestors[gt].type=st.OBJECT_TYPE_AXISPOINT);return pt=at.copyAttributes(dt,ut.options,"axis","ticks"),vt=at.exists(pt.ticksdistance)?pt.ticksdistance:at.isArray(pt.ticks)?pt.ticks:1,mt.defaultTicks=ut.create("ticks",[mt,vt],pt),mt.defaultTicks.dump=!1,mt.elType="axis",mt.subs={ticks:mt.defaultTicks},mt.inherits.push(mt.defaultTicks),mt},tt.registerElement("axis",tt.createAxis),tt.createTangent=function(ut,ht,dt){var ft,pt,mt,gt,vt,At,yt;if(ht.length===1)ft=ht[0],pt=ft.slideObject;else{if(ht.length!==2)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);if(at.isPoint(ht[0]))ft=ht[0],pt=ht[1];else{if(!at.isPoint(ht[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);pt=ht[0],ft=ht[1]}}if(pt.elementClass===st.OBJECT_CLASS_LINE?(yt=ut.create("line",[pt.point1,pt.point2],dt),yt.glider=ft):pt.elementClass===st.OBJECT_CLASS_CURVE&&pt.type!==st.OBJECT_TYPE_CONIC?at.evaluate(pt.visProp.curvetype)!=="plot"?(mt=pt.X,gt=pt.Y,yt=ut.create("line",[function(){return-ft.X()*nt.D(gt)(ft.position)+ft.Y()*nt.D(mt)(ft.position)},function(){return nt.D(gt)(ft.position)},function(){return-nt.D(mt)(ft.position)}],dt),ft.addChild(yt),yt.glider=ft):(yt=ut.create("line",[function(){var xt,_t,Et=Math.floor(ft.position);return Et===pt.numberPoints-1&&Et--,Et<0?1:(xt=pt.points[Et].usrCoords,_t=pt.points[Et+1].usrCoords,xt[2]*_t[1]-xt[1]*_t[2])},function(){var xt,_t,Et=Math.floor(ft.position);return Et===pt.numberPoints-1&&Et--,Et<0?0:(xt=pt.points[Et].usrCoords,_t=pt.points[Et+1].usrCoords,_t[2]-xt[2])},function(){var xt,_t,Et=Math.floor(ft.position);return Et===pt.numberPoints-1&&Et--,Et<0?0:(xt=pt.points[Et].usrCoords,_t=pt.points[Et+1].usrCoords,xt[1]-_t[1])}],dt),ft.addChild(yt),yt.glider=ft):pt.type===st.OBJECT_TYPE_TURTLE?(yt=ut.create("line",[function(){var xt=Math.floor(ft.position);for(vt=0;vt<pt.objects.length;vt++)if(At=pt.objects[vt],At.type===st.OBJECT_TYPE_CURVE){if(xt<At.numberPoints)break;xt-=At.numberPoints}return xt===At.numberPoints-1&&xt--,xt<0?1:At.Y(xt)*At.X(xt+1)-At.X(xt)*At.Y(xt+1)},function(){var xt=Math.floor(ft.position);for(vt=0;vt<pt.objects.length;vt++)if(At=pt.objects[vt],At.type===st.OBJECT_TYPE_CURVE){if(xt<At.numberPoints)break;xt-=At.numberPoints}return xt===At.numberPoints-1&&xt--,xt<0?0:At.Y(xt+1)-At.Y(xt)},function(){var xt=Math.floor(ft.position);for(vt=0;vt<pt.objects.length;vt++)if(At=pt.objects[vt],At.type===st.OBJECT_TYPE_CURVE){if(xt<At.numberPoints)break;xt-=At.numberPoints}return xt===At.numberPoints-1&&xt--,xt<0?0:At.X(xt)-At.X(xt+1)}],dt),ft.addChild(yt),yt.glider=ft):pt.elementClass!==st.OBJECT_CLASS_CIRCLE&&pt.type!==st.OBJECT_TYPE_CONIC||(yt=ut.create("line",[function(){return _e.matVecMult(pt.quadraticform,ft.coords.usrCoords)[0]},function(){return _e.matVecMult(pt.quadraticform,ft.coords.usrCoords)[1]},function(){return _e.matVecMult(pt.quadraticform,ft.coords.usrCoords)[2]}],dt),ft.addChild(yt),yt.glider=ft),!at.exists(yt))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return yt.elType="tangent",yt.type=st.OBJECT_TYPE_TANGENT,yt.setParents(ht),yt},tt.createRadicalAxis=function(ut,ht,dt){var ft,pt,mt;if(ht.length!==2||ht[0].elementClass!==st.OBJECT_CLASS_CIRCLE||ht[1].elementClass!==st.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent type: [circle,circle]`);return pt=ut.select(ht[0]),mt=ut.select(ht[1]),ft=ut.create("line",[function(){var gt=pt.stdform,vt=mt.stdform;return _e.matVecMult(_e.transpose([gt.slice(0,3),vt.slice(0,3)]),[vt[3],-gt[3]])}],dt),ft.elType="radicalaxis",ft.setParents([pt.id,mt.id]),pt.addChild(ft),mt.addChild(ft),ft},tt.createPolarLine=function(ut,ht,dt){var ft,pt,mt,gt,vt,At,yt;if(ht.length>1&&(gt=ht[0].type===st.OBJECT_TYPE_CONIC||ht[0].elementClass===st.OBJECT_CLASS_CIRCLE,vt=ht[1].type===st.OBJECT_TYPE_CONIC||ht[1].elementClass===st.OBJECT_CLASS_CIRCLE,At=at.isPoint(ht[0]),yt=at.isPoint(ht[1])),ht.length!==2||!(gt&&yt||At&&vt))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent type: [conic|circle,point], [point,conic|circle]`);return yt?(pt=ut.select(ht[0]),mt=ut.select(ht[1])):(pt=ut.select(ht[1]),mt=ut.select(ht[0])),ft=ut.create("tangent",[pt,mt],dt),ft.elType="polarline",ft},tt.registerElement("tangent",tt.createTangent),tt.registerElement("polar",tt.createTangent),tt.registerElement("radicalaxis",tt.createRadicalAxis),tt.registerElement("polarline",tt.createPolarLine),{Line:tt.Line,createLine:tt.createLine,createTangent:tt.createTangent,createPolar:tt.createTangent,createSegment:tt.createSegment,createAxis:tt.createAxis,createArrow:tt.createArrow,createRadicalAxis:tt.createRadicalAxis,createPolarLine:tt.createPolarLine}}),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","math/numerics","math/geometry","parser/geonext","utils/type","base/transformation","math/qdt"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut,ht){return tt.Curve=function(dt,ft,pt){this.constructor(dt,pt,_e.OBJECT_TYPE_CURVE,_e.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=ct.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.qdt=null,ct.exists(ft[0])?this.varname=ft[0]:this.varname="x",this.xterm=ft[1],this.yterm=ft[2],this.generateTerm(this.varname,this.xterm,this.yterm,ft[3],ft[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),ct.isString(this.xterm)&&this.notifyParents(this.xterm),ct.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=ct.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},tt.Curve.prototype=new nt,tt.extend(tt.Curve.prototype,{minX:function(){var dt;return ct.evaluate(this.visProp.curvetype)==="polar"?0:(dt=new rt(_e.COORDS_BY_SCREEN,[0,0],this.board,!1),dt.usrCoords[1])},maxX:function(){var dt;return ct.evaluate(this.visProp.curvetype)==="polar"?2*Math.PI:(dt=new rt(_e.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board,!1),dt.usrCoords[1])},X:function(dt){return NaN},Y:function(dt){return NaN},Z:function(dt){return 1},hasPoint:function(dt,ft,pt){var mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt,Pt,It=[],Ot=ct.evaluate(this.visProp.numberpointslow),Bt=(this.maxX()-this.minX())/Ot,Ut=this.board.options.precision.hasPoint,Ft=1/0;if(gt=new rt(_e.COORDS_BY_SCREEN,[dt,ft],this.board,!1),dt=gt.usrCoords[1],ft=gt.usrCoords[2],Ut+=.5*ct.evaluate(this.visProp.strokewidth),Ut*=Ut,Tt=this.board.unitX*this.board.unitX,Mt=this.board.unitY*this.board.unitY,(Pt=ct.evaluate(this.visProp.curvetype))==="parameter"||Pt==="polar")for(this.transformations.length>0&&(this.updateTransformMatrix(),At=it.inverse(this.transformMat),yt=it.matVecMult(At,[1,dt,ft]),dt=yt[1],ft=yt[2]),xt=0,mt=this.minX();xt<Ot;xt++){if(_t=this.X(mt,!0),Et=this.Y(mt,!0),(Ft=(dt-_t)*(dt-_t)*Tt+(ft-Et)*(ft-Et)*Mt)<=Ut)return!0;mt+=Bt}else if(Pt==="plot"||Pt==="functiongraph"){for((!ct.exists(pt)||pt<0)&&(pt=0),ct.exists(this.qdt)&&ct.evaluate(this.visProp.useqdt)&&this.bezierDegree!==3?(wt=this.qdt.query(new rt(_e.COORDS_BY_USER,[dt,ft],this.board)),bt=wt.points,vt=bt.length):(bt=this.points,vt=this.numberPoints-1),xt=pt;xt<vt;xt++)if(this.bezierDegree===3?It.push(lt.projectCoordsToBeziersegment([1,dt,ft],this,xt)):wt?(bt[xt].prev&&(It=lt.projectCoordsToSegment([1,dt,ft],bt[xt].prev.usrCoords,bt[xt].usrCoords)),bt[xt].next&&bt[xt+1]!==bt[xt].next&&(It=lt.projectCoordsToSegment([1,dt,ft],bt[xt].usrCoords,bt[xt].next.usrCoords))):It=lt.projectCoordsToSegment([1,dt,ft],bt[xt].usrCoords,bt[xt+1].usrCoords),It[1]>=0&&It[1]<=1&&(dt-It[0][1])*(dt-It[0][1])*Tt+(ft-It[0][2])*(ft-It[0][2])*Mt<=Ut)return!0;return!1}return Ft<Ut},allocatePoints:function(){var dt,ft;if(ft=this.numberPoints,this.points.length<this.numberPoints)for(dt=this.points.length;dt<ft;dt++)this.points[dt]=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(ct.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.checkReal(),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var dt,ft,pt,mt,gt,vt,At=!1;if(this.updateTransformMatrix(),this.updateDataArray(),ft=this.minX(),pt=this.maxX(),ct.exists(this.dataX))for(this.numberPoints=this.dataX.length,dt=this.numberPoints,this.allocatePoints(),vt=0;vt<dt;vt++)mt=vt,ct.exists(this.dataY)?(gt=vt,this.points[vt].setCoordinates(_e.COORDS_BY_USER,[this.dataX[vt],this.dataY[vt]],!1)):(gt=this.X(mt),this.points[vt].setCoordinates(_e.COORDS_BY_USER,[this.dataX[vt],this.Y(gt,At)],!1)),this.points[vt]._t=vt,this.updateTransform(this.points[vt]),At=!0;else{if(ct.evaluate(this.visProp.doadvancedplot)?this.updateParametricCurve(ft,pt):ct.evaluate(this.visProp.doadvancedplotold)?this.updateParametricCurveOld(ft,pt):(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.numberPoints=ct.evaluate(this.visProp.numberpointshigh):this.numberPoints=ct.evaluate(this.visProp.numberpointslow),this.allocatePoints(),this.updateParametricCurveNaive(ft,pt,this.numberPoints)),dt=this.numberPoints,ct.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new ht(this.board.getBoundingBox()),vt=0;vt<this.points.length;vt++)this.qdt.insert(this.points[vt]),vt>0&&(this.points[vt].prev=this.points[vt-1]),vt<dt-1&&(this.points[vt].next=this.points[vt+1]);for(vt=0;vt<dt;vt++)this.updateTransform(this.points[vt])}return ct.evaluate(this.visProp.curvetype)!=="plot"&&ct.evaluate(this.visProp.rdpsmoothing)&&(this.points=ot.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),this},updateTransformMatrix:function(){var dt,ft,pt=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],ft=0;ft<pt;ft++)dt=this.transformations[ft],dt.update(),this.transformMat=it.matMatMult(dt.matrix,this.transformMat);return this},checkReal:function(){var dt,ft,pt=!1,mt=this.numberPoints;for(dt=0;dt<mt;dt++)if(ft=this.points[dt].usrCoords,!isNaN(ft[1])&&!isNaN(ft[2])&&Math.abs(ft[0])>it.eps){pt=!0;break}this.isReal=pt},updateParametricCurveNaive:function(dt,ft,pt){var mt,gt,vt=!1,At=(ft-dt)/pt;for(mt=0;mt<pt;mt++)gt=dt+mt*At,this.points[mt].setCoordinates(_e.COORDS_BY_USER,[this.X(gt,vt),this.Y(gt,vt)],!1),this.points[mt]._t=gt,vt=!0;return this},updateParametricCurveOld:function(dt,ft){var pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt=!1,Mt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),Pt=[],It=[],Ot=[],Bt=[],Ut=!1,Ft=0;for(tt.deprecated("Curve.updateParametricCurveOld()"),this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(Et=15,bt=10,wt=10):(Et=21,bt=.7,wt=.7),Bt[0]=ft-dt,pt=1;pt<Et;pt++)Bt[pt]=.5*Bt[pt-1];pt=1,Pt[0]=1,It[0]=0,mt=dt,Mt.setCoordinates(_e.COORDS_BY_USER,[this.X(mt,Tt),this.Y(mt,Tt)],!1),Tt=!0,At=Mt.scrCoords[1],yt=Mt.scrCoords[2],t0=mt,mt=ft,Mt.setCoordinates(_e.COORDS_BY_USER,[this.X(mt,Tt),this.Y(mt,Tt)],!1),gt=Mt.scrCoords[1],vt=Mt.scrCoords[2],Ot[0]=[gt,vt],xt=1,_t=0,this.points=[],this.points[Ft++]=new rt(_e.COORDS_BY_SCREEN,[At,yt],this.board,!1);do{for(Ut=this.isDistOK(gt-At,vt-yt,bt,wt)||this.isSegmentOutside(At,yt,gt,vt);_t<Et&&(!Ut||_t<6)&&(_t<=7||this.isSegmentDefined(At,yt,gt,vt));)Pt[xt]=pt,It[xt]=_t,Ot[xt]=[gt,vt],xt+=1,pt=2*pt-1,_t++,mt=dt+pt*Bt[_t],Mt.setCoordinates(_e.COORDS_BY_USER,[this.X(mt,Tt),this.Y(mt,Tt)],!1,!0),gt=Mt.scrCoords[1],vt=Mt.scrCoords[2],Ut=this.isDistOK(gt-At,vt-yt,bt,wt)||this.isSegmentOutside(At,yt,gt,vt);Ft>1&&function(jt,Dt,Gt){var zt,$t,Ht=Gt[1]-jt[1],er=Gt[2]-jt[2],Zt=Dt[0]-jt[1],or=Dt[1]-jt[2],Kt=Zt*Zt+or*or;return Kt>=it.eps&&(zt=(Ht*Zt+er*or)/Kt)>0&&(zt<=1?(Ht-=zt*Zt,er-=zt*or):(Ht-=Zt,er-=or)),$t=Ht*Ht+er*er,Math.sqrt($t)}(this.points[Ft-2].scrCoords,[gt,vt],this.points[Ft-1].scrCoords)<.015&&(Ft-=1),this.points[Ft]=new rt(_e.COORDS_BY_SCREEN,[gt,vt],this.board,!1),this.points[Ft]._t=mt,Ft+=1,At=gt,yt=vt,t0=mt,xt-=1,gt=Ot[xt][0],vt=Ot[xt][1],_t=It[xt]+1,pt=2*Pt[xt]}while(xt>0&&Ft<5e5);return this.numberPoints=this.points.length,this},isSegmentOutside:function(dt,ft,pt,mt){return ft<0&&mt<0||ft>this.board.canvasHeight&&mt>this.board.canvasHeight||dt<0&&pt<0||dt>this.board.canvasWidth&&pt>this.board.canvasWidth},isDistOK:function(dt,ft,pt,mt){return Math.abs(dt)<pt&&Math.abs(ft)<mt&&!isNaN(dt+ft)},isSegmentDefined:function(dt,ft,pt,mt){return!(isNaN(dt+ft)&&isNaN(pt+mt))},_insertPoint:function(dt,ft){var pt=!isNaN(this._lastCrds[1]+this._lastCrds[2]),mt=!isNaN(dt.scrCoords[1]+dt.scrCoords[2]),gt=this.board.canvasWidth,vt=this.board.canvasHeight;(!(mt=mt&&dt.scrCoords[1]>-500&&dt.scrCoords[2]>-500&&dt.scrCoords[1]<gt+500&&dt.scrCoords[2]<vt+500)&&pt||mt&&(!pt||Math.abs(dt.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(dt.scrCoords[2]-this._lastCrds[2])>.7))&&(dt._t=ft,this.points.push(dt),this._lastCrds=dt.copy("scrCoords"))},_intersectWithBorder:function(dt,ft,pt){var mt,gt,vt,At;return pt<=0?(mt=[-ft[0],1,0],gt=it.crossProduct(mt,dt),gt[0]!==0?(vt=gt[1]/gt[0],At=gt[2]/gt[0]):At=1/0,At<ft[3]?(mt=[-ft[3],0,1],gt=it.crossProduct(mt,dt),gt[0]!==0?(vt=gt[1]/gt[0],At=gt[2]/gt[0]):vt=1/0):At>ft[1]&&(mt=[-ft[1],0,1],gt=it.crossProduct(mt,dt),gt[0]!==0?(vt=gt[1]/gt[0],At=gt[2]/gt[0]):vt=1/0)):(mt=[-ft[2],1,0],gt=it.crossProduct(mt,dt),gt[0]!==0?(vt=gt[1]/gt[0],At=gt[2]/gt[0]):At=1/0,At<ft[3]?(mt=[-ft[3],0,1],gt=it.crossProduct(mt,dt),gt[0]!==0?(vt=gt[1]/gt[0],At=gt[2]/gt[0]):vt=1/0):At>ft[1]&&(mt=[-ft[1],0,1],gt=it.crossProduct(mt,dt),gt[0]!==0?(vt=gt[1]/gt[0],At=gt[2]/gt[0]):vt=1/0)),[1,vt,At]},_borderCase:function(dt,ft,pt,mt,gt,vt,At){var yt,xt,_t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt,Dt=null,Gt=!1;if(At<=1){xt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),Et=0;do{if(isNaN(dt[1]+dt[2])&&!isNaN(pt[1]+pt[2]))bt=mt,wt=vt,Tt=gt;else if(isNaN(ft[1]+ft[2])&&!isNaN(pt[1]+pt[2]))bt=gt,wt=vt,Tt=mt;else if(isNaN(pt[1]+pt[2])&&!isNaN(ft[1]+ft[2]))bt=vt,wt=gt,Tt=gt+(gt-vt);else{if(!isNaN(pt[1]+pt[2])||isNaN(dt[1]+dt[2]))return!1;bt=vt,wt=mt,Tt=mt-(vt-mt)}yt=.5*(bt+wt),xt.setCoordinates(_e.COORDS_BY_USER,[this.X(yt,!0),this.Y(yt,!0)],!1),_t=xt.usrCoords,Gt=isNaN(_t[1]+_t[2]),Gt?bt=yt:(Tt=wt,wt=yt),++Et}while(Gt&&Et<30);if(Et<30&&(Dt=_t.slice(),pt=_t.slice(),wt=yt),Pt=this.X(wt,!0),Ot=this.X(Tt,!0),Ut=(Pt-Ot)/(wt-Tt),It=this.Y(wt,!0),Bt=this.Y(Tt,!0),Ft=(It-Bt)/(wt-Tt),Mt=this.board.getBoundingBox(),Math.sqrt(Ut*Ut+Ft*Ft)>500&&(jt=[Ut*It-Ft*Pt,Ft,-Ut],Dt=this._intersectWithBorder(jt,Mt,Pt-Ot)),Dt!==null)return this._insertPoint(new rt(_e.COORDS_BY_USER,Dt,this.board,!1)),!0}return!1},_triangleDists:function(dt,ft,pt){var mt,gt,vt,At,yt;return mt=[dt[0]*ft[0],.5*(dt[1]+ft[1]),.5*(dt[2]+ft[2])],gt=lt.distance(dt,ft,3),vt=lt.distance(dt,pt,3),At=lt.distance(pt,ft,3),yt=lt.distance(pt,mt,3),[gt,vt,At,yt]},_isUndefined:function(dt,ft,pt,mt){var gt,vt,At;if(!isNaN(dt[1]+dt[2])||!isNaN(pt[1]+pt[2]))return!1;for(At=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),vt=0;vt<20;++vt)if(gt=ft+Math.random()*(mt-ft),At.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,!0),this.Y(gt,!0)],!1),!isNaN(At.scrCoords[0]+At.scrCoords[1]+At.scrCoords[2]))return!1;return!0},_isOutside:function(dt,ft,pt,mt){var gt=this.board.canvasWidth,vt=this.board.canvasHeight;return dt[1]<-500&&pt[1]<-500||dt[2]<-500&&pt[2]<-500||dt[1]>gt+500&&pt[1]>gt+500||dt[2]>vt+500&&pt[2]>vt+500},_plotRecursive:function(dt,ft,pt,mt,gt,vt){var At,yt,xt,_t,Et,bt,wt=0,Tt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1);if(!(this.numberPoints>65536))return gt<this.nanLevel&&this._isUndefined(dt,ft,pt,mt)?this:gt<this.nanLevel&&this._isOutside(dt,ft,pt,mt)?this:(At=.5*(ft+mt),Tt.setCoordinates(_e.COORDS_BY_USER,[this.X(At,!0),this.Y(At,!0)],!1),yt=Tt.scrCoords,this._borderCase(dt,pt,yt,ft,mt,At,gt)?this:(xt=this._triangleDists(dt,pt,yt),_t=gt<this.smoothLevel&&xt[3]<vt,Et=gt<this.jumpLevel&&(xt[2]>.99*xt[0]||xt[1]>.99*xt[0]||xt[0]===1/0||xt[1]===1/0||xt[2]===1/0),bt=gt<this.smoothLevel+2&&xt[0]<.5*(xt[1]+xt[2]),bt&&(wt=0,_t=!1),--gt,Et?this._insertPoint(new rt(_e.COORDS_BY_SCREEN,[NaN,NaN],this.board,!1),At):gt<=wt||_t?this._insertPoint(Tt,At):(this._plotRecursive(dt,ft,yt,At,gt,vt),this._insertPoint(Tt,At),this._plotRecursive(yt,At,pt,mt,gt,vt)),this))},updateParametricCurve:function(dt,ft){var pt,mt,gt,vt,At,yt,xt=!1,_t=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),Et=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1);return this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(At=ct.evaluate(this.visProp.recursiondepthlow)||13,yt=2,this.smoothLevel=5,this.jumpLevel=5):(At=ct.evaluate(this.visProp.recursiondepthhigh)||17,yt=2,this.smoothLevel=3,this.jumpLevel=3),this.nanLevel=At-4,this.points=[],pt=dt,_t.setCoordinates(_e.COORDS_BY_USER,[this.X(pt,xt),this.Y(pt,xt)],!1),gt=_t.copy("scrCoords"),xt=!0,mt=ft,Et.setCoordinates(_e.COORDS_BY_USER,[this.X(mt,xt),this.Y(mt,xt)],!1),vt=Et.copy("scrCoords"),_t._t=pt,this.points.push(_t),this._lastCrds=_t.copy("scrCoords"),this._plotRecursive(gt,pt,vt,mt,At,yt),Et._t=mt,this.points.push(Et),this.numberPoints=this.points.length,this},updateTransform:function(dt){var ft;return this.transformations.length>0&&(ft=it.matVecMult(this.transformMat,dt.usrCoords),dt.setCoordinates(_e.COORDS_BY_USER,[ft[1],ft[2]],!1,!0)),dt},addTransform:function(dt){var ft,pt=ct.isArray(dt)?dt:[dt],mt=pt.length;for(ft=0;ft<mt;ft++)this.transformations.push(pt[ft]);return this},interpolationFunctionFromArray:function(dt){var ft="data"+dt;return function(pt,mt){var gt,vt,At,yt,xt=this[ft],_t=xt.length,Et=[];if(isNaN(pt))return NaN;if(pt<0)return ct.isFunction(xt[0])?xt[0]():xt[0];if(this.bezierDegree===3){if(_t/=3,pt>=_t)return ct.isFunction(xt[xt.length-1])?xt[xt.length-1]():xt[xt.length-1];for(gt=3*Math.floor(pt),At=pt%1,yt=1-At,vt=0;vt<4;vt++)ct.isFunction(xt[gt+vt])?Et[vt]=xt[gt+vt]():Et[vt]=xt[gt+vt];return yt*yt*(yt*Et[0]+3*At*Et[1])+(3*yt*Et[2]+At*Et[3])*At*At}if((gt=pt>_t-2?_t-2:parseInt(Math.floor(pt),10))===pt)return ct.isFunction(xt[gt])?xt[gt]():xt[gt];for(vt=0;vt<2;vt++)ct.isFunction(xt[gt+vt])?Et[vt]=xt[gt+vt]():Et[vt]=xt[gt+vt];return Et[0]+(Et[1]-Et[0])*(pt-gt)}},generateTerm:function(dt,ft,pt,mt,gt){var vt,At;ct.isArray(ft)?(this.dataX=ft,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray("X"),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=ct.createFunction(ft,this.board,dt),ct.isString(ft)?this.visProp.curvetype="functiongraph":(ct.isFunction(ft)||ct.isNumber(ft))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),ct.isArray(pt)?(this.dataY=pt,this.Y=this.interpolationFunctionFromArray("Y")):this.Y=ct.createFunction(pt,this.board,dt),ct.isFunction(ft)&&ct.isArray(pt)&&(vt=ct.createFunction(pt[0],this.board,""),At=ct.createFunction(pt[1],this.board,""),this.X=function(yt){return ft(yt)*Math.cos(yt)+vt()},this.Y=function(yt){return ft(yt)*Math.sin(yt)+At()},this.visProp.curvetype="polar"),ct.exists(mt)&&(this.minX=ct.createFunction(mt,this.board,"")),ct.exists(gt)&&(this.maxX=ct.createFunction(gt,this.board,""))},notifyParents:function(dt){var ft,pt,mt,gt=!1;mt={xterm:1,yterm:1};for(ft in mt)if(mt.hasOwnProperty(ft)&&this.hasOwnProperty(ft)&&this[ft].origin){gt=!0;for(pt in this[ft].origin.deps)this[ft].origin.deps.hasOwnProperty(pt)&&this[ft].origin.deps[pt].addChild(this)}gt||at.findDependencies(this,dt,this.board)},getLabelAnchor:function(){var dt,ft,pt,mt=.05*this.board.canvasWidth,gt=.05*this.board.canvasHeight,vt=.95*this.board.canvasWidth,At=.95*this.board.canvasHeight;switch(ct.evaluate(this.visProp.label.position)){case"ulft":ft=mt,pt=gt;break;case"llft":ft=mt,pt=At;break;case"rt":ft=vt,pt=.5*At;break;case"lrt":ft=vt,pt=At;break;case"urt":ft=vt,pt=gt;break;case"top":ft=.5*vt,pt=gt;break;case"bot":ft=.5*vt,pt=At;break;default:ft=mt,pt=.5*At}return dt=new rt(_e.COORDS_BY_SCREEN,[ft,pt],this.board,!1),lt.projectCoordsToCurve(dt.usrCoords[1],dt.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var dt,ft={id:this.id+"T"+this.numTraces,elementClass:_e.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:ct.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return ft.visProp.layer=this.board.options.layer.trace,ft.visProp.curvetype=this.visProp.curvetype,this.numTraces++,ct.clearVisPropOld(ft),ft.visPropCalc={visible:ct.evaluate(ft.visProp.visible)},dt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(ft),this.board.renderer.enhancedRendering=dt,this.traces[ft.id]=ft.rendNode,this},bounds:function(){var dt,ft,pt,mt=1/0,gt=-1/0,vt=1/0,At=-1/0,yt=this.points.length;if(this.bezierDegree===3){for(dt=0;dt<yt;dt++)this.points[dt].X=ct.bind(function(){return this.usrCoords[1]},this.points[dt]),this.points[dt].Y=ct.bind(function(){return this.usrCoords[2]},this.points[dt]);return ft=ot.bezier(this.points),pt=ft[3](),mt=ot.fminbr(function(xt){return ft[0](xt)},[0,pt]),gt=ot.fminbr(function(xt){return-ft[0](xt)},[0,pt]),vt=ot.fminbr(function(xt){return ft[1](xt)},[0,pt]),At=ot.fminbr(function(xt){return-ft[1](xt)},[0,pt]),mt=ft[0](mt),gt=ft[0](gt),vt=ft[1](vt),At=ft[1](At),[mt,At,gt,vt]}for(dt=0;dt<yt;dt++)mt>this.points[dt].usrCoords[1]&&(mt=this.points[dt].usrCoords[1]),gt<this.points[dt].usrCoords[1]&&(gt=this.points[dt].usrCoords[1]),vt>this.points[dt].usrCoords[2]&&(vt=this.points[dt].usrCoords[2]),At<this.points[dt].usrCoords[2]&&(At=this.points[dt].usrCoords[2]);return[mt,At,gt,vt]},getParents:function(){var dt=[this.xterm,this.yterm,this.minX(),this.maxX()];return this.parents.length!==0&&(dt=this.parents),dt},moveTo:function(dt){var ft,pt=[];return this.points.length>0&&!ct.evaluate(this.visProp.fixed)&&(ft=this.points[0],pt=dt.length===3?[dt[0]-ft.usrCoords[0],dt[1]-ft.usrCoords[1],dt[2]-ft.usrCoords[2]]:[dt[0]-ft.usrCoords[1],dt[1]-ft.usrCoords[2]],this.setPosition(_e.COORDS_BY_USER,pt)),this}}),tt.createCurve=function(dt,ft,pt){var mt,gt,vt=ct.copyAttributes(pt,dt.options,"curve");return mt=dt.select(ft[0]),ct.isObject(mt)&&(mt.type===_e.OBJECT_TYPE_CURVE||mt.type===_e.OBJECT_TYPE_ANGLE||mt.type===_e.OBJECT_TYPE_ARC||mt.type===_e.OBJECT_TYPE_CONIC||mt.type===_e.OBJECT_TYPE_SECTOR)&&ct.isTransformationOrArray(ft[1])?(mt.type===_e.OBJECT_TYPE_SECTOR?vt=ct.copyAttributes(pt,dt.options,"sector"):mt.type===_e.OBJECT_TYPE_ARC?vt=ct.copyAttributes(pt,dt.options,"arc"):mt.type===_e.OBJECT_TYPE_ANGLE?(ct.exists(pt.withLabel)||(pt.withLabel=!1),vt=ct.copyAttributes(pt,dt.options,"angle")):vt=ct.copyAttributes(pt,dt.options,"curve"),vt=ct.copyAttributes(vt,dt.options,"curve"),gt=new tt.Curve(dt,["x",[],[]],vt),gt.updateDataArray=function(){var At,yt=mt.numberPoints;for(this.bezierDegree=mt.bezierDegree,this.dataX=[],this.dataY=[],At=0;At<yt;At++)this.dataX.push(mt.points[At].usrCoords[1]),this.dataY.push(mt.points[At].usrCoords[2]);return this},gt.addTransform(ft[1]),gt):(vt=ct.copyAttributes(pt,dt.options,"curve"),new tt.Curve(dt,["x"].concat(ft),vt))},tt.registerElement("curve",tt.createCurve),tt.createFunctiongraph=function(dt,ft,pt){var mt,gt=["x","x"].concat(ft);return mt=ct.copyAttributes(pt,dt.options,"curve"),mt.curvetype="functiongraph",new tt.Curve(dt,gt,mt)},tt.registerElement("functiongraph",tt.createFunctiongraph),tt.registerElement("plot",tt.createFunctiongraph),tt.createSpline=function(dt,ft,pt){var mt,gt;return gt=function(){var vt,At=[],yt=[];return function(xt,_t){var Et,bt,wt;if(!_t){if(At=[],yt=[],ft.length===2&&ct.isArray(ft[0])&&ct.isArray(ft[1])&&ft[0].length===ft[1].length)for(Et=0;Et<ft[0].length;Et++)ct.isFunction(ft[0][Et])?At.push(ft[0][Et]()):At.push(ft[0][Et]),ct.isFunction(ft[1][Et])?yt.push(ft[1][Et]()):yt.push(ft[1][Et]);else for(Et=0;Et<ft.length;Et++)if(ct.isPoint(ft[Et]))At.push(ft[Et].X()),yt.push(ft[Et].Y());else if(ct.isArray(ft[Et])&&ft[Et].length===2)for(bt=0;bt<ft.length;bt++)ct.isFunction(ft[bt][0])?At.push(ft[bt][0]()):At.push(ft[bt][0]),ct.isFunction(ft[bt][1])?yt.push(ft[bt][1]()):yt.push(ft[bt][1]);else ct.isFunction(ft[Et])&&ft[Et]().length===2&&(wt=ft[Et](),At.push(wt[0]),yt.push(wt[1]));vt=ot.splineDef(At,yt)}return ot.splineEval(xt,At,yt,vt)}},pt=ct.copyAttributes(pt,dt.options,"curve"),pt.curvetype="functiongraph",mt=new tt.Curve(dt,["x","x",gt()],pt),mt.setParents(ft),mt.elType="spline",mt},tt.registerElement("spline",tt.createSpline),tt.createCardinalSpline=function(dt,ft,pt){var mt,gt,vt,At,yt,xt,_t,Et,bt=`
Possible parent types: [points:array, tau:number|function, type:string]`;if(!ct.exists(ft[0])||!ct.isArray(ft[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+bt);if(!ct.exists(ft[1])||!ct.isNumber(ft[1])&&!ct.isFunction(ft[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+bt);if(!ct.exists(ft[2])||!ct.isString(ft[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+bt);if(pt=ct.copyAttributes(pt,dt.options,"curve"),pt=ct.copyAttributes(pt,dt.options,"cardinalspline"),pt.curvetype="parameter",At=ft[0],yt=[],!pt.isarrayofcoordinates&&At.length===2&&ct.isArray(At[0])&&ct.isArray(At[1])&&At[0].length===At[1].length)for(xt=0;xt<At[0].length;xt++)yt[xt]=[],ct.isFunction(At[0][xt])?yt[xt].push(At[0][xt]()):yt[xt].push(At[0][xt]),ct.isFunction(At[1][xt])?yt[xt].push(At[1][xt]()):yt[xt].push(At[1][xt]);else for(xt=0;xt<At.length;xt++)ct.isString(At[xt])?yt.push(dt.select(At[xt])):ct.isPoint(At[xt])?yt.push(At[xt]):ct.isArray(At[xt])&&At[xt].length===2?(yt[xt]=[],ct.isFunction(At[xt][0])?yt[xt].push(At[xt][0]()):yt[xt].push(At[xt][0]),ct.isFunction(At[xt][1])?yt[xt].push(At[xt][1]()):yt[xt].push(At[xt][1])):ct.isFunction(At[xt])&&At[xt]().length===2&&yt.push(ft[xt]());if(pt.createpoints===!0)gt=ct.providePoints(dt,yt,pt,"cardinalspline",["points"]);else for(gt=[],xt=0;xt<yt.length;xt++)ct.isPoint(yt[xt])?gt.push(yt[xt]):gt.push(function(wt){return{X:function(){return yt[wt][0]},Y:function(){return yt[wt][1]}}}(xt));for(vt=ft[1],ft[2],Et=["x"].concat(ot.CardinalSpline(gt,vt)),mt=new tt.Curve(dt,Et,pt),_t=gt.length,mt.setParents(gt),xt=0;xt<_t;xt++)ct.isPoint(gt[xt])&&gt[xt].addChild(mt);return mt.elType="cardinalspline",mt},tt.registerElement("cardinalspline",tt.createCardinalSpline),tt.createRiemannsum=function(dt,ft,pt){var mt,gt,vt,At,yt,xt;if(xt=ct.copyAttributes(pt,dt.options,"riemannsum"),xt.curvetype="plot",vt=ft[0],mt=ct.createFunction(ft[1],dt,""),!ct.exists(mt))throw new Error(`JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);if(gt=ct.createFunction(ft[2],dt,"",!1),!ct.exists(gt))throw new Error(`JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);return At=[[0],[0]].concat(ft.slice(3)),yt=dt.create("curve",At,xt),yt.sum=0,yt.Value=function(){return this.sum},yt.updateDataArray=function(){var _t=ot.riemann(vt,mt(),gt(),this.minX(),this.maxX());this.dataX=_t[0],this.dataY=_t[1],this.sum=_t[2]},yt},tt.registerElement("riemannsum",tt.createRiemannsum),tt.createTracecurve=function(dt,ft,pt){var mt,gt,vt,At;if(ft.length!==2)throw new Error(`JSXGraph: Can't create trace curve with given parent'
Possible parent types: [glider, point]`);if(gt=dt.select(ft[0]),vt=dt.select(ft[1]),gt.type!==_e.OBJECT_TYPE_GLIDER||!ct.isPoint(vt))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof ft[0]+"' and '"+typeof ft[1]+`'.
Possible parent types: [glider, point]`);return At=ct.copyAttributes(pt,dt.options,"tracecurve"),At.curvetype="plot",mt=dt.create("curve",[[0],[0]],At),mt.updateDataArray=function(){var yt,xt,_t,Et,bt,wt,Tt,Mt,Pt,It=At.numberpoints,Ot=gt.position,Bt=gt.slideObject,Ut=Bt.minX(),Ft=Bt.maxX();for(xt=(Ft-Ut)/It,this.dataX=[],this.dataY=[],Bt.elementClass!==_e.OBJECT_CLASS_CURVE&&It++,yt=0;yt<It;yt++){_t=Ut+yt*xt,wt=Bt.X(_t)/Bt.Z(_t),Tt=Bt.Y(_t)/Bt.Z(_t),gt.setPositionDirectly(_e.COORDS_BY_USER,[wt,Tt]),Mt=!1;for(Et in this.board.objects)if(this.board.objects.hasOwnProperty(Et)&&(bt=this.board.objects[Et],bt===gt&&(Mt=!0),Mt&&bt.needsRegularUpdate&&(Pt=bt.visProp.trace,bt.visProp.trace=!1,bt.needsUpdate=!0,bt.update(!0),bt.visProp.trace=Pt,bt===vt)))break;this.dataX[yt]=vt.X(),this.dataY[yt]=vt.Y()}gt.position=Ot,Mt=!1;for(Et in this.board.objects)if(this.board.objects.hasOwnProperty(Et)&&(bt=this.board.objects[Et],bt===gt&&(Mt=!0),Mt&&bt.needsRegularUpdate&&(Pt=bt.visProp.trace,bt.visProp.trace=!1,bt.needsUpdate=!0,bt.update(!0),bt.visProp.trace=Pt,bt===vt)))break},mt},tt.registerElement("tracecurve",tt.createTracecurve),tt.createStepfunction=function(dt,ft,pt){var mt,gt;if(ft.length!==2)throw new Error(`JSXGraph: Can't create step function with given parent'
Possible parent types: [array, array|function]`);return gt=ct.copyAttributes(pt,dt.options,"stepfunction"),mt=dt.create("curve",ft,gt),mt.updateDataArray=function(){var vt,At=0,yt=this.xterm.length;if(this.dataX=[],this.dataY=[],yt!==0)for(this.dataX[At]=this.xterm[0],this.dataY[At]=this.yterm[0],++At,vt=1;vt<yt;++vt)this.dataX[At]=this.xterm[vt],this.dataY[At]=this.dataY[At-1],++At,this.dataX[At]=this.xterm[vt],this.dataY[At]=this.yterm[vt],++At},mt},tt.registerElement("stepfunction",tt.createStepfunction),tt.createDerivative=function(dt,ft,pt){var mt,gt,vt,At,yt;if(ft.length!==1&&ft[0].class!==_e.OBJECT_CLASS_CURVE)throw new Error(`JSXGraph: Can't create derivative curve with given parent'
Possible parent types: [curve]`);return yt=ct.copyAttributes(pt,dt.options,"curve"),gt=ft[0],vt=ot.D(gt.X),At=ot.D(gt.Y),mt=dt.create("curve",[function(xt){return gt.X(xt)},function(xt){return At(xt)/vt(xt)},gt.minX(),gt.maxX()],yt),mt.setParents(gt),mt},tt.registerElement("derivative",tt.createDerivative),{Curve:tt.Curve,createCurve:tt.createCurve,createFunctiongraph:tt.createFunctiongraph,createPlot:tt.createPlot,createSpline:tt.createSpline,createRiemannsum:tt.createRiemannsum,createTracecurve:tt.createTracecurve,createStepfunction:tt.createStepfunction}}),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type","base/point","base/curve"],function(tt,_e,rt,nt,it,st,ot,lt,at){return tt.createEllipse=function(ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt=[],xt=ot.copyAttributes(ht,ct.options,"conic","foci"),_t=ot.copyAttributes(ht,ct.options,"conic","center"),Et=ot.copyAttributes(ht,ct.options,"conic");for(vt=0;vt<2;vt++)if(ut[vt].length>1)yt[vt]=ct.create("point",ut[vt],xt);else if(ot.isPoint(ut[vt]))yt[vt]=ct.select(ut[vt]);else if(ot.isFunction(ut[vt])&&ot.isPoint(ut[vt]()))yt[vt]=ut[vt]();else{if(!ot.isString(ut[vt]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);yt[vt]=ct.select(ut[vt])}if(ot.isNumber(ut[2]))gt=ot.createFunction(ut[2],ct);else if(ot.isFunction(ut[2])&&ot.isNumber(ut[2]()))gt=ut[2];else{if(ot.isPoint(ut[2]))mt=ct.select(ut[2]);else if(ut[2].length>1)mt=ct.create("point",ut[2],xt);else if(ot.isFunction(ut[2])&&ot.isPoint(ut[2]()))mt=ut[2]();else{if(!ot.isString(ut[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);mt=ct.select(ut[2])}gt=function(){return mt.Dist(yt[0])+mt.Dist(yt[1])}}for(ot.exists(ut[4])||(ut[4]=2*Math.PI),ot.exists(ut[3])||(ut[3]=0),pt=ct.create("point",[function(){return .5*(yt[0].X()+yt[1].X())},function(){return .5*(yt[0].Y()+yt[1].Y())}],_t),ft=ct.create("curve",[function(bt){return 0},function(bt){return 0},ut[3],ut[4]],Et),ft.majorAxis=gt,At=ft.hasPoint,dt=function(bt,wt){var Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt;wt||(Tt=gt(),Mt=Tt*Tt,Pt=yt[0].X(),It=yt[0].Y(),Ot=yt[1].X(),Bt=yt[1].Y(),Ut=Pt-Ot,Ft=It-Bt,jt=(Mt-Pt*Pt-It*It+Ot*Ot+Bt*Bt)/(2*Tt),ft.quadraticform=[[jt*jt-Ot*Ot-Bt*Bt,jt*Ut/Tt+Ot,jt*Ft/Tt+Bt],[jt*Ut/Tt+Ot,Ut*Ut/Mt-1,Ut*Ft/Mt],[jt*Ft/Tt+Bt,Ut*Ft/Mt,Ft*Ft/Mt-1]])},ft.X=function(bt,wt){var Tt=gt(),Mt=yt[1].Dist(yt[0]),Pt=.5*(Mt*Mt-Tt*Tt)/(Mt*Math.cos(bt)-Tt),It=Math.atan2(yt[1].Y()-yt[0].Y(),yt[1].X()-yt[0].X());return wt||dt(bt,wt),yt[0].X()+Math.cos(It+bt)*Pt},ft.Y=function(bt,wt){var Tt=gt(),Mt=yt[1].Dist(yt[0]),Pt=.5*(Mt*Mt-Tt*Tt)/(Mt*Math.cos(bt)-Tt),It=Math.atan2(yt[1].Y()-yt[0].Y(),yt[1].X()-yt[0].X());return yt[0].Y()+Math.sin(It+bt)*Pt},ft.midpoint=ft.center=pt,ft.type=_e.OBJECT_TYPE_CONIC,ft.subs={center:ft.center},ft.inherits.push(ft.center,yt[0],yt[1]),ot.isPoint(mt)&&ft.inherits.push(mt),ft.hasPoint=function(bt,wt){var Tt,Mt,Pt,It;return ot.evaluate(this.visProp.hasinnerpoints)?(Tt=yt[0].coords,Mt=yt[1].coords,Pt=this.majorAxis(),It=new rt(_e.COORDS_BY_SCREEN,[bt,wt],this.board),It.distance(_e.COORDS_BY_USER,Tt)+It.distance(_e.COORDS_BY_USER,Mt)<=Pt):At.apply(this,arguments)},pt.addChild(ft),vt=0;vt<2;vt++)ot.isPoint(yt[vt])&&yt[vt].addChild(ft);return ot.isPoint(mt)&&mt.addChild(ft),ft.setParents(ut),ft},tt.createHyperbola=function(ct,ut,ht){var dt,ft,pt,mt,gt,vt,At=[],yt=ot.copyAttributes(ht,ct.options,"conic","foci"),xt=ot.copyAttributes(ht,ct.options,"conic","center"),_t=ot.copyAttributes(ht,ct.options,"conic");for(vt=0;vt<2;vt++)if(ut[vt].length>1)At[vt]=ct.create("point",ut[vt],yt);else if(ot.isPoint(ut[vt]))At[vt]=ct.select(ut[vt]);else if(ot.isFunction(ut[vt])&&ot.isPoint(ut[vt]()))At[vt]=ut[vt]();else{if(!ot.isString(ut[vt]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);At[vt]=ct.select(ut[vt])}if(ot.isNumber(ut[2]))gt=ot.createFunction(ut[2],ct);else if(ot.isFunction(ut[2])&&ot.isNumber(ut[2]()))gt=ut[2];else{if(ot.isPoint(ut[2]))mt=ct.select(ut[2]);else if(ut[2].length>1)mt=ct.create("point",ut[2],yt);else if(ot.isFunction(ut[2])&&ot.isPoint(ut[2]()))mt=ut[2]();else{if(!ot.isString(ut[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);mt=ct.select(ut[2])}gt=function(){return mt.Dist(At[0])-mt.Dist(At[1])}}for(ot.exists(ut[4])||(ut[4]=1.0001*Math.PI),ot.exists(ut[3])||(ut[3]=-1.0001*Math.PI),pt=ct.create("point",[function(){return .5*(At[0].X()+At[1].X())},function(){return .5*(At[0].Y()+At[1].Y())}],xt),ft=ct.create("curve",[function(Et){return 0},function(Et){return 0},ut[3],ut[4]],_t),ft.majorAxis=gt,dt=function(Et,bt){var wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft;bt||(wt=gt(),Tt=wt*wt,Mt=At[0].X(),Pt=At[0].Y(),It=At[1].X(),Ot=At[1].Y(),Bt=Mt-It,Ut=Pt-Ot,Ft=(Tt-Mt*Mt-Pt*Pt+It*It+Ot*Ot)/(2*wt),ft.quadraticform=[[Ft*Ft-It*It-Ot*Ot,Ft*Bt/wt+It,Ft*Ut/wt+Ot],[Ft*Bt/wt+It,Bt*Bt/Tt-1,Bt*Ut/Tt],[Ft*Ut/wt+Ot,Bt*Ut/Tt,Ut*Ut/Tt-1]])},ft.X=function(Et,bt){var wt=gt(),Tt=At[1].Dist(At[0]),Mt=.5*(Tt*Tt-wt*wt)/(Tt*Math.cos(Et)+wt),Pt=Math.atan2(At[1].Y()-At[0].Y(),At[1].X()-At[0].X());return bt||dt(Et,bt),At[0].X()+Math.cos(Pt+Et)*Mt},ft.Y=function(Et,bt){var wt=gt(),Tt=At[1].Dist(At[0]),Mt=.5*(Tt*Tt-wt*wt)/(Tt*Math.cos(Et)+wt),Pt=Math.atan2(At[1].Y()-At[0].Y(),At[1].X()-At[0].X());return At[0].Y()+Math.sin(Pt+Et)*Mt},ft.midpoint=ft.center=pt,ft.subs={center:ft.center},ft.inherits.push(ft.center,At[0],At[1]),ot.isPoint(mt)&&ft.inherits.push(mt),ft.type=_e.OBJECT_TYPE_CONIC,pt.addChild(ft),vt=0;vt<2;vt++)ot.isPoint(At[vt])&&At[vt].addChild(ft);return ot.isPoint(mt)&&mt.addChild(ft),ft.setParents(ut),ft},tt.createParabola=function(ct,ut,ht){var dt,ft,pt,mt=ut[0],gt=ut[1],vt=ot.copyAttributes(ht,ct.options,"conic","foci"),At=ot.copyAttributes(ht,ct.options,"conic","center"),yt=ot.copyAttributes(ht,ct.options,"conic");if(ut[0].length>1)mt=ct.create("point",ut[0],vt);else if(ot.isPoint(ut[0]))mt=ct.select(ut[0]);else if(ot.isFunction(ut[0])&&ot.isPoint(ut[0]()))mt=ut[0]();else{if(!ot.isString(ut[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,line]`);mt=ct.select(ut[0])}return ot.exists(ut[3])||(ut[3]=10),ot.exists(ut[2])||(ut[2]=-10),pt=ct.create("point",[function(){return st.projectPointToLine(mt,gt,ct).usrCoords}],At),ft=ct.create("curve",[function(xt){return 0},function(xt){return 0},ut[2],ut[3]],yt),ft.midpoint=ft.center=pt,ft.subs={center:ft.center},ft.inherits.push(ft.center),dt=function(xt,_t){var Et,bt,wt,Tt,Mt,Pt;_t||(Et=gt.stdform[1],bt=gt.stdform[2],wt=gt.stdform[0],Tt=Et*Et+bt*bt,Mt=mt.X(),Pt=mt.Y(),ft.quadraticform=[[wt*wt-Tt*(Mt*Mt+Pt*Pt),wt*Et+Tt*Mt,wt*bt+Tt*Pt],[wt*Et+Tt*Mt,-bt*bt,Et*bt],[wt*bt+Tt*Pt,Et*bt,-Et*Et]])},ft.X=function(xt,_t){var Et,bt,wt=gt.getAngle(),Tt=st.distPointLine(mt.coords.usrCoords,gt.stdform),Mt=gt.point1.coords.usrCoords,Pt=gt.point2.coords.usrCoords,It=mt.coords.usrCoords;return Mt[0]===0?Mt=[1,Pt[1]+gt.stdform[2],Pt[2]-gt.stdform[1]]:Pt[0]===0&&(Pt=[1,Mt[1]+gt.stdform[2],Mt[2]-gt.stdform[1]]),bt=(Pt[1]-Mt[1])*(It[2]-Mt[2])-(Pt[2]-Mt[2])*(It[1]-Mt[1])>=0?1:-1,Et=bt*Tt/(1-Math.sin(xt)),_t||dt(xt,_t),mt.X()+Math.cos(xt+wt)*Et},ft.Y=function(xt,_t){var Et,bt,wt=gt.getAngle(),Tt=st.distPointLine(mt.coords.usrCoords,gt.stdform),Mt=gt.point1.coords.usrCoords,Pt=gt.point2.coords.usrCoords,It=mt.coords.usrCoords;return Mt[0]===0?Mt=[1,Pt[1]+gt.stdform[2],Pt[2]-gt.stdform[1]]:Pt[0]===0&&(Pt=[1,Mt[1]+gt.stdform[2],Mt[2]-gt.stdform[1]]),bt=(Pt[1]-Mt[1])*(It[2]-Mt[2])-(Pt[2]-Mt[2])*(It[1]-Mt[1])>=0?1:-1,Et=bt*Tt/(1-Math.sin(xt)),mt.Y()+Math.sin(xt+wt)*Et},ft.type=_e.OBJECT_TYPE_CONIC,pt.addChild(ft),ot.isPoint(mt)&&(mt.addChild(ft),ft.inherits.push(mt)),gt.addChild(ft),ft.setParents(ut),ft},tt.createConic=function(ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt=[[1,0,0],[0,1,0],[0,0,1]],Pt=[[1,0,0],[0,1,0],[0,0,1]],It=[],Ot=[],Bt=ot.copyAttributes(ht,ct.options,"conic","point"),Ut=ot.copyAttributes(ht,ct.options,"conic","center"),Ft=ot.copyAttributes(ht,ct.options,"conic");if(ut.length===5)Tt=!0;else{if(ut.length!==6)throw new Error("JSXGraph: Can't create generic Conic with "+ut.length+" parameters.");Tt=!1}if(Tt)for(bt=0;bt<5;bt++)if(ut[bt].length>1)It[bt]=ct.create("point",ut[bt],Bt);else if(ot.isPoint(ut[bt]))It[bt]=ct.select(ut[bt]);else if(ot.isFunction(ut[bt])&&ot.isPoint(ut[bt]()))It[bt]=ut[bt]();else{if(!ot.isString(ut[bt]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof ut[bt]+`'.
Possible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]`);It[bt]=ct.select(ut[bt])}else wt=[[0,0,0],[0,0,0],[0,0,0]],wt[0][0]=ot.isFunction(ut[2])?function(){return ut[2]()}:function(){return ut[2]},wt[0][1]=ot.isFunction(ut[4])?function(){return ut[4]()}:function(){return ut[4]},wt[0][2]=ot.isFunction(ut[5])?function(){return ut[5]()}:function(){return ut[5]},wt[1][1]=ot.isFunction(ut[0])?function(){return ut[0]()}:function(){return ut[0]},wt[1][2]=ot.isFunction(ut[3])?function(){return ut[3]()}:function(){return ut[3]},wt[2][2]=ot.isFunction(ut[1])?function(){return ut[1]()}:function(){return ut[1]};if(gt=function(jt){var Dt,Gt;for(Dt=0;Dt<3;Dt++)for(Gt=Dt;Gt<3;Gt++)jt[Dt][Gt]+=jt[Gt][Dt];for(Dt=0;Dt<3;Dt++)for(Gt=0;Gt<Dt;Gt++)jt[Dt][Gt]=jt[Gt][Dt];return jt},mt=function(jt,Dt){var Gt,zt,$t=[[0,0,0],[0,0,0],[0,0,0]];for(Gt=0;Gt<3;Gt++)for(zt=0;zt<3;zt++)$t[Gt][zt]=jt[Gt]*Dt[zt];return gt($t)},pt=function(jt,Dt,Gt){var zt,$t,Ht,er,Zt,or=[[0,0,0],[0,0,0],[0,0,0]];for(Zt=nt.matVecMult(Dt,Gt),Ht=nt.innerProduct(Gt,Zt),Zt=nt.matVecMult(jt,Gt),er=nt.innerProduct(Gt,Zt),zt=0;zt<3;zt++)for($t=0;$t<3;$t++)or[zt][$t]=Ht*jt[zt][$t]-er*Dt[zt][$t];return or},ft=ct.create("curve",[function(jt){return 0},function(jt){return 0},0,2*Math.PI],Ft),dt=function(jt,Dt){var Gt,zt,$t,Ht;if(!Dt){if(Tt){for(Gt=0;Gt<5;Gt++)Ot[Gt]=It[Gt].coords.usrCoords;_t=mt(nt.crossProduct(Ot[0],Ot[1]),nt.crossProduct(Ot[2],Ot[3])),Et=mt(nt.crossProduct(Ot[0],Ot[2]),nt.crossProduct(Ot[1],Ot[3])),Pt=pt(_t,Et,Ot[4])}else for(Gt=0;Gt<3;Gt++)for(zt=Gt;zt<3;zt++)Pt[Gt][zt]=wt[Gt][zt](),zt>Gt&&(Pt[zt][Gt]=Pt[Gt][zt]);for(ft.quadraticform=Pt,vt=it.Jacobi(Pt),vt[0][0][0]<0&&(vt[0][0][0]*=-1,vt[0][1][1]*=-1,vt[0][2][2]*=-1),Gt=0;Gt<3;Gt++){for($t=0,zt=0;zt<3;zt++)$t+=vt[1][zt][Gt]*vt[1][zt][Gt];$t=Math.sqrt($t)}Mt=vt[1],xt=Math.sqrt(Math.abs(vt[0][0][0])),At=Math.sqrt(Math.abs(vt[0][1][1])),yt=Math.sqrt(Math.abs(vt[0][2][2]))}return vt[0][1][1]<=0&&vt[0][2][2]<=0?Ht=nt.matVecMult(Mt,[1/xt,Math.cos(jt)/At,Math.sin(jt)/yt]):vt[0][1][1]<=0&&vt[0][2][2]>0?Ht=nt.matVecMult(Mt,[Math.cos(jt)/xt,1/At,Math.sin(jt)/yt]):vt[0][2][2]<0&&(Ht=nt.matVecMult(Mt,[Math.sin(jt)/xt,Math.cos(jt)/At,1/yt])),ot.exists(Ht)?(Ht[1]/=Ht[0],Ht[2]/=Ht[0],Ht[0]=1):Ht=[1,NaN,NaN],Ht},ft.X=function(jt,Dt){return dt(jt,Dt)[1]},ft.Y=function(jt,Dt){return dt(jt,Dt)[2]},ft.midpoint=ct.create("point",[function(){var jt=ft.quadraticform;return[jt[1][1]*jt[2][2]-jt[1][2]*jt[1][2],jt[1][2]*jt[0][2]-jt[2][2]*jt[0][1],jt[0][1]*jt[1][2]-jt[1][1]*jt[0][2]]}],Ut),ft.type=_e.OBJECT_TYPE_CONIC,ft.center=ft.midpoint,ft.subs={center:ft.center},ft.inherits.push(ft.center),ft.inherits=ft.inherits.concat(It),Tt){for(bt=0;bt<5;bt++)ot.isPoint(It[bt])&&It[bt].addChild(ft);ft.setParents(ut)}return ft.addChild(ft.center),ft},tt.registerElement("ellipse",tt.createEllipse),tt.registerElement("hyperbola",tt.createHyperbola),tt.registerElement("parabola",tt.createParabola),tt.registerElement("conic",tt.createConic),{createEllipse:tt.createEllipse,createHyperbola:tt.createHyperbola,createParabola:tt.createParabola,createConic:tt.createConic}}),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],function(tt,_e,rt,nt,it,st,ot){return tt.Circle=function(lt,at,ct,ut,ht){this.constructor(lt,ht,nt.OBJECT_TYPE_CIRCLE,nt.OBJECT_CLASS_CIRCLE),this.method=at,this.midpoint=this.board.select(ct),this.center=this.board.select(ct),this.point2=null,this.radius=0,this.line=null,this.circle=null,at==="twoPoints"?(this.point2=lt.select(ut),this.radius=this.Radius()):at==="pointRadius"?(this.gxtterm=ut,this.updateRadius=ot.createFunction(ut,this.board,null,!0),this.updateRadius()):at==="pointLine"?(this.line=lt.select(ut),this.radius=this.line.point1.coords.distance(nt.COORDS_BY_USER,this.line.point2.coords)):at==="pointCircle"&&(this.circle=lt.select(ut),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),this.center.addChild(this),at==="pointRadius"?this.notifyParents(ut):at==="pointLine"?this.line.addChild(this):at==="pointCircle"?this.circle.addChild(this):at==="twoPoints"&&this.point2.addChild(this),this.methodMap=ot.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},tt.Circle.prototype=new _e,tt.extend(tt.Circle.prototype,{hasPoint:function(lt,at){var ct,ut,ht,dt=this.board.options.precision.hasPoint,ft=this.center.coords.usrCoords,pt=new rt(nt.COORDS_BY_SCREEN,[lt,at],this.board),mt=this.Radius();return ct=ft[1]-pt.usrCoords[1],ut=ft[2]-pt.usrCoords[2],ht=Math.sqrt(ct*ct+ut*ut),dt+=.5*ot.evaluate(this.visProp.strokewidth),dt/=Math.sqrt(this.board.unitX*this.board.unitY),ot.evaluate(this.visProp.hasinnerpoints)?ht<mt+dt:Math.abs(ht-mt)<dt},generatePolynomial:function(lt){var at=this.center.symbolic.x,ct=this.center.symbolic.y,ut=lt.symbolic.x,ht=lt.symbolic.y,dt=this.generateRadiusSquared();return dt===""?[]:["(("+ut+")-("+at+"))^2 + (("+ht+")-("+ct+"))^2 - ("+dt+")"]},generateRadiusSquared:function(){var lt,at,ct,ut,ht,dt,ft="";return this.method==="twoPoints"?(lt=this.center.symbolic.x,at=this.center.symbolic.y,ct=this.point2.symbolic.x,ut=this.point2.symbolic.y,ft="(("+ct+")-("+lt+"))^2 + (("+ut+")-("+at+"))^2"):this.method==="pointRadius"?ot.isNumber(this.radius)&&(ft=(this.radius*this.radius).toString()):this.method==="pointLine"?(ct=this.line.point1.symbolic.x,ut=this.line.point1.symbolic.y,ht=this.line.point2.symbolic.x,dt=this.line.point2.symbolic.y,ft="(("+ct+")-("+ht+"))^2 + (("+ut+")-("+dt+"))^2"):this.method==="pointCircle"&&(ft=this.circle.Radius()),ft},update:function(){return this.needsUpdate&&(ot.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.method==="pointLine"?this.radius=this.line.point1.coords.distance(nt.COORDS_BY_USER,this.line.point2.coords):this.method==="pointCircle"?this.radius=this.circle.Radius():this.method==="pointRadius"&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform()),this},updateQuadraticform:function(){var lt=this.center,at=lt.X(),ct=lt.Y(),ut=this.Radius();this.quadraticform=[[at*at+ct*ct-ut*ut,-at,-ct],[-at,1,0],[-ct,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=ot.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(lt){ot.isString(lt)&&st.findDependencies(this,lt,this.board)},setRadius:function(lt){return this.updateRadius=ot.createFunction(lt,this.board,null,!0),this.board.update(),this},Radius:function(lt){return ot.exists(lt)?(this.setRadius(lt),this.Radius()):this.method==="twoPoints"?ot.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||ot.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):this.method==="pointLine"||this.method==="pointCircle"?this.radius:this.method==="pointRadius"?this.updateRadius():NaN},getRadius:function(){return tt.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var lt,at,ct=this.Radius(),ut=this.center.coords.usrCoords;switch(ot.evaluate(this.visProp.label.position)){case"lft":lt=ut[1]-ct,at=ut[2];break;case"llft":lt=ut[1]-Math.sqrt(.5)*ct,at=ut[2]-Math.sqrt(.5)*ct;break;case"rt":lt=ut[1]+ct,at=ut[2];break;case"lrt":lt=ut[1]+Math.sqrt(.5)*ct,at=ut[2]-Math.sqrt(.5)*ct;break;case"urt":lt=ut[1]+Math.sqrt(.5)*ct,at=ut[2]+Math.sqrt(.5)*ct;break;case"top":lt=ut[1],at=ut[2]+ct;break;case"bot":lt=ut[1],at=ut[2]-ct;break;default:lt=ut[1]-Math.sqrt(.5)*ct,at=ut[2]+Math.sqrt(.5)*ct}return new rt(nt.COORDS_BY_USER,[lt,at],this.board)},cloneToBackground:function(){var lt,at=this.Radius(),ct={id:this.id+"T"+this.numTraces,elementClass:nt.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return at},getRadius:function(){return at},board:this.board,visProp:ot.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return ct.visProp.layer=this.board.options.layer.trace,this.numTraces++,ot.clearVisPropOld(ct),ct.visPropCalc={visible:ot.evaluate(ct.visProp.visible)},lt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(ct),this.board.renderer.enhancedRendering=lt,this.traces[ct.id]=ct.rendNode,this},addTransform:function(lt){var at,ct=ot.isArray(lt)?lt:[lt],ut=ct.length;for(at=0;at<ut;at++)this.center.transformations.push(ct[at]),this.method==="twoPoints"&&this.point2.transformations.push(ct[at]);return this},snapToGrid:function(){var lt=ot.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(lt,!0),this.method==="twoPoints"&&this.point2.handleSnapToGrid(lt,!0),this},snapToPoints:function(){var lt=ot.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(lt),this.method==="twoPoints"&&this.point2.handleSnapToPoints(lt),this},X:function(lt){return this.Radius()*Math.cos(2*lt*Math.PI)+this.center.coords.usrCoords[1]},Y:function(lt){return this.Radius()*Math.sin(2*lt*Math.PI)+this.center.coords.usrCoords[2]},Z:function(lt){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var lt=this.Radius();return lt*lt*Math.PI},bounds:function(){var lt=this.center.coords.usrCoords,at=this.Radius();return[lt[1]-at,lt[2]+at,lt[1]+at,lt[2]-at]},getParents:function(){return this.parents.length===1?this.parents.concat(this.radius):this.parents}}),tt.createCircle=function(lt,at,ct){var ut,ht,dt,ft,pt;if(ht=[],pt=lt.select(at[0]),ot.isObject(pt)&&pt.elementClass===nt.OBJECT_CLASS_CIRCLE&&ot.isTransformationOrArray(at[1]))return ft=ot.copyAttributes(ct,lt.options,"circle"),ut=it.createEllipse(lt,[pt.center,pt.center,function(){return 2*pt.Radius()}],ft),ut.addTransform(at[1]),ut;for(dt=0;dt<at.length;dt++)if(ot.isPointType(lt,at[dt])){if(ht=ht.concat(ot.providePoints(lt,[at[dt]],ct,"circle",["center"])),ht[ht.length-1]===!1)throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else ht.push(at[dt]);if(ft=ot.copyAttributes(ct,lt.options,"circle"),ht.length===2&&ot.isPoint(ht[0])&&ot.isPoint(ht[1]))ut=new tt.Circle(lt,"twoPoints",ht[0],ht[1],ft);else if((ot.isNumber(ht[0])||ot.isFunction(ht[0])||ot.isString(ht[0]))&&ot.isPoint(ht[1]))ut=new tt.Circle(lt,"pointRadius",ht[1],ht[0],ft);else if((ot.isNumber(ht[1])||ot.isFunction(ht[1])||ot.isString(ht[1]))&&ot.isPoint(ht[0]))ut=new tt.Circle(lt,"pointRadius",ht[0],ht[1],ft);else if(ht[0].elementClass===nt.OBJECT_CLASS_CIRCLE&&ot.isPoint(ht[1]))ut=new tt.Circle(lt,"pointCircle",ht[1],ht[0],ft);else if(ht[1].elementClass===nt.OBJECT_CLASS_CIRCLE&&ot.isPoint(ht[0]))ut=new tt.Circle(lt,"pointCircle",ht[0],ht[1],ft);else if(ht[0].elementClass===nt.OBJECT_CLASS_LINE&&ot.isPoint(ht[1]))ut=new tt.Circle(lt,"pointLine",ht[1],ht[0],ft);else if(ht[1].elementClass===nt.OBJECT_CLASS_LINE&&ot.isPoint(ht[0]))ut=new tt.Circle(lt,"pointLine",ht[0],ht[1],ft);else{if(!(at.length===3&&ot.isPoint(ht[0])&&ot.isPoint(ht[1])&&ot.isPoint(ht[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof at[0]+"' and '"+typeof at[1]+`'.
Possible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]`);if(!tt.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");ut=tt.elements.circumcircle(lt,ht,ft)}for(ut.isDraggable=!0,ut.setParents(ht),ut.elType="circle",dt=0;dt<ht.length;dt++)ot.isPoint(ht[dt])&&ut.inherits.push(ht[dt]);return ut},tt.registerElement("circle",tt.createCircle),{Circle:tt.Circle,createCircle:tt.createCircle}}),define("base/composition",["jxg","utils/type"],function(tt,_e){return tt.Composition=function(rt){var nt,it=this,st=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"];for(nt=0;nt<st.length;nt++)this[st[nt]]=function(ot){return function(){var lt;for(lt in it.elements)it.elements.hasOwnProperty(lt)&&_e.exists(it.elements[lt][ot])&&it.elements[lt][ot].apply(it.elements[lt],arguments);return it}}(st[nt]);this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"};for(nt in rt)rt.hasOwnProperty(nt)&&this.add(nt,rt[nt]);this.dump=!0,this.subs={}},tt.extend(tt.Composition.prototype,{add:function(rt,nt){return!(_e.exists(this[rt])||!_e.exists(nt))&&(_e.exists(nt.id)?this.elements[nt.id]=nt:this.elements[rt]=nt,_e.exists(nt.name)&&(this.elementsByName[nt.name]=nt),nt.on("attribute:name",this.nameListener,this),this.objectsList.push(nt),this[rt]=nt,this.methodMap[rt]=nt,!0)},remove:function(rt){var nt,it=!1;for(nt in this.elements)if(this.elements.hasOwnProperty(nt)&&this.elements[nt].id===this[rt].id){it=!0;break}return it&&(delete this.elements[this[rt].id],delete this[rt]),it},nameListener:function(rt,nt,it){delete this.elementsByName[rt],this.elementsByName[nt]=it},select:function(rt){return _e.exists(tt.Board)?tt.Board.prototype.select.call(this,rt):new tt.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var rt;for(rt in this.subs)this.subs.hasOwnProperty(rt)&&this.subs[rt].visProp;return this.attr}}),tt.Composition}),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element","base/line","base/transformation"],function(tt,_e,rt,nt,it,st,ot,lt,at){return tt.Polygon=function(ct,ut,ht){this.constructor(ct,ht,_e.OBJECT_TYPE_POLYGON,_e.OBJECT_CLASS_AREA);var dt,ft,pt,mt,gt=st.copyAttributes(ht,ct.options,"polygon","borders");for(this.withLines=ht.withlines,this.attr_line=gt,this.vertices=[],dt=0;dt<ut.length;dt++)this.vertices[dt]=this.board.select(ut[dt]);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(pt=this.vertices.length-1,mt=0;mt<pt;mt++)dt=(mt+1)%pt,gt.id=gt.ids&&gt.ids[dt],gt.name=gt.names&&gt.names[dt],gt.strokecolor=st.isArray(gt.colors)&&gt.colors[dt%gt.colors.length]||gt.strokecolor,gt.visible=st.exists(ht.borders.visible)?ht.borders.visible:ht.visible,gt.strokecolor===!1&&(gt.strokecolor="none"),ft=ct.create("segment",[this.vertices[dt],this.vertices[dt+1]],gt),ft.dump=!1,this.borders[dt]=ft,ft.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),dt=0;dt<this.vertices.length-1;dt++)this.board.select(this.vertices[dt]).addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=tt.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},tt.Polygon.prototype=new ot,tt.extend(tt.Polygon.prototype,{hasPoint:function(ct,ut){var ht,dt,ft,pt=!1;if(st.evaluate(this.visProp.hasinnerpoints)){for(ft=this.vertices.length,ht=0,dt=ft-2;ht<ft-1;dt=ht++)this.vertices[ht].coords.scrCoords[2]>ut!=this.vertices[dt].coords.scrCoords[2]>ut&&ct<(this.vertices[dt].coords.scrCoords[1]-this.vertices[ht].coords.scrCoords[1])*(ut-this.vertices[ht].coords.scrCoords[2])/(this.vertices[dt].coords.scrCoords[2]-this.vertices[ht].coords.scrCoords[2])+this.vertices[ht].coords.scrCoords[1]&&(pt=!pt);if(pt)return!0}for(ft=this.borders.length,ht=0;ht<ft;ht++)if(this.borders[ht].hasPoint(ct,ut)){pt=!0;break}return pt},updateRenderer:function(){var ct,ut;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(ut=this.vertices.length,this.isReal=!0,ct=0;ct<ut;++ct)if(!this.vertices[ct].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var ct,ut,ht,dt,ft;if(this.vertices.length===0)return new rt(_e.COORDS_BY_USER,[1,0,0],this.board);for(ct=this.vertices[0].X(),ut=this.vertices[0].Y(),ht=ct,dt=ut,ft=0;ft<this.vertices.length;ft++)this.vertices[ft].X()<ct&&(ct=this.vertices[ft].X()),this.vertices[ft].X()>ht&&(ht=this.vertices[ft].X()),this.vertices[ft].Y()>ut&&(ut=this.vertices[ft].Y()),this.vertices[ft].Y()<dt&&(dt=this.vertices[ft].Y());return new rt(_e.COORDS_BY_USER,[.5*(ct+ht),.5*(ut+dt)],this.board)},getLabelAnchor:tt.shortcut(tt.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var ct,ut={};return ut.id=this.id+"T"+this.numTraces,this.numTraces++,ut.vertices=this.vertices,ut.visProp=st.deepCopy(this.visProp,this.visProp.traceattributes,!0),ut.visProp.layer=this.board.options.layer.trace,ut.board=this.board,st.clearVisPropOld(ut),ut.visPropCalc={visible:st.evaluate(ut.visProp.visible)},ct=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(ut),this.board.renderer.enhancedRendering=ct,this.traces[ut.id]=ut.rendNode,this},hideElement:function(ct){var ut;if(tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!ct)for(ut=0;ut<this.borders.length;ut++)this.borders[ut].hideElement();this.hasLabel&&st.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(ct){var ut;if(tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!ct)for(ut=0;ut<this.borders.length;ut++)this.borders[ut].showElement().updateRenderer();return st.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(it.signedPolygon(this.vertices,!0))},Perimeter:function(){var ct,ut=this.vertices.length,ht=0;for(ct=1;ct<ut;++ct)ht+=this.vertices[ct].Dist(this.vertices[ct-1]);return ht},boundingBox:function(){var ct,ut,ht=[0,0,0,0],dt=this.vertices.length-1;if(dt===0)return ht;for(ht[0]=this.vertices[0].X(),ht[2]=ht[0],ht[1]=this.vertices[0].Y(),ht[3]=ht[1],ct=1;ct<dt;++ct)ut=this.vertices[ct].X(),ut<ht[0]?ht[0]=ut:ut>ht[2]&&(ht[2]=ut),ut=this.vertices[ct].Y(),ut>ht[1]?ht[1]=ut:ut<ht[3]&&(ht[3]=ut);return ht},bounds:function(){return this.boundingBox()},remove:function(){var ct;for(ct=0;ct<this.borders.length;ct++)this.board.removeObject(this.borders[ct]);ot.prototype.remove.call(this)},findPoint:function(ct){var ut;if(!st.isPoint(ct))return-1;for(ut=0;ut<this.vertices.length;ut++)if(this.vertices[ut].id===ct.id)return ut;return-1},addPoints:function(ct){var ut=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(ut))},insertPoints:function(ct,ut){var ht,dt,ft=[];if(arguments.length===0)return this;if(ct<0||ct>this.vertices.length-2)return this;for(ht=1;ht<arguments.length;ht++)st.isPoint(arguments[ht])&&ft.push(arguments[ht]);if(dt=this.vertices.slice(0,ct+1).concat(ft),this.vertices=dt.concat(this.vertices.slice(ct+1)),this.withLines){for(dt=this.borders.slice(0,ct),this.board.removeObject(this.borders[ct]),ht=0;ht<ft.length;ht++)dt.push(this.board.create("segment",[this.vertices[ct+ht],this.vertices[ct+ht+1]],this.attr_line));dt.push(this.board.create("segment",[this.vertices[ct+ft.length],this.vertices[ct+ft.length+1]],this.attr_line)),this.borders=dt.concat(this.borders.slice(ct+1))}return this.board.update(),this},removePoints:function(ct){var ut,ht,dt,ft=[],pt=[],mt=[],gt=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),ut=0;ut<arguments.length;ut++)dt=arguments[ut],st.isPoint(dt)&&(dt=this.findPoint(dt)),st.isNumber(dt)&&dt>-1&&dt<this.vertices.length&&st.indexOf(mt,dt)===-1&&mt.push(dt);for(ut=0;ut<mt.length;ut++)this.vertices[mt[ut]].removeChild(this);for(mt=mt.sort(),ft=this.vertices.slice(),pt=this.borders.slice(),this.withLines&&gt.push([mt[mt.length-1]]),ut=mt.length-1;ut>-1;ut--)ft[mt[ut]]=-1,this.withLines&&mt[ut]-1>mt[ut-1]&&(gt[gt.length-1][1]=mt[ut],gt.push([mt[ut-1]]));for(this.withLines&&(gt[gt.length-1][1]=mt[0]),this.vertices=[],ut=0;ut<ft.length;ut++)st.isPoint(ft[ut])&&this.vertices.push(ft[ut]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(ut=0;ut<gt.length;ut++){for(ht=gt[ut][1]-1;ht<gt[ut][0]+1;ht++)ht<0?(ht=0,this.board.removeObject(this.borders[pt.length-1]),pt[pt.length-1]=-1):ht>pt.length-1&&(ht=pt.length-1),this.board.removeObject(this.borders[ht]),pt[ht]=-1;gt[ut][1]!==0&&gt[ut][0]!==ft.length-1&&(pt[gt[ut][0]-1]=this.board.create("segment",[ft[Math.max(gt[ut][1]-1,0)],ft[Math.min(gt[ut][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],ut=0;ut<pt.length;ut++)pt[ut]!==-1&&this.borders.push(pt[ut]);gt[0][1]!==this.vertices.length-1&&gt[gt.length-1][1]!==0||this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var ct,ut=ot.prototype.getAttributes.call(this);if(this.withLines)for(ut.lines=ut.lines||{},ut.lines.ids=[],ut.lines.colors=[],ct=0;ct<this.borders.length;ct++)ut.lines.ids.push(this.borders[ct].id),ut.lines.colors.push(this.borders[ct].visProp.strokecolor);return ut},snapToGrid:function(){var ct,ut;for(ut=!!st.evaluate(this.visProp.snaptogrid),ct=0;ct<this.vertices.length;ct++)this.vertices[ct].handleSnapToGrid(ut,!0)},setPositionDirectly:function(ct,ut,ht){var dt,ft,pt,mt,gt=new rt(ct,ut,this.board),vt=new rt(ct,ht,this.board);for(mt=this.vertices.length-1,pt=0;pt<mt;pt++)if(!this.vertices[pt].draggable())return this;return dt=nt.subtract(gt.usrCoords,vt.usrCoords),ft=this.board.create("transform",dt.slice(1),{type:"translate"}),ft.applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(ct){var ut,ht,dt,ft,pt,mt,gt,vt=tt.Math.Geometry.sortVertices(this.vertices),At=tt.Math.Geometry.sortVertices(ct.vertices),yt=vt.length-1,xt=At.length-1,_t=[],Et=function(bt,wt,Tt){return(wt[1]-bt[1])*(Tt[2]-bt[2])-(wt[2]-bt[2])*(Tt[1]-bt[1])>=0};for(dt=0;dt<xt;dt++)_t.push(At[dt]);for(dt=0;dt<yt;dt++)for(ht=_t.slice(0),ut=ht.length,_t=[],pt=ht[ut-1],ft=0;ft<ut;ft++)mt=ht[ft],Et(vt[dt],vt[dt+1],mt)?(Et(vt[dt],vt[dt+1],pt)||(gt=tt.Math.Geometry.meetSegmentSegment(pt,mt,vt[dt],vt[dt+1]),gt[0][1]/=gt[0][0],gt[0][2]/=gt[0][0],gt[0][0]=1,_t.push(gt[0])),_t.push(mt)):Et(vt[dt],vt[dt+1],pt)&&(gt=tt.Math.Geometry.meetSegmentSegment(pt,mt,vt[dt],vt[dt+1]),gt[0][1]/=gt[0][0],gt[0][2]/=gt[0][0],gt[0][0]=1,_t.push(gt[0])),pt=mt;return _t},intersect:function(ct){return this.sutherlandHodgman(ct)}}),tt.createPolygon=function(ct,ut,ht){var dt,ft,pt,mt,gt,vt,At=[],yt=!1;if(gt=st.copyAttributes(ht,ct.options,"polygon"),mt=ct.select(ut[0]),st.isObject(mt)&&mt.type===_e.OBJECT_TYPE_POLYGON&&st.isTransformationOrArray(ut[1]))for(yt=!0,pt=mt.vertices.length-1,vt=st.copyAttributes(ht,ct.options,"polygon","vertices"),ft=0;ft<pt;ft++)vt.withlabel&&(vt.name=mt.vertices[ft].name===""?"":mt.vertices[ft].name+"'"),At.push(ct.create("point",[mt.vertices[ft],ut[1]],vt));else if((At=st.providePoints(ct,ut,ht,"polygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(gt=st.copyAttributes(ht,ct.options,"polygon"),dt=new tt.Polygon(ct,At,gt),dt.isDraggable=!0,yt)for(pt=mt.vertices.length-1,ft=0;ft<pt;ft++)At[ft].prepareUpdate().update().updateVisibility(st.evaluate(dt.visProp.visible)).updateRenderer();return dt},tt.createRegularPolygon=function(ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt=[];if(gt=ut.length,pt=ut[gt-1],st.isNumber(pt)&&(ut.length!==3||pt<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(st.isNumber(ct.select(pt))?(gt--,vt=!1):(pt=gt,vt=!0),(yt=st.providePoints(ct,ut.slice(0,gt),ht,"regularpolygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(At=st.copyAttributes(ht,ct.options,"regularpolygon","vertices"),ft=2;ft<pt;ft++)mt=ct.create("transform",[Math.PI*(2-(pt-2)/pt),yt[ft-1]],{type:"rotate"}),vt?(yt[ft].addTransform(yt[ft-2],mt),yt[ft].fullUpdate()):(st.isArray(At.ids)&&At.ids.length>=pt-2&&(At.id=At.ids[ft-2]),yt[ft]=ct.create("point",[yt[ft-2],mt],At),yt[ft].type=_e.OBJECT_TYPE_CAS,yt[ft].isDraggable=!0,yt[ft].visProp.fixed=!1);return At=st.copyAttributes(ht,ct.options,"regularpolygon"),dt=ct.create("polygon",yt,At),dt.elType="regularpolygon",dt},tt.registerElement("polygon",tt.createPolygon),tt.registerElement("regularpolygon",tt.createRegularPolygon),{Polygon:tt.Polygon,createPolygon:tt.createPolygon,createRegularPolygon:tt.createRegularPolygon}}),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants","base/curve","element/composition"],function(tt,_e,rt,nt,it,st,ot,lt,at){return tt.createArc=function(ct,ut,ht){var dt,ft,pt;if((pt=st.providePoints(ct,ut,ht,"arc",["center","radiuspoint","anglepoint"]))===!1||pt.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [arc, transformation]`);return ft=st.copyAttributes(ht,ct.options,"arc"),dt=ct.create("curve",[[0],[0]],ft),dt.elType="arc",dt.setParents(pt),dt.type=ot.OBJECT_TYPE_ARC,dt.center=pt[0],dt.radiuspoint=pt[1],dt.point2=dt.radiuspoint,dt.anglepoint=pt[2],dt.point3=dt.anglepoint,dt.center.addChild(dt),dt.radiuspoint.addChild(dt),dt.anglepoint.addChild(dt),dt.useDirection=ft.usedirection,dt.updateDataArray=function(){var mt,gt,vt,At,yt,xt,_t=1,Et=this.radiuspoint,bt=this.center,wt=this.anglepoint,Tt=st.evaluate(this.visProp.selection);gt=_e.rad(Et,bt,wt),(Tt==="minor"&&gt>Math.PI||Tt==="major"&&gt<Math.PI)&&(_t=-1),this.useDirection&&(At=pt[1].coords.usrCoords,yt=pt[3].coords.usrCoords,xt=pt[2].coords.usrCoords,vt=(At[1]-xt[1])*(At[2]-yt[2])-(At[2]-xt[2])*(At[1]-yt[1]),vt<0?(this.radiuspoint=pt[1],this.anglepoint=pt[2]):(this.radiuspoint=pt[2],this.anglepoint=pt[1])),Et=Et.coords.usrCoords,bt=bt.coords.usrCoords,wt=wt.coords.usrCoords,mt=_e.bezierArc(Et,bt,wt,!1,_t),this.dataX=mt[0],this.dataY=mt[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},dt.Radius=function(){return this.radiuspoint.Dist(this.center)},dt.getRadius=function(){return tt.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},dt.Value=function(){return this.Radius()*_e.rad(this.radiuspoint,this.center,this.anglepoint)},dt.hasPoint=function(mt,gt){var vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt=this.Radius(),Pt=st.evaluate(this.visProp.selection);return st.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(mt,gt):(Tt=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),At=new nt(ot.COORDS_BY_SCREEN,[mt,gt],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),bt=rt.inverse(this.transformMat),wt=rt.matVecMult(bt,At.usrCoords),At=new nt(ot.COORDS_BY_USER,wt,this.board)),vt=this.center.coords.distance(ot.COORDS_BY_USER,At),yt=Math.abs(vt-Mt)<Tt,yt&&(xt=_e.rad(this.radiuspoint,this.center,At.usrCoords.slice(1)),_t=0,Et=_e.rad(this.radiuspoint,this.center,this.anglepoint),(Pt==="minor"&&Et>Math.PI||Pt==="major"&&Et<Math.PI)&&(_t=Et,Et=2*Math.PI),(xt<_t||xt>Et)&&(yt=!1)),yt)},dt.hasPointSector=function(mt,gt){var vt,At,yt,xt=new nt(ot.COORDS_BY_SCREEN,[mt,gt],this.board),_t=this.Radius(),Et=this.center.coords.distance(ot.COORDS_BY_USER,xt),bt=Et<_t,wt=st.evaluate(this.visProp.selection);return bt&&(vt=_e.rad(this.radiuspoint,this.center,xt.usrCoords.slice(1)),At=0,yt=_e.rad(this.radiuspoint,this.center,this.anglepoint),(wt==="minor"&&yt>Math.PI||wt==="major"&&yt<Math.PI)&&(At=yt,yt=2*Math.PI),(vt<At||vt>yt)&&(bt=!1)),bt},dt.getTextAnchor=function(){return this.center.coords},dt.getLabelAnchor=function(){var mt,gt,vt,At,yt,xt=_e.rad(this.radiuspoint,this.center,this.anglepoint),_t=10/this.board.unitX,Et=10/this.board.unitY,bt=this.point2.coords.usrCoords,wt=this.center.coords.usrCoords,Tt=bt[1]-wt[1],Mt=bt[2]-wt[2],Pt=st.evaluate(this.visProp.selection),It=this.label?this.label.visProp:this.visProp.label;return(Pt==="minor"&&xt>Math.PI||Pt==="major"&&xt<Math.PI)&&(xt=-(2*Math.PI-xt)),mt=new nt(ot.COORDS_BY_USER,[wt[1]+Math.cos(.5*xt)*Tt-Math.sin(.5*xt)*Mt,wt[2]+Math.sin(.5*xt)*Tt+Math.cos(.5*xt)*Mt],this.board),vt=mt.usrCoords[1]-wt[1],At=mt.usrCoords[2]-wt[2],yt=Math.sqrt(vt*vt+At*At),vt=vt*(yt+_t)/yt,At=At*(yt+Et)/yt,gt=[wt[1]+vt,wt[2]+At],It.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],gt)),new nt(ot.COORDS_BY_USER,gt,this.board)},dt.updateQuadraticform=it.Circle.prototype.updateQuadraticform,dt.updateStdform=it.Circle.prototype.updateStdform,dt.methodMap=tt.deepCopy(dt.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),dt.prepareUpdate().update(),dt},tt.registerElement("arc",tt.createArc),tt.createSemicircle=function(ct,ut,ht){var dt,ft,pt,mt;if((mt=st.providePoints(ct,ut,ht,"point"))===!1||mt.length!==2)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point]`);return pt=st.copyAttributes(ht,ct.options,"semicircle","center"),ft=ct.create("midpoint",mt,pt),ft.dump=!1,pt=st.copyAttributes(ht,ct.options,"semicircle"),dt=ct.create("arc",[ft,mt[1],mt[0]],pt),dt.elType="semicircle",dt.setParents([mt[0].id,mt[1].id]),dt.subs={midpoint:ft},dt.inherits.push(ft),dt.midpoint=dt.center=ft,dt},tt.registerElement("semicircle",tt.createSemicircle),tt.createCircumcircleArc=function(ct,ut,ht){var dt,ft,pt,mt;if((mt=st.providePoints(ct,ut,ht,"point"))===!1||mt.length!==3)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point]`);return pt=st.copyAttributes(ht,ct.options,"circumcirclearc","center"),ft=ct.create("circumcenter",mt,pt),ft.dump=!1,pt=st.copyAttributes(ht,ct.options,"circumcirclearc"),pt.usedirection=!0,dt=ct.create("arc",[ft,mt[0],mt[2],mt[1]],pt),dt.elType="circumcirclearc",dt.setParents([mt[0].id,mt[1].id,mt[2].id]),dt.subs={center:ft},dt.inherits.push(ft),dt.center=ft,dt},tt.registerElement("circumcirclearc",tt.createCircumcircleArc),tt.createMinorArc=function(ct,ut,ht){return ht.selection="minor",tt.createArc(ct,ut,ht)},tt.registerElement("minorarc",tt.createMinorArc),tt.createMajorArc=function(ct,ut,ht){return ht.selection="major",tt.createArc(ct,ut,ht)},tt.registerElement("majorarc",tt.createMajorArc),{createArc:tt.createArc,createSemicircle:tt.createSemicircle,createCircumcircleArc:tt.createCircumcircleArc,createMinorArc:tt.createMinorArc,createMajorArc:tt.createMajorArc}}),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type","base/point","base/curve","base/transformation","element/composition"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut){return tt.createSector=function(ht,dt,ft){var pt,mt,gt,vt,At,yt="invalid",xt=["center","radiuspoint","anglepoint"];if(dt[0].elementClass===st.OBJECT_CLASS_LINE&&dt[1].elementClass===st.OBJECT_CLASS_LINE&&(ot.isArray(dt[2])||ot.isNumber(dt[2]))&&(ot.isArray(dt[3])||ot.isNumber(dt[3]))&&(ot.isNumber(dt[4])||ot.isFunction(dt[4])))yt="2lines";else{if((At=ot.providePoints(ht,dt,ft,"sector",xt))===!1)throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");yt="3points"}return mt=ot.copyAttributes(ft,ht.options,"sector"),pt=ht.create("curve",[[0],[0]],mt),pt.type=st.OBJECT_TYPE_SECTOR,pt.elType="sector",yt==="2lines"?(pt.Radius=function(){return ot.evaluate(dt[4])},pt.line1=ht.select(dt[0]),pt.line2=ht.select(dt[1]),pt.line1.addChild(pt),pt.line2.addChild(pt),pt.setParents(dt),pt.point1={visProp:{}},pt.point2={visProp:{}},pt.point3={visProp:{}},gt=_e.meetLineLine(pt.line1.stdform,pt.line2.stdform,0,ht),ot.isArray(dt[2])?(dt[2].length===2&&(dt[2]=[1].concat(dt[2])),vt=_e.projectPointToLine({coords:{usrCoords:dt[2]}},pt.line1,ht),vt=nt.subtract(vt.usrCoords,gt.usrCoords),pt.direction1=rt.innerProduct(vt,[0,pt.line1.stdform[2],-pt.line1.stdform[1]],3)>=0?1:-1):pt.direction1=dt[2]>=0?1:-1,ot.isArray(dt[3])?(dt[3].length===2&&(dt[3]=[1].concat(dt[3])),vt=_e.projectPointToLine({coords:{usrCoords:dt[3]}},pt.line2,ht),vt=nt.subtract(vt.usrCoords,gt.usrCoords),pt.direction2=rt.innerProduct(vt,[0,pt.line2.stdform[2],-pt.line2.stdform[1]],3)>=0?1:-1):pt.direction2=dt[3]>=0?1:-1,pt.updateDataArray=function(){var _t,Et,bt,wt,Tt=[0,0,0],Mt=[0,0,0],Pt=[0,0,0];if(Et=this.line1,bt=this.line2,Mt=rt.crossProduct(Et.stdform,bt.stdform),Math.abs(Mt[0])>rt.eps*rt.eps&&(Mt[1]/=Mt[0],Mt[2]/=Mt[0],Mt[0]/=Mt[0]),_t=this.direction1*this.Radius(),Tt=nt.add(Mt,[0,_t*Et.stdform[2],-_t*Et.stdform[1]]),_t=this.direction2*this.Radius(),Pt=nt.add(Mt,[0,_t*bt.stdform[2],-_t*bt.stdform[1]]),this.point2.coords=new it(st.COORDS_BY_USER,Tt,pt.board),this.point1.coords=new it(st.COORDS_BY_USER,Mt,pt.board),this.point3.coords=new it(st.COORDS_BY_USER,Pt,pt.board),Math.abs(Tt[0])<rt.eps||Math.abs(Mt[0])<rt.eps||Math.abs(Pt[0])<rt.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);wt=_e.bezierArc(Tt,Mt,Pt,!0,1),this.dataX=wt[0],this.dataY=wt[1],this.bezierDegree=3},pt.methodMap=tt.deepCopy(pt.methodMap,{radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),pt.prepareUpdate().update()):yt==="3points"&&(pt.point1=At[0],pt.point2=At[1],pt.point3=At[2],pt.point1.addChild(pt),pt.point2.addChild(pt),pt.point3.addChild(pt),pt.useDirection=ft.usedirection,pt.setParents(At),ot.exists(At[3])&&(pt.point4=At[3],pt.point4.addChild(pt)),pt.methodMap=tt.deepCopy(pt.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),pt.updateDataArray=function(){var _t,Et,bt,wt,Tt,Mt=this.point2,Pt=this.point1,It=this.point3,Ot=1,Bt=ot.evaluate(this.visProp.selection);if(!Mt.isReal||!Pt.isReal||!It.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);Tt=_e.rad(Mt,Pt,It),(Bt==="minor"&&Tt>Math.PI||Bt==="major"&&Tt<Math.PI)&&(Ot=-1),this.useDirection&&ot.exists(this.point4)&&(Et=this.point2.coords.usrCoords,bt=this.point4.coords.usrCoords,wt=this.point3.coords.usrCoords,(Et[1]-wt[1])*(Et[2]-bt[2])-(Et[2]-wt[2])*(Et[1]-bt[1])>=0&&(It=this.point2,Mt=this.point3)),Mt=Mt.coords.usrCoords,Pt=Pt.coords.usrCoords,It=It.coords.usrCoords,_t=_e.bezierArc(Mt,Pt,It,!0,Ot),this.dataX=_t[0],this.dataY=_t[1],this.bezierDegree=3},pt.Radius=function(){return this.point2.Dist(this.point1)},mt=ot.copyAttributes(ft,ht.options,"sector","arc"),mt.withLabel=!1,mt.name+="_arc",pt.arc=ht.create("arc",[pt.point1,pt.point2,pt.point3],mt),pt.addChild(pt.arc)),pt.center=pt.point1,pt.radiuspoint=pt.point2,pt.anglepoint=pt.point3,pt.hasPointCurve=function(_t,Et){var bt,wt,Tt,Mt,Pt,It=new it(st.COORDS_BY_SCREEN,[_t,Et],this.board),Ot=this.Radius(),Bt=this.center.coords.distance(st.COORDS_BY_USER,It),Ut=ot.evaluate(this.visProp.selection);return Mt=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),Pt=Math.abs(Bt-Ot)<Mt,Pt&&(bt=_e.rad(this.point2,this.center,It.usrCoords.slice(1)),wt=0,Tt=_e.rad(this.point2,this.center,this.point3),(Ut==="minor"&&Tt>Math.PI||Ut==="major"&&Tt<Math.PI)&&(wt=Tt,Tt=2*Math.PI),(bt<wt||bt>Tt)&&(Pt=!1)),Pt},pt.hasPointSector=function(_t,Et){var bt,wt,Tt,Mt=new it(st.COORDS_BY_SCREEN,[_t,Et],this.board),Pt=this.Radius(),It=this.point1.coords.distance(st.COORDS_BY_USER,Mt),Ot=It<Pt,Bt=ot.evaluate(this.visProp.selection);return Ot&&(bt=_e.rad(this.radiuspoint,this.center,Mt.usrCoords.slice(1)),wt=0,Tt=_e.rad(this.radiuspoint,this.center,this.anglepoint),(Bt==="minor"&&Tt>Math.PI||Bt==="major"&&Tt<Math.PI)&&(wt=Tt,Tt=2*Math.PI),(bt<wt||bt>Tt)&&(Ot=!1)),Ot},pt.hasPoint=function(_t,Et){return ot.evaluate(this.visProp.highlightonsector)||ot.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(_t,Et):this.hasPointCurve(_t,Et)},pt.getTextAnchor=function(){return this.point1.coords},pt.getLabelAnchor=function(){var _t,Et,bt,wt,Tt,Mt=_e.rad(this.point2,this.point1,this.point3),Pt=13/this.board.unitX,It=13/this.board.unitY,Ot=this.point2.coords.usrCoords,Bt=this.point1.coords.usrCoords,Ut=Ot[1]-Bt[1],Ft=Ot[2]-Bt[2],jt=ot.evaluate(this.visProp.selection),Dt=this.label?this.label.visProp:this.visProp.label;return(jt==="minor"&&Mt>Math.PI||jt==="major"&&Mt<Math.PI)&&(Mt=-(2*Math.PI-Mt)),_t=new it(st.COORDS_BY_USER,[Bt[1]+Math.cos(.5*Mt)*Ut-Math.sin(.5*Mt)*Ft,Bt[2]+Math.sin(.5*Mt)*Ut+Math.cos(.5*Mt)*Ft],this.board),bt=_t.usrCoords[1]-Bt[1],wt=_t.usrCoords[2]-Bt[2],Tt=Math.sqrt(bt*bt+wt*wt),bt=bt*(Tt+Pt)/Tt,wt=wt*(Tt+It)/Tt,Et=[Bt[1]+bt,Bt[2]+wt],Dt.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],Et)),new it(st.COORDS_BY_USER,Et,this.board)},pt.setRadius=function(_t){pt.Radius=function(){return ot.evaluate(_t)}},pt.getRadius=function(){return tt.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},yt==="3points"&&(pt.setPositionDirectly=function(_t,Et,bt){var wt,Tt,Mt=new it(_t,Et,this.board),Pt=new it(_t,bt,this.board);return pt.point1.draggable()&&pt.point2.draggable()&&pt.point3.draggable()?(wt=nt.subtract(Mt.usrCoords,Pt.usrCoords),Tt=this.board.create("transform",wt.slice(1),{type:"translate"}),Tt.applyOnce([pt.point1,pt.point2,pt.point3]),this):this}),pt.prepareUpdate().update(),pt},tt.registerElement("sector",tt.createSector),tt.createCircumcircleSector=function(ht,dt,ft){var pt,mt,gt,vt;if((vt=ot.providePoints(ht,dt,ft,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");return mt=ht.create("circumcenter",vt.slice(0,3),gt),mt.dump=!1,gt=ot.copyAttributes(ft,ht.options,"circumcirclesector"),pt=ht.create("sector",[mt,vt[0],vt[2],vt[1]],gt),pt.elType="circumcirclesector",pt.setParents(vt),pt.center=mt,pt.subs={center:mt},pt},tt.registerElement("circumcirclesector",tt.createCircumcircleSector),tt.createMinorSector=function(ht,dt,ft){return ft.selection="minor",tt.createSector(ht,dt,ft)},tt.registerElement("minorsector",tt.createMinorSector),tt.createMajorSector=function(ht,dt,ft){return ft.selection="major",tt.createSector(ht,dt,ft)},tt.registerElement("majorsector",tt.createMajorSector),tt.createAngle=function(ht,dt,ft){var pt,mt,gt,vt,At,yt,xt="invalid";if(dt[0].elementClass===st.OBJECT_CLASS_LINE&&dt[1].elementClass===st.OBJECT_CLASS_LINE&&(ot.isArray(dt[2])||ot.isNumber(dt[2]))&&(ot.isArray(dt[3])||ot.isNumber(dt[3])))xt="2lines";else{if((yt=ot.providePoints(ht,dt,ft,"point"))===!1)throw new Error("JSXGraph: Can't create angle with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");xt="3points"}if(gt=ot.copyAttributes(ft,ht.options,"angle"),ot.exists(gt.name)&&gt.name!==""||(gt.name=ht.generateName({type:st.OBJECT_TYPE_ANGLE})),mt=ot.exists(gt.radius)?gt.radius:0,xt==="2lines"?(dt.push(mt),pt=ht.create("sector",dt,gt),pt.updateDataArraySector=pt.updateDataArray,pt.setAngle=function(_t){},pt.free=function(_t){}):(pt=ht.create("sector",[yt[1],yt[0],yt[2]],gt),pt.arc.visProp.priv=!0,pt.point=pt.point2=pt.radiuspoint=yt[0],pt.pointsquare=pt.point3=pt.anglepoint=yt[2],pt.Radius=function(){return ot.evaluate(mt)},pt.updateDataArraySector=function(){var _t,Et,bt=this.point2,wt=this.point1,Tt=this.point3,Mt=this.Radius(),Pt=wt.Dist(bt),It=1,Ot=ot.evaluate(this.visProp.selection);Et=_e.rad(bt,wt,Tt),(Ot==="minor"&&Et>Math.PI||Ot==="major"&&Et<Math.PI)&&(It=-1),bt=bt.coords.usrCoords,wt=wt.coords.usrCoords,Tt=Tt.coords.usrCoords,bt=[1,wt[1]+(bt[1]-wt[1])*Mt/Pt,wt[2]+(bt[2]-wt[2])*Mt/Pt],Tt=[1,wt[1]+(Tt[1]-wt[1])*Mt/Pt,wt[2]+(Tt[2]-wt[2])*Mt/Pt],_t=_e.bezierArc(bt,wt,Tt,!0,It),this.dataX=_t[0],this.dataY=_t[1],this.bezierDegree=3},pt.setAngle=function(_t){var Et,bt=this.anglepoint,wt=this.radiuspoint;return bt.draggable()&&(Et=this.board.create("transform",[_t,this.center],{type:"rotate"}),bt.addTransform(wt,Et),bt.isDraggable=!1,bt.setParents(wt)),this},pt.free=function(){var _t=this.anglepoint;return _t.transformations.length>0&&(_t.transformations.pop(),_t.isDraggable=!0,_t.parents=[]),this},pt.setParents(yt)),ot.exists(pt.visProp.text)&&pt.label.setText(ot.evaluate(pt.visProp.text)),pt.elType="angle",pt.type=st.OBJECT_TYPE_ANGLE,pt.subs={},pt.updateDataArraySquare=function(){var _t,Et,bt,wt,Tt,Mt,Pt,It,Ot=this.Radius();xt==="2lines"&&this.updateDataArraySector(),_t=this.point2,Et=this.point1,bt=this.point3,_t=_t.coords.usrCoords,Et=Et.coords.usrCoords,bt=bt.coords.usrCoords,wt=_e.distance(_t,Et,3),Tt=_e.distance(bt,Et,3),_t=[1,Et[1]+(_t[1]-Et[1])*Ot/wt,Et[2]+(_t[2]-Et[2])*Ot/wt],bt=[1,Et[1]+(bt[1]-Et[1])*Ot/Tt,Et[2]+(bt[2]-Et[2])*Ot/Tt],Mt=rt.crossProduct(bt,Et),Pt=[-_t[1]*Mt[1]-_t[2]*Mt[2],_t[0]*Mt[1],_t[0]*Mt[2]],Mt=rt.crossProduct(_t,Et),It=[-bt[1]*Mt[1]-bt[2]*Mt[2],bt[0]*Mt[1],bt[0]*Mt[2]],Mt=rt.crossProduct(Pt,It),Mt[1]/=Mt[0],Mt[2]/=Mt[0],this.dataX=[Et[1],_t[1],Mt[1],bt[1],Et[1]],this.dataY=[Et[2],_t[2],Mt[2],bt[2],Et[2]],this.bezierDegree=1},pt.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},pt.updateDataArray=function(){var _t=ot.evaluate(this.visProp.type),Et=_e.trueAngle(this.point2,this.point1,this.point3),bt=ot.evaluate(this.visProp.selection);(bt==="minor"&&Et>180||bt==="major"&&Et<180)&&(Et=360-Et),Math.abs(Et-90)<ot.evaluate(this.visProp.orthosensitivity)+rt.eps&&(_t=ot.evaluate(this.visProp.orthotype)),_t==="none"?this.updateDataArrayNone():_t==="square"?this.updateDataArraySquare():_t==="sector"?this.updateDataArraySector():_t==="sectordot"&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||_t!=="sectordot"&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},vt=ot.copyAttributes(ft,ht.options,"angle","dot"),pt.dot=ht.create("point",[function(){var _t,Et,bt,wt,Tt,Mt,Pt,It,Ot;return ot.exists(pt.dot)&&!pt.dot.visProp.visible?[0,0]:(_t=pt.point2.coords.usrCoords,Et=pt.point1.coords.usrCoords,bt=pt.Radius(),wt=_e.distance(_t,Et,3),Tt=_e.rad(pt.point2,pt.point1,pt.point3),Ot=ot.evaluate(pt.visProp.selection),(Ot==="minor"&&Tt>Math.PI||Ot==="major"&&Tt<Math.PI)&&(Tt=-(2*Math.PI-Tt)),Tt*=.5,Mt=Math.cos(Tt),Pt=Math.sin(Tt),_t=[1,Et[1]+(_t[1]-Et[1])*bt/wt,Et[2]+(_t[2]-Et[2])*bt/wt],It=[[1,0,0],[Et[1]-.5*Et[1]*Mt+.5*Et[2]*Pt,.5*Mt,.5*-Pt],[Et[2]-.5*Et[1]*Pt-.5*Et[2]*Mt,.5*Pt,.5*Mt]],rt.matVecMult(It,_t))}],vt),pt.dot.dump=!1,pt.subs.dot=pt.dot,xt==="2lines")for(At=0;At<2;At++)ht.select(dt[At]).addChild(pt.dot);else for(At=0;At<3;At++)ht.select(yt[At]).addChild(pt.dot);return pt.getLabelAnchor=function(){var _t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt=12,Ut=ot.evaluate(pt.visProp.selection),Ft=this.label?this.label.visProp:this.visProp.label;return ot.exists(this.label.visProp.fontSize)&&(Bt=dy=ot.evaluate(this.label.visProp.fontSize)),Bt/=this.board.unitX,Et=pt.point2.coords.usrCoords,bt=pt.point1.coords.usrCoords,wt=pt.Radius(),Tt=_e.distance(Et,bt,3),Mt=_e.rad(pt.point2,pt.point1,pt.point3),(Ut==="minor"&&Mt>Math.PI||Ut==="major"&&Mt<Math.PI)&&(Mt=-(2*Math.PI-Mt)),Mt*=.5,Pt=Math.cos(Mt),It=Math.sin(Mt),Et=[1,bt[1]+(Et[1]-bt[1])*wt/Tt,bt[2]+(Et[2]-bt[2])*wt/Tt],Ot=[[1,0,0],[bt[1]-.5*bt[1]*Pt+.5*bt[2]*It,.5*Pt,.5*-It],[bt[2]-.5*bt[1]*It-.5*bt[2]*Pt,.5*It,.5*Pt]],_t=rt.matVecMult(Ot,Et),_t[1]/=_t[0],_t[2]/=_t[0],_t[0]/=_t[0],Tt=_e.distance(_t,bt,3),_t=[_t[0],bt[1]+(_t[1]-bt[1])*(wt+Bt)/Tt,bt[2]+(_t[2]-bt[2])*(wt+Bt)/Tt],Ft.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],_t)),new it(st.COORDS_BY_USER,_t,this.board)},pt.Value=function(){return _e.rad(this.point2,this.point1,this.point3)},pt.methodMap=ot.deepCopy(pt.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),pt},tt.registerElement("angle",tt.createAngle),tt.createNonreflexAngle=function(ht,dt,ft){var pt;return ft.selection="minor",pt=tt.createAngle(ht,dt,ft),pt.Value=function(){var mt=_e.rad(this.point2,this.point1,this.point3);return mt<Math.PI?mt:2*Math.PI-mt},pt},tt.registerElement("nonreflexangle",tt.createNonreflexAngle),tt.createReflexAngle=function(ht,dt,ft){var pt;return ft.selection="major",pt=tt.createAngle(ht,dt,ft),pt.Value=function(){var mt=_e.rad(this.point2,this.point1,this.point3);return mt>=Math.PI?mt:2*Math.PI-mt},pt},tt.registerElement("reflexangle",tt.createReflexAngle),{createSector:tt.createSector,createCircumcircleSector:tt.createCircumcircleSector,createMinorSector:tt.createMinorSector,createMajorSector:tt.createMajorSector,createAngle:tt.createAngle,createReflexAngle:tt.createReflexAngle,createNonreflexAngle:tt.createNonreflexAngle}}),define("element/composition",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/text","base/polygon","element/arc","element/sector"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut,ht,dt,ft,pt,mt,gt,vt){return tt.createOrthogonalProjection=function(At,yt,xt){var _t,Et,bt,wt;if(yt[0]=At.select(yt[0]),yt[1]=At.select(yt[1]),ot.isPointType(At,yt[0])&&yt[1].elementClass===lt.OBJECT_CLASS_LINE)Et=ot.providePoints(At,[yt[0]],xt,"point")[0],_t=yt[1];else{if(!ot.isPointType(At,yt[1])||yt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [point,line]`);Et=ot.providePoints(At,[yt[1]],xt,"point")[0],_t=yt[0]}return wt=ot.copyAttributes(xt,At.options,"orthogonalprojection"),bt=At.create("point",[function(){return rt.projectPointToLine(Et,_t,At)}],wt),Et.addChild(bt),_t.addChild(bt),bt.elType="orthogonalprojection",bt.setParents([Et.id,bt.id]),bt.update(),bt.generatePolynomial=function(){var Tt=_t.point1.symbolic.x,Mt=_t.point1.symbolic.y,Pt=_t.point2.symbolic.x,It=_t.point2.symbolic.y,Ot=Et.symbolic.x,Bt=Et.symbolic.y,Ut=bt.symbolic.x,Ft=bt.symbolic.y;return["("+Mt+")*("+Ut+")-("+Mt+")*("+Pt+")+("+Ft+")*("+Pt+")-("+Tt+")*("+Ft+")+("+Tt+")*("+It+")-("+Ut+")*("+It+")","("+Bt+")*("+Mt+")-("+Bt+")*("+It+")-("+Ft+")*("+Mt+")+("+Ft+")*("+It+")+("+Ot+")*("+Tt+")-("+Ot+")*("+Pt+")-("+Ut+")*("+Tt+")+("+Ut+")*("+Pt+")"]},bt},tt.createPerpendicular=function(At,yt,xt){var _t,Et,bt,wt;if(yt[0]=At.select(yt[0]),yt[1]=At.select(yt[1]),ot.isPointType(At,yt[0])&&yt[1].elementClass===lt.OBJECT_CLASS_LINE)Et=yt[1],_t=ot.providePoints(At,[yt[0]],xt,"point")[0];else{if(!ot.isPointType(At,yt[1])||yt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [line,point]`);Et=yt[0],_t=ot.providePoints(At,[yt[1]],xt,"point")[0]}return wt=ot.copyAttributes(xt,At.options,"perpendicular"),bt=ct.createLine(At,[function(){return Et.stdform[2]*_t.X()-Et.stdform[1]*_t.Y()},function(){return-Et.stdform[2]*_t.Z()},function(){return Et.stdform[1]*_t.Z()}],wt),bt.elType="perpendicular",bt.setParents([Et.id,_t.id]),bt},tt.createPerpendicularPoint=function(At,yt,xt){var _t,Et,bt;if(yt[0]=At.select(yt[0]),yt[1]=At.select(yt[1]),ot.isPointType(At,yt[0])&&yt[1].elementClass===lt.OBJECT_CLASS_LINE)Et=ot.providePoints(At,[yt[0]],xt,"point")[0],_t=yt[1];else{if(!ot.isPointType(At,yt[1])||yt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [point,line]`);Et=ot.providePoints(At,[yt[1]],xt,"point")[0],_t=yt[0]}return bt=At.create("point",[function(){return rt.perpendicular(_t,Et,At)[0]}],xt),Et.addChild(bt),_t.addChild(bt),bt.elType="perpendicularpoint",bt.setParents([Et.id,_t.id]),bt.update(),bt.generatePolynomial=function(){var wt=_t.point1.symbolic.x,Tt=_t.point1.symbolic.y,Mt=_t.point2.symbolic.x,Pt=_t.point2.symbolic.y,It=Et.symbolic.x,Ot=Et.symbolic.y,Bt=bt.symbolic.x,Ut=bt.symbolic.y;return["("+Tt+")*("+Bt+")-("+Tt+")*("+Mt+")+("+Ut+")*("+Mt+")-("+wt+")*("+Ut+")+("+wt+")*("+Pt+")-("+Bt+")*("+Pt+")","("+Ot+")*("+Tt+")-("+Ot+")*("+Pt+")-("+Ut+")*("+Tt+")+("+Ut+")*("+Pt+")+("+It+")*("+wt+")-("+It+")*("+Mt+")-("+Bt+")*("+wt+")+("+Bt+")*("+Mt+")"]},bt},tt.createPerpendicularSegment=function(At,yt,xt){var _t,Et,bt,wt,Tt;if(yt[0]=At.select(yt[0]),yt[1]=At.select(yt[1]),ot.isPointType(At,yt[0])&&yt[1].elementClass===lt.OBJECT_CLASS_LINE)Et=yt[1],_t=ot.providePoints(At,[yt[0]],xt,"point")[0];else{if(!ot.isPointType(At,yt[1])||yt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [line,point]`);Et=yt[0],_t=ot.providePoints(At,[yt[1]],xt,"point")[0]}return Tt=ot.copyAttributes(xt,At.options,"perpendicularsegment","point"),wt=tt.createPerpendicularPoint(At,[Et,_t],Tt),wt.dump=!1,ot.exists(xt.layer)||(xt.layer=At.options.layer.line),Tt=ot.copyAttributes(xt,At.options,"perpendicularsegment"),bt=ct.createLine(At,[function(){return rt.perpendicular(Et,_t,At)[1]?[wt,_t]:[_t,wt]}],Tt),bt.point=wt,bt.elType="perpendicularsegment",bt.setParents([_t.id,Et.id]),bt.subs={point:wt},bt.inherits.push(wt),bt},tt.createMidpoint=function(At,yt,xt){var _t,Et,bt,wt,Tt;for(wt=0;wt<yt.length;++wt)yt[wt]=At.select(yt[wt]);if(yt.length===2&&ot.isPointType(At,yt[0])&&ot.isPointType(At,yt[1]))yt=ot.providePoints(At,yt,xt,"point"),_t=yt[0],Et=yt[1];else{if(yt.length!==1||yt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error(`JSXGraph: Can't create midpoint.
Possible parent types: [point,point], [line]`);_t=yt[0].point1,Et=yt[0].point2}return Tt=ot.copyAttributes(xt,At.options,"midpoint"),bt=At.create("point",[function(){var Mt=_t.coords.usrCoords[1]+Et.coords.usrCoords[1];return isNaN(Mt)||Math.abs(_t.coords.usrCoords[0])<_e.eps||Math.abs(Et.coords.usrCoords[0])<_e.eps?NaN:.5*Mt},function(){var Mt=_t.coords.usrCoords[2]+Et.coords.usrCoords[2];return isNaN(Mt)||Math.abs(_t.coords.usrCoords[0])<_e.eps||Math.abs(Et.coords.usrCoords[0])<_e.eps?NaN:.5*Mt}],Tt),_t.addChild(bt),Et.addChild(bt),bt.elType="midpoint",bt.setParents([_t.id,Et.id]),bt.prepareUpdate().update(),bt.generatePolynomial=function(){var Mt=_t.symbolic.x,Pt=_t.symbolic.y,It=Et.symbolic.x,Ot=Et.symbolic.y,Bt=bt.symbolic.x,Ut=bt.symbolic.y;return["("+Pt+")*("+Bt+")-("+Pt+")*("+It+")+("+Ut+")*("+It+")-("+Mt+")*("+Ut+")+("+Mt+")*("+Ot+")-("+Bt+")*("+Ot+")","("+Mt+")^2 - 2*("+Mt+")*("+Bt+")+("+Pt+")^2-2*("+Pt+")*("+Ut+")-("+It+")^2+2*("+It+")*("+Bt+")-("+Ot+")^2+2*("+Ot+")*("+Ut+")"]},bt},tt.createParallelPoint=function(At,yt,xt){var _t,Et,bt,wt,Tt;for(Tt=0;Tt<yt.length;++Tt)yt[Tt]=At.select(yt[Tt]);if(yt.length===3&&ot.isPointType(At,yt[0])&&ot.isPointType(At,yt[1])&&ot.isPointType(At,yt[2]))yt=ot.providePoints(At,yt,xt,"point"),_t=yt[0],Et=yt[1],bt=yt[2];else if(ot.isPointType(At,yt[0])&&yt[1].elementClass===lt.OBJECT_CLASS_LINE)bt=ot.providePoints(At,[yt[0]],xt,"point")[0],_t=yt[1].point1,Et=yt[1].point2;else{if(!ot.isPointType(At,yt[1])||yt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof yt[0]+"', '"+typeof yt[1]+"' and '"+typeof yt[2]+`'.
Possible parent types: [line,point], [point,point,point]`);bt=ot.providePoints(At,[yt[1]],xt,"point")[0],_t=yt[0].point1,Et=yt[0].point2}return wt=At.create("point",[function(){return bt.coords.usrCoords[1]+Et.coords.usrCoords[1]-_t.coords.usrCoords[1]},function(){return bt.coords.usrCoords[2]+Et.coords.usrCoords[2]-_t.coords.usrCoords[2]}],xt),_t.addChild(wt),Et.addChild(wt),bt.addChild(wt),wt.elType="parallelpoint",wt.setParents([_t.id,Et.id,bt.id]),wt.prepareUpdate().update(),wt.generatePolynomial=function(){var Mt=_t.symbolic.x,Pt=_t.symbolic.y,It=Et.symbolic.x,Ot=Et.symbolic.y,Bt=bt.symbolic.x,Ut=bt.symbolic.y,Ft=wt.symbolic.x,jt=wt.symbolic.y;return["("+Ot+")*("+Ft+")-("+Ot+")*("+Bt+")-("+Pt+")*("+Ft+")+("+Pt+")*("+Bt+")-("+jt+")*("+It+")+("+jt+")*("+Mt+")+("+Ut+")*("+It+")-("+Ut+")*("+Mt+")","("+jt+")*("+Mt+")-("+jt+")*("+Bt+")-("+Ot+")*("+Mt+")+("+Ot+")*("+Bt+")-("+Ft+")*("+Pt+")+("+Ft+")*("+Ut+")+("+It+")*("+Pt+")-("+It+")*("+Ut+")"]},wt},tt.createParallel=function(At,yt,xt){var _t,Et,bt,wt,Tt,Mt;for(Tt=0;Tt<yt.length;++Tt)yt[Tt]=At.select(yt[Tt]);return _t=null,yt.length===3?(yt=ot.providePoints(At,yt,xt,"point"),_t=yt[2],wt=function(){return _e.crossProduct(yt[0].coords.usrCoords,yt[1].coords.usrCoords)}):ot.isPointType(At,yt[0])?(_t=ot.providePoints(At,[yt[0]],xt,"point")[0],wt=function(){return yt[1].stdform}):ot.isPointType(At,yt[1])&&(_t=ot.providePoints(At,[yt[1]],xt,"point")[0],wt=function(){return yt[0].stdform}),ot.exists(xt.layer)||(xt.layer=At.options.layer.line),Mt=ot.copyAttributes(xt,At.options,"parallel","point"),Et=At.create("point",[function(){return _e.crossProduct([1,0,0],wt())}],Mt),Et.isDraggable=!0,Mt=ot.copyAttributes(xt,At.options,"parallel"),bt=At.create("line",[_t,Et],Mt),bt.elType="parallel",bt.subs={point:Et},bt.inherits.push(Et),bt.setParents([yt[0].id,yt[1].id]),yt.length===3&&bt.addParents(yt[2].id),bt.point=Et,bt},tt.createArrowParallel=function(At,yt,xt){var _t;try{return xt.firstArrow=!1,xt.lastArrow=!0,_t=tt.createParallel(At,yt,xt).setAttribute({straightFirst:!1,straightLast:!1}),_t.elType="arrowparallel",_t}catch{throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [line,point], [point,point,point]`)}},tt.createNormal=function(At,yt,xt){var _t,Et,bt,wt,Tt,Mt,Pt,It,Ot;for(wt=0;wt<yt.length;++wt)yt[wt]=At.select(yt[wt]);if(yt.length===1)_t=yt[0],Et=_t.slideObject;else{if(yt.length!==2)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);if(ot.isPointType(At,yt[0]))_t=ot.providePoints(At,[yt[0]],xt,"point")[0],Et=yt[1];else{if(!ot.isPointType(At,yt[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);Et=yt[0],_t=ot.providePoints(At,[yt[1]],xt,"point")[0]}}if(Pt=ot.copyAttributes(xt,At.options,"normal"),Et.elementClass===lt.OBJECT_CLASS_LINE)Ot=ot.copyAttributes(xt,At.options,"normal","point"),It=At.create("point",[function(){var Bt=_e.crossProduct([1,0,0],Et.stdform);return[Bt[0],-Bt[2],Bt[1]]}],Ot),It.isDraggable=!0,bt=At.create("line",[_t,It],Pt),bt.point=It,bt.subs={point:It},bt.inherits.push(It);else if(Et.elementClass===lt.OBJECT_CLASS_CIRCLE)bt=At.create("line",[Et.midpoint,_t],Pt);else if(Et.elementClass===lt.OBJECT_CLASS_CURVE)ot.evaluate(Et.visProp.curvetype)!=="plot"?(Tt=Et.X,Mt=Et.Y,bt=At.create("line",[function(){return-_t.X()*nt.D(Tt)(_t.position)-_t.Y()*nt.D(Mt)(_t.position)},function(){return nt.D(Tt)(_t.position)},function(){return nt.D(Mt)(_t.position)}],Pt)):bt=At.create("line",[function(){var Bt=Math.floor(_t.position),Ut=_t.position-Bt;return Bt===Et.numberPoints-1&&(Bt-=1,Ut=1),Bt<0?1:(Et.Y(Bt)+Ut*(Et.Y(Bt+1)-Et.Y(Bt)))*(Et.Y(Bt)-Et.Y(Bt+1))-(Et.X(Bt)+Ut*(Et.X(Bt+1)-Et.X(Bt)))*(Et.X(Bt+1)-Et.X(Bt))},function(){var Bt=Math.floor(_t.position);return Bt===Et.numberPoints-1&&(Bt-=1),Bt<0?0:Et.X(Bt+1)-Et.X(Bt)},function(){var Bt=Math.floor(_t.position);return Bt===Et.numberPoints-1&&(Bt-=1),Bt<0?0:Et.Y(Bt+1)-Et.Y(Bt)}],Pt);else{if(Et.type!==lt.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);bt=At.create("line",[function(){var Bt,Ut,Ft=Math.floor(_t.position),jt=_t.position-Ft;for(Ut=0;Ut<Et.objects.length;Ut++)if(Bt=Et.objects[Ut],Bt.type===lt.OBJECT_TYPE_CURVE){if(Ft<Bt.numberPoints)break;Ft-=Bt.numberPoints}return Ft===Bt.numberPoints-1&&(Ft-=1,jt=1),Ft<0?1:(Bt.Y(Ft)+jt*(Bt.Y(Ft+1)-Bt.Y(Ft)))*(Bt.Y(Ft)-Bt.Y(Ft+1))-(Bt.X(Ft)+jt*(Bt.X(Ft+1)-Bt.X(Ft)))*(Bt.X(Ft+1)-Bt.X(Ft))},function(){var Bt,Ut,Ft=Math.floor(_t.position);for(Ut=0;Ut<Et.objects.length;Ut++)if(Bt=Et.objects[Ut],Bt.type===lt.OBJECT_TYPE_CURVE){if(Ft<Bt.numberPoints)break;Ft-=Bt.numberPoints}return Ft===Bt.numberPoints-1&&(Ft-=1),Ft<0?0:Bt.X(Ft+1)-Bt.X(Ft)},function(){var Bt,Ut,Ft=Math.floor(_t.position);for(Ut=0;Ut<Et.objects.length;Ut++)if(Bt=Et.objects[Ut],Bt.type===lt.OBJECT_TYPE_CURVE){if(Ft<Bt.numberPoints)break;Ft-=Bt.numberPoints}return Ft===Bt.numberPoints-1&&(Ft-=1),Ft<0?0:Bt.Y(Ft+1)-Bt.Y(Ft)}],Pt)}return bt.elType="normal",bt.setParents(yt),bt},tt.createBisector=function(At,yt,xt){var _t,Et,bt,wt;if(yt=ot.providePoints(At,yt,xt,"point"),ot.isPoint(yt[0])&&ot.isPoint(yt[1])&&ot.isPoint(yt[2])){for(wt=ot.copyAttributes(xt,At.options,"bisector","point"),wt.snapToGrid=!1,_t=At.create("point",[function(){return rt.angleBisector(yt[0],yt[1],yt[2],At)}],wt),_t.dump=!1,bt=0;bt<3;bt++)yt[bt].addChild(_t);return ot.exists(xt.layer)||(xt.layer=At.options.layer.line),wt=ot.copyAttributes(xt,At.options,"bisector"),Et=ct.createLine(At,[yt[1],_t],wt),Et.point=_t,Et.elType="bisector",Et.setParents(yt),Et.subs={point:_t},Et.inherits.push(_t),Et}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [point,point,point]`)},tt.createAngularBisectorsOfTwoLines=function(At,yt,xt){var _t,Et,bt,wt,Tt=At.select(yt[0]),Mt=At.select(yt[1]);if(Tt.elementClass!==lt.OBJECT_CLASS_LINE||Mt.elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [line,line]`);return ot.exists(xt.layer)||(xt.layer=At.options.layer.line),bt=ot.copyAttributes(xt,At.options,"bisectorlines","line1"),_t=At.create("line",[function(){var Pt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]),It=Math.sqrt(Mt.stdform[1]*Mt.stdform[1]+Mt.stdform[2]*Mt.stdform[2]);return Tt.stdform[0]/Pt-Mt.stdform[0]/It},function(){var Pt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]),It=Math.sqrt(Mt.stdform[1]*Mt.stdform[1]+Mt.stdform[2]*Mt.stdform[2]);return Tt.stdform[1]/Pt-Mt.stdform[1]/It},function(){var Pt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]),It=Math.sqrt(Mt.stdform[1]*Mt.stdform[1]+Mt.stdform[2]*Mt.stdform[2]);return Tt.stdform[2]/Pt-Mt.stdform[2]/It}],bt),ot.exists(xt.layer)||(xt.layer=At.options.layer.line),bt=ot.copyAttributes(xt,At.options,"bisectorlines","line2"),Et=At.create("line",[function(){var Pt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]),It=Math.sqrt(Mt.stdform[1]*Mt.stdform[1]+Mt.stdform[2]*Mt.stdform[2]);return Tt.stdform[0]/Pt+Mt.stdform[0]/It},function(){var Pt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]),It=Math.sqrt(Mt.stdform[1]*Mt.stdform[1]+Mt.stdform[2]*Mt.stdform[2]);return Tt.stdform[1]/Pt+Mt.stdform[1]/It},function(){var Pt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]),It=Math.sqrt(Mt.stdform[1]*Mt.stdform[1]+Mt.stdform[2]*Mt.stdform[2]);return Tt.stdform[2]/Pt+Mt.stdform[2]/It}],bt),wt=new dt({line1:_t,line2:Et}),_t.dump=!1,Et.dump=!1,wt.elType="bisectorlines",wt.setParents([Tt.id,Mt.id]),wt.subs={line1:_t,line2:Et},wt},tt.createCircumcenter=function(At,yt,xt){var _t,Et,bt,wt,Tt;if(yt=ot.providePoints(At,yt,xt,"point"),ot.isPoint(yt[0])&&ot.isPoint(yt[1])&&ot.isPoint(yt[2])){for(bt=yt[0],wt=yt[1],Tt=yt[2],_t=at.createPoint(At,[function(){return rt.circumcenter(bt,wt,Tt,At)}],xt),Et=0;Et<3;Et++)yt[Et].addChild(_t);return _t.elType="circumcenter",_t.setParents(yt),_t.generatePolynomial=function(){var Mt=bt.symbolic.x,Pt=bt.symbolic.y,It=wt.symbolic.x,Ot=wt.symbolic.y,Bt=Tt.symbolic.x,Ut=Tt.symbolic.y,Ft=_t.symbolic.x,jt=_t.symbolic.y;return[["((",Ft,")-(",Mt,"))^2+((",jt,")-(",Pt,"))^2-((",Ft,")-(",It,"))^2-((",jt,")-(",Ot,"))^2"].join(""),["((",Ft,")-(",Mt,"))^2+((",jt,")-(",Pt,"))^2-((",Ft,")-(",Bt,"))^2-((",jt,")-(",Ut,"))^2"].join("")]},_t}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof yt[0]+"', '"+typeof yt[1]+"' and '"+typeof yt[2]+`'.
Possible parent types: [point,point,point]`)},tt.createIncenter=function(At,yt,xt){var _t,Et,bt,wt;if(yt=ot.providePoints(At,yt,xt,"point"),!(yt.length>=3&&ot.isPoint(yt[0])&&ot.isPoint(yt[1])&&ot.isPoint(yt[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof yt[0]+"', '"+typeof yt[1]+"' and '"+typeof yt[2]+`'.
Possible parent types: [point,point,point]`);return Et=yt[0],bt=yt[1],wt=yt[2],_t=At.create("point",[function(){var Tt,Mt,Pt;return Tt=Math.sqrt((bt.X()-wt.X())*(bt.X()-wt.X())+(bt.Y()-wt.Y())*(bt.Y()-wt.Y())),Mt=Math.sqrt((Et.X()-wt.X())*(Et.X()-wt.X())+(Et.Y()-wt.Y())*(Et.Y()-wt.Y())),Pt=Math.sqrt((bt.X()-Et.X())*(bt.X()-Et.X())+(bt.Y()-Et.Y())*(bt.Y()-Et.Y())),new st(lt.COORDS_BY_USER,[(Tt*Et.X()+Mt*bt.X()+Pt*wt.X())/(Tt+Mt+Pt),(Tt*Et.Y()+Mt*bt.Y()+Pt*wt.Y())/(Tt+Mt+Pt)],At)}],xt),_t.elType="incenter",_t.setParents(yt),_t},tt.createCircumcircle=function(At,yt,xt){var _t,Et,bt;if((yt=ot.providePoints(At,yt,xt,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof yt[0]+"', '"+typeof yt[1]+"' and '"+typeof yt[2]+`'.
Possible parent types: [point,point,point]`);try{bt=ot.copyAttributes(xt,At.options,"circumcircle","center"),_t=tt.createCircumcenter(At,yt,bt),_t.dump=!1,ot.exists(xt.layer)||(xt.layer=At.options.layer.circle),bt=ot.copyAttributes(xt,At.options,"circumcircle"),Et=ut.createCircle(At,[_t,yt[0]],bt),Et.elType="circumcircle",Et.setParents(yt),Et.subs={center:_t},Et.inherits.push(Et)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof yt[0]+"', '"+typeof yt[1]+"' and '"+typeof yt[2]+`'.
Possible parent types: [point,point,point]`)}return Et},tt.createIncircle=function(At,yt,xt){var _t,Et,bt;if((yt=ot.providePoints(At,yt,xt,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof yt[0]+"', '"+typeof yt[1]+"' and '"+typeof yt[2]+`'.
Possible parent types: [point,point,point]`);try{bt=ot.copyAttributes(xt,At.options,"incircle","center"),_t=tt.createIncenter(At,yt,bt),_t.dump=!1,ot.exists(xt.layer)||(xt.layer=At.options.layer.circle),bt=ot.copyAttributes(xt,At.options,"incircle"),Et=ut.createCircle(At,[_t,function(){var wt=Math.sqrt((yt[1].X()-yt[2].X())*(yt[1].X()-yt[2].X())+(yt[1].Y()-yt[2].Y())*(yt[1].Y()-yt[2].Y())),Tt=Math.sqrt((yt[0].X()-yt[2].X())*(yt[0].X()-yt[2].X())+(yt[0].Y()-yt[2].Y())*(yt[0].Y()-yt[2].Y())),Mt=Math.sqrt((yt[1].X()-yt[0].X())*(yt[1].X()-yt[0].X())+(yt[1].Y()-yt[0].Y())*(yt[1].Y()-yt[0].Y())),Pt=(wt+Tt+Mt)/2;return Math.sqrt((Pt-wt)*(Pt-Tt)*(Pt-Mt)/Pt)}],bt),Et.elType="incircle",Et.setParents(yt),Et.center=_t,Et.subs={center:Et.center},Et.inherits.push(_t)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof yt[0]+"', '"+typeof yt[1]+"' and '"+typeof yt[2]+`'.
Possible parent types: [point,point,point]`)}return Et},tt.createReflection=function(At,yt,xt){var _t,Et,bt,wt,Tt,Mt=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, line]`;for(Tt=0;Tt<yt.length;++Tt)yt[Tt]=At.select(yt[Tt]);if(ot.isPoint(yt[0]))Et=ot.providePoints(At,[yt[0]],xt,"point")[0];else{if(yt[0].elementClass!==lt.OBJECT_CLASS_CURVE&&yt[0].elementClass!==lt.OBJECT_CLASS_LINE&&yt[0].type!==lt.OBJECT_TYPE_POLYGON&&yt[0].elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+"'."+Mt);Et=yt[0]}if(yt[1].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+"'."+Mt);if(_t=yt[1],wt=ht.createTransform(At,[_t],{type:"reflect"}),ot.isPoint(Et))bt=at.createPoint(At,[Et,wt],xt);else if(Et.elementClass===lt.OBJECT_CLASS_CURVE)bt=ft.createCurve(At,[Et,wt],xt);else if(Et.elementClass===lt.OBJECT_CLASS_LINE)bt=ct.createLine(At,[Et,wt],xt);else if(Et.type===lt.OBJECT_TYPE_POLYGON)bt=mt.createPolygon(At,[Et,wt],xt);else{if(Et.elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+"'."+Mt);bt=ut.createCircle(At,[Et,wt],xt)}return Et.addChild(bt),_t.addChild(bt),bt.elType="reflection",bt.setParents([Et,_t]),bt.prepareUpdate().update(),ot.isPoint(bt)&&(bt.generatePolynomial=function(){var Pt=_t.point1.symbolic.x,It=_t.point1.symbolic.y,Ot=_t.point2.symbolic.x,Bt=_t.point2.symbolic.y,Ut=Et.symbolic.x,Ft=Et.symbolic.y,jt=bt.symbolic.x,Dt=bt.symbolic.y;return[["((",Dt,")-(",Ft,"))*((",It,")-(",Bt,"))+((",Pt,")-(",Ot,"))*((",jt,")-(",Ut,"))"].join(""),["((",jt,")-(",Pt,"))^2+((",Dt,")-(",It,"))^2-((",Ut,")-(",Pt,"))^2-((",Ft,")-(",It,"))^2"].join("")]}),bt},tt.createMirrorElement=function(At,yt,xt){var _t,Et,bt,wt,Tt=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, point]`;if(ot.isPoint(yt[0]))_t=ot.providePoints(At,[yt[0]],xt,"point")[0];else{if(yt[0].elementClass!==lt.OBJECT_CLASS_CURVE&&yt[0].elementClass!==lt.OBJECT_CLASS_LINE&&yt[0].type!==lt.OBJECT_TYPE_POLYGON&&yt[0].elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+"'."+Tt);_t=yt[0]}if(!ot.isPoint(yt[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+"'."+Tt);if(Et=ot.providePoints(At,[yt[1]],xt,"point")[0],wt=ht.createTransform(At,[Math.PI,Et],{type:"rotate"}),ot.isPoint(_t))bt=at.createPoint(At,[_t,wt],xt);else if(_t.elementClass===lt.OBJECT_CLASS_CURVE)bt=ft.createCurve(At,[_t,wt],xt);else if(_t.elementClass===lt.OBJECT_CLASS_LINE)bt=ct.createLine(At,[_t,wt],xt);else if(_t.type===lt.OBJECT_TYPE_POLYGON)bt=mt.createPolygon(At,[_t,wt],xt);else{if(_t.elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+"'."+Tt);bt=ut.createCircle(At,[_t,wt],xt)}return _t.addChild(bt),Et.addChild(bt),bt.elType="mirrorpoint",bt.setParents([_t,Et]),bt.prepareUpdate().update(),bt},tt.createMirrorPoint=function(At,yt,xt){return tt.createMirrorElement(At,yt,xt)},tt.createIntegral=function(At,yt,xt){var _t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt,Dt,Gt=null;if(ot.isArray(yt[0])&&yt[1].elementClass===lt.OBJECT_CLASS_CURVE)_t=yt[0],Et=yt[1];else{if(!ot.isArray(yt[1])||yt[0].elementClass!==lt.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof yt[0]+"' and '"+typeof yt[1]+`'.
Possible parent types: [[number|function,number|function],curve]`);_t=yt[1],Et=yt[0]}return bt=ot.copyAttributes(xt,At.options,"integral"),bt.withLabel=!1,Dt=At.create("curve",[[0],[0]],bt),wt=_t[0],Tt=_t[1],ot.isFunction(wt)?(Mt=wt,Pt=function(){return Et.Y(Mt())},wt=Mt()):(Mt=wt,Pt=Et.Y(wt)),ot.isFunction(Tt)?(It=Tt,Ot=function(){return Et.Y(It())},Tt=It()):(It=Tt,Ot=Et.Y(Tt)),bt=ot.copyAttributes(xt,At.options,"integral","curveLeft"),Bt=At.create("glider",[Mt,Pt,Et],bt),ot.isFunction(Mt)&&Bt.hideElement(),bt=ot.copyAttributes(xt,At.options,"integral","baseLeft"),Ut=At.create("point",[function(){return ot.evaluate(Dt.visProp.axis)==="y"?0:Bt.X()},function(){return ot.evaluate(Dt.visProp.axis)==="y"?Bt.Y():0}],bt),bt=ot.copyAttributes(xt,At.options,"integral","curveRight"),Ft=At.create("glider",[It,Ot,Et],bt),ot.isFunction(It)&&Ft.hideElement(),bt=ot.copyAttributes(xt,At.options,"integral","baseRight"),jt=At.create("point",[function(){return ot.evaluate(Dt.visProp.axis)==="y"?0:Ft.X()},function(){return ot.evaluate(Dt.visProp.axis)==="y"?Ft.Y():0}],bt),bt=ot.copyAttributes(xt,At.options,"integral"),bt.withlabel!==!1&&bt.axis!=="y"&&(bt=ot.copyAttributes(xt,At.options,"integral","label"),bt=ot.copyAttributes(bt,At.options,"label"),Gt=At.create("text",[function(){var zt=new st(lt.COORDS_BY_SCREEN,[ot.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),$t=this.board.getBoundingBox(),Ht=.1*($t[2]-$t[0]),er=Ft.X();return er<$t[0]?er=$t[0]+Ht:er>$t[2]&&(er=$t[2]-Ht),er+zt.usrCoords[1]},function(){var zt=new st(lt.COORDS_BY_SCREEN,[0,ot.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),$t=this.board.getBoundingBox(),Ht=.1*($t[1]-$t[3]),er=Ft.Y();return er>$t[1]?er=$t[1]-Ht:er<$t[3]&&(er=$t[3]+Ht),er+zt.usrCoords[2]},function(){var zt=nt.NewtonCotes([Ut.X(),jt.X()],Et.Y);return"&int; = "+ot.toFixed(zt,4)}],bt),Gt.dump=!1,Bt.addChild(Gt),Ft.addChild(Gt)),Bt.dump=!1,Ut.dump=!1,Ft.dump=!1,jt.dump=!1,Dt.elType="integral",Dt.setParents([Et.id,_t]),Dt.subs={curveLeft:Bt,baseLeft:Ut,curveRight:Ft,baseRight:jt},Dt.inherits.push(Bt,Ut,Ft,jt),bt.withLabel&&(Dt.subs.label=Gt,Dt.inherits.push(Gt)),Dt.Value=function(){return nt.I([Ut.X(),jt.X()],Et.Y)},Dt.updateDataArray=function(){var zt,$t,Ht,er,Zt,or,Kt,rr,ur;if(ot.evaluate(this.visProp.axis)==="y"){for(Bt.Y()<Ft.Y()?(or=Bt.X(),rr=Bt.Y(),Kt=Ft.X(),ur=Ft.Y()):(or=Ft.X(),rr=Ft.Y(),Kt=Bt.X(),ur=Bt.Y()),er=Math.min(or,Kt),Zt=Math.max(or,Kt),zt=[0,or],$t=[rr,rr],Ht=0;Ht<Et.numberPoints;Ht++)rr<=Et.points[Ht].usrCoords[2]&&er<=Et.points[Ht].usrCoords[1]&&Et.points[Ht].usrCoords[2]<=ur&&Et.points[Ht].usrCoords[1]<=Zt&&(zt.push(Et.points[Ht].usrCoords[1]),$t.push(Et.points[Ht].usrCoords[2]));zt.push(Kt),$t.push(ur),zt.push(0),$t.push(ur),zt.push(0),$t.push(rr)}else{for(Ut.X()<jt.X()?(er=Ut.X(),Zt=jt.X()):(er=jt.X(),Zt=Ut.X()),zt=[er,er],$t=[0,Et.Y(er)],Ht=0;Ht<Et.numberPoints;Ht++)er<=Et.points[Ht].usrCoords[1]&&Et.points[Ht].usrCoords[1]<=Zt&&(zt.push(Et.points[Ht].usrCoords[1]),$t.push(Et.points[Ht].usrCoords[2]));zt.push(Zt),$t.push(Et.Y(Zt)),zt.push(Zt),$t.push(0),zt.push(er),$t.push(0)}this.dataX=zt,this.dataY=$t},Bt.addChild(Dt),Ft.addChild(Dt),Ut.addChild(Dt),jt.addChild(Dt),Dt.baseLeft=Ut,Dt.baseRight=jt,Dt.curveLeft=Bt,Dt.curveRight=Ft,Dt.methodMap=tt.deepCopy(Dt.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),Dt.label=Gt,Dt},tt.createGrid=function(At,yt,xt){var _t,Et;return Et=ot.copyAttributes(xt,At.options,"grid"),_t=At.create("curve",[[null],[null]],Et),_t.elType="grid",_t.type=lt.OBJECT_TYPE_GRID,_t.updateDataArray=function(){var bt,wt,Tt,Mt,Pt,It=ot.evaluate(this.visProp.gridx),Ot=ot.evaluate(this.visProp.gridy);for(Mt=ot.isArray(this.visProp.topleft)?new st(ot.evaluate(this.visProp.tltype)||lt.COORDS_BY_USER,this.visProp.topleft,At):new st(lt.COORDS_BY_SCREEN,[0,0],At),Pt=ot.isArray(this.visProp.bottomright)?new st(ot.evaluate(this.visProp.brtype)||lt.COORDS_BY_USER,this.visProp.bottomright,At):new st(lt.COORDS_BY_SCREEN,[At.canvasWidth,At.canvasHeight],At),At.options.grid.hasGrid=!0,_t.dataX=[],_t.dataY=[],bt=Math.floor(Mt.usrCoords[2]/Ot)*Ot,wt=Math.ceil(Pt.usrCoords[2]/Ot)*Ot,Mt.usrCoords[2]<Pt.usrCoords[2]&&(bt=Math.ceil(Pt.usrCoords[2]/Ot)*Ot,wt=Math.floor(Mt.usrCoords[2]/Ot)*Ot),Tt=bt;Tt>wt-Ot;Tt-=Ot)_t.dataX.push(Mt.usrCoords[1],Pt.usrCoords[1],NaN),_t.dataY.push(Tt,Tt,NaN);for(bt=Math.ceil(Mt.usrCoords[1]/It)*It,wt=Math.floor(Pt.usrCoords[1]/It)*It,Mt.usrCoords[1]>Pt.usrCoords[1]&&(bt=Math.floor(Pt.usrCoords[1]/It)*It,wt=Math.ceil(Mt.usrCoords[1]/It)*It),Tt=bt;Tt<wt+It;Tt+=It)_t.dataX.push(Tt,Tt,NaN),_t.dataY.push(Mt.usrCoords[2],Pt.usrCoords[2],NaN)},_t.hasPoint=function(){return!1},At.grids.push(_t),_t},tt.createInequality=function(At,yt,xt){var _t,Et,bt;if(bt=ot.copyAttributes(xt,At.options,"inequality"),yt[0].elementClass===lt.OBJECT_CLASS_LINE)Et=At.create("curve",[[],[]],bt),Et.hasPoint=function(){return!1},Et.updateDataArray=function(){var wt,Tt,Mt,Pt=At.getBoundingBox(),It=bt.inverse?-1:1,Ot=1.5*Math.max(Pt[2]-Pt[0],Pt[1]-Pt[3]),Bt={coords:{usrCoords:[1,(Pt[0]+Pt[2])/2,bt.inverse?Pt[1]:Pt[3]]}},Ut=yt[0].stdform.slice(1),Ft=Ut;Mt=1.5*Math.max(rt.perpendicular(yt[0],Bt,At)[0].distance(lt.COORDS_BY_USER,Bt.coords),Ot),Mt*=It,Bt={coords:{usrCoords:[1,(Pt[0]+Pt[2])/2,(Pt[1]+Pt[3])/2]}},Bt=Math.abs(_e.innerProduct(Bt.coords.usrCoords,yt[0].stdform,3))>=_e.eps?rt.perpendicular(yt[0],Bt,At)[0].usrCoords:Bt.coords.usrCoords,wt=[1,Bt[1]+Ut[1]*Ot,Bt[2]-Ut[0]*Ot],Tt=[1,Bt[1]-Ft[1]*Ot,Bt[2]+Ft[0]*Ot],this.dataX=[wt[1],wt[1]+Ut[0]*Mt,Tt[1]+Ft[0]*Mt,Tt[1],wt[1]],this.dataY=[wt[2],wt[2]+Ut[1]*Mt,Tt[2]+Ft[1]*Mt,Tt[2],wt[2]]};else if(yt[0].elementClass===lt.OBJECT_CLASS_CURVE&&yt[0].visProp.curvetype==="functiongraph")Et=At.create("curve",[[],[]],bt),Et.hasPoint=function(){return!1},Et.updateDataArray=function(){var wt,Tt,Mt=this.board.getBoundingBox(),Pt=1.5*(bt.inverse?Mt[1]:Mt[3]);if(this.dataX=[],this.dataY=[],!((Tt=yt[0].points.length)<=0)){for(this.dataX.push(yt[0].points[0].usrCoords[1]),this.dataY.push(Pt),wt=0;wt<Tt;wt++)this.dataX.push(yt[0].points[wt].usrCoords[1]),this.dataY.push(yt[0].points[wt].usrCoords[2]);this.dataX.push(yt[0].points[Tt-1].usrCoords[1]),this.dataY.push(Pt)}};else if(_t=ot.createFunction(yt[0]),!ot.exists(_t))throw new Error(`JSXGraph: Can't create area with the given parents.
Possible parent types: [line], [function]`);return Et.addParents(yt[0]),Et},tt.registerElement("arrowparallel",tt.createArrowParallel),tt.registerElement("bisector",tt.createBisector),tt.registerElement("bisectorlines",tt.createAngularBisectorsOfTwoLines),tt.registerElement("msector",tt.createMsector),tt.registerElement("circumcircle",tt.createCircumcircle),tt.registerElement("circumcirclemidpoint",tt.createCircumcenter),tt.registerElement("circumcenter",tt.createCircumcenter),tt.registerElement("incenter",tt.createIncenter),tt.registerElement("incircle",tt.createIncircle),tt.registerElement("integral",tt.createIntegral),tt.registerElement("midpoint",tt.createMidpoint),tt.registerElement("mirrorelement",tt.createMirrorElement),tt.registerElement("mirrorpoint",tt.createMirrorPoint),tt.registerElement("normal",tt.createNormal),tt.registerElement("orthogonalprojection",tt.createOrthogonalProjection),tt.registerElement("parallel",tt.createParallel),tt.registerElement("parallelpoint",tt.createParallelPoint),tt.registerElement("perpendicular",tt.createPerpendicular),tt.registerElement("perpendicularpoint",tt.createPerpendicularPoint),tt.registerElement("perpendicularsegment",tt.createPerpendicularSegment),tt.registerElement("reflection",tt.createReflection),tt.registerElement("grid",tt.createGrid),tt.registerElement("inequality",tt.createInequality),{createArrowParallel:tt.createArrowParallel,createBisector:tt.createBisector,createAngularBisectorOfTwoLines:tt.createAngularBisectorsOfTwoLines,createCircumcircle:tt.createCircumcircle,createCircumcenter:tt.createCircumcenter,createIncenter:tt.createIncenter,createIncircle:tt.createIncircle,createIntegral:tt.createIntegral,createMidpoint:tt.createMidpoint,createMirrorElement:tt.createMirrorElement,createMirrorPoint:tt.createMirrorPoint,createNormal:tt.createNormal,createOrthogonalProjection:tt.createOrthogonalProjection,createParallel:tt.createParallel,createParallelPoint:tt.createParallelPoint,createPerpendicular:tt.createPerpendicular,createPerpendicularPoint:tt.createPerpendicularPoint,createPerpendicularSegmen:tt.createPerpendicularSegment,createReflection:tt.createReflection,createGrid:tt.createGrid,createInequality:tt.createInequality}}),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","parser/geonext","utils/color","utils/type","utils/event","utils/env","base/transformation","base/point","base/line","base/text","element/composition","base/composition"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt){return tt.Board=function(_t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,this.BOARD_MODE_ZOOM=17,dt.exists(Ut.document)&&Ut.document!==!1?this.document=Ut.document:document!==void 0&&dt.isObject(document)&&(this.document=document),this.container=_t,this.containerObj=pt.isBrowser?this.document.getElementById(this.container):null,pt.isBrowser&&Et.type!=="no"&&this.containerObj===null)throw new Error(`
JSXGraph: HTML container element '`+_t+"' not found.");this.renderer=Et,this.grids=[],this.options=dt.deepCopy(nt),this.attr=Ut,this.dimension=2,this.jc=new ct,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,wt[0],wt[1]],this.zoomX=Tt,this.zoomY=Mt,this.unitX=Pt*this.zoomX,this.unitY=It*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=Ot,this.canvasHeight=Bt,dt.exists(bt)&&bt!==""&&pt.isBrowser&&!dt.exists(this.document.getElementById(bt))?this.id=bt:this.id=this.generateId(),ft.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(_e.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this.selectingBox=[[0,0],[0,0]],this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},tt.extend(tt.Board.prototype,{generateName:function(_t){var Et,bt,wt=this.attr.maxnamelength,Tt="",Mt="",Pt=[],It="";if(_t.type===_e.OBJECT_TYPE_TICKS)return"";for(Et=dt.isPoint(_t)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:_t.type===_e.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],dt.isPoint(_t)||_t.elementClass===_e.OBJECT_CLASS_LINE||_t.type===_e.OBJECT_TYPE_ANGLE||(Tt=_t.type===_e.OBJECT_TYPE_POLYGON?"P_{":_t.elementClass===_e.OBJECT_CLASS_CIRCLE?"k_{":_t.elementClass===_e.OBJECT_CLASS_TEXT?"t_{":"s_{",Mt="}"),bt=0;bt<wt;bt++)Pt[bt]=0;for(;Pt[wt-1]<Et.length;){for(Pt[0]=1;Pt[0]<Et.length;Pt[0]++){for(It=Tt,bt=wt;bt>0;bt--)It+=Et[Pt[bt-1]];if(!dt.exists(this.elementsByName[It+Mt]))return It+Mt}for(Pt[0]=Et.length,bt=1;bt<wt;bt++)Pt[bt-1]===Et.length&&(Pt[bt-1]=1,Pt[bt]+=1)}return""},generateId:function(){for(var _t=1;dt.exists(tt.boards["jxgBoard"+_t]);)_t=Math.round(65535*Math.random());return"jxgBoard"+_t},setId:function(_t,Et){var bt,wt=this.numObjects,Tt=_t.id;if(this.numObjects+=1,Tt===""||!dt.exists(Tt))for(Tt=this.id+Et+wt;dt.exists(this.objects[Tt]);)bt=Math.round(65535*Math.random()),Tt=this.id+Et+wt+"-"+bt;return _t.id=Tt,this.objects[Tt]=_t,_t._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=_t,Tt},finalizeAdding:function(_t){dt.evaluate(_t.visProp.visible)===!1&&this.renderer.display(_t,!1)},finalizeLabel:function(_t){_t.hasLabel&&!dt.evaluate(_t.label.visProp.islabel)&&dt.evaluate(_t.label.visProp.visible)===!1&&this.renderer.display(_t.label,!1)},getCoordsTopLeftCorner:function(){var _t,Et,bt,wt,Tt,Mt=this.document.documentElement||this.document.body.parentNode,Pt=this.document.body,It=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||new Date().getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=new Date().getTime(),It.getBoundingClientRect){for(bt=It.getBoundingClientRect(),wt=1,Tt=It;Tt&&dt.exists(Tt.parentNode);)dt.exists(Tt.style)&&dt.exists(Tt.style.zoom)&&Tt.style.zoom!==""&&(wt*=parseFloat(Tt.style.zoom)),Tt=Tt.parentNode;return _t=[bt.left*wt,bt.top*wt],_t[0]+=pt.getProp(It,"border-left-width"),_t[1]+=pt.getProp(It,"border-top-width"),this.renderer.type!=="vml"&&(_t[0]+=pt.getProp(It,"padding-left"),_t[1]+=pt.getProp(It,"padding-top")),this.cPos=_t.slice(),this.cPos}return _t=pt.getOffset(It),Et=this.document.documentElement.ownerDocument,!this.containerObj.currentStyle&&Et.defaultView&&(_t[0]+=pt.getProp(Mt,"margin-left"),_t[1]+=pt.getProp(Mt,"margin-top"),_t[0]+=pt.getProp(Mt,"border-left-width"),_t[1]+=pt.getProp(Mt,"border-top-width"),_t[0]+=pt.getProp(Mt,"padding-left"),_t[1]+=pt.getProp(Mt,"padding-top")),Pt&&(_t[0]+=pt.getProp(Pt,"left"),_t[1]+=pt.getProp(Pt,"top")),typeof google=="object"&&google.translate&&(_t[0]+=10,_t[1]+=25),_t[0]+=pt.getProp(It,"border-left-width"),_t[1]+=pt.getProp(It,"border-top-width"),this.renderer.type!=="vml"&&(_t[0]+=pt.getProp(It,"padding-left"),_t[1]+=pt.getProp(It,"padding-top")),_t[0]+=this.attr.offsetx,_t[1]+=this.attr.offsety,this.cPos=_t.slice(),this.cPos},getMousePosition:function(_t,Et){var bt,wt,Tt=this.getCoordsTopLeftCorner();return bt=pt.getPosition(_t,Et,this.document),dt.exists(this.cssTransMat)||this.updateCSSTransforms(),wt=[1,bt[0]-Tt[0],bt[1]-Tt[1]],wt=st.matVecMult(this.cssTransMat,wt),wt[1]/=wt[0],wt[2]/=wt[0],[wt[1],wt[2]]},initMoveOrigin:function(_t,Et){this.drag_dx=_t-this.origin.scrCoords[1],this.drag_dy=Et-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(_t,Et,bt,wt){var Tt,Mt,Pt,It=[],Ot=[],Bt=this.objectsList.length,Ut={visProp:{layer:-1e4}};for(Mt=0;Mt<Bt;Mt++)Tt=this.objectsList[Mt],Pt=Tt.hasPoint&&Tt.hasPoint(_t,Et),Tt.visPropCalc.visible&&Pt&&(Tt.triggerEventHandlers([wt+"down","down"],[bt]),this.downObjects.push(Tt)),(this.geonextCompatibilityMode&&(dt.isPoint(Tt)||Tt.elementClass===_e.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&Tt.isDraggable&&Tt.visPropCalc.visible&&!dt.evaluate(Tt.visProp.fixed)&&Pt&&(Tt.visProp.layer>Ut.visProp.layer||Tt.visProp.layer===Ut.visProp.layer&&Tt.lastDragTime.getTime()>=Ut.lastDragTime.getTime())&&(this.attr.ignorelabels&&dt.exists(Ut.label)&&Tt===Ut.label||(Ut=Tt,It.push(Ut),dt.exists(Ut.coords)?Ot.push(at.subtract(Ut.coords.scrCoords.slice(1),[_t,Et])):Ot.push([0,0])));return It.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(It.length=1,this._drag_offset=Ot[0]):(It=It.slice(-1),this._drag_offset=Ot[Ot.length-1]),this._drag_offset||(this._drag_offset=[0,0]),this.renderer.type==="svg"&&dt.exists(It[0])&&dt.evaluate(It[0].visProp.dragtotopoflayer)&&It.length===1&&dt.exists(It[0].rendNode)&&It[0].rendNode.parentNode.appendChild(It[0].rendNode),It},moveObject:function(_t,Et,bt,wt,Tt){var Mt,Pt,It,Ot=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(_t,Et),this);bt&&bt.obj&&(Mt=bt.obj,Mt.coords&&(Pt=Mt.coords.scrCoords.slice()),this.drag_position=[Ot.scrCoords[1],Ot.scrCoords[2]],this.drag_position=at.add(this.drag_position,this._drag_offset),dt.exists(Mt.coords)?Mt.setPositionDirectly(_e.COORDS_BY_SCREEN,this.drag_position):(this.showInfobox(!1),isNaN(bt.targets[0].Xprev+bt.targets[0].Yprev)||Mt.setPositionDirectly(_e.COORDS_BY_SCREEN,[Ot.scrCoords[1],Ot.scrCoords[2]],[bt.targets[0].Xprev,bt.targets[0].Yprev]),bt.targets[0].Xprev=Ot.scrCoords[1],bt.targets[0].Yprev=Ot.scrCoords[2]),Mt.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(Mt),Mt.prepareUpdate().update(!0).updateRenderer(),Mt.coords&&(It=Mt.coords.scrCoords),Mt.coords&&Pt[1]===It[1]&&Pt[2]===It[2]||(Mt.triggerEventHandlers([Tt+"drag","drag"],[wt]),this.update()),Mt.highlight(!0),Mt.lastDragTime=new Date)},twoFingerMove:function(_t,Et,bt,wt){var Tt,Mt,Pt;dt.exists(bt)&&dt.exists(bt.obj)&&(Pt=bt.obj,Tt=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(_t[0],_t[1]),this),Mt=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(Et[0],Et[1]),this),Pt.elementClass===_e.OBJECT_CLASS_LINE||Pt.type===_e.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(Tt,Mt,bt,Pt):Pt.elementClass===_e.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(Tt,Mt,bt,Pt),Pt.triggerEventHandlers(["touchdrag","drag"],[wt]),bt.targets[0].Xprev=Tt.scrCoords[1],bt.targets[0].Yprev=Tt.scrCoords[2],bt.targets[1].Xprev=Mt.scrCoords[1],bt.targets[1].Yprev=Mt.scrCoords[2])},twoFingerTouchObject:function(_t,Et,bt,wt){var Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt,Dt,Gt,zt,$t,Ht,er,Zt,or,Kt,rr;if(dt.exists(bt.targets[0])&&dt.exists(bt.targets[1])&&!isNaN(bt.targets[0].Xprev+bt.targets[0].Yprev+bt.targets[1].Xprev+bt.targets[1].Yprev)){if(Tt=_t.usrCoords,Mt=Et.usrCoords,Pt=new rt(_e.COORDS_BY_SCREEN,[bt.targets[0].Xprev,bt.targets[0].Yprev],this).usrCoords,It=new rt(_e.COORDS_BY_SCREEN,[bt.targets[1].Xprev,bt.targets[1].Yprev],this).usrCoords,Bt=[1,.5*(Pt[1]+It[1]),.5*(Pt[2]+It[2])],Ot=[1,.5*(Tt[1]+Mt[1]),.5*(Tt[2]+Mt[2])],Ft=st.crossProduct(Pt,It),Ut=st.crossProduct(Tt,Mt),Dt=st.crossProduct(Ft,Ut),Math.abs(Dt[0])<st.eps)return;if(Dt[1]/=Dt[0],Dt[2]/=Dt[0],Gt=ot.rad(Bt.slice(1),Dt.slice(1),Ot.slice(1)),zt=this.create("transform",[Gt,Dt[1],Dt[2]],{type:"rotate"}),zt.update(),Bt=st.matVecMult(zt.matrix,Bt),Bt[1]/=Bt[0],Bt[2]/=Bt[0],$t=this.create("transform",[Ot[1]-Bt[1],Ot[2]-Bt[2]],{type:"translate"}),$t.update(),zt.melt($t),dt.evaluate(wt.visProp.scalable)&&(jt=ot.distance(Tt,Mt)/ot.distance(Pt,It),Ht=this.create("transform",[-Ot[1],-Ot[2]],{type:"translate"}),er=this.create("transform",[jt,jt],{type:"scale"}),Zt=this.create("transform",[Ot[1],Ot[2]],{type:"translate"}),zt.melt(Ht).melt(er).melt(Zt)),wt.elementClass===_e.OBJECT_CLASS_LINE)or=[],wt.point1.draggable()&&or.push(wt.point1),wt.point2.draggable()&&or.push(wt.point2),zt.applyOnce(or);else if(wt.type===_e.OBJECT_TYPE_POLYGON){for(or=[],rr=wt.vertices.length-1,Kt=0;Kt<rr;++Kt)wt.vertices[Kt].draggable()&&or.push(wt.vertices[Kt]);zt.applyOnce(or)}this.update(),wt.highlight(!0)}},twoFingerTouchCircle:function(_t,Et,bt,wt){var Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt,Dt,Gt;wt.method!=="pointCircle"&&wt.method!=="pointLine"&&dt.exists(bt.targets[0])&&dt.exists(bt.targets[1])&&!isNaN(bt.targets[0].Xprev+bt.targets[0].Yprev+bt.targets[1].Xprev+bt.targets[1].Yprev)&&(Tt=_t.usrCoords,Mt=Et.usrCoords,Pt=new rt(_e.COORDS_BY_SCREEN,[bt.targets[0].Xprev,bt.targets[0].Yprev],this).usrCoords,It=new rt(_e.COORDS_BY_SCREEN,[bt.targets[1].Xprev,bt.targets[1].Yprev],this).usrCoords,Ut=this.create("transform",[Tt[1]-Pt[1],Tt[2]-Pt[2]],{type:"translate"}),Bt=ot.rad(It.slice(1),Tt.slice(1),Mt.slice(1)),Ft=this.create("transform",[-Tt[1],-Tt[2]],{type:"translate"}),jt=this.create("transform",[Bt],{type:"rotate"}),Ut.melt(Ft).melt(jt),dt.evaluate(wt.visProp.scalable)&&(Ot=ot.distance(Tt,Mt)/ot.distance(Pt,It),Dt=this.create("transform",[Ot,Ot],{type:"scale"}),Ut.melt(Dt)),Gt=this.create("transform",[Tt[1],Tt[2]],{type:"translate"}),Ut.melt(Gt),wt.center.draggable()&&Ut.applyOnce([wt.center]),wt.method==="twoPoints"?wt.point2.draggable()&&Ut.applyOnce([wt.point2]):wt.method==="pointRadius"&&dt.isNumber(wt.updateRadius.origin)&&wt.setRadius(wt.radius*Ot),this.update(wt.center),wt.highlight(!0))},highlightElements:function(_t,Et,bt,wt){var Tt,Mt,Pt,It={},Ot=this.objectsList.length;for(Tt=0;Tt<Ot;Tt++)Mt=this.objectsList[Tt],Pt=Mt.id,dt.exists(Mt.hasPoint)&&Mt.visPropCalc.visible&&Mt.hasPoint(_t,Et)&&(this.updateInfobox(Mt),dt.exists(this.highlightedObjects[Pt])||(It[Pt]=Mt,Mt.highlight(),Mt.triggerEventHandlers(["mousehit","hit"],[bt,Mt,wt])),Mt.mouseover?Mt.triggerEventHandlers(["mousemove","move"],[bt]):(Mt.triggerEventHandlers(["mouseover","over"],[bt]),Mt.mouseover=!0));for(Tt=0;Tt<Ot;Tt++)Mt=this.objectsList[Tt],Pt=Mt.id,Mt.mouseover&&(It[Pt]||(Mt.triggerEventHandlers(["mouseout","out"],[bt]),Mt.mouseover=!1))},saveStartPos:function(_t,Et){var bt,wt,Tt=[];if(_t.type===_e.OBJECT_TYPE_TICKS)Tt.push([1,NaN,NaN]);else if(_t.elementClass===_e.OBJECT_CLASS_LINE)Tt.push(_t.point1.coords.usrCoords),Tt.push(_t.point2.coords.usrCoords);else if(_t.elementClass===_e.OBJECT_CLASS_CIRCLE)Tt.push(_t.center.coords.usrCoords),_t.method==="twoPoints"&&Tt.push(_t.point2.coords.usrCoords);else if(_t.type===_e.OBJECT_TYPE_POLYGON)for(wt=_t.vertices.length-1,bt=0;bt<wt;bt++)Tt.push(_t.vertices[bt].coords.usrCoords);else if(_t.type===_e.OBJECT_TYPE_SECTOR)Tt.push(_t.point1.coords.usrCoords),Tt.push(_t.point2.coords.usrCoords),Tt.push(_t.point3.coords.usrCoords);else if(dt.isPoint(_t)||_t.type===_e.OBJECT_TYPE_GLIDER)Tt.push(_t.coords.usrCoords);else if(_t.elementClass===_e.OBJECT_CLASS_CURVE)_t.points.length>0&&Tt.push(_t.points[0].usrCoords);else try{Tt.push(_t.coords.usrCoords)}catch(Mt){tt.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+Mt)}for(wt=Tt.length,bt=0;bt<wt;bt++)Et.Zstart.push(Tt[bt][0]),Et.Xstart.push(Tt[bt][1]),Et.Ystart.push(Tt[bt][2])},mouseOriginMoveStart:function(_t){var Et,bt;return Et=this._isRequiredKeyPressed(_t,"pan"),Et&&(bt=this.getMousePosition(_t),this.initMoveOrigin(bt[0],bt[1])),Et},mouseOriginMove:function(_t){var Et,bt=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return bt&&(Et=this.getMousePosition(_t),this.moveOrigin(Et[0],Et[1],!0)),bt},touchOriginMoveStart:function(_t){var Et,bt,wt=_t[tt.touchProperty];return Et=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&wt.length==1,Et&&(bt=this.getMousePosition(_t,0),this.initMoveOrigin(bt[0],bt[1])),Et},touchOriginMove:function(_t){var Et,bt=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return bt&&(Et=this.getMousePosition(_t,0),this.moveOrigin(Et[0],Et[1],!0)),bt},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){pt.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),this.containerObj!==null&&(this.containerObj.oncontextmenu=function(_t){return dt.exists(_t)&&_t.preventDefault(),!1})},addPointerEventHandlers:function(){!this.hasPointerHandlers&&pt.isBrowser&&(window.navigator.msPointerEnabled?(pt.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),pt.addEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(pt.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),pt.addEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),pt.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),pt.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.containerObj!==null&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0)},addMouseEventHandlers:function(){!this.hasMouseHandlers&&pt.isBrowser&&(pt.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),pt.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),pt.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),pt.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0)},addTouchEventHandlers:function(_t){!this.hasTouchHandlers&&pt.isBrowser&&(pt.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),pt.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0)},removePointerEventHandlers:function(){this.hasPointerHandlers&&pt.isBrowser&&(window.navigator.msPointerEnabled?(pt.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),pt.removeEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(pt.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),pt.removeEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),pt.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),pt.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?pt.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):pt.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.hasPointerHandlers=!1)},removeMouseEventHandlers:function(){this.hasMouseHandlers&&pt.isBrowser&&(pt.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),pt.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(pt.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),pt.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),pt.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1)},removeTouchEventHandlers:function(){this.hasTouchHandlers&&pt.isBrowser&&(pt.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),pt.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(pt.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1)},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers()},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(_t){var Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut=this.attr.zoom.factorx,Ft=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(_t.preventDefault(),Et=new rt(_e.COORDS_BY_SCREEN,this.getMousePosition(_t,0),this),wt=ot.distance([_t.touches[0].clientX,_t.touches[0].clientY],[_t.touches[1].clientX,_t.touches[1].clientY],2),_t.scale===void 0&&(_t.scale=wt/this.prevDist),bt=_t.scale/this.prevScale,this.prevScale=_t.scale,this.attr.pan.enabled&&this.attr.pan.needtwofingers&&Math.abs(_t.scale-1)<.4&&this._num_pan>=.8*this._num_zoom?(this._num_pan++,this.moveOrigin(Et.scrCoords[1],Et.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(bt-1)<.5&&(this._num_zoom++,(this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(Tt=Math.abs(_t.touches[0].clientX-_t.touches[1].clientX),Mt=Math.abs(_t.touches[0].clientY-_t.touches[1].clientY),Pt=Math.abs(Math.atan2(Mt,Tt)),Bt=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&Pt<Bt?(this.attr.zoom.factorx=bt,this.attr.zoom.factory=1,It=0,Ot=0):this.attr.zoom.pinchvertical&&Math.abs(Pt-.5*Math.PI)<Bt?(this.attr.zoom.factorx=1,this.attr.zoom.factory=bt,It=0,Ot=0):(this.attr.zoom.factorx=bt,this.attr.zoom.factory=bt,It=Et.usrCoords[1],Ot=Et.usrCoords[2]),this.zoomIn(It,Ot),this.attr.zoom.factorx=Ut,this.attr.zoom.factory=Ft),!1)},gestureStartListener:function(_t){var Et;return _t.preventDefault(),this.prevScale=1,this.prevDist=ot.distance([_t.touches[0].clientX,_t.touches[0].clientY],[_t.touches[1].clientX,_t.touches[1].clientY],2),Et=this.getMousePosition(_t,0),this.initMoveOrigin(Et[0],Et[1]),this._num_zoom=this._num_pan=0,this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(_t,Et){var bt=this.attr[Et];return!!bt.enabled&&!(!(bt.needshift&&_t.shiftKey||!bt.needshift&&!_t.shiftKey)||!(bt.needctrl&&_t.ctrlKey||!bt.needctrl&&!_t.ctrlKey))},_pointerAddBoardTouches:function(_t){var Et,bt;for(Et=0,bt=!1;Et<this._board_touches.length;Et++)if(this._board_touches[Et].pointerId===_t.pointerId){this._board_touches[Et].clientX=_t.clientX,this._board_touches[Et].clientY=_t.clientY,bt=!0;break}return bt||this._board_touches.push({pointerId:_t.pointerId,clientX:_t.clientX,clientY:_t.clientY}),this},_pointerRemoveBoardTouches:function(_t){var Et;for(Et=0;Et<this._board_touches.length;Et++)if(this._board_touches[Et].pointerId===_t.pointerId){this._board_touches.splice(Et,1);break}return this},pointerDownListener:function(_t,Et){var bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut=this.options.precision.touch;if(this.hasPointerUp||(window.navigator.msPointerEnabled?pt.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):pt.addEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&dt.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(It=window.getSelection(),It.removeAllRanges))try{It.removeAllRanges()}catch{}if(pt.isBrowser&&(_t.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=Ut),Mt=this.getMousePosition(_t),this._testForSelection(_t),this.selectingMode)return this._startSelecting(Mt),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[_t]);if(Et?(Pt=[Et],this.mode=this.BOARD_MODE_DRAG):Pt=this.initMoveObject(Mt[0],Mt[1],_t,"mouse"),Pt.length>0){for(Bt=Pt[Pt.length-1],Ot=!1,bt=0;bt<this.touches.length;bt++)if(this.touches[bt].obj===Bt){wt=bt,Tt=this.touches[bt].targets.push({num:_t.pointerId,X:Mt[0],Y:Mt[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]})-1,Ot=!0;break}Ot||(Tt=0,wt=this.touches.push({obj:Bt,targets:[{num:_t.pointerId,X:Mt[0],Y:Mt[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}]})-1),this.dehighlightAll(),Bt.highlight(!0),this.saveStartPos(Bt,this.touches[wt].targets[Tt]),_t&&_t.preventDefault?_t.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(_t.preventDefault(),_t.stopPropagation()),this.options.precision.hasPoint=this.options.precision.mouse,pt.isBrowser&&_t.pointerType!=="touch"?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(_t):(this._pointerAddBoardTouches(_t),_t.touches=this._board_touches,this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(_t)||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||_t.touches.length!=2||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(_t))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[_t]),!1},pointerMoveListener:function(_t){var Et,bt,wt;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(_t.preventDefault(),_t.stopPropagation()),pt.isBrowser&&(_t.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=this.options.precision.touch),this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode)wt=this.getMousePosition(_t),this._moveSelecting(wt),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[_t,this.mode]);else if(!this.mouseOriginMove(_t))if(this.mode===this.BOARD_MODE_DRAG){for(Et=0;Et<this.touches.length;Et++)for(bt=0;bt<this.touches[Et].targets.length;bt++)if(this.touches[Et].targets[bt].num===_t.pointerId){this.touches[Et].targets.length===1?(this.touches[Et].targets[bt].X=_t.pageX,this.touches[Et].targets[bt].Y=_t.pageY,wt=this.getMousePosition(_t),this.moveObject(wt[0],wt[1],this.touches[Et],_t,"touch")):this.touches[Et].targets.length===2&&this.touches[Et].targets[0].num>-1&&this.touches[Et].targets[1].num>-1&&(this.touches[Et].targets[bt].X=_t.pageX,this.touches[Et].targets[bt].Y=_t.pageY,this.twoFingerMove(this.getMousePosition({clientX:this.touches[Et].targets[0].X,clientY:this.touches[Et].targets[0].Y}),this.getMousePosition({clientX:this.touches[Et].targets[1].X,clientY:this.touches[Et].targets[1].Y}),this.touches[Et],_t));break}}else _t.pointerType=="touch"?(this._pointerAddBoardTouches(_t),this._board_touches.length==2&&(_t.touches=this._board_touches,this.gestureChangeListener(_t))):(wt=this.getMousePosition(_t),this.highlightElements(wt[0],wt[1],_t,-1));return this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[_t,this.mode]),this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(_t){var Et,bt,wt;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[_t]),this.showInfobox(!1),_t){for(Et=0;Et<this.touches.length;Et++)for(bt=0;bt<this.touches[Et].targets.length;bt++)if(this.touches[Et].targets[bt].num===_t.pointerId){this.touches[Et].targets.splice(bt,1),this.touches[Et].targets.length===0&&this.touches.splice(Et,1);break}}if(this.selectingMode)this._stopSelecting(_t),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[_t]);else for(Et=this.downObjects.length-1;Et>-1;Et--){for(wt=!1,bt=0;bt<this.touches.length;bt++)this.touches[bt].obj.id===this.downObjects[Et].id&&(wt=!0);wt||(this.downObjects[Et].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[_t]),this.downObjects[Et].snapToGrid(),this.downObjects[Et].snapToPoints(),this.downObjects.splice(Et,1))}return this._pointerRemoveBoardTouches(_t),this._board_touches.length===0&&(this.hasPointerUp&&(window.navigator.msPointerEnabled?pt.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):pt.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this.originMoveEnd(),this.update()),!0},touchStartListener:function(_t){var Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut=this.options.precision.touch,Ft=_t[tt.touchProperty];for(this.hasTouchEnd||(pt.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&dt.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.options.precision.hasPoint=this.options.precision.touch,Et=0;Et<Ft.length;Et++)Ft[Et].jxg_isused=!1;for(Et=0;Et<this.touches.length;Et++)for(Tt=0;Tt<this.touches[Et].targets.length;Tt++){this.touches[Et].targets[Tt].num=-1,Ut=this.options.precision.touch;do{for(Mt=0;Mt<Ft.length;Mt++)if(Math.abs(Math.pow(Ft[Mt].screenX-this.touches[Et].targets[Tt].X,2)+Math.pow(Ft[Mt].screenY-this.touches[Et].targets[Tt].Y,2))<Ut*Ut){this.touches[Et].targets[Tt].num=Mt,this.touches[Et].targets[Tt].X=Ft[Mt].screenX,this.touches[Et].targets[Tt].Y=Ft[Mt].screenY,Ft[Mt].jxg_isused=!0;break}Ut*=2}while(this.touches[Et].targets[Tt].num===-1&&Ut<this.options.precision.touchMax);this.touches[Et].targets[Tt].num===-1&&(tt.debug("i couldn't find a targettouches for target no "+Tt+" on "+this.touches[Et].obj.name+" ("+this.touches[Et].obj.id+"). Removed the target."),tt.debug("eps = "+Ut+", touchMax = "+nt.precision.touchMax),this.touches[Et].targets.splice(Et,1))}for(Et=0;Et<Ft.length;Et++)if(!Ft[Et].jxg_isused){if(bt=this.getMousePosition(_t,Et),this.selectingMode)return this._startSelecting(bt),this.triggerEventHandlers(["touchstartselecting","startselecting"],[_t]),_t.preventDefault(),_t.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if(wt=this.initMoveObject(bt[0],bt[1],_t,"touch"),wt.length!==0){if(Pt=wt[wt.length-1],dt.isPoint(Pt)||Pt.elementClass===_e.OBJECT_CLASS_TEXT||Pt.type===_e.OBJECT_TYPE_TICKS||Pt.type===_e.OBJECT_TYPE_IMAGE)Ot=[{num:Et,X:Ft[Et].screenX,Y:Ft[Et].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(Pt,Ot[0]),this.touches.push({obj:Pt,targets:Ot}),Pt.highlight(!0);else if(Pt.elementClass===_e.OBJECT_CLASS_LINE||Pt.elementClass===_e.OBJECT_CLASS_CIRCLE||Pt.elementClass===_e.OBJECT_CLASS_CURVE||Pt.type===_e.OBJECT_TYPE_POLYGON){for(It=!1,Tt=0;Tt<this.touches.length;Tt++)Pt.id===this.touches[Tt].obj.id&&(It=!0,this.touches[Tt].targets.length===1&&(Bt={num:Et,X:Ft[Et].screenX,Y:Ft[Et].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},this.saveStartPos(Pt,Bt),this.touches[Tt].targets.push(Bt)),Ft[Et].jxg_isused=!0);It||(Ot=[{num:Et,X:Ft[Et].screenX,Y:Ft[Et].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(Pt,Ot[0]),this.touches.push({obj:Pt,targets:Ot}),Pt.highlight(!0))}}Ft[Et].jxg_isused=!0}return this.touches.length>0&&(_t.preventDefault(),_t.stopPropagation()),this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(_t)||Ft.length!=2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(_t)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[_t]),!1},touchMoveListener:function(_t){var Et,bt,wt,Tt=_t[tt.touchProperty];if(this.mode!==this.BOARD_MODE_NONE&&(_t.preventDefault(),_t.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(Et=0;Et<Tt.length;Et++)if(!Tt[Et].jxg_isused){bt=this.getMousePosition(_t,Et),this._moveSelecting(bt),this.triggerEventHandlers(["touchmoves","moveselecting"],[_t,this.mode]);break}}else if(!this.touchOriginMove(_t))if(this.mode===this.BOARD_MODE_DRAG){for(Et=0;Et<this.touches.length;Et++)if(this.touches[Et].targets.length===1){if(Tt[this.touches[Et].targets[0].num]){if(bt=this.getMousePosition(_t,this.touches[Et].targets[0].num),bt[0]<0||bt[0]>this.canvasWidth||bt[1]<0||bt[1]>this.canvasHeight)return;this.touches[Et].targets[0].X=Tt[this.touches[Et].targets[0].num].screenX,this.touches[Et].targets[0].Y=Tt[this.touches[Et].targets[0].num].screenY,this.moveObject(bt[0],bt[1],this.touches[Et],_t,"touch")}}else if(this.touches[Et].targets.length===2&&this.touches[Et].targets[0].num>-1&&this.touches[Et].targets[1].num>-1&&Tt[this.touches[Et].targets[0].num]&&Tt[this.touches[Et].targets[1].num]){if(bt=this.getMousePosition(_t,this.touches[Et].targets[0].num),wt=this.getMousePosition(_t,this.touches[Et].targets[1].num),bt[0]<0||bt[0]>this.canvasWidth||bt[1]<0||bt[1]>this.canvasHeight||wt[0]<0||wt[0]>this.canvasWidth||wt[1]<0||wt[1]>this.canvasHeight)return;this.touches[Et].targets[0].X=Tt[this.touches[Et].targets[0].num].screenX,this.touches[Et].targets[0].Y=Tt[this.touches[Et].targets[0].num].screenY,this.touches[Et].targets[1].X=Tt[this.touches[Et].targets[1].num].screenX,this.touches[Et].targets[1].Y=Tt[this.touches[Et].targets[1].num].screenY,this.twoFingerMove(bt,wt,this.touches[Et],_t)}}else Tt.length==2&&this.gestureChangeListener(_t);return this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move"],[_t,this.mode]),this.mode===this.BOARD_MODE_NONE},touchEndListener:function(_t){var Et,bt,wt,Tt,Mt,Pt=this.options.precision.touch,It=[],Ot=_t&&_t[tt.touchProperty];if(this.triggerEventHandlers(["touchend","up"],[_t]),this.showInfobox(!1),this.selectingMode)this._stopSelecting(_t),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[_t]);else if(Ot&&Ot.length>0){for(Et=0;Et<this.touches.length;Et++)It[Et]=this.touches[Et];for(this.touches.length=0,Et=0;Et<Ot.length;Et++)Ot[Et].jxg_isused=!1;for(Et=0;Et<It.length;Et++){for(Tt=!1,Mt=0,bt=0;bt<It[Et].targets.length;bt++)for(It[Et].targets[bt].found=!1,wt=0;wt<Ot.length;wt++)if(Math.abs(Math.pow(Ot[wt].screenX-It[Et].targets[bt].X,2)+Math.pow(Ot[wt].screenY-It[Et].targets[bt].Y,2))<Pt*Pt){It[Et].targets[bt].found=!0,It[Et].targets[bt].num=wt,It[Et].targets[bt].X=Ot[wt].screenX,It[Et].targets[bt].Y=Ot[wt].screenY,Mt+=1;break}if(dt.isPoint(It[Et].obj)?Tt=It[Et].targets[0]&&It[Et].targets[0].found:It[Et].obj.elementClass===_e.OBJECT_CLASS_LINE?Tt=It[Et].targets[0]&&It[Et].targets[0].found||It[Et].targets[1]&&It[Et].targets[1].found:It[Et].obj.elementClass===_e.OBJECT_CLASS_CIRCLE&&(Tt=Mt===1||Mt===3),Tt)for(this.touches.push({obj:It[Et].obj,targets:[]}),bt=0;bt<It[Et].targets.length;bt++)It[Et].targets[bt].found&&this.touches[this.touches.length-1].targets.push({num:It[Et].targets[bt].num,X:It[Et].targets[bt].screenX,Y:It[Et].targets[bt].screenY,Xprev:NaN,Yprev:NaN,Xstart:It[Et].targets[bt].Xstart,Ystart:It[Et].targets[bt].Ystart,Zstart:It[Et].targets[bt].Zstart});else It[Et].obj.noHighlight()}}else this.touches.length=0;for(Et=this.downObjects.length-1;Et>-1;Et--){for(Tt=!1,bt=0;bt<this.touches.length;bt++)this.touches[bt].obj.id===this.downObjects[Et].id&&(Tt=!0);Tt||(this.downObjects[Et].triggerEventHandlers(["touchup","up"],[_t]),this.downObjects[Et].snapToGrid(),this.downObjects[Et].snapToPoints(),this.downObjects.splice(Et,1))}return Ot&&Ot.length!==0||(this.hasTouchEnd&&(pt.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(_t){var Et,bt,wt;if(this.document.selection&&dt.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return pt.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,Et=this.getMousePosition(_t),this._testForSelection(_t),this.selectingMode?(this._startSelecting(Et),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[_t])):(bt=this.initMoveObject(Et[0],Et[1],_t,"mouse"),bt.length===0?(this.mode=this.BOARD_MODE_NONE,wt=!0):(this.mouse={obj:null,targets:[{X:Et[0],Y:Et[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=bt[bt.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),_t&&_t.preventDefault?_t.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(wt=this.mouseOriginMoveStart(_t)),this.triggerEventHandlers(["mousedown","down"],[_t]),wt)},mouseMoveListener:function(_t){var Et;Et=this.getMousePosition(_t),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.selectingMode?(this._moveSelecting(Et),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[_t,this.mode])):this.mouseOriginMove(_t)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(Et[0],Et[1],this.mouse,_t,"mouse"):this.highlightElements(Et[0],Et[1],_t,-1),this.triggerEventHandlers(["mousemove","move"],[_t,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(_t){var Et;if(this.selectingMode===!1&&this.triggerEventHandlers(["mouseup","up"],[_t]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&(this.mouse.obj.snapToGrid(this.mouse.targets[0]),this.mouse.obj.snapToPoints()),this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(_t),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[_t]);else for(Et=0;Et<this.downObjects.length;Et++)this.downObjects[Et].triggerEventHandlers(["mouseup","up"],[_t]);this.downObjects.length=0,this.hasMouseUp&&(pt.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(_t){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(_t,"zoom"))return!0;_t=_t||window.event;var Et=_t.detail?-_t.detail:_t.wheelDelta/40,bt=new rt(_e.COORDS_BY_SCREEN,this.getMousePosition(_t),this);return Et>0?this.zoomIn(bt.usrCoords[1],bt.usrCoords[2]):this.zoomOut(bt.usrCoords[1],bt.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[_t]),_t.preventDefault(),!1},initInfobox:function(){var _t=dt.copyAttributes({},this.options,"infobox");return _t.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],_t),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.showInfobox(!1),this},updateInfobox:function(_t){var Et,bt,wt,Tt,Mt;return dt.evaluate(_t.visProp.showinfobox)?(dt.isPoint(_t)&&(wt=_t.coords.usrCoords[1],Tt=_t.coords.usrCoords[2],Mt=dt.evaluate(_t.visProp.infoboxdigits),this.infobox.setCoords(wt+this.infobox.distanceX/this.unitX,Tt+this.infobox.distanceY/this.unitY),typeof _t.infoboxText!="string"?(Mt==="auto"?(Et=dt.autoDigits(wt),bt=dt.autoDigits(Tt)):dt.isNumber(Mt)?(Et=dt.toFixed(wt,Mt),bt=dt.toFixed(Tt,Mt)):(Et=wt,bt=Tt),this.highlightInfobox(Et,bt,_t)):this.highlightCustomInfobox(_t.infoboxText,_t),this.showInfobox(!0)),this):this},showInfobox:function(_t){return this.infobox.hiddenByParent==_t&&(this.infobox.hiddenByParent=!_t,this.infobox.prepareUpdate().updateVisibility(_t).updateRenderer()),this},highlightInfobox:function(_t,Et,bt){return this.highlightCustomInfobox("("+_t+", "+Et+")",bt),this},highlightCustomInfobox:function(_t,Et){return this.infobox.setText(_t),this},dehighlightAll:function(){var _t,Et,bt=!1;for(_t in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(_t)&&(Et=this.highlightedObjects[_t],(this.hasMouseHandlers||this.hasPointerHandlers)&&Et.noHighlight(),bt=!0);return this.highlightedObjects={},this.renderer.type==="canvas"&&bt&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(_t,Et){return[_t,Et]},getUsrCoordsOfMouse:function(_t){var Et=this.getCoordsTopLeftCorner(),bt=pt.getPosition(_t,null,this.document),wt=bt[0]-Et[0],Tt=bt[1]-Et[1];return new rt(_e.COORDS_BY_SCREEN,[wt,Tt],this).usrCoords.slice(1)},getAllUnderMouse:function(_t){var Et=this.getAllObjectsUnderMouse(_t);return Et.push(this.getUsrCoordsOfMouse(_t)),Et},getAllObjectsUnderMouse:function(_t){var Et,bt,wt=this.getCoordsTopLeftCorner(),Tt=pt.getPosition(_t,null,this.document),Mt=Tt[0]-wt[0],Pt=Tt[1]-wt[1],It=[],Ot=this.objectsList.length;for(Et=0;Et<Ot;Et++)bt=this.objectsList[Et],bt.visPropCalc.visible&&bt.hasPoint&&bt.hasPoint(Mt,Pt)&&(It[It.length]=bt);return It},updateCoords:function(){var _t,Et,bt=this.objectsList.length;for(Et=0;Et<bt;Et++)_t=this.objectsList[Et],dt.exists(_t.coords)&&(dt.evaluate(_t.visProp.frozen)?_t.coords.screen2usr():_t.coords.usr2screen());return this},moveOrigin:function(_t,Et,bt){return dt.exists(_t)&&dt.exists(Et)&&(this.origin.scrCoords[1]=_t,this.origin.scrCoords[2]=Et,bt&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(_t){var Et,bt,wt,Tt,Mt,Pt,It,Ot=[],Bt=`var el, x, y, c, rgbo;
`,Ut=_t.indexOf("<data>"),Ft=_t.indexOf("</data>"),jt=function(Gt,zt,$t,Ht){return function(){var er,Zt;er=Gt.select(zt.id),Zt=er.coords.usrCoords[Ht],Ht===2?er.setPositionDirectly(_e.COORDS_BY_USER,[$t(),Zt]):er.setPositionDirectly(_e.COORDS_BY_USER,[Zt,$t()]),er.prepareUpdate().update()}},Dt=function(Gt,zt,$t,Ht){return function(){var er,Zt;er=Gt.select(zt.id),Zt=$t(),Ht==="strokewidth"?er.visProp.strokewidth=Zt:(Zt=ht.rgba2rgbo(Zt),er.visProp[Ht+"color"]=Zt[0],er.visProp[Ht+"opacity"]=Zt[1])}};if(!(Ut<0)){for(;Ut>=0;){if(Et=_t.slice(Ut+6,Ft),bt=Et.indexOf("="),wt=Et.slice(0,bt),Tt=Et.slice(bt+1),bt=wt.indexOf("."),Mt=wt.slice(0,bt),Pt=this.elementsByName[dt.unescapeHTML(Mt)],It=wt.slice(bt+1).replace(/\s+/g,"").toLowerCase(),Tt=dt.createFunction(Tt,this,"",!0),dt.exists(this.elementsByName[Mt]))switch(Bt+='el = this.objects["'+Pt.id+`"];
`,It){case"x":Ot.push(jt(this,Pt,Tt,2));break;case"y":Ot.push(jt(this,Pt,Tt,1));break;case"visible":Ot.push(function(Gt,zt,$t){return function(){var Ht,er;Ht=Gt.select(zt.id),er=$t(),Ht.setAttribute({visible:er})}}(this,Pt,Tt));break;case"position":Ot.push(function(Gt,zt,$t){return function(){Gt.select(zt.id).position=$t()}}(this,Pt,Tt));break;case"stroke":Ot.push(Dt(this,Pt,Tt,"stroke"));break;case"style":Ot.push(function(Gt,zt,$t){return function(){Gt.select(zt.id).setStyle($t())}}(this,Pt,Tt));break;case"strokewidth":Ot.push(Dt(this,Pt,Tt,"strokewidth"));break;case"fill":Ot.push(Dt(this,Pt,Tt,"fill"));break;case"label":break;default:tt.debug("property '"+It+"' in conditions not yet implemented:"+Tt)}else tt.debug("debug conditions: |"+Mt+"| undefined");_t=_t.slice(Ft+7),Ut=_t.indexOf("<data>"),Ft=_t.indexOf("</data>")}this.updateConditions=function(){var Gt;for(Gt=0;Gt<Ot.length;Gt++)Ot[Gt]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var _t=new rt(_e.COORDS_BY_USER,[0,0],this),Et=new rt(_e.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),bt=_t.scrCoords[1]-Et.scrCoords[1],wt=_t.scrCoords[2]-Et.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(bt)>25;)this.options.grid.snapSizeX*=2,bt/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(wt)>25;)this.options.grid.snapSizeY*=2,wt/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(_t,Et){var bt=this.getBoundingBox(),wt=this.attr.zoom.factorx,Tt=this.attr.zoom.factory,Mt=(bt[2]-bt[0])*(1-1/wt),Pt=(bt[1]-bt[3])*(1-1/Tt),It=.5,Ot=.5,Bt=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&wt>1||this.zoomY>this.attr.zoom.max&&Tt>1||this.zoomX<Bt&&wt<1||this.zoomY<Bt&&Tt<1?this:(dt.isNumber(_t)&&dt.isNumber(Et)&&(It=(_t-bt[0])/(bt[2]-bt[0]),Ot=(bt[1]-Et)/(bt[1]-bt[3])),this.setBoundingBox([bt[0]+Mt*It,bt[1]-Pt*Ot,bt[2]-Mt*(1-It),bt[3]+Pt*(1-Ot)],!1),this.zoomX*=wt,this.zoomY*=Tt,this.applyZoom())},zoomOut:function(_t,Et){var bt=this.getBoundingBox(),wt=this.attr.zoom.factorx,Tt=this.attr.zoom.factory,Mt=(bt[2]-bt[0])*(1-wt),Pt=(bt[1]-bt[3])*(1-Tt),It=.5,Ot=.5,Bt=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<Bt||this.zoomY<Bt?this:(dt.isNumber(_t)&&dt.isNumber(Et)&&(It=(_t-bt[0])/(bt[2]-bt[0]),Ot=(bt[1]-Et)/(bt[1]-bt[3])),this.setBoundingBox([bt[0]+Mt*It,bt[1]-Pt*Ot,bt[2]-Mt*(1-It),bt[3]+Pt*(1-Ot)],!1),this.zoomX/=wt,this.zoomY/=Tt,this.applyZoom())},zoom100:function(){var _t=this.getBoundingBox(),Et=(_t[2]-_t[0])*(1-this.zoomX)*.5,bt=(_t[1]-_t[3])*(1-this.zoomY)*.5;return this.setBoundingBox([_t[0]+Et,_t[1]-bt,_t[2]-Et,_t[3]+bt],!1),this.zoomX=1,this.zoomY=1,this.applyZoom()},zoomAllPoints:function(){var _t,Et,bt,wt,Tt,Mt=0,Pt=0,It=0,Ot=0,Bt=this.objectsList.length;for(_t=0;_t<Bt;_t++)Tt=this.objectsList[_t],dt.isPoint(Tt)&&Tt.visPropCalc.visible&&(Tt.coords.usrCoords[1]<Mt?Mt=Tt.coords.usrCoords[1]:Tt.coords.usrCoords[1]>Pt&&(Pt=Tt.coords.usrCoords[1]),Tt.coords.usrCoords[2]>Ot?Ot=Tt.coords.usrCoords[2]:Tt.coords.usrCoords[2]<It&&(It=Tt.coords.usrCoords[2]));return Et=50,bt=Et/this.unitX,wt=Et/this.unitY,this.zoomX=1,this.zoomY=1,this.setBoundingBox([Mt-bt,Ot+wt,Pt+bt,It-wt],!0),this.applyZoom()},zoomElements:function(_t){var Et,bt,wt,Tt,Mt=[0,0,0,0],Pt=[1,-1,-1,1];if(!dt.isArray(_t)||_t.length===0)return this;for(Et=0;Et<_t.length;Et++)if(wt=this.select(_t[Et]),Tt=wt.bounds(),dt.isArray(Tt))if(dt.isArray(Mt))for(bt=0;bt<4;bt++)Pt[bt]*Tt[bt]<Pt[bt]*Mt[bt]&&(Mt[bt]=Tt[bt]);else Mt=Tt;if(dt.isArray(Mt)){for(bt=0;bt<4;bt++)Mt[bt]-=Pt[bt];this.zoomX=1,this.zoomY=1,this.setBoundingBox(Mt,!0)}return this},setZoom:function(_t,Et){var bt=this.attr.zoom.factorx,wt=this.attr.zoom.factory;return this.attr.zoom.factorx=_t/this.zoomX,this.attr.zoom.factory=Et/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=bt,this.attr.zoom.factory=wt,this},removeObject:function(_t){var Et,bt;if(dt.isArray(_t)){for(bt=0;bt<_t.length;bt++)this.removeObject(_t[bt]);return this}if(_t=this.select(_t),!dt.exists(_t)||dt.isString(_t))return this;try{for(Et in _t.childElements)_t.childElements.hasOwnProperty(Et)&&_t.childElements[Et].board.removeObject(_t.childElements[Et]);for(Et in _t.objects)_t.objects.hasOwnProperty(Et)&&_t.objects[Et].board.removeObject(_t.objects[Et]);for(Et in this.objects)this.objects.hasOwnProperty(Et)&&dt.exists(this.objects[Et].childElements)&&(delete this.objects[Et].childElements[_t.id],delete this.objects[Et].descendants[_t.id]);if(_t._pos>-1)for(this.objectsList.splice(_t._pos,1),Et=_t._pos;Et<this.objectsList.length;Et++)this.objectsList[Et]._pos--;else _t.type!==_e.OBJECT_TYPE_TURTLE&&tt.debug("Board.removeObject: object "+_t.id+" not found in list.");delete this.objects[_t.id],delete this.elementsByName[_t.name],_t.visProp&&dt.evaluate(_t.visProp.trace)&&_t.clearTrace(),dt.exists(_t.remove)&&_t.remove()}catch(wt){tt.debug(_t.id+": Could not be removed: "+wt)}return this.update(),this},removeAncestors:function(_t){var Et;for(Et in _t.ancestors)_t.ancestors.hasOwnProperty(Et)&&this.removeAncestors(_t.ancestors[Et]);return this.removeObject(_t),this},initGeonextBoard:function(){var _t,Et,bt;return _t=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),Et=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),bt=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[_t,Et],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[_t,bt],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(_t,Et,bt,wt){var Tt;return wt||(Tt=this.getBoundingBox()),this.canvasWidth=parseInt(_t,10),this.canvasHeight=parseInt(Et,10),bt||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),wt||this.setBoundingBox(Tt,this.keepaspectratio),this},showDependencies:function(){var _t,Et,bt,wt,Tt;Et=`<p>
`;for(_t in this.objects)if(this.objects.hasOwnProperty(_t)){Tt=0;for(bt in this.objects[_t].childElements)this.objects[_t].childElements.hasOwnProperty(bt)&&(Tt+=1);Tt>=0&&(Et+="<strong>"+this.objects[_t].id+":</strong> ");for(bt in this.objects[_t].childElements)this.objects[_t].childElements.hasOwnProperty(bt)&&(Et+=this.objects[_t].childElements[bt].id+"("+this.objects[_t].childElements[bt].name+"), ");Et+=`<p>
`}return Et+=`</p>
`,wt=window.open(),wt.document.open(),wt.document.write(Et),wt.document.close(),this},showXML:function(){var _t=window.open("");return _t.document.open(),_t.document.write("<pre>"+dt.escapeHTML(this.xmlString)+"</pre>"),_t.document.close(),this},prepareUpdate:function(){var _t,Et,bt=this.objectsList.length;for(_t=0;_t<bt;_t++)Et=this.objectsList[_t],Et.needsUpdate=Et.needsRegularUpdate||this.needsFullUpdate;for(_t in this.groups)this.groups.hasOwnProperty(_t)&&(Et=this.groups[_t],Et.needsUpdate=Et.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(_t){var Et,bt;for(_t=this.select(_t),Et=0;Et<this.objectsList.length;Et++)bt=this.objectsList[Et],bt.update(!dt.exists(_t)||bt.id!==_t.id).updateVisibility();for(Et in this.groups)this.groups.hasOwnProperty(Et)&&this.groups[Et].update(_t);return this},updateRenderer:function(){var _t,Et=this.objectsList.length;if(this.renderer.type==="canvas")this.updateRendererCanvas();else for(_t=0;_t<Et;_t++)this.objectsList[_t].updateRenderer();return this},updateRendererCanvas:function(){var _t,Et,bt,wt,Tt,Mt=this.objectsList.length,Pt=this.options.layer,It=this.options.layer.numlayers,Ot=Number.NEGATIVE_INFINITY;for(bt=0;bt<It;bt++){wt=Number.POSITIVE_INFINITY;for(Tt in Pt)Pt.hasOwnProperty(Tt)&&Pt[Tt]>Ot&&Pt[Tt]<wt&&(wt=Pt[Tt]);for(Ot=wt,_t=0;_t<Mt;_t++)Et=this.objectsList[_t],Et.visProp.layer===wt&&Et.prepareUpdate().updateRenderer()}return this},addHook:function(_t,Et,bt){return tt.deprecated("Board.addHook()","Board.on()"),Et=dt.def(Et,"update"),bt=dt.def(bt,this),this.hooks.push([Et,_t]),this.on(Et,_t,bt),this.hooks.length-1},addEvent:tt.shortcut(tt.Board.prototype,"on"),removeHook:function(_t){return tt.deprecated("Board.removeHook()","Board.off()"),this.hooks[_t]&&(this.off(this.hooks[_t][0],this.hooks[_t][1]),this.hooks[_t]=null),this},removeEvent:tt.shortcut(tt.Board.prototype,"off"),updateHooks:function(_t){var Et=Array.prototype.slice.call(arguments,0);return tt.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),Et[0]=dt.def(Et[0],"update"),this.triggerEventHandlers([Et[0]],arguments),this},addChild:function(_t){return dt.exists(_t)&&dt.exists(_t.containerObj)&&(this.dependentBoards.push(_t),this.update()),this},removeChild:function(_t){var Et;for(Et=this.dependentBoards.length-1;Et>=0;Et--)this.dependentBoards[Et]===_t&&this.dependentBoards.splice(Et,1);return this},update:function(_t){var Et,bt,wt,Tt;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,this.attr.minimizereflow==="all"&&this.containerObj&&this.renderer.type!=="vml"&&(Tt=this.renderer.removeToInsertLater(this.containerObj)),this.attr.minimizereflow==="svg"&&this.renderer.type==="svg"&&(Tt=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(_t).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),Tt&&Tt(),bt=this.dependentBoards.length,Et=0;Et<bt;Et++)wt=this.dependentBoards[Et],dt.exists(wt)&&wt!==this&&(wt.updateQuality=this.updateQuality,wt.prepareUpdate().updateElements().updateConditions(),wt.renderer.suspendRedraw(),wt.updateRenderer(),wt.renderer.unsuspendRedraw(),wt.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var _t;for(_t=0;_t<this.grids.length;_t++)this.removeObject(this.grids[_t]);return this.grids.length=0,this.update(),this},create:function(_t,Et,bt){var wt,Tt;for(_t=_t.toLowerCase(),dt.exists(Et)||(Et=[]),dt.exists(bt)||(bt={}),Tt=0;Tt<Et.length;Tt++)dt.isString(Et[Tt])&&(_t!=="text"||Tt!==2)&&(_t!=="input"&&_t!=="checkbox"&&_t!=="button"||Tt!==2&&Tt!==3)&&(Et[Tt]=this.select(Et[Tt]));if(!dt.isFunction(tt.elements[_t]))throw new Error("JSXGraph: create: Unknown element type given: "+_t);return wt=tt.elements[_t](this,Et,bt),dt.exists(wt)?(wt.prepareUpdate&&wt.update&&wt.updateRenderer&&wt.fullUpdate(),wt):(tt.debug("JSXGraph: create: failure creating "+_t),wt)},createElement:function(){return tt.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var _t;for(_t=0;_t<this.objectsList.length;_t++)this.objectsList[_t].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(_t,Et){var bt,wt,Tt=pt.getDimensions(this.container,this.document);return dt.isArray(_t)?(this.plainBB=_t,this.canvasWidth=parseInt(Tt.width,10),this.canvasHeight=parseInt(Tt.height,10),wt=this.canvasWidth,bt=this.canvasHeight,Et?(this.unitX=wt/(_t[2]-_t[0]),this.unitY=bt/(_t[1]-_t[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY):this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),this.keepaspectratio=!0):(this.unitX=wt/(_t[2]-_t[0]),this.unitY=bt/(_t[1]-_t[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*_t[0],this.unitY*_t[1]),this):this},getBoundingBox:function(){var _t=new rt(_e.COORDS_BY_SCREEN,[0,0],this),Et=new rt(_e.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[_t.usrCoords[1],_t.usrCoords[2],Et.usrCoords[1],Et.usrCoords[2]]},addAnimation:function(_t){var Et=this;return this.animationObjects[_t.id]=_t,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval(function(){Et.animate()},_t.board.attr.animationdelay)),this},stopAllAnimation:function(){var _t;for(_t in this.animationObjects)this.animationObjects.hasOwnProperty(_t)&&dt.exists(this.animationObjects[_t])&&(this.animationObjects[_t]=null,delete this.animationObjects[_t]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var _t,Et,bt,wt,Tt,Mt,Pt,It,Ot=0,Bt=null;for(Et in this.animationObjects)if(this.animationObjects.hasOwnProperty(Et)&&dt.exists(this.animationObjects[Et])){if(Ot+=1,bt=this.animationObjects[Et],bt.animationPath&&(wt=dt.isFunction(bt.animationPath)?bt.animationPath(new Date().getTime()-bt.animationStart):bt.animationPath.pop(),!dt.exists(wt)||!dt.isArray(wt)&&isNaN(wt)?delete bt.animationPath:(bt.setPositionDirectly(_e.COORDS_BY_USER,wt),bt.fullUpdate(),Bt=bt)),bt.animationData){Pt=0;for(Tt in bt.animationData)bt.animationData.hasOwnProperty(Tt)&&(Mt=bt.animationData[Tt].pop(),dt.exists(Mt)?(Pt+=1,_t={},_t[Tt]=Mt,bt.setAttribute(_t)):delete bt.animationData[Mt]);Pt===0&&delete bt.animationData}dt.exists(bt.animationData)||dt.exists(bt.animationPath)||(this.animationObjects[Et]=null,delete this.animationObjects[Et],dt.exists(bt.animationCallback)&&(It=bt.animationCallback,bt.animationCallback=null,It()))}return Ot===0?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(Bt),this},migratePoint:function(_t,Et,bt){var wt,Tt,Mt,Pt,It,Ot,Bt=!1;_t=this.select(_t),Et=this.select(Et),dt.exists(_t.label)&&(Ot=_t.label.id,Bt=!0,this.removeObject(_t.label));for(Tt in _t.childElements)if(_t.childElements.hasOwnProperty(Tt)){wt=_t.childElements[Tt],Pt=!1;for(Mt in wt)wt.hasOwnProperty(Mt)&&wt[Mt]===_t&&(wt[Mt]=Et,Pt=!0);for(Pt&&delete _t.childElements[Tt],It=0;It<wt.parents.length;It++)wt.parents[It]===_t.id&&(wt.parents[It]=Et.id);Et.addChild(wt)}return bt&&(Bt&&(delete Et.childElements[Ot],delete Et.descendants[Ot]),Et.label&&this.removeObject(Et.label),delete this.elementsByName[Et.name],Et.name=_t.name,Bt&&Et.createLabel()),this.removeObject(_t),dt.exists(Et.name)&&Et.name!==""&&(this.elementsByName[Et.name]=Et),this.fullUpdate(),this},emulateColorblindness:function(_t){var Et,bt;if(dt.exists(_t)||(_t="none"),this.currentCBDef===_t)return this;for(Et in this.objects)this.objects.hasOwnProperty(Et)&&(bt=this.objects[Et],_t!=="none"?(this.currentCBDef==="none"&&(bt.visPropOriginal={strokecolor:bt.visProp.strokecolor,fillcolor:bt.visProp.fillcolor,highlightstrokecolor:bt.visProp.highlightstrokecolor,highlightfillcolor:bt.visProp.highlightfillcolor}),bt.setAttribute({strokecolor:ht.rgb2cb(dt.evaluate(bt.visPropOriginal.strokecolor),_t),fillcolor:ht.rgb2cb(dt.evaluate(bt.visPropOriginal.fillcolor),_t),highlightstrokecolor:ht.rgb2cb(dt.evaluate(bt.visPropOriginal.highlightstrokecolor),_t),highlightfillcolor:ht.rgb2cb(dt.evaluate(bt.visPropOriginal.highlightfillcolor),_t)})):dt.exists(bt.visPropOriginal)&&tt.extend(bt.visProp,bt.visPropOriginal));return this.currentCBDef=_t,this.update(),this},select:function(_t){var Et,bt,wt,Tt,Mt=_t;if(Mt===null)return Mt;if(dt.isString(Mt)&&Mt!=="")dt.exists(this.objects[Mt])?Mt=this.objects[Mt]:dt.exists(this.elementsByName[Mt])?Mt=this.elementsByName[Mt]:dt.exists(this.groups[Mt])&&(Mt=this.groups[Mt]);else if(dt.isFunction(Mt)||dt.isObject(Mt)&&!dt.isFunction(Mt.setAttribute)){for(Et=dt.filterElements(this.objectsList,Mt),bt={},Tt=Et.length,wt=0;wt<Tt;wt++)bt[Et[wt].id]=Et[wt];Mt=new xt(bt)}else dt.isObject(Mt)&&dt.exists(Mt.id)&&!dt.exists(this.objects[Mt.id])&&(Mt=null);return Mt},hasPoint:function(_t,Et){var bt=_t,wt=Et,Tt=this.getBoundingBox();return dt.exists(_t)&&dt.isArray(_t.usrCoords)&&(bt=_t.usrCoords[1],wt=_t.usrCoords[2]),!!(dt.isNumber(bt)&&dt.isNumber(wt)&&Tt[0]<bt&&bt<Tt[2]&&Tt[1]>wt&&wt>Tt[3])},updateCSSTransforms:function(){var _t=this.containerObj,Et=_t,bt=_t;for(this.cssTransMat=pt.getCSSTransformMatrix(Et),Et=Et.offsetParent;Et;){for(this.cssTransMat=st.matMatMult(pt.getCSSTransformMatrix(Et),this.cssTransMat),bt=bt.parentNode;bt!==Et;)this.cssTransMat=st.matMatMult(pt.getCSSTransformMatrix(Et),this.cssTransMat),bt=bt.parentNode;Et=Et.offsetParent}return this.cssTransMat=st.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(_t){this.isSelecting=!0,this.selectingBox=[[_t[0],_t[1]],[_t[0],_t[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(_t){this.isSelecting&&(this.selectingBox[1]=[_t[0],_t[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(_t){var Et=this.getMousePosition(_t);this.isSelecting=!1,this.selectingBox[1]=[Et[0],Et[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var _t=this.selectingBox[0],Et=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(tt.COORDS_BY_SCREEN,[_t[0],_t[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(tt.COORDS_BY_SCREEN,[_t[0],Et[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(tt.COORDS_BY_SCREEN,[Et[0],Et[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(tt.COORDS_BY_SCREEN,[Et[0],_t[1]])},_testForSelection:function(_t){this._isRequiredKeyPressed(_t,"selection")&&(dt.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(_t){var Et;return dt.exists(this.selectionPolygon)||(Et=dt.copyAttributes(_t,nt,"board","selection"),Et.enabled===!0&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],Et))),this},__evt__down:function(_t){},__evt__mousedown:function(_t){},__evt__pointerdown:function(_t){},__evt__touchstart:function(_t){},__evt__up:function(_t){},__evt__mouseup:function(_t){},__evt__pointerup:function(_t){},__evt__touchend:function(_t){},__evt__move:function(_t,Et){},__evt__mousemove:function(_t,Et){},__evt__pointermove:function(_t,Et){},__evt__touchmove:function(_t,Et){},__evt__hit:function(_t,Et,bt){},__evt__mousehit:function(_t,Et,bt){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},createRoulette:function(_t,Et,bt,wt,Tt,Mt,Pt){var It=this;return new function(){var Ot,Bt=0,Ut=0,Ft=0,jt=bt,Dt=it.root(function(fr){var dr=_t.X(jt),gr=_t.Y(jt),Yt=Et.X(fr),xr=Et.Y(fr);return(dr-Yt)*(dr-Yt)+(gr-xr)*(gr-xr)},[0,2*Math.PI]),Gt=0,zt=0,$t=It.create("transform",[function(){return Bt}],{type:"rotate"}),Ht=It.create("transform",[function(){return Bt},function(){return _t.X(jt)},function(){return _t.Y(jt)}],{type:"rotate"}),er=It.create("transform",[function(){return Ut},function(){return Ft}],{type:"translate"}),Zt=function(fr,dr,gr){var Yt=it.D(fr.X)(dr),xr=it.D(fr.Y)(dr),vr=it.D(fr.X)(gr),Pr=it.D(fr.Y)(gr),Sr=it.D(fr.X)(.5*(dr+gr)),Qr=it.D(fr.Y)(.5*(dr+gr)),Ir=Math.sqrt(Yt*Yt+xr*xr),Dr=Math.sqrt(vr*vr+Pr*Pr);return(Ir+4*Math.sqrt(Sr*Sr+Qr*Qr)+Dr)*(gr-dr)/6},or=function(fr){return Ot-Zt(Et,Dt,fr)},Kt=Math.PI/18,rr=9*Kt,ur=null;return this.rolling=function(){var fr,dr,gr,Yt,xr;Gt=jt+Tt*wt,Ot=Zt(_t,jt,Gt),zt=it.root(or,Dt),fr=new lt(_t.X(Gt),_t.Y(Gt)),dr=new lt(Et.X(zt),Et.Y(zt)),gr=new lt(it.D(_t.X)(Gt),it.D(_t.Y)(Gt)),Yt=new lt(it.D(Et.X)(zt),it.D(Et.Y)(zt)),xr=lt.C.div(gr,Yt),Bt=Math.atan2(xr.imaginary,xr.real),xr.div(lt.C.abs(xr)),xr.mult(dr),Ut=fr.real-xr.real,Ft=fr.imaginary-xr.imaginary,Bt<-Kt&&Bt>-rr?(Bt=-Kt,Ht.applyOnce(Pt)):Bt>Kt&&Bt<rr?(Bt=Kt,Ht.applyOnce(Pt)):($t.applyOnce(Pt),er.applyOnce(Pt),jt=Gt,Dt=zt),It.update()},this.start=function(){return Mt>0&&(ur=window.setInterval(this.rolling,Mt)),this},this.stop=function(){return window.clearInterval(ur),this},this}}}),tt.Board}),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/env","utils/color","utils/base64","math/numerics"],function(tt,_e,rt,nt,it,st,ot,lt,at){return tt.SVGRenderer=function(ct,ut){var ht;for(this.type="svg",this.isIE=navigator.appVersion.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=ct,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.resize(ut.width,ut.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],ht=0;ht<_e.layer.numlayers;ht++)this.layer[ht]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[ht]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},tt.SVGRenderer.prototype=new rt,tt.extend(tt.SVGRenderer.prototype,{_createArrowHead:function(ct,ut){var ht,dt,ft=ct.id+"Triangle",pt=null,mt=it.evaluate(ct.visProp.firstarrow),gt=it.evaluate(ct.visProp.lastarrow);return it.exists(ut)&&(ft+=ut),ht=this.createPrim("marker",ft),ht.setAttributeNS(null,"stroke",it.evaluate(ct.visProp.strokecolor)),ht.setAttributeNS(null,"stroke-opacity",it.evaluate(ct.visProp.strokeopacity)),ht.setAttributeNS(null,"fill",it.evaluate(ct.visProp.strokecolor)),ht.setAttributeNS(null,"fill-opacity",it.evaluate(ct.visProp.strokeopacity)),ht.setAttributeNS(null,"stroke-width",0),ht.setAttributeNS(null,"orient","auto"),ht.setAttributeNS(null,"markerUnits","strokeWidth"),dt=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),ut==="End"?(tt.exists(mt.type)&&(pt=it.evaluate(mt.type)),ht.setAttributeNS(null,"refY",5),pt===2?(ht.setAttributeNS(null,"refX",4.9),dt.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z")):pt===3?(ht.setAttributeNS(null,"refX",3.33),dt.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(ht.setAttributeNS(null,"refX",9.9),dt.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"))):(tt.exists(gt.type)&&(pt=it.evaluate(gt.type)),ht.setAttributeNS(null,"refY",5),pt===2?(ht.setAttributeNS(null,"refX",5.1),dt.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z")):pt===3?(ht.setAttributeNS(null,"refX",.1),dt.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(ht.setAttributeNS(null,"refX",.1),dt.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"))),ht.appendChild(dt),ht},_setArrowColor:function(ct,ut,ht,dt){ct&&(it.isString(ut)&&this._setAttribute(function(){ct.setAttributeNS(null,"stroke",ut),ct.setAttributeNS(null,"fill",ut),ct.setAttributeNS(null,"stroke-opacity",ht),ct.setAttributeNS(null,"fill-opacity",ht)},dt.visPropOld.fillcolor),this.isIE&&dt.rendNode.parentNode.insertBefore(dt.rendNode,dt.rendNode))},_setArrowWidth:function(ct,ut,ht,dt){var ft,pt;ct&&(ut===0?ct.setAttributeNS(null,"display","none"):(ft=ut,pt=ft*dt,ct.setAttributeNS(null,"viewBox","0 0 "+10*ft+" "+10*ft),ct.setAttributeNS(null,"markerHeight",pt),ct.setAttributeNS(null,"markerWidth",pt),ct.setAttributeNS(null,"display","inherit")),this.isIE&&ht.parentNode.insertBefore(ht,ht))},updateTicks:function(ct){var ut,ht,dt,ft,pt,mt="",gt=ct.ticks.length;for(ut=0;ut<gt;ut++)ht=ct.ticks[ut],ft=ht[0],pt=ht[1],it.isNumber(ft[0])&&it.isNumber(ft[1])&&(mt+="M "+ft[0]+" "+pt[0]+" L "+ft[1]+" "+pt[1]+" ");dt=ct.rendNode,it.exists(dt)||(dt=this.createPrim("path",ct.id),this.appendChildPrim(dt,it.evaluate(ct.visProp.layer)),ct.rendNode=dt),dt.setAttributeNS(null,"stroke",it.evaluate(ct.visProp.strokecolor)),dt.setAttributeNS(null,"stroke-opacity",it.evaluate(ct.visProp.strokeopacity)),dt.setAttributeNS(null,"stroke-width",it.evaluate(ct.visProp.strokewidth)),this.updatePathPrim(dt,mt,ct.board)},displayCopyright:function(ct,ut){var ht,dt=this.createPrim("text","licenseText");dt.setAttributeNS(null,"x","20px"),dt.setAttributeNS(null,"y",2+ut+"px"),dt.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+ut+"px; fill:#356AA0;  opacity:0.3;"),ht=this.container.ownerDocument.createTextNode(ct),dt.appendChild(ht),this.appendChildPrim(dt,0)},drawInternalText:function(ct){var ut=this.createPrim("text",ct.id);return ut.style.whiteSpace="nowrap",ct.rendNodeText=this.container.ownerDocument.createTextNode(""),ut.appendChild(ct.rendNodeText),this.appendChildPrim(ut,it.evaluate(ct.visProp.layer)),ut},updateInternalText:function(ct){var ut,ht=ct.plaintext,dt=ct.getAnchorX(),ft=ct.getAnchorY();ct.rendNode.getAttributeNS(null,"class")!==ct.visProp.cssclass&&(ct.rendNode.setAttributeNS(null,"class",it.evaluate(ct.visProp.cssclass)),ct.needsSizeUpdate=!0),isNaN(ct.coords.scrCoords[1]+ct.coords.scrCoords[2])||(ut=ct.coords.scrCoords[1],ct.visPropOld.left!==dt+ut&&(ct.rendNode.setAttributeNS(null,"x",ut+"px"),dt==="left"?ct.rendNode.setAttributeNS(null,"text-anchor","start"):dt==="right"?ct.rendNode.setAttributeNS(null,"text-anchor","end"):dt==="middle"&&ct.rendNode.setAttributeNS(null,"text-anchor","middle"),ct.visPropOld.left=dt+ut),ut=ct.coords.scrCoords[2],ct.visPropOld.top!==ft+ut&&(ct.rendNode.setAttributeNS(null,"y",ut+.5*this.vOffsetText+"px"),ft==="bottom"?ct.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):ft==="top"?ct.rendNode.setAttributeNS(null,"dy","1.6ex"):ft==="middle"&&ct.rendNode.setAttributeNS(null,"dy","0.6ex"),ct.visPropOld.top=ft+ut)),ct.htmlStr!==ht&&(ct.rendNodeText.data=ht,ct.htmlStr=ht),this.transformImage(ct,ct.transformations)},updateInternalTextStyle:function(ct,ut,ht,dt){this.setObjectFillColor(ct,ut,ht)},drawImage:function(ct){var ut=this.createPrim("image",ct.id);ut.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(ut,it.evaluate(ct.visProp.layer)),ct.rendNode=ut,this.updateImage(ct)},transformImage:function(ct,ut){var ht,dt,ft=ct.rendNode,pt="";ut.length>0&&(dt=this.joinTransforms(ct,ut),ht=[dt[1][1],dt[2][1],dt[1][2],dt[2][2],dt[1][0],dt[2][0]].join(","),pt+=" matrix("+ht+") ",ft.setAttributeNS(null,"transform",pt))},updateImageURL:function(ct){var ut=it.evaluate(ct.url);ct.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",ut)},updateImageStyle:function(ct,ut){var ht=it.evaluate(ut?ct.visProp.highlightcssclass:ct.visProp.cssclass);ct.rendNode.setAttributeNS(null,"class",ht)},appendChildPrim:function(ct,ut){return it.exists(ut)?ut>=_e.layer.numlayers&&(ut=_e.layer.numlayers-1):ut=0,this.layer[ut].appendChild(ct),ct},createPrim:function(ct,ut){var ht=this.container.ownerDocument.createElementNS(this.svgNamespace,ct);return ht.setAttributeNS(null,"id",this.container.id+"_"+ut),ht.style.position="absolute",ct==="path"&&(ht.setAttributeNS(null,"stroke-linecap","round"),ht.setAttributeNS(null,"stroke-linejoin","round")),ht},remove:function(ct){it.exists(ct)&&it.exists(ct.parentNode)&&ct.parentNode.removeChild(ct)},makeArrows:function(ct){var ut,ht=it.evaluate(ct.visProp.firstarrow),dt=it.evaluate(ct.visProp.lastarrow);if(ct.visPropOld.firstarrow===ht&&ct.visPropOld.lastarrow===dt)return void(this.isIE&&ct.visPropCalc.visible&&(ht||dt)&&ct.rendNode.parentNode.insertBefore(ct.rendNode,ct.rendNode));ht?(ut=ct.rendNodeTriangleStart,it.exists(ut)?this.defs.appendChild(ut):(ut=this._createArrowHead(ct,"End"),this.defs.appendChild(ut),ct.rendNodeTriangleStart=ut,ct.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+ct.id+"TriangleEnd)"))):(ut=ct.rendNodeTriangleStart,it.exists(ut)&&this.remove(ut)),dt?(ut=ct.rendNodeTriangleEnd,it.exists(ut)?this.defs.appendChild(ut):(ut=this._createArrowHead(ct,"Start"),this.defs.appendChild(ut),ct.rendNodeTriangleEnd=ut,ct.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+ct.id+"TriangleStart)"))):(ut=ct.rendNodeTriangleEnd,it.exists(ut)&&this.remove(ut)),ct.visPropOld.firstarrow=ht,ct.visPropOld.lastarrow=dt},updateEllipsePrim:function(ct,ut,ht,dt,ft){var pt=1e6;pt=2e5,ut=Math.abs(ut)<pt?ut:pt*ut/Math.abs(ut),ht=Math.abs(ht)<pt?ht:pt*ht/Math.abs(ht),dt=Math.abs(dt)<pt?dt:pt*dt/Math.abs(dt),ft=Math.abs(ft)<pt?ft:pt*ft/Math.abs(ft),ct.setAttributeNS(null,"cx",ut),ct.setAttributeNS(null,"cy",ht),ct.setAttributeNS(null,"rx",Math.abs(dt)),ct.setAttributeNS(null,"ry",Math.abs(ft))},updateLinePrim:function(ct,ut,ht,dt,ft){var pt=1e6;pt=2e5,isNaN(ut+ht+dt+ft)||(ut=Math.abs(ut)<pt?ut:pt*ut/Math.abs(ut),ht=Math.abs(ht)<pt?ht:pt*ht/Math.abs(ht),dt=Math.abs(dt)<pt?dt:pt*dt/Math.abs(dt),ft=Math.abs(ft)<pt?ft:pt*ft/Math.abs(ft),ct.setAttributeNS(null,"x1",ut),ct.setAttributeNS(null,"y1",ht),ct.setAttributeNS(null,"x2",dt),ct.setAttributeNS(null,"y2",ft))},updatePathPrim:function(ct,ut){ut===""&&(ut="M 0 0"),ct.setAttributeNS(null,"d",ut)},updatePathStringPoint:function(ct,ut,ht){var dt="",ft=ct.coords.scrCoords,pt=ut*Math.sqrt(3)*.5,mt=.5*ut;return ht==="x"?dt=" M "+(ft[1]-ut)+" "+(ft[2]-ut)+" L "+(ft[1]+ut)+" "+(ft[2]+ut)+" M "+(ft[1]+ut)+" "+(ft[2]-ut)+" L "+(ft[1]-ut)+" "+(ft[2]+ut):ht==="+"?dt=" M "+(ft[1]-ut)+" "+ft[2]+" L "+(ft[1]+ut)+" "+ft[2]+" M "+ft[1]+" "+(ft[2]-ut)+" L "+ft[1]+" "+(ft[2]+ut):ht==="<>"?dt=" M "+(ft[1]-ut)+" "+ft[2]+" L "+ft[1]+" "+(ft[2]+ut)+" L "+(ft[1]+ut)+" "+ft[2]+" L "+ft[1]+" "+(ft[2]-ut)+" Z ":ht==="^"?dt=" M "+ft[1]+" "+(ft[2]-ut)+" L "+(ft[1]-pt)+" "+(ft[2]+mt)+" L "+(ft[1]+pt)+" "+(ft[2]+mt)+" Z ":ht==="v"?dt=" M "+ft[1]+" "+(ft[2]+ut)+" L "+(ft[1]-pt)+" "+(ft[2]-mt)+" L "+(ft[1]+pt)+" "+(ft[2]-mt)+" Z ":ht===">"?dt=" M "+(ft[1]+ut)+" "+ft[2]+" L "+(ft[1]-mt)+" "+(ft[2]-pt)+" L "+(ft[1]-mt)+" "+(ft[2]+pt)+" Z ":ht==="<"&&(dt=" M "+(ft[1]-ut)+" "+ft[2]+" L "+(ft[1]+mt)+" "+(ft[2]-pt)+" L "+(ft[1]+mt)+" "+(ft[2]+pt)+" Z "),dt},updatePathStringPrim:function(ct){var ut,ht,dt,ft=" M ",pt="";if(ct.numberPoints<=0)return"";if(dt=Math.min(ct.points.length,ct.numberPoints),ct.bezierDegree===1)for(ut=0;ut<dt;ut++)ht=ct.points[ut].scrCoords,isNaN(ht[1])||isNaN(ht[2])?ft=" M ":(ht[1]=Math.max(Math.min(ht[1],5e3),-5e3),ht[2]=Math.max(Math.min(ht[2],5e3),-5e3),pt+=ft+ht[1]+" "+ht[2],ft=" L ");else if(ct.bezierDegree===3)for(ut=0;ut<dt;)ht=ct.points[ut].scrCoords,isNaN(ht[1])||isNaN(ht[2])?ft=" M ":(pt+=ft+ht[1]+" "+ht[2],ft===" C "&&(ut+=1,ht=ct.points[ut].scrCoords,pt+=" "+ht[1]+" "+ht[2],ut+=1,ht=ct.points[ut].scrCoords,pt+=" "+ht[1]+" "+ht[2]),ft=" C "),ut+=1;return pt},updatePathStringBezierPrim:function(ct){var ut,ht,dt,ft,pt,mt,gt,vt=" M ",At="",yt=it.evaluate(ct.visProp.strokewidth),xt=it.evaluate(ct.visProp.curvetype)!=="plot";if(ct.numberPoints<=0)return"";for(xt&&ct.board.options.curve.RDPsmoothing&&(ct.points=at.RamerDouglasPeucker(ct.points,.5)),gt=Math.min(ct.points.length,ct.numberPoints),ht=1;ht<3;ht++)for(vt=" M ",ut=0;ut<gt;ut++)ft=ct.points[ut].scrCoords,isNaN(ft[1])||isNaN(ft[2])?vt=" M ":(ft[1]=Math.max(Math.min(ft[1],5e3),-5e3),ft[2]=Math.max(Math.min(ft[2],5e3),-5e3),vt===" M "?At+=vt+ft[1]+" "+ft[2]:(dt=2*ht,At+=[vt,pt+.333*(ft[1]-pt)+yt*(dt*Math.random()-ht)," ",mt+.333*(ft[2]-mt)+yt*(dt*Math.random()-ht)," ",pt+.666*(ft[1]-pt)+yt*(dt*Math.random()-ht)," ",mt+.666*(ft[2]-mt)+yt*(dt*Math.random()-ht)," ",ft[1]," ",ft[2]].join("")),vt=" C ",pt=ft[1],mt=ft[2]);return At},updatePolygonPrim:function(ct,ut){var ht,dt,ft="",pt=ut.vertices.length;for(ct.setAttributeNS(null,"stroke","none"),ht=0;ht<pt-1;ht++){if(!ut.vertices[ht].isReal)return void ct.setAttributeNS(null,"points","");dt=ut.vertices[ht].coords.scrCoords,ft=ft+dt[1]+","+dt[2],ht<pt-2&&(ft+=" ")}ft.indexOf("NaN")===-1&&ct.setAttributeNS(null,"points",ft)},updateRectPrim:function(ct,ut,ht,dt,ft){ct.setAttributeNS(null,"x",ut),ct.setAttributeNS(null,"y",ht),ct.setAttributeNS(null,"width",dt),ct.setAttributeNS(null,"height",ft)},setPropertyPrim:function(ct,ut,ht){ut!=="stroked"&&ct.setAttributeNS(null,ut,ht)},display:function(ct,ut){var ht;ct&&ct.rendNode&&(ct.visPropOld.visible=ut,ht=ct.rendNode,ut?(ht.setAttributeNS(null,"display","inline"),ht.style.visibility="inherit"):(ht.setAttributeNS(null,"display","none"),ht.style.visibility="hidden"))},show:function(ct){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(ct,!0)},hide:function(ct){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(ct,!1)},setBuffering:function(ct,ut){ct.rendNode.setAttribute("buffered-rendering",ut)},setDashStyle:function(ct){var ut=it.evaluate(ct.visProp.dash),ht=ct.rendNode;ut>0?ht.setAttributeNS(null,"stroke-dasharray",this.dashArray[ut-1]):ht.hasAttributeNS(null,"stroke-dasharray")&&ht.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(ct){var ut,ht,dt,ft,pt,mt,gt,vt,At,yt=ct.rendNode,xt=it.evaluate(ct.visProp.gradient);ht=it.evaluate(ct.visProp.fillopacity),ht=ht>0?ht:0,ut=it.evaluate(ct.visProp.fillcolor),xt==="linear"?(dt=this.createPrim("linearGradient",ct.id+"_gradient"),mt="0%",gt="100%",vt="0%",At="0%",dt.setAttributeNS(null,"x1",mt),dt.setAttributeNS(null,"x2",gt),dt.setAttributeNS(null,"y1",vt),dt.setAttributeNS(null,"y2",At),ft=this.createPrim("stop",ct.id+"_gradient1"),ft.setAttributeNS(null,"offset","0%"),ft.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),pt=this.createPrim("stop",ct.id+"_gradient2"),pt.setAttributeNS(null,"offset","100%"),pt.setAttributeNS(null,"style","stop-color:"+it.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+it.evaluate(ct.visProp.gradientsecondopacity)),dt.appendChild(ft),dt.appendChild(pt),this.defs.appendChild(dt),yt.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+ct.id+"_gradient)"),ct.gradNode1=ft,ct.gradNode2=pt):xt==="radial"?(dt=this.createPrim("radialGradient",ct.id+"_gradient"),dt.setAttributeNS(null,"cx","50%"),dt.setAttributeNS(null,"cy","50%"),dt.setAttributeNS(null,"r","50%"),dt.setAttributeNS(null,"fx",100*it.evaluate(ct.visProp.gradientpositionx)+"%"),dt.setAttributeNS(null,"fy",100*it.evaluate(ct.visProp.gradientpositiony)+"%"),ft=this.createPrim("stop",ct.id+"_gradient1"),ft.setAttributeNS(null,"offset","0%"),ft.setAttributeNS(null,"style","stop-color:"+it.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+it.evaluate(ct.visProp.gradientsecondopacity)),pt=this.createPrim("stop",ct.id+"_gradient2"),pt.setAttributeNS(null,"offset","100%"),pt.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),dt.appendChild(ft),dt.appendChild(pt),this.defs.appendChild(dt),yt.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+ct.id+"_gradient)"),ct.gradNode1=ft,ct.gradNode2=pt):yt.removeAttributeNS(null,"style")},updateGradient:function(ct){var ut,ht,dt=ct.gradNode1,ft=ct.gradNode2,pt=it.evaluate(ct.visProp.gradient);it.exists(dt)&&it.exists(ft)&&(ht=it.evaluate(ct.visProp.fillopacity),ht=ht>0?ht:0,ut=it.evaluate(ct.visProp.fillcolor),pt==="linear"?(dt.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),ft.setAttributeNS(null,"style","stop-color:"+it.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+it.evaluate(ct.visProp.gradientsecondopacity))):pt==="radial"&&(dt.setAttributeNS(null,"style","stop-color:"+it.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+it.evaluate(ct.visProp.gradientsecondopacity)),ft.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht)))},setObjectTransition:function(ct,ut){var ht,dt,ft,pt,mt=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(ut===void 0&&(ut=it.evaluate(ct.visProp.transitionduration)),ut!==ct.visPropOld.transitionduration){for(dt=ct.elementClass===nt.OBJECT_CLASS_TEXT&&it.evaluate(ct.visProp.display)==="html"?" color "+ut+"ms, opacity "+ut+"ms":" fill "+ut+"ms, fill-opacity "+ut+"ms, stroke "+ut+"ms, stroke-opacity "+ut+"ms",pt=mt.length,ft=0;ft<pt;++ft)ct[mt[ft]]&&(ht=ct[mt[ft]],ht.style.transition=dt);ct.visPropOld.transitionduration=ut}},_setAttribute:function(ct,ut){ut===""?ct():setTimeout(ct,1)},setObjectFillColor:function(ct,ut,ht,dt){var ft,pt,mt,gt,vt=it.evaluate(ut),At=it.evaluate(ht);At=At>0?At:0,ct.visPropOld.fillcolor===vt&&ct.visPropOld.fillopacity===At||(it.exists(vt)&&vt!==!1&&(vt.length!==9?(pt=vt,gt=At):(mt=ot.rgba2rgbo(vt),pt=mt[0],gt=At*mt[1]),ft=dt===void 0?ct.rendNode:dt,pt!=="none"&&this._setAttribute(function(){ft.setAttributeNS(null,"fill",pt)},ct.visPropOld.fillcolor),ct.type===tt.OBJECT_TYPE_IMAGE?this._setAttribute(function(){ft.setAttributeNS(null,"opacity",gt)},ct.visPropOld.fillopacity):(pt==="none"&&(gt=0),this._setAttribute(function(){ft.setAttributeNS(null,"fill-opacity",gt)},ct.visPropOld.fillopacity)),it.exists(ct.visProp.gradient)&&this.updateGradient(ct)),ct.visPropOld.fillcolor=vt,ct.visPropOld.fillopacity=At)},setObjectStrokeColor:function(ct,ut,ht){var dt,ft,pt,mt,gt=it.evaluate(ut),vt=it.evaluate(ht);vt=vt>0?vt:0,ct.visPropOld.strokecolor===gt&&ct.visPropOld.strokeopacity===vt||(it.exists(gt)&&gt!==!1&&(gt.length!==9?(dt=gt,pt=vt):(ft=ot.rgba2rgbo(gt),dt=ft[0],pt=vt*ft[1]),mt=ct.rendNode,ct.elementClass===nt.OBJECT_CLASS_TEXT?it.evaluate(ct.visProp.display)==="html"?this._setAttribute(function(){mt.style.color=dt,mt.style.opacity=pt},ct.visPropOld.strokecolor):this._setAttribute(function(){mt.setAttributeNS(null,"style","fill:"+dt),mt.setAttributeNS(null,"style","fill-opacity:"+pt)},ct.visPropOld.strokecolor):this._setAttribute(function(){mt.setAttributeNS(null,"stroke",dt),mt.setAttributeNS(null,"stroke-opacity",pt)},ct.visPropOld.strokecolor),ct.elementClass!==nt.OBJECT_CLASS_CURVE&&ct.elementClass!==nt.OBJECT_CLASS_LINE||(it.evaluate(ct.visProp.firstarrow)&&this._setArrowColor(ct.rendNodeTriangleStart,dt,pt,ct),it.evaluate(ct.visProp.lastarrow)&&this._setArrowColor(ct.rendNodeTriangleEnd,dt,pt,ct))),ct.visPropOld.strokecolor=gt,ct.visPropOld.strokeopacity=vt)},setObjectStrokeWidth:function(ct,ut){var ht,dt=it.evaluate(ut);isNaN(dt)||ct.visPropOld.strokewidth===dt||(ht=ct.rendNode,this.setPropertyPrim(ht,"stroked","true"),it.exists(dt)&&this.setPropertyPrim(ht,"stroke-width",dt+"px"),ct.visPropOld.strokewidth=dt)},setLineCap:function(ct){var ut=it.evaluate(ct.visProp.linecap);ut!==void 0&&ut!==""&&ct.visPropOld.linecap!==ut&&it.exists(ct.rendNode)&&(this.setPropertyPrim(ct.rendNode,"stroke-linecap",ut),ct.visPropOld.linecap=ut)},setShadow:function(ct){var ut=it.evaluate(ct.visProp.shadow);ct.visPropOld.shadow!==ut&&(it.exists(ct.rendNode)&&(ut?ct.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):ct.rendNode.removeAttributeNS(null,"filter")),ct.visPropOld.shadow=ut)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(ct,ut){this.svgRoot.style.width=parseFloat(ct)+"px",this.svgRoot.style.height=parseFloat(ut)+"px",this.svgRoot.setAttribute("width",parseFloat(ct)),this.svgRoot.setAttribute("height",parseFloat(ut))},createTouchpoints:function(ct){var ut,ht,dt,ft;for(this.touchpoints=[],ut=0;ut<ct;ut++)ht="touchpoint1_"+ut,ft=this.createPrim("path",ht),this.appendChildPrim(ft,19),ft.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(ft),this.setPropertyPrim(ft,"stroked","true"),this.setPropertyPrim(ft,"stroke-width","1px"),ft.setAttributeNS(null,"stroke","#000000"),ft.setAttributeNS(null,"stroke-opacity",1),ft.setAttributeNS(null,"display","none"),dt="touchpoint2_"+ut,ft=this.createPrim("ellipse",dt),this.appendChildPrim(ft,19),this.updateEllipsePrim(ft,0,0,0,0),this.touchpoints.push(ft),this.setPropertyPrim(ft,"stroked","true"),this.setPropertyPrim(ft,"stroke-width","1px"),ft.setAttributeNS(null,"stroke","#000000"),ft.setAttributeNS(null,"stroke-opacity",1),ft.setAttributeNS(null,"fill","#ffffff"),ft.setAttributeNS(null,"fill-opacity",0),ft.setAttributeNS(null,"display","none")},showTouchpoint:function(ct){this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(this.touchpoints[2*ct].setAttributeNS(null,"display","inline"),this.touchpoints[2*ct+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(ct){this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(this.touchpoints[2*ct].setAttributeNS(null,"display","none"),this.touchpoints[2*ct+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(ct,ut){var ht,dt;this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(ht=ut[0],dt=ut[1],this.touchpoints[2*ct].setAttributeNS(null,"d","M "+(ht-37)+" "+dt+" L "+(ht+37)+" "+dt+" M "+ht+" "+(dt-37)+" L "+ht+" "+(dt+37)),this.updateEllipsePrim(this.touchpoints[2*ct+1],ut[0],ut[1],25,25))},dumpToCanvas:function(ct,ut,ht,dt){var ft,pt,mt,gt,vt,At,yt,xt,_t=this.svgRoot,Et=window.btoa||lt.encode;if(this.container.hasChildNodes()&&it.exists(this.foreignObjLayer)){for(;_t.nextSibling;)this.foreignObjLayer.appendChild(_t.nextSibling);dt===!0&&(xt=this.container.ownerDocument,yt=xt.createElement("div"),yt.appendChild(this.foreignObjLayer))}if(_t.setAttribute("xmlns","http://www.w3.org/2000/svg"),vt=_t.getAttribute("width"),At=_t.getAttribute("height"),ft=new XMLSerializer().serializeToString(_t),(ft.match(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g)||[]).length>1&&(ft=ft.replace(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g,"")),ft=ft.replace(/&nbsp;/g," "),mt=document.getElementById(ct),mt.width=mt.width,gt=mt.getContext("2d"),ut!==void 0&&ht!==void 0&&(mt.style.width=parseFloat(ut)+"px",mt.style.height=parseFloat(ht)+"px",mt.setAttribute("width",2*parseFloat(vt)),mt.setAttribute("height",2*parseFloat(At)),gt.scale(2*vt/ut,2*At/ht)),pt=new Image,pt.src="data:image/svg+xml;base64,"+Et(unescape(encodeURIComponent(ft))),pt.onload=function(){setTimeout(function(){gt.drawImage(pt,0,0,ut,ht)},200)},it.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes())for(dt===!0&&_t.appendChild(this.foreignObjLayer);this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);return this},screenshot:function(ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt=this.container.ownerDocument,wt=this.container.parentNode,Tt=ct.attr.screenshot,Mt=!1;return this.type==="no"?this:(yt=Tt.scale*parseFloat(this.container.style.width),xt=Tt.scale*parseFloat(this.container.style.height),ut===void 0||ut===""?(Mt=!0,gt=new Image,gt.style.width=yt+"px",gt.style.height=xt+"px"):(Mt=!1,gt=bt.getElementById(ut)),Mt&&(dt=bt.createElement("div"),dt.style.cssText=Tt.css,dt.style.width=yt+"px",dt.style.height=xt+"px",dt.style.zIndex=this.container.style.zIndex+120,ft=ct.getCoordsTopLeftCorner(),dt.style.position="absolute",dt.style.left=ft[0]+"px",dt.style.top=ft[1]+"px"),pt=bt.createElement("canvas"),mt=Math.random().toString(36).substr(2,5),pt.setAttribute("id",mt),pt.setAttribute("width",yt),pt.setAttribute("height",xt),pt.style.width=yt+"px",pt.style.height=yt+"px",pt.style.display="none",wt.append(pt),Mt&&(vt=bt.createElement("span"),At=bt.createTextNode("✖"),vt.style.cssText=Tt.cssButton,vt.appendChild(At),vt.onclick=function(){dt.parentNode.removeChild(dt)},dt.appendChild(gt),dt.appendChild(vt),wt.appendChild(dt)),_t=document.getElementById(this.container.id+"_navigationbar"),it.exists(_t)&&(Et=_t.style.display,_t.style.display="none"),this.dumpToCanvas(mt,yt,xt,ht),setTimeout(function(){gt.src=pt.toDataURL("image/png"),wt.removeChild(pt)},400),it.exists(_t)&&(_t.style.display=Et),this)}}),tt.SVGRenderer}),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],function(tt,_e,rt,nt,it,st,ot){return tt.VMLRenderer=function(lt){this.type="vml",this.container=lt,this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,nt.exists(tt.vmlStylesheet)||(lt.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),tt.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),tt.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{lt.ownerDocument.namespaces.jxgvml||lt.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(at){return lt.ownerDocument.createElement("<jxgvml:"+at+' class="jxgvml">')}}catch{this.createNode=function(ct){return lt.ownerDocument.createElement("<"+ct+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},tt.VMLRenderer.prototype=new _e,tt.extend(tt.VMLRenderer.prototype,{_setAttr:function(lt,at,ct,ut){try{this.container.ownerDocument.documentMode===8?lt[at]=ct:lt.setAttribute(at,ct,ut)}catch{tt.debug("_setAttr: "+at+" "+ct+`<br>
`)}},updateTicks:function(lt){var at,ct,ut,ht,dt,ft=this.resolution,pt=[];for(ct=lt.ticks.length,at=0;at<ct;at++)ut=lt.ticks[at],ht=ut[0],dt=ut[1],nt.isNumber(ht[0])&&nt.isNumber(ht[1])&&pt.push(" m "+Math.round(ft*ht[0])+", "+Math.round(ft*dt[0])+" l "+Math.round(ft*ht[1])+", "+Math.round(ft*dt[1])+" ");nt.exists(lt.rendNode)||(lt.rendNode=this.createPrim("path",lt.id),this.appendChildPrim(lt.rendNode,nt.evaluate(lt.visProp.layer))),this._setAttr(lt.rendNode,"stroked","true"),this._setAttr(lt.rendNode,"strokecolor",nt.evaluate(lt.visProp.strokecolor),1),this._setAttr(lt.rendNode,"strokeweight",nt.evaluate(lt.visProp.strokewidth)),this._setAttr(lt.rendNodeStroke,"opacity",100*nt.evaluate(lt.visProp.strokeopacity)+"%"),this.updatePathPrim(lt.rendNode,pt,lt.board)},displayCopyright:function(lt,at){var ct,ut;ct=this.createNode("textbox"),ct.style.position="absolute",this._setAttr(ct,"id",this.container.id+"_licenseText"),ct.style.left=20,ct.style.top=2,ct.style.fontSize=at,ct.style.color="#356AA0",ct.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(ct,"opacity","30%"),ct.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",ut=this.container.ownerDocument.createTextNode(lt),ct.appendChild(ut),this.appendChildPrim(ct,0)},drawInternalText:function(lt){var at;return at=this.createNode("textbox"),at.style.position="absolute",lt.rendNodeText=this.container.ownerDocument.createTextNode(""),at.appendChild(lt.rendNodeText),this.appendChildPrim(at,9),at.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",at},updateInternalText:function(lt){var at,ct,ut,ht,dt,ft,pt=lt.plaintext,mt=this.joinTransforms(lt,lt.transformations),gt=[0,0],vt=lt.rendNode,At=[],yt=lt.getAnchorX(),xt=lt.getAnchorY();if(!isNaN(lt.coords.scrCoords[1]+lt.coords.scrCoords[2])){for(yt==="right"?gt[0]=1:yt==="middle"&&(gt[0]=.5),xt==="bottom"?gt[1]=1:xt==="middle"&&(gt[1]=.5),At[0]=st.matVecMult(mt,[1,lt.coords.scrCoords[1]-gt[0]*lt.size[0],lt.coords.scrCoords[2]+(1-gt[1])*lt.size[1]+this.vOffsetText]),At[0][1]/=At[0][0],At[0][2]/=At[0][0],At[1]=st.matVecMult(mt,[1,lt.coords.scrCoords[1]+(1-gt[0])*lt.size[0],lt.coords.scrCoords[2]+(1-gt[1])*lt.size[1]+this.vOffsetText]),At[1][1]/=At[1][0],At[1][2]/=At[1][0],At[2]=st.matVecMult(mt,[1,lt.coords.scrCoords[1]+(1-gt[0])*lt.size[0],lt.coords.scrCoords[2]-gt[1]*lt.size[1]+this.vOffsetText]),At[2][1]/=At[2][0],At[2][2]/=At[2][0],At[3]=st.matVecMult(mt,[1,lt.coords.scrCoords[1]-gt[0]*lt.size[0],lt.coords.scrCoords[2]-gt[1]*lt.size[1]+this.vOffsetText]),At[3][1]/=At[3][0],At[3][2]/=At[3][0],ct=At[0][1],ht=At[0][1],ut=At[0][2],dt=At[0][2],ft=1;ft<4;ft++)ct=Math.max(ct,At[ft][1]),ht=Math.min(ht,At[ft][1]),ut=Math.max(ut,At[ft][2]),dt=Math.min(dt,At[ft][2]);at=gt[0]===1?Math.floor(lt.board.canvasWidth-ct):Math.floor(ht),lt.visPropOld.left!==yt+at&&(gt[0]===1?(lt.rendNode.style.right=at+"px",lt.rendNode.style.left="auto"):(lt.rendNode.style.left=at+"px",lt.rendNode.style.right="auto"),lt.visPropOld.left=yt+at),at=gt[1]===1?Math.floor(lt.board.canvasHeight-ut):Math.floor(dt),lt.visPropOld.top!==xt+at&&(gt[1]===1?(lt.rendNode.style.bottom=at+"px",lt.rendNode.style.top="auto"):(lt.rendNode.style.top=at+"px",lt.rendNode.style.bottom="auto"),lt.visPropOld.top=xt+at)}lt.htmlStr!==pt&&(lt.rendNodeText.data=pt,lt.htmlStr=pt),vt.filters.item(0).M11=mt[1][1],vt.filters.item(0).M12=mt[1][2],vt.filters.item(0).M21=mt[2][1],vt.filters.item(0).M22=mt[2][2],vt.filters.item(0).enabled=!0},drawImage:function(lt){var at;at=this.container.ownerDocument.createElement("img"),at.style.position="absolute",this._setAttr(at,"id",this.container.id+"_"+lt.id),this.container.appendChild(at),this.appendChildPrim(at,nt.evaluate(lt.visProp.layer)),at.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",lt.rendNode=at,this.updateImage(lt)},transformImage:function(lt,at){var ct,ut,ht,dt,ft,pt,mt=lt.rendNode,gt=[];if(at.length>0){for(ct=this.joinTransforms(lt,at),gt[0]=st.matVecMult(ct,lt.coords.scrCoords),gt[0][1]/=gt[0][0],gt[0][2]/=gt[0][0],gt[1]=st.matVecMult(ct,[1,lt.coords.scrCoords[1]+lt.size[0],lt.coords.scrCoords[2]]),gt[1][1]/=gt[1][0],gt[1][2]/=gt[1][0],gt[2]=st.matVecMult(ct,[1,lt.coords.scrCoords[1]+lt.size[0],lt.coords.scrCoords[2]-lt.size[1]]),gt[2][1]/=gt[2][0],gt[2][2]/=gt[2][0],gt[3]=st.matVecMult(ct,[1,lt.coords.scrCoords[1],lt.coords.scrCoords[2]-lt.size[1]]),gt[3][1]/=gt[3][0],gt[3][2]/=gt[3][0],ut=gt[0][1],dt=gt[0][1],ht=gt[0][2],ft=gt[0][2],pt=1;pt<4;pt++)ut=Math.max(ut,gt[pt][1]),dt=Math.min(dt,gt[pt][1]),ht=Math.max(ht,gt[pt][2]),ft=Math.min(ft,gt[pt][2]);mt.style.left=Math.floor(dt)+"px",mt.style.top=Math.floor(ft)+"px",mt.filters.item(0).M11=ct[1][1],mt.filters.item(0).M12=ct[1][2],mt.filters.item(0).M21=ct[2][1],mt.filters.item(0).M22=ct[2][2],mt.filters.item(0).enabled=!0}},updateImageURL:function(lt){var at=nt.evaluate(lt.url);this._setAttr(lt.rendNode,"src",at)},appendChildPrim:function(lt,at){return nt.exists(at)||(at=0),lt.style.zIndex=at,this.container.appendChild(lt),lt},appendNodesToElement:function(lt,at){at!=="shape"&&at!=="path"&&at!=="polygon"||(lt.rendNodePath=this.getElementById(lt.id+"_path")),lt.rendNodeFill=this.getElementById(lt.id+"_fill"),lt.rendNodeStroke=this.getElementById(lt.id+"_stroke"),lt.rendNodeShadow=this.getElementById(lt.id+"_shadow"),lt.rendNode=this.getElementById(lt.id)},createPrim:function(lt,at){var ct,ut,ht=this.createNode("fill"),dt=this.createNode("stroke"),ft=this.createNode("shadow");return this._setAttr(ht,"id",this.container.id+"_"+at+"_fill"),this._setAttr(dt,"id",this.container.id+"_"+at+"_stroke"),this._setAttr(ft,"id",this.container.id+"_"+at+"_shadow"),lt==="circle"||lt==="ellipse"?(ct=this.createNode("oval"),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(ft)):lt==="polygon"||lt==="path"||lt==="shape"||lt==="line"?(ct=this.createNode("shape"),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(ft),ut=this.createNode("path"),this._setAttr(ut,"id",this.container.id+"_"+at+"_path"),ct.appendChild(ut)):(ct=this.createNode(lt),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(ft)),ct.style.position="absolute",ct.style.left="0px",ct.style.top="0px",this._setAttr(ct,"id",this.container.id+"_"+at),ct},remove:function(lt){nt.exists(lt)&&lt.removeNode(!0)},makeArrows:function(lt){var at,ct=nt.evaluate(lt.visProp.firstarrow),ut=nt.evaluate(lt.visProp.lastarrow);lt.visPropOld.firstarrow===ct&&lt.visPropOld.lastarrow===ut||(ct?(at=lt.rendNodeStroke,this._setAttr(at,"startarrow","block"),this._setAttr(at,"startarrowlength","long")):(at=lt.rendNodeStroke,nt.exists(at)&&this._setAttr(at,"startarrow","none")),ut?(at=lt.rendNodeStroke,this._setAttr(at,"id",this.container.id+"_"+lt.id+"stroke"),this._setAttr(at,"endarrow","block"),this._setAttr(at,"endarrowlength","long")):(at=lt.rendNodeStroke,nt.exists(at)&&this._setAttr(at,"endarrow","none")),lt.visPropOld.firstarrow=ct,lt.visPropOld.lastarrow=ut)},updateEllipsePrim:function(lt,at,ct,ut,ht){lt.style.left=Math.floor(at-ut)+"px",lt.style.top=Math.floor(ct-ht)+"px",lt.style.width=Math.floor(2*Math.abs(ut))+"px",lt.style.height=Math.floor(2*Math.abs(ht))+"px"},updateLinePrim:function(lt,at,ct,ut,ht,dt){var ft,pt=this.resolution;isNaN(at+ct+ut+ht)||(ft=["m ",Math.floor(pt*at),", ",Math.floor(pt*ct)," l ",Math.floor(pt*ut),", ",Math.floor(pt*ht)],this.updatePathPrim(lt,ft,dt))},updatePathPrim:function(lt,at,ct){var ut=ct.canvasWidth,ht=ct.canvasHeight;at.length<=0&&(at=["m 0,0"]),lt.style.width=ut,lt.style.height=ht,this._setAttr(lt,"coordsize",[Math.floor(this.resolution*ut),Math.floor(this.resolution*ht)].join(",")),this._setAttr(lt,"path",at.join(""))},updatePathStringPoint:function(lt,at,ct){var ut=[],ht=Math.round,dt=lt.coords.scrCoords,ft=at*Math.sqrt(3)*.5,pt=.5*at,mt=this.resolution;return ct==="x"?ut.push([" m ",ht(mt*(dt[1]-at)),", ",ht(mt*(dt[2]-at))," l ",ht(mt*(dt[1]+at)),", ",ht(mt*(dt[2]+at))," m ",ht(mt*(dt[1]+at)),", ",ht(mt*(dt[2]-at))," l ",ht(mt*(dt[1]-at)),", ",ht(mt*(dt[2]+at))].join("")):ct==="+"?ut.push([" m ",ht(mt*(dt[1]-at)),", ",ht(mt*dt[2])," l ",ht(mt*(dt[1]+at)),", ",ht(mt*dt[2])," m ",ht(mt*dt[1]),", ",ht(mt*(dt[2]-at))," l ",ht(mt*dt[1]),", ",ht(mt*(dt[2]+at))].join("")):ct==="<>"?ut.push([" m ",ht(mt*(dt[1]-at)),", ",ht(mt*dt[2])," l ",ht(mt*dt[1]),", ",ht(mt*(dt[2]+at))," l ",ht(mt*(dt[1]+at)),", ",ht(mt*dt[2])," l ",ht(mt*dt[1]),", ",ht(mt*(dt[2]-at))," x e "].join("")):ct==="^"?ut.push([" m ",ht(mt*dt[1]),", ",ht(mt*(dt[2]-at))," l ",ht(mt*(dt[1]-ft)),", ",ht(mt*(dt[2]+pt))," l ",ht(mt*(dt[1]+ft)),", ",ht(mt*(dt[2]+pt))," x e "].join("")):ct==="v"?ut.push([" m ",ht(mt*dt[1]),", ",ht(mt*(dt[2]+at))," l ",ht(mt*(dt[1]-ft)),", ",ht(mt*(dt[2]-pt))," l ",ht(mt*(dt[1]+ft)),", ",ht(mt*(dt[2]-pt))," x e "].join("")):ct===">"?ut.push([" m ",ht(mt*(dt[1]+at)),", ",ht(mt*dt[2])," l ",ht(mt*(dt[1]-pt)),", ",ht(mt*(dt[2]-ft))," l ",ht(mt*(dt[1]-pt)),", ",ht(mt*(dt[2]+ft))," l ",ht(mt*(dt[1]+at)),", ",ht(mt*dt[2])].join("")):ct==="<"&&ut.push([" m ",ht(mt*(dt[1]-at)),", ",ht(mt*dt[2])," l ",ht(mt*(dt[1]+pt)),", ",ht(mt*(dt[2]-ft))," l ",ht(mt*(dt[1]+pt)),", ",ht(mt*(dt[2]+ft))," x e "].join("")),ut},updatePathStringPrim:function(lt){var at,ct,ut=[],ht=this.resolution,dt=Math.round,ft=" m ",pt=Math.min(lt.numberPoints,8192);if(lt.numberPoints<=0)return"";if(pt=Math.min(pt,lt.points.length),lt.bezierDegree===1)for(at=0;at<pt;at++)ct=lt.points[at].scrCoords,isNaN(ct[1])||isNaN(ct[2])?ft=" m ":(ct[1]>2e4?ct[1]=2e4:ct[1]<-2e4&&(ct[1]=-2e4),ct[2]>2e4?ct[2]=2e4:ct[2]<-2e4&&(ct[2]=-2e4),ut.push([ft,dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),ft=" l ");else if(lt.bezierDegree===3)for(at=0;at<pt;)ct=lt.points[at].scrCoords,isNaN(ct[1])||isNaN(ct[2])?ft=" m ":(ut.push([ft,dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),ft===" c "&&(at+=1,ct=lt.points[at].scrCoords,ut.push([" ",dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),at+=1,ct=lt.points[at].scrCoords,ut.push([" ",dt(ht*ct[1]),", ",dt(ht*ct[2])].join(""))),ft=" c "),at+=1;return ut.push(" e"),ut},updatePathStringBezierPrim:function(lt){var at,ct,ut,ht,dt,ft,pt=[],mt=nt.evaluate(lt.visProp.strokewidth),gt=this.resolution,vt=Math.round,At=" m ",yt=nt.evaluate(lt.visProp.curvetype)!=="plot",xt=Math.min(lt.numberPoints,8192);if(lt.numberPoints<=0)return"";for(yt&&lt.board.options.curve.RDPsmoothing&&(lt.points=ot.RamerDouglasPeucker(lt.points,1)),xt=Math.min(xt,lt.points.length),ct=1;ct<3;ct++)for(At=" m ",at=0;at<xt;at++)ht=lt.points[at].scrCoords,isNaN(ht[1])||isNaN(ht[2])?At=" m ":(ht[1]>2e4?ht[1]=2e4:ht[1]<-2e4&&(ht[1]=-2e4),ht[2]>2e4?ht[2]=2e4:ht[2]<-2e4&&(ht[2]=-2e4),At===" m "?pt.push([At,vt(gt*ht[1])," ",vt(gt*ht[2])].join("")):(ut=2*ct,pt.push([At,vt(gt*(dt+.333*(ht[1]-dt)+mt*(ut*Math.random()-ct)))," ",vt(gt*(ft+.333*(ht[2]-ft)+mt*(ut*Math.random()-ct)))," ",vt(gt*(dt+.666*(ht[1]-dt)+mt*(ut*Math.random()-ct)))," ",vt(gt*(ft+.666*(ht[2]-ft)+mt*(ut*Math.random()-ct)))," ",vt(gt*ht[1])," ",vt(gt*ht[2])].join(""))),At=" c ",dt=ht[1],ft=ht[2]);return pt.push(" e"),pt},updatePolygonPrim:function(lt,at){var ct,ut,ht=at.vertices.length,dt=this.resolution,ft=[];if(this._setAttr(lt,"stroked","false"),ut=at.vertices[0].coords.scrCoords,!isNaN(ut[1]+ut[2])){for(ft.push(["m ",Math.floor(dt*ut[1]),",",Math.floor(dt*ut[2])," l "].join("")),ct=1;ct<ht-1;ct++){if(!at.vertices[ct].isReal)return void this.updatePathPrim(lt,"",at.board);if(ut=at.vertices[ct].coords.scrCoords,isNaN(ut[1]+ut[2]))return;ft.push(Math.floor(dt*ut[1])+","+Math.floor(dt*ut[2])),ct<ht-2&&ft.push(", ")}ft.push(" x e"),this.updatePathPrim(lt,ft,at.board)}},updateRectPrim:function(lt,at,ct,ut,ht){lt.style.left=Math.floor(at)+"px",lt.style.top=Math.floor(ct)+"px",ut>=0&&(lt.style.width=ut+"px"),ht>=0&&(lt.style.height=ht+"px")},setPropertyPrim:function(lt,at,ct){var ut,ht="";switch(at){case"stroke":ht="strokecolor";break;case"stroke-width":ht="strokeweight";break;case"stroke-dasharray":ht="dashstyle"}ht!==""&&(ut=nt.evaluate(ct),this._setAttr(lt,ht,ut))},display:function(lt,at){lt&&lt.rendNode&&(lt.visPropOld.visible=at,lt.rendNode.style.visibility=at?"inherit":"hidden")},show:function(lt){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),lt&&lt.rendNode&&(lt.rendNode.style.visibility="inherit")},hide:function(lt){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),lt&&lt.rendNode&&(lt.rendNode.style.visibility="hidden")},setDashStyle:function(lt,at){var ct;at.dash>=0&&(ct=lt.rendNodeStroke,this._setAttr(ct,"dashstyle",this.dashArray[at.dash]))},setGradient:function(lt){var at=lt.rendNodeFill,ct=nt.evaluate(lt.visProp.gradient);ct==="linear"?(this._setAttr(at,"type","gradient"),this._setAttr(at,"color2",nt.evaluate(lt.visProp.gradientsecondcolor)),this._setAttr(at,"opacity2",nt.evaluate(lt.visProp.gradientsecondopacity)),this._setAttr(at,"angle",nt.evaluate(lt.visProp.gradientangle))):ct==="radial"?(this._setAttr(at,"type","gradientradial"),this._setAttr(at,"color2",nt.evaluate(lt.visProp.gradientsecondcolor)),this._setAttr(at,"opacity2",nt.evaluate(lt.visProp.gradientsecondopacity)),this._setAttr(at,"focusposition",100*nt.evaluate(lt.visProp.gradientpositionx)+"%,"+100*nt.evaluate(lt.visProp.gradientpositiony)+"%"),this._setAttr(at,"focussize","0,0")):this._setAttr(at,"type","solid")},setObjectFillColor:function(lt,at,ct){var ut,ht,dt,ft=nt.evaluate(at),pt=nt.evaluate(ct),mt=lt.rendNode;pt=pt>0?pt:0,lt.visPropOld.fillcolor===ft&&lt.visPropOld.fillopacity===pt||(nt.exists(ft)&&ft!==!1&&(ft.length!==9?(ut=ft,dt=pt):(ht=it.rgba2rgbo(ft),ut=ht[0],dt=pt*ht[1]),ut==="none"||ut===!1?this._setAttr(lt.rendNode,"filled","false"):(this._setAttr(lt.rendNode,"filled","true"),this._setAttr(lt.rendNode,"fillcolor",ut),nt.exists(dt)&&lt.rendNodeFill&&this._setAttr(lt.rendNodeFill,"opacity",100*dt+"%")),lt.type===rt.OBJECT_TYPE_IMAGE&&mt.filters.length>1&&(mt.filters.item(1).opacity=Math.round(100*dt),mt.filters.item(1).enabled=!0)),lt.visPropOld.fillcolor=ft,lt.visPropOld.fillopacity=pt)},setObjectStrokeColor:function(lt,at,ct){var ut,ht,dt,ft,pt=nt.evaluate(at),mt=nt.evaluate(ct),gt=lt.rendNode;mt=mt>0?mt:0,lt.visPropOld.strokecolor===pt&&lt.visPropOld.strokeopacity===mt||(nt.exists(pt)&&pt!==!1&&(pt.length!==9?(ut=pt,dt=mt):(ht=at.rgba2rgbo(pt),ut=ht[0],dt=mt*ht[1]),lt.elementClass===rt.OBJECT_CLASS_TEXT?(gt.filters.length>1&&(gt.filters.item(1).opacity=Math.round(100*dt),gt.filters.item(1).enabled=!0),gt.style.color=ut):(ut!==!1&&(this._setAttr(gt,"stroked","true"),this._setAttr(gt,"strokecolor",ut)),ft=lt.rendNodeStroke,nt.exists(dt)&&lt.type!==rt.OBJECT_TYPE_IMAGE&&this._setAttr(ft,"opacity",100*dt+"%"))),lt.visPropOld.strokecolor=pt,lt.visPropOld.strokeopacity=mt)},setObjectStrokeWidth:function(lt,at){var ct,ut=nt.evaluate(at);isNaN(ut)||lt.visPropOld.strokewidth===ut||(ct=lt.rendNode,this.setPropertyPrim(ct,"stroked","true"),nt.exists(ut)&&(this.setPropertyPrim(ct,"stroke-width",ut),ut===0&&nt.exists(lt.rendNodeStroke)&&this._setAttr(ct,"stroked","false")),lt.visPropOld.strokewidth=ut)},setShadow:function(lt){var at=lt.rendNodeShadow,ct=nt.evaluate(lt.visProp.shadow);at&&lt.visPropOld.shadow!==ct&&(ct?(this._setAttr(at,"On","True"),this._setAttr(at,"Offset","3pt,3pt"),this._setAttr(at,"Opacity","60%"),this._setAttr(at,"Color","#aaaaaa")):this._setAttr(at,"On","False"),lt.visPropOld.shadow=ct)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),tt.VMLRenderer}),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut){return tt.CanvasRenderer=function(ht,dt){this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=st.genUUID(),this.canvasNamespace=null,nt.isBrowser?(this.container=ht,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',dt.width,'px" height="',dt.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.context=this.canvasRoot.getContext("2d")):nt.isNode()&&(this.canvasId=module.require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")),this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},tt.CanvasRenderer.prototype=new _e,tt.extend(tt.CanvasRenderer.prototype,{_drawFilledPolygon:function(ht){var dt,ft=ht.length,pt=this.context;if(ft>0){for(pt.beginPath(),pt.moveTo(ht[0][0],ht[0][1]),dt=0;dt<ft;dt++)dt>0&&pt.lineTo(ht[dt][0],ht[dt][1]);pt.lineTo(ht[0][0],ht[0][1]),pt.fill()}},_fill:function(ht){var dt=this.context;dt.save(),this._setColor(ht,"fill")&&dt.fill(),dt.restore()},_rotatePoint:function(ht,dt,ft){return[dt*Math.cos(ht)-ft*Math.sin(ht),dt*Math.sin(ht)+ft*Math.cos(ht)]},_rotateShape:function(ht,dt){var ft,pt=[],mt=ht.length;if(mt<=0)return ht;for(ft=0;ft<mt;ft++)pt.push(this._rotatePoint(dt,ht[ft][0],ht[ft][1]));return pt},_setColor:function(ht,dt,ft){var pt,mt,gt,vt,At,yt,xt,_t=!0,Et=!1,bt=ht.visProp;return dt=dt||"stroke",ft=ft||dt,it.exists(ht.board)&&it.exists(ht.board.highlightedObjects)||(Et=!0),pt=!Et&&it.exists(ht.board.highlightedObjects[ht.id])?"highlight":"",gt=it.evaluate(bt[pt+dt+"color"]),gt!=="none"&&gt!==!1?(yt=it.evaluate(bt[pt+dt+"opacity"]),yt=yt>0?yt:0,gt.length!==9?(At=gt,xt=yt):(vt=ot.rgba2rgbo(gt),At=vt[0],xt=yt*vt[1]),this.context.globalAlpha=xt,this.context[ft+"Style"]=At):_t=!1,mt=parseFloat(it.evaluate(bt.strokewidth)),dt!=="stroke"||isNaN(mt)||(mt===0?this.context.globalAlpha=0:this.context.lineWidth=mt),dt==="stroke"&&bt.linecap!==void 0&&bt.linecap!==""&&(this.context.lineCap=bt.linecap),_t},_stroke:function(ht){var dt=this.context,ft=it.evaluate(ht.visProp.dash);dt.save(),ft>0?dt.setLineDash&&dt.setLineDash(this.dashArray[ft]):this.context.lineDashArray=[],this._setColor(ht,"stroke")&&dt.stroke(),dt.restore()},_translateShape:function(ht,dt,ft){var pt,mt=[],gt=ht.length;if(gt<=0)return ht;for(pt=0;pt<gt;pt++)mt.push([ht[pt][0]+dt,ht[pt][1]+ft]);return mt},drawPoint:function(ht){var dt=it.evaluate(ht.visProp.face),ft=it.evaluate(ht.visProp.size),pt=ht.coords.scrCoords,mt=ft*Math.sqrt(3)*.5,gt=.5*ft,vt=parseFloat(it.evaluate(ht.visProp.strokewidth))/2,At=this.context;if(ht.visPropCalc.visible)switch(dt){case"cross":case"x":At.beginPath(),At.moveTo(pt[1]-ft,pt[2]-ft),At.lineTo(pt[1]+ft,pt[2]+ft),At.moveTo(pt[1]+ft,pt[2]-ft),At.lineTo(pt[1]-ft,pt[2]+ft),At.lineCap="round",At.lineJoin="round",At.closePath(),this._stroke(ht);break;case"circle":case"o":At.beginPath(),At.arc(pt[1],pt[2],ft+1+vt,0,2*Math.PI,!1),At.closePath(),this._fill(ht),this._stroke(ht);break;case"square":case"[]":if(ft<=0)break;At.save(),this._setColor(ht,"stroke","fill")&&At.fillRect(pt[1]-ft-vt,pt[2]-ft-vt,2*ft+3*vt,2*ft+3*vt),At.restore(),At.save(),this._setColor(ht,"fill"),At.fillRect(pt[1]-ft+vt,pt[2]-ft+vt,2*ft-vt,2*ft-vt),At.restore();break;case"plus":case"+":At.beginPath(),At.moveTo(pt[1]-ft,pt[2]),At.lineTo(pt[1]+ft,pt[2]),At.moveTo(pt[1],pt[2]-ft),At.lineTo(pt[1],pt[2]+ft),At.lineCap="round",At.lineJoin="round",At.closePath(),this._stroke(ht);break;case"diamond":case"<>":At.beginPath(),At.moveTo(pt[1]-ft,pt[2]),At.lineTo(pt[1],pt[2]+ft),At.lineTo(pt[1]+ft,pt[2]),At.lineTo(pt[1],pt[2]-ft),At.closePath(),this._fill(ht),this._stroke(ht);break;case"triangleup":case"a":case"^":At.beginPath(),At.moveTo(pt[1],pt[2]-ft),At.lineTo(pt[1]-mt,pt[2]+gt),At.lineTo(pt[1]+mt,pt[2]+gt),At.closePath(),this._fill(ht),this._stroke(ht);break;case"triangledown":case"v":At.beginPath(),At.moveTo(pt[1],pt[2]+ft),At.lineTo(pt[1]-mt,pt[2]-gt),At.lineTo(pt[1]+mt,pt[2]-gt),At.closePath(),this._fill(ht),this._stroke(ht);break;case"triangleleft":case"<":At.beginPath(),At.moveTo(pt[1]-ft,pt[2]),At.lineTo(pt[1]+gt,pt[2]-mt),At.lineTo(pt[1]+gt,pt[2]+mt),At.closePath(),this.fill(ht),this._stroke(ht);break;case"triangleright":case">":At.beginPath(),At.moveTo(pt[1]+ft,pt[2]),At.lineTo(pt[1]-gt,pt[2]-mt),At.lineTo(pt[1]-gt,pt[2]+mt),At.closePath(),this._fill(ht),this._stroke(ht)}},updatePoint:function(ht){this.drawPoint(ht)},drawLine:function(ht){var dt,ft=new lt(rt.COORDS_BY_USER,ht.point1.coords.usrCoords,ht.board),pt=new lt(rt.COORDS_BY_USER,ht.point2.coords.usrCoords,ht.board),mt=null,gt=it.evaluate(ht.visProp.firstarrow),vt=it.evaluate(ht.visProp.lastarrow);ht.visPropCalc.visible&&((gt||vt)&&(mt=-4),ct.calcStraight(ht,ft,pt,mt),dt=this.getPositionArrowHead(ht,ft,pt),this.context.beginPath(),this.context.moveTo(dt.c1.scrCoords[1]+dt.d1x,dt.c1.scrCoords[2]+dt.d1y),this.context.lineTo(dt.c2.scrCoords[1]-dt.d2x,dt.c2.scrCoords[2]-dt.d2y),this._stroke(ht),(gt&&dt.sFirst>0||vt&&dt.sLast>0)&&this.makeArrows(ht,dt.c1,dt.c2))},updateLine:function(ht){this.drawLine(ht)},drawTicks:function(){},updateTicks:function(ht){var dt,ft,pt,mt,gt=ht.ticks.length,vt=this.context;for(vt.beginPath(),dt=0;dt<gt;dt++)ft=ht.ticks[dt],pt=ft[0],mt=ft[1],vt.moveTo(pt[0],mt[0]),vt.lineTo(pt[1],mt[1]);for(dt=0;dt<gt;dt++)ft=ht.ticks[dt].scrCoords,ht.ticks[dt].major&&(ht.board.needsFullUpdate||ht.needsRegularUpdate)&&ht.labels[dt]&&ht.labels[dt].visPropCalc.visible&&this.updateText(ht.labels[dt]);vt.lineCap="round",this._stroke(ht)},drawCurve:function(ht){it.evaluate(ht.visProp.handdrawing)?this.updatePathStringBezierPrim(ht):this.updatePathStringPrim(ht),ht.numberPoints>1&&this.makeArrows(ht)},updateCurve:function(ht){this.drawCurve(ht)},drawEllipse:function(ht){var dt=ht.center.coords.scrCoords[1],ft=ht.center.coords.scrCoords[2],pt=ht.board.unitX,mt=ht.board.unitY,gt=2*ht.Radius(),vt=2*ht.Radius(),At=gt*pt,yt=vt*mt,xt=dt-At/2,_t=ft-yt/2,Et=At/2*.5522848,bt=yt/2*.5522848,wt=xt+At,Tt=_t+yt,Mt=xt+At/2,Pt=_t+yt/2,It=this.context;gt>0&&vt>0&&!isNaN(dt+ft)&&(It.beginPath(),It.moveTo(xt,Pt),It.bezierCurveTo(xt,Pt-bt,Mt-Et,_t,Mt,_t),It.bezierCurveTo(Mt+Et,_t,wt,Pt-bt,wt,Pt),It.bezierCurveTo(wt,Pt+bt,Mt+Et,Tt,Mt,Tt),It.bezierCurveTo(Mt-Et,Tt,xt,Pt+bt,xt,Pt),It.closePath(),this._fill(ht),this._stroke(ht))},updateEllipse:function(ht){return this.drawEllipse(ht)},displayCopyright:function(ht,dt){var ft=this.context;ft.save(),ft.font=dt+"px Arial",ft.fillStyle="#aaa",ft.lineWidth=.5,ft.fillText(ht,10,2+dt),ft.restore()},drawInternalText:function(ht){var dt=it.evaluate(ht.visProp.fontsize),ft=ht.getAnchorX(),pt=ht.getAnchorY(),mt=this.context;return mt.save(),this._setColor(ht,"stroke","fill")&&!isNaN(ht.coords.scrCoords[1]+ht.coords.scrCoords[2])&&(mt.font=(dt>0?dt:0)+"px Arial",this.transformImage(ht,ht.transformations),ft==="left"?mt.textAlign="left":ft==="right"?mt.textAlign="right":ft==="middle"&&(mt.textAlign="center"),pt==="bottom"?mt.textBaseline="bottom":pt==="top"?mt.textBaseline="top":pt==="middle"&&(mt.textBaseline="middle"),mt.fillText(ht.plaintext,ht.coords.scrCoords[1],ht.coords.scrCoords[2])),mt.restore(),null},updateInternalText:function(ht){this.drawInternalText(ht)},setObjectStrokeColor:function(ht,dt,ft){var pt,mt,gt,vt,At=it.evaluate(dt),yt=it.evaluate(ft);yt=yt>0?yt:0,ht.visPropOld.strokecolor===At&&ht.visPropOld.strokeopacity===yt||(it.exists(At)&&At!==!1&&(At.length!==9?(pt=At,gt=yt):(mt=ot.rgba2rgbo(At),pt=mt[0],gt=yt*mt[1]),vt=ht.rendNode,ht.elementClass===rt.OBJECT_CLASS_TEXT&&it.evaluate(ht.visProp.display)==="html"&&(vt.style.color=pt,vt.style.opacity=gt)),ht.visPropOld.strokecolor=At,ht.visPropOld.strokeopacity=yt)},drawImage:function(ht){ht.rendNode=new Image,ht._src="",this.updateImage(ht)},updateImage:function(ht){var dt=this.context,ft=it.evaluate(ht.visProp.fillopacity),pt=it.bind(function(){ht.imgIsLoaded=!0,ht.size[0]<=0||ht.size[1]<=0||(dt.save(),dt.globalAlpha=ft,this.transformImage(ht,ht.transformations),dt.drawImage(ht.rendNode,ht.coords.scrCoords[1],ht.coords.scrCoords[2]-ht.size[1],ht.size[0],ht.size[1]),dt.restore())},this);this.updateImageURL(ht)?ht.rendNode.onload=pt:ht.imgIsLoaded&&pt()},transformImage:function(ht,dt){var ft,pt=dt.length,mt=this.context;pt>0&&(ft=this.joinTransforms(ht,dt),Math.abs(ut.det(ft))>=at.eps&&mt.transform(ft[1][1],ft[2][1],ft[1][2],ft[2][2],ft[1][0],ft[2][0]))},updateImageURL:function(ht){var dt;return dt=it.evaluate(ht.url),ht._src!==dt&&(ht.imgIsLoaded=!1,ht.rendNode.src=dt,ht._src=dt,!0)},remove:function(ht){it.exists(ht)&&it.exists(ht.parentNode)&&ht.parentNode.removeChild(ht)},makeArrows:function(ht,dt,ft){var pt,mt,gt,vt,At,yt,xt,_t,Et,bt=it.evaluate(ht.visProp.strokewidth),wt=this.context,Tt=it.evaluate(ht.visProp.firstarrow),Mt=it.evaluate(ht.visProp.lastarrow);if(it.evaluate(ht.visProp.strokecolor)!=="none"&&(Tt||Mt)){if(ht.elementClass!==rt.OBJECT_CLASS_LINE)return pt=ht.points[0].scrCoords[1],mt=ht.points[0].scrCoords[2],gt=ht.points[ht.points.length-1].scrCoords[1],void(vt=ht.points[ht.points.length-1].scrCoords[2]);pt=dt.scrCoords[1],mt=dt.scrCoords[2],gt=ft.scrCoords[1],vt=ft.scrCoords[2],Tt&&it.exists(Tt.type)&&(yt=it.exists(Tt.size)?it.evaluate(Tt.size):3,bt*=yt,Et=it.evaluate(Tt.type),_t=Et===2?[[bt,.5*-bt],[0,0],[bt,.5*bt],[.5*bt,0]]:Et===3?[[bt/3,.5*-bt],[0,.5*-bt],[0,.5*bt],[bt/3,.5*bt]]:[[bt,.5*-bt],[0,0],[bt,.5*bt]]),Mt&&it.exists(Mt.type)&&(yt=it.exists(Mt.size)?it.evaluate(Mt.size):3,bt*=yt,Et=it.evaluate(Mt.type),xt=Et===2?[[-bt,.5*-bt],[0,0],[-bt,.5*bt],[.5*-bt,0]]:Et===3?[[-bt/3,.5*-bt],[0,.5*-bt],[0,.5*bt],[-bt/3,.5*bt]]:[[-bt,.5*-bt],[0,0],[-bt,.5*bt]]),wt.save(),this._setColor(ht,"stroke","fill")&&(At=Math.atan2(vt-mt,gt-pt),Mt&&this._drawFilledPolygon(this._translateShape(this._rotateShape(xt,At),gt,vt)),Tt&&this._drawFilledPolygon(this._translateShape(this._rotateShape(_t,At),pt,mt))),wt.restore()}},updatePathStringPrim:function(ht){var dt,ft,pt,mt,gt,vt="M",At=this.context;if(!(ht.numberPoints<=0)){if(gt=Math.min(ht.points.length,ht.numberPoints),At.beginPath(),ht.bezierDegree===1)for(dt=0;dt<gt;dt++)ft=ht.points[dt].scrCoords,isNaN(ft[1])||isNaN(ft[2])?vt="M":(ft[1]>5e3?ft[1]=5e3:ft[1]<-5e3&&(ft[1]=-5e3),ft[2]>5e3?ft[2]=5e3:ft[2]<-5e3&&(ft[2]=-5e3),vt==="M"?At.moveTo(ft[1],ft[2]):At.lineTo(ft[1],ft[2]),vt="L");else if(ht.bezierDegree===3)for(dt=0;dt<gt;)ft=ht.points[dt].scrCoords,isNaN(ft[1])||isNaN(ft[2])?vt="M":(vt==="M"?At.moveTo(ft[1],ft[2]):(dt+=1,pt=ht.points[dt].scrCoords,dt+=1,mt=ht.points[dt].scrCoords,At.bezierCurveTo(ft[1],ft[2],pt[1],pt[2],mt[1],mt[2])),vt="C"),dt+=1;At.lineCap="round",this._fill(ht),this._stroke(ht)}},updatePathStringBezierPrim:function(ht){var dt,ft,pt,mt,gt,vt,At,yt="M",xt=it.evaluate(ht.visProp.strokewidth),_t=it.evaluate(ht.visProp.curvetype)!=="plot",Et=this.context;if(!(ht.numberPoints<=0)){for(_t&&ht.board.options.curve.RDPsmoothing&&(ht.points=ut.RamerDouglasPeucker(ht.points,.5)),At=Math.min(ht.points.length,ht.numberPoints),Et.beginPath(),ft=1;ft<3;ft++)for(yt="M",dt=0;dt<At;dt++)mt=ht.points[dt].scrCoords,isNaN(mt[1])||isNaN(mt[2])?yt="M":(mt[1]>5e3?mt[1]=5e3:mt[1]<-5e3&&(mt[1]=-5e3),mt[2]>5e3?mt[2]=5e3:mt[2]<-5e3&&(mt[2]=-5e3),yt==="M"?Et.moveTo(mt[1],mt[2]):(pt=2*ft,Et.bezierCurveTo(gt+.333*(mt[1]-gt)+xt*(pt*Math.random()-ft),vt+.333*(mt[2]-vt)+xt*(pt*Math.random()-ft),gt+.666*(mt[1]-gt)+xt*(pt*Math.random()-ft),vt+.666*(mt[2]-vt)+xt*(pt*Math.random()-ft),mt[1],mt[2])),yt="C",gt=mt[1],vt=mt[2]);Et.lineCap="round",this._fill(ht),this._stroke(ht)}},updatePolygonPrim:function(ht,dt){var ft,pt,mt,gt=dt.vertices.length,vt=this.context,At=!0;if(!(gt<=0)&&dt.visPropCalc.visible){for(vt.beginPath(),pt=0;!dt.vertices[pt].isReal&&pt<gt-1;)pt++,At=!1;for(ft=dt.vertices[pt].coords.scrCoords,vt.moveTo(ft[1],ft[2]),mt=pt;mt<gt-1;mt++)dt.vertices[mt].isReal||(At=!1),ft=dt.vertices[mt].coords.scrCoords,vt.lineTo(ft[1],ft[2]);vt.closePath(),At&&this._fill(dt)}},display:function(ht,dt){ht&&ht.rendNode&&(ht.visPropOld.visible=dt,ht.rendNode.style.visibility=dt?"inherit":"hidden")},show:function(ht){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),it.exists(ht.rendNode)&&(ht.rendNode.style.visibility="inherit")},hide:function(ht){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),it.exists(ht.rendNode)&&(ht.rendNode.style.visibility="hidden")},setGradient:function(ht){it.evaluate(ht.visProp.fillopacity),it.evaluate(ht.visProp.fillcolor)},setShadow:function(ht){ht.visPropOld.shadow!==ht.visProp.shadow&&(ht.visPropOld.shadow=ht.visProp.shadow)},highlight:function(ht){return ht.elementClass===rt.OBJECT_CLASS_TEXT&&it.evaluate(ht.visProp.display)==="html"?this.updateTextStyle(ht,!0):(ht.board.prepareUpdate(),ht.board.renderer.suspendRedraw(ht.board),ht.board.updateRenderer(),ht.board.renderer.unsuspendRedraw()),this},noHighlight:function(ht){return ht.elementClass===rt.OBJECT_CLASS_TEXT&&it.evaluate(ht.visProp.display)==="html"?this.updateTextStyle(ht,!1):(ht.board.prepareUpdate(),ht.board.renderer.suspendRedraw(ht.board),ht.board.updateRenderer(),ht.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(ht){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),ht&&ht.attr.showcopyright&&this.displayCopyright(tt.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(ht,dt){this.container?(this.canvasRoot.style.width=parseFloat(ht)+"px",this.canvasRoot.style.height=parseFloat(dt)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(ht)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(dt)+"px")):(this.canvasRoot.width=2*parseFloat(ht),this.canvasRoot.height=2*parseFloat(dt)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),tt.CanvasRenderer}),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct){return tt.JSXGraph={rendererType:function(){return st.board.renderer="no",_e.supportsVML()&&(st.board.renderer="vml",document.onmousemove=function(){var ut;return document.body&&(ut=document.body.scrollLeft,ut+=document.body.scrollTop),ut}),_e.supportsCanvas()&&(st.board.renderer="canvas"),_e.supportsSVG()&&(st.board.renderer="svg"),_e.isNode()&&_e.supportsCanvas()&&(st.board.renderer="canvas"),(_e.isNode()||st.renderer==="no")&&(st.text.display="internal",st.infobox.display="internal"),st.board.renderer}(),initRenderer:function(ut,ht,dt,ft){var pt;if(rt.exists(dt)&&dt!==!1||typeof document!="object"||(dt=document),typeof dt=="object"&&ut!==null)for(pt=dt.getElementById(ut);pt.firstChild;)pt.removeChild(pt.firstChild);else pt=ut;return ft!==void 0&&ft!=="auto"||(ft=this.rendererType),ft==="svg"?new ot(pt,ht):ft==="vml"?new lt(pt):ft==="canvas"?new at(pt,ht):new ct},initBoard:function(ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt;return ht=ht||{},_t=rt.copyAttributes(ht,st,"board"),_t.zoom=rt.copyAttributes(_t,st,"board","zoom"),_t.pan=rt.copyAttributes(_t,st,"board","pan"),_t.selection=rt.copyAttributes(_t,st,"board","selection"),_t.navbar=rt.copyAttributes(_t.navbar,st,"navbar"),yt=_e.getDimensions(ut,_t.document),_t.unitx||_t.unity?(dt=rt.def(_t.originx,150),ft=rt.def(_t.originy,150),pt=rt.def(_t.unitx,50),mt=rt.def(_t.unity,50)):(xt=_t.boundingbox,vt=parseInt(yt.width,10),At=parseInt(yt.height,10),rt.exists(xt)&&_t.keepaspectratio?(pt=vt/(xt[2]-xt[0]),mt=At/(xt[1]-xt[3]),Math.abs(pt)<Math.abs(mt)?mt=Math.abs(pt)*mt/Math.abs(mt):pt=Math.abs(mt)*pt/Math.abs(pt)):(pt=vt/(xt[2]-xt[0]),mt=At/(xt[1]-xt[3])),dt=-pt*xt[0],ft=mt*xt[1]),gt=this.initRenderer(ut,yt,_t.document,_t.renderer),Tt=new nt(ut,gt,_t.id,[dt,ft],_t.zoomfactor*_t.zoomx,_t.zoomfactor*_t.zoomy,pt,mt,yt.width,yt.height,_t),tt.boards[Tt.id]=Tt,Tt.keepaspectratio=_t.keepaspectratio,Tt.resizeContainer(yt.width,yt.height,!0,!0),Tt.suspendUpdate(),Tt.initInfobox(),_t.axis&&(Et=typeof _t.axis=="object"?_t.axis:{},bt=rt.deepCopy(st.board.defaultAxes.x,Et),wt=rt.deepCopy(st.board.defaultAxes.y,Et),_t.defaultaxes.x&&(bt=rt.deepCopy(bt,_t.defaultaxes.x)),_t.defaultaxes.y&&(wt=rt.deepCopy(wt,_t.defaultaxes.y)),Tt.defaultAxes={},Tt.defaultAxes.x=Tt.create("axis",[[0,0],[1,0]],bt),Tt.defaultAxes.y=Tt.create("axis",[[0,0],[0,1]],wt)),_t.grid&&Tt.create("grid",[],typeof _t.grid=="object"?_t.grid:{}),Tt._createSelectionPolygon(_t),Tt.renderer.drawZoomBar(Tt,_t.navbar),Tt.unsuspendUpdate(),Tt},loadBoardFromFile:function(ut,ht,dt,ft,pt){var mt,gt,vt,At,yt;return ft=ft||{},mt=rt.copyAttributes(ft,st,"board"),mt.zoom=rt.copyAttributes(ft,st,"board","zoom"),mt.pan=rt.copyAttributes(ft,st,"board","pan"),mt.selection=rt.copyAttributes(mt,st,"board","selection"),mt.navbar=rt.copyAttributes(mt.navbar,st,"navbar"),At=_e.getDimensions(ut,mt.document),gt=this.initRenderer(ut,At,mt.document,mt.renderer),vt=new nt(ut,gt,"",[150,150],1,1,50,50,At.width,At.height,mt),vt.initInfobox(),vt.resizeContainer(At.width,At.height,!0,!0),it.parseFileContent(ht,vt,dt,!0,pt),yt=rt.copyAttributes(mt,st,"board","selection"),vt.selectionPolygon=vt.create("polygon",[[0,0],[0,0],[0,0],[0,0]],yt),vt.renderer.drawZoomBar(vt,mt.navbar),tt.boards[vt.id]=vt,vt},loadBoardFromString:function(ut,ht,dt,ft,pt){var mt,gt,vt,At,yt;return ft=ft||{},mt=rt.copyAttributes(ft,st,"board"),mt.zoom=rt.copyAttributes(ft,st,"board","zoom"),mt.pan=rt.copyAttributes(ft,st,"board","pan"),mt.selection=rt.copyAttributes(mt,st,"board","selection"),mt.navbar=rt.copyAttributes(mt.navbar,st,"navbar"),vt=_e.getDimensions(ut,mt.document),gt=this.initRenderer(ut,vt,mt.document),At=new nt(ut,gt,"",[150,150],1,1,50,50,vt.width,vt.height,mt),At.initInfobox(),At.resizeContainer(vt.width,vt.height,!0,!0),it.parseString(ht,At,dt,!0,pt),yt=rt.copyAttributes(mt,st,"board","selection"),At.selectionPolygon=At.create("polygon",[[0,0],[0,0],[0,0],[0,0]],yt),At.renderer.drawZoomBar(At,mt.navbar),tt.boards[At.id]=At,At},freeBoard:function(ut){var ht;typeof ut=="string"&&(ut=tt.boards[ut]),ut.removeEventHandlers(),ut.suspendUpdate();for(ht in ut.objects)ut.objects.hasOwnProperty(ht)&&ut.objects[ht].remove();for(;ut.containerObj.firstChild;)ut.containerObj.removeChild(ut.containerObj.firstChild);for(ht in ut.objects)ut.objects.hasOwnProperty(ht)&&delete ut.objects[ht];delete ut.renderer,ut.jc.creator.clearCache(),delete ut.jc,delete tt.boards[ut.id]},registerElement:function(ut,ht){tt.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),tt.registerElement(ut,ht)}},_e.isBrowser&&typeof window=="object"&&typeof document=="object"&&_e.addEvent(window,"load",function(){var ut,ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et=document.getElementsByTagName("script"),bt=function(Tt,Mt,Pt){var It=tt.JSXGraph.initBoard(pt,{boundingbox:Pt,keepaspectratio:!0,grid:xt,axis:yt,showReload:!0});if(Mt.toLowerCase().indexOf("script")>-1)It.construct(Tt);else try{It.jc.parse(Tt)}catch(Ot){tt.debug(Ot)}return It},wt=function(Tt,Mt,Pt,It){return function(){var Ot;tt.JSXGraph.freeBoard(Tt),Ot=bt(Mt,Pt,It),Ot.reload=wt(Ot,Mt,Pt,It)}};for(ht=0;ht<Et.length;ht++)if(ut=Et[ht].getAttribute("type",!1),rt.exists(ut)&&(ut.toLowerCase()==="text/jessiescript"||ut.toLowerCase()==="jessiescript"||ut.toLowerCase()==="text/jessiecode"||ut.toLowerCase()==="jessiecode")){if(gt=Et[ht].getAttribute("width",!1)||"500px",vt=Et[ht].getAttribute("height",!1)||"500px",At=Et[ht].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",pt=Et[ht].getAttribute("container",!1),At=At.split(","),At.length!==4)At=[-5,5,5,-5];else for(dt=0;dt<At.length;dt++)At[dt]=parseFloat(At[dt]);if(yt=rt.str2Bool(Et[ht].getAttribute("axis",!1)||"false"),xt=rt.str2Bool(Et[ht].getAttribute("grid",!1)||"false"),rt.exists(pt))ft=document.getElementById(pt);else{pt="jessiescript_autgen_jxg_"+ht,ft=document.createElement("div"),ft.setAttribute("id",pt),ft.setAttribute("style","width:"+gt+"; height:"+vt+"; float:left"),ft.setAttribute("class","jxgbox");try{document.body.insertBefore(ft,Et[ht])}catch{typeof jQuery=="object"&&jQuery(ft).insertBefore(Et[ht])}}document.getElementById(pt)?(_t=Et[ht].innerHTML,_t=_t.replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),Et[ht].innerHTML=_t,mt=bt(_t,ut,At),mt.reload=wt(mt,_t,ut,At)):tt.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),tt.JSXGraph}),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],function(tt,_e,rt,nt,it){return tt.Group=function(st,ot,lt,at,ct){var ut,ht,dt,ft;for(this.board=st,this.objects={},ut=this.board.numObjects,this.board.numObjects+=1,ot!==""&&it.exists(ot)?this.id=ot:this.id=this.board.id+"Group"+ut,this.board.groups[this.id]=this,this.type=_e.OBJECT_TYPE_POINT,this.elementClass=_e.OBJECT_CLASS_POINT,lt!==""&&it.exists(lt)?this.name=lt:this.name="group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=ct.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],ht=it.isArray(at)?at:Array.prototype.slice.call(arguments,3),dt=0;dt<ht.length;dt++)ft=this.board.select(ht[dt]),!it.evaluate(ft.visProp.fixed)&&it.exists(ft.coords)&&this.addPoint(ft);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},tt.extend(tt.Group.prototype,{ungroup:function(){var st,ot,lt;for(st in this.objects)this.objects.hasOwnProperty(st)&&(ot=this.objects[st].point,it.isArray(ot.groups)&&(lt=it.indexOf(ot.groups,this.id))>=0&&delete ot.groups[lt]);return this.objects={},this},addParents:function(st){var ot,lt,at;for(at=it.isArray(st)?st:arguments,lt=at.length,ot=0;ot<lt;++ot)it.isId(this.board,at[ot])?this.parents.push(at[ot]):it.exists(at[ot].id)&&this.parents.push(at[ot].id);this.parents=it.uniqueArray(this.parents)},setParents:function(st){this.parents=[],this.addParents(st)},getParents:function(){return it.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(st){var ot;st!==""&&it.exists(this.objects[st])&&(ot=this.objects[st].point,this.coords[ot.id]={usrCoords:ot.coords.usrCoords.slice(0)})},update:function(st){var ot,lt,at,ct,ut,ht,dt,ft,pt,mt=null;if(!this.needsUpdate)return this;if(st=this._update_find_drag_type(),st.action==="nothing")return this._updateCoordsCache(st.id),this;if(mt=this.objects[st.id].point,st.action==="translation")ft=[mt.coords.usrCoords[1]-this.coords[st.id].usrCoords[1],mt.coords.usrCoords[2]-this.coords[st.id].usrCoords[2]];else if(st.action==="rotation"||st.action==="scaling"){if(lt=st.action==="rotation"?"rotationCenter":"scaleCenter",it.isPoint(this[lt]))pt=this[lt].coords.usrCoords.slice(1);else if(this[lt]==="centroid")pt=this._update_centroid_center();else if(it.isArray(this[lt]))pt=this[lt];else{if(!it.isFunction(this[lt]))return this;pt=this[lt]()}if(st.action==="rotation")dt=nt.rad(this.coords[st.id].usrCoords.slice(1),pt,this.objects[st.id].point),ft=this.board.create("transform",[dt,pt[0],pt[1]],{type:"rotate"}),ft.update();else{if(st.action!=="scaling")return this;if(ct=nt.distance(this.coords[st.id].usrCoords.slice(1),pt),Math.abs(ct)<rt.eps)return this;ct=nt.distance(mt.coords.usrCoords.slice(1),pt)/ct,ut=this.scaleDirections[st.id].indexOf("x")>=0?ct:1,ht=this.scaleDirections[st.id].indexOf("y")>=0?ct:1,ft=this.board.create("transform",[1,0,0,pt[0]*(1-ut),ut,0,pt[1]*(1-ht),0,ht],{type:"generic"}),ft.update()}}this._update_apply_transformation(st,ft),this.needsUpdate=!1;for(ot in this.objects)if(this.objects.hasOwnProperty(ot))for(at in this.objects[ot].descendants)this.objects[ot].descendants.hasOwnProperty(at)&&(this.objects[ot].descendants.needsUpdate=this.objects[ot].descendants.needsRegularUpdate||this.board.needsFullUpdate);this.board.updateElements(st);for(ot in this.objects)this.objects.hasOwnProperty(ot)&&this._updateCoordsCache(ot);return this},_update_find_drag_type:function(){var st,ot,lt,at="nothing",ct=[];for(st in this.objects)this.objects.hasOwnProperty(st)&&(ot=this.objects[st].point,ot.coords.distance(_e.COORDS_BY_USER,this.coords[st])>rt.eps&&ct.push(ot.id));return ct.length===0?{action:at,id:"",changed:ct}:(lt=ct[0],ot=this.objects[lt].point,ct.length>1?at="translation":it.isInArray(this.rotationPoints,ot)&&it.exists(this.rotationCenter)?at="rotation":it.isInArray(this.scalePoints,ot)&&it.exists(this.scaleCenter)?at="scaling":it.isInArray(this.translationPoints,ot)&&(at="translation"),{action:at,id:lt,changed:ct})},_update_centroid_center:function(){var st,ot,lt;st=[0,0],ot=0;for(lt in this.coords)this.coords.hasOwnProperty(lt)&&(st[0]+=this.coords[lt].usrCoords[1],st[1]+=this.coords[lt].usrCoords[2],++ot);return ot>0&&(st[0]/=ot,st[1]/=ot),st},_update_apply_transformation:function(st,ot){var lt,at;for(lt in this.objects)this.objects.hasOwnProperty(lt)&&(it.exists(this.board.objects[lt])?(at=this.objects[lt].point,at.id!==st.id?st.action==="translation"?it.isInArray(st.changed,at.id)||at.coords.setCoordinates(_e.COORDS_BY_USER,[this.coords[lt].usrCoords[1]+ot[0],this.coords[lt].usrCoords[2]+ot[1]]):st.action!=="rotation"&&st.action!=="scaling"||ot.applyOnce([at]):st.action!=="rotation"&&st.action!=="scaling"||at.coords.setCoordinates(_e.COORDS_BY_USER,rt.matVecMult(ot.matrix,this.coords[at.id].usrCoords))):delete this.objects[lt])},addPoint:function(st){return this.objects[st.id]={point:this.board.select(st)},this._updateCoordsCache(st.id),this.translationPoints.push(st),st.groups.push(this.id),st.groups=it.uniqueArray(st.groups),this},addPoints:function(st){var ot;for(ot=0;ot<st.length;ot++)this.addPoint(st[ot]);return this},addGroup:function(st){var ot;for(ot in st.objects)st.objects.hasOwnProperty(ot)&&this.addPoint(st.objects[ot].point);return this},removePoint:function(st){return delete this.objects[st.id],this},setRotationCenter:function(st){return this.rotationCenter=st,this},setRotationPoints:function(st){return this._setActionPoints("rotation",st)},addRotationPoint:function(st){return this._addActionPoint("rotation",st)},removeRotationPoint:function(st){return this._removeActionPoint("rotation",st)},setTranslationPoints:function(st){return this._setActionPoints("translation",st)},addTranslationPoint:function(st){return this._addActionPoint("translation",st)},removeTranslationPoint:function(st){return this._removeActionPoint("translation",st)},setScaleCenter:function(st){return this.scaleCenter=st,this},setScalePoints:function(st,ot){var lt,at,ct;for(lt=it.isArray(st)?st:arguments,ct=lt.length,at=0;at<ct;++at)this.scaleDirections[this.board.select(lt[at]).id]=ot||"xy";return this._setActionPoints("scale",st)},addScalePoint:function(st,ot){return this._addActionPoint("scale",st),this.scaleDirections[this.board.select(st).id]=ot||"xy",this},removeScalePoint:function(st){return this._removeActionPoint("scale",st)},_setActionPoints:function(st,ot){var lt,at,ct;for(lt=it.isArray(ot)?ot:arguments,ct=lt.length,this[st+"Points"]=[],at=0;at<ct;++at)this._addActionPoint(st,lt[at]);return this},_addActionPoint:function(st,ot){return this[st+"Points"].push(this.board.select(ot)),this},_removeActionPoint:function(st,ot){var lt=this[st+"Points"].indexOf(this.board.select(ot));return lt>-1&&this[st+"Points"].splice(lt,1),this},setProperty:function(){tt.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var st;for(st in this.objects)this.objects.hasOwnProperty(st)&&this.objects[st].point.setAttribute.apply(this.objects[st].point,arguments);return this}}),tt.createGroup=function(st,ot,lt){var at=it.copyAttributes(lt,st.options,"group"),ct=new tt.Group(st,at.id,at.name,ot,at);return ct.elType="group",ct.setParents(ot),ct},tt.registerElement("group",tt.createGroup),{Group:tt.Group,createGroup:tt.createGroup}}),define("element/locus",["jxg","math/symbolic","utils/type","base/constants","base/curve"],function(tt,_e,rt,nt,it){return tt.createLocus=function(st,ot,lt){var at,ct;if(!rt.isArray(ot)||ot.length!==1||!rt.isPoint(ot[0]))throw new Error(`JSXGraph: Can't create locus with parent of type other than point.
Possible parent types: [point]`);return ct=ot[0],at=st.create("curve",[[null],[null]],lt),at.dontCallServer=!1,at.elType="locus",at.setParents([ct.id]),at.updateDataArray=function(){var ut,ht,dt;at.board.mode>0||(ut=_e.generatePolynomials(st,ct,!0).join("|"))!==at.spe&&(at.spe=ut,ht=function(ft,pt,mt,gt){at.dataX=ft,at.dataY=pt,at.eq=mt,at.ctime=gt,at.generatePolynomial=function(vt){return function(At){var yt,xt="("+At.symbolic.x+")",_t="("+At.symbolic.y+")",Et=[];for(yt=0;yt<vt.length;yt++)Et[yt]=vt[yt].replace(/\*\*/g,"^").replace(/x/g,xt).replace(/y/g,_t);return Et}}(mt)},dt=_e.geometricLocusByGroebnerBase(st,ct,ht),ht(dt.datax,dt.datay,dt.polynomial,dt.exectime))},at},tt.registerElement("locus",tt.createLocus),{createLocus:tt.createLocus}}),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","utils/type","base/coordselement"],function(tt,_e,rt,nt,it,st,ot,lt){return tt.Image=function(at,ct,ut,ht,dt){this.constructor(at,ut,_e.OBJECT_TYPE_IMAGE,_e.OBJECT_CLASS_OTHER),this.element=this.board.select(ut.anchor),this.coordsConstructor(ct),this.W=ot.createFunction(dt[0],this.board,""),this.H=ot.createFunction(dt[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*at.unitX),Math.abs(this.usrSize[1]*at.unitY)],this.url=ht,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=tt.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},tt.Image.prototype=new nt,ot.copyPrototypeMethods(tt.Image,lt,"coordsConstructor"),tt.extend(tt.Image.prototype,{hasPoint:function(at,ct){var ut,ht,dt,ft,pt,mt,gt;return this.transformations.length===0?(ut=at-this.coords.scrCoords[1],ht=this.coords.scrCoords[2]-ct,dt=this.board.options.precision.hasPoint,ut>=-dt&&ut-this.size[0]<=dt&&ht>=-dt&&ht-this.size[1]<=dt):(ft=new rt(_e.COORDS_BY_SCREEN,[at,ct],this.board),ft=ft.usrCoords,pt=[ft[0]-this.span[0][0],ft[1]-this.span[0][1],ft[2]-this.span[0][2]],gt=it.innerProduct,0<=(mt=gt(pt,this.span[1]))&&mt<=gt(this.span[1],this.span[1])&&0<=(mt=gt(pt,this.span[2]))&&mt<=gt(this.span[2],this.span[2]))},update:function(at){return this.needsUpdate?(this.updateCoords(at),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var at,ct,ut=this.transformations.length,ht=[];if(ut===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(ht[0]=[this.Z(),this.X(),this.Y()],ht[1]=[this.Z(),this.X()+this.W(),this.Y()],ht[2]=[this.Z(),this.X(),this.Y()+this.H()],at=0;at<ut;at++)for(ct=0;ct<3;ct++)ht[ct]=it.matVecMult(this.transformations[at].matrix,ht[ct]);for(ct=0;ct<3;ct++)ht[ct][1]/=ht[ct][0],ht[ct][2]/=ht[ct][0],ht[ct][0]/=ht[ct][0];for(ct=1;ct<3;ct++)ht[ct][0]-=ht[0][0],ht[ct][1]-=ht[0][1],ht[ct][2]-=ht[0][2];this.span=ht}return this},addTransform:function(at){var ct;if(ot.isArray(at))for(ct=0;ct<at.length;ct++)this.transformations.push(at[ct]);else this.transformations.push(at);return this},getParents:function(){var at=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(at=this.parents),at},setSize:function(at,ct){return this.W=ot.createFunction(at,this.board,""),this.H=ot.createFunction(ct,this.board,""),this},W:function(){},H:function(){}}),tt.createImage=function(at,ct,ut){var ht,dt,ft=ct[0],pt=ct[1],mt=ct[2];if(ht=ot.copyAttributes(ut,at.options,"image"),!(dt=lt.create(tt.Image,at,pt,ht,ft,mt)))throw new Error("JSXGraph: Can't create image with parent types '"+typeof ct[0]+"' and '"+typeof ct[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return ot.evaluate(ht.rotate)!==0&&dt.addRotation(ot.evaluate(ht.rotate)),dt},tt.registerElement("image",tt.createImage),{Image:tt.Image,createImage:tt.createImage}}),define("base/ticks",["jxg","math/math","math/geometry","base/constants","base/element","base/coords","utils/type","base/text"],function(tt,_e,rt,nt,it,st,ot,lt){return tt.Ticks=function(at,ct,ut){if(this.constructor(at.board,ut,nt.OBJECT_TYPE_TICKS,nt.OBJECT_CLASS_OTHER),this.line=at,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],ot.isFunction(ct))throw this.ticksFunction=ct,new Error("Function arguments are no longer supported.");ot.isArray(ct)?this.fixedTicks=ct:((Math.abs(ct)<_e.eps||ct<0)&&(ct=ut.defaultdistance),this.ticksFunction=this.makeTicksFunction(ct),this.equidistant=!0),this.minTicksDistance=ut.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},tt.Ticks.prototype=new it,tt.extend(tt.Ticks.prototype,{makeTicksFunction:function(at){return function(){var ct,ut,ht;return ot.evaluate(this.visProp.insertticks)?(ut=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),ht=ut.upper-ut.lower,ct=Math.pow(10,Math.floor(Math.log(.6*ht)/Math.LN10)),ht<=6*ct&&(ct*=.5),ct):at}},hasPoint:function(at,ct){var ut,ht,dt=this.ticks&&this.ticks.length||0,ft=this.board.options.precision.hasPoint+.5*ot.evaluate(this.visProp.strokewidth);if(!ot.evaluate(this.line.visProp.scalable)||this.line.stdform[1]!==0&&this.line.stdform[2]!==0&&this.line.type!==nt.OBJECT_TYPE_AXIS)return!1;for(ut=0;ut<dt;ut++)if(ht=this.ticks[ut],ht[2]&&!(this.line.stdform[1]===0&&Math.abs(ht[0][0]-this.line.point1.coords.scrCoords[1])<_e.eps||this.line.stdform[2]===0&&Math.abs(ht[1][0]-this.line.point1.coords.scrCoords[2])<_e.eps)&&(Math.abs(ht[0][0]-ht[0][1])>=1||Math.abs(ht[1][0]-ht[1][1])>=1)){if(this.line.stdform[1]===0){if(Math.abs(ct-.5*(ht[1][0]+ht[1][1]))<2*ft&&ht[0][0]-ft<at&&at<ht[0][1]+ft)return!0}else if(this.line.stdform[2]===0&&Math.abs(at-.5*(ht[0][0]+ht[0][1]))<2*ft&&ht[1][0]-ft<ct&&ct<ht[1][1]+ft)return!0}return!1},setPositionDirectly:function(at,ct,ut){var ht,dt,ft=new st(at,ct,this.board),pt=new st(at,ut,this.board),mt=this.board.getBoundingBox();return ot.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<_e.eps&&Math.abs(ft.usrCoords[1]*pt.usrCoords[1])>_e.eps?(ht=pt.usrCoords[1]/ft.usrCoords[1],mt[0]*=ht,mt[2]*=ht,this.board.setBoundingBox(mt,!1)):Math.abs(this.line.stdform[2])<_e.eps&&Math.abs(ft.usrCoords[2]*pt.usrCoords[2])>_e.eps&&(dt=pt.usrCoords[2]/ft.usrCoords[2],mt[3]*=dt,mt[1]*=dt,this.board.setBoundingBox(mt,!1)),this):this},calculateTicksCoordinates:function(){var at,ct;if(this.setTicksSizeVariables(),!(Math.abs(this.dx)<_e.eps&&Math.abs(this.dy)<_e.eps))return at=this.getZeroCoordinates(),ct=this.getLowerAndUpperBounds(at),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(at,ct):this.generateFixedTicks(at,ct),this},setTicksSizeVariables:function(){var at,ct=.5*ot.evaluate(this.visProp.majorheight),ut=.5*ot.evaluate(this.visProp.minorheight);this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2],this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,at=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=ct/at*this.board.unitX,this.dyMaj*=ct/at*this.board.unitY,this.dxMin*=ut/at*this.board.unitX,this.dyMin*=ut/at*this.board.unitY,this.minStyle=ot.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=ot.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var at,ct,ut,ht,dt,ft,pt=ot.evaluate(this.visProp.anchor);return this.line.type===nt.OBJECT_TYPE_AXIS?rt.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(ut=this.line.point1.coords.usrCoords[0],at=this.line.point1.coords.usrCoords[1],ct=this.line.point1.coords.usrCoords[2],ft=this.line.point2.coords.usrCoords[0],ht=this.line.point2.coords.usrCoords[1],dt=this.line.point2.coords.usrCoords[2],pt==="right"?this.line.point2.coords:pt==="middle"?new st(nt.COORDS_BY_USER,[.5*(ut+ft),.5*(at+ht),.5*(ct+dt)],this.board):ot.isNumber(pt)?new st(nt.COORDS_BY_USER,[ut+(ft-ut)*pt,at+(ht-at)*pt,ct+(dt-ct)*pt],this.board):this.line.point1.coords)},getLowerAndUpperBounds:function(at,ct){var ut,ht,dt,ft,pt,mt=new st(nt.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),gt=new st(nt.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),vt=Math.abs(mt.usrCoords[0])>=_e.eps&&mt.scrCoords[1]>=0&&mt.scrCoords[1]<=this.board.canvasWidth&&mt.scrCoords[2]>=0&&mt.scrCoords[2]<=this.board.canvasHeight,At=Math.abs(gt.usrCoords[0])>=_e.eps&&gt.scrCoords[1]>=0&&gt.scrCoords[1]<=this.board.canvasWidth&&gt.scrCoords[2]>=0&&gt.scrCoords[2]<=this.board.canvasHeight,yt=ot.evaluate(this.line.visProp.straightfirst),xt=ot.evaluate(this.line.visProp.straightlast),_t=ot.evaluate(this.visProp.includeboundaries);return ot.exists(ct)||ct==="tickdistance"?rt.calcStraight(this.line,mt,gt,ot.evaluate(this.line.visProp.margin)):rt.calcLineDelimitingPoints(this.line,mt,gt),pt=this.board.renderer.getPositionArrowHead(this.line,mt,gt,ot.evaluate(this.line.visProp.strokewidth)),mt.setCoordinates(nt.COORDS_BY_SCREEN,[mt.scrCoords[1]-pt.d1x,mt.scrCoords[2]-pt.d1y]),gt.setCoordinates(nt.COORDS_BY_SCREEN,[gt.scrCoords[1]-pt.d2x,gt.scrCoords[2]-pt.d2y]),dt=this.getDistanceFromZero(at,mt),ft=this.getDistanceFromZero(at,gt),dt<ft?(ut=dt,yt||!vt||_t||(ut+=_e.eps),ht=ft,xt||!At||_t||(ht-=_e.eps)):ft<dt?(ut=ft,xt||!At||_t||(ut+=_e.eps),ht=dt,yt||!vt||_t||(ht-=_e.eps)):(ut=0,ht=0),{lower:ut,upper:ht}},getDistanceFromZero:function(at,ct){var ut=_e.eps,ht=at.distance(nt.COORDS_BY_USER,ct);return this.line.type===nt.OBJECT_TYPE_AXIS?(_e.relDif(at.usrCoords[1],ct.usrCoords[1])>ut&&at.usrCoords[1]-ct.usrCoords[1]>ut||_e.relDif(at.usrCoords[2],ct.usrCoords[2])>ut&&at.usrCoords[2]-ct.usrCoords[2]>ut)&&(ht*=-1):ot.evaluate(this.visProp.anchor)==="right"?rt.isSameDirection(at,this.line.point1.coords,ct)&&(ht*=-1):rt.isSameDirection(at,this.line.point2.coords,ct)||(ht*=-1),ht},generateEquidistantTicks:function(at,ct){var ut,ht=this.getXandYdeltas(),dt=this.equidistant?this.ticksFunction(1):this.ticksDelta,ft=ot.evaluate(this.visProp.insertticks),pt=ot.evaluate(this.visProp.minorticks);if(dt*=ot.evaluate(this.visProp.scale),ft&&this.minTicksDistance>_e.eps?(dt=this.adjustTickDistance(dt,at,ht),dt/=pt+1):ft||(dt/=pt+1),this.ticksDelta=dt,!(dt<_e.eps)){for(ut=0,ot.evaluate(this.visProp.drawzero)||(ut=dt);ut<=ct.upper;)ut>=ct.lower&&this.processTickPosition(at,ut,dt,ht),ut+=dt;for(ut=-dt;ut>=ct.lower;)ut<=ct.upper&&this.processTickPosition(at,ut,dt,ht),ut-=dt}},adjustTickDistance:function(at,ct,ut){var ht,dt,ft,pt=1,mt=ot.evaluate(this.visProp.minorticks);for(this.getLowerAndUpperBounds(ct,"ticksdistance"),ht=ct.usrCoords[1]+ut.x*at,dt=ct.usrCoords[2]+ut.y*at,ft=ct.distance(nt.COORDS_BY_SCREEN,new st(nt.COORDS_BY_USER,[ht,dt],this.board));ft/(mt+1)<this.minTicksDistance;)at*=pt===1?2:5,pt*=-1,ht=ct.usrCoords[1]+ut.x*at,dt=ct.usrCoords[2]+ut.y*at,ft=ct.distance(nt.COORDS_BY_SCREEN,new st(nt.COORDS_BY_USER,[ht,dt],this.board));return at},processTickPosition:function(at,ct,ut,ht){var dt,ft,pt,mt;dt=at.usrCoords[1]+ct*ht.x,ft=at.usrCoords[2]+ct*ht.y,pt=new st(nt.COORDS_BY_USER,[dt,ft],this.board),pt.major=Math.round(ct/ut)%(ot.evaluate(this.visProp.minorticks)+1)==0,mt=this.tickEndings(pt,pt.major),mt.length===3&&(this.ticks.push(mt),pt.major&&ot.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(pt,at),pt,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(at,ct){var ut,ht,dt,ft,pt,mt,gt=ot.isArray(this.visProp.labels),vt=this.getXandYdeltas(),At=ot.evaluate(this.visProp.drawlabels);for(dt=0;dt<this.fixedTicks.length;dt++)pt=at.usrCoords[1]+this.fixedTicks[dt]*vt.x,mt=at.usrCoords[2]+this.fixedTicks[dt]*vt.y,ut=new st(nt.COORDS_BY_USER,[pt,mt],this.board),ft=this.tickEndings(ut,!0),ft.length===3&&this.fixedTicks[dt]>=ct.lower&&this.fixedTicks[dt]<=ct.upper&&(this.ticks.push(ft),At&&(gt||ot.exists(this.visProp.labels[dt]))?(ht=gt?ot.evaluate(this.visProp.labels[dt]):this.fixedTicks[dt],this.labelsData.push(this.generateLabelData(this.generateLabelText(ut,at,ht),ut,dt))):this.labelsData.push(null))},getXandYdeltas:function(){var at,ct,ut=this.line.point1.Dist(this.line.point2);return this.line.type===nt.OBJECT_TYPE_AXIS?(at=this.line.point1.coords.usrCoords,ct=this.line.point2.coords.usrCoords,(at[1]>ct[1]||Math.abs(at[1]-ct[1])<_e.eps&&at[2]>ct[2])&&(at=this.line.point2.coords.usrCoords,ct=this.line.point1.coords.usrCoords)):(at=this.line.point1.coords.usrCoords,ct=this.line.point2.coords.usrCoords),{x:(ct[1]-at[1])/ut,y:(ct[2]-at[2])/ut}},_isInsideCanvas:function(at,ct,ut){var ht=this.board.canvasWidth,dt=this.board.canvasHeight;return ut===void 0&&(ut=0),at[0]>=ut&&at[0]<=ht-ut&&ct[0]>=ut&&ct[0]<=dt-ut||at[1]>=ut&&at[1]<=ht-ut&&ct[1]>=ut&&ct[1]<=dt-ut},tickEndings:function(at,ct){var ut,ht,dt,ft,pt,mt,gt=[-2e6,-2e6],vt=[-2e6,-2e6];return ut=at.scrCoords,ct?(ft=this.dxMaj,pt=this.dyMaj,mt=this.majStyle):(ft=this.dxMin,pt=this.dyMin,mt=this.minStyle),ht=[-pt*ut[1]-ft*ut[2],pt,ft],mt==="infinite"?(dt=rt.meetLineBoard(ht,this.board),gt[0]=dt[0].scrCoords[1],gt[1]=dt[1].scrCoords[1],vt[0]=dt[0].scrCoords[2],vt[1]=dt[1].scrCoords[2]):(gt[0]=ut[1]+ft*ot.evaluate(this.visProp.tickendings[0]),vt[0]=ut[2]-pt*ot.evaluate(this.visProp.tickendings[0]),gt[1]=ut[1]-ft*ot.evaluate(this.visProp.tickendings[1]),vt[1]=ut[2]+pt*ot.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(gt,vt)?[gt,vt,ct]:[]},formatLabelText:function(at){var ct=at.toString(),ut=ot.evaluate(this.visProp.scalesymbol);return ot.isNumber(at)&&((ct.length>ot.evaluate(this.visProp.maxlabellength)||ct.indexOf("e")!==-1)&&(ct=at.toPrecision(ot.evaluate(this.visProp.precision)).toString()),ct.indexOf(".")>-1&&ct.indexOf("e")===-1&&(ct=ct.replace(/0+$/,""),ct=ct.replace(/\.$/,""))),ut.length>0&&(ct==="1"?ct=ut:ct==="-1"?ct="-"+ut:ct!=="0"&&(ct+=ut)),ot.evaluate(this.visProp.useunicodeminus)&&(ct=ct.replace(/-/g,"−")),ct},generateLabelText:function(at,ct,ut){var ht,dt=this.getDistanceFromZero(ct,at);return Math.abs(dt)<_e.eps?ht="0":(ot.exists(ut)||(ut=dt/ot.evaluate(this.visProp.scale)),ht=this.formatLabelText(ut)),ht},generateLabelData:function(at,ct,ut){var ht,dt,ft,pt;return pt=ot.evaluate(this.visProp.label.fontsize),ht=[ct.scrCoords[1],ct.scrCoords[1]],dt=[ct.scrCoords[2],ct.scrCoords[2]],ft=pt===void 0?12:pt,ft*=1.5,this._isInsideCanvas(ht,dt,ft)?(ht=ot.evaluate(this.visProp.label.offset[0]),dt=ot.evaluate(this.visProp.label.offset[1]),{x:ct.usrCoords[1]+ht/this.board.unitX,y:ct.usrCoords[2]+dt/this.board.unitY,t:at,i:ut}):null},update:function(){return this.needsUpdate&&this.board.canvasWidth!==0&&this.board.canvasHeight!==0&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var at,ct,ut,ht,dt,ft,pt,mt;for(ut=this.labelsData.length,ht=this.labels.length,at=0,ct=0;at<ut;at++)this.labelsData[at]!==null&&(pt=this.labelsData[at],ct<ht?(ft=this.labels[ct],ft.setText(pt.t),ft.setCoords(pt.x,pt.y),ct++):(this.labelCounter+=1,dt={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},dt=ot.deepCopy(dt,this.visProp.label),dt.id=this.id+pt.i+"Label"+this.labelCounter,ft=lt.createText(this.board,[pt.x,pt.y,pt.t],dt),ft.isDraggable=!1,ft.dump=!1,this.labels.push(ft)),mt=ot.evaluate(this.visProp.label.visible),mt==="inherit"&&(mt=this.visPropCalc.visible),ft.prepareUpdate().updateVisibility(mt).updateRenderer(),ft.distanceX=ot.evaluate(this.visProp.label.offset[0]),ft.distanceY=ot.evaluate(this.visProp.label.offset[1]));for(ut=ct,ct=ut;ct<ht;ct++)this.board.renderer.display(this.labels[ct],!1),this.labels[ct].visProp.visible=!1;return this},hideElement:function(){var at;for(tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),at=0;at<this.labels.length;at++)ot.exists(this.labels[at])&&this.labels[at].hideElement();return this},showElement:function(){var at;for(tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),at=0;at<this.labels.length;at++)ot.exists(this.labels[at])&&this.labels[at].showElement();return this}}),tt.createTicks=function(at,ct,ut){var ht,dt,ft=ot.copyAttributes(ut,at.options,"ticks");if(dt=ct.length<2?ft.ticksdistance:ct[1],ct[0].elementClass!==nt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof ct[0]+"'.");return ht=new tt.Ticks(ct[0],dt,ft),ot.isFunction(ft.generatelabelvalue)&&(ht.generateLabelText=ft.generatelabelvalue),ot.isFunction(ft.generatelabeltext)&&(ht.generateLabelText=ft.generatelabeltext),ht.setParents(ct[0]),ht.isDraggable=!0,ht.fullUpdate(ct[0].visPropCalc.visible),ht},tt.createHatchmark=function(at,ct,ut){var ht,dt,ft,pt,mt,gt,vt=[],At=ot.copyAttributes(ut,at.options,"hatch");if(ct[0].elementClass!==nt.OBJECT_CLASS_LINE||typeof ct[1]!="number")throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof ct[0]+"' and '"+typeof ct[1]+" and ''"+typeof ct[2]+"'.");for(ht=ct[1],pt=At.ticksdistance,mt=(ht-1)*pt,ft=.5*-mt,dt=0;dt<ht;dt++)vt[dt]=ft+dt*pt;return gt=at.create("ticks",[ct[0],vt],At),gt.elType="hatch",gt},tt.registerElement("ticks",tt.createTicks),tt.registerElement("hash",tt.createHatchmark),tt.registerElement("hatch",tt.createHatchmark),{Ticks:tt.Ticks,createTicks:tt.createTicks,createHashmark:tt.createHatchmark,createHatchmark:tt.createHatchmark}}),define("element/slider",["jxg","math/math","base/constants","utils/type","base/point","base/group","base/element","base/line","base/ticks","base/text"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct){return tt.createSlider=function(ut,ht,dt){var ft,pt,mt,gt,vt,At,yt,xt,_t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt;return Ft=nt.copyAttributes(dt,ut.options,"slider"),Bt=Ft.withticks,Ot=Ft.withlabel,Ut=Ft.snapwidth,jt=Ft.precision,Ft=nt.copyAttributes(dt,ut.options,"slider","point1"),yt=ut.create("point",ht[0],Ft),Ft=nt.copyAttributes(dt,ut.options,"slider","point2"),xt=ut.create("point",ht[1],Ft),Ft=nt.copyAttributes(dt,ut.options,"slider","baseline"),_t=ut.create("segment",[yt,xt],Ft),_t.updateStdform(),ft=yt.coords.usrCoords.slice(1),pt=xt.coords.usrCoords.slice(1),mt=ht[2][0],gt=ht[2][1],vt=ht[2][2],At=vt-mt,wt=ft[0]+(pt[0]-ft[0])*(gt-mt)/(vt-mt),Tt=ft[1]+(pt[1]-ft[1])*(gt-mt)/(vt-mt),Ft=nt.copyAttributes(dt,ut.options,"slider"),Ft.withLabel=!1,Mt=ut.create("glider",[wt,Tt,_t],Ft),Mt.setAttribute({snapwidth:Ut}),Ft=nt.copyAttributes(dt,ut.options,"slider","highline"),Pt=ut.create("segment",[yt,Mt],Ft),Mt.Value=function(){var Dt=this._smax-this._smin,Gt=nt.evaluate(this.visProp.snapwidth);return Gt===-1?this.position*Dt+this._smin:Math.round((this.position*Dt+this._smin)/Gt)*Gt},Mt.methodMap=nt.deepCopy(Mt.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),Mt._smax=vt,Mt._smin=mt,Mt.setMax=function(Dt){return this._smax=Dt,this},Mt.setValue=function(Dt){var Gt=this._smax-this._smin;return Math.abs(Gt)>_e.eps?this.position=(Dt-this._smin)/Gt:this.position=0,this.position=Math.max(0,Math.min(1,this.position)),this},Mt.setMin=function(Dt){return this._smin=Dt,this},Ot&&(Ft=nt.copyAttributes(dt,ut.options,"slider","label"),It=ut.create("text",[function(){return .05*(xt.X()-yt.X())+xt.X()},function(){return .05*(xt.Y()-yt.Y())+xt.Y()},function(){var Dt,Gt=nt.evaluate(Mt.visProp.suffixlabel),zt=nt.evaluate(Mt.visProp.unitlabel),$t=nt.evaluate(Mt.visProp.postlabel);return Dt=Gt!==null?Gt:Mt.name&&Mt.name!==""?Mt.name+" = ":"",Dt+=nt.toFixed(Mt.Value(),jt),zt!==null&&(Dt+=zt),$t!==null&&(Dt+=$t),Dt}],Ft),Mt.label=It,Mt.visProp.withlabel=!0,Mt.hasLabel=!0),Mt.point1=yt,Mt.point2=xt,Mt.baseline=_t,Mt.highline=Pt,Bt&&(Ft=nt.copyAttributes(dt,ut.options,"slider","ticks"),nt.exists(Ft.generatelabeltext)||(Ft.generateLabelText=function(Dt,Gt,zt){var $t=Mt.point1.Dist(Mt.point2),Ht=Mt._smin,er=Mt._smax,Zt=this.getDistanceFromZero(Gt,Dt)*(er-Ht)/$t+Ht;return $t<_e.eps||Math.abs(Zt)<_e.eps?"0":this.formatLabelText(Zt)}),Et=2,bt=ut.create("ticks",[Mt.baseline,Mt.point1.Dist(yt)/Et,function(Dt){var Gt=Mt.point1.Dist(Mt.point2),zt=Mt.point1.coords.distance(rt.COORDS_BY_USER,Dt);return Gt<_e.eps?0:zt/Gt*At+mt}],Ft),Mt.ticks=bt),Mt.remove=function(){Ot&&ut.removeObject(It),ut.removeObject(Pt),ut.removeObject(_t),ut.removeObject(xt),ut.removeObject(yt),it.Point.prototype.remove.call(Mt)},yt.dump=!1,xt.dump=!1,_t.dump=!1,Pt.dump=!1,Mt.elType="slider",Mt.parents=ht,Mt.subs={point1:yt,point2:xt,baseLine:_t,highLine:Pt},Mt.inherits.push(yt,xt,_t,Pt),Bt&&(bt.dump=!1,Mt.subs.ticks=bt,Mt.inherits.push(bt)),Mt},tt.registerElement("slider",tt.createSlider),{createSlider:tt.createSlider}}),define("element/measure",["jxg","utils/type","base/element","base/point","base/line","base/ticks"],function(tt,_e,rt,nt,it,st){return tt.createTapemeasure=function(ot,lt,at){var ct,ut,ht,dt,ft,pt,mt,gt,vt,At,yt;return ct=lt[0],ut=lt[1],ht=_e.copyAttributes(at,ot.options,"tapemeasure","point1"),gt=ot.create("point",ct,ht),ht=_e.copyAttributes(at,ot.options,"tapemeasure","point2"),vt=ot.create("point",ut,ht),gt.setAttribute({ignoredSnapToPoints:[vt]}),vt.setAttribute({ignoredSnapToPoints:[gt]}),ht=_e.copyAttributes(at,ot.options,"tapemeasure"),dt=ht.withticks,ft=ht.withlabel,pt=ht.precision,ft&&(ht.withlabel=!0),mt=ot.create("segment",[gt,vt],ht),ft&&(At=at.name&&at.name!==""?at.name+" = ":"",mt.label.setText(function(){return At+_e.toFixed(gt.Dist(vt),pt)})),dt&&(ht=_e.copyAttributes(at,ot.options,"tapemeasure","ticks"),yt=ot.create("ticks",[mt,.1],ht),mt.inherits.push(yt)),mt.remove=function(){dt&&mt.removeTicks(yt),ot.removeObject(vt),ot.removeObject(gt),rt.prototype.remove.call(this)},mt.Value=function(){return gt.Dist(vt)},gt.dump=!1,vt.dump=!1,mt.elType="tapemeasure",mt.getParents=function(){return[[gt.X(),gt.Y()],[vt.X(),vt.Y()]]},mt.subs={point1:gt,point2:vt},dt&&(yt.dump=!1),mt.methodMap=tt.deepCopy(mt.methodMap,{Value:"Value"}),mt.prepareUpdate().update(),ot.isSuspendedUpdate||(mt.updateVisibility().updateRenderer(),mt.point1.updateVisibility().updateRenderer(),mt.point2.updateVisibility().updateRenderer()),mt},tt.registerElement("tapemeasure",tt.createTapemeasure),{createTapemeasure:tt.createTapemeasure}}),define("parser/datasource",["jxg","utils/type"],function(tt,_e){return tt.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},tt.extend(tt.DataSource.prototype,{loadFromArray:function(rt,nt,it){var st,ot,lt;if(_e.isArray(nt)&&(this.columnHeaders=nt,nt=!1),_e.isArray(it)&&(this.rowHeaders=it,it=!1),this.data=[],nt&&(this.columnHeaders=[]),it&&(this.rowHeaders=[]),_e.exists(rt)){for(this.data=[],st=0;st<rt.length;st++)for(this.data[st]=[],ot=0;ot<rt[st].length;ot++)lt=rt[st][ot],parseFloat(lt).toString()===lt?this.data[st][ot]=parseFloat(lt):this.data[st][ot]=lt!=="-"?lt:NaN;if(nt&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),it)for(this.rowHeaders=[],st=0;st<this.data.length;st++)this.rowHeaders.push(this.data[st][0]),this.data[st]=this.data[st].slice(1)}return this},loadFromTable:function(rt,nt,it){var st,ot,lt,at,ct;if(_e.isArray(nt)&&(this.columnHeaders=nt,nt=!1),_e.isArray(it)&&(this.rowHeaders=it,it=!1),this.data=[],nt&&(this.columnHeaders=[]),it&&(this.rowHeaders=[]),rt=document.getElementById(rt),_e.exists(rt)){for(st=rt.getElementsByTagName("tr"),this.data=[],ot=0;ot<st.length;ot++)for(at=st[ot].getElementsByTagName("td"),this.data[ot]=[],lt=0;lt<at.length;lt++)ct=at[lt].innerHTML,parseFloat(ct).toString()===ct?this.data[ot][lt]=parseFloat(ct):this.data[ot][lt]=ct!=="-"?ct:NaN;if(nt&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),it)for(this.rowHeaders=[],ot=0;ot<this.data.length;ot++)this.rowHeaders.push(this.data[ot][0]),this.data[ot]=this.data[ot].slice(1)}return this},addColumn:function(rt,nt,it){throw new Error("not implemented")},addRow:function(rt,nt,it){throw new Error("not implemented")},getColumn:function(rt){var nt,it=[];if(_e.isString(rt)){for(nt=0;nt<this.columnHeaders.length;nt++)if(rt===this.columnHeaders[nt]){rt=nt;break}}for(nt=0;nt<this.data.length;nt++)this.data[nt].length>rt&&(it[nt]=parseFloat(this.data[nt][rt]));return it},getRow:function(rt){var nt,it;if(_e.isString(rt)){for(it=0;it<this.rowHeaders.length;it++)if(rt===this.rowHeaders[it]){rt=it;break}}for(nt=[],it=0;it<this.data[rt].length;it++)nt[it]=this.data[rt][it];return nt}}),tt.DataSource}),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],function(tt,_e,rt,nt,it,st,ot,lt,at,ct,ut,ht,dt,ft,pt,mt,gt,vt){return tt.Chart=function(At,yt,xt){this.constructor(At,xt);var _t,Et,bt,wt,Tt,Mt;if(!at.isArray(yt)||yt.length===0)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],at.isNumber(yt[0]))for(Et=yt,_t=[],bt=0;bt<Et.length;bt++)_t[bt]=bt+1;else if(yt.length===1&&at.isArray(yt[0]))for(Et=yt[0],_t=[],Mt=at.evaluate(Et).length,bt=0;bt<Mt;bt++)_t[bt]=bt+1;else yt.length===2&&(Mt=Math.min(yt[0].length,yt[1].length),_t=yt[0].slice(0,Mt),Et=yt[1].slice(0,Mt));if(at.isArray(Et)&&Et.length===0)throw new Error("JSXGraph: Can't create charts without data.");for(Tt=xt.chartstyle.replace(/ /g,"").split(","),bt=0;bt<Tt.length;bt++){switch(Tt[bt]){case"bar":wt=this.drawBar(At,_t,Et,xt);break;case"line":wt=this.drawLine(At,_t,Et,xt);break;case"fit":wt=this.drawFit(At,_t,Et,xt);break;case"spline":wt=this.drawSpline(At,_t,Et,xt);break;case"pie":wt=this.drawPie(At,Et,xt);break;case"point":wt=this.drawPoints(At,_t,Et,xt);break;case"radar":wt=this.drawRadar(At,yt,xt)}this.elements.push(wt)}return this.id=this.board.setId(this,"Chart"),this.elements},tt.Chart.prototype=new st,tt.extend(tt.Chart.prototype,{drawLine:function(At,yt,xt,_t){return _t.fillcolor="none",_t.highlightfillcolor="none",At.create("curve",[yt,xt],_t)},drawSpline:function(At,yt,xt,_t){return _t.fillColor="none",_t.highlightfillcolor="none",At.create("spline",[yt,xt],_t)},drawFit:function(At,yt,xt,_t){var Et=_t.degree;return Et=Math.max(parseInt(Et,10),1)||1,_t.fillcolor="none",_t.highlightfillcolor="none",At.create("functiongraph",[_e.regressionPolynomial(Et,yt,xt)],_t)},drawBar:function(At,yt,xt,_t){var Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft=[],jt=[],Dt=function(zt,$t){return function(){return yt[zt]()-$t*wt}},Gt={fixed:!0,withLabel:!1,visible:!1,name:""};if((Bt=at.copyAttributes(_t,At.options,"chart"))&&Bt.width)wt=Bt.width;else{if(yt.length<=1)wt=1;else for(wt=yt[1]-yt[0],Et=1;Et<yt.length-1;Et++)wt=yt[Et+1]-yt[Et]<wt?yt[Et+1]-yt[Et]:wt;wt*=.8}for(Ut=at.copyAttributes(_t,At.options,"chart","label"),Et=0;Et<yt.length;Et++)at.isFunction(yt[Et])?(Tt=Dt(Et,-.5),Mt=Dt(Et,0),Pt=Dt(Et,.5)):(Tt=yt[Et]-.5*wt,Mt=yt[Et],Pt=yt[Et]+.5*wt),It=at.isFunction(xt[Et])?xt[Et]():xt[Et],It=xt[Et],Bt.dir==="horizontal"?(jt[0]=At.create("point",[0,Tt],Gt),jt[1]=At.create("point",[It,Tt],Gt),jt[2]=At.create("point",[It,Pt],Gt),jt[3]=At.create("point",[0,Pt],Gt),at.exists(Bt.labels)&&at.exists(Bt.labels[Et])&&(Ut.anchorY="middle",bt=At.create("text",[It,Mt,Bt.labels[Et]],Ut),bt.visProp.anchorx=function(zt){return function(){return zt.X()>=0?"left":"right"}}(bt))):(jt[0]=At.create("point",[Tt,0],Gt),jt[1]=At.create("point",[Tt,It],Gt),jt[2]=At.create("point",[Pt,It],Gt),jt[3]=At.create("point",[Pt,0],Gt),at.exists(Bt.labels)&&at.exists(Bt.labels[Et])&&(Ut.anchorX="middle",bt=At.create("text",[Mt,It,Bt.labels[Et]],Ut),bt.visProp.anchory=function(zt){return function(){return zt.Y()>=0?"bottom":"top"}}(bt))),at.isArray(Bt.colors)&&(Ot=Bt.colors,Bt.fillcolor=Ot[Et%Ot.length]),Ft[Et]=At.create("polygon",jt,Bt),at.exists(Bt.labels)&&at.exists(Bt.labels[Et])&&(Ft[Et].text=bt);return Ft},drawPoints:function(At,yt,xt,_t){var Et,bt=[],wt=_t.infoboxarray;for(_t.fixed=!0,_t.name="",Et=0;Et<yt.length;Et++)_t.infoboxtext=!!wt&&wt[Et%wt.length],bt[Et]=At.create("point",[yt[Et],xt[Et]],_t);return bt},drawPie:function(At,yt,xt){var _t,Et,bt=[],wt=[],Tt=(rt.sum(yt),xt.colors),Mt=xt.highlightcolors,Pt=xt.labels,It=xt.radius||4,Ot=It,Bt=xt.center||[0,0],Ut=Bt[0],Ft=Bt[1],jt=function(Ht,er,Zt){return function(){var or,Kt,rr,ur=0;for(Kt=0;Kt<=Ht;Kt++)ur+=parseFloat(at.evaluate(yt[Kt]));for(or=ur,Kt=Ht+1;Kt<yt.length;Kt++)or+=parseFloat(at.evaluate(yt[Kt]));return rr=or!==0?2*Math.PI*ur/or:0,Ot()*Math[er](rr)+Zt}},Dt=function(Ht,er){var Zt=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],or=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];at.exists(this.label)&&(this.label.rendNode.style.fontSize=er*at.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new it(nt.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+Zt*Ht,this.point1.coords.usrCoords[2]+or*Ht],this.board),this.fullUpdate()},Gt=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),Dt.call(this,1.1,2))},zt=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),Dt.call(this,.9090909,1))},$t={fixed:!0,withLabel:!1,visible:!1,name:""};if(!at.isArray(Pt))for(Pt=[],_t=0;_t<yt.length;_t++)Pt[_t]="";for(at.isFunction(It)||(Ot=function(){return It}),xt.highlightonsector=xt.highlightonsector||!1,xt.straightfirst=!1,xt.straightlast=!1,Et=At.create("point",[Ut,Ft],$t),bt[0]=At.create("point",[function(){return Ot()+Ut},function(){return Ft}],$t),_t=0;_t<yt.length;_t++)bt[_t+1]=At.create("point",[jt(_t,"cos",Ut),jt(_t,"sin",Ft)],$t),xt.name=Pt[_t],xt.withlabel=xt.name!=="",xt.fillcolor=Tt&&Tt[_t%Tt.length],xt.labelcolor=Tt&&Tt[_t%Tt.length],xt.highlightfillcolor=Mt&&Mt[_t%Mt.length],wt[_t]=At.create("sector",[Et,bt[_t],bt[_t+1]],xt),xt.highlightonsector&&(wt[_t].hasPoint=wt[_t].hasPointSector),xt.highlightbysize&&(wt[_t].highlight=Gt,wt[_t].noHighlight=zt);return{sectors:wt,points:bt,midpoint:Et}},drawRadar:function(At,yt,xt){var _t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt,Dt,Gt,zt,$t,Ht,er,Zt,or,Kt,rr,ur,fr,dr,gr,Yt,xr,vr,Pr,Sr,Qr,Ir,Dr,Ur,Lr,Wr,Xt,Qt,hr,kr,yr,_r=yt.length,Hr=function(){var Ar,qt,pr,mr,nr=at.evaluate(this.visProp.label.offset).slice(0);return Ar=this.point1.X(),qt=this.point2.X(),pr=this.point1.Y(),mr=this.point2.Y(),qt<Ar&&(nr[0]=-nr[0]),mr<pr&&(nr[1]=-nr[1]),this.setLabelRelativeCoords(nr),new it(nt.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},Er=function(Ar,qt){var pr,mr,nr;return pr=At.create("transform",[-(Gt[qt]-jt[qt]),0],{type:"translate"}),mr=At.create("transform",[er/(zt[qt]+Dt[qt]-(Gt[qt]-jt[qt])),1],{type:"scale"}),pr.melt(mr),nr=At.create("transform",[Ar],{type:"rotate"}),pr.melt(nr),pr};if(_r<=0)return void tt.debug("No data");if(bt=xt.paramarray,!at.exists(bt))return void tt.debug("Need paramArray attribute");if((wt=bt.length)<=1)return void tt.debug("Need more than 1 param");for(_t=0;_t<_r;_t++)if(wt!==yt[_t].length)return void tt.debug("Use data length equal to number of params ("+yt[_t].length+" != "+wt+")");for(Tt=[],Mt=[],Et=0;Et<wt;Et++)Tt[Et]=yt[0][Et],Mt[Et]=Tt[Et];for(_t=1;_t<_r;_t++)for(Et=0;Et<wt;Et++)yt[_t][Et]>Tt[Et]&&(Tt[Et]=yt[_t][Et]),yt[_t][Et]<Mt[Et]&&(Mt[Et]=yt[_t][Et]);for(Pt=[],It=[],_t=0;_t<_r;_t++)Pt[_t]="",It[_t]=[];for(Ot=[],Bt=[],Ut=xt.startshiftratio||0,Ft=xt.endshiftratio||0,_t=0;_t<wt;_t++)Ot[_t]=(Tt[_t]-Mt[_t])*Ut,Bt[_t]=(Tt[_t]-Mt[_t])*Ft;if(jt=xt.startshiftarray||Ot,Dt=xt.endshiftarray||Bt,Gt=xt.startarray||Mt,at.exists(xt.start))for(_t=0;_t<wt;_t++)Gt[_t]=xt.start;if(zt=xt.endarray||Tt,at.exists(xt.end))for(_t=0;_t<wt;_t++)zt[_t]=xt.end;if(jt.length!==wt)return void tt.debug("Start shifts length is not equal to number of parameters");if(Dt.length!==wt)return void tt.debug("End shifts length is not equal to number of parameters");if(Gt.length!==wt)return void tt.debug("Starts length is not equal to number of parameters");if(zt.length!==wt)return void tt.debug("Ends length is not equal to number of parameters");for($t=xt.labelarray||Pt,Ht=xt.colors,xt.highlightcolors,er=xt.radius||10,kr=xt.strokewidth||1,at.exists(xt.highlightonsector)||(xt.highlightonsector=!1),Zt={name:xt.name,id:xt.id,strokewidth:kr,polystrokewidth:xt.polystrokewidth||kr,strokecolor:xt.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:xt.fillColor||"#FFFF88",fillopacity:xt.fillOpacity||.4,highlightfillcolor:xt.highlightFillColor||"#FF7400",highlightstrokecolor:xt.highlightStrokeColor||"black",gradient:xt.gradient||"none"},or=xt.center||[0,0],Kt=or[0],rr=or[1],ur=At.create("point",[Kt,rr],{name:"",fixed:!0,withlabel:!1,visible:!1}),fr=Math.PI/2-Math.PI/wt,fr=xt.startangle||0,dr=fr,gr=[],Yt=[],_t=0;_t<wt;_t++)for(dr+=2*Math.PI/wt,vr=er*Math.cos(dr)+Kt,Pr=er*Math.sin(dr)+rr,gr[_t]=At.create("point",[vr,Pr],{name:"",fixed:!0,withlabel:!1,visible:!1}),Yt[_t]=At.create("line",[ur,gr[_t]],{name:bt[_t],strokeColor:Zt.strokecolor,strokeWidth:Zt.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:Zt.highlightstrokecolor}),Yt[_t].getLabelAnchor=Hr,xr=Er(dr,_t),Et=0;Et<yt.length;Et++)yr=yt[Et][_t],It[Et][_t]=At.create("point",[yr,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),It[Et][_t].addTransform(It[Et][_t],xr);for(Sr=[],_t=0;_t<_r;_t++)for(Zt.labelcolor=Ht&&Ht[_t%Ht.length],Zt.strokecolor=Ht&&Ht[_t%Ht.length],Zt.fillcolor=Ht&&Ht[_t%Ht.length],Sr[_t]=At.create("polygon",It[_t],{withLines:!0,withLabel:!1,fillColor:Zt.fillcolor,fillOpacity:Zt.fillopacity,highlightFillColor:Zt.highlightfillcolor}),Et=0;Et<wt;Et++)Sr[_t].borders[Et].setAttribute("strokecolor:"+Ht[_t%Ht.length]),Sr[_t].borders[Et].setAttribute("strokewidth:"+Zt.polystrokewidth);switch(xt.legendposition||"none"){case"right":Ir=xt.legendleftoffset||2,Dr=xt.legendtopoffset||1,this.legend=At.create("legend",[Kt+er+Ir,rr+er-Dr],{labels:$t,colors:Ht});break;case"none":break;default:tt.debug("Unknown legend position")}if(Qr=[],xt.showcircles){for(Ur=[],_t=0;_t<6;_t++)Ur[_t]=20*_t;if(Ur[0]="0",Lr=xt.circlelabelarray||Ur,(Wr=Lr.length)<2)return void tt.debug("Too less circles");for(Xt=[],Qt=fr+Math.PI/wt,xr=Er(Qt,0),Zt.fillcolor="none",Zt.highlightfillcolor="none",Zt.strokecolor=xt.strokecolor||"black",Zt.strokewidth=xt.circlestrokewidth||.5,Zt.layer=0,hr=(zt[0]-Gt[0])/(Wr-1),_t=0;_t<Wr;_t++)Xt[_t]=At.create("point",[Gt[0]+_t*hr,0],{name:Lr[_t],size:0,fixed:!0,withLabel:!0,visible:!0}),Xt[_t].addTransform(Xt[_t],xr),Qr[_t]=At.create("circle",[ur,Xt[_t]],Zt)}return this.rendNode=Sr[0].rendNode,{circles:Qr,lines:Yt,points:It,midpoint:ur,polygons:Sr}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){}}),tt.createChart=function(At,yt,xt){var _t,Et,bt,wt,Tt,Mt,Pt,It,Ot,Bt,Ut,Ft,jt,Dt,Gt,zt,$t=[],Ht=ct.isBrowser?At.document.getElementById(yt[0]):null;if(yt.length===1&&at.isString(yt[0])){if(at.exists(Ht)){if(Ot=at.copyAttributes(xt,At.options,"chart"),Ht=new ot().loadFromTable(yt[0],Ot.withheaders,Ot.withheaders),_t=Ht.data,Tt=Ht.columnHeaders,Et=Ht.rowHeaders,Bt=Ot.width,Ut=Ot.name,Ft=Ot.strokecolor,jt=Ot.fillcolor,Dt=Ot.highlightstrokecolor,Gt=Ot.highlightfillcolor,At.suspendUpdate(),zt=_t.length,It=[],Ot.rows&&at.isArray(Ot.rows)){for(bt=0;bt<zt;bt++)for(wt=0;wt<Ot.rows.length;wt++)if(Ot.rows[wt]===bt||Ot.withheaders&&Ot.rows[wt]===Et[bt]){It.push(_t[bt]);break}}else It=_t;for(zt=It.length,bt=0;bt<zt;bt++){if(Pt=[],Ot.chartstyle&&Ot.chartstyle.indexOf("bar")!==-1){for(Mt=Bt||.8,Pt.push(1-Mt/2+(bt+.5)*Mt/zt),wt=1;wt<It[bt].length;wt++)Pt.push(Pt[wt-1]+1);Ot.width=Mt/zt}Ut&&Ut.length===zt?Ot.name=Ut[bt]:Ot.withheaders&&(Ot.name=Tt[bt]),Ft&&Ft.length===zt?Ot.strokecolor=Ft[bt]:Ot.strokecolor=lt.hsv2rgb((bt+1)/zt*360,.9,.6),jt&&jt.length===zt?Ot.fillcolor=jt[bt]:Ot.fillcolor=lt.hsv2rgb((bt+1)/zt*360,.9,1),Dt&&Dt.length===zt?Ot.highlightstrokecolor=Dt[bt]:Ot.highlightstrokecolor=lt.hsv2rgb((bt+1)/zt*360,.9,1),Gt&&Gt.length===zt?Ot.highlightfillcolor=Gt[bt]:Ot.highlightfillcolor=lt.hsv2rgb((bt+1)/zt*360,.9,.6),Ot.chartstyle&&Ot.chartstyle.indexOf("bar")!==-1?$t.push(new tt.Chart(At,[Pt,It[bt]],Ot)):$t.push(new tt.Chart(At,[It[bt]],Ot))}At.unsuspendUpdate()}return $t}return Ot=at.copyAttributes(xt,At.options,"chart"),new tt.Chart(At,yt,Ot)},tt.registerElement("chart",tt.createChart),tt.Legend=function(At,yt,xt){var _t;if(this.constructor(),_t=at.copyAttributes(xt,At.options,"legend"),this.board=At,this.coords=new it(nt.COORDS_BY_USER,yt,this.board),this.myAtts={},this.label_array=_t.labelarray||_t.labels,this.color_array=_t.colorarray||_t.colors,this.lines=[],this.myAtts.strokewidth=_t.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=_t.legendstyle||_t.style,this.style!=="vertical")throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(At,_t)},tt.Legend.prototype=new st,tt.Legend.prototype.drawVerticalLegend=function(At,yt){var xt,_t=yt.linelength||1,Et=(yt.rowheight||20)/this.board.unitY,bt=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new it(nt.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(xt=0;xt<this.label_array.length;xt++)this.myAtts.strokecolor=this.color_array[xt],this.myAtts.highlightstrokecolor=this.color_array[xt],this.myAtts.name=this.label_array[xt],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[xt],strokeWidth:this.myAtts.strokewidth},this.lines[xt]=At.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-xt*Et],[this.coords.usrCoords[1]+_t,this.coords.usrCoords[2]-xt*Et]],this.myAtts),this.lines[xt].getLabelAnchor=bt},tt.createLegend=function(At,yt,xt){var _t=[0,0];return at.exists(yt)&&yt.length===2&&(_t=yt),new tt.Legend(At,_t,xt)},tt.registerElement("legend",tt.createLegend),{Chart:tt.Chart,Legend:tt.Legend,createChart:tt.createChart,createLegend:tt.createLegend}}),define("base/turtle",["jxg","base/constants","base/element","utils/type","base/curve","base/point","base/line","base/transformation"],function(tt,_e,rt,nt,it,st,ot,lt){return tt.Turtle=function(at,ct,ut){var ht,dt,ft;return this.constructor(at,ut,_e.OBJECT_TYPE_TURTLE,_e.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=at,this.visProp.curveType="plot",this._attributes=nt.copyAttributes(this.visProp,at.options,"turtle"),delete this._attributes.id,ht=0,dt=0,ft=90,ct.length!==0&&(ct.length===3?(ht=ct[0],dt=ct[1],ft=ct[2]):ct.length===2?nt.isArray(ct[0])?(ht=ct[0][0],dt=ct[0][1],ft=ct[1]):(ht=ct[0],dt=ct[1]):(ht=ct[0][0],dt=ct[0][1])),this.init(ht,dt,ft),this.methodMap=nt.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},tt.Turtle.prototype=new rt,tt.extend(tt.Turtle.prototype,{init:function(at,ct,ut){var ht={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[at,ct],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,ht),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],ht),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-ut),this.board.update()},forward:function(at){if(at===0)return this;var ct,ut=at*Math.cos(this.dir*Math.PI/180),ht=at*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||(ct=this.board.create("transform",[ut,ht],{type:"translate"}),ct.applyOnce(this.turtle),ct.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=ut,this.pos[1]+=ht,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(at){return this.forward(-at)},right:function(at){return this.dir-=at,this.dir%=360,!this.turtleIsHidden&&this.board.create("transform",[-at*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2),this.board.update(),this},left:function(at){return this.right(-at)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var at,ct;for(at=0;at<this.objects.length;at++)ct=this.objects[at],ct.type===_e.OBJECT_TYPE_CURVE&&(this.board.removeObject(ct),this.objects.splice(at,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var at,ct,ut=this.objects.length;for(at=0;at<ut;at++)ct=this.objects[at],this.board.removeObject(ct);return this.init(0,0,90),this},setPos:function(at,ct){var ut;return nt.isArray(at)?this.pos=at:this.pos=[at,ct],this.turtleIsHidden||(this.turtle.setPositionDirectly(_e.COORDS_BY_USER,[at,ct]),this.turtle2.setPositionDirectly(_e.COORDS_BY_USER,[at,ct+this.arrowLen]),ut=this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}),ut.applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(at){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",at)),this.objects.push(this.curve),this},setPenColor:function(at){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",at)),this.objects.push(this.curve),this},setHighlightPenColor:function(at){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",at)),this.objects.push(this.curve),this},setAttribute:function(at){var ct,ut,ht,dt=this.objects.length;for(ct=0;ct<dt;ct++)ut=this.objects[ct],ut.type===_e.OBJECT_TYPE_CURVE&&ut.setAttribute(at);return ht=this.visProp.id,this.visProp=nt.deepCopy(this.curve.visProp),this.visProp.id=ht,this._attributes=nt.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(at,ct){return this._attributes[at.toLowerCase()]=ct,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var at=this.stack.pop();return this.pos[0]=at[0],this.pos[1]=at[1],this.dir=at[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(at){var ct,ut,ht,dt,ft;return nt.isArray(at)?(ct=this.pos[0],ut=this.pos[1],ht=at[0],dt=at[1],ft=Math.atan2(dt-ut,ht-ct),this.right(this.dir-180*ft/Math.PI)):nt.isNumber(at)&&this.right(this.dir-at),this},moveTo:function(at){var ct,ut,ht;return nt.isArray(at)&&(ct=at[0]-this.pos[0],ut=at[1]-this.pos[1],this.turtleIsHidden||(ht=this.board.create("transform",[ct,ut],{type:"translate"}),ht.applyOnce(this.turtle),ht.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=at[0],this.pos[1]=at[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(at){return this.forward(at)},bk:function(at){return this.back(at)},lt:function(at){return this.left(at)},rt:function(at){return this.right(at)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(at,ct){var ut,ht,dt,ft,pt=this.objects.length;for(ut=0,ht=0;ut<pt;ut++)if(dt=this.objects[ut],dt.elementClass===_e.OBJECT_CLASS_CURVE){if(ht<=at&&at<ht+dt.numberPoints)return ft=at-ht,dt[ct](ft);ht+=dt.numberPoints}return this[ct]()},X:function(at){return nt.exists(at)?this.evalAt(at,"X"):this.pos[0]},Y:function(at){return nt.exists(at)?this.evalAt(at,"Y"):this.pos[1]},Z:function(at){return 1},minX:function(){return 0},maxX:function(){var at,ct,ut=this.objects.length,ht=0;for(at=0;at<ut;at++)ct=this.objects[at],ct.elementClass===_e.OBJECT_CLASS_CURVE&&(ht+=this.objects[at].numberPoints);return ht},hasPoint:function(at,ct){var ut,ht;for(ut=0;ut<this.objects.length;ut++)if(ht=this.objects[ut],ht.type===_e.OBJECT_TYPE_CURVE&&ht.hasPoint(at,ct))return!0;return!1}}),tt.createTurtle=function(at,ct,ut){var ht;return ct=ct||[],ht=nt.copyAttributes(ut,at.options,"turtle"),new tt.Turtle(at,ct,ht)},tt.registerElement("turtle",tt.createTurtle),{Turtle:tt.Turtle,createTurtle:tt.createTurtle}}),define("parser/ca",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/env"],function(tt,_e,rt,nt,it,st,ot,lt){return tt.CA=function(at,ct,ut){this.node=at,this.createNode=ct,this.parser=ut},tt.extend(tt.CA.prototype,{findMapNode:function(at,ct){var ut,ht,dt;if(ct.value==="op_assign"&&ct.children[0].value===at)return ct.children[1];if(ct.children){for(ht=ct.children.length,ut=0;ut<ht;++ut)if((dt=this.findMapNode(at,ct.children[ut]))!==null)return dt}return null},setMath:function(at){var ct,ut;if((at.type!="node_op"||at.value!="op_add"&&at.value!="op_sub"&&at.value!="op_mul"&&at.value!="op_div"&&at.value!="op_neg"&&at.value!="op_execfun"&&at.value!="op_exp")&&at.type!="node_var"&&at.type!="node_const"||(at.isMath=!0),at.children)for(ut=at.children.length,ct=0;ct<ut;++ct)this.setMath(at.children[ct])},deriveElementary:function(at,ct){var ut,ht=at.children[0].value,dt=at.children[1];switch(ht){case"abs":ut=this.createNode("node_op","op_div",dt[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",ot.deepCopy(dt[0]),ot.deepCopy(dt[0]))]));break;case"sqrt":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(at.type,at.value,ot.deepCopy(at.children[0]),ot.deepCopy(at.children[1]))));break;case"sin":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),ot.deepCopy(dt));break;case"cos":ut=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),ot.deepCopy(dt)));break;case"tan":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),ot.deepCopy(dt)),this.createNode("node_const",2)));break;case"exp":ut=this.createNode(at.type,at.value,ot.deepCopy(at.children[0]),ot.deepCopy(at.children[1]));break;case"pow":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",ot.deepCopy(at.children[0]),ot.deepCopy(at.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(at.children[1][0],ct),this.createNode("node_op","op_div",ot.deepCopy(at.children[1][1]),ot.deepCopy(at.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(at.children[1][1],ct),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[ot.deepCopy(at.children[1][0])]))));break;case"log":case"ln":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),ot.deepCopy(dt[0]));break;case"log2":case"lb":case"ld":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),ot.deepCopy(dt[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),ot.deepCopy(dt[0])),this.createNode("node_const",.43429448190325176));break;case"asin":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",ot.deepCopy(dt[0]),ot.deepCopy(dt[0])))]));break;case"acos":ut=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",ot.deepCopy(dt[0]),ot.deepCopy(dt[0])))])));break;case"atan":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",ot.deepCopy(dt[0]),ot.deepCopy(dt[0]))));break;case"sinh":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[ot.deepCopy(dt[0])]);break;case"cosh":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[ot.deepCopy(dt[0])]);break;case"tanh":ut=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[ot.deepCopy(dt[0])]),this.createNode("node_const",2)));break;case"asinh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",ot.deepCopy(dt[0]),ot.deepCopy(dt[0])),this.createNode("node_const",1))]));break;case"acosh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",ot.deepCopy(dt[0]),ot.deepCopy(dt[0])),this.createNode("node_const",1))]));break;case"atanh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",ot.deepCopy(dt[0]),ot.deepCopy(dt[0]))));break;default:ut=this.createNode("node_const",0),this._error('Derivative of "'+ht+'" not yet implemented')}return ut},derivative:function(at,ct){var ut;switch(at.type){case"node_op":switch(at.value){case"op_execfun":ut=at.children[0].value=="pow"?this.deriveElementary(at,ct):this.createNode("node_op","op_mul",this.deriveElementary(at,ct),this.derivative(at.children[1][0],ct));break;case"op_div":ut=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(at.children[0],ct),ot.deepCopy(at.children[1])),this.createNode("node_op","op_mul",ot.deepCopy(at.children[0]),this.derivative(at.children[1],ct))),this.createNode("node_op","op_mul",ot.deepCopy(at.children[1]),ot.deepCopy(at.children[1])));break;case"op_mul":ut=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",ot.deepCopy(at.children[0]),this.derivative(at.children[1],ct)),this.createNode("node_op","op_mul",this.derivative(at.children[0],ct),ot.deepCopy(at.children[1])));break;case"op_neg":ut=this.createNode("node_op","op_neg",this.derivative(at.children[0],ct));break;case"op_add":case"op_sub":ut=this.createNode("node_op",at.value,this.derivative(at.children[0],ct),this.derivative(at.children[1],ct));break;case"op_exp":ut=this.createNode("node_op","op_mul",ot.deepCopy(at),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(at.children[0],ct),this.createNode("node_op","op_div",ot.deepCopy(at.children[1]),ot.deepCopy(at.children[0]))),this.createNode("node_op","op_mul",this.derivative(at.children[1],ct),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[ot.deepCopy(at.children[0])]))))}break;case"node_var":ut=at.value===ct?this.createNode("node_const",1):this.createNode("node_const",0);break;case"node_const":ut=this.createNode("node_const",0)}return ut},expandDerivatives:function(at,ct,ut){var ht,dt,ft,pt,mt,gt,vt,At,yt,xt,_t,Et;if(gt=0,!at)return gt;for(this.line=at.line,this.col=at.col,ht=at.children.length,dt=0;dt<ht;++dt)if(at.children[dt]&&at.children[dt].type)at.children[dt]=this.expandDerivatives(at.children[dt],at,ut);else if(ot.isArray(at.children[dt]))for(ft=0;ft<at.children[dt].length;++ft)at.children[dt][ft]&&at.children[dt][ft].type&&(at.children[dt][ft]=this.expandDerivatives(at.children[dt][ft],at,ut));switch(at.type){case"node_op":switch(at.value){case"op_execfun":if(at.children[0]&&at.children[0].value==="D"){if(at.children[1][0].type=="node_var"?(yt=at.children[1][0].value,pt=this.findMapNode(yt,ut),_t=pt.children[0],xt=at.children[1].length>=2?at.children[1][1].value:pt.children[0][0],mt=pt.children[1]):(mt=at.children[1][0],_t=["x"],xt=at.children[1].length>=2?at.children[1][1].value:"x"),Et=at.children[1].length>=3?at.children[1][2].value:1,At=mt,Et>=1)for(;Et>=1;)At=this.derivative(At,xt),At=this.removeTrivialNodes(At),Et--;vt=ct.type=="node_op"&&ct.value=="op_assign"?this.createNode("node_op","op_map",_t,At):At,this.setMath(vt),at.type=vt.type,at.value=vt.value,at.children[0]=vt.children[0],at.children[1]=vt.children[1]}}}return at},removeTrivialNodes:function(at){var ct,ut,ht,dt,ft;if(ot.isArray(at))for(ut=at.length,ct=0;ct<ut;++ct)at[ct]=this.removeTrivialNodes(at[ct]);if(at.type!="node_op"||!at.children)return at;for(ut=at.children.length,ct=0;ct<ut;++ct){this.mayNotBeSimplified=!1;do at.children[ct]=this.removeTrivialNodes(at.children[ct]);while(this.mayNotBeSimplified)}switch(at.value){case"op_map":if(ht=at.children[0],dt=at.children[1],dt.type=="node_var"){for(ct=0;ct<ht.length;++ct)if(ht[ct]==dt.value){dt.isMath=!0;break}}break;case"op_add":if(ht=at.children[0],dt=at.children[1],ht.type=="node_const"&&ht.value===0)return dt;if(dt.type=="node_const"&&dt.value===0)return ht;if(ht.type=="node_const"&&dt.type=="node_const")return ht.value+=dt.value,ht;break;case"op_mul":if(ht=at.children[0],dt=at.children[1],ht.type=="node_const"&&ht.value==1)return dt;if(dt.type=="node_const"&&dt.value==1||ht.type=="node_const"&&ht.value===0)return ht;if(dt.type=="node_const"&&dt.value===0||dt.type=="node_const"&&dt.value===0)return dt;if(ht.type=="node_op"&&ht.value=="op_neg"&&dt.type=="node_op"&&dt.value=="op_neg")return at.children=[ht.children[0],dt.children[0]],this.mayNotBeSimplified=!0,at;if(ht.value=="op_neg"&&dt.value!="op_neg")return at.type="node_op",at.value="op_neg",at.children=[this.createNode("node_op","op_mul",ht.children[0],dt)],this.mayNotBeSimplified=!0,at;if(ht.value!="op_neg"&&dt.value=="op_neg")return at.type="node_op",at.value="op_neg",at.children=[this.createNode("node_op","op_mul",ht,dt.children[0])],this.mayNotBeSimplified=!0,at;if(ht.value=="op_div"&&ht.children[0].type=="node_const"&&ht.children[0].value==1)return at.type="node_op",at.value="op_div",at.children=[dt,ht.children[1]],this.mayNotBeSimplified=!0,at;if(dt.value=="op_div"&&dt.children[0].type=="node_const"&&dt.children[0].value==1)return at.type="node_op",at.value="op_div",at.children=[ht,dt.children[1]],this.mayNotBeSimplified=!0,at;if(ht.type!="node_const"&&dt.type=="node_const")return at.children=[dt,ht],this.mayNotBeSimplified=!0,at;if(ht.type!="node_const"&&dt.type=="node_op"&&dt.value=="op_neg"&&dt.children[0].type=="node_const")return at.children=[dt,ht],this.mayNotBeSimplified=!0,at;if(ht.type=="node_op"&&ht.value!="op_execfun"&&(dt.type=="node_var"||dt.type=="node_op"&&dt.value=="op_execfun"))return at.children=[dt,ht],this.mayNotBeSimplified=!0,at;if(ht.type!="node_op"&&dt.type=="node_op"&&dt.value=="op_neg"&&dt.children[0].type=="node_var")return at.children=[dt,ht],this.mayNotBeSimplified=!0,at;if(ht.type!="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return ft=dt.children[0],dt.children[0]=ht,at.children=[ft,dt],this.mayNotBeSimplified=!0,at;if(dt.type!="node_const"&&ht.type=="node_op"&&ht.value=="op_mul"&&ht.children[0].type=="node_const")return at.children=[ht.children[0],this.createNode("node_op","op_mul",ht.children[1],dt)],this.mayNotBeSimplified=!0,at;if(ht.type=="node_const"&&dt.type=="node_const")return ht.value*=dt.value,ht;if(ht.type=="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return dt.children[0].value*=ht.value,dt;if(ht.hash=this.parser.compile(ht),dt.hash=this.parser.compile(dt),ht.hash===dt.hash)return at.value="op_exp",at.children[1]=this.createNode("node_const",2),at;if(ht.type=="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return dt.children[0].value*=ht.value,dt;if(dt.type=="node_op"&&dt.value=="op_exp"&&(ht.hash||(ht.hash=this.parser.compile(ht)),dt.children[0].hash||(dt.children[0].hash=this.parser.compile(dt.children[0])),ht.hash===dt.children[0].hash))return dt.children[1]=this.createNode("node_op","op_add",dt.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,dt;if(ht.type=="node_op"&&ht.value=="op_exp"&&dt.type=="node_op"&&dt.value=="op_exp"&&(ht.children[0].hash=this.parser.compile(ht.children[0]),dt.children[0].hash=this.parser.compile(dt.children[0]),ht.children[0].hash===dt.children[0].hash))return ht.children[1]=this.createNode("node_op","op_add",ht.children[1],dt.children[1]),this.mayNotBeSimplified=!0,ht;break;case"op_sub":if(ht=at.children[0],dt=at.children[1],ht.type=="node_const"&&ht.value===0)return at.value="op_neg",at.children[0]=dt,at;if(dt.type=="node_const"&&dt.value===0)return ht;if(ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value)return this.createNode("node_const",0);if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return this.createNode("node_const",0);if(ht.type=="node_const"&&dt.type=="node_const")return ht.value-=dt.value,ht;if(ht.type=="node_op"&&ht.value=="op_mul"&&dt.type=="node_op"&&dt.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.children[1].hash=this.parser.compile(dt.children[1]),ht.children[1].hash===dt.children[1].hash))return at.value="op_mul",at.children=[this.createNode("node_op","op_sub",ht.children[0],dt.children[0]),ht.children[1]],this.mayNotBeSimplified=!0,at;if(ht.type=="node_op"&&ht.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.hash=this.parser.compile(dt),ht.children[1].hash===dt.hash))return at.value="op_mul",at.children=[this.createNode("node_op","op_sub",ht.children[0],this.createNode("node_const",1)),dt],this.mayNotBeSimplified=!0,at;if(dt.type=="node_op"&&dt.value=="op_mul"&&(dt.children[1].hash=this.parser.compile(dt.children[1]),ht.hash=this.parser.compile(ht),dt.children[1].hash===ht.hash))return at.value="op_mul",at.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),dt.children[0]),ht],this.mayNotBeSimplified=!0,at;break;case"op_neg":if(ht=at.children[0],ht.type=="node_const"&&ht.value===0)return ht;if(ht.type=="node_op"&&ht.value=="op_neg")return ht.children[0];break;case"op_div":if(ht=at.children[0],dt=at.children[1],ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value&&ht.value!==0)return ht.value=1,ht;if(ht.type=="node_const"&&ht.value===0&&dt.type=="node_const"&&dt.value!==0)return ht.value=0,ht;if(ht.type=="node_const"&&ht.value===0&&(dt.type=="node_op"||dt.type=="node_var"))return at.type="node_const",at.value=0,at;if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return this.createNode("node_const",1);if(ht.type=="node_const"&&ht.value!==0&&dt.type=="node_const"&&dt.value===0)return ht.value>0?ht.value=1/0:ht.value=-1/0,ht;if(ht.type=="node_op"&&ht.value=="op_neg"&&dt.type=="node_op"&&dt.value=="op_neg")return at.children=[ht.children[0],dt.children[0]],this.mayNotBeSimplified=!0,at;if(ht.value=="op_neg"&&dt.value!="op_neg")return at.type="node_op",at.value="op_neg",at.children=[this.createNode("node_op","op_div",ht.children[0],dt)],this.mayNotBeSimplified=!0,at;if(ht.value!="op_neg"&&dt.value=="op_neg")return at.type="node_op",at.value="op_neg",at.children=[this.createNode("node_op","op_div",ht,dt.children[0])],this.mayNotBeSimplified=!0,at;if(ht.type=="node_op"&&ht.value=="op_exp"&&(dt.hash||(dt.hash=this.parser.compile(dt)),ht.children[0].hash||(ht.children[0].hash=this.parser.compile(ht.children[0])),dt.hash===ht.children[0].hash))return ht.children[1]=this.createNode("node_op","op_sub",ht.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,ht;if(dt.type!="node_const"&&ht.type=="node_op"&&ht.value=="op_mul"&&ht.children[0].type=="node_const")return at.value="op_mul",at.children=[ht.children[0],this.createNode("node_op","op_div",ht.children[1],dt)],this.mayNotBeSimplified=!0,at;if(ht.type=="node_op"&&ht.value=="op_exp"&&dt.type=="node_op"&&dt.value=="op_exp"&&(ht.children[0].hash=this.parser.compile(ht.children[0]),dt.children[0].hash=this.parser.compile(dt.children[0]),ht.children[0].hash===dt.children[0].hash))return ht.children[1]=this.createNode("node_op","op_sub",ht.children[1],dt.children[1]),this.mayNotBeSimplified=!0,ht;break;case"op_exp":if(ht=at.children[0],dt=at.children[1],dt.type=="node_const"&&dt.value===0)return dt.value=1,dt;if(dt.type=="node_const"&&dt.value==1||ht.type=="node_const"&&ht.value==1||ht.type=="node_const"&&ht.value===0&&dt.type=="node_const"&&dt.value!==0)return ht;if(ht.type=="node_op"&&ht.value=="op_exp")return at.children=[ht.children[0],this.createNode("node_op","op_mul",ht.children[1],dt)],at}switch(at.value){case"op_add":if(ht=at.children[0],dt=at.children[1],ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value)return ht.value+=dt.value,ht;if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return at.children[0]=this.createNode("node_const",2),at.value="op_mul",at;if(ht.type=="node_op"&&ht.value=="op_neg")return at.value="op_sub",at.children[0]=dt,at.children[1]=ht.children[0],this.mayNotBeSimplified=!0,at;if(dt.type=="node_op"&&dt.value=="op_neg")return at.value="op_sub",at.children[1]=dt.children[0],this.mayNotBeSimplified=!0,at;if(ht.type=="node_op"&&ht.value=="op_mul"&&dt.type=="node_op"&&dt.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.children[1].hash=this.parser.compile(dt.children[1]),ht.children[1].hash===dt.children[1].hash))return at.value="op_mul",at.children=[this.createNode("node_op","op_add",ht.children[0],dt.children[0]),ht.children[1]],this.mayNotBeSimplified=!0,at;if(ht.type=="node_op"&&ht.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.hash=this.parser.compile(dt),ht.children[1].hash===dt.hash))return at.value="op_mul",at.children=[this.createNode("node_op","op_add",ht.children[0],this.createNode("node_const",1)),dt],this.mayNotBeSimplified=!0,at;if(dt.type=="node_op"&&dt.value=="op_mul"&&(dt.children[1].hash=this.parser.compile(dt.children[1]),ht.hash=this.parser.compile(ht),dt.children[1].hash===ht.hash))return at.value="op_mul",at.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),dt.children[0]),ht],this.mayNotBeSimplified=!0,at;break;case"op_sub":if(ht=at.children[0],dt=at.children[1],dt.type=="node_op"&&dt.value=="op_neg")return at.value="op_add",at.children[1]=dt.children[0],this.mayNotBeSimplified=!0,at;break;case"op_execfun":return this.simplifyElementary(at)}return at},simplifyElementary:function(at){var ct=at.children[0].value,ut=at.children[1];if(ut.length==0)return at;switch(ct){case"sin":case"tan":if(ut[0].type=="node_const"&&ut[0].value===0||ut[0].type=="node_var"&&ut[0].value=="PI"||ut[0].type=="node_op"&&ut[0].value=="op_mul"&&ut[0].children[0].type=="node_const"&&ut[0].children[0].value%1==0&&ut[0].children[1].type=="node_var"&&ut[0].children[1].value=="PI")return at.type="node_const",at.value=0,at;break;case"cos":if(ut[0].type=="node_const"&&ut[0].value===0)return at.type="node_const",at.value=1,at;if(ut[0].type=="node_var"&&ut[0].value=="PI")return at.type="node_op",at.value="op_neg",at.children=[this.createNode("node_const",1)],at;break;case"exp":if(ut[0].type=="node_const"&&ut[0].value===0)return at.type="node_const",at.value=1,at;break;case"pow":if(ut[1].type=="node_const"&&ut[1].value===0)return at.type="node_const",at.value=1,at}return at}}),tt.CA}),define("utils/dump",["jxg","utils/type"],function(tt,_e){return tt.Dump={addMarkers:function(rt,nt,it){var st,ot,lt;_e.isArray(nt)||(nt=[nt]),_e.isArray(it)||(it=[it]),ot=Math.min(nt.length,it.length),nt.length=ot,it.length=ot;for(st in rt.objects)if(rt.objects.hasOwnProperty(st))for(lt=0;lt<ot;lt++)rt.objects[st][nt[lt]]=it[lt]},deleteMarkers:function(rt,nt){var it,st,ot;_e.isArray(nt)||(nt=[nt]),st=nt.length,nt.length=st;for(it in rt.objects)if(rt.objects.hasOwnProperty(it))for(ot=0;ot<st;ot++)delete rt.objects[it][nt[ot]]},str:function(rt){return typeof rt=="string"&&rt.substr(0,7)!=="function"&&(rt='"'+rt+'"'),rt},minimizeObject:function(rt,nt){var it,st,ot,lt={},at=_e.deepCopy(rt),ct=[];for(ot=1;ot<arguments.length;ot++)ct.push(arguments[ot]);for(lt=_e.deepCopy(lt,tt.Options.elements,!0),ot=ct.length;ot>0;ot--)lt=_e.deepCopy(lt,ct[ot-1],!0);for(it in lt)lt.hasOwnProperty(it)&&(st=it.toLowerCase(),typeof lt[it]!="object"&&lt[it]===at[st]&&(console.log("delete",it),delete at[st]));return at},prepareAttributes:function(rt,nt){var it,st;it=this.minimizeObject(nt.getAttributes(),tt.Options[nt.elType]);for(st in nt.subs)nt.subs.hasOwnProperty(st)&&(it[st]=this.minimizeObject(nt.subs[st].getAttributes(),tt.Options[nt.elType][st],tt.Options[nt.subs[st].elType]),it[st].id=nt.subs[st].id,it[st].name=nt.subs[st].name);return it.id=nt.id,it.name=nt.name,it},setBoundingBox:function(rt,nt,it){return rt.push({obj:it,method:"setBoundingBox",params:[nt.getBoundingBox(),!0]}),rt},dump:function(rt){var nt,it,st,ot,lt=[],at=[],ct=[],ut=rt.objectsList.length;for(this.addMarkers(rt,"dumped",!1),nt=0;nt<ut;nt++)if(it=rt.objectsList[nt],st={},!it.dumped&&it.dump){for(st.type=it.getType(),st.parents=it.getParents().slice(),st.type==="point"&&st.parents[0]===1&&(st.parents=st.parents.slice(1)),ot=0;ot<st.parents.length;ot++)_e.isString(st.parents[ot])&&st.parents[ot][0]!=="'"&&st.parents[ot][0]!=='"'?st.parents[ot]='"'+st.parents[ot]+'"':_e.isArray(st.parents[ot])&&(st.parents[ot]="["+st.parents[ot].toString()+"]");st.attributes=this.prepareAttributes(rt,it),st.type==="glider"&&it.onPolygon&&lt.push({obj:it.id,prop:"onPolygon",val:!0}),ct.push(st)}return this.deleteMarkers(rt,"dumped"),{elements:ct,props:lt,methods:at}},arrayToParamStr:function(rt,nt){var it,st=[];for(it=0;it<rt.length;it++)st.push(nt.call(this,rt[it]));return st.join(", ")},toJCAN:function(rt){var nt,it,st;switch(typeof rt){case"object":if(rt){if(it=[],_e.isArray(rt)){for(nt=0;nt<rt.length;nt++)it.push(this.toJCAN(rt[nt]));return"["+it.join(",")+"]"}for(st in rt)rt.hasOwnProperty(st)&&it.push(st+": "+this.toJCAN(rt[st]));return"<<"+it.join(", ")+">> "}return"null";case"string":return"'"+rt.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return rt.toString();case"null":return"null"}},toJessie:function(rt){var nt,it,st=this.dump(rt),ot=[];for(st.methods=this.setBoundingBox(st.methods,rt,"$board"),it=st.elements,nt=0;nt<it.length;nt++)it[nt].attributes.name.length>0&&ot.push("// "+it[nt].attributes.name),ot.push("s"+nt+" = "+it[nt].type+"("+it[nt].parents.join(", ")+") "+this.toJCAN(it[nt].attributes).replace(/\n/,"\\n")+";"),ot.push("");for(nt=0;nt<st.methods.length;nt++)ot.push(st.methods[nt].obj+"."+st.methods[nt].method+"("+this.arrayToParamStr(st.methods[nt].params,this.toJCAN)+");"),ot.push("");for(nt=0;nt<st.props.length;nt++)ot.push(st.props[nt].obj+"."+st.props[nt].prop+" = "+this.toJCAN(st.props[nt].val)+";"),ot.push("");return ot.join(`
`)},toJavaScript:function(rt){var nt,it,st=this.dump(rt),ot=[];for(st.methods=this.setBoundingBox(st.methods,rt,"board"),it=st.elements,nt=0;nt<it.length;nt++)ot.push('board.create("'+it[nt].type+'", ['+it[nt].parents.join(", ")+"], "+_e.toJSON(it[nt].attributes)+");");for(nt=0;nt<st.methods.length;nt++)ot.push(st.methods[nt].obj+"."+st.methods[nt].method+"("+this.arrayToParamStr(st.methods[nt].params,_e.toJSON)+");"),ot.push("");for(nt=0;nt<st.props.length;nt++)ot.push(st.props[nt].obj+"."+st.props[nt].prop+" = "+_e.toJSON(st.props[nt].val)+";"),ot.push("");return ot.join(`
`)}},tt.Dump}),define("element/comb",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point"],function(tt,_e,rt,nt,it,st,ot){return tt.createComb=function(lt,at,ct){var ut,ht,dt,ft,pt,mt,gt,vt,At;if(at.length!==2)throw pt=at.map(function(yt){return"'"+typeof yt+"'"}),new Error("JSXGraph: Can't create comb with parent types "+pt.join(", ")+`.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);if(rt.isArray(at[0])&&at[0].length>1)ft=rt.copyAttributes(ct,lt.options,"comb","point1"),ut=lt.create("point",at[0],ft);else if(rt.isString(at[0])||rt.isPoint(at[0]))ut=lt.select(at[0]);else if(rt.isFunction(at[0])&&rt.isPoint(at[0]()))ut=at[0]();else{if(!(rt.isFunction(at[0])&&at[0]().length&&at[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof at[0]+"' and '"+typeof at[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);ft=rt.copyAttributes(ct,lt.options,"comb","point1"),ut=ot.createPoint(lt,at[0](),ft)}if(rt.isArray(at[1])&&at[1].length>1)ft=rt.copyAttributes(ct,lt.options,"comb","point2"),ht=lt.create("point",at[1],ft);else if(rt.isString(at[1])||rt.isPoint(at[1]))ht=lt.select(at[1]);else if(rt.isFunction(at[1])&&rt.isPoint(at[1]()))ht=at[1]();else{if(!(rt.isFunction(at[1])&&at[1]().length&&at[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof at[0]+"' and '"+typeof at[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);ft=rt.copyAttributes(ct,lt.options,"comb","point2"),ht=ot.createPoint(lt,at[1](),ft)}return ft=rt.copyAttributes(ct,lt.options,"comb","curve"),dt=lt.create("curve",[[0],[0]],ft),ft=rt.copyAttributes(ct,lt.options,"comb"),mt=ft.frequency,gt=-ft.angle,vt=ft.width,ft.reverse&&(At=ut,ut=ht,ht=At,gt=-gt),dt.updateDataArray=function(){var yt,xt,_t,Et=0,bt=ut.Dist(ht),wt=Math.cos(gt),Tt=Math.sin(gt),Mt=(ht.X()-ut.X())/bt,Pt=(ht.Y()-ut.Y())/bt;for(wt*=vt/Math.abs(Tt),Tt*=vt/Math.abs(Tt),this.dataX=[],this.dataY=[];Et<bt;)yt=ut.X()+Mt*Et,xt=ut.Y()+Pt*Et,_t=Math.min(wt,bt-Et)/Math.abs(wt),Tt*=_t,wt*=_t,this.dataX.push(yt),this.dataY.push(xt),this.dataX.push(yt+Mt*wt+Pt*Tt),this.dataY.push(xt-Mt*Tt+Pt*wt),this.dataX.push(NaN),this.dataY.push(NaN),Et+=mt},dt},tt.registerElement("comb",tt.createComb),{createComb:tt.createComb}}),define("element/slopetriangle",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point","base/element"],function(tt,_e,rt,nt,it,st,ot,lt){var at={removeSlopeTriangle:function(){st.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},Value:function(){return this.tangent.getSlope()}};return tt.createSlopeTriangle=function(ct,ut,ht){var dt,ft,pt,mt,gt,vt,At,yt,xt,_t=!1;if(ut.length===1&&ut[0].type===nt.OBJECT_TYPE_TANGENT)ft=ut[0],pt=ft.glider;else if(ut.length===1&&ut[0].type===nt.OBJECT_TYPE_GLIDER)pt=ut[0],xt=rt.copyAttributes(ht,ct.options,"slopetriangle","tangent"),ft=ct.create("tangent",[pt],xt),_t=!0;else{if(ut.length!==2||ut[0].elementClass!==nt.OBJECT_CLASS_LINE||!rt.isPoint(ut[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof ut[0]+"'.");ft=ut[0],pt=ut[1]}return xt=rt.copyAttributes(ht,ct.options,"slopetriangle","basepoint"),At=ct.create("point",[function(){return[pt.X()+1,pt.Y()]}],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","baseline"),vt=ct.create("line",[pt,At],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","glider"),mt=ct.create("glider",[pt.X()+1,pt.Y(),vt],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","toppoint"),gt=ct.create("point",[function(){return[mt.X(),mt.Y()+(mt.X()-pt.X())*ft.getSlope()]}],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle"),xt.borders=rt.copyAttributes(xt.borders,ct.options,"slopetriangle","borders"),dt=ct.create("polygon",[pt,mt,gt],xt),dt.Value=at.Value,dt.tangent=ft,dt._isPrivateTangent=_t,dt.borders[2].setArrow(!1,!1),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","label"),yt=ct.create("text",[function(){return mt.X()+.1},function(){return .5*(mt.Y()+gt.Y())},function(){return""}],xt),yt._setText(function(){return rt.toFixed(dt.Value(),rt.evaluate(yt.visProp.digits))}),yt.fullUpdate(),dt.glider=mt,dt.basepoint=At,dt.baseline=vt,dt.toppoint=gt,dt.label=yt,dt.subs={glider:mt,basePoint:At,baseLine:vt,topPoint:gt,label:yt},dt.inherits.push(mt,At,vt,gt,yt),dt.methodMap=tt.deepCopy(dt.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),dt.remove=at.removeSlopeTriangle,dt},tt.registerElement("slopetriangle",tt.createSlopeTriangle),{createSlopeTriangle:tt.createSlopeTriangle}}),define("element/checkbox",["jxg","utils/env","utils/type"],function(tt,_e,rt){var nt={CheckboxChangeEventHandler:function(){this._value=this.rendNodeCheckbox.checked,this.board.update()}};return tt.createCheckbox=function(it,st,ot){var lt,at,ct=rt.copyAttributes(ot,it.options,"checkbox");return at=[st[0],st[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],lt=it.create("text",at,ct),lt.type=rt.OBJECT_TYPE_CHECKBOX,lt.rendNodeCheckbox=lt.rendNode.childNodes[0].childNodes[0],lt.rendNodeLabel=lt.rendNode.childNodes[0].childNodes[1],lt.rendNodeTag=lt.rendNodeCheckbox,lt.rendNodeTag.disabled=!!ct.disabled,lt.rendNodeLabel.innerHTML=st[2],lt.rendNodeCheckbox.id=lt.rendNode.id+"_checkbox",lt.rendNodeLabel.id=lt.rendNode.id+"_label",lt.rendNodeLabel.setAttribute("for",lt.rendNodeCheckbox.id),lt.visPropOld.fontsize="0px",it.renderer.updateTextStyle(lt,!1),lt.rendNodeCheckbox.checked=ct.checked,lt._value=ct.checked,lt.Value=function(){return this._value},lt.update=function(){return this.needsUpdate&&(tt.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},_e.addEvent(lt.rendNodeCheckbox,"change",nt.CheckboxChangeEventHandler,lt),lt},tt.registerElement("checkbox",tt.createCheckbox),{createCheckbox:tt.createCheckbox}}),define("element/input",["jxg","utils/env","utils/type"],function(tt,_e,rt){var nt={InputInputEventHandler:function(it){this._value=this.rendNodeInput.value,this.board.update()}};return tt.createInput=function(it,st,ot){var lt,at,ct=rt.copyAttributes(ot,it.options,"input");return at=[st[0],st[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+ct.maxlength+'" style="width:100%"/></span>'],lt=it.create("text",at,ct),lt.type=rt.OBJECT_TYPE_INPUT,lt.rendNodeLabel=lt.rendNode.childNodes[0].childNodes[0],lt.rendNodeInput=lt.rendNode.childNodes[0].childNodes[1],lt.rendNodeLabel.innerHTML=st[3],lt.rendNodeInput.value=st[2],lt.rendNodeTag=lt.rendNodeInput,lt.rendNodeTag.disabled=!!ct.disabled,lt.rendNodeLabel.id=lt.rendNode.id+"_label",lt.rendNodeInput.id=lt.rendNode.id+"_input",lt._value=st[2],lt.update=function(){return this.needsUpdate&&(tt.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},lt.Value=function(){return this._value},_e.addEvent(lt.rendNodeInput,"input",nt.InputInputEventHandler,lt),_e.addEvent(lt.rendNodeInput,"mousedown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeInput,"touchstart",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeInput,"pointerdown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),lt.visPropOld.fontsize="0px",it.renderer.updateTextStyle(lt,!1),lt},tt.registerElement("input",tt.createInput),{createInput:tt.createInput}}),define("element/button",["jxg","utils/env","utils/type"],function(tt,_e,rt){var nt={ButtonClickEventHandler:function(){this._handler&&this._handler(),this.board.update()}};return tt.createButton=function(it,st,ot){var lt,at,ct=rt.copyAttributes(ot,it.options,"button");return at=[st[0],st[1],'<button type="button" style="width:100%;"></button>'],lt=it.create("text",at,ct),lt.type=rt.OBJECT_TYPE_BUTTON,lt.rendNodeButton=lt.rendNode.childNodes[0],lt.rendNodeButton.id=lt.rendNode.id+"_button",lt.rendNodeButton.innerHTML=st[2],lt.rendNodeTag=lt.rendNodeButton,lt.rendNodeTag.disabled=!!ct.disabled,lt.visPropOld.fontsize="0px",it.renderer.updateTextStyle(lt,!1),st[3]&&(rt.isString(st[3])?(lt._jc=new tt.JessieCode,lt._jc.use(it),lt._handler=function(){lt._jc.parse(st[3])}):lt._handler=st[3]),_e.addEvent(lt.rendNodeButton,"click",nt.ButtonClickEventHandler,lt),_e.addEvent(lt.rendNodeButton,"mousedown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeButton,"touchstart",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeButton,"pointerdown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),lt},tt.registerElement("button",tt.createButton),{createButton:tt.createButton}}),define("../build/core.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/qdt","math/numerics","math/statistics","math/symbolic","math/geometry","math/poly","math/complex","renderer/abstract","renderer/no","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","parser/datasource","parser/jessiecode","parser/ca","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button"],function(tt,_e){return _e.isBrowser?window.JXG=tt:_e.isNode()?module.exports=tt:_e.isWebWorker()&&(self.JXG=tt),tt}),require("../build/core.deps.js")})});jsxgraphcore.parser;jsxgraphcore.Parser;jsxgraphcore.parse;jsxgraphcore.main;var classCallCheck=function(tt,_e){if(!(tt instanceof _e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function tt(_e,rt){for(var nt=0;nt<rt.length;nt++){var it=rt[nt];it.enumerable=it.enumerable||!1,it.configurable=!0,"value"in it&&(it.writable=!0),Object.defineProperty(_e,it.key,it)}}return function(_e,rt,nt){return rt&&tt(_e.prototype,rt),nt&&tt(_e,nt),_e}}(),inherits=function(tt,_e){if(typeof _e!="function"&&_e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _e);tt.prototype=Object.create(_e&&_e.prototype,{constructor:{value:tt,enumerable:!1,writable:!0,configurable:!0}}),_e&&(Object.setPrototypeOf?Object.setPrototypeOf(tt,_e):tt.__proto__=_e)},possibleConstructorReturn=function(tt,_e){if(!tt)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _e&&(typeof _e=="object"||typeof _e=="function")?_e:tt},JXGBoard=function(tt){inherits(_e,tt);function _e(rt){classCallCheck(this,_e);var nt=possibleConstructorReturn(this,(_e.__proto__||Object.getPrototypeOf(_e)).call(this,rt));return nt.id="board_"+Math.random().toString(36).substr(2,9),nt.state={board:null},nt.defaultStyle={width:500,height:500},nt.defauflboardAttributes={},nt}return createClass(_e,[{key:"getChildContext",value:function(){return{board:this.state.board}}},{key:"componentDidMount",value:function(){var nt={};Object.assign(nt,this.defauflboardAttributes,this.props.boardAttributes||{});var it=jsxgraphcore.JSXGraph.initBoard(this.id,nt);this.props.jessieCode?it.jc.parse(this.props.logic):this.props.logic(it),this.setState({board:it})}},{key:"render",value:function(){var nt=assign_1(this.defaultStyle,this.props.style||{});return React.createElement("div",{id:this.id,className:"jxgbox "+this.props.className,style:nt})}}]),_e}(reactExports.Component);JXGBoard.propTypes={style:PropTypes.object,className:PropTypes.string,logic:PropTypes.oneOfType([PropTypes.func,PropTypes.string]).isRequired,boardAttributes:PropTypes.object,jessieCode:PropTypes.bool};let logicJC$1=`
$board.setView([-1.5, 2, 1.5, -1]);

// Triangle ABC
A = point(1, 0);
B = point(-1, 0);
C = point(0.2, 1.5);
pol = polygon(A,B,C) <<
        fillColor: '#FFFF00',
        borders: <<
            strokeWidth: 2,
            strokeColor: '#009256'
        >>
    >>;

// Midpoints of segments
mAB = midpoint(A, B);
mBC = midpoint(B, C);
mCA = midpoint(C, A);

// Line bisectors and centroid i2
ma = segment(mBC, A);
mb = segment(mCA, B);
mc = segment(mAB, C);
i2 = intersection(ma, mc, 0);
`;class JSXGraphReact extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"무게중심 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJC$1,style:{border:"3px solid red"},jessieCode:!0})]})}}let logicJC=`
$board.setView([-1.5, 2, 1.5, -1]);

// Triangle ABC
A = point(1, 0);
B = point(-1, 0);
C = point(0.2, 1.5);
pol = polygon(A,B,C) <<
        fillColor: '#FFFF00',
        borders: <<
            strokeWidth: 2,
            strokeColor: '#009256'
        >>
    >>;

// Midpoints of segments
mAB = midpoint(A, B);
mBC = midpoint(B, C);
mCA = midpoint(C, A);

// Perpendiculars and orthocenter i1
pABC = perpendicular(pol.borders[0], mAB);
pBCA = perpendicular(pol.borders[1], mBC);
pCAB = perpendicular(pol.borders[2], mCA);
i1 = intersection(pABC, pCAB, 0);

// Circum circle and circum center
c = circumcircle(A, B, C) <<
        strokeColor: '#000000',
        dash: 3,
        strokeWidth: 1,
        center: <<
            name: 'i_3',
            withlabel:true,
            visible: true
        >>
    >>;
`;class JSXGraphReact2 extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각형의  외심 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJC,style:{border:"3px solid red"},jessieCode:!0})]})}}let logicJS$9=tt=>{tt.suspendUpdate();var st=tt.create("point",[0,0]),_e=tt.create("point",[4,0]),rt=tt.create("circle",[st,_e]),nt=tt.create("circle",[_e,st],{strokeColor:"blue"}),it=tt.create("intersection",[rt,nt,0]),st=tt.create("polygon",[st,_e,it]);tt.unsuspendUpdate()},JSXGraphComponent$9=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"정삼각형 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$9,boardAttributes:{axis:!0,boundingbox:[-10,10,10,-10]},style:{border:"3px solid red"}})]})}},logicJS$8=tt=>{tt.suspendUpdate();var _e=tt.create("point",[-10,-5],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),rt=tt.create("point",[2,5],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),mt=tt.create("point",[7,-5],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),nt=tt.create("segment",[_e,rt],{strokeColor:"black",strokeWidth:3}),it=tt.create("segment",[rt,mt],{strokeColor:"black",strokeWidth:3}),st=tt.create("segment",[mt,_e],{strokeColor:"black",strokeWidth:3}),ot=tt.create("bisector",[_e,rt,mt],{name:"bABC",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1}),lt=tt.create("bisector",[mt,_e,rt],{name:"bCAB",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1}),at=tt.create("intersection",[ot,lt,0],{name:"F",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5});tt.create("angle",[_e,rt,at],{radius:2,fillColor:"blue",strokeColor:"blue",strokeWidth:2}),tt.create("angle",[at,rt,mt],{radius:2,fillColor:"blue",strokeColor:"blue",strokeWidth:2}),tt.create("angle",[at,_e,rt],{radius:2,fillColor:"red",strokeColor:"red",strokeWidth:2}),tt.create("angle",[mt,_e,at],{radius:2,fillColor:"red",strokeColor:"red",strokeWidth:2});var ct=tt.create("perpendicularsegment",[nt,at]);tt.create("hatch",[ct,2]);var ut=tt.create("perpendicularsegment",[it,at]);tt.create("hatch",[ut,2]);var ht=tt.create("perpendicularsegment",[st,at]);tt.create("hatch",[ht,2]);var dt=tt.create("intersection",[ct,nt,0],{name:"G",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),ft=tt.create("intersection",[ut,it,0],{name:"H",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),pt=tt.create("intersection",[ht,st,0],{name:"I",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5});tt.create("angle",[_e,dt,at],{radius:1}),tt.create("angle",[rt,ft,at],{radius:1}),tt.create("angle",[mt,pt,at],{radius:1});var mt=tt.create("circle",[at,ct],{strokeColor:"#0099FF",strokeWidth:3});tt.unsuspendUpdate()},JSXGraphComponent$8=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각형의 내심과 내접원의 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$8,boardAttributes:{axis:!0,boundingbox:[-10,10,10,-10]},style:{border:"3px solid red"}})]})}};function degrees_to_radians$1(tt){var _e=Math.PI;return tt*(_e/180)}let logicJS$7=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-6,5],[-2.5,5],[0,325,360]],{name:"&theta;",snapWidth:1,fillColor:"white",strokeColor:"green",postLabel:"°",precision:0,label:{fontSize:18,strokeColor:"red",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"green",strokeWidth:1},highline:{strokeColor:"green",strokeWidth:3}});tt.create("functiongraph",[function(ft){return 2*Math.sin(ft)},-10,10],{strokeColor:"green",strokeWidth:2});var rt=tt.create("point",[-5,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:0,fixed:!0}),nt=tt.create("point",[-3,0],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2,fixed:!0}),it=tt.create("point",[-1,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),st=tt.create("line",[rt,nt],{strokeColor:"black",strokeWidth:0});tt.create("segment",[nt,it],{strokeColor:"black",strokeWidth:2}),tt.create("point",[0,0],{name:"O",withLabel:!0,visible:!0,color:"gray",strokeColor:"black",strokeWidth:1,size:2,fixed:!0});var ot=tt.create("point",[-1,0],{name:"",withLabel:!0,visible:!1,color:"gray",strokeColor:"black",strokeWidth:1,size:2,fixed:!0}),lt=tt.create("angle",[ot,nt,it],{radius:.5,strokeWidth:1,color:"green",name:function(){return _e.Value()+"°"}});lt.setAngle(function(){return degrees_to_radians$1(_e.Value())}),tt.update(),tt.create("circle",[nt,2],{strokeColor:"#0099FF",strokeWidth:3});var at=tt.create("point",[function(){return degrees_to_radians$1(_e.Value())},function(){return 2*Math.sin(degrees_to_radians$1(_e.Value()))}],{name:"P",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3}),ct=tt.create("perpendicular",[st,it],{strokeColor:"red",strokeWidth:0}),ut=tt.create("intersection",[ct,st,0],{name:"B",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:0});tt.create("segment",[it,ut],{strokeColor:"red",strokeWidth:2});var ht=tt.create("perpendicular",[st,at],{strokeColor:"red",strokeWidth:0}),dt=tt.create("intersection",[ht,st,0],{name:"C",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:0});tt.create("segment",[at,dt],{strokeColor:"red",strokeWidth:2}),tt.create("segment",[at,it],{strokeColor:"blue",dash:2,strokeWidth:1}),tt.unsuspendUpdate()},JSXGraphComponent$7=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각함수 사인함수"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$7,boardAttributes:{boundingBox:[-7,7,7,-7],axis:!0},style:{border:"3px solid blue"}})]})}};function degrees_to_radians(tt){var _e=Math.PI;return tt*(_e/180)}let logicJS$6=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-6,5],[-2.5,5],[0,325,360]],{name:"&theta;",snapWidth:1,fillColor:"white",strokeColor:"green",postLabel:"°",precision:0,label:{fontSize:18,strokeColor:"red",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"green",strokeWidth:1},highline:{strokeColor:"green",strokeWidth:3}});tt.create("functiongraph",[function(ft){return 2*Math.cos(ft)},-10,10],{strokeColor:"green",strokeWidth:2});var rt=tt.create("point",[-5,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:0,fixed:!0}),nt=tt.create("point",[-3,0],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2,fixed:!0}),it=tt.create("point",[-1,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),st=tt.create("line",[rt,nt],{strokeColor:"black",strokeWidth:0});tt.create("segment",[nt,it],{strokeColor:"black",strokeWidth:2}),tt.create("point",[0,0],{name:"O",withLabel:!0,visible:!0,color:"gray",strokeColor:"black",strokeWidth:1,size:2,fixed:!0});var ot=tt.create("point",[-1,0],{name:"",withLabel:!0,visible:!1,color:"gray",strokeColor:"black",strokeWidth:1,size:2,fixed:!0}),lt=tt.create("angle",[ot,nt,it],{radius:.5,strokeWidth:1,color:"green",name:function(){return _e.Value()+"°"}});lt.setAngle(function(){return degrees_to_radians(_e.Value())}),tt.update(),tt.create("circle",[nt,2],{strokeColor:"#0099FF",strokeWidth:3});var at=tt.create("point",[function(){return degrees_to_radians(_e.Value())},function(){return 2*Math.cos(degrees_to_radians(_e.Value()))}],{name:function(){return Number(2*Math.cos(degrees_to_radians(_e.Value()))).toFixed(2)},withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3}),ct=tt.create("perpendicular",[st,it],{strokeColor:"red",strokeWidth:0}),ut=tt.create("intersection",[ct,st,0],{name:function(){return Number(2*Math.cos(degrees_to_radians(_e.Value()))).toFixed(2)},withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:0});tt.create("segment",[nt,ut],{strokeColor:"red",strokeWidth:2});var ht=tt.create("perpendicular",[st,at],{strokeColor:"red",strokeWidth:0}),dt=tt.create("intersection",[ht,st,0],{name:"C",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:0});tt.create("segment",[at,dt],{strokeColor:"red",strokeWidth:2}),tt.unsuspendUpdate()},JSXGraphComponent$6=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각함수 코사인함수"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$6,boardAttributes:{boundingBox:[-7,7,7,-7],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$5=tt=>{tt.suspendUpdate();var _e=tt.create("point",[-3,19],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),rt=tt.create("point",[-22,-7],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),nt=tt.create("point",[30,1],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2});tt.create("polygon",[_e,rt,nt],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2});var it=tt.create("midpoint",[rt,nt],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:0}),st=tt.create("midpoint",[_e,nt],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:0}),ot=tt.create("segment",[_e,it],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:0,size:0}),lt=tt.create("segment",[rt,st],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:0,size:0}),at=tt.create("intersection",[ot,lt,0],{name:"G",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),ct=tt.create("point",[0,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:0,fixed:!0});tt.create("arrow",[ct,at],{name:"",visible:!0,strokeColor:"black"}),tt.create("arrow",[ct,rt],{name:"",visible:!0,strokeColor:"black"}),tt.create("arrow",[ct,nt],{name:"",visible:!0,strokeColor:"black"}),tt.create("arrow",[ct,_e],{name:"",visible:!0,strokeColor:"black"}),tt.unsuspendUpdate()},JSXGraphComponent$5=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"무게중심 (벡터)"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$5,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$4=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-30,30],[-10,30],[-10,2,10]],{name:"ratio",fillColor:"white",strokeColor:"green",postLabel:"",precision:0,label:{fontSize:18,strokeColor:"red",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"green",strokeWidth:1},highline:{strokeColor:"green",strokeWidth:3}}),rt=tt.create("point",[2,8],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),nt=tt.create("point",[9,9],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),it=tt.create("point",[11,3],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),st=tt.create("polygon",[rt,nt,it],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),ot=tt.create("point",[0,0],{name:"O",withLabel:!0,visible:!0,strokeColor:"yellow",strokeWidth:1,size:3,fixed:!0});tt.create("segment",[rt,ot],{strokeColor:"black",strokeWidth:1,dash:1}),tt.create("segment",[nt,ot],{strokeColor:"black",strokeWidth:1,dash:1}),tt.create("segment",[it,ot],{strokeColor:"black",strokeWidth:1,dash:1});var lt=tt.create("transform",[function(){return _e.Value()},function(){return _e.Value()}],{type:"scale"}),at=tt.create("polygon",[st,lt],{vertices:{withLabel:!0,strokeColor:"blue",strokeWidth:1,size:2}});tt.create("segment",[at.vertices[0],ot],{strokeColor:"black",strokeWidth:1,dash:1}),tt.create("segment",[at.vertices[1],ot],{strokeColor:"black",strokeWidth:1,dash:1}),tt.create("segment",[at.vertices[2],ot],{strokeColor:"black",strokeWidth:1,dash:1}),tt.unsuspendUpdate()},JSXGraphComponent$4=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"Dilation"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$4,boardAttributes:{boundingBox:[-40,40,40,-40],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$3=tt=>{tt.suspendUpdate();var _e=tt.create("point",[0,0],{name:"A",withLabel:!0,visible:!0,fillColor:"gray",strokeColor:"black",strokeWidth:1,size:3,fixed:!0}),rt=tt.create("point",[6,12],{name:"B",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),nt=tt.create("point",[13,-3],{name:"C",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),it=tt.create("point",[function(){return rt.X()+nt.X()},function(){return rt.Y()+nt.Y()}],{name:"D",withLabel:!0,fillColor:"blue",visible:!0,strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3});tt.create("arrow",[_e,rt],{name:"v",visible:!0,strokeColor:"#484848",strokeWidth:3}),tt.create("arrow",[_e,nt],{name:"u",visible:!0,strokeColor:"#484848",strokeWidth:3}),tt.create("arrow",[rt,nt],{name:"w",visible:!0,strokeColor:"#484848",strokeWidth:3}),tt.create("arrow",[_e,it],{name:"e",visible:!0,strokeColor:"#484848",strokeWidth:3}),tt.unsuspendUpdate()},JSXGraphComponent$3=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"벡터의 덧셈과 뻴셈"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$3,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$2=tt=>{tt.suspendUpdate();var _e=tt.create("point",[-20,-8],{name:"A",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"black",strokeWidth:1,size:3}),rt=tt.create("point",[6,12],{name:"B",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),nt=tt.create("point",[13,-3],{name:"C",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:0}),it=tt.create("ellipse",[_e,rt,nt],{name:"e",visible:!0,strokeColor:"#484848",strokeWidth:3,dash:2}),st=tt.create("glider",[10,10,it],{name:"C",withLabel:!0,visible:!0,fillColor:"#00FFFF",strokeColor:"black",highlightStrokeColor:"#00FFFF",highlightFillColor:"#00FFFF",highlightStrokeWidth:4,strokeWidth:1,size:5});tt.create("segment",[st,_e],{strokeColor:"black",strokeWidth:1}),tt.create("segment",[st,rt],{strokeColor:"black",strokeWidth:1}),tt.unsuspendUpdate()},JSXGraphComponent$2=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"타원 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$2,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$1=tt=>{tt.suspendUpdate();var _e=tt.create("point",[0,0],{name:"",withLabel:!0,visible:!0,size:0,fixed:!0}),rt=tt.create("point",[100,0],{name:"",visible:!0,fillColor:"blue",size:1,fixed:!0}),nt=tt.create("segment",[_e,rt],{name:"",strokeColor:"black",strokeWidth:0,fixed:!0}),it=tt.create("glider",[10,10,nt],{name:"P",withLabel:!0,visible:!0,fillColor:"#00FFFF",strokeColor:"black",highlightStrokeColor:"#00FFFF",highlightFillColor:"#00FFFF",highlightStrokeWidth:4,strokeWidth:1,size:5}),st=tt.create("point",[0,0],{name:"",size:0,fixed:!0}),ot=tt.create("point",[0,0],{name:"",size:0,fixed:!0}),lt=tt.create("parallelpoint",[it,st,ot],{name:"-P",withLabel:!0,visible:!0,fillColor:"#00FFFF",strokeColor:"black",highlightStrokeColor:"#00FFFF",highlightFillColor:"#00FFFF",highlightStrokeWidth:4,strokeWidth:1,size:5,fixed:!0}),at=tt.create("perpendicular",[nt,lt],{name:"",strokeColor:"black",strokeWidth:1}),ct=tt.create("glider",[-10,10,at],{name:"A",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),ut=tt.create("parabola",[it,at],{name:"",strokeColor:"pink",strokeWidth:2}),ht=tt.create("perpendicular",[at,ct],{name:"",strokeColor:"black",strokeWidth:0}),dt=tt.create("intersection",[ut,ht,0],{name:"C",withLabel:!0,visible:!0,fillColor:"red",strokeColor:"black",highlightStrokeColor:"red",highlightFillColor:"red",highlightStrokeWidth:4,strokeWidth:1,size:3}),ft=tt.create("segment",[it,dt],{name:"",strokeColor:"green",strokeWidth:1});tt.create("hatch",[ft,2],{name:"",strokeColor:"green",strokeWidth:.5,ticksDistance:1});var pt=tt.create("segment",[ct,dt],{name:"",strokeColor:"green",strokeWidth:1});tt.create("hatch",[pt,2],{name:"",strokeColor:"green",strokeWidth:.5,ticksDistance:1}),tt.unsuspendUpdate()},JSXGraphComponent$1=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"실을 이용한 포물선 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$1,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS=tt=>{tt.suspendUpdate();var _e=tt.create("point",[-25,5],{name:"A0",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),rt=tt.create("point",[15,-5],{name:"A1",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3});tt.create("arrow",[_e,rt],{strokeWidth:3,strokeOpacity:.7,strokeColor:"black",withLabel:!0,label:{offset:[120,-15]},name:'<span class="vecteur">a</span>'});var nt=tt.create("point",[-30,-30],{name:"B0",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0}),it=tt.create("point",["X(B0) + 5","Y(B0) + 15"],{name:"",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0});tt.create("arrow",[nt,it],{strokeWidth:3,strokeOpacity:.7,strokeColor:"black",withLabel:!0,label:{offset:[40,30]},name:'<span class="vecteur">b</span>'});var st=tt.create("button",[-35,15,"next",function(){var at=tt.create("point",[_e.X(),_e.Y()],{face:"o",size:5,visible:!1,strokeColor:"red",fillOpacity:.3,strokeOpacity:.3});tt.create("arrow",[_e,at],{strokeWidth:3,strokeOpacity:.7,strokeColor:"red",withLabel:!0,label:{offset:[120,40],strokeColor:"red"},name:'<span class="vecteur">a</span> <span class="plus"> + </span> <span class="vecteur">b</span>'}),setInterval(function(){at.moveTo([it.X(),it.Y()],100)},50),st.setAttribute({disabled:!0})}],{disabled:!0}),ot=tt.create("button",[-35,25,"start",function(){st.setAttribute({disabled:!1}),lt.setAttribute({disabled:!1}),setInterval(function(){nt.moveTo([rt.X(),rt.Y()],100)},50),ot.setAttribute({disabled:!0})}]),lt=tt.create("button",[-35,5,"reset",function(){lt.setAttribute({disabled:!0}),ot.setAttribute({disabled:!1}),st.setAttribute({disabled:!0}),location.reload()}],{disabled:!0});tt.unsuspendUpdate()};class JSXGraphComponent extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"벡터의 덧셈"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}}function toTrianglesDrawMode(tt,_e){if(_e===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),tt;if(_e===TriangleFanDrawMode||_e===TriangleStripDrawMode){let rt=tt.getIndex();if(rt===null){const ot=[],lt=tt.getAttribute("position");if(lt!==void 0){for(let at=0;at<lt.count;at++)ot.push(at);tt.setIndex(ot),rt=tt.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),tt}const nt=rt.count-2,it=[];if(_e===TriangleFanDrawMode)for(let ot=1;ot<=nt;ot++)it.push(rt.getX(0)),it.push(rt.getX(ot)),it.push(rt.getX(ot+1));else for(let ot=0;ot<nt;ot++)ot%2===0?(it.push(rt.getX(ot)),it.push(rt.getX(ot+1)),it.push(rt.getX(ot+2))):(it.push(rt.getX(ot+2)),it.push(rt.getX(ot+1)),it.push(rt.getX(ot)));it.length/3!==nt&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const st=tt.clone();return st.setIndex(it),st.clearGroups(),st}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_e),tt}class GLTFLoader extends Loader{constructor(_e){super(_e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(rt){return new GLTFMaterialsClearcoatExtension(rt)}),this.register(function(rt){return new GLTFTextureBasisUExtension(rt)}),this.register(function(rt){return new GLTFTextureWebPExtension(rt)}),this.register(function(rt){return new GLTFTextureAVIFExtension(rt)}),this.register(function(rt){return new GLTFMaterialsSheenExtension(rt)}),this.register(function(rt){return new GLTFMaterialsTransmissionExtension(rt)}),this.register(function(rt){return new GLTFMaterialsVolumeExtension(rt)}),this.register(function(rt){return new GLTFMaterialsIorExtension(rt)}),this.register(function(rt){return new GLTFMaterialsEmissiveStrengthExtension(rt)}),this.register(function(rt){return new GLTFMaterialsSpecularExtension(rt)}),this.register(function(rt){return new GLTFMaterialsIridescenceExtension(rt)}),this.register(function(rt){return new GLTFMaterialsAnisotropyExtension(rt)}),this.register(function(rt){return new GLTFLightsExtension(rt)}),this.register(function(rt){return new GLTFMeshoptCompression(rt)}),this.register(function(rt){return new GLTFMeshGpuInstancing(rt)})}load(_e,rt,nt,it){const st=this;let ot;this.resourcePath!==""?ot=this.resourcePath:this.path!==""?ot=this.path:ot=LoaderUtils.extractUrlBase(_e),this.manager.itemStart(_e);const lt=function(ct){it?it(ct):console.error(ct),st.manager.itemError(_e),st.manager.itemEnd(_e)},at=new FileLoader(this.manager);at.setPath(this.path),at.setResponseType("arraybuffer"),at.setRequestHeader(this.requestHeader),at.setWithCredentials(this.withCredentials),at.load(_e,function(ct){try{st.parse(ct,ot,function(ut){rt(ut),st.manager.itemEnd(_e)},lt)}catch(ut){lt(ut)}},nt,lt)}setDRACOLoader(_e){return this.dracoLoader=_e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_e){return this.ktx2Loader=_e,this}setMeshoptDecoder(_e){return this.meshoptDecoder=_e,this}register(_e){return this.pluginCallbacks.indexOf(_e)===-1&&this.pluginCallbacks.push(_e),this}unregister(_e){return this.pluginCallbacks.indexOf(_e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_e),1),this}parse(_e,rt,nt,it){let st;const ot={},lt={},at=new TextDecoder;if(typeof _e=="string")st=JSON.parse(_e);else if(_e instanceof ArrayBuffer)if(at.decode(new Uint8Array(_e,0,4))===BINARY_EXTENSION_HEADER_MAGIC){try{ot[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(_e)}catch(ht){it&&it(ht);return}st=JSON.parse(ot[EXTENSIONS.KHR_BINARY_GLTF].content)}else st=JSON.parse(at.decode(_e));else st=_e;if(st.asset===void 0||st.asset.version[0]<2){it&&it(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const ct=new GLTFParser(st,{path:rt||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ct.fileLoader.setRequestHeader(this.requestHeader);for(let ut=0;ut<this.pluginCallbacks.length;ut++){const ht=this.pluginCallbacks[ut](ct);lt[ht.name]=ht,ot[ht.name]=!0}if(st.extensionsUsed)for(let ut=0;ut<st.extensionsUsed.length;++ut){const ht=st.extensionsUsed[ut],dt=st.extensionsRequired||[];switch(ht){case EXTENSIONS.KHR_MATERIALS_UNLIT:ot[ht]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:ot[ht]=new GLTFDracoMeshCompressionExtension(st,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:ot[ht]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:ot[ht]=new GLTFMeshQuantizationExtension;break;default:dt.indexOf(ht)>=0&&lt[ht]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ht+'".')}}ct.setExtensions(ot),ct.setPlugins(lt),ct.parse(nt,it)}parseAsync(_e,rt){const nt=this;return new Promise(function(it,st){nt.parse(_e,rt,it,st)})}}function GLTFRegistry(){let tt={};return{get:function(_e){return tt[_e]},add:function(_e,rt){tt[_e]=rt},remove:function(_e){delete tt[_e]},removeAll:function(){tt={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _e=this.parser,rt=this.parser.json.nodes||[];for(let nt=0,it=rt.length;nt<it;nt++){const st=rt[nt];st.extensions&&st.extensions[this.name]&&st.extensions[this.name].light!==void 0&&_e._addNodeRef(this.cache,st.extensions[this.name].light)}}_loadLight(_e){const rt=this.parser,nt="light:"+_e;let it=rt.cache.get(nt);if(it)return it;const st=rt.json,at=((st.extensions&&st.extensions[this.name]||{}).lights||[])[_e];let ct;const ut=new Color$1(16777215);at.color!==void 0&&ut.fromArray(at.color);const ht=at.range!==void 0?at.range:0;switch(at.type){case"directional":ct=new DirectionalLight(ut),ct.target.position.set(0,0,-1),ct.add(ct.target);break;case"point":ct=new PointLight(ut),ct.distance=ht;break;case"spot":ct=new SpotLight(ut),ct.distance=ht,at.spot=at.spot||{},at.spot.innerConeAngle=at.spot.innerConeAngle!==void 0?at.spot.innerConeAngle:0,at.spot.outerConeAngle=at.spot.outerConeAngle!==void 0?at.spot.outerConeAngle:Math.PI/4,ct.angle=at.spot.outerConeAngle,ct.penumbra=1-at.spot.innerConeAngle/at.spot.outerConeAngle,ct.target.position.set(0,0,-1),ct.add(ct.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+at.type)}return ct.position.set(0,0,0),ct.decay=2,assignExtrasToUserData(ct,at),at.intensity!==void 0&&(ct.intensity=at.intensity),ct.name=rt.createUniqueName(at.name||"light_"+_e),it=Promise.resolve(ct),rt.cache.add(nt,it),it}getDependency(_e,rt){if(_e==="light")return this._loadLight(rt)}createNodeAttachment(_e){const rt=this,nt=this.parser,st=nt.json.nodes[_e],lt=(st.extensions&&st.extensions[this.name]||{}).light;return lt===void 0?null:this._loadLight(lt).then(function(at){return nt._getNodeRef(rt.cache,lt,at)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_e,rt,nt){const it=[];_e.color=new Color$1(1,1,1),_e.opacity=1;const st=rt.pbrMetallicRoughness;if(st){if(Array.isArray(st.baseColorFactor)){const ot=st.baseColorFactor;_e.color.fromArray(ot),_e.opacity=ot[3]}st.baseColorTexture!==void 0&&it.push(nt.assignTexture(_e,"map",st.baseColorTexture,SRGBColorSpace))}return Promise.all(it)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_e,rt){const it=this.parser.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=it.extensions[this.name].emissiveStrength;return st!==void 0&&(rt.emissiveIntensity=st),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];if(ot.clearcoatFactor!==void 0&&(rt.clearcoat=ot.clearcoatFactor),ot.clearcoatTexture!==void 0&&st.push(nt.assignTexture(rt,"clearcoatMap",ot.clearcoatTexture)),ot.clearcoatRoughnessFactor!==void 0&&(rt.clearcoatRoughness=ot.clearcoatRoughnessFactor),ot.clearcoatRoughnessTexture!==void 0&&st.push(nt.assignTexture(rt,"clearcoatRoughnessMap",ot.clearcoatRoughnessTexture)),ot.clearcoatNormalTexture!==void 0&&(st.push(nt.assignTexture(rt,"clearcoatNormalMap",ot.clearcoatNormalTexture)),ot.clearcoatNormalTexture.scale!==void 0)){const lt=ot.clearcoatNormalTexture.scale;rt.clearcoatNormalScale=new Vector2(lt,lt)}return Promise.all(st)}}class GLTFMaterialsIridescenceExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.iridescenceFactor!==void 0&&(rt.iridescence=ot.iridescenceFactor),ot.iridescenceTexture!==void 0&&st.push(nt.assignTexture(rt,"iridescenceMap",ot.iridescenceTexture)),ot.iridescenceIor!==void 0&&(rt.iridescenceIOR=ot.iridescenceIor),rt.iridescenceThicknessRange===void 0&&(rt.iridescenceThicknessRange=[100,400]),ot.iridescenceThicknessMinimum!==void 0&&(rt.iridescenceThicknessRange[0]=ot.iridescenceThicknessMinimum),ot.iridescenceThicknessMaximum!==void 0&&(rt.iridescenceThicknessRange[1]=ot.iridescenceThicknessMaximum),ot.iridescenceThicknessTexture!==void 0&&st.push(nt.assignTexture(rt,"iridescenceThicknessMap",ot.iridescenceThicknessTexture)),Promise.all(st)}}class GLTFMaterialsSheenExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[];rt.sheenColor=new Color$1(0,0,0),rt.sheenRoughness=0,rt.sheen=1;const ot=it.extensions[this.name];return ot.sheenColorFactor!==void 0&&rt.sheenColor.fromArray(ot.sheenColorFactor),ot.sheenRoughnessFactor!==void 0&&(rt.sheenRoughness=ot.sheenRoughnessFactor),ot.sheenColorTexture!==void 0&&st.push(nt.assignTexture(rt,"sheenColorMap",ot.sheenColorTexture,SRGBColorSpace)),ot.sheenRoughnessTexture!==void 0&&st.push(nt.assignTexture(rt,"sheenRoughnessMap",ot.sheenRoughnessTexture)),Promise.all(st)}}class GLTFMaterialsTransmissionExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.transmissionFactor!==void 0&&(rt.transmission=ot.transmissionFactor),ot.transmissionTexture!==void 0&&st.push(nt.assignTexture(rt,"transmissionMap",ot.transmissionTexture)),Promise.all(st)}}class GLTFMaterialsVolumeExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];rt.thickness=ot.thicknessFactor!==void 0?ot.thicknessFactor:0,ot.thicknessTexture!==void 0&&st.push(nt.assignTexture(rt,"thicknessMap",ot.thicknessTexture)),rt.attenuationDistance=ot.attenuationDistance||1/0;const lt=ot.attenuationColor||[1,1,1];return rt.attenuationColor=new Color$1(lt[0],lt[1],lt[2]),Promise.all(st)}}class GLTFMaterialsIorExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=it.extensions[this.name];return rt.ior=st.ior!==void 0?st.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];rt.specularIntensity=ot.specularFactor!==void 0?ot.specularFactor:1,ot.specularTexture!==void 0&&st.push(nt.assignTexture(rt,"specularIntensityMap",ot.specularTexture));const lt=ot.specularColorFactor||[1,1,1];return rt.specularColor=new Color$1(lt[0],lt[1],lt[2]),ot.specularColorTexture!==void 0&&st.push(nt.assignTexture(rt,"specularColorMap",ot.specularColorTexture,SRGBColorSpace)),Promise.all(st)}}class GLTFMaterialsAnisotropyExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(_e){const nt=this.parser.json.materials[_e];return!nt.extensions||!nt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser,it=nt.json.materials[_e];if(!it.extensions||!it.extensions[this.name])return Promise.resolve();const st=[],ot=it.extensions[this.name];return ot.anisotropyStrength!==void 0&&(rt.anisotropy=ot.anisotropyStrength),ot.anisotropyRotation!==void 0&&(rt.anisotropyRotation=ot.anisotropyRotation),ot.anisotropyTexture!==void 0&&st.push(nt.assignTexture(rt,"anisotropyMap",ot.anisotropyTexture)),Promise.all(st)}}class GLTFTextureBasisUExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(_e){const rt=this.parser,nt=rt.json,it=nt.textures[_e];if(!it.extensions||!it.extensions[this.name])return null;const st=it.extensions[this.name],ot=rt.options.ktx2Loader;if(!ot){if(nt.extensionsRequired&&nt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return rt.loadTextureImage(_e,st.source,ot)}}class GLTFTextureWebPExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_e){const rt=this.name,nt=this.parser,it=nt.json,st=it.textures[_e];if(!st.extensions||!st.extensions[rt])return null;const ot=st.extensions[rt],lt=it.images[ot.source];let at=nt.textureLoader;if(lt.uri){const ct=nt.options.manager.getHandler(lt.uri);ct!==null&&(at=ct)}return this.detectSupport().then(function(ct){if(ct)return nt.loadTextureImage(_e,ot.source,at);if(it.extensionsRequired&&it.extensionsRequired.indexOf(rt)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return nt.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const rt=new Image;rt.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",rt.onload=rt.onerror=function(){_e(rt.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_e){const rt=this.name,nt=this.parser,it=nt.json,st=it.textures[_e];if(!st.extensions||!st.extensions[rt])return null;const ot=st.extensions[rt],lt=it.images[ot.source];let at=nt.textureLoader;if(lt.uri){const ct=nt.options.manager.getHandler(lt.uri);ct!==null&&(at=ct)}return this.detectSupport().then(function(ct){if(ct)return nt.loadTextureImage(_e,ot.source,at);if(it.extensionsRequired&&it.extensionsRequired.indexOf(rt)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return nt.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const rt=new Image;rt.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",rt.onload=rt.onerror=function(){_e(rt.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(_e){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=_e}loadBufferView(_e){const rt=this.parser.json,nt=rt.bufferViews[_e];if(nt.extensions&&nt.extensions[this.name]){const it=nt.extensions[this.name],st=this.parser.getDependency("buffer",it.buffer),ot=this.parser.options.meshoptDecoder;if(!ot||!ot.supported){if(rt.extensionsRequired&&rt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return st.then(function(lt){const at=it.byteOffset||0,ct=it.byteLength||0,ut=it.count,ht=it.byteStride,dt=new Uint8Array(lt,at,ct);return ot.decodeGltfBufferAsync?ot.decodeGltfBufferAsync(ut,ht,dt,it.mode,it.filter).then(function(ft){return ft.buffer}):ot.ready.then(function(){const ft=new ArrayBuffer(ut*ht);return ot.decodeGltfBuffer(new Uint8Array(ft),ut,ht,dt,it.mode,it.filter),ft})})}else return null}}class GLTFMeshGpuInstancing{constructor(_e){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=_e}createNodeMesh(_e){const rt=this.parser.json,nt=rt.nodes[_e];if(!nt.extensions||!nt.extensions[this.name]||nt.mesh===void 0)return null;const it=rt.meshes[nt.mesh];for(const ct of it.primitives)if(ct.mode!==WEBGL_CONSTANTS.TRIANGLES&&ct.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&ct.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&ct.mode!==void 0)return null;const ot=nt.extensions[this.name].attributes,lt=[],at={};for(const ct in ot)lt.push(this.parser.getDependency("accessor",ot[ct]).then(ut=>(at[ct]=ut,at[ct])));return lt.length<1?null:(lt.push(this.parser.createNodeMesh(_e)),Promise.all(lt).then(ct=>{const ut=ct.pop(),ht=ut.isGroup?ut.children:[ut],dt=ct[0].count,ft=[];for(const pt of ht){const mt=new Matrix4,gt=new Vector3,vt=new Quaternion,At=new Vector3(1,1,1),yt=new InstancedMesh(pt.geometry,pt.material,dt);for(let xt=0;xt<dt;xt++)at.TRANSLATION&&gt.fromBufferAttribute(at.TRANSLATION,xt),at.ROTATION&&vt.fromBufferAttribute(at.ROTATION,xt),at.SCALE&&At.fromBufferAttribute(at.SCALE,xt),yt.setMatrixAt(xt,mt.compose(gt,vt,At));for(const xt in at)xt!=="TRANSLATION"&&xt!=="ROTATION"&&xt!=="SCALE"&&pt.geometry.setAttribute(xt,at[xt]);Object3D.prototype.copy.call(yt,pt),this.parser.assignFinalMaterial(yt),ft.push(yt)}return ut.isGroup?(ut.clear(),ut.add(...ft),ut):ft[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(_e){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const rt=new DataView(_e,0,BINARY_EXTENSION_HEADER_LENGTH),nt=new TextDecoder;if(this.header={magic:nt.decode(new Uint8Array(_e.slice(0,4))),version:rt.getUint32(4,!0),length:rt.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const it=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,st=new DataView(_e,BINARY_EXTENSION_HEADER_LENGTH);let ot=0;for(;ot<it;){const lt=st.getUint32(ot,!0);ot+=4;const at=st.getUint32(ot,!0);if(ot+=4,at===BINARY_EXTENSION_CHUNK_TYPES.JSON){const ct=new Uint8Array(_e,BINARY_EXTENSION_HEADER_LENGTH+ot,lt);this.content=nt.decode(ct)}else if(at===BINARY_EXTENSION_CHUNK_TYPES.BIN){const ct=BINARY_EXTENSION_HEADER_LENGTH+ot;this.body=_e.slice(ct,ct+lt)}ot+=lt}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(_e,rt){if(!rt)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=_e,this.dracoLoader=rt,this.dracoLoader.preload()}decodePrimitive(_e,rt){const nt=this.json,it=this.dracoLoader,st=_e.extensions[this.name].bufferView,ot=_e.extensions[this.name].attributes,lt={},at={},ct={};for(const ut in ot){const ht=ATTRIBUTES[ut]||ut.toLowerCase();lt[ht]=ot[ut]}for(const ut in _e.attributes){const ht=ATTRIBUTES[ut]||ut.toLowerCase();if(ot[ut]!==void 0){const dt=nt.accessors[_e.attributes[ut]],ft=WEBGL_COMPONENT_TYPES[dt.componentType];ct[ht]=ft.name,at[ht]=dt.normalized===!0}}return rt.getDependency("bufferView",st).then(function(ut){return new Promise(function(ht){it.decodeDracoFile(ut,function(dt){for(const ft in dt.attributes){const pt=dt.attributes[ft],mt=at[ft];mt!==void 0&&(pt.normalized=mt)}ht(dt)},lt,ct)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(_e,rt){return(rt.texCoord===void 0||rt.texCoord===_e.channel)&&rt.offset===void 0&&rt.rotation===void 0&&rt.scale===void 0||(_e=_e.clone(),rt.texCoord!==void 0&&(_e.channel=rt.texCoord),rt.offset!==void 0&&_e.offset.fromArray(rt.offset),rt.rotation!==void 0&&(_e.rotation=rt.rotation),rt.scale!==void 0&&_e.repeat.fromArray(rt.scale),_e.needsUpdate=!0),_e}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(_e,rt,nt,it){super(_e,rt,nt,it)}copySampleValue_(_e){const rt=this.resultBuffer,nt=this.sampleValues,it=this.valueSize,st=_e*it*3+it;for(let ot=0;ot!==it;ot++)rt[ot]=nt[st+ot];return rt}interpolate_(_e,rt,nt,it){const st=this.resultBuffer,ot=this.sampleValues,lt=this.valueSize,at=lt*2,ct=lt*3,ut=it-rt,ht=(nt-rt)/ut,dt=ht*ht,ft=dt*ht,pt=_e*ct,mt=pt-ct,gt=-2*ft+3*dt,vt=ft-dt,At=1-gt,yt=vt-dt+ht;for(let xt=0;xt!==lt;xt++){const _t=ot[mt+xt+lt],Et=ot[mt+xt+at]*ut,bt=ot[pt+xt+lt],wt=ot[pt+xt]*ut;st[xt]=At*_t+yt*Et+gt*bt+vt*wt}return st}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(_e,rt,nt,it){const st=super.interpolate_(_e,rt,nt,it);return _q.fromArray(st).normalize().toArray(st),st}}const WEBGL_CONSTANTS={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(tt){return tt.DefaultMaterial===void 0&&(tt.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),tt.DefaultMaterial}function addUnknownExtensionsToUserData(tt,_e,rt){for(const nt in rt.extensions)tt[nt]===void 0&&(_e.userData.gltfExtensions=_e.userData.gltfExtensions||{},_e.userData.gltfExtensions[nt]=rt.extensions[nt])}function assignExtrasToUserData(tt,_e){_e.extras!==void 0&&(typeof _e.extras=="object"?Object.assign(tt.userData,_e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_e.extras))}function addMorphTargets(tt,_e,rt){let nt=!1,it=!1,st=!1;for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(ht.POSITION!==void 0&&(nt=!0),ht.NORMAL!==void 0&&(it=!0),ht.COLOR_0!==void 0&&(st=!0),nt&&it&&st)break}if(!nt&&!it&&!st)return Promise.resolve(tt);const ot=[],lt=[],at=[];for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(nt){const dt=ht.POSITION!==void 0?rt.getDependency("accessor",ht.POSITION):tt.attributes.position;ot.push(dt)}if(it){const dt=ht.NORMAL!==void 0?rt.getDependency("accessor",ht.NORMAL):tt.attributes.normal;lt.push(dt)}if(st){const dt=ht.COLOR_0!==void 0?rt.getDependency("accessor",ht.COLOR_0):tt.attributes.color;at.push(dt)}}return Promise.all([Promise.all(ot),Promise.all(lt),Promise.all(at)]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];return nt&&(tt.morphAttributes.position=ut),it&&(tt.morphAttributes.normal=ht),st&&(tt.morphAttributes.color=dt),tt.morphTargetsRelative=!0,tt})}function updateMorphTargets(tt,_e){if(tt.updateMorphTargets(),_e.weights!==void 0)for(let rt=0,nt=_e.weights.length;rt<nt;rt++)tt.morphTargetInfluences[rt]=_e.weights[rt];if(_e.extras&&Array.isArray(_e.extras.targetNames)){const rt=_e.extras.targetNames;if(tt.morphTargetInfluences.length===rt.length){tt.morphTargetDictionary={};for(let nt=0,it=rt.length;nt<it;nt++)tt.morphTargetDictionary[rt[nt]]=nt}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(tt){let _e;const rt=tt.extensions&&tt.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(rt?_e="draco:"+rt.bufferView+":"+rt.indices+":"+createAttributesKey(rt.attributes):_e=tt.indices+":"+createAttributesKey(tt.attributes)+":"+tt.mode,tt.targets!==void 0)for(let nt=0,it=tt.targets.length;nt<it;nt++)_e+=":"+createAttributesKey(tt.targets[nt]);return _e}function createAttributesKey(tt){let _e="";const rt=Object.keys(tt).sort();for(let nt=0,it=rt.length;nt<it;nt++)_e+=rt[nt]+":"+tt[rt[nt]]+";";return _e}function getNormalizedComponentScale(tt){switch(tt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(tt){return tt.search(/\.jpe?g($|\?)/i)>0||tt.search(/^data\:image\/jpeg/)===0?"image/jpeg":tt.search(/\.webp($|\?)/i)>0||tt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(_e={},rt={}){this.json=_e,this.extensions={},this.plugins={},this.options=rt,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let nt=!1,it=!1,st=-1;typeof navigator<"u"&&(nt=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,it=navigator.userAgent.indexOf("Firefox")>-1,st=it?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||nt||it&&st<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_e){this.extensions=_e}setPlugins(_e){this.plugins=_e}parse(_e,rt){const nt=this,it=this.json,st=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(ot){return ot._markDefs&&ot._markDefs()}),Promise.all(this._invokeAll(function(ot){return ot.beforeRoot&&ot.beforeRoot()})).then(function(){return Promise.all([nt.getDependencies("scene"),nt.getDependencies("animation"),nt.getDependencies("camera")])}).then(function(ot){const lt={scene:ot[0][it.scene||0],scenes:ot[0],animations:ot[1],cameras:ot[2],asset:it.asset,parser:nt,userData:{}};addUnknownExtensionsToUserData(st,lt,it),assignExtrasToUserData(lt,it),Promise.all(nt._invokeAll(function(at){return at.afterRoot&&at.afterRoot(lt)})).then(function(){_e(lt)})}).catch(rt)}_markDefs(){const _e=this.json.nodes||[],rt=this.json.skins||[],nt=this.json.meshes||[];for(let it=0,st=rt.length;it<st;it++){const ot=rt[it].joints;for(let lt=0,at=ot.length;lt<at;lt++)_e[ot[lt]].isBone=!0}for(let it=0,st=_e.length;it<st;it++){const ot=_e[it];ot.mesh!==void 0&&(this._addNodeRef(this.meshCache,ot.mesh),ot.skin!==void 0&&(nt[ot.mesh].isSkinnedMesh=!0)),ot.camera!==void 0&&this._addNodeRef(this.cameraCache,ot.camera)}}_addNodeRef(_e,rt){rt!==void 0&&(_e.refs[rt]===void 0&&(_e.refs[rt]=_e.uses[rt]=0),_e.refs[rt]++)}_getNodeRef(_e,rt,nt){if(_e.refs[rt]<=1)return nt;const it=nt.clone(),st=(ot,lt)=>{const at=this.associations.get(ot);at!=null&&this.associations.set(lt,at);for(const[ct,ut]of ot.children.entries())st(ut,lt.children[ct])};return st(nt,it),it.name+="_instance_"+_e.uses[rt]++,it}_invokeOne(_e){const rt=Object.values(this.plugins);rt.push(this);for(let nt=0;nt<rt.length;nt++){const it=_e(rt[nt]);if(it)return it}return null}_invokeAll(_e){const rt=Object.values(this.plugins);rt.unshift(this);const nt=[];for(let it=0;it<rt.length;it++){const st=_e(rt[it]);st&&nt.push(st)}return nt}getDependency(_e,rt){const nt=_e+":"+rt;let it=this.cache.get(nt);if(!it){switch(_e){case"scene":it=this.loadScene(rt);break;case"node":it=this._invokeOne(function(st){return st.loadNode&&st.loadNode(rt)});break;case"mesh":it=this._invokeOne(function(st){return st.loadMesh&&st.loadMesh(rt)});break;case"accessor":it=this.loadAccessor(rt);break;case"bufferView":it=this._invokeOne(function(st){return st.loadBufferView&&st.loadBufferView(rt)});break;case"buffer":it=this.loadBuffer(rt);break;case"material":it=this._invokeOne(function(st){return st.loadMaterial&&st.loadMaterial(rt)});break;case"texture":it=this._invokeOne(function(st){return st.loadTexture&&st.loadTexture(rt)});break;case"skin":it=this.loadSkin(rt);break;case"animation":it=this._invokeOne(function(st){return st.loadAnimation&&st.loadAnimation(rt)});break;case"camera":it=this.loadCamera(rt);break;default:if(it=this._invokeOne(function(st){return st!=this&&st.getDependency&&st.getDependency(_e,rt)}),!it)throw new Error("Unknown type: "+_e);break}this.cache.add(nt,it)}return it}getDependencies(_e){let rt=this.cache.get(_e);if(!rt){const nt=this,it=this.json[_e+(_e==="mesh"?"es":"s")]||[];rt=Promise.all(it.map(function(st,ot){return nt.getDependency(_e,ot)})),this.cache.add(_e,rt)}return rt}loadBuffer(_e){const rt=this.json.buffers[_e],nt=this.fileLoader;if(rt.type&&rt.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+rt.type+" buffer type is not supported.");if(rt.uri===void 0&&_e===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const it=this.options;return new Promise(function(st,ot){nt.load(LoaderUtils.resolveURL(rt.uri,it.path),st,void 0,function(){ot(new Error('THREE.GLTFLoader: Failed to load buffer "'+rt.uri+'".'))})})}loadBufferView(_e){const rt=this.json.bufferViews[_e];return this.getDependency("buffer",rt.buffer).then(function(nt){const it=rt.byteLength||0,st=rt.byteOffset||0;return nt.slice(st,st+it)})}loadAccessor(_e){const rt=this,nt=this.json,it=this.json.accessors[_e];if(it.bufferView===void 0&&it.sparse===void 0){const ot=WEBGL_TYPE_SIZES[it.type],lt=WEBGL_COMPONENT_TYPES[it.componentType],at=it.normalized===!0,ct=new lt(it.count*ot);return Promise.resolve(new BufferAttribute(ct,ot,at))}const st=[];return it.bufferView!==void 0?st.push(this.getDependency("bufferView",it.bufferView)):st.push(null),it.sparse!==void 0&&(st.push(this.getDependency("bufferView",it.sparse.indices.bufferView)),st.push(this.getDependency("bufferView",it.sparse.values.bufferView))),Promise.all(st).then(function(ot){const lt=ot[0],at=WEBGL_TYPE_SIZES[it.type],ct=WEBGL_COMPONENT_TYPES[it.componentType],ut=ct.BYTES_PER_ELEMENT,ht=ut*at,dt=it.byteOffset||0,ft=it.bufferView!==void 0?nt.bufferViews[it.bufferView].byteStride:void 0,pt=it.normalized===!0;let mt,gt;if(ft&&ft!==ht){const vt=Math.floor(dt/ft),At="InterleavedBuffer:"+it.bufferView+":"+it.componentType+":"+vt+":"+it.count;let yt=rt.cache.get(At);yt||(mt=new ct(lt,vt*ft,it.count*ft/ut),yt=new InterleavedBuffer(mt,ft/ut),rt.cache.add(At,yt)),gt=new InterleavedBufferAttribute(yt,at,dt%ft/ut,pt)}else lt===null?mt=new ct(it.count*at):mt=new ct(lt,dt,it.count*at),gt=new BufferAttribute(mt,at,pt);if(it.sparse!==void 0){const vt=WEBGL_TYPE_SIZES.SCALAR,At=WEBGL_COMPONENT_TYPES[it.sparse.indices.componentType],yt=it.sparse.indices.byteOffset||0,xt=it.sparse.values.byteOffset||0,_t=new At(ot[1],yt,it.sparse.count*vt),Et=new ct(ot[2],xt,it.sparse.count*at);lt!==null&&(gt=new BufferAttribute(gt.array.slice(),gt.itemSize,gt.normalized));for(let bt=0,wt=_t.length;bt<wt;bt++){const Tt=_t[bt];if(gt.setX(Tt,Et[bt*at]),at>=2&&gt.setY(Tt,Et[bt*at+1]),at>=3&&gt.setZ(Tt,Et[bt*at+2]),at>=4&&gt.setW(Tt,Et[bt*at+3]),at>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return gt})}loadTexture(_e){const rt=this.json,nt=this.options,st=rt.textures[_e].source,ot=rt.images[st];let lt=this.textureLoader;if(ot.uri){const at=nt.manager.getHandler(ot.uri);at!==null&&(lt=at)}return this.loadTextureImage(_e,st,lt)}loadTextureImage(_e,rt,nt){const it=this,st=this.json,ot=st.textures[_e],lt=st.images[rt],at=(lt.uri||lt.bufferView)+":"+ot.sampler;if(this.textureCache[at])return this.textureCache[at];const ct=this.loadImageSource(rt,nt).then(function(ut){ut.flipY=!1,ut.name=ot.name||lt.name||"",ut.name===""&&typeof lt.uri=="string"&&lt.uri.startsWith("data:image/")===!1&&(ut.name=lt.uri);const dt=(st.samplers||{})[ot.sampler]||{};return ut.magFilter=WEBGL_FILTERS[dt.magFilter]||LinearFilter,ut.minFilter=WEBGL_FILTERS[dt.minFilter]||LinearMipmapLinearFilter,ut.wrapS=WEBGL_WRAPPINGS[dt.wrapS]||RepeatWrapping,ut.wrapT=WEBGL_WRAPPINGS[dt.wrapT]||RepeatWrapping,it.associations.set(ut,{textures:_e}),ut}).catch(function(){return null});return this.textureCache[at]=ct,ct}loadImageSource(_e,rt){const nt=this,it=this.json,st=this.options;if(this.sourceCache[_e]!==void 0)return this.sourceCache[_e].then(ht=>ht.clone());const ot=it.images[_e],lt=self.URL||self.webkitURL;let at=ot.uri||"",ct=!1;if(ot.bufferView!==void 0)at=nt.getDependency("bufferView",ot.bufferView).then(function(ht){ct=!0;const dt=new Blob([ht],{type:ot.mimeType});return at=lt.createObjectURL(dt),at});else if(ot.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_e+" is missing URI and bufferView");const ut=Promise.resolve(at).then(function(ht){return new Promise(function(dt,ft){let pt=dt;rt.isImageBitmapLoader===!0&&(pt=function(mt){const gt=new Texture(mt);gt.needsUpdate=!0,dt(gt)}),rt.load(LoaderUtils.resolveURL(ht,st.path),pt,void 0,ft)})}).then(function(ht){return ct===!0&&lt.revokeObjectURL(at),ht.userData.mimeType=ot.mimeType||getImageURIMimeType(ot.uri),ht}).catch(function(ht){throw console.error("THREE.GLTFLoader: Couldn't load texture",at),ht});return this.sourceCache[_e]=ut,ut}assignTexture(_e,rt,nt,it){const st=this;return this.getDependency("texture",nt.index).then(function(ot){if(!ot)return null;if(nt.texCoord!==void 0&&nt.texCoord>0&&(ot=ot.clone(),ot.channel=nt.texCoord),st.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const lt=nt.extensions!==void 0?nt.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(lt){const at=st.associations.get(ot);ot=st.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(ot,lt),st.associations.set(ot,at)}}return it!==void 0&&(ot.colorSpace=it),_e[rt]=ot,ot})}assignFinalMaterial(_e){const rt=_e.geometry;let nt=_e.material;const it=rt.attributes.tangent===void 0,st=rt.attributes.color!==void 0,ot=rt.attributes.normal===void 0;if(_e.isPoints){const lt="PointsMaterial:"+nt.uuid;let at=this.cache.get(lt);at||(at=new PointsMaterial,Material.prototype.copy.call(at,nt),at.color.copy(nt.color),at.map=nt.map,at.sizeAttenuation=!1,this.cache.add(lt,at)),nt=at}else if(_e.isLine){const lt="LineBasicMaterial:"+nt.uuid;let at=this.cache.get(lt);at||(at=new LineBasicMaterial,Material.prototype.copy.call(at,nt),at.color.copy(nt.color),at.map=nt.map,this.cache.add(lt,at)),nt=at}if(it||st||ot){let lt="ClonedMaterial:"+nt.uuid+":";it&&(lt+="derivative-tangents:"),st&&(lt+="vertex-colors:"),ot&&(lt+="flat-shading:");let at=this.cache.get(lt);at||(at=nt.clone(),st&&(at.vertexColors=!0),ot&&(at.flatShading=!0),it&&(at.normalScale&&(at.normalScale.y*=-1),at.clearcoatNormalScale&&(at.clearcoatNormalScale.y*=-1)),this.cache.add(lt,at),this.associations.set(at,this.associations.get(nt))),nt=at}_e.material=nt}getMaterialType(){return MeshStandardMaterial}loadMaterial(_e){const rt=this,nt=this.json,it=this.extensions,st=nt.materials[_e];let ot;const lt={},at=st.extensions||{},ct=[];if(at[EXTENSIONS.KHR_MATERIALS_UNLIT]){const ht=it[EXTENSIONS.KHR_MATERIALS_UNLIT];ot=ht.getMaterialType(),ct.push(ht.extendParams(lt,st,rt))}else{const ht=st.pbrMetallicRoughness||{};if(lt.color=new Color$1(1,1,1),lt.opacity=1,Array.isArray(ht.baseColorFactor)){const dt=ht.baseColorFactor;lt.color.fromArray(dt),lt.opacity=dt[3]}ht.baseColorTexture!==void 0&&ct.push(rt.assignTexture(lt,"map",ht.baseColorTexture,SRGBColorSpace)),lt.metalness=ht.metallicFactor!==void 0?ht.metallicFactor:1,lt.roughness=ht.roughnessFactor!==void 0?ht.roughnessFactor:1,ht.metallicRoughnessTexture!==void 0&&(ct.push(rt.assignTexture(lt,"metalnessMap",ht.metallicRoughnessTexture)),ct.push(rt.assignTexture(lt,"roughnessMap",ht.metallicRoughnessTexture))),ot=this._invokeOne(function(dt){return dt.getMaterialType&&dt.getMaterialType(_e)}),ct.push(Promise.all(this._invokeAll(function(dt){return dt.extendMaterialParams&&dt.extendMaterialParams(_e,lt)})))}st.doubleSided===!0&&(lt.side=DoubleSide);const ut=st.alphaMode||ALPHA_MODES.OPAQUE;if(ut===ALPHA_MODES.BLEND?(lt.transparent=!0,lt.depthWrite=!1):(lt.transparent=!1,ut===ALPHA_MODES.MASK&&(lt.alphaTest=st.alphaCutoff!==void 0?st.alphaCutoff:.5)),st.normalTexture!==void 0&&ot!==MeshBasicMaterial&&(ct.push(rt.assignTexture(lt,"normalMap",st.normalTexture)),lt.normalScale=new Vector2(1,1),st.normalTexture.scale!==void 0)){const ht=st.normalTexture.scale;lt.normalScale.set(ht,ht)}return st.occlusionTexture!==void 0&&ot!==MeshBasicMaterial&&(ct.push(rt.assignTexture(lt,"aoMap",st.occlusionTexture)),st.occlusionTexture.strength!==void 0&&(lt.aoMapIntensity=st.occlusionTexture.strength)),st.emissiveFactor!==void 0&&ot!==MeshBasicMaterial&&(lt.emissive=new Color$1().fromArray(st.emissiveFactor)),st.emissiveTexture!==void 0&&ot!==MeshBasicMaterial&&ct.push(rt.assignTexture(lt,"emissiveMap",st.emissiveTexture,SRGBColorSpace)),Promise.all(ct).then(function(){const ht=new ot(lt);return st.name&&(ht.name=st.name),assignExtrasToUserData(ht,st),rt.associations.set(ht,{materials:_e}),st.extensions&&addUnknownExtensionsToUserData(it,ht,st),ht})}createUniqueName(_e){const rt=PropertyBinding.sanitizeNodeName(_e||"");return rt in this.nodeNamesUsed?rt+"_"+ ++this.nodeNamesUsed[rt]:(this.nodeNamesUsed[rt]=0,rt)}loadGeometries(_e){const rt=this,nt=this.extensions,it=this.primitiveCache;function st(lt){return nt[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(lt,rt).then(function(at){return addPrimitiveAttributes(at,lt,rt)})}const ot=[];for(let lt=0,at=_e.length;lt<at;lt++){const ct=_e[lt],ut=createPrimitiveKey(ct),ht=it[ut];if(ht)ot.push(ht.promise);else{let dt;ct.extensions&&ct.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?dt=st(ct):dt=addPrimitiveAttributes(new BufferGeometry,ct,rt),it[ut]={primitive:ct,promise:dt},ot.push(dt)}}return Promise.all(ot)}loadMesh(_e){const rt=this,nt=this.json,it=this.extensions,st=nt.meshes[_e],ot=st.primitives,lt=[];for(let at=0,ct=ot.length;at<ct;at++){const ut=ot[at].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",ot[at].material);lt.push(ut)}return lt.push(rt.loadGeometries(ot)),Promise.all(lt).then(function(at){const ct=at.slice(0,at.length-1),ut=at[at.length-1],ht=[];for(let ft=0,pt=ut.length;ft<pt;ft++){const mt=ut[ft],gt=ot[ft];let vt;const At=ct[ft];if(gt.mode===WEBGL_CONSTANTS.TRIANGLES||gt.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||gt.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||gt.mode===void 0)vt=st.isSkinnedMesh===!0?new SkinnedMesh(mt,At):new Mesh(mt,At),vt.isSkinnedMesh===!0&&vt.normalizeSkinWeights(),gt.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?vt.geometry=toTrianglesDrawMode(vt.geometry,TriangleStripDrawMode):gt.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(vt.geometry=toTrianglesDrawMode(vt.geometry,TriangleFanDrawMode));else if(gt.mode===WEBGL_CONSTANTS.LINES)vt=new LineSegments(mt,At);else if(gt.mode===WEBGL_CONSTANTS.LINE_STRIP)vt=new Line(mt,At);else if(gt.mode===WEBGL_CONSTANTS.LINE_LOOP)vt=new LineLoop(mt,At);else if(gt.mode===WEBGL_CONSTANTS.POINTS)vt=new Points(mt,At);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+gt.mode);Object.keys(vt.geometry.morphAttributes).length>0&&updateMorphTargets(vt,st),vt.name=rt.createUniqueName(st.name||"mesh_"+_e),assignExtrasToUserData(vt,st),gt.extensions&&addUnknownExtensionsToUserData(it,vt,gt),rt.assignFinalMaterial(vt),ht.push(vt)}for(let ft=0,pt=ht.length;ft<pt;ft++)rt.associations.set(ht[ft],{meshes:_e,primitives:ft});if(ht.length===1)return st.extensions&&addUnknownExtensionsToUserData(it,ht[0],st),ht[0];const dt=new Group;st.extensions&&addUnknownExtensionsToUserData(it,dt,st),rt.associations.set(dt,{meshes:_e});for(let ft=0,pt=ht.length;ft<pt;ft++)dt.add(ht[ft]);return dt})}loadCamera(_e){let rt;const nt=this.json.cameras[_e],it=nt[nt.type];if(!it){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return nt.type==="perspective"?rt=new PerspectiveCamera(MathUtils.radToDeg(it.yfov),it.aspectRatio||1,it.znear||1,it.zfar||2e6):nt.type==="orthographic"&&(rt=new OrthographicCamera(-it.xmag,it.xmag,it.ymag,-it.ymag,it.znear,it.zfar)),nt.name&&(rt.name=this.createUniqueName(nt.name)),assignExtrasToUserData(rt,nt),Promise.resolve(rt)}loadSkin(_e){const rt=this.json.skins[_e],nt=[];for(let it=0,st=rt.joints.length;it<st;it++)nt.push(this._loadNodeShallow(rt.joints[it]));return rt.inverseBindMatrices!==void 0?nt.push(this.getDependency("accessor",rt.inverseBindMatrices)):nt.push(null),Promise.all(nt).then(function(it){const st=it.pop(),ot=it,lt=[],at=[];for(let ct=0,ut=ot.length;ct<ut;ct++){const ht=ot[ct];if(ht){lt.push(ht);const dt=new Matrix4;st!==null&&dt.fromArray(st.array,ct*16),at.push(dt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',rt.joints[ct])}return new Skeleton(lt,at)})}loadAnimation(_e){const rt=this.json,nt=this,it=rt.animations[_e],st=it.name?it.name:"animation_"+_e,ot=[],lt=[],at=[],ct=[],ut=[];for(let ht=0,dt=it.channels.length;ht<dt;ht++){const ft=it.channels[ht],pt=it.samplers[ft.sampler],mt=ft.target,gt=mt.node,vt=it.parameters!==void 0?it.parameters[pt.input]:pt.input,At=it.parameters!==void 0?it.parameters[pt.output]:pt.output;mt.node!==void 0&&(ot.push(this.getDependency("node",gt)),lt.push(this.getDependency("accessor",vt)),at.push(this.getDependency("accessor",At)),ct.push(pt),ut.push(mt))}return Promise.all([Promise.all(ot),Promise.all(lt),Promise.all(at),Promise.all(ct),Promise.all(ut)]).then(function(ht){const dt=ht[0],ft=ht[1],pt=ht[2],mt=ht[3],gt=ht[4],vt=[];for(let At=0,yt=dt.length;At<yt;At++){const xt=dt[At],_t=ft[At],Et=pt[At],bt=mt[At],wt=gt[At];if(xt===void 0)continue;xt.updateMatrix&&(xt.updateMatrix(),xt.matrixAutoUpdate=!0);const Tt=nt._createAnimationTracks(xt,_t,Et,bt,wt);if(Tt)for(let Mt=0;Mt<Tt.length;Mt++)vt.push(Tt[Mt])}return new AnimationClip(st,void 0,vt)})}createNodeMesh(_e){const rt=this.json,nt=this,it=rt.nodes[_e];return it.mesh===void 0?null:nt.getDependency("mesh",it.mesh).then(function(st){const ot=nt._getNodeRef(nt.meshCache,it.mesh,st);return it.weights!==void 0&&ot.traverse(function(lt){if(lt.isMesh)for(let at=0,ct=it.weights.length;at<ct;at++)lt.morphTargetInfluences[at]=it.weights[at]}),ot})}loadNode(_e){const rt=this.json,nt=this,it=rt.nodes[_e],st=nt._loadNodeShallow(_e),ot=[],lt=it.children||[];for(let ct=0,ut=lt.length;ct<ut;ct++)ot.push(nt.getDependency("node",lt[ct]));const at=it.skin===void 0?Promise.resolve(null):nt.getDependency("skin",it.skin);return Promise.all([st,Promise.all(ot),at]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];dt!==null&&ut.traverse(function(ft){ft.isSkinnedMesh&&ft.bind(dt,_identityMatrix)});for(let ft=0,pt=ht.length;ft<pt;ft++)ut.add(ht[ft]);return ut})}_loadNodeShallow(_e){const rt=this.json,nt=this.extensions,it=this;if(this.nodeCache[_e]!==void 0)return this.nodeCache[_e];const st=rt.nodes[_e],ot=st.name?it.createUniqueName(st.name):"",lt=[],at=it._invokeOne(function(ct){return ct.createNodeMesh&&ct.createNodeMesh(_e)});return at&&lt.push(at),st.camera!==void 0&&lt.push(it.getDependency("camera",st.camera).then(function(ct){return it._getNodeRef(it.cameraCache,st.camera,ct)})),it._invokeAll(function(ct){return ct.createNodeAttachment&&ct.createNodeAttachment(_e)}).forEach(function(ct){lt.push(ct)}),this.nodeCache[_e]=Promise.all(lt).then(function(ct){let ut;if(st.isBone===!0?ut=new Bone:ct.length>1?ut=new Group:ct.length===1?ut=ct[0]:ut=new Object3D,ut!==ct[0])for(let ht=0,dt=ct.length;ht<dt;ht++)ut.add(ct[ht]);if(st.name&&(ut.userData.name=st.name,ut.name=ot),assignExtrasToUserData(ut,st),st.extensions&&addUnknownExtensionsToUserData(nt,ut,st),st.matrix!==void 0){const ht=new Matrix4;ht.fromArray(st.matrix),ut.applyMatrix4(ht)}else st.translation!==void 0&&ut.position.fromArray(st.translation),st.rotation!==void 0&&ut.quaternion.fromArray(st.rotation),st.scale!==void 0&&ut.scale.fromArray(st.scale);return it.associations.has(ut)||it.associations.set(ut,{}),it.associations.get(ut).nodes=_e,ut}),this.nodeCache[_e]}loadScene(_e){const rt=this.extensions,nt=this.json.scenes[_e],it=this,st=new Group;nt.name&&(st.name=it.createUniqueName(nt.name)),assignExtrasToUserData(st,nt),nt.extensions&&addUnknownExtensionsToUserData(rt,st,nt);const ot=nt.nodes||[],lt=[];for(let at=0,ct=ot.length;at<ct;at++)lt.push(it.getDependency("node",ot[at]));return Promise.all(lt).then(function(at){for(let ut=0,ht=at.length;ut<ht;ut++)st.add(at[ut]);const ct=ut=>{const ht=new Map;for(const[dt,ft]of it.associations)(dt instanceof Material||dt instanceof Texture)&&ht.set(dt,ft);return ut.traverse(dt=>{const ft=it.associations.get(dt);ft!=null&&ht.set(dt,ft)}),ht};return it.associations=ct(st),st})}_createAnimationTracks(_e,rt,nt,it,st){const ot=[],lt=_e.name?_e.name:_e.uuid,at=[];PATH_PROPERTIES[st.path]===PATH_PROPERTIES.weights?_e.traverse(function(dt){dt.morphTargetInfluences&&at.push(dt.name?dt.name:dt.uuid)}):at.push(lt);let ct;switch(PATH_PROPERTIES[st.path]){case PATH_PROPERTIES.weights:ct=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:ct=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:default:switch(nt.itemSize){case 1:ct=NumberKeyframeTrack;break;case 2:case 3:ct=VectorKeyframeTrack;break}break}const ut=it.interpolation!==void 0?INTERPOLATION[it.interpolation]:InterpolateLinear,ht=this._getArrayFromAccessor(nt);for(let dt=0,ft=at.length;dt<ft;dt++){const pt=new ct(at[dt]+"."+PATH_PROPERTIES[st.path],rt.array,ht,ut);ut==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(pt),ot.push(pt)}return ot}_getArrayFromAccessor(_e){let rt=_e.array;if(_e.normalized){const nt=getNormalizedComponentScale(rt.constructor),it=new Float32Array(rt.length);for(let st=0,ot=rt.length;st<ot;st++)it[st]=rt[st]*nt;rt=it}return rt}_createCubicSplineTrackInterpolant(_e){_e.createInterpolant=function(nt){const it=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new it(this.times,this.values,this.getValueSize()/3,nt)},_e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function computeBounds(tt,_e,rt){const nt=_e.attributes,it=new Box3;if(nt.POSITION!==void 0){const lt=rt.json.accessors[nt.POSITION],at=lt.min,ct=lt.max;if(at!==void 0&&ct!==void 0){if(it.set(new Vector3(at[0],at[1],at[2]),new Vector3(ct[0],ct[1],ct[2])),lt.normalized){const ut=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[lt.componentType]);it.min.multiplyScalar(ut),it.max.multiplyScalar(ut)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const st=_e.targets;if(st!==void 0){const lt=new Vector3,at=new Vector3;for(let ct=0,ut=st.length;ct<ut;ct++){const ht=st[ct];if(ht.POSITION!==void 0){const dt=rt.json.accessors[ht.POSITION],ft=dt.min,pt=dt.max;if(ft!==void 0&&pt!==void 0){if(at.setX(Math.max(Math.abs(ft[0]),Math.abs(pt[0]))),at.setY(Math.max(Math.abs(ft[1]),Math.abs(pt[1]))),at.setZ(Math.max(Math.abs(ft[2]),Math.abs(pt[2]))),dt.normalized){const mt=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[dt.componentType]);at.multiplyScalar(mt)}lt.max(at)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}it.expandByVector(lt)}tt.boundingBox=it;const ot=new Sphere;it.getCenter(ot.center),ot.radius=it.min.distanceTo(it.max)/2,tt.boundingSphere=ot}function addPrimitiveAttributes(tt,_e,rt){const nt=_e.attributes,it=[];function st(ot,lt){return rt.getDependency("accessor",ot).then(function(at){tt.setAttribute(lt,at)})}for(const ot in nt){const lt=ATTRIBUTES[ot]||ot.toLowerCase();lt in tt.attributes||it.push(st(nt[ot],lt))}if(_e.indices!==void 0&&!tt.index){const ot=rt.getDependency("accessor",_e.indices).then(function(lt){tt.setIndex(lt)});it.push(ot)}return assignExtrasToUserData(tt,_e),computeBounds(tt,_e,rt),Promise.all(it).then(function(){return _e.targets!==void 0?addMorphTargets(tt,_e.targets,rt):tt})}function Model3D({percentage:tt,..._e}){const rt=reactExports.useRef(),{scene:nt,animations:it}=useLoader(GLTFLoader,_e.model);new MeshBasicMaterial({color:"red",wireframe:!1});const st=new MeshStandardMaterial({color:_e.color,flatShading:!0});nt.traverse(at=>{at.isMesh&&(at.material=st)});const ot=reactExports.useRef([]);rt.current=new AnimationMixer(nt);for(const at of it){const ct=rt.current.clipAction(at);ct.play(),ct.paused=!0,ot.current.push({clip:at,action:ct})}const lt=at=>{for(const{clip:ct,action:ut}of ot.current)ut.time=at*ct.duration};return useFrame((at,ct)=>{rt.current.update(ct)}),lt(tt),jsxRuntimeExports.jsx("primitive",{object:nt,scale:2})}function useAnimationControls(){const{percentage:tt}=useControls({percentage:{value:0,min:0,max:1,step:.01}});return tt}const models=["../box3d0.gltf","../box3d1.gltf","../box3d2.gltf","../dagiac1.gltf","../_source Cylinder2 100fps.glb"],button_positions=[[3.8,.2,2.5],[.1,.2,2.5],[.1,.2,2.8],[.1,.2,3.8],[.1,.2,2.8]];function Box3D(){let tt=useAnimationControls(),_e=0;const rt=useParams().box_id;rt===void 0?_e=0:_e=parseInt(rt),_e==0?(_e=useControls({box_style:{options:{"Style 01":0,"Style 02":1,"Style 03":2},onChange:lt=>{_e=lt},transient:!1}}).box_style,_e===void 0&&(_e=0)):_e+=2;const nt=models[_e],it=button_positions[_e],st={visible:!0,position:{x:3.3,y:1,z:4.4},castShadow:!0};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Canvas$1,{camera:{position:[-10,10,10],fov:60},children:jsxRuntimeExports.jsxs(XR,{children:[jsxRuntimeExports.jsx(Sky,{sunPosition:[0,1,0]}),jsxRuntimeExports.jsx("ambientLight",{}),jsxRuntimeExports.jsx("directionalLight",{visible:st.visible,position:[st.position.x,st.position.y,st.position.z],castShadow:st.castShadow}),jsxRuntimeExports.jsx(Button3D,{position:it,text:"tekville.com"}),jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:null,children:[jsxRuntimeExports.jsx(Model3D,{percentage:tt,model:nt,color:15630622}),jsxRuntimeExports.jsx(OrbitControls,{}),jsxRuntimeExports.jsx(Stats,{})]})]})})})}const App=()=>jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{exact:!0,path:"/vr-demo",element:jsxRuntimeExports.jsx(VRApp,{})}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/vr-demo/3D/:box_id",element:jsxRuntimeExports.jsx(Box3D,{})}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/vr-demo/VRApp",element:jsxRuntimeExports.jsx(VRApp,{})}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/0",Component:JSXGraphReact}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/1",Component:JSXGraphReact2}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/2",Component:JSXGraphComponent$9}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/3",Component:JSXGraphComponent$8}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/4",Component:JSXGraphComponent$7}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/5",Component:JSXGraphComponent$6}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/6",Component:JSXGraphComponent$5}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/7",Component:JSXGraphComponent$4}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/8",Component:JSXGraphComponent$3}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/9",Component:JSXGraphComponent$2}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/10",Component:JSXGraphComponent$1}),jsxRuntimeExports.jsx(Route,{path:"/vr-demo/2D/11",Component:JSXGraphComponent})]})}),index="";client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.Fragment,{children:jsxRuntimeExports.jsx(App,{})}))});export default vm();
