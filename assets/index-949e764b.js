var m1=(tt,_e)=>()=>(_e||tt((_e={exports:{}}).exports,_e),_e.exports);var v1=m1((exports,module)=>{function _mergeNamespaces(tt,_e){for(var rt=0;rt<_e.length;rt++){const it=_e[rt];if(typeof it!="string"&&!Array.isArray(it)){for(const nt in it)if(nt!=="default"&&!(nt in tt)){const st=Object.getOwnPropertyDescriptor(it,nt);st&&Object.defineProperty(tt,nt,st.get?st:{enumerable:!0,get:()=>it[nt]})}}}return Object.freeze(Object.defineProperty(tt,Symbol.toStringTag,{value:"Module"}))}(function(){const _e=document.createElement("link").relList;if(_e&&_e.supports&&_e.supports("modulepreload"))return;for(const nt of document.querySelectorAll('link[rel="modulepreload"]'))it(nt);new MutationObserver(nt=>{for(const st of nt)if(st.type==="childList")for(const at of st.addedNodes)at.tagName==="LINK"&&at.rel==="modulepreload"&&it(at)}).observe(document,{childList:!0,subtree:!0});function rt(nt){const st={};return nt.integrity&&(st.integrity=nt.integrity),nt.referrerPolicy&&(st.referrerPolicy=nt.referrerPolicy),nt.crossOrigin==="use-credentials"?st.credentials="include":nt.crossOrigin==="anonymous"?st.credentials="omit":st.credentials="same-origin",st}function it(nt){if(nt.ep)return;nt.ep=!0;const st=rt(nt);fetch(nt.href,st)}})();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(tt){return tt&&tt.__esModule&&Object.prototype.hasOwnProperty.call(tt,"default")?tt.default:tt}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$6=Symbol.for("react.element"),n$6=Symbol.for("react.portal"),p$6=Symbol.for("react.fragment"),q$3=Symbol.for("react.strict_mode"),r$5=Symbol.for("react.profiler"),t$6=Symbol.for("react.provider"),u$4=Symbol.for("react.context"),v$5=Symbol.for("react.forward_ref"),w$3=Symbol.for("react.suspense"),x$4=Symbol.for("react.memo"),y$4=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$3(tt){return tt===null||typeof tt!="object"?null:(tt=z$2&&tt[z$2]||tt["@@iterator"],typeof tt=="function"?tt:null)}var B$3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$3=Object.assign,D$2={};function E$3(tt,_e,rt){this.props=tt,this.context=_e,this.refs=D$2,this.updater=rt||B$3}E$3.prototype.isReactComponent={};E$3.prototype.setState=function(tt,_e){if(typeof tt!="object"&&typeof tt!="function"&&tt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,tt,_e,"setState")};E$3.prototype.forceUpdate=function(tt){this.updater.enqueueForceUpdate(this,tt,"forceUpdate")};function F$2(){}F$2.prototype=E$3.prototype;function G$2(tt,_e,rt){this.props=tt,this.context=_e,this.refs=D$2,this.updater=rt||B$3}var H$3=G$2.prototype=new F$2;H$3.constructor=G$2;C$3(H$3,E$3.prototype);H$3.isPureReactComponent=!0;var I$5=Array.isArray,J$2=Object.prototype.hasOwnProperty,K$1={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$3(tt,_e,rt){var it,nt={},st=null,at=null;if(_e!=null)for(it in _e.ref!==void 0&&(at=_e.ref),_e.key!==void 0&&(st=""+_e.key),_e)J$2.call(_e,it)&&!L$3.hasOwnProperty(it)&&(nt[it]=_e[it]);var lt=arguments.length-2;if(lt===1)nt.children=rt;else if(1<lt){for(var ot=Array(lt),ct=0;ct<lt;ct++)ot[ct]=arguments[ct+2];nt.children=ot}if(tt&&tt.defaultProps)for(it in lt=tt.defaultProps,lt)nt[it]===void 0&&(nt[it]=lt[it]);return{$$typeof:l$6,type:tt,key:st,ref:at,props:nt,_owner:K$1.current}}function N$3(tt,_e){return{$$typeof:l$6,type:tt.type,key:_e,ref:tt.ref,props:tt.props,_owner:tt._owner}}function O$2(tt){return typeof tt=="object"&&tt!==null&&tt.$$typeof===l$6}function escape$1(tt){var _e={"=":"=0",":":"=2"};return"$"+tt.replace(/[=:]/g,function(rt){return _e[rt]})}var P$2=/\/+/g;function Q$3(tt,_e){return typeof tt=="object"&&tt!==null&&tt.key!=null?escape$1(""+tt.key):_e.toString(36)}function R$2(tt,_e,rt,it,nt){var st=typeof tt;(st==="undefined"||st==="boolean")&&(tt=null);var at=!1;if(tt===null)at=!0;else switch(st){case"string":case"number":at=!0;break;case"object":switch(tt.$$typeof){case l$6:case n$6:at=!0}}if(at)return at=tt,nt=nt(at),tt=it===""?"."+Q$3(at,0):it,I$5(nt)?(rt="",tt!=null&&(rt=tt.replace(P$2,"$&/")+"/"),R$2(nt,_e,rt,"",function(ct){return ct})):nt!=null&&(O$2(nt)&&(nt=N$3(nt,rt+(!nt.key||at&&at.key===nt.key?"":(""+nt.key).replace(P$2,"$&/")+"/")+tt)),_e.push(nt)),1;if(at=0,it=it===""?".":it+":",I$5(tt))for(var lt=0;lt<tt.length;lt++){st=tt[lt];var ot=it+Q$3(st,lt);at+=R$2(st,_e,rt,ot,nt)}else if(ot=A$3(tt),typeof ot=="function")for(tt=ot.call(tt),lt=0;!(st=tt.next()).done;)st=st.value,ot=it+Q$3(st,lt++),at+=R$2(st,_e,rt,ot,nt);else if(st==="object")throw _e=String(tt),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(tt).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.");return at}function S$4(tt,_e,rt){if(tt==null)return tt;var it=[],nt=0;return R$2(tt,it,"","",function(st){return _e.call(rt,st,nt++)}),it}function T$3(tt){if(tt._status===-1){var _e=tt._result;_e=_e(),_e.then(function(rt){(tt._status===0||tt._status===-1)&&(tt._status=1,tt._result=rt)},function(rt){(tt._status===0||tt._status===-1)&&(tt._status=2,tt._result=rt)}),tt._status===-1&&(tt._status=0,tt._result=_e)}if(tt._status===1)return tt._result.default;throw tt._result}var U$3={current:null},V$4={transition:null},W$2={ReactCurrentDispatcher:U$3,ReactCurrentBatchConfig:V$4,ReactCurrentOwner:K$1};react_production_min.Children={map:S$4,forEach:function(tt,_e,rt){S$4(tt,function(){_e.apply(this,arguments)},rt)},count:function(tt){var _e=0;return S$4(tt,function(){_e++}),_e},toArray:function(tt){return S$4(tt,function(_e){return _e})||[]},only:function(tt){if(!O$2(tt))throw Error("React.Children.only expected to receive a single React element child.");return tt}};react_production_min.Component=E$3;react_production_min.Fragment=p$6;react_production_min.Profiler=r$5;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$3;react_production_min.Suspense=w$3;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.cloneElement=function(tt,_e,rt){if(tt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+tt+".");var it=C$3({},tt.props),nt=tt.key,st=tt.ref,at=tt._owner;if(_e!=null){if(_e.ref!==void 0&&(st=_e.ref,at=K$1.current),_e.key!==void 0&&(nt=""+_e.key),tt.type&&tt.type.defaultProps)var lt=tt.type.defaultProps;for(ot in _e)J$2.call(_e,ot)&&!L$3.hasOwnProperty(ot)&&(it[ot]=_e[ot]===void 0&&lt!==void 0?lt[ot]:_e[ot])}var ot=arguments.length-2;if(ot===1)it.children=rt;else if(1<ot){lt=Array(ot);for(var ct=0;ct<ot;ct++)lt[ct]=arguments[ct+2];it.children=lt}return{$$typeof:l$6,type:tt.type,key:nt,ref:st,props:it,_owner:at}};react_production_min.createContext=function(tt){return tt={$$typeof:u$4,_currentValue:tt,_currentValue2:tt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},tt.Provider={$$typeof:t$6,_context:tt},tt.Consumer=tt};react_production_min.createElement=M$3;react_production_min.createFactory=function(tt){var _e=M$3.bind(null,tt);return _e.type=tt,_e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(tt){return{$$typeof:v$5,render:tt}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(tt){return{$$typeof:y$4,_payload:{_status:-1,_result:tt},_init:T$3}};react_production_min.memo=function(tt,_e){return{$$typeof:x$4,type:tt,compare:_e===void 0?null:_e}};react_production_min.startTransition=function(tt){var _e=V$4.transition;V$4.transition={};try{tt()}finally{V$4.transition=_e}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(tt,_e){return U$3.current.useCallback(tt,_e)};react_production_min.useContext=function(tt){return U$3.current.useContext(tt)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(tt){return U$3.current.useDeferredValue(tt)};react_production_min.useEffect=function(tt,_e){return U$3.current.useEffect(tt,_e)};react_production_min.useId=function(){return U$3.current.useId()};react_production_min.useImperativeHandle=function(tt,_e,rt){return U$3.current.useImperativeHandle(tt,_e,rt)};react_production_min.useInsertionEffect=function(tt,_e){return U$3.current.useInsertionEffect(tt,_e)};react_production_min.useLayoutEffect=function(tt,_e){return U$3.current.useLayoutEffect(tt,_e)};react_production_min.useMemo=function(tt,_e){return U$3.current.useMemo(tt,_e)};react_production_min.useReducer=function(tt,_e,rt){return U$3.current.useReducer(tt,_e,rt)};react_production_min.useRef=function(tt){return U$3.current.useRef(tt)};react_production_min.useState=function(tt){return U$3.current.useState(tt)};react_production_min.useSyncExternalStore=function(tt,_e,rt){return U$3.current.useSyncExternalStore(tt,_e,rt)};react_production_min.useTransition=function(){return U$3.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),t$5=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$4=reactExports,k$4=Symbol.for("react.element"),l$5=Symbol.for("react.fragment"),m$5=Object.prototype.hasOwnProperty,n$5=f$4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$5={key:!0,ref:!0,__self:!0,__source:!0};function q$2(tt,_e,rt){var it,nt={},st=null,at=null;rt!==void 0&&(st=""+rt),_e.key!==void 0&&(st=""+_e.key),_e.ref!==void 0&&(at=_e.ref);for(it in _e)m$5.call(_e,it)&&!p$5.hasOwnProperty(it)&&(nt[it]=_e[it]);if(tt&&tt.defaultProps)for(it in _e=tt.defaultProps,_e)nt[it]===void 0&&(nt[it]=_e[it]);return{$$typeof:k$4,type:tt,key:st,ref:at,props:nt,_owner:n$5.current}}reactJsxRuntime_production_min.Fragment=l$5;reactJsxRuntime_production_min.jsx=q$2;reactJsxRuntime_production_min.jsxs=q$2;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler$2={exports:{}},scheduler_production_min$2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(tt){function _e(Dt,Ft){var Ut=Dt.length;Dt.push(Ft);e:for(;0<Ut;){var $t=Ut-1>>>1,Vt=Dt[$t];if(0<nt(Vt,Ft))Dt[$t]=Ft,Dt[Ut]=Vt,Ut=$t;else break e}}function rt(Dt){return Dt.length===0?null:Dt[0]}function it(Dt){if(Dt.length===0)return null;var Ft=Dt[0],Ut=Dt.pop();if(Ut!==Ft){Dt[0]=Ut;e:for(var $t=0,Vt=Dt.length,Zt=Vt>>>1;$t<Zt;){var qt=2*($t+1)-1,sr=Dt[qt],er=qt+1,ir=Dt[er];if(0>nt(sr,Ut))er<Vt&&0>nt(ir,sr)?(Dt[$t]=ir,Dt[er]=Ut,$t=er):(Dt[$t]=sr,Dt[qt]=Ut,$t=qt);else if(er<Vt&&0>nt(ir,Ut))Dt[$t]=ir,Dt[er]=Ut,$t=er;else break e}}return Ft}function nt(Dt,Ft){var Ut=Dt.sortIndex-Ft.sortIndex;return Ut!==0?Ut:Dt.id-Ft.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;tt.unstable_now=function(){return st.now()}}else{var at=Date,lt=at.now();tt.unstable_now=function(){return at.now()-lt}}var ot=[],ct=[],ut=1,ht=null,dt=3,pt=!1,ft=!1,gt=!1,mt=typeof setTimeout=="function"?setTimeout:null,At=typeof clearTimeout=="function"?clearTimeout:null,yt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function bt(Dt){for(var Ft=rt(ct);Ft!==null;){if(Ft.callback===null)it(ct);else if(Ft.startTime<=Dt)it(ct),Ft.sortIndex=Ft.expirationTime,_e(ot,Ft);else break;Ft=rt(ct)}}function xt(Dt){if(gt=!1,bt(Dt),!ft)if(rt(ot)!==null)ft=!0,Nt(vt);else{var Ft=rt(ct);Ft!==null&&zt(xt,Ft.startTime-Dt)}}function vt(Dt,Ft){ft=!1,gt&&(gt=!1,At(St),St=-1),pt=!0;var Ut=dt;try{for(bt(Ft),ht=rt(ot);ht!==null&&(!(ht.expirationTime>Ft)||Dt&&!Mt());){var $t=ht.callback;if(typeof $t=="function"){ht.callback=null,dt=ht.priorityLevel;var Vt=$t(ht.expirationTime<=Ft);Ft=tt.unstable_now(),typeof Vt=="function"?ht.callback=Vt:ht===rt(ot)&&it(ot),bt(Ft)}else it(ot);ht=rt(ot)}if(ht!==null)var Zt=!0;else{var qt=rt(ct);qt!==null&&zt(xt,qt.startTime-Ft),Zt=!1}return Zt}finally{ht=null,dt=Ut,pt=!1}}var _t=!1,Ct=null,St=-1,Et=5,Tt=-1;function Mt(){return!(tt.unstable_now()-Tt<Et)}function Rt(){if(Ct!==null){var Dt=tt.unstable_now();Tt=Dt;var Ft=!0;try{Ft=Ct(!0,Dt)}finally{Ft?It():(_t=!1,Ct=null)}}else _t=!1}var It;if(typeof yt=="function")It=function(){yt(Rt)};else if(typeof MessageChannel<"u"){var Ot=new MessageChannel,Bt=Ot.port2;Ot.port1.onmessage=Rt,It=function(){Bt.postMessage(null)}}else It=function(){mt(Rt,0)};function Nt(Dt){Ct=Dt,_t||(_t=!0,It())}function zt(Dt,Ft){St=mt(function(){Dt(tt.unstable_now())},Ft)}tt.unstable_IdlePriority=5,tt.unstable_ImmediatePriority=1,tt.unstable_LowPriority=4,tt.unstable_NormalPriority=3,tt.unstable_Profiling=null,tt.unstable_UserBlockingPriority=2,tt.unstable_cancelCallback=function(Dt){Dt.callback=null},tt.unstable_continueExecution=function(){ft||pt||(ft=!0,Nt(vt))},tt.unstable_forceFrameRate=function(Dt){0>Dt||125<Dt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Et=0<Dt?Math.floor(1e3/Dt):5},tt.unstable_getCurrentPriorityLevel=function(){return dt},tt.unstable_getFirstCallbackNode=function(){return rt(ot)},tt.unstable_next=function(Dt){switch(dt){case 1:case 2:case 3:var Ft=3;break;default:Ft=dt}var Ut=dt;dt=Ft;try{return Dt()}finally{dt=Ut}},tt.unstable_pauseExecution=function(){},tt.unstable_requestPaint=function(){},tt.unstable_runWithPriority=function(Dt,Ft){switch(Dt){case 1:case 2:case 3:case 4:case 5:break;default:Dt=3}var Ut=dt;dt=Dt;try{return Ft()}finally{dt=Ut}},tt.unstable_scheduleCallback=function(Dt,Ft,Ut){var $t=tt.unstable_now();switch(typeof Ut=="object"&&Ut!==null?(Ut=Ut.delay,Ut=typeof Ut=="number"&&0<Ut?$t+Ut:$t):Ut=$t,Dt){case 1:var Vt=-1;break;case 2:Vt=250;break;case 5:Vt=1073741823;break;case 4:Vt=1e4;break;default:Vt=5e3}return Vt=Ut+Vt,Dt={id:ut++,callback:Ft,priorityLevel:Dt,startTime:Ut,expirationTime:Vt,sortIndex:-1},Ut>$t?(Dt.sortIndex=Ut,_e(ct,Dt),rt(ot)===null&&Dt===rt(ct)&&(gt?(At(St),St=-1):gt=!0,zt(xt,Ut-$t))):(Dt.sortIndex=Vt,_e(ot,Dt),ft||pt||(ft=!0,Nt(vt))),Dt},tt.unstable_shouldYield=Mt,tt.unstable_wrapCallback=function(Dt){var Ft=dt;return function(){var Ut=dt;dt=Ft;try{return Dt.apply(this,arguments)}finally{dt=Ut}}}})(scheduler_production_min$2);scheduler$2.exports=scheduler_production_min$2;var schedulerExports$1=scheduler$2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports$1;function p$4(tt){for(var _e="https://reactjs.org/docs/error-decoder.html?invariant="+tt,rt=1;rt<arguments.length;rt++)_e+="&args[]="+encodeURIComponent(arguments[rt]);return"Minified React error #"+tt+"; visit "+_e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(tt,_e){ha(tt,_e),ha(tt+"Capture",_e)}function ha(tt,_e){for(ea[tt]=_e,tt=0;tt<_e.length;tt++)da.add(_e[tt])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(tt){return ja.call(ma,tt)?!0:ja.call(la,tt)?!1:ka.test(tt)?ma[tt]=!0:(la[tt]=!0,!1)}function pa(tt,_e,rt,it){if(rt!==null&&rt.type===0)return!1;switch(typeof _e){case"function":case"symbol":return!0;case"boolean":return it?!1:rt!==null?!rt.acceptsBooleans:(tt=tt.toLowerCase().slice(0,5),tt!=="data-"&&tt!=="aria-");default:return!1}}function qa(tt,_e,rt,it){if(_e===null||typeof _e>"u"||pa(tt,_e,rt,it))return!0;if(it)return!1;if(rt!==null)switch(rt.type){case 3:return!_e;case 4:return _e===!1;case 5:return isNaN(_e);case 6:return isNaN(_e)||1>_e}return!1}function v$4(tt,_e,rt,it,nt,st,at){this.acceptsBooleans=_e===2||_e===3||_e===4,this.attributeName=it,this.attributeNamespace=nt,this.mustUseProperty=rt,this.propertyName=tt,this.type=_e,this.sanitizeURL=st,this.removeEmptyString=at}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(tt){z$1[tt]=new v$4(tt,0,!1,tt,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(tt){var _e=tt[0];z$1[_e]=new v$4(_e,1,!1,tt[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(tt){z$1[tt]=new v$4(tt,2,!1,tt.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(tt){z$1[tt]=new v$4(tt,2,!1,tt,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(tt){z$1[tt]=new v$4(tt,3,!1,tt.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(tt){z$1[tt]=new v$4(tt,3,!0,tt,null,!1,!1)});["capture","download"].forEach(function(tt){z$1[tt]=new v$4(tt,4,!1,tt,null,!1,!1)});["cols","rows","size","span"].forEach(function(tt){z$1[tt]=new v$4(tt,6,!1,tt,null,!1,!1)});["rowSpan","start"].forEach(function(tt){z$1[tt]=new v$4(tt,5,!1,tt.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(tt){return tt[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(tt){var _e=tt.replace(ra,sa);z$1[_e]=new v$4(_e,1,!1,tt,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(tt){var _e=tt.replace(ra,sa);z$1[_e]=new v$4(_e,1,!1,tt,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(tt){var _e=tt.replace(ra,sa);z$1[_e]=new v$4(_e,1,!1,tt,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(tt){z$1[tt]=new v$4(tt,1,!1,tt.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$4("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(tt){z$1[tt]=new v$4(tt,1,!1,tt.toLowerCase(),null,!0,!0)});function ta(tt,_e,rt,it){var nt=z$1.hasOwnProperty(_e)?z$1[_e]:null;(nt!==null?nt.type!==0:it||!(2<_e.length)||_e[0]!=="o"&&_e[0]!=="O"||_e[1]!=="n"&&_e[1]!=="N")&&(qa(_e,rt,nt,it)&&(rt=null),it||nt===null?oa(_e)&&(rt===null?tt.removeAttribute(_e):tt.setAttribute(_e,""+rt)):nt.mustUseProperty?tt[nt.propertyName]=rt===null?nt.type===3?!1:"":rt:(_e=nt.attributeName,it=nt.attributeNamespace,rt===null?tt.removeAttribute(_e):(nt=nt.type,rt=nt===3||nt===4&&rt===!0?"":""+rt,it?tt.setAttributeNS(it,_e,rt):tt.setAttribute(_e,rt))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(tt){return tt===null||typeof tt!="object"?null:(tt=Ja&&tt[Ja]||tt["@@iterator"],typeof tt=="function"?tt:null)}var A$2=Object.assign,La;function Ma(tt){if(La===void 0)try{throw Error()}catch(rt){var _e=rt.stack.trim().match(/\n( *(at )?)/);La=_e&&_e[1]||""}return`
`+La+tt}var Na=!1;function Oa(tt,_e){if(!tt||Na)return"";Na=!0;var rt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_e)if(_e=function(){throw Error()},Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(ct){var it=ct}Reflect.construct(tt,[],_e)}else{try{_e.call()}catch(ct){it=ct}tt.call(_e.prototype)}else{try{throw Error()}catch(ct){it=ct}tt()}}catch(ct){if(ct&&it&&typeof ct.stack=="string"){for(var nt=ct.stack.split(`
`),st=it.stack.split(`
`),at=nt.length-1,lt=st.length-1;1<=at&&0<=lt&&nt[at]!==st[lt];)lt--;for(;1<=at&&0<=lt;at--,lt--)if(nt[at]!==st[lt]){if(at!==1||lt!==1)do if(at--,lt--,0>lt||nt[at]!==st[lt]){var ot=`
`+nt[at].replace(" at new "," at ");return tt.displayName&&ot.includes("<anonymous>")&&(ot=ot.replace("<anonymous>",tt.displayName)),ot}while(1<=at&&0<=lt);break}}}finally{Na=!1,Error.prepareStackTrace=rt}return(tt=tt?tt.displayName||tt.name:"")?Ma(tt):""}function Pa(tt){switch(tt.tag){case 5:return Ma(tt.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return tt=Oa(tt.type,!1),tt;case 11:return tt=Oa(tt.type.render,!1),tt;case 1:return tt=Oa(tt.type,!0),tt;default:return""}}function Qa(tt){if(tt==null)return null;if(typeof tt=="function")return tt.displayName||tt.name||null;if(typeof tt=="string")return tt;switch(tt){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof tt=="object")switch(tt.$$typeof){case Ca:return(tt.displayName||"Context")+".Consumer";case Ba:return(tt._context.displayName||"Context")+".Provider";case Da:var _e=tt.render;return tt=tt.displayName,tt||(tt=_e.displayName||_e.name||"",tt=tt!==""?"ForwardRef("+tt+")":"ForwardRef"),tt;case Ga:return _e=tt.displayName||null,_e!==null?_e:Qa(tt.type)||"Memo";case Ha:_e=tt._payload,tt=tt._init;try{return Qa(tt(_e))}catch{}}return null}function Ra(tt){var _e=tt.type;switch(tt.tag){case 24:return"Cache";case 9:return(_e.displayName||"Context")+".Consumer";case 10:return(_e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return tt=_e.render,tt=tt.displayName||tt.name||"",_e.displayName||(tt!==""?"ForwardRef("+tt+")":"ForwardRef");case 7:return"Fragment";case 5:return _e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(_e);case 8:return _e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _e=="function")return _e.displayName||_e.name||null;if(typeof _e=="string")return _e}return null}function Sa(tt){switch(typeof tt){case"boolean":case"number":case"string":case"undefined":return tt;case"object":return tt;default:return""}}function Ta(tt){var _e=tt.type;return(tt=tt.nodeName)&&tt.toLowerCase()==="input"&&(_e==="checkbox"||_e==="radio")}function Ua(tt){var _e=Ta(tt)?"checked":"value",rt=Object.getOwnPropertyDescriptor(tt.constructor.prototype,_e),it=""+tt[_e];if(!tt.hasOwnProperty(_e)&&typeof rt<"u"&&typeof rt.get=="function"&&typeof rt.set=="function"){var nt=rt.get,st=rt.set;return Object.defineProperty(tt,_e,{configurable:!0,get:function(){return nt.call(this)},set:function(at){it=""+at,st.call(this,at)}}),Object.defineProperty(tt,_e,{enumerable:rt.enumerable}),{getValue:function(){return it},setValue:function(at){it=""+at},stopTracking:function(){tt._valueTracker=null,delete tt[_e]}}}}function Va(tt){tt._valueTracker||(tt._valueTracker=Ua(tt))}function Wa(tt){if(!tt)return!1;var _e=tt._valueTracker;if(!_e)return!0;var rt=_e.getValue(),it="";return tt&&(it=Ta(tt)?tt.checked?"true":"false":tt.value),tt=it,tt!==rt?(_e.setValue(tt),!0):!1}function Xa(tt){if(tt=tt||(typeof document<"u"?document:void 0),typeof tt>"u")return null;try{return tt.activeElement||tt.body}catch{return tt.body}}function Ya(tt,_e){var rt=_e.checked;return A$2({},_e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:rt??tt._wrapperState.initialChecked})}function Za(tt,_e){var rt=_e.defaultValue==null?"":_e.defaultValue,it=_e.checked!=null?_e.checked:_e.defaultChecked;rt=Sa(_e.value!=null?_e.value:rt),tt._wrapperState={initialChecked:it,initialValue:rt,controlled:_e.type==="checkbox"||_e.type==="radio"?_e.checked!=null:_e.value!=null}}function ab(tt,_e){_e=_e.checked,_e!=null&&ta(tt,"checked",_e,!1)}function bb(tt,_e){ab(tt,_e);var rt=Sa(_e.value),it=_e.type;if(rt!=null)it==="number"?(rt===0&&tt.value===""||tt.value!=rt)&&(tt.value=""+rt):tt.value!==""+rt&&(tt.value=""+rt);else if(it==="submit"||it==="reset"){tt.removeAttribute("value");return}_e.hasOwnProperty("value")?cb(tt,_e.type,rt):_e.hasOwnProperty("defaultValue")&&cb(tt,_e.type,Sa(_e.defaultValue)),_e.checked==null&&_e.defaultChecked!=null&&(tt.defaultChecked=!!_e.defaultChecked)}function db(tt,_e,rt){if(_e.hasOwnProperty("value")||_e.hasOwnProperty("defaultValue")){var it=_e.type;if(!(it!=="submit"&&it!=="reset"||_e.value!==void 0&&_e.value!==null))return;_e=""+tt._wrapperState.initialValue,rt||_e===tt.value||(tt.value=_e),tt.defaultValue=_e}rt=tt.name,rt!==""&&(tt.name=""),tt.defaultChecked=!!tt._wrapperState.initialChecked,rt!==""&&(tt.name=rt)}function cb(tt,_e,rt){(_e!=="number"||Xa(tt.ownerDocument)!==tt)&&(rt==null?tt.defaultValue=""+tt._wrapperState.initialValue:tt.defaultValue!==""+rt&&(tt.defaultValue=""+rt))}var eb=Array.isArray;function fb(tt,_e,rt,it){if(tt=tt.options,_e){_e={};for(var nt=0;nt<rt.length;nt++)_e["$"+rt[nt]]=!0;for(rt=0;rt<tt.length;rt++)nt=_e.hasOwnProperty("$"+tt[rt].value),tt[rt].selected!==nt&&(tt[rt].selected=nt),nt&&it&&(tt[rt].defaultSelected=!0)}else{for(rt=""+Sa(rt),_e=null,nt=0;nt<tt.length;nt++){if(tt[nt].value===rt){tt[nt].selected=!0,it&&(tt[nt].defaultSelected=!0);return}_e!==null||tt[nt].disabled||(_e=tt[nt])}_e!==null&&(_e.selected=!0)}}function gb(tt,_e){if(_e.dangerouslySetInnerHTML!=null)throw Error(p$4(91));return A$2({},_e,{value:void 0,defaultValue:void 0,children:""+tt._wrapperState.initialValue})}function hb(tt,_e){var rt=_e.value;if(rt==null){if(rt=_e.children,_e=_e.defaultValue,rt!=null){if(_e!=null)throw Error(p$4(92));if(eb(rt)){if(1<rt.length)throw Error(p$4(93));rt=rt[0]}_e=rt}_e==null&&(_e=""),rt=_e}tt._wrapperState={initialValue:Sa(rt)}}function ib(tt,_e){var rt=Sa(_e.value),it=Sa(_e.defaultValue);rt!=null&&(rt=""+rt,rt!==tt.value&&(tt.value=rt),_e.defaultValue==null&&tt.defaultValue!==rt&&(tt.defaultValue=rt)),it!=null&&(tt.defaultValue=""+it)}function jb(tt){var _e=tt.textContent;_e===tt._wrapperState.initialValue&&_e!==""&&_e!==null&&(tt.value=_e)}function kb(tt){switch(tt){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(tt,_e){return tt==null||tt==="http://www.w3.org/1999/xhtml"?kb(_e):tt==="http://www.w3.org/2000/svg"&&_e==="foreignObject"?"http://www.w3.org/1999/xhtml":tt}var mb,nb=function(tt){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(_e,rt,it,nt){MSApp.execUnsafeLocalFunction(function(){return tt(_e,rt,it,nt)})}:tt}(function(tt,_e){if(tt.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in tt)tt.innerHTML=_e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+_e.valueOf().toString()+"</svg>",_e=mb.firstChild;tt.firstChild;)tt.removeChild(tt.firstChild);for(;_e.firstChild;)tt.appendChild(_e.firstChild)}});function ob(tt,_e){if(_e){var rt=tt.firstChild;if(rt&&rt===tt.lastChild&&rt.nodeType===3){rt.nodeValue=_e;return}}tt.textContent=_e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(tt){qb.forEach(function(_e){_e=_e+tt.charAt(0).toUpperCase()+tt.substring(1),pb[_e]=pb[tt]})});function rb(tt,_e,rt){return _e==null||typeof _e=="boolean"||_e===""?"":rt||typeof _e!="number"||_e===0||pb.hasOwnProperty(tt)&&pb[tt]?(""+_e).trim():_e+"px"}function sb(tt,_e){tt=tt.style;for(var rt in _e)if(_e.hasOwnProperty(rt)){var it=rt.indexOf("--")===0,nt=rb(rt,_e[rt],it);rt==="float"&&(rt="cssFloat"),it?tt.setProperty(rt,nt):tt[rt]=nt}}var tb=A$2({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(tt,_e){if(_e){if(tb[tt]&&(_e.children!=null||_e.dangerouslySetInnerHTML!=null))throw Error(p$4(137,tt));if(_e.dangerouslySetInnerHTML!=null){if(_e.children!=null)throw Error(p$4(60));if(typeof _e.dangerouslySetInnerHTML!="object"||!("__html"in _e.dangerouslySetInnerHTML))throw Error(p$4(61))}if(_e.style!=null&&typeof _e.style!="object")throw Error(p$4(62))}}function vb(tt,_e){if(tt.indexOf("-")===-1)return typeof _e.is=="string";switch(tt){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(tt){return tt=tt.target||tt.srcElement||window,tt.correspondingUseElement&&(tt=tt.correspondingUseElement),tt.nodeType===3?tt.parentNode:tt}var yb=null,zb=null,Ab=null;function Bb(tt){if(tt=Cb(tt)){if(typeof yb!="function")throw Error(p$4(280));var _e=tt.stateNode;_e&&(_e=Db(_e),yb(tt.stateNode,tt.type,_e))}}function Eb(tt){zb?Ab?Ab.push(tt):Ab=[tt]:zb=tt}function Fb(){if(zb){var tt=zb,_e=Ab;if(Ab=zb=null,Bb(tt),_e)for(tt=0;tt<_e.length;tt++)Bb(_e[tt])}}function Gb(tt,_e){return tt(_e)}function Hb(){}var Ib=!1;function Jb(tt,_e,rt){if(Ib)return tt(_e,rt);Ib=!0;try{return Gb(tt,_e,rt)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(tt,_e){var rt=tt.stateNode;if(rt===null)return null;var it=Db(rt);if(it===null)return null;rt=it[_e];e:switch(_e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(it=!it.disabled)||(tt=tt.type,it=!(tt==="button"||tt==="input"||tt==="select"||tt==="textarea")),tt=!it;break e;default:tt=!1}if(tt)return null;if(rt&&typeof rt!="function")throw Error(p$4(231,_e,typeof rt));return rt}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(tt,_e,rt,it,nt,st,at,lt,ot){var ct=Array.prototype.slice.call(arguments,3);try{_e.apply(rt,ct)}catch(ut){this.onError(ut)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(tt){Ob=!0,Pb=tt}};function Tb(tt,_e,rt,it,nt,st,at,lt,ot){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(tt,_e,rt,it,nt,st,at,lt,ot){if(Tb.apply(this,arguments),Ob){if(Ob){var ct=Pb;Ob=!1,Pb=null}else throw Error(p$4(198));Qb||(Qb=!0,Rb=ct)}}function Vb(tt){var _e=tt,rt=tt;if(tt.alternate)for(;_e.return;)_e=_e.return;else{tt=_e;do _e=tt,_e.flags&4098&&(rt=_e.return),tt=_e.return;while(tt)}return _e.tag===3?rt:null}function Wb(tt){if(tt.tag===13){var _e=tt.memoizedState;if(_e===null&&(tt=tt.alternate,tt!==null&&(_e=tt.memoizedState)),_e!==null)return _e.dehydrated}return null}function Xb(tt){if(Vb(tt)!==tt)throw Error(p$4(188))}function Yb(tt){var _e=tt.alternate;if(!_e){if(_e=Vb(tt),_e===null)throw Error(p$4(188));return _e!==tt?null:tt}for(var rt=tt,it=_e;;){var nt=rt.return;if(nt===null)break;var st=nt.alternate;if(st===null){if(it=nt.return,it!==null){rt=it;continue}break}if(nt.child===st.child){for(st=nt.child;st;){if(st===rt)return Xb(nt),tt;if(st===it)return Xb(nt),_e;st=st.sibling}throw Error(p$4(188))}if(rt.return!==it.return)rt=nt,it=st;else{for(var at=!1,lt=nt.child;lt;){if(lt===rt){at=!0,rt=nt,it=st;break}if(lt===it){at=!0,it=nt,rt=st;break}lt=lt.sibling}if(!at){for(lt=st.child;lt;){if(lt===rt){at=!0,rt=st,it=nt;break}if(lt===it){at=!0,it=st,rt=nt;break}lt=lt.sibling}if(!at)throw Error(p$4(189))}}if(rt.alternate!==it)throw Error(p$4(190))}if(rt.tag!==3)throw Error(p$4(188));return rt.stateNode.current===rt?tt:_e}function Zb(tt){return tt=Yb(tt),tt!==null?$b(tt):null}function $b(tt){if(tt.tag===5||tt.tag===6)return tt;for(tt=tt.child;tt!==null;){var _e=$b(tt);if(_e!==null)return _e;tt=tt.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc$1=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$2=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(tt){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,tt,void 0,(tt.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(tt){return tt>>>=0,tt===0?32:31-(pc(tt)/qc|0)|0}var rc=64,sc=4194304;function tc(tt){switch(tt&-tt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return tt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return tt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return tt}}function uc(tt,_e){var rt=tt.pendingLanes;if(rt===0)return 0;var it=0,nt=tt.suspendedLanes,st=tt.pingedLanes,at=rt&268435455;if(at!==0){var lt=at&~nt;lt!==0?it=tc(lt):(st&=at,st!==0&&(it=tc(st)))}else at=rt&~nt,at!==0?it=tc(at):st!==0&&(it=tc(st));if(it===0)return 0;if(_e!==0&&_e!==it&&!(_e&nt)&&(nt=it&-it,st=_e&-_e,nt>=st||nt===16&&(st&4194240)!==0))return _e;if(it&4&&(it|=rt&16),_e=tt.entangledLanes,_e!==0)for(tt=tt.entanglements,_e&=it;0<_e;)rt=31-oc(_e),nt=1<<rt,it|=tt[rt],_e&=~nt;return it}function vc(tt,_e){switch(tt){case 1:case 2:case 4:return _e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(tt,_e){for(var rt=tt.suspendedLanes,it=tt.pingedLanes,nt=tt.expirationTimes,st=tt.pendingLanes;0<st;){var at=31-oc(st),lt=1<<at,ot=nt[at];ot===-1?(!(lt&rt)||lt&it)&&(nt[at]=vc(lt,_e)):ot<=_e&&(tt.expiredLanes|=lt),st&=~lt}}function xc(tt){return tt=tt.pendingLanes&-1073741825,tt!==0?tt:tt&1073741824?1073741824:0}function yc(){var tt=rc;return rc<<=1,!(rc&4194240)&&(rc=64),tt}function zc(tt){for(var _e=[],rt=0;31>rt;rt++)_e.push(tt);return _e}function Ac(tt,_e,rt){tt.pendingLanes|=_e,_e!==536870912&&(tt.suspendedLanes=0,tt.pingedLanes=0),tt=tt.eventTimes,_e=31-oc(_e),tt[_e]=rt}function Bc(tt,_e){var rt=tt.pendingLanes&~_e;tt.pendingLanes=_e,tt.suspendedLanes=0,tt.pingedLanes=0,tt.expiredLanes&=_e,tt.mutableReadLanes&=_e,tt.entangledLanes&=_e,_e=tt.entanglements;var it=tt.eventTimes;for(tt=tt.expirationTimes;0<rt;){var nt=31-oc(rt),st=1<<nt;_e[nt]=0,it[nt]=-1,tt[nt]=-1,rt&=~st}}function Cc(tt,_e){var rt=tt.entangledLanes|=_e;for(tt=tt.entanglements;rt;){var it=31-oc(rt),nt=1<<it;nt&_e|tt[it]&_e&&(tt[it]|=_e),rt&=~nt}}var C$2=0;function Dc(tt){return tt&=-tt,1<tt?4<tt?tt&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(tt,_e){switch(tt){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(_e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(_e.pointerId)}}function Tc(tt,_e,rt,it,nt,st){return tt===null||tt.nativeEvent!==st?(tt={blockedOn:_e,domEventName:rt,eventSystemFlags:it,nativeEvent:st,targetContainers:[nt]},_e!==null&&(_e=Cb(_e),_e!==null&&Fc(_e)),tt):(tt.eventSystemFlags|=it,_e=tt.targetContainers,nt!==null&&_e.indexOf(nt)===-1&&_e.push(nt),tt)}function Uc(tt,_e,rt,it,nt){switch(_e){case"focusin":return Lc=Tc(Lc,tt,_e,rt,it,nt),!0;case"dragenter":return Mc=Tc(Mc,tt,_e,rt,it,nt),!0;case"mouseover":return Nc=Tc(Nc,tt,_e,rt,it,nt),!0;case"pointerover":var st=nt.pointerId;return Oc.set(st,Tc(Oc.get(st)||null,tt,_e,rt,it,nt)),!0;case"gotpointercapture":return st=nt.pointerId,Pc.set(st,Tc(Pc.get(st)||null,tt,_e,rt,it,nt)),!0}return!1}function Vc(tt){var _e=Wc(tt.target);if(_e!==null){var rt=Vb(_e);if(rt!==null){if(_e=rt.tag,_e===13){if(_e=Wb(rt),_e!==null){tt.blockedOn=_e,Ic(tt.priority,function(){Gc(rt)});return}}else if(_e===3&&rt.stateNode.current.memoizedState.isDehydrated){tt.blockedOn=rt.tag===3?rt.stateNode.containerInfo:null;return}}}tt.blockedOn=null}function Xc(tt){if(tt.blockedOn!==null)return!1;for(var _e=tt.targetContainers;0<_e.length;){var rt=Yc(tt.domEventName,tt.eventSystemFlags,_e[0],tt.nativeEvent);if(rt===null){rt=tt.nativeEvent;var it=new rt.constructor(rt.type,rt);wb=it,rt.target.dispatchEvent(it),wb=null}else return _e=Cb(rt),_e!==null&&Fc(_e),tt.blockedOn=rt,!1;_e.shift()}return!0}function Zc(tt,_e,rt){Xc(tt)&&rt.delete(_e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(tt,_e){tt.blockedOn===_e&&(tt.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(tt){function _e(nt){return ad(nt,tt)}if(0<Kc.length){ad(Kc[0],tt);for(var rt=1;rt<Kc.length;rt++){var it=Kc[rt];it.blockedOn===tt&&(it.blockedOn=null)}}for(Lc!==null&&ad(Lc,tt),Mc!==null&&ad(Mc,tt),Nc!==null&&ad(Nc,tt),Oc.forEach(_e),Pc.forEach(_e),rt=0;rt<Qc.length;rt++)it=Qc[rt],it.blockedOn===tt&&(it.blockedOn=null);for(;0<Qc.length&&(rt=Qc[0],rt.blockedOn===null);)Vc(rt),rt.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(tt,_e,rt,it){var nt=C$2,st=cd.transition;cd.transition=null;try{C$2=1,fd$1(tt,_e,rt,it)}finally{C$2=nt,cd.transition=st}}function gd(tt,_e,rt,it){var nt=C$2,st=cd.transition;cd.transition=null;try{C$2=4,fd$1(tt,_e,rt,it)}finally{C$2=nt,cd.transition=st}}function fd$1(tt,_e,rt,it){if(dd){var nt=Yc(tt,_e,rt,it);if(nt===null)hd(tt,_e,it,id$1,rt),Sc(tt,it);else if(Uc(nt,tt,_e,rt,it))it.stopPropagation();else if(Sc(tt,it),_e&4&&-1<Rc.indexOf(tt)){for(;nt!==null;){var st=Cb(nt);if(st!==null&&Ec(st),st=Yc(tt,_e,rt,it),st===null&&hd(tt,_e,it,id$1,rt),st===nt)break;nt=st}nt!==null&&it.stopPropagation()}else hd(tt,_e,it,null,rt)}}var id$1=null;function Yc(tt,_e,rt,it){if(id$1=null,tt=xb(it),tt=Wc(tt),tt!==null)if(_e=Vb(tt),_e===null)tt=null;else if(rt=_e.tag,rt===13){if(tt=Wb(_e),tt!==null)return tt;tt=null}else if(rt===3){if(_e.stateNode.current.memoizedState.isDehydrated)return _e.tag===3?_e.stateNode.containerInfo:null;tt=null}else _e!==tt&&(tt=null);return id$1=tt,null}function jd(tt){switch(tt){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var tt,_e=ld,rt=_e.length,it,nt="value"in kd?kd.value:kd.textContent,st=nt.length;for(tt=0;tt<rt&&_e[tt]===nt[tt];tt++);var at=rt-tt;for(it=1;it<=at&&_e[rt-it]===nt[st-it];it++);return md=nt.slice(tt,1<it?1-it:void 0)}function od(tt){var _e=tt.keyCode;return"charCode"in tt?(tt=tt.charCode,tt===0&&_e===13&&(tt=13)):tt=_e,tt===10&&(tt=13),32<=tt||tt===13?tt:0}function pd(){return!0}function qd(){return!1}function rd(tt){function _e(rt,it,nt,st,at){this._reactName=rt,this._targetInst=nt,this.type=it,this.nativeEvent=st,this.target=at,this.currentTarget=null;for(var lt in tt)tt.hasOwnProperty(lt)&&(rt=tt[lt],this[lt]=rt?rt(st):st[lt]);return this.isDefaultPrevented=(st.defaultPrevented!=null?st.defaultPrevented:st.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$2(_e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var rt=this.nativeEvent;rt&&(rt.preventDefault?rt.preventDefault():typeof rt.returnValue!="unknown"&&(rt.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var rt=this.nativeEvent;rt&&(rt.stopPropagation?rt.stopPropagation():typeof rt.cancelBubble!="unknown"&&(rt.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),_e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(tt){return tt.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd(sd),ud=A$2({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$2({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(tt){return tt.relatedTarget===void 0?tt.fromElement===tt.srcElement?tt.toElement:tt.fromElement:tt.relatedTarget},movementX:function(tt){return"movementX"in tt?tt.movementX:(tt!==yd&&(yd&&tt.type==="mousemove"?(wd=tt.screenX-yd.screenX,xd=tt.screenY-yd.screenY):xd=wd=0,yd=tt),wd)},movementY:function(tt){return"movementY"in tt?tt.movementY:xd}}),Bd=rd(Ad),Cd=A$2({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$2({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$2({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$2({},sd,{clipboardData:function(tt){return"clipboardData"in tt?tt.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$2({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(tt){var _e=this.nativeEvent;return _e.getModifierState?_e.getModifierState(tt):(tt=Od[tt])?!!_e[tt]:!1}function zd(){return Pd}var Qd=A$2({},ud,{key:function(tt){if(tt.key){var _e=Md[tt.key]||tt.key;if(_e!=="Unidentified")return _e}return tt.type==="keypress"?(tt=od(tt),tt===13?"Enter":String.fromCharCode(tt)):tt.type==="keydown"||tt.type==="keyup"?Nd[tt.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(tt){return tt.type==="keypress"?od(tt):0},keyCode:function(tt){return tt.type==="keydown"||tt.type==="keyup"?tt.keyCode:0},which:function(tt){return tt.type==="keypress"?od(tt):tt.type==="keydown"||tt.type==="keyup"?tt.keyCode:0}}),Rd=rd(Qd),Sd=A$2({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$2({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$2({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$2({},Ad,{deltaX:function(tt){return"deltaX"in tt?tt.deltaX:"wheelDeltaX"in tt?-tt.wheelDeltaX:0},deltaY:function(tt){return"deltaY"in tt?tt.deltaY:"wheelDeltaY"in tt?-tt.wheelDeltaY:"wheelDelta"in tt?-tt.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee$1=String.fromCharCode(32),fe=!1;function ge(tt,_e){switch(tt){case"keyup":return $d.indexOf(_e.keyCode)!==-1;case"keydown":return _e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(tt){return tt=tt.detail,typeof tt=="object"&&"data"in tt?tt.data:null}var ie=!1;function je(tt,_e){switch(tt){case"compositionend":return he(_e);case"keypress":return _e.which!==32?null:(fe=!0,ee$1);case"textInput":return tt=_e.data,tt===ee$1&&fe?null:tt;default:return null}}function ke(tt,_e){if(ie)return tt==="compositionend"||!ae&&ge(tt,_e)?(tt=nd(),md=ld=kd=null,ie=!1,tt):null;switch(tt){case"paste":return null;case"keypress":if(!(_e.ctrlKey||_e.altKey||_e.metaKey)||_e.ctrlKey&&_e.altKey){if(_e.char&&1<_e.char.length)return _e.char;if(_e.which)return String.fromCharCode(_e.which)}return null;case"compositionend":return de&&_e.locale!=="ko"?null:_e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(tt){var _e=tt&&tt.nodeName&&tt.nodeName.toLowerCase();return _e==="input"?!!le[tt.type]:_e==="textarea"}function ne(tt,_e,rt,it){Eb(it),_e=oe(_e,"onChange"),0<_e.length&&(rt=new td$1("onChange","change",null,rt,it),tt.push({event:rt,listeners:_e}))}var pe=null,qe=null;function re$1(tt){se(tt,0)}function te(tt){var _e=ue(tt);if(Wa(_e))return tt}function ve(tt,_e){if(tt==="change")return _e}var we=!1;if(ia){var xe$1;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe$1=ye}else xe$1=!1;we=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(tt){if(tt.propertyName==="value"&&te(qe)){var _e=[];ne(_e,qe,tt,xb(tt)),Jb(re$1,_e)}}function Ce$1(tt,_e,rt){tt==="focusin"?(Ae(),pe=_e,qe=rt,pe.attachEvent("onpropertychange",Be)):tt==="focusout"&&Ae()}function De(tt){if(tt==="selectionchange"||tt==="keyup"||tt==="keydown")return te(qe)}function Ee(tt,_e){if(tt==="click")return te(_e)}function Fe(tt,_e){if(tt==="input"||tt==="change")return te(_e)}function Ge(tt,_e){return tt===_e&&(tt!==0||1/tt===1/_e)||tt!==tt&&_e!==_e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(tt,_e){if(He(tt,_e))return!0;if(typeof tt!="object"||tt===null||typeof _e!="object"||_e===null)return!1;var rt=Object.keys(tt),it=Object.keys(_e);if(rt.length!==it.length)return!1;for(it=0;it<rt.length;it++){var nt=rt[it];if(!ja.call(_e,nt)||!He(tt[nt],_e[nt]))return!1}return!0}function Je(tt){for(;tt&&tt.firstChild;)tt=tt.firstChild;return tt}function Ke(tt,_e){var rt=Je(tt);tt=0;for(var it;rt;){if(rt.nodeType===3){if(it=tt+rt.textContent.length,tt<=_e&&it>=_e)return{node:rt,offset:_e-tt};tt=it}e:{for(;rt;){if(rt.nextSibling){rt=rt.nextSibling;break e}rt=rt.parentNode}rt=void 0}rt=Je(rt)}}function Le(tt,_e){return tt&&_e?tt===_e?!0:tt&&tt.nodeType===3?!1:_e&&_e.nodeType===3?Le(tt,_e.parentNode):"contains"in tt?tt.contains(_e):tt.compareDocumentPosition?!!(tt.compareDocumentPosition(_e)&16):!1:!1}function Me$1(){for(var tt=window,_e=Xa();_e instanceof tt.HTMLIFrameElement;){try{var rt=typeof _e.contentWindow.location.href=="string"}catch{rt=!1}if(rt)tt=_e.contentWindow;else break;_e=Xa(tt.document)}return _e}function Ne$1(tt){var _e=tt&&tt.nodeName&&tt.nodeName.toLowerCase();return _e&&(_e==="input"&&(tt.type==="text"||tt.type==="search"||tt.type==="tel"||tt.type==="url"||tt.type==="password")||_e==="textarea"||tt.contentEditable==="true")}function Oe(tt){var _e=Me$1(),rt=tt.focusedElem,it=tt.selectionRange;if(_e!==rt&&rt&&rt.ownerDocument&&Le(rt.ownerDocument.documentElement,rt)){if(it!==null&&Ne$1(rt)){if(_e=it.start,tt=it.end,tt===void 0&&(tt=_e),"selectionStart"in rt)rt.selectionStart=_e,rt.selectionEnd=Math.min(tt,rt.value.length);else if(tt=(_e=rt.ownerDocument||document)&&_e.defaultView||window,tt.getSelection){tt=tt.getSelection();var nt=rt.textContent.length,st=Math.min(it.start,nt);it=it.end===void 0?st:Math.min(it.end,nt),!tt.extend&&st>it&&(nt=it,it=st,st=nt),nt=Ke(rt,st);var at=Ke(rt,it);nt&&at&&(tt.rangeCount!==1||tt.anchorNode!==nt.node||tt.anchorOffset!==nt.offset||tt.focusNode!==at.node||tt.focusOffset!==at.offset)&&(_e=_e.createRange(),_e.setStart(nt.node,nt.offset),tt.removeAllRanges(),st>it?(tt.addRange(_e),tt.extend(at.node,at.offset)):(_e.setEnd(at.node,at.offset),tt.addRange(_e)))}}for(_e=[],tt=rt;tt=tt.parentNode;)tt.nodeType===1&&_e.push({element:tt,left:tt.scrollLeft,top:tt.scrollTop});for(typeof rt.focus=="function"&&rt.focus(),rt=0;rt<_e.length;rt++)tt=_e[rt],tt.element.scrollLeft=tt.left,tt.element.scrollTop=tt.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(tt,_e,rt){var it=rt.window===rt?rt.document:rt.nodeType===9?rt:rt.ownerDocument;Te||Qe==null||Qe!==Xa(it)||(it=Qe,"selectionStart"in it&&Ne$1(it)?it={start:it.selectionStart,end:it.selectionEnd}:(it=(it.ownerDocument&&it.ownerDocument.defaultView||window).getSelection(),it={anchorNode:it.anchorNode,anchorOffset:it.anchorOffset,focusNode:it.focusNode,focusOffset:it.focusOffset}),Se&&Ie(Se,it)||(Se=it,it=oe(Re,"onSelect"),0<it.length&&(_e=new td$1("onSelect","select",null,_e,rt),tt.push({event:_e,listeners:it}),_e.target=Qe)))}function Ve(tt,_e){var rt={};return rt[tt.toLowerCase()]=_e.toLowerCase(),rt["Webkit"+tt]="webkit"+_e,rt["Moz"+tt]="moz"+_e,rt}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(tt){if(Xe[tt])return Xe[tt];if(!We[tt])return tt;var _e=We[tt],rt;for(rt in _e)if(_e.hasOwnProperty(rt)&&rt in Ye)return Xe[tt]=_e[rt];return tt}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(tt,_e){df.set(tt,_e),fa(_e,[tt])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(tt,_e,rt){var it=tt.type||"unknown-event";tt.currentTarget=rt,Ub(it,_e,void 0,tt),tt.currentTarget=null}function se(tt,_e){_e=(_e&4)!==0;for(var rt=0;rt<tt.length;rt++){var it=tt[rt],nt=it.event;it=it.listeners;e:{var st=void 0;if(_e)for(var at=it.length-1;0<=at;at--){var lt=it[at],ot=lt.instance,ct=lt.currentTarget;if(lt=lt.listener,ot!==st&&nt.isPropagationStopped())break e;nf(nt,lt,ct),st=ot}else for(at=0;at<it.length;at++){if(lt=it[at],ot=lt.instance,ct=lt.currentTarget,lt=lt.listener,ot!==st&&nt.isPropagationStopped())break e;nf(nt,lt,ct),st=ot}}}if(Qb)throw tt=Rb,Qb=!1,Rb=null,tt}function D$1(tt,_e){var rt=_e[of];rt===void 0&&(rt=_e[of]=new Set);var it=tt+"__bubble";rt.has(it)||(pf(_e,tt,2,!1),rt.add(it))}function qf(tt,_e,rt){var it=0;_e&&(it|=4),pf(rt,tt,it,_e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(tt){if(!tt[rf]){tt[rf]=!0,da.forEach(function(rt){rt!=="selectionchange"&&(mf.has(rt)||qf(rt,!1,tt),qf(rt,!0,tt))});var _e=tt.nodeType===9?tt:tt.ownerDocument;_e===null||_e[rf]||(_e[rf]=!0,qf("selectionchange",!1,_e))}}function pf(tt,_e,rt,it){switch(jd(_e)){case 1:var nt=ed;break;case 4:nt=gd;break;default:nt=fd$1}rt=nt.bind(null,_e,rt,tt),nt=void 0,!Lb||_e!=="touchstart"&&_e!=="touchmove"&&_e!=="wheel"||(nt=!0),it?nt!==void 0?tt.addEventListener(_e,rt,{capture:!0,passive:nt}):tt.addEventListener(_e,rt,!0):nt!==void 0?tt.addEventListener(_e,rt,{passive:nt}):tt.addEventListener(_e,rt,!1)}function hd(tt,_e,rt,it,nt){var st=it;if(!(_e&1)&&!(_e&2)&&it!==null)e:for(;;){if(it===null)return;var at=it.tag;if(at===3||at===4){var lt=it.stateNode.containerInfo;if(lt===nt||lt.nodeType===8&&lt.parentNode===nt)break;if(at===4)for(at=it.return;at!==null;){var ot=at.tag;if((ot===3||ot===4)&&(ot=at.stateNode.containerInfo,ot===nt||ot.nodeType===8&&ot.parentNode===nt))return;at=at.return}for(;lt!==null;){if(at=Wc(lt),at===null)return;if(ot=at.tag,ot===5||ot===6){it=st=at;continue e}lt=lt.parentNode}}it=it.return}Jb(function(){var ct=st,ut=xb(rt),ht=[];e:{var dt=df.get(tt);if(dt!==void 0){var pt=td$1,ft=tt;switch(tt){case"keypress":if(od(rt)===0)break e;case"keydown":case"keyup":pt=Rd;break;case"focusin":ft="focus",pt=Fd;break;case"focusout":ft="blur",pt=Fd;break;case"beforeblur":case"afterblur":pt=Fd;break;case"click":if(rt.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=Vd;break;case $e:case af:case bf:pt=Hd;break;case cf:pt=Xd;break;case"scroll":pt=vd;break;case"wheel":pt=Zd;break;case"copy":case"cut":case"paste":pt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=Td}var gt=(_e&4)!==0,mt=!gt&&tt==="scroll",At=gt?dt!==null?dt+"Capture":null:dt;gt=[];for(var yt=ct,bt;yt!==null;){bt=yt;var xt=bt.stateNode;if(bt.tag===5&&xt!==null&&(bt=xt,At!==null&&(xt=Kb(yt,At),xt!=null&&gt.push(tf(yt,xt,bt)))),mt)break;yt=yt.return}0<gt.length&&(dt=new pt(dt,ft,null,rt,ut),ht.push({event:dt,listeners:gt}))}}if(!(_e&7)){e:{if(dt=tt==="mouseover"||tt==="pointerover",pt=tt==="mouseout"||tt==="pointerout",dt&&rt!==wb&&(ft=rt.relatedTarget||rt.fromElement)&&(Wc(ft)||ft[uf]))break e;if((pt||dt)&&(dt=ut.window===ut?ut:(dt=ut.ownerDocument)?dt.defaultView||dt.parentWindow:window,pt?(ft=rt.relatedTarget||rt.toElement,pt=ct,ft=ft?Wc(ft):null,ft!==null&&(mt=Vb(ft),ft!==mt||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(pt=null,ft=ct),pt!==ft)){if(gt=Bd,xt="onMouseLeave",At="onMouseEnter",yt="mouse",(tt==="pointerout"||tt==="pointerover")&&(gt=Td,xt="onPointerLeave",At="onPointerEnter",yt="pointer"),mt=pt==null?dt:ue(pt),bt=ft==null?dt:ue(ft),dt=new gt(xt,yt+"leave",pt,rt,ut),dt.target=mt,dt.relatedTarget=bt,xt=null,Wc(ut)===ct&&(gt=new gt(At,yt+"enter",ft,rt,ut),gt.target=bt,gt.relatedTarget=mt,xt=gt),mt=xt,pt&&ft)t:{for(gt=pt,At=ft,yt=0,bt=gt;bt;bt=vf(bt))yt++;for(bt=0,xt=At;xt;xt=vf(xt))bt++;for(;0<yt-bt;)gt=vf(gt),yt--;for(;0<bt-yt;)At=vf(At),bt--;for(;yt--;){if(gt===At||At!==null&&gt===At.alternate)break t;gt=vf(gt),At=vf(At)}gt=null}else gt=null;pt!==null&&wf(ht,dt,pt,gt,!1),ft!==null&&mt!==null&&wf(ht,mt,ft,gt,!0)}}e:{if(dt=ct?ue(ct):window,pt=dt.nodeName&&dt.nodeName.toLowerCase(),pt==="select"||pt==="input"&&dt.type==="file")var vt=ve;else if(me(dt))if(we)vt=Fe;else{vt=De;var _t=Ce$1}else(pt=dt.nodeName)&&pt.toLowerCase()==="input"&&(dt.type==="checkbox"||dt.type==="radio")&&(vt=Ee);if(vt&&(vt=vt(tt,ct))){ne(ht,vt,rt,ut);break e}_t&&_t(tt,dt,ct),tt==="focusout"&&(_t=dt._wrapperState)&&_t.controlled&&dt.type==="number"&&cb(dt,"number",dt.value)}switch(_t=ct?ue(ct):window,tt){case"focusin":(me(_t)||_t.contentEditable==="true")&&(Qe=_t,Re=ct,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ht,rt,ut);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ht,rt,ut)}var Ct;if(ae)e:{switch(tt){case"compositionstart":var St="onCompositionStart";break e;case"compositionend":St="onCompositionEnd";break e;case"compositionupdate":St="onCompositionUpdate";break e}St=void 0}else ie?ge(tt,rt)&&(St="onCompositionEnd"):tt==="keydown"&&rt.keyCode===229&&(St="onCompositionStart");St&&(de&&rt.locale!=="ko"&&(ie||St!=="onCompositionStart"?St==="onCompositionEnd"&&ie&&(Ct=nd()):(kd=ut,ld="value"in kd?kd.value:kd.textContent,ie=!0)),_t=oe(ct,St),0<_t.length&&(St=new Ld(St,tt,null,rt,ut),ht.push({event:St,listeners:_t}),Ct?St.data=Ct:(Ct=he(rt),Ct!==null&&(St.data=Ct)))),(Ct=ce?je(tt,rt):ke(tt,rt))&&(ct=oe(ct,"onBeforeInput"),0<ct.length&&(ut=new Ld("onBeforeInput","beforeinput",null,rt,ut),ht.push({event:ut,listeners:ct}),ut.data=Ct))}se(ht,_e)})}function tf(tt,_e,rt){return{instance:tt,listener:_e,currentTarget:rt}}function oe(tt,_e){for(var rt=_e+"Capture",it=[];tt!==null;){var nt=tt,st=nt.stateNode;nt.tag===5&&st!==null&&(nt=st,st=Kb(tt,rt),st!=null&&it.unshift(tf(tt,st,nt)),st=Kb(tt,_e),st!=null&&it.push(tf(tt,st,nt))),tt=tt.return}return it}function vf(tt){if(tt===null)return null;do tt=tt.return;while(tt&&tt.tag!==5);return tt||null}function wf(tt,_e,rt,it,nt){for(var st=_e._reactName,at=[];rt!==null&&rt!==it;){var lt=rt,ot=lt.alternate,ct=lt.stateNode;if(ot!==null&&ot===it)break;lt.tag===5&&ct!==null&&(lt=ct,nt?(ot=Kb(rt,st),ot!=null&&at.unshift(tf(rt,ot,lt))):nt||(ot=Kb(rt,st),ot!=null&&at.push(tf(rt,ot,lt)))),rt=rt.return}at.length!==0&&tt.push({event:_e,listeners:at})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(tt){return(typeof tt=="string"?tt:""+tt).replace(xf,`
`).replace(yf,"")}function Af(tt,_e,rt){if(_e=zf(_e),zf(tt)!==_e&&rt)throw Error(p$4(425))}function Bf(){}var Cf=null,Df=null;function Ef(tt,_e){return tt==="textarea"||tt==="noscript"||typeof _e.children=="string"||typeof _e.children=="number"||typeof _e.dangerouslySetInnerHTML=="object"&&_e.dangerouslySetInnerHTML!==null&&_e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(tt){return Hf.resolve(null).then(tt).catch(If)}:Ff;function If(tt){setTimeout(function(){throw tt})}function Kf(tt,_e){var rt=_e,it=0;do{var nt=rt.nextSibling;if(tt.removeChild(rt),nt&&nt.nodeType===8)if(rt=nt.data,rt==="/$"){if(it===0){tt.removeChild(nt),bd(_e);return}it--}else rt!=="$"&&rt!=="$?"&&rt!=="$!"||it++;rt=nt}while(rt);bd(_e)}function Lf(tt){for(;tt!=null;tt=tt.nextSibling){var _e=tt.nodeType;if(_e===1||_e===3)break;if(_e===8){if(_e=tt.data,_e==="$"||_e==="$!"||_e==="$?")break;if(_e==="/$")return null}}return tt}function Mf(tt){tt=tt.previousSibling;for(var _e=0;tt;){if(tt.nodeType===8){var rt=tt.data;if(rt==="$"||rt==="$!"||rt==="$?"){if(_e===0)return tt;_e--}else rt==="/$"&&_e++}tt=tt.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(tt){var _e=tt[Of];if(_e)return _e;for(var rt=tt.parentNode;rt;){if(_e=rt[uf]||rt[Of]){if(rt=_e.alternate,_e.child!==null||rt!==null&&rt.child!==null)for(tt=Mf(tt);tt!==null;){if(rt=tt[Of])return rt;tt=Mf(tt)}return _e}tt=rt,rt=tt.parentNode}return null}function Cb(tt){return tt=tt[Of]||tt[uf],!tt||tt.tag!==5&&tt.tag!==6&&tt.tag!==13&&tt.tag!==3?null:tt}function ue(tt){if(tt.tag===5||tt.tag===6)return tt.stateNode;throw Error(p$4(33))}function Db(tt){return tt[Pf]||null}var Sf=[],Tf=-1;function Uf(tt){return{current:tt}}function E$2(tt){0>Tf||(tt.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(tt,_e){Tf++,Sf[Tf]=tt.current,tt.current=_e}var Vf={},H$2=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(tt,_e){var rt=tt.type.contextTypes;if(!rt)return Vf;var it=tt.stateNode;if(it&&it.__reactInternalMemoizedUnmaskedChildContext===_e)return it.__reactInternalMemoizedMaskedChildContext;var nt={},st;for(st in rt)nt[st]=_e[st];return it&&(tt=tt.stateNode,tt.__reactInternalMemoizedUnmaskedChildContext=_e,tt.__reactInternalMemoizedMaskedChildContext=nt),nt}function Zf(tt){return tt=tt.childContextTypes,tt!=null}function $f(){E$2(Wf),E$2(H$2)}function ag(tt,_e,rt){if(H$2.current!==Vf)throw Error(p$4(168));G$1(H$2,_e),G$1(Wf,rt)}function bg(tt,_e,rt){var it=tt.stateNode;if(_e=_e.childContextTypes,typeof it.getChildContext!="function")return rt;it=it.getChildContext();for(var nt in it)if(!(nt in _e))throw Error(p$4(108,Ra(tt)||"Unknown",nt));return A$2({},rt,it)}function cg(tt){return tt=(tt=tt.stateNode)&&tt.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$2.current,G$1(H$2,tt),G$1(Wf,Wf.current),!0}function dg(tt,_e,rt){var it=tt.stateNode;if(!it)throw Error(p$4(169));rt?(tt=bg(tt,_e,Xf),it.__reactInternalMemoizedMergedChildContext=tt,E$2(Wf),E$2(H$2),G$1(H$2,tt)):E$2(Wf),G$1(Wf,rt)}var eg=null,fg=!1,gg=!1;function hg(tt){eg===null?eg=[tt]:eg.push(tt)}function ig(tt){fg=!0,hg(tt)}function jg(){if(!gg&&eg!==null){gg=!0;var tt=0,_e=C$2;try{var rt=eg;for(C$2=1;tt<rt.length;tt++){var it=rt[tt];do it=it(!0);while(it!==null)}eg=null,fg=!1}catch(nt){throw eg!==null&&(eg=eg.slice(tt+1)),ac(fc,jg),nt}finally{C$2=_e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(tt,_e){kg[lg++]=ng,kg[lg++]=mg,mg=tt,ng=_e}function ug(tt,_e,rt){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=tt;var it=rg;tt=sg;var nt=32-oc(it)-1;it&=~(1<<nt),rt+=1;var st=32-oc(_e)+nt;if(30<st){var at=nt-nt%5;st=(it&(1<<at)-1).toString(32),it>>=at,nt-=at,rg=1<<32-oc(_e)+nt|rt<<nt|it,sg=st+tt}else rg=1<<st|rt<<nt|it,sg=tt}function vg(tt){tt.return!==null&&(tg(tt,1),ug(tt,1,0))}function wg(tt){for(;tt===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;tt===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$4=!1,zg=null;function Ag(tt,_e){var rt=Bg(5,null,null,0);rt.elementType="DELETED",rt.stateNode=_e,rt.return=tt,_e=tt.deletions,_e===null?(tt.deletions=[rt],tt.flags|=16):_e.push(rt)}function Cg(tt,_e){switch(tt.tag){case 5:var rt=tt.type;return _e=_e.nodeType!==1||rt.toLowerCase()!==_e.nodeName.toLowerCase()?null:_e,_e!==null?(tt.stateNode=_e,xg=tt,yg=Lf(_e.firstChild),!0):!1;case 6:return _e=tt.pendingProps===""||_e.nodeType!==3?null:_e,_e!==null?(tt.stateNode=_e,xg=tt,yg=null,!0):!1;case 13:return _e=_e.nodeType!==8?null:_e,_e!==null?(rt=qg!==null?{id:rg,overflow:sg}:null,tt.memoizedState={dehydrated:_e,treeContext:rt,retryLane:1073741824},rt=Bg(18,null,null,0),rt.stateNode=_e,rt.return=tt,tt.child=rt,xg=tt,yg=null,!0):!1;default:return!1}}function Dg(tt){return(tt.mode&1)!==0&&(tt.flags&128)===0}function Eg(tt){if(I$4){var _e=yg;if(_e){var rt=_e;if(!Cg(tt,_e)){if(Dg(tt))throw Error(p$4(418));_e=Lf(rt.nextSibling);var it=xg;_e&&Cg(tt,_e)?Ag(it,rt):(tt.flags=tt.flags&-4097|2,I$4=!1,xg=tt)}}else{if(Dg(tt))throw Error(p$4(418));tt.flags=tt.flags&-4097|2,I$4=!1,xg=tt}}}function Fg(tt){for(tt=tt.return;tt!==null&&tt.tag!==5&&tt.tag!==3&&tt.tag!==13;)tt=tt.return;xg=tt}function Gg(tt){if(tt!==xg)return!1;if(!I$4)return Fg(tt),I$4=!0,!1;var _e;if((_e=tt.tag!==3)&&!(_e=tt.tag!==5)&&(_e=tt.type,_e=_e!=="head"&&_e!=="body"&&!Ef(tt.type,tt.memoizedProps)),_e&&(_e=yg)){if(Dg(tt))throw Hg(),Error(p$4(418));for(;_e;)Ag(tt,_e),_e=Lf(_e.nextSibling)}if(Fg(tt),tt.tag===13){if(tt=tt.memoizedState,tt=tt!==null?tt.dehydrated:null,!tt)throw Error(p$4(317));e:{for(tt=tt.nextSibling,_e=0;tt;){if(tt.nodeType===8){var rt=tt.data;if(rt==="/$"){if(_e===0){yg=Lf(tt.nextSibling);break e}_e--}else rt!=="$"&&rt!=="$!"&&rt!=="$?"||_e++}tt=tt.nextSibling}yg=null}}else yg=xg?Lf(tt.stateNode.nextSibling):null;return!0}function Hg(){for(var tt=yg;tt;)tt=Lf(tt.nextSibling)}function Ig(){yg=xg=null,I$4=!1}function Jg(tt){zg===null?zg=[tt]:zg.push(tt)}var Kg=ua.ReactCurrentBatchConfig;function Lg(tt,_e){if(tt&&tt.defaultProps){_e=A$2({},_e),tt=tt.defaultProps;for(var rt in tt)_e[rt]===void 0&&(_e[rt]=tt[rt]);return _e}return _e}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(tt){var _e=Mg.current;E$2(Mg),tt._currentValue=_e}function Sg(tt,_e,rt){for(;tt!==null;){var it=tt.alternate;if((tt.childLanes&_e)!==_e?(tt.childLanes|=_e,it!==null&&(it.childLanes|=_e)):it!==null&&(it.childLanes&_e)!==_e&&(it.childLanes|=_e),tt===rt)break;tt=tt.return}}function Tg(tt,_e){Ng=tt,Pg=Og=null,tt=tt.dependencies,tt!==null&&tt.firstContext!==null&&(tt.lanes&_e&&(Ug=!0),tt.firstContext=null)}function Vg(tt){var _e=tt._currentValue;if(Pg!==tt)if(tt={context:tt,memoizedValue:_e,next:null},Og===null){if(Ng===null)throw Error(p$4(308));Og=tt,Ng.dependencies={lanes:0,firstContext:tt}}else Og=Og.next=tt;return _e}var Wg=null;function Xg(tt){Wg===null?Wg=[tt]:Wg.push(tt)}function Yg(tt,_e,rt,it){var nt=_e.interleaved;return nt===null?(rt.next=rt,Xg(_e)):(rt.next=nt.next,nt.next=rt),_e.interleaved=rt,Zg(tt,it)}function Zg(tt,_e){tt.lanes|=_e;var rt=tt.alternate;for(rt!==null&&(rt.lanes|=_e),rt=tt,tt=tt.return;tt!==null;)tt.childLanes|=_e,rt=tt.alternate,rt!==null&&(rt.childLanes|=_e),rt=tt,tt=tt.return;return rt.tag===3?rt.stateNode:null}var $g=!1;function ah(tt){tt.updateQueue={baseState:tt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(tt,_e){tt=tt.updateQueue,_e.updateQueue===tt&&(_e.updateQueue={baseState:tt.baseState,firstBaseUpdate:tt.firstBaseUpdate,lastBaseUpdate:tt.lastBaseUpdate,shared:tt.shared,effects:tt.effects})}function ch(tt,_e){return{eventTime:tt,lane:_e,tag:0,payload:null,callback:null,next:null}}function dh(tt,_e,rt){var it=tt.updateQueue;if(it===null)return null;if(it=it.shared,K&2){var nt=it.pending;return nt===null?_e.next=_e:(_e.next=nt.next,nt.next=_e),it.pending=_e,Zg(tt,rt)}return nt=it.interleaved,nt===null?(_e.next=_e,Xg(it)):(_e.next=nt.next,nt.next=_e),it.interleaved=_e,Zg(tt,rt)}function eh(tt,_e,rt){if(_e=_e.updateQueue,_e!==null&&(_e=_e.shared,(rt&4194240)!==0)){var it=_e.lanes;it&=tt.pendingLanes,rt|=it,_e.lanes=rt,Cc(tt,rt)}}function fh(tt,_e){var rt=tt.updateQueue,it=tt.alternate;if(it!==null&&(it=it.updateQueue,rt===it)){var nt=null,st=null;if(rt=rt.firstBaseUpdate,rt!==null){do{var at={eventTime:rt.eventTime,lane:rt.lane,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null};st===null?nt=st=at:st=st.next=at,rt=rt.next}while(rt!==null);st===null?nt=st=_e:st=st.next=_e}else nt=st=_e;rt={baseState:it.baseState,firstBaseUpdate:nt,lastBaseUpdate:st,shared:it.shared,effects:it.effects},tt.updateQueue=rt;return}tt=rt.lastBaseUpdate,tt===null?rt.firstBaseUpdate=_e:tt.next=_e,rt.lastBaseUpdate=_e}function gh(tt,_e,rt,it){var nt=tt.updateQueue;$g=!1;var st=nt.firstBaseUpdate,at=nt.lastBaseUpdate,lt=nt.shared.pending;if(lt!==null){nt.shared.pending=null;var ot=lt,ct=ot.next;ot.next=null,at===null?st=ct:at.next=ct,at=ot;var ut=tt.alternate;ut!==null&&(ut=ut.updateQueue,lt=ut.lastBaseUpdate,lt!==at&&(lt===null?ut.firstBaseUpdate=ct:lt.next=ct,ut.lastBaseUpdate=ot))}if(st!==null){var ht=nt.baseState;at=0,ut=ct=ot=null,lt=st;do{var dt=lt.lane,pt=lt.eventTime;if((it&dt)===dt){ut!==null&&(ut=ut.next={eventTime:pt,lane:0,tag:lt.tag,payload:lt.payload,callback:lt.callback,next:null});e:{var ft=tt,gt=lt;switch(dt=_e,pt=rt,gt.tag){case 1:if(ft=gt.payload,typeof ft=="function"){ht=ft.call(pt,ht,dt);break e}ht=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=gt.payload,dt=typeof ft=="function"?ft.call(pt,ht,dt):ft,dt==null)break e;ht=A$2({},ht,dt);break e;case 2:$g=!0}}lt.callback!==null&&lt.lane!==0&&(tt.flags|=64,dt=nt.effects,dt===null?nt.effects=[lt]:dt.push(lt))}else pt={eventTime:pt,lane:dt,tag:lt.tag,payload:lt.payload,callback:lt.callback,next:null},ut===null?(ct=ut=pt,ot=ht):ut=ut.next=pt,at|=dt;if(lt=lt.next,lt===null){if(lt=nt.shared.pending,lt===null)break;dt=lt,lt=dt.next,dt.next=null,nt.lastBaseUpdate=dt,nt.shared.pending=null}}while(1);if(ut===null&&(ot=ht),nt.baseState=ot,nt.firstBaseUpdate=ct,nt.lastBaseUpdate=ut,_e=nt.shared.interleaved,_e!==null){nt=_e;do at|=nt.lane,nt=nt.next;while(nt!==_e)}else st===null&&(nt.shared.lanes=0);hh|=at,tt.lanes=at,tt.memoizedState=ht}}function ih(tt,_e,rt){if(tt=_e.effects,_e.effects=null,tt!==null)for(_e=0;_e<tt.length;_e++){var it=tt[_e],nt=it.callback;if(nt!==null){if(it.callback=null,it=rt,typeof nt!="function")throw Error(p$4(191,nt));nt.call(it)}}}var jh=new aa.Component().refs;function kh(tt,_e,rt,it){_e=tt.memoizedState,rt=rt(it,_e),rt=rt==null?_e:A$2({},_e,rt),tt.memoizedState=rt,tt.lanes===0&&(tt.updateQueue.baseState=rt)}var nh={isMounted:function(tt){return(tt=tt._reactInternals)?Vb(tt)===tt:!1},enqueueSetState:function(tt,_e,rt){tt=tt._reactInternals;var it=L$2(),nt=lh(tt),st=ch(it,nt);st.payload=_e,rt!=null&&(st.callback=rt),_e=dh(tt,st,nt),_e!==null&&(mh(_e,tt,nt,it),eh(_e,tt,nt))},enqueueReplaceState:function(tt,_e,rt){tt=tt._reactInternals;var it=L$2(),nt=lh(tt),st=ch(it,nt);st.tag=1,st.payload=_e,rt!=null&&(st.callback=rt),_e=dh(tt,st,nt),_e!==null&&(mh(_e,tt,nt,it),eh(_e,tt,nt))},enqueueForceUpdate:function(tt,_e){tt=tt._reactInternals;var rt=L$2(),it=lh(tt),nt=ch(rt,it);nt.tag=2,_e!=null&&(nt.callback=_e),_e=dh(tt,nt,it),_e!==null&&(mh(_e,tt,it,rt),eh(_e,tt,it))}};function oh(tt,_e,rt,it,nt,st,at){return tt=tt.stateNode,typeof tt.shouldComponentUpdate=="function"?tt.shouldComponentUpdate(it,st,at):_e.prototype&&_e.prototype.isPureReactComponent?!Ie(rt,it)||!Ie(nt,st):!0}function ph(tt,_e,rt){var it=!1,nt=Vf,st=_e.contextType;return typeof st=="object"&&st!==null?st=Vg(st):(nt=Zf(_e)?Xf:H$2.current,it=_e.contextTypes,st=(it=it!=null)?Yf(tt,nt):Vf),_e=new _e(rt,st),tt.memoizedState=_e.state!==null&&_e.state!==void 0?_e.state:null,_e.updater=nh,tt.stateNode=_e,_e._reactInternals=tt,it&&(tt=tt.stateNode,tt.__reactInternalMemoizedUnmaskedChildContext=nt,tt.__reactInternalMemoizedMaskedChildContext=st),_e}function qh(tt,_e,rt,it){tt=_e.state,typeof _e.componentWillReceiveProps=="function"&&_e.componentWillReceiveProps(rt,it),typeof _e.UNSAFE_componentWillReceiveProps=="function"&&_e.UNSAFE_componentWillReceiveProps(rt,it),_e.state!==tt&&nh.enqueueReplaceState(_e,_e.state,null)}function rh(tt,_e,rt,it){var nt=tt.stateNode;nt.props=rt,nt.state=tt.memoizedState,nt.refs=jh,ah(tt);var st=_e.contextType;typeof st=="object"&&st!==null?nt.context=Vg(st):(st=Zf(_e)?Xf:H$2.current,nt.context=Yf(tt,st)),nt.state=tt.memoizedState,st=_e.getDerivedStateFromProps,typeof st=="function"&&(kh(tt,_e,st,rt),nt.state=tt.memoizedState),typeof _e.getDerivedStateFromProps=="function"||typeof nt.getSnapshotBeforeUpdate=="function"||typeof nt.UNSAFE_componentWillMount!="function"&&typeof nt.componentWillMount!="function"||(_e=nt.state,typeof nt.componentWillMount=="function"&&nt.componentWillMount(),typeof nt.UNSAFE_componentWillMount=="function"&&nt.UNSAFE_componentWillMount(),_e!==nt.state&&nh.enqueueReplaceState(nt,nt.state,null),gh(tt,rt,nt,it),nt.state=tt.memoizedState),typeof nt.componentDidMount=="function"&&(tt.flags|=4194308)}function sh(tt,_e,rt){if(tt=rt.ref,tt!==null&&typeof tt!="function"&&typeof tt!="object"){if(rt._owner){if(rt=rt._owner,rt){if(rt.tag!==1)throw Error(p$4(309));var it=rt.stateNode}if(!it)throw Error(p$4(147,tt));var nt=it,st=""+tt;return _e!==null&&_e.ref!==null&&typeof _e.ref=="function"&&_e.ref._stringRef===st?_e.ref:(_e=function(at){var lt=nt.refs;lt===jh&&(lt=nt.refs={}),at===null?delete lt[st]:lt[st]=at},_e._stringRef=st,_e)}if(typeof tt!="string")throw Error(p$4(284));if(!rt._owner)throw Error(p$4(290,tt))}return tt}function th(tt,_e){throw tt=Object.prototype.toString.call(_e),Error(p$4(31,tt==="[object Object]"?"object with keys {"+Object.keys(_e).join(", ")+"}":tt))}function uh(tt){var _e=tt._init;return _e(tt._payload)}function vh(tt){function _e(At,yt){if(tt){var bt=At.deletions;bt===null?(At.deletions=[yt],At.flags|=16):bt.push(yt)}}function rt(At,yt){if(!tt)return null;for(;yt!==null;)_e(At,yt),yt=yt.sibling;return null}function it(At,yt){for(At=new Map;yt!==null;)yt.key!==null?At.set(yt.key,yt):At.set(yt.index,yt),yt=yt.sibling;return At}function nt(At,yt){return At=wh(At,yt),At.index=0,At.sibling=null,At}function st(At,yt,bt){return At.index=bt,tt?(bt=At.alternate,bt!==null?(bt=bt.index,bt<yt?(At.flags|=2,yt):bt):(At.flags|=2,yt)):(At.flags|=1048576,yt)}function at(At){return tt&&At.alternate===null&&(At.flags|=2),At}function lt(At,yt,bt,xt){return yt===null||yt.tag!==6?(yt=xh(bt,At.mode,xt),yt.return=At,yt):(yt=nt(yt,bt),yt.return=At,yt)}function ot(At,yt,bt,xt){var vt=bt.type;return vt===ya?ut(At,yt,bt.props.children,xt,bt.key):yt!==null&&(yt.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===Ha&&uh(vt)===yt.type)?(xt=nt(yt,bt.props),xt.ref=sh(At,yt,bt),xt.return=At,xt):(xt=yh(bt.type,bt.key,bt.props,null,At.mode,xt),xt.ref=sh(At,yt,bt),xt.return=At,xt)}function ct(At,yt,bt,xt){return yt===null||yt.tag!==4||yt.stateNode.containerInfo!==bt.containerInfo||yt.stateNode.implementation!==bt.implementation?(yt=zh(bt,At.mode,xt),yt.return=At,yt):(yt=nt(yt,bt.children||[]),yt.return=At,yt)}function ut(At,yt,bt,xt,vt){return yt===null||yt.tag!==7?(yt=Ah(bt,At.mode,xt,vt),yt.return=At,yt):(yt=nt(yt,bt),yt.return=At,yt)}function ht(At,yt,bt){if(typeof yt=="string"&&yt!==""||typeof yt=="number")return yt=xh(""+yt,At.mode,bt),yt.return=At,yt;if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case va:return bt=yh(yt.type,yt.key,yt.props,null,At.mode,bt),bt.ref=sh(At,null,yt),bt.return=At,bt;case wa:return yt=zh(yt,At.mode,bt),yt.return=At,yt;case Ha:var xt=yt._init;return ht(At,xt(yt._payload),bt)}if(eb(yt)||Ka(yt))return yt=Ah(yt,At.mode,bt,null),yt.return=At,yt;th(At,yt)}return null}function dt(At,yt,bt,xt){var vt=yt!==null?yt.key:null;if(typeof bt=="string"&&bt!==""||typeof bt=="number")return vt!==null?null:lt(At,yt,""+bt,xt);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case va:return bt.key===vt?ot(At,yt,bt,xt):null;case wa:return bt.key===vt?ct(At,yt,bt,xt):null;case Ha:return vt=bt._init,dt(At,yt,vt(bt._payload),xt)}if(eb(bt)||Ka(bt))return vt!==null?null:ut(At,yt,bt,xt,null);th(At,bt)}return null}function pt(At,yt,bt,xt,vt){if(typeof xt=="string"&&xt!==""||typeof xt=="number")return At=At.get(bt)||null,lt(yt,At,""+xt,vt);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case va:return At=At.get(xt.key===null?bt:xt.key)||null,ot(yt,At,xt,vt);case wa:return At=At.get(xt.key===null?bt:xt.key)||null,ct(yt,At,xt,vt);case Ha:var _t=xt._init;return pt(At,yt,bt,_t(xt._payload),vt)}if(eb(xt)||Ka(xt))return At=At.get(bt)||null,ut(yt,At,xt,vt,null);th(yt,xt)}return null}function ft(At,yt,bt,xt){for(var vt=null,_t=null,Ct=yt,St=yt=0,Et=null;Ct!==null&&St<bt.length;St++){Ct.index>St?(Et=Ct,Ct=null):Et=Ct.sibling;var Tt=dt(At,Ct,bt[St],xt);if(Tt===null){Ct===null&&(Ct=Et);break}tt&&Ct&&Tt.alternate===null&&_e(At,Ct),yt=st(Tt,yt,St),_t===null?vt=Tt:_t.sibling=Tt,_t=Tt,Ct=Et}if(St===bt.length)return rt(At,Ct),I$4&&tg(At,St),vt;if(Ct===null){for(;St<bt.length;St++)Ct=ht(At,bt[St],xt),Ct!==null&&(yt=st(Ct,yt,St),_t===null?vt=Ct:_t.sibling=Ct,_t=Ct);return I$4&&tg(At,St),vt}for(Ct=it(At,Ct);St<bt.length;St++)Et=pt(Ct,At,St,bt[St],xt),Et!==null&&(tt&&Et.alternate!==null&&Ct.delete(Et.key===null?St:Et.key),yt=st(Et,yt,St),_t===null?vt=Et:_t.sibling=Et,_t=Et);return tt&&Ct.forEach(function(Mt){return _e(At,Mt)}),I$4&&tg(At,St),vt}function gt(At,yt,bt,xt){var vt=Ka(bt);if(typeof vt!="function")throw Error(p$4(150));if(bt=vt.call(bt),bt==null)throw Error(p$4(151));for(var _t=vt=null,Ct=yt,St=yt=0,Et=null,Tt=bt.next();Ct!==null&&!Tt.done;St++,Tt=bt.next()){Ct.index>St?(Et=Ct,Ct=null):Et=Ct.sibling;var Mt=dt(At,Ct,Tt.value,xt);if(Mt===null){Ct===null&&(Ct=Et);break}tt&&Ct&&Mt.alternate===null&&_e(At,Ct),yt=st(Mt,yt,St),_t===null?vt=Mt:_t.sibling=Mt,_t=Mt,Ct=Et}if(Tt.done)return rt(At,Ct),I$4&&tg(At,St),vt;if(Ct===null){for(;!Tt.done;St++,Tt=bt.next())Tt=ht(At,Tt.value,xt),Tt!==null&&(yt=st(Tt,yt,St),_t===null?vt=Tt:_t.sibling=Tt,_t=Tt);return I$4&&tg(At,St),vt}for(Ct=it(At,Ct);!Tt.done;St++,Tt=bt.next())Tt=pt(Ct,At,St,Tt.value,xt),Tt!==null&&(tt&&Tt.alternate!==null&&Ct.delete(Tt.key===null?St:Tt.key),yt=st(Tt,yt,St),_t===null?vt=Tt:_t.sibling=Tt,_t=Tt);return tt&&Ct.forEach(function(Rt){return _e(At,Rt)}),I$4&&tg(At,St),vt}function mt(At,yt,bt,xt){if(typeof bt=="object"&&bt!==null&&bt.type===ya&&bt.key===null&&(bt=bt.props.children),typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case va:e:{for(var vt=bt.key,_t=yt;_t!==null;){if(_t.key===vt){if(vt=bt.type,vt===ya){if(_t.tag===7){rt(At,_t.sibling),yt=nt(_t,bt.props.children),yt.return=At,At=yt;break e}}else if(_t.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===Ha&&uh(vt)===_t.type){rt(At,_t.sibling),yt=nt(_t,bt.props),yt.ref=sh(At,_t,bt),yt.return=At,At=yt;break e}rt(At,_t);break}else _e(At,_t);_t=_t.sibling}bt.type===ya?(yt=Ah(bt.props.children,At.mode,xt,bt.key),yt.return=At,At=yt):(xt=yh(bt.type,bt.key,bt.props,null,At.mode,xt),xt.ref=sh(At,yt,bt),xt.return=At,At=xt)}return at(At);case wa:e:{for(_t=bt.key;yt!==null;){if(yt.key===_t)if(yt.tag===4&&yt.stateNode.containerInfo===bt.containerInfo&&yt.stateNode.implementation===bt.implementation){rt(At,yt.sibling),yt=nt(yt,bt.children||[]),yt.return=At,At=yt;break e}else{rt(At,yt);break}else _e(At,yt);yt=yt.sibling}yt=zh(bt,At.mode,xt),yt.return=At,At=yt}return at(At);case Ha:return _t=bt._init,mt(At,yt,_t(bt._payload),xt)}if(eb(bt))return ft(At,yt,bt,xt);if(Ka(bt))return gt(At,yt,bt,xt);th(At,bt)}return typeof bt=="string"&&bt!==""||typeof bt=="number"?(bt=""+bt,yt!==null&&yt.tag===6?(rt(At,yt.sibling),yt=nt(yt,bt),yt.return=At,At=yt):(rt(At,yt),yt=xh(bt,At.mode,xt),yt.return=At,At=yt),at(At)):rt(At,yt)}return mt}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(tt){if(tt===Dh)throw Error(p$4(174));return tt}function Ih(tt,_e){switch(G$1(Gh,_e),G$1(Fh,tt),G$1(Eh,Dh),tt=_e.nodeType,tt){case 9:case 11:_e=(_e=_e.documentElement)?_e.namespaceURI:lb(null,"");break;default:tt=tt===8?_e.parentNode:_e,_e=tt.namespaceURI||null,tt=tt.tagName,_e=lb(_e,tt)}E$2(Eh),G$1(Eh,_e)}function Jh(){E$2(Eh),E$2(Fh),E$2(Gh)}function Kh(tt){Hh(Gh.current);var _e=Hh(Eh.current),rt=lb(_e,tt.type);_e!==rt&&(G$1(Fh,tt),G$1(Eh,rt))}function Lh(tt){Fh.current===tt&&(E$2(Eh),E$2(Fh))}var M$2=Uf(0);function Mh(tt){for(var _e=tt;_e!==null;){if(_e.tag===13){var rt=_e.memoizedState;if(rt!==null&&(rt=rt.dehydrated,rt===null||rt.data==="$?"||rt.data==="$!"))return _e}else if(_e.tag===19&&_e.memoizedProps.revealOrder!==void 0){if(_e.flags&128)return _e}else if(_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===tt)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===tt)return null;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}return null}var Nh=[];function Oh(){for(var tt=0;tt<Nh.length;tt++)Nh[tt]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N$2=null,O$1=null,P$1=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q$2(){throw Error(p$4(321))}function Wh(tt,_e){if(_e===null)return!1;for(var rt=0;rt<_e.length&&rt<tt.length;rt++)if(!He(tt[rt],_e[rt]))return!1;return!0}function Xh(tt,_e,rt,it,nt,st){if(Rh=st,N$2=_e,_e.memoizedState=null,_e.updateQueue=null,_e.lanes=0,Ph.current=tt===null||tt.memoizedState===null?Yh:Zh,tt=rt(it,nt),Th){st=0;do{if(Th=!1,Uh=0,25<=st)throw Error(p$4(301));st+=1,P$1=O$1=null,_e.updateQueue=null,Ph.current=$h,tt=rt(it,nt)}while(Th)}if(Ph.current=ai,_e=O$1!==null&&O$1.next!==null,Rh=0,P$1=O$1=N$2=null,Sh=!1,_e)throw Error(p$4(300));return tt}function bi(){var tt=Uh!==0;return Uh=0,tt}function ci(){var tt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P$1===null?N$2.memoizedState=P$1=tt:P$1=P$1.next=tt,P$1}function di(){if(O$1===null){var tt=N$2.alternate;tt=tt!==null?tt.memoizedState:null}else tt=O$1.next;var _e=P$1===null?N$2.memoizedState:P$1.next;if(_e!==null)P$1=_e,O$1=tt;else{if(tt===null)throw Error(p$4(310));O$1=tt,tt={memoizedState:O$1.memoizedState,baseState:O$1.baseState,baseQueue:O$1.baseQueue,queue:O$1.queue,next:null},P$1===null?N$2.memoizedState=P$1=tt:P$1=P$1.next=tt}return P$1}function ei(tt,_e){return typeof _e=="function"?_e(tt):_e}function fi(tt){var _e=di(),rt=_e.queue;if(rt===null)throw Error(p$4(311));rt.lastRenderedReducer=tt;var it=O$1,nt=it.baseQueue,st=rt.pending;if(st!==null){if(nt!==null){var at=nt.next;nt.next=st.next,st.next=at}it.baseQueue=nt=st,rt.pending=null}if(nt!==null){st=nt.next,it=it.baseState;var lt=at=null,ot=null,ct=st;do{var ut=ct.lane;if((Rh&ut)===ut)ot!==null&&(ot=ot.next={lane:0,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),it=ct.hasEagerState?ct.eagerState:tt(it,ct.action);else{var ht={lane:ut,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null};ot===null?(lt=ot=ht,at=it):ot=ot.next=ht,N$2.lanes|=ut,hh|=ut}ct=ct.next}while(ct!==null&&ct!==st);ot===null?at=it:ot.next=lt,He(it,_e.memoizedState)||(Ug=!0),_e.memoizedState=it,_e.baseState=at,_e.baseQueue=ot,rt.lastRenderedState=it}if(tt=rt.interleaved,tt!==null){nt=tt;do st=nt.lane,N$2.lanes|=st,hh|=st,nt=nt.next;while(nt!==tt)}else nt===null&&(rt.lanes=0);return[_e.memoizedState,rt.dispatch]}function gi(tt){var _e=di(),rt=_e.queue;if(rt===null)throw Error(p$4(311));rt.lastRenderedReducer=tt;var it=rt.dispatch,nt=rt.pending,st=_e.memoizedState;if(nt!==null){rt.pending=null;var at=nt=nt.next;do st=tt(st,at.action),at=at.next;while(at!==nt);He(st,_e.memoizedState)||(Ug=!0),_e.memoizedState=st,_e.baseQueue===null&&(_e.baseState=st),rt.lastRenderedState=st}return[st,it]}function hi(){}function ii(tt,_e){var rt=N$2,it=di(),nt=_e(),st=!He(it.memoizedState,nt);if(st&&(it.memoizedState=nt,Ug=!0),it=it.queue,ji(ki.bind(null,rt,it,tt),[tt]),it.getSnapshot!==_e||st||P$1!==null&&P$1.memoizedState.tag&1){if(rt.flags|=2048,li(9,mi.bind(null,rt,it,nt,_e),void 0,null),R$1===null)throw Error(p$4(349));Rh&30||ni(rt,_e,nt)}return nt}function ni(tt,_e,rt){tt.flags|=16384,tt={getSnapshot:_e,value:rt},_e=N$2.updateQueue,_e===null?(_e={lastEffect:null,stores:null},N$2.updateQueue=_e,_e.stores=[tt]):(rt=_e.stores,rt===null?_e.stores=[tt]:rt.push(tt))}function mi(tt,_e,rt,it){_e.value=rt,_e.getSnapshot=it,oi(_e)&&pi(tt)}function ki(tt,_e,rt){return rt(function(){oi(_e)&&pi(tt)})}function oi(tt){var _e=tt.getSnapshot;tt=tt.value;try{var rt=_e();return!He(tt,rt)}catch{return!0}}function pi(tt){var _e=Zg(tt,1);_e!==null&&mh(_e,tt,1,-1)}function qi(tt){var _e=ci();return typeof tt=="function"&&(tt=tt()),_e.memoizedState=_e.baseState=tt,tt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:tt},_e.queue=tt,tt=tt.dispatch=ri.bind(null,N$2,tt),[_e.memoizedState,tt]}function li(tt,_e,rt,it){return tt={tag:tt,create:_e,destroy:rt,deps:it,next:null},_e=N$2.updateQueue,_e===null?(_e={lastEffect:null,stores:null},N$2.updateQueue=_e,_e.lastEffect=tt.next=tt):(rt=_e.lastEffect,rt===null?_e.lastEffect=tt.next=tt:(it=rt.next,rt.next=tt,tt.next=it,_e.lastEffect=tt)),tt}function si(){return di().memoizedState}function ti(tt,_e,rt,it){var nt=ci();N$2.flags|=tt,nt.memoizedState=li(1|_e,rt,void 0,it===void 0?null:it)}function ui(tt,_e,rt,it){var nt=di();it=it===void 0?null:it;var st=void 0;if(O$1!==null){var at=O$1.memoizedState;if(st=at.destroy,it!==null&&Wh(it,at.deps)){nt.memoizedState=li(_e,rt,st,it);return}}N$2.flags|=tt,nt.memoizedState=li(1|_e,rt,st,it)}function vi(tt,_e){return ti(8390656,8,tt,_e)}function ji(tt,_e){return ui(2048,8,tt,_e)}function wi(tt,_e){return ui(4,2,tt,_e)}function xi(tt,_e){return ui(4,4,tt,_e)}function yi(tt,_e){if(typeof _e=="function")return tt=tt(),_e(tt),function(){_e(null)};if(_e!=null)return tt=tt(),_e.current=tt,function(){_e.current=null}}function zi(tt,_e,rt){return rt=rt!=null?rt.concat([tt]):null,ui(4,4,yi.bind(null,_e,tt),rt)}function Ai(){}function Bi(tt,_e){var rt=di();_e=_e===void 0?null:_e;var it=rt.memoizedState;return it!==null&&_e!==null&&Wh(_e,it[1])?it[0]:(rt.memoizedState=[tt,_e],tt)}function Ci(tt,_e){var rt=di();_e=_e===void 0?null:_e;var it=rt.memoizedState;return it!==null&&_e!==null&&Wh(_e,it[1])?it[0]:(tt=tt(),rt.memoizedState=[tt,_e],tt)}function Di(tt,_e,rt){return Rh&21?(He(rt,_e)||(rt=yc(),N$2.lanes|=rt,hh|=rt,tt.baseState=!0),_e):(tt.baseState&&(tt.baseState=!1,Ug=!0),tt.memoizedState=rt)}function Ei(tt,_e){var rt=C$2;C$2=rt!==0&&4>rt?rt:4,tt(!0);var it=Qh.transition;Qh.transition={};try{tt(!1),_e()}finally{C$2=rt,Qh.transition=it}}function Fi(){return di().memoizedState}function Gi(tt,_e,rt){var it=lh(tt);if(rt={lane:it,action:rt,hasEagerState:!1,eagerState:null,next:null},Hi(tt))Ii(_e,rt);else if(rt=Yg(tt,_e,rt,it),rt!==null){var nt=L$2();mh(rt,tt,it,nt),Ji(rt,_e,it)}}function ri(tt,_e,rt){var it=lh(tt),nt={lane:it,action:rt,hasEagerState:!1,eagerState:null,next:null};if(Hi(tt))Ii(_e,nt);else{var st=tt.alternate;if(tt.lanes===0&&(st===null||st.lanes===0)&&(st=_e.lastRenderedReducer,st!==null))try{var at=_e.lastRenderedState,lt=st(at,rt);if(nt.hasEagerState=!0,nt.eagerState=lt,He(lt,at)){var ot=_e.interleaved;ot===null?(nt.next=nt,Xg(_e)):(nt.next=ot.next,ot.next=nt),_e.interleaved=nt;return}}catch{}finally{}rt=Yg(tt,_e,nt,it),rt!==null&&(nt=L$2(),mh(rt,tt,it,nt),Ji(rt,_e,it))}}function Hi(tt){var _e=tt.alternate;return tt===N$2||_e!==null&&_e===N$2}function Ii(tt,_e){Th=Sh=!0;var rt=tt.pending;rt===null?_e.next=_e:(_e.next=rt.next,rt.next=_e),tt.pending=_e}function Ji(tt,_e,rt){if(rt&4194240){var it=_e.lanes;it&=tt.pendingLanes,rt|=it,_e.lanes=rt,Cc(tt,rt)}}var ai={readContext:Vg,useCallback:Q$2,useContext:Q$2,useEffect:Q$2,useImperativeHandle:Q$2,useInsertionEffect:Q$2,useLayoutEffect:Q$2,useMemo:Q$2,useReducer:Q$2,useRef:Q$2,useState:Q$2,useDebugValue:Q$2,useDeferredValue:Q$2,useTransition:Q$2,useMutableSource:Q$2,useSyncExternalStore:Q$2,useId:Q$2,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(tt,_e){return ci().memoizedState=[tt,_e===void 0?null:_e],tt},useContext:Vg,useEffect:vi,useImperativeHandle:function(tt,_e,rt){return rt=rt!=null?rt.concat([tt]):null,ti(4194308,4,yi.bind(null,_e,tt),rt)},useLayoutEffect:function(tt,_e){return ti(4194308,4,tt,_e)},useInsertionEffect:function(tt,_e){return ti(4,2,tt,_e)},useMemo:function(tt,_e){var rt=ci();return _e=_e===void 0?null:_e,tt=tt(),rt.memoizedState=[tt,_e],tt},useReducer:function(tt,_e,rt){var it=ci();return _e=rt!==void 0?rt(_e):_e,it.memoizedState=it.baseState=_e,tt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tt,lastRenderedState:_e},it.queue=tt,tt=tt.dispatch=Gi.bind(null,N$2,tt),[it.memoizedState,tt]},useRef:function(tt){var _e=ci();return tt={current:tt},_e.memoizedState=tt},useState:qi,useDebugValue:Ai,useDeferredValue:function(tt){return ci().memoizedState=tt},useTransition:function(){var tt=qi(!1),_e=tt[0];return tt=Ei.bind(null,tt[1]),ci().memoizedState=tt,[_e,tt]},useMutableSource:function(){},useSyncExternalStore:function(tt,_e,rt){var it=N$2,nt=ci();if(I$4){if(rt===void 0)throw Error(p$4(407));rt=rt()}else{if(rt=_e(),R$1===null)throw Error(p$4(349));Rh&30||ni(it,_e,rt)}nt.memoizedState=rt;var st={value:rt,getSnapshot:_e};return nt.queue=st,vi(ki.bind(null,it,st,tt),[tt]),it.flags|=2048,li(9,mi.bind(null,it,st,rt,_e),void 0,null),rt},useId:function(){var tt=ci(),_e=R$1.identifierPrefix;if(I$4){var rt=sg,it=rg;rt=(it&~(1<<32-oc(it)-1)).toString(32)+rt,_e=":"+_e+"R"+rt,rt=Uh++,0<rt&&(_e+="H"+rt.toString(32)),_e+=":"}else rt=Vh++,_e=":"+_e+"r"+rt.toString(32)+":";return tt.memoizedState=_e},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(tt){var _e=di();return Di(_e,O$1.memoizedState,tt)},useTransition:function(){var tt=fi(ei)[0],_e=di().memoizedState;return[tt,_e]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(tt){var _e=di();return O$1===null?_e.memoizedState=tt:Di(_e,O$1.memoizedState,tt)},useTransition:function(){var tt=gi(ei)[0],_e=di().memoizedState;return[tt,_e]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(tt,_e){try{var rt="",it=_e;do rt+=Pa(it),it=it.return;while(it);var nt=rt}catch(st){nt=`
Error generating stack: `+st.message+`
`+st.stack}return{value:tt,source:_e,stack:nt,digest:null}}function Li(tt,_e,rt){return{value:tt,source:null,stack:rt??null,digest:_e??null}}function Mi(tt,_e){try{console.error(_e.value)}catch(rt){setTimeout(function(){throw rt})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(tt,_e,rt){rt=ch(-1,rt),rt.tag=3,rt.payload={element:null};var it=_e.value;return rt.callback=function(){Pi||(Pi=!0,Qi=it),Mi(tt,_e)},rt}function Ri(tt,_e,rt){rt=ch(-1,rt),rt.tag=3;var it=tt.type.getDerivedStateFromError;if(typeof it=="function"){var nt=_e.value;rt.payload=function(){return it(nt)},rt.callback=function(){Mi(tt,_e)}}var st=tt.stateNode;return st!==null&&typeof st.componentDidCatch=="function"&&(rt.callback=function(){Mi(tt,_e),typeof it!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var at=_e.stack;this.componentDidCatch(_e.value,{componentStack:at!==null?at:""})}),rt}function Ti(tt,_e,rt){var it=tt.pingCache;if(it===null){it=tt.pingCache=new Ni;var nt=new Set;it.set(_e,nt)}else nt=it.get(_e),nt===void 0&&(nt=new Set,it.set(_e,nt));nt.has(rt)||(nt.add(rt),tt=Ui.bind(null,tt,_e,rt),_e.then(tt,tt))}function Vi(tt){do{var _e;if((_e=tt.tag===13)&&(_e=tt.memoizedState,_e=_e!==null?_e.dehydrated!==null:!0),_e)return tt;tt=tt.return}while(tt!==null);return null}function Wi(tt,_e,rt,it,nt){return tt.mode&1?(tt.flags|=65536,tt.lanes=nt,tt):(tt===_e?tt.flags|=65536:(tt.flags|=128,rt.flags|=131072,rt.flags&=-52805,rt.tag===1&&(rt.alternate===null?rt.tag=17:(_e=ch(-1,1),_e.tag=2,dh(rt,_e,1))),rt.lanes|=1),tt)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(tt,_e,rt,it){_e.child=tt===null?Ch(_e,null,rt,it):Bh(_e,tt.child,rt,it)}function Zi(tt,_e,rt,it,nt){rt=rt.render;var st=_e.ref;return Tg(_e,nt),it=Xh(tt,_e,rt,it,st,nt),rt=bi(),tt!==null&&!Ug?(_e.updateQueue=tt.updateQueue,_e.flags&=-2053,tt.lanes&=~nt,$i(tt,_e,nt)):(I$4&&rt&&vg(_e),_e.flags|=1,Yi(tt,_e,it,nt),_e.child)}function aj(tt,_e,rt,it,nt){if(tt===null){var st=rt.type;return typeof st=="function"&&!bj(st)&&st.defaultProps===void 0&&rt.compare===null&&rt.defaultProps===void 0?(_e.tag=15,_e.type=st,cj(tt,_e,st,it,nt)):(tt=yh(rt.type,null,it,_e,_e.mode,nt),tt.ref=_e.ref,tt.return=_e,_e.child=tt)}if(st=tt.child,!(tt.lanes&nt)){var at=st.memoizedProps;if(rt=rt.compare,rt=rt!==null?rt:Ie,rt(at,it)&&tt.ref===_e.ref)return $i(tt,_e,nt)}return _e.flags|=1,tt=wh(st,it),tt.ref=_e.ref,tt.return=_e,_e.child=tt}function cj(tt,_e,rt,it,nt){if(tt!==null){var st=tt.memoizedProps;if(Ie(st,it)&&tt.ref===_e.ref)if(Ug=!1,_e.pendingProps=it=st,(tt.lanes&nt)!==0)tt.flags&131072&&(Ug=!0);else return _e.lanes=tt.lanes,$i(tt,_e,nt)}return dj(tt,_e,rt,it,nt)}function ej(tt,_e,rt){var it=_e.pendingProps,nt=it.children,st=tt!==null?tt.memoizedState:null;if(it.mode==="hidden")if(!(_e.mode&1))_e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(fj,gj),gj|=rt;else{if(!(rt&1073741824))return tt=st!==null?st.baseLanes|rt:rt,_e.lanes=_e.childLanes=1073741824,_e.memoizedState={baseLanes:tt,cachePool:null,transitions:null},_e.updateQueue=null,G$1(fj,gj),gj|=tt,null;_e.memoizedState={baseLanes:0,cachePool:null,transitions:null},it=st!==null?st.baseLanes:rt,G$1(fj,gj),gj|=it}else st!==null?(it=st.baseLanes|rt,_e.memoizedState=null):it=rt,G$1(fj,gj),gj|=it;return Yi(tt,_e,nt,rt),_e.child}function hj(tt,_e){var rt=_e.ref;(tt===null&&rt!==null||tt!==null&&tt.ref!==rt)&&(_e.flags|=512,_e.flags|=2097152)}function dj(tt,_e,rt,it,nt){var st=Zf(rt)?Xf:H$2.current;return st=Yf(_e,st),Tg(_e,nt),rt=Xh(tt,_e,rt,it,st,nt),it=bi(),tt!==null&&!Ug?(_e.updateQueue=tt.updateQueue,_e.flags&=-2053,tt.lanes&=~nt,$i(tt,_e,nt)):(I$4&&it&&vg(_e),_e.flags|=1,Yi(tt,_e,rt,nt),_e.child)}function ij(tt,_e,rt,it,nt){if(Zf(rt)){var st=!0;cg(_e)}else st=!1;if(Tg(_e,nt),_e.stateNode===null)jj(tt,_e),ph(_e,rt,it),rh(_e,rt,it,nt),it=!0;else if(tt===null){var at=_e.stateNode,lt=_e.memoizedProps;at.props=lt;var ot=at.context,ct=rt.contextType;typeof ct=="object"&&ct!==null?ct=Vg(ct):(ct=Zf(rt)?Xf:H$2.current,ct=Yf(_e,ct));var ut=rt.getDerivedStateFromProps,ht=typeof ut=="function"||typeof at.getSnapshotBeforeUpdate=="function";ht||typeof at.UNSAFE_componentWillReceiveProps!="function"&&typeof at.componentWillReceiveProps!="function"||(lt!==it||ot!==ct)&&qh(_e,at,it,ct),$g=!1;var dt=_e.memoizedState;at.state=dt,gh(_e,it,at,nt),ot=_e.memoizedState,lt!==it||dt!==ot||Wf.current||$g?(typeof ut=="function"&&(kh(_e,rt,ut,it),ot=_e.memoizedState),(lt=$g||oh(_e,rt,lt,it,dt,ot,ct))?(ht||typeof at.UNSAFE_componentWillMount!="function"&&typeof at.componentWillMount!="function"||(typeof at.componentWillMount=="function"&&at.componentWillMount(),typeof at.UNSAFE_componentWillMount=="function"&&at.UNSAFE_componentWillMount()),typeof at.componentDidMount=="function"&&(_e.flags|=4194308)):(typeof at.componentDidMount=="function"&&(_e.flags|=4194308),_e.memoizedProps=it,_e.memoizedState=ot),at.props=it,at.state=ot,at.context=ct,it=lt):(typeof at.componentDidMount=="function"&&(_e.flags|=4194308),it=!1)}else{at=_e.stateNode,bh(tt,_e),lt=_e.memoizedProps,ct=_e.type===_e.elementType?lt:Lg(_e.type,lt),at.props=ct,ht=_e.pendingProps,dt=at.context,ot=rt.contextType,typeof ot=="object"&&ot!==null?ot=Vg(ot):(ot=Zf(rt)?Xf:H$2.current,ot=Yf(_e,ot));var pt=rt.getDerivedStateFromProps;(ut=typeof pt=="function"||typeof at.getSnapshotBeforeUpdate=="function")||typeof at.UNSAFE_componentWillReceiveProps!="function"&&typeof at.componentWillReceiveProps!="function"||(lt!==ht||dt!==ot)&&qh(_e,at,it,ot),$g=!1,dt=_e.memoizedState,at.state=dt,gh(_e,it,at,nt);var ft=_e.memoizedState;lt!==ht||dt!==ft||Wf.current||$g?(typeof pt=="function"&&(kh(_e,rt,pt,it),ft=_e.memoizedState),(ct=$g||oh(_e,rt,ct,it,dt,ft,ot)||!1)?(ut||typeof at.UNSAFE_componentWillUpdate!="function"&&typeof at.componentWillUpdate!="function"||(typeof at.componentWillUpdate=="function"&&at.componentWillUpdate(it,ft,ot),typeof at.UNSAFE_componentWillUpdate=="function"&&at.UNSAFE_componentWillUpdate(it,ft,ot)),typeof at.componentDidUpdate=="function"&&(_e.flags|=4),typeof at.getSnapshotBeforeUpdate=="function"&&(_e.flags|=1024)):(typeof at.componentDidUpdate!="function"||lt===tt.memoizedProps&&dt===tt.memoizedState||(_e.flags|=4),typeof at.getSnapshotBeforeUpdate!="function"||lt===tt.memoizedProps&&dt===tt.memoizedState||(_e.flags|=1024),_e.memoizedProps=it,_e.memoizedState=ft),at.props=it,at.state=ft,at.context=ot,it=ct):(typeof at.componentDidUpdate!="function"||lt===tt.memoizedProps&&dt===tt.memoizedState||(_e.flags|=4),typeof at.getSnapshotBeforeUpdate!="function"||lt===tt.memoizedProps&&dt===tt.memoizedState||(_e.flags|=1024),it=!1)}return kj(tt,_e,rt,it,st,nt)}function kj(tt,_e,rt,it,nt,st){hj(tt,_e);var at=(_e.flags&128)!==0;if(!it&&!at)return nt&&dg(_e,rt,!1),$i(tt,_e,st);it=_e.stateNode,Xi.current=_e;var lt=at&&typeof rt.getDerivedStateFromError!="function"?null:it.render();return _e.flags|=1,tt!==null&&at?(_e.child=Bh(_e,tt.child,null,st),_e.child=Bh(_e,null,lt,st)):Yi(tt,_e,lt,st),_e.memoizedState=it.state,nt&&dg(_e,rt,!0),_e.child}function lj(tt){var _e=tt.stateNode;_e.pendingContext?ag(tt,_e.pendingContext,_e.pendingContext!==_e.context):_e.context&&ag(tt,_e.context,!1),Ih(tt,_e.containerInfo)}function mj(tt,_e,rt,it,nt){return Ig(),Jg(nt),_e.flags|=256,Yi(tt,_e,rt,it),_e.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(tt){return{baseLanes:tt,cachePool:null,transitions:null}}function pj(tt,_e,rt){var it=_e.pendingProps,nt=M$2.current,st=!1,at=(_e.flags&128)!==0,lt;if((lt=at)||(lt=tt!==null&&tt.memoizedState===null?!1:(nt&2)!==0),lt?(st=!0,_e.flags&=-129):(tt===null||tt.memoizedState!==null)&&(nt|=1),G$1(M$2,nt&1),tt===null)return Eg(_e),tt=_e.memoizedState,tt!==null&&(tt=tt.dehydrated,tt!==null)?(_e.mode&1?tt.data==="$!"?_e.lanes=8:_e.lanes=1073741824:_e.lanes=1,null):(at=it.children,tt=it.fallback,st?(it=_e.mode,st=_e.child,at={mode:"hidden",children:at},!(it&1)&&st!==null?(st.childLanes=0,st.pendingProps=at):st=qj(at,it,0,null),tt=Ah(tt,it,rt,null),st.return=_e,tt.return=_e,st.sibling=tt,_e.child=st,_e.child.memoizedState=oj(rt),_e.memoizedState=nj,tt):rj(_e,at));if(nt=tt.memoizedState,nt!==null&&(lt=nt.dehydrated,lt!==null))return sj(tt,_e,at,it,lt,nt,rt);if(st){st=it.fallback,at=_e.mode,nt=tt.child,lt=nt.sibling;var ot={mode:"hidden",children:it.children};return!(at&1)&&_e.child!==nt?(it=_e.child,it.childLanes=0,it.pendingProps=ot,_e.deletions=null):(it=wh(nt,ot),it.subtreeFlags=nt.subtreeFlags&14680064),lt!==null?st=wh(lt,st):(st=Ah(st,at,rt,null),st.flags|=2),st.return=_e,it.return=_e,it.sibling=st,_e.child=it,it=st,st=_e.child,at=tt.child.memoizedState,at=at===null?oj(rt):{baseLanes:at.baseLanes|rt,cachePool:null,transitions:at.transitions},st.memoizedState=at,st.childLanes=tt.childLanes&~rt,_e.memoizedState=nj,it}return st=tt.child,tt=st.sibling,it=wh(st,{mode:"visible",children:it.children}),!(_e.mode&1)&&(it.lanes=rt),it.return=_e,it.sibling=null,tt!==null&&(rt=_e.deletions,rt===null?(_e.deletions=[tt],_e.flags|=16):rt.push(tt)),_e.child=it,_e.memoizedState=null,it}function rj(tt,_e){return _e=qj({mode:"visible",children:_e},tt.mode,0,null),_e.return=tt,tt.child=_e}function tj(tt,_e,rt,it){return it!==null&&Jg(it),Bh(_e,tt.child,null,rt),tt=rj(_e,_e.pendingProps.children),tt.flags|=2,_e.memoizedState=null,tt}function sj(tt,_e,rt,it,nt,st,at){if(rt)return _e.flags&256?(_e.flags&=-257,it=Li(Error(p$4(422))),tj(tt,_e,at,it)):_e.memoizedState!==null?(_e.child=tt.child,_e.flags|=128,null):(st=it.fallback,nt=_e.mode,it=qj({mode:"visible",children:it.children},nt,0,null),st=Ah(st,nt,at,null),st.flags|=2,it.return=_e,st.return=_e,it.sibling=st,_e.child=it,_e.mode&1&&Bh(_e,tt.child,null,at),_e.child.memoizedState=oj(at),_e.memoizedState=nj,st);if(!(_e.mode&1))return tj(tt,_e,at,null);if(nt.data==="$!"){if(it=nt.nextSibling&&nt.nextSibling.dataset,it)var lt=it.dgst;return it=lt,st=Error(p$4(419)),it=Li(st,it,void 0),tj(tt,_e,at,it)}if(lt=(at&tt.childLanes)!==0,Ug||lt){if(it=R$1,it!==null){switch(at&-at){case 4:nt=2;break;case 16:nt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:nt=32;break;case 536870912:nt=268435456;break;default:nt=0}nt=nt&(it.suspendedLanes|at)?0:nt,nt!==0&&nt!==st.retryLane&&(st.retryLane=nt,Zg(tt,nt),mh(it,tt,nt,-1))}return uj(),it=Li(Error(p$4(421))),tj(tt,_e,at,it)}return nt.data==="$?"?(_e.flags|=128,_e.child=tt.child,_e=vj.bind(null,tt),nt._reactRetry=_e,null):(tt=st.treeContext,yg=Lf(nt.nextSibling),xg=_e,I$4=!0,zg=null,tt!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=tt.id,sg=tt.overflow,qg=_e),_e=rj(_e,it.children),_e.flags|=4096,_e)}function wj(tt,_e,rt){tt.lanes|=_e;var it=tt.alternate;it!==null&&(it.lanes|=_e),Sg(tt.return,_e,rt)}function xj(tt,_e,rt,it,nt){var st=tt.memoizedState;st===null?tt.memoizedState={isBackwards:_e,rendering:null,renderingStartTime:0,last:it,tail:rt,tailMode:nt}:(st.isBackwards=_e,st.rendering=null,st.renderingStartTime=0,st.last=it,st.tail=rt,st.tailMode=nt)}function yj(tt,_e,rt){var it=_e.pendingProps,nt=it.revealOrder,st=it.tail;if(Yi(tt,_e,it.children,rt),it=M$2.current,it&2)it=it&1|2,_e.flags|=128;else{if(tt!==null&&tt.flags&128)e:for(tt=_e.child;tt!==null;){if(tt.tag===13)tt.memoizedState!==null&&wj(tt,rt,_e);else if(tt.tag===19)wj(tt,rt,_e);else if(tt.child!==null){tt.child.return=tt,tt=tt.child;continue}if(tt===_e)break e;for(;tt.sibling===null;){if(tt.return===null||tt.return===_e)break e;tt=tt.return}tt.sibling.return=tt.return,tt=tt.sibling}it&=1}if(G$1(M$2,it),!(_e.mode&1))_e.memoizedState=null;else switch(nt){case"forwards":for(rt=_e.child,nt=null;rt!==null;)tt=rt.alternate,tt!==null&&Mh(tt)===null&&(nt=rt),rt=rt.sibling;rt=nt,rt===null?(nt=_e.child,_e.child=null):(nt=rt.sibling,rt.sibling=null),xj(_e,!1,nt,rt,st);break;case"backwards":for(rt=null,nt=_e.child,_e.child=null;nt!==null;){if(tt=nt.alternate,tt!==null&&Mh(tt)===null){_e.child=nt;break}tt=nt.sibling,nt.sibling=rt,rt=nt,nt=tt}xj(_e,!0,rt,null,st);break;case"together":xj(_e,!1,null,null,void 0);break;default:_e.memoizedState=null}return _e.child}function jj(tt,_e){!(_e.mode&1)&&tt!==null&&(tt.alternate=null,_e.alternate=null,_e.flags|=2)}function $i(tt,_e,rt){if(tt!==null&&(_e.dependencies=tt.dependencies),hh|=_e.lanes,!(rt&_e.childLanes))return null;if(tt!==null&&_e.child!==tt.child)throw Error(p$4(153));if(_e.child!==null){for(tt=_e.child,rt=wh(tt,tt.pendingProps),_e.child=rt,rt.return=_e;tt.sibling!==null;)tt=tt.sibling,rt=rt.sibling=wh(tt,tt.pendingProps),rt.return=_e;rt.sibling=null}return _e.child}function zj(tt,_e,rt){switch(_e.tag){case 3:lj(_e),Ig();break;case 5:Kh(_e);break;case 1:Zf(_e.type)&&cg(_e);break;case 4:Ih(_e,_e.stateNode.containerInfo);break;case 10:var it=_e.type._context,nt=_e.memoizedProps.value;G$1(Mg,it._currentValue),it._currentValue=nt;break;case 13:if(it=_e.memoizedState,it!==null)return it.dehydrated!==null?(G$1(M$2,M$2.current&1),_e.flags|=128,null):rt&_e.child.childLanes?pj(tt,_e,rt):(G$1(M$2,M$2.current&1),tt=$i(tt,_e,rt),tt!==null?tt.sibling:null);G$1(M$2,M$2.current&1);break;case 19:if(it=(rt&_e.childLanes)!==0,tt.flags&128){if(it)return yj(tt,_e,rt);_e.flags|=128}if(nt=_e.memoizedState,nt!==null&&(nt.rendering=null,nt.tail=null,nt.lastEffect=null),G$1(M$2,M$2.current),it)break;return null;case 22:case 23:return _e.lanes=0,ej(tt,_e,rt)}return $i(tt,_e,rt)}var Aj,Bj,Cj,Dj;Aj=function(tt,_e){for(var rt=_e.child;rt!==null;){if(rt.tag===5||rt.tag===6)tt.appendChild(rt.stateNode);else if(rt.tag!==4&&rt.child!==null){rt.child.return=rt,rt=rt.child;continue}if(rt===_e)break;for(;rt.sibling===null;){if(rt.return===null||rt.return===_e)return;rt=rt.return}rt.sibling.return=rt.return,rt=rt.sibling}};Bj=function(){};Cj=function(tt,_e,rt,it){var nt=tt.memoizedProps;if(nt!==it){tt=_e.stateNode,Hh(Eh.current);var st=null;switch(rt){case"input":nt=Ya(tt,nt),it=Ya(tt,it),st=[];break;case"select":nt=A$2({},nt,{value:void 0}),it=A$2({},it,{value:void 0}),st=[];break;case"textarea":nt=gb(tt,nt),it=gb(tt,it),st=[];break;default:typeof nt.onClick!="function"&&typeof it.onClick=="function"&&(tt.onclick=Bf)}ub(rt,it);var at;rt=null;for(ct in nt)if(!it.hasOwnProperty(ct)&&nt.hasOwnProperty(ct)&&nt[ct]!=null)if(ct==="style"){var lt=nt[ct];for(at in lt)lt.hasOwnProperty(at)&&(rt||(rt={}),rt[at]="")}else ct!=="dangerouslySetInnerHTML"&&ct!=="children"&&ct!=="suppressContentEditableWarning"&&ct!=="suppressHydrationWarning"&&ct!=="autoFocus"&&(ea.hasOwnProperty(ct)?st||(st=[]):(st=st||[]).push(ct,null));for(ct in it){var ot=it[ct];if(lt=nt!=null?nt[ct]:void 0,it.hasOwnProperty(ct)&&ot!==lt&&(ot!=null||lt!=null))if(ct==="style")if(lt){for(at in lt)!lt.hasOwnProperty(at)||ot&&ot.hasOwnProperty(at)||(rt||(rt={}),rt[at]="");for(at in ot)ot.hasOwnProperty(at)&&lt[at]!==ot[at]&&(rt||(rt={}),rt[at]=ot[at])}else rt||(st||(st=[]),st.push(ct,rt)),rt=ot;else ct==="dangerouslySetInnerHTML"?(ot=ot?ot.__html:void 0,lt=lt?lt.__html:void 0,ot!=null&&lt!==ot&&(st=st||[]).push(ct,ot)):ct==="children"?typeof ot!="string"&&typeof ot!="number"||(st=st||[]).push(ct,""+ot):ct!=="suppressContentEditableWarning"&&ct!=="suppressHydrationWarning"&&(ea.hasOwnProperty(ct)?(ot!=null&&ct==="onScroll"&&D$1("scroll",tt),st||lt===ot||(st=[])):(st=st||[]).push(ct,ot))}rt&&(st=st||[]).push("style",rt);var ct=st;(_e.updateQueue=ct)&&(_e.flags|=4)}};Dj=function(tt,_e,rt,it){rt!==it&&(_e.flags|=4)};function Ej(tt,_e){if(!I$4)switch(tt.tailMode){case"hidden":_e=tt.tail;for(var rt=null;_e!==null;)_e.alternate!==null&&(rt=_e),_e=_e.sibling;rt===null?tt.tail=null:rt.sibling=null;break;case"collapsed":rt=tt.tail;for(var it=null;rt!==null;)rt.alternate!==null&&(it=rt),rt=rt.sibling;it===null?_e||tt.tail===null?tt.tail=null:tt.tail.sibling=null:it.sibling=null}}function S$3(tt){var _e=tt.alternate!==null&&tt.alternate.child===tt.child,rt=0,it=0;if(_e)for(var nt=tt.child;nt!==null;)rt|=nt.lanes|nt.childLanes,it|=nt.subtreeFlags&14680064,it|=nt.flags&14680064,nt.return=tt,nt=nt.sibling;else for(nt=tt.child;nt!==null;)rt|=nt.lanes|nt.childLanes,it|=nt.subtreeFlags,it|=nt.flags,nt.return=tt,nt=nt.sibling;return tt.subtreeFlags|=it,tt.childLanes=rt,_e}function Fj(tt,_e,rt){var it=_e.pendingProps;switch(wg(_e),_e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$3(_e),null;case 1:return Zf(_e.type)&&$f(),S$3(_e),null;case 3:return it=_e.stateNode,Jh(),E$2(Wf),E$2(H$2),Oh(),it.pendingContext&&(it.context=it.pendingContext,it.pendingContext=null),(tt===null||tt.child===null)&&(Gg(_e)?_e.flags|=4:tt===null||tt.memoizedState.isDehydrated&&!(_e.flags&256)||(_e.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(tt,_e),S$3(_e),null;case 5:Lh(_e);var nt=Hh(Gh.current);if(rt=_e.type,tt!==null&&_e.stateNode!=null)Cj(tt,_e,rt,it,nt),tt.ref!==_e.ref&&(_e.flags|=512,_e.flags|=2097152);else{if(!it){if(_e.stateNode===null)throw Error(p$4(166));return S$3(_e),null}if(tt=Hh(Eh.current),Gg(_e)){it=_e.stateNode,rt=_e.type;var st=_e.memoizedProps;switch(it[Of]=_e,it[Pf]=st,tt=(_e.mode&1)!==0,rt){case"dialog":D$1("cancel",it),D$1("close",it);break;case"iframe":case"object":case"embed":D$1("load",it);break;case"video":case"audio":for(nt=0;nt<lf.length;nt++)D$1(lf[nt],it);break;case"source":D$1("error",it);break;case"img":case"image":case"link":D$1("error",it),D$1("load",it);break;case"details":D$1("toggle",it);break;case"input":Za(it,st),D$1("invalid",it);break;case"select":it._wrapperState={wasMultiple:!!st.multiple},D$1("invalid",it);break;case"textarea":hb(it,st),D$1("invalid",it)}ub(rt,st),nt=null;for(var at in st)if(st.hasOwnProperty(at)){var lt=st[at];at==="children"?typeof lt=="string"?it.textContent!==lt&&(st.suppressHydrationWarning!==!0&&Af(it.textContent,lt,tt),nt=["children",lt]):typeof lt=="number"&&it.textContent!==""+lt&&(st.suppressHydrationWarning!==!0&&Af(it.textContent,lt,tt),nt=["children",""+lt]):ea.hasOwnProperty(at)&&lt!=null&&at==="onScroll"&&D$1("scroll",it)}switch(rt){case"input":Va(it),db(it,st,!0);break;case"textarea":Va(it),jb(it);break;case"select":case"option":break;default:typeof st.onClick=="function"&&(it.onclick=Bf)}it=nt,_e.updateQueue=it,it!==null&&(_e.flags|=4)}else{at=nt.nodeType===9?nt:nt.ownerDocument,tt==="http://www.w3.org/1999/xhtml"&&(tt=kb(rt)),tt==="http://www.w3.org/1999/xhtml"?rt==="script"?(tt=at.createElement("div"),tt.innerHTML="<script><\/script>",tt=tt.removeChild(tt.firstChild)):typeof it.is=="string"?tt=at.createElement(rt,{is:it.is}):(tt=at.createElement(rt),rt==="select"&&(at=tt,it.multiple?at.multiple=!0:it.size&&(at.size=it.size))):tt=at.createElementNS(tt,rt),tt[Of]=_e,tt[Pf]=it,Aj(tt,_e,!1,!1),_e.stateNode=tt;e:{switch(at=vb(rt,it),rt){case"dialog":D$1("cancel",tt),D$1("close",tt),nt=it;break;case"iframe":case"object":case"embed":D$1("load",tt),nt=it;break;case"video":case"audio":for(nt=0;nt<lf.length;nt++)D$1(lf[nt],tt);nt=it;break;case"source":D$1("error",tt),nt=it;break;case"img":case"image":case"link":D$1("error",tt),D$1("load",tt),nt=it;break;case"details":D$1("toggle",tt),nt=it;break;case"input":Za(tt,it),nt=Ya(tt,it),D$1("invalid",tt);break;case"option":nt=it;break;case"select":tt._wrapperState={wasMultiple:!!it.multiple},nt=A$2({},it,{value:void 0}),D$1("invalid",tt);break;case"textarea":hb(tt,it),nt=gb(tt,it),D$1("invalid",tt);break;default:nt=it}ub(rt,nt),lt=nt;for(st in lt)if(lt.hasOwnProperty(st)){var ot=lt[st];st==="style"?sb(tt,ot):st==="dangerouslySetInnerHTML"?(ot=ot?ot.__html:void 0,ot!=null&&nb(tt,ot)):st==="children"?typeof ot=="string"?(rt!=="textarea"||ot!=="")&&ob(tt,ot):typeof ot=="number"&&ob(tt,""+ot):st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&st!=="autoFocus"&&(ea.hasOwnProperty(st)?ot!=null&&st==="onScroll"&&D$1("scroll",tt):ot!=null&&ta(tt,st,ot,at))}switch(rt){case"input":Va(tt),db(tt,it,!1);break;case"textarea":Va(tt),jb(tt);break;case"option":it.value!=null&&tt.setAttribute("value",""+Sa(it.value));break;case"select":tt.multiple=!!it.multiple,st=it.value,st!=null?fb(tt,!!it.multiple,st,!1):it.defaultValue!=null&&fb(tt,!!it.multiple,it.defaultValue,!0);break;default:typeof nt.onClick=="function"&&(tt.onclick=Bf)}switch(rt){case"button":case"input":case"select":case"textarea":it=!!it.autoFocus;break e;case"img":it=!0;break e;default:it=!1}}it&&(_e.flags|=4)}_e.ref!==null&&(_e.flags|=512,_e.flags|=2097152)}return S$3(_e),null;case 6:if(tt&&_e.stateNode!=null)Dj(tt,_e,tt.memoizedProps,it);else{if(typeof it!="string"&&_e.stateNode===null)throw Error(p$4(166));if(rt=Hh(Gh.current),Hh(Eh.current),Gg(_e)){if(it=_e.stateNode,rt=_e.memoizedProps,it[Of]=_e,(st=it.nodeValue!==rt)&&(tt=xg,tt!==null))switch(tt.tag){case 3:Af(it.nodeValue,rt,(tt.mode&1)!==0);break;case 5:tt.memoizedProps.suppressHydrationWarning!==!0&&Af(it.nodeValue,rt,(tt.mode&1)!==0)}st&&(_e.flags|=4)}else it=(rt.nodeType===9?rt:rt.ownerDocument).createTextNode(it),it[Of]=_e,_e.stateNode=it}return S$3(_e),null;case 13:if(E$2(M$2),it=_e.memoizedState,tt===null||tt.memoizedState!==null&&tt.memoizedState.dehydrated!==null){if(I$4&&yg!==null&&_e.mode&1&&!(_e.flags&128))Hg(),Ig(),_e.flags|=98560,st=!1;else if(st=Gg(_e),it!==null&&it.dehydrated!==null){if(tt===null){if(!st)throw Error(p$4(318));if(st=_e.memoizedState,st=st!==null?st.dehydrated:null,!st)throw Error(p$4(317));st[Of]=_e}else Ig(),!(_e.flags&128)&&(_e.memoizedState=null),_e.flags|=4;S$3(_e),st=!1}else zg!==null&&(Gj(zg),zg=null),st=!0;if(!st)return _e.flags&65536?_e:null}return _e.flags&128?(_e.lanes=rt,_e):(it=it!==null,it!==(tt!==null&&tt.memoizedState!==null)&&it&&(_e.child.flags|=8192,_e.mode&1&&(tt===null||M$2.current&1?T$2===0&&(T$2=3):uj())),_e.updateQueue!==null&&(_e.flags|=4),S$3(_e),null);case 4:return Jh(),Bj(tt,_e),tt===null&&sf(_e.stateNode.containerInfo),S$3(_e),null;case 10:return Rg(_e.type._context),S$3(_e),null;case 17:return Zf(_e.type)&&$f(),S$3(_e),null;case 19:if(E$2(M$2),st=_e.memoizedState,st===null)return S$3(_e),null;if(it=(_e.flags&128)!==0,at=st.rendering,at===null)if(it)Ej(st,!1);else{if(T$2!==0||tt!==null&&tt.flags&128)for(tt=_e.child;tt!==null;){if(at=Mh(tt),at!==null){for(_e.flags|=128,Ej(st,!1),it=at.updateQueue,it!==null&&(_e.updateQueue=it,_e.flags|=4),_e.subtreeFlags=0,it=rt,rt=_e.child;rt!==null;)st=rt,tt=it,st.flags&=14680066,at=st.alternate,at===null?(st.childLanes=0,st.lanes=tt,st.child=null,st.subtreeFlags=0,st.memoizedProps=null,st.memoizedState=null,st.updateQueue=null,st.dependencies=null,st.stateNode=null):(st.childLanes=at.childLanes,st.lanes=at.lanes,st.child=at.child,st.subtreeFlags=0,st.deletions=null,st.memoizedProps=at.memoizedProps,st.memoizedState=at.memoizedState,st.updateQueue=at.updateQueue,st.type=at.type,tt=at.dependencies,st.dependencies=tt===null?null:{lanes:tt.lanes,firstContext:tt.firstContext}),rt=rt.sibling;return G$1(M$2,M$2.current&1|2),_e.child}tt=tt.sibling}st.tail!==null&&B$2()>Hj&&(_e.flags|=128,it=!0,Ej(st,!1),_e.lanes=4194304)}else{if(!it)if(tt=Mh(at),tt!==null){if(_e.flags|=128,it=!0,rt=tt.updateQueue,rt!==null&&(_e.updateQueue=rt,_e.flags|=4),Ej(st,!0),st.tail===null&&st.tailMode==="hidden"&&!at.alternate&&!I$4)return S$3(_e),null}else 2*B$2()-st.renderingStartTime>Hj&&rt!==1073741824&&(_e.flags|=128,it=!0,Ej(st,!1),_e.lanes=4194304);st.isBackwards?(at.sibling=_e.child,_e.child=at):(rt=st.last,rt!==null?rt.sibling=at:_e.child=at,st.last=at)}return st.tail!==null?(_e=st.tail,st.rendering=_e,st.tail=_e.sibling,st.renderingStartTime=B$2(),_e.sibling=null,rt=M$2.current,G$1(M$2,it?rt&1|2:rt&1),_e):(S$3(_e),null);case 22:case 23:return Ij(),it=_e.memoizedState!==null,tt!==null&&tt.memoizedState!==null!==it&&(_e.flags|=8192),it&&_e.mode&1?gj&1073741824&&(S$3(_e),_e.subtreeFlags&6&&(_e.flags|=8192)):S$3(_e),null;case 24:return null;case 25:return null}throw Error(p$4(156,_e.tag))}function Jj(tt,_e){switch(wg(_e),_e.tag){case 1:return Zf(_e.type)&&$f(),tt=_e.flags,tt&65536?(_e.flags=tt&-65537|128,_e):null;case 3:return Jh(),E$2(Wf),E$2(H$2),Oh(),tt=_e.flags,tt&65536&&!(tt&128)?(_e.flags=tt&-65537|128,_e):null;case 5:return Lh(_e),null;case 13:if(E$2(M$2),tt=_e.memoizedState,tt!==null&&tt.dehydrated!==null){if(_e.alternate===null)throw Error(p$4(340));Ig()}return tt=_e.flags,tt&65536?(_e.flags=tt&-65537|128,_e):null;case 19:return E$2(M$2),null;case 4:return Jh(),null;case 10:return Rg(_e.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U$2=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$3=null;function Mj(tt,_e){var rt=tt.ref;if(rt!==null)if(typeof rt=="function")try{rt(null)}catch(it){W$1(tt,_e,it)}else rt.current=null}function Nj(tt,_e,rt){try{rt()}catch(it){W$1(tt,_e,it)}}var Oj=!1;function Pj(tt,_e){if(Cf=dd,tt=Me$1(),Ne$1(tt)){if("selectionStart"in tt)var rt={start:tt.selectionStart,end:tt.selectionEnd};else e:{rt=(rt=tt.ownerDocument)&&rt.defaultView||window;var it=rt.getSelection&&rt.getSelection();if(it&&it.rangeCount!==0){rt=it.anchorNode;var nt=it.anchorOffset,st=it.focusNode;it=it.focusOffset;try{rt.nodeType,st.nodeType}catch{rt=null;break e}var at=0,lt=-1,ot=-1,ct=0,ut=0,ht=tt,dt=null;t:for(;;){for(var pt;ht!==rt||nt!==0&&ht.nodeType!==3||(lt=at+nt),ht!==st||it!==0&&ht.nodeType!==3||(ot=at+it),ht.nodeType===3&&(at+=ht.nodeValue.length),(pt=ht.firstChild)!==null;)dt=ht,ht=pt;for(;;){if(ht===tt)break t;if(dt===rt&&++ct===nt&&(lt=at),dt===st&&++ut===it&&(ot=at),(pt=ht.nextSibling)!==null)break;ht=dt,dt=ht.parentNode}ht=pt}rt=lt===-1||ot===-1?null:{start:lt,end:ot}}else rt=null}rt=rt||{start:0,end:0}}else rt=null;for(Df={focusedElem:tt,selectionRange:rt},dd=!1,V$3=_e;V$3!==null;)if(_e=V$3,tt=_e.child,(_e.subtreeFlags&1028)!==0&&tt!==null)tt.return=_e,V$3=tt;else for(;V$3!==null;){_e=V$3;try{var ft=_e.alternate;if(_e.flags&1024)switch(_e.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var gt=ft.memoizedProps,mt=ft.memoizedState,At=_e.stateNode,yt=At.getSnapshotBeforeUpdate(_e.elementType===_e.type?gt:Lg(_e.type,gt),mt);At.__reactInternalSnapshotBeforeUpdate=yt}break;case 3:var bt=_e.stateNode.containerInfo;bt.nodeType===1?bt.textContent="":bt.nodeType===9&&bt.documentElement&&bt.removeChild(bt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$4(163))}}catch(xt){W$1(_e,_e.return,xt)}if(tt=_e.sibling,tt!==null){tt.return=_e.return,V$3=tt;break}V$3=_e.return}return ft=Oj,Oj=!1,ft}function Qj(tt,_e,rt){var it=_e.updateQueue;if(it=it!==null?it.lastEffect:null,it!==null){var nt=it=it.next;do{if((nt.tag&tt)===tt){var st=nt.destroy;nt.destroy=void 0,st!==void 0&&Nj(_e,rt,st)}nt=nt.next}while(nt!==it)}}function Rj(tt,_e){if(_e=_e.updateQueue,_e=_e!==null?_e.lastEffect:null,_e!==null){var rt=_e=_e.next;do{if((rt.tag&tt)===tt){var it=rt.create;rt.destroy=it()}rt=rt.next}while(rt!==_e)}}function Sj(tt){var _e=tt.ref;if(_e!==null){var rt=tt.stateNode;switch(tt.tag){case 5:tt=rt;break;default:tt=rt}typeof _e=="function"?_e(tt):_e.current=tt}}function Tj(tt){var _e=tt.alternate;_e!==null&&(tt.alternate=null,Tj(_e)),tt.child=null,tt.deletions=null,tt.sibling=null,tt.tag===5&&(_e=tt.stateNode,_e!==null&&(delete _e[Of],delete _e[Pf],delete _e[of],delete _e[Qf],delete _e[Rf])),tt.stateNode=null,tt.return=null,tt.dependencies=null,tt.memoizedProps=null,tt.memoizedState=null,tt.pendingProps=null,tt.stateNode=null,tt.updateQueue=null}function Uj(tt){return tt.tag===5||tt.tag===3||tt.tag===4}function Vj(tt){e:for(;;){for(;tt.sibling===null;){if(tt.return===null||Uj(tt.return))return null;tt=tt.return}for(tt.sibling.return=tt.return,tt=tt.sibling;tt.tag!==5&&tt.tag!==6&&tt.tag!==18;){if(tt.flags&2||tt.child===null||tt.tag===4)continue e;tt.child.return=tt,tt=tt.child}if(!(tt.flags&2))return tt.stateNode}}function Wj(tt,_e,rt){var it=tt.tag;if(it===5||it===6)tt=tt.stateNode,_e?rt.nodeType===8?rt.parentNode.insertBefore(tt,_e):rt.insertBefore(tt,_e):(rt.nodeType===8?(_e=rt.parentNode,_e.insertBefore(tt,rt)):(_e=rt,_e.appendChild(tt)),rt=rt._reactRootContainer,rt!=null||_e.onclick!==null||(_e.onclick=Bf));else if(it!==4&&(tt=tt.child,tt!==null))for(Wj(tt,_e,rt),tt=tt.sibling;tt!==null;)Wj(tt,_e,rt),tt=tt.sibling}function Xj(tt,_e,rt){var it=tt.tag;if(it===5||it===6)tt=tt.stateNode,_e?rt.insertBefore(tt,_e):rt.appendChild(tt);else if(it!==4&&(tt=tt.child,tt!==null))for(Xj(tt,_e,rt),tt=tt.sibling;tt!==null;)Xj(tt,_e,rt),tt=tt.sibling}var X=null,Yj=!1;function Zj(tt,_e,rt){for(rt=rt.child;rt!==null;)ak(tt,_e,rt),rt=rt.sibling}function ak(tt,_e,rt){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,rt)}catch{}switch(rt.tag){case 5:U$2||Mj(rt,_e);case 6:var it=X,nt=Yj;X=null,Zj(tt,_e,rt),X=it,Yj=nt,X!==null&&(Yj?(tt=X,rt=rt.stateNode,tt.nodeType===8?tt.parentNode.removeChild(rt):tt.removeChild(rt)):X.removeChild(rt.stateNode));break;case 18:X!==null&&(Yj?(tt=X,rt=rt.stateNode,tt.nodeType===8?Kf(tt.parentNode,rt):tt.nodeType===1&&Kf(tt,rt),bd(tt)):Kf(X,rt.stateNode));break;case 4:it=X,nt=Yj,X=rt.stateNode.containerInfo,Yj=!0,Zj(tt,_e,rt),X=it,Yj=nt;break;case 0:case 11:case 14:case 15:if(!U$2&&(it=rt.updateQueue,it!==null&&(it=it.lastEffect,it!==null))){nt=it=it.next;do{var st=nt,at=st.destroy;st=st.tag,at!==void 0&&(st&2||st&4)&&Nj(rt,_e,at),nt=nt.next}while(nt!==it)}Zj(tt,_e,rt);break;case 1:if(!U$2&&(Mj(rt,_e),it=rt.stateNode,typeof it.componentWillUnmount=="function"))try{it.props=rt.memoizedProps,it.state=rt.memoizedState,it.componentWillUnmount()}catch(lt){W$1(rt,_e,lt)}Zj(tt,_e,rt);break;case 21:Zj(tt,_e,rt);break;case 22:rt.mode&1?(U$2=(it=U$2)||rt.memoizedState!==null,Zj(tt,_e,rt),U$2=it):Zj(tt,_e,rt);break;default:Zj(tt,_e,rt)}}function bk(tt){var _e=tt.updateQueue;if(_e!==null){tt.updateQueue=null;var rt=tt.stateNode;rt===null&&(rt=tt.stateNode=new Lj),_e.forEach(function(it){var nt=ck.bind(null,tt,it);rt.has(it)||(rt.add(it),it.then(nt,nt))})}}function dk(tt,_e){var rt=_e.deletions;if(rt!==null)for(var it=0;it<rt.length;it++){var nt=rt[it];try{var st=tt,at=_e,lt=at;e:for(;lt!==null;){switch(lt.tag){case 5:X=lt.stateNode,Yj=!1;break e;case 3:X=lt.stateNode.containerInfo,Yj=!0;break e;case 4:X=lt.stateNode.containerInfo,Yj=!0;break e}lt=lt.return}if(X===null)throw Error(p$4(160));ak(st,at,nt),X=null,Yj=!1;var ot=nt.alternate;ot!==null&&(ot.return=null),nt.return=null}catch(ct){W$1(nt,_e,ct)}}if(_e.subtreeFlags&12854)for(_e=_e.child;_e!==null;)ek(_e,tt),_e=_e.sibling}function ek(tt,_e){var rt=tt.alternate,it=tt.flags;switch(tt.tag){case 0:case 11:case 14:case 15:if(dk(_e,tt),fk(tt),it&4){try{Qj(3,tt,tt.return),Rj(3,tt)}catch(gt){W$1(tt,tt.return,gt)}try{Qj(5,tt,tt.return)}catch(gt){W$1(tt,tt.return,gt)}}break;case 1:dk(_e,tt),fk(tt),it&512&&rt!==null&&Mj(rt,rt.return);break;case 5:if(dk(_e,tt),fk(tt),it&512&&rt!==null&&Mj(rt,rt.return),tt.flags&32){var nt=tt.stateNode;try{ob(nt,"")}catch(gt){W$1(tt,tt.return,gt)}}if(it&4&&(nt=tt.stateNode,nt!=null)){var st=tt.memoizedProps,at=rt!==null?rt.memoizedProps:st,lt=tt.type,ot=tt.updateQueue;if(tt.updateQueue=null,ot!==null)try{lt==="input"&&st.type==="radio"&&st.name!=null&&ab(nt,st),vb(lt,at);var ct=vb(lt,st);for(at=0;at<ot.length;at+=2){var ut=ot[at],ht=ot[at+1];ut==="style"?sb(nt,ht):ut==="dangerouslySetInnerHTML"?nb(nt,ht):ut==="children"?ob(nt,ht):ta(nt,ut,ht,ct)}switch(lt){case"input":bb(nt,st);break;case"textarea":ib(nt,st);break;case"select":var dt=nt._wrapperState.wasMultiple;nt._wrapperState.wasMultiple=!!st.multiple;var pt=st.value;pt!=null?fb(nt,!!st.multiple,pt,!1):dt!==!!st.multiple&&(st.defaultValue!=null?fb(nt,!!st.multiple,st.defaultValue,!0):fb(nt,!!st.multiple,st.multiple?[]:"",!1))}nt[Pf]=st}catch(gt){W$1(tt,tt.return,gt)}}break;case 6:if(dk(_e,tt),fk(tt),it&4){if(tt.stateNode===null)throw Error(p$4(162));nt=tt.stateNode,st=tt.memoizedProps;try{nt.nodeValue=st}catch(gt){W$1(tt,tt.return,gt)}}break;case 3:if(dk(_e,tt),fk(tt),it&4&&rt!==null&&rt.memoizedState.isDehydrated)try{bd(_e.containerInfo)}catch(gt){W$1(tt,tt.return,gt)}break;case 4:dk(_e,tt),fk(tt);break;case 13:dk(_e,tt),fk(tt),nt=tt.child,nt.flags&8192&&(st=nt.memoizedState!==null,nt.stateNode.isHidden=st,!st||nt.alternate!==null&&nt.alternate.memoizedState!==null||(gk=B$2())),it&4&&bk(tt);break;case 22:if(ut=rt!==null&&rt.memoizedState!==null,tt.mode&1?(U$2=(ct=U$2)||ut,dk(_e,tt),U$2=ct):dk(_e,tt),fk(tt),it&8192){if(ct=tt.memoizedState!==null,(tt.stateNode.isHidden=ct)&&!ut&&tt.mode&1)for(V$3=tt,ut=tt.child;ut!==null;){for(ht=V$3=ut;V$3!==null;){switch(dt=V$3,pt=dt.child,dt.tag){case 0:case 11:case 14:case 15:Qj(4,dt,dt.return);break;case 1:Mj(dt,dt.return);var ft=dt.stateNode;if(typeof ft.componentWillUnmount=="function"){it=dt,rt=dt.return;try{_e=it,ft.props=_e.memoizedProps,ft.state=_e.memoizedState,ft.componentWillUnmount()}catch(gt){W$1(it,rt,gt)}}break;case 5:Mj(dt,dt.return);break;case 22:if(dt.memoizedState!==null){hk(ht);continue}}pt!==null?(pt.return=dt,V$3=pt):hk(ht)}ut=ut.sibling}e:for(ut=null,ht=tt;;){if(ht.tag===5){if(ut===null){ut=ht;try{nt=ht.stateNode,ct?(st=nt.style,typeof st.setProperty=="function"?st.setProperty("display","none","important"):st.display="none"):(lt=ht.stateNode,ot=ht.memoizedProps.style,at=ot!=null&&ot.hasOwnProperty("display")?ot.display:null,lt.style.display=rb("display",at))}catch(gt){W$1(tt,tt.return,gt)}}}else if(ht.tag===6){if(ut===null)try{ht.stateNode.nodeValue=ct?"":ht.memoizedProps}catch(gt){W$1(tt,tt.return,gt)}}else if((ht.tag!==22&&ht.tag!==23||ht.memoizedState===null||ht===tt)&&ht.child!==null){ht.child.return=ht,ht=ht.child;continue}if(ht===tt)break e;for(;ht.sibling===null;){if(ht.return===null||ht.return===tt)break e;ut===ht&&(ut=null),ht=ht.return}ut===ht&&(ut=null),ht.sibling.return=ht.return,ht=ht.sibling}}break;case 19:dk(_e,tt),fk(tt),it&4&&bk(tt);break;case 21:break;default:dk(_e,tt),fk(tt)}}function fk(tt){var _e=tt.flags;if(_e&2){try{e:{for(var rt=tt.return;rt!==null;){if(Uj(rt)){var it=rt;break e}rt=rt.return}throw Error(p$4(160))}switch(it.tag){case 5:var nt=it.stateNode;it.flags&32&&(ob(nt,""),it.flags&=-33);var st=Vj(tt);Xj(tt,st,nt);break;case 3:case 4:var at=it.stateNode.containerInfo,lt=Vj(tt);Wj(tt,lt,at);break;default:throw Error(p$4(161))}}catch(ot){W$1(tt,tt.return,ot)}tt.flags&=-3}_e&4096&&(tt.flags&=-4097)}function ik(tt,_e,rt){V$3=tt,jk(tt)}function jk(tt,_e,rt){for(var it=(tt.mode&1)!==0;V$3!==null;){var nt=V$3,st=nt.child;if(nt.tag===22&&it){var at=nt.memoizedState!==null||Kj;if(!at){var lt=nt.alternate,ot=lt!==null&&lt.memoizedState!==null||U$2;lt=Kj;var ct=U$2;if(Kj=at,(U$2=ot)&&!ct)for(V$3=nt;V$3!==null;)at=V$3,ot=at.child,at.tag===22&&at.memoizedState!==null?kk(nt):ot!==null?(ot.return=at,V$3=ot):kk(nt);for(;st!==null;)V$3=st,jk(st),st=st.sibling;V$3=nt,Kj=lt,U$2=ct}lk(tt)}else nt.subtreeFlags&8772&&st!==null?(st.return=nt,V$3=st):lk(tt)}}function lk(tt){for(;V$3!==null;){var _e=V$3;if(_e.flags&8772){var rt=_e.alternate;try{if(_e.flags&8772)switch(_e.tag){case 0:case 11:case 15:U$2||Rj(5,_e);break;case 1:var it=_e.stateNode;if(_e.flags&4&&!U$2)if(rt===null)it.componentDidMount();else{var nt=_e.elementType===_e.type?rt.memoizedProps:Lg(_e.type,rt.memoizedProps);it.componentDidUpdate(nt,rt.memoizedState,it.__reactInternalSnapshotBeforeUpdate)}var st=_e.updateQueue;st!==null&&ih(_e,st,it);break;case 3:var at=_e.updateQueue;if(at!==null){if(rt=null,_e.child!==null)switch(_e.child.tag){case 5:rt=_e.child.stateNode;break;case 1:rt=_e.child.stateNode}ih(_e,at,rt)}break;case 5:var lt=_e.stateNode;if(rt===null&&_e.flags&4){rt=lt;var ot=_e.memoizedProps;switch(_e.type){case"button":case"input":case"select":case"textarea":ot.autoFocus&&rt.focus();break;case"img":ot.src&&(rt.src=ot.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(_e.memoizedState===null){var ct=_e.alternate;if(ct!==null){var ut=ct.memoizedState;if(ut!==null){var ht=ut.dehydrated;ht!==null&&bd(ht)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$4(163))}U$2||_e.flags&512&&Sj(_e)}catch(dt){W$1(_e,_e.return,dt)}}if(_e===tt){V$3=null;break}if(rt=_e.sibling,rt!==null){rt.return=_e.return,V$3=rt;break}V$3=_e.return}}function hk(tt){for(;V$3!==null;){var _e=V$3;if(_e===tt){V$3=null;break}var rt=_e.sibling;if(rt!==null){rt.return=_e.return,V$3=rt;break}V$3=_e.return}}function kk(tt){for(;V$3!==null;){var _e=V$3;try{switch(_e.tag){case 0:case 11:case 15:var rt=_e.return;try{Rj(4,_e)}catch(ot){W$1(_e,rt,ot)}break;case 1:var it=_e.stateNode;if(typeof it.componentDidMount=="function"){var nt=_e.return;try{it.componentDidMount()}catch(ot){W$1(_e,nt,ot)}}var st=_e.return;try{Sj(_e)}catch(ot){W$1(_e,st,ot)}break;case 5:var at=_e.return;try{Sj(_e)}catch(ot){W$1(_e,at,ot)}}}catch(ot){W$1(_e,_e.return,ot)}if(_e===tt){V$3=null;break}var lt=_e.sibling;if(lt!==null){lt.return=_e.return,V$3=lt;break}V$3=_e.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R$1=null,Y$2=null,Z=0,gj=0,fj=Uf(0),T$2=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L$2(){return K&6?B$2():Bk!==-1?Bk:Bk=B$2()}function lh(tt){return tt.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(tt=C$2,tt!==0||(tt=window.event,tt=tt===void 0?16:jd(tt.type)),tt):1}function mh(tt,_e,rt,it){if(50<zk)throw zk=0,Ak=null,Error(p$4(185));Ac(tt,rt,it),(!(K&2)||tt!==R$1)&&(tt===R$1&&(!(K&2)&&(rk|=rt),T$2===4&&Dk(tt,Z)),Ek(tt,it),rt===1&&K===0&&!(_e.mode&1)&&(Hj=B$2()+500,fg&&jg()))}function Ek(tt,_e){var rt=tt.callbackNode;wc(tt,_e);var it=uc(tt,tt===R$1?Z:0);if(it===0)rt!==null&&bc(rt),tt.callbackNode=null,tt.callbackPriority=0;else if(_e=it&-it,tt.callbackPriority!==_e){if(rt!=null&&bc(rt),_e===1)tt.tag===0?ig(Fk.bind(null,tt)):hg(Fk.bind(null,tt)),Jf(function(){!(K&6)&&jg()}),rt=null;else{switch(Dc(it)){case 1:rt=fc;break;case 4:rt=gc;break;case 16:rt=hc;break;case 536870912:rt=jc;break;default:rt=hc}rt=Gk(rt,Hk.bind(null,tt))}tt.callbackPriority=_e,tt.callbackNode=rt}}function Hk(tt,_e){if(Bk=-1,Ck=0,K&6)throw Error(p$4(327));var rt=tt.callbackNode;if(Ik()&&tt.callbackNode!==rt)return null;var it=uc(tt,tt===R$1?Z:0);if(it===0)return null;if(it&30||it&tt.expiredLanes||_e)_e=Jk(tt,it);else{_e=it;var nt=K;K|=2;var st=Kk();(R$1!==tt||Z!==_e)&&(vk=null,Hj=B$2()+500,Lk(tt,_e));do try{Mk();break}catch(lt){Nk(tt,lt)}while(1);Qg(),nk.current=st,K=nt,Y$2!==null?_e=0:(R$1=null,Z=0,_e=T$2)}if(_e!==0){if(_e===2&&(nt=xc(tt),nt!==0&&(it=nt,_e=Ok(tt,nt))),_e===1)throw rt=qk,Lk(tt,0),Dk(tt,it),Ek(tt,B$2()),rt;if(_e===6)Dk(tt,it);else{if(nt=tt.current.alternate,!(it&30)&&!Pk(nt)&&(_e=Jk(tt,it),_e===2&&(st=xc(tt),st!==0&&(it=st,_e=Ok(tt,st))),_e===1))throw rt=qk,Lk(tt,0),Dk(tt,it),Ek(tt,B$2()),rt;switch(tt.finishedWork=nt,tt.finishedLanes=it,_e){case 0:case 1:throw Error(p$4(345));case 2:Qk(tt,uk,vk);break;case 3:if(Dk(tt,it),(it&130023424)===it&&(_e=gk+500-B$2(),10<_e)){if(uc(tt,0)!==0)break;if(nt=tt.suspendedLanes,(nt&it)!==it){L$2(),tt.pingedLanes|=tt.suspendedLanes&nt;break}tt.timeoutHandle=Ff(Qk.bind(null,tt,uk,vk),_e);break}Qk(tt,uk,vk);break;case 4:if(Dk(tt,it),(it&4194240)===it)break;for(_e=tt.eventTimes,nt=-1;0<it;){var at=31-oc(it);st=1<<at,at=_e[at],at>nt&&(nt=at),it&=~st}if(it=nt,it=B$2()-it,it=(120>it?120:480>it?480:1080>it?1080:1920>it?1920:3e3>it?3e3:4320>it?4320:1960*mk(it/1960))-it,10<it){tt.timeoutHandle=Ff(Qk.bind(null,tt,uk,vk),it);break}Qk(tt,uk,vk);break;case 5:Qk(tt,uk,vk);break;default:throw Error(p$4(329))}}}return Ek(tt,B$2()),tt.callbackNode===rt?Hk.bind(null,tt):null}function Ok(tt,_e){var rt=tk;return tt.current.memoizedState.isDehydrated&&(Lk(tt,_e).flags|=256),tt=Jk(tt,_e),tt!==2&&(_e=uk,uk=rt,_e!==null&&Gj(_e)),tt}function Gj(tt){uk===null?uk=tt:uk.push.apply(uk,tt)}function Pk(tt){for(var _e=tt;;){if(_e.flags&16384){var rt=_e.updateQueue;if(rt!==null&&(rt=rt.stores,rt!==null))for(var it=0;it<rt.length;it++){var nt=rt[it],st=nt.getSnapshot;nt=nt.value;try{if(!He(st(),nt))return!1}catch{return!1}}}if(rt=_e.child,_e.subtreeFlags&16384&&rt!==null)rt.return=_e,_e=rt;else{if(_e===tt)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===tt)return!0;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}}return!0}function Dk(tt,_e){for(_e&=~sk,_e&=~rk,tt.suspendedLanes|=_e,tt.pingedLanes&=~_e,tt=tt.expirationTimes;0<_e;){var rt=31-oc(_e),it=1<<rt;tt[rt]=-1,_e&=~it}}function Fk(tt){if(K&6)throw Error(p$4(327));Ik();var _e=uc(tt,0);if(!(_e&1))return Ek(tt,B$2()),null;var rt=Jk(tt,_e);if(tt.tag!==0&&rt===2){var it=xc(tt);it!==0&&(_e=it,rt=Ok(tt,it))}if(rt===1)throw rt=qk,Lk(tt,0),Dk(tt,_e),Ek(tt,B$2()),rt;if(rt===6)throw Error(p$4(345));return tt.finishedWork=tt.current.alternate,tt.finishedLanes=_e,Qk(tt,uk,vk),Ek(tt,B$2()),null}function Rk(tt,_e){var rt=K;K|=1;try{return tt(_e)}finally{K=rt,K===0&&(Hj=B$2()+500,fg&&jg())}}function Sk(tt){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var _e=K;K|=1;var rt=pk.transition,it=C$2;try{if(pk.transition=null,C$2=1,tt)return tt()}finally{C$2=it,pk.transition=rt,K=_e,!(K&6)&&jg()}}function Ij(){gj=fj.current,E$2(fj)}function Lk(tt,_e){tt.finishedWork=null,tt.finishedLanes=0;var rt=tt.timeoutHandle;if(rt!==-1&&(tt.timeoutHandle=-1,Gf(rt)),Y$2!==null)for(rt=Y$2.return;rt!==null;){var it=rt;switch(wg(it),it.tag){case 1:it=it.type.childContextTypes,it!=null&&$f();break;case 3:Jh(),E$2(Wf),E$2(H$2),Oh();break;case 5:Lh(it);break;case 4:Jh();break;case 13:E$2(M$2);break;case 19:E$2(M$2);break;case 10:Rg(it.type._context);break;case 22:case 23:Ij()}rt=rt.return}if(R$1=tt,Y$2=tt=wh(tt.current,null),Z=gj=_e,T$2=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(_e=0;_e<Wg.length;_e++)if(rt=Wg[_e],it=rt.interleaved,it!==null){rt.interleaved=null;var nt=it.next,st=rt.pending;if(st!==null){var at=st.next;st.next=nt,it.next=at}rt.pending=it}Wg=null}return tt}function Nk(tt,_e){do{var rt=Y$2;try{if(Qg(),Ph.current=ai,Sh){for(var it=N$2.memoizedState;it!==null;){var nt=it.queue;nt!==null&&(nt.pending=null),it=it.next}Sh=!1}if(Rh=0,P$1=O$1=N$2=null,Th=!1,Uh=0,ok.current=null,rt===null||rt.return===null){T$2=1,qk=_e,Y$2=null;break}e:{var st=tt,at=rt.return,lt=rt,ot=_e;if(_e=Z,lt.flags|=32768,ot!==null&&typeof ot=="object"&&typeof ot.then=="function"){var ct=ot,ut=lt,ht=ut.tag;if(!(ut.mode&1)&&(ht===0||ht===11||ht===15)){var dt=ut.alternate;dt?(ut.updateQueue=dt.updateQueue,ut.memoizedState=dt.memoizedState,ut.lanes=dt.lanes):(ut.updateQueue=null,ut.memoizedState=null)}var pt=Vi(at);if(pt!==null){pt.flags&=-257,Wi(pt,at,lt,st,_e),pt.mode&1&&Ti(st,ct,_e),_e=pt,ot=ct;var ft=_e.updateQueue;if(ft===null){var gt=new Set;gt.add(ot),_e.updateQueue=gt}else ft.add(ot);break e}else{if(!(_e&1)){Ti(st,ct,_e),uj();break e}ot=Error(p$4(426))}}else if(I$4&&lt.mode&1){var mt=Vi(at);if(mt!==null){!(mt.flags&65536)&&(mt.flags|=256),Wi(mt,at,lt,st,_e),Jg(Ki(ot,lt));break e}}st=ot=Ki(ot,lt),T$2!==4&&(T$2=2),tk===null?tk=[st]:tk.push(st),st=at;do{switch(st.tag){case 3:st.flags|=65536,_e&=-_e,st.lanes|=_e;var At=Oi(st,ot,_e);fh(st,At);break e;case 1:lt=ot;var yt=st.type,bt=st.stateNode;if(!(st.flags&128)&&(typeof yt.getDerivedStateFromError=="function"||bt!==null&&typeof bt.componentDidCatch=="function"&&(Si===null||!Si.has(bt)))){st.flags|=65536,_e&=-_e,st.lanes|=_e;var xt=Ri(st,lt,_e);fh(st,xt);break e}}st=st.return}while(st!==null)}Tk(rt)}catch(vt){_e=vt,Y$2===rt&&rt!==null&&(Y$2=rt=rt.return);continue}break}while(1)}function Kk(){var tt=nk.current;return nk.current=ai,tt===null?ai:tt}function uj(){(T$2===0||T$2===3||T$2===2)&&(T$2=4),R$1===null||!(hh&268435455)&&!(rk&268435455)||Dk(R$1,Z)}function Jk(tt,_e){var rt=K;K|=2;var it=Kk();(R$1!==tt||Z!==_e)&&(vk=null,Lk(tt,_e));do try{Uk();break}catch(nt){Nk(tt,nt)}while(1);if(Qg(),K=rt,nk.current=it,Y$2!==null)throw Error(p$4(261));return R$1=null,Z=0,T$2}function Uk(){for(;Y$2!==null;)Vk(Y$2)}function Mk(){for(;Y$2!==null&&!cc$1();)Vk(Y$2)}function Vk(tt){var _e=Wk(tt.alternate,tt,gj);tt.memoizedProps=tt.pendingProps,_e===null?Tk(tt):Y$2=_e,ok.current=null}function Tk(tt){var _e=tt;do{var rt=_e.alternate;if(tt=_e.return,_e.flags&32768){if(rt=Jj(rt,_e),rt!==null){rt.flags&=32767,Y$2=rt;return}if(tt!==null)tt.flags|=32768,tt.subtreeFlags=0,tt.deletions=null;else{T$2=6,Y$2=null;return}}else if(rt=Fj(rt,_e,gj),rt!==null){Y$2=rt;return}if(_e=_e.sibling,_e!==null){Y$2=_e;return}Y$2=_e=tt}while(_e!==null);T$2===0&&(T$2=5)}function Qk(tt,_e,rt){var it=C$2,nt=pk.transition;try{pk.transition=null,C$2=1,Xk(tt,_e,rt,it)}finally{pk.transition=nt,C$2=it}return null}function Xk(tt,_e,rt,it){do Ik();while(xk!==null);if(K&6)throw Error(p$4(327));rt=tt.finishedWork;var nt=tt.finishedLanes;if(rt===null)return null;if(tt.finishedWork=null,tt.finishedLanes=0,rt===tt.current)throw Error(p$4(177));tt.callbackNode=null,tt.callbackPriority=0;var st=rt.lanes|rt.childLanes;if(Bc(tt,st),tt===R$1&&(Y$2=R$1=null,Z=0),!(rt.subtreeFlags&2064)&&!(rt.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),st=(rt.flags&15990)!==0,rt.subtreeFlags&15990||st){st=pk.transition,pk.transition=null;var at=C$2;C$2=1;var lt=K;K|=4,ok.current=null,Pj(tt,rt),ek(rt,tt),Oe(Df),dd=!!Cf,Df=Cf=null,tt.current=rt,ik(rt),dc(),K=lt,C$2=at,pk.transition=st}else tt.current=rt;if(wk&&(wk=!1,xk=tt,yk=nt),st=tt.pendingLanes,st===0&&(Si=null),mc(rt.stateNode),Ek(tt,B$2()),_e!==null)for(it=tt.onRecoverableError,rt=0;rt<_e.length;rt++)nt=_e[rt],it(nt.value,{componentStack:nt.stack,digest:nt.digest});if(Pi)throw Pi=!1,tt=Qi,Qi=null,tt;return yk&1&&tt.tag!==0&&Ik(),st=tt.pendingLanes,st&1?tt===Ak?zk++:(zk=0,Ak=tt):zk=0,jg(),null}function Ik(){if(xk!==null){var tt=Dc(yk),_e=pk.transition,rt=C$2;try{if(pk.transition=null,C$2=16>tt?16:tt,xk===null)var it=!1;else{if(tt=xk,xk=null,yk=0,K&6)throw Error(p$4(331));var nt=K;for(K|=4,V$3=tt.current;V$3!==null;){var st=V$3,at=st.child;if(V$3.flags&16){var lt=st.deletions;if(lt!==null){for(var ot=0;ot<lt.length;ot++){var ct=lt[ot];for(V$3=ct;V$3!==null;){var ut=V$3;switch(ut.tag){case 0:case 11:case 15:Qj(8,ut,st)}var ht=ut.child;if(ht!==null)ht.return=ut,V$3=ht;else for(;V$3!==null;){ut=V$3;var dt=ut.sibling,pt=ut.return;if(Tj(ut),ut===ct){V$3=null;break}if(dt!==null){dt.return=pt,V$3=dt;break}V$3=pt}}}var ft=st.alternate;if(ft!==null){var gt=ft.child;if(gt!==null){ft.child=null;do{var mt=gt.sibling;gt.sibling=null,gt=mt}while(gt!==null)}}V$3=st}}if(st.subtreeFlags&2064&&at!==null)at.return=st,V$3=at;else e:for(;V$3!==null;){if(st=V$3,st.flags&2048)switch(st.tag){case 0:case 11:case 15:Qj(9,st,st.return)}var At=st.sibling;if(At!==null){At.return=st.return,V$3=At;break e}V$3=st.return}}var yt=tt.current;for(V$3=yt;V$3!==null;){at=V$3;var bt=at.child;if(at.subtreeFlags&2064&&bt!==null)bt.return=at,V$3=bt;else e:for(at=yt;V$3!==null;){if(lt=V$3,lt.flags&2048)try{switch(lt.tag){case 0:case 11:case 15:Rj(9,lt)}}catch(vt){W$1(lt,lt.return,vt)}if(lt===at){V$3=null;break e}var xt=lt.sibling;if(xt!==null){xt.return=lt.return,V$3=xt;break e}V$3=lt.return}}if(K=nt,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,tt)}catch{}it=!0}return it}finally{C$2=rt,pk.transition=_e}}return!1}function Yk(tt,_e,rt){_e=Ki(rt,_e),_e=Oi(tt,_e,1),tt=dh(tt,_e,1),_e=L$2(),tt!==null&&(Ac(tt,1,_e),Ek(tt,_e))}function W$1(tt,_e,rt){if(tt.tag===3)Yk(tt,tt,rt);else for(;_e!==null;){if(_e.tag===3){Yk(_e,tt,rt);break}else if(_e.tag===1){var it=_e.stateNode;if(typeof _e.type.getDerivedStateFromError=="function"||typeof it.componentDidCatch=="function"&&(Si===null||!Si.has(it))){tt=Ki(rt,tt),tt=Ri(_e,tt,1),_e=dh(_e,tt,1),tt=L$2(),_e!==null&&(Ac(_e,1,tt),Ek(_e,tt));break}}_e=_e.return}}function Ui(tt,_e,rt){var it=tt.pingCache;it!==null&&it.delete(_e),_e=L$2(),tt.pingedLanes|=tt.suspendedLanes&rt,R$1===tt&&(Z&rt)===rt&&(T$2===4||T$2===3&&(Z&130023424)===Z&&500>B$2()-gk?Lk(tt,0):sk|=rt),Ek(tt,_e)}function Zk(tt,_e){_e===0&&(tt.mode&1?(_e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):_e=1);var rt=L$2();tt=Zg(tt,_e),tt!==null&&(Ac(tt,_e,rt),Ek(tt,rt))}function vj(tt){var _e=tt.memoizedState,rt=0;_e!==null&&(rt=_e.retryLane),Zk(tt,rt)}function ck(tt,_e){var rt=0;switch(tt.tag){case 13:var it=tt.stateNode,nt=tt.memoizedState;nt!==null&&(rt=nt.retryLane);break;case 19:it=tt.stateNode;break;default:throw Error(p$4(314))}it!==null&&it.delete(_e),Zk(tt,rt)}var Wk;Wk=function(tt,_e,rt){if(tt!==null)if(tt.memoizedProps!==_e.pendingProps||Wf.current)Ug=!0;else{if(!(tt.lanes&rt)&&!(_e.flags&128))return Ug=!1,zj(tt,_e,rt);Ug=!!(tt.flags&131072)}else Ug=!1,I$4&&_e.flags&1048576&&ug(_e,ng,_e.index);switch(_e.lanes=0,_e.tag){case 2:var it=_e.type;jj(tt,_e),tt=_e.pendingProps;var nt=Yf(_e,H$2.current);Tg(_e,rt),nt=Xh(null,_e,it,tt,nt,rt);var st=bi();return _e.flags|=1,typeof nt=="object"&&nt!==null&&typeof nt.render=="function"&&nt.$$typeof===void 0?(_e.tag=1,_e.memoizedState=null,_e.updateQueue=null,Zf(it)?(st=!0,cg(_e)):st=!1,_e.memoizedState=nt.state!==null&&nt.state!==void 0?nt.state:null,ah(_e),nt.updater=nh,_e.stateNode=nt,nt._reactInternals=_e,rh(_e,it,tt,rt),_e=kj(null,_e,it,!0,st,rt)):(_e.tag=0,I$4&&st&&vg(_e),Yi(null,_e,nt,rt),_e=_e.child),_e;case 16:it=_e.elementType;e:{switch(jj(tt,_e),tt=_e.pendingProps,nt=it._init,it=nt(it._payload),_e.type=it,nt=_e.tag=$k(it),tt=Lg(it,tt),nt){case 0:_e=dj(null,_e,it,tt,rt);break e;case 1:_e=ij(null,_e,it,tt,rt);break e;case 11:_e=Zi(null,_e,it,tt,rt);break e;case 14:_e=aj(null,_e,it,Lg(it.type,tt),rt);break e}throw Error(p$4(306,it,""))}return _e;case 0:return it=_e.type,nt=_e.pendingProps,nt=_e.elementType===it?nt:Lg(it,nt),dj(tt,_e,it,nt,rt);case 1:return it=_e.type,nt=_e.pendingProps,nt=_e.elementType===it?nt:Lg(it,nt),ij(tt,_e,it,nt,rt);case 3:e:{if(lj(_e),tt===null)throw Error(p$4(387));it=_e.pendingProps,st=_e.memoizedState,nt=st.element,bh(tt,_e),gh(_e,it,null,rt);var at=_e.memoizedState;if(it=at.element,st.isDehydrated)if(st={element:it,isDehydrated:!1,cache:at.cache,pendingSuspenseBoundaries:at.pendingSuspenseBoundaries,transitions:at.transitions},_e.updateQueue.baseState=st,_e.memoizedState=st,_e.flags&256){nt=Ki(Error(p$4(423)),_e),_e=mj(tt,_e,it,rt,nt);break e}else if(it!==nt){nt=Ki(Error(p$4(424)),_e),_e=mj(tt,_e,it,rt,nt);break e}else for(yg=Lf(_e.stateNode.containerInfo.firstChild),xg=_e,I$4=!0,zg=null,rt=Ch(_e,null,it,rt),_e.child=rt;rt;)rt.flags=rt.flags&-3|4096,rt=rt.sibling;else{if(Ig(),it===nt){_e=$i(tt,_e,rt);break e}Yi(tt,_e,it,rt)}_e=_e.child}return _e;case 5:return Kh(_e),tt===null&&Eg(_e),it=_e.type,nt=_e.pendingProps,st=tt!==null?tt.memoizedProps:null,at=nt.children,Ef(it,nt)?at=null:st!==null&&Ef(it,st)&&(_e.flags|=32),hj(tt,_e),Yi(tt,_e,at,rt),_e.child;case 6:return tt===null&&Eg(_e),null;case 13:return pj(tt,_e,rt);case 4:return Ih(_e,_e.stateNode.containerInfo),it=_e.pendingProps,tt===null?_e.child=Bh(_e,null,it,rt):Yi(tt,_e,it,rt),_e.child;case 11:return it=_e.type,nt=_e.pendingProps,nt=_e.elementType===it?nt:Lg(it,nt),Zi(tt,_e,it,nt,rt);case 7:return Yi(tt,_e,_e.pendingProps,rt),_e.child;case 8:return Yi(tt,_e,_e.pendingProps.children,rt),_e.child;case 12:return Yi(tt,_e,_e.pendingProps.children,rt),_e.child;case 10:e:{if(it=_e.type._context,nt=_e.pendingProps,st=_e.memoizedProps,at=nt.value,G$1(Mg,it._currentValue),it._currentValue=at,st!==null)if(He(st.value,at)){if(st.children===nt.children&&!Wf.current){_e=$i(tt,_e,rt);break e}}else for(st=_e.child,st!==null&&(st.return=_e);st!==null;){var lt=st.dependencies;if(lt!==null){at=st.child;for(var ot=lt.firstContext;ot!==null;){if(ot.context===it){if(st.tag===1){ot=ch(-1,rt&-rt),ot.tag=2;var ct=st.updateQueue;if(ct!==null){ct=ct.shared;var ut=ct.pending;ut===null?ot.next=ot:(ot.next=ut.next,ut.next=ot),ct.pending=ot}}st.lanes|=rt,ot=st.alternate,ot!==null&&(ot.lanes|=rt),Sg(st.return,rt,_e),lt.lanes|=rt;break}ot=ot.next}}else if(st.tag===10)at=st.type===_e.type?null:st.child;else if(st.tag===18){if(at=st.return,at===null)throw Error(p$4(341));at.lanes|=rt,lt=at.alternate,lt!==null&&(lt.lanes|=rt),Sg(at,rt,_e),at=st.sibling}else at=st.child;if(at!==null)at.return=st;else for(at=st;at!==null;){if(at===_e){at=null;break}if(st=at.sibling,st!==null){st.return=at.return,at=st;break}at=at.return}st=at}Yi(tt,_e,nt.children,rt),_e=_e.child}return _e;case 9:return nt=_e.type,it=_e.pendingProps.children,Tg(_e,rt),nt=Vg(nt),it=it(nt),_e.flags|=1,Yi(tt,_e,it,rt),_e.child;case 14:return it=_e.type,nt=Lg(it,_e.pendingProps),nt=Lg(it.type,nt),aj(tt,_e,it,nt,rt);case 15:return cj(tt,_e,_e.type,_e.pendingProps,rt);case 17:return it=_e.type,nt=_e.pendingProps,nt=_e.elementType===it?nt:Lg(it,nt),jj(tt,_e),_e.tag=1,Zf(it)?(tt=!0,cg(_e)):tt=!1,Tg(_e,rt),ph(_e,it,nt),rh(_e,it,nt,rt),kj(null,_e,it,!0,tt,rt);case 19:return yj(tt,_e,rt);case 22:return ej(tt,_e,rt)}throw Error(p$4(156,_e.tag))};function Gk(tt,_e){return ac(tt,_e)}function al(tt,_e,rt,it){this.tag=tt,this.key=rt,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=it,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(tt,_e,rt,it){return new al(tt,_e,rt,it)}function bj(tt){return tt=tt.prototype,!(!tt||!tt.isReactComponent)}function $k(tt){if(typeof tt=="function")return bj(tt)?1:0;if(tt!=null){if(tt=tt.$$typeof,tt===Da)return 11;if(tt===Ga)return 14}return 2}function wh(tt,_e){var rt=tt.alternate;return rt===null?(rt=Bg(tt.tag,_e,tt.key,tt.mode),rt.elementType=tt.elementType,rt.type=tt.type,rt.stateNode=tt.stateNode,rt.alternate=tt,tt.alternate=rt):(rt.pendingProps=_e,rt.type=tt.type,rt.flags=0,rt.subtreeFlags=0,rt.deletions=null),rt.flags=tt.flags&14680064,rt.childLanes=tt.childLanes,rt.lanes=tt.lanes,rt.child=tt.child,rt.memoizedProps=tt.memoizedProps,rt.memoizedState=tt.memoizedState,rt.updateQueue=tt.updateQueue,_e=tt.dependencies,rt.dependencies=_e===null?null:{lanes:_e.lanes,firstContext:_e.firstContext},rt.sibling=tt.sibling,rt.index=tt.index,rt.ref=tt.ref,rt}function yh(tt,_e,rt,it,nt,st){var at=2;if(it=tt,typeof tt=="function")bj(tt)&&(at=1);else if(typeof tt=="string")at=5;else e:switch(tt){case ya:return Ah(rt.children,nt,st,_e);case za:at=8,nt|=8;break;case Aa:return tt=Bg(12,rt,_e,nt|2),tt.elementType=Aa,tt.lanes=st,tt;case Ea:return tt=Bg(13,rt,_e,nt),tt.elementType=Ea,tt.lanes=st,tt;case Fa:return tt=Bg(19,rt,_e,nt),tt.elementType=Fa,tt.lanes=st,tt;case Ia:return qj(rt,nt,st,_e);default:if(typeof tt=="object"&&tt!==null)switch(tt.$$typeof){case Ba:at=10;break e;case Ca:at=9;break e;case Da:at=11;break e;case Ga:at=14;break e;case Ha:at=16,it=null;break e}throw Error(p$4(130,tt==null?tt:typeof tt,""))}return _e=Bg(at,rt,_e,nt),_e.elementType=tt,_e.type=it,_e.lanes=st,_e}function Ah(tt,_e,rt,it){return tt=Bg(7,tt,it,_e),tt.lanes=rt,tt}function qj(tt,_e,rt,it){return tt=Bg(22,tt,it,_e),tt.elementType=Ia,tt.lanes=rt,tt.stateNode={isHidden:!1},tt}function xh(tt,_e,rt){return tt=Bg(6,tt,null,_e),tt.lanes=rt,tt}function zh(tt,_e,rt){return _e=Bg(4,tt.children!==null?tt.children:[],tt.key,_e),_e.lanes=rt,_e.stateNode={containerInfo:tt.containerInfo,pendingChildren:null,implementation:tt.implementation},_e}function bl(tt,_e,rt,it,nt){this.tag=_e,this.containerInfo=tt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=it,this.onRecoverableError=nt,this.mutableSourceEagerHydrationData=null}function cl(tt,_e,rt,it,nt,st,at,lt,ot){return tt=new bl(tt,_e,rt,lt,ot),_e===1?(_e=1,st===!0&&(_e|=8)):_e=0,st=Bg(3,null,null,_e),tt.current=st,st.stateNode=tt,st.memoizedState={element:it,isDehydrated:rt,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(st),tt}function dl(tt,_e,rt){var it=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:it==null?null:""+it,children:tt,containerInfo:_e,implementation:rt}}function el(tt){if(!tt)return Vf;tt=tt._reactInternals;e:{if(Vb(tt)!==tt||tt.tag!==1)throw Error(p$4(170));var _e=tt;do{switch(_e.tag){case 3:_e=_e.stateNode.context;break e;case 1:if(Zf(_e.type)){_e=_e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_e=_e.return}while(_e!==null);throw Error(p$4(171))}if(tt.tag===1){var rt=tt.type;if(Zf(rt))return bg(tt,rt,_e)}return _e}function fl$1(tt,_e,rt,it,nt,st,at,lt,ot){return tt=cl(rt,it,!0,tt,nt,st,at,lt,ot),tt.context=el(null),rt=tt.current,it=L$2(),nt=lh(rt),st=ch(it,nt),st.callback=_e??null,dh(rt,st,nt),tt.current.lanes=nt,Ac(tt,nt,it),Ek(tt,it),tt}function gl(tt,_e,rt,it){var nt=_e.current,st=L$2(),at=lh(nt);return rt=el(rt),_e.context===null?_e.context=rt:_e.pendingContext=rt,_e=ch(st,at),_e.payload={element:tt},it=it===void 0?null:it,it!==null&&(_e.callback=it),tt=dh(nt,_e,at),tt!==null&&(mh(tt,nt,at,st),eh(tt,nt,at)),at}function hl(tt){if(tt=tt.current,!tt.child)return null;switch(tt.child.tag){case 5:return tt.child.stateNode;default:return tt.child.stateNode}}function il(tt,_e){if(tt=tt.memoizedState,tt!==null&&tt.dehydrated!==null){var rt=tt.retryLane;tt.retryLane=rt!==0&&rt<_e?rt:_e}}function jl(tt,_e){il(tt,_e),(tt=tt.alternate)&&il(tt,_e)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(tt){console.error(tt)};function ml(tt){this._internalRoot=tt}nl.prototype.render=ml.prototype.render=function(tt){var _e=this._internalRoot;if(_e===null)throw Error(p$4(409));gl(tt,_e,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var tt=this._internalRoot;if(tt!==null){this._internalRoot=null;var _e=tt.containerInfo;Sk(function(){gl(null,tt,null,null)}),_e[uf]=null}};function nl(tt){this._internalRoot=tt}nl.prototype.unstable_scheduleHydration=function(tt){if(tt){var _e=Hc();tt={blockedOn:null,target:tt,priority:_e};for(var rt=0;rt<Qc.length&&_e!==0&&_e<Qc[rt].priority;rt++);Qc.splice(rt,0,tt),rt===0&&Vc(tt)}};function ol(tt){return!(!tt||tt.nodeType!==1&&tt.nodeType!==9&&tt.nodeType!==11)}function pl(tt){return!(!tt||tt.nodeType!==1&&tt.nodeType!==9&&tt.nodeType!==11&&(tt.nodeType!==8||tt.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(tt,_e,rt,it,nt){if(nt){if(typeof it=="function"){var st=it;it=function(){var ct=hl(at);st.call(ct)}}var at=fl$1(_e,it,tt,0,null,!1,!1,"",ql);return tt._reactRootContainer=at,tt[uf]=at.current,sf(tt.nodeType===8?tt.parentNode:tt),Sk(),at}for(;nt=tt.lastChild;)tt.removeChild(nt);if(typeof it=="function"){var lt=it;it=function(){var ct=hl(ot);lt.call(ct)}}var ot=cl(tt,0,!1,null,null,!1,!1,"",ql);return tt._reactRootContainer=ot,tt[uf]=ot.current,sf(tt.nodeType===8?tt.parentNode:tt),Sk(function(){gl(_e,ot,rt,it)}),ot}function sl(tt,_e,rt,it,nt){var st=rt._reactRootContainer;if(st){var at=st;if(typeof nt=="function"){var lt=nt;nt=function(){var ot=hl(at);lt.call(ot)}}gl(_e,at,tt,nt)}else at=rl(rt,_e,tt,nt,it);return hl(at)}Ec=function(tt){switch(tt.tag){case 3:var _e=tt.stateNode;if(_e.current.memoizedState.isDehydrated){var rt=tc(_e.pendingLanes);rt!==0&&(Cc(_e,rt|1),Ek(_e,B$2()),!(K&6)&&(Hj=B$2()+500,jg()))}break;case 13:Sk(function(){var it=Zg(tt,1);if(it!==null){var nt=L$2();mh(it,tt,1,nt)}}),jl(tt,1)}};Fc=function(tt){if(tt.tag===13){var _e=Zg(tt,134217728);if(_e!==null){var rt=L$2();mh(_e,tt,134217728,rt)}jl(tt,134217728)}};Gc=function(tt){if(tt.tag===13){var _e=lh(tt),rt=Zg(tt,_e);if(rt!==null){var it=L$2();mh(rt,tt,_e,it)}jl(tt,_e)}};Hc=function(){return C$2};Ic=function(tt,_e){var rt=C$2;try{return C$2=tt,_e()}finally{C$2=rt}};yb=function(tt,_e,rt){switch(_e){case"input":if(bb(tt,rt),_e=rt.name,rt.type==="radio"&&_e!=null){for(rt=tt;rt.parentNode;)rt=rt.parentNode;for(rt=rt.querySelectorAll("input[name="+JSON.stringify(""+_e)+'][type="radio"]'),_e=0;_e<rt.length;_e++){var it=rt[_e];if(it!==tt&&it.form===tt.form){var nt=Db(it);if(!nt)throw Error(p$4(90));Wa(it),bb(it,nt)}}}break;case"textarea":ib(tt,rt);break;case"select":_e=rt.value,_e!=null&&fb(tt,!!rt.multiple,_e,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(tt){return tt=Zb(tt),tt===null?null:tt.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(tt,_e){var rt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(_e))throw Error(p$4(200));return dl(tt,_e,null,rt)};reactDom_production_min.createRoot=function(tt,_e){if(!ol(tt))throw Error(p$4(299));var rt=!1,it="",nt=ll;return _e!=null&&(_e.unstable_strictMode===!0&&(rt=!0),_e.identifierPrefix!==void 0&&(it=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(nt=_e.onRecoverableError)),_e=cl(tt,1,!1,null,null,rt,!1,it,nt),tt[uf]=_e.current,sf(tt.nodeType===8?tt.parentNode:tt),new ml(_e)};reactDom_production_min.findDOMNode=function(tt){if(tt==null)return null;if(tt.nodeType===1)return tt;var _e=tt._reactInternals;if(_e===void 0)throw typeof tt.render=="function"?Error(p$4(188)):(tt=Object.keys(tt).join(","),Error(p$4(268,tt)));return tt=Zb(_e),tt=tt===null?null:tt.stateNode,tt};reactDom_production_min.flushSync=function(tt){return Sk(tt)};reactDom_production_min.hydrate=function(tt,_e,rt){if(!pl(_e))throw Error(p$4(200));return sl(null,tt,_e,!0,rt)};reactDom_production_min.hydrateRoot=function(tt,_e,rt){if(!ol(tt))throw Error(p$4(405));var it=rt!=null&&rt.hydratedSources||null,nt=!1,st="",at=ll;if(rt!=null&&(rt.unstable_strictMode===!0&&(nt=!0),rt.identifierPrefix!==void 0&&(st=rt.identifierPrefix),rt.onRecoverableError!==void 0&&(at=rt.onRecoverableError)),_e=fl$1(_e,null,tt,1,rt??null,nt,!1,st,at),tt[uf]=_e.current,sf(tt),it)for(tt=0;tt<it.length;tt++)rt=it[tt],nt=rt._getVersion,nt=nt(rt._source),_e.mutableSourceEagerHydrationData==null?_e.mutableSourceEagerHydrationData=[rt,nt]:_e.mutableSourceEagerHydrationData.push(rt,nt);return new nl(_e)};reactDom_production_min.render=function(tt,_e,rt){if(!pl(_e))throw Error(p$4(200));return sl(null,tt,_e,!1,rt)};reactDom_production_min.unmountComponentAtNode=function(tt){if(!pl(tt))throw Error(p$4(40));return tt._reactRootContainer?(Sk(function(){sl(null,null,tt,!1,function(){tt._reactRootContainer=null,tt[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(tt,_e,rt,it){if(!pl(rt))throw Error(p$4(200));if(tt==null||tt._reactInternals===void 0)throw Error(p$4(38));return sl(tt,_e,rt,!1,it)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(tt){console.error(tt)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);var m$4=reactDomExports;client.createRoot=m$4.createRoot,client.hydrateRoot=m$4.hydrateRoot;/**
 * @remix-run/router v1.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var it in rt)Object.prototype.hasOwnProperty.call(rt,it)&&(tt[it]=rt[it])}return tt},_extends$3.apply(this,arguments)}var Action;(function(tt){tt.Pop="POP",tt.Push="PUSH",tt.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(tt){tt===void 0&&(tt={});function _e(it,nt){let{pathname:st,search:at,hash:lt}=it.location;return createLocation("",{pathname:st,search:at,hash:lt},nt.state&&nt.state.usr||null,nt.state&&nt.state.key||"default")}function rt(it,nt){return typeof nt=="string"?nt:createPath$1(nt)}return getUrlBasedHistory(_e,rt,null,tt)}function invariant(tt,_e){if(tt===!1||tt===null||typeof tt>"u")throw new Error(_e)}function warning(tt,_e){if(!tt){typeof console<"u"&&console.warn(_e);try{throw new Error(_e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(tt,_e){return{usr:tt.state,key:tt.key,idx:_e}}function createLocation(tt,_e,rt,it){return rt===void 0&&(rt=null),_extends$3({pathname:typeof tt=="string"?tt:tt.pathname,search:"",hash:""},typeof _e=="string"?parsePath(_e):_e,{state:rt,key:_e&&_e.key||it||createKey()})}function createPath$1(tt){let{pathname:_e="/",search:rt="",hash:it=""}=tt;return rt&&rt!=="?"&&(_e+=rt.charAt(0)==="?"?rt:"?"+rt),it&&it!=="#"&&(_e+=it.charAt(0)==="#"?it:"#"+it),_e}function parsePath(tt){let _e={};if(tt){let rt=tt.indexOf("#");rt>=0&&(_e.hash=tt.substr(rt),tt=tt.substr(0,rt));let it=tt.indexOf("?");it>=0&&(_e.search=tt.substr(it),tt=tt.substr(0,it)),tt&&(_e.pathname=tt)}return _e}function getUrlBasedHistory(tt,_e,rt,it){it===void 0&&(it={});let{window:nt=document.defaultView,v5Compat:st=!1}=it,at=nt.history,lt=Action.Pop,ot=null,ct=ut();ct==null&&(ct=0,at.replaceState(_extends$3({},at.state,{idx:ct}),""));function ut(){return(at.state||{idx:null}).idx}function ht(){lt=Action.Pop;let mt=ut(),At=mt==null?null:mt-ct;ct=mt,ot&&ot({action:lt,location:gt.location,delta:At})}function dt(mt,At){lt=Action.Push;let yt=createLocation(gt.location,mt,At);rt&&rt(yt,mt),ct=ut()+1;let bt=getHistoryState(yt,ct),xt=gt.createHref(yt);try{at.pushState(bt,"",xt)}catch(vt){if(vt instanceof DOMException&&vt.name==="DataCloneError")throw vt;nt.location.assign(xt)}st&&ot&&ot({action:lt,location:gt.location,delta:1})}function pt(mt,At){lt=Action.Replace;let yt=createLocation(gt.location,mt,At);rt&&rt(yt,mt),ct=ut();let bt=getHistoryState(yt,ct),xt=gt.createHref(yt);at.replaceState(bt,"",xt),st&&ot&&ot({action:lt,location:gt.location,delta:0})}function ft(mt){let At=nt.location.origin!=="null"?nt.location.origin:nt.location.href,yt=typeof mt=="string"?mt:createPath$1(mt);return invariant(At,"No window.location.(origin|href) available to create URL for href: "+yt),new URL(yt,At)}let gt={get action(){return lt},get location(){return tt(nt,at)},listen(mt){if(ot)throw new Error("A history only accepts one active listener");return nt.addEventListener(PopStateEventType,ht),ot=mt,()=>{nt.removeEventListener(PopStateEventType,ht),ot=null}},createHref(mt){return _e(nt,mt)},createURL:ft,encodeLocation(mt){let At=ft(mt);return{pathname:At.pathname,search:At.search,hash:At.hash}},push:dt,replace:pt,go(mt){return at.go(mt)}};return gt}var ResultType;(function(tt){tt.data="data",tt.deferred="deferred",tt.redirect="redirect",tt.error="error"})(ResultType||(ResultType={}));function matchRoutes(tt,_e,rt){rt===void 0&&(rt="/");let it=typeof _e=="string"?parsePath(_e):_e,nt=stripBasename(it.pathname||"/",rt);if(nt==null)return null;let st=flattenRoutes(tt);rankRouteBranches(st);let at=null;for(let lt=0;at==null&&lt<st.length;++lt)at=matchRouteBranch(st[lt],safelyDecodeURI(nt));return at}function flattenRoutes(tt,_e,rt,it){_e===void 0&&(_e=[]),rt===void 0&&(rt=[]),it===void 0&&(it="");let nt=(st,at,lt)=>{let ot={relativePath:lt===void 0?st.path||"":lt,caseSensitive:st.caseSensitive===!0,childrenIndex:at,route:st};ot.relativePath.startsWith("/")&&(invariant(ot.relativePath.startsWith(it),'Absolute route path "'+ot.relativePath+'" nested under path '+('"'+it+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),ot.relativePath=ot.relativePath.slice(it.length));let ct=joinPaths([it,ot.relativePath]),ut=rt.concat(ot);st.children&&st.children.length>0&&(invariant(st.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+ct+'".')),flattenRoutes(st.children,_e,ut,ct)),!(st.path==null&&!st.index)&&_e.push({path:ct,score:computeScore(ct,st.index),routesMeta:ut})};return tt.forEach((st,at)=>{var lt;if(st.path===""||!((lt=st.path)!=null&&lt.includes("?")))nt(st,at);else for(let ot of explodeOptionalSegments(st.path))nt(st,at,ot)}),_e}function explodeOptionalSegments(tt){let _e=tt.split("/");if(_e.length===0)return[];let[rt,...it]=_e,nt=rt.endsWith("?"),st=rt.replace(/\?$/,"");if(it.length===0)return nt?[st,""]:[st];let at=explodeOptionalSegments(it.join("/")),lt=[];return lt.push(...at.map(ot=>ot===""?st:[st,ot].join("/"))),nt&&lt.push(...at),lt.map(ot=>tt.startsWith("/")&&ot===""?"/":ot)}function rankRouteBranches(tt){tt.sort((_e,rt)=>_e.score!==rt.score?rt.score-_e.score:compareIndexes(_e.routesMeta.map(it=>it.childrenIndex),rt.routesMeta.map(it=>it.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=tt=>tt==="*";function computeScore(tt,_e){let rt=tt.split("/"),it=rt.length;return rt.some(isSplat)&&(it+=splatPenalty),_e&&(it+=indexRouteValue),rt.filter(nt=>!isSplat(nt)).reduce((nt,st)=>nt+(paramRe.test(st)?dynamicSegmentValue:st===""?emptySegmentValue:staticSegmentValue),it)}function compareIndexes(tt,_e){return tt.length===_e.length&&tt.slice(0,-1).every((it,nt)=>it===_e[nt])?tt[tt.length-1]-_e[_e.length-1]:0}function matchRouteBranch(tt,_e){let{routesMeta:rt}=tt,it={},nt="/",st=[];for(let at=0;at<rt.length;++at){let lt=rt[at],ot=at===rt.length-1,ct=nt==="/"?_e:_e.slice(nt.length)||"/",ut=matchPath({path:lt.relativePath,caseSensitive:lt.caseSensitive,end:ot},ct);if(!ut)return null;Object.assign(it,ut.params);let ht=lt.route;st.push({params:it,pathname:joinPaths([nt,ut.pathname]),pathnameBase:normalizePathname(joinPaths([nt,ut.pathnameBase])),route:ht}),ut.pathnameBase!=="/"&&(nt=joinPaths([nt,ut.pathnameBase]))}return st}function matchPath(tt,_e){typeof tt=="string"&&(tt={path:tt,caseSensitive:!1,end:!0});let[rt,it]=compilePath(tt.path,tt.caseSensitive,tt.end),nt=_e.match(rt);if(!nt)return null;let st=nt[0],at=st.replace(/(.)\/+$/,"$1"),lt=nt.slice(1);return{params:it.reduce((ct,ut,ht)=>{if(ut==="*"){let dt=lt[ht]||"";at=st.slice(0,st.length-dt.length).replace(/(.)\/+$/,"$1")}return ct[ut]=safelyDecodeURIComponent(lt[ht]||"",ut),ct},{}),pathname:st,pathnameBase:at,pattern:tt}}function compilePath(tt,_e,rt){_e===void 0&&(_e=!1),rt===void 0&&(rt=!0),warning(tt==="*"||!tt.endsWith("*")||tt.endsWith("/*"),'Route path "'+tt+'" will be treated as if it were '+('"'+tt.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+tt.replace(/\*$/,"/*")+'".'));let it=[],nt="^"+tt.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(at,lt)=>(it.push(lt),"/([^\\/]+)"));return tt.endsWith("*")?(it.push("*"),nt+=tt==="*"||tt==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):rt?nt+="\\/*$":tt!==""&&tt!=="/"&&(nt+="(?:(?=\\/|$))"),[new RegExp(nt,_e?void 0:"i"),it]}function safelyDecodeURI(tt){try{return decodeURI(tt)}catch(_e){return warning(!1,'The URL path "'+tt+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+_e+").")),tt}}function safelyDecodeURIComponent(tt,_e){try{return decodeURIComponent(tt)}catch(rt){return warning(!1,'The value for the URL param "'+_e+'" will not be decoded because'+(' the string "'+tt+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+rt+").")),tt}}function stripBasename(tt,_e){if(_e==="/")return tt;if(!tt.toLowerCase().startsWith(_e.toLowerCase()))return null;let rt=_e.endsWith("/")?_e.length-1:_e.length,it=tt.charAt(rt);return it&&it!=="/"?null:tt.slice(rt)||"/"}const joinPaths=tt=>tt.join("/").replace(/\/\/+/g,"/"),normalizePathname=tt=>tt.replace(/\/+$/,"").replace(/^\/*/,"/");function isRouteErrorResponse(tt){return tt!=null&&typeof tt.status=="number"&&typeof tt.statusText=="string"&&typeof tt.internal=="boolean"&&"data"in tt}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var it in rt)Object.prototype.hasOwnProperty.call(rt,it)&&(tt[it]=rt[it])}return tt},_extends$2.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useParams(){let{matches:tt}=reactExports.useContext(RouteContext),_e=tt[tt.length-1];return _e?_e.params:{}}function useRoutes(tt,_e){return useRoutesImpl(tt,_e)}function useRoutesImpl(tt,_e,rt){useInRouterContext()||invariant(!1);let{navigator:it}=reactExports.useContext(NavigationContext),{matches:nt}=reactExports.useContext(RouteContext),st=nt[nt.length-1],at=st?st.params:{};st&&st.pathname;let lt=st?st.pathnameBase:"/";st&&st.route;let ot=useLocation(),ct;if(_e){var ut;let gt=typeof _e=="string"?parsePath(_e):_e;lt==="/"||(ut=gt.pathname)!=null&&ut.startsWith(lt)||invariant(!1),ct=gt}else ct=ot;let ht=ct.pathname||"/",dt=lt==="/"?ht:ht.slice(lt.length)||"/",pt=matchRoutes(tt,{pathname:dt}),ft=_renderMatches(pt&&pt.map(gt=>Object.assign({},gt,{params:Object.assign({},at,gt.params),pathname:joinPaths([lt,it.encodeLocation?it.encodeLocation(gt.pathname).pathname:gt.pathname]),pathnameBase:gt.pathnameBase==="/"?lt:joinPaths([lt,it.encodeLocation?it.encodeLocation(gt.pathnameBase).pathname:gt.pathnameBase])})),nt,rt);return _e&&ft?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$2({pathname:"/",search:"",hash:"",state:null,key:"default"},ct),navigationType:Action.Pop}},ft):ft}function DefaultErrorComponent(){let tt=useRouteError(),_e=isRouteErrorResponse(tt)?tt.status+" "+tt.statusText:tt instanceof Error?tt.message:JSON.stringify(tt),rt=tt instanceof Error?tt.stack:null,nt={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},st=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},_e),rt?reactExports.createElement("pre",{style:nt},rt):null,st)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(_e){super(_e),this.state={location:_e.location,revalidation:_e.revalidation,error:_e.error}}static getDerivedStateFromError(_e){return{error:_e}}static getDerivedStateFromProps(_e,rt){return rt.location!==_e.location||rt.revalidation!=="idle"&&_e.revalidation==="idle"?{error:_e.error,location:_e.location,revalidation:_e.revalidation}:{error:_e.error||rt.error,location:rt.location,revalidation:_e.revalidation||rt.revalidation}}componentDidCatch(_e,rt){console.error("React Router caught the following error during render",_e,rt)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(tt){let{routeContext:_e,match:rt,children:it}=tt,nt=reactExports.useContext(DataRouterContext);return nt&&nt.static&&nt.staticContext&&(rt.route.errorElement||rt.route.ErrorBoundary)&&(nt.staticContext._deepestRenderedBoundaryId=rt.route.id),reactExports.createElement(RouteContext.Provider,{value:_e},it)}function _renderMatches(tt,_e,rt){var it;if(_e===void 0&&(_e=[]),rt===void 0&&(rt=null),tt==null){var nt;if((nt=rt)!=null&&nt.errors)tt=rt.matches;else return null}let st=tt,at=(it=rt)==null?void 0:it.errors;if(at!=null){let lt=st.findIndex(ot=>ot.route.id&&(at==null?void 0:at[ot.route.id]));lt>=0||invariant(!1),st=st.slice(0,Math.min(st.length,lt+1))}return st.reduceRight((lt,ot,ct)=>{let ut=ot.route.id?at==null?void 0:at[ot.route.id]:null,ht=null;rt&&(ht=ot.route.errorElement||defaultErrorElement);let dt=_e.concat(st.slice(0,ct+1)),pt=()=>{let ft;return ut?ft=ht:ot.route.Component?ft=reactExports.createElement(ot.route.Component,null):ot.route.element?ft=ot.route.element:ft=lt,reactExports.createElement(RenderedRoute,{match:ot,routeContext:{outlet:lt,matches:dt,isDataRoute:rt!=null},children:ft})};return rt&&(ot.route.ErrorBoundary||ot.route.errorElement||ct===0)?reactExports.createElement(RenderErrorBoundary,{location:rt.location,revalidation:rt.revalidation,component:ht,error:ut,children:pt(),routeContext:{outlet:null,matches:dt,isDataRoute:!0}}):pt()},null)}var DataRouterStateHook$1=function(tt){return tt.UseBlocker="useBlocker",tt.UseLoaderData="useLoaderData",tt.UseActionData="useActionData",tt.UseRouteError="useRouteError",tt.UseNavigation="useNavigation",tt.UseRouteLoaderData="useRouteLoaderData",tt.UseMatches="useMatches",tt.UseRevalidator="useRevalidator",tt.UseNavigateStable="useNavigate",tt.UseRouteId="useRouteId",tt}(DataRouterStateHook$1||{});function useDataRouterState(tt){let _e=reactExports.useContext(DataRouterStateContext);return _e||invariant(!1),_e}function useRouteContext(tt){let _e=reactExports.useContext(RouteContext);return _e||invariant(!1),_e}function useCurrentRouteId(tt){let _e=useRouteContext(),rt=_e.matches[_e.matches.length-1];return rt.route.id||invariant(!1),rt.route.id}function useRouteError(){var tt;let _e=reactExports.useContext(RouteErrorContext),rt=useDataRouterState(DataRouterStateHook$1.UseRouteError),it=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return _e||((tt=rt.errors)==null?void 0:tt[it])}function Route(tt){invariant(!1)}function Router(tt){let{basename:_e="/",children:rt=null,location:it,navigationType:nt=Action.Pop,navigator:st,static:at=!1}=tt;useInRouterContext()&&invariant(!1);let lt=_e.replace(/^\/*/,"/"),ot=reactExports.useMemo(()=>({basename:lt,navigator:st,static:at}),[lt,st,at]);typeof it=="string"&&(it=parsePath(it));let{pathname:ct="/",search:ut="",hash:ht="",state:dt=null,key:pt="default"}=it,ft=reactExports.useMemo(()=>{let gt=stripBasename(ct,lt);return gt==null?null:{location:{pathname:gt,search:ut,hash:ht,state:dt,key:pt},navigationType:nt}},[lt,ct,ut,ht,dt,pt,nt]);return ft==null?null:reactExports.createElement(NavigationContext.Provider,{value:ot},reactExports.createElement(LocationContext.Provider,{children:rt,value:ft}))}function Routes(tt){let{children:_e,location:rt}=tt;return useRoutes(createRoutesFromChildren(_e),rt)}new Promise(()=>{});function createRoutesFromChildren(tt,_e){_e===void 0&&(_e=[]);let rt=[];return reactExports.Children.forEach(tt,(it,nt)=>{if(!reactExports.isValidElement(it))return;let st=[..._e,nt];if(it.type===reactExports.Fragment){rt.push.apply(rt,createRoutesFromChildren(it.props.children,st));return}it.type!==Route&&invariant(!1),!it.props.index||!it.props.children||invariant(!1);let at={id:it.props.id||st.join("-"),caseSensitive:it.props.caseSensitive,element:it.props.element,Component:it.props.Component,index:it.props.index,path:it.props.path,loader:it.props.loader,action:it.props.action,errorElement:it.props.errorElement,ErrorBoundary:it.props.ErrorBoundary,hasErrorBoundary:it.props.ErrorBoundary!=null||it.props.errorElement!=null,shouldRevalidate:it.props.shouldRevalidate,handle:it.props.handle,lazy:it.props.lazy};it.props.children&&(at.children=createRoutesFromChildren(it.props.children,st)),rt.push(at)}),rt}/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const START_TRANSITION="startTransition",startTransitionImpl=t$5[START_TRANSITION];function BrowserRouter(tt){let{basename:_e,children:rt,future:it,window:nt}=tt,st=reactExports.useRef();st.current==null&&(st.current=createBrowserHistory({window:nt,v5Compat:!0}));let at=st.current,[lt,ot]=reactExports.useState({action:at.action,location:at.location}),{v7_startTransition:ct}=it||{},ut=reactExports.useCallback(ht=>{ct&&startTransitionImpl?startTransitionImpl(()=>ot(ht)):ot(ht)},[ot,ct]);return reactExports.useLayoutEffect(()=>at.listen(ut),[at,ut]),reactExports.createElement(Router,{basename:_e,children:rt,location:lt.location,navigationType:lt.action,navigator:at})}var DataRouterHook;(function(tt){tt.UseScrollRestoration="useScrollRestoration",tt.UseSubmit="useSubmit",tt.UseSubmitFetcher="useSubmitFetcher",tt.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(tt){tt.UseFetchers="useFetchers",tt.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var it in rt)Object.prototype.hasOwnProperty.call(rt,it)&&(tt[it]=rt[it])}return tt},_extends$1.apply(this,arguments)}var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function tt(it,nt,st,at,lt,ot){if(ot!==ReactPropTypesSecret){var ct=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw ct.name="Invariant Violation",ct}}tt.isRequired=tt;function _e(){return tt}var rt={array:tt,bigint:tt,bool:tt,func:tt,number:tt,object:tt,string:tt,symbol:tt,any:tt,arrayOf:_e,element:tt,elementType:tt,instanceOf:_e,node:tt,objectOf:_e,oneOf:_e,oneOfType:_e,shape:_e,exact:_e,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return rt.PropTypes=rt,rt};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="154",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,TwoPassDoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,AlphaFormat=1021,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding=3e3,sRGBEncoding=3001,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",_SRGBAFormat=1035,WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(_e,rt){this._listeners===void 0&&(this._listeners={});const it=this._listeners;it[_e]===void 0&&(it[_e]=[]),it[_e].indexOf(rt)===-1&&it[_e].push(rt)}hasEventListener(_e,rt){if(this._listeners===void 0)return!1;const it=this._listeners;return it[_e]!==void 0&&it[_e].indexOf(rt)!==-1}removeEventListener(_e,rt){if(this._listeners===void 0)return;const nt=this._listeners[_e];if(nt!==void 0){const st=nt.indexOf(rt);st!==-1&&nt.splice(st,1)}}dispatchEvent(_e){if(this._listeners===void 0)return;const it=this._listeners[_e.type];if(it!==void 0){_e.target=this;const nt=it.slice(0);for(let st=0,at=nt.length;st<at;st++)nt[st].call(this,_e);_e.target=null}}}const _lut$1=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID$1(){const tt=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,rt=Math.random()*4294967295|0,it=Math.random()*4294967295|0;return(_lut$1[tt&255]+_lut$1[tt>>8&255]+_lut$1[tt>>16&255]+_lut$1[tt>>24&255]+"-"+_lut$1[_e&255]+_lut$1[_e>>8&255]+"-"+_lut$1[_e>>16&15|64]+_lut$1[_e>>24&255]+"-"+_lut$1[rt&63|128]+_lut$1[rt>>8&255]+"-"+_lut$1[rt>>16&255]+_lut$1[rt>>24&255]+_lut$1[it&255]+_lut$1[it>>8&255]+_lut$1[it>>16&255]+_lut$1[it>>24&255]).toLowerCase()}function clamp$2(tt,_e,rt){return Math.max(_e,Math.min(rt,tt))}function euclideanModulo(tt,_e){return(tt%_e+_e)%_e}function mapLinear(tt,_e,rt,it,nt){return it+(tt-_e)*(nt-it)/(rt-_e)}function inverseLerp(tt,_e,rt){return tt!==_e?(rt-tt)/(_e-tt):0}function lerp(tt,_e,rt){return(1-rt)*tt+rt*_e}function damp(tt,_e,rt,it){return lerp(tt,_e,1-Math.exp(-rt*it))}function pingpong(tt,_e=1){return _e-Math.abs(euclideanModulo(tt,_e*2)-_e)}function smoothstep(tt,_e,rt){return tt<=_e?0:tt>=rt?1:(tt=(tt-_e)/(rt-_e),tt*tt*(3-2*tt))}function smootherstep(tt,_e,rt){return tt<=_e?0:tt>=rt?1:(tt=(tt-_e)/(rt-_e),tt*tt*tt*(tt*(tt*6-15)+10))}function randInt(tt,_e){return tt+Math.floor(Math.random()*(_e-tt+1))}function randFloat(tt,_e){return tt+Math.random()*(_e-tt)}function randFloatSpread(tt){return tt*(.5-Math.random())}function seededRandom(tt){tt!==void 0&&(_seed=tt);let _e=_seed+=1831565813;return _e=Math.imul(_e^_e>>>15,_e|1),_e^=_e+Math.imul(_e^_e>>>7,_e|61),((_e^_e>>>14)>>>0)/4294967296}function degToRad(tt){return tt*DEG2RAD}function radToDeg(tt){return tt*RAD2DEG}function isPowerOfTwo(tt){return(tt&tt-1)===0&&tt!==0}function ceilPowerOfTwo(tt){return Math.pow(2,Math.ceil(Math.log(tt)/Math.LN2))}function floorPowerOfTwo(tt){return Math.pow(2,Math.floor(Math.log(tt)/Math.LN2))}function setQuaternionFromProperEuler(tt,_e,rt,it,nt){const st=Math.cos,at=Math.sin,lt=st(rt/2),ot=at(rt/2),ct=st((_e+it)/2),ut=at((_e+it)/2),ht=st((_e-it)/2),dt=at((_e-it)/2),pt=st((it-_e)/2),ft=at((it-_e)/2);switch(nt){case"XYX":tt.set(lt*ut,ot*ht,ot*dt,lt*ct);break;case"YZY":tt.set(ot*dt,lt*ut,ot*ht,lt*ct);break;case"ZXZ":tt.set(ot*ht,ot*dt,lt*ut,lt*ct);break;case"XZX":tt.set(lt*ut,ot*ft,ot*pt,lt*ct);break;case"YXY":tt.set(ot*pt,lt*ut,ot*ft,lt*ct);break;case"ZYZ":tt.set(ot*ft,ot*pt,lt*ut,lt*ct);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+nt)}}function denormalize(tt,_e){switch(_e.constructor){case Float32Array:return tt;case Uint32Array:return tt/4294967295;case Uint16Array:return tt/65535;case Uint8Array:return tt/255;case Int32Array:return Math.max(tt/2147483647,-1);case Int16Array:return Math.max(tt/32767,-1);case Int8Array:return Math.max(tt/127,-1);default:throw new Error("Invalid component type.")}}function normalize$5(tt,_e){switch(_e.constructor){case Float32Array:return tt;case Uint32Array:return Math.round(tt*4294967295);case Uint16Array:return Math.round(tt*65535);case Uint8Array:return Math.round(tt*255);case Int32Array:return Math.round(tt*2147483647);case Int16Array:return Math.round(tt*32767);case Int8Array:return Math.round(tt*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID:generateUUID$1,clamp:clamp$2,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize:normalize$5,denormalize};class Vector2{constructor(_e=0,rt=0){Vector2.prototype.isVector2=!0,this.x=_e,this.y=rt}get width(){return this.x}set width(_e){this.x=_e}get height(){return this.y}set height(_e){this.y=_e}set(_e,rt){return this.x=_e,this.y=rt,this}setScalar(_e){return this.x=_e,this.y=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setComponent(_e,rt){switch(_e){case 0:this.x=rt;break;case 1:this.y=rt;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y)}copy(_e){return this.x=_e.x,this.y=_e.y,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this}addScalar(_e){return this.x+=_e,this.y+=_e,this}addVectors(_e,rt){return this.x=_e.x+rt.x,this.y=_e.y+rt.y,this}addScaledVector(_e,rt){return this.x+=_e.x*rt,this.y+=_e.y*rt,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this}subScalar(_e){return this.x-=_e,this.y-=_e,this}subVectors(_e,rt){return this.x=_e.x-rt.x,this.y=_e.y-rt.y,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this}divide(_e){return this.x/=_e.x,this.y/=_e.y,this}divideScalar(_e){return this.multiplyScalar(1/_e)}applyMatrix3(_e){const rt=this.x,it=this.y,nt=_e.elements;return this.x=nt[0]*rt+nt[3]*it+nt[6],this.y=nt[1]*rt+nt[4]*it+nt[7],this}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this}clamp(_e,rt){return this.x=Math.max(_e.x,Math.min(rt.x,this.x)),this.y=Math.max(_e.y,Math.min(rt.y,this.y)),this}clampScalar(_e,rt){return this.x=Math.max(_e,Math.min(rt,this.x)),this.y=Math.max(_e,Math.min(rt,this.y)),this}clampLength(_e,rt){const it=this.length();return this.divideScalar(it||1).multiplyScalar(Math.max(_e,Math.min(rt,it)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_e){return this.x*_e.x+this.y*_e.y}cross(_e){return this.x*_e.y-this.y*_e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_e){const rt=Math.sqrt(this.lengthSq()*_e.lengthSq());if(rt===0)return Math.PI/2;const it=this.dot(_e)/rt;return Math.acos(clamp$2(it,-1,1))}distanceTo(_e){return Math.sqrt(this.distanceToSquared(_e))}distanceToSquared(_e){const rt=this.x-_e.x,it=this.y-_e.y;return rt*rt+it*it}manhattanDistanceTo(_e){return Math.abs(this.x-_e.x)+Math.abs(this.y-_e.y)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,rt){return this.x+=(_e.x-this.x)*rt,this.y+=(_e.y-this.y)*rt,this}lerpVectors(_e,rt,it){return this.x=_e.x+(rt.x-_e.x)*it,this.y=_e.y+(rt.y-_e.y)*it,this}equals(_e){return _e.x===this.x&&_e.y===this.y}fromArray(_e,rt=0){return this.x=_e[rt],this.y=_e[rt+1],this}toArray(_e=[],rt=0){return _e[rt]=this.x,_e[rt+1]=this.y,_e}fromBufferAttribute(_e,rt){return this.x=_e.getX(rt),this.y=_e.getY(rt),this}rotateAround(_e,rt){const it=Math.cos(rt),nt=Math.sin(rt),st=this.x-_e.x,at=this.y-_e.y;return this.x=st*it-at*nt+_e.x,this.y=st*nt+at*it+_e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(_e,rt,it,nt,st,at,lt,ot,ct){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_e!==void 0&&this.set(_e,rt,it,nt,st,at,lt,ot,ct)}set(_e,rt,it,nt,st,at,lt,ot,ct){const ut=this.elements;return ut[0]=_e,ut[1]=nt,ut[2]=lt,ut[3]=rt,ut[4]=st,ut[5]=ot,ut[6]=it,ut[7]=at,ut[8]=ct,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_e){const rt=this.elements,it=_e.elements;return rt[0]=it[0],rt[1]=it[1],rt[2]=it[2],rt[3]=it[3],rt[4]=it[4],rt[5]=it[5],rt[6]=it[6],rt[7]=it[7],rt[8]=it[8],this}extractBasis(_e,rt,it){return _e.setFromMatrix3Column(this,0),rt.setFromMatrix3Column(this,1),it.setFromMatrix3Column(this,2),this}setFromMatrix4(_e){const rt=_e.elements;return this.set(rt[0],rt[4],rt[8],rt[1],rt[5],rt[9],rt[2],rt[6],rt[10]),this}multiply(_e){return this.multiplyMatrices(this,_e)}premultiply(_e){return this.multiplyMatrices(_e,this)}multiplyMatrices(_e,rt){const it=_e.elements,nt=rt.elements,st=this.elements,at=it[0],lt=it[3],ot=it[6],ct=it[1],ut=it[4],ht=it[7],dt=it[2],pt=it[5],ft=it[8],gt=nt[0],mt=nt[3],At=nt[6],yt=nt[1],bt=nt[4],xt=nt[7],vt=nt[2],_t=nt[5],Ct=nt[8];return st[0]=at*gt+lt*yt+ot*vt,st[3]=at*mt+lt*bt+ot*_t,st[6]=at*At+lt*xt+ot*Ct,st[1]=ct*gt+ut*yt+ht*vt,st[4]=ct*mt+ut*bt+ht*_t,st[7]=ct*At+ut*xt+ht*Ct,st[2]=dt*gt+pt*yt+ft*vt,st[5]=dt*mt+pt*bt+ft*_t,st[8]=dt*At+pt*xt+ft*Ct,this}multiplyScalar(_e){const rt=this.elements;return rt[0]*=_e,rt[3]*=_e,rt[6]*=_e,rt[1]*=_e,rt[4]*=_e,rt[7]*=_e,rt[2]*=_e,rt[5]*=_e,rt[8]*=_e,this}determinant(){const _e=this.elements,rt=_e[0],it=_e[1],nt=_e[2],st=_e[3],at=_e[4],lt=_e[5],ot=_e[6],ct=_e[7],ut=_e[8];return rt*at*ut-rt*lt*ct-it*st*ut+it*lt*ot+nt*st*ct-nt*at*ot}invert(){const _e=this.elements,rt=_e[0],it=_e[1],nt=_e[2],st=_e[3],at=_e[4],lt=_e[5],ot=_e[6],ct=_e[7],ut=_e[8],ht=ut*at-lt*ct,dt=lt*ot-ut*st,pt=ct*st-at*ot,ft=rt*ht+it*dt+nt*pt;if(ft===0)return this.set(0,0,0,0,0,0,0,0,0);const gt=1/ft;return _e[0]=ht*gt,_e[1]=(nt*ct-ut*it)*gt,_e[2]=(lt*it-nt*at)*gt,_e[3]=dt*gt,_e[4]=(ut*rt-nt*ot)*gt,_e[5]=(nt*st-lt*rt)*gt,_e[6]=pt*gt,_e[7]=(it*ot-ct*rt)*gt,_e[8]=(at*rt-it*st)*gt,this}transpose(){let _e;const rt=this.elements;return _e=rt[1],rt[1]=rt[3],rt[3]=_e,_e=rt[2],rt[2]=rt[6],rt[6]=_e,_e=rt[5],rt[5]=rt[7],rt[7]=_e,this}getNormalMatrix(_e){return this.setFromMatrix4(_e).invert().transpose()}transposeIntoArray(_e){const rt=this.elements;return _e[0]=rt[0],_e[1]=rt[3],_e[2]=rt[6],_e[3]=rt[1],_e[4]=rt[4],_e[5]=rt[7],_e[6]=rt[2],_e[7]=rt[5],_e[8]=rt[8],this}setUvTransform(_e,rt,it,nt,st,at,lt){const ot=Math.cos(st),ct=Math.sin(st);return this.set(it*ot,it*ct,-it*(ot*at+ct*lt)+at+_e,-nt*ct,nt*ot,-nt*(-ct*at+ot*lt)+lt+rt,0,0,1),this}scale(_e,rt){return this.premultiply(_m3.makeScale(_e,rt)),this}rotate(_e){return this.premultiply(_m3.makeRotation(-_e)),this}translate(_e,rt){return this.premultiply(_m3.makeTranslation(_e,rt)),this}makeTranslation(_e,rt){return _e.isVector2?this.set(1,0,_e.x,0,1,_e.y,0,0,1):this.set(1,0,_e,0,1,rt,0,0,1),this}makeRotation(_e){const rt=Math.cos(_e),it=Math.sin(_e);return this.set(rt,-it,0,it,rt,0,0,0,1),this}makeScale(_e,rt){return this.set(_e,0,0,0,rt,0,0,0,1),this}equals(_e){const rt=this.elements,it=_e.elements;for(let nt=0;nt<9;nt++)if(rt[nt]!==it[nt])return!1;return!0}fromArray(_e,rt=0){for(let it=0;it<9;it++)this.elements[it]=_e[it+rt];return this}toArray(_e=[],rt=0){const it=this.elements;return _e[rt]=it[0],_e[rt+1]=it[1],_e[rt+2]=it[2],_e[rt+3]=it[3],_e[rt+4]=it[4],_e[rt+5]=it[5],_e[rt+6]=it[6],_e[rt+7]=it[7],_e[rt+8]=it[8],_e}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(tt){for(let _e=tt.length-1;_e>=0;--_e)if(tt[_e]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(tt,_e){return new TYPED_ARRAYS[tt](_e)}function createElementNS(tt){return document.createElementNS("http://www.w3.org/1999/xhtml",tt)}const _cache={};function warnOnce(tt){tt in _cache||(_cache[tt]=!0,console.warn(tt))}function SRGBToLinear(tt){return tt<.04045?tt*.0773993808:Math.pow(tt*.9478672986+.0521327014,2.4)}function LinearToSRGB(tt){return tt<.0031308?tt*12.92:1.055*Math.pow(tt,.41666)-.055}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function DisplayP3ToLinearSRGB(tt){return tt.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB)}function LinearSRGBToDisplayP3(tt){return tt.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}const TO_LINEAR={[LinearSRGBColorSpace]:tt=>tt,[SRGBColorSpace]:tt=>tt.convertSRGBToLinear(),[DisplayP3ColorSpace]:DisplayP3ToLinearSRGB},FROM_LINEAR={[LinearSRGBColorSpace]:tt=>tt,[SRGBColorSpace]:tt=>tt.convertLinearToSRGB(),[DisplayP3ColorSpace]:LinearSRGBToDisplayP3},ColorManagement={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(tt){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!tt},get workingColorSpace(){return LinearSRGBColorSpace},set workingColorSpace(tt){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(tt,_e,rt){if(this.enabled===!1||_e===rt||!_e||!rt)return tt;const it=TO_LINEAR[_e],nt=FROM_LINEAR[rt];if(it===void 0||nt===void 0)throw new Error(`Unsupported color space conversion, "${_e}" to "${rt}".`);return nt(it(tt))},fromWorkingColorSpace:function(tt,_e){return this.convert(tt,this.workingColorSpace,_e)},toWorkingColorSpace:function(tt,_e){return this.convert(tt,_e,this.workingColorSpace)}};let _canvas;class ImageUtils{static getDataURL(_e){if(/^data:/i.test(_e.src)||typeof HTMLCanvasElement>"u")return _e.src;let rt;if(_e instanceof HTMLCanvasElement)rt=_e;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_e.width,_canvas.height=_e.height;const it=_canvas.getContext("2d");_e instanceof ImageData?it.putImageData(_e,0,0):it.drawImage(_e,0,0,_e.width,_e.height),rt=_canvas}return rt.width>2048||rt.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_e),rt.toDataURL("image/jpeg",.6)):rt.toDataURL("image/png")}static sRGBToLinear(_e){if(typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_e instanceof ImageBitmap){const rt=createElementNS("canvas");rt.width=_e.width,rt.height=_e.height;const it=rt.getContext("2d");it.drawImage(_e,0,0,_e.width,_e.height);const nt=it.getImageData(0,0,_e.width,_e.height),st=nt.data;for(let at=0;at<st.length;at++)st[at]=SRGBToLinear(st[at]/255)*255;return it.putImageData(nt,0,0),rt}else if(_e.data){const rt=_e.data.slice(0);for(let it=0;it<rt.length;it++)rt instanceof Uint8Array||rt instanceof Uint8ClampedArray?rt[it]=Math.floor(SRGBToLinear(rt[it]/255)*255):rt[it]=SRGBToLinear(rt[it]);return{data:rt,width:_e.width,height:_e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_e}}let sourceId=0;class Source{constructor(_e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:sourceId++}),this.uuid=generateUUID$1(),this.data=_e,this.version=0}set needsUpdate(_e){_e===!0&&this.version++}toJSON(_e){const rt=_e===void 0||typeof _e=="string";if(!rt&&_e.images[this.uuid]!==void 0)return _e.images[this.uuid];const it={uuid:this.uuid,url:""},nt=this.data;if(nt!==null){let st;if(Array.isArray(nt)){st=[];for(let at=0,lt=nt.length;at<lt;at++)nt[at].isDataTexture?st.push(serializeImage(nt[at].image)):st.push(serializeImage(nt[at]))}else st=serializeImage(nt);it.url=st}return rt||(_e.images[this.uuid]=it),it}}function serializeImage(tt){return typeof HTMLImageElement<"u"&&tt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&tt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&tt instanceof ImageBitmap?ImageUtils.getDataURL(tt):tt.data?{data:Array.from(tt.data),width:tt.width,height:tt.height,type:tt.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let textureId=0;class Texture extends EventDispatcher{constructor(_e=Texture.DEFAULT_IMAGE,rt=Texture.DEFAULT_MAPPING,it=ClampToEdgeWrapping,nt=ClampToEdgeWrapping,st=LinearFilter,at=LinearMipmapLinearFilter,lt=RGBAFormat,ot=UnsignedByteType,ct=Texture.DEFAULT_ANISOTROPY,ut=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:textureId++}),this.uuid=generateUUID$1(),this.name="",this.source=new Source(_e),this.mipmaps=[],this.mapping=rt,this.channel=0,this.wrapS=it,this.wrapT=nt,this.magFilter=st,this.minFilter=at,this.anisotropy=ct,this.format=lt,this.internalFormat=null,this.type=ot,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof ut=="string"?this.colorSpace=ut:(warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=ut===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(_e=null){this.source.data=_e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_e){return this.name=_e.name,this.source=_e.source,this.mipmaps=_e.mipmaps.slice(0),this.mapping=_e.mapping,this.channel=_e.channel,this.wrapS=_e.wrapS,this.wrapT=_e.wrapT,this.magFilter=_e.magFilter,this.minFilter=_e.minFilter,this.anisotropy=_e.anisotropy,this.format=_e.format,this.internalFormat=_e.internalFormat,this.type=_e.type,this.offset.copy(_e.offset),this.repeat.copy(_e.repeat),this.center.copy(_e.center),this.rotation=_e.rotation,this.matrixAutoUpdate=_e.matrixAutoUpdate,this.matrix.copy(_e.matrix),this.generateMipmaps=_e.generateMipmaps,this.premultiplyAlpha=_e.premultiplyAlpha,this.flipY=_e.flipY,this.unpackAlignment=_e.unpackAlignment,this.colorSpace=_e.colorSpace,this.userData=JSON.parse(JSON.stringify(_e.userData)),this.needsUpdate=!0,this}toJSON(_e){const rt=_e===void 0||typeof _e=="string";if(!rt&&_e.textures[this.uuid]!==void 0)return _e.textures[this.uuid];const it={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(it.userData=this.userData),rt||(_e.textures[this.uuid]=it),it}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_e){if(this.mapping!==UVMapping)return _e;if(_e.applyMatrix3(this.matrix),_e.x<0||_e.x>1)switch(this.wrapS){case RepeatWrapping:_e.x=_e.x-Math.floor(_e.x);break;case ClampToEdgeWrapping:_e.x=_e.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_e.x)%2)===1?_e.x=Math.ceil(_e.x)-_e.x:_e.x=_e.x-Math.floor(_e.x);break}if(_e.y<0||_e.y>1)switch(this.wrapT){case RepeatWrapping:_e.y=_e.y-Math.floor(_e.y);break;case ClampToEdgeWrapping:_e.y=_e.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_e.y)%2)===1?_e.y=Math.ceil(_e.y)-_e.y:_e.y=_e.y-Math.floor(_e.y);break}return this.flipY&&(_e.y=1-_e.y),_e}set needsUpdate(_e){_e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set encoding(_e){warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=_e===sRGBEncoding?SRGBColorSpace:NoColorSpace}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_e=0,rt=0,it=0,nt=1){Vector4.prototype.isVector4=!0,this.x=_e,this.y=rt,this.z=it,this.w=nt}get width(){return this.z}set width(_e){this.z=_e}get height(){return this.w}set height(_e){this.w=_e}set(_e,rt,it,nt){return this.x=_e,this.y=rt,this.z=it,this.w=nt,this}setScalar(_e){return this.x=_e,this.y=_e,this.z=_e,this.w=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setZ(_e){return this.z=_e,this}setW(_e){return this.w=_e,this}setComponent(_e,rt){switch(_e){case 0:this.x=rt;break;case 1:this.y=rt;break;case 2:this.z=rt;break;case 3:this.w=rt;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_e){return this.x=_e.x,this.y=_e.y,this.z=_e.z,this.w=_e.w!==void 0?_e.w:1,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this.z+=_e.z,this.w+=_e.w,this}addScalar(_e){return this.x+=_e,this.y+=_e,this.z+=_e,this.w+=_e,this}addVectors(_e,rt){return this.x=_e.x+rt.x,this.y=_e.y+rt.y,this.z=_e.z+rt.z,this.w=_e.w+rt.w,this}addScaledVector(_e,rt){return this.x+=_e.x*rt,this.y+=_e.y*rt,this.z+=_e.z*rt,this.w+=_e.w*rt,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this.z-=_e.z,this.w-=_e.w,this}subScalar(_e){return this.x-=_e,this.y-=_e,this.z-=_e,this.w-=_e,this}subVectors(_e,rt){return this.x=_e.x-rt.x,this.y=_e.y-rt.y,this.z=_e.z-rt.z,this.w=_e.w-rt.w,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this.z*=_e.z,this.w*=_e.w,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this.z*=_e,this.w*=_e,this}applyMatrix4(_e){const rt=this.x,it=this.y,nt=this.z,st=this.w,at=_e.elements;return this.x=at[0]*rt+at[4]*it+at[8]*nt+at[12]*st,this.y=at[1]*rt+at[5]*it+at[9]*nt+at[13]*st,this.z=at[2]*rt+at[6]*it+at[10]*nt+at[14]*st,this.w=at[3]*rt+at[7]*it+at[11]*nt+at[15]*st,this}divideScalar(_e){return this.multiplyScalar(1/_e)}setAxisAngleFromQuaternion(_e){this.w=2*Math.acos(_e.w);const rt=Math.sqrt(1-_e.w*_e.w);return rt<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_e.x/rt,this.y=_e.y/rt,this.z=_e.z/rt),this}setAxisAngleFromRotationMatrix(_e){let rt,it,nt,st;const ot=_e.elements,ct=ot[0],ut=ot[4],ht=ot[8],dt=ot[1],pt=ot[5],ft=ot[9],gt=ot[2],mt=ot[6],At=ot[10];if(Math.abs(ut-dt)<.01&&Math.abs(ht-gt)<.01&&Math.abs(ft-mt)<.01){if(Math.abs(ut+dt)<.1&&Math.abs(ht+gt)<.1&&Math.abs(ft+mt)<.1&&Math.abs(ct+pt+At-3)<.1)return this.set(1,0,0,0),this;rt=Math.PI;const bt=(ct+1)/2,xt=(pt+1)/2,vt=(At+1)/2,_t=(ut+dt)/4,Ct=(ht+gt)/4,St=(ft+mt)/4;return bt>xt&&bt>vt?bt<.01?(it=0,nt=.707106781,st=.707106781):(it=Math.sqrt(bt),nt=_t/it,st=Ct/it):xt>vt?xt<.01?(it=.707106781,nt=0,st=.707106781):(nt=Math.sqrt(xt),it=_t/nt,st=St/nt):vt<.01?(it=.707106781,nt=.707106781,st=0):(st=Math.sqrt(vt),it=Ct/st,nt=St/st),this.set(it,nt,st,rt),this}let yt=Math.sqrt((mt-ft)*(mt-ft)+(ht-gt)*(ht-gt)+(dt-ut)*(dt-ut));return Math.abs(yt)<.001&&(yt=1),this.x=(mt-ft)/yt,this.y=(ht-gt)/yt,this.z=(dt-ut)/yt,this.w=Math.acos((ct+pt+At-1)/2),this}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this.z=Math.min(this.z,_e.z),this.w=Math.min(this.w,_e.w),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this.z=Math.max(this.z,_e.z),this.w=Math.max(this.w,_e.w),this}clamp(_e,rt){return this.x=Math.max(_e.x,Math.min(rt.x,this.x)),this.y=Math.max(_e.y,Math.min(rt.y,this.y)),this.z=Math.max(_e.z,Math.min(rt.z,this.z)),this.w=Math.max(_e.w,Math.min(rt.w,this.w)),this}clampScalar(_e,rt){return this.x=Math.max(_e,Math.min(rt,this.x)),this.y=Math.max(_e,Math.min(rt,this.y)),this.z=Math.max(_e,Math.min(rt,this.z)),this.w=Math.max(_e,Math.min(rt,this.w)),this}clampLength(_e,rt){const it=this.length();return this.divideScalar(it||1).multiplyScalar(Math.max(_e,Math.min(rt,it)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_e){return this.x*_e.x+this.y*_e.y+this.z*_e.z+this.w*_e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,rt){return this.x+=(_e.x-this.x)*rt,this.y+=(_e.y-this.y)*rt,this.z+=(_e.z-this.z)*rt,this.w+=(_e.w-this.w)*rt,this}lerpVectors(_e,rt,it){return this.x=_e.x+(rt.x-_e.x)*it,this.y=_e.y+(rt.y-_e.y)*it,this.z=_e.z+(rt.z-_e.z)*it,this.w=_e.w+(rt.w-_e.w)*it,this}equals(_e){return _e.x===this.x&&_e.y===this.y&&_e.z===this.z&&_e.w===this.w}fromArray(_e,rt=0){return this.x=_e[rt],this.y=_e[rt+1],this.z=_e[rt+2],this.w=_e[rt+3],this}toArray(_e=[],rt=0){return _e[rt]=this.x,_e[rt+1]=this.y,_e[rt+2]=this.z,_e[rt+3]=this.w,_e}fromBufferAttribute(_e,rt){return this.x=_e.getX(rt),this.y=_e.getY(rt),this.z=_e.getZ(rt),this.w=_e.getW(rt),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class WebGLRenderTarget extends EventDispatcher{constructor(_e=1,rt=1,it={}){super(),this.isWebGLRenderTarget=!0,this.width=_e,this.height=rt,this.depth=1,this.scissor=new Vector4(0,0,_e,rt),this.scissorTest=!1,this.viewport=new Vector4(0,0,_e,rt);const nt={width:_e,height:rt,depth:1};it.encoding!==void 0&&(warnOnce("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),it.colorSpace=it.encoding===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.texture=new Texture(nt,it.mapping,it.wrapS,it.wrapT,it.magFilter,it.minFilter,it.format,it.type,it.anisotropy,it.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=it.generateMipmaps!==void 0?it.generateMipmaps:!1,this.texture.internalFormat=it.internalFormat!==void 0?it.internalFormat:null,this.texture.minFilter=it.minFilter!==void 0?it.minFilter:LinearFilter,this.depthBuffer=it.depthBuffer!==void 0?it.depthBuffer:!0,this.stencilBuffer=it.stencilBuffer!==void 0?it.stencilBuffer:!1,this.depthTexture=it.depthTexture!==void 0?it.depthTexture:null,this.samples=it.samples!==void 0?it.samples:0}setSize(_e,rt,it=1){(this.width!==_e||this.height!==rt||this.depth!==it)&&(this.width=_e,this.height=rt,this.depth=it,this.texture.image.width=_e,this.texture.image.height=rt,this.texture.image.depth=it,this.dispose()),this.viewport.set(0,0,_e,rt),this.scissor.set(0,0,_e,rt)}clone(){return new this.constructor().copy(this)}copy(_e){this.width=_e.width,this.height=_e.height,this.depth=_e.depth,this.scissor.copy(_e.scissor),this.scissorTest=_e.scissorTest,this.viewport.copy(_e.viewport),this.texture=_e.texture.clone(),this.texture.isRenderTargetTexture=!0;const rt=Object.assign({},_e.texture.image);return this.texture.source=new Source(rt),this.depthBuffer=_e.depthBuffer,this.stencilBuffer=_e.stencilBuffer,_e.depthTexture!==null&&(this.depthTexture=_e.depthTexture.clone()),this.samples=_e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class DataArrayTexture extends Texture{constructor(_e=null,rt=1,it=1,nt=1){super(null),this.isDataArrayTexture=!0,this.image={data:_e,width:rt,height:it,depth:nt},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(_e=1,rt=1,it=1){super(_e,rt),this.isWebGLArrayRenderTarget=!0,this.depth=it,this.texture=new DataArrayTexture(null,_e,rt,it),this.texture.isRenderTargetTexture=!0}}let Data3DTexture$1=class extends Texture{constructor(_e=null,rt=1,it=1,nt=1){super(null),this.isData3DTexture=!0,this.image={data:_e,width:rt,height:it,depth:nt},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(_e=1,rt=1,it=1){super(_e,rt),this.isWebGL3DRenderTarget=!0,this.depth=it,this.texture=new Data3DTexture$1(null,_e,rt,it),this.texture.isRenderTargetTexture=!0}}class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(_e=1,rt=1,it=1,nt={}){super(_e,rt,nt),this.isWebGLMultipleRenderTargets=!0;const st=this.texture;this.texture=[];for(let at=0;at<it;at++)this.texture[at]=st.clone(),this.texture[at].isRenderTargetTexture=!0}setSize(_e,rt,it=1){if(this.width!==_e||this.height!==rt||this.depth!==it){this.width=_e,this.height=rt,this.depth=it;for(let nt=0,st=this.texture.length;nt<st;nt++)this.texture[nt].image.width=_e,this.texture[nt].image.height=rt,this.texture[nt].image.depth=it;this.dispose()}return this.viewport.set(0,0,_e,rt),this.scissor.set(0,0,_e,rt),this}copy(_e){this.dispose(),this.width=_e.width,this.height=_e.height,this.depth=_e.depth,this.scissor.copy(_e.scissor),this.scissorTest=_e.scissorTest,this.viewport.copy(_e.viewport),this.depthBuffer=_e.depthBuffer,this.stencilBuffer=_e.stencilBuffer,_e.depthTexture!==null&&(this.depthTexture=_e.depthTexture.clone()),this.texture.length=0;for(let rt=0,it=_e.texture.length;rt<it;rt++)this.texture[rt]=_e.texture[rt].clone(),this.texture[rt].isRenderTargetTexture=!0;return this}}class Quaternion{constructor(_e=0,rt=0,it=0,nt=1){this.isQuaternion=!0,this._x=_e,this._y=rt,this._z=it,this._w=nt}static slerpFlat(_e,rt,it,nt,st,at,lt){let ot=it[nt+0],ct=it[nt+1],ut=it[nt+2],ht=it[nt+3];const dt=st[at+0],pt=st[at+1],ft=st[at+2],gt=st[at+3];if(lt===0){_e[rt+0]=ot,_e[rt+1]=ct,_e[rt+2]=ut,_e[rt+3]=ht;return}if(lt===1){_e[rt+0]=dt,_e[rt+1]=pt,_e[rt+2]=ft,_e[rt+3]=gt;return}if(ht!==gt||ot!==dt||ct!==pt||ut!==ft){let mt=1-lt;const At=ot*dt+ct*pt+ut*ft+ht*gt,yt=At>=0?1:-1,bt=1-At*At;if(bt>Number.EPSILON){const vt=Math.sqrt(bt),_t=Math.atan2(vt,At*yt);mt=Math.sin(mt*_t)/vt,lt=Math.sin(lt*_t)/vt}const xt=lt*yt;if(ot=ot*mt+dt*xt,ct=ct*mt+pt*xt,ut=ut*mt+ft*xt,ht=ht*mt+gt*xt,mt===1-lt){const vt=1/Math.sqrt(ot*ot+ct*ct+ut*ut+ht*ht);ot*=vt,ct*=vt,ut*=vt,ht*=vt}}_e[rt]=ot,_e[rt+1]=ct,_e[rt+2]=ut,_e[rt+3]=ht}static multiplyQuaternionsFlat(_e,rt,it,nt,st,at){const lt=it[nt],ot=it[nt+1],ct=it[nt+2],ut=it[nt+3],ht=st[at],dt=st[at+1],pt=st[at+2],ft=st[at+3];return _e[rt]=lt*ft+ut*ht+ot*pt-ct*dt,_e[rt+1]=ot*ft+ut*dt+ct*ht-lt*pt,_e[rt+2]=ct*ft+ut*pt+lt*dt-ot*ht,_e[rt+3]=ut*ft-lt*ht-ot*dt-ct*pt,_e}get x(){return this._x}set x(_e){this._x=_e,this._onChangeCallback()}get y(){return this._y}set y(_e){this._y=_e,this._onChangeCallback()}get z(){return this._z}set z(_e){this._z=_e,this._onChangeCallback()}get w(){return this._w}set w(_e){this._w=_e,this._onChangeCallback()}set(_e,rt,it,nt){return this._x=_e,this._y=rt,this._z=it,this._w=nt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_e){return this._x=_e.x,this._y=_e.y,this._z=_e.z,this._w=_e.w,this._onChangeCallback(),this}setFromEuler(_e,rt){const it=_e._x,nt=_e._y,st=_e._z,at=_e._order,lt=Math.cos,ot=Math.sin,ct=lt(it/2),ut=lt(nt/2),ht=lt(st/2),dt=ot(it/2),pt=ot(nt/2),ft=ot(st/2);switch(at){case"XYZ":this._x=dt*ut*ht+ct*pt*ft,this._y=ct*pt*ht-dt*ut*ft,this._z=ct*ut*ft+dt*pt*ht,this._w=ct*ut*ht-dt*pt*ft;break;case"YXZ":this._x=dt*ut*ht+ct*pt*ft,this._y=ct*pt*ht-dt*ut*ft,this._z=ct*ut*ft-dt*pt*ht,this._w=ct*ut*ht+dt*pt*ft;break;case"ZXY":this._x=dt*ut*ht-ct*pt*ft,this._y=ct*pt*ht+dt*ut*ft,this._z=ct*ut*ft+dt*pt*ht,this._w=ct*ut*ht-dt*pt*ft;break;case"ZYX":this._x=dt*ut*ht-ct*pt*ft,this._y=ct*pt*ht+dt*ut*ft,this._z=ct*ut*ft-dt*pt*ht,this._w=ct*ut*ht+dt*pt*ft;break;case"YZX":this._x=dt*ut*ht+ct*pt*ft,this._y=ct*pt*ht+dt*ut*ft,this._z=ct*ut*ft-dt*pt*ht,this._w=ct*ut*ht-dt*pt*ft;break;case"XZY":this._x=dt*ut*ht-ct*pt*ft,this._y=ct*pt*ht-dt*ut*ft,this._z=ct*ut*ft+dt*pt*ht,this._w=ct*ut*ht+dt*pt*ft;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+at)}return rt!==!1&&this._onChangeCallback(),this}setFromAxisAngle(_e,rt){const it=rt/2,nt=Math.sin(it);return this._x=_e.x*nt,this._y=_e.y*nt,this._z=_e.z*nt,this._w=Math.cos(it),this._onChangeCallback(),this}setFromRotationMatrix(_e){const rt=_e.elements,it=rt[0],nt=rt[4],st=rt[8],at=rt[1],lt=rt[5],ot=rt[9],ct=rt[2],ut=rt[6],ht=rt[10],dt=it+lt+ht;if(dt>0){const pt=.5/Math.sqrt(dt+1);this._w=.25/pt,this._x=(ut-ot)*pt,this._y=(st-ct)*pt,this._z=(at-nt)*pt}else if(it>lt&&it>ht){const pt=2*Math.sqrt(1+it-lt-ht);this._w=(ut-ot)/pt,this._x=.25*pt,this._y=(nt+at)/pt,this._z=(st+ct)/pt}else if(lt>ht){const pt=2*Math.sqrt(1+lt-it-ht);this._w=(st-ct)/pt,this._x=(nt+at)/pt,this._y=.25*pt,this._z=(ot+ut)/pt}else{const pt=2*Math.sqrt(1+ht-it-lt);this._w=(at-nt)/pt,this._x=(st+ct)/pt,this._y=(ot+ut)/pt,this._z=.25*pt}return this._onChangeCallback(),this}setFromUnitVectors(_e,rt){let it=_e.dot(rt)+1;return it<Number.EPSILON?(it=0,Math.abs(_e.x)>Math.abs(_e.z)?(this._x=-_e.y,this._y=_e.x,this._z=0,this._w=it):(this._x=0,this._y=-_e.z,this._z=_e.y,this._w=it)):(this._x=_e.y*rt.z-_e.z*rt.y,this._y=_e.z*rt.x-_e.x*rt.z,this._z=_e.x*rt.y-_e.y*rt.x,this._w=it),this.normalize()}angleTo(_e){return 2*Math.acos(Math.abs(clamp$2(this.dot(_e),-1,1)))}rotateTowards(_e,rt){const it=this.angleTo(_e);if(it===0)return this;const nt=Math.min(1,rt/it);return this.slerp(_e,nt),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_e){return this._x*_e._x+this._y*_e._y+this._z*_e._z+this._w*_e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _e=this.length();return _e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_e=1/_e,this._x=this._x*_e,this._y=this._y*_e,this._z=this._z*_e,this._w=this._w*_e),this._onChangeCallback(),this}multiply(_e){return this.multiplyQuaternions(this,_e)}premultiply(_e){return this.multiplyQuaternions(_e,this)}multiplyQuaternions(_e,rt){const it=_e._x,nt=_e._y,st=_e._z,at=_e._w,lt=rt._x,ot=rt._y,ct=rt._z,ut=rt._w;return this._x=it*ut+at*lt+nt*ct-st*ot,this._y=nt*ut+at*ot+st*lt-it*ct,this._z=st*ut+at*ct+it*ot-nt*lt,this._w=at*ut-it*lt-nt*ot-st*ct,this._onChangeCallback(),this}slerp(_e,rt){if(rt===0)return this;if(rt===1)return this.copy(_e);const it=this._x,nt=this._y,st=this._z,at=this._w;let lt=at*_e._w+it*_e._x+nt*_e._y+st*_e._z;if(lt<0?(this._w=-_e._w,this._x=-_e._x,this._y=-_e._y,this._z=-_e._z,lt=-lt):this.copy(_e),lt>=1)return this._w=at,this._x=it,this._y=nt,this._z=st,this;const ot=1-lt*lt;if(ot<=Number.EPSILON){const pt=1-rt;return this._w=pt*at+rt*this._w,this._x=pt*it+rt*this._x,this._y=pt*nt+rt*this._y,this._z=pt*st+rt*this._z,this.normalize(),this._onChangeCallback(),this}const ct=Math.sqrt(ot),ut=Math.atan2(ct,lt),ht=Math.sin((1-rt)*ut)/ct,dt=Math.sin(rt*ut)/ct;return this._w=at*ht+this._w*dt,this._x=it*ht+this._x*dt,this._y=nt*ht+this._y*dt,this._z=st*ht+this._z*dt,this._onChangeCallback(),this}slerpQuaternions(_e,rt,it){return this.copy(_e).slerp(rt,it)}random(){const _e=Math.random(),rt=Math.sqrt(1-_e),it=Math.sqrt(_e),nt=2*Math.PI*Math.random(),st=2*Math.PI*Math.random();return this.set(rt*Math.cos(nt),it*Math.sin(st),it*Math.cos(st),rt*Math.sin(nt))}equals(_e){return _e._x===this._x&&_e._y===this._y&&_e._z===this._z&&_e._w===this._w}fromArray(_e,rt=0){return this._x=_e[rt],this._y=_e[rt+1],this._z=_e[rt+2],this._w=_e[rt+3],this._onChangeCallback(),this}toArray(_e=[],rt=0){return _e[rt]=this._x,_e[rt+1]=this._y,_e[rt+2]=this._z,_e[rt+3]=this._w,_e}fromBufferAttribute(_e,rt){return this._x=_e.getX(rt),this._y=_e.getY(rt),this._z=_e.getZ(rt),this._w=_e.getW(rt),this}toJSON(){return this.toArray()}_onChange(_e){return this._onChangeCallback=_e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_e=0,rt=0,it=0){Vector3.prototype.isVector3=!0,this.x=_e,this.y=rt,this.z=it}set(_e,rt,it){return it===void 0&&(it=this.z),this.x=_e,this.y=rt,this.z=it,this}setScalar(_e){return this.x=_e,this.y=_e,this.z=_e,this}setX(_e){return this.x=_e,this}setY(_e){return this.y=_e,this}setZ(_e){return this.z=_e,this}setComponent(_e,rt){switch(_e){case 0:this.x=rt;break;case 1:this.y=rt;break;case 2:this.z=rt;break;default:throw new Error("index is out of range: "+_e)}return this}getComponent(_e){switch(_e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_e){return this.x=_e.x,this.y=_e.y,this.z=_e.z,this}add(_e){return this.x+=_e.x,this.y+=_e.y,this.z+=_e.z,this}addScalar(_e){return this.x+=_e,this.y+=_e,this.z+=_e,this}addVectors(_e,rt){return this.x=_e.x+rt.x,this.y=_e.y+rt.y,this.z=_e.z+rt.z,this}addScaledVector(_e,rt){return this.x+=_e.x*rt,this.y+=_e.y*rt,this.z+=_e.z*rt,this}sub(_e){return this.x-=_e.x,this.y-=_e.y,this.z-=_e.z,this}subScalar(_e){return this.x-=_e,this.y-=_e,this.z-=_e,this}subVectors(_e,rt){return this.x=_e.x-rt.x,this.y=_e.y-rt.y,this.z=_e.z-rt.z,this}multiply(_e){return this.x*=_e.x,this.y*=_e.y,this.z*=_e.z,this}multiplyScalar(_e){return this.x*=_e,this.y*=_e,this.z*=_e,this}multiplyVectors(_e,rt){return this.x=_e.x*rt.x,this.y=_e.y*rt.y,this.z=_e.z*rt.z,this}applyEuler(_e){return this.applyQuaternion(_quaternion$4.setFromEuler(_e))}applyAxisAngle(_e,rt){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_e,rt))}applyMatrix3(_e){const rt=this.x,it=this.y,nt=this.z,st=_e.elements;return this.x=st[0]*rt+st[3]*it+st[6]*nt,this.y=st[1]*rt+st[4]*it+st[7]*nt,this.z=st[2]*rt+st[5]*it+st[8]*nt,this}applyNormalMatrix(_e){return this.applyMatrix3(_e).normalize()}applyMatrix4(_e){const rt=this.x,it=this.y,nt=this.z,st=_e.elements,at=1/(st[3]*rt+st[7]*it+st[11]*nt+st[15]);return this.x=(st[0]*rt+st[4]*it+st[8]*nt+st[12])*at,this.y=(st[1]*rt+st[5]*it+st[9]*nt+st[13])*at,this.z=(st[2]*rt+st[6]*it+st[10]*nt+st[14])*at,this}applyQuaternion(_e){const rt=this.x,it=this.y,nt=this.z,st=_e.x,at=_e.y,lt=_e.z,ot=_e.w,ct=ot*rt+at*nt-lt*it,ut=ot*it+lt*rt-st*nt,ht=ot*nt+st*it-at*rt,dt=-st*rt-at*it-lt*nt;return this.x=ct*ot+dt*-st+ut*-lt-ht*-at,this.y=ut*ot+dt*-at+ht*-st-ct*-lt,this.z=ht*ot+dt*-lt+ct*-at-ut*-st,this}project(_e){return this.applyMatrix4(_e.matrixWorldInverse).applyMatrix4(_e.projectionMatrix)}unproject(_e){return this.applyMatrix4(_e.projectionMatrixInverse).applyMatrix4(_e.matrixWorld)}transformDirection(_e){const rt=this.x,it=this.y,nt=this.z,st=_e.elements;return this.x=st[0]*rt+st[4]*it+st[8]*nt,this.y=st[1]*rt+st[5]*it+st[9]*nt,this.z=st[2]*rt+st[6]*it+st[10]*nt,this.normalize()}divide(_e){return this.x/=_e.x,this.y/=_e.y,this.z/=_e.z,this}divideScalar(_e){return this.multiplyScalar(1/_e)}min(_e){return this.x=Math.min(this.x,_e.x),this.y=Math.min(this.y,_e.y),this.z=Math.min(this.z,_e.z),this}max(_e){return this.x=Math.max(this.x,_e.x),this.y=Math.max(this.y,_e.y),this.z=Math.max(this.z,_e.z),this}clamp(_e,rt){return this.x=Math.max(_e.x,Math.min(rt.x,this.x)),this.y=Math.max(_e.y,Math.min(rt.y,this.y)),this.z=Math.max(_e.z,Math.min(rt.z,this.z)),this}clampScalar(_e,rt){return this.x=Math.max(_e,Math.min(rt,this.x)),this.y=Math.max(_e,Math.min(rt,this.y)),this.z=Math.max(_e,Math.min(rt,this.z)),this}clampLength(_e,rt){const it=this.length();return this.divideScalar(it||1).multiplyScalar(Math.max(_e,Math.min(rt,it)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_e){return this.x*_e.x+this.y*_e.y+this.z*_e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_e){return this.normalize().multiplyScalar(_e)}lerp(_e,rt){return this.x+=(_e.x-this.x)*rt,this.y+=(_e.y-this.y)*rt,this.z+=(_e.z-this.z)*rt,this}lerpVectors(_e,rt,it){return this.x=_e.x+(rt.x-_e.x)*it,this.y=_e.y+(rt.y-_e.y)*it,this.z=_e.z+(rt.z-_e.z)*it,this}cross(_e){return this.crossVectors(this,_e)}crossVectors(_e,rt){const it=_e.x,nt=_e.y,st=_e.z,at=rt.x,lt=rt.y,ot=rt.z;return this.x=nt*ot-st*lt,this.y=st*at-it*ot,this.z=it*lt-nt*at,this}projectOnVector(_e){const rt=_e.lengthSq();if(rt===0)return this.set(0,0,0);const it=_e.dot(this)/rt;return this.copy(_e).multiplyScalar(it)}projectOnPlane(_e){return _vector$b.copy(this).projectOnVector(_e),this.sub(_vector$b)}reflect(_e){return this.sub(_vector$b.copy(_e).multiplyScalar(2*this.dot(_e)))}angleTo(_e){const rt=Math.sqrt(this.lengthSq()*_e.lengthSq());if(rt===0)return Math.PI/2;const it=this.dot(_e)/rt;return Math.acos(clamp$2(it,-1,1))}distanceTo(_e){return Math.sqrt(this.distanceToSquared(_e))}distanceToSquared(_e){const rt=this.x-_e.x,it=this.y-_e.y,nt=this.z-_e.z;return rt*rt+it*it+nt*nt}manhattanDistanceTo(_e){return Math.abs(this.x-_e.x)+Math.abs(this.y-_e.y)+Math.abs(this.z-_e.z)}setFromSpherical(_e){return this.setFromSphericalCoords(_e.radius,_e.phi,_e.theta)}setFromSphericalCoords(_e,rt,it){const nt=Math.sin(rt)*_e;return this.x=nt*Math.sin(it),this.y=Math.cos(rt)*_e,this.z=nt*Math.cos(it),this}setFromCylindrical(_e){return this.setFromCylindricalCoords(_e.radius,_e.theta,_e.y)}setFromCylindricalCoords(_e,rt,it){return this.x=_e*Math.sin(rt),this.y=it,this.z=_e*Math.cos(rt),this}setFromMatrixPosition(_e){const rt=_e.elements;return this.x=rt[12],this.y=rt[13],this.z=rt[14],this}setFromMatrixScale(_e){const rt=this.setFromMatrixColumn(_e,0).length(),it=this.setFromMatrixColumn(_e,1).length(),nt=this.setFromMatrixColumn(_e,2).length();return this.x=rt,this.y=it,this.z=nt,this}setFromMatrixColumn(_e,rt){return this.fromArray(_e.elements,rt*4)}setFromMatrix3Column(_e,rt){return this.fromArray(_e.elements,rt*3)}setFromEuler(_e){return this.x=_e._x,this.y=_e._y,this.z=_e._z,this}setFromColor(_e){return this.x=_e.r,this.y=_e.g,this.z=_e.b,this}equals(_e){return _e.x===this.x&&_e.y===this.y&&_e.z===this.z}fromArray(_e,rt=0){return this.x=_e[rt],this.y=_e[rt+1],this.z=_e[rt+2],this}toArray(_e=[],rt=0){return _e[rt]=this.x,_e[rt+1]=this.y,_e[rt+2]=this.z,_e}fromBufferAttribute(_e,rt){return this.x=_e.getX(rt),this.y=_e.getY(rt),this.z=_e.getZ(rt),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _e=(Math.random()-.5)*2,rt=Math.random()*Math.PI*2,it=Math.sqrt(1-_e**2);return this.x=it*Math.cos(rt),this.y=it*Math.sin(rt),this.z=_e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$b=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(_e=new Vector3(1/0,1/0,1/0),rt=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_e,this.max=rt}set(_e,rt){return this.min.copy(_e),this.max.copy(rt),this}setFromArray(_e){this.makeEmpty();for(let rt=0,it=_e.length;rt<it;rt+=3)this.expandByPoint(_vector$a.fromArray(_e,rt));return this}setFromBufferAttribute(_e){this.makeEmpty();for(let rt=0,it=_e.count;rt<it;rt++)this.expandByPoint(_vector$a.fromBufferAttribute(_e,rt));return this}setFromPoints(_e){this.makeEmpty();for(let rt=0,it=_e.length;rt<it;rt++)this.expandByPoint(_e[rt]);return this}setFromCenterAndSize(_e,rt){const it=_vector$a.copy(rt).multiplyScalar(.5);return this.min.copy(_e).sub(it),this.max.copy(_e).add(it),this}setFromObject(_e,rt=!1){return this.makeEmpty(),this.expandByObject(_e,rt)}clone(){return new this.constructor().copy(this)}copy(_e){return this.min.copy(_e.min),this.max.copy(_e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_e){return this.isEmpty()?_e.set(0,0,0):_e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_e){return this.isEmpty()?_e.set(0,0,0):_e.subVectors(this.max,this.min)}expandByPoint(_e){return this.min.min(_e),this.max.max(_e),this}expandByVector(_e){return this.min.sub(_e),this.max.add(_e),this}expandByScalar(_e){return this.min.addScalar(-_e),this.max.addScalar(_e),this}expandByObject(_e,rt=!1){if(_e.updateWorldMatrix(!1,!1),_e.boundingBox!==void 0)_e.boundingBox===null&&_e.computeBoundingBox(),_box$3.copy(_e.boundingBox),_box$3.applyMatrix4(_e.matrixWorld),this.union(_box$3);else{const nt=_e.geometry;if(nt!==void 0)if(rt&&nt.attributes!==void 0&&nt.attributes.position!==void 0){const st=nt.attributes.position;for(let at=0,lt=st.count;at<lt;at++)_vector$a.fromBufferAttribute(st,at).applyMatrix4(_e.matrixWorld),this.expandByPoint(_vector$a)}else nt.boundingBox===null&&nt.computeBoundingBox(),_box$3.copy(nt.boundingBox),_box$3.applyMatrix4(_e.matrixWorld),this.union(_box$3)}const it=_e.children;for(let nt=0,st=it.length;nt<st;nt++)this.expandByObject(it[nt],rt);return this}containsPoint(_e){return!(_e.x<this.min.x||_e.x>this.max.x||_e.y<this.min.y||_e.y>this.max.y||_e.z<this.min.z||_e.z>this.max.z)}containsBox(_e){return this.min.x<=_e.min.x&&_e.max.x<=this.max.x&&this.min.y<=_e.min.y&&_e.max.y<=this.max.y&&this.min.z<=_e.min.z&&_e.max.z<=this.max.z}getParameter(_e,rt){return rt.set((_e.x-this.min.x)/(this.max.x-this.min.x),(_e.y-this.min.y)/(this.max.y-this.min.y),(_e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_e){return!(_e.max.x<this.min.x||_e.min.x>this.max.x||_e.max.y<this.min.y||_e.min.y>this.max.y||_e.max.z<this.min.z||_e.min.z>this.max.z)}intersectsSphere(_e){return this.clampPoint(_e.center,_vector$a),_vector$a.distanceToSquared(_e.center)<=_e.radius*_e.radius}intersectsPlane(_e){let rt,it;return _e.normal.x>0?(rt=_e.normal.x*this.min.x,it=_e.normal.x*this.max.x):(rt=_e.normal.x*this.max.x,it=_e.normal.x*this.min.x),_e.normal.y>0?(rt+=_e.normal.y*this.min.y,it+=_e.normal.y*this.max.y):(rt+=_e.normal.y*this.max.y,it+=_e.normal.y*this.min.y),_e.normal.z>0?(rt+=_e.normal.z*this.min.z,it+=_e.normal.z*this.max.z):(rt+=_e.normal.z*this.max.z,it+=_e.normal.z*this.min.z),rt<=-_e.constant&&it>=-_e.constant}intersectsTriangle(_e){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(_e.a,_center),_v1$7.subVectors(_e.b,_center),_v2$4.subVectors(_e.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let rt=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(rt,_v0$2,_v1$7,_v2$4,_extents)||(rt=[1,0,0,0,1,0,0,0,1],!satForAxes(rt,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),rt=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(rt,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(_e,rt){return rt.copy(_e).clamp(this.min,this.max)}distanceToPoint(_e){return this.clampPoint(_e,_vector$a).distanceTo(_e)}getBoundingSphere(_e){return this.isEmpty()?_e.makeEmpty():(this.getCenter(_e.center),_e.radius=this.getSize(_vector$a).length()*.5),_e}intersect(_e){return this.min.max(_e.min),this.max.min(_e.max),this.isEmpty()&&this.makeEmpty(),this}union(_e){return this.min.min(_e.min),this.max.max(_e.max),this}applyMatrix4(_e){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_e),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_e),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_e),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_e),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_e),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_e),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_e),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_e),this.setFromPoints(_points),this)}translate(_e){return this.min.add(_e),this.max.add(_e),this}equals(_e){return _e.min.equals(this.min)&&_e.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$a=new Vector3,_box$3=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(tt,_e,rt,it,nt){for(let st=0,at=tt.length-3;st<=at;st+=3){_testAxis.fromArray(tt,st);const lt=nt.x*Math.abs(_testAxis.x)+nt.y*Math.abs(_testAxis.y)+nt.z*Math.abs(_testAxis.z),ot=_e.dot(_testAxis),ct=rt.dot(_testAxis),ut=it.dot(_testAxis);if(Math.max(-Math.max(ot,ct,ut),Math.min(ot,ct,ut))>lt)return!1}return!0}const _box$2=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(_e=new Vector3,rt=-1){this.center=_e,this.radius=rt}set(_e,rt){return this.center.copy(_e),this.radius=rt,this}setFromPoints(_e,rt){const it=this.center;rt!==void 0?it.copy(rt):_box$2.setFromPoints(_e).getCenter(it);let nt=0;for(let st=0,at=_e.length;st<at;st++)nt=Math.max(nt,it.distanceToSquared(_e[st]));return this.radius=Math.sqrt(nt),this}copy(_e){return this.center.copy(_e.center),this.radius=_e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_e){return _e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_e){return _e.distanceTo(this.center)-this.radius}intersectsSphere(_e){const rt=this.radius+_e.radius;return _e.center.distanceToSquared(this.center)<=rt*rt}intersectsBox(_e){return _e.intersectsSphere(this)}intersectsPlane(_e){return Math.abs(_e.distanceToPoint(this.center))<=this.radius}clampPoint(_e,rt){const it=this.center.distanceToSquared(_e);return rt.copy(_e),it>this.radius*this.radius&&(rt.sub(this.center).normalize(),rt.multiplyScalar(this.radius).add(this.center)),rt}getBoundingBox(_e){return this.isEmpty()?(_e.makeEmpty(),_e):(_e.set(this.center,this.center),_e.expandByScalar(this.radius),_e)}applyMatrix4(_e){return this.center.applyMatrix4(_e),this.radius=this.radius*_e.getMaxScaleOnAxis(),this}translate(_e){return this.center.add(_e),this}expandByPoint(_e){if(this.isEmpty())return this.center.copy(_e),this.radius=0,this;_v1$6.subVectors(_e,this.center);const rt=_v1$6.lengthSq();if(rt>this.radius*this.radius){const it=Math.sqrt(rt),nt=(it-this.radius)*.5;this.center.addScaledVector(_v1$6,nt/it),this.radius+=nt}return this}union(_e){return _e.isEmpty()?this:this.isEmpty()?(this.copy(_e),this):(this.center.equals(_e.center)===!0?this.radius=Math.max(this.radius,_e.radius):(_v2$3.subVectors(_e.center,this.center).setLength(_e.radius),this.expandByPoint(_v1$6.copy(_e.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_e.center).sub(_v2$3))),this)}equals(_e){return _e.center.equals(this.center)&&_e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$9=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;let Ray$1=class{constructor(_e=new Vector3,rt=new Vector3(0,0,-1)){this.origin=_e,this.direction=rt}set(_e,rt){return this.origin.copy(_e),this.direction.copy(rt),this}copy(_e){return this.origin.copy(_e.origin),this.direction.copy(_e.direction),this}at(_e,rt){return rt.copy(this.origin).addScaledVector(this.direction,_e)}lookAt(_e){return this.direction.copy(_e).sub(this.origin).normalize(),this}recast(_e){return this.origin.copy(this.at(_e,_vector$9)),this}closestPointToPoint(_e,rt){rt.subVectors(_e,this.origin);const it=rt.dot(this.direction);return it<0?rt.copy(this.origin):rt.copy(this.origin).addScaledVector(this.direction,it)}distanceToPoint(_e){return Math.sqrt(this.distanceSqToPoint(_e))}distanceSqToPoint(_e){const rt=_vector$9.subVectors(_e,this.origin).dot(this.direction);return rt<0?this.origin.distanceToSquared(_e):(_vector$9.copy(this.origin).addScaledVector(this.direction,rt),_vector$9.distanceToSquared(_e))}distanceSqToSegment(_e,rt,it,nt){_segCenter.copy(_e).add(rt).multiplyScalar(.5),_segDir.copy(rt).sub(_e).normalize(),_diff.copy(this.origin).sub(_segCenter);const st=_e.distanceTo(rt)*.5,at=-this.direction.dot(_segDir),lt=_diff.dot(this.direction),ot=-_diff.dot(_segDir),ct=_diff.lengthSq(),ut=Math.abs(1-at*at);let ht,dt,pt,ft;if(ut>0)if(ht=at*ot-lt,dt=at*lt-ot,ft=st*ut,ht>=0)if(dt>=-ft)if(dt<=ft){const gt=1/ut;ht*=gt,dt*=gt,pt=ht*(ht+at*dt+2*lt)+dt*(at*ht+dt+2*ot)+ct}else dt=st,ht=Math.max(0,-(at*dt+lt)),pt=-ht*ht+dt*(dt+2*ot)+ct;else dt=-st,ht=Math.max(0,-(at*dt+lt)),pt=-ht*ht+dt*(dt+2*ot)+ct;else dt<=-ft?(ht=Math.max(0,-(-at*st+lt)),dt=ht>0?-st:Math.min(Math.max(-st,-ot),st),pt=-ht*ht+dt*(dt+2*ot)+ct):dt<=ft?(ht=0,dt=Math.min(Math.max(-st,-ot),st),pt=dt*(dt+2*ot)+ct):(ht=Math.max(0,-(at*st+lt)),dt=ht>0?st:Math.min(Math.max(-st,-ot),st),pt=-ht*ht+dt*(dt+2*ot)+ct);else dt=at>0?-st:st,ht=Math.max(0,-(at*dt+lt)),pt=-ht*ht+dt*(dt+2*ot)+ct;return it&&it.copy(this.origin).addScaledVector(this.direction,ht),nt&&nt.copy(_segCenter).addScaledVector(_segDir,dt),pt}intersectSphere(_e,rt){_vector$9.subVectors(_e.center,this.origin);const it=_vector$9.dot(this.direction),nt=_vector$9.dot(_vector$9)-it*it,st=_e.radius*_e.radius;if(nt>st)return null;const at=Math.sqrt(st-nt),lt=it-at,ot=it+at;return ot<0?null:lt<0?this.at(ot,rt):this.at(lt,rt)}intersectsSphere(_e){return this.distanceSqToPoint(_e.center)<=_e.radius*_e.radius}distanceToPlane(_e){const rt=_e.normal.dot(this.direction);if(rt===0)return _e.distanceToPoint(this.origin)===0?0:null;const it=-(this.origin.dot(_e.normal)+_e.constant)/rt;return it>=0?it:null}intersectPlane(_e,rt){const it=this.distanceToPlane(_e);return it===null?null:this.at(it,rt)}intersectsPlane(_e){const rt=_e.distanceToPoint(this.origin);return rt===0||_e.normal.dot(this.direction)*rt<0}intersectBox(_e,rt){let it,nt,st,at,lt,ot;const ct=1/this.direction.x,ut=1/this.direction.y,ht=1/this.direction.z,dt=this.origin;return ct>=0?(it=(_e.min.x-dt.x)*ct,nt=(_e.max.x-dt.x)*ct):(it=(_e.max.x-dt.x)*ct,nt=(_e.min.x-dt.x)*ct),ut>=0?(st=(_e.min.y-dt.y)*ut,at=(_e.max.y-dt.y)*ut):(st=(_e.max.y-dt.y)*ut,at=(_e.min.y-dt.y)*ut),it>at||st>nt||((st>it||isNaN(it))&&(it=st),(at<nt||isNaN(nt))&&(nt=at),ht>=0?(lt=(_e.min.z-dt.z)*ht,ot=(_e.max.z-dt.z)*ht):(lt=(_e.max.z-dt.z)*ht,ot=(_e.min.z-dt.z)*ht),it>ot||lt>nt)||((lt>it||it!==it)&&(it=lt),(ot<nt||nt!==nt)&&(nt=ot),nt<0)?null:this.at(it>=0?it:nt,rt)}intersectsBox(_e){return this.intersectBox(_e,_vector$9)!==null}intersectTriangle(_e,rt,it,nt,st){_edge1.subVectors(rt,_e),_edge2.subVectors(it,_e),_normal$1.crossVectors(_edge1,_edge2);let at=this.direction.dot(_normal$1),lt;if(at>0){if(nt)return null;lt=1}else if(at<0)lt=-1,at=-at;else return null;_diff.subVectors(this.origin,_e);const ot=lt*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(ot<0)return null;const ct=lt*this.direction.dot(_edge1.cross(_diff));if(ct<0||ot+ct>at)return null;const ut=-lt*_diff.dot(_normal$1);return ut<0?null:this.at(ut/at,st)}applyMatrix4(_e){return this.origin.applyMatrix4(_e),this.direction.transformDirection(_e),this}equals(_e){return _e.origin.equals(this.origin)&&_e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};class Matrix4{constructor(_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_e!==void 0&&this.set(_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt)}set(_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt){const At=this.elements;return At[0]=_e,At[4]=rt,At[8]=it,At[12]=nt,At[1]=st,At[5]=at,At[9]=lt,At[13]=ot,At[2]=ct,At[6]=ut,At[10]=ht,At[14]=dt,At[3]=pt,At[7]=ft,At[11]=gt,At[15]=mt,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_e){const rt=this.elements,it=_e.elements;return rt[0]=it[0],rt[1]=it[1],rt[2]=it[2],rt[3]=it[3],rt[4]=it[4],rt[5]=it[5],rt[6]=it[6],rt[7]=it[7],rt[8]=it[8],rt[9]=it[9],rt[10]=it[10],rt[11]=it[11],rt[12]=it[12],rt[13]=it[13],rt[14]=it[14],rt[15]=it[15],this}copyPosition(_e){const rt=this.elements,it=_e.elements;return rt[12]=it[12],rt[13]=it[13],rt[14]=it[14],this}setFromMatrix3(_e){const rt=_e.elements;return this.set(rt[0],rt[3],rt[6],0,rt[1],rt[4],rt[7],0,rt[2],rt[5],rt[8],0,0,0,0,1),this}extractBasis(_e,rt,it){return _e.setFromMatrixColumn(this,0),rt.setFromMatrixColumn(this,1),it.setFromMatrixColumn(this,2),this}makeBasis(_e,rt,it){return this.set(_e.x,rt.x,it.x,0,_e.y,rt.y,it.y,0,_e.z,rt.z,it.z,0,0,0,0,1),this}extractRotation(_e){const rt=this.elements,it=_e.elements,nt=1/_v1$5.setFromMatrixColumn(_e,0).length(),st=1/_v1$5.setFromMatrixColumn(_e,1).length(),at=1/_v1$5.setFromMatrixColumn(_e,2).length();return rt[0]=it[0]*nt,rt[1]=it[1]*nt,rt[2]=it[2]*nt,rt[3]=0,rt[4]=it[4]*st,rt[5]=it[5]*st,rt[6]=it[6]*st,rt[7]=0,rt[8]=it[8]*at,rt[9]=it[9]*at,rt[10]=it[10]*at,rt[11]=0,rt[12]=0,rt[13]=0,rt[14]=0,rt[15]=1,this}makeRotationFromEuler(_e){const rt=this.elements,it=_e.x,nt=_e.y,st=_e.z,at=Math.cos(it),lt=Math.sin(it),ot=Math.cos(nt),ct=Math.sin(nt),ut=Math.cos(st),ht=Math.sin(st);if(_e.order==="XYZ"){const dt=at*ut,pt=at*ht,ft=lt*ut,gt=lt*ht;rt[0]=ot*ut,rt[4]=-ot*ht,rt[8]=ct,rt[1]=pt+ft*ct,rt[5]=dt-gt*ct,rt[9]=-lt*ot,rt[2]=gt-dt*ct,rt[6]=ft+pt*ct,rt[10]=at*ot}else if(_e.order==="YXZ"){const dt=ot*ut,pt=ot*ht,ft=ct*ut,gt=ct*ht;rt[0]=dt+gt*lt,rt[4]=ft*lt-pt,rt[8]=at*ct,rt[1]=at*ht,rt[5]=at*ut,rt[9]=-lt,rt[2]=pt*lt-ft,rt[6]=gt+dt*lt,rt[10]=at*ot}else if(_e.order==="ZXY"){const dt=ot*ut,pt=ot*ht,ft=ct*ut,gt=ct*ht;rt[0]=dt-gt*lt,rt[4]=-at*ht,rt[8]=ft+pt*lt,rt[1]=pt+ft*lt,rt[5]=at*ut,rt[9]=gt-dt*lt,rt[2]=-at*ct,rt[6]=lt,rt[10]=at*ot}else if(_e.order==="ZYX"){const dt=at*ut,pt=at*ht,ft=lt*ut,gt=lt*ht;rt[0]=ot*ut,rt[4]=ft*ct-pt,rt[8]=dt*ct+gt,rt[1]=ot*ht,rt[5]=gt*ct+dt,rt[9]=pt*ct-ft,rt[2]=-ct,rt[6]=lt*ot,rt[10]=at*ot}else if(_e.order==="YZX"){const dt=at*ot,pt=at*ct,ft=lt*ot,gt=lt*ct;rt[0]=ot*ut,rt[4]=gt-dt*ht,rt[8]=ft*ht+pt,rt[1]=ht,rt[5]=at*ut,rt[9]=-lt*ut,rt[2]=-ct*ut,rt[6]=pt*ht+ft,rt[10]=dt-gt*ht}else if(_e.order==="XZY"){const dt=at*ot,pt=at*ct,ft=lt*ot,gt=lt*ct;rt[0]=ot*ut,rt[4]=-ht,rt[8]=ct*ut,rt[1]=dt*ht+gt,rt[5]=at*ut,rt[9]=pt*ht-ft,rt[2]=ft*ht-pt,rt[6]=lt*ut,rt[10]=gt*ht+dt}return rt[3]=0,rt[7]=0,rt[11]=0,rt[12]=0,rt[13]=0,rt[14]=0,rt[15]=1,this}makeRotationFromQuaternion(_e){return this.compose(_zero,_e,_one)}lookAt(_e,rt,it){const nt=this.elements;return _z.subVectors(_e,rt),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(it,_z),_x.lengthSq()===0&&(Math.abs(it.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(it,_z)),_x.normalize(),_y.crossVectors(_z,_x),nt[0]=_x.x,nt[4]=_y.x,nt[8]=_z.x,nt[1]=_x.y,nt[5]=_y.y,nt[9]=_z.y,nt[2]=_x.z,nt[6]=_y.z,nt[10]=_z.z,this}multiply(_e){return this.multiplyMatrices(this,_e)}premultiply(_e){return this.multiplyMatrices(_e,this)}multiplyMatrices(_e,rt){const it=_e.elements,nt=rt.elements,st=this.elements,at=it[0],lt=it[4],ot=it[8],ct=it[12],ut=it[1],ht=it[5],dt=it[9],pt=it[13],ft=it[2],gt=it[6],mt=it[10],At=it[14],yt=it[3],bt=it[7],xt=it[11],vt=it[15],_t=nt[0],Ct=nt[4],St=nt[8],Et=nt[12],Tt=nt[1],Mt=nt[5],Rt=nt[9],It=nt[13],Ot=nt[2],Bt=nt[6],Nt=nt[10],zt=nt[14],Dt=nt[3],Ft=nt[7],Ut=nt[11],$t=nt[15];return st[0]=at*_t+lt*Tt+ot*Ot+ct*Dt,st[4]=at*Ct+lt*Mt+ot*Bt+ct*Ft,st[8]=at*St+lt*Rt+ot*Nt+ct*Ut,st[12]=at*Et+lt*It+ot*zt+ct*$t,st[1]=ut*_t+ht*Tt+dt*Ot+pt*Dt,st[5]=ut*Ct+ht*Mt+dt*Bt+pt*Ft,st[9]=ut*St+ht*Rt+dt*Nt+pt*Ut,st[13]=ut*Et+ht*It+dt*zt+pt*$t,st[2]=ft*_t+gt*Tt+mt*Ot+At*Dt,st[6]=ft*Ct+gt*Mt+mt*Bt+At*Ft,st[10]=ft*St+gt*Rt+mt*Nt+At*Ut,st[14]=ft*Et+gt*It+mt*zt+At*$t,st[3]=yt*_t+bt*Tt+xt*Ot+vt*Dt,st[7]=yt*Ct+bt*Mt+xt*Bt+vt*Ft,st[11]=yt*St+bt*Rt+xt*Nt+vt*Ut,st[15]=yt*Et+bt*It+xt*zt+vt*$t,this}multiplyScalar(_e){const rt=this.elements;return rt[0]*=_e,rt[4]*=_e,rt[8]*=_e,rt[12]*=_e,rt[1]*=_e,rt[5]*=_e,rt[9]*=_e,rt[13]*=_e,rt[2]*=_e,rt[6]*=_e,rt[10]*=_e,rt[14]*=_e,rt[3]*=_e,rt[7]*=_e,rt[11]*=_e,rt[15]*=_e,this}determinant(){const _e=this.elements,rt=_e[0],it=_e[4],nt=_e[8],st=_e[12],at=_e[1],lt=_e[5],ot=_e[9],ct=_e[13],ut=_e[2],ht=_e[6],dt=_e[10],pt=_e[14],ft=_e[3],gt=_e[7],mt=_e[11],At=_e[15];return ft*(+st*ot*ht-nt*ct*ht-st*lt*dt+it*ct*dt+nt*lt*pt-it*ot*pt)+gt*(+rt*ot*pt-rt*ct*dt+st*at*dt-nt*at*pt+nt*ct*ut-st*ot*ut)+mt*(+rt*ct*ht-rt*lt*pt-st*at*ht+it*at*pt+st*lt*ut-it*ct*ut)+At*(-nt*lt*ut-rt*ot*ht+rt*lt*dt+nt*at*ht-it*at*dt+it*ot*ut)}transpose(){const _e=this.elements;let rt;return rt=_e[1],_e[1]=_e[4],_e[4]=rt,rt=_e[2],_e[2]=_e[8],_e[8]=rt,rt=_e[6],_e[6]=_e[9],_e[9]=rt,rt=_e[3],_e[3]=_e[12],_e[12]=rt,rt=_e[7],_e[7]=_e[13],_e[13]=rt,rt=_e[11],_e[11]=_e[14],_e[14]=rt,this}setPosition(_e,rt,it){const nt=this.elements;return _e.isVector3?(nt[12]=_e.x,nt[13]=_e.y,nt[14]=_e.z):(nt[12]=_e,nt[13]=rt,nt[14]=it),this}invert(){const _e=this.elements,rt=_e[0],it=_e[1],nt=_e[2],st=_e[3],at=_e[4],lt=_e[5],ot=_e[6],ct=_e[7],ut=_e[8],ht=_e[9],dt=_e[10],pt=_e[11],ft=_e[12],gt=_e[13],mt=_e[14],At=_e[15],yt=ht*mt*ct-gt*dt*ct+gt*ot*pt-lt*mt*pt-ht*ot*At+lt*dt*At,bt=ft*dt*ct-ut*mt*ct-ft*ot*pt+at*mt*pt+ut*ot*At-at*dt*At,xt=ut*gt*ct-ft*ht*ct+ft*lt*pt-at*gt*pt-ut*lt*At+at*ht*At,vt=ft*ht*ot-ut*gt*ot-ft*lt*dt+at*gt*dt+ut*lt*mt-at*ht*mt,_t=rt*yt+it*bt+nt*xt+st*vt;if(_t===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Ct=1/_t;return _e[0]=yt*Ct,_e[1]=(gt*dt*st-ht*mt*st-gt*nt*pt+it*mt*pt+ht*nt*At-it*dt*At)*Ct,_e[2]=(lt*mt*st-gt*ot*st+gt*nt*ct-it*mt*ct-lt*nt*At+it*ot*At)*Ct,_e[3]=(ht*ot*st-lt*dt*st-ht*nt*ct+it*dt*ct+lt*nt*pt-it*ot*pt)*Ct,_e[4]=bt*Ct,_e[5]=(ut*mt*st-ft*dt*st+ft*nt*pt-rt*mt*pt-ut*nt*At+rt*dt*At)*Ct,_e[6]=(ft*ot*st-at*mt*st-ft*nt*ct+rt*mt*ct+at*nt*At-rt*ot*At)*Ct,_e[7]=(at*dt*st-ut*ot*st+ut*nt*ct-rt*dt*ct-at*nt*pt+rt*ot*pt)*Ct,_e[8]=xt*Ct,_e[9]=(ft*ht*st-ut*gt*st-ft*it*pt+rt*gt*pt+ut*it*At-rt*ht*At)*Ct,_e[10]=(at*gt*st-ft*lt*st+ft*it*ct-rt*gt*ct-at*it*At+rt*lt*At)*Ct,_e[11]=(ut*lt*st-at*ht*st-ut*it*ct+rt*ht*ct+at*it*pt-rt*lt*pt)*Ct,_e[12]=vt*Ct,_e[13]=(ut*gt*nt-ft*ht*nt+ft*it*dt-rt*gt*dt-ut*it*mt+rt*ht*mt)*Ct,_e[14]=(ft*lt*nt-at*gt*nt-ft*it*ot+rt*gt*ot+at*it*mt-rt*lt*mt)*Ct,_e[15]=(at*ht*nt-ut*lt*nt+ut*it*ot-rt*ht*ot-at*it*dt+rt*lt*dt)*Ct,this}scale(_e){const rt=this.elements,it=_e.x,nt=_e.y,st=_e.z;return rt[0]*=it,rt[4]*=nt,rt[8]*=st,rt[1]*=it,rt[5]*=nt,rt[9]*=st,rt[2]*=it,rt[6]*=nt,rt[10]*=st,rt[3]*=it,rt[7]*=nt,rt[11]*=st,this}getMaxScaleOnAxis(){const _e=this.elements,rt=_e[0]*_e[0]+_e[1]*_e[1]+_e[2]*_e[2],it=_e[4]*_e[4]+_e[5]*_e[5]+_e[6]*_e[6],nt=_e[8]*_e[8]+_e[9]*_e[9]+_e[10]*_e[10];return Math.sqrt(Math.max(rt,it,nt))}makeTranslation(_e,rt,it){return _e.isVector3?this.set(1,0,0,_e.x,0,1,0,_e.y,0,0,1,_e.z,0,0,0,1):this.set(1,0,0,_e,0,1,0,rt,0,0,1,it,0,0,0,1),this}makeRotationX(_e){const rt=Math.cos(_e),it=Math.sin(_e);return this.set(1,0,0,0,0,rt,-it,0,0,it,rt,0,0,0,0,1),this}makeRotationY(_e){const rt=Math.cos(_e),it=Math.sin(_e);return this.set(rt,0,it,0,0,1,0,0,-it,0,rt,0,0,0,0,1),this}makeRotationZ(_e){const rt=Math.cos(_e),it=Math.sin(_e);return this.set(rt,-it,0,0,it,rt,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_e,rt){const it=Math.cos(rt),nt=Math.sin(rt),st=1-it,at=_e.x,lt=_e.y,ot=_e.z,ct=st*at,ut=st*lt;return this.set(ct*at+it,ct*lt-nt*ot,ct*ot+nt*lt,0,ct*lt+nt*ot,ut*lt+it,ut*ot-nt*at,0,ct*ot-nt*lt,ut*ot+nt*at,st*ot*ot+it,0,0,0,0,1),this}makeScale(_e,rt,it){return this.set(_e,0,0,0,0,rt,0,0,0,0,it,0,0,0,0,1),this}makeShear(_e,rt,it,nt,st,at){return this.set(1,it,st,0,_e,1,at,0,rt,nt,1,0,0,0,0,1),this}compose(_e,rt,it){const nt=this.elements,st=rt._x,at=rt._y,lt=rt._z,ot=rt._w,ct=st+st,ut=at+at,ht=lt+lt,dt=st*ct,pt=st*ut,ft=st*ht,gt=at*ut,mt=at*ht,At=lt*ht,yt=ot*ct,bt=ot*ut,xt=ot*ht,vt=it.x,_t=it.y,Ct=it.z;return nt[0]=(1-(gt+At))*vt,nt[1]=(pt+xt)*vt,nt[2]=(ft-bt)*vt,nt[3]=0,nt[4]=(pt-xt)*_t,nt[5]=(1-(dt+At))*_t,nt[6]=(mt+yt)*_t,nt[7]=0,nt[8]=(ft+bt)*Ct,nt[9]=(mt-yt)*Ct,nt[10]=(1-(dt+gt))*Ct,nt[11]=0,nt[12]=_e.x,nt[13]=_e.y,nt[14]=_e.z,nt[15]=1,this}decompose(_e,rt,it){const nt=this.elements;let st=_v1$5.set(nt[0],nt[1],nt[2]).length();const at=_v1$5.set(nt[4],nt[5],nt[6]).length(),lt=_v1$5.set(nt[8],nt[9],nt[10]).length();this.determinant()<0&&(st=-st),_e.x=nt[12],_e.y=nt[13],_e.z=nt[14],_m1$2.copy(this);const ct=1/st,ut=1/at,ht=1/lt;return _m1$2.elements[0]*=ct,_m1$2.elements[1]*=ct,_m1$2.elements[2]*=ct,_m1$2.elements[4]*=ut,_m1$2.elements[5]*=ut,_m1$2.elements[6]*=ut,_m1$2.elements[8]*=ht,_m1$2.elements[9]*=ht,_m1$2.elements[10]*=ht,rt.setFromRotationMatrix(_m1$2),it.x=st,it.y=at,it.z=lt,this}makePerspective(_e,rt,it,nt,st,at,lt=WebGLCoordinateSystem){const ot=this.elements,ct=2*st/(rt-_e),ut=2*st/(it-nt),ht=(rt+_e)/(rt-_e),dt=(it+nt)/(it-nt);let pt,ft;if(lt===WebGLCoordinateSystem)pt=-(at+st)/(at-st),ft=-2*at*st/(at-st);else if(lt===WebGPUCoordinateSystem)pt=-at/(at-st),ft=-at*st/(at-st);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+lt);return ot[0]=ct,ot[4]=0,ot[8]=ht,ot[12]=0,ot[1]=0,ot[5]=ut,ot[9]=dt,ot[13]=0,ot[2]=0,ot[6]=0,ot[10]=pt,ot[14]=ft,ot[3]=0,ot[7]=0,ot[11]=-1,ot[15]=0,this}makeOrthographic(_e,rt,it,nt,st,at,lt=WebGLCoordinateSystem){const ot=this.elements,ct=1/(rt-_e),ut=1/(it-nt),ht=1/(at-st),dt=(rt+_e)*ct,pt=(it+nt)*ut;let ft,gt;if(lt===WebGLCoordinateSystem)ft=(at+st)*ht,gt=-2*ht;else if(lt===WebGPUCoordinateSystem)ft=st*ht,gt=-1*ht;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+lt);return ot[0]=2*ct,ot[4]=0,ot[8]=0,ot[12]=-dt,ot[1]=0,ot[5]=2*ut,ot[9]=0,ot[13]=-pt,ot[2]=0,ot[6]=0,ot[10]=gt,ot[14]=-ft,ot[3]=0,ot[7]=0,ot[11]=0,ot[15]=1,this}equals(_e){const rt=this.elements,it=_e.elements;for(let nt=0;nt<16;nt++)if(rt[nt]!==it[nt])return!1;return!0}fromArray(_e,rt=0){for(let it=0;it<16;it++)this.elements[it]=_e[it+rt];return this}toArray(_e=[],rt=0){const it=this.elements;return _e[rt]=it[0],_e[rt+1]=it[1],_e[rt+2]=it[2],_e[rt+3]=it[3],_e[rt+4]=it[4],_e[rt+5]=it[5],_e[rt+6]=it[6],_e[rt+7]=it[7],_e[rt+8]=it[8],_e[rt+9]=it[9],_e[rt+10]=it[10],_e[rt+11]=it[11],_e[rt+12]=it[12],_e[rt+13]=it[13],_e[rt+14]=it[14],_e[rt+15]=it[15],_e}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_e=0,rt=0,it=0,nt=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_e,this._y=rt,this._z=it,this._order=nt}get x(){return this._x}set x(_e){this._x=_e,this._onChangeCallback()}get y(){return this._y}set y(_e){this._y=_e,this._onChangeCallback()}get z(){return this._z}set z(_e){this._z=_e,this._onChangeCallback()}get order(){return this._order}set order(_e){this._order=_e,this._onChangeCallback()}set(_e,rt,it,nt=this._order){return this._x=_e,this._y=rt,this._z=it,this._order=nt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_e){return this._x=_e._x,this._y=_e._y,this._z=_e._z,this._order=_e._order,this._onChangeCallback(),this}setFromRotationMatrix(_e,rt=this._order,it=!0){const nt=_e.elements,st=nt[0],at=nt[4],lt=nt[8],ot=nt[1],ct=nt[5],ut=nt[9],ht=nt[2],dt=nt[6],pt=nt[10];switch(rt){case"XYZ":this._y=Math.asin(clamp$2(lt,-1,1)),Math.abs(lt)<.9999999?(this._x=Math.atan2(-ut,pt),this._z=Math.atan2(-at,st)):(this._x=Math.atan2(dt,ct),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$2(ut,-1,1)),Math.abs(ut)<.9999999?(this._y=Math.atan2(lt,pt),this._z=Math.atan2(ot,ct)):(this._y=Math.atan2(-ht,st),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$2(dt,-1,1)),Math.abs(dt)<.9999999?(this._y=Math.atan2(-ht,pt),this._z=Math.atan2(-at,ct)):(this._y=0,this._z=Math.atan2(ot,st));break;case"ZYX":this._y=Math.asin(-clamp$2(ht,-1,1)),Math.abs(ht)<.9999999?(this._x=Math.atan2(dt,pt),this._z=Math.atan2(ot,st)):(this._x=0,this._z=Math.atan2(-at,ct));break;case"YZX":this._z=Math.asin(clamp$2(ot,-1,1)),Math.abs(ot)<.9999999?(this._x=Math.atan2(-ut,ct),this._y=Math.atan2(-ht,st)):(this._x=0,this._y=Math.atan2(lt,pt));break;case"XZY":this._z=Math.asin(-clamp$2(at,-1,1)),Math.abs(at)<.9999999?(this._x=Math.atan2(dt,ct),this._y=Math.atan2(lt,st)):(this._x=Math.atan2(-ut,pt),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+rt)}return this._order=rt,it===!0&&this._onChangeCallback(),this}setFromQuaternion(_e,rt,it){return _matrix.makeRotationFromQuaternion(_e),this.setFromRotationMatrix(_matrix,rt,it)}setFromVector3(_e,rt=this._order){return this.set(_e.x,_e.y,_e.z,rt)}reorder(_e){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_e)}equals(_e){return _e._x===this._x&&_e._y===this._y&&_e._z===this._z&&_e._order===this._order}fromArray(_e){return this._x=_e[0],this._y=_e[1],this._z=_e[2],_e[3]!==void 0&&(this._order=_e[3]),this._onChangeCallback(),this}toArray(_e=[],rt=0){return _e[rt]=this._x,_e[rt+1]=this._y,_e[rt+2]=this._z,_e[rt+3]=this._order,_e}_onChange(_e){return this._onChangeCallback=_e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_e){this.mask=(1<<_e|0)>>>0}enable(_e){this.mask|=1<<_e|0}enableAll(){this.mask=-1}toggle(_e){this.mask^=1<<_e|0}disable(_e){this.mask&=~(1<<_e|0)}disableAll(){this.mask=0}test(_e){return(this.mask&_e.mask)!==0}isEnabled(_e){return(this.mask&(1<<_e|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID$1(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _e=new Vector3,rt=new Euler,it=new Quaternion,nt=new Vector3(1,1,1);function st(){it.setFromEuler(rt,!1)}function at(){rt.setFromQuaternion(it,void 0,!1)}rt._onChange(st),it._onChange(at),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_e},rotation:{configurable:!0,enumerable:!0,value:rt},quaternion:{configurable:!0,enumerable:!0,value:it},scale:{configurable:!0,enumerable:!0,value:nt},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(_e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_e){return this.quaternion.premultiply(_e),this}setRotationFromAxisAngle(_e,rt){this.quaternion.setFromAxisAngle(_e,rt)}setRotationFromEuler(_e){this.quaternion.setFromEuler(_e,!0)}setRotationFromMatrix(_e){this.quaternion.setFromRotationMatrix(_e)}setRotationFromQuaternion(_e){this.quaternion.copy(_e)}rotateOnAxis(_e,rt){return _q1.setFromAxisAngle(_e,rt),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(_e,rt){return _q1.setFromAxisAngle(_e,rt),this.quaternion.premultiply(_q1),this}rotateX(_e){return this.rotateOnAxis(_xAxis,_e)}rotateY(_e){return this.rotateOnAxis(_yAxis,_e)}rotateZ(_e){return this.rotateOnAxis(_zAxis,_e)}translateOnAxis(_e,rt){return _v1$4.copy(_e).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(rt)),this}translateX(_e){return this.translateOnAxis(_xAxis,_e)}translateY(_e){return this.translateOnAxis(_yAxis,_e)}translateZ(_e){return this.translateOnAxis(_zAxis,_e)}localToWorld(_e){return this.updateWorldMatrix(!0,!1),_e.applyMatrix4(this.matrixWorld)}worldToLocal(_e){return this.updateWorldMatrix(!0,!1),_e.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(_e,rt,it){_e.isVector3?_target.copy(_e):_target.set(_e,rt,it);const nt=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target,this.up):_m1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),nt&&(_m1$1.extractRotation(nt.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))}add(_e){if(arguments.length>1){for(let rt=0;rt<arguments.length;rt++)this.add(arguments[rt]);return this}return _e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_e),this):(_e&&_e.isObject3D?(_e.parent!==null&&_e.parent.remove(_e),_e.parent=this,this.children.push(_e),_e.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_e),this)}remove(_e){if(arguments.length>1){for(let it=0;it<arguments.length;it++)this.remove(arguments[it]);return this}const rt=this.children.indexOf(_e);return rt!==-1&&(_e.parent=null,this.children.splice(rt,1),_e.dispatchEvent(_removedEvent)),this}removeFromParent(){const _e=this.parent;return _e!==null&&_e.remove(this),this}clear(){for(let _e=0;_e<this.children.length;_e++){const rt=this.children[_e];rt.parent=null,rt.dispatchEvent(_removedEvent)}return this.children.length=0,this}attach(_e){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),_e.parent!==null&&(_e.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(_e.parent.matrixWorld)),_e.applyMatrix4(_m1$1),this.add(_e),_e.updateWorldMatrix(!1,!0),this}getObjectById(_e){return this.getObjectByProperty("id",_e)}getObjectByName(_e){return this.getObjectByProperty("name",_e)}getObjectByProperty(_e,rt){if(this[_e]===rt)return this;for(let it=0,nt=this.children.length;it<nt;it++){const at=this.children[it].getObjectByProperty(_e,rt);if(at!==void 0)return at}}getObjectsByProperty(_e,rt){let it=[];this[_e]===rt&&it.push(this);for(let nt=0,st=this.children.length;nt<st;nt++){const at=this.children[nt].getObjectsByProperty(_e,rt);at.length>0&&(it=it.concat(at))}return it}getWorldPosition(_e){return this.updateWorldMatrix(!0,!1),_e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_e,_scale$2),_e}getWorldScale(_e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_e),_e}getWorldDirection(_e){this.updateWorldMatrix(!0,!1);const rt=this.matrixWorld.elements;return _e.set(rt[8],rt[9],rt[10]).normalize()}raycast(){}traverse(_e){_e(this);const rt=this.children;for(let it=0,nt=rt.length;it<nt;it++)rt[it].traverse(_e)}traverseVisible(_e){if(this.visible===!1)return;_e(this);const rt=this.children;for(let it=0,nt=rt.length;it<nt;it++)rt[it].traverseVisible(_e)}traverseAncestors(_e){const rt=this.parent;rt!==null&&(_e(rt),rt.traverseAncestors(_e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,_e=!0);const rt=this.children;for(let it=0,nt=rt.length;it<nt;it++){const st=rt[it];(st.matrixWorldAutoUpdate===!0||_e===!0)&&st.updateMatrixWorld(_e)}}updateWorldMatrix(_e,rt){const it=this.parent;if(_e===!0&&it!==null&&it.matrixWorldAutoUpdate===!0&&it.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),rt===!0){const nt=this.children;for(let st=0,at=nt.length;st<at;st++){const lt=nt[st];lt.matrixWorldAutoUpdate===!0&&lt.updateWorldMatrix(!1,!0)}}}toJSON(_e){const rt=_e===void 0||typeof _e=="string",it={};rt&&(_e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},it.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const nt={};nt.uuid=this.uuid,nt.type=this.type,this.name!==""&&(nt.name=this.name),this.castShadow===!0&&(nt.castShadow=!0),this.receiveShadow===!0&&(nt.receiveShadow=!0),this.visible===!1&&(nt.visible=!1),this.frustumCulled===!1&&(nt.frustumCulled=!1),this.renderOrder!==0&&(nt.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(nt.userData=this.userData),nt.layers=this.layers.mask,nt.matrix=this.matrix.toArray(),nt.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(nt.matrixAutoUpdate=!1),this.isInstancedMesh&&(nt.type="InstancedMesh",nt.count=this.count,nt.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(nt.instanceColor=this.instanceColor.toJSON()));function st(lt,ot){return lt[ot.uuid]===void 0&&(lt[ot.uuid]=ot.toJSON(_e)),ot.uuid}if(this.isScene)this.background&&(this.background.isColor?nt.background=this.background.toJSON():this.background.isTexture&&(nt.background=this.background.toJSON(_e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(nt.environment=this.environment.toJSON(_e).uuid);else if(this.isMesh||this.isLine||this.isPoints){nt.geometry=st(_e.geometries,this.geometry);const lt=this.geometry.parameters;if(lt!==void 0&&lt.shapes!==void 0){const ot=lt.shapes;if(Array.isArray(ot))for(let ct=0,ut=ot.length;ct<ut;ct++){const ht=ot[ct];st(_e.shapes,ht)}else st(_e.shapes,ot)}}if(this.isSkinnedMesh&&(nt.bindMode=this.bindMode,nt.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(st(_e.skeletons,this.skeleton),nt.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const lt=[];for(let ot=0,ct=this.material.length;ot<ct;ot++)lt.push(st(_e.materials,this.material[ot]));nt.material=lt}else nt.material=st(_e.materials,this.material);if(this.children.length>0){nt.children=[];for(let lt=0;lt<this.children.length;lt++)nt.children.push(this.children[lt].toJSON(_e).object)}if(this.animations.length>0){nt.animations=[];for(let lt=0;lt<this.animations.length;lt++){const ot=this.animations[lt];nt.animations.push(st(_e.animations,ot))}}if(rt){const lt=at(_e.geometries),ot=at(_e.materials),ct=at(_e.textures),ut=at(_e.images),ht=at(_e.shapes),dt=at(_e.skeletons),pt=at(_e.animations),ft=at(_e.nodes);lt.length>0&&(it.geometries=lt),ot.length>0&&(it.materials=ot),ct.length>0&&(it.textures=ct),ut.length>0&&(it.images=ut),ht.length>0&&(it.shapes=ht),dt.length>0&&(it.skeletons=dt),pt.length>0&&(it.animations=pt),ft.length>0&&(it.nodes=ft)}return it.object=nt,it;function at(lt){const ot=[];for(const ct in lt){const ut=lt[ct];delete ut.metadata,ot.push(ut)}return ot}}clone(_e){return new this.constructor().copy(this,_e)}copy(_e,rt=!0){if(this.name=_e.name,this.up.copy(_e.up),this.position.copy(_e.position),this.rotation.order=_e.rotation.order,this.quaternion.copy(_e.quaternion),this.scale.copy(_e.scale),this.matrix.copy(_e.matrix),this.matrixWorld.copy(_e.matrixWorld),this.matrixAutoUpdate=_e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=_e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=_e.matrixWorldAutoUpdate,this.layers.mask=_e.layers.mask,this.visible=_e.visible,this.castShadow=_e.castShadow,this.receiveShadow=_e.receiveShadow,this.frustumCulled=_e.frustumCulled,this.renderOrder=_e.renderOrder,this.animations=_e.animations,this.userData=JSON.parse(JSON.stringify(_e.userData)),rt===!0)for(let it=0;it<_e.children.length;it++){const nt=_e.children[it];this.add(nt.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$1=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;let warnedGetUV=!1;class Triangle{constructor(_e=new Vector3,rt=new Vector3,it=new Vector3){this.a=_e,this.b=rt,this.c=it}static getNormal(_e,rt,it,nt){nt.subVectors(it,rt),_v0$1.subVectors(_e,rt),nt.cross(_v0$1);const st=nt.lengthSq();return st>0?nt.multiplyScalar(1/Math.sqrt(st)):nt.set(0,0,0)}static getBarycoord(_e,rt,it,nt,st){_v0$1.subVectors(nt,rt),_v1$3.subVectors(it,rt),_v2$2.subVectors(_e,rt);const at=_v0$1.dot(_v0$1),lt=_v0$1.dot(_v1$3),ot=_v0$1.dot(_v2$2),ct=_v1$3.dot(_v1$3),ut=_v1$3.dot(_v2$2),ht=at*ct-lt*lt;if(ht===0)return st.set(-2,-1,-1);const dt=1/ht,pt=(ct*ot-lt*ut)*dt,ft=(at*ut-lt*ot)*dt;return st.set(1-pt-ft,ft,pt)}static containsPoint(_e,rt,it,nt){return this.getBarycoord(_e,rt,it,nt,_v3$1),_v3$1.x>=0&&_v3$1.y>=0&&_v3$1.x+_v3$1.y<=1}static getUV(_e,rt,it,nt,st,at,lt,ot){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),this.getInterpolation(_e,rt,it,nt,st,at,lt,ot)}static getInterpolation(_e,rt,it,nt,st,at,lt,ot){return this.getBarycoord(_e,rt,it,nt,_v3$1),ot.setScalar(0),ot.addScaledVector(st,_v3$1.x),ot.addScaledVector(at,_v3$1.y),ot.addScaledVector(lt,_v3$1.z),ot}static isFrontFacing(_e,rt,it,nt){return _v0$1.subVectors(it,rt),_v1$3.subVectors(_e,rt),_v0$1.cross(_v1$3).dot(nt)<0}set(_e,rt,it){return this.a.copy(_e),this.b.copy(rt),this.c.copy(it),this}setFromPointsAndIndices(_e,rt,it,nt){return this.a.copy(_e[rt]),this.b.copy(_e[it]),this.c.copy(_e[nt]),this}setFromAttributeAndIndices(_e,rt,it,nt){return this.a.fromBufferAttribute(_e,rt),this.b.fromBufferAttribute(_e,it),this.c.fromBufferAttribute(_e,nt),this}clone(){return new this.constructor().copy(this)}copy(_e){return this.a.copy(_e.a),this.b.copy(_e.b),this.c.copy(_e.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(_e){return _e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_e){return Triangle.getNormal(this.a,this.b,this.c,_e)}getPlane(_e){return _e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_e,rt){return Triangle.getBarycoord(_e,this.a,this.b,this.c,rt)}getUV(_e,rt,it,nt,st){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),Triangle.getInterpolation(_e,this.a,this.b,this.c,rt,it,nt,st)}getInterpolation(_e,rt,it,nt,st){return Triangle.getInterpolation(_e,this.a,this.b,this.c,rt,it,nt,st)}containsPoint(_e){return Triangle.containsPoint(_e,this.a,this.b,this.c)}isFrontFacing(_e){return Triangle.isFrontFacing(this.a,this.b,this.c,_e)}intersectsBox(_e){return _e.intersectsTriangle(this)}closestPointToPoint(_e,rt){const it=this.a,nt=this.b,st=this.c;let at,lt;_vab.subVectors(nt,it),_vac.subVectors(st,it),_vap.subVectors(_e,it);const ot=_vab.dot(_vap),ct=_vac.dot(_vap);if(ot<=0&&ct<=0)return rt.copy(it);_vbp.subVectors(_e,nt);const ut=_vab.dot(_vbp),ht=_vac.dot(_vbp);if(ut>=0&&ht<=ut)return rt.copy(nt);const dt=ot*ht-ut*ct;if(dt<=0&&ot>=0&&ut<=0)return at=ot/(ot-ut),rt.copy(it).addScaledVector(_vab,at);_vcp.subVectors(_e,st);const pt=_vab.dot(_vcp),ft=_vac.dot(_vcp);if(ft>=0&&pt<=ft)return rt.copy(st);const gt=pt*ct-ot*ft;if(gt<=0&&ct>=0&&ft<=0)return lt=ct/(ct-ft),rt.copy(it).addScaledVector(_vac,lt);const mt=ut*ft-pt*ht;if(mt<=0&&ht-ut>=0&&pt-ft>=0)return _vbc.subVectors(st,nt),lt=(ht-ut)/(ht-ut+(pt-ft)),rt.copy(nt).addScaledVector(_vbc,lt);const At=1/(mt+gt+dt);return at=gt*At,lt=dt*At,rt.copy(it).addScaledVector(_vab,at).addScaledVector(_vac,lt)}equals(_e){return _e.a.equals(this.a)&&_e.b.equals(this.b)&&_e.c.equals(this.c)}}let materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:materialId++}),this.uuid=generateUUID$1(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_e){this._alphaTest>0!=_e>0&&this.version++,this._alphaTest=_e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_e){if(_e!==void 0)for(const rt in _e){const it=_e[rt];if(it===void 0){console.warn(`THREE.Material: parameter '${rt}' has value of undefined.`);continue}const nt=this[rt];if(nt===void 0){console.warn(`THREE.Material: '${rt}' is not a property of THREE.${this.type}.`);continue}nt&&nt.isColor?nt.set(it):nt&&nt.isVector3&&it&&it.isVector3?nt.copy(it):this[rt]=it}}toJSON(_e){const rt=_e===void 0||typeof _e=="string";rt&&(_e={textures:{},images:{}});const it={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};it.uuid=this.uuid,it.type=this.type,this.name!==""&&(it.name=this.name),this.color&&this.color.isColor&&(it.color=this.color.getHex()),this.roughness!==void 0&&(it.roughness=this.roughness),this.metalness!==void 0&&(it.metalness=this.metalness),this.sheen!==void 0&&(it.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(it.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(it.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(it.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(it.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(it.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(it.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(it.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(it.shininess=this.shininess),this.clearcoat!==void 0&&(it.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(it.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(it.clearcoatMap=this.clearcoatMap.toJSON(_e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(it.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(it.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_e).uuid,it.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(it.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(it.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(it.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(it.iridescenceMap=this.iridescenceMap.toJSON(_e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(it.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_e).uuid),this.anisotropy!==void 0&&(it.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(it.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(it.anisotropyMap=this.anisotropyMap.toJSON(_e).uuid),this.map&&this.map.isTexture&&(it.map=this.map.toJSON(_e).uuid),this.matcap&&this.matcap.isTexture&&(it.matcap=this.matcap.toJSON(_e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(it.alphaMap=this.alphaMap.toJSON(_e).uuid),this.lightMap&&this.lightMap.isTexture&&(it.lightMap=this.lightMap.toJSON(_e).uuid,it.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(it.aoMap=this.aoMap.toJSON(_e).uuid,it.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(it.bumpMap=this.bumpMap.toJSON(_e).uuid,it.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(it.normalMap=this.normalMap.toJSON(_e).uuid,it.normalMapType=this.normalMapType,it.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(it.displacementMap=this.displacementMap.toJSON(_e).uuid,it.displacementScale=this.displacementScale,it.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(it.roughnessMap=this.roughnessMap.toJSON(_e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(it.metalnessMap=this.metalnessMap.toJSON(_e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(it.emissiveMap=this.emissiveMap.toJSON(_e).uuid),this.specularMap&&this.specularMap.isTexture&&(it.specularMap=this.specularMap.toJSON(_e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(it.specularIntensityMap=this.specularIntensityMap.toJSON(_e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(it.specularColorMap=this.specularColorMap.toJSON(_e).uuid),this.envMap&&this.envMap.isTexture&&(it.envMap=this.envMap.toJSON(_e).uuid,this.combine!==void 0&&(it.combine=this.combine)),this.envMapIntensity!==void 0&&(it.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(it.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(it.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(it.gradientMap=this.gradientMap.toJSON(_e).uuid),this.transmission!==void 0&&(it.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(it.transmissionMap=this.transmissionMap.toJSON(_e).uuid),this.thickness!==void 0&&(it.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(it.thicknessMap=this.thicknessMap.toJSON(_e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(it.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(it.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(it.size=this.size),this.shadowSide!==null&&(it.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(it.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(it.blending=this.blending),this.side!==FrontSide&&(it.side=this.side),this.vertexColors&&(it.vertexColors=!0),this.opacity<1&&(it.opacity=this.opacity),this.transparent===!0&&(it.transparent=this.transparent),it.depthFunc=this.depthFunc,it.depthTest=this.depthTest,it.depthWrite=this.depthWrite,it.colorWrite=this.colorWrite,it.stencilWrite=this.stencilWrite,it.stencilWriteMask=this.stencilWriteMask,it.stencilFunc=this.stencilFunc,it.stencilRef=this.stencilRef,it.stencilFuncMask=this.stencilFuncMask,it.stencilFail=this.stencilFail,it.stencilZFail=this.stencilZFail,it.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(it.rotation=this.rotation),this.polygonOffset===!0&&(it.polygonOffset=!0),this.polygonOffsetFactor!==0&&(it.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(it.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(it.linewidth=this.linewidth),this.dashSize!==void 0&&(it.dashSize=this.dashSize),this.gapSize!==void 0&&(it.gapSize=this.gapSize),this.scale!==void 0&&(it.scale=this.scale),this.dithering===!0&&(it.dithering=!0),this.alphaTest>0&&(it.alphaTest=this.alphaTest),this.alphaHash===!0&&(it.alphaHash=this.alphaHash),this.alphaToCoverage===!0&&(it.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(it.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(it.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(it.wireframe=this.wireframe),this.wireframeLinewidth>1&&(it.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(it.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(it.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(it.flatShading=this.flatShading),this.visible===!1&&(it.visible=!1),this.toneMapped===!1&&(it.toneMapped=!1),this.fog===!1&&(it.fog=!1),Object.keys(this.userData).length>0&&(it.userData=this.userData);function nt(st){const at=[];for(const lt in st){const ot=st[lt];delete ot.metadata,at.push(ot)}return at}if(rt){const st=nt(_e.textures),at=nt(_e.images);st.length>0&&(it.textures=st),at.length>0&&(it.images=at)}return it}clone(){return new this.constructor().copy(this)}copy(_e){this.name=_e.name,this.blending=_e.blending,this.side=_e.side,this.vertexColors=_e.vertexColors,this.opacity=_e.opacity,this.transparent=_e.transparent,this.blendSrc=_e.blendSrc,this.blendDst=_e.blendDst,this.blendEquation=_e.blendEquation,this.blendSrcAlpha=_e.blendSrcAlpha,this.blendDstAlpha=_e.blendDstAlpha,this.blendEquationAlpha=_e.blendEquationAlpha,this.depthFunc=_e.depthFunc,this.depthTest=_e.depthTest,this.depthWrite=_e.depthWrite,this.stencilWriteMask=_e.stencilWriteMask,this.stencilFunc=_e.stencilFunc,this.stencilRef=_e.stencilRef,this.stencilFuncMask=_e.stencilFuncMask,this.stencilFail=_e.stencilFail,this.stencilZFail=_e.stencilZFail,this.stencilZPass=_e.stencilZPass,this.stencilWrite=_e.stencilWrite;const rt=_e.clippingPlanes;let it=null;if(rt!==null){const nt=rt.length;it=new Array(nt);for(let st=0;st!==nt;++st)it[st]=rt[st].clone()}return this.clippingPlanes=it,this.clipIntersection=_e.clipIntersection,this.clipShadows=_e.clipShadows,this.shadowSide=_e.shadowSide,this.colorWrite=_e.colorWrite,this.precision=_e.precision,this.polygonOffset=_e.polygonOffset,this.polygonOffsetFactor=_e.polygonOffsetFactor,this.polygonOffsetUnits=_e.polygonOffsetUnits,this.dithering=_e.dithering,this.alphaTest=_e.alphaTest,this.alphaHash=_e.alphaHash,this.alphaToCoverage=_e.alphaToCoverage,this.premultipliedAlpha=_e.premultipliedAlpha,this.forceSinglePass=_e.forceSinglePass,this.visible=_e.visible,this.toneMapped=_e.toneMapped,this.userData=JSON.parse(JSON.stringify(_e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_e){_e===!0&&this.version++}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(tt,_e,rt){return rt<0&&(rt+=1),rt>1&&(rt-=1),rt<1/6?tt+(_e-tt)*6*rt:rt<1/2?_e:rt<2/3?tt+(_e-tt)*6*(2/3-rt):tt}let Color$1=class{constructor(_e,rt,it){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_e,rt,it)}set(_e,rt,it){if(rt===void 0&&it===void 0){const nt=_e;nt&&nt.isColor?this.copy(nt):typeof nt=="number"?this.setHex(nt):typeof nt=="string"&&this.setStyle(nt)}else this.setRGB(_e,rt,it);return this}setScalar(_e){return this.r=_e,this.g=_e,this.b=_e,this}setHex(_e,rt=SRGBColorSpace){return _e=Math.floor(_e),this.r=(_e>>16&255)/255,this.g=(_e>>8&255)/255,this.b=(_e&255)/255,ColorManagement.toWorkingColorSpace(this,rt),this}setRGB(_e,rt,it,nt=ColorManagement.workingColorSpace){return this.r=_e,this.g=rt,this.b=it,ColorManagement.toWorkingColorSpace(this,nt),this}setHSL(_e,rt,it,nt=ColorManagement.workingColorSpace){if(_e=euclideanModulo(_e,1),rt=clamp$2(rt,0,1),it=clamp$2(it,0,1),rt===0)this.r=this.g=this.b=it;else{const st=it<=.5?it*(1+rt):it+rt-it*rt,at=2*it-st;this.r=hue2rgb(at,st,_e+1/3),this.g=hue2rgb(at,st,_e),this.b=hue2rgb(at,st,_e-1/3)}return ColorManagement.toWorkingColorSpace(this,nt),this}setStyle(_e,rt=SRGBColorSpace){function it(st){st!==void 0&&parseFloat(st)<1&&console.warn("THREE.Color: Alpha component of "+_e+" will be ignored.")}let nt;if(nt=/^(\w+)\(([^\)]*)\)/.exec(_e)){let st;const at=nt[1],lt=nt[2];switch(at){case"rgb":case"rgba":if(st=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(lt))return it(st[4]),this.setRGB(Math.min(255,parseInt(st[1],10))/255,Math.min(255,parseInt(st[2],10))/255,Math.min(255,parseInt(st[3],10))/255,rt);if(st=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(lt))return it(st[4]),this.setRGB(Math.min(100,parseInt(st[1],10))/100,Math.min(100,parseInt(st[2],10))/100,Math.min(100,parseInt(st[3],10))/100,rt);break;case"hsl":case"hsla":if(st=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(lt))return it(st[4]),this.setHSL(parseFloat(st[1])/360,parseFloat(st[2])/100,parseFloat(st[3])/100,rt);break;default:console.warn("THREE.Color: Unknown color model "+_e)}}else if(nt=/^\#([A-Fa-f\d]+)$/.exec(_e)){const st=nt[1],at=st.length;if(at===3)return this.setRGB(parseInt(st.charAt(0),16)/15,parseInt(st.charAt(1),16)/15,parseInt(st.charAt(2),16)/15,rt);if(at===6)return this.setHex(parseInt(st,16),rt);console.warn("THREE.Color: Invalid hex color "+_e)}else if(_e&&_e.length>0)return this.setColorName(_e,rt);return this}setColorName(_e,rt=SRGBColorSpace){const it=_colorKeywords[_e.toLowerCase()];return it!==void 0?this.setHex(it,rt):console.warn("THREE.Color: Unknown color "+_e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_e){return this.r=_e.r,this.g=_e.g,this.b=_e.b,this}copySRGBToLinear(_e){return this.r=SRGBToLinear(_e.r),this.g=SRGBToLinear(_e.g),this.b=SRGBToLinear(_e.b),this}copyLinearToSRGB(_e){return this.r=LinearToSRGB(_e.r),this.g=LinearToSRGB(_e.g),this.b=LinearToSRGB(_e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_e=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),_e),Math.round(clamp$2(_color.r*255,0,255))*65536+Math.round(clamp$2(_color.g*255,0,255))*256+Math.round(clamp$2(_color.b*255,0,255))}getHexString(_e=SRGBColorSpace){return("000000"+this.getHex(_e).toString(16)).slice(-6)}getHSL(_e,rt=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),rt);const it=_color.r,nt=_color.g,st=_color.b,at=Math.max(it,nt,st),lt=Math.min(it,nt,st);let ot,ct;const ut=(lt+at)/2;if(lt===at)ot=0,ct=0;else{const ht=at-lt;switch(ct=ut<=.5?ht/(at+lt):ht/(2-at-lt),at){case it:ot=(nt-st)/ht+(nt<st?6:0);break;case nt:ot=(st-it)/ht+2;break;case st:ot=(it-nt)/ht+4;break}ot/=6}return _e.h=ot,_e.s=ct,_e.l=ut,_e}getRGB(_e,rt=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),rt),_e.r=_color.r,_e.g=_color.g,_e.b=_color.b,_e}getStyle(_e=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),_e);const rt=_color.r,it=_color.g,nt=_color.b;return _e!==SRGBColorSpace?`color(${_e} ${rt.toFixed(3)} ${it.toFixed(3)} ${nt.toFixed(3)})`:`rgb(${Math.round(rt*255)},${Math.round(it*255)},${Math.round(nt*255)})`}offsetHSL(_e,rt,it){return this.getHSL(_hslA),_hslA.h+=_e,_hslA.s+=rt,_hslA.l+=it,this.setHSL(_hslA.h,_hslA.s,_hslA.l),this}add(_e){return this.r+=_e.r,this.g+=_e.g,this.b+=_e.b,this}addColors(_e,rt){return this.r=_e.r+rt.r,this.g=_e.g+rt.g,this.b=_e.b+rt.b,this}addScalar(_e){return this.r+=_e,this.g+=_e,this.b+=_e,this}sub(_e){return this.r=Math.max(0,this.r-_e.r),this.g=Math.max(0,this.g-_e.g),this.b=Math.max(0,this.b-_e.b),this}multiply(_e){return this.r*=_e.r,this.g*=_e.g,this.b*=_e.b,this}multiplyScalar(_e){return this.r*=_e,this.g*=_e,this.b*=_e,this}lerp(_e,rt){return this.r+=(_e.r-this.r)*rt,this.g+=(_e.g-this.g)*rt,this.b+=(_e.b-this.b)*rt,this}lerpColors(_e,rt,it){return this.r=_e.r+(rt.r-_e.r)*it,this.g=_e.g+(rt.g-_e.g)*it,this.b=_e.b+(rt.b-_e.b)*it,this}lerpHSL(_e,rt){this.getHSL(_hslA),_e.getHSL(_hslB);const it=lerp(_hslA.h,_hslB.h,rt),nt=lerp(_hslA.s,_hslB.s,rt),st=lerp(_hslA.l,_hslB.l,rt);return this.setHSL(it,nt,st),this}setFromVector3(_e){return this.r=_e.x,this.g=_e.y,this.b=_e.z,this}applyMatrix3(_e){const rt=this.r,it=this.g,nt=this.b,st=_e.elements;return this.r=st[0]*rt+st[3]*it+st[6]*nt,this.g=st[1]*rt+st[4]*it+st[7]*nt,this.b=st[2]*rt+st[5]*it+st[8]*nt,this}equals(_e){return _e.r===this.r&&_e.g===this.g&&_e.b===this.b}fromArray(_e,rt=0){return this.r=_e[rt],this.g=_e[rt+1],this.b=_e[rt+2],this}toArray(_e=[],rt=0){return _e[rt]=this.r,_e[rt+1]=this.g,_e[rt+2]=this.b,_e}fromBufferAttribute(_e,rt){return this.r=_e.getX(rt),this.g=_e.getY(rt),this.b=_e.getZ(rt),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const _color=new Color$1;Color$1.NAMES=_colorKeywords;class MeshBasicMaterial extends Material{constructor(_e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.fog=_e.fog,this}}const _tables=_generateTables();function _generateTables(){const tt=new ArrayBuffer(4),_e=new Float32Array(tt),rt=new Uint32Array(tt),it=new Uint32Array(512),nt=new Uint32Array(512);for(let ot=0;ot<256;++ot){const ct=ot-127;ct<-27?(it[ot]=0,it[ot|256]=32768,nt[ot]=24,nt[ot|256]=24):ct<-14?(it[ot]=1024>>-ct-14,it[ot|256]=1024>>-ct-14|32768,nt[ot]=-ct-1,nt[ot|256]=-ct-1):ct<=15?(it[ot]=ct+15<<10,it[ot|256]=ct+15<<10|32768,nt[ot]=13,nt[ot|256]=13):ct<128?(it[ot]=31744,it[ot|256]=64512,nt[ot]=24,nt[ot|256]=24):(it[ot]=31744,it[ot|256]=64512,nt[ot]=13,nt[ot|256]=13)}const st=new Uint32Array(2048),at=new Uint32Array(64),lt=new Uint32Array(64);for(let ot=1;ot<1024;++ot){let ct=ot<<13,ut=0;for(;!(ct&8388608);)ct<<=1,ut-=8388608;ct&=-8388609,ut+=947912704,st[ot]=ct|ut}for(let ot=1024;ot<2048;++ot)st[ot]=939524096+(ot-1024<<13);for(let ot=1;ot<31;++ot)at[ot]=ot<<23;at[31]=1199570944,at[32]=2147483648;for(let ot=33;ot<63;++ot)at[ot]=2147483648+(ot-32<<23);at[63]=3347054592;for(let ot=1;ot<64;++ot)ot!==32&&(lt[ot]=1024);return{floatView:_e,uint32View:rt,baseTable:it,shiftTable:nt,mantissaTable:st,exponentTable:at,offsetTable:lt}}function toHalfFloat(tt){Math.abs(tt)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),tt=clamp$2(tt,-65504,65504),_tables.floatView[0]=tt;const _e=_tables.uint32View[0],rt=_e>>23&511;return _tables.baseTable[rt]+((_e&8388607)>>_tables.shiftTable[rt])}function fromHalfFloat(tt){const _e=tt>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_e]+(tt&1023)]+_tables.exponentTable[_e],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$8=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(_e,rt,it=!1){if(Array.isArray(_e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_e,this.itemSize=rt,this.count=_e!==void 0?_e.length/rt:0,this.normalized=it,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(_e){_e===!0&&this.version++}setUsage(_e){return this.usage=_e,this}copy(_e){return this.name=_e.name,this.array=new _e.array.constructor(_e.array),this.itemSize=_e.itemSize,this.count=_e.count,this.normalized=_e.normalized,this.usage=_e.usage,this.gpuType=_e.gpuType,this}copyAt(_e,rt,it){_e*=this.itemSize,it*=rt.itemSize;for(let nt=0,st=this.itemSize;nt<st;nt++)this.array[_e+nt]=rt.array[it+nt];return this}copyArray(_e){return this.array.set(_e),this}applyMatrix3(_e){if(this.itemSize===2)for(let rt=0,it=this.count;rt<it;rt++)_vector2$1.fromBufferAttribute(this,rt),_vector2$1.applyMatrix3(_e),this.setXY(rt,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let rt=0,it=this.count;rt<it;rt++)_vector$8.fromBufferAttribute(this,rt),_vector$8.applyMatrix3(_e),this.setXYZ(rt,_vector$8.x,_vector$8.y,_vector$8.z);return this}applyMatrix4(_e){for(let rt=0,it=this.count;rt<it;rt++)_vector$8.fromBufferAttribute(this,rt),_vector$8.applyMatrix4(_e),this.setXYZ(rt,_vector$8.x,_vector$8.y,_vector$8.z);return this}applyNormalMatrix(_e){for(let rt=0,it=this.count;rt<it;rt++)_vector$8.fromBufferAttribute(this,rt),_vector$8.applyNormalMatrix(_e),this.setXYZ(rt,_vector$8.x,_vector$8.y,_vector$8.z);return this}transformDirection(_e){for(let rt=0,it=this.count;rt<it;rt++)_vector$8.fromBufferAttribute(this,rt),_vector$8.transformDirection(_e),this.setXYZ(rt,_vector$8.x,_vector$8.y,_vector$8.z);return this}set(_e,rt=0){return this.array.set(_e,rt),this}getX(_e){let rt=this.array[_e*this.itemSize];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setX(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize]=rt,this}getY(_e){let rt=this.array[_e*this.itemSize+1];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setY(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+1]=rt,this}getZ(_e){let rt=this.array[_e*this.itemSize+2];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setZ(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+2]=rt,this}getW(_e){let rt=this.array[_e*this.itemSize+3];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setW(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+3]=rt,this}setXY(_e,rt,it){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array)),this.array[_e+0]=rt,this.array[_e+1]=it,this}setXYZ(_e,rt,it,nt){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array),nt=normalize$5(nt,this.array)),this.array[_e+0]=rt,this.array[_e+1]=it,this.array[_e+2]=nt,this}setXYZW(_e,rt,it,nt,st){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array),nt=normalize$5(nt,this.array),st=normalize$5(st,this.array)),this.array[_e+0]=rt,this.array[_e+1]=it,this.array[_e+2]=nt,this.array[_e+3]=st,this}onUpload(_e){return this.onUploadCallback=_e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_e.name=this.name),this.usage!==StaticDrawUsage&&(_e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(_e.updateRange=this.updateRange),_e}}class Int8BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Int8Array(_e),rt,it)}}class Uint8BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Uint8Array(_e),rt,it)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Uint8ClampedArray(_e),rt,it)}}class Int16BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Int16Array(_e),rt,it)}}class Uint16BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Uint16Array(_e),rt,it)}}class Int32BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Int32Array(_e),rt,it)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Uint32Array(_e),rt,it)}}class Float16BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Uint16Array(_e),rt,it),this.isFloat16BufferAttribute=!0}getX(_e){let rt=fromHalfFloat(this.array[_e*this.itemSize]);return this.normalized&&(rt=denormalize(rt,this.array)),rt}setX(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize]=toHalfFloat(rt),this}getY(_e){let rt=fromHalfFloat(this.array[_e*this.itemSize+1]);return this.normalized&&(rt=denormalize(rt,this.array)),rt}setY(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+1]=toHalfFloat(rt),this}getZ(_e){let rt=fromHalfFloat(this.array[_e*this.itemSize+2]);return this.normalized&&(rt=denormalize(rt,this.array)),rt}setZ(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+2]=toHalfFloat(rt),this}getW(_e){let rt=fromHalfFloat(this.array[_e*this.itemSize+3]);return this.normalized&&(rt=denormalize(rt,this.array)),rt}setW(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.array[_e*this.itemSize+3]=toHalfFloat(rt),this}setXY(_e,rt,it){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array)),this.array[_e+0]=toHalfFloat(rt),this.array[_e+1]=toHalfFloat(it),this}setXYZ(_e,rt,it,nt){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array),nt=normalize$5(nt,this.array)),this.array[_e+0]=toHalfFloat(rt),this.array[_e+1]=toHalfFloat(it),this.array[_e+2]=toHalfFloat(nt),this}setXYZW(_e,rt,it,nt,st){return _e*=this.itemSize,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array),nt=normalize$5(nt,this.array),st=normalize$5(st,this.array)),this.array[_e+0]=toHalfFloat(rt),this.array[_e+1]=toHalfFloat(it),this.array[_e+2]=toHalfFloat(nt),this.array[_e+3]=toHalfFloat(st),this}}class Float32BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Float32Array(_e),rt,it)}}class Float64BufferAttribute extends BufferAttribute{constructor(_e,rt,it){super(new Float64Array(_e),rt,it)}}let _id$1=0;const _m1=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$1=new Box3,_boxMorphTargets=new Box3,_vector$7=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$1++}),this.uuid=generateUUID$1(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_e){return Array.isArray(_e)?this.index=new(arrayNeedsUint32(_e)?Uint32BufferAttribute:Uint16BufferAttribute)(_e,1):this.index=_e,this}getAttribute(_e){return this.attributes[_e]}setAttribute(_e,rt){return this.attributes[_e]=rt,this}deleteAttribute(_e){return delete this.attributes[_e],this}hasAttribute(_e){return this.attributes[_e]!==void 0}addGroup(_e,rt,it=0){this.groups.push({start:_e,count:rt,materialIndex:it})}clearGroups(){this.groups=[]}setDrawRange(_e,rt){this.drawRange.start=_e,this.drawRange.count=rt}applyMatrix4(_e){const rt=this.attributes.position;rt!==void 0&&(rt.applyMatrix4(_e),rt.needsUpdate=!0);const it=this.attributes.normal;if(it!==void 0){const st=new Matrix3().getNormalMatrix(_e);it.applyNormalMatrix(st),it.needsUpdate=!0}const nt=this.attributes.tangent;return nt!==void 0&&(nt.transformDirection(_e),nt.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_e){return _m1.makeRotationFromQuaternion(_e),this.applyMatrix4(_m1),this}rotateX(_e){return _m1.makeRotationX(_e),this.applyMatrix4(_m1),this}rotateY(_e){return _m1.makeRotationY(_e),this.applyMatrix4(_m1),this}rotateZ(_e){return _m1.makeRotationZ(_e),this.applyMatrix4(_m1),this}translate(_e,rt,it){return _m1.makeTranslation(_e,rt,it),this.applyMatrix4(_m1),this}scale(_e,rt,it){return _m1.makeScale(_e,rt,it),this.applyMatrix4(_m1),this}lookAt(_e){return _obj.lookAt(_e),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_e){const rt=[];for(let it=0,nt=_e.length;it<nt;it++){const st=_e[it];rt.push(st.x,st.y,st.z||0)}return this.setAttribute("position",new Float32BufferAttribute(rt,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _e=this.attributes.position,rt=this.morphAttributes.position;if(_e&&_e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_e!==void 0){if(this.boundingBox.setFromBufferAttribute(_e),rt)for(let it=0,nt=rt.length;it<nt;it++){const st=rt[it];_box$1.setFromBufferAttribute(st),this.morphTargetsRelative?(_vector$7.addVectors(this.boundingBox.min,_box$1.min),this.boundingBox.expandByPoint(_vector$7),_vector$7.addVectors(this.boundingBox.max,_box$1.max),this.boundingBox.expandByPoint(_vector$7)):(this.boundingBox.expandByPoint(_box$1.min),this.boundingBox.expandByPoint(_box$1.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _e=this.attributes.position,rt=this.morphAttributes.position;if(_e&&_e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Vector3,1/0);return}if(_e){const it=this.boundingSphere.center;if(_box$1.setFromBufferAttribute(_e),rt)for(let st=0,at=rt.length;st<at;st++){const lt=rt[st];_boxMorphTargets.setFromBufferAttribute(lt),this.morphTargetsRelative?(_vector$7.addVectors(_box$1.min,_boxMorphTargets.min),_box$1.expandByPoint(_vector$7),_vector$7.addVectors(_box$1.max,_boxMorphTargets.max),_box$1.expandByPoint(_vector$7)):(_box$1.expandByPoint(_boxMorphTargets.min),_box$1.expandByPoint(_boxMorphTargets.max))}_box$1.getCenter(it);let nt=0;for(let st=0,at=_e.count;st<at;st++)_vector$7.fromBufferAttribute(_e,st),nt=Math.max(nt,it.distanceToSquared(_vector$7));if(rt)for(let st=0,at=rt.length;st<at;st++){const lt=rt[st],ot=this.morphTargetsRelative;for(let ct=0,ut=lt.count;ct<ut;ct++)_vector$7.fromBufferAttribute(lt,ct),ot&&(_offset.fromBufferAttribute(_e,ct),_vector$7.add(_offset)),nt=Math.max(nt,it.distanceToSquared(_vector$7))}this.boundingSphere.radius=Math.sqrt(nt),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _e=this.index,rt=this.attributes;if(_e===null||rt.position===void 0||rt.normal===void 0||rt.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const it=_e.array,nt=rt.position.array,st=rt.normal.array,at=rt.uv.array,lt=nt.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*lt),4));const ot=this.getAttribute("tangent").array,ct=[],ut=[];for(let Tt=0;Tt<lt;Tt++)ct[Tt]=new Vector3,ut[Tt]=new Vector3;const ht=new Vector3,dt=new Vector3,pt=new Vector3,ft=new Vector2,gt=new Vector2,mt=new Vector2,At=new Vector3,yt=new Vector3;function bt(Tt,Mt,Rt){ht.fromArray(nt,Tt*3),dt.fromArray(nt,Mt*3),pt.fromArray(nt,Rt*3),ft.fromArray(at,Tt*2),gt.fromArray(at,Mt*2),mt.fromArray(at,Rt*2),dt.sub(ht),pt.sub(ht),gt.sub(ft),mt.sub(ft);const It=1/(gt.x*mt.y-mt.x*gt.y);isFinite(It)&&(At.copy(dt).multiplyScalar(mt.y).addScaledVector(pt,-gt.y).multiplyScalar(It),yt.copy(pt).multiplyScalar(gt.x).addScaledVector(dt,-mt.x).multiplyScalar(It),ct[Tt].add(At),ct[Mt].add(At),ct[Rt].add(At),ut[Tt].add(yt),ut[Mt].add(yt),ut[Rt].add(yt))}let xt=this.groups;xt.length===0&&(xt=[{start:0,count:it.length}]);for(let Tt=0,Mt=xt.length;Tt<Mt;++Tt){const Rt=xt[Tt],It=Rt.start,Ot=Rt.count;for(let Bt=It,Nt=It+Ot;Bt<Nt;Bt+=3)bt(it[Bt+0],it[Bt+1],it[Bt+2])}const vt=new Vector3,_t=new Vector3,Ct=new Vector3,St=new Vector3;function Et(Tt){Ct.fromArray(st,Tt*3),St.copy(Ct);const Mt=ct[Tt];vt.copy(Mt),vt.sub(Ct.multiplyScalar(Ct.dot(Mt))).normalize(),_t.crossVectors(St,Mt);const It=_t.dot(ut[Tt])<0?-1:1;ot[Tt*4]=vt.x,ot[Tt*4+1]=vt.y,ot[Tt*4+2]=vt.z,ot[Tt*4+3]=It}for(let Tt=0,Mt=xt.length;Tt<Mt;++Tt){const Rt=xt[Tt],It=Rt.start,Ot=Rt.count;for(let Bt=It,Nt=It+Ot;Bt<Nt;Bt+=3)Et(it[Bt+0]),Et(it[Bt+1]),Et(it[Bt+2])}}computeVertexNormals(){const _e=this.index,rt=this.getAttribute("position");if(rt!==void 0){let it=this.getAttribute("normal");if(it===void 0)it=new BufferAttribute(new Float32Array(rt.count*3),3),this.setAttribute("normal",it);else for(let dt=0,pt=it.count;dt<pt;dt++)it.setXYZ(dt,0,0,0);const nt=new Vector3,st=new Vector3,at=new Vector3,lt=new Vector3,ot=new Vector3,ct=new Vector3,ut=new Vector3,ht=new Vector3;if(_e)for(let dt=0,pt=_e.count;dt<pt;dt+=3){const ft=_e.getX(dt+0),gt=_e.getX(dt+1),mt=_e.getX(dt+2);nt.fromBufferAttribute(rt,ft),st.fromBufferAttribute(rt,gt),at.fromBufferAttribute(rt,mt),ut.subVectors(at,st),ht.subVectors(nt,st),ut.cross(ht),lt.fromBufferAttribute(it,ft),ot.fromBufferAttribute(it,gt),ct.fromBufferAttribute(it,mt),lt.add(ut),ot.add(ut),ct.add(ut),it.setXYZ(ft,lt.x,lt.y,lt.z),it.setXYZ(gt,ot.x,ot.y,ot.z),it.setXYZ(mt,ct.x,ct.y,ct.z)}else for(let dt=0,pt=rt.count;dt<pt;dt+=3)nt.fromBufferAttribute(rt,dt+0),st.fromBufferAttribute(rt,dt+1),at.fromBufferAttribute(rt,dt+2),ut.subVectors(at,st),ht.subVectors(nt,st),ut.cross(ht),it.setXYZ(dt+0,ut.x,ut.y,ut.z),it.setXYZ(dt+1,ut.x,ut.y,ut.z),it.setXYZ(dt+2,ut.x,ut.y,ut.z);this.normalizeNormals(),it.needsUpdate=!0}}normalizeNormals(){const _e=this.attributes.normal;for(let rt=0,it=_e.count;rt<it;rt++)_vector$7.fromBufferAttribute(_e,rt),_vector$7.normalize(),_e.setXYZ(rt,_vector$7.x,_vector$7.y,_vector$7.z)}toNonIndexed(){function _e(lt,ot){const ct=lt.array,ut=lt.itemSize,ht=lt.normalized,dt=new ct.constructor(ot.length*ut);let pt=0,ft=0;for(let gt=0,mt=ot.length;gt<mt;gt++){lt.isInterleavedBufferAttribute?pt=ot[gt]*lt.data.stride+lt.offset:pt=ot[gt]*ut;for(let At=0;At<ut;At++)dt[ft++]=ct[pt++]}return new BufferAttribute(dt,ut,ht)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const rt=new BufferGeometry,it=this.index.array,nt=this.attributes;for(const lt in nt){const ot=nt[lt],ct=_e(ot,it);rt.setAttribute(lt,ct)}const st=this.morphAttributes;for(const lt in st){const ot=[],ct=st[lt];for(let ut=0,ht=ct.length;ut<ht;ut++){const dt=ct[ut],pt=_e(dt,it);ot.push(pt)}rt.morphAttributes[lt]=ot}rt.morphTargetsRelative=this.morphTargetsRelative;const at=this.groups;for(let lt=0,ot=at.length;lt<ot;lt++){const ct=at[lt];rt.addGroup(ct.start,ct.count,ct.materialIndex)}return rt}toJSON(){const _e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_e.uuid=this.uuid,_e.type=this.type,this.name!==""&&(_e.name=this.name),Object.keys(this.userData).length>0&&(_e.userData=this.userData),this.parameters!==void 0){const ot=this.parameters;for(const ct in ot)ot[ct]!==void 0&&(_e[ct]=ot[ct]);return _e}_e.data={attributes:{}};const rt=this.index;rt!==null&&(_e.data.index={type:rt.array.constructor.name,array:Array.prototype.slice.call(rt.array)});const it=this.attributes;for(const ot in it){const ct=it[ot];_e.data.attributes[ot]=ct.toJSON(_e.data)}const nt={};let st=!1;for(const ot in this.morphAttributes){const ct=this.morphAttributes[ot],ut=[];for(let ht=0,dt=ct.length;ht<dt;ht++){const pt=ct[ht];ut.push(pt.toJSON(_e.data))}ut.length>0&&(nt[ot]=ut,st=!0)}st&&(_e.data.morphAttributes=nt,_e.data.morphTargetsRelative=this.morphTargetsRelative);const at=this.groups;at.length>0&&(_e.data.groups=JSON.parse(JSON.stringify(at)));const lt=this.boundingSphere;return lt!==null&&(_e.data.boundingSphere={center:lt.center.toArray(),radius:lt.radius}),_e}clone(){return new this.constructor().copy(this)}copy(_e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const rt={};this.name=_e.name;const it=_e.index;it!==null&&this.setIndex(it.clone(rt));const nt=_e.attributes;for(const ct in nt){const ut=nt[ct];this.setAttribute(ct,ut.clone(rt))}const st=_e.morphAttributes;for(const ct in st){const ut=[],ht=st[ct];for(let dt=0,pt=ht.length;dt<pt;dt++)ut.push(ht[dt].clone(rt));this.morphAttributes[ct]=ut}this.morphTargetsRelative=_e.morphTargetsRelative;const at=_e.groups;for(let ct=0,ut=at.length;ct<ut;ct++){const ht=at[ct];this.addGroup(ht.start,ht.count,ht.materialIndex)}const lt=_e.boundingBox;lt!==null&&(this.boundingBox=lt.clone());const ot=_e.boundingSphere;return ot!==null&&(this.boundingSphere=ot.clone()),this.drawRange.start=_e.drawRange.start,this.drawRange.count=_e.drawRange.count,this.userData=_e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray$1,_sphere$5=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_e=new BufferGeometry,rt=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_e,this.material=rt,this.updateMorphTargets()}copy(_e,rt){return super.copy(_e,rt),_e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_e.morphTargetInfluences.slice()),_e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_e.morphTargetDictionary)),this.material=_e.material,this.geometry=_e.geometry,this}updateMorphTargets(){const rt=this.geometry.morphAttributes,it=Object.keys(rt);if(it.length>0){const nt=rt[it[0]];if(nt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,at=nt.length;st<at;st++){const lt=nt[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[lt]=st}}}}getVertexPosition(_e,rt){const it=this.geometry,nt=it.attributes.position,st=it.morphAttributes.position,at=it.morphTargetsRelative;rt.fromBufferAttribute(nt,_e);const lt=this.morphTargetInfluences;if(st&&lt){_morphA.set(0,0,0);for(let ot=0,ct=st.length;ot<ct;ot++){const ut=lt[ot],ht=st[ot];ut!==0&&(_tempA.fromBufferAttribute(ht,_e),at?_morphA.addScaledVector(_tempA,ut):_morphA.addScaledVector(_tempA.sub(rt),ut))}rt.add(_morphA)}return rt}raycast(_e,rt){const it=this.geometry,nt=this.material,st=this.matrixWorld;nt!==void 0&&(it.boundingSphere===null&&it.computeBoundingSphere(),_sphere$5.copy(it.boundingSphere),_sphere$5.applyMatrix4(st),_ray$3.copy(_e.ray).recast(_e.near),!(_sphere$5.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$5,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(_e.far-_e.near)**2))&&(_inverseMatrix$3.copy(st).invert(),_ray$3.copy(_e.ray).applyMatrix4(_inverseMatrix$3),!(it.boundingBox!==null&&_ray$3.intersectsBox(it.boundingBox)===!1)&&this._computeIntersections(_e,rt,_ray$3)))}_computeIntersections(_e,rt,it){let nt;const st=this.geometry,at=this.material,lt=st.index,ot=st.attributes.position,ct=st.attributes.uv,ut=st.attributes.uv1,ht=st.attributes.normal,dt=st.groups,pt=st.drawRange;if(lt!==null)if(Array.isArray(at))for(let ft=0,gt=dt.length;ft<gt;ft++){const mt=dt[ft],At=at[mt.materialIndex],yt=Math.max(mt.start,pt.start),bt=Math.min(lt.count,Math.min(mt.start+mt.count,pt.start+pt.count));for(let xt=yt,vt=bt;xt<vt;xt+=3){const _t=lt.getX(xt),Ct=lt.getX(xt+1),St=lt.getX(xt+2);nt=checkGeometryIntersection(this,At,_e,it,ct,ut,ht,_t,Ct,St),nt&&(nt.faceIndex=Math.floor(xt/3),nt.face.materialIndex=mt.materialIndex,rt.push(nt))}}else{const ft=Math.max(0,pt.start),gt=Math.min(lt.count,pt.start+pt.count);for(let mt=ft,At=gt;mt<At;mt+=3){const yt=lt.getX(mt),bt=lt.getX(mt+1),xt=lt.getX(mt+2);nt=checkGeometryIntersection(this,at,_e,it,ct,ut,ht,yt,bt,xt),nt&&(nt.faceIndex=Math.floor(mt/3),rt.push(nt))}}else if(ot!==void 0)if(Array.isArray(at))for(let ft=0,gt=dt.length;ft<gt;ft++){const mt=dt[ft],At=at[mt.materialIndex],yt=Math.max(mt.start,pt.start),bt=Math.min(ot.count,Math.min(mt.start+mt.count,pt.start+pt.count));for(let xt=yt,vt=bt;xt<vt;xt+=3){const _t=xt,Ct=xt+1,St=xt+2;nt=checkGeometryIntersection(this,At,_e,it,ct,ut,ht,_t,Ct,St),nt&&(nt.faceIndex=Math.floor(xt/3),nt.face.materialIndex=mt.materialIndex,rt.push(nt))}}else{const ft=Math.max(0,pt.start),gt=Math.min(ot.count,pt.start+pt.count);for(let mt=ft,At=gt;mt<At;mt+=3){const yt=mt,bt=mt+1,xt=mt+2;nt=checkGeometryIntersection(this,at,_e,it,ct,ut,ht,yt,bt,xt),nt&&(nt.faceIndex=Math.floor(mt/3),rt.push(nt))}}}}function checkIntersection(tt,_e,rt,it,nt,st,at,lt){let ot;if(_e.side===BackSide?ot=it.intersectTriangle(at,st,nt,!0,lt):ot=it.intersectTriangle(nt,st,at,_e.side===FrontSide,lt),ot===null)return null;_intersectionPointWorld.copy(lt),_intersectionPointWorld.applyMatrix4(tt.matrixWorld);const ct=rt.ray.origin.distanceTo(_intersectionPointWorld);return ct<rt.near||ct>rt.far?null:{distance:ct,point:_intersectionPointWorld.clone(),object:tt}}function checkGeometryIntersection(tt,_e,rt,it,nt,st,at,lt,ot,ct){tt.getVertexPosition(lt,_vA$1),tt.getVertexPosition(ot,_vB$1),tt.getVertexPosition(ct,_vC$1);const ut=checkIntersection(tt,_e,rt,it,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(ut){nt&&(_uvA$1.fromBufferAttribute(nt,lt),_uvB$1.fromBufferAttribute(nt,ot),_uvC$1.fromBufferAttribute(nt,ct),ut.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),st&&(_uvA$1.fromBufferAttribute(st,lt),_uvB$1.fromBufferAttribute(st,ot),_uvC$1.fromBufferAttribute(st,ct),ut.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),ut.uv2=ut.uv1),at&&(_normalA.fromBufferAttribute(at,lt),_normalB.fromBufferAttribute(at,ot),_normalC.fromBufferAttribute(at,ct),ut.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),ut.normal.dot(it.direction)>0&&ut.normal.multiplyScalar(-1));const ht={a:lt,b:ot,c:ct,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,ht.normal),ut.face=ht}return ut}class BoxGeometry extends BufferGeometry{constructor(_e=1,rt=1,it=1,nt=1,st=1,at=1){super(),this.type="BoxGeometry",this.parameters={width:_e,height:rt,depth:it,widthSegments:nt,heightSegments:st,depthSegments:at};const lt=this;nt=Math.floor(nt),st=Math.floor(st),at=Math.floor(at);const ot=[],ct=[],ut=[],ht=[];let dt=0,pt=0;ft("z","y","x",-1,-1,it,rt,_e,at,st,0),ft("z","y","x",1,-1,it,rt,-_e,at,st,1),ft("x","z","y",1,1,_e,it,rt,nt,at,2),ft("x","z","y",1,-1,_e,it,-rt,nt,at,3),ft("x","y","z",1,-1,_e,rt,it,nt,st,4),ft("x","y","z",-1,-1,_e,rt,-it,nt,st,5),this.setIndex(ot),this.setAttribute("position",new Float32BufferAttribute(ct,3)),this.setAttribute("normal",new Float32BufferAttribute(ut,3)),this.setAttribute("uv",new Float32BufferAttribute(ht,2));function ft(gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et){const Tt=xt/Ct,Mt=vt/St,Rt=xt/2,It=vt/2,Ot=_t/2,Bt=Ct+1,Nt=St+1;let zt=0,Dt=0;const Ft=new Vector3;for(let Ut=0;Ut<Nt;Ut++){const $t=Ut*Mt-It;for(let Vt=0;Vt<Bt;Vt++){const Zt=Vt*Tt-Rt;Ft[gt]=Zt*yt,Ft[mt]=$t*bt,Ft[At]=Ot,ct.push(Ft.x,Ft.y,Ft.z),Ft[gt]=0,Ft[mt]=0,Ft[At]=_t>0?1:-1,ut.push(Ft.x,Ft.y,Ft.z),ht.push(Vt/Ct),ht.push(1-Ut/St),zt+=1}}for(let Ut=0;Ut<St;Ut++)for(let $t=0;$t<Ct;$t++){const Vt=dt+$t+Bt*Ut,Zt=dt+$t+Bt*(Ut+1),qt=dt+($t+1)+Bt*(Ut+1),sr=dt+($t+1)+Bt*Ut;ot.push(Vt,Zt,sr),ot.push(Zt,qt,sr),Dt+=6}lt.addGroup(pt,Dt,Et),pt+=Dt,dt+=zt}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new BoxGeometry(_e.width,_e.height,_e.depth,_e.widthSegments,_e.heightSegments,_e.depthSegments)}}function cloneUniforms(tt){const _e={};for(const rt in tt){_e[rt]={};for(const it in tt[rt]){const nt=tt[rt][it];nt&&(nt.isColor||nt.isMatrix3||nt.isMatrix4||nt.isVector2||nt.isVector3||nt.isVector4||nt.isTexture||nt.isQuaternion)?nt.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_e[rt][it]=null):_e[rt][it]=nt.clone():Array.isArray(nt)?_e[rt][it]=nt.slice():_e[rt][it]=nt}}return _e}function mergeUniforms(tt){const _e={};for(let rt=0;rt<tt.length;rt++){const it=cloneUniforms(tt[rt]);for(const nt in it)_e[nt]=it[nt]}return _e}function cloneUniformsGroups(tt){const _e=[];for(let rt=0;rt<tt.length;rt++)_e.push(tt[rt].clone());return _e}function getUnlitUniformColorSpace(tt){return tt.getRenderTarget()===null?tt.outputColorSpace:LinearSRGBColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(_e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_e!==void 0&&this.setValues(_e)}copy(_e){return super.copy(_e),this.fragmentShader=_e.fragmentShader,this.vertexShader=_e.vertexShader,this.uniforms=cloneUniforms(_e.uniforms),this.uniformsGroups=cloneUniformsGroups(_e.uniformsGroups),this.defines=Object.assign({},_e.defines),this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.fog=_e.fog,this.lights=_e.lights,this.clipping=_e.clipping,this.extensions=Object.assign({},_e.extensions),this.glslVersion=_e.glslVersion,this}toJSON(_e){const rt=super.toJSON(_e);rt.glslVersion=this.glslVersion,rt.uniforms={};for(const nt in this.uniforms){const at=this.uniforms[nt].value;at&&at.isTexture?rt.uniforms[nt]={type:"t",value:at.toJSON(_e).uuid}:at&&at.isColor?rt.uniforms[nt]={type:"c",value:at.getHex()}:at&&at.isVector2?rt.uniforms[nt]={type:"v2",value:at.toArray()}:at&&at.isVector3?rt.uniforms[nt]={type:"v3",value:at.toArray()}:at&&at.isVector4?rt.uniforms[nt]={type:"v4",value:at.toArray()}:at&&at.isMatrix3?rt.uniforms[nt]={type:"m3",value:at.toArray()}:at&&at.isMatrix4?rt.uniforms[nt]={type:"m4",value:at.toArray()}:rt.uniforms[nt]={value:at}}Object.keys(this.defines).length>0&&(rt.defines=this.defines),rt.vertexShader=this.vertexShader,rt.fragmentShader=this.fragmentShader,rt.lights=this.lights,rt.clipping=this.clipping;const it={};for(const nt in this.extensions)this.extensions[nt]===!0&&(it[nt]=!0);return Object.keys(it).length>0&&(rt.extensions=it),rt}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(_e,rt){return super.copy(_e,rt),this.matrixWorldInverse.copy(_e.matrixWorldInverse),this.projectionMatrix.copy(_e.projectionMatrix),this.projectionMatrixInverse.copy(_e.projectionMatrixInverse),this.coordinateSystem=_e.coordinateSystem,this}getWorldDirection(_e){this.updateWorldMatrix(!0,!1);const rt=this.matrixWorld.elements;return _e.set(-rt[8],-rt[9],-rt[10]).normalize()}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_e,rt){super.updateWorldMatrix(_e,rt),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class PerspectiveCamera extends Camera{constructor(_e=50,rt=1,it=.1,nt=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_e,this.zoom=1,this.near=it,this.far=nt,this.focus=10,this.aspect=rt,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_e,rt){return super.copy(_e,rt),this.fov=_e.fov,this.zoom=_e.zoom,this.near=_e.near,this.far=_e.far,this.focus=_e.focus,this.aspect=_e.aspect,this.view=_e.view===null?null:Object.assign({},_e.view),this.filmGauge=_e.filmGauge,this.filmOffset=_e.filmOffset,this}setFocalLength(_e){const rt=.5*this.getFilmHeight()/_e;this.fov=RAD2DEG*2*Math.atan(rt),this.updateProjectionMatrix()}getFocalLength(){const _e=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_e}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(_e,rt,it,nt,st,at){this.aspect=_e/rt,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_e,this.view.fullHeight=rt,this.view.offsetX=it,this.view.offsetY=nt,this.view.width=st,this.view.height=at,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _e=this.near;let rt=_e*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,it=2*rt,nt=this.aspect*it,st=-.5*nt;const at=this.view;if(this.view!==null&&this.view.enabled){const ot=at.fullWidth,ct=at.fullHeight;st+=at.offsetX*nt/ot,rt-=at.offsetY*it/ct,nt*=at.width/ot,it*=at.height/ct}const lt=this.filmOffset;lt!==0&&(st+=_e*lt/this.getFilmWidth()),this.projectionMatrix.makePerspective(st,st+nt,rt,rt-it,_e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_e){const rt=super.toJSON(_e);return rt.object.fov=this.fov,rt.object.zoom=this.zoom,rt.object.near=this.near,rt.object.far=this.far,rt.object.focus=this.focus,rt.object.aspect=this.aspect,this.view!==null&&(rt.object.view=Object.assign({},this.view)),rt.object.filmGauge=this.filmGauge,rt.object.filmOffset=this.filmOffset,rt}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(_e,rt,it){super(),this.type="CubeCamera",this.renderTarget=it,this.coordinateSystem=null;const nt=new PerspectiveCamera(fov,aspect,_e,rt);nt.layers=this.layers,this.add(nt);const st=new PerspectiveCamera(fov,aspect,_e,rt);st.layers=this.layers,this.add(st);const at=new PerspectiveCamera(fov,aspect,_e,rt);at.layers=this.layers,this.add(at);const lt=new PerspectiveCamera(fov,aspect,_e,rt);lt.layers=this.layers,this.add(lt);const ot=new PerspectiveCamera(fov,aspect,_e,rt);ot.layers=this.layers,this.add(ot);const ct=new PerspectiveCamera(fov,aspect,_e,rt);ct.layers=this.layers,this.add(ct)}updateCoordinateSystem(){const _e=this.coordinateSystem,rt=this.children.concat(),[it,nt,st,at,lt,ot]=rt;for(const ct of rt)this.remove(ct);if(_e===WebGLCoordinateSystem)it.up.set(0,1,0),it.lookAt(1,0,0),nt.up.set(0,1,0),nt.lookAt(-1,0,0),st.up.set(0,0,-1),st.lookAt(0,1,0),at.up.set(0,0,1),at.lookAt(0,-1,0),lt.up.set(0,1,0),lt.lookAt(0,0,1),ot.up.set(0,1,0),ot.lookAt(0,0,-1);else if(_e===WebGPUCoordinateSystem)it.up.set(0,-1,0),it.lookAt(-1,0,0),nt.up.set(0,-1,0),nt.lookAt(1,0,0),st.up.set(0,0,1),st.lookAt(0,1,0),at.up.set(0,0,-1),at.lookAt(0,-1,0),lt.up.set(0,-1,0),lt.lookAt(0,0,1),ot.up.set(0,-1,0),ot.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_e);for(const ct of rt)this.add(ct),ct.updateMatrixWorld()}update(_e,rt){this.parent===null&&this.updateMatrixWorld();const it=this.renderTarget;this.coordinateSystem!==_e.coordinateSystem&&(this.coordinateSystem=_e.coordinateSystem,this.updateCoordinateSystem());const[nt,st,at,lt,ot,ct]=this.children,ut=_e.getRenderTarget(),ht=_e.toneMapping,dt=_e.xr.enabled;_e.toneMapping=NoToneMapping,_e.xr.enabled=!1;const pt=it.texture.generateMipmaps;it.texture.generateMipmaps=!1,_e.setRenderTarget(it,0),_e.render(rt,nt),_e.setRenderTarget(it,1),_e.render(rt,st),_e.setRenderTarget(it,2),_e.render(rt,at),_e.setRenderTarget(it,3),_e.render(rt,lt),_e.setRenderTarget(it,4),_e.render(rt,ot),it.texture.generateMipmaps=pt,_e.setRenderTarget(it,5),_e.render(rt,ct),_e.setRenderTarget(ut),_e.toneMapping=ht,_e.xr.enabled=dt,it.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(_e,rt,it,nt,st,at,lt,ot,ct,ut){_e=_e!==void 0?_e:[],rt=rt!==void 0?rt:CubeReflectionMapping,super(_e,rt,it,nt,st,at,lt,ot,ct,ut),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_e){this.image=_e}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_e=1,rt={}){super(_e,_e,rt),this.isWebGLCubeRenderTarget=!0;const it={width:_e,height:_e,depth:1},nt=[it,it,it,it,it,it];rt.encoding!==void 0&&(warnOnce("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),rt.colorSpace=rt.encoding===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.texture=new CubeTexture(nt,rt.mapping,rt.wrapS,rt.wrapT,rt.magFilter,rt.minFilter,rt.format,rt.type,rt.anisotropy,rt.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=rt.generateMipmaps!==void 0?rt.generateMipmaps:!1,this.texture.minFilter=rt.minFilter!==void 0?rt.minFilter:LinearFilter}fromEquirectangularTexture(_e,rt){this.texture.type=rt.type,this.texture.colorSpace=rt.colorSpace,this.texture.generateMipmaps=rt.generateMipmaps,this.texture.minFilter=rt.minFilter,this.texture.magFilter=rt.magFilter;const it={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},nt=new BoxGeometry(5,5,5),st=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(it.uniforms),vertexShader:it.vertexShader,fragmentShader:it.fragmentShader,side:BackSide,blending:NoBlending});st.uniforms.tEquirect.value=rt;const at=new Mesh(nt,st),lt=rt.minFilter;return rt.minFilter===LinearMipmapLinearFilter&&(rt.minFilter=LinearFilter),new CubeCamera(1,10,this).update(_e,at),rt.minFilter=lt,at.geometry.dispose(),at.material.dispose(),this}clear(_e,rt,it,nt){const st=_e.getRenderTarget();for(let at=0;at<6;at++)_e.setRenderTarget(this,at),_e.clear(rt,it,nt);_e.setRenderTarget(st)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(_e=new Vector3(1,0,0),rt=0){this.isPlane=!0,this.normal=_e,this.constant=rt}set(_e,rt){return this.normal.copy(_e),this.constant=rt,this}setComponents(_e,rt,it,nt){return this.normal.set(_e,rt,it),this.constant=nt,this}setFromNormalAndCoplanarPoint(_e,rt){return this.normal.copy(_e),this.constant=-rt.dot(this.normal),this}setFromCoplanarPoints(_e,rt,it){const nt=_vector1.subVectors(it,rt).cross(_vector2.subVectors(_e,rt)).normalize();return this.setFromNormalAndCoplanarPoint(nt,_e),this}copy(_e){return this.normal.copy(_e.normal),this.constant=_e.constant,this}normalize(){const _e=1/this.normal.length();return this.normal.multiplyScalar(_e),this.constant*=_e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_e){return this.normal.dot(_e)+this.constant}distanceToSphere(_e){return this.distanceToPoint(_e.center)-_e.radius}projectPoint(_e,rt){return rt.copy(_e).addScaledVector(this.normal,-this.distanceToPoint(_e))}intersectLine(_e,rt){const it=_e.delta(_vector1),nt=this.normal.dot(it);if(nt===0)return this.distanceToPoint(_e.start)===0?rt.copy(_e.start):null;const st=-(_e.start.dot(this.normal)+this.constant)/nt;return st<0||st>1?null:rt.copy(_e.start).addScaledVector(it,st)}intersectsLine(_e){const rt=this.distanceToPoint(_e.start),it=this.distanceToPoint(_e.end);return rt<0&&it>0||it<0&&rt>0}intersectsBox(_e){return _e.intersectsPlane(this)}intersectsSphere(_e){return _e.intersectsPlane(this)}coplanarPoint(_e){return _e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_e,rt){const it=rt||_normalMatrix.getNormalMatrix(_e),nt=this.coplanarPoint(_vector1).applyMatrix4(_e),st=this.normal.applyMatrix3(it).normalize();return this.constant=-nt.dot(st),this}translate(_e){return this.constant-=_e.dot(this.normal),this}equals(_e){return _e.normal.equals(this.normal)&&_e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$4=new Sphere,_vector$6=new Vector3;class Frustum{constructor(_e=new Plane,rt=new Plane,it=new Plane,nt=new Plane,st=new Plane,at=new Plane){this.planes=[_e,rt,it,nt,st,at]}set(_e,rt,it,nt,st,at){const lt=this.planes;return lt[0].copy(_e),lt[1].copy(rt),lt[2].copy(it),lt[3].copy(nt),lt[4].copy(st),lt[5].copy(at),this}copy(_e){const rt=this.planes;for(let it=0;it<6;it++)rt[it].copy(_e.planes[it]);return this}setFromProjectionMatrix(_e,rt=WebGLCoordinateSystem){const it=this.planes,nt=_e.elements,st=nt[0],at=nt[1],lt=nt[2],ot=nt[3],ct=nt[4],ut=nt[5],ht=nt[6],dt=nt[7],pt=nt[8],ft=nt[9],gt=nt[10],mt=nt[11],At=nt[12],yt=nt[13],bt=nt[14],xt=nt[15];if(it[0].setComponents(ot-st,dt-ct,mt-pt,xt-At).normalize(),it[1].setComponents(ot+st,dt+ct,mt+pt,xt+At).normalize(),it[2].setComponents(ot+at,dt+ut,mt+ft,xt+yt).normalize(),it[3].setComponents(ot-at,dt-ut,mt-ft,xt-yt).normalize(),it[4].setComponents(ot-lt,dt-ht,mt-gt,xt-bt).normalize(),rt===WebGLCoordinateSystem)it[5].setComponents(ot+lt,dt+ht,mt+gt,xt+bt).normalize();else if(rt===WebGPUCoordinateSystem)it[5].setComponents(lt,ht,gt,bt).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+rt);return this}intersectsObject(_e){if(_e.boundingSphere!==void 0)_e.boundingSphere===null&&_e.computeBoundingSphere(),_sphere$4.copy(_e.boundingSphere).applyMatrix4(_e.matrixWorld);else{const rt=_e.geometry;rt.boundingSphere===null&&rt.computeBoundingSphere(),_sphere$4.copy(rt.boundingSphere).applyMatrix4(_e.matrixWorld)}return this.intersectsSphere(_sphere$4)}intersectsSprite(_e){return _sphere$4.center.set(0,0,0),_sphere$4.radius=.7071067811865476,_sphere$4.applyMatrix4(_e.matrixWorld),this.intersectsSphere(_sphere$4)}intersectsSphere(_e){const rt=this.planes,it=_e.center,nt=-_e.radius;for(let st=0;st<6;st++)if(rt[st].distanceToPoint(it)<nt)return!1;return!0}intersectsBox(_e){const rt=this.planes;for(let it=0;it<6;it++){const nt=rt[it];if(_vector$6.x=nt.normal.x>0?_e.max.x:_e.min.x,_vector$6.y=nt.normal.y>0?_e.max.y:_e.min.y,_vector$6.z=nt.normal.z>0?_e.max.z:_e.min.z,nt.distanceToPoint(_vector$6)<0)return!1}return!0}containsPoint(_e){const rt=this.planes;for(let it=0;it<6;it++)if(rt[it].distanceToPoint(_e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let tt=null,_e=!1,rt=null,it=null;function nt(st,at){rt(st,at),it=tt.requestAnimationFrame(nt)}return{start:function(){_e!==!0&&rt!==null&&(it=tt.requestAnimationFrame(nt),_e=!0)},stop:function(){tt.cancelAnimationFrame(it),_e=!1},setAnimationLoop:function(st){rt=st},setContext:function(st){tt=st}}}function WebGLAttributes(tt,_e){const rt=_e.isWebGL2,it=new WeakMap;function nt(ct,ut){const ht=ct.array,dt=ct.usage,pt=tt.createBuffer();tt.bindBuffer(ut,pt),tt.bufferData(ut,ht,dt),ct.onUploadCallback();let ft;if(ht instanceof Float32Array)ft=tt.FLOAT;else if(ht instanceof Uint16Array)if(ct.isFloat16BufferAttribute)if(rt)ft=tt.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else ft=tt.UNSIGNED_SHORT;else if(ht instanceof Int16Array)ft=tt.SHORT;else if(ht instanceof Uint32Array)ft=tt.UNSIGNED_INT;else if(ht instanceof Int32Array)ft=tt.INT;else if(ht instanceof Int8Array)ft=tt.BYTE;else if(ht instanceof Uint8Array)ft=tt.UNSIGNED_BYTE;else if(ht instanceof Uint8ClampedArray)ft=tt.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+ht);return{buffer:pt,type:ft,bytesPerElement:ht.BYTES_PER_ELEMENT,version:ct.version}}function st(ct,ut,ht){const dt=ut.array,pt=ut.updateRange;tt.bindBuffer(ht,ct),pt.count===-1?tt.bufferSubData(ht,0,dt):(rt?tt.bufferSubData(ht,pt.offset*dt.BYTES_PER_ELEMENT,dt,pt.offset,pt.count):tt.bufferSubData(ht,pt.offset*dt.BYTES_PER_ELEMENT,dt.subarray(pt.offset,pt.offset+pt.count)),pt.count=-1),ut.onUploadCallback()}function at(ct){return ct.isInterleavedBufferAttribute&&(ct=ct.data),it.get(ct)}function lt(ct){ct.isInterleavedBufferAttribute&&(ct=ct.data);const ut=it.get(ct);ut&&(tt.deleteBuffer(ut.buffer),it.delete(ct))}function ot(ct,ut){if(ct.isGLBufferAttribute){const dt=it.get(ct);(!dt||dt.version<ct.version)&&it.set(ct,{buffer:ct.buffer,type:ct.type,bytesPerElement:ct.elementSize,version:ct.version});return}ct.isInterleavedBufferAttribute&&(ct=ct.data);const ht=it.get(ct);ht===void 0?it.set(ct,nt(ct,ut)):ht.version<ct.version&&(st(ht.buffer,ct,ut),ht.version=ct.version)}return{get:at,remove:lt,update:ot}}class PlaneGeometry extends BufferGeometry{constructor(_e=1,rt=1,it=1,nt=1){super(),this.type="PlaneGeometry",this.parameters={width:_e,height:rt,widthSegments:it,heightSegments:nt};const st=_e/2,at=rt/2,lt=Math.floor(it),ot=Math.floor(nt),ct=lt+1,ut=ot+1,ht=_e/lt,dt=rt/ot,pt=[],ft=[],gt=[],mt=[];for(let At=0;At<ut;At++){const yt=At*dt-at;for(let bt=0;bt<ct;bt++){const xt=bt*ht-st;ft.push(xt,-yt,0),gt.push(0,0,1),mt.push(bt/lt),mt.push(1-At/ot)}}for(let At=0;At<ot;At++)for(let yt=0;yt<lt;yt++){const bt=yt+ct*At,xt=yt+ct*(At+1),vt=yt+1+ct*(At+1),_t=yt+1+ct*At;pt.push(bt,xt,_t),pt.push(xt,vt,_t)}this.setIndex(pt),this.setAttribute("position",new Float32BufferAttribute(ft,3)),this.setAttribute("normal",new Float32BufferAttribute(gt,3)),this.setAttribute("uv",new Float32BufferAttribute(mt,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new PlaneGeometry(_e.width,_e.height,_e.widthSegments,_e.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_fragment=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color$1(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},specular:{value:new Color$1(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color$1(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color$1(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color$1(0)},specularColor:{value:new Color$1(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0};function WebGLBackground(tt,_e,rt,it,nt,st,at){const lt=new Color$1(0);let ot=st===!0?0:1,ct,ut,ht=null,dt=0,pt=null;function ft(mt,At){let yt=!1,bt=At.isScene===!0?At.background:null;switch(bt&&bt.isTexture&&(bt=(At.backgroundBlurriness>0?rt:_e).get(bt)),bt===null?gt(lt,ot):bt&&bt.isColor&&(gt(bt,1),yt=!0),tt.xr.getEnvironmentBlendMode()){case"opaque":yt=!0;break;case"additive":it.buffers.color.setClear(0,0,0,1,at),yt=!0;break;case"alpha-blend":it.buffers.color.setClear(0,0,0,0,at),yt=!0;break}(tt.autoClear||yt)&&tt.clear(tt.autoClearColor,tt.autoClearDepth,tt.autoClearStencil),bt&&(bt.isCubeTexture||bt.mapping===CubeUVReflectionMapping)?(ut===void 0&&(ut=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),ut.geometry.deleteAttribute("normal"),ut.geometry.deleteAttribute("uv"),ut.onBeforeRender=function(_t,Ct,St){this.matrixWorld.copyPosition(St.matrixWorld)},Object.defineProperty(ut.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),nt.update(ut)),ut.material.uniforms.envMap.value=bt,ut.material.uniforms.flipEnvMap.value=bt.isCubeTexture&&bt.isRenderTargetTexture===!1?-1:1,ut.material.uniforms.backgroundBlurriness.value=At.backgroundBlurriness,ut.material.uniforms.backgroundIntensity.value=At.backgroundIntensity,ut.material.toneMapped=bt.colorSpace!==SRGBColorSpace,(ht!==bt||dt!==bt.version||pt!==tt.toneMapping)&&(ut.material.needsUpdate=!0,ht=bt,dt=bt.version,pt=tt.toneMapping),ut.layers.enableAll(),mt.unshift(ut,ut.geometry,ut.material,0,0,null)):bt&&bt.isTexture&&(ct===void 0&&(ct=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),ct.geometry.deleteAttribute("normal"),Object.defineProperty(ct.material,"map",{get:function(){return this.uniforms.t2D.value}}),nt.update(ct)),ct.material.uniforms.t2D.value=bt,ct.material.uniforms.backgroundIntensity.value=At.backgroundIntensity,ct.material.toneMapped=bt.colorSpace!==SRGBColorSpace,bt.matrixAutoUpdate===!0&&bt.updateMatrix(),ct.material.uniforms.uvTransform.value.copy(bt.matrix),(ht!==bt||dt!==bt.version||pt!==tt.toneMapping)&&(ct.material.needsUpdate=!0,ht=bt,dt=bt.version,pt=tt.toneMapping),ct.layers.enableAll(),mt.unshift(ct,ct.geometry,ct.material,0,0,null))}function gt(mt,At){mt.getRGB(_rgb,getUnlitUniformColorSpace(tt)),it.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,At,at)}return{getClearColor:function(){return lt},setClearColor:function(mt,At=1){lt.set(mt),ot=At,gt(lt,ot)},getClearAlpha:function(){return ot},setClearAlpha:function(mt){ot=mt,gt(lt,ot)},render:ft}}function WebGLBindingStates(tt,_e,rt,it){const nt=tt.getParameter(tt.MAX_VERTEX_ATTRIBS),st=it.isWebGL2?null:_e.get("OES_vertex_array_object"),at=it.isWebGL2||st!==null,lt={},ot=mt(null);let ct=ot,ut=!1;function ht(Ot,Bt,Nt,zt,Dt){let Ft=!1;if(at){const Ut=gt(zt,Nt,Bt);ct!==Ut&&(ct=Ut,pt(ct.object)),Ft=At(Ot,zt,Nt,Dt),Ft&&yt(Ot,zt,Nt,Dt)}else{const Ut=Bt.wireframe===!0;(ct.geometry!==zt.id||ct.program!==Nt.id||ct.wireframe!==Ut)&&(ct.geometry=zt.id,ct.program=Nt.id,ct.wireframe=Ut,Ft=!0)}Dt!==null&&rt.update(Dt,tt.ELEMENT_ARRAY_BUFFER),(Ft||ut)&&(ut=!1,St(Ot,Bt,Nt,zt),Dt!==null&&tt.bindBuffer(tt.ELEMENT_ARRAY_BUFFER,rt.get(Dt).buffer))}function dt(){return it.isWebGL2?tt.createVertexArray():st.createVertexArrayOES()}function pt(Ot){return it.isWebGL2?tt.bindVertexArray(Ot):st.bindVertexArrayOES(Ot)}function ft(Ot){return it.isWebGL2?tt.deleteVertexArray(Ot):st.deleteVertexArrayOES(Ot)}function gt(Ot,Bt,Nt){const zt=Nt.wireframe===!0;let Dt=lt[Ot.id];Dt===void 0&&(Dt={},lt[Ot.id]=Dt);let Ft=Dt[Bt.id];Ft===void 0&&(Ft={},Dt[Bt.id]=Ft);let Ut=Ft[zt];return Ut===void 0&&(Ut=mt(dt()),Ft[zt]=Ut),Ut}function mt(Ot){const Bt=[],Nt=[],zt=[];for(let Dt=0;Dt<nt;Dt++)Bt[Dt]=0,Nt[Dt]=0,zt[Dt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Bt,enabledAttributes:Nt,attributeDivisors:zt,object:Ot,attributes:{},index:null}}function At(Ot,Bt,Nt,zt){const Dt=ct.attributes,Ft=Bt.attributes;let Ut=0;const $t=Nt.getAttributes();for(const Vt in $t)if($t[Vt].location>=0){const qt=Dt[Vt];let sr=Ft[Vt];if(sr===void 0&&(Vt==="instanceMatrix"&&Ot.instanceMatrix&&(sr=Ot.instanceMatrix),Vt==="instanceColor"&&Ot.instanceColor&&(sr=Ot.instanceColor)),qt===void 0||qt.attribute!==sr||sr&&qt.data!==sr.data)return!0;Ut++}return ct.attributesNum!==Ut||ct.index!==zt}function yt(Ot,Bt,Nt,zt){const Dt={},Ft=Bt.attributes;let Ut=0;const $t=Nt.getAttributes();for(const Vt in $t)if($t[Vt].location>=0){let qt=Ft[Vt];qt===void 0&&(Vt==="instanceMatrix"&&Ot.instanceMatrix&&(qt=Ot.instanceMatrix),Vt==="instanceColor"&&Ot.instanceColor&&(qt=Ot.instanceColor));const sr={};sr.attribute=qt,qt&&qt.data&&(sr.data=qt.data),Dt[Vt]=sr,Ut++}ct.attributes=Dt,ct.attributesNum=Ut,ct.index=zt}function bt(){const Ot=ct.newAttributes;for(let Bt=0,Nt=Ot.length;Bt<Nt;Bt++)Ot[Bt]=0}function xt(Ot){vt(Ot,0)}function vt(Ot,Bt){const Nt=ct.newAttributes,zt=ct.enabledAttributes,Dt=ct.attributeDivisors;Nt[Ot]=1,zt[Ot]===0&&(tt.enableVertexAttribArray(Ot),zt[Ot]=1),Dt[Ot]!==Bt&&((it.isWebGL2?tt:_e.get("ANGLE_instanced_arrays"))[it.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ot,Bt),Dt[Ot]=Bt)}function _t(){const Ot=ct.newAttributes,Bt=ct.enabledAttributes;for(let Nt=0,zt=Bt.length;Nt<zt;Nt++)Bt[Nt]!==Ot[Nt]&&(tt.disableVertexAttribArray(Nt),Bt[Nt]=0)}function Ct(Ot,Bt,Nt,zt,Dt,Ft,Ut){Ut===!0?tt.vertexAttribIPointer(Ot,Bt,Nt,Dt,Ft):tt.vertexAttribPointer(Ot,Bt,Nt,zt,Dt,Ft)}function St(Ot,Bt,Nt,zt){if(it.isWebGL2===!1&&(Ot.isInstancedMesh||zt.isInstancedBufferGeometry)&&_e.get("ANGLE_instanced_arrays")===null)return;bt();const Dt=zt.attributes,Ft=Nt.getAttributes(),Ut=Bt.defaultAttributeValues;for(const $t in Ft){const Vt=Ft[$t];if(Vt.location>=0){let Zt=Dt[$t];if(Zt===void 0&&($t==="instanceMatrix"&&Ot.instanceMatrix&&(Zt=Ot.instanceMatrix),$t==="instanceColor"&&Ot.instanceColor&&(Zt=Ot.instanceColor)),Zt!==void 0){const qt=Zt.normalized,sr=Zt.itemSize,er=rt.get(Zt);if(er===void 0)continue;const ir=er.buffer,ur=er.type,ar=er.bytesPerElement,lr=it.isWebGL2===!0&&(ur===tt.INT||ur===tt.UNSIGNED_INT||Zt.gpuType===IntType);if(Zt.isInterleavedBufferAttribute){const gr=Zt.data,Yt=gr.stride,nr=Zt.offset;if(gr.isInstancedInterleavedBuffer){for(let mr=0;mr<Vt.locationSize;mr++)vt(Vt.location+mr,gr.meshPerAttribute);Ot.isInstancedMesh!==!0&&zt._maxInstanceCount===void 0&&(zt._maxInstanceCount=gr.meshPerAttribute*gr.count)}else for(let mr=0;mr<Vt.locationSize;mr++)xt(Vt.location+mr);tt.bindBuffer(tt.ARRAY_BUFFER,ir);for(let mr=0;mr<Vt.locationSize;mr++)Ct(Vt.location+mr,sr/Vt.locationSize,ur,qt,Yt*ar,(nr+sr/Vt.locationSize*mr)*ar,lr)}else{if(Zt.isInstancedBufferAttribute){for(let gr=0;gr<Vt.locationSize;gr++)vt(Vt.location+gr,Zt.meshPerAttribute);Ot.isInstancedMesh!==!0&&zt._maxInstanceCount===void 0&&(zt._maxInstanceCount=Zt.meshPerAttribute*Zt.count)}else for(let gr=0;gr<Vt.locationSize;gr++)xt(Vt.location+gr);tt.bindBuffer(tt.ARRAY_BUFFER,ir);for(let gr=0;gr<Vt.locationSize;gr++)Ct(Vt.location+gr,sr/Vt.locationSize,ur,qt,sr*ar,sr/Vt.locationSize*gr*ar,lr)}}else if(Ut!==void 0){const qt=Ut[$t];if(qt!==void 0)switch(qt.length){case 2:tt.vertexAttrib2fv(Vt.location,qt);break;case 3:tt.vertexAttrib3fv(Vt.location,qt);break;case 4:tt.vertexAttrib4fv(Vt.location,qt);break;default:tt.vertexAttrib1fv(Vt.location,qt)}}}}_t()}function Et(){Rt();for(const Ot in lt){const Bt=lt[Ot];for(const Nt in Bt){const zt=Bt[Nt];for(const Dt in zt)ft(zt[Dt].object),delete zt[Dt];delete Bt[Nt]}delete lt[Ot]}}function Tt(Ot){if(lt[Ot.id]===void 0)return;const Bt=lt[Ot.id];for(const Nt in Bt){const zt=Bt[Nt];for(const Dt in zt)ft(zt[Dt].object),delete zt[Dt];delete Bt[Nt]}delete lt[Ot.id]}function Mt(Ot){for(const Bt in lt){const Nt=lt[Bt];if(Nt[Ot.id]===void 0)continue;const zt=Nt[Ot.id];for(const Dt in zt)ft(zt[Dt].object),delete zt[Dt];delete Nt[Ot.id]}}function Rt(){It(),ut=!0,ct!==ot&&(ct=ot,pt(ct.object))}function It(){ot.geometry=null,ot.program=null,ot.wireframe=!1}return{setup:ht,reset:Rt,resetDefaultState:It,dispose:Et,releaseStatesOfGeometry:Tt,releaseStatesOfProgram:Mt,initAttributes:bt,enableAttribute:xt,disableUnusedAttributes:_t}}function WebGLBufferRenderer(tt,_e,rt,it){const nt=it.isWebGL2;let st;function at(ct){st=ct}function lt(ct,ut){tt.drawArrays(st,ct,ut),rt.update(ut,st,1)}function ot(ct,ut,ht){if(ht===0)return;let dt,pt;if(nt)dt=tt,pt="drawArraysInstanced";else if(dt=_e.get("ANGLE_instanced_arrays"),pt="drawArraysInstancedANGLE",dt===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}dt[pt](st,ct,ut,ht),rt.update(ut,st,ht)}this.setMode=at,this.render=lt,this.renderInstances=ot}function WebGLCapabilities(tt,_e,rt){let it;function nt(){if(it!==void 0)return it;if(_e.has("EXT_texture_filter_anisotropic")===!0){const Ct=_e.get("EXT_texture_filter_anisotropic");it=tt.getParameter(Ct.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else it=0;return it}function st(Ct){if(Ct==="highp"){if(tt.getShaderPrecisionFormat(tt.VERTEX_SHADER,tt.HIGH_FLOAT).precision>0&&tt.getShaderPrecisionFormat(tt.FRAGMENT_SHADER,tt.HIGH_FLOAT).precision>0)return"highp";Ct="mediump"}return Ct==="mediump"&&tt.getShaderPrecisionFormat(tt.VERTEX_SHADER,tt.MEDIUM_FLOAT).precision>0&&tt.getShaderPrecisionFormat(tt.FRAGMENT_SHADER,tt.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const at=typeof WebGL2RenderingContext<"u"&&tt.constructor.name==="WebGL2RenderingContext";let lt=rt.precision!==void 0?rt.precision:"highp";const ot=st(lt);ot!==lt&&(console.warn("THREE.WebGLRenderer:",lt,"not supported, using",ot,"instead."),lt=ot);const ct=at||_e.has("WEBGL_draw_buffers"),ut=rt.logarithmicDepthBuffer===!0,ht=tt.getParameter(tt.MAX_TEXTURE_IMAGE_UNITS),dt=tt.getParameter(tt.MAX_VERTEX_TEXTURE_IMAGE_UNITS),pt=tt.getParameter(tt.MAX_TEXTURE_SIZE),ft=tt.getParameter(tt.MAX_CUBE_MAP_TEXTURE_SIZE),gt=tt.getParameter(tt.MAX_VERTEX_ATTRIBS),mt=tt.getParameter(tt.MAX_VERTEX_UNIFORM_VECTORS),At=tt.getParameter(tt.MAX_VARYING_VECTORS),yt=tt.getParameter(tt.MAX_FRAGMENT_UNIFORM_VECTORS),bt=dt>0,xt=at||_e.has("OES_texture_float"),vt=bt&&xt,_t=at?tt.getParameter(tt.MAX_SAMPLES):0;return{isWebGL2:at,drawBuffers:ct,getMaxAnisotropy:nt,getMaxPrecision:st,precision:lt,logarithmicDepthBuffer:ut,maxTextures:ht,maxVertexTextures:dt,maxTextureSize:pt,maxCubemapSize:ft,maxAttributes:gt,maxVertexUniforms:mt,maxVaryings:At,maxFragmentUniforms:yt,vertexTextures:bt,floatFragmentTextures:xt,floatVertexTextures:vt,maxSamples:_t}}function WebGLClipping(tt){const _e=this;let rt=null,it=0,nt=!1,st=!1;const at=new Plane,lt=new Matrix3,ot={value:null,needsUpdate:!1};this.uniform=ot,this.numPlanes=0,this.numIntersection=0,this.init=function(ht,dt){const pt=ht.length!==0||dt||it!==0||nt;return nt=dt,it=ht.length,pt},this.beginShadows=function(){st=!0,ut(null)},this.endShadows=function(){st=!1},this.setGlobalState=function(ht,dt){rt=ut(ht,dt,0)},this.setState=function(ht,dt,pt){const ft=ht.clippingPlanes,gt=ht.clipIntersection,mt=ht.clipShadows,At=tt.get(ht);if(!nt||ft===null||ft.length===0||st&&!mt)st?ut(null):ct();else{const yt=st?0:it,bt=yt*4;let xt=At.clippingState||null;ot.value=xt,xt=ut(ft,dt,bt,pt);for(let vt=0;vt!==bt;++vt)xt[vt]=rt[vt];At.clippingState=xt,this.numIntersection=gt?this.numPlanes:0,this.numPlanes+=yt}};function ct(){ot.value!==rt&&(ot.value=rt,ot.needsUpdate=it>0),_e.numPlanes=it,_e.numIntersection=0}function ut(ht,dt,pt,ft){const gt=ht!==null?ht.length:0;let mt=null;if(gt!==0){if(mt=ot.value,ft!==!0||mt===null){const At=pt+gt*4,yt=dt.matrixWorldInverse;lt.getNormalMatrix(yt),(mt===null||mt.length<At)&&(mt=new Float32Array(At));for(let bt=0,xt=pt;bt!==gt;++bt,xt+=4)at.copy(ht[bt]).applyMatrix4(yt,lt),at.normal.toArray(mt,xt),mt[xt+3]=at.constant}ot.value=mt,ot.needsUpdate=!0}return _e.numPlanes=gt,_e.numIntersection=0,mt}}function WebGLCubeMaps(tt){let _e=new WeakMap;function rt(at,lt){return lt===EquirectangularReflectionMapping?at.mapping=CubeReflectionMapping:lt===EquirectangularRefractionMapping&&(at.mapping=CubeRefractionMapping),at}function it(at){if(at&&at.isTexture&&at.isRenderTargetTexture===!1){const lt=at.mapping;if(lt===EquirectangularReflectionMapping||lt===EquirectangularRefractionMapping)if(_e.has(at)){const ot=_e.get(at).texture;return rt(ot,at.mapping)}else{const ot=at.image;if(ot&&ot.height>0){const ct=new WebGLCubeRenderTarget(ot.height/2);return ct.fromEquirectangularTexture(tt,at),_e.set(at,ct),at.addEventListener("dispose",nt),rt(ct.texture,at.mapping)}else return null}}return at}function nt(at){const lt=at.target;lt.removeEventListener("dispose",nt);const ot=_e.get(lt);ot!==void 0&&(_e.delete(lt),ot.dispose())}function st(){_e=new WeakMap}return{get:it,dispose:st}}class OrthographicCamera extends Camera{constructor(_e=-1,rt=1,it=1,nt=-1,st=.1,at=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_e,this.right=rt,this.top=it,this.bottom=nt,this.near=st,this.far=at,this.updateProjectionMatrix()}copy(_e,rt){return super.copy(_e,rt),this.left=_e.left,this.right=_e.right,this.top=_e.top,this.bottom=_e.bottom,this.near=_e.near,this.far=_e.far,this.zoom=_e.zoom,this.view=_e.view===null?null:Object.assign({},_e.view),this}setViewOffset(_e,rt,it,nt,st,at){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_e,this.view.fullHeight=rt,this.view.offsetX=it,this.view.offsetY=nt,this.view.width=st,this.view.height=at,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _e=(this.right-this.left)/(2*this.zoom),rt=(this.top-this.bottom)/(2*this.zoom),it=(this.right+this.left)/2,nt=(this.top+this.bottom)/2;let st=it-_e,at=it+_e,lt=nt+rt,ot=nt-rt;if(this.view!==null&&this.view.enabled){const ct=(this.right-this.left)/this.view.fullWidth/this.zoom,ut=(this.top-this.bottom)/this.view.fullHeight/this.zoom;st+=ct*this.view.offsetX,at=st+ct*this.view.width,lt-=ut*this.view.offsetY,ot=lt-ut*this.view.height}this.projectionMatrix.makeOrthographic(st,at,lt,ot,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_e){const rt=super.toJSON(_e);return rt.object.zoom=this.zoom,rt.object.left=this.left,rt.object.right=this.right,rt.object.top=this.top,rt.object.bottom=this.bottom,rt.object.near=this.near,rt.object.far=this.far,this.view!==null&&(rt.object.view=Object.assign({},this.view)),rt}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera,_clearColor=new Color$1;let _oldTarget=null;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];class PMREMGenerator{constructor(_e){this._renderer=_e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_e,rt=0,it=.1,nt=100){_oldTarget=this._renderer.getRenderTarget(),this._setSize(256);const st=this._allocateTargets();return st.depthBuffer=!0,this._sceneToCubeUV(_e,it,nt,st),rt>0&&this._blur(st,0,0,rt),this._applyPMREM(st),this._cleanup(st),st}fromEquirectangular(_e,rt=null){return this._fromTexture(_e,rt)}fromCubemap(_e,rt=null){return this._fromTexture(_e,rt)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_e){this._lodMax=Math.floor(Math.log2(_e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _e=0;_e<this._lodPlanes.length;_e++)this._lodPlanes[_e].dispose()}_cleanup(_e){this._renderer.setRenderTarget(_oldTarget),_e.scissorTest=!1,_setViewport(_e,0,0,_e.width,_e.height)}_fromTexture(_e,rt){_e.mapping===CubeReflectionMapping||_e.mapping===CubeRefractionMapping?this._setSize(_e.image.length===0?16:_e.image[0].width||_e.image[0].image.width):this._setSize(_e.image.width/4),_oldTarget=this._renderer.getRenderTarget();const it=rt||this._allocateTargets();return this._textureToCubeUV(_e,it),this._applyPMREM(it),this._cleanup(it),it}_allocateTargets(){const _e=3*Math.max(this._cubeSize,112),rt=4*this._cubeSize,it={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,depthBuffer:!1},nt=_createRenderTarget(_e,rt,it);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_e||this._pingPongRenderTarget.height!==rt){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_e,rt,it);const{_lodMax:st}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(st)),this._blurMaterial=_getBlurShader(st,_e,rt)}return nt}_compileMaterial(_e){const rt=new Mesh(this._lodPlanes[0],_e);this._renderer.compile(rt,_flatCamera)}_sceneToCubeUV(_e,rt,it,nt){const lt=new PerspectiveCamera(90,1,rt,it),ot=[1,-1,1,1,1,1],ct=[1,1,1,-1,-1,-1],ut=this._renderer,ht=ut.autoClear,dt=ut.toneMapping;ut.getClearColor(_clearColor),ut.toneMapping=NoToneMapping,ut.autoClear=!1;const pt=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),ft=new Mesh(new BoxGeometry,pt);let gt=!1;const mt=_e.background;mt?mt.isColor&&(pt.color.copy(mt),_e.background=null,gt=!0):(pt.color.copy(_clearColor),gt=!0);for(let At=0;At<6;At++){const yt=At%3;yt===0?(lt.up.set(0,ot[At],0),lt.lookAt(ct[At],0,0)):yt===1?(lt.up.set(0,0,ot[At]),lt.lookAt(0,ct[At],0)):(lt.up.set(0,ot[At],0),lt.lookAt(0,0,ct[At]));const bt=this._cubeSize;_setViewport(nt,yt*bt,At>2?bt:0,bt,bt),ut.setRenderTarget(nt),gt&&ut.render(ft,lt),ut.render(_e,lt)}ft.geometry.dispose(),ft.material.dispose(),ut.toneMapping=dt,ut.autoClear=ht,_e.background=mt}_textureToCubeUV(_e,rt){const it=this._renderer,nt=_e.mapping===CubeReflectionMapping||_e.mapping===CubeRefractionMapping;nt?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=_e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const st=nt?this._cubemapMaterial:this._equirectMaterial,at=new Mesh(this._lodPlanes[0],st),lt=st.uniforms;lt.envMap.value=_e;const ot=this._cubeSize;_setViewport(rt,0,0,3*ot,2*ot),it.setRenderTarget(rt),it.render(at,_flatCamera)}_applyPMREM(_e){const rt=this._renderer,it=rt.autoClear;rt.autoClear=!1;for(let nt=1;nt<this._lodPlanes.length;nt++){const st=Math.sqrt(this._sigmas[nt]*this._sigmas[nt]-this._sigmas[nt-1]*this._sigmas[nt-1]),at=_axisDirections[(nt-1)%_axisDirections.length];this._blur(_e,nt-1,nt,st,at)}rt.autoClear=it}_blur(_e,rt,it,nt,st){const at=this._pingPongRenderTarget;this._halfBlur(_e,at,rt,it,nt,"latitudinal",st),this._halfBlur(at,_e,it,it,nt,"longitudinal",st)}_halfBlur(_e,rt,it,nt,st,at,lt){const ot=this._renderer,ct=this._blurMaterial;at!=="latitudinal"&&at!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const ut=3,ht=new Mesh(this._lodPlanes[nt],ct),dt=ct.uniforms,pt=this._sizeLods[it]-1,ft=isFinite(st)?Math.PI/(2*pt):2*Math.PI/(2*MAX_SAMPLES-1),gt=st/ft,mt=isFinite(st)?1+Math.floor(ut*gt):MAX_SAMPLES;mt>MAX_SAMPLES&&console.warn(`sigmaRadians, ${st}, is too large and will clip, as it requested ${mt} samples when the maximum is set to ${MAX_SAMPLES}`);const At=[];let yt=0;for(let Ct=0;Ct<MAX_SAMPLES;++Ct){const St=Ct/gt,Et=Math.exp(-St*St/2);At.push(Et),Ct===0?yt+=Et:Ct<mt&&(yt+=2*Et)}for(let Ct=0;Ct<At.length;Ct++)At[Ct]=At[Ct]/yt;dt.envMap.value=_e.texture,dt.samples.value=mt,dt.weights.value=At,dt.latitudinal.value=at==="latitudinal",lt&&(dt.poleAxis.value=lt);const{_lodMax:bt}=this;dt.dTheta.value=ft,dt.mipInt.value=bt-it;const xt=this._sizeLods[nt],vt=3*xt*(nt>bt-LOD_MIN?nt-bt+LOD_MIN:0),_t=4*(this._cubeSize-xt);_setViewport(rt,vt,_t,3*xt,2*xt),ot.setRenderTarget(rt),ot.render(ht,_flatCamera)}}function _createPlanes(tt){const _e=[],rt=[],it=[];let nt=tt;const st=tt-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let at=0;at<st;at++){const lt=Math.pow(2,nt);rt.push(lt);let ot=1/lt;at>tt-LOD_MIN?ot=EXTRA_LOD_SIGMA[at-tt+LOD_MIN-1]:at===0&&(ot=0),it.push(ot);const ct=1/(lt-2),ut=-ct,ht=1+ct,dt=[ut,ut,ht,ut,ht,ht,ut,ut,ht,ht,ut,ht],pt=6,ft=6,gt=3,mt=2,At=1,yt=new Float32Array(gt*ft*pt),bt=new Float32Array(mt*ft*pt),xt=new Float32Array(At*ft*pt);for(let _t=0;_t<pt;_t++){const Ct=_t%3*2/3-1,St=_t>2?0:-1,Et=[Ct,St,0,Ct+2/3,St,0,Ct+2/3,St+1,0,Ct,St,0,Ct+2/3,St+1,0,Ct,St+1,0];yt.set(Et,gt*ft*_t),bt.set(dt,mt*ft*_t);const Tt=[_t,_t,_t,_t,_t,_t];xt.set(Tt,At*ft*_t)}const vt=new BufferGeometry;vt.setAttribute("position",new BufferAttribute(yt,gt)),vt.setAttribute("uv",new BufferAttribute(bt,mt)),vt.setAttribute("faceIndex",new BufferAttribute(xt,At)),_e.push(vt),nt>LOD_MIN&&nt--}return{lodPlanes:_e,sizeLods:rt,sigmas:it}}function _createRenderTarget(tt,_e,rt){const it=new WebGLRenderTarget(tt,_e,rt);return it.texture.mapping=CubeUVReflectionMapping,it.texture.name="PMREM.cubeUv",it.scissorTest=!0,it}function _setViewport(tt,_e,rt,it,nt){tt.viewport.set(_e,rt,it,nt),tt.scissor.set(_e,rt,it,nt)}function _getBlurShader(tt,_e,rt){const it=new Float32Array(MAX_SAMPLES),nt=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/_e,CUBEUV_TEXEL_HEIGHT:1/rt,CUBEUV_MAX_MIP:`${tt}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:it},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:nt}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(tt){let _e=new WeakMap,rt=null;function it(lt){if(lt&&lt.isTexture){const ot=lt.mapping,ct=ot===EquirectangularReflectionMapping||ot===EquirectangularRefractionMapping,ut=ot===CubeReflectionMapping||ot===CubeRefractionMapping;if(ct||ut)if(lt.isRenderTargetTexture&&lt.needsPMREMUpdate===!0){lt.needsPMREMUpdate=!1;let ht=_e.get(lt);return rt===null&&(rt=new PMREMGenerator(tt)),ht=ct?rt.fromEquirectangular(lt,ht):rt.fromCubemap(lt,ht),_e.set(lt,ht),ht.texture}else{if(_e.has(lt))return _e.get(lt).texture;{const ht=lt.image;if(ct&&ht&&ht.height>0||ut&&ht&&nt(ht)){rt===null&&(rt=new PMREMGenerator(tt));const dt=ct?rt.fromEquirectangular(lt):rt.fromCubemap(lt);return _e.set(lt,dt),lt.addEventListener("dispose",st),dt.texture}else return null}}}return lt}function nt(lt){let ot=0;const ct=6;for(let ut=0;ut<ct;ut++)lt[ut]!==void 0&&ot++;return ot===ct}function st(lt){const ot=lt.target;ot.removeEventListener("dispose",st);const ct=_e.get(ot);ct!==void 0&&(_e.delete(ot),ct.dispose())}function at(){_e=new WeakMap,rt!==null&&(rt.dispose(),rt=null)}return{get:it,dispose:at}}function WebGLExtensions(tt){const _e={};function rt(it){if(_e[it]!==void 0)return _e[it];let nt;switch(it){case"WEBGL_depth_texture":nt=tt.getExtension("WEBGL_depth_texture")||tt.getExtension("MOZ_WEBGL_depth_texture")||tt.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":nt=tt.getExtension("EXT_texture_filter_anisotropic")||tt.getExtension("MOZ_EXT_texture_filter_anisotropic")||tt.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":nt=tt.getExtension("WEBGL_compressed_texture_s3tc")||tt.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||tt.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":nt=tt.getExtension("WEBGL_compressed_texture_pvrtc")||tt.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:nt=tt.getExtension(it)}return _e[it]=nt,nt}return{has:function(it){return rt(it)!==null},init:function(it){it.isWebGL2?rt("EXT_color_buffer_float"):(rt("WEBGL_depth_texture"),rt("OES_texture_float"),rt("OES_texture_half_float"),rt("OES_texture_half_float_linear"),rt("OES_standard_derivatives"),rt("OES_element_index_uint"),rt("OES_vertex_array_object"),rt("ANGLE_instanced_arrays")),rt("OES_texture_float_linear"),rt("EXT_color_buffer_half_float"),rt("WEBGL_multisampled_render_to_texture")},get:function(it){const nt=rt(it);return nt===null&&console.warn("THREE.WebGLRenderer: "+it+" extension not supported."),nt}}}function WebGLGeometries(tt,_e,rt,it){const nt={},st=new WeakMap;function at(ht){const dt=ht.target;dt.index!==null&&_e.remove(dt.index);for(const ft in dt.attributes)_e.remove(dt.attributes[ft]);for(const ft in dt.morphAttributes){const gt=dt.morphAttributes[ft];for(let mt=0,At=gt.length;mt<At;mt++)_e.remove(gt[mt])}dt.removeEventListener("dispose",at),delete nt[dt.id];const pt=st.get(dt);pt&&(_e.remove(pt),st.delete(dt)),it.releaseStatesOfGeometry(dt),dt.isInstancedBufferGeometry===!0&&delete dt._maxInstanceCount,rt.memory.geometries--}function lt(ht,dt){return nt[dt.id]===!0||(dt.addEventListener("dispose",at),nt[dt.id]=!0,rt.memory.geometries++),dt}function ot(ht){const dt=ht.attributes;for(const ft in dt)_e.update(dt[ft],tt.ARRAY_BUFFER);const pt=ht.morphAttributes;for(const ft in pt){const gt=pt[ft];for(let mt=0,At=gt.length;mt<At;mt++)_e.update(gt[mt],tt.ARRAY_BUFFER)}}function ct(ht){const dt=[],pt=ht.index,ft=ht.attributes.position;let gt=0;if(pt!==null){const yt=pt.array;gt=pt.version;for(let bt=0,xt=yt.length;bt<xt;bt+=3){const vt=yt[bt+0],_t=yt[bt+1],Ct=yt[bt+2];dt.push(vt,_t,_t,Ct,Ct,vt)}}else{const yt=ft.array;gt=ft.version;for(let bt=0,xt=yt.length/3-1;bt<xt;bt+=3){const vt=bt+0,_t=bt+1,Ct=bt+2;dt.push(vt,_t,_t,Ct,Ct,vt)}}const mt=new(arrayNeedsUint32(dt)?Uint32BufferAttribute:Uint16BufferAttribute)(dt,1);mt.version=gt;const At=st.get(ht);At&&_e.remove(At),st.set(ht,mt)}function ut(ht){const dt=st.get(ht);if(dt){const pt=ht.index;pt!==null&&dt.version<pt.version&&ct(ht)}else ct(ht);return st.get(ht)}return{get:lt,update:ot,getWireframeAttribute:ut}}function WebGLIndexedBufferRenderer(tt,_e,rt,it){const nt=it.isWebGL2;let st;function at(dt){st=dt}let lt,ot;function ct(dt){lt=dt.type,ot=dt.bytesPerElement}function ut(dt,pt){tt.drawElements(st,pt,lt,dt*ot),rt.update(pt,st,1)}function ht(dt,pt,ft){if(ft===0)return;let gt,mt;if(nt)gt=tt,mt="drawElementsInstanced";else if(gt=_e.get("ANGLE_instanced_arrays"),mt="drawElementsInstancedANGLE",gt===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}gt[mt](st,pt,lt,dt*ot,ft),rt.update(pt,st,ft)}this.setMode=at,this.setIndex=ct,this.render=ut,this.renderInstances=ht}function WebGLInfo(tt){const _e={geometries:0,textures:0},rt={frame:0,calls:0,triangles:0,points:0,lines:0};function it(st,at,lt){switch(rt.calls++,at){case tt.TRIANGLES:rt.triangles+=lt*(st/3);break;case tt.LINES:rt.lines+=lt*(st/2);break;case tt.LINE_STRIP:rt.lines+=lt*(st-1);break;case tt.LINE_LOOP:rt.lines+=lt*st;break;case tt.POINTS:rt.points+=lt*st;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",at);break}}function nt(){rt.calls=0,rt.triangles=0,rt.points=0,rt.lines=0}return{memory:_e,render:rt,programs:null,autoReset:!0,reset:nt,update:it}}function numericalSort(tt,_e){return tt[0]-_e[0]}function absNumericalSort(tt,_e){return Math.abs(_e[1])-Math.abs(tt[1])}function WebGLMorphtargets(tt,_e,rt){const it={},nt=new Float32Array(8),st=new WeakMap,at=new Vector4,lt=[];for(let ct=0;ct<8;ct++)lt[ct]=[ct,0];function ot(ct,ut,ht){const dt=ct.morphTargetInfluences;if(_e.isWebGL2===!0){const ft=ut.morphAttributes.position||ut.morphAttributes.normal||ut.morphAttributes.color,gt=ft!==void 0?ft.length:0;let mt=st.get(ut);if(mt===void 0||mt.count!==gt){let Bt=function(){It.dispose(),st.delete(ut),ut.removeEventListener("dispose",Bt)};var pt=Bt;mt!==void 0&&mt.texture.dispose();const bt=ut.morphAttributes.position!==void 0,xt=ut.morphAttributes.normal!==void 0,vt=ut.morphAttributes.color!==void 0,_t=ut.morphAttributes.position||[],Ct=ut.morphAttributes.normal||[],St=ut.morphAttributes.color||[];let Et=0;bt===!0&&(Et=1),xt===!0&&(Et=2),vt===!0&&(Et=3);let Tt=ut.attributes.position.count*Et,Mt=1;Tt>_e.maxTextureSize&&(Mt=Math.ceil(Tt/_e.maxTextureSize),Tt=_e.maxTextureSize);const Rt=new Float32Array(Tt*Mt*4*gt),It=new DataArrayTexture(Rt,Tt,Mt,gt);It.type=FloatType,It.needsUpdate=!0;const Ot=Et*4;for(let Nt=0;Nt<gt;Nt++){const zt=_t[Nt],Dt=Ct[Nt],Ft=St[Nt],Ut=Tt*Mt*4*Nt;for(let $t=0;$t<zt.count;$t++){const Vt=$t*Ot;bt===!0&&(at.fromBufferAttribute(zt,$t),Rt[Ut+Vt+0]=at.x,Rt[Ut+Vt+1]=at.y,Rt[Ut+Vt+2]=at.z,Rt[Ut+Vt+3]=0),xt===!0&&(at.fromBufferAttribute(Dt,$t),Rt[Ut+Vt+4]=at.x,Rt[Ut+Vt+5]=at.y,Rt[Ut+Vt+6]=at.z,Rt[Ut+Vt+7]=0),vt===!0&&(at.fromBufferAttribute(Ft,$t),Rt[Ut+Vt+8]=at.x,Rt[Ut+Vt+9]=at.y,Rt[Ut+Vt+10]=at.z,Rt[Ut+Vt+11]=Ft.itemSize===4?at.w:1)}}mt={count:gt,texture:It,size:new Vector2(Tt,Mt)},st.set(ut,mt),ut.addEventListener("dispose",Bt)}let At=0;for(let bt=0;bt<dt.length;bt++)At+=dt[bt];const yt=ut.morphTargetsRelative?1:1-At;ht.getUniforms().setValue(tt,"morphTargetBaseInfluence",yt),ht.getUniforms().setValue(tt,"morphTargetInfluences",dt),ht.getUniforms().setValue(tt,"morphTargetsTexture",mt.texture,rt),ht.getUniforms().setValue(tt,"morphTargetsTextureSize",mt.size)}else{const ft=dt===void 0?0:dt.length;let gt=it[ut.id];if(gt===void 0||gt.length!==ft){gt=[];for(let xt=0;xt<ft;xt++)gt[xt]=[xt,0];it[ut.id]=gt}for(let xt=0;xt<ft;xt++){const vt=gt[xt];vt[0]=xt,vt[1]=dt[xt]}gt.sort(absNumericalSort);for(let xt=0;xt<8;xt++)xt<ft&&gt[xt][1]?(lt[xt][0]=gt[xt][0],lt[xt][1]=gt[xt][1]):(lt[xt][0]=Number.MAX_SAFE_INTEGER,lt[xt][1]=0);lt.sort(numericalSort);const mt=ut.morphAttributes.position,At=ut.morphAttributes.normal;let yt=0;for(let xt=0;xt<8;xt++){const vt=lt[xt],_t=vt[0],Ct=vt[1];_t!==Number.MAX_SAFE_INTEGER&&Ct?(mt&&ut.getAttribute("morphTarget"+xt)!==mt[_t]&&ut.setAttribute("morphTarget"+xt,mt[_t]),At&&ut.getAttribute("morphNormal"+xt)!==At[_t]&&ut.setAttribute("morphNormal"+xt,At[_t]),nt[xt]=Ct,yt+=Ct):(mt&&ut.hasAttribute("morphTarget"+xt)===!0&&ut.deleteAttribute("morphTarget"+xt),At&&ut.hasAttribute("morphNormal"+xt)===!0&&ut.deleteAttribute("morphNormal"+xt),nt[xt]=0)}const bt=ut.morphTargetsRelative?1:1-yt;ht.getUniforms().setValue(tt,"morphTargetBaseInfluence",bt),ht.getUniforms().setValue(tt,"morphTargetInfluences",nt)}}return{update:ot}}function WebGLObjects(tt,_e,rt,it){let nt=new WeakMap;function st(ot){const ct=it.render.frame,ut=ot.geometry,ht=_e.get(ot,ut);if(nt.get(ht)!==ct&&(_e.update(ht),nt.set(ht,ct)),ot.isInstancedMesh&&(ot.hasEventListener("dispose",lt)===!1&&ot.addEventListener("dispose",lt),nt.get(ot)!==ct&&(rt.update(ot.instanceMatrix,tt.ARRAY_BUFFER),ot.instanceColor!==null&&rt.update(ot.instanceColor,tt.ARRAY_BUFFER),nt.set(ot,ct))),ot.isSkinnedMesh){const dt=ot.skeleton;nt.get(dt)!==ct&&(dt.update(),nt.set(dt,ct))}return ht}function at(){nt=new WeakMap}function lt(ot){const ct=ot.target;ct.removeEventListener("dispose",lt),rt.remove(ct.instanceMatrix),ct.instanceColor!==null&&rt.remove(ct.instanceColor)}return{update:st,dispose:at}}const emptyTexture=new Texture,emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture$1,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten$2(tt,_e,rt){const it=tt[0];if(it<=0||it>0)return tt;const nt=_e*rt;let st=arrayCacheF32[nt];if(st===void 0&&(st=new Float32Array(nt),arrayCacheF32[nt]=st),_e!==0){it.toArray(st,0);for(let at=1,lt=0;at!==_e;++at)lt+=rt,tt[at].toArray(st,lt)}return st}function arraysEqual$1(tt,_e){if(tt.length!==_e.length)return!1;for(let rt=0,it=tt.length;rt<it;rt++)if(tt[rt]!==_e[rt])return!1;return!0}function copyArray$1(tt,_e){for(let rt=0,it=_e.length;rt<it;rt++)tt[rt]=_e[rt]}function allocTexUnits(tt,_e){let rt=arrayCacheI32[_e];rt===void 0&&(rt=new Int32Array(_e),arrayCacheI32[_e]=rt);for(let it=0;it!==_e;++it)rt[it]=tt.allocateTextureUnit();return rt}function setValueV1f(tt,_e){const rt=this.cache;rt[0]!==_e&&(tt.uniform1f(this.addr,_e),rt[0]=_e)}function setValueV2f(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y)&&(tt.uniform2f(this.addr,_e.x,_e.y),rt[0]=_e.x,rt[1]=_e.y);else{if(arraysEqual$1(rt,_e))return;tt.uniform2fv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV3f(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z)&&(tt.uniform3f(this.addr,_e.x,_e.y,_e.z),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z);else if(_e.r!==void 0)(rt[0]!==_e.r||rt[1]!==_e.g||rt[2]!==_e.b)&&(tt.uniform3f(this.addr,_e.r,_e.g,_e.b),rt[0]=_e.r,rt[1]=_e.g,rt[2]=_e.b);else{if(arraysEqual$1(rt,_e))return;tt.uniform3fv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV4f(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z||rt[3]!==_e.w)&&(tt.uniform4f(this.addr,_e.x,_e.y,_e.z,_e.w),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z,rt[3]=_e.w);else{if(arraysEqual$1(rt,_e))return;tt.uniform4fv(this.addr,_e),copyArray$1(rt,_e)}}function setValueM2(tt,_e){const rt=this.cache,it=_e.elements;if(it===void 0){if(arraysEqual$1(rt,_e))return;tt.uniformMatrix2fv(this.addr,!1,_e),copyArray$1(rt,_e)}else{if(arraysEqual$1(rt,it))return;mat2array.set(it),tt.uniformMatrix2fv(this.addr,!1,mat2array),copyArray$1(rt,it)}}function setValueM3(tt,_e){const rt=this.cache,it=_e.elements;if(it===void 0){if(arraysEqual$1(rt,_e))return;tt.uniformMatrix3fv(this.addr,!1,_e),copyArray$1(rt,_e)}else{if(arraysEqual$1(rt,it))return;mat3array.set(it),tt.uniformMatrix3fv(this.addr,!1,mat3array),copyArray$1(rt,it)}}function setValueM4(tt,_e){const rt=this.cache,it=_e.elements;if(it===void 0){if(arraysEqual$1(rt,_e))return;tt.uniformMatrix4fv(this.addr,!1,_e),copyArray$1(rt,_e)}else{if(arraysEqual$1(rt,it))return;mat4array.set(it),tt.uniformMatrix4fv(this.addr,!1,mat4array),copyArray$1(rt,it)}}function setValueV1i(tt,_e){const rt=this.cache;rt[0]!==_e&&(tt.uniform1i(this.addr,_e),rt[0]=_e)}function setValueV2i(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y)&&(tt.uniform2i(this.addr,_e.x,_e.y),rt[0]=_e.x,rt[1]=_e.y);else{if(arraysEqual$1(rt,_e))return;tt.uniform2iv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV3i(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z)&&(tt.uniform3i(this.addr,_e.x,_e.y,_e.z),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z);else{if(arraysEqual$1(rt,_e))return;tt.uniform3iv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV4i(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z||rt[3]!==_e.w)&&(tt.uniform4i(this.addr,_e.x,_e.y,_e.z,_e.w),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z,rt[3]=_e.w);else{if(arraysEqual$1(rt,_e))return;tt.uniform4iv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV1ui(tt,_e){const rt=this.cache;rt[0]!==_e&&(tt.uniform1ui(this.addr,_e),rt[0]=_e)}function setValueV2ui(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y)&&(tt.uniform2ui(this.addr,_e.x,_e.y),rt[0]=_e.x,rt[1]=_e.y);else{if(arraysEqual$1(rt,_e))return;tt.uniform2uiv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV3ui(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z)&&(tt.uniform3ui(this.addr,_e.x,_e.y,_e.z),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z);else{if(arraysEqual$1(rt,_e))return;tt.uniform3uiv(this.addr,_e),copyArray$1(rt,_e)}}function setValueV4ui(tt,_e){const rt=this.cache;if(_e.x!==void 0)(rt[0]!==_e.x||rt[1]!==_e.y||rt[2]!==_e.z||rt[3]!==_e.w)&&(tt.uniform4ui(this.addr,_e.x,_e.y,_e.z,_e.w),rt[0]=_e.x,rt[1]=_e.y,rt[2]=_e.z,rt[3]=_e.w);else{if(arraysEqual$1(rt,_e))return;tt.uniform4uiv(this.addr,_e),copyArray$1(rt,_e)}}function setValueT1(tt,_e,rt){const it=this.cache,nt=rt.allocateTextureUnit();it[0]!==nt&&(tt.uniform1i(this.addr,nt),it[0]=nt),rt.setTexture2D(_e||emptyTexture,nt)}function setValueT3D1(tt,_e,rt){const it=this.cache,nt=rt.allocateTextureUnit();it[0]!==nt&&(tt.uniform1i(this.addr,nt),it[0]=nt),rt.setTexture3D(_e||empty3dTexture,nt)}function setValueT6(tt,_e,rt){const it=this.cache,nt=rt.allocateTextureUnit();it[0]!==nt&&(tt.uniform1i(this.addr,nt),it[0]=nt),rt.setTextureCube(_e||emptyCubeTexture,nt)}function setValueT2DArray1(tt,_e,rt){const it=this.cache,nt=rt.allocateTextureUnit();it[0]!==nt&&(tt.uniform1i(this.addr,nt),it[0]=nt),rt.setTexture2DArray(_e||emptyArrayTexture,nt)}function getSingularSetter(tt){switch(tt){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(tt,_e){tt.uniform1fv(this.addr,_e)}function setValueV2fArray(tt,_e){const rt=flatten$2(_e,this.size,2);tt.uniform2fv(this.addr,rt)}function setValueV3fArray(tt,_e){const rt=flatten$2(_e,this.size,3);tt.uniform3fv(this.addr,rt)}function setValueV4fArray(tt,_e){const rt=flatten$2(_e,this.size,4);tt.uniform4fv(this.addr,rt)}function setValueM2Array(tt,_e){const rt=flatten$2(_e,this.size,4);tt.uniformMatrix2fv(this.addr,!1,rt)}function setValueM3Array(tt,_e){const rt=flatten$2(_e,this.size,9);tt.uniformMatrix3fv(this.addr,!1,rt)}function setValueM4Array(tt,_e){const rt=flatten$2(_e,this.size,16);tt.uniformMatrix4fv(this.addr,!1,rt)}function setValueV1iArray(tt,_e){tt.uniform1iv(this.addr,_e)}function setValueV2iArray(tt,_e){tt.uniform2iv(this.addr,_e)}function setValueV3iArray(tt,_e){tt.uniform3iv(this.addr,_e)}function setValueV4iArray(tt,_e){tt.uniform4iv(this.addr,_e)}function setValueV1uiArray(tt,_e){tt.uniform1uiv(this.addr,_e)}function setValueV2uiArray(tt,_e){tt.uniform2uiv(this.addr,_e)}function setValueV3uiArray(tt,_e){tt.uniform3uiv(this.addr,_e)}function setValueV4uiArray(tt,_e){tt.uniform4uiv(this.addr,_e)}function setValueT1Array(tt,_e,rt){const it=this.cache,nt=_e.length,st=allocTexUnits(rt,nt);arraysEqual$1(it,st)||(tt.uniform1iv(this.addr,st),copyArray$1(it,st));for(let at=0;at!==nt;++at)rt.setTexture2D(_e[at]||emptyTexture,st[at])}function setValueT3DArray(tt,_e,rt){const it=this.cache,nt=_e.length,st=allocTexUnits(rt,nt);arraysEqual$1(it,st)||(tt.uniform1iv(this.addr,st),copyArray$1(it,st));for(let at=0;at!==nt;++at)rt.setTexture3D(_e[at]||empty3dTexture,st[at])}function setValueT6Array(tt,_e,rt){const it=this.cache,nt=_e.length,st=allocTexUnits(rt,nt);arraysEqual$1(it,st)||(tt.uniform1iv(this.addr,st),copyArray$1(it,st));for(let at=0;at!==nt;++at)rt.setTextureCube(_e[at]||emptyCubeTexture,st[at])}function setValueT2DArrayArray(tt,_e,rt){const it=this.cache,nt=_e.length,st=allocTexUnits(rt,nt);arraysEqual$1(it,st)||(tt.uniform1iv(this.addr,st),copyArray$1(it,st));for(let at=0;at!==nt;++at)rt.setTexture2DArray(_e[at]||emptyArrayTexture,st[at])}function getPureArraySetter(tt){switch(tt){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_e,rt,it){this.id=_e,this.addr=it,this.cache=[],this.setValue=getSingularSetter(rt.type)}}class PureArrayUniform{constructor(_e,rt,it){this.id=_e,this.addr=it,this.cache=[],this.size=rt.size,this.setValue=getPureArraySetter(rt.type)}}class StructuredUniform{constructor(_e){this.id=_e,this.seq=[],this.map={}}setValue(_e,rt,it){const nt=this.seq;for(let st=0,at=nt.length;st!==at;++st){const lt=nt[st];lt.setValue(_e,rt[lt.id],it)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(tt,_e){tt.seq.push(_e),tt.map[_e.id]=_e}function parseUniform(tt,_e,rt){const it=tt.name,nt=it.length;for(RePathPart.lastIndex=0;;){const st=RePathPart.exec(it),at=RePathPart.lastIndex;let lt=st[1];const ot=st[2]==="]",ct=st[3];if(ot&&(lt=lt|0),ct===void 0||ct==="["&&at+2===nt){addUniform(rt,ct===void 0?new SingleUniform(lt,tt,_e):new PureArrayUniform(lt,tt,_e));break}else{let ht=rt.map[lt];ht===void 0&&(ht=new StructuredUniform(lt),addUniform(rt,ht)),rt=ht}}}class WebGLUniforms{constructor(_e,rt){this.seq=[],this.map={};const it=_e.getProgramParameter(rt,_e.ACTIVE_UNIFORMS);for(let nt=0;nt<it;++nt){const st=_e.getActiveUniform(rt,nt),at=_e.getUniformLocation(rt,st.name);parseUniform(st,at,this)}}setValue(_e,rt,it,nt){const st=this.map[rt];st!==void 0&&st.setValue(_e,it,nt)}setOptional(_e,rt,it){const nt=rt[it];nt!==void 0&&this.setValue(_e,it,nt)}static upload(_e,rt,it,nt){for(let st=0,at=rt.length;st!==at;++st){const lt=rt[st],ot=it[lt.id];ot.needsUpdate!==!1&&lt.setValue(_e,ot.value,nt)}}static seqWithValue(_e,rt){const it=[];for(let nt=0,st=_e.length;nt!==st;++nt){const at=_e[nt];at.id in rt&&it.push(at)}return it}}function WebGLShader(tt,_e,rt){const it=tt.createShader(_e);return tt.shaderSource(it,rt),tt.compileShader(it),it}let programIdCount=0;function handleSource(tt,_e){const rt=tt.split(`
`),it=[],nt=Math.max(_e-6,0),st=Math.min(_e+6,rt.length);for(let at=nt;at<st;at++){const lt=at+1;it.push(`${lt===_e?">":" "} ${lt}: ${rt[at]}`)}return it.join(`
`)}function getEncodingComponents(tt){switch(tt){case LinearSRGBColorSpace:return["Linear","( value )"];case SRGBColorSpace:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",tt),["Linear","( value )"]}}function getShaderErrors(tt,_e,rt){const it=tt.getShaderParameter(_e,tt.COMPILE_STATUS),nt=tt.getShaderInfoLog(_e).trim();if(it&&nt==="")return"";const st=/ERROR: 0:(\d+)/.exec(nt);if(st){const at=parseInt(st[1]);return rt.toUpperCase()+`

`+nt+`

`+handleSource(tt.getShaderSource(_e),at)}else return nt}function getTexelEncodingFunction(tt,_e){const rt=getEncodingComponents(_e);return"vec4 "+tt+"( vec4 value ) { return LinearTo"+rt[0]+rt[1]+"; }"}function getToneMappingFunction(tt,_e){let rt;switch(_e){case LinearToneMapping:rt="Linear";break;case ReinhardToneMapping:rt="Reinhard";break;case CineonToneMapping:rt="OptimizedCineon";break;case ACESFilmicToneMapping:rt="ACESFilmic";break;case CustomToneMapping:rt="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_e),rt="Linear"}return"vec3 "+tt+"( vec3 color ) { return "+rt+"ToneMapping( color ); }"}function generateExtensions(tt){return[tt.extensionDerivatives||tt.envMapCubeUVHeight||tt.bumpMap||tt.normalMapTangentSpace||tt.clearcoatNormalMap||tt.flatShading||tt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(tt.extensionFragDepth||tt.logarithmicDepthBuffer)&&tt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",tt.extensionDrawBuffers&&tt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(tt.extensionShaderTextureLOD||tt.envMap||tt.transmission)&&tt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join(`
`)}function generateDefines(tt){const _e=[];for(const rt in tt){const it=tt[rt];it!==!1&&_e.push("#define "+rt+" "+it)}return _e.join(`
`)}function fetchAttributeLocations(tt,_e){const rt={},it=tt.getProgramParameter(_e,tt.ACTIVE_ATTRIBUTES);for(let nt=0;nt<it;nt++){const st=tt.getActiveAttrib(_e,nt),at=st.name;let lt=1;st.type===tt.FLOAT_MAT2&&(lt=2),st.type===tt.FLOAT_MAT3&&(lt=3),st.type===tt.FLOAT_MAT4&&(lt=4),rt[at]={type:st.type,location:tt.getAttribLocation(_e,at),locationSize:lt}}return rt}function filterEmptyLine(tt){return tt!==""}function replaceLightNums(tt,_e){const rt=_e.numSpotLightShadows+_e.numSpotLightMaps-_e.numSpotLightShadowsWithMaps;return tt.replace(/NUM_DIR_LIGHTS/g,_e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,rt).replace(/NUM_RECT_AREA_LIGHTS/g,_e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_e.numPointLightShadows)}function replaceClippingPlaneNums(tt,_e){return tt.replace(/NUM_CLIPPING_PLANES/g,_e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_e.numClippingPlanes-_e.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(tt){return tt.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function includeReplacer(tt,_e){let rt=ShaderChunk[_e];if(rt===void 0){const it=shaderChunkMap.get(_e);if(it!==void 0)rt=ShaderChunk[it],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',_e,it);else throw new Error("Can not resolve #include <"+_e+">")}return resolveIncludes(rt)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(tt){return tt.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(tt,_e,rt,it){let nt="";for(let st=parseInt(_e);st<parseInt(rt);st++)nt+=it.replace(/\[\s*i\s*\]/g,"[ "+st+" ]").replace(/UNROLLED_LOOP_INDEX/g,st);return nt}function generatePrecision(tt){let _e="precision "+tt.precision+` float;
precision `+tt.precision+" int;";return tt.precision==="highp"?_e+=`
#define HIGH_PRECISION`:tt.precision==="mediump"?_e+=`
#define MEDIUM_PRECISION`:tt.precision==="lowp"&&(_e+=`
#define LOW_PRECISION`),_e}function generateShadowMapTypeDefine(tt){let _e="SHADOWMAP_TYPE_BASIC";return tt.shadowMapType===PCFShadowMap?_e="SHADOWMAP_TYPE_PCF":tt.shadowMapType===PCFSoftShadowMap?_e="SHADOWMAP_TYPE_PCF_SOFT":tt.shadowMapType===VSMShadowMap&&(_e="SHADOWMAP_TYPE_VSM"),_e}function generateEnvMapTypeDefine(tt){let _e="ENVMAP_TYPE_CUBE";if(tt.envMap)switch(tt.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:_e="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:_e="ENVMAP_TYPE_CUBE_UV";break}return _e}function generateEnvMapModeDefine(tt){let _e="ENVMAP_MODE_REFLECTION";if(tt.envMap)switch(tt.envMapMode){case CubeRefractionMapping:_e="ENVMAP_MODE_REFRACTION";break}return _e}function generateEnvMapBlendingDefine(tt){let _e="ENVMAP_BLENDING_NONE";if(tt.envMap)switch(tt.combine){case MultiplyOperation:_e="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:_e="ENVMAP_BLENDING_MIX";break;case AddOperation:_e="ENVMAP_BLENDING_ADD";break}return _e}function generateCubeUVSize(tt){const _e=tt.envMapCubeUVHeight;if(_e===null)return null;const rt=Math.log2(_e)-2,it=1/_e;return{texelWidth:1/(3*Math.max(Math.pow(2,rt),7*16)),texelHeight:it,maxMip:rt}}function WebGLProgram(tt,_e,rt,it){const nt=tt.getContext(),st=rt.defines;let at=rt.vertexShader,lt=rt.fragmentShader;const ot=generateShadowMapTypeDefine(rt),ct=generateEnvMapTypeDefine(rt),ut=generateEnvMapModeDefine(rt),ht=generateEnvMapBlendingDefine(rt),dt=generateCubeUVSize(rt),pt=rt.isWebGL2?"":generateExtensions(rt),ft=generateDefines(st),gt=nt.createProgram();let mt,At,yt=rt.glslVersion?"#version "+rt.glslVersion+`
`:"";rt.isRawShaderMaterial?(mt=["#define SHADER_TYPE "+rt.shaderType,"#define SHADER_NAME "+rt.shaderName,ft].filter(filterEmptyLine).join(`
`),mt.length>0&&(mt+=`
`),At=[pt,"#define SHADER_TYPE "+rt.shaderType,"#define SHADER_NAME "+rt.shaderName,ft].filter(filterEmptyLine).join(`
`),At.length>0&&(At+=`
`)):(mt=[generatePrecision(rt),"#define SHADER_TYPE "+rt.shaderType,"#define SHADER_NAME "+rt.shaderName,ft,rt.instancing?"#define USE_INSTANCING":"",rt.instancingColor?"#define USE_INSTANCING_COLOR":"",rt.useFog&&rt.fog?"#define USE_FOG":"",rt.useFog&&rt.fogExp2?"#define FOG_EXP2":"",rt.map?"#define USE_MAP":"",rt.envMap?"#define USE_ENVMAP":"",rt.envMap?"#define "+ut:"",rt.lightMap?"#define USE_LIGHTMAP":"",rt.aoMap?"#define USE_AOMAP":"",rt.bumpMap?"#define USE_BUMPMAP":"",rt.normalMap?"#define USE_NORMALMAP":"",rt.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",rt.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",rt.displacementMap?"#define USE_DISPLACEMENTMAP":"",rt.emissiveMap?"#define USE_EMISSIVEMAP":"",rt.anisotropyMap?"#define USE_ANISOTROPYMAP":"",rt.clearcoatMap?"#define USE_CLEARCOATMAP":"",rt.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",rt.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",rt.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",rt.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",rt.specularMap?"#define USE_SPECULARMAP":"",rt.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",rt.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",rt.roughnessMap?"#define USE_ROUGHNESSMAP":"",rt.metalnessMap?"#define USE_METALNESSMAP":"",rt.alphaMap?"#define USE_ALPHAMAP":"",rt.alphaHash?"#define USE_ALPHAHASH":"",rt.transmission?"#define USE_TRANSMISSION":"",rt.transmissionMap?"#define USE_TRANSMISSIONMAP":"",rt.thicknessMap?"#define USE_THICKNESSMAP":"",rt.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",rt.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",rt.mapUv?"#define MAP_UV "+rt.mapUv:"",rt.alphaMapUv?"#define ALPHAMAP_UV "+rt.alphaMapUv:"",rt.lightMapUv?"#define LIGHTMAP_UV "+rt.lightMapUv:"",rt.aoMapUv?"#define AOMAP_UV "+rt.aoMapUv:"",rt.emissiveMapUv?"#define EMISSIVEMAP_UV "+rt.emissiveMapUv:"",rt.bumpMapUv?"#define BUMPMAP_UV "+rt.bumpMapUv:"",rt.normalMapUv?"#define NORMALMAP_UV "+rt.normalMapUv:"",rt.displacementMapUv?"#define DISPLACEMENTMAP_UV "+rt.displacementMapUv:"",rt.metalnessMapUv?"#define METALNESSMAP_UV "+rt.metalnessMapUv:"",rt.roughnessMapUv?"#define ROUGHNESSMAP_UV "+rt.roughnessMapUv:"",rt.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+rt.anisotropyMapUv:"",rt.clearcoatMapUv?"#define CLEARCOATMAP_UV "+rt.clearcoatMapUv:"",rt.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+rt.clearcoatNormalMapUv:"",rt.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+rt.clearcoatRoughnessMapUv:"",rt.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+rt.iridescenceMapUv:"",rt.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+rt.iridescenceThicknessMapUv:"",rt.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+rt.sheenColorMapUv:"",rt.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+rt.sheenRoughnessMapUv:"",rt.specularMapUv?"#define SPECULARMAP_UV "+rt.specularMapUv:"",rt.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+rt.specularColorMapUv:"",rt.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+rt.specularIntensityMapUv:"",rt.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+rt.transmissionMapUv:"",rt.thicknessMapUv?"#define THICKNESSMAP_UV "+rt.thicknessMapUv:"",rt.vertexTangents&&rt.flatShading===!1?"#define USE_TANGENT":"",rt.vertexColors?"#define USE_COLOR":"",rt.vertexAlphas?"#define USE_COLOR_ALPHA":"",rt.vertexUv1s?"#define USE_UV1":"",rt.vertexUv2s?"#define USE_UV2":"",rt.vertexUv3s?"#define USE_UV3":"",rt.pointsUvs?"#define USE_POINTS_UV":"",rt.flatShading?"#define FLAT_SHADED":"",rt.skinning?"#define USE_SKINNING":"",rt.morphTargets?"#define USE_MORPHTARGETS":"",rt.morphNormals&&rt.flatShading===!1?"#define USE_MORPHNORMALS":"",rt.morphColors&&rt.isWebGL2?"#define USE_MORPHCOLORS":"",rt.morphTargetsCount>0&&rt.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",rt.morphTargetsCount>0&&rt.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+rt.morphTextureStride:"",rt.morphTargetsCount>0&&rt.isWebGL2?"#define MORPHTARGETS_COUNT "+rt.morphTargetsCount:"",rt.doubleSided?"#define DOUBLE_SIDED":"",rt.flipSided?"#define FLIP_SIDED":"",rt.shadowMapEnabled?"#define USE_SHADOWMAP":"",rt.shadowMapEnabled?"#define "+ot:"",rt.sizeAttenuation?"#define USE_SIZEATTENUATION":"",rt.useLegacyLights?"#define LEGACY_LIGHTS":"",rt.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",rt.logarithmicDepthBuffer&&rt.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),At=[pt,generatePrecision(rt),"#define SHADER_TYPE "+rt.shaderType,"#define SHADER_NAME "+rt.shaderName,ft,rt.useFog&&rt.fog?"#define USE_FOG":"",rt.useFog&&rt.fogExp2?"#define FOG_EXP2":"",rt.map?"#define USE_MAP":"",rt.matcap?"#define USE_MATCAP":"",rt.envMap?"#define USE_ENVMAP":"",rt.envMap?"#define "+ct:"",rt.envMap?"#define "+ut:"",rt.envMap?"#define "+ht:"",dt?"#define CUBEUV_TEXEL_WIDTH "+dt.texelWidth:"",dt?"#define CUBEUV_TEXEL_HEIGHT "+dt.texelHeight:"",dt?"#define CUBEUV_MAX_MIP "+dt.maxMip+".0":"",rt.lightMap?"#define USE_LIGHTMAP":"",rt.aoMap?"#define USE_AOMAP":"",rt.bumpMap?"#define USE_BUMPMAP":"",rt.normalMap?"#define USE_NORMALMAP":"",rt.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",rt.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",rt.emissiveMap?"#define USE_EMISSIVEMAP":"",rt.anisotropy?"#define USE_ANISOTROPY":"",rt.anisotropyMap?"#define USE_ANISOTROPYMAP":"",rt.clearcoat?"#define USE_CLEARCOAT":"",rt.clearcoatMap?"#define USE_CLEARCOATMAP":"",rt.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",rt.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",rt.iridescence?"#define USE_IRIDESCENCE":"",rt.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",rt.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",rt.specularMap?"#define USE_SPECULARMAP":"",rt.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",rt.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",rt.roughnessMap?"#define USE_ROUGHNESSMAP":"",rt.metalnessMap?"#define USE_METALNESSMAP":"",rt.alphaMap?"#define USE_ALPHAMAP":"",rt.alphaTest?"#define USE_ALPHATEST":"",rt.alphaHash?"#define USE_ALPHAHASH":"",rt.sheen?"#define USE_SHEEN":"",rt.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",rt.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",rt.transmission?"#define USE_TRANSMISSION":"",rt.transmissionMap?"#define USE_TRANSMISSIONMAP":"",rt.thicknessMap?"#define USE_THICKNESSMAP":"",rt.vertexTangents&&rt.flatShading===!1?"#define USE_TANGENT":"",rt.vertexColors||rt.instancingColor?"#define USE_COLOR":"",rt.vertexAlphas?"#define USE_COLOR_ALPHA":"",rt.vertexUv1s?"#define USE_UV1":"",rt.vertexUv2s?"#define USE_UV2":"",rt.vertexUv3s?"#define USE_UV3":"",rt.pointsUvs?"#define USE_POINTS_UV":"",rt.gradientMap?"#define USE_GRADIENTMAP":"",rt.flatShading?"#define FLAT_SHADED":"",rt.doubleSided?"#define DOUBLE_SIDED":"",rt.flipSided?"#define FLIP_SIDED":"",rt.shadowMapEnabled?"#define USE_SHADOWMAP":"",rt.shadowMapEnabled?"#define "+ot:"",rt.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",rt.useLegacyLights?"#define LEGACY_LIGHTS":"",rt.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",rt.logarithmicDepthBuffer&&rt.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",rt.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",rt.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",rt.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",rt.toneMapping):"",rt.dithering?"#define DITHERING":"",rt.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",rt.outputColorSpace),rt.useDepthPacking?"#define DEPTH_PACKING "+rt.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),at=resolveIncludes(at),at=replaceLightNums(at,rt),at=replaceClippingPlaneNums(at,rt),lt=resolveIncludes(lt),lt=replaceLightNums(lt,rt),lt=replaceClippingPlaneNums(lt,rt),at=unrollLoops(at),lt=unrollLoops(lt),rt.isWebGL2&&rt.isRawShaderMaterial!==!0&&(yt=`#version 300 es
`,mt=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+mt,At=["#define varying in",rt.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",rt.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+At);const bt=yt+mt+at,xt=yt+At+lt,vt=WebGLShader(nt,nt.VERTEX_SHADER,bt),_t=WebGLShader(nt,nt.FRAGMENT_SHADER,xt);if(nt.attachShader(gt,vt),nt.attachShader(gt,_t),rt.index0AttributeName!==void 0?nt.bindAttribLocation(gt,0,rt.index0AttributeName):rt.morphTargets===!0&&nt.bindAttribLocation(gt,0,"position"),nt.linkProgram(gt),tt.debug.checkShaderErrors){const Et=nt.getProgramInfoLog(gt).trim(),Tt=nt.getShaderInfoLog(vt).trim(),Mt=nt.getShaderInfoLog(_t).trim();let Rt=!0,It=!0;if(nt.getProgramParameter(gt,nt.LINK_STATUS)===!1)if(Rt=!1,typeof tt.debug.onShaderError=="function")tt.debug.onShaderError(nt,gt,vt,_t);else{const Ot=getShaderErrors(nt,vt,"vertex"),Bt=getShaderErrors(nt,_t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+nt.getError()+" - VALIDATE_STATUS "+nt.getProgramParameter(gt,nt.VALIDATE_STATUS)+`

Program Info Log: `+Et+`
`+Ot+`
`+Bt)}else Et!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Et):(Tt===""||Mt==="")&&(It=!1);It&&(this.diagnostics={runnable:Rt,programLog:Et,vertexShader:{log:Tt,prefix:mt},fragmentShader:{log:Mt,prefix:At}})}nt.deleteShader(vt),nt.deleteShader(_t);let Ct;this.getUniforms=function(){return Ct===void 0&&(Ct=new WebGLUniforms(nt,gt)),Ct};let St;return this.getAttributes=function(){return St===void 0&&(St=fetchAttributeLocations(nt,gt)),St},this.destroy=function(){it.releaseStatesOfProgram(this),nt.deleteProgram(gt),this.program=void 0},this.type=rt.shaderType,this.name=rt.shaderName,this.id=programIdCount++,this.cacheKey=_e,this.usedTimes=1,this.program=gt,this.vertexShader=vt,this.fragmentShader=_t,this}let _id=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_e){const rt=_e.vertexShader,it=_e.fragmentShader,nt=this._getShaderStage(rt),st=this._getShaderStage(it),at=this._getShaderCacheForMaterial(_e);return at.has(nt)===!1&&(at.add(nt),nt.usedTimes++),at.has(st)===!1&&(at.add(st),st.usedTimes++),this}remove(_e){const rt=this.materialCache.get(_e);for(const it of rt)it.usedTimes--,it.usedTimes===0&&this.shaderCache.delete(it.code);return this.materialCache.delete(_e),this}getVertexShaderID(_e){return this._getShaderStage(_e.vertexShader).id}getFragmentShaderID(_e){return this._getShaderStage(_e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_e){const rt=this.materialCache;let it=rt.get(_e);return it===void 0&&(it=new Set,rt.set(_e,it)),it}_getShaderStage(_e){const rt=this.shaderCache;let it=rt.get(_e);return it===void 0&&(it=new WebGLShaderStage(_e),rt.set(_e,it)),it}}class WebGLShaderStage{constructor(_e){this.id=_id++,this.code=_e,this.usedTimes=0}}function WebGLPrograms(tt,_e,rt,it,nt,st,at){const lt=new Layers,ot=new WebGLShaderCache,ct=[],ut=nt.isWebGL2,ht=nt.logarithmicDepthBuffer,dt=nt.vertexTextures;let pt=nt.precision;const ft={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function gt(Et){return Et===0?"uv":`uv${Et}`}function mt(Et,Tt,Mt,Rt,It){const Ot=Rt.fog,Bt=It.geometry,Nt=Et.isMeshStandardMaterial?Rt.environment:null,zt=(Et.isMeshStandardMaterial?rt:_e).get(Et.envMap||Nt),Dt=zt&&zt.mapping===CubeUVReflectionMapping?zt.image.height:null,Ft=ft[Et.type];Et.precision!==null&&(pt=nt.getMaxPrecision(Et.precision),pt!==Et.precision&&console.warn("THREE.WebGLProgram.getParameters:",Et.precision,"not supported, using",pt,"instead."));const Ut=Bt.morphAttributes.position||Bt.morphAttributes.normal||Bt.morphAttributes.color,$t=Ut!==void 0?Ut.length:0;let Vt=0;Bt.morphAttributes.position!==void 0&&(Vt=1),Bt.morphAttributes.normal!==void 0&&(Vt=2),Bt.morphAttributes.color!==void 0&&(Vt=3);let Zt,qt,sr,er;if(Ft){const Cn=ShaderLib[Ft];Zt=Cn.vertexShader,qt=Cn.fragmentShader}else Zt=Et.vertexShader,qt=Et.fragmentShader,ot.update(Et),sr=ot.getVertexShaderID(Et),er=ot.getFragmentShaderID(Et);const ir=tt.getRenderTarget(),ur=It.isInstancedMesh===!0,ar=!!Et.map,lr=!!Et.matcap,gr=!!zt,Yt=!!Et.aoMap,nr=!!Et.lightMap,mr=!!Et.bumpMap,Sr=!!Et.normalMap,Er=!!Et.displacementMap,Nr=!!Et.emissiveMap,wr=!!Et.metalnessMap,kr=!!Et.roughnessMap,Ur=Et.anisotropy>0,Or=Et.clearcoat>0,Xr=Et.iridescence>0,Qt=Et.sheen>0,Xt=Et.transmission>0,xr=Ur&&!!Et.anisotropyMap,Lr=Or&&!!Et.clearcoatMap,fr=Or&&!!Et.clearcoatNormalMap,pr=Or&&!!Et.clearcoatRoughnessMap,Hr=Xr&&!!Et.iridescenceMap,hr=Xr&&!!Et.iridescenceThicknessMap,Cr=Qt&&!!Et.sheenColorMap,tr=Qt&&!!Et.sheenRoughnessMap,Ar=!!Et.specularMap,yr=!!Et.specularColorMap,Jt=!!Et.specularIntensityMap,_r=Xt&&!!Et.transmissionMap,Kt=Xt&&!!Et.thicknessMap,Qr=!!Et.gradientMap,br=!!Et.alphaMap,Rr=Et.alphaTest>0,Tr=!!Et.alphaHash,Vr=!!Et.extensions,Wr=!!Bt.attributes.uv1,pn=!!Bt.attributes.uv2,En=!!Bt.attributes.uv3;return{isWebGL2:ut,shaderID:Ft,shaderType:Et.type,shaderName:Et.name,vertexShader:Zt,fragmentShader:qt,defines:Et.defines,customVertexShaderID:sr,customFragmentShaderID:er,isRawShaderMaterial:Et.isRawShaderMaterial===!0,glslVersion:Et.glslVersion,precision:pt,instancing:ur,instancingColor:ur&&It.instanceColor!==null,supportsVertexTextures:dt,outputColorSpace:ir===null?tt.outputColorSpace:ir.isXRRenderTarget===!0?ir.texture.colorSpace:LinearSRGBColorSpace,map:ar,matcap:lr,envMap:gr,envMapMode:gr&&zt.mapping,envMapCubeUVHeight:Dt,aoMap:Yt,lightMap:nr,bumpMap:mr,normalMap:Sr,displacementMap:dt&&Er,emissiveMap:Nr,normalMapObjectSpace:Sr&&Et.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:Sr&&Et.normalMapType===TangentSpaceNormalMap,metalnessMap:wr,roughnessMap:kr,anisotropy:Ur,anisotropyMap:xr,clearcoat:Or,clearcoatMap:Lr,clearcoatNormalMap:fr,clearcoatRoughnessMap:pr,iridescence:Xr,iridescenceMap:Hr,iridescenceThicknessMap:hr,sheen:Qt,sheenColorMap:Cr,sheenRoughnessMap:tr,specularMap:Ar,specularColorMap:yr,specularIntensityMap:Jt,transmission:Xt,transmissionMap:_r,thicknessMap:Kt,gradientMap:Qr,opaque:Et.transparent===!1&&Et.blending===NormalBlending,alphaMap:br,alphaTest:Rr,alphaHash:Tr,combine:Et.combine,mapUv:ar&&gt(Et.map.channel),aoMapUv:Yt&&gt(Et.aoMap.channel),lightMapUv:nr&&gt(Et.lightMap.channel),bumpMapUv:mr&&gt(Et.bumpMap.channel),normalMapUv:Sr&&gt(Et.normalMap.channel),displacementMapUv:Er&&gt(Et.displacementMap.channel),emissiveMapUv:Nr&&gt(Et.emissiveMap.channel),metalnessMapUv:wr&&gt(Et.metalnessMap.channel),roughnessMapUv:kr&&gt(Et.roughnessMap.channel),anisotropyMapUv:xr&&gt(Et.anisotropyMap.channel),clearcoatMapUv:Lr&&gt(Et.clearcoatMap.channel),clearcoatNormalMapUv:fr&&gt(Et.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:pr&&gt(Et.clearcoatRoughnessMap.channel),iridescenceMapUv:Hr&&gt(Et.iridescenceMap.channel),iridescenceThicknessMapUv:hr&&gt(Et.iridescenceThicknessMap.channel),sheenColorMapUv:Cr&&gt(Et.sheenColorMap.channel),sheenRoughnessMapUv:tr&&gt(Et.sheenRoughnessMap.channel),specularMapUv:Ar&&gt(Et.specularMap.channel),specularColorMapUv:yr&&gt(Et.specularColorMap.channel),specularIntensityMapUv:Jt&&gt(Et.specularIntensityMap.channel),transmissionMapUv:_r&&gt(Et.transmissionMap.channel),thicknessMapUv:Kt&&gt(Et.thicknessMap.channel),alphaMapUv:br&&gt(Et.alphaMap.channel),vertexTangents:!!Bt.attributes.tangent&&(Sr||Ur),vertexColors:Et.vertexColors,vertexAlphas:Et.vertexColors===!0&&!!Bt.attributes.color&&Bt.attributes.color.itemSize===4,vertexUv1s:Wr,vertexUv2s:pn,vertexUv3s:En,pointsUvs:It.isPoints===!0&&!!Bt.attributes.uv&&(ar||br),fog:!!Ot,useFog:Et.fog===!0,fogExp2:Ot&&Ot.isFogExp2,flatShading:Et.flatShading===!0,sizeAttenuation:Et.sizeAttenuation===!0,logarithmicDepthBuffer:ht,skinning:It.isSkinnedMesh===!0,morphTargets:Bt.morphAttributes.position!==void 0,morphNormals:Bt.morphAttributes.normal!==void 0,morphColors:Bt.morphAttributes.color!==void 0,morphTargetsCount:$t,morphTextureStride:Vt,numDirLights:Tt.directional.length,numPointLights:Tt.point.length,numSpotLights:Tt.spot.length,numSpotLightMaps:Tt.spotLightMap.length,numRectAreaLights:Tt.rectArea.length,numHemiLights:Tt.hemi.length,numDirLightShadows:Tt.directionalShadowMap.length,numPointLightShadows:Tt.pointShadowMap.length,numSpotLightShadows:Tt.spotShadowMap.length,numSpotLightShadowsWithMaps:Tt.numSpotLightShadowsWithMaps,numClippingPlanes:at.numPlanes,numClipIntersection:at.numIntersection,dithering:Et.dithering,shadowMapEnabled:tt.shadowMap.enabled&&Mt.length>0,shadowMapType:tt.shadowMap.type,toneMapping:Et.toneMapped?tt.toneMapping:NoToneMapping,useLegacyLights:tt.useLegacyLights,premultipliedAlpha:Et.premultipliedAlpha,doubleSided:Et.side===DoubleSide,flipSided:Et.side===BackSide,useDepthPacking:Et.depthPacking>=0,depthPacking:Et.depthPacking||0,index0AttributeName:Et.index0AttributeName,extensionDerivatives:Vr&&Et.extensions.derivatives===!0,extensionFragDepth:Vr&&Et.extensions.fragDepth===!0,extensionDrawBuffers:Vr&&Et.extensions.drawBuffers===!0,extensionShaderTextureLOD:Vr&&Et.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:ut||it.has("EXT_frag_depth"),rendererExtensionDrawBuffers:ut||it.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:ut||it.has("EXT_shader_texture_lod"),customProgramCacheKey:Et.customProgramCacheKey()}}function At(Et){const Tt=[];if(Et.shaderID?Tt.push(Et.shaderID):(Tt.push(Et.customVertexShaderID),Tt.push(Et.customFragmentShaderID)),Et.defines!==void 0)for(const Mt in Et.defines)Tt.push(Mt),Tt.push(Et.defines[Mt]);return Et.isRawShaderMaterial===!1&&(yt(Tt,Et),bt(Tt,Et),Tt.push(tt.outputColorSpace)),Tt.push(Et.customProgramCacheKey),Tt.join()}function yt(Et,Tt){Et.push(Tt.precision),Et.push(Tt.outputColorSpace),Et.push(Tt.envMapMode),Et.push(Tt.envMapCubeUVHeight),Et.push(Tt.mapUv),Et.push(Tt.alphaMapUv),Et.push(Tt.lightMapUv),Et.push(Tt.aoMapUv),Et.push(Tt.bumpMapUv),Et.push(Tt.normalMapUv),Et.push(Tt.displacementMapUv),Et.push(Tt.emissiveMapUv),Et.push(Tt.metalnessMapUv),Et.push(Tt.roughnessMapUv),Et.push(Tt.anisotropyMapUv),Et.push(Tt.clearcoatMapUv),Et.push(Tt.clearcoatNormalMapUv),Et.push(Tt.clearcoatRoughnessMapUv),Et.push(Tt.iridescenceMapUv),Et.push(Tt.iridescenceThicknessMapUv),Et.push(Tt.sheenColorMapUv),Et.push(Tt.sheenRoughnessMapUv),Et.push(Tt.specularMapUv),Et.push(Tt.specularColorMapUv),Et.push(Tt.specularIntensityMapUv),Et.push(Tt.transmissionMapUv),Et.push(Tt.thicknessMapUv),Et.push(Tt.combine),Et.push(Tt.fogExp2),Et.push(Tt.sizeAttenuation),Et.push(Tt.morphTargetsCount),Et.push(Tt.morphAttributeCount),Et.push(Tt.numDirLights),Et.push(Tt.numPointLights),Et.push(Tt.numSpotLights),Et.push(Tt.numSpotLightMaps),Et.push(Tt.numHemiLights),Et.push(Tt.numRectAreaLights),Et.push(Tt.numDirLightShadows),Et.push(Tt.numPointLightShadows),Et.push(Tt.numSpotLightShadows),Et.push(Tt.numSpotLightShadowsWithMaps),Et.push(Tt.shadowMapType),Et.push(Tt.toneMapping),Et.push(Tt.numClippingPlanes),Et.push(Tt.numClipIntersection),Et.push(Tt.depthPacking)}function bt(Et,Tt){lt.disableAll(),Tt.isWebGL2&&lt.enable(0),Tt.supportsVertexTextures&&lt.enable(1),Tt.instancing&&lt.enable(2),Tt.instancingColor&&lt.enable(3),Tt.matcap&&lt.enable(4),Tt.envMap&&lt.enable(5),Tt.normalMapObjectSpace&&lt.enable(6),Tt.normalMapTangentSpace&&lt.enable(7),Tt.clearcoat&&lt.enable(8),Tt.iridescence&&lt.enable(9),Tt.alphaTest&&lt.enable(10),Tt.vertexColors&&lt.enable(11),Tt.vertexAlphas&&lt.enable(12),Tt.vertexUv1s&&lt.enable(13),Tt.vertexUv2s&&lt.enable(14),Tt.vertexUv3s&&lt.enable(15),Tt.vertexTangents&&lt.enable(16),Tt.anisotropy&&lt.enable(17),Et.push(lt.mask),lt.disableAll(),Tt.fog&&lt.enable(0),Tt.useFog&&lt.enable(1),Tt.flatShading&&lt.enable(2),Tt.logarithmicDepthBuffer&&lt.enable(3),Tt.skinning&&lt.enable(4),Tt.morphTargets&&lt.enable(5),Tt.morphNormals&&lt.enable(6),Tt.morphColors&&lt.enable(7),Tt.premultipliedAlpha&&lt.enable(8),Tt.shadowMapEnabled&&lt.enable(9),Tt.useLegacyLights&&lt.enable(10),Tt.doubleSided&&lt.enable(11),Tt.flipSided&&lt.enable(12),Tt.useDepthPacking&&lt.enable(13),Tt.dithering&&lt.enable(14),Tt.transmission&&lt.enable(15),Tt.sheen&&lt.enable(16),Tt.opaque&&lt.enable(17),Tt.pointsUvs&&lt.enable(18),Et.push(lt.mask)}function xt(Et){const Tt=ft[Et.type];let Mt;if(Tt){const Rt=ShaderLib[Tt];Mt=UniformsUtils.clone(Rt.uniforms)}else Mt=Et.uniforms;return Mt}function vt(Et,Tt){let Mt;for(let Rt=0,It=ct.length;Rt<It;Rt++){const Ot=ct[Rt];if(Ot.cacheKey===Tt){Mt=Ot,++Mt.usedTimes;break}}return Mt===void 0&&(Mt=new WebGLProgram(tt,Tt,Et,st),ct.push(Mt)),Mt}function _t(Et){if(--Et.usedTimes===0){const Tt=ct.indexOf(Et);ct[Tt]=ct[ct.length-1],ct.pop(),Et.destroy()}}function Ct(Et){ot.remove(Et)}function St(){ot.dispose()}return{getParameters:mt,getProgramCacheKey:At,getUniforms:xt,acquireProgram:vt,releaseProgram:_t,releaseShaderCache:Ct,programs:ct,dispose:St}}function WebGLProperties(){let tt=new WeakMap;function _e(st){let at=tt.get(st);return at===void 0&&(at={},tt.set(st,at)),at}function rt(st){tt.delete(st)}function it(st,at,lt){tt.get(st)[at]=lt}function nt(){tt=new WeakMap}return{get:_e,remove:rt,update:it,dispose:nt}}function painterSortStable(tt,_e){return tt.groupOrder!==_e.groupOrder?tt.groupOrder-_e.groupOrder:tt.renderOrder!==_e.renderOrder?tt.renderOrder-_e.renderOrder:tt.material.id!==_e.material.id?tt.material.id-_e.material.id:tt.z!==_e.z?tt.z-_e.z:tt.id-_e.id}function reversePainterSortStable(tt,_e){return tt.groupOrder!==_e.groupOrder?tt.groupOrder-_e.groupOrder:tt.renderOrder!==_e.renderOrder?tt.renderOrder-_e.renderOrder:tt.z!==_e.z?_e.z-tt.z:tt.id-_e.id}function WebGLRenderList(){const tt=[];let _e=0;const rt=[],it=[],nt=[];function st(){_e=0,rt.length=0,it.length=0,nt.length=0}function at(ht,dt,pt,ft,gt,mt){let At=tt[_e];return At===void 0?(At={id:ht.id,object:ht,geometry:dt,material:pt,groupOrder:ft,renderOrder:ht.renderOrder,z:gt,group:mt},tt[_e]=At):(At.id=ht.id,At.object=ht,At.geometry=dt,At.material=pt,At.groupOrder=ft,At.renderOrder=ht.renderOrder,At.z=gt,At.group=mt),_e++,At}function lt(ht,dt,pt,ft,gt,mt){const At=at(ht,dt,pt,ft,gt,mt);pt.transmission>0?it.push(At):pt.transparent===!0?nt.push(At):rt.push(At)}function ot(ht,dt,pt,ft,gt,mt){const At=at(ht,dt,pt,ft,gt,mt);pt.transmission>0?it.unshift(At):pt.transparent===!0?nt.unshift(At):rt.unshift(At)}function ct(ht,dt){rt.length>1&&rt.sort(ht||painterSortStable),it.length>1&&it.sort(dt||reversePainterSortStable),nt.length>1&&nt.sort(dt||reversePainterSortStable)}function ut(){for(let ht=_e,dt=tt.length;ht<dt;ht++){const pt=tt[ht];if(pt.id===null)break;pt.id=null,pt.object=null,pt.geometry=null,pt.material=null,pt.group=null}}return{opaque:rt,transmissive:it,transparent:nt,init:st,push:lt,unshift:ot,finish:ut,sort:ct}}function WebGLRenderLists(){let tt=new WeakMap;function _e(it,nt){const st=tt.get(it);let at;return st===void 0?(at=new WebGLRenderList,tt.set(it,[at])):nt>=st.length?(at=new WebGLRenderList,st.push(at)):at=st[nt],at}function rt(){tt=new WeakMap}return{get:_e,dispose:rt}}function UniformsCache(){const tt={};return{get:function(_e){if(tt[_e.id]!==void 0)return tt[_e.id];let rt;switch(_e.type){case"DirectionalLight":rt={direction:new Vector3,color:new Color$1};break;case"SpotLight":rt={position:new Vector3,direction:new Vector3,color:new Color$1,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":rt={position:new Vector3,color:new Color$1,distance:0,decay:0};break;case"HemisphereLight":rt={direction:new Vector3,skyColor:new Color$1,groundColor:new Color$1};break;case"RectAreaLight":rt={color:new Color$1,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return tt[_e.id]=rt,rt}}}function ShadowUniformsCache(){const tt={};return{get:function(_e){if(tt[_e.id]!==void 0)return tt[_e.id];let rt;switch(_e.type){case"DirectionalLight":rt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":rt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":rt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return tt[_e.id]=rt,rt}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(tt,_e){return(_e.castShadow?2:0)-(tt.castShadow?2:0)+(_e.map?1:0)-(tt.map?1:0)}function WebGLLights(tt,_e){const rt=new UniformsCache,it=ShadowUniformsCache(),nt={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let ut=0;ut<9;ut++)nt.probe.push(new Vector3);const st=new Vector3,at=new Matrix4,lt=new Matrix4;function ot(ut,ht){let dt=0,pt=0,ft=0;for(let Mt=0;Mt<9;Mt++)nt.probe[Mt].set(0,0,0);let gt=0,mt=0,At=0,yt=0,bt=0,xt=0,vt=0,_t=0,Ct=0,St=0;ut.sort(shadowCastingAndTexturingLightsFirst);const Et=ht===!0?Math.PI:1;for(let Mt=0,Rt=ut.length;Mt<Rt;Mt++){const It=ut[Mt],Ot=It.color,Bt=It.intensity,Nt=It.distance,zt=It.shadow&&It.shadow.map?It.shadow.map.texture:null;if(It.isAmbientLight)dt+=Ot.r*Bt*Et,pt+=Ot.g*Bt*Et,ft+=Ot.b*Bt*Et;else if(It.isLightProbe)for(let Dt=0;Dt<9;Dt++)nt.probe[Dt].addScaledVector(It.sh.coefficients[Dt],Bt);else if(It.isDirectionalLight){const Dt=rt.get(It);if(Dt.color.copy(It.color).multiplyScalar(It.intensity*Et),It.castShadow){const Ft=It.shadow,Ut=it.get(It);Ut.shadowBias=Ft.bias,Ut.shadowNormalBias=Ft.normalBias,Ut.shadowRadius=Ft.radius,Ut.shadowMapSize=Ft.mapSize,nt.directionalShadow[gt]=Ut,nt.directionalShadowMap[gt]=zt,nt.directionalShadowMatrix[gt]=It.shadow.matrix,xt++}nt.directional[gt]=Dt,gt++}else if(It.isSpotLight){const Dt=rt.get(It);Dt.position.setFromMatrixPosition(It.matrixWorld),Dt.color.copy(Ot).multiplyScalar(Bt*Et),Dt.distance=Nt,Dt.coneCos=Math.cos(It.angle),Dt.penumbraCos=Math.cos(It.angle*(1-It.penumbra)),Dt.decay=It.decay,nt.spot[At]=Dt;const Ft=It.shadow;if(It.map&&(nt.spotLightMap[Ct]=It.map,Ct++,Ft.updateMatrices(It),It.castShadow&&St++),nt.spotLightMatrix[At]=Ft.matrix,It.castShadow){const Ut=it.get(It);Ut.shadowBias=Ft.bias,Ut.shadowNormalBias=Ft.normalBias,Ut.shadowRadius=Ft.radius,Ut.shadowMapSize=Ft.mapSize,nt.spotShadow[At]=Ut,nt.spotShadowMap[At]=zt,_t++}At++}else if(It.isRectAreaLight){const Dt=rt.get(It);Dt.color.copy(Ot).multiplyScalar(Bt),Dt.halfWidth.set(It.width*.5,0,0),Dt.halfHeight.set(0,It.height*.5,0),nt.rectArea[yt]=Dt,yt++}else if(It.isPointLight){const Dt=rt.get(It);if(Dt.color.copy(It.color).multiplyScalar(It.intensity*Et),Dt.distance=It.distance,Dt.decay=It.decay,It.castShadow){const Ft=It.shadow,Ut=it.get(It);Ut.shadowBias=Ft.bias,Ut.shadowNormalBias=Ft.normalBias,Ut.shadowRadius=Ft.radius,Ut.shadowMapSize=Ft.mapSize,Ut.shadowCameraNear=Ft.camera.near,Ut.shadowCameraFar=Ft.camera.far,nt.pointShadow[mt]=Ut,nt.pointShadowMap[mt]=zt,nt.pointShadowMatrix[mt]=It.shadow.matrix,vt++}nt.point[mt]=Dt,mt++}else if(It.isHemisphereLight){const Dt=rt.get(It);Dt.skyColor.copy(It.color).multiplyScalar(Bt*Et),Dt.groundColor.copy(It.groundColor).multiplyScalar(Bt*Et),nt.hemi[bt]=Dt,bt++}}yt>0&&(_e.isWebGL2||tt.has("OES_texture_float_linear")===!0?(nt.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,nt.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):tt.has("OES_texture_half_float_linear")===!0?(nt.rectAreaLTC1=UniformsLib.LTC_HALF_1,nt.rectAreaLTC2=UniformsLib.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),nt.ambient[0]=dt,nt.ambient[1]=pt,nt.ambient[2]=ft;const Tt=nt.hash;(Tt.directionalLength!==gt||Tt.pointLength!==mt||Tt.spotLength!==At||Tt.rectAreaLength!==yt||Tt.hemiLength!==bt||Tt.numDirectionalShadows!==xt||Tt.numPointShadows!==vt||Tt.numSpotShadows!==_t||Tt.numSpotMaps!==Ct)&&(nt.directional.length=gt,nt.spot.length=At,nt.rectArea.length=yt,nt.point.length=mt,nt.hemi.length=bt,nt.directionalShadow.length=xt,nt.directionalShadowMap.length=xt,nt.pointShadow.length=vt,nt.pointShadowMap.length=vt,nt.spotShadow.length=_t,nt.spotShadowMap.length=_t,nt.directionalShadowMatrix.length=xt,nt.pointShadowMatrix.length=vt,nt.spotLightMatrix.length=_t+Ct-St,nt.spotLightMap.length=Ct,nt.numSpotLightShadowsWithMaps=St,Tt.directionalLength=gt,Tt.pointLength=mt,Tt.spotLength=At,Tt.rectAreaLength=yt,Tt.hemiLength=bt,Tt.numDirectionalShadows=xt,Tt.numPointShadows=vt,Tt.numSpotShadows=_t,Tt.numSpotMaps=Ct,nt.version=nextVersion++)}function ct(ut,ht){let dt=0,pt=0,ft=0,gt=0,mt=0;const At=ht.matrixWorldInverse;for(let yt=0,bt=ut.length;yt<bt;yt++){const xt=ut[yt];if(xt.isDirectionalLight){const vt=nt.directional[dt];vt.direction.setFromMatrixPosition(xt.matrixWorld),st.setFromMatrixPosition(xt.target.matrixWorld),vt.direction.sub(st),vt.direction.transformDirection(At),dt++}else if(xt.isSpotLight){const vt=nt.spot[ft];vt.position.setFromMatrixPosition(xt.matrixWorld),vt.position.applyMatrix4(At),vt.direction.setFromMatrixPosition(xt.matrixWorld),st.setFromMatrixPosition(xt.target.matrixWorld),vt.direction.sub(st),vt.direction.transformDirection(At),ft++}else if(xt.isRectAreaLight){const vt=nt.rectArea[gt];vt.position.setFromMatrixPosition(xt.matrixWorld),vt.position.applyMatrix4(At),lt.identity(),at.copy(xt.matrixWorld),at.premultiply(At),lt.extractRotation(at),vt.halfWidth.set(xt.width*.5,0,0),vt.halfHeight.set(0,xt.height*.5,0),vt.halfWidth.applyMatrix4(lt),vt.halfHeight.applyMatrix4(lt),gt++}else if(xt.isPointLight){const vt=nt.point[pt];vt.position.setFromMatrixPosition(xt.matrixWorld),vt.position.applyMatrix4(At),pt++}else if(xt.isHemisphereLight){const vt=nt.hemi[mt];vt.direction.setFromMatrixPosition(xt.matrixWorld),vt.direction.transformDirection(At),mt++}}}return{setup:ot,setupView:ct,state:nt}}function WebGLRenderState(tt,_e){const rt=new WebGLLights(tt,_e),it=[],nt=[];function st(){it.length=0,nt.length=0}function at(ht){it.push(ht)}function lt(ht){nt.push(ht)}function ot(ht){rt.setup(it,ht)}function ct(ht){rt.setupView(it,ht)}return{init:st,state:{lightsArray:it,shadowsArray:nt,lights:rt},setupLights:ot,setupLightsView:ct,pushLight:at,pushShadow:lt}}function WebGLRenderStates(tt,_e){let rt=new WeakMap;function it(st,at=0){const lt=rt.get(st);let ot;return lt===void 0?(ot=new WebGLRenderState(tt,_e),rt.set(st,[ot])):at>=lt.length?(ot=new WebGLRenderState(tt,_e),lt.push(ot)):ot=lt[at],ot}function nt(){rt=new WeakMap}return{get:it,dispose:nt}}class MeshDepthMaterial extends Material{constructor(_e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_e)}copy(_e){return super.copy(_e),this.depthPacking=_e.depthPacking,this.map=_e.map,this.alphaMap=_e.alphaMap,this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(_e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_e)}copy(_e){return super.copy(_e),this.map=_e.map,this.alphaMap=_e.alphaMap,this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(tt,_e,rt){let it=new Frustum;const nt=new Vector2,st=new Vector2,at=new Vector4,lt=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),ot=new MeshDistanceMaterial,ct={},ut=rt.maxTextureSize,ht={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},dt=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),pt=dt.clone();pt.defines.HORIZONTAL_PASS=1;const ft=new BufferGeometry;ft.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const gt=new Mesh(ft,dt),mt=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let At=this.type;this.render=function(vt,_t,Ct){if(mt.enabled===!1||mt.autoUpdate===!1&&mt.needsUpdate===!1||vt.length===0)return;const St=tt.getRenderTarget(),Et=tt.getActiveCubeFace(),Tt=tt.getActiveMipmapLevel(),Mt=tt.state;Mt.setBlending(NoBlending),Mt.buffers.color.setClear(1,1,1,1),Mt.buffers.depth.setTest(!0),Mt.setScissorTest(!1);const Rt=At!==VSMShadowMap&&this.type===VSMShadowMap,It=At===VSMShadowMap&&this.type!==VSMShadowMap;for(let Ot=0,Bt=vt.length;Ot<Bt;Ot++){const Nt=vt[Ot],zt=Nt.shadow;if(zt===void 0){console.warn("THREE.WebGLShadowMap:",Nt,"has no shadow.");continue}if(zt.autoUpdate===!1&&zt.needsUpdate===!1)continue;nt.copy(zt.mapSize);const Dt=zt.getFrameExtents();if(nt.multiply(Dt),st.copy(zt.mapSize),(nt.x>ut||nt.y>ut)&&(nt.x>ut&&(st.x=Math.floor(ut/Dt.x),nt.x=st.x*Dt.x,zt.mapSize.x=st.x),nt.y>ut&&(st.y=Math.floor(ut/Dt.y),nt.y=st.y*Dt.y,zt.mapSize.y=st.y)),zt.map===null||Rt===!0||It===!0){const Ut=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};zt.map!==null&&zt.map.dispose(),zt.map=new WebGLRenderTarget(nt.x,nt.y,Ut),zt.map.texture.name=Nt.name+".shadowMap",zt.camera.updateProjectionMatrix()}tt.setRenderTarget(zt.map),tt.clear();const Ft=zt.getViewportCount();for(let Ut=0;Ut<Ft;Ut++){const $t=zt.getViewport(Ut);at.set(st.x*$t.x,st.y*$t.y,st.x*$t.z,st.y*$t.w),Mt.viewport(at),zt.updateMatrices(Nt,Ut),it=zt.getFrustum(),xt(_t,Ct,zt.camera,Nt,this.type)}zt.isPointLightShadow!==!0&&this.type===VSMShadowMap&&yt(zt,Ct),zt.needsUpdate=!1}At=this.type,mt.needsUpdate=!1,tt.setRenderTarget(St,Et,Tt)};function yt(vt,_t){const Ct=_e.update(gt);dt.defines.VSM_SAMPLES!==vt.blurSamples&&(dt.defines.VSM_SAMPLES=vt.blurSamples,pt.defines.VSM_SAMPLES=vt.blurSamples,dt.needsUpdate=!0,pt.needsUpdate=!0),vt.mapPass===null&&(vt.mapPass=new WebGLRenderTarget(nt.x,nt.y)),dt.uniforms.shadow_pass.value=vt.map.texture,dt.uniforms.resolution.value=vt.mapSize,dt.uniforms.radius.value=vt.radius,tt.setRenderTarget(vt.mapPass),tt.clear(),tt.renderBufferDirect(_t,null,Ct,dt,gt,null),pt.uniforms.shadow_pass.value=vt.mapPass.texture,pt.uniforms.resolution.value=vt.mapSize,pt.uniforms.radius.value=vt.radius,tt.setRenderTarget(vt.map),tt.clear(),tt.renderBufferDirect(_t,null,Ct,pt,gt,null)}function bt(vt,_t,Ct,St){let Et=null;const Tt=Ct.isPointLight===!0?vt.customDistanceMaterial:vt.customDepthMaterial;if(Tt!==void 0)Et=Tt;else if(Et=Ct.isPointLight===!0?ot:lt,tt.localClippingEnabled&&_t.clipShadows===!0&&Array.isArray(_t.clippingPlanes)&&_t.clippingPlanes.length!==0||_t.displacementMap&&_t.displacementScale!==0||_t.alphaMap&&_t.alphaTest>0||_t.map&&_t.alphaTest>0){const Mt=Et.uuid,Rt=_t.uuid;let It=ct[Mt];It===void 0&&(It={},ct[Mt]=It);let Ot=It[Rt];Ot===void 0&&(Ot=Et.clone(),It[Rt]=Ot),Et=Ot}if(Et.visible=_t.visible,Et.wireframe=_t.wireframe,St===VSMShadowMap?Et.side=_t.shadowSide!==null?_t.shadowSide:_t.side:Et.side=_t.shadowSide!==null?_t.shadowSide:ht[_t.side],Et.alphaMap=_t.alphaMap,Et.alphaTest=_t.alphaTest,Et.map=_t.map,Et.clipShadows=_t.clipShadows,Et.clippingPlanes=_t.clippingPlanes,Et.clipIntersection=_t.clipIntersection,Et.displacementMap=_t.displacementMap,Et.displacementScale=_t.displacementScale,Et.displacementBias=_t.displacementBias,Et.wireframeLinewidth=_t.wireframeLinewidth,Et.linewidth=_t.linewidth,Ct.isPointLight===!0&&Et.isMeshDistanceMaterial===!0){const Mt=tt.properties.get(Et);Mt.light=Ct}return Et}function xt(vt,_t,Ct,St,Et){if(vt.visible===!1)return;if(vt.layers.test(_t.layers)&&(vt.isMesh||vt.isLine||vt.isPoints)&&(vt.castShadow||vt.receiveShadow&&Et===VSMShadowMap)&&(!vt.frustumCulled||it.intersectsObject(vt))){vt.modelViewMatrix.multiplyMatrices(Ct.matrixWorldInverse,vt.matrixWorld);const Rt=_e.update(vt),It=vt.material;if(Array.isArray(It)){const Ot=Rt.groups;for(let Bt=0,Nt=Ot.length;Bt<Nt;Bt++){const zt=Ot[Bt],Dt=It[zt.materialIndex];if(Dt&&Dt.visible){const Ft=bt(vt,Dt,St,Et);tt.renderBufferDirect(Ct,null,Rt,Ft,vt,zt)}}}else if(It.visible){const Ot=bt(vt,It,St,Et);tt.renderBufferDirect(Ct,null,Rt,Ot,vt,null)}}const Mt=vt.children;for(let Rt=0,It=Mt.length;Rt<It;Rt++)xt(Mt[Rt],_t,Ct,St,Et)}}function WebGLState(tt,_e,rt){const it=rt.isWebGL2;function nt(){let br=!1;const Rr=new Vector4;let Tr=null;const Vr=new Vector4(0,0,0,0);return{setMask:function(Wr){Tr!==Wr&&!br&&(tt.colorMask(Wr,Wr,Wr,Wr),Tr=Wr)},setLocked:function(Wr){br=Wr},setClear:function(Wr,pn,En,rn,Cn){Cn===!0&&(Wr*=rn,pn*=rn,En*=rn),Rr.set(Wr,pn,En,rn),Vr.equals(Rr)===!1&&(tt.clearColor(Wr,pn,En,rn),Vr.copy(Rr))},reset:function(){br=!1,Tr=null,Vr.set(-1,0,0,0)}}}function st(){let br=!1,Rr=null,Tr=null,Vr=null;return{setTest:function(Wr){Wr?ir(tt.DEPTH_TEST):ur(tt.DEPTH_TEST)},setMask:function(Wr){Rr!==Wr&&!br&&(tt.depthMask(Wr),Rr=Wr)},setFunc:function(Wr){if(Tr!==Wr){switch(Wr){case NeverDepth:tt.depthFunc(tt.NEVER);break;case AlwaysDepth:tt.depthFunc(tt.ALWAYS);break;case LessDepth:tt.depthFunc(tt.LESS);break;case LessEqualDepth:tt.depthFunc(tt.LEQUAL);break;case EqualDepth:tt.depthFunc(tt.EQUAL);break;case GreaterEqualDepth:tt.depthFunc(tt.GEQUAL);break;case GreaterDepth:tt.depthFunc(tt.GREATER);break;case NotEqualDepth:tt.depthFunc(tt.NOTEQUAL);break;default:tt.depthFunc(tt.LEQUAL)}Tr=Wr}},setLocked:function(Wr){br=Wr},setClear:function(Wr){Vr!==Wr&&(tt.clearDepth(Wr),Vr=Wr)},reset:function(){br=!1,Rr=null,Tr=null,Vr=null}}}function at(){let br=!1,Rr=null,Tr=null,Vr=null,Wr=null,pn=null,En=null,rn=null,Cn=null;return{setTest:function(vn){br||(vn?ir(tt.STENCIL_TEST):ur(tt.STENCIL_TEST))},setMask:function(vn){Rr!==vn&&!br&&(tt.stencilMask(vn),Rr=vn)},setFunc:function(vn,an,yn){(Tr!==vn||Vr!==an||Wr!==yn)&&(tt.stencilFunc(vn,an,yn),Tr=vn,Vr=an,Wr=yn)},setOp:function(vn,an,yn){(pn!==vn||En!==an||rn!==yn)&&(tt.stencilOp(vn,an,yn),pn=vn,En=an,rn=yn)},setLocked:function(vn){br=vn},setClear:function(vn){Cn!==vn&&(tt.clearStencil(vn),Cn=vn)},reset:function(){br=!1,Rr=null,Tr=null,Vr=null,Wr=null,pn=null,En=null,rn=null,Cn=null}}}const lt=new nt,ot=new st,ct=new at,ut=new WeakMap,ht=new WeakMap;let dt={},pt={},ft=new WeakMap,gt=[],mt=null,At=!1,yt=null,bt=null,xt=null,vt=null,_t=null,Ct=null,St=null,Et=!1,Tt=null,Mt=null,Rt=null,It=null,Ot=null;const Bt=tt.getParameter(tt.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Nt=!1,zt=0;const Dt=tt.getParameter(tt.VERSION);Dt.indexOf("WebGL")!==-1?(zt=parseFloat(/^WebGL (\d)/.exec(Dt)[1]),Nt=zt>=1):Dt.indexOf("OpenGL ES")!==-1&&(zt=parseFloat(/^OpenGL ES (\d)/.exec(Dt)[1]),Nt=zt>=2);let Ft=null,Ut={};const $t=tt.getParameter(tt.SCISSOR_BOX),Vt=tt.getParameter(tt.VIEWPORT),Zt=new Vector4().fromArray($t),qt=new Vector4().fromArray(Vt);function sr(br,Rr,Tr,Vr){const Wr=new Uint8Array(4),pn=tt.createTexture();tt.bindTexture(br,pn),tt.texParameteri(br,tt.TEXTURE_MIN_FILTER,tt.NEAREST),tt.texParameteri(br,tt.TEXTURE_MAG_FILTER,tt.NEAREST);for(let En=0;En<Tr;En++)it&&(br===tt.TEXTURE_3D||br===tt.TEXTURE_2D_ARRAY)?tt.texImage3D(Rr,0,tt.RGBA,1,1,Vr,0,tt.RGBA,tt.UNSIGNED_BYTE,Wr):tt.texImage2D(Rr+En,0,tt.RGBA,1,1,0,tt.RGBA,tt.UNSIGNED_BYTE,Wr);return pn}const er={};er[tt.TEXTURE_2D]=sr(tt.TEXTURE_2D,tt.TEXTURE_2D,1),er[tt.TEXTURE_CUBE_MAP]=sr(tt.TEXTURE_CUBE_MAP,tt.TEXTURE_CUBE_MAP_POSITIVE_X,6),it&&(er[tt.TEXTURE_2D_ARRAY]=sr(tt.TEXTURE_2D_ARRAY,tt.TEXTURE_2D_ARRAY,1,1),er[tt.TEXTURE_3D]=sr(tt.TEXTURE_3D,tt.TEXTURE_3D,1,1)),lt.setClear(0,0,0,1),ot.setClear(1),ct.setClear(0),ir(tt.DEPTH_TEST),ot.setFunc(LessEqualDepth),Er(!1),Nr(CullFaceBack),ir(tt.CULL_FACE),mr(NoBlending);function ir(br){dt[br]!==!0&&(tt.enable(br),dt[br]=!0)}function ur(br){dt[br]!==!1&&(tt.disable(br),dt[br]=!1)}function ar(br,Rr){return pt[br]!==Rr?(tt.bindFramebuffer(br,Rr),pt[br]=Rr,it&&(br===tt.DRAW_FRAMEBUFFER&&(pt[tt.FRAMEBUFFER]=Rr),br===tt.FRAMEBUFFER&&(pt[tt.DRAW_FRAMEBUFFER]=Rr)),!0):!1}function lr(br,Rr){let Tr=gt,Vr=!1;if(br)if(Tr=ft.get(Rr),Tr===void 0&&(Tr=[],ft.set(Rr,Tr)),br.isWebGLMultipleRenderTargets){const Wr=br.texture;if(Tr.length!==Wr.length||Tr[0]!==tt.COLOR_ATTACHMENT0){for(let pn=0,En=Wr.length;pn<En;pn++)Tr[pn]=tt.COLOR_ATTACHMENT0+pn;Tr.length=Wr.length,Vr=!0}}else Tr[0]!==tt.COLOR_ATTACHMENT0&&(Tr[0]=tt.COLOR_ATTACHMENT0,Vr=!0);else Tr[0]!==tt.BACK&&(Tr[0]=tt.BACK,Vr=!0);Vr&&(rt.isWebGL2?tt.drawBuffers(Tr):_e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Tr))}function gr(br){return mt!==br?(tt.useProgram(br),mt=br,!0):!1}const Yt={[AddEquation]:tt.FUNC_ADD,[SubtractEquation]:tt.FUNC_SUBTRACT,[ReverseSubtractEquation]:tt.FUNC_REVERSE_SUBTRACT};if(it)Yt[MinEquation]=tt.MIN,Yt[MaxEquation]=tt.MAX;else{const br=_e.get("EXT_blend_minmax");br!==null&&(Yt[MinEquation]=br.MIN_EXT,Yt[MaxEquation]=br.MAX_EXT)}const nr={[ZeroFactor]:tt.ZERO,[OneFactor]:tt.ONE,[SrcColorFactor]:tt.SRC_COLOR,[SrcAlphaFactor]:tt.SRC_ALPHA,[SrcAlphaSaturateFactor]:tt.SRC_ALPHA_SATURATE,[DstColorFactor]:tt.DST_COLOR,[DstAlphaFactor]:tt.DST_ALPHA,[OneMinusSrcColorFactor]:tt.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:tt.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:tt.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:tt.ONE_MINUS_DST_ALPHA};function mr(br,Rr,Tr,Vr,Wr,pn,En,rn){if(br===NoBlending){At===!0&&(ur(tt.BLEND),At=!1);return}if(At===!1&&(ir(tt.BLEND),At=!0),br!==CustomBlending){if(br!==yt||rn!==Et){if((bt!==AddEquation||_t!==AddEquation)&&(tt.blendEquation(tt.FUNC_ADD),bt=AddEquation,_t=AddEquation),rn)switch(br){case NormalBlending:tt.blendFuncSeparate(tt.ONE,tt.ONE_MINUS_SRC_ALPHA,tt.ONE,tt.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:tt.blendFunc(tt.ONE,tt.ONE);break;case SubtractiveBlending:tt.blendFuncSeparate(tt.ZERO,tt.ONE_MINUS_SRC_COLOR,tt.ZERO,tt.ONE);break;case MultiplyBlending:tt.blendFuncSeparate(tt.ZERO,tt.SRC_COLOR,tt.ZERO,tt.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",br);break}else switch(br){case NormalBlending:tt.blendFuncSeparate(tt.SRC_ALPHA,tt.ONE_MINUS_SRC_ALPHA,tt.ONE,tt.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:tt.blendFunc(tt.SRC_ALPHA,tt.ONE);break;case SubtractiveBlending:tt.blendFuncSeparate(tt.ZERO,tt.ONE_MINUS_SRC_COLOR,tt.ZERO,tt.ONE);break;case MultiplyBlending:tt.blendFunc(tt.ZERO,tt.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",br);break}xt=null,vt=null,Ct=null,St=null,yt=br,Et=rn}return}Wr=Wr||Rr,pn=pn||Tr,En=En||Vr,(Rr!==bt||Wr!==_t)&&(tt.blendEquationSeparate(Yt[Rr],Yt[Wr]),bt=Rr,_t=Wr),(Tr!==xt||Vr!==vt||pn!==Ct||En!==St)&&(tt.blendFuncSeparate(nr[Tr],nr[Vr],nr[pn],nr[En]),xt=Tr,vt=Vr,Ct=pn,St=En),yt=br,Et=!1}function Sr(br,Rr){br.side===DoubleSide?ur(tt.CULL_FACE):ir(tt.CULL_FACE);let Tr=br.side===BackSide;Rr&&(Tr=!Tr),Er(Tr),br.blending===NormalBlending&&br.transparent===!1?mr(NoBlending):mr(br.blending,br.blendEquation,br.blendSrc,br.blendDst,br.blendEquationAlpha,br.blendSrcAlpha,br.blendDstAlpha,br.premultipliedAlpha),ot.setFunc(br.depthFunc),ot.setTest(br.depthTest),ot.setMask(br.depthWrite),lt.setMask(br.colorWrite);const Vr=br.stencilWrite;ct.setTest(Vr),Vr&&(ct.setMask(br.stencilWriteMask),ct.setFunc(br.stencilFunc,br.stencilRef,br.stencilFuncMask),ct.setOp(br.stencilFail,br.stencilZFail,br.stencilZPass)),kr(br.polygonOffset,br.polygonOffsetFactor,br.polygonOffsetUnits),br.alphaToCoverage===!0?ir(tt.SAMPLE_ALPHA_TO_COVERAGE):ur(tt.SAMPLE_ALPHA_TO_COVERAGE)}function Er(br){Tt!==br&&(br?tt.frontFace(tt.CW):tt.frontFace(tt.CCW),Tt=br)}function Nr(br){br!==CullFaceNone?(ir(tt.CULL_FACE),br!==Mt&&(br===CullFaceBack?tt.cullFace(tt.BACK):br===CullFaceFront?tt.cullFace(tt.FRONT):tt.cullFace(tt.FRONT_AND_BACK))):ur(tt.CULL_FACE),Mt=br}function wr(br){br!==Rt&&(Nt&&tt.lineWidth(br),Rt=br)}function kr(br,Rr,Tr){br?(ir(tt.POLYGON_OFFSET_FILL),(It!==Rr||Ot!==Tr)&&(tt.polygonOffset(Rr,Tr),It=Rr,Ot=Tr)):ur(tt.POLYGON_OFFSET_FILL)}function Ur(br){br?ir(tt.SCISSOR_TEST):ur(tt.SCISSOR_TEST)}function Or(br){br===void 0&&(br=tt.TEXTURE0+Bt-1),Ft!==br&&(tt.activeTexture(br),Ft=br)}function Xr(br,Rr,Tr){Tr===void 0&&(Ft===null?Tr=tt.TEXTURE0+Bt-1:Tr=Ft);let Vr=Ut[Tr];Vr===void 0&&(Vr={type:void 0,texture:void 0},Ut[Tr]=Vr),(Vr.type!==br||Vr.texture!==Rr)&&(Ft!==Tr&&(tt.activeTexture(Tr),Ft=Tr),tt.bindTexture(br,Rr||er[br]),Vr.type=br,Vr.texture=Rr)}function Qt(){const br=Ut[Ft];br!==void 0&&br.type!==void 0&&(tt.bindTexture(br.type,null),br.type=void 0,br.texture=void 0)}function Xt(){try{tt.compressedTexImage2D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function xr(){try{tt.compressedTexImage3D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function Lr(){try{tt.texSubImage2D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function fr(){try{tt.texSubImage3D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function pr(){try{tt.compressedTexSubImage2D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function Hr(){try{tt.compressedTexSubImage3D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function hr(){try{tt.texStorage2D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function Cr(){try{tt.texStorage3D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function tr(){try{tt.texImage2D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function Ar(){try{tt.texImage3D.apply(tt,arguments)}catch(br){console.error("THREE.WebGLState:",br)}}function yr(br){Zt.equals(br)===!1&&(tt.scissor(br.x,br.y,br.z,br.w),Zt.copy(br))}function Jt(br){qt.equals(br)===!1&&(tt.viewport(br.x,br.y,br.z,br.w),qt.copy(br))}function _r(br,Rr){let Tr=ht.get(Rr);Tr===void 0&&(Tr=new WeakMap,ht.set(Rr,Tr));let Vr=Tr.get(br);Vr===void 0&&(Vr=tt.getUniformBlockIndex(Rr,br.name),Tr.set(br,Vr))}function Kt(br,Rr){const Vr=ht.get(Rr).get(br);ut.get(Rr)!==Vr&&(tt.uniformBlockBinding(Rr,Vr,br.__bindingPointIndex),ut.set(Rr,Vr))}function Qr(){tt.disable(tt.BLEND),tt.disable(tt.CULL_FACE),tt.disable(tt.DEPTH_TEST),tt.disable(tt.POLYGON_OFFSET_FILL),tt.disable(tt.SCISSOR_TEST),tt.disable(tt.STENCIL_TEST),tt.disable(tt.SAMPLE_ALPHA_TO_COVERAGE),tt.blendEquation(tt.FUNC_ADD),tt.blendFunc(tt.ONE,tt.ZERO),tt.blendFuncSeparate(tt.ONE,tt.ZERO,tt.ONE,tt.ZERO),tt.colorMask(!0,!0,!0,!0),tt.clearColor(0,0,0,0),tt.depthMask(!0),tt.depthFunc(tt.LESS),tt.clearDepth(1),tt.stencilMask(4294967295),tt.stencilFunc(tt.ALWAYS,0,4294967295),tt.stencilOp(tt.KEEP,tt.KEEP,tt.KEEP),tt.clearStencil(0),tt.cullFace(tt.BACK),tt.frontFace(tt.CCW),tt.polygonOffset(0,0),tt.activeTexture(tt.TEXTURE0),tt.bindFramebuffer(tt.FRAMEBUFFER,null),it===!0&&(tt.bindFramebuffer(tt.DRAW_FRAMEBUFFER,null),tt.bindFramebuffer(tt.READ_FRAMEBUFFER,null)),tt.useProgram(null),tt.lineWidth(1),tt.scissor(0,0,tt.canvas.width,tt.canvas.height),tt.viewport(0,0,tt.canvas.width,tt.canvas.height),dt={},Ft=null,Ut={},pt={},ft=new WeakMap,gt=[],mt=null,At=!1,yt=null,bt=null,xt=null,vt=null,_t=null,Ct=null,St=null,Et=!1,Tt=null,Mt=null,Rt=null,It=null,Ot=null,Zt.set(0,0,tt.canvas.width,tt.canvas.height),qt.set(0,0,tt.canvas.width,tt.canvas.height),lt.reset(),ot.reset(),ct.reset()}return{buffers:{color:lt,depth:ot,stencil:ct},enable:ir,disable:ur,bindFramebuffer:ar,drawBuffers:lr,useProgram:gr,setBlending:mr,setMaterial:Sr,setFlipSided:Er,setCullFace:Nr,setLineWidth:wr,setPolygonOffset:kr,setScissorTest:Ur,activeTexture:Or,bindTexture:Xr,unbindTexture:Qt,compressedTexImage2D:Xt,compressedTexImage3D:xr,texImage2D:tr,texImage3D:Ar,updateUBOMapping:_r,uniformBlockBinding:Kt,texStorage2D:hr,texStorage3D:Cr,texSubImage2D:Lr,texSubImage3D:fr,compressedTexSubImage2D:pr,compressedTexSubImage3D:Hr,scissor:yr,viewport:Jt,reset:Qr}}function WebGLTextures(tt,_e,rt,it,nt,st,at){const lt=nt.isWebGL2,ot=nt.maxTextures,ct=nt.maxCubemapSize,ut=nt.maxTextureSize,ht=nt.maxSamples,dt=_e.has("WEBGL_multisampled_render_to_texture")?_e.get("WEBGL_multisampled_render_to_texture"):null,pt=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),ft=new WeakMap;let gt;const mt=new WeakMap;let At=!1;try{At=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function yt(Qt,Xt){return At?new OffscreenCanvas(Qt,Xt):createElementNS("canvas")}function bt(Qt,Xt,xr,Lr){let fr=1;if((Qt.width>Lr||Qt.height>Lr)&&(fr=Lr/Math.max(Qt.width,Qt.height)),fr<1||Xt===!0)if(typeof HTMLImageElement<"u"&&Qt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Qt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Qt instanceof ImageBitmap){const pr=Xt?floorPowerOfTwo:Math.floor,Hr=pr(fr*Qt.width),hr=pr(fr*Qt.height);gt===void 0&&(gt=yt(Hr,hr));const Cr=xr?yt(Hr,hr):gt;return Cr.width=Hr,Cr.height=hr,Cr.getContext("2d").drawImage(Qt,0,0,Hr,hr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Qt.width+"x"+Qt.height+") to ("+Hr+"x"+hr+")."),Cr}else return"data"in Qt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Qt.width+"x"+Qt.height+")."),Qt;return Qt}function xt(Qt){return isPowerOfTwo(Qt.width)&&isPowerOfTwo(Qt.height)}function vt(Qt){return lt?!1:Qt.wrapS!==ClampToEdgeWrapping||Qt.wrapT!==ClampToEdgeWrapping||Qt.minFilter!==NearestFilter&&Qt.minFilter!==LinearFilter}function _t(Qt,Xt){return Qt.generateMipmaps&&Xt&&Qt.minFilter!==NearestFilter&&Qt.minFilter!==LinearFilter}function Ct(Qt){tt.generateMipmap(Qt)}function St(Qt,Xt,xr,Lr,fr=!1){if(lt===!1)return Xt;if(Qt!==null){if(tt[Qt]!==void 0)return tt[Qt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Qt+"'")}let pr=Xt;return Xt===tt.RED&&(xr===tt.FLOAT&&(pr=tt.R32F),xr===tt.HALF_FLOAT&&(pr=tt.R16F),xr===tt.UNSIGNED_BYTE&&(pr=tt.R8)),Xt===tt.RG&&(xr===tt.FLOAT&&(pr=tt.RG32F),xr===tt.HALF_FLOAT&&(pr=tt.RG16F),xr===tt.UNSIGNED_BYTE&&(pr=tt.RG8)),Xt===tt.RGBA&&(xr===tt.FLOAT&&(pr=tt.RGBA32F),xr===tt.HALF_FLOAT&&(pr=tt.RGBA16F),xr===tt.UNSIGNED_BYTE&&(pr=Lr===SRGBColorSpace&&fr===!1?tt.SRGB8_ALPHA8:tt.RGBA8),xr===tt.UNSIGNED_SHORT_4_4_4_4&&(pr=tt.RGBA4),xr===tt.UNSIGNED_SHORT_5_5_5_1&&(pr=tt.RGB5_A1)),(pr===tt.R16F||pr===tt.R32F||pr===tt.RG16F||pr===tt.RG32F||pr===tt.RGBA16F||pr===tt.RGBA32F)&&_e.get("EXT_color_buffer_float"),pr}function Et(Qt,Xt,xr){return _t(Qt,xr)===!0||Qt.isFramebufferTexture&&Qt.minFilter!==NearestFilter&&Qt.minFilter!==LinearFilter?Math.log2(Math.max(Xt.width,Xt.height))+1:Qt.mipmaps!==void 0&&Qt.mipmaps.length>0?Qt.mipmaps.length:Qt.isCompressedTexture&&Array.isArray(Qt.image)?Xt.mipmaps.length:1}function Tt(Qt){return Qt===NearestFilter||Qt===NearestMipmapNearestFilter||Qt===NearestMipmapLinearFilter?tt.NEAREST:tt.LINEAR}function Mt(Qt){const Xt=Qt.target;Xt.removeEventListener("dispose",Mt),It(Xt),Xt.isVideoTexture&&ft.delete(Xt)}function Rt(Qt){const Xt=Qt.target;Xt.removeEventListener("dispose",Rt),Bt(Xt)}function It(Qt){const Xt=it.get(Qt);if(Xt.__webglInit===void 0)return;const xr=Qt.source,Lr=mt.get(xr);if(Lr){const fr=Lr[Xt.__cacheKey];fr.usedTimes--,fr.usedTimes===0&&Ot(Qt),Object.keys(Lr).length===0&&mt.delete(xr)}it.remove(Qt)}function Ot(Qt){const Xt=it.get(Qt);tt.deleteTexture(Xt.__webglTexture);const xr=Qt.source,Lr=mt.get(xr);delete Lr[Xt.__cacheKey],at.memory.textures--}function Bt(Qt){const Xt=Qt.texture,xr=it.get(Qt),Lr=it.get(Xt);if(Lr.__webglTexture!==void 0&&(tt.deleteTexture(Lr.__webglTexture),at.memory.textures--),Qt.depthTexture&&Qt.depthTexture.dispose(),Qt.isWebGLCubeRenderTarget)for(let fr=0;fr<6;fr++)tt.deleteFramebuffer(xr.__webglFramebuffer[fr]),xr.__webglDepthbuffer&&tt.deleteRenderbuffer(xr.__webglDepthbuffer[fr]);else{if(tt.deleteFramebuffer(xr.__webglFramebuffer),xr.__webglDepthbuffer&&tt.deleteRenderbuffer(xr.__webglDepthbuffer),xr.__webglMultisampledFramebuffer&&tt.deleteFramebuffer(xr.__webglMultisampledFramebuffer),xr.__webglColorRenderbuffer)for(let fr=0;fr<xr.__webglColorRenderbuffer.length;fr++)xr.__webglColorRenderbuffer[fr]&&tt.deleteRenderbuffer(xr.__webglColorRenderbuffer[fr]);xr.__webglDepthRenderbuffer&&tt.deleteRenderbuffer(xr.__webglDepthRenderbuffer)}if(Qt.isWebGLMultipleRenderTargets)for(let fr=0,pr=Xt.length;fr<pr;fr++){const Hr=it.get(Xt[fr]);Hr.__webglTexture&&(tt.deleteTexture(Hr.__webglTexture),at.memory.textures--),it.remove(Xt[fr])}it.remove(Xt),it.remove(Qt)}let Nt=0;function zt(){Nt=0}function Dt(){const Qt=Nt;return Qt>=ot&&console.warn("THREE.WebGLTextures: Trying to use "+Qt+" texture units while this GPU supports only "+ot),Nt+=1,Qt}function Ft(Qt){const Xt=[];return Xt.push(Qt.wrapS),Xt.push(Qt.wrapT),Xt.push(Qt.wrapR||0),Xt.push(Qt.magFilter),Xt.push(Qt.minFilter),Xt.push(Qt.anisotropy),Xt.push(Qt.internalFormat),Xt.push(Qt.format),Xt.push(Qt.type),Xt.push(Qt.generateMipmaps),Xt.push(Qt.premultiplyAlpha),Xt.push(Qt.flipY),Xt.push(Qt.unpackAlignment),Xt.push(Qt.colorSpace),Xt.join()}function Ut(Qt,Xt){const xr=it.get(Qt);if(Qt.isVideoTexture&&Or(Qt),Qt.isRenderTargetTexture===!1&&Qt.version>0&&xr.__version!==Qt.version){const Lr=Qt.image;if(Lr===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Lr.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ar(xr,Qt,Xt);return}}rt.bindTexture(tt.TEXTURE_2D,xr.__webglTexture,tt.TEXTURE0+Xt)}function $t(Qt,Xt){const xr=it.get(Qt);if(Qt.version>0&&xr.__version!==Qt.version){ar(xr,Qt,Xt);return}rt.bindTexture(tt.TEXTURE_2D_ARRAY,xr.__webglTexture,tt.TEXTURE0+Xt)}function Vt(Qt,Xt){const xr=it.get(Qt);if(Qt.version>0&&xr.__version!==Qt.version){ar(xr,Qt,Xt);return}rt.bindTexture(tt.TEXTURE_3D,xr.__webglTexture,tt.TEXTURE0+Xt)}function Zt(Qt,Xt){const xr=it.get(Qt);if(Qt.version>0&&xr.__version!==Qt.version){lr(xr,Qt,Xt);return}rt.bindTexture(tt.TEXTURE_CUBE_MAP,xr.__webglTexture,tt.TEXTURE0+Xt)}const qt={[RepeatWrapping]:tt.REPEAT,[ClampToEdgeWrapping]:tt.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:tt.MIRRORED_REPEAT},sr={[NearestFilter]:tt.NEAREST,[NearestMipmapNearestFilter]:tt.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:tt.NEAREST_MIPMAP_LINEAR,[LinearFilter]:tt.LINEAR,[LinearMipmapNearestFilter]:tt.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:tt.LINEAR_MIPMAP_LINEAR},er={[NeverCompare]:tt.NEVER,[AlwaysCompare]:tt.ALWAYS,[LessCompare]:tt.LESS,[LessEqualCompare]:tt.LEQUAL,[EqualCompare]:tt.EQUAL,[GreaterEqualCompare]:tt.GEQUAL,[GreaterCompare]:tt.GREATER,[NotEqualCompare]:tt.NOTEQUAL};function ir(Qt,Xt,xr){if(xr?(tt.texParameteri(Qt,tt.TEXTURE_WRAP_S,qt[Xt.wrapS]),tt.texParameteri(Qt,tt.TEXTURE_WRAP_T,qt[Xt.wrapT]),(Qt===tt.TEXTURE_3D||Qt===tt.TEXTURE_2D_ARRAY)&&tt.texParameteri(Qt,tt.TEXTURE_WRAP_R,qt[Xt.wrapR]),tt.texParameteri(Qt,tt.TEXTURE_MAG_FILTER,sr[Xt.magFilter]),tt.texParameteri(Qt,tt.TEXTURE_MIN_FILTER,sr[Xt.minFilter])):(tt.texParameteri(Qt,tt.TEXTURE_WRAP_S,tt.CLAMP_TO_EDGE),tt.texParameteri(Qt,tt.TEXTURE_WRAP_T,tt.CLAMP_TO_EDGE),(Qt===tt.TEXTURE_3D||Qt===tt.TEXTURE_2D_ARRAY)&&tt.texParameteri(Qt,tt.TEXTURE_WRAP_R,tt.CLAMP_TO_EDGE),(Xt.wrapS!==ClampToEdgeWrapping||Xt.wrapT!==ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),tt.texParameteri(Qt,tt.TEXTURE_MAG_FILTER,Tt(Xt.magFilter)),tt.texParameteri(Qt,tt.TEXTURE_MIN_FILTER,Tt(Xt.minFilter)),Xt.minFilter!==NearestFilter&&Xt.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Xt.compareFunction&&(tt.texParameteri(Qt,tt.TEXTURE_COMPARE_MODE,tt.COMPARE_REF_TO_TEXTURE),tt.texParameteri(Qt,tt.TEXTURE_COMPARE_FUNC,er[Xt.compareFunction])),_e.has("EXT_texture_filter_anisotropic")===!0){const Lr=_e.get("EXT_texture_filter_anisotropic");if(Xt.magFilter===NearestFilter||Xt.minFilter!==NearestMipmapLinearFilter&&Xt.minFilter!==LinearMipmapLinearFilter||Xt.type===FloatType&&_e.has("OES_texture_float_linear")===!1||lt===!1&&Xt.type===HalfFloatType&&_e.has("OES_texture_half_float_linear")===!1)return;(Xt.anisotropy>1||it.get(Xt).__currentAnisotropy)&&(tt.texParameterf(Qt,Lr.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Xt.anisotropy,nt.getMaxAnisotropy())),it.get(Xt).__currentAnisotropy=Xt.anisotropy)}}function ur(Qt,Xt){let xr=!1;Qt.__webglInit===void 0&&(Qt.__webglInit=!0,Xt.addEventListener("dispose",Mt));const Lr=Xt.source;let fr=mt.get(Lr);fr===void 0&&(fr={},mt.set(Lr,fr));const pr=Ft(Xt);if(pr!==Qt.__cacheKey){fr[pr]===void 0&&(fr[pr]={texture:tt.createTexture(),usedTimes:0},at.memory.textures++,xr=!0),fr[pr].usedTimes++;const Hr=fr[Qt.__cacheKey];Hr!==void 0&&(fr[Qt.__cacheKey].usedTimes--,Hr.usedTimes===0&&Ot(Xt)),Qt.__cacheKey=pr,Qt.__webglTexture=fr[pr].texture}return xr}function ar(Qt,Xt,xr){let Lr=tt.TEXTURE_2D;(Xt.isDataArrayTexture||Xt.isCompressedArrayTexture)&&(Lr=tt.TEXTURE_2D_ARRAY),Xt.isData3DTexture&&(Lr=tt.TEXTURE_3D);const fr=ur(Qt,Xt),pr=Xt.source;rt.bindTexture(Lr,Qt.__webglTexture,tt.TEXTURE0+xr);const Hr=it.get(pr);if(pr.version!==Hr.__version||fr===!0){rt.activeTexture(tt.TEXTURE0+xr),tt.pixelStorei(tt.UNPACK_FLIP_Y_WEBGL,Xt.flipY),tt.pixelStorei(tt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Xt.premultiplyAlpha),tt.pixelStorei(tt.UNPACK_ALIGNMENT,Xt.unpackAlignment),tt.pixelStorei(tt.UNPACK_COLORSPACE_CONVERSION_WEBGL,tt.NONE);const hr=vt(Xt)&&xt(Xt.image)===!1;let Cr=bt(Xt.image,hr,!1,ut);Cr=Xr(Xt,Cr);const tr=xt(Cr)||lt,Ar=st.convert(Xt.format,Xt.colorSpace);let yr=st.convert(Xt.type),Jt=St(Xt.internalFormat,Ar,yr,Xt.colorSpace);ir(Lr,Xt,tr);let _r;const Kt=Xt.mipmaps,Qr=lt&&Xt.isVideoTexture!==!0,br=Hr.__version===void 0||fr===!0,Rr=Et(Xt,Cr,tr);if(Xt.isDepthTexture)Jt=tt.DEPTH_COMPONENT,lt?Xt.type===FloatType?Jt=tt.DEPTH_COMPONENT32F:Xt.type===UnsignedIntType?Jt=tt.DEPTH_COMPONENT24:Xt.type===UnsignedInt248Type?Jt=tt.DEPTH24_STENCIL8:Jt=tt.DEPTH_COMPONENT16:Xt.type===FloatType&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Xt.format===DepthFormat&&Jt===tt.DEPTH_COMPONENT&&Xt.type!==UnsignedShortType&&Xt.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Xt.type=UnsignedIntType,yr=st.convert(Xt.type)),Xt.format===DepthStencilFormat&&Jt===tt.DEPTH_COMPONENT&&(Jt=tt.DEPTH_STENCIL,Xt.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Xt.type=UnsignedInt248Type,yr=st.convert(Xt.type))),br&&(Qr?rt.texStorage2D(tt.TEXTURE_2D,1,Jt,Cr.width,Cr.height):rt.texImage2D(tt.TEXTURE_2D,0,Jt,Cr.width,Cr.height,0,Ar,yr,null));else if(Xt.isDataTexture)if(Kt.length>0&&tr){Qr&&br&&rt.texStorage2D(tt.TEXTURE_2D,Rr,Jt,Kt[0].width,Kt[0].height);for(let Tr=0,Vr=Kt.length;Tr<Vr;Tr++)_r=Kt[Tr],Qr?rt.texSubImage2D(tt.TEXTURE_2D,Tr,0,0,_r.width,_r.height,Ar,yr,_r.data):rt.texImage2D(tt.TEXTURE_2D,Tr,Jt,_r.width,_r.height,0,Ar,yr,_r.data);Xt.generateMipmaps=!1}else Qr?(br&&rt.texStorage2D(tt.TEXTURE_2D,Rr,Jt,Cr.width,Cr.height),rt.texSubImage2D(tt.TEXTURE_2D,0,0,0,Cr.width,Cr.height,Ar,yr,Cr.data)):rt.texImage2D(tt.TEXTURE_2D,0,Jt,Cr.width,Cr.height,0,Ar,yr,Cr.data);else if(Xt.isCompressedTexture)if(Xt.isCompressedArrayTexture){Qr&&br&&rt.texStorage3D(tt.TEXTURE_2D_ARRAY,Rr,Jt,Kt[0].width,Kt[0].height,Cr.depth);for(let Tr=0,Vr=Kt.length;Tr<Vr;Tr++)_r=Kt[Tr],Xt.format!==RGBAFormat?Ar!==null?Qr?rt.compressedTexSubImage3D(tt.TEXTURE_2D_ARRAY,Tr,0,0,0,_r.width,_r.height,Cr.depth,Ar,_r.data,0,0):rt.compressedTexImage3D(tt.TEXTURE_2D_ARRAY,Tr,Jt,_r.width,_r.height,Cr.depth,0,_r.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qr?rt.texSubImage3D(tt.TEXTURE_2D_ARRAY,Tr,0,0,0,_r.width,_r.height,Cr.depth,Ar,yr,_r.data):rt.texImage3D(tt.TEXTURE_2D_ARRAY,Tr,Jt,_r.width,_r.height,Cr.depth,0,Ar,yr,_r.data)}else{Qr&&br&&rt.texStorage2D(tt.TEXTURE_2D,Rr,Jt,Kt[0].width,Kt[0].height);for(let Tr=0,Vr=Kt.length;Tr<Vr;Tr++)_r=Kt[Tr],Xt.format!==RGBAFormat?Ar!==null?Qr?rt.compressedTexSubImage2D(tt.TEXTURE_2D,Tr,0,0,_r.width,_r.height,Ar,_r.data):rt.compressedTexImage2D(tt.TEXTURE_2D,Tr,Jt,_r.width,_r.height,0,_r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qr?rt.texSubImage2D(tt.TEXTURE_2D,Tr,0,0,_r.width,_r.height,Ar,yr,_r.data):rt.texImage2D(tt.TEXTURE_2D,Tr,Jt,_r.width,_r.height,0,Ar,yr,_r.data)}else if(Xt.isDataArrayTexture)Qr?(br&&rt.texStorage3D(tt.TEXTURE_2D_ARRAY,Rr,Jt,Cr.width,Cr.height,Cr.depth),rt.texSubImage3D(tt.TEXTURE_2D_ARRAY,0,0,0,0,Cr.width,Cr.height,Cr.depth,Ar,yr,Cr.data)):rt.texImage3D(tt.TEXTURE_2D_ARRAY,0,Jt,Cr.width,Cr.height,Cr.depth,0,Ar,yr,Cr.data);else if(Xt.isData3DTexture)Qr?(br&&rt.texStorage3D(tt.TEXTURE_3D,Rr,Jt,Cr.width,Cr.height,Cr.depth),rt.texSubImage3D(tt.TEXTURE_3D,0,0,0,0,Cr.width,Cr.height,Cr.depth,Ar,yr,Cr.data)):rt.texImage3D(tt.TEXTURE_3D,0,Jt,Cr.width,Cr.height,Cr.depth,0,Ar,yr,Cr.data);else if(Xt.isFramebufferTexture){if(br)if(Qr)rt.texStorage2D(tt.TEXTURE_2D,Rr,Jt,Cr.width,Cr.height);else{let Tr=Cr.width,Vr=Cr.height;for(let Wr=0;Wr<Rr;Wr++)rt.texImage2D(tt.TEXTURE_2D,Wr,Jt,Tr,Vr,0,Ar,yr,null),Tr>>=1,Vr>>=1}}else if(Kt.length>0&&tr){Qr&&br&&rt.texStorage2D(tt.TEXTURE_2D,Rr,Jt,Kt[0].width,Kt[0].height);for(let Tr=0,Vr=Kt.length;Tr<Vr;Tr++)_r=Kt[Tr],Qr?rt.texSubImage2D(tt.TEXTURE_2D,Tr,0,0,Ar,yr,_r):rt.texImage2D(tt.TEXTURE_2D,Tr,Jt,Ar,yr,_r);Xt.generateMipmaps=!1}else Qr?(br&&rt.texStorage2D(tt.TEXTURE_2D,Rr,Jt,Cr.width,Cr.height),rt.texSubImage2D(tt.TEXTURE_2D,0,0,0,Ar,yr,Cr)):rt.texImage2D(tt.TEXTURE_2D,0,Jt,Ar,yr,Cr);_t(Xt,tr)&&Ct(Lr),Hr.__version=pr.version,Xt.onUpdate&&Xt.onUpdate(Xt)}Qt.__version=Xt.version}function lr(Qt,Xt,xr){if(Xt.image.length!==6)return;const Lr=ur(Qt,Xt),fr=Xt.source;rt.bindTexture(tt.TEXTURE_CUBE_MAP,Qt.__webglTexture,tt.TEXTURE0+xr);const pr=it.get(fr);if(fr.version!==pr.__version||Lr===!0){rt.activeTexture(tt.TEXTURE0+xr),tt.pixelStorei(tt.UNPACK_FLIP_Y_WEBGL,Xt.flipY),tt.pixelStorei(tt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Xt.premultiplyAlpha),tt.pixelStorei(tt.UNPACK_ALIGNMENT,Xt.unpackAlignment),tt.pixelStorei(tt.UNPACK_COLORSPACE_CONVERSION_WEBGL,tt.NONE);const Hr=Xt.isCompressedTexture||Xt.image[0].isCompressedTexture,hr=Xt.image[0]&&Xt.image[0].isDataTexture,Cr=[];for(let Tr=0;Tr<6;Tr++)!Hr&&!hr?Cr[Tr]=bt(Xt.image[Tr],!1,!0,ct):Cr[Tr]=hr?Xt.image[Tr].image:Xt.image[Tr],Cr[Tr]=Xr(Xt,Cr[Tr]);const tr=Cr[0],Ar=xt(tr)||lt,yr=st.convert(Xt.format,Xt.colorSpace),Jt=st.convert(Xt.type),_r=St(Xt.internalFormat,yr,Jt,Xt.colorSpace),Kt=lt&&Xt.isVideoTexture!==!0,Qr=pr.__version===void 0||Lr===!0;let br=Et(Xt,tr,Ar);ir(tt.TEXTURE_CUBE_MAP,Xt,Ar);let Rr;if(Hr){Kt&&Qr&&rt.texStorage2D(tt.TEXTURE_CUBE_MAP,br,_r,tr.width,tr.height);for(let Tr=0;Tr<6;Tr++){Rr=Cr[Tr].mipmaps;for(let Vr=0;Vr<Rr.length;Vr++){const Wr=Rr[Vr];Xt.format!==RGBAFormat?yr!==null?Kt?rt.compressedTexSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,Vr,0,0,Wr.width,Wr.height,yr,Wr.data):rt.compressedTexImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,Vr,_r,Wr.width,Wr.height,0,Wr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Kt?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,Vr,0,0,Wr.width,Wr.height,yr,Jt,Wr.data):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,Vr,_r,Wr.width,Wr.height,0,yr,Jt,Wr.data)}}}else{Rr=Xt.mipmaps,Kt&&Qr&&(Rr.length>0&&br++,rt.texStorage2D(tt.TEXTURE_CUBE_MAP,br,_r,Cr[0].width,Cr[0].height));for(let Tr=0;Tr<6;Tr++)if(hr){Kt?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,0,0,0,Cr[Tr].width,Cr[Tr].height,yr,Jt,Cr[Tr].data):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,0,_r,Cr[Tr].width,Cr[Tr].height,0,yr,Jt,Cr[Tr].data);for(let Vr=0;Vr<Rr.length;Vr++){const pn=Rr[Vr].image[Tr].image;Kt?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,Vr+1,0,0,pn.width,pn.height,yr,Jt,pn.data):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,Vr+1,_r,pn.width,pn.height,0,yr,Jt,pn.data)}}else{Kt?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,0,0,0,yr,Jt,Cr[Tr]):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,0,_r,yr,Jt,Cr[Tr]);for(let Vr=0;Vr<Rr.length;Vr++){const Wr=Rr[Vr];Kt?rt.texSubImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,Vr+1,0,0,yr,Jt,Wr.image[Tr]):rt.texImage2D(tt.TEXTURE_CUBE_MAP_POSITIVE_X+Tr,Vr+1,_r,yr,Jt,Wr.image[Tr])}}}_t(Xt,Ar)&&Ct(tt.TEXTURE_CUBE_MAP),pr.__version=fr.version,Xt.onUpdate&&Xt.onUpdate(Xt)}Qt.__version=Xt.version}function gr(Qt,Xt,xr,Lr,fr){const pr=st.convert(xr.format,xr.colorSpace),Hr=st.convert(xr.type),hr=St(xr.internalFormat,pr,Hr,xr.colorSpace);it.get(Xt).__hasExternalTextures||(fr===tt.TEXTURE_3D||fr===tt.TEXTURE_2D_ARRAY?rt.texImage3D(fr,0,hr,Xt.width,Xt.height,Xt.depth,0,pr,Hr,null):rt.texImage2D(fr,0,hr,Xt.width,Xt.height,0,pr,Hr,null)),rt.bindFramebuffer(tt.FRAMEBUFFER,Qt),Ur(Xt)?dt.framebufferTexture2DMultisampleEXT(tt.FRAMEBUFFER,Lr,fr,it.get(xr).__webglTexture,0,kr(Xt)):(fr===tt.TEXTURE_2D||fr>=tt.TEXTURE_CUBE_MAP_POSITIVE_X&&fr<=tt.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&tt.framebufferTexture2D(tt.FRAMEBUFFER,Lr,fr,it.get(xr).__webglTexture,0),rt.bindFramebuffer(tt.FRAMEBUFFER,null)}function Yt(Qt,Xt,xr){if(tt.bindRenderbuffer(tt.RENDERBUFFER,Qt),Xt.depthBuffer&&!Xt.stencilBuffer){let Lr=tt.DEPTH_COMPONENT16;if(xr||Ur(Xt)){const fr=Xt.depthTexture;fr&&fr.isDepthTexture&&(fr.type===FloatType?Lr=tt.DEPTH_COMPONENT32F:fr.type===UnsignedIntType&&(Lr=tt.DEPTH_COMPONENT24));const pr=kr(Xt);Ur(Xt)?dt.renderbufferStorageMultisampleEXT(tt.RENDERBUFFER,pr,Lr,Xt.width,Xt.height):tt.renderbufferStorageMultisample(tt.RENDERBUFFER,pr,Lr,Xt.width,Xt.height)}else tt.renderbufferStorage(tt.RENDERBUFFER,Lr,Xt.width,Xt.height);tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.DEPTH_ATTACHMENT,tt.RENDERBUFFER,Qt)}else if(Xt.depthBuffer&&Xt.stencilBuffer){const Lr=kr(Xt);xr&&Ur(Xt)===!1?tt.renderbufferStorageMultisample(tt.RENDERBUFFER,Lr,tt.DEPTH24_STENCIL8,Xt.width,Xt.height):Ur(Xt)?dt.renderbufferStorageMultisampleEXT(tt.RENDERBUFFER,Lr,tt.DEPTH24_STENCIL8,Xt.width,Xt.height):tt.renderbufferStorage(tt.RENDERBUFFER,tt.DEPTH_STENCIL,Xt.width,Xt.height),tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.DEPTH_STENCIL_ATTACHMENT,tt.RENDERBUFFER,Qt)}else{const Lr=Xt.isWebGLMultipleRenderTargets===!0?Xt.texture:[Xt.texture];for(let fr=0;fr<Lr.length;fr++){const pr=Lr[fr],Hr=st.convert(pr.format,pr.colorSpace),hr=st.convert(pr.type),Cr=St(pr.internalFormat,Hr,hr,pr.colorSpace),tr=kr(Xt);xr&&Ur(Xt)===!1?tt.renderbufferStorageMultisample(tt.RENDERBUFFER,tr,Cr,Xt.width,Xt.height):Ur(Xt)?dt.renderbufferStorageMultisampleEXT(tt.RENDERBUFFER,tr,Cr,Xt.width,Xt.height):tt.renderbufferStorage(tt.RENDERBUFFER,Cr,Xt.width,Xt.height)}}tt.bindRenderbuffer(tt.RENDERBUFFER,null)}function nr(Qt,Xt){if(Xt&&Xt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(rt.bindFramebuffer(tt.FRAMEBUFFER,Qt),!(Xt.depthTexture&&Xt.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!it.get(Xt.depthTexture).__webglTexture||Xt.depthTexture.image.width!==Xt.width||Xt.depthTexture.image.height!==Xt.height)&&(Xt.depthTexture.image.width=Xt.width,Xt.depthTexture.image.height=Xt.height,Xt.depthTexture.needsUpdate=!0),Ut(Xt.depthTexture,0);const Lr=it.get(Xt.depthTexture).__webglTexture,fr=kr(Xt);if(Xt.depthTexture.format===DepthFormat)Ur(Xt)?dt.framebufferTexture2DMultisampleEXT(tt.FRAMEBUFFER,tt.DEPTH_ATTACHMENT,tt.TEXTURE_2D,Lr,0,fr):tt.framebufferTexture2D(tt.FRAMEBUFFER,tt.DEPTH_ATTACHMENT,tt.TEXTURE_2D,Lr,0);else if(Xt.depthTexture.format===DepthStencilFormat)Ur(Xt)?dt.framebufferTexture2DMultisampleEXT(tt.FRAMEBUFFER,tt.DEPTH_STENCIL_ATTACHMENT,tt.TEXTURE_2D,Lr,0,fr):tt.framebufferTexture2D(tt.FRAMEBUFFER,tt.DEPTH_STENCIL_ATTACHMENT,tt.TEXTURE_2D,Lr,0);else throw new Error("Unknown depthTexture format")}function mr(Qt){const Xt=it.get(Qt),xr=Qt.isWebGLCubeRenderTarget===!0;if(Qt.depthTexture&&!Xt.__autoAllocateDepthBuffer){if(xr)throw new Error("target.depthTexture not supported in Cube render targets");nr(Xt.__webglFramebuffer,Qt)}else if(xr){Xt.__webglDepthbuffer=[];for(let Lr=0;Lr<6;Lr++)rt.bindFramebuffer(tt.FRAMEBUFFER,Xt.__webglFramebuffer[Lr]),Xt.__webglDepthbuffer[Lr]=tt.createRenderbuffer(),Yt(Xt.__webglDepthbuffer[Lr],Qt,!1)}else rt.bindFramebuffer(tt.FRAMEBUFFER,Xt.__webglFramebuffer),Xt.__webglDepthbuffer=tt.createRenderbuffer(),Yt(Xt.__webglDepthbuffer,Qt,!1);rt.bindFramebuffer(tt.FRAMEBUFFER,null)}function Sr(Qt,Xt,xr){const Lr=it.get(Qt);Xt!==void 0&&gr(Lr.__webglFramebuffer,Qt,Qt.texture,tt.COLOR_ATTACHMENT0,tt.TEXTURE_2D),xr!==void 0&&mr(Qt)}function Er(Qt){const Xt=Qt.texture,xr=it.get(Qt),Lr=it.get(Xt);Qt.addEventListener("dispose",Rt),Qt.isWebGLMultipleRenderTargets!==!0&&(Lr.__webglTexture===void 0&&(Lr.__webglTexture=tt.createTexture()),Lr.__version=Xt.version,at.memory.textures++);const fr=Qt.isWebGLCubeRenderTarget===!0,pr=Qt.isWebGLMultipleRenderTargets===!0,Hr=xt(Qt)||lt;if(fr){xr.__webglFramebuffer=[];for(let hr=0;hr<6;hr++)xr.__webglFramebuffer[hr]=tt.createFramebuffer()}else{if(xr.__webglFramebuffer=tt.createFramebuffer(),pr)if(nt.drawBuffers){const hr=Qt.texture;for(let Cr=0,tr=hr.length;Cr<tr;Cr++){const Ar=it.get(hr[Cr]);Ar.__webglTexture===void 0&&(Ar.__webglTexture=tt.createTexture(),at.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(lt&&Qt.samples>0&&Ur(Qt)===!1){const hr=pr?Xt:[Xt];xr.__webglMultisampledFramebuffer=tt.createFramebuffer(),xr.__webglColorRenderbuffer=[],rt.bindFramebuffer(tt.FRAMEBUFFER,xr.__webglMultisampledFramebuffer);for(let Cr=0;Cr<hr.length;Cr++){const tr=hr[Cr];xr.__webglColorRenderbuffer[Cr]=tt.createRenderbuffer(),tt.bindRenderbuffer(tt.RENDERBUFFER,xr.__webglColorRenderbuffer[Cr]);const Ar=st.convert(tr.format,tr.colorSpace),yr=st.convert(tr.type),Jt=St(tr.internalFormat,Ar,yr,tr.colorSpace,Qt.isXRRenderTarget===!0),_r=kr(Qt);tt.renderbufferStorageMultisample(tt.RENDERBUFFER,_r,Jt,Qt.width,Qt.height),tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0+Cr,tt.RENDERBUFFER,xr.__webglColorRenderbuffer[Cr])}tt.bindRenderbuffer(tt.RENDERBUFFER,null),Qt.depthBuffer&&(xr.__webglDepthRenderbuffer=tt.createRenderbuffer(),Yt(xr.__webglDepthRenderbuffer,Qt,!0)),rt.bindFramebuffer(tt.FRAMEBUFFER,null)}}if(fr){rt.bindTexture(tt.TEXTURE_CUBE_MAP,Lr.__webglTexture),ir(tt.TEXTURE_CUBE_MAP,Xt,Hr);for(let hr=0;hr<6;hr++)gr(xr.__webglFramebuffer[hr],Qt,Xt,tt.COLOR_ATTACHMENT0,tt.TEXTURE_CUBE_MAP_POSITIVE_X+hr);_t(Xt,Hr)&&Ct(tt.TEXTURE_CUBE_MAP),rt.unbindTexture()}else if(pr){const hr=Qt.texture;for(let Cr=0,tr=hr.length;Cr<tr;Cr++){const Ar=hr[Cr],yr=it.get(Ar);rt.bindTexture(tt.TEXTURE_2D,yr.__webglTexture),ir(tt.TEXTURE_2D,Ar,Hr),gr(xr.__webglFramebuffer,Qt,Ar,tt.COLOR_ATTACHMENT0+Cr,tt.TEXTURE_2D),_t(Ar,Hr)&&Ct(tt.TEXTURE_2D)}rt.unbindTexture()}else{let hr=tt.TEXTURE_2D;(Qt.isWebGL3DRenderTarget||Qt.isWebGLArrayRenderTarget)&&(lt?hr=Qt.isWebGL3DRenderTarget?tt.TEXTURE_3D:tt.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),rt.bindTexture(hr,Lr.__webglTexture),ir(hr,Xt,Hr),gr(xr.__webglFramebuffer,Qt,Xt,tt.COLOR_ATTACHMENT0,hr),_t(Xt,Hr)&&Ct(hr),rt.unbindTexture()}Qt.depthBuffer&&mr(Qt)}function Nr(Qt){const Xt=xt(Qt)||lt,xr=Qt.isWebGLMultipleRenderTargets===!0?Qt.texture:[Qt.texture];for(let Lr=0,fr=xr.length;Lr<fr;Lr++){const pr=xr[Lr];if(_t(pr,Xt)){const Hr=Qt.isWebGLCubeRenderTarget?tt.TEXTURE_CUBE_MAP:tt.TEXTURE_2D,hr=it.get(pr).__webglTexture;rt.bindTexture(Hr,hr),Ct(Hr),rt.unbindTexture()}}}function wr(Qt){if(lt&&Qt.samples>0&&Ur(Qt)===!1){const Xt=Qt.isWebGLMultipleRenderTargets?Qt.texture:[Qt.texture],xr=Qt.width,Lr=Qt.height;let fr=tt.COLOR_BUFFER_BIT;const pr=[],Hr=Qt.stencilBuffer?tt.DEPTH_STENCIL_ATTACHMENT:tt.DEPTH_ATTACHMENT,hr=it.get(Qt),Cr=Qt.isWebGLMultipleRenderTargets===!0;if(Cr)for(let tr=0;tr<Xt.length;tr++)rt.bindFramebuffer(tt.FRAMEBUFFER,hr.__webglMultisampledFramebuffer),tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0+tr,tt.RENDERBUFFER,null),rt.bindFramebuffer(tt.FRAMEBUFFER,hr.__webglFramebuffer),tt.framebufferTexture2D(tt.DRAW_FRAMEBUFFER,tt.COLOR_ATTACHMENT0+tr,tt.TEXTURE_2D,null,0);rt.bindFramebuffer(tt.READ_FRAMEBUFFER,hr.__webglMultisampledFramebuffer),rt.bindFramebuffer(tt.DRAW_FRAMEBUFFER,hr.__webglFramebuffer);for(let tr=0;tr<Xt.length;tr++){pr.push(tt.COLOR_ATTACHMENT0+tr),Qt.depthBuffer&&pr.push(Hr);const Ar=hr.__ignoreDepthValues!==void 0?hr.__ignoreDepthValues:!1;if(Ar===!1&&(Qt.depthBuffer&&(fr|=tt.DEPTH_BUFFER_BIT),Qt.stencilBuffer&&(fr|=tt.STENCIL_BUFFER_BIT)),Cr&&tt.framebufferRenderbuffer(tt.READ_FRAMEBUFFER,tt.COLOR_ATTACHMENT0,tt.RENDERBUFFER,hr.__webglColorRenderbuffer[tr]),Ar===!0&&(tt.invalidateFramebuffer(tt.READ_FRAMEBUFFER,[Hr]),tt.invalidateFramebuffer(tt.DRAW_FRAMEBUFFER,[Hr])),Cr){const yr=it.get(Xt[tr]).__webglTexture;tt.framebufferTexture2D(tt.DRAW_FRAMEBUFFER,tt.COLOR_ATTACHMENT0,tt.TEXTURE_2D,yr,0)}tt.blitFramebuffer(0,0,xr,Lr,0,0,xr,Lr,fr,tt.NEAREST),pt&&tt.invalidateFramebuffer(tt.READ_FRAMEBUFFER,pr)}if(rt.bindFramebuffer(tt.READ_FRAMEBUFFER,null),rt.bindFramebuffer(tt.DRAW_FRAMEBUFFER,null),Cr)for(let tr=0;tr<Xt.length;tr++){rt.bindFramebuffer(tt.FRAMEBUFFER,hr.__webglMultisampledFramebuffer),tt.framebufferRenderbuffer(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0+tr,tt.RENDERBUFFER,hr.__webglColorRenderbuffer[tr]);const Ar=it.get(Xt[tr]).__webglTexture;rt.bindFramebuffer(tt.FRAMEBUFFER,hr.__webglFramebuffer),tt.framebufferTexture2D(tt.DRAW_FRAMEBUFFER,tt.COLOR_ATTACHMENT0+tr,tt.TEXTURE_2D,Ar,0)}rt.bindFramebuffer(tt.DRAW_FRAMEBUFFER,hr.__webglMultisampledFramebuffer)}}function kr(Qt){return Math.min(ht,Qt.samples)}function Ur(Qt){const Xt=it.get(Qt);return lt&&Qt.samples>0&&_e.has("WEBGL_multisampled_render_to_texture")===!0&&Xt.__useRenderToTexture!==!1}function Or(Qt){const Xt=at.render.frame;ft.get(Qt)!==Xt&&(ft.set(Qt,Xt),Qt.update())}function Xr(Qt,Xt){const xr=Qt.colorSpace,Lr=Qt.format,fr=Qt.type;return Qt.isCompressedTexture===!0||Qt.format===_SRGBAFormat||xr!==LinearSRGBColorSpace&&xr!==NoColorSpace&&(xr===SRGBColorSpace?lt===!1?_e.has("EXT_sRGB")===!0&&Lr===RGBAFormat?(Qt.format=_SRGBAFormat,Qt.minFilter=LinearFilter,Qt.generateMipmaps=!1):Xt=ImageUtils.sRGBToLinear(Xt):(Lr!==RGBAFormat||fr!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",xr)),Xt}this.allocateTextureUnit=Dt,this.resetTextureUnits=zt,this.setTexture2D=Ut,this.setTexture2DArray=$t,this.setTexture3D=Vt,this.setTextureCube=Zt,this.rebindTextures=Sr,this.setupRenderTarget=Er,this.updateRenderTargetMipmap=Nr,this.updateMultisampleRenderTarget=wr,this.setupDepthRenderbuffer=mr,this.setupFrameBufferTexture=gr,this.useMultisampledRTT=Ur}function WebGLUtils(tt,_e,rt){const it=rt.isWebGL2;function nt(st,at=NoColorSpace){let lt;if(st===UnsignedByteType)return tt.UNSIGNED_BYTE;if(st===UnsignedShort4444Type)return tt.UNSIGNED_SHORT_4_4_4_4;if(st===UnsignedShort5551Type)return tt.UNSIGNED_SHORT_5_5_5_1;if(st===ByteType)return tt.BYTE;if(st===ShortType)return tt.SHORT;if(st===UnsignedShortType)return tt.UNSIGNED_SHORT;if(st===IntType)return tt.INT;if(st===UnsignedIntType)return tt.UNSIGNED_INT;if(st===FloatType)return tt.FLOAT;if(st===HalfFloatType)return it?tt.HALF_FLOAT:(lt=_e.get("OES_texture_half_float"),lt!==null?lt.HALF_FLOAT_OES:null);if(st===AlphaFormat)return tt.ALPHA;if(st===RGBAFormat)return tt.RGBA;if(st===LuminanceFormat)return tt.LUMINANCE;if(st===LuminanceAlphaFormat)return tt.LUMINANCE_ALPHA;if(st===DepthFormat)return tt.DEPTH_COMPONENT;if(st===DepthStencilFormat)return tt.DEPTH_STENCIL;if(st===_SRGBAFormat)return lt=_e.get("EXT_sRGB"),lt!==null?lt.SRGB_ALPHA_EXT:null;if(st===RedFormat)return tt.RED;if(st===RedIntegerFormat)return tt.RED_INTEGER;if(st===RGFormat)return tt.RG;if(st===RGIntegerFormat)return tt.RG_INTEGER;if(st===RGBAIntegerFormat)return tt.RGBA_INTEGER;if(st===RGB_S3TC_DXT1_Format||st===RGBA_S3TC_DXT1_Format||st===RGBA_S3TC_DXT3_Format||st===RGBA_S3TC_DXT5_Format)if(at===SRGBColorSpace)if(lt=_e.get("WEBGL_compressed_texture_s3tc_srgb"),lt!==null){if(st===RGB_S3TC_DXT1_Format)return lt.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(st===RGBA_S3TC_DXT1_Format)return lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(st===RGBA_S3TC_DXT3_Format)return lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(st===RGBA_S3TC_DXT5_Format)return lt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(lt=_e.get("WEBGL_compressed_texture_s3tc"),lt!==null){if(st===RGB_S3TC_DXT1_Format)return lt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(st===RGBA_S3TC_DXT1_Format)return lt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(st===RGBA_S3TC_DXT3_Format)return lt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(st===RGBA_S3TC_DXT5_Format)return lt.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(st===RGB_PVRTC_4BPPV1_Format||st===RGB_PVRTC_2BPPV1_Format||st===RGBA_PVRTC_4BPPV1_Format||st===RGBA_PVRTC_2BPPV1_Format)if(lt=_e.get("WEBGL_compressed_texture_pvrtc"),lt!==null){if(st===RGB_PVRTC_4BPPV1_Format)return lt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(st===RGB_PVRTC_2BPPV1_Format)return lt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(st===RGBA_PVRTC_4BPPV1_Format)return lt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(st===RGBA_PVRTC_2BPPV1_Format)return lt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(st===RGB_ETC1_Format)return lt=_e.get("WEBGL_compressed_texture_etc1"),lt!==null?lt.COMPRESSED_RGB_ETC1_WEBGL:null;if(st===RGB_ETC2_Format||st===RGBA_ETC2_EAC_Format)if(lt=_e.get("WEBGL_compressed_texture_etc"),lt!==null){if(st===RGB_ETC2_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ETC2:lt.COMPRESSED_RGB8_ETC2;if(st===RGBA_ETC2_EAC_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:lt.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(st===RGBA_ASTC_4x4_Format||st===RGBA_ASTC_5x4_Format||st===RGBA_ASTC_5x5_Format||st===RGBA_ASTC_6x5_Format||st===RGBA_ASTC_6x6_Format||st===RGBA_ASTC_8x5_Format||st===RGBA_ASTC_8x6_Format||st===RGBA_ASTC_8x8_Format||st===RGBA_ASTC_10x5_Format||st===RGBA_ASTC_10x6_Format||st===RGBA_ASTC_10x8_Format||st===RGBA_ASTC_10x10_Format||st===RGBA_ASTC_12x10_Format||st===RGBA_ASTC_12x12_Format)if(lt=_e.get("WEBGL_compressed_texture_astc"),lt!==null){if(st===RGBA_ASTC_4x4_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:lt.COMPRESSED_RGBA_ASTC_4x4_KHR;if(st===RGBA_ASTC_5x4_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:lt.COMPRESSED_RGBA_ASTC_5x4_KHR;if(st===RGBA_ASTC_5x5_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:lt.COMPRESSED_RGBA_ASTC_5x5_KHR;if(st===RGBA_ASTC_6x5_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:lt.COMPRESSED_RGBA_ASTC_6x5_KHR;if(st===RGBA_ASTC_6x6_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:lt.COMPRESSED_RGBA_ASTC_6x6_KHR;if(st===RGBA_ASTC_8x5_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:lt.COMPRESSED_RGBA_ASTC_8x5_KHR;if(st===RGBA_ASTC_8x6_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:lt.COMPRESSED_RGBA_ASTC_8x6_KHR;if(st===RGBA_ASTC_8x8_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:lt.COMPRESSED_RGBA_ASTC_8x8_KHR;if(st===RGBA_ASTC_10x5_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:lt.COMPRESSED_RGBA_ASTC_10x5_KHR;if(st===RGBA_ASTC_10x6_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:lt.COMPRESSED_RGBA_ASTC_10x6_KHR;if(st===RGBA_ASTC_10x8_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:lt.COMPRESSED_RGBA_ASTC_10x8_KHR;if(st===RGBA_ASTC_10x10_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:lt.COMPRESSED_RGBA_ASTC_10x10_KHR;if(st===RGBA_ASTC_12x10_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:lt.COMPRESSED_RGBA_ASTC_12x10_KHR;if(st===RGBA_ASTC_12x12_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:lt.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(st===RGBA_BPTC_Format)if(lt=_e.get("EXT_texture_compression_bptc"),lt!==null){if(st===RGBA_BPTC_Format)return at===SRGBColorSpace?lt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:lt.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(st===RED_RGTC1_Format||st===SIGNED_RED_RGTC1_Format||st===RED_GREEN_RGTC2_Format||st===SIGNED_RED_GREEN_RGTC2_Format)if(lt=_e.get("EXT_texture_compression_rgtc"),lt!==null){if(st===RGBA_BPTC_Format)return lt.COMPRESSED_RED_RGTC1_EXT;if(st===SIGNED_RED_RGTC1_Format)return lt.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(st===RED_GREEN_RGTC2_Format)return lt.COMPRESSED_RED_GREEN_RGTC2_EXT;if(st===SIGNED_RED_GREEN_RGTC2_Format)return lt.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return st===UnsignedInt248Type?it?tt.UNSIGNED_INT_24_8:(lt=_e.get("WEBGL_depth_texture"),lt!==null?lt.UNSIGNED_INT_24_8_WEBGL:null):tt[st]!==void 0?tt[st]:null}return{convert:nt}}class ArrayCamera extends PerspectiveCamera{constructor(_e=[]){super(),this.isArrayCamera=!0,this.cameras=_e}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(_e){return this._targetRay!==null&&this._targetRay.dispatchEvent(_e),this._grip!==null&&this._grip.dispatchEvent(_e),this._hand!==null&&this._hand.dispatchEvent(_e),this}connect(_e){if(_e&&_e.hand){const rt=this._hand;if(rt)for(const it of _e.hand.values())this._getHandJoint(rt,it)}return this.dispatchEvent({type:"connected",data:_e}),this}disconnect(_e){return this.dispatchEvent({type:"disconnected",data:_e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_e,rt,it){let nt=null,st=null,at=null;const lt=this._targetRay,ot=this._grip,ct=this._hand;if(_e&&rt.session.visibilityState!=="visible-blurred"){if(ct&&_e.hand){at=!0;for(const gt of _e.hand.values()){const mt=rt.getJointPose(gt,it),At=this._getHandJoint(ct,gt);mt!==null&&(At.matrix.fromArray(mt.transform.matrix),At.matrix.decompose(At.position,At.rotation,At.scale),At.matrixWorldNeedsUpdate=!0,At.jointRadius=mt.radius),At.visible=mt!==null}const ut=ct.joints["index-finger-tip"],ht=ct.joints["thumb-tip"],dt=ut.position.distanceTo(ht.position),pt=.02,ft=.005;ct.inputState.pinching&&dt>pt+ft?(ct.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_e.handedness,target:this})):!ct.inputState.pinching&&dt<=pt-ft&&(ct.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_e.handedness,target:this}))}else ot!==null&&_e.gripSpace&&(st=rt.getPose(_e.gripSpace,it),st!==null&&(ot.matrix.fromArray(st.transform.matrix),ot.matrix.decompose(ot.position,ot.rotation,ot.scale),ot.matrixWorldNeedsUpdate=!0,st.linearVelocity?(ot.hasLinearVelocity=!0,ot.linearVelocity.copy(st.linearVelocity)):ot.hasLinearVelocity=!1,st.angularVelocity?(ot.hasAngularVelocity=!0,ot.angularVelocity.copy(st.angularVelocity)):ot.hasAngularVelocity=!1));lt!==null&&(nt=rt.getPose(_e.targetRaySpace,it),nt===null&&st!==null&&(nt=st),nt!==null&&(lt.matrix.fromArray(nt.transform.matrix),lt.matrix.decompose(lt.position,lt.rotation,lt.scale),lt.matrixWorldNeedsUpdate=!0,nt.linearVelocity?(lt.hasLinearVelocity=!0,lt.linearVelocity.copy(nt.linearVelocity)):lt.hasLinearVelocity=!1,nt.angularVelocity?(lt.hasAngularVelocity=!0,lt.angularVelocity.copy(nt.angularVelocity)):lt.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return lt!==null&&(lt.visible=nt!==null),ot!==null&&(ot.visible=st!==null),ct!==null&&(ct.visible=at!==null),this}_getHandJoint(_e,rt){if(_e.joints[rt.jointName]===void 0){const it=new Group;it.matrixAutoUpdate=!1,it.visible=!1,_e.joints[rt.jointName]=it,_e.add(it)}return _e.joints[rt.jointName]}}class DepthTexture extends Texture{constructor(_e,rt,it,nt,st,at,lt,ot,ct,ut){if(ut=ut!==void 0?ut:DepthFormat,ut!==DepthFormat&&ut!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");it===void 0&&ut===DepthFormat&&(it=UnsignedIntType),it===void 0&&ut===DepthStencilFormat&&(it=UnsignedInt248Type),super(null,nt,st,at,lt,ot,ut,it,ct),this.isDepthTexture=!0,this.image={width:_e,height:rt},this.magFilter=lt!==void 0?lt:NearestFilter,this.minFilter=ot!==void 0?ot:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_e){return super.copy(_e),this.compareFunction=_e.compareFunction,this}toJSON(_e){const rt=super.toJSON(_e);return this.compareFunction!==null&&(rt.compareFunction=this.compareFunction),rt}}class WebXRManager extends EventDispatcher{constructor(_e,rt){super();const it=this;let nt=null,st=1,at=null,lt="local-floor",ot=1,ct=null,ut=null,ht=null,dt=null,pt=null,ft=null;const gt=rt.getContextAttributes();let mt=null,At=null;const yt=[],bt=[],xt=new PerspectiveCamera;xt.layers.enable(1),xt.viewport=new Vector4;const vt=new PerspectiveCamera;vt.layers.enable(2),vt.viewport=new Vector4;const _t=[xt,vt],Ct=new ArrayCamera;Ct.layers.enable(1),Ct.layers.enable(2);let St=null,Et=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function($t){let Vt=yt[$t];return Vt===void 0&&(Vt=new WebXRController,yt[$t]=Vt),Vt.getTargetRaySpace()},this.getControllerGrip=function($t){let Vt=yt[$t];return Vt===void 0&&(Vt=new WebXRController,yt[$t]=Vt),Vt.getGripSpace()},this.getHand=function($t){let Vt=yt[$t];return Vt===void 0&&(Vt=new WebXRController,yt[$t]=Vt),Vt.getHandSpace()};function Tt($t){const Vt=bt.indexOf($t.inputSource);if(Vt===-1)return;const Zt=yt[Vt];Zt!==void 0&&(Zt.update($t.inputSource,$t.frame,ct||at),Zt.dispatchEvent({type:$t.type,data:$t.inputSource}))}function Mt(){nt.removeEventListener("select",Tt),nt.removeEventListener("selectstart",Tt),nt.removeEventListener("selectend",Tt),nt.removeEventListener("squeeze",Tt),nt.removeEventListener("squeezestart",Tt),nt.removeEventListener("squeezeend",Tt),nt.removeEventListener("end",Mt),nt.removeEventListener("inputsourceschange",Rt);for(let $t=0;$t<yt.length;$t++){const Vt=bt[$t];Vt!==null&&(bt[$t]=null,yt[$t].disconnect(Vt))}St=null,Et=null,_e.setRenderTarget(mt),pt=null,dt=null,ht=null,nt=null,At=null,Ut.stop(),it.isPresenting=!1,it.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function($t){st=$t,it.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function($t){lt=$t,it.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return ct||at},this.setReferenceSpace=function($t){ct=$t},this.getBaseLayer=function(){return dt!==null?dt:pt},this.getBinding=function(){return ht},this.getFrame=function(){return ft},this.getSession=function(){return nt},this.setSession=async function($t){if(nt=$t,nt!==null){if(mt=_e.getRenderTarget(),nt.addEventListener("select",Tt),nt.addEventListener("selectstart",Tt),nt.addEventListener("selectend",Tt),nt.addEventListener("squeeze",Tt),nt.addEventListener("squeezestart",Tt),nt.addEventListener("squeezeend",Tt),nt.addEventListener("end",Mt),nt.addEventListener("inputsourceschange",Rt),gt.xrCompatible!==!0&&await rt.makeXRCompatible(),nt.renderState.layers===void 0||_e.capabilities.isWebGL2===!1){const Vt={antialias:nt.renderState.layers===void 0?gt.antialias:!0,alpha:!0,depth:gt.depth,stencil:gt.stencil,framebufferScaleFactor:st};pt=new XRWebGLLayer(nt,rt,Vt),nt.updateRenderState({baseLayer:pt}),At=new WebGLRenderTarget(pt.framebufferWidth,pt.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:_e.outputColorSpace,stencilBuffer:gt.stencil})}else{let Vt=null,Zt=null,qt=null;gt.depth&&(qt=gt.stencil?rt.DEPTH24_STENCIL8:rt.DEPTH_COMPONENT24,Vt=gt.stencil?DepthStencilFormat:DepthFormat,Zt=gt.stencil?UnsignedInt248Type:UnsignedIntType);const sr={colorFormat:rt.RGBA8,depthFormat:qt,scaleFactor:st};ht=new XRWebGLBinding(nt,rt),dt=ht.createProjectionLayer(sr),nt.updateRenderState({layers:[dt]}),At=new WebGLRenderTarget(dt.textureWidth,dt.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(dt.textureWidth,dt.textureHeight,Zt,void 0,void 0,void 0,void 0,void 0,void 0,Vt),stencilBuffer:gt.stencil,colorSpace:_e.outputColorSpace,samples:gt.antialias?4:0});const er=_e.properties.get(At);er.__ignoreDepthValues=dt.ignoreDepthValues}At.isXRRenderTarget=!0,this.setFoveation(ot),ct=null,at=await nt.requestReferenceSpace(lt),Ut.setContext(nt),Ut.start(),it.isPresenting=!0,it.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(nt!==null)return nt.environmentBlendMode};function Rt($t){for(let Vt=0;Vt<$t.removed.length;Vt++){const Zt=$t.removed[Vt],qt=bt.indexOf(Zt);qt>=0&&(bt[qt]=null,yt[qt].disconnect(Zt))}for(let Vt=0;Vt<$t.added.length;Vt++){const Zt=$t.added[Vt];let qt=bt.indexOf(Zt);if(qt===-1){for(let er=0;er<yt.length;er++)if(er>=bt.length){bt.push(Zt),qt=er;break}else if(bt[er]===null){bt[er]=Zt,qt=er;break}if(qt===-1)break}const sr=yt[qt];sr&&sr.connect(Zt)}}const It=new Vector3,Ot=new Vector3;function Bt($t,Vt,Zt){It.setFromMatrixPosition(Vt.matrixWorld),Ot.setFromMatrixPosition(Zt.matrixWorld);const qt=It.distanceTo(Ot),sr=Vt.projectionMatrix.elements,er=Zt.projectionMatrix.elements,ir=sr[14]/(sr[10]-1),ur=sr[14]/(sr[10]+1),ar=(sr[9]+1)/sr[5],lr=(sr[9]-1)/sr[5],gr=(sr[8]-1)/sr[0],Yt=(er[8]+1)/er[0],nr=ir*gr,mr=ir*Yt,Sr=qt/(-gr+Yt),Er=Sr*-gr;Vt.matrixWorld.decompose($t.position,$t.quaternion,$t.scale),$t.translateX(Er),$t.translateZ(Sr),$t.matrixWorld.compose($t.position,$t.quaternion,$t.scale),$t.matrixWorldInverse.copy($t.matrixWorld).invert();const Nr=ir+Sr,wr=ur+Sr,kr=nr-Er,Ur=mr+(qt-Er),Or=ar*ur/wr*Nr,Xr=lr*ur/wr*Nr;$t.projectionMatrix.makePerspective(kr,Ur,Or,Xr,Nr,wr),$t.projectionMatrixInverse.copy($t.projectionMatrix).invert()}function Nt($t,Vt){Vt===null?$t.matrixWorld.copy($t.matrix):$t.matrixWorld.multiplyMatrices(Vt.matrixWorld,$t.matrix),$t.matrixWorldInverse.copy($t.matrixWorld).invert()}this.updateCamera=function($t){if(nt===null)return;Ct.near=vt.near=xt.near=$t.near,Ct.far=vt.far=xt.far=$t.far,(St!==Ct.near||Et!==Ct.far)&&(nt.updateRenderState({depthNear:Ct.near,depthFar:Ct.far}),St=Ct.near,Et=Ct.far);const Vt=$t.parent,Zt=Ct.cameras;Nt(Ct,Vt);for(let qt=0;qt<Zt.length;qt++)Nt(Zt[qt],Vt);Zt.length===2?Bt(Ct,xt,vt):Ct.projectionMatrix.copy(xt.projectionMatrix),zt($t,Ct,Vt)};function zt($t,Vt,Zt){Zt===null?$t.matrix.copy(Vt.matrixWorld):($t.matrix.copy(Zt.matrixWorld),$t.matrix.invert(),$t.matrix.multiply(Vt.matrixWorld)),$t.matrix.decompose($t.position,$t.quaternion,$t.scale),$t.updateMatrixWorld(!0);const qt=$t.children;for(let sr=0,er=qt.length;sr<er;sr++)qt[sr].updateMatrixWorld(!0);$t.projectionMatrix.copy(Vt.projectionMatrix),$t.projectionMatrixInverse.copy(Vt.projectionMatrixInverse),$t.isPerspectiveCamera&&($t.fov=RAD2DEG*2*Math.atan(1/$t.projectionMatrix.elements[5]),$t.zoom=1)}this.getCamera=function(){return Ct},this.getFoveation=function(){if(!(dt===null&&pt===null))return ot},this.setFoveation=function($t){ot=$t,dt!==null&&(dt.fixedFoveation=$t),pt!==null&&pt.fixedFoveation!==void 0&&(pt.fixedFoveation=$t)};let Dt=null;function Ft($t,Vt){if(ut=Vt.getViewerPose(ct||at),ft=Vt,ut!==null){const Zt=ut.views;pt!==null&&(_e.setRenderTargetFramebuffer(At,pt.framebuffer),_e.setRenderTarget(At));let qt=!1;Zt.length!==Ct.cameras.length&&(Ct.cameras.length=0,qt=!0);for(let sr=0;sr<Zt.length;sr++){const er=Zt[sr];let ir=null;if(pt!==null)ir=pt.getViewport(er);else{const ar=ht.getViewSubImage(dt,er);ir=ar.viewport,sr===0&&(_e.setRenderTargetTextures(At,ar.colorTexture,dt.ignoreDepthValues?void 0:ar.depthStencilTexture),_e.setRenderTarget(At))}let ur=_t[sr];ur===void 0&&(ur=new PerspectiveCamera,ur.layers.enable(sr),ur.viewport=new Vector4,_t[sr]=ur),ur.matrix.fromArray(er.transform.matrix),ur.matrix.decompose(ur.position,ur.quaternion,ur.scale),ur.projectionMatrix.fromArray(er.projectionMatrix),ur.projectionMatrixInverse.copy(ur.projectionMatrix).invert(),ur.viewport.set(ir.x,ir.y,ir.width,ir.height),sr===0&&(Ct.matrix.copy(ur.matrix),Ct.matrix.decompose(Ct.position,Ct.quaternion,Ct.scale)),qt===!0&&Ct.cameras.push(ur)}}for(let Zt=0;Zt<yt.length;Zt++){const qt=bt[Zt],sr=yt[Zt];qt!==null&&sr!==void 0&&sr.update(qt,Vt,ct||at)}Dt&&Dt($t,Vt),Vt.detectedPlanes&&it.dispatchEvent({type:"planesdetected",data:Vt}),ft=null}const Ut=new WebGLAnimation;Ut.setAnimationLoop(Ft),this.setAnimationLoop=function($t){Dt=$t},this.dispose=function(){}}}function WebGLMaterials(tt,_e){function rt(mt,At){mt.matrixAutoUpdate===!0&&mt.updateMatrix(),At.value.copy(mt.matrix)}function it(mt,At){At.color.getRGB(mt.fogColor.value,getUnlitUniformColorSpace(tt)),At.isFog?(mt.fogNear.value=At.near,mt.fogFar.value=At.far):At.isFogExp2&&(mt.fogDensity.value=At.density)}function nt(mt,At,yt,bt,xt){At.isMeshBasicMaterial||At.isMeshLambertMaterial?st(mt,At):At.isMeshToonMaterial?(st(mt,At),ht(mt,At)):At.isMeshPhongMaterial?(st(mt,At),ut(mt,At)):At.isMeshStandardMaterial?(st(mt,At),dt(mt,At),At.isMeshPhysicalMaterial&&pt(mt,At,xt)):At.isMeshMatcapMaterial?(st(mt,At),ft(mt,At)):At.isMeshDepthMaterial?st(mt,At):At.isMeshDistanceMaterial?(st(mt,At),gt(mt,At)):At.isMeshNormalMaterial?st(mt,At):At.isLineBasicMaterial?(at(mt,At),At.isLineDashedMaterial&&lt(mt,At)):At.isPointsMaterial?ot(mt,At,yt,bt):At.isSpriteMaterial?ct(mt,At):At.isShadowMaterial?(mt.color.value.copy(At.color),mt.opacity.value=At.opacity):At.isShaderMaterial&&(At.uniformsNeedUpdate=!1)}function st(mt,At){mt.opacity.value=At.opacity,At.color&&mt.diffuse.value.copy(At.color),At.emissive&&mt.emissive.value.copy(At.emissive).multiplyScalar(At.emissiveIntensity),At.map&&(mt.map.value=At.map,rt(At.map,mt.mapTransform)),At.alphaMap&&(mt.alphaMap.value=At.alphaMap,rt(At.alphaMap,mt.alphaMapTransform)),At.bumpMap&&(mt.bumpMap.value=At.bumpMap,rt(At.bumpMap,mt.bumpMapTransform),mt.bumpScale.value=At.bumpScale,At.side===BackSide&&(mt.bumpScale.value*=-1)),At.normalMap&&(mt.normalMap.value=At.normalMap,rt(At.normalMap,mt.normalMapTransform),mt.normalScale.value.copy(At.normalScale),At.side===BackSide&&mt.normalScale.value.negate()),At.displacementMap&&(mt.displacementMap.value=At.displacementMap,rt(At.displacementMap,mt.displacementMapTransform),mt.displacementScale.value=At.displacementScale,mt.displacementBias.value=At.displacementBias),At.emissiveMap&&(mt.emissiveMap.value=At.emissiveMap,rt(At.emissiveMap,mt.emissiveMapTransform)),At.specularMap&&(mt.specularMap.value=At.specularMap,rt(At.specularMap,mt.specularMapTransform)),At.alphaTest>0&&(mt.alphaTest.value=At.alphaTest);const yt=_e.get(At).envMap;if(yt&&(mt.envMap.value=yt,mt.flipEnvMap.value=yt.isCubeTexture&&yt.isRenderTargetTexture===!1?-1:1,mt.reflectivity.value=At.reflectivity,mt.ior.value=At.ior,mt.refractionRatio.value=At.refractionRatio),At.lightMap){mt.lightMap.value=At.lightMap;const bt=tt.useLegacyLights===!0?Math.PI:1;mt.lightMapIntensity.value=At.lightMapIntensity*bt,rt(At.lightMap,mt.lightMapTransform)}At.aoMap&&(mt.aoMap.value=At.aoMap,mt.aoMapIntensity.value=At.aoMapIntensity,rt(At.aoMap,mt.aoMapTransform))}function at(mt,At){mt.diffuse.value.copy(At.color),mt.opacity.value=At.opacity,At.map&&(mt.map.value=At.map,rt(At.map,mt.mapTransform))}function lt(mt,At){mt.dashSize.value=At.dashSize,mt.totalSize.value=At.dashSize+At.gapSize,mt.scale.value=At.scale}function ot(mt,At,yt,bt){mt.diffuse.value.copy(At.color),mt.opacity.value=At.opacity,mt.size.value=At.size*yt,mt.scale.value=bt*.5,At.map&&(mt.map.value=At.map,rt(At.map,mt.uvTransform)),At.alphaMap&&(mt.alphaMap.value=At.alphaMap,rt(At.alphaMap,mt.alphaMapTransform)),At.alphaTest>0&&(mt.alphaTest.value=At.alphaTest)}function ct(mt,At){mt.diffuse.value.copy(At.color),mt.opacity.value=At.opacity,mt.rotation.value=At.rotation,At.map&&(mt.map.value=At.map,rt(At.map,mt.mapTransform)),At.alphaMap&&(mt.alphaMap.value=At.alphaMap,rt(At.alphaMap,mt.alphaMapTransform)),At.alphaTest>0&&(mt.alphaTest.value=At.alphaTest)}function ut(mt,At){mt.specular.value.copy(At.specular),mt.shininess.value=Math.max(At.shininess,1e-4)}function ht(mt,At){At.gradientMap&&(mt.gradientMap.value=At.gradientMap)}function dt(mt,At){mt.metalness.value=At.metalness,At.metalnessMap&&(mt.metalnessMap.value=At.metalnessMap,rt(At.metalnessMap,mt.metalnessMapTransform)),mt.roughness.value=At.roughness,At.roughnessMap&&(mt.roughnessMap.value=At.roughnessMap,rt(At.roughnessMap,mt.roughnessMapTransform)),_e.get(At).envMap&&(mt.envMapIntensity.value=At.envMapIntensity)}function pt(mt,At,yt){mt.ior.value=At.ior,At.sheen>0&&(mt.sheenColor.value.copy(At.sheenColor).multiplyScalar(At.sheen),mt.sheenRoughness.value=At.sheenRoughness,At.sheenColorMap&&(mt.sheenColorMap.value=At.sheenColorMap,rt(At.sheenColorMap,mt.sheenColorMapTransform)),At.sheenRoughnessMap&&(mt.sheenRoughnessMap.value=At.sheenRoughnessMap,rt(At.sheenRoughnessMap,mt.sheenRoughnessMapTransform))),At.clearcoat>0&&(mt.clearcoat.value=At.clearcoat,mt.clearcoatRoughness.value=At.clearcoatRoughness,At.clearcoatMap&&(mt.clearcoatMap.value=At.clearcoatMap,rt(At.clearcoatMap,mt.clearcoatMapTransform)),At.clearcoatRoughnessMap&&(mt.clearcoatRoughnessMap.value=At.clearcoatRoughnessMap,rt(At.clearcoatRoughnessMap,mt.clearcoatRoughnessMapTransform)),At.clearcoatNormalMap&&(mt.clearcoatNormalMap.value=At.clearcoatNormalMap,rt(At.clearcoatNormalMap,mt.clearcoatNormalMapTransform),mt.clearcoatNormalScale.value.copy(At.clearcoatNormalScale),At.side===BackSide&&mt.clearcoatNormalScale.value.negate())),At.iridescence>0&&(mt.iridescence.value=At.iridescence,mt.iridescenceIOR.value=At.iridescenceIOR,mt.iridescenceThicknessMinimum.value=At.iridescenceThicknessRange[0],mt.iridescenceThicknessMaximum.value=At.iridescenceThicknessRange[1],At.iridescenceMap&&(mt.iridescenceMap.value=At.iridescenceMap,rt(At.iridescenceMap,mt.iridescenceMapTransform)),At.iridescenceThicknessMap&&(mt.iridescenceThicknessMap.value=At.iridescenceThicknessMap,rt(At.iridescenceThicknessMap,mt.iridescenceThicknessMapTransform))),At.transmission>0&&(mt.transmission.value=At.transmission,mt.transmissionSamplerMap.value=yt.texture,mt.transmissionSamplerSize.value.set(yt.width,yt.height),At.transmissionMap&&(mt.transmissionMap.value=At.transmissionMap,rt(At.transmissionMap,mt.transmissionMapTransform)),mt.thickness.value=At.thickness,At.thicknessMap&&(mt.thicknessMap.value=At.thicknessMap,rt(At.thicknessMap,mt.thicknessMapTransform)),mt.attenuationDistance.value=At.attenuationDistance,mt.attenuationColor.value.copy(At.attenuationColor)),At.anisotropy>0&&(mt.anisotropyVector.value.set(At.anisotropy*Math.cos(At.anisotropyRotation),At.anisotropy*Math.sin(At.anisotropyRotation)),At.anisotropyMap&&(mt.anisotropyMap.value=At.anisotropyMap,rt(At.anisotropyMap,mt.anisotropyMapTransform))),mt.specularIntensity.value=At.specularIntensity,mt.specularColor.value.copy(At.specularColor),At.specularColorMap&&(mt.specularColorMap.value=At.specularColorMap,rt(At.specularColorMap,mt.specularColorMapTransform)),At.specularIntensityMap&&(mt.specularIntensityMap.value=At.specularIntensityMap,rt(At.specularIntensityMap,mt.specularIntensityMapTransform))}function ft(mt,At){At.matcap&&(mt.matcap.value=At.matcap)}function gt(mt,At){const yt=_e.get(At).light;mt.referencePosition.value.setFromMatrixPosition(yt.matrixWorld),mt.nearDistance.value=yt.shadow.camera.near,mt.farDistance.value=yt.shadow.camera.far}return{refreshFogUniforms:it,refreshMaterialUniforms:nt}}function WebGLUniformsGroups(tt,_e,rt,it){let nt={},st={},at=[];const lt=rt.isWebGL2?tt.getParameter(tt.MAX_UNIFORM_BUFFER_BINDINGS):0;function ot(yt,bt){const xt=bt.program;it.uniformBlockBinding(yt,xt)}function ct(yt,bt){let xt=nt[yt.id];xt===void 0&&(ft(yt),xt=ut(yt),nt[yt.id]=xt,yt.addEventListener("dispose",mt));const vt=bt.program;it.updateUBOMapping(yt,vt);const _t=_e.render.frame;st[yt.id]!==_t&&(dt(yt),st[yt.id]=_t)}function ut(yt){const bt=ht();yt.__bindingPointIndex=bt;const xt=tt.createBuffer(),vt=yt.__size,_t=yt.usage;return tt.bindBuffer(tt.UNIFORM_BUFFER,xt),tt.bufferData(tt.UNIFORM_BUFFER,vt,_t),tt.bindBuffer(tt.UNIFORM_BUFFER,null),tt.bindBufferBase(tt.UNIFORM_BUFFER,bt,xt),xt}function ht(){for(let yt=0;yt<lt;yt++)if(at.indexOf(yt)===-1)return at.push(yt),yt;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function dt(yt){const bt=nt[yt.id],xt=yt.uniforms,vt=yt.__cache;tt.bindBuffer(tt.UNIFORM_BUFFER,bt);for(let _t=0,Ct=xt.length;_t<Ct;_t++){const St=xt[_t];if(pt(St,_t,vt)===!0){const Et=St.__offset,Tt=Array.isArray(St.value)?St.value:[St.value];let Mt=0;for(let Rt=0;Rt<Tt.length;Rt++){const It=Tt[Rt],Ot=gt(It);typeof It=="number"?(St.__data[0]=It,tt.bufferSubData(tt.UNIFORM_BUFFER,Et+Mt,St.__data)):It.isMatrix3?(St.__data[0]=It.elements[0],St.__data[1]=It.elements[1],St.__data[2]=It.elements[2],St.__data[3]=It.elements[0],St.__data[4]=It.elements[3],St.__data[5]=It.elements[4],St.__data[6]=It.elements[5],St.__data[7]=It.elements[0],St.__data[8]=It.elements[6],St.__data[9]=It.elements[7],St.__data[10]=It.elements[8],St.__data[11]=It.elements[0]):(It.toArray(St.__data,Mt),Mt+=Ot.storage/Float32Array.BYTES_PER_ELEMENT)}tt.bufferSubData(tt.UNIFORM_BUFFER,Et,St.__data)}}tt.bindBuffer(tt.UNIFORM_BUFFER,null)}function pt(yt,bt,xt){const vt=yt.value;if(xt[bt]===void 0){if(typeof vt=="number")xt[bt]=vt;else{const _t=Array.isArray(vt)?vt:[vt],Ct=[];for(let St=0;St<_t.length;St++)Ct.push(_t[St].clone());xt[bt]=Ct}return!0}else if(typeof vt=="number"){if(xt[bt]!==vt)return xt[bt]=vt,!0}else{const _t=Array.isArray(xt[bt])?xt[bt]:[xt[bt]],Ct=Array.isArray(vt)?vt:[vt];for(let St=0;St<_t.length;St++){const Et=_t[St];if(Et.equals(Ct[St])===!1)return Et.copy(Ct[St]),!0}}return!1}function ft(yt){const bt=yt.uniforms;let xt=0;const vt=16;let _t=0;for(let Ct=0,St=bt.length;Ct<St;Ct++){const Et=bt[Ct],Tt={boundary:0,storage:0},Mt=Array.isArray(Et.value)?Et.value:[Et.value];for(let Rt=0,It=Mt.length;Rt<It;Rt++){const Ot=Mt[Rt],Bt=gt(Ot);Tt.boundary+=Bt.boundary,Tt.storage+=Bt.storage}if(Et.__data=new Float32Array(Tt.storage/Float32Array.BYTES_PER_ELEMENT),Et.__offset=xt,Ct>0){_t=xt%vt;const Rt=vt-_t;_t!==0&&Rt-Tt.boundary<0&&(xt+=vt-_t,Et.__offset=xt)}xt+=Tt.storage}return _t=xt%vt,_t>0&&(xt+=vt-_t),yt.__size=xt,yt.__cache={},this}function gt(yt){const bt={boundary:0,storage:0};return typeof yt=="number"?(bt.boundary=4,bt.storage=4):yt.isVector2?(bt.boundary=8,bt.storage=8):yt.isVector3||yt.isColor?(bt.boundary=16,bt.storage=12):yt.isVector4?(bt.boundary=16,bt.storage=16):yt.isMatrix3?(bt.boundary=48,bt.storage=48):yt.isMatrix4?(bt.boundary=64,bt.storage=64):yt.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",yt),bt}function mt(yt){const bt=yt.target;bt.removeEventListener("dispose",mt);const xt=at.indexOf(bt.__bindingPointIndex);at.splice(xt,1),tt.deleteBuffer(nt[bt.id]),delete nt[bt.id],delete st[bt.id]}function At(){for(const yt in nt)tt.deleteBuffer(nt[yt]);at=[],nt={},st={}}return{bind:ot,update:ct,dispose:At}}function createCanvasElement(){const tt=createElementNS("canvas");return tt.style.display="block",tt}class WebGLRenderer{constructor(_e={}){const{canvas:rt=createCanvasElement(),context:it=null,depth:nt=!0,stencil:st=!0,alpha:at=!1,antialias:lt=!1,premultipliedAlpha:ot=!0,preserveDrawingBuffer:ct=!1,powerPreference:ut="default",failIfMajorPerformanceCaveat:ht=!1}=_e;this.isWebGLRenderer=!0;let dt;it!==null?dt=it.getContextAttributes().alpha:dt=at;const pt=new Uint32Array(4),ft=new Int32Array(4);let gt=null,mt=null;const At=[],yt=[];this.domElement=rt,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=SRGBColorSpace,this.useLegacyLights=!0,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const bt=this;let xt=!1,vt=0,_t=0,Ct=null,St=-1,Et=null;const Tt=new Vector4,Mt=new Vector4;let Rt=null;const It=new Color$1(0);let Ot=0,Bt=rt.width,Nt=rt.height,zt=1,Dt=null,Ft=null;const Ut=new Vector4(0,0,Bt,Nt),$t=new Vector4(0,0,Bt,Nt);let Vt=!1;const Zt=new Frustum;let qt=!1,sr=!1,er=null;const ir=new Matrix4,ur=new Vector2,ar=new Vector3,lr={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function gr(){return Ct===null?zt:1}let Yt=it;function nr(jt,rr){for(let cr=0;cr<jt.length;cr++){const or=jt[cr],vr=rt.getContext(or,rr);if(vr!==null)return vr}return null}try{const jt={alpha:!0,depth:nt,stencil:st,antialias:lt,premultipliedAlpha:ot,preserveDrawingBuffer:ct,powerPreference:ut,failIfMajorPerformanceCaveat:ht};if("setAttribute"in rt&&rt.setAttribute("data-engine",`three.js r${REVISION}`),rt.addEventListener("webglcontextlost",Rr,!1),rt.addEventListener("webglcontextrestored",Tr,!1),rt.addEventListener("webglcontextcreationerror",Vr,!1),Yt===null){const rr=["webgl2","webgl","experimental-webgl"];if(bt.isWebGL1Renderer===!0&&rr.shift(),Yt=nr(rr,jt),Yt===null)throw nr(rr)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Yt instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Yt.getShaderPrecisionFormat===void 0&&(Yt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(jt){throw console.error("THREE.WebGLRenderer: "+jt.message),jt}let mr,Sr,Er,Nr,wr,kr,Ur,Or,Xr,Qt,Xt,xr,Lr,fr,pr,Hr,hr,Cr,tr,Ar,yr,Jt,_r,Kt;function Qr(){mr=new WebGLExtensions(Yt),Sr=new WebGLCapabilities(Yt,mr,_e),mr.init(Sr),Jt=new WebGLUtils(Yt,mr,Sr),Er=new WebGLState(Yt,mr,Sr),Nr=new WebGLInfo(Yt),wr=new WebGLProperties,kr=new WebGLTextures(Yt,mr,Er,wr,Sr,Jt,Nr),Ur=new WebGLCubeMaps(bt),Or=new WebGLCubeUVMaps(bt),Xr=new WebGLAttributes(Yt,Sr),_r=new WebGLBindingStates(Yt,mr,Xr,Sr),Qt=new WebGLGeometries(Yt,Xr,Nr,_r),Xt=new WebGLObjects(Yt,Qt,Xr,Nr),tr=new WebGLMorphtargets(Yt,Sr,kr),Hr=new WebGLClipping(wr),xr=new WebGLPrograms(bt,Ur,Or,mr,Sr,_r,Hr),Lr=new WebGLMaterials(bt,wr),fr=new WebGLRenderLists,pr=new WebGLRenderStates(mr,Sr),Cr=new WebGLBackground(bt,Ur,Or,Er,Xt,dt,ot),hr=new WebGLShadowMap(bt,Xt,Sr),Kt=new WebGLUniformsGroups(Yt,Nr,Sr,Er),Ar=new WebGLBufferRenderer(Yt,mr,Nr,Sr),yr=new WebGLIndexedBufferRenderer(Yt,mr,Nr,Sr),Nr.programs=xr.programs,bt.capabilities=Sr,bt.extensions=mr,bt.properties=wr,bt.renderLists=fr,bt.shadowMap=hr,bt.state=Er,bt.info=Nr}Qr();const br=new WebXRManager(bt,Yt);this.xr=br,this.getContext=function(){return Yt},this.getContextAttributes=function(){return Yt.getContextAttributes()},this.forceContextLoss=function(){const jt=mr.get("WEBGL_lose_context");jt&&jt.loseContext()},this.forceContextRestore=function(){const jt=mr.get("WEBGL_lose_context");jt&&jt.restoreContext()},this.getPixelRatio=function(){return zt},this.setPixelRatio=function(jt){jt!==void 0&&(zt=jt,this.setSize(Bt,Nt,!1))},this.getSize=function(jt){return jt.set(Bt,Nt)},this.setSize=function(jt,rr,cr=!0){if(br.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Bt=jt,Nt=rr,rt.width=Math.floor(jt*zt),rt.height=Math.floor(rr*zt),cr===!0&&(rt.style.width=jt+"px",rt.style.height=rr+"px"),this.setViewport(0,0,jt,rr)},this.getDrawingBufferSize=function(jt){return jt.set(Bt*zt,Nt*zt).floor()},this.setDrawingBufferSize=function(jt,rr,cr){Bt=jt,Nt=rr,zt=cr,rt.width=Math.floor(jt*cr),rt.height=Math.floor(rr*cr),this.setViewport(0,0,jt,rr)},this.getCurrentViewport=function(jt){return jt.copy(Tt)},this.getViewport=function(jt){return jt.copy(Ut)},this.setViewport=function(jt,rr,cr,or){jt.isVector4?Ut.set(jt.x,jt.y,jt.z,jt.w):Ut.set(jt,rr,cr,or),Er.viewport(Tt.copy(Ut).multiplyScalar(zt).floor())},this.getScissor=function(jt){return jt.copy($t)},this.setScissor=function(jt,rr,cr,or){jt.isVector4?$t.set(jt.x,jt.y,jt.z,jt.w):$t.set(jt,rr,cr,or),Er.scissor(Mt.copy($t).multiplyScalar(zt).floor())},this.getScissorTest=function(){return Vt},this.setScissorTest=function(jt){Er.setScissorTest(Vt=jt)},this.setOpaqueSort=function(jt){Dt=jt},this.setTransparentSort=function(jt){Ft=jt},this.getClearColor=function(jt){return jt.copy(Cr.getClearColor())},this.setClearColor=function(){Cr.setClearColor.apply(Cr,arguments)},this.getClearAlpha=function(){return Cr.getClearAlpha()},this.setClearAlpha=function(){Cr.setClearAlpha.apply(Cr,arguments)},this.clear=function(jt=!0,rr=!0,cr=!0){let or=0;if(jt){let vr=!1;if(Ct!==null){const Br=Ct.texture.format;vr=Br===RGBAIntegerFormat||Br===RGIntegerFormat||Br===RedIntegerFormat}if(vr){const Br=Ct.texture.type,Dr=Br===UnsignedByteType||Br===UnsignedIntType||Br===UnsignedShortType||Br===UnsignedInt248Type||Br===UnsignedShort4444Type||Br===UnsignedShort5551Type,Gr=Cr.getClearColor(),zr=Cr.getClearAlpha(),Yr=Gr.r,Mr=Gr.g,Zr=Gr.b;Dr?(pt[0]=Yr,pt[1]=Mr,pt[2]=Zr,pt[3]=zr,Yt.clearBufferuiv(Yt.COLOR,0,pt)):(ft[0]=Yr,ft[1]=Mr,ft[2]=Zr,ft[3]=zr,Yt.clearBufferiv(Yt.COLOR,0,ft))}else or|=Yt.COLOR_BUFFER_BIT}rr&&(or|=Yt.DEPTH_BUFFER_BIT),cr&&(or|=Yt.STENCIL_BUFFER_BIT),Yt.clear(or)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){rt.removeEventListener("webglcontextlost",Rr,!1),rt.removeEventListener("webglcontextrestored",Tr,!1),rt.removeEventListener("webglcontextcreationerror",Vr,!1),fr.dispose(),pr.dispose(),wr.dispose(),Ur.dispose(),Or.dispose(),Xt.dispose(),_r.dispose(),Kt.dispose(),xr.dispose(),br.dispose(),br.removeEventListener("sessionstart",vn),br.removeEventListener("sessionend",an),er&&(er.dispose(),er=null),yn.stop()};function Rr(jt){jt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),xt=!0}function Tr(){console.log("THREE.WebGLRenderer: Context Restored."),xt=!1;const jt=Nr.autoReset,rr=hr.enabled,cr=hr.autoUpdate,or=hr.needsUpdate,vr=hr.type;Qr(),Nr.autoReset=jt,hr.enabled=rr,hr.autoUpdate=cr,hr.needsUpdate=or,hr.type=vr}function Vr(jt){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",jt.statusMessage)}function Wr(jt){const rr=jt.target;rr.removeEventListener("dispose",Wr),pn(rr)}function pn(jt){En(jt),wr.remove(jt)}function En(jt){const rr=wr.get(jt).programs;rr!==void 0&&(rr.forEach(function(cr){xr.releaseProgram(cr)}),jt.isShaderMaterial&&xr.releaseShaderCache(jt))}this.renderBufferDirect=function(jt,rr,cr,or,vr,Br){rr===null&&(rr=lr);const Dr=vr.isMesh&&vr.matrixWorld.determinant()<0,Gr=Nn(jt,rr,cr,or,vr);Er.setMaterial(or,Dr);let zr=cr.index,Yr=1;or.wireframe===!0&&(zr=Qt.getWireframeAttribute(cr),Yr=2);const Mr=cr.drawRange,Zr=cr.attributes.position;let Kr=Mr.start*Yr,qr=(Mr.start+Mr.count)*Yr;Br!==null&&(Kr=Math.max(Kr,Br.start*Yr),qr=Math.min(qr,(Br.start+Br.count)*Yr)),zr!==null?(Kr=Math.max(Kr,0),qr=Math.min(qr,zr.count)):Zr!=null&&(Kr=Math.max(Kr,0),qr=Math.min(qr,Zr.count));const ln=qr-Kr;if(ln<0||ln===1/0)return;_r.setup(vr,or,Gr,cr,zr);let dn,cn=Ar;if(zr!==null&&(dn=Xr.get(zr),cn=yr,cn.setIndex(dn)),vr.isMesh)or.wireframe===!0?(Er.setLineWidth(or.wireframeLinewidth*gr()),cn.setMode(Yt.LINES)):cn.setMode(Yt.TRIANGLES);else if(vr.isLine){let _i=or.linewidth;_i===void 0&&(_i=1),Er.setLineWidth(_i*gr()),vr.isLineSegments?cn.setMode(Yt.LINES):vr.isLineLoop?cn.setMode(Yt.LINE_LOOP):cn.setMode(Yt.LINE_STRIP)}else vr.isPoints?cn.setMode(Yt.POINTS):vr.isSprite&&cn.setMode(Yt.TRIANGLES);if(vr.isInstancedMesh)cn.renderInstances(Kr,ln,vr.count);else if(cr.isInstancedBufferGeometry){const _i=cr._maxInstanceCount!==void 0?cr._maxInstanceCount:1/0,fn=Math.min(cr.instanceCount,_i);cn.renderInstances(Kr,ln,fn)}else cn.render(Kr,ln)},this.compile=function(jt,rr){function cr(or,vr,Br){or.transparent===!0&&or.side===DoubleSide&&or.forceSinglePass===!1?(or.side=BackSide,or.needsUpdate=!0,_n(or,vr,Br),or.side=FrontSide,or.needsUpdate=!0,_n(or,vr,Br),or.side=DoubleSide):_n(or,vr,Br)}mt=pr.get(jt),mt.init(),yt.push(mt),jt.traverseVisible(function(or){or.isLight&&or.layers.test(rr.layers)&&(mt.pushLight(or),or.castShadow&&mt.pushShadow(or))}),mt.setupLights(bt.useLegacyLights),jt.traverse(function(or){const vr=or.material;if(vr)if(Array.isArray(vr))for(let Br=0;Br<vr.length;Br++){const Dr=vr[Br];cr(Dr,jt,or)}else cr(vr,jt,or)}),yt.pop(),mt=null};let rn=null;function Cn(jt){rn&&rn(jt)}function vn(){yn.stop()}function an(){yn.start()}const yn=new WebGLAnimation;yn.setAnimationLoop(Cn),typeof self<"u"&&yn.setContext(self),this.setAnimationLoop=function(jt){rn=jt,br.setAnimationLoop(jt),jt===null?yn.stop():yn.start()},br.addEventListener("sessionstart",vn),br.addEventListener("sessionend",an),this.render=function(jt,rr){if(rr!==void 0&&rr.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(xt===!0)return;jt.matrixWorldAutoUpdate===!0&&jt.updateMatrixWorld(),rr.parent===null&&rr.matrixWorldAutoUpdate===!0&&rr.updateMatrixWorld(),br.enabled===!0&&br.isPresenting===!0&&(br.cameraAutoUpdate===!0&&br.updateCamera(rr),rr=br.getCamera()),jt.isScene===!0&&jt.onBeforeRender(bt,jt,rr,Ct),mt=pr.get(jt,yt.length),mt.init(),yt.push(mt),ir.multiplyMatrices(rr.projectionMatrix,rr.matrixWorldInverse),Zt.setFromProjectionMatrix(ir),sr=this.localClippingEnabled,qt=Hr.init(this.clippingPlanes,sr),gt=fr.get(jt,At.length),gt.init(),At.push(gt),Gn(jt,rr,0,bt.sortObjects),gt.finish(),bt.sortObjects===!0&&gt.sort(Dt,Ft),this.info.render.frame++,qt===!0&&Hr.beginShadows();const cr=mt.state.shadowsArray;if(hr.render(cr,jt,rr),qt===!0&&Hr.endShadows(),this.info.autoReset===!0&&this.info.reset(),Cr.render(gt,jt),mt.setupLights(bt.useLegacyLights),rr.isArrayCamera){const or=rr.cameras;for(let vr=0,Br=or.length;vr<Br;vr++){const Dr=or[vr];Pn(gt,jt,Dr,Dr.viewport)}}else Pn(gt,jt,rr);Ct!==null&&(kr.updateMultisampleRenderTarget(Ct),kr.updateRenderTargetMipmap(Ct)),jt.isScene===!0&&jt.onAfterRender(bt,jt,rr),_r.resetDefaultState(),St=-1,Et=null,yt.pop(),yt.length>0?mt=yt[yt.length-1]:mt=null,At.pop(),At.length>0?gt=At[At.length-1]:gt=null};function Gn(jt,rr,cr,or){if(jt.visible===!1)return;if(jt.layers.test(rr.layers)){if(jt.isGroup)cr=jt.renderOrder;else if(jt.isLOD)jt.autoUpdate===!0&&jt.update(rr);else if(jt.isLight)mt.pushLight(jt),jt.castShadow&&mt.pushShadow(jt);else if(jt.isSprite){if(!jt.frustumCulled||Zt.intersectsSprite(jt)){or&&ar.setFromMatrixPosition(jt.matrixWorld).applyMatrix4(ir);const Dr=Xt.update(jt),Gr=jt.material;Gr.visible&&gt.push(jt,Dr,Gr,cr,ar.z,null)}}else if((jt.isMesh||jt.isLine||jt.isPoints)&&(!jt.frustumCulled||Zt.intersectsObject(jt))){const Dr=Xt.update(jt),Gr=jt.material;if(or&&(jt.boundingSphere!==void 0?(jt.boundingSphere===null&&jt.computeBoundingSphere(),ar.copy(jt.boundingSphere.center)):(Dr.boundingSphere===null&&Dr.computeBoundingSphere(),ar.copy(Dr.boundingSphere.center)),ar.applyMatrix4(jt.matrixWorld).applyMatrix4(ir)),Array.isArray(Gr)){const zr=Dr.groups;for(let Yr=0,Mr=zr.length;Yr<Mr;Yr++){const Zr=zr[Yr],Kr=Gr[Zr.materialIndex];Kr&&Kr.visible&&gt.push(jt,Dr,Kr,cr,ar.z,Zr)}}else Gr.visible&&gt.push(jt,Dr,Gr,cr,ar.z,null)}}const Br=jt.children;for(let Dr=0,Gr=Br.length;Dr<Gr;Dr++)Gn(Br[Dr],rr,cr,or)}function Pn(jt,rr,cr,or){const vr=jt.opaque,Br=jt.transmissive,Dr=jt.transparent;mt.setupLightsView(cr),qt===!0&&Hr.setGlobalState(bt.clippingPlanes,cr),Br.length>0&&Sn(vr,Br,rr,cr),or&&Er.viewport(Tt.copy(or)),vr.length>0&&In(vr,rr,cr),Br.length>0&&In(Br,rr,cr),Dr.length>0&&In(Dr,rr,cr),Er.buffers.depth.setTest(!0),Er.buffers.depth.setMask(!0),Er.buffers.color.setMask(!0),Er.setPolygonOffset(!1)}function Sn(jt,rr,cr,or){const vr=Sr.isWebGL2;er===null&&(er=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:mr.has("EXT_color_buffer_half_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:vr?4:0})),bt.getDrawingBufferSize(ur),vr?er.setSize(ur.x,ur.y):er.setSize(floorPowerOfTwo(ur.x),floorPowerOfTwo(ur.y));const Br=bt.getRenderTarget();bt.setRenderTarget(er),bt.getClearColor(It),Ot=bt.getClearAlpha(),Ot<1&&bt.setClearColor(16777215,.5),bt.clear();const Dr=bt.toneMapping;bt.toneMapping=NoToneMapping,In(jt,cr,or),kr.updateMultisampleRenderTarget(er),kr.updateRenderTargetMipmap(er);let Gr=!1;for(let zr=0,Yr=rr.length;zr<Yr;zr++){const Mr=rr[zr],Zr=Mr.object,Kr=Mr.geometry,qr=Mr.material,ln=Mr.group;if(qr.side===DoubleSide&&Zr.layers.test(or.layers)){const dn=qr.side;qr.side=BackSide,qr.needsUpdate=!0,jn(Zr,cr,or,Kr,qr,ln),qr.side=dn,qr.needsUpdate=!0,Gr=!0}}Gr===!0&&(kr.updateMultisampleRenderTarget(er),kr.updateRenderTargetMipmap(er)),bt.setRenderTarget(Br),bt.setClearColor(It,Ot),bt.toneMapping=Dr}function In(jt,rr,cr){const or=rr.isScene===!0?rr.overrideMaterial:null;for(let vr=0,Br=jt.length;vr<Br;vr++){const Dr=jt[vr],Gr=Dr.object,zr=Dr.geometry,Yr=or===null?Dr.material:or,Mr=Dr.group;Gr.layers.test(cr.layers)&&jn(Gr,rr,cr,zr,Yr,Mr)}}function jn(jt,rr,cr,or,vr,Br){jt.onBeforeRender(bt,rr,cr,or,vr,Br),jt.modelViewMatrix.multiplyMatrices(cr.matrixWorldInverse,jt.matrixWorld),jt.normalMatrix.getNormalMatrix(jt.modelViewMatrix),vr.onBeforeRender(bt,rr,cr,or,jt,Br),vr.transparent===!0&&vr.side===DoubleSide&&vr.forceSinglePass===!1?(vr.side=BackSide,vr.needsUpdate=!0,bt.renderBufferDirect(cr,rr,or,vr,jt,Br),vr.side=FrontSide,vr.needsUpdate=!0,bt.renderBufferDirect(cr,rr,or,vr,jt,Br),vr.side=DoubleSide):bt.renderBufferDirect(cr,rr,or,vr,jt,Br),jt.onAfterRender(bt,rr,cr,or,vr,Br)}function _n(jt,rr,cr){rr.isScene!==!0&&(rr=lr);const or=wr.get(jt),vr=mt.state.lights,Br=mt.state.shadowsArray,Dr=vr.state.version,Gr=xr.getParameters(jt,vr.state,Br,rr,cr),zr=xr.getProgramCacheKey(Gr);let Yr=or.programs;or.environment=jt.isMeshStandardMaterial?rr.environment:null,or.fog=rr.fog,or.envMap=(jt.isMeshStandardMaterial?Or:Ur).get(jt.envMap||or.environment),Yr===void 0&&(jt.addEventListener("dispose",Wr),Yr=new Map,or.programs=Yr);let Mr=Yr.get(zr);if(Mr!==void 0){if(or.currentProgram===Mr&&or.lightsStateVersion===Dr)return nn(jt,Gr),Mr}else Gr.uniforms=xr.getUniforms(jt),jt.onBuild(cr,Gr,bt),jt.onBeforeCompile(Gr,bt),Mr=xr.acquireProgram(Gr,zr),Yr.set(zr,Mr),or.uniforms=Gr.uniforms;const Zr=or.uniforms;(!jt.isShaderMaterial&&!jt.isRawShaderMaterial||jt.clipping===!0)&&(Zr.clippingPlanes=Hr.uniform),nn(jt,Gr),or.needsLights=Wt(jt),or.lightsStateVersion=Dr,or.needsLights&&(Zr.ambientLightColor.value=vr.state.ambient,Zr.lightProbe.value=vr.state.probe,Zr.directionalLights.value=vr.state.directional,Zr.directionalLightShadows.value=vr.state.directionalShadow,Zr.spotLights.value=vr.state.spot,Zr.spotLightShadows.value=vr.state.spotShadow,Zr.rectAreaLights.value=vr.state.rectArea,Zr.ltc_1.value=vr.state.rectAreaLTC1,Zr.ltc_2.value=vr.state.rectAreaLTC2,Zr.pointLights.value=vr.state.point,Zr.pointLightShadows.value=vr.state.pointShadow,Zr.hemisphereLights.value=vr.state.hemi,Zr.directionalShadowMap.value=vr.state.directionalShadowMap,Zr.directionalShadowMatrix.value=vr.state.directionalShadowMatrix,Zr.spotShadowMap.value=vr.state.spotShadowMap,Zr.spotLightMatrix.value=vr.state.spotLightMatrix,Zr.spotLightMap.value=vr.state.spotLightMap,Zr.pointShadowMap.value=vr.state.pointShadowMap,Zr.pointShadowMatrix.value=vr.state.pointShadowMatrix);const Kr=Mr.getUniforms(),qr=WebGLUniforms.seqWithValue(Kr.seq,Zr);return or.currentProgram=Mr,or.uniformsList=qr,Mr}function nn(jt,rr){const cr=wr.get(jt);cr.outputColorSpace=rr.outputColorSpace,cr.instancing=rr.instancing,cr.skinning=rr.skinning,cr.morphTargets=rr.morphTargets,cr.morphNormals=rr.morphNormals,cr.morphColors=rr.morphColors,cr.morphTargetsCount=rr.morphTargetsCount,cr.numClippingPlanes=rr.numClippingPlanes,cr.numIntersection=rr.numClipIntersection,cr.vertexAlphas=rr.vertexAlphas,cr.vertexTangents=rr.vertexTangents,cr.toneMapping=rr.toneMapping}function Nn(jt,rr,cr,or,vr){rr.isScene!==!0&&(rr=lr),kr.resetTextureUnits();const Br=rr.fog,Dr=or.isMeshStandardMaterial?rr.environment:null,Gr=Ct===null?bt.outputColorSpace:Ct.isXRRenderTarget===!0?Ct.texture.colorSpace:LinearSRGBColorSpace,zr=(or.isMeshStandardMaterial?Or:Ur).get(or.envMap||Dr),Yr=or.vertexColors===!0&&!!cr.attributes.color&&cr.attributes.color.itemSize===4,Mr=!!cr.attributes.tangent&&(!!or.normalMap||or.anisotropy>0),Zr=!!cr.morphAttributes.position,Kr=!!cr.morphAttributes.normal,qr=!!cr.morphAttributes.color,ln=or.toneMapped?bt.toneMapping:NoToneMapping,dn=cr.morphAttributes.position||cr.morphAttributes.normal||cr.morphAttributes.color,cn=dn!==void 0?dn.length:0,_i=wr.get(or),fn=mt.state.lights;if(qt===!0&&(sr===!0||jt!==Et)){const bn=jt===Et&&or.id===St;Hr.setState(or,jt,bn)}let on=!1;or.version===_i.__version?(_i.needsLights&&_i.lightsStateVersion!==fn.state.version||_i.outputColorSpace!==Gr||vr.isInstancedMesh&&_i.instancing===!1||!vr.isInstancedMesh&&_i.instancing===!0||vr.isSkinnedMesh&&_i.skinning===!1||!vr.isSkinnedMesh&&_i.skinning===!0||_i.envMap!==zr||or.fog===!0&&_i.fog!==Br||_i.numClippingPlanes!==void 0&&(_i.numClippingPlanes!==Hr.numPlanes||_i.numIntersection!==Hr.numIntersection)||_i.vertexAlphas!==Yr||_i.vertexTangents!==Mr||_i.morphTargets!==Zr||_i.morphNormals!==Kr||_i.morphColors!==qr||_i.toneMapping!==ln||Sr.isWebGL2===!0&&_i.morphTargetsCount!==cn)&&(on=!0):(on=!0,_i.__version=or.version);let An=_i.currentProgram;on===!0&&(An=_n(or,rr,vr));let Bn=!1,mn=!1,Dn=!1;const On=An.getUniforms(),Fn=_i.uniforms;if(Er.useProgram(An.program)&&(Bn=!0,mn=!0,Dn=!0),or.id!==St&&(St=or.id,mn=!0),Bn||Et!==jt){if(On.setValue(Yt,"projectionMatrix",jt.projectionMatrix),Sr.logarithmicDepthBuffer&&On.setValue(Yt,"logDepthBufFC",2/(Math.log(jt.far+1)/Math.LN2)),Et!==jt&&(Et=jt,mn=!0,Dn=!0),or.isShaderMaterial||or.isMeshPhongMaterial||or.isMeshToonMaterial||or.isMeshStandardMaterial||or.envMap){const bn=On.map.cameraPosition;bn!==void 0&&bn.setValue(Yt,ar.setFromMatrixPosition(jt.matrixWorld))}(or.isMeshPhongMaterial||or.isMeshToonMaterial||or.isMeshLambertMaterial||or.isMeshBasicMaterial||or.isMeshStandardMaterial||or.isShaderMaterial)&&On.setValue(Yt,"isOrthographic",jt.isOrthographicCamera===!0),(or.isMeshPhongMaterial||or.isMeshToonMaterial||or.isMeshLambertMaterial||or.isMeshBasicMaterial||or.isMeshStandardMaterial||or.isShaderMaterial||or.isShadowMaterial||vr.isSkinnedMesh)&&On.setValue(Yt,"viewMatrix",jt.matrixWorldInverse)}if(vr.isSkinnedMesh){On.setOptional(Yt,vr,"bindMatrix"),On.setOptional(Yt,vr,"bindMatrixInverse");const bn=vr.skeleton;bn&&(Sr.floatVertexTextures?(bn.boneTexture===null&&bn.computeBoneTexture(),On.setValue(Yt,"boneTexture",bn.boneTexture,kr),On.setValue(Yt,"boneTextureSize",bn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const zn=cr.morphAttributes;if((zn.position!==void 0||zn.normal!==void 0||zn.color!==void 0&&Sr.isWebGL2===!0)&&tr.update(vr,cr,An),(mn||_i.receiveShadow!==vr.receiveShadow)&&(_i.receiveShadow=vr.receiveShadow,On.setValue(Yt,"receiveShadow",vr.receiveShadow)),or.isMeshGouraudMaterial&&or.envMap!==null&&(Fn.envMap.value=zr,Fn.flipEnvMap.value=zr.isCubeTexture&&zr.isRenderTargetTexture===!1?-1:1),mn&&(On.setValue(Yt,"toneMappingExposure",bt.toneMappingExposure),_i.needsLights&&bs(Fn,Dn),Br&&or.fog===!0&&Lr.refreshFogUniforms(Fn,Br),Lr.refreshMaterialUniforms(Fn,or,zt,Nt,er),WebGLUniforms.upload(Yt,_i.uniformsList,Fn,kr)),or.isShaderMaterial&&or.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(Yt,_i.uniformsList,Fn,kr),or.uniformsNeedUpdate=!1),or.isSpriteMaterial&&On.setValue(Yt,"center",vr.center),On.setValue(Yt,"modelViewMatrix",vr.modelViewMatrix),On.setValue(Yt,"normalMatrix",vr.normalMatrix),On.setValue(Yt,"modelMatrix",vr.matrixWorld),or.isShaderMaterial||or.isRawShaderMaterial){const bn=or.uniformsGroups;for(let Vn=0,Ln=bn.length;Vn<Ln;Vn++)if(Sr.isWebGL2){const xn=bn[Vn];Kt.update(xn,An),Kt.bind(xn,An)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return An}function bs(jt,rr){jt.ambientLightColor.needsUpdate=rr,jt.lightProbe.needsUpdate=rr,jt.directionalLights.needsUpdate=rr,jt.directionalLightShadows.needsUpdate=rr,jt.pointLights.needsUpdate=rr,jt.pointLightShadows.needsUpdate=rr,jt.spotLights.needsUpdate=rr,jt.spotLightShadows.needsUpdate=rr,jt.rectAreaLights.needsUpdate=rr,jt.hemisphereLights.needsUpdate=rr}function Wt(jt){return jt.isMeshLambertMaterial||jt.isMeshToonMaterial||jt.isMeshPhongMaterial||jt.isMeshStandardMaterial||jt.isShadowMaterial||jt.isShaderMaterial&&jt.lights===!0}this.getActiveCubeFace=function(){return vt},this.getActiveMipmapLevel=function(){return _t},this.getRenderTarget=function(){return Ct},this.setRenderTargetTextures=function(jt,rr,cr){wr.get(jt.texture).__webglTexture=rr,wr.get(jt.depthTexture).__webglTexture=cr;const or=wr.get(jt);or.__hasExternalTextures=!0,or.__hasExternalTextures&&(or.__autoAllocateDepthBuffer=cr===void 0,or.__autoAllocateDepthBuffer||mr.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),or.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(jt,rr){const cr=wr.get(jt);cr.__webglFramebuffer=rr,cr.__useDefaultFramebuffer=rr===void 0},this.setRenderTarget=function(jt,rr=0,cr=0){Ct=jt,vt=rr,_t=cr;let or=!0,vr=null,Br=!1,Dr=!1;if(jt){const zr=wr.get(jt);zr.__useDefaultFramebuffer!==void 0?(Er.bindFramebuffer(Yt.FRAMEBUFFER,null),or=!1):zr.__webglFramebuffer===void 0?kr.setupRenderTarget(jt):zr.__hasExternalTextures&&kr.rebindTextures(jt,wr.get(jt.texture).__webglTexture,wr.get(jt.depthTexture).__webglTexture);const Yr=jt.texture;(Yr.isData3DTexture||Yr.isDataArrayTexture||Yr.isCompressedArrayTexture)&&(Dr=!0);const Mr=wr.get(jt).__webglFramebuffer;jt.isWebGLCubeRenderTarget?(vr=Mr[rr],Br=!0):Sr.isWebGL2&&jt.samples>0&&kr.useMultisampledRTT(jt)===!1?vr=wr.get(jt).__webglMultisampledFramebuffer:vr=Mr,Tt.copy(jt.viewport),Mt.copy(jt.scissor),Rt=jt.scissorTest}else Tt.copy(Ut).multiplyScalar(zt).floor(),Mt.copy($t).multiplyScalar(zt).floor(),Rt=Vt;if(Er.bindFramebuffer(Yt.FRAMEBUFFER,vr)&&Sr.drawBuffers&&or&&Er.drawBuffers(jt,vr),Er.viewport(Tt),Er.scissor(Mt),Er.setScissorTest(Rt),Br){const zr=wr.get(jt.texture);Yt.framebufferTexture2D(Yt.FRAMEBUFFER,Yt.COLOR_ATTACHMENT0,Yt.TEXTURE_CUBE_MAP_POSITIVE_X+rr,zr.__webglTexture,cr)}else if(Dr){const zr=wr.get(jt.texture),Yr=rr||0;Yt.framebufferTextureLayer(Yt.FRAMEBUFFER,Yt.COLOR_ATTACHMENT0,zr.__webglTexture,cr||0,Yr)}St=-1},this.readRenderTargetPixels=function(jt,rr,cr,or,vr,Br,Dr){if(!(jt&&jt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Gr=wr.get(jt).__webglFramebuffer;if(jt.isWebGLCubeRenderTarget&&Dr!==void 0&&(Gr=Gr[Dr]),Gr){Er.bindFramebuffer(Yt.FRAMEBUFFER,Gr);try{const zr=jt.texture,Yr=zr.format,Mr=zr.type;if(Yr!==RGBAFormat&&Jt.convert(Yr)!==Yt.getParameter(Yt.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Zr=Mr===HalfFloatType&&(mr.has("EXT_color_buffer_half_float")||Sr.isWebGL2&&mr.has("EXT_color_buffer_float"));if(Mr!==UnsignedByteType&&Jt.convert(Mr)!==Yt.getParameter(Yt.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Mr===FloatType&&(Sr.isWebGL2||mr.has("OES_texture_float")||mr.has("WEBGL_color_buffer_float")))&&!Zr){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}rr>=0&&rr<=jt.width-or&&cr>=0&&cr<=jt.height-vr&&Yt.readPixels(rr,cr,or,vr,Jt.convert(Yr),Jt.convert(Mr),Br)}finally{const zr=Ct!==null?wr.get(Ct).__webglFramebuffer:null;Er.bindFramebuffer(Yt.FRAMEBUFFER,zr)}}},this.copyFramebufferToTexture=function(jt,rr,cr=0){const or=Math.pow(2,-cr),vr=Math.floor(rr.image.width*or),Br=Math.floor(rr.image.height*or);kr.setTexture2D(rr,0),Yt.copyTexSubImage2D(Yt.TEXTURE_2D,cr,0,0,jt.x,jt.y,vr,Br),Er.unbindTexture()},this.copyTextureToTexture=function(jt,rr,cr,or=0){const vr=rr.image.width,Br=rr.image.height,Dr=Jt.convert(cr.format),Gr=Jt.convert(cr.type);kr.setTexture2D(cr,0),Yt.pixelStorei(Yt.UNPACK_FLIP_Y_WEBGL,cr.flipY),Yt.pixelStorei(Yt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,cr.premultiplyAlpha),Yt.pixelStorei(Yt.UNPACK_ALIGNMENT,cr.unpackAlignment),rr.isDataTexture?Yt.texSubImage2D(Yt.TEXTURE_2D,or,jt.x,jt.y,vr,Br,Dr,Gr,rr.image.data):rr.isCompressedTexture?Yt.compressedTexSubImage2D(Yt.TEXTURE_2D,or,jt.x,jt.y,rr.mipmaps[0].width,rr.mipmaps[0].height,Dr,rr.mipmaps[0].data):Yt.texSubImage2D(Yt.TEXTURE_2D,or,jt.x,jt.y,Dr,Gr,rr.image),or===0&&cr.generateMipmaps&&Yt.generateMipmap(Yt.TEXTURE_2D),Er.unbindTexture()},this.copyTextureToTexture3D=function(jt,rr,cr,or,vr=0){if(bt.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Br=jt.max.x-jt.min.x+1,Dr=jt.max.y-jt.min.y+1,Gr=jt.max.z-jt.min.z+1,zr=Jt.convert(or.format),Yr=Jt.convert(or.type);let Mr;if(or.isData3DTexture)kr.setTexture3D(or,0),Mr=Yt.TEXTURE_3D;else if(or.isDataArrayTexture)kr.setTexture2DArray(or,0),Mr=Yt.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Yt.pixelStorei(Yt.UNPACK_FLIP_Y_WEBGL,or.flipY),Yt.pixelStorei(Yt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,or.premultiplyAlpha),Yt.pixelStorei(Yt.UNPACK_ALIGNMENT,or.unpackAlignment);const Zr=Yt.getParameter(Yt.UNPACK_ROW_LENGTH),Kr=Yt.getParameter(Yt.UNPACK_IMAGE_HEIGHT),qr=Yt.getParameter(Yt.UNPACK_SKIP_PIXELS),ln=Yt.getParameter(Yt.UNPACK_SKIP_ROWS),dn=Yt.getParameter(Yt.UNPACK_SKIP_IMAGES),cn=cr.isCompressedTexture?cr.mipmaps[0]:cr.image;Yt.pixelStorei(Yt.UNPACK_ROW_LENGTH,cn.width),Yt.pixelStorei(Yt.UNPACK_IMAGE_HEIGHT,cn.height),Yt.pixelStorei(Yt.UNPACK_SKIP_PIXELS,jt.min.x),Yt.pixelStorei(Yt.UNPACK_SKIP_ROWS,jt.min.y),Yt.pixelStorei(Yt.UNPACK_SKIP_IMAGES,jt.min.z),cr.isDataTexture||cr.isData3DTexture?Yt.texSubImage3D(Mr,vr,rr.x,rr.y,rr.z,Br,Dr,Gr,zr,Yr,cn.data):cr.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Yt.compressedTexSubImage3D(Mr,vr,rr.x,rr.y,rr.z,Br,Dr,Gr,zr,cn.data)):Yt.texSubImage3D(Mr,vr,rr.x,rr.y,rr.z,Br,Dr,Gr,zr,Yr,cn),Yt.pixelStorei(Yt.UNPACK_ROW_LENGTH,Zr),Yt.pixelStorei(Yt.UNPACK_IMAGE_HEIGHT,Kr),Yt.pixelStorei(Yt.UNPACK_SKIP_PIXELS,qr),Yt.pixelStorei(Yt.UNPACK_SKIP_ROWS,ln),Yt.pixelStorei(Yt.UNPACK_SKIP_IMAGES,dn),vr===0&&or.generateMipmaps&&Yt.generateMipmap(Mr),Er.unbindTexture()},this.initTexture=function(jt){jt.isCubeTexture?kr.setTextureCube(jt,0):jt.isData3DTexture?kr.setTexture3D(jt,0):jt.isDataArrayTexture||jt.isCompressedArrayTexture?kr.setTexture2DArray(jt,0):kr.setTexture2D(jt,0),Er.unbindTexture()},this.resetState=function(){vt=0,_t=0,Ct=null,Er.reset(),_r.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(_e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!_e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set outputEncoding(_e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=_e===sRGBEncoding?SRGBColorSpace:LinearSRGBColorSpace}}class WebGL1Renderer extends WebGLRenderer{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class FogExp2{constructor(_e,rt=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color$1(_e),this.density=rt}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Fog{constructor(_e,rt=1,it=1e3){this.isFog=!0,this.name="",this.color=new Color$1(_e),this.near=rt,this.far=it}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_e,rt){return super.copy(_e,rt),_e.background!==null&&(this.background=_e.background.clone()),_e.environment!==null&&(this.environment=_e.environment.clone()),_e.fog!==null&&(this.fog=_e.fog.clone()),this.backgroundBlurriness=_e.backgroundBlurriness,this.backgroundIntensity=_e.backgroundIntensity,_e.overrideMaterial!==null&&(this.overrideMaterial=_e.overrideMaterial.clone()),this.matrixAutoUpdate=_e.matrixAutoUpdate,this}toJSON(_e){const rt=super.toJSON(_e);return this.fog!==null&&(rt.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(rt.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(rt.object.backgroundIntensity=this.backgroundIntensity),rt}}class InterleavedBuffer{constructor(_e,rt){this.isInterleavedBuffer=!0,this.array=_e,this.stride=rt,this.count=_e!==void 0?_e.length/rt:0,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=generateUUID$1()}onUploadCallback(){}set needsUpdate(_e){_e===!0&&this.version++}setUsage(_e){return this.usage=_e,this}copy(_e){return this.array=new _e.array.constructor(_e.array),this.count=_e.count,this.stride=_e.stride,this.usage=_e.usage,this}copyAt(_e,rt,it){_e*=this.stride,it*=rt.stride;for(let nt=0,st=this.stride;nt<st;nt++)this.array[_e+nt]=rt.array[it+nt];return this}set(_e,rt=0){return this.array.set(_e,rt),this}clone(_e){_e.arrayBuffers===void 0&&(_e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_e.arrayBuffers[this.array.buffer._uuid]===void 0&&(_e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const rt=new this.array.constructor(_e.arrayBuffers[this.array.buffer._uuid]),it=new this.constructor(rt,this.stride);return it.setUsage(this.usage),it}onUpload(_e){return this.onUploadCallback=_e,this}toJSON(_e){return _e.arrayBuffers===void 0&&(_e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_e.arrayBuffers[this.array.buffer._uuid]===void 0&&(_e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$5=new Vector3;class InterleavedBufferAttribute{constructor(_e,rt,it,nt=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_e,this.itemSize=rt,this.offset=it,this.normalized=nt}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_e){this.data.needsUpdate=_e}applyMatrix4(_e){for(let rt=0,it=this.data.count;rt<it;rt++)_vector$5.fromBufferAttribute(this,rt),_vector$5.applyMatrix4(_e),this.setXYZ(rt,_vector$5.x,_vector$5.y,_vector$5.z);return this}applyNormalMatrix(_e){for(let rt=0,it=this.count;rt<it;rt++)_vector$5.fromBufferAttribute(this,rt),_vector$5.applyNormalMatrix(_e),this.setXYZ(rt,_vector$5.x,_vector$5.y,_vector$5.z);return this}transformDirection(_e){for(let rt=0,it=this.count;rt<it;rt++)_vector$5.fromBufferAttribute(this,rt),_vector$5.transformDirection(_e),this.setXYZ(rt,_vector$5.x,_vector$5.y,_vector$5.z);return this}setX(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.data.array[_e*this.data.stride+this.offset]=rt,this}setY(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.data.array[_e*this.data.stride+this.offset+1]=rt,this}setZ(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.data.array[_e*this.data.stride+this.offset+2]=rt,this}setW(_e,rt){return this.normalized&&(rt=normalize$5(rt,this.array)),this.data.array[_e*this.data.stride+this.offset+3]=rt,this}getX(_e){let rt=this.data.array[_e*this.data.stride+this.offset];return this.normalized&&(rt=denormalize(rt,this.array)),rt}getY(_e){let rt=this.data.array[_e*this.data.stride+this.offset+1];return this.normalized&&(rt=denormalize(rt,this.array)),rt}getZ(_e){let rt=this.data.array[_e*this.data.stride+this.offset+2];return this.normalized&&(rt=denormalize(rt,this.array)),rt}getW(_e){let rt=this.data.array[_e*this.data.stride+this.offset+3];return this.normalized&&(rt=denormalize(rt,this.array)),rt}setXY(_e,rt,it){return _e=_e*this.data.stride+this.offset,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array)),this.data.array[_e+0]=rt,this.data.array[_e+1]=it,this}setXYZ(_e,rt,it,nt){return _e=_e*this.data.stride+this.offset,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array),nt=normalize$5(nt,this.array)),this.data.array[_e+0]=rt,this.data.array[_e+1]=it,this.data.array[_e+2]=nt,this}setXYZW(_e,rt,it,nt,st){return _e=_e*this.data.stride+this.offset,this.normalized&&(rt=normalize$5(rt,this.array),it=normalize$5(it,this.array),nt=normalize$5(nt,this.array),st=normalize$5(st,this.array)),this.data.array[_e+0]=rt,this.data.array[_e+1]=it,this.data.array[_e+2]=nt,this.data.array[_e+3]=st,this}clone(_e){if(_e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const rt=[];for(let it=0;it<this.count;it++){const nt=it*this.data.stride+this.offset;for(let st=0;st<this.itemSize;st++)rt.push(this.data.array[nt+st])}return new BufferAttribute(new this.array.constructor(rt),this.itemSize,this.normalized)}else return _e.interleavedBuffers===void 0&&(_e.interleavedBuffers={}),_e.interleavedBuffers[this.data.uuid]===void 0&&(_e.interleavedBuffers[this.data.uuid]=this.data.clone(_e)),new InterleavedBufferAttribute(_e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_e){if(_e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const rt=[];for(let it=0;it<this.count;it++){const nt=it*this.data.stride+this.offset;for(let st=0;st<this.itemSize;st++)rt.push(this.data.array[nt+st])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:rt,normalized:this.normalized}}else return _e.interleavedBuffers===void 0&&(_e.interleavedBuffers={}),_e.interleavedBuffers[this.data.uuid]===void 0&&(_e.interleavedBuffers[this.data.uuid]=this.data.toJSON(_e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(_e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.alphaMap=_e.alphaMap,this.rotation=_e.rotation,this.sizeAttenuation=_e.sizeAttenuation,this.fog=_e.fog,this}}let _geometry;const _intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2;class Sprite extends Object3D{constructor(_e){if(super(),this.isSprite=!0,this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;const rt=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),it=new InterleavedBuffer(rt,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(it,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(it,2,3,!1))}this.geometry=_geometry,this.material=_e!==void 0?_e:new SpriteMaterial,this.center=new Vector2(.5,.5)}raycast(_e,rt){_e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(_e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_e.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),_e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const it=this.material.rotation;let nt,st;it!==0&&(st=Math.cos(it),nt=Math.sin(it));const at=this.center;transformVertex(_vA.set(-.5,-.5,0),_mvPosition,at,_worldScale,nt,st),transformVertex(_vB.set(.5,-.5,0),_mvPosition,at,_worldScale,nt,st),transformVertex(_vC.set(.5,.5,0),_mvPosition,at,_worldScale,nt,st),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let lt=_e.ray.intersectTriangle(_vA,_vB,_vC,!1,_intersectPoint);if(lt===null&&(transformVertex(_vB.set(-.5,.5,0),_mvPosition,at,_worldScale,nt,st),_uvB.set(0,1),lt=_e.ray.intersectTriangle(_vA,_vC,_vB,!1,_intersectPoint),lt===null))return;const ot=_e.ray.origin.distanceTo(_intersectPoint);ot<_e.near||ot>_e.far||rt.push({distance:ot,point:_intersectPoint.clone(),uv:Triangle.getInterpolation(_intersectPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2),face:null,object:this})}copy(_e,rt){return super.copy(_e,rt),_e.center!==void 0&&this.center.copy(_e.center),this.material=_e.material,this}}function transformVertex(tt,_e,rt,it,nt,st){_alignedPosition.subVectors(tt,rt).addScalar(.5).multiply(it),nt!==void 0?(_rotatedPosition.x=st*_alignedPosition.x-nt*_alignedPosition.y,_rotatedPosition.y=nt*_alignedPosition.x+st*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),tt.copy(_e),tt.x+=_rotatedPosition.x,tt.y+=_rotatedPosition.y,tt.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(_e){super.copy(_e,!1);const rt=_e.levels;for(let it=0,nt=rt.length;it<nt;it++){const st=rt[it];this.addLevel(st.object.clone(),st.distance,st.hysteresis)}return this.autoUpdate=_e.autoUpdate,this}addLevel(_e,rt=0,it=0){rt=Math.abs(rt);const nt=this.levels;let st;for(st=0;st<nt.length&&!(rt<nt[st].distance);st++);return nt.splice(st,0,{distance:rt,hysteresis:it,object:_e}),this.add(_e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_e){const rt=this.levels;if(rt.length>0){let it,nt;for(it=1,nt=rt.length;it<nt;it++){let st=rt[it].distance;if(rt[it].object.visible&&(st-=st*rt[it].hysteresis),_e<st)break}return rt[it-1].object}return null}raycast(_e,rt){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const nt=_e.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(nt).raycast(_e,rt)}}update(_e){const rt=this.levels;if(rt.length>1){_v1$2.setFromMatrixPosition(_e.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const it=_v1$2.distanceTo(_v2$1)/_e.zoom;rt[0].object.visible=!0;let nt,st;for(nt=1,st=rt.length;nt<st;nt++){let at=rt[nt].distance;if(rt[nt].object.visible&&(at-=at*rt[nt].hysteresis),it>=at)rt[nt-1].object.visible=!1,rt[nt].object.visible=!0;else break}for(this._currentLevel=nt-1;nt<st;nt++)rt[nt].object.visible=!1}}toJSON(_e){const rt=super.toJSON(_e);this.autoUpdate===!1&&(rt.object.autoUpdate=!1),rt.object.levels=[];const it=this.levels;for(let nt=0,st=it.length;nt<st;nt++){const at=it[nt];rt.object.levels.push({object:at.object.uuid,distance:at.distance,hysteresis:at.hysteresis})}return rt}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$3=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray$1;class SkinnedMesh extends Mesh{constructor(_e,rt){super(_e,rt),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const _e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const rt=_e.getAttribute("position");for(let it=0;it<rt.count;it++)_vertex.fromBufferAttribute(rt,it),this.applyBoneTransform(it,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const _e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const rt=_e.getAttribute("position");for(let it=0;it<rt.count;it++)_vertex.fromBufferAttribute(rt,it),this.applyBoneTransform(it,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(_e,rt){return super.copy(_e,rt),this.bindMode=_e.bindMode,this.bindMatrix.copy(_e.bindMatrix),this.bindMatrixInverse.copy(_e.bindMatrixInverse),this.skeleton=_e.skeleton,_e.boundingBox!==null&&(this.boundingBox=_e.boundingBox.clone()),_e.boundingSphere!==null&&(this.boundingSphere=_e.boundingSphere.clone()),this}raycast(_e,rt){const it=this.material,nt=this.matrixWorld;it!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4(nt),_e.ray.intersectsSphere(_sphere$3)!==!1&&(_inverseMatrix$2.copy(nt).invert(),_ray$2.copy(_e.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(_e,rt,_ray$2)))}getVertexPosition(_e,rt){return super.getVertexPosition(_e,rt),this.applyBoneTransform(_e,rt),rt}bind(_e,rt){this.skeleton=_e,rt===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),rt=this.matrixWorld),this.bindMatrix.copy(rt),this.bindMatrixInverse.copy(rt).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _e=new Vector4,rt=this.geometry.attributes.skinWeight;for(let it=0,nt=rt.count;it<nt;it++){_e.fromBufferAttribute(rt,it);const st=1/_e.manhattanLength();st!==1/0?_e.multiplyScalar(st):_e.set(1,0,0,0),rt.setXYZW(it,_e.x,_e.y,_e.z,_e.w)}}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(_e,rt){const it=this.skeleton,nt=this.geometry;_skinIndex.fromBufferAttribute(nt.attributes.skinIndex,_e),_skinWeight.fromBufferAttribute(nt.attributes.skinWeight,_e),_basePosition.copy(rt).applyMatrix4(this.bindMatrix),rt.set(0,0,0);for(let st=0;st<4;st++){const at=_skinWeight.getComponent(st);if(at!==0){const lt=_skinIndex.getComponent(st);_matrix4.multiplyMatrices(it.bones[lt].matrixWorld,it.boneInverses[lt]),rt.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),at)}}return rt.applyMatrix4(this.bindMatrixInverse)}boneTransform(_e,rt){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(_e,rt)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(_e=null,rt=1,it=1,nt,st,at,lt,ot,ct=NearestFilter,ut=NearestFilter,ht,dt){super(null,at,lt,ot,ct,ut,nt,st,ht,dt),this.isDataTexture=!0,this.image={data:_e,width:rt,height:it},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$2=new Matrix4;class Skeleton{constructor(_e=[],rt=[]){this.uuid=generateUUID$1(),this.bones=_e.slice(0),this.boneInverses=rt,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const _e=this.bones,rt=this.boneInverses;if(this.boneMatrices=new Float32Array(_e.length*16),rt.length===0)this.calculateInverses();else if(_e.length!==rt.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let it=0,nt=this.bones.length;it<nt;it++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let _e=0,rt=this.bones.length;_e<rt;_e++){const it=new Matrix4;this.bones[_e]&&it.copy(this.bones[_e].matrixWorld).invert(),this.boneInverses.push(it)}}pose(){for(let _e=0,rt=this.bones.length;_e<rt;_e++){const it=this.bones[_e];it&&it.matrixWorld.copy(this.boneInverses[_e]).invert()}for(let _e=0,rt=this.bones.length;_e<rt;_e++){const it=this.bones[_e];it&&(it.parent&&it.parent.isBone?(it.matrix.copy(it.parent.matrixWorld).invert(),it.matrix.multiply(it.matrixWorld)):it.matrix.copy(it.matrixWorld),it.matrix.decompose(it.position,it.quaternion,it.scale))}}update(){const _e=this.bones,rt=this.boneInverses,it=this.boneMatrices,nt=this.boneTexture;for(let st=0,at=_e.length;st<at;st++){const lt=_e[st]?_e[st].matrixWorld:_identityMatrix$2;_offsetMatrix.multiplyMatrices(lt,rt[st]),_offsetMatrix.toArray(it,st*16)}nt!==null&&(nt.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _e=Math.sqrt(this.bones.length*4);_e=ceilPowerOfTwo(_e),_e=Math.max(_e,4);const rt=new Float32Array(_e*_e*4);rt.set(this.boneMatrices);const it=new DataTexture(rt,_e,_e,RGBAFormat,FloatType);return it.needsUpdate=!0,this.boneMatrices=rt,this.boneTexture=it,this.boneTextureSize=_e,this}getBoneByName(_e){for(let rt=0,it=this.bones.length;rt<it;rt++){const nt=this.bones[rt];if(nt.name===_e)return nt}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_e,rt){this.uuid=_e.uuid;for(let it=0,nt=_e.bones.length;it<nt;it++){const st=_e.bones[it];let at=rt[st];at===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",st),at=new Bone),this.bones.push(at),this.boneInverses.push(new Matrix4().fromArray(_e.boneInverses[it]))}return this.init(),this}toJSON(){const _e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_e.uuid=this.uuid;const rt=this.bones,it=this.boneInverses;for(let nt=0,st=rt.length;nt<st;nt++){const at=rt[nt];_e.bones.push(at.uuid);const lt=it[nt];_e.boneInverses.push(lt.toArray())}return _e}}class InstancedBufferAttribute extends BufferAttribute{constructor(_e,rt,it,nt=1){super(_e,rt,it),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=nt}copy(_e){return super.copy(_e),this.meshPerAttribute=_e.meshPerAttribute,this}toJSON(){const _e=super.toJSON();return _e.meshPerAttribute=this.meshPerAttribute,_e.isInstancedBufferAttribute=!0,_e}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh=new Mesh,_sphere$2=new Sphere;class InstancedMesh extends Mesh{constructor(_e,rt,it){super(_e,rt),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(it*16),16),this.instanceColor=null,this.count=it,this.boundingBox=null,this.boundingSphere=null;for(let nt=0;nt<it;nt++)this.setMatrixAt(nt,_identity)}computeBoundingBox(){const _e=this.geometry,rt=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),_e.boundingBox===null&&_e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let it=0;it<rt;it++)this.getMatrixAt(it,_instanceLocalMatrix),_box3.copy(_e.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const _e=this.geometry,rt=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),_e.boundingSphere===null&&_e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let it=0;it<rt;it++)this.getMatrixAt(it,_instanceLocalMatrix),_sphere$2.copy(_e.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$2)}copy(_e,rt){return super.copy(_e,rt),this.instanceMatrix.copy(_e.instanceMatrix),_e.instanceColor!==null&&(this.instanceColor=_e.instanceColor.clone()),this.count=_e.count,_e.boundingBox!==null&&(this.boundingBox=_e.boundingBox.clone()),_e.boundingSphere!==null&&(this.boundingSphere=_e.boundingSphere.clone()),this}getColorAt(_e,rt){rt.fromArray(this.instanceColor.array,_e*3)}getMatrixAt(_e,rt){rt.fromArray(this.instanceMatrix.array,_e*16)}raycast(_e,rt){const it=this.matrixWorld,nt=this.count;if(_mesh.geometry=this.geometry,_mesh.material=this.material,_mesh.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$2.copy(this.boundingSphere),_sphere$2.applyMatrix4(it),_e.ray.intersectsSphere(_sphere$2)!==!1))for(let st=0;st<nt;st++){this.getMatrixAt(st,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(it,_instanceLocalMatrix),_mesh.matrixWorld=_instanceWorldMatrix,_mesh.raycast(_e,_instanceIntersects);for(let at=0,lt=_instanceIntersects.length;at<lt;at++){const ot=_instanceIntersects[at];ot.instanceId=st,ot.object=this,rt.push(ot)}_instanceIntersects.length=0}}setColorAt(_e,rt){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3),3)),rt.toArray(this.instanceColor.array,_e*3)}setMatrixAt(_e,rt){rt.toArray(this.instanceMatrix.array,_e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class LineBasicMaterial extends Material{constructor(_e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.linewidth=_e.linewidth,this.linecap=_e.linecap,this.linejoin=_e.linejoin,this.fog=_e.fog,this}}const _start$1=new Vector3,_end$1=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray$1,_sphere$1=new Sphere;class Line extends Object3D{constructor(_e=new BufferGeometry,rt=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=_e,this.material=rt,this.updateMorphTargets()}copy(_e,rt){return super.copy(_e,rt),this.material=_e.material,this.geometry=_e.geometry,this}computeLineDistances(){const _e=this.geometry;if(_e.index===null){const rt=_e.attributes.position,it=[0];for(let nt=1,st=rt.count;nt<st;nt++)_start$1.fromBufferAttribute(rt,nt-1),_end$1.fromBufferAttribute(rt,nt),it[nt]=it[nt-1],it[nt]+=_start$1.distanceTo(_end$1);_e.setAttribute("lineDistance",new Float32BufferAttribute(it,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_e,rt){const it=this.geometry,nt=this.matrixWorld,st=_e.params.Line.threshold,at=it.drawRange;if(it.boundingSphere===null&&it.computeBoundingSphere(),_sphere$1.copy(it.boundingSphere),_sphere$1.applyMatrix4(nt),_sphere$1.radius+=st,_e.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(nt).invert(),_ray$1.copy(_e.ray).applyMatrix4(_inverseMatrix$1);const lt=st/((this.scale.x+this.scale.y+this.scale.z)/3),ot=lt*lt,ct=new Vector3,ut=new Vector3,ht=new Vector3,dt=new Vector3,pt=this.isLineSegments?2:1,ft=it.index,mt=it.attributes.position;if(ft!==null){const At=Math.max(0,at.start),yt=Math.min(ft.count,at.start+at.count);for(let bt=At,xt=yt-1;bt<xt;bt+=pt){const vt=ft.getX(bt),_t=ft.getX(bt+1);if(ct.fromBufferAttribute(mt,vt),ut.fromBufferAttribute(mt,_t),_ray$1.distanceSqToSegment(ct,ut,dt,ht)>ot)continue;dt.applyMatrix4(this.matrixWorld);const St=_e.ray.origin.distanceTo(dt);St<_e.near||St>_e.far||rt.push({distance:St,point:ht.clone().applyMatrix4(this.matrixWorld),index:bt,face:null,faceIndex:null,object:this})}}else{const At=Math.max(0,at.start),yt=Math.min(mt.count,at.start+at.count);for(let bt=At,xt=yt-1;bt<xt;bt+=pt){if(ct.fromBufferAttribute(mt,bt),ut.fromBufferAttribute(mt,bt+1),_ray$1.distanceSqToSegment(ct,ut,dt,ht)>ot)continue;dt.applyMatrix4(this.matrixWorld);const _t=_e.ray.origin.distanceTo(dt);_t<_e.near||_t>_e.far||rt.push({distance:_t,point:ht.clone().applyMatrix4(this.matrixWorld),index:bt,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const rt=this.geometry.morphAttributes,it=Object.keys(rt);if(it.length>0){const nt=rt[it[0]];if(nt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,at=nt.length;st<at;st++){const lt=nt[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[lt]=st}}}}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(_e,rt){super(_e,rt),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _e=this.geometry;if(_e.index===null){const rt=_e.attributes.position,it=[];for(let nt=0,st=rt.count;nt<st;nt+=2)_start.fromBufferAttribute(rt,nt),_end.fromBufferAttribute(rt,nt+1),it[nt]=nt===0?0:it[nt-1],it[nt+1]=it[nt]+_start.distanceTo(_end);_e.setAttribute("lineDistance",new Float32BufferAttribute(it,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(_e,rt){super(_e,rt),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(_e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.alphaMap=_e.alphaMap,this.size=_e.size,this.sizeAttenuation=_e.sizeAttenuation,this.fog=_e.fog,this}}const _inverseMatrix=new Matrix4,_ray=new Ray$1,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(_e=new BufferGeometry,rt=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=_e,this.material=rt,this.updateMorphTargets()}copy(_e,rt){return super.copy(_e,rt),this.material=_e.material,this.geometry=_e.geometry,this}raycast(_e,rt){const it=this.geometry,nt=this.matrixWorld,st=_e.params.Points.threshold,at=it.drawRange;if(it.boundingSphere===null&&it.computeBoundingSphere(),_sphere.copy(it.boundingSphere),_sphere.applyMatrix4(nt),_sphere.radius+=st,_e.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(nt).invert(),_ray.copy(_e.ray).applyMatrix4(_inverseMatrix);const lt=st/((this.scale.x+this.scale.y+this.scale.z)/3),ot=lt*lt,ct=it.index,ht=it.attributes.position;if(ct!==null){const dt=Math.max(0,at.start),pt=Math.min(ct.count,at.start+at.count);for(let ft=dt,gt=pt;ft<gt;ft++){const mt=ct.getX(ft);_position$2.fromBufferAttribute(ht,mt),testPoint(_position$2,mt,ot,nt,_e,rt,this)}}else{const dt=Math.max(0,at.start),pt=Math.min(ht.count,at.start+at.count);for(let ft=dt,gt=pt;ft<gt;ft++)_position$2.fromBufferAttribute(ht,ft),testPoint(_position$2,ft,ot,nt,_e,rt,this)}}updateMorphTargets(){const rt=this.geometry.morphAttributes,it=Object.keys(rt);if(it.length>0){const nt=rt[it[0]];if(nt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let st=0,at=nt.length;st<at;st++){const lt=nt[st].name||String(st);this.morphTargetInfluences.push(0),this.morphTargetDictionary[lt]=st}}}}}function testPoint(tt,_e,rt,it,nt,st,at){const lt=_ray.distanceSqToPoint(tt);if(lt<rt){const ot=new Vector3;_ray.closestPointToPoint(tt,ot),ot.applyMatrix4(it);const ct=nt.ray.origin.distanceTo(ot);if(ct<nt.near||ct>nt.far)return;st.push({distance:ct,distanceToRay:Math.sqrt(lt),point:ot,index:_e,face:null,object:at})}}class VideoTexture extends Texture{constructor(_e,rt,it,nt,st,at,lt,ot,ct){super(_e,rt,it,nt,st,at,lt,ot,ct),this.isVideoTexture=!0,this.minFilter=at!==void 0?at:LinearFilter,this.magFilter=st!==void 0?st:LinearFilter,this.generateMipmaps=!1;const ut=this;function ht(){ut.needsUpdate=!0,_e.requestVideoFrameCallback(ht)}"requestVideoFrameCallback"in _e&&_e.requestVideoFrameCallback(ht)}clone(){return new this.constructor(this.image).copy(this)}update(){const _e=this.image;"requestVideoFrameCallback"in _e===!1&&_e.readyState>=_e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class FramebufferTexture extends Texture{constructor(_e,rt){super({width:_e,height:rt}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture{constructor(_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt){super(null,at,lt,ot,ct,ut,nt,st,ht,dt),this.isCompressedTexture=!0,this.image={width:rt,height:it},this.mipmaps=_e,this.flipY=!1,this.generateMipmaps=!1}}let CompressedArrayTexture$1=class extends CompressedTexture{constructor(_e,rt,it,nt,st,at){super(_e,rt,it,st,at),this.isCompressedArrayTexture=!0,this.image.depth=nt,this.wrapR=ClampToEdgeWrapping}};class CanvasTexture extends Texture{constructor(_e,rt,it,nt,st,at,lt,ot,ct){super(_e,rt,it,nt,st,at,lt,ot,ct),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(_e,rt){const it=this.getUtoTmapping(_e);return this.getPoint(it,rt)}getPoints(_e=5){const rt=[];for(let it=0;it<=_e;it++)rt.push(this.getPoint(it/_e));return rt}getSpacedPoints(_e=5){const rt=[];for(let it=0;it<=_e;it++)rt.push(this.getPointAt(it/_e));return rt}getLength(){const _e=this.getLengths();return _e[_e.length-1]}getLengths(_e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const rt=[];let it,nt=this.getPoint(0),st=0;rt.push(0);for(let at=1;at<=_e;at++)it=this.getPoint(at/_e),st+=it.distanceTo(nt),rt.push(st),nt=it;return this.cacheArcLengths=rt,rt}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_e,rt){const it=this.getLengths();let nt=0;const st=it.length;let at;rt?at=rt:at=_e*it[st-1];let lt=0,ot=st-1,ct;for(;lt<=ot;)if(nt=Math.floor(lt+(ot-lt)/2),ct=it[nt]-at,ct<0)lt=nt+1;else if(ct>0)ot=nt-1;else{ot=nt;break}if(nt=ot,it[nt]===at)return nt/(st-1);const ut=it[nt],dt=it[nt+1]-ut,pt=(at-ut)/dt;return(nt+pt)/(st-1)}getTangent(_e,rt){let nt=_e-1e-4,st=_e+1e-4;nt<0&&(nt=0),st>1&&(st=1);const at=this.getPoint(nt),lt=this.getPoint(st),ot=rt||(at.isVector2?new Vector2:new Vector3);return ot.copy(lt).sub(at).normalize(),ot}getTangentAt(_e,rt){const it=this.getUtoTmapping(_e);return this.getTangent(it,rt)}computeFrenetFrames(_e,rt){const it=new Vector3,nt=[],st=[],at=[],lt=new Vector3,ot=new Matrix4;for(let pt=0;pt<=_e;pt++){const ft=pt/_e;nt[pt]=this.getTangentAt(ft,new Vector3)}st[0]=new Vector3,at[0]=new Vector3;let ct=Number.MAX_VALUE;const ut=Math.abs(nt[0].x),ht=Math.abs(nt[0].y),dt=Math.abs(nt[0].z);ut<=ct&&(ct=ut,it.set(1,0,0)),ht<=ct&&(ct=ht,it.set(0,1,0)),dt<=ct&&it.set(0,0,1),lt.crossVectors(nt[0],it).normalize(),st[0].crossVectors(nt[0],lt),at[0].crossVectors(nt[0],st[0]);for(let pt=1;pt<=_e;pt++){if(st[pt]=st[pt-1].clone(),at[pt]=at[pt-1].clone(),lt.crossVectors(nt[pt-1],nt[pt]),lt.length()>Number.EPSILON){lt.normalize();const ft=Math.acos(clamp$2(nt[pt-1].dot(nt[pt]),-1,1));st[pt].applyMatrix4(ot.makeRotationAxis(lt,ft))}at[pt].crossVectors(nt[pt],st[pt])}if(rt===!0){let pt=Math.acos(clamp$2(st[0].dot(st[_e]),-1,1));pt/=_e,nt[0].dot(lt.crossVectors(st[0],st[_e]))>0&&(pt=-pt);for(let ft=1;ft<=_e;ft++)st[ft].applyMatrix4(ot.makeRotationAxis(nt[ft],pt*ft)),at[ft].crossVectors(nt[ft],st[ft])}return{tangents:nt,normals:st,binormals:at}}clone(){return new this.constructor().copy(this)}copy(_e){return this.arcLengthDivisions=_e.arcLengthDivisions,this}toJSON(){const _e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return _e.arcLengthDivisions=this.arcLengthDivisions,_e.type=this.type,_e}fromJSON(_e){return this.arcLengthDivisions=_e.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(_e=0,rt=0,it=1,nt=1,st=0,at=Math.PI*2,lt=!1,ot=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_e,this.aY=rt,this.xRadius=it,this.yRadius=nt,this.aStartAngle=st,this.aEndAngle=at,this.aClockwise=lt,this.aRotation=ot}getPoint(_e,rt){const it=rt||new Vector2,nt=Math.PI*2;let st=this.aEndAngle-this.aStartAngle;const at=Math.abs(st)<Number.EPSILON;for(;st<0;)st+=nt;for(;st>nt;)st-=nt;st<Number.EPSILON&&(at?st=0:st=nt),this.aClockwise===!0&&!at&&(st===nt?st=-nt:st=st-nt);const lt=this.aStartAngle+_e*st;let ot=this.aX+this.xRadius*Math.cos(lt),ct=this.aY+this.yRadius*Math.sin(lt);if(this.aRotation!==0){const ut=Math.cos(this.aRotation),ht=Math.sin(this.aRotation),dt=ot-this.aX,pt=ct-this.aY;ot=dt*ut-pt*ht+this.aX,ct=dt*ht+pt*ut+this.aY}return it.set(ot,ct)}copy(_e){return super.copy(_e),this.aX=_e.aX,this.aY=_e.aY,this.xRadius=_e.xRadius,this.yRadius=_e.yRadius,this.aStartAngle=_e.aStartAngle,this.aEndAngle=_e.aEndAngle,this.aClockwise=_e.aClockwise,this.aRotation=_e.aRotation,this}toJSON(){const _e=super.toJSON();return _e.aX=this.aX,_e.aY=this.aY,_e.xRadius=this.xRadius,_e.yRadius=this.yRadius,_e.aStartAngle=this.aStartAngle,_e.aEndAngle=this.aEndAngle,_e.aClockwise=this.aClockwise,_e.aRotation=this.aRotation,_e}fromJSON(_e){return super.fromJSON(_e),this.aX=_e.aX,this.aY=_e.aY,this.xRadius=_e.xRadius,this.yRadius=_e.yRadius,this.aStartAngle=_e.aStartAngle,this.aEndAngle=_e.aEndAngle,this.aClockwise=_e.aClockwise,this.aRotation=_e.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(_e,rt,it,nt,st,at){super(_e,rt,it,it,nt,st,at),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let tt=0,_e=0,rt=0,it=0;function nt(st,at,lt,ot){tt=st,_e=lt,rt=-3*st+3*at-2*lt-ot,it=2*st-2*at+lt+ot}return{initCatmullRom:function(st,at,lt,ot,ct){nt(at,lt,ct*(lt-st),ct*(ot-at))},initNonuniformCatmullRom:function(st,at,lt,ot,ct,ut,ht){let dt=(at-st)/ct-(lt-st)/(ct+ut)+(lt-at)/ut,pt=(lt-at)/ut-(ot-at)/(ut+ht)+(ot-lt)/ht;dt*=ut,pt*=ut,nt(at,lt,dt,pt)},calc:function(st){const at=st*st,lt=at*st;return tt+_e*st+rt*at+it*lt}}}const tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(_e=[],rt=!1,it="centripetal",nt=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_e,this.closed=rt,this.curveType=it,this.tension=nt}getPoint(_e,rt=new Vector3){const it=rt,nt=this.points,st=nt.length,at=(st-(this.closed?0:1))*_e;let lt=Math.floor(at),ot=at-lt;this.closed?lt+=lt>0?0:(Math.floor(Math.abs(lt)/st)+1)*st:ot===0&&lt===st-1&&(lt=st-2,ot=1);let ct,ut;this.closed||lt>0?ct=nt[(lt-1)%st]:(tmp.subVectors(nt[0],nt[1]).add(nt[0]),ct=tmp);const ht=nt[lt%st],dt=nt[(lt+1)%st];if(this.closed||lt+2<st?ut=nt[(lt+2)%st]:(tmp.subVectors(nt[st-1],nt[st-2]).add(nt[st-1]),ut=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const pt=this.curveType==="chordal"?.5:.25;let ft=Math.pow(ct.distanceToSquared(ht),pt),gt=Math.pow(ht.distanceToSquared(dt),pt),mt=Math.pow(dt.distanceToSquared(ut),pt);gt<1e-4&&(gt=1),ft<1e-4&&(ft=gt),mt<1e-4&&(mt=gt),px.initNonuniformCatmullRom(ct.x,ht.x,dt.x,ut.x,ft,gt,mt),py.initNonuniformCatmullRom(ct.y,ht.y,dt.y,ut.y,ft,gt,mt),pz.initNonuniformCatmullRom(ct.z,ht.z,dt.z,ut.z,ft,gt,mt)}else this.curveType==="catmullrom"&&(px.initCatmullRom(ct.x,ht.x,dt.x,ut.x,this.tension),py.initCatmullRom(ct.y,ht.y,dt.y,ut.y,this.tension),pz.initCatmullRom(ct.z,ht.z,dt.z,ut.z,this.tension));return it.set(px.calc(ot),py.calc(ot),pz.calc(ot)),it}copy(_e){super.copy(_e),this.points=[];for(let rt=0,it=_e.points.length;rt<it;rt++){const nt=_e.points[rt];this.points.push(nt.clone())}return this.closed=_e.closed,this.curveType=_e.curveType,this.tension=_e.tension,this}toJSON(){const _e=super.toJSON();_e.points=[];for(let rt=0,it=this.points.length;rt<it;rt++){const nt=this.points[rt];_e.points.push(nt.toArray())}return _e.closed=this.closed,_e.curveType=this.curveType,_e.tension=this.tension,_e}fromJSON(_e){super.fromJSON(_e),this.points=[];for(let rt=0,it=_e.points.length;rt<it;rt++){const nt=_e.points[rt];this.points.push(new Vector3().fromArray(nt))}return this.closed=_e.closed,this.curveType=_e.curveType,this.tension=_e.tension,this}}function CatmullRom(tt,_e,rt,it,nt){const st=(it-_e)*.5,at=(nt-rt)*.5,lt=tt*tt,ot=tt*lt;return(2*rt-2*it+st+at)*ot+(-3*rt+3*it-2*st-at)*lt+st*tt+rt}function QuadraticBezierP0(tt,_e){const rt=1-tt;return rt*rt*_e}function QuadraticBezierP1(tt,_e){return 2*(1-tt)*tt*_e}function QuadraticBezierP2(tt,_e){return tt*tt*_e}function QuadraticBezier(tt,_e,rt,it){return QuadraticBezierP0(tt,_e)+QuadraticBezierP1(tt,rt)+QuadraticBezierP2(tt,it)}function CubicBezierP0(tt,_e){const rt=1-tt;return rt*rt*rt*_e}function CubicBezierP1(tt,_e){const rt=1-tt;return 3*rt*rt*tt*_e}function CubicBezierP2(tt,_e){return 3*(1-tt)*tt*tt*_e}function CubicBezierP3(tt,_e){return tt*tt*tt*_e}function CubicBezier(tt,_e,rt,it,nt){return CubicBezierP0(tt,_e)+CubicBezierP1(tt,rt)+CubicBezierP2(tt,it)+CubicBezierP3(tt,nt)}class CubicBezierCurve extends Curve{constructor(_e=new Vector2,rt=new Vector2,it=new Vector2,nt=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_e,this.v1=rt,this.v2=it,this.v3=nt}getPoint(_e,rt=new Vector2){const it=rt,nt=this.v0,st=this.v1,at=this.v2,lt=this.v3;return it.set(CubicBezier(_e,nt.x,st.x,at.x,lt.x),CubicBezier(_e,nt.y,st.y,at.y,lt.y)),it}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this.v3.copy(_e.v3),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e.v3=this.v3.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this.v3.fromArray(_e.v3),this}}class CubicBezierCurve3 extends Curve{constructor(_e=new Vector3,rt=new Vector3,it=new Vector3,nt=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_e,this.v1=rt,this.v2=it,this.v3=nt}getPoint(_e,rt=new Vector3){const it=rt,nt=this.v0,st=this.v1,at=this.v2,lt=this.v3;return it.set(CubicBezier(_e,nt.x,st.x,at.x,lt.x),CubicBezier(_e,nt.y,st.y,at.y,lt.y),CubicBezier(_e,nt.z,st.z,at.z,lt.z)),it}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this.v3.copy(_e.v3),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e.v3=this.v3.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this.v3.fromArray(_e.v3),this}}class LineCurve extends Curve{constructor(_e=new Vector2,rt=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_e,this.v2=rt}getPoint(_e,rt=new Vector2){const it=rt;return _e===1?it.copy(this.v2):(it.copy(this.v2).sub(this.v1),it.multiplyScalar(_e).add(this.v1)),it}getPointAt(_e,rt){return this.getPoint(_e,rt)}getTangent(_e,rt=new Vector2){return rt.subVectors(this.v2,this.v1).normalize()}getTangentAt(_e,rt){return this.getTangent(_e,rt)}copy(_e){return super.copy(_e),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class LineCurve3 extends Curve{constructor(_e=new Vector3,rt=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_e,this.v2=rt}getPoint(_e,rt=new Vector3){const it=rt;return _e===1?it.copy(this.v2):(it.copy(this.v2).sub(this.v1),it.multiplyScalar(_e).add(this.v1)),it}getPointAt(_e,rt){return this.getPoint(_e,rt)}getTangent(_e,rt=new Vector3){return rt.subVectors(this.v2,this.v1).normalize()}getTangentAt(_e,rt){return this.getTangent(_e,rt)}copy(_e){return super.copy(_e),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class QuadraticBezierCurve extends Curve{constructor(_e=new Vector2,rt=new Vector2,it=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_e,this.v1=rt,this.v2=it}getPoint(_e,rt=new Vector2){const it=rt,nt=this.v0,st=this.v1,at=this.v2;return it.set(QuadraticBezier(_e,nt.x,st.x,at.x),QuadraticBezier(_e,nt.y,st.y,at.y)),it}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(_e=new Vector3,rt=new Vector3,it=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_e,this.v1=rt,this.v2=it}getPoint(_e,rt=new Vector3){const it=rt,nt=this.v0,st=this.v1,at=this.v2;return it.set(QuadraticBezier(_e,nt.x,st.x,at.x),QuadraticBezier(_e,nt.y,st.y,at.y),QuadraticBezier(_e,nt.z,st.z,at.z)),it}copy(_e){return super.copy(_e),this.v0.copy(_e.v0),this.v1.copy(_e.v1),this.v2.copy(_e.v2),this}toJSON(){const _e=super.toJSON();return _e.v0=this.v0.toArray(),_e.v1=this.v1.toArray(),_e.v2=this.v2.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.v0.fromArray(_e.v0),this.v1.fromArray(_e.v1),this.v2.fromArray(_e.v2),this}}class SplineCurve extends Curve{constructor(_e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_e}getPoint(_e,rt=new Vector2){const it=rt,nt=this.points,st=(nt.length-1)*_e,at=Math.floor(st),lt=st-at,ot=nt[at===0?at:at-1],ct=nt[at],ut=nt[at>nt.length-2?nt.length-1:at+1],ht=nt[at>nt.length-3?nt.length-1:at+2];return it.set(CatmullRom(lt,ot.x,ct.x,ut.x,ht.x),CatmullRom(lt,ot.y,ct.y,ut.y,ht.y)),it}copy(_e){super.copy(_e),this.points=[];for(let rt=0,it=_e.points.length;rt<it;rt++){const nt=_e.points[rt];this.points.push(nt.clone())}return this}toJSON(){const _e=super.toJSON();_e.points=[];for(let rt=0,it=this.points.length;rt<it;rt++){const nt=this.points[rt];_e.points.push(nt.toArray())}return _e}fromJSON(_e){super.fromJSON(_e),this.points=[];for(let rt=0,it=_e.points.length;rt<it;rt++){const nt=_e.points[rt];this.points.push(new Vector2().fromArray(nt))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_e){this.curves.push(_e)}closePath(){const _e=this.curves[0].getPoint(0),rt=this.curves[this.curves.length-1].getPoint(1);_e.equals(rt)||this.curves.push(new LineCurve(rt,_e))}getPoint(_e,rt){const it=_e*this.getLength(),nt=this.getCurveLengths();let st=0;for(;st<nt.length;){if(nt[st]>=it){const at=nt[st]-it,lt=this.curves[st],ot=lt.getLength(),ct=ot===0?0:1-at/ot;return lt.getPointAt(ct,rt)}st++}return null}getLength(){const _e=this.getCurveLengths();return _e[_e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _e=[];let rt=0;for(let it=0,nt=this.curves.length;it<nt;it++)rt+=this.curves[it].getLength(),_e.push(rt);return this.cacheLengths=_e,_e}getSpacedPoints(_e=40){const rt=[];for(let it=0;it<=_e;it++)rt.push(this.getPoint(it/_e));return this.autoClose&&rt.push(rt[0]),rt}getPoints(_e=12){const rt=[];let it;for(let nt=0,st=this.curves;nt<st.length;nt++){const at=st[nt],lt=at.isEllipseCurve?_e*2:at.isLineCurve||at.isLineCurve3?1:at.isSplineCurve?_e*at.points.length:_e,ot=at.getPoints(lt);for(let ct=0;ct<ot.length;ct++){const ut=ot[ct];it&&it.equals(ut)||(rt.push(ut),it=ut)}}return this.autoClose&&rt.length>1&&!rt[rt.length-1].equals(rt[0])&&rt.push(rt[0]),rt}copy(_e){super.copy(_e),this.curves=[];for(let rt=0,it=_e.curves.length;rt<it;rt++){const nt=_e.curves[rt];this.curves.push(nt.clone())}return this.autoClose=_e.autoClose,this}toJSON(){const _e=super.toJSON();_e.autoClose=this.autoClose,_e.curves=[];for(let rt=0,it=this.curves.length;rt<it;rt++){const nt=this.curves[rt];_e.curves.push(nt.toJSON())}return _e}fromJSON(_e){super.fromJSON(_e),this.autoClose=_e.autoClose,this.curves=[];for(let rt=0,it=_e.curves.length;rt<it;rt++){const nt=_e.curves[rt];this.curves.push(new Curves[nt.type]().fromJSON(nt))}return this}}let Path$1=class extends CurvePath{constructor(_e){super(),this.type="Path",this.currentPoint=new Vector2,_e&&this.setFromPoints(_e)}setFromPoints(_e){this.moveTo(_e[0].x,_e[0].y);for(let rt=1,it=_e.length;rt<it;rt++)this.lineTo(_e[rt].x,_e[rt].y);return this}moveTo(_e,rt){return this.currentPoint.set(_e,rt),this}lineTo(_e,rt){const it=new LineCurve(this.currentPoint.clone(),new Vector2(_e,rt));return this.curves.push(it),this.currentPoint.set(_e,rt),this}quadraticCurveTo(_e,rt,it,nt){const st=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(_e,rt),new Vector2(it,nt));return this.curves.push(st),this.currentPoint.set(it,nt),this}bezierCurveTo(_e,rt,it,nt,st,at){const lt=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(_e,rt),new Vector2(it,nt),new Vector2(st,at));return this.curves.push(lt),this.currentPoint.set(st,at),this}splineThru(_e){const rt=[this.currentPoint.clone()].concat(_e),it=new SplineCurve(rt);return this.curves.push(it),this.currentPoint.copy(_e[_e.length-1]),this}arc(_e,rt,it,nt,st,at){const lt=this.currentPoint.x,ot=this.currentPoint.y;return this.absarc(_e+lt,rt+ot,it,nt,st,at),this}absarc(_e,rt,it,nt,st,at){return this.absellipse(_e,rt,it,it,nt,st,at),this}ellipse(_e,rt,it,nt,st,at,lt,ot){const ct=this.currentPoint.x,ut=this.currentPoint.y;return this.absellipse(_e+ct,rt+ut,it,nt,st,at,lt,ot),this}absellipse(_e,rt,it,nt,st,at,lt,ot){const ct=new EllipseCurve(_e,rt,it,nt,st,at,lt,ot);if(this.curves.length>0){const ht=ct.getPoint(0);ht.equals(this.currentPoint)||this.lineTo(ht.x,ht.y)}this.curves.push(ct);const ut=ct.getPoint(1);return this.currentPoint.copy(ut),this}copy(_e){return super.copy(_e),this.currentPoint.copy(_e.currentPoint),this}toJSON(){const _e=super.toJSON();return _e.currentPoint=this.currentPoint.toArray(),_e}fromJSON(_e){return super.fromJSON(_e),this.currentPoint.fromArray(_e.currentPoint),this}};class LatheGeometry extends BufferGeometry{constructor(_e=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],rt=12,it=0,nt=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:_e,segments:rt,phiStart:it,phiLength:nt},rt=Math.floor(rt),nt=clamp$2(nt,0,Math.PI*2);const st=[],at=[],lt=[],ot=[],ct=[],ut=1/rt,ht=new Vector3,dt=new Vector2,pt=new Vector3,ft=new Vector3,gt=new Vector3;let mt=0,At=0;for(let yt=0;yt<=_e.length-1;yt++)switch(yt){case 0:mt=_e[yt+1].x-_e[yt].x,At=_e[yt+1].y-_e[yt].y,pt.x=At*1,pt.y=-mt,pt.z=At*0,gt.copy(pt),pt.normalize(),ot.push(pt.x,pt.y,pt.z);break;case _e.length-1:ot.push(gt.x,gt.y,gt.z);break;default:mt=_e[yt+1].x-_e[yt].x,At=_e[yt+1].y-_e[yt].y,pt.x=At*1,pt.y=-mt,pt.z=At*0,ft.copy(pt),pt.x+=gt.x,pt.y+=gt.y,pt.z+=gt.z,pt.normalize(),ot.push(pt.x,pt.y,pt.z),gt.copy(ft)}for(let yt=0;yt<=rt;yt++){const bt=it+yt*ut*nt,xt=Math.sin(bt),vt=Math.cos(bt);for(let _t=0;_t<=_e.length-1;_t++){ht.x=_e[_t].x*xt,ht.y=_e[_t].y,ht.z=_e[_t].x*vt,at.push(ht.x,ht.y,ht.z),dt.x=yt/rt,dt.y=_t/(_e.length-1),lt.push(dt.x,dt.y);const Ct=ot[3*_t+0]*xt,St=ot[3*_t+1],Et=ot[3*_t+0]*vt;ct.push(Ct,St,Et)}}for(let yt=0;yt<rt;yt++)for(let bt=0;bt<_e.length-1;bt++){const xt=bt+yt*_e.length,vt=xt,_t=xt+_e.length,Ct=xt+_e.length+1,St=xt+1;st.push(vt,_t,St),st.push(Ct,St,_t)}this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute(at,3)),this.setAttribute("uv",new Float32BufferAttribute(lt,2)),this.setAttribute("normal",new Float32BufferAttribute(ct,3))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new LatheGeometry(_e.points,_e.segments,_e.phiStart,_e.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(_e=1,rt=1,it=4,nt=8){const st=new Path$1;st.absarc(0,-rt/2,_e,Math.PI*1.5,0),st.absarc(0,rt/2,_e,0,Math.PI*.5),super(st.getPoints(it),nt),this.type="CapsuleGeometry",this.parameters={radius:_e,height:rt,capSegments:it,radialSegments:nt}}static fromJSON(_e){return new CapsuleGeometry(_e.radius,_e.length,_e.capSegments,_e.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(_e=1,rt=32,it=0,nt=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:_e,segments:rt,thetaStart:it,thetaLength:nt},rt=Math.max(3,rt);const st=[],at=[],lt=[],ot=[],ct=new Vector3,ut=new Vector2;at.push(0,0,0),lt.push(0,0,1),ot.push(.5,.5);for(let ht=0,dt=3;ht<=rt;ht++,dt+=3){const pt=it+ht/rt*nt;ct.x=_e*Math.cos(pt),ct.y=_e*Math.sin(pt),at.push(ct.x,ct.y,ct.z),lt.push(0,0,1),ut.x=(at[dt]/_e+1)/2,ut.y=(at[dt+1]/_e+1)/2,ot.push(ut.x,ut.y)}for(let ht=1;ht<=rt;ht++)st.push(ht,ht+1,0);this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute(at,3)),this.setAttribute("normal",new Float32BufferAttribute(lt,3)),this.setAttribute("uv",new Float32BufferAttribute(ot,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new CircleGeometry(_e.radius,_e.segments,_e.thetaStart,_e.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(_e=1,rt=1,it=1,nt=32,st=1,at=!1,lt=0,ot=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_e,radiusBottom:rt,height:it,radialSegments:nt,heightSegments:st,openEnded:at,thetaStart:lt,thetaLength:ot};const ct=this;nt=Math.floor(nt),st=Math.floor(st);const ut=[],ht=[],dt=[],pt=[];let ft=0;const gt=[],mt=it/2;let At=0;yt(),at===!1&&(_e>0&&bt(!0),rt>0&&bt(!1)),this.setIndex(ut),this.setAttribute("position",new Float32BufferAttribute(ht,3)),this.setAttribute("normal",new Float32BufferAttribute(dt,3)),this.setAttribute("uv",new Float32BufferAttribute(pt,2));function yt(){const xt=new Vector3,vt=new Vector3;let _t=0;const Ct=(rt-_e)/it;for(let St=0;St<=st;St++){const Et=[],Tt=St/st,Mt=Tt*(rt-_e)+_e;for(let Rt=0;Rt<=nt;Rt++){const It=Rt/nt,Ot=It*ot+lt,Bt=Math.sin(Ot),Nt=Math.cos(Ot);vt.x=Mt*Bt,vt.y=-Tt*it+mt,vt.z=Mt*Nt,ht.push(vt.x,vt.y,vt.z),xt.set(Bt,Ct,Nt).normalize(),dt.push(xt.x,xt.y,xt.z),pt.push(It,1-Tt),Et.push(ft++)}gt.push(Et)}for(let St=0;St<nt;St++)for(let Et=0;Et<st;Et++){const Tt=gt[Et][St],Mt=gt[Et+1][St],Rt=gt[Et+1][St+1],It=gt[Et][St+1];ut.push(Tt,Mt,It),ut.push(Mt,Rt,It),_t+=6}ct.addGroup(At,_t,0),At+=_t}function bt(xt){const vt=ft,_t=new Vector2,Ct=new Vector3;let St=0;const Et=xt===!0?_e:rt,Tt=xt===!0?1:-1;for(let Rt=1;Rt<=nt;Rt++)ht.push(0,mt*Tt,0),dt.push(0,Tt,0),pt.push(.5,.5),ft++;const Mt=ft;for(let Rt=0;Rt<=nt;Rt++){const Ot=Rt/nt*ot+lt,Bt=Math.cos(Ot),Nt=Math.sin(Ot);Ct.x=Et*Nt,Ct.y=mt*Tt,Ct.z=Et*Bt,ht.push(Ct.x,Ct.y,Ct.z),dt.push(0,Tt,0),_t.x=Bt*.5+.5,_t.y=Nt*.5*Tt+.5,pt.push(_t.x,_t.y),ft++}for(let Rt=0;Rt<nt;Rt++){const It=vt+Rt,Ot=Mt+Rt;xt===!0?ut.push(Ot,Ot+1,It):ut.push(Ot+1,Ot,It),St+=3}ct.addGroup(At,St,xt===!0?1:2),At+=St}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new CylinderGeometry(_e.radiusTop,_e.radiusBottom,_e.height,_e.radialSegments,_e.heightSegments,_e.openEnded,_e.thetaStart,_e.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(_e=1,rt=1,it=32,nt=1,st=!1,at=0,lt=Math.PI*2){super(0,_e,rt,it,nt,st,at,lt),this.type="ConeGeometry",this.parameters={radius:_e,height:rt,radialSegments:it,heightSegments:nt,openEnded:st,thetaStart:at,thetaLength:lt}}static fromJSON(_e){return new ConeGeometry(_e.radius,_e.height,_e.radialSegments,_e.heightSegments,_e.openEnded,_e.thetaStart,_e.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(_e=[],rt=[],it=1,nt=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_e,indices:rt,radius:it,detail:nt};const st=[],at=[];lt(nt),ct(it),ut(),this.setAttribute("position",new Float32BufferAttribute(st,3)),this.setAttribute("normal",new Float32BufferAttribute(st.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(at,2)),nt===0?this.computeVertexNormals():this.normalizeNormals();function lt(yt){const bt=new Vector3,xt=new Vector3,vt=new Vector3;for(let _t=0;_t<rt.length;_t+=3)pt(rt[_t+0],bt),pt(rt[_t+1],xt),pt(rt[_t+2],vt),ot(bt,xt,vt,yt)}function ot(yt,bt,xt,vt){const _t=vt+1,Ct=[];for(let St=0;St<=_t;St++){Ct[St]=[];const Et=yt.clone().lerp(xt,St/_t),Tt=bt.clone().lerp(xt,St/_t),Mt=_t-St;for(let Rt=0;Rt<=Mt;Rt++)Rt===0&&St===_t?Ct[St][Rt]=Et:Ct[St][Rt]=Et.clone().lerp(Tt,Rt/Mt)}for(let St=0;St<_t;St++)for(let Et=0;Et<2*(_t-St)-1;Et++){const Tt=Math.floor(Et/2);Et%2===0?(dt(Ct[St][Tt+1]),dt(Ct[St+1][Tt]),dt(Ct[St][Tt])):(dt(Ct[St][Tt+1]),dt(Ct[St+1][Tt+1]),dt(Ct[St+1][Tt]))}}function ct(yt){const bt=new Vector3;for(let xt=0;xt<st.length;xt+=3)bt.x=st[xt+0],bt.y=st[xt+1],bt.z=st[xt+2],bt.normalize().multiplyScalar(yt),st[xt+0]=bt.x,st[xt+1]=bt.y,st[xt+2]=bt.z}function ut(){const yt=new Vector3;for(let bt=0;bt<st.length;bt+=3){yt.x=st[bt+0],yt.y=st[bt+1],yt.z=st[bt+2];const xt=mt(yt)/2/Math.PI+.5,vt=At(yt)/Math.PI+.5;at.push(xt,1-vt)}ft(),ht()}function ht(){for(let yt=0;yt<at.length;yt+=6){const bt=at[yt+0],xt=at[yt+2],vt=at[yt+4],_t=Math.max(bt,xt,vt),Ct=Math.min(bt,xt,vt);_t>.9&&Ct<.1&&(bt<.2&&(at[yt+0]+=1),xt<.2&&(at[yt+2]+=1),vt<.2&&(at[yt+4]+=1))}}function dt(yt){st.push(yt.x,yt.y,yt.z)}function pt(yt,bt){const xt=yt*3;bt.x=_e[xt+0],bt.y=_e[xt+1],bt.z=_e[xt+2]}function ft(){const yt=new Vector3,bt=new Vector3,xt=new Vector3,vt=new Vector3,_t=new Vector2,Ct=new Vector2,St=new Vector2;for(let Et=0,Tt=0;Et<st.length;Et+=9,Tt+=6){yt.set(st[Et+0],st[Et+1],st[Et+2]),bt.set(st[Et+3],st[Et+4],st[Et+5]),xt.set(st[Et+6],st[Et+7],st[Et+8]),_t.set(at[Tt+0],at[Tt+1]),Ct.set(at[Tt+2],at[Tt+3]),St.set(at[Tt+4],at[Tt+5]),vt.copy(yt).add(bt).add(xt).divideScalar(3);const Mt=mt(vt);gt(_t,Tt+0,yt,Mt),gt(Ct,Tt+2,bt,Mt),gt(St,Tt+4,xt,Mt)}}function gt(yt,bt,xt,vt){vt<0&&yt.x===1&&(at[bt]=yt.x-1),xt.x===0&&xt.z===0&&(at[bt]=vt/2/Math.PI+.5)}function mt(yt){return Math.atan2(yt.z,-yt.x)}function At(yt){return Math.atan2(-yt.y,Math.sqrt(yt.x*yt.x+yt.z*yt.z))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new PolyhedronGeometry(_e.vertices,_e.indices,_e.radius,_e.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(_e=1,rt=0){const it=(1+Math.sqrt(5))/2,nt=1/it,st=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-nt,-it,0,-nt,it,0,nt,-it,0,nt,it,-nt,-it,0,-nt,it,0,nt,-it,0,nt,it,0,-it,0,-nt,it,0,-nt,-it,0,nt,it,0,nt],at=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(st,at,_e,rt),this.type="DodecahedronGeometry",this.parameters={radius:_e,detail:rt}}static fromJSON(_e){return new DodecahedronGeometry(_e.radius,_e.detail)}}const _v0=new Vector3,_v1$1=new Vector3,_normal=new Vector3,_triangle=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(_e=null,rt=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_e,thresholdAngle:rt},_e!==null){const nt=Math.pow(10,4),st=Math.cos(DEG2RAD*rt),at=_e.getIndex(),lt=_e.getAttribute("position"),ot=at?at.count:lt.count,ct=[0,0,0],ut=["a","b","c"],ht=new Array(3),dt={},pt=[];for(let ft=0;ft<ot;ft+=3){at?(ct[0]=at.getX(ft),ct[1]=at.getX(ft+1),ct[2]=at.getX(ft+2)):(ct[0]=ft,ct[1]=ft+1,ct[2]=ft+2);const{a:gt,b:mt,c:At}=_triangle;if(gt.fromBufferAttribute(lt,ct[0]),mt.fromBufferAttribute(lt,ct[1]),At.fromBufferAttribute(lt,ct[2]),_triangle.getNormal(_normal),ht[0]=`${Math.round(gt.x*nt)},${Math.round(gt.y*nt)},${Math.round(gt.z*nt)}`,ht[1]=`${Math.round(mt.x*nt)},${Math.round(mt.y*nt)},${Math.round(mt.z*nt)}`,ht[2]=`${Math.round(At.x*nt)},${Math.round(At.y*nt)},${Math.round(At.z*nt)}`,!(ht[0]===ht[1]||ht[1]===ht[2]||ht[2]===ht[0]))for(let yt=0;yt<3;yt++){const bt=(yt+1)%3,xt=ht[yt],vt=ht[bt],_t=_triangle[ut[yt]],Ct=_triangle[ut[bt]],St=`${xt}_${vt}`,Et=`${vt}_${xt}`;Et in dt&&dt[Et]?(_normal.dot(dt[Et].normal)<=st&&(pt.push(_t.x,_t.y,_t.z),pt.push(Ct.x,Ct.y,Ct.z)),dt[Et]=null):St in dt||(dt[St]={index0:ct[yt],index1:ct[bt],normal:_normal.clone()})}}for(const ft in dt)if(dt[ft]){const{index0:gt,index1:mt}=dt[ft];_v0.fromBufferAttribute(lt,gt),_v1$1.fromBufferAttribute(lt,mt),pt.push(_v0.x,_v0.y,_v0.z),pt.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute(pt,3))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}}class Shape extends Path$1{constructor(_e){super(_e),this.uuid=generateUUID$1(),this.type="Shape",this.holes=[]}getPointsHoles(_e){const rt=[];for(let it=0,nt=this.holes.length;it<nt;it++)rt[it]=this.holes[it].getPoints(_e);return rt}extractPoints(_e){return{shape:this.getPoints(_e),holes:this.getPointsHoles(_e)}}copy(_e){super.copy(_e),this.holes=[];for(let rt=0,it=_e.holes.length;rt<it;rt++){const nt=_e.holes[rt];this.holes.push(nt.clone())}return this}toJSON(){const _e=super.toJSON();_e.uuid=this.uuid,_e.holes=[];for(let rt=0,it=this.holes.length;rt<it;rt++){const nt=this.holes[rt];_e.holes.push(nt.toJSON())}return _e}fromJSON(_e){super.fromJSON(_e),this.uuid=_e.uuid,this.holes=[];for(let rt=0,it=_e.holes.length;rt<it;rt++){const nt=_e.holes[rt];this.holes.push(new Path$1().fromJSON(nt))}return this}}const Earcut={triangulate:function(tt,_e,rt=2){const it=_e&&_e.length,nt=it?_e[0]*rt:tt.length;let st=linkedList(tt,0,nt,rt,!0);const at=[];if(!st||st.next===st.prev)return at;let lt,ot,ct,ut,ht,dt,pt;if(it&&(st=eliminateHoles(tt,_e,st,rt)),tt.length>80*rt){lt=ct=tt[0],ot=ut=tt[1];for(let ft=rt;ft<nt;ft+=rt)ht=tt[ft],dt=tt[ft+1],ht<lt&&(lt=ht),dt<ot&&(ot=dt),ht>ct&&(ct=ht),dt>ut&&(ut=dt);pt=Math.max(ct-lt,ut-ot),pt=pt!==0?32767/pt:0}return earcutLinked(st,at,rt,lt,ot,pt,0),at}};function linkedList(tt,_e,rt,it,nt){let st,at;if(nt===signedArea(tt,_e,rt,it)>0)for(st=_e;st<rt;st+=it)at=insertNode(st,tt[st],tt[st+1],at);else for(st=rt-it;st>=_e;st-=it)at=insertNode(st,tt[st],tt[st+1],at);return at&&equals$1(at,at.next)&&(removeNode(at),at=at.next),at}function filterPoints(tt,_e){if(!tt)return tt;_e||(_e=tt);let rt=tt,it;do if(it=!1,!rt.steiner&&(equals$1(rt,rt.next)||area(rt.prev,rt,rt.next)===0)){if(removeNode(rt),rt=_e=rt.prev,rt===rt.next)break;it=!0}else rt=rt.next;while(it||rt!==_e);return _e}function earcutLinked(tt,_e,rt,it,nt,st,at){if(!tt)return;!at&&st&&indexCurve(tt,it,nt,st);let lt=tt,ot,ct;for(;tt.prev!==tt.next;){if(ot=tt.prev,ct=tt.next,st?isEarHashed(tt,it,nt,st):isEar(tt)){_e.push(ot.i/rt|0),_e.push(tt.i/rt|0),_e.push(ct.i/rt|0),removeNode(tt),tt=ct.next,lt=ct.next;continue}if(tt=ct,tt===lt){at?at===1?(tt=cureLocalIntersections(filterPoints(tt),_e,rt),earcutLinked(tt,_e,rt,it,nt,st,2)):at===2&&splitEarcut(tt,_e,rt,it,nt,st):earcutLinked(filterPoints(tt),_e,rt,it,nt,st,1);break}}}function isEar(tt){const _e=tt.prev,rt=tt,it=tt.next;if(area(_e,rt,it)>=0)return!1;const nt=_e.x,st=rt.x,at=it.x,lt=_e.y,ot=rt.y,ct=it.y,ut=nt<st?nt<at?nt:at:st<at?st:at,ht=lt<ot?lt<ct?lt:ct:ot<ct?ot:ct,dt=nt>st?nt>at?nt:at:st>at?st:at,pt=lt>ot?lt>ct?lt:ct:ot>ct?ot:ct;let ft=it.next;for(;ft!==_e;){if(ft.x>=ut&&ft.x<=dt&&ft.y>=ht&&ft.y<=pt&&pointInTriangle(nt,lt,st,ot,at,ct,ft.x,ft.y)&&area(ft.prev,ft,ft.next)>=0)return!1;ft=ft.next}return!0}function isEarHashed(tt,_e,rt,it){const nt=tt.prev,st=tt,at=tt.next;if(area(nt,st,at)>=0)return!1;const lt=nt.x,ot=st.x,ct=at.x,ut=nt.y,ht=st.y,dt=at.y,pt=lt<ot?lt<ct?lt:ct:ot<ct?ot:ct,ft=ut<ht?ut<dt?ut:dt:ht<dt?ht:dt,gt=lt>ot?lt>ct?lt:ct:ot>ct?ot:ct,mt=ut>ht?ut>dt?ut:dt:ht>dt?ht:dt,At=zOrder(pt,ft,_e,rt,it),yt=zOrder(gt,mt,_e,rt,it);let bt=tt.prevZ,xt=tt.nextZ;for(;bt&&bt.z>=At&&xt&&xt.z<=yt;){if(bt.x>=pt&&bt.x<=gt&&bt.y>=ft&&bt.y<=mt&&bt!==nt&&bt!==at&&pointInTriangle(lt,ut,ot,ht,ct,dt,bt.x,bt.y)&&area(bt.prev,bt,bt.next)>=0||(bt=bt.prevZ,xt.x>=pt&&xt.x<=gt&&xt.y>=ft&&xt.y<=mt&&xt!==nt&&xt!==at&&pointInTriangle(lt,ut,ot,ht,ct,dt,xt.x,xt.y)&&area(xt.prev,xt,xt.next)>=0))return!1;xt=xt.nextZ}for(;bt&&bt.z>=At;){if(bt.x>=pt&&bt.x<=gt&&bt.y>=ft&&bt.y<=mt&&bt!==nt&&bt!==at&&pointInTriangle(lt,ut,ot,ht,ct,dt,bt.x,bt.y)&&area(bt.prev,bt,bt.next)>=0)return!1;bt=bt.prevZ}for(;xt&&xt.z<=yt;){if(xt.x>=pt&&xt.x<=gt&&xt.y>=ft&&xt.y<=mt&&xt!==nt&&xt!==at&&pointInTriangle(lt,ut,ot,ht,ct,dt,xt.x,xt.y)&&area(xt.prev,xt,xt.next)>=0)return!1;xt=xt.nextZ}return!0}function cureLocalIntersections(tt,_e,rt){let it=tt;do{const nt=it.prev,st=it.next.next;!equals$1(nt,st)&&intersects(nt,it,it.next,st)&&locallyInside(nt,st)&&locallyInside(st,nt)&&(_e.push(nt.i/rt|0),_e.push(it.i/rt|0),_e.push(st.i/rt|0),removeNode(it),removeNode(it.next),it=tt=st),it=it.next}while(it!==tt);return filterPoints(it)}function splitEarcut(tt,_e,rt,it,nt,st){let at=tt;do{let lt=at.next.next;for(;lt!==at.prev;){if(at.i!==lt.i&&isValidDiagonal(at,lt)){let ot=splitPolygon(at,lt);at=filterPoints(at,at.next),ot=filterPoints(ot,ot.next),earcutLinked(at,_e,rt,it,nt,st,0),earcutLinked(ot,_e,rt,it,nt,st,0);return}lt=lt.next}at=at.next}while(at!==tt)}function eliminateHoles(tt,_e,rt,it){const nt=[];let st,at,lt,ot,ct;for(st=0,at=_e.length;st<at;st++)lt=_e[st]*it,ot=st<at-1?_e[st+1]*it:tt.length,ct=linkedList(tt,lt,ot,it,!1),ct===ct.next&&(ct.steiner=!0),nt.push(getLeftmost(ct));for(nt.sort(compareX),st=0;st<nt.length;st++)rt=eliminateHole(nt[st],rt);return rt}function compareX(tt,_e){return tt.x-_e.x}function eliminateHole(tt,_e){const rt=findHoleBridge(tt,_e);if(!rt)return _e;const it=splitPolygon(rt,tt);return filterPoints(it,it.next),filterPoints(rt,rt.next)}function findHoleBridge(tt,_e){let rt=_e,it=-1/0,nt;const st=tt.x,at=tt.y;do{if(at<=rt.y&&at>=rt.next.y&&rt.next.y!==rt.y){const dt=rt.x+(at-rt.y)*(rt.next.x-rt.x)/(rt.next.y-rt.y);if(dt<=st&&dt>it&&(it=dt,nt=rt.x<rt.next.x?rt:rt.next,dt===st))return nt}rt=rt.next}while(rt!==_e);if(!nt)return null;const lt=nt,ot=nt.x,ct=nt.y;let ut=1/0,ht;rt=nt;do st>=rt.x&&rt.x>=ot&&st!==rt.x&&pointInTriangle(at<ct?st:it,at,ot,ct,at<ct?it:st,at,rt.x,rt.y)&&(ht=Math.abs(at-rt.y)/(st-rt.x),locallyInside(rt,tt)&&(ht<ut||ht===ut&&(rt.x>nt.x||rt.x===nt.x&&sectorContainsSector(nt,rt)))&&(nt=rt,ut=ht)),rt=rt.next;while(rt!==lt);return nt}function sectorContainsSector(tt,_e){return area(tt.prev,tt,_e.prev)<0&&area(_e.next,tt,tt.next)<0}function indexCurve(tt,_e,rt,it){let nt=tt;do nt.z===0&&(nt.z=zOrder(nt.x,nt.y,_e,rt,it)),nt.prevZ=nt.prev,nt.nextZ=nt.next,nt=nt.next;while(nt!==tt);nt.prevZ.nextZ=null,nt.prevZ=null,sortLinked(nt)}function sortLinked(tt){let _e,rt,it,nt,st,at,lt,ot,ct=1;do{for(rt=tt,tt=null,st=null,at=0;rt;){for(at++,it=rt,lt=0,_e=0;_e<ct&&(lt++,it=it.nextZ,!!it);_e++);for(ot=ct;lt>0||ot>0&&it;)lt!==0&&(ot===0||!it||rt.z<=it.z)?(nt=rt,rt=rt.nextZ,lt--):(nt=it,it=it.nextZ,ot--),st?st.nextZ=nt:tt=nt,nt.prevZ=st,st=nt;rt=it}st.nextZ=null,ct*=2}while(at>1);return tt}function zOrder(tt,_e,rt,it,nt){return tt=(tt-rt)*nt|0,_e=(_e-it)*nt|0,tt=(tt|tt<<8)&16711935,tt=(tt|tt<<4)&252645135,tt=(tt|tt<<2)&858993459,tt=(tt|tt<<1)&1431655765,_e=(_e|_e<<8)&16711935,_e=(_e|_e<<4)&252645135,_e=(_e|_e<<2)&858993459,_e=(_e|_e<<1)&1431655765,tt|_e<<1}function getLeftmost(tt){let _e=tt,rt=tt;do(_e.x<rt.x||_e.x===rt.x&&_e.y<rt.y)&&(rt=_e),_e=_e.next;while(_e!==tt);return rt}function pointInTriangle(tt,_e,rt,it,nt,st,at,lt){return(nt-at)*(_e-lt)>=(tt-at)*(st-lt)&&(tt-at)*(it-lt)>=(rt-at)*(_e-lt)&&(rt-at)*(st-lt)>=(nt-at)*(it-lt)}function isValidDiagonal(tt,_e){return tt.next.i!==_e.i&&tt.prev.i!==_e.i&&!intersectsPolygon(tt,_e)&&(locallyInside(tt,_e)&&locallyInside(_e,tt)&&middleInside(tt,_e)&&(area(tt.prev,tt,_e.prev)||area(tt,_e.prev,_e))||equals$1(tt,_e)&&area(tt.prev,tt,tt.next)>0&&area(_e.prev,_e,_e.next)>0)}function area(tt,_e,rt){return(_e.y-tt.y)*(rt.x-_e.x)-(_e.x-tt.x)*(rt.y-_e.y)}function equals$1(tt,_e){return tt.x===_e.x&&tt.y===_e.y}function intersects(tt,_e,rt,it){const nt=sign(area(tt,_e,rt)),st=sign(area(tt,_e,it)),at=sign(area(rt,it,tt)),lt=sign(area(rt,it,_e));return!!(nt!==st&&at!==lt||nt===0&&onSegment(tt,rt,_e)||st===0&&onSegment(tt,it,_e)||at===0&&onSegment(rt,tt,it)||lt===0&&onSegment(rt,_e,it))}function onSegment(tt,_e,rt){return _e.x<=Math.max(tt.x,rt.x)&&_e.x>=Math.min(tt.x,rt.x)&&_e.y<=Math.max(tt.y,rt.y)&&_e.y>=Math.min(tt.y,rt.y)}function sign(tt){return tt>0?1:tt<0?-1:0}function intersectsPolygon(tt,_e){let rt=tt;do{if(rt.i!==tt.i&&rt.next.i!==tt.i&&rt.i!==_e.i&&rt.next.i!==_e.i&&intersects(rt,rt.next,tt,_e))return!0;rt=rt.next}while(rt!==tt);return!1}function locallyInside(tt,_e){return area(tt.prev,tt,tt.next)<0?area(tt,_e,tt.next)>=0&&area(tt,tt.prev,_e)>=0:area(tt,_e,tt.prev)<0||area(tt,tt.next,_e)<0}function middleInside(tt,_e){let rt=tt,it=!1;const nt=(tt.x+_e.x)/2,st=(tt.y+_e.y)/2;do rt.y>st!=rt.next.y>st&&rt.next.y!==rt.y&&nt<(rt.next.x-rt.x)*(st-rt.y)/(rt.next.y-rt.y)+rt.x&&(it=!it),rt=rt.next;while(rt!==tt);return it}function splitPolygon(tt,_e){const rt=new Node(tt.i,tt.x,tt.y),it=new Node(_e.i,_e.x,_e.y),nt=tt.next,st=_e.prev;return tt.next=_e,_e.prev=tt,rt.next=nt,nt.prev=rt,it.next=rt,rt.prev=it,st.next=it,it.prev=st,it}function insertNode(tt,_e,rt,it){const nt=new Node(tt,_e,rt);return it?(nt.next=it.next,nt.prev=it,it.next.prev=nt,it.next=nt):(nt.prev=nt,nt.next=nt),nt}function removeNode(tt){tt.next.prev=tt.prev,tt.prev.next=tt.next,tt.prevZ&&(tt.prevZ.nextZ=tt.nextZ),tt.nextZ&&(tt.nextZ.prevZ=tt.prevZ)}function Node(tt,_e,rt){this.i=tt,this.x=_e,this.y=rt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(tt,_e,rt,it){let nt=0;for(let st=_e,at=rt-it;st<rt;st+=it)nt+=(tt[at]-tt[st])*(tt[st+1]+tt[at+1]),at=st;return nt}class ShapeUtils{static area(_e){const rt=_e.length;let it=0;for(let nt=rt-1,st=0;st<rt;nt=st++)it+=_e[nt].x*_e[st].y-_e[st].x*_e[nt].y;return it*.5}static isClockWise(_e){return ShapeUtils.area(_e)<0}static triangulateShape(_e,rt){const it=[],nt=[],st=[];removeDupEndPts(_e),addContour(it,_e);let at=_e.length;rt.forEach(removeDupEndPts);for(let ot=0;ot<rt.length;ot++)nt.push(at),at+=rt[ot].length,addContour(it,rt[ot]);const lt=Earcut.triangulate(it,nt);for(let ot=0;ot<lt.length;ot+=3)st.push(lt.slice(ot,ot+3));return st}}function removeDupEndPts(tt){const _e=tt.length;_e>2&&tt[_e-1].equals(tt[0])&&tt.pop()}function addContour(tt,_e){for(let rt=0;rt<_e.length;rt++)tt.push(_e[rt].x),tt.push(_e[rt].y)}class ExtrudeGeometry extends BufferGeometry{constructor(_e=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),rt={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_e,options:rt},_e=Array.isArray(_e)?_e:[_e];const it=this,nt=[],st=[];for(let lt=0,ot=_e.length;lt<ot;lt++){const ct=_e[lt];at(ct)}this.setAttribute("position",new Float32BufferAttribute(nt,3)),this.setAttribute("uv",new Float32BufferAttribute(st,2)),this.computeVertexNormals();function at(lt){const ot=[],ct=rt.curveSegments!==void 0?rt.curveSegments:12,ut=rt.steps!==void 0?rt.steps:1,ht=rt.depth!==void 0?rt.depth:1;let dt=rt.bevelEnabled!==void 0?rt.bevelEnabled:!0,pt=rt.bevelThickness!==void 0?rt.bevelThickness:.2,ft=rt.bevelSize!==void 0?rt.bevelSize:pt-.1,gt=rt.bevelOffset!==void 0?rt.bevelOffset:0,mt=rt.bevelSegments!==void 0?rt.bevelSegments:3;const At=rt.extrudePath,yt=rt.UVGenerator!==void 0?rt.UVGenerator:WorldUVGenerator;let bt,xt=!1,vt,_t,Ct,St;At&&(bt=At.getSpacedPoints(ut),xt=!0,dt=!1,vt=At.computeFrenetFrames(ut,!1),_t=new Vector3,Ct=new Vector3,St=new Vector3),dt||(mt=0,pt=0,ft=0,gt=0);const Et=lt.extractPoints(ct);let Tt=Et.shape;const Mt=Et.holes;if(!ShapeUtils.isClockWise(Tt)){Tt=Tt.reverse();for(let Yt=0,nr=Mt.length;Yt<nr;Yt++){const mr=Mt[Yt];ShapeUtils.isClockWise(mr)&&(Mt[Yt]=mr.reverse())}}const It=ShapeUtils.triangulateShape(Tt,Mt),Ot=Tt;for(let Yt=0,nr=Mt.length;Yt<nr;Yt++){const mr=Mt[Yt];Tt=Tt.concat(mr)}function Bt(Yt,nr,mr){return nr||console.error("THREE.ExtrudeGeometry: vec does not exist"),Yt.clone().addScaledVector(nr,mr)}const Nt=Tt.length,zt=It.length;function Dt(Yt,nr,mr){let Sr,Er,Nr;const wr=Yt.x-nr.x,kr=Yt.y-nr.y,Ur=mr.x-Yt.x,Or=mr.y-Yt.y,Xr=wr*wr+kr*kr,Qt=wr*Or-kr*Ur;if(Math.abs(Qt)>Number.EPSILON){const Xt=Math.sqrt(Xr),xr=Math.sqrt(Ur*Ur+Or*Or),Lr=nr.x-kr/Xt,fr=nr.y+wr/Xt,pr=mr.x-Or/xr,Hr=mr.y+Ur/xr,hr=((pr-Lr)*Or-(Hr-fr)*Ur)/(wr*Or-kr*Ur);Sr=Lr+wr*hr-Yt.x,Er=fr+kr*hr-Yt.y;const Cr=Sr*Sr+Er*Er;if(Cr<=2)return new Vector2(Sr,Er);Nr=Math.sqrt(Cr/2)}else{let Xt=!1;wr>Number.EPSILON?Ur>Number.EPSILON&&(Xt=!0):wr<-Number.EPSILON?Ur<-Number.EPSILON&&(Xt=!0):Math.sign(kr)===Math.sign(Or)&&(Xt=!0),Xt?(Sr=-kr,Er=wr,Nr=Math.sqrt(Xr)):(Sr=wr,Er=kr,Nr=Math.sqrt(Xr/2))}return new Vector2(Sr/Nr,Er/Nr)}const Ft=[];for(let Yt=0,nr=Ot.length,mr=nr-1,Sr=Yt+1;Yt<nr;Yt++,mr++,Sr++)mr===nr&&(mr=0),Sr===nr&&(Sr=0),Ft[Yt]=Dt(Ot[Yt],Ot[mr],Ot[Sr]);const Ut=[];let $t,Vt=Ft.concat();for(let Yt=0,nr=Mt.length;Yt<nr;Yt++){const mr=Mt[Yt];$t=[];for(let Sr=0,Er=mr.length,Nr=Er-1,wr=Sr+1;Sr<Er;Sr++,Nr++,wr++)Nr===Er&&(Nr=0),wr===Er&&(wr=0),$t[Sr]=Dt(mr[Sr],mr[Nr],mr[wr]);Ut.push($t),Vt=Vt.concat($t)}for(let Yt=0;Yt<mt;Yt++){const nr=Yt/mt,mr=pt*Math.cos(nr*Math.PI/2),Sr=ft*Math.sin(nr*Math.PI/2)+gt;for(let Er=0,Nr=Ot.length;Er<Nr;Er++){const wr=Bt(Ot[Er],Ft[Er],Sr);ir(wr.x,wr.y,-mr)}for(let Er=0,Nr=Mt.length;Er<Nr;Er++){const wr=Mt[Er];$t=Ut[Er];for(let kr=0,Ur=wr.length;kr<Ur;kr++){const Or=Bt(wr[kr],$t[kr],Sr);ir(Or.x,Or.y,-mr)}}}const Zt=ft+gt;for(let Yt=0;Yt<Nt;Yt++){const nr=dt?Bt(Tt[Yt],Vt[Yt],Zt):Tt[Yt];xt?(Ct.copy(vt.normals[0]).multiplyScalar(nr.x),_t.copy(vt.binormals[0]).multiplyScalar(nr.y),St.copy(bt[0]).add(Ct).add(_t),ir(St.x,St.y,St.z)):ir(nr.x,nr.y,0)}for(let Yt=1;Yt<=ut;Yt++)for(let nr=0;nr<Nt;nr++){const mr=dt?Bt(Tt[nr],Vt[nr],Zt):Tt[nr];xt?(Ct.copy(vt.normals[Yt]).multiplyScalar(mr.x),_t.copy(vt.binormals[Yt]).multiplyScalar(mr.y),St.copy(bt[Yt]).add(Ct).add(_t),ir(St.x,St.y,St.z)):ir(mr.x,mr.y,ht/ut*Yt)}for(let Yt=mt-1;Yt>=0;Yt--){const nr=Yt/mt,mr=pt*Math.cos(nr*Math.PI/2),Sr=ft*Math.sin(nr*Math.PI/2)+gt;for(let Er=0,Nr=Ot.length;Er<Nr;Er++){const wr=Bt(Ot[Er],Ft[Er],Sr);ir(wr.x,wr.y,ht+mr)}for(let Er=0,Nr=Mt.length;Er<Nr;Er++){const wr=Mt[Er];$t=Ut[Er];for(let kr=0,Ur=wr.length;kr<Ur;kr++){const Or=Bt(wr[kr],$t[kr],Sr);xt?ir(Or.x,Or.y+bt[ut-1].y,bt[ut-1].x+mr):ir(Or.x,Or.y,ht+mr)}}}qt(),sr();function qt(){const Yt=nt.length/3;if(dt){let nr=0,mr=Nt*nr;for(let Sr=0;Sr<zt;Sr++){const Er=It[Sr];ur(Er[2]+mr,Er[1]+mr,Er[0]+mr)}nr=ut+mt*2,mr=Nt*nr;for(let Sr=0;Sr<zt;Sr++){const Er=It[Sr];ur(Er[0]+mr,Er[1]+mr,Er[2]+mr)}}else{for(let nr=0;nr<zt;nr++){const mr=It[nr];ur(mr[2],mr[1],mr[0])}for(let nr=0;nr<zt;nr++){const mr=It[nr];ur(mr[0]+Nt*ut,mr[1]+Nt*ut,mr[2]+Nt*ut)}}it.addGroup(Yt,nt.length/3-Yt,0)}function sr(){const Yt=nt.length/3;let nr=0;er(Ot,nr),nr+=Ot.length;for(let mr=0,Sr=Mt.length;mr<Sr;mr++){const Er=Mt[mr];er(Er,nr),nr+=Er.length}it.addGroup(Yt,nt.length/3-Yt,1)}function er(Yt,nr){let mr=Yt.length;for(;--mr>=0;){const Sr=mr;let Er=mr-1;Er<0&&(Er=Yt.length-1);for(let Nr=0,wr=ut+mt*2;Nr<wr;Nr++){const kr=Nt*Nr,Ur=Nt*(Nr+1),Or=nr+Sr+kr,Xr=nr+Er+kr,Qt=nr+Er+Ur,Xt=nr+Sr+Ur;ar(Or,Xr,Qt,Xt)}}}function ir(Yt,nr,mr){ot.push(Yt),ot.push(nr),ot.push(mr)}function ur(Yt,nr,mr){lr(Yt),lr(nr),lr(mr);const Sr=nt.length/3,Er=yt.generateTopUV(it,nt,Sr-3,Sr-2,Sr-1);gr(Er[0]),gr(Er[1]),gr(Er[2])}function ar(Yt,nr,mr,Sr){lr(Yt),lr(nr),lr(Sr),lr(nr),lr(mr),lr(Sr);const Er=nt.length/3,Nr=yt.generateSideWallUV(it,nt,Er-6,Er-3,Er-2,Er-1);gr(Nr[0]),gr(Nr[1]),gr(Nr[3]),gr(Nr[1]),gr(Nr[2]),gr(Nr[3])}function lr(Yt){nt.push(ot[Yt*3+0]),nt.push(ot[Yt*3+1]),nt.push(ot[Yt*3+2])}function gr(Yt){st.push(Yt.x),st.push(Yt.y)}}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON(),rt=this.parameters.shapes,it=this.parameters.options;return toJSON$1(rt,it,_e)}static fromJSON(_e,rt){const it=[];for(let st=0,at=_e.shapes.length;st<at;st++){const lt=rt[_e.shapes[st]];it.push(lt)}const nt=_e.options.extrudePath;return nt!==void 0&&(_e.options.extrudePath=new Curves[nt.type]().fromJSON(nt)),new ExtrudeGeometry(it,_e.options)}}const WorldUVGenerator={generateTopUV:function(tt,_e,rt,it,nt){const st=_e[rt*3],at=_e[rt*3+1],lt=_e[it*3],ot=_e[it*3+1],ct=_e[nt*3],ut=_e[nt*3+1];return[new Vector2(st,at),new Vector2(lt,ot),new Vector2(ct,ut)]},generateSideWallUV:function(tt,_e,rt,it,nt,st){const at=_e[rt*3],lt=_e[rt*3+1],ot=_e[rt*3+2],ct=_e[it*3],ut=_e[it*3+1],ht=_e[it*3+2],dt=_e[nt*3],pt=_e[nt*3+1],ft=_e[nt*3+2],gt=_e[st*3],mt=_e[st*3+1],At=_e[st*3+2];return Math.abs(lt-ut)<Math.abs(at-ct)?[new Vector2(at,1-ot),new Vector2(ct,1-ht),new Vector2(dt,1-ft),new Vector2(gt,1-At)]:[new Vector2(lt,1-ot),new Vector2(ut,1-ht),new Vector2(pt,1-ft),new Vector2(mt,1-At)]}};function toJSON$1(tt,_e,rt){if(rt.shapes=[],Array.isArray(tt))for(let it=0,nt=tt.length;it<nt;it++){const st=tt[it];rt.shapes.push(st.uuid)}else rt.shapes.push(tt.uuid);return rt.options=Object.assign({},_e),_e.extrudePath!==void 0&&(rt.options.extrudePath=_e.extrudePath.toJSON()),rt}class IcosahedronGeometry extends PolyhedronGeometry{constructor(_e=1,rt=0){const it=(1+Math.sqrt(5))/2,nt=[-1,it,0,1,it,0,-1,-it,0,1,-it,0,0,-1,it,0,1,it,0,-1,-it,0,1,-it,it,0,-1,it,0,1,-it,0,-1,-it,0,1],st=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(nt,st,_e,rt),this.type="IcosahedronGeometry",this.parameters={radius:_e,detail:rt}}static fromJSON(_e){return new IcosahedronGeometry(_e.radius,_e.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(_e=1,rt=0){const it=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],nt=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(it,nt,_e,rt),this.type="OctahedronGeometry",this.parameters={radius:_e,detail:rt}}static fromJSON(_e){return new OctahedronGeometry(_e.radius,_e.detail)}}class RingGeometry extends BufferGeometry{constructor(_e=.5,rt=1,it=32,nt=1,st=0,at=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:_e,outerRadius:rt,thetaSegments:it,phiSegments:nt,thetaStart:st,thetaLength:at},it=Math.max(3,it),nt=Math.max(1,nt);const lt=[],ot=[],ct=[],ut=[];let ht=_e;const dt=(rt-_e)/nt,pt=new Vector3,ft=new Vector2;for(let gt=0;gt<=nt;gt++){for(let mt=0;mt<=it;mt++){const At=st+mt/it*at;pt.x=ht*Math.cos(At),pt.y=ht*Math.sin(At),ot.push(pt.x,pt.y,pt.z),ct.push(0,0,1),ft.x=(pt.x/rt+1)/2,ft.y=(pt.y/rt+1)/2,ut.push(ft.x,ft.y)}ht+=dt}for(let gt=0;gt<nt;gt++){const mt=gt*(it+1);for(let At=0;At<it;At++){const yt=At+mt,bt=yt,xt=yt+it+1,vt=yt+it+2,_t=yt+1;lt.push(bt,xt,_t),lt.push(xt,vt,_t)}}this.setIndex(lt),this.setAttribute("position",new Float32BufferAttribute(ot,3)),this.setAttribute("normal",new Float32BufferAttribute(ct,3)),this.setAttribute("uv",new Float32BufferAttribute(ut,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new RingGeometry(_e.innerRadius,_e.outerRadius,_e.thetaSegments,_e.phiSegments,_e.thetaStart,_e.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(_e=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),rt=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_e,curveSegments:rt};const it=[],nt=[],st=[],at=[];let lt=0,ot=0;if(Array.isArray(_e)===!1)ct(_e);else for(let ut=0;ut<_e.length;ut++)ct(_e[ut]),this.addGroup(lt,ot,ut),lt+=ot,ot=0;this.setIndex(it),this.setAttribute("position",new Float32BufferAttribute(nt,3)),this.setAttribute("normal",new Float32BufferAttribute(st,3)),this.setAttribute("uv",new Float32BufferAttribute(at,2));function ct(ut){const ht=nt.length/3,dt=ut.extractPoints(rt);let pt=dt.shape;const ft=dt.holes;ShapeUtils.isClockWise(pt)===!1&&(pt=pt.reverse());for(let mt=0,At=ft.length;mt<At;mt++){const yt=ft[mt];ShapeUtils.isClockWise(yt)===!0&&(ft[mt]=yt.reverse())}const gt=ShapeUtils.triangulateShape(pt,ft);for(let mt=0,At=ft.length;mt<At;mt++){const yt=ft[mt];pt=pt.concat(yt)}for(let mt=0,At=pt.length;mt<At;mt++){const yt=pt[mt];nt.push(yt.x,yt.y,0),st.push(0,0,1),at.push(yt.x,yt.y)}for(let mt=0,At=gt.length;mt<At;mt++){const yt=gt[mt],bt=yt[0]+ht,xt=yt[1]+ht,vt=yt[2]+ht;it.push(bt,xt,vt),ot+=3}}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON(),rt=this.parameters.shapes;return toJSON(rt,_e)}static fromJSON(_e,rt){const it=[];for(let nt=0,st=_e.shapes.length;nt<st;nt++){const at=rt[_e.shapes[nt]];it.push(at)}return new ShapeGeometry(it,_e.curveSegments)}}function toJSON(tt,_e){if(_e.shapes=[],Array.isArray(tt))for(let rt=0,it=tt.length;rt<it;rt++){const nt=tt[rt];_e.shapes.push(nt.uuid)}else _e.shapes.push(tt.uuid);return _e}class SphereGeometry extends BufferGeometry{constructor(_e=1,rt=32,it=16,nt=0,st=Math.PI*2,at=0,lt=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_e,widthSegments:rt,heightSegments:it,phiStart:nt,phiLength:st,thetaStart:at,thetaLength:lt},rt=Math.max(3,Math.floor(rt)),it=Math.max(2,Math.floor(it));const ot=Math.min(at+lt,Math.PI);let ct=0;const ut=[],ht=new Vector3,dt=new Vector3,pt=[],ft=[],gt=[],mt=[];for(let At=0;At<=it;At++){const yt=[],bt=At/it;let xt=0;At===0&&at===0?xt=.5/rt:At===it&&ot===Math.PI&&(xt=-.5/rt);for(let vt=0;vt<=rt;vt++){const _t=vt/rt;ht.x=-_e*Math.cos(nt+_t*st)*Math.sin(at+bt*lt),ht.y=_e*Math.cos(at+bt*lt),ht.z=_e*Math.sin(nt+_t*st)*Math.sin(at+bt*lt),ft.push(ht.x,ht.y,ht.z),dt.copy(ht).normalize(),gt.push(dt.x,dt.y,dt.z),mt.push(_t+xt,1-bt),yt.push(ct++)}ut.push(yt)}for(let At=0;At<it;At++)for(let yt=0;yt<rt;yt++){const bt=ut[At][yt+1],xt=ut[At][yt],vt=ut[At+1][yt],_t=ut[At+1][yt+1];(At!==0||at>0)&&pt.push(bt,xt,_t),(At!==it-1||ot<Math.PI)&&pt.push(xt,vt,_t)}this.setIndex(pt),this.setAttribute("position",new Float32BufferAttribute(ft,3)),this.setAttribute("normal",new Float32BufferAttribute(gt,3)),this.setAttribute("uv",new Float32BufferAttribute(mt,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new SphereGeometry(_e.radius,_e.widthSegments,_e.heightSegments,_e.phiStart,_e.phiLength,_e.thetaStart,_e.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(_e=1,rt=0){const it=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],nt=[2,1,0,0,3,2,1,3,0,2,3,1];super(it,nt,_e,rt),this.type="TetrahedronGeometry",this.parameters={radius:_e,detail:rt}}static fromJSON(_e){return new TetrahedronGeometry(_e.radius,_e.detail)}}class TorusGeometry extends BufferGeometry{constructor(_e=1,rt=.4,it=12,nt=48,st=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:_e,tube:rt,radialSegments:it,tubularSegments:nt,arc:st},it=Math.floor(it),nt=Math.floor(nt);const at=[],lt=[],ot=[],ct=[],ut=new Vector3,ht=new Vector3,dt=new Vector3;for(let pt=0;pt<=it;pt++)for(let ft=0;ft<=nt;ft++){const gt=ft/nt*st,mt=pt/it*Math.PI*2;ht.x=(_e+rt*Math.cos(mt))*Math.cos(gt),ht.y=(_e+rt*Math.cos(mt))*Math.sin(gt),ht.z=rt*Math.sin(mt),lt.push(ht.x,ht.y,ht.z),ut.x=_e*Math.cos(gt),ut.y=_e*Math.sin(gt),dt.subVectors(ht,ut).normalize(),ot.push(dt.x,dt.y,dt.z),ct.push(ft/nt),ct.push(pt/it)}for(let pt=1;pt<=it;pt++)for(let ft=1;ft<=nt;ft++){const gt=(nt+1)*pt+ft-1,mt=(nt+1)*(pt-1)+ft-1,At=(nt+1)*(pt-1)+ft,yt=(nt+1)*pt+ft;at.push(gt,mt,yt),at.push(mt,At,yt)}this.setIndex(at),this.setAttribute("position",new Float32BufferAttribute(lt,3)),this.setAttribute("normal",new Float32BufferAttribute(ot,3)),this.setAttribute("uv",new Float32BufferAttribute(ct,2))}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new TorusGeometry(_e.radius,_e.tube,_e.radialSegments,_e.tubularSegments,_e.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(_e=1,rt=.4,it=64,nt=8,st=2,at=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_e,tube:rt,tubularSegments:it,radialSegments:nt,p:st,q:at},it=Math.floor(it),nt=Math.floor(nt);const lt=[],ot=[],ct=[],ut=[],ht=new Vector3,dt=new Vector3,pt=new Vector3,ft=new Vector3,gt=new Vector3,mt=new Vector3,At=new Vector3;for(let bt=0;bt<=it;++bt){const xt=bt/it*st*Math.PI*2;yt(xt,st,at,_e,pt),yt(xt+.01,st,at,_e,ft),mt.subVectors(ft,pt),At.addVectors(ft,pt),gt.crossVectors(mt,At),At.crossVectors(gt,mt),gt.normalize(),At.normalize();for(let vt=0;vt<=nt;++vt){const _t=vt/nt*Math.PI*2,Ct=-rt*Math.cos(_t),St=rt*Math.sin(_t);ht.x=pt.x+(Ct*At.x+St*gt.x),ht.y=pt.y+(Ct*At.y+St*gt.y),ht.z=pt.z+(Ct*At.z+St*gt.z),ot.push(ht.x,ht.y,ht.z),dt.subVectors(ht,pt).normalize(),ct.push(dt.x,dt.y,dt.z),ut.push(bt/it),ut.push(vt/nt)}}for(let bt=1;bt<=it;bt++)for(let xt=1;xt<=nt;xt++){const vt=(nt+1)*(bt-1)+(xt-1),_t=(nt+1)*bt+(xt-1),Ct=(nt+1)*bt+xt,St=(nt+1)*(bt-1)+xt;lt.push(vt,_t,St),lt.push(_t,Ct,St)}this.setIndex(lt),this.setAttribute("position",new Float32BufferAttribute(ot,3)),this.setAttribute("normal",new Float32BufferAttribute(ct,3)),this.setAttribute("uv",new Float32BufferAttribute(ut,2));function yt(bt,xt,vt,_t,Ct){const St=Math.cos(bt),Et=Math.sin(bt),Tt=vt/xt*bt,Mt=Math.cos(Tt);Ct.x=_t*(2+Mt)*.5*St,Ct.y=_t*(2+Mt)*Et*.5,Ct.z=_t*Math.sin(Tt)*.5}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}static fromJSON(_e){return new TorusKnotGeometry(_e.radius,_e.tube,_e.tubularSegments,_e.radialSegments,_e.p,_e.q)}}class TubeGeometry extends BufferGeometry{constructor(_e=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),rt=64,it=1,nt=8,st=!1){super(),this.type="TubeGeometry",this.parameters={path:_e,tubularSegments:rt,radius:it,radialSegments:nt,closed:st};const at=_e.computeFrenetFrames(rt,st);this.tangents=at.tangents,this.normals=at.normals,this.binormals=at.binormals;const lt=new Vector3,ot=new Vector3,ct=new Vector2;let ut=new Vector3;const ht=[],dt=[],pt=[],ft=[];gt(),this.setIndex(ft),this.setAttribute("position",new Float32BufferAttribute(ht,3)),this.setAttribute("normal",new Float32BufferAttribute(dt,3)),this.setAttribute("uv",new Float32BufferAttribute(pt,2));function gt(){for(let bt=0;bt<rt;bt++)mt(bt);mt(st===!1?rt:0),yt(),At()}function mt(bt){ut=_e.getPointAt(bt/rt,ut);const xt=at.normals[bt],vt=at.binormals[bt];for(let _t=0;_t<=nt;_t++){const Ct=_t/nt*Math.PI*2,St=Math.sin(Ct),Et=-Math.cos(Ct);ot.x=Et*xt.x+St*vt.x,ot.y=Et*xt.y+St*vt.y,ot.z=Et*xt.z+St*vt.z,ot.normalize(),dt.push(ot.x,ot.y,ot.z),lt.x=ut.x+it*ot.x,lt.y=ut.y+it*ot.y,lt.z=ut.z+it*ot.z,ht.push(lt.x,lt.y,lt.z)}}function At(){for(let bt=1;bt<=rt;bt++)for(let xt=1;xt<=nt;xt++){const vt=(nt+1)*(bt-1)+(xt-1),_t=(nt+1)*bt+(xt-1),Ct=(nt+1)*bt+xt,St=(nt+1)*(bt-1)+xt;ft.push(vt,_t,St),ft.push(_t,Ct,St)}}function yt(){for(let bt=0;bt<=rt;bt++)for(let xt=0;xt<=nt;xt++)ct.x=bt/rt,ct.y=xt/nt,pt.push(ct.x,ct.y)}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}toJSON(){const _e=super.toJSON();return _e.path=this.parameters.path.toJSON(),_e}static fromJSON(_e){return new TubeGeometry(new Curves[_e.path.type]().fromJSON(_e.path),_e.tubularSegments,_e.radius,_e.radialSegments,_e.closed)}}class WireframeGeometry extends BufferGeometry{constructor(_e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_e},_e!==null){const rt=[],it=new Set,nt=new Vector3,st=new Vector3;if(_e.index!==null){const at=_e.attributes.position,lt=_e.index;let ot=_e.groups;ot.length===0&&(ot=[{start:0,count:lt.count,materialIndex:0}]);for(let ct=0,ut=ot.length;ct<ut;++ct){const ht=ot[ct],dt=ht.start,pt=ht.count;for(let ft=dt,gt=dt+pt;ft<gt;ft+=3)for(let mt=0;mt<3;mt++){const At=lt.getX(ft+mt),yt=lt.getX(ft+(mt+1)%3);nt.fromBufferAttribute(at,At),st.fromBufferAttribute(at,yt),isUniqueEdge(nt,st,it)===!0&&(rt.push(nt.x,nt.y,nt.z),rt.push(st.x,st.y,st.z))}}}else{const at=_e.attributes.position;for(let lt=0,ot=at.count/3;lt<ot;lt++)for(let ct=0;ct<3;ct++){const ut=3*lt+ct,ht=3*lt+(ct+1)%3;nt.fromBufferAttribute(at,ut),st.fromBufferAttribute(at,ht),isUniqueEdge(nt,st,it)===!0&&(rt.push(nt.x,nt.y,nt.z),rt.push(st.x,st.y,st.z))}}this.setAttribute("position",new Float32BufferAttribute(rt,3))}}copy(_e){return super.copy(_e),this.parameters=Object.assign({},_e.parameters),this}}function isUniqueEdge(tt,_e,rt){const it=`${tt.x},${tt.y},${tt.z}-${_e.x},${_e.y},${_e.z}`,nt=`${_e.x},${_e.y},${_e.z}-${tt.x},${tt.y},${tt.z}`;return rt.has(it)===!0||rt.has(nt)===!0?!1:(rt.add(it),rt.add(nt),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(_e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color$1(0),this.transparent=!0,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.fog=_e.fog,this}}class RawShaderMaterial extends ShaderMaterial{constructor(_e){super(_e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(_e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color$1(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.defines={STANDARD:""},this.color.copy(_e.color),this.roughness=_e.roughness,this.metalness=_e.metalness,this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.roughnessMap=_e.roughnessMap,this.metalnessMap=_e.metalnessMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.envMapIntensity=_e.envMapIntensity,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$2(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(rt){this.ior=(1+.4*rt)/(1-.4*rt)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color$1(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color$1(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color$1(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_e)}get anisotropy(){return this._anisotropy}set anisotropy(_e){this._anisotropy>0!=_e>0&&this.version++,this._anisotropy=_e}get clearcoat(){return this._clearcoat}set clearcoat(_e){this._clearcoat>0!=_e>0&&this.version++,this._clearcoat=_e}get iridescence(){return this._iridescence}set iridescence(_e){this._iridescence>0!=_e>0&&this.version++,this._iridescence=_e}get sheen(){return this._sheen}set sheen(_e){this._sheen>0!=_e>0&&this.version++,this._sheen=_e}get transmission(){return this._transmission}set transmission(_e){this._transmission>0!=_e>0&&this.version++,this._transmission=_e}copy(_e){return super.copy(_e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_e.anisotropy,this.anisotropyRotation=_e.anisotropyRotation,this.anisotropyMap=_e.anisotropyMap,this.clearcoat=_e.clearcoat,this.clearcoatMap=_e.clearcoatMap,this.clearcoatRoughness=_e.clearcoatRoughness,this.clearcoatRoughnessMap=_e.clearcoatRoughnessMap,this.clearcoatNormalMap=_e.clearcoatNormalMap,this.clearcoatNormalScale.copy(_e.clearcoatNormalScale),this.ior=_e.ior,this.iridescence=_e.iridescence,this.iridescenceMap=_e.iridescenceMap,this.iridescenceIOR=_e.iridescenceIOR,this.iridescenceThicknessRange=[..._e.iridescenceThicknessRange],this.iridescenceThicknessMap=_e.iridescenceThicknessMap,this.sheen=_e.sheen,this.sheenColor.copy(_e.sheenColor),this.sheenColorMap=_e.sheenColorMap,this.sheenRoughness=_e.sheenRoughness,this.sheenRoughnessMap=_e.sheenRoughnessMap,this.transmission=_e.transmission,this.transmissionMap=_e.transmissionMap,this.thickness=_e.thickness,this.thicknessMap=_e.thicknessMap,this.attenuationDistance=_e.attenuationDistance,this.attenuationColor.copy(_e.attenuationColor),this.specularIntensity=_e.specularIntensity,this.specularIntensityMap=_e.specularIntensityMap,this.specularColor.copy(_e.specularColor),this.specularColorMap=_e.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(_e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color$1(16777215),this.specular=new Color$1(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.specular.copy(_e.specular),this.shininess=_e.shininess,this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshToonMaterial extends Material{constructor(_e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color$1(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.gradientMap=_e.gradientMap,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.alphaMap=_e.alphaMap,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.fog=_e.fog,this}}class MeshNormalMaterial extends Material{constructor(_e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_e)}copy(_e){return super.copy(_e),this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.flatShading=_e.flatShading,this}}class MeshLambertMaterial extends Material{constructor(_e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.color.copy(_e.color),this.map=_e.map,this.lightMap=_e.lightMap,this.lightMapIntensity=_e.lightMapIntensity,this.aoMap=_e.aoMap,this.aoMapIntensity=_e.aoMapIntensity,this.emissive.copy(_e.emissive),this.emissiveMap=_e.emissiveMap,this.emissiveIntensity=_e.emissiveIntensity,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.specularMap=_e.specularMap,this.alphaMap=_e.alphaMap,this.envMap=_e.envMap,this.combine=_e.combine,this.reflectivity=_e.reflectivity,this.refractionRatio=_e.refractionRatio,this.wireframe=_e.wireframe,this.wireframeLinewidth=_e.wireframeLinewidth,this.wireframeLinecap=_e.wireframeLinecap,this.wireframeLinejoin=_e.wireframeLinejoin,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class MeshMatcapMaterial extends Material{constructor(_e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color$1(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_e)}copy(_e){return super.copy(_e),this.defines={MATCAP:""},this.color.copy(_e.color),this.matcap=_e.matcap,this.map=_e.map,this.bumpMap=_e.bumpMap,this.bumpScale=_e.bumpScale,this.normalMap=_e.normalMap,this.normalMapType=_e.normalMapType,this.normalScale.copy(_e.normalScale),this.displacementMap=_e.displacementMap,this.displacementScale=_e.displacementScale,this.displacementBias=_e.displacementBias,this.alphaMap=_e.alphaMap,this.flatShading=_e.flatShading,this.fog=_e.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(_e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_e)}copy(_e){return super.copy(_e),this.scale=_e.scale,this.dashSize=_e.dashSize,this.gapSize=_e.gapSize,this}}function arraySlice(tt,_e,rt){return isTypedArray$2(tt)?new tt.constructor(tt.subarray(_e,rt!==void 0?rt:tt.length)):tt.slice(_e,rt)}function convertArray(tt,_e,rt){return!tt||!rt&&tt.constructor===_e?tt:typeof _e.BYTES_PER_ELEMENT=="number"?new _e(tt):Array.prototype.slice.call(tt)}function isTypedArray$2(tt){return ArrayBuffer.isView(tt)&&!(tt instanceof DataView)}function getKeyframeOrder(tt){function _e(nt,st){return tt[nt]-tt[st]}const rt=tt.length,it=new Array(rt);for(let nt=0;nt!==rt;++nt)it[nt]=nt;return it.sort(_e),it}function sortedArray(tt,_e,rt){const it=tt.length,nt=new tt.constructor(it);for(let st=0,at=0;at!==it;++st){const lt=rt[st]*_e;for(let ot=0;ot!==_e;++ot)nt[at++]=tt[lt+ot]}return nt}function flattenJSON(tt,_e,rt,it){let nt=1,st=tt[0];for(;st!==void 0&&st[it]===void 0;)st=tt[nt++];if(st===void 0)return;let at=st[it];if(at!==void 0)if(Array.isArray(at))do at=st[it],at!==void 0&&(_e.push(st.time),rt.push.apply(rt,at)),st=tt[nt++];while(st!==void 0);else if(at.toArray!==void 0)do at=st[it],at!==void 0&&(_e.push(st.time),at.toArray(rt,rt.length)),st=tt[nt++];while(st!==void 0);else do at=st[it],at!==void 0&&(_e.push(st.time),rt.push(at)),st=tt[nt++];while(st!==void 0)}function subclip(tt,_e,rt,it,nt=30){const st=tt.clone();st.name=_e;const at=[];for(let ot=0;ot<st.tracks.length;++ot){const ct=st.tracks[ot],ut=ct.getValueSize(),ht=[],dt=[];for(let pt=0;pt<ct.times.length;++pt){const ft=ct.times[pt]*nt;if(!(ft<rt||ft>=it)){ht.push(ct.times[pt]);for(let gt=0;gt<ut;++gt)dt.push(ct.values[pt*ut+gt])}}ht.length!==0&&(ct.times=convertArray(ht,ct.times.constructor),ct.values=convertArray(dt,ct.values.constructor),at.push(ct))}st.tracks=at;let lt=1/0;for(let ot=0;ot<st.tracks.length;++ot)lt>st.tracks[ot].times[0]&&(lt=st.tracks[ot].times[0]);for(let ot=0;ot<st.tracks.length;++ot)st.tracks[ot].shift(-1*lt);return st.resetDuration(),st}function makeClipAdditive(tt,_e=0,rt=tt,it=30){it<=0&&(it=30);const nt=rt.tracks.length,st=_e/it;for(let at=0;at<nt;++at){const lt=rt.tracks[at],ot=lt.ValueTypeName;if(ot==="bool"||ot==="string")continue;const ct=tt.tracks.find(function(At){return At.name===lt.name&&At.ValueTypeName===ot});if(ct===void 0)continue;let ut=0;const ht=lt.getValueSize();lt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ut=ht/3);let dt=0;const pt=ct.getValueSize();ct.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(dt=pt/3);const ft=lt.times.length-1;let gt;if(st<=lt.times[0]){const At=ut,yt=ht-ut;gt=arraySlice(lt.values,At,yt)}else if(st>=lt.times[ft]){const At=ft*ht+ut,yt=At+ht-ut;gt=arraySlice(lt.values,At,yt)}else{const At=lt.createInterpolant(),yt=ut,bt=ht-ut;At.evaluate(st),gt=arraySlice(At.resultBuffer,yt,bt)}ot==="quaternion"&&new Quaternion().fromArray(gt).normalize().conjugate().toArray(gt);const mt=ct.times.length;for(let At=0;At<mt;++At){const yt=At*pt+dt;if(ot==="quaternion")Quaternion.multiplyQuaternionsFlat(ct.values,yt,gt,0,ct.values,yt);else{const bt=pt-dt*2;for(let xt=0;xt<bt;++xt)ct.values[yt+xt]-=gt[xt]}}}return tt.blendMode=AdditiveAnimationBlendMode,tt}const AnimationUtils={arraySlice,convertArray,isTypedArray:isTypedArray$2,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(_e,rt,it,nt){this.parameterPositions=_e,this._cachedIndex=0,this.resultBuffer=nt!==void 0?nt:new rt.constructor(it),this.sampleValues=rt,this.valueSize=it,this.settings=null,this.DefaultSettings_={}}evaluate(_e){const rt=this.parameterPositions;let it=this._cachedIndex,nt=rt[it],st=rt[it-1];e:{t:{let at;r:{i:if(!(_e<nt)){for(let lt=it+2;;){if(nt===void 0){if(_e<st)break i;return it=rt.length,this._cachedIndex=it,this.copySampleValue_(it-1)}if(it===lt)break;if(st=nt,nt=rt[++it],_e<nt)break t}at=rt.length;break r}if(!(_e>=st)){const lt=rt[1];_e<lt&&(it=2,st=lt);for(let ot=it-2;;){if(st===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(it===ot)break;if(nt=st,st=rt[--it-1],_e>=st)break t}at=it,it=0;break r}break e}for(;it<at;){const lt=it+at>>>1;_e<rt[lt]?at=lt:it=lt+1}if(nt=rt[it],st=rt[it-1],st===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(nt===void 0)return it=rt.length,this._cachedIndex=it,this.copySampleValue_(it-1)}this._cachedIndex=it,this.intervalChanged_(it,st,nt)}return this.interpolate_(it,st,_e,nt)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_e){const rt=this.resultBuffer,it=this.sampleValues,nt=this.valueSize,st=_e*nt;for(let at=0;at!==nt;++at)rt[at]=it[st+at];return rt}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_e,rt,it,nt){super(_e,rt,it,nt),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_e,rt,it){const nt=this.parameterPositions;let st=_e-2,at=_e+1,lt=nt[st],ot=nt[at];if(lt===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:st=_e,lt=2*rt-it;break;case WrapAroundEnding:st=nt.length-2,lt=rt+nt[st]-nt[st+1];break;default:st=_e,lt=it}if(ot===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:at=_e,ot=2*it-rt;break;case WrapAroundEnding:at=1,ot=it+nt[1]-nt[0];break;default:at=_e-1,ot=rt}const ct=(it-rt)*.5,ut=this.valueSize;this._weightPrev=ct/(rt-lt),this._weightNext=ct/(ot-it),this._offsetPrev=st*ut,this._offsetNext=at*ut}interpolate_(_e,rt,it,nt){const st=this.resultBuffer,at=this.sampleValues,lt=this.valueSize,ot=_e*lt,ct=ot-lt,ut=this._offsetPrev,ht=this._offsetNext,dt=this._weightPrev,pt=this._weightNext,ft=(it-rt)/(nt-rt),gt=ft*ft,mt=gt*ft,At=-dt*mt+2*dt*gt-dt*ft,yt=(1+dt)*mt+(-1.5-2*dt)*gt+(-.5+dt)*ft+1,bt=(-1-pt)*mt+(1.5+pt)*gt+.5*ft,xt=pt*mt-pt*gt;for(let vt=0;vt!==lt;++vt)st[vt]=At*at[ut+vt]+yt*at[ct+vt]+bt*at[ot+vt]+xt*at[ht+vt];return st}}class LinearInterpolant extends Interpolant{constructor(_e,rt,it,nt){super(_e,rt,it,nt)}interpolate_(_e,rt,it,nt){const st=this.resultBuffer,at=this.sampleValues,lt=this.valueSize,ot=_e*lt,ct=ot-lt,ut=(it-rt)/(nt-rt),ht=1-ut;for(let dt=0;dt!==lt;++dt)st[dt]=at[ct+dt]*ht+at[ot+dt]*ut;return st}}class DiscreteInterpolant extends Interpolant{constructor(_e,rt,it,nt){super(_e,rt,it,nt)}interpolate_(_e){return this.copySampleValue_(_e-1)}}class KeyframeTrack{constructor(_e,rt,it,nt){if(_e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(rt===void 0||rt.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_e);this.name=_e,this.times=convertArray(rt,this.TimeBufferType),this.values=convertArray(it,this.ValueBufferType),this.setInterpolation(nt||this.DefaultInterpolation)}static toJSON(_e){const rt=_e.constructor;let it;if(rt.toJSON!==this.toJSON)it=rt.toJSON(_e);else{it={name:_e.name,times:convertArray(_e.times,Array),values:convertArray(_e.values,Array)};const nt=_e.getInterpolation();nt!==_e.DefaultInterpolation&&(it.interpolation=nt)}return it.type=_e.ValueTypeName,it}InterpolantFactoryMethodDiscrete(_e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_e)}InterpolantFactoryMethodLinear(_e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_e)}InterpolantFactoryMethodSmooth(_e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_e)}setInterpolation(_e){let rt;switch(_e){case InterpolateDiscrete:rt=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:rt=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:rt=this.InterpolantFactoryMethodSmooth;break}if(rt===void 0){const it="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(it);return console.warn("THREE.KeyframeTrack:",it),this}return this.createInterpolant=rt,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_e){if(_e!==0){const rt=this.times;for(let it=0,nt=rt.length;it!==nt;++it)rt[it]+=_e}return this}scale(_e){if(_e!==1){const rt=this.times;for(let it=0,nt=rt.length;it!==nt;++it)rt[it]*=_e}return this}trim(_e,rt){const it=this.times,nt=it.length;let st=0,at=nt-1;for(;st!==nt&&it[st]<_e;)++st;for(;at!==-1&&it[at]>rt;)--at;if(++at,st!==0||at!==nt){st>=at&&(at=Math.max(at,1),st=at-1);const lt=this.getValueSize();this.times=arraySlice(it,st,at),this.values=arraySlice(this.values,st*lt,at*lt)}return this}validate(){let _e=!0;const rt=this.getValueSize();rt-Math.floor(rt)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_e=!1);const it=this.times,nt=this.values,st=it.length;st===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_e=!1);let at=null;for(let lt=0;lt!==st;lt++){const ot=it[lt];if(typeof ot=="number"&&isNaN(ot)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,lt,ot),_e=!1;break}if(at!==null&&at>ot){console.error("THREE.KeyframeTrack: Out of order keys.",this,lt,ot,at),_e=!1;break}at=ot}if(nt!==void 0&&isTypedArray$2(nt))for(let lt=0,ot=nt.length;lt!==ot;++lt){const ct=nt[lt];if(isNaN(ct)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,lt,ct),_e=!1;break}}return _e}optimize(){const _e=arraySlice(this.times),rt=arraySlice(this.values),it=this.getValueSize(),nt=this.getInterpolation()===InterpolateSmooth,st=_e.length-1;let at=1;for(let lt=1;lt<st;++lt){let ot=!1;const ct=_e[lt],ut=_e[lt+1];if(ct!==ut&&(lt!==1||ct!==_e[0]))if(nt)ot=!0;else{const ht=lt*it,dt=ht-it,pt=ht+it;for(let ft=0;ft!==it;++ft){const gt=rt[ht+ft];if(gt!==rt[dt+ft]||gt!==rt[pt+ft]){ot=!0;break}}}if(ot){if(lt!==at){_e[at]=_e[lt];const ht=lt*it,dt=at*it;for(let pt=0;pt!==it;++pt)rt[dt+pt]=rt[ht+pt]}++at}}if(st>0){_e[at]=_e[st];for(let lt=st*it,ot=at*it,ct=0;ct!==it;++ct)rt[ot+ct]=rt[lt+ct];++at}return at!==_e.length?(this.times=arraySlice(_e,0,at),this.values=arraySlice(rt,0,at*it)):(this.times=_e,this.values=rt),this}clone(){const _e=arraySlice(this.times,0),rt=arraySlice(this.values,0),it=this.constructor,nt=new it(this.name,_e,rt);return nt.createInterpolant=this.createInterpolant,nt}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_e,rt,it,nt){super(_e,rt,it,nt)}interpolate_(_e,rt,it,nt){const st=this.resultBuffer,at=this.sampleValues,lt=this.valueSize,ot=(it-rt)/(nt-rt);let ct=_e*lt;for(let ut=ct+lt;ct!==ut;ct+=4)Quaternion.slerpFlat(st,0,at,ct-lt,at,ct,ot);return st}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(_e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_e)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_e,rt=-1,it,nt=NormalAnimationBlendMode){this.name=_e,this.tracks=it,this.duration=rt,this.blendMode=nt,this.uuid=generateUUID$1(),this.duration<0&&this.resetDuration()}static parse(_e){const rt=[],it=_e.tracks,nt=1/(_e.fps||1);for(let at=0,lt=it.length;at!==lt;++at)rt.push(parseKeyframeTrack(it[at]).scale(nt));const st=new this(_e.name,_e.duration,rt,_e.blendMode);return st.uuid=_e.uuid,st}static toJSON(_e){const rt=[],it=_e.tracks,nt={name:_e.name,duration:_e.duration,tracks:rt,uuid:_e.uuid,blendMode:_e.blendMode};for(let st=0,at=it.length;st!==at;++st)rt.push(KeyframeTrack.toJSON(it[st]));return nt}static CreateFromMorphTargetSequence(_e,rt,it,nt){const st=rt.length,at=[];for(let lt=0;lt<st;lt++){let ot=[],ct=[];ot.push((lt+st-1)%st,lt,(lt+1)%st),ct.push(0,1,0);const ut=getKeyframeOrder(ot);ot=sortedArray(ot,1,ut),ct=sortedArray(ct,1,ut),!nt&&ot[0]===0&&(ot.push(st),ct.push(ct[0])),at.push(new NumberKeyframeTrack(".morphTargetInfluences["+rt[lt].name+"]",ot,ct).scale(1/it))}return new this(_e,-1,at)}static findByName(_e,rt){let it=_e;if(!Array.isArray(_e)){const nt=_e;it=nt.geometry&&nt.geometry.animations||nt.animations}for(let nt=0;nt<it.length;nt++)if(it[nt].name===rt)return it[nt];return null}static CreateClipsFromMorphTargetSequences(_e,rt,it){const nt={},st=/^([\w-]*?)([\d]+)$/;for(let lt=0,ot=_e.length;lt<ot;lt++){const ct=_e[lt],ut=ct.name.match(st);if(ut&&ut.length>1){const ht=ut[1];let dt=nt[ht];dt||(nt[ht]=dt=[]),dt.push(ct)}}const at=[];for(const lt in nt)at.push(this.CreateFromMorphTargetSequence(lt,nt[lt],rt,it));return at}static parseAnimation(_e,rt){if(!_e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const it=function(ht,dt,pt,ft,gt){if(pt.length!==0){const mt=[],At=[];flattenJSON(pt,mt,At,ft),mt.length!==0&&gt.push(new ht(dt,mt,At))}},nt=[],st=_e.name||"default",at=_e.fps||30,lt=_e.blendMode;let ot=_e.length||-1;const ct=_e.hierarchy||[];for(let ht=0;ht<ct.length;ht++){const dt=ct[ht].keys;if(!(!dt||dt.length===0))if(dt[0].morphTargets){const pt={};let ft;for(ft=0;ft<dt.length;ft++)if(dt[ft].morphTargets)for(let gt=0;gt<dt[ft].morphTargets.length;gt++)pt[dt[ft].morphTargets[gt]]=-1;for(const gt in pt){const mt=[],At=[];for(let yt=0;yt!==dt[ft].morphTargets.length;++yt){const bt=dt[ft];mt.push(bt.time),At.push(bt.morphTarget===gt?1:0)}nt.push(new NumberKeyframeTrack(".morphTargetInfluence["+gt+"]",mt,At))}ot=pt.length*at}else{const pt=".bones["+rt[ht].name+"]";it(VectorKeyframeTrack,pt+".position",dt,"pos",nt),it(QuaternionKeyframeTrack,pt+".quaternion",dt,"rot",nt),it(VectorKeyframeTrack,pt+".scale",dt,"scl",nt)}}return nt.length===0?null:new this(st,ot,nt,lt)}resetDuration(){const _e=this.tracks;let rt=0;for(let it=0,nt=_e.length;it!==nt;++it){const st=this.tracks[it];rt=Math.max(rt,st.times[st.times.length-1])}return this.duration=rt,this}trim(){for(let _e=0;_e<this.tracks.length;_e++)this.tracks[_e].trim(0,this.duration);return this}validate(){let _e=!0;for(let rt=0;rt<this.tracks.length;rt++)_e=_e&&this.tracks[rt].validate();return _e}optimize(){for(let _e=0;_e<this.tracks.length;_e++)this.tracks[_e].optimize();return this}clone(){const _e=[];for(let rt=0;rt<this.tracks.length;rt++)_e.push(this.tracks[rt].clone());return new this.constructor(this.name,this.duration,_e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(tt){switch(tt.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+tt)}function parseKeyframeTrack(tt){if(tt.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _e=getTrackTypeForValueTypeName(tt.type);if(tt.times===void 0){const rt=[],it=[];flattenJSON(tt.keys,rt,it,"value"),tt.times=rt,tt.values=it}return _e.parse!==void 0?_e.parse(tt):new _e(tt.name,tt.times,tt.values,tt.interpolation)}const Cache={enabled:!1,files:{},add:function(tt,_e){this.enabled!==!1&&(this.files[tt]=_e)},get:function(tt){if(this.enabled!==!1)return this.files[tt]},remove:function(tt){delete this.files[tt]},clear:function(){this.files={}}};class LoadingManager{constructor(_e,rt,it){const nt=this;let st=!1,at=0,lt=0,ot;const ct=[];this.onStart=void 0,this.onLoad=_e,this.onProgress=rt,this.onError=it,this.itemStart=function(ut){lt++,st===!1&&nt.onStart!==void 0&&nt.onStart(ut,at,lt),st=!0},this.itemEnd=function(ut){at++,nt.onProgress!==void 0&&nt.onProgress(ut,at,lt),at===lt&&(st=!1,nt.onLoad!==void 0&&nt.onLoad())},this.itemError=function(ut){nt.onError!==void 0&&nt.onError(ut)},this.resolveURL=function(ut){return ot?ot(ut):ut},this.setURLModifier=function(ut){return ot=ut,this},this.addHandler=function(ut,ht){return ct.push(ut,ht),this},this.removeHandler=function(ut){const ht=ct.indexOf(ut);return ht!==-1&&ct.splice(ht,2),this},this.getHandler=function(ut){for(let ht=0,dt=ct.length;ht<dt;ht+=2){const pt=ct[ht],ft=ct[ht+1];if(pt.global&&(pt.lastIndex=0),pt.test(ut))return ft}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_e){this.manager=_e!==void 0?_e:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_e,rt){const it=this;return new Promise(function(nt,st){it.load(_e,nt,rt,st)})}parse(){}setCrossOrigin(_e){return this.crossOrigin=_e,this}setWithCredentials(_e){return this.withCredentials=_e,this}setPath(_e){return this.path=_e,this}setResourcePath(_e){return this.resourcePath=_e,this}setRequestHeader(_e){return this.requestHeader=_e,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(_e,rt){super(_e),this.response=rt}}class FileLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){_e===void 0&&(_e=""),this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=Cache.get(_e);if(st!==void 0)return this.manager.itemStart(_e),setTimeout(()=>{rt&&rt(st),this.manager.itemEnd(_e)},0),st;if(loading[_e]!==void 0){loading[_e].push({onLoad:rt,onProgress:it,onError:nt});return}loading[_e]=[],loading[_e].push({onLoad:rt,onProgress:it,onError:nt});const at=new Request(_e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),lt=this.mimeType,ot=this.responseType;fetch(at).then(ct=>{if(ct.status===200||ct.status===0){if(ct.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||ct.body===void 0||ct.body.getReader===void 0)return ct;const ut=loading[_e],ht=ct.body.getReader(),dt=ct.headers.get("Content-Length")||ct.headers.get("X-File-Size"),pt=dt?parseInt(dt):0,ft=pt!==0;let gt=0;const mt=new ReadableStream({start(At){yt();function yt(){ht.read().then(({done:bt,value:xt})=>{if(bt)At.close();else{gt+=xt.byteLength;const vt=new ProgressEvent("progress",{lengthComputable:ft,loaded:gt,total:pt});for(let _t=0,Ct=ut.length;_t<Ct;_t++){const St=ut[_t];St.onProgress&&St.onProgress(vt)}At.enqueue(xt),yt()}})}}});return new Response(mt)}else throw new HttpError(`fetch for "${ct.url}" responded with ${ct.status}: ${ct.statusText}`,ct)}).then(ct=>{switch(ot){case"arraybuffer":return ct.arrayBuffer();case"blob":return ct.blob();case"document":return ct.text().then(ut=>new DOMParser().parseFromString(ut,lt));case"json":return ct.json();default:if(lt===void 0)return ct.text();{const ht=/charset="?([^;"\s]*)"?/i.exec(lt),dt=ht&&ht[1]?ht[1].toLowerCase():void 0,pt=new TextDecoder(dt);return ct.arrayBuffer().then(ft=>pt.decode(ft))}}}).then(ct=>{Cache.add(_e,ct);const ut=loading[_e];delete loading[_e];for(let ht=0,dt=ut.length;ht<dt;ht++){const pt=ut[ht];pt.onLoad&&pt.onLoad(ct)}}).catch(ct=>{const ut=loading[_e];if(ut===void 0)throw this.manager.itemError(_e),ct;delete loading[_e];for(let ht=0,dt=ut.length;ht<dt;ht++){const pt=ut[ht];pt.onError&&pt.onError(ct)}this.manager.itemError(_e)}).finally(()=>{this.manager.itemEnd(_e)}),this.manager.itemStart(_e)}setResponseType(_e){return this.responseType=_e,this}setMimeType(_e){return this.mimeType=_e,this}}class AnimationLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){const st=this,at=new FileLoader(this.manager);at.setPath(this.path),at.setRequestHeader(this.requestHeader),at.setWithCredentials(this.withCredentials),at.load(_e,function(lt){try{rt(st.parse(JSON.parse(lt)))}catch(ot){nt?nt(ot):console.error(ot),st.manager.itemError(_e)}},it,nt)}parse(_e){const rt=[];for(let it=0;it<_e.length;it++){const nt=AnimationClip.parse(_e[it]);rt.push(nt)}return rt}}class CompressedTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){const st=this,at=[],lt=new CompressedTexture,ot=new FileLoader(this.manager);ot.setPath(this.path),ot.setResponseType("arraybuffer"),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(st.withCredentials);let ct=0;function ut(ht){ot.load(_e[ht],function(dt){const pt=st.parse(dt,!0);at[ht]={width:pt.width,height:pt.height,format:pt.format,mipmaps:pt.mipmaps},ct+=1,ct===6&&(pt.mipmapCount===1&&(lt.minFilter=LinearFilter),lt.image=at,lt.format=pt.format,lt.needsUpdate=!0,rt&&rt(lt))},it,nt)}if(Array.isArray(_e))for(let ht=0,dt=_e.length;ht<dt;++ht)ut(ht);else ot.load(_e,function(ht){const dt=st.parse(ht,!0);if(dt.isCubemap){const pt=dt.mipmaps.length/dt.mipmapCount;for(let ft=0;ft<pt;ft++){at[ft]={mipmaps:[]};for(let gt=0;gt<dt.mipmapCount;gt++)at[ft].mipmaps.push(dt.mipmaps[ft*dt.mipmapCount+gt]),at[ft].format=dt.format,at[ft].width=dt.width,at[ft].height=dt.height}lt.image=at}else lt.image.width=dt.width,lt.image.height=dt.height,lt.mipmaps=dt.mipmaps;dt.mipmapCount===1&&(lt.minFilter=LinearFilter),lt.format=dt.format,lt.needsUpdate=!0,rt&&rt(lt)},it,nt);return lt}}class ImageLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=this,at=Cache.get(_e);if(at!==void 0)return st.manager.itemStart(_e),setTimeout(function(){rt&&rt(at),st.manager.itemEnd(_e)},0),at;const lt=createElementNS("img");function ot(){ut(),Cache.add(_e,this),rt&&rt(this),st.manager.itemEnd(_e)}function ct(ht){ut(),nt&&nt(ht),st.manager.itemError(_e),st.manager.itemEnd(_e)}function ut(){lt.removeEventListener("load",ot,!1),lt.removeEventListener("error",ct,!1)}return lt.addEventListener("load",ot,!1),lt.addEventListener("error",ct,!1),_e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(lt.crossOrigin=this.crossOrigin),st.manager.itemStart(_e),lt.src=_e,lt}}class CubeTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){const st=new CubeTexture;st.colorSpace=SRGBColorSpace;const at=new ImageLoader(this.manager);at.setCrossOrigin(this.crossOrigin),at.setPath(this.path);let lt=0;function ot(ct){at.load(_e[ct],function(ut){st.images[ct]=ut,lt++,lt===6&&(st.needsUpdate=!0,rt&&rt(st))},void 0,nt)}for(let ct=0;ct<_e.length;++ct)ot(ct);return st}}class DataTextureLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){const st=this,at=new DataTexture,lt=new FileLoader(this.manager);return lt.setResponseType("arraybuffer"),lt.setRequestHeader(this.requestHeader),lt.setPath(this.path),lt.setWithCredentials(st.withCredentials),lt.load(_e,function(ot){const ct=st.parse(ot);ct&&(ct.image!==void 0?at.image=ct.image:ct.data!==void 0&&(at.image.width=ct.width,at.image.height=ct.height,at.image.data=ct.data),at.wrapS=ct.wrapS!==void 0?ct.wrapS:ClampToEdgeWrapping,at.wrapT=ct.wrapT!==void 0?ct.wrapT:ClampToEdgeWrapping,at.magFilter=ct.magFilter!==void 0?ct.magFilter:LinearFilter,at.minFilter=ct.minFilter!==void 0?ct.minFilter:LinearFilter,at.anisotropy=ct.anisotropy!==void 0?ct.anisotropy:1,ct.colorSpace!==void 0?at.colorSpace=ct.colorSpace:ct.encoding!==void 0&&(at.encoding=ct.encoding),ct.flipY!==void 0&&(at.flipY=ct.flipY),ct.format!==void 0&&(at.format=ct.format),ct.type!==void 0&&(at.type=ct.type),ct.mipmaps!==void 0&&(at.mipmaps=ct.mipmaps,at.minFilter=LinearMipmapLinearFilter),ct.mipmapCount===1&&(at.minFilter=LinearFilter),ct.generateMipmaps!==void 0&&(at.generateMipmaps=ct.generateMipmaps),at.needsUpdate=!0,rt&&rt(at,ct))},it,nt),at}}class TextureLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){const st=new Texture,at=new ImageLoader(this.manager);return at.setCrossOrigin(this.crossOrigin),at.setPath(this.path),at.load(_e,function(lt){st.image=lt,st.needsUpdate=!0,rt!==void 0&&rt(st)},it,nt),st}}class Light extends Object3D{constructor(_e,rt=1){super(),this.isLight=!0,this.type="Light",this.color=new Color$1(_e),this.intensity=rt}dispose(){}copy(_e,rt){return super.copy(_e,rt),this.color.copy(_e.color),this.intensity=_e.intensity,this}toJSON(_e){const rt=super.toJSON(_e);return rt.object.color=this.color.getHex(),rt.object.intensity=this.intensity,this.groundColor!==void 0&&(rt.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(rt.object.distance=this.distance),this.angle!==void 0&&(rt.object.angle=this.angle),this.decay!==void 0&&(rt.object.decay=this.decay),this.penumbra!==void 0&&(rt.object.penumbra=this.penumbra),this.shadow!==void 0&&(rt.object.shadow=this.shadow.toJSON()),rt}}class HemisphereLight extends Light{constructor(_e,rt,it){super(_e,it),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color$1(rt)}copy(_e,rt){return super.copy(_e,rt),this.groundColor.copy(_e.groundColor),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_e){this.camera=_e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_e){const rt=this.camera,it=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_e.matrixWorld),rt.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_e.target.matrixWorld),rt.lookAt(_lookTarget$1),rt.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(rt.projectionMatrix,rt.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),it.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),it.multiply(_projScreenMatrix$1)}getViewport(_e){return this._viewports[_e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_e){return this.camera=_e.camera.clone(),this.bias=_e.bias,this.radius=_e.radius,this.mapSize.copy(_e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _e={};return this.bias!==0&&(_e.bias=this.bias),this.normalBias!==0&&(_e.normalBias=this.normalBias),this.radius!==1&&(_e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_e.mapSize=this.mapSize.toArray()),_e.camera=this.camera.toJSON(!1).object,delete _e.camera.matrix,_e}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_e){const rt=this.camera,it=RAD2DEG*2*_e.angle*this.focus,nt=this.mapSize.width/this.mapSize.height,st=_e.distance||rt.far;(it!==rt.fov||nt!==rt.aspect||st!==rt.far)&&(rt.fov=it,rt.aspect=nt,rt.far=st,rt.updateProjectionMatrix()),super.updateMatrices(_e)}copy(_e){return super.copy(_e),this.focus=_e.focus,this}}class SpotLight extends Light{constructor(_e,rt,it=0,nt=Math.PI/3,st=0,at=2){super(_e,rt),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=it,this.angle=nt,this.penumbra=st,this.decay=at,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(_e){this.intensity=_e/Math.PI}dispose(){this.shadow.dispose()}copy(_e,rt){return super.copy(_e,rt),this.distance=_e.distance,this.angle=_e.angle,this.penumbra=_e.penumbra,this.decay=_e.decay,this.target=_e.target.clone(),this.shadow=_e.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_e,rt=0){const it=this.camera,nt=this.matrix,st=_e.distance||it.far;st!==it.far&&(it.far=st,it.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_e.matrixWorld),it.position.copy(_lightPositionWorld),_lookTarget.copy(it.position),_lookTarget.add(this._cubeDirections[rt]),it.up.copy(this._cubeUps[rt]),it.lookAt(_lookTarget),it.updateMatrixWorld(),nt.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(it.projectionMatrix,it.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(_e,rt,it=0,nt=2){super(_e,rt),this.isPointLight=!0,this.type="PointLight",this.distance=it,this.decay=nt,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_e){this.intensity=_e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_e,rt){return super.copy(_e,rt),this.distance=_e.distance,this.decay=_e.decay,this.shadow=_e.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(_e,rt){super(_e,rt),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_e){return super.copy(_e),this.target=_e.target.clone(),this.shadow=_e.shadow.clone(),this}}class AmbientLight extends Light{constructor(_e,rt){super(_e,rt),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(_e,rt,it=10,nt=10){super(_e,rt),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=it,this.height=nt}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_e){this.intensity=_e/(this.width*this.height*Math.PI)}copy(_e){return super.copy(_e),this.width=_e.width,this.height=_e.height,this}toJSON(_e){const rt=super.toJSON(_e);return rt.object.width=this.width,rt.object.height=this.height,rt}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _e=0;_e<9;_e++)this.coefficients.push(new Vector3)}set(_e){for(let rt=0;rt<9;rt++)this.coefficients[rt].copy(_e[rt]);return this}zero(){for(let _e=0;_e<9;_e++)this.coefficients[_e].set(0,0,0);return this}getAt(_e,rt){const it=_e.x,nt=_e.y,st=_e.z,at=this.coefficients;return rt.copy(at[0]).multiplyScalar(.282095),rt.addScaledVector(at[1],.488603*nt),rt.addScaledVector(at[2],.488603*st),rt.addScaledVector(at[3],.488603*it),rt.addScaledVector(at[4],1.092548*(it*nt)),rt.addScaledVector(at[5],1.092548*(nt*st)),rt.addScaledVector(at[6],.315392*(3*st*st-1)),rt.addScaledVector(at[7],1.092548*(it*st)),rt.addScaledVector(at[8],.546274*(it*it-nt*nt)),rt}getIrradianceAt(_e,rt){const it=_e.x,nt=_e.y,st=_e.z,at=this.coefficients;return rt.copy(at[0]).multiplyScalar(.886227),rt.addScaledVector(at[1],2*.511664*nt),rt.addScaledVector(at[2],2*.511664*st),rt.addScaledVector(at[3],2*.511664*it),rt.addScaledVector(at[4],2*.429043*it*nt),rt.addScaledVector(at[5],2*.429043*nt*st),rt.addScaledVector(at[6],.743125*st*st-.247708),rt.addScaledVector(at[7],2*.429043*it*st),rt.addScaledVector(at[8],.429043*(it*it-nt*nt)),rt}add(_e){for(let rt=0;rt<9;rt++)this.coefficients[rt].add(_e.coefficients[rt]);return this}addScaledSH(_e,rt){for(let it=0;it<9;it++)this.coefficients[it].addScaledVector(_e.coefficients[it],rt);return this}scale(_e){for(let rt=0;rt<9;rt++)this.coefficients[rt].multiplyScalar(_e);return this}lerp(_e,rt){for(let it=0;it<9;it++)this.coefficients[it].lerp(_e.coefficients[it],rt);return this}equals(_e){for(let rt=0;rt<9;rt++)if(!this.coefficients[rt].equals(_e.coefficients[rt]))return!1;return!0}copy(_e){return this.set(_e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_e,rt=0){const it=this.coefficients;for(let nt=0;nt<9;nt++)it[nt].fromArray(_e,rt+nt*3);return this}toArray(_e=[],rt=0){const it=this.coefficients;for(let nt=0;nt<9;nt++)it[nt].toArray(_e,rt+nt*3);return _e}static getBasisAt(_e,rt){const it=_e.x,nt=_e.y,st=_e.z;rt[0]=.282095,rt[1]=.488603*nt,rt[2]=.488603*st,rt[3]=.488603*it,rt[4]=1.092548*it*nt,rt[5]=1.092548*nt*st,rt[6]=.315392*(3*st*st-1),rt[7]=1.092548*it*st,rt[8]=.546274*(it*it-nt*nt)}}class LightProbe extends Light{constructor(_e=new SphericalHarmonics3,rt=1){super(void 0,rt),this.isLightProbe=!0,this.sh=_e}copy(_e){return super.copy(_e),this.sh.copy(_e.sh),this}fromJSON(_e){return this.intensity=_e.intensity,this.sh.fromArray(_e.sh),this}toJSON(_e){const rt=super.toJSON(_e);return rt.object.sh=this.sh.toArray(),rt}}class MaterialLoader extends Loader{constructor(_e){super(_e),this.textures={}}load(_e,rt,it,nt){const st=this,at=new FileLoader(st.manager);at.setPath(st.path),at.setRequestHeader(st.requestHeader),at.setWithCredentials(st.withCredentials),at.load(_e,function(lt){try{rt(st.parse(JSON.parse(lt)))}catch(ot){nt?nt(ot):console.error(ot),st.manager.itemError(_e)}},it,nt)}parse(_e){const rt=this.textures;function it(st){return rt[st]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",st),rt[st]}const nt=MaterialLoader.createMaterialFromType(_e.type);if(_e.uuid!==void 0&&(nt.uuid=_e.uuid),_e.name!==void 0&&(nt.name=_e.name),_e.color!==void 0&&nt.color!==void 0&&nt.color.setHex(_e.color),_e.roughness!==void 0&&(nt.roughness=_e.roughness),_e.metalness!==void 0&&(nt.metalness=_e.metalness),_e.sheen!==void 0&&(nt.sheen=_e.sheen),_e.sheenColor!==void 0&&(nt.sheenColor=new Color$1().setHex(_e.sheenColor)),_e.sheenRoughness!==void 0&&(nt.sheenRoughness=_e.sheenRoughness),_e.emissive!==void 0&&nt.emissive!==void 0&&nt.emissive.setHex(_e.emissive),_e.specular!==void 0&&nt.specular!==void 0&&nt.specular.setHex(_e.specular),_e.specularIntensity!==void 0&&(nt.specularIntensity=_e.specularIntensity),_e.specularColor!==void 0&&nt.specularColor!==void 0&&nt.specularColor.setHex(_e.specularColor),_e.shininess!==void 0&&(nt.shininess=_e.shininess),_e.clearcoat!==void 0&&(nt.clearcoat=_e.clearcoat),_e.clearcoatRoughness!==void 0&&(nt.clearcoatRoughness=_e.clearcoatRoughness),_e.iridescence!==void 0&&(nt.iridescence=_e.iridescence),_e.iridescenceIOR!==void 0&&(nt.iridescenceIOR=_e.iridescenceIOR),_e.iridescenceThicknessRange!==void 0&&(nt.iridescenceThicknessRange=_e.iridescenceThicknessRange),_e.transmission!==void 0&&(nt.transmission=_e.transmission),_e.thickness!==void 0&&(nt.thickness=_e.thickness),_e.attenuationDistance!==void 0&&(nt.attenuationDistance=_e.attenuationDistance),_e.attenuationColor!==void 0&&nt.attenuationColor!==void 0&&nt.attenuationColor.setHex(_e.attenuationColor),_e.anisotropy!==void 0&&(nt.anisotropy=_e.anisotropy),_e.anisotropyRotation!==void 0&&(nt.anisotropyRotation=_e.anisotropyRotation),_e.fog!==void 0&&(nt.fog=_e.fog),_e.flatShading!==void 0&&(nt.flatShading=_e.flatShading),_e.blending!==void 0&&(nt.blending=_e.blending),_e.combine!==void 0&&(nt.combine=_e.combine),_e.side!==void 0&&(nt.side=_e.side),_e.shadowSide!==void 0&&(nt.shadowSide=_e.shadowSide),_e.opacity!==void 0&&(nt.opacity=_e.opacity),_e.transparent!==void 0&&(nt.transparent=_e.transparent),_e.alphaTest!==void 0&&(nt.alphaTest=_e.alphaTest),_e.alphaHash!==void 0&&(nt.alphaHash=_e.alphaHash),_e.depthTest!==void 0&&(nt.depthTest=_e.depthTest),_e.depthWrite!==void 0&&(nt.depthWrite=_e.depthWrite),_e.colorWrite!==void 0&&(nt.colorWrite=_e.colorWrite),_e.stencilWrite!==void 0&&(nt.stencilWrite=_e.stencilWrite),_e.stencilWriteMask!==void 0&&(nt.stencilWriteMask=_e.stencilWriteMask),_e.stencilFunc!==void 0&&(nt.stencilFunc=_e.stencilFunc),_e.stencilRef!==void 0&&(nt.stencilRef=_e.stencilRef),_e.stencilFuncMask!==void 0&&(nt.stencilFuncMask=_e.stencilFuncMask),_e.stencilFail!==void 0&&(nt.stencilFail=_e.stencilFail),_e.stencilZFail!==void 0&&(nt.stencilZFail=_e.stencilZFail),_e.stencilZPass!==void 0&&(nt.stencilZPass=_e.stencilZPass),_e.wireframe!==void 0&&(nt.wireframe=_e.wireframe),_e.wireframeLinewidth!==void 0&&(nt.wireframeLinewidth=_e.wireframeLinewidth),_e.wireframeLinecap!==void 0&&(nt.wireframeLinecap=_e.wireframeLinecap),_e.wireframeLinejoin!==void 0&&(nt.wireframeLinejoin=_e.wireframeLinejoin),_e.rotation!==void 0&&(nt.rotation=_e.rotation),_e.linewidth!==1&&(nt.linewidth=_e.linewidth),_e.dashSize!==void 0&&(nt.dashSize=_e.dashSize),_e.gapSize!==void 0&&(nt.gapSize=_e.gapSize),_e.scale!==void 0&&(nt.scale=_e.scale),_e.polygonOffset!==void 0&&(nt.polygonOffset=_e.polygonOffset),_e.polygonOffsetFactor!==void 0&&(nt.polygonOffsetFactor=_e.polygonOffsetFactor),_e.polygonOffsetUnits!==void 0&&(nt.polygonOffsetUnits=_e.polygonOffsetUnits),_e.dithering!==void 0&&(nt.dithering=_e.dithering),_e.alphaToCoverage!==void 0&&(nt.alphaToCoverage=_e.alphaToCoverage),_e.premultipliedAlpha!==void 0&&(nt.premultipliedAlpha=_e.premultipliedAlpha),_e.forceSinglePass!==void 0&&(nt.forceSinglePass=_e.forceSinglePass),_e.visible!==void 0&&(nt.visible=_e.visible),_e.toneMapped!==void 0&&(nt.toneMapped=_e.toneMapped),_e.userData!==void 0&&(nt.userData=_e.userData),_e.vertexColors!==void 0&&(typeof _e.vertexColors=="number"?nt.vertexColors=_e.vertexColors>0:nt.vertexColors=_e.vertexColors),_e.uniforms!==void 0)for(const st in _e.uniforms){const at=_e.uniforms[st];switch(nt.uniforms[st]={},at.type){case"t":nt.uniforms[st].value=it(at.value);break;case"c":nt.uniforms[st].value=new Color$1().setHex(at.value);break;case"v2":nt.uniforms[st].value=new Vector2().fromArray(at.value);break;case"v3":nt.uniforms[st].value=new Vector3().fromArray(at.value);break;case"v4":nt.uniforms[st].value=new Vector4().fromArray(at.value);break;case"m3":nt.uniforms[st].value=new Matrix3().fromArray(at.value);break;case"m4":nt.uniforms[st].value=new Matrix4().fromArray(at.value);break;default:nt.uniforms[st].value=at.value}}if(_e.defines!==void 0&&(nt.defines=_e.defines),_e.vertexShader!==void 0&&(nt.vertexShader=_e.vertexShader),_e.fragmentShader!==void 0&&(nt.fragmentShader=_e.fragmentShader),_e.glslVersion!==void 0&&(nt.glslVersion=_e.glslVersion),_e.extensions!==void 0)for(const st in _e.extensions)nt.extensions[st]=_e.extensions[st];if(_e.lights!==void 0&&(nt.lights=_e.lights),_e.clipping!==void 0&&(nt.clipping=_e.clipping),_e.size!==void 0&&(nt.size=_e.size),_e.sizeAttenuation!==void 0&&(nt.sizeAttenuation=_e.sizeAttenuation),_e.map!==void 0&&(nt.map=it(_e.map)),_e.matcap!==void 0&&(nt.matcap=it(_e.matcap)),_e.alphaMap!==void 0&&(nt.alphaMap=it(_e.alphaMap)),_e.bumpMap!==void 0&&(nt.bumpMap=it(_e.bumpMap)),_e.bumpScale!==void 0&&(nt.bumpScale=_e.bumpScale),_e.normalMap!==void 0&&(nt.normalMap=it(_e.normalMap)),_e.normalMapType!==void 0&&(nt.normalMapType=_e.normalMapType),_e.normalScale!==void 0){let st=_e.normalScale;Array.isArray(st)===!1&&(st=[st,st]),nt.normalScale=new Vector2().fromArray(st)}return _e.displacementMap!==void 0&&(nt.displacementMap=it(_e.displacementMap)),_e.displacementScale!==void 0&&(nt.displacementScale=_e.displacementScale),_e.displacementBias!==void 0&&(nt.displacementBias=_e.displacementBias),_e.roughnessMap!==void 0&&(nt.roughnessMap=it(_e.roughnessMap)),_e.metalnessMap!==void 0&&(nt.metalnessMap=it(_e.metalnessMap)),_e.emissiveMap!==void 0&&(nt.emissiveMap=it(_e.emissiveMap)),_e.emissiveIntensity!==void 0&&(nt.emissiveIntensity=_e.emissiveIntensity),_e.specularMap!==void 0&&(nt.specularMap=it(_e.specularMap)),_e.specularIntensityMap!==void 0&&(nt.specularIntensityMap=it(_e.specularIntensityMap)),_e.specularColorMap!==void 0&&(nt.specularColorMap=it(_e.specularColorMap)),_e.envMap!==void 0&&(nt.envMap=it(_e.envMap)),_e.envMapIntensity!==void 0&&(nt.envMapIntensity=_e.envMapIntensity),_e.reflectivity!==void 0&&(nt.reflectivity=_e.reflectivity),_e.refractionRatio!==void 0&&(nt.refractionRatio=_e.refractionRatio),_e.lightMap!==void 0&&(nt.lightMap=it(_e.lightMap)),_e.lightMapIntensity!==void 0&&(nt.lightMapIntensity=_e.lightMapIntensity),_e.aoMap!==void 0&&(nt.aoMap=it(_e.aoMap)),_e.aoMapIntensity!==void 0&&(nt.aoMapIntensity=_e.aoMapIntensity),_e.gradientMap!==void 0&&(nt.gradientMap=it(_e.gradientMap)),_e.clearcoatMap!==void 0&&(nt.clearcoatMap=it(_e.clearcoatMap)),_e.clearcoatRoughnessMap!==void 0&&(nt.clearcoatRoughnessMap=it(_e.clearcoatRoughnessMap)),_e.clearcoatNormalMap!==void 0&&(nt.clearcoatNormalMap=it(_e.clearcoatNormalMap)),_e.clearcoatNormalScale!==void 0&&(nt.clearcoatNormalScale=new Vector2().fromArray(_e.clearcoatNormalScale)),_e.iridescenceMap!==void 0&&(nt.iridescenceMap=it(_e.iridescenceMap)),_e.iridescenceThicknessMap!==void 0&&(nt.iridescenceThicknessMap=it(_e.iridescenceThicknessMap)),_e.transmissionMap!==void 0&&(nt.transmissionMap=it(_e.transmissionMap)),_e.thicknessMap!==void 0&&(nt.thicknessMap=it(_e.thicknessMap)),_e.anisotropyMap!==void 0&&(nt.anisotropyMap=it(_e.anisotropyMap)),_e.sheenColorMap!==void 0&&(nt.sheenColorMap=it(_e.sheenColorMap)),_e.sheenRoughnessMap!==void 0&&(nt.sheenRoughnessMap=it(_e.sheenRoughnessMap)),nt}setTextures(_e){return this.textures=_e,this}static createMaterialFromType(_e){const rt={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new rt[_e]}}class LoaderUtils{static decodeText(_e){if(typeof TextDecoder<"u")return new TextDecoder().decode(_e);let rt="";for(let it=0,nt=_e.length;it<nt;it++)rt+=String.fromCharCode(_e[it]);try{return decodeURIComponent(escape(rt))}catch{return rt}}static extractUrlBase(_e){const rt=_e.lastIndexOf("/");return rt===-1?"./":_e.slice(0,rt+1)}static resolveURL(_e,rt){return typeof _e!="string"||_e===""?"":(/^https?:\/\//i.test(rt)&&/^\//.test(_e)&&(rt=rt.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_e)||/^data:.*,.*$/i.test(_e)||/^blob:.*$/i.test(_e)?_e:rt+_e)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_e){return super.copy(_e),this.instanceCount=_e.instanceCount,this}toJSON(){const _e=super.toJSON();return _e.instanceCount=this.instanceCount,_e.isInstancedBufferGeometry=!0,_e}}class BufferGeometryLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){const st=this,at=new FileLoader(st.manager);at.setPath(st.path),at.setRequestHeader(st.requestHeader),at.setWithCredentials(st.withCredentials),at.load(_e,function(lt){try{rt(st.parse(JSON.parse(lt)))}catch(ot){nt?nt(ot):console.error(ot),st.manager.itemError(_e)}},it,nt)}parse(_e){const rt={},it={};function nt(pt,ft){if(rt[ft]!==void 0)return rt[ft];const mt=pt.interleavedBuffers[ft],At=st(pt,mt.buffer),yt=getTypedArray(mt.type,At),bt=new InterleavedBuffer(yt,mt.stride);return bt.uuid=mt.uuid,rt[ft]=bt,bt}function st(pt,ft){if(it[ft]!==void 0)return it[ft];const mt=pt.arrayBuffers[ft],At=new Uint32Array(mt).buffer;return it[ft]=At,At}const at=_e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,lt=_e.data.index;if(lt!==void 0){const pt=getTypedArray(lt.type,lt.array);at.setIndex(new BufferAttribute(pt,1))}const ot=_e.data.attributes;for(const pt in ot){const ft=ot[pt];let gt;if(ft.isInterleavedBufferAttribute){const mt=nt(_e.data,ft.data);gt=new InterleavedBufferAttribute(mt,ft.itemSize,ft.offset,ft.normalized)}else{const mt=getTypedArray(ft.type,ft.array),At=ft.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;gt=new At(mt,ft.itemSize,ft.normalized)}ft.name!==void 0&&(gt.name=ft.name),ft.usage!==void 0&&gt.setUsage(ft.usage),ft.updateRange!==void 0&&(gt.updateRange.offset=ft.updateRange.offset,gt.updateRange.count=ft.updateRange.count),at.setAttribute(pt,gt)}const ct=_e.data.morphAttributes;if(ct)for(const pt in ct){const ft=ct[pt],gt=[];for(let mt=0,At=ft.length;mt<At;mt++){const yt=ft[mt];let bt;if(yt.isInterleavedBufferAttribute){const xt=nt(_e.data,yt.data);bt=new InterleavedBufferAttribute(xt,yt.itemSize,yt.offset,yt.normalized)}else{const xt=getTypedArray(yt.type,yt.array);bt=new BufferAttribute(xt,yt.itemSize,yt.normalized)}yt.name!==void 0&&(bt.name=yt.name),gt.push(bt)}at.morphAttributes[pt]=gt}_e.data.morphTargetsRelative&&(at.morphTargetsRelative=!0);const ht=_e.data.groups||_e.data.drawcalls||_e.data.offsets;if(ht!==void 0)for(let pt=0,ft=ht.length;pt!==ft;++pt){const gt=ht[pt];at.addGroup(gt.start,gt.count,gt.materialIndex)}const dt=_e.data.boundingSphere;if(dt!==void 0){const pt=new Vector3;dt.center!==void 0&&pt.fromArray(dt.center),at.boundingSphere=new Sphere(pt,dt.radius)}return _e.name&&(at.name=_e.name),_e.userData&&(at.userData=_e.userData),at}}class ObjectLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){const st=this,at=this.path===""?LoaderUtils.extractUrlBase(_e):this.path;this.resourcePath=this.resourcePath||at;const lt=new FileLoader(this.manager);lt.setPath(this.path),lt.setRequestHeader(this.requestHeader),lt.setWithCredentials(this.withCredentials),lt.load(_e,function(ot){let ct=null;try{ct=JSON.parse(ot)}catch(ht){nt!==void 0&&nt(ht),console.error("THREE:ObjectLoader: Can't parse "+_e+".",ht.message);return}const ut=ct.metadata;if(ut===void 0||ut.type===void 0||ut.type.toLowerCase()==="geometry"){nt!==void 0&&nt(new Error("THREE.ObjectLoader: Can't load "+_e)),console.error("THREE.ObjectLoader: Can't load "+_e);return}st.parse(ct,rt)},it,nt)}async loadAsync(_e,rt){const it=this,nt=this.path===""?LoaderUtils.extractUrlBase(_e):this.path;this.resourcePath=this.resourcePath||nt;const st=new FileLoader(this.manager);st.setPath(this.path),st.setRequestHeader(this.requestHeader),st.setWithCredentials(this.withCredentials);const at=await st.loadAsync(_e,rt),lt=JSON.parse(at),ot=lt.metadata;if(ot===void 0||ot.type===void 0||ot.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_e);return await it.parseAsync(lt)}parse(_e,rt){const it=this.parseAnimations(_e.animations),nt=this.parseShapes(_e.shapes),st=this.parseGeometries(_e.geometries,nt),at=this.parseImages(_e.images,function(){rt!==void 0&&rt(ct)}),lt=this.parseTextures(_e.textures,at),ot=this.parseMaterials(_e.materials,lt),ct=this.parseObject(_e.object,st,ot,lt,it),ut=this.parseSkeletons(_e.skeletons,ct);if(this.bindSkeletons(ct,ut),rt!==void 0){let ht=!1;for(const dt in at)if(at[dt].data instanceof HTMLImageElement){ht=!0;break}ht===!1&&rt(ct)}return ct}async parseAsync(_e){const rt=this.parseAnimations(_e.animations),it=this.parseShapes(_e.shapes),nt=this.parseGeometries(_e.geometries,it),st=await this.parseImagesAsync(_e.images),at=this.parseTextures(_e.textures,st),lt=this.parseMaterials(_e.materials,at),ot=this.parseObject(_e.object,nt,lt,at,rt),ct=this.parseSkeletons(_e.skeletons,ot);return this.bindSkeletons(ot,ct),ot}parseShapes(_e){const rt={};if(_e!==void 0)for(let it=0,nt=_e.length;it<nt;it++){const st=new Shape().fromJSON(_e[it]);rt[st.uuid]=st}return rt}parseSkeletons(_e,rt){const it={},nt={};if(rt.traverse(function(st){st.isBone&&(nt[st.uuid]=st)}),_e!==void 0)for(let st=0,at=_e.length;st<at;st++){const lt=new Skeleton().fromJSON(_e[st],nt);it[lt.uuid]=lt}return it}parseGeometries(_e,rt){const it={};if(_e!==void 0){const nt=new BufferGeometryLoader;for(let st=0,at=_e.length;st<at;st++){let lt;const ot=_e[st];switch(ot.type){case"BufferGeometry":case"InstancedBufferGeometry":lt=nt.parse(ot);break;default:ot.type in Geometries?lt=Geometries[ot.type].fromJSON(ot,rt):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${ot.type}"`)}lt.uuid=ot.uuid,ot.name!==void 0&&(lt.name=ot.name),ot.userData!==void 0&&(lt.userData=ot.userData),it[ot.uuid]=lt}}return it}parseMaterials(_e,rt){const it={},nt={};if(_e!==void 0){const st=new MaterialLoader;st.setTextures(rt);for(let at=0,lt=_e.length;at<lt;at++){const ot=_e[at];it[ot.uuid]===void 0&&(it[ot.uuid]=st.parse(ot)),nt[ot.uuid]=it[ot.uuid]}}return nt}parseAnimations(_e){const rt={};if(_e!==void 0)for(let it=0;it<_e.length;it++){const nt=_e[it],st=AnimationClip.parse(nt);rt[st.uuid]=st}return rt}parseImages(_e,rt){const it=this,nt={};let st;function at(ot){return it.manager.itemStart(ot),st.load(ot,function(){it.manager.itemEnd(ot)},void 0,function(){it.manager.itemError(ot),it.manager.itemEnd(ot)})}function lt(ot){if(typeof ot=="string"){const ct=ot,ut=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(ct)?ct:it.resourcePath+ct;return at(ut)}else return ot.data?{data:getTypedArray(ot.type,ot.data),width:ot.width,height:ot.height}:null}if(_e!==void 0&&_e.length>0){const ot=new LoadingManager(rt);st=new ImageLoader(ot),st.setCrossOrigin(this.crossOrigin);for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct],dt=ht.url;if(Array.isArray(dt)){const pt=[];for(let ft=0,gt=dt.length;ft<gt;ft++){const mt=dt[ft],At=lt(mt);At!==null&&(At instanceof HTMLImageElement?pt.push(At):pt.push(new DataTexture(At.data,At.width,At.height)))}nt[ht.uuid]=new Source(pt)}else{const pt=lt(ht.url);nt[ht.uuid]=new Source(pt)}}}return nt}async parseImagesAsync(_e){const rt=this,it={};let nt;async function st(at){if(typeof at=="string"){const lt=at,ot=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(lt)?lt:rt.resourcePath+lt;return await nt.loadAsync(ot)}else return at.data?{data:getTypedArray(at.type,at.data),width:at.width,height:at.height}:null}if(_e!==void 0&&_e.length>0){nt=new ImageLoader(this.manager),nt.setCrossOrigin(this.crossOrigin);for(let at=0,lt=_e.length;at<lt;at++){const ot=_e[at],ct=ot.url;if(Array.isArray(ct)){const ut=[];for(let ht=0,dt=ct.length;ht<dt;ht++){const pt=ct[ht],ft=await st(pt);ft!==null&&(ft instanceof HTMLImageElement?ut.push(ft):ut.push(new DataTexture(ft.data,ft.width,ft.height)))}it[ot.uuid]=new Source(ut)}else{const ut=await st(ot.url);it[ot.uuid]=new Source(ut)}}}return it}parseTextures(_e,rt){function it(st,at){return typeof st=="number"?st:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",st),at[st])}const nt={};if(_e!==void 0)for(let st=0,at=_e.length;st<at;st++){const lt=_e[st];lt.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',lt.uuid),rt[lt.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",lt.image);const ot=rt[lt.image],ct=ot.data;let ut;Array.isArray(ct)?(ut=new CubeTexture,ct.length===6&&(ut.needsUpdate=!0)):(ct&&ct.data?ut=new DataTexture:ut=new Texture,ct&&(ut.needsUpdate=!0)),ut.source=ot,ut.uuid=lt.uuid,lt.name!==void 0&&(ut.name=lt.name),lt.mapping!==void 0&&(ut.mapping=it(lt.mapping,TEXTURE_MAPPING)),lt.channel!==void 0&&(ut.channel=lt.channel),lt.offset!==void 0&&ut.offset.fromArray(lt.offset),lt.repeat!==void 0&&ut.repeat.fromArray(lt.repeat),lt.center!==void 0&&ut.center.fromArray(lt.center),lt.rotation!==void 0&&(ut.rotation=lt.rotation),lt.wrap!==void 0&&(ut.wrapS=it(lt.wrap[0],TEXTURE_WRAPPING),ut.wrapT=it(lt.wrap[1],TEXTURE_WRAPPING)),lt.format!==void 0&&(ut.format=lt.format),lt.internalFormat!==void 0&&(ut.internalFormat=lt.internalFormat),lt.type!==void 0&&(ut.type=lt.type),lt.colorSpace!==void 0&&(ut.colorSpace=lt.colorSpace),lt.encoding!==void 0&&(ut.encoding=lt.encoding),lt.minFilter!==void 0&&(ut.minFilter=it(lt.minFilter,TEXTURE_FILTER)),lt.magFilter!==void 0&&(ut.magFilter=it(lt.magFilter,TEXTURE_FILTER)),lt.anisotropy!==void 0&&(ut.anisotropy=lt.anisotropy),lt.flipY!==void 0&&(ut.flipY=lt.flipY),lt.generateMipmaps!==void 0&&(ut.generateMipmaps=lt.generateMipmaps),lt.premultiplyAlpha!==void 0&&(ut.premultiplyAlpha=lt.premultiplyAlpha),lt.unpackAlignment!==void 0&&(ut.unpackAlignment=lt.unpackAlignment),lt.compareFunction!==void 0&&(ut.compareFunction=lt.compareFunction),lt.userData!==void 0&&(ut.userData=lt.userData),nt[lt.uuid]=ut}return nt}parseObject(_e,rt,it,nt,st){let at;function lt(dt){return rt[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",dt),rt[dt]}function ot(dt){if(dt!==void 0){if(Array.isArray(dt)){const pt=[];for(let ft=0,gt=dt.length;ft<gt;ft++){const mt=dt[ft];it[mt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",mt),pt.push(it[mt])}return pt}return it[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",dt),it[dt]}}function ct(dt){return nt[dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",dt),nt[dt]}let ut,ht;switch(_e.type){case"Scene":at=new Scene,_e.background!==void 0&&(Number.isInteger(_e.background)?at.background=new Color$1(_e.background):at.background=ct(_e.background)),_e.environment!==void 0&&(at.environment=ct(_e.environment)),_e.fog!==void 0&&(_e.fog.type==="Fog"?at.fog=new Fog(_e.fog.color,_e.fog.near,_e.fog.far):_e.fog.type==="FogExp2"&&(at.fog=new FogExp2(_e.fog.color,_e.fog.density))),_e.backgroundBlurriness!==void 0&&(at.backgroundBlurriness=_e.backgroundBlurriness),_e.backgroundIntensity!==void 0&&(at.backgroundIntensity=_e.backgroundIntensity);break;case"PerspectiveCamera":at=new PerspectiveCamera(_e.fov,_e.aspect,_e.near,_e.far),_e.focus!==void 0&&(at.focus=_e.focus),_e.zoom!==void 0&&(at.zoom=_e.zoom),_e.filmGauge!==void 0&&(at.filmGauge=_e.filmGauge),_e.filmOffset!==void 0&&(at.filmOffset=_e.filmOffset),_e.view!==void 0&&(at.view=Object.assign({},_e.view));break;case"OrthographicCamera":at=new OrthographicCamera(_e.left,_e.right,_e.top,_e.bottom,_e.near,_e.far),_e.zoom!==void 0&&(at.zoom=_e.zoom),_e.view!==void 0&&(at.view=Object.assign({},_e.view));break;case"AmbientLight":at=new AmbientLight(_e.color,_e.intensity);break;case"DirectionalLight":at=new DirectionalLight(_e.color,_e.intensity);break;case"PointLight":at=new PointLight(_e.color,_e.intensity,_e.distance,_e.decay);break;case"RectAreaLight":at=new RectAreaLight(_e.color,_e.intensity,_e.width,_e.height);break;case"SpotLight":at=new SpotLight(_e.color,_e.intensity,_e.distance,_e.angle,_e.penumbra,_e.decay);break;case"HemisphereLight":at=new HemisphereLight(_e.color,_e.groundColor,_e.intensity);break;case"LightProbe":at=new LightProbe().fromJSON(_e);break;case"SkinnedMesh":ut=lt(_e.geometry),ht=ot(_e.material),at=new SkinnedMesh(ut,ht),_e.bindMode!==void 0&&(at.bindMode=_e.bindMode),_e.bindMatrix!==void 0&&at.bindMatrix.fromArray(_e.bindMatrix),_e.skeleton!==void 0&&(at.skeleton=_e.skeleton);break;case"Mesh":ut=lt(_e.geometry),ht=ot(_e.material),at=new Mesh(ut,ht);break;case"InstancedMesh":ut=lt(_e.geometry),ht=ot(_e.material);const dt=_e.count,pt=_e.instanceMatrix,ft=_e.instanceColor;at=new InstancedMesh(ut,ht,dt),at.instanceMatrix=new InstancedBufferAttribute(new Float32Array(pt.array),16),ft!==void 0&&(at.instanceColor=new InstancedBufferAttribute(new Float32Array(ft.array),ft.itemSize));break;case"LOD":at=new LOD;break;case"Line":at=new Line(lt(_e.geometry),ot(_e.material));break;case"LineLoop":at=new LineLoop(lt(_e.geometry),ot(_e.material));break;case"LineSegments":at=new LineSegments(lt(_e.geometry),ot(_e.material));break;case"PointCloud":case"Points":at=new Points(lt(_e.geometry),ot(_e.material));break;case"Sprite":at=new Sprite(ot(_e.material));break;case"Group":at=new Group;break;case"Bone":at=new Bone;break;default:at=new Object3D}if(at.uuid=_e.uuid,_e.name!==void 0&&(at.name=_e.name),_e.matrix!==void 0?(at.matrix.fromArray(_e.matrix),_e.matrixAutoUpdate!==void 0&&(at.matrixAutoUpdate=_e.matrixAutoUpdate),at.matrixAutoUpdate&&at.matrix.decompose(at.position,at.quaternion,at.scale)):(_e.position!==void 0&&at.position.fromArray(_e.position),_e.rotation!==void 0&&at.rotation.fromArray(_e.rotation),_e.quaternion!==void 0&&at.quaternion.fromArray(_e.quaternion),_e.scale!==void 0&&at.scale.fromArray(_e.scale)),_e.up!==void 0&&at.up.fromArray(_e.up),_e.castShadow!==void 0&&(at.castShadow=_e.castShadow),_e.receiveShadow!==void 0&&(at.receiveShadow=_e.receiveShadow),_e.shadow&&(_e.shadow.bias!==void 0&&(at.shadow.bias=_e.shadow.bias),_e.shadow.normalBias!==void 0&&(at.shadow.normalBias=_e.shadow.normalBias),_e.shadow.radius!==void 0&&(at.shadow.radius=_e.shadow.radius),_e.shadow.mapSize!==void 0&&at.shadow.mapSize.fromArray(_e.shadow.mapSize),_e.shadow.camera!==void 0&&(at.shadow.camera=this.parseObject(_e.shadow.camera))),_e.visible!==void 0&&(at.visible=_e.visible),_e.frustumCulled!==void 0&&(at.frustumCulled=_e.frustumCulled),_e.renderOrder!==void 0&&(at.renderOrder=_e.renderOrder),_e.userData!==void 0&&(at.userData=_e.userData),_e.layers!==void 0&&(at.layers.mask=_e.layers),_e.children!==void 0){const dt=_e.children;for(let pt=0;pt<dt.length;pt++)at.add(this.parseObject(dt[pt],rt,it,nt,st))}if(_e.animations!==void 0){const dt=_e.animations;for(let pt=0;pt<dt.length;pt++){const ft=dt[pt];at.animations.push(st[ft])}}if(_e.type==="LOD"){_e.autoUpdate!==void 0&&(at.autoUpdate=_e.autoUpdate);const dt=_e.levels;for(let pt=0;pt<dt.length;pt++){const ft=dt[pt],gt=at.getObjectByProperty("uuid",ft.object);gt!==void 0&&at.addLevel(gt,ft.distance,ft.hysteresis)}}return at}bindSkeletons(_e,rt){Object.keys(rt).length!==0&&_e.traverse(function(it){if(it.isSkinnedMesh===!0&&it.skeleton!==void 0){const nt=rt[it.skeleton];nt===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",it.skeleton):it.bind(nt,it.bindMatrix)}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(_e){super(_e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_e){return this.options=_e,this}load(_e,rt,it,nt){_e===void 0&&(_e=""),this.path!==void 0&&(_e=this.path+_e),_e=this.manager.resolveURL(_e);const st=this,at=Cache.get(_e);if(at!==void 0)return st.manager.itemStart(_e),setTimeout(function(){rt&&rt(at),st.manager.itemEnd(_e)},0),at;const lt={};lt.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",lt.headers=this.requestHeader,fetch(_e,lt).then(function(ot){return ot.blob()}).then(function(ot){return createImageBitmap(ot,Object.assign(st.options,{colorSpaceConversion:"none"}))}).then(function(ot){Cache.add(_e,ot),rt&&rt(ot),st.manager.itemEnd(_e)}).catch(function(ot){nt&&nt(ot),st.manager.itemError(_e),st.manager.itemEnd(_e)}),st.manager.itemStart(_e)}}let _context;class AudioContext{static getContext(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context}static setContext(_e){_context=_e}}class AudioLoader extends Loader{constructor(_e){super(_e)}load(_e,rt,it,nt){const st=this,at=new FileLoader(this.manager);at.setResponseType("arraybuffer"),at.setPath(this.path),at.setRequestHeader(this.requestHeader),at.setWithCredentials(this.withCredentials),at.load(_e,function(ot){try{const ct=ot.slice(0);AudioContext.getContext().decodeAudioData(ct,function(ht){rt(ht)},lt)}catch(ct){lt(ct)}},it,nt);function lt(ot){nt?nt(ot):console.error(ot),st.manager.itemError(_e)}}}class HemisphereLightProbe extends LightProbe{constructor(_e,rt,it=1){super(void 0,it),this.isHemisphereLightProbe=!0;const nt=new Color$1().set(_e),st=new Color$1().set(rt),at=new Vector3(nt.r,nt.g,nt.b),lt=new Vector3(st.r,st.g,st.b),ot=Math.sqrt(Math.PI),ct=ot*Math.sqrt(.75);this.sh.coefficients[0].copy(at).add(lt).multiplyScalar(ot),this.sh.coefficients[1].copy(at).sub(lt).multiplyScalar(ct)}}class AmbientLightProbe extends LightProbe{constructor(_e,rt=1){super(void 0,rt),this.isAmbientLightProbe=!0;const it=new Color$1().set(_e);this.sh.coefficients[0].set(it.r,it.g,it.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_e){const rt=this._cache;if(rt.focus!==_e.focus||rt.fov!==_e.fov||rt.aspect!==_e.aspect*this.aspect||rt.near!==_e.near||rt.far!==_e.far||rt.zoom!==_e.zoom||rt.eyeSep!==this.eyeSep){rt.focus=_e.focus,rt.fov=_e.fov,rt.aspect=_e.aspect*this.aspect,rt.near=_e.near,rt.far=_e.far,rt.zoom=_e.zoom,rt.eyeSep=this.eyeSep,_projectionMatrix.copy(_e.projectionMatrix);const nt=rt.eyeSep/2,st=nt*rt.near/rt.focus,at=rt.near*Math.tan(DEG2RAD*rt.fov*.5)/rt.zoom;let lt,ot;_eyeLeft.elements[12]=-nt,_eyeRight.elements[12]=nt,lt=-at*rt.aspect+st,ot=at*rt.aspect+st,_projectionMatrix.elements[0]=2*rt.near/(ot-lt),_projectionMatrix.elements[8]=(ot+lt)/(ot-lt),this.cameraL.projectionMatrix.copy(_projectionMatrix),lt=-at*rt.aspect-st,ot=at*rt.aspect-st,_projectionMatrix.elements[0]=2*rt.near/(ot-lt),_projectionMatrix.elements[8]=(ot+lt)/(ot-lt),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(_e.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(_e.matrixWorld).multiply(_eyeRight)}}class Clock{constructor(_e=!0){this.autoStart=_e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now$2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const rt=now$2();_e=(rt-this.oldTime)/1e3,this.oldTime=rt,this.elapsedTime+=_e}return _e}}function now$2(){return(typeof performance>"u"?Date:performance).now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_e){return this.gain.gain.setTargetAtTime(_e,this.context.currentTime,.01),this}updateMatrixWorld(_e){super.updateMatrixWorld(_e);const rt=this.context.listener,it=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),rt.positionX){const nt=this.context.currentTime+this.timeDelta;rt.positionX.linearRampToValueAtTime(_position$1.x,nt),rt.positionY.linearRampToValueAtTime(_position$1.y,nt),rt.positionZ.linearRampToValueAtTime(_position$1.z,nt),rt.forwardX.linearRampToValueAtTime(_orientation$1.x,nt),rt.forwardY.linearRampToValueAtTime(_orientation$1.y,nt),rt.forwardZ.linearRampToValueAtTime(_orientation$1.z,nt),rt.upX.linearRampToValueAtTime(it.x,nt),rt.upY.linearRampToValueAtTime(it.y,nt),rt.upZ.linearRampToValueAtTime(it.z,nt)}else rt.setPosition(_position$1.x,_position$1.y,_position$1.z),rt.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,it.x,it.y,it.z)}}class Audio extends Object3D{constructor(_e){super(),this.type="Audio",this.listener=_e,this.context=_e.context,this.gain=this.context.createGain(),this.gain.connect(_e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_e,this.connect(),this}setMediaElementSource(_e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_e),this.connect(),this}setMediaStreamSource(_e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_e),this.connect(),this}setBuffer(_e){return this.buffer=_e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+_e;const rt=this.context.createBufferSource();return rt.buffer=this.buffer,rt.loop=this.loop,rt.loopStart=this.loopStart,rt.loopEnd=this.loopEnd,rt.onended=this.onEnded.bind(this),rt.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=rt,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _e=1,rt=this.filters.length;_e<rt;_e++)this.filters[_e-1].connect(this.filters[_e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _e=1,rt=this.filters.length;_e<rt;_e++)this.filters[_e-1].disconnect(this.filters[_e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(_e){return _e||(_e=[]),this._connected===!0?(this.disconnect(),this.filters=_e.slice(),this.connect()):this.filters=_e.slice(),this}setDetune(_e){if(this.detune=_e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_e){return this.setFilters(_e?[_e]:[])}setPlaybackRate(_e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=_e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=_e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(_e){return this.loopStart=_e,this}setLoopEnd(_e){return this.loopEnd=_e,this}getVolume(){return this.gain.gain.value}setVolume(_e){return this.gain.gain.setTargetAtTime(_e,this.context.currentTime,.01),this}}const _position=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_orientation=new Vector3;class PositionalAudio extends Audio{constructor(_e){super(_e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_e){return this.panner.refDistance=_e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_e){return this.panner.rolloffFactor=_e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_e){return this.panner.distanceModel=_e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_e){return this.panner.maxDistance=_e,this}setDirectionalCone(_e,rt,it){return this.panner.coneInnerAngle=_e,this.panner.coneOuterAngle=rt,this.panner.coneOuterGain=it,this}updateMatrixWorld(_e){if(super.updateMatrixWorld(_e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position,_quaternion,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion);const rt=this.panner;if(rt.positionX){const it=this.context.currentTime+this.listener.timeDelta;rt.positionX.linearRampToValueAtTime(_position.x,it),rt.positionY.linearRampToValueAtTime(_position.y,it),rt.positionZ.linearRampToValueAtTime(_position.z,it),rt.orientationX.linearRampToValueAtTime(_orientation.x,it),rt.orientationY.linearRampToValueAtTime(_orientation.y,it),rt.orientationZ.linearRampToValueAtTime(_orientation.z,it)}else rt.setPosition(_position.x,_position.y,_position.z),rt.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(_e,rt=2048){this.analyser=_e.context.createAnalyser(),this.analyser.fftSize=rt,this.data=new Uint8Array(this.analyser.frequencyBinCount),_e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _e=0;const rt=this.getFrequencyData();for(let it=0;it<rt.length;it++)_e+=rt[it];return _e/rt.length}}class PropertyMixer{constructor(_e,rt,it){this.binding=_e,this.valueSize=it;let nt,st,at;switch(rt){case"quaternion":nt=this._slerp,st=this._slerpAdditive,at=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(it*6),this._workIndex=5;break;case"string":case"bool":nt=this._select,st=this._select,at=this._setAdditiveIdentityOther,this.buffer=new Array(it*5);break;default:nt=this._lerp,st=this._lerpAdditive,at=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(it*5)}this._mixBufferRegion=nt,this._mixBufferRegionAdditive=st,this._setIdentity=at,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_e,rt){const it=this.buffer,nt=this.valueSize,st=_e*nt+nt;let at=this.cumulativeWeight;if(at===0){for(let lt=0;lt!==nt;++lt)it[st+lt]=it[lt];at=rt}else{at+=rt;const lt=rt/at;this._mixBufferRegion(it,st,0,lt,nt)}this.cumulativeWeight=at}accumulateAdditive(_e){const rt=this.buffer,it=this.valueSize,nt=it*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(rt,nt,0,_e,it),this.cumulativeWeightAdditive+=_e}apply(_e){const rt=this.valueSize,it=this.buffer,nt=_e*rt+rt,st=this.cumulativeWeight,at=this.cumulativeWeightAdditive,lt=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,st<1){const ot=rt*this._origIndex;this._mixBufferRegion(it,nt,ot,1-st,rt)}at>0&&this._mixBufferRegionAdditive(it,nt,this._addIndex*rt,1,rt);for(let ot=rt,ct=rt+rt;ot!==ct;++ot)if(it[ot]!==it[ot+rt]){lt.setValue(it,nt);break}}saveOriginalState(){const _e=this.binding,rt=this.buffer,it=this.valueSize,nt=it*this._origIndex;_e.getValue(rt,nt);for(let st=it,at=nt;st!==at;++st)rt[st]=rt[nt+st%it];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _e=this.valueSize*3;this.binding.setValue(this.buffer,_e)}_setAdditiveIdentityNumeric(){const _e=this._addIndex*this.valueSize,rt=_e+this.valueSize;for(let it=_e;it<rt;it++)this.buffer[it]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _e=this._origIndex*this.valueSize,rt=this._addIndex*this.valueSize;for(let it=0;it<this.valueSize;it++)this.buffer[rt+it]=this.buffer[_e+it]}_select(_e,rt,it,nt,st){if(nt>=.5)for(let at=0;at!==st;++at)_e[rt+at]=_e[it+at]}_slerp(_e,rt,it,nt){Quaternion.slerpFlat(_e,rt,_e,rt,_e,it,nt)}_slerpAdditive(_e,rt,it,nt,st){const at=this._workIndex*st;Quaternion.multiplyQuaternionsFlat(_e,at,_e,rt,_e,it),Quaternion.slerpFlat(_e,rt,_e,rt,_e,at,nt)}_lerp(_e,rt,it,nt,st){const at=1-nt;for(let lt=0;lt!==st;++lt){const ot=rt+lt;_e[ot]=_e[ot]*at+_e[it+lt]*nt}}_lerpAdditive(_e,rt,it,nt,st){for(let at=0;at!==st;++at){const lt=rt+at;_e[lt]=_e[lt]+_e[it+at]*nt}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_e,rt,it){const nt=it||PropertyBinding.parseTrackName(rt);this._targetGroup=_e,this._bindings=_e.subscribe_(rt,nt)}getValue(_e,rt){this.bind();const it=this._targetGroup.nCachedObjects_,nt=this._bindings[it];nt!==void 0&&nt.getValue(_e,rt)}setValue(_e,rt){const it=this._bindings;for(let nt=this._targetGroup.nCachedObjects_,st=it.length;nt!==st;++nt)it[nt].setValue(_e,rt)}bind(){const _e=this._bindings;for(let rt=this._targetGroup.nCachedObjects_,it=_e.length;rt!==it;++rt)_e[rt].bind()}unbind(){const _e=this._bindings;for(let rt=this._targetGroup.nCachedObjects_,it=_e.length;rt!==it;++rt)_e[rt].unbind()}}class PropertyBinding{constructor(_e,rt,it){this.path=rt,this.parsedPath=it||PropertyBinding.parseTrackName(rt),this.node=PropertyBinding.findNode(_e,this.parsedPath.nodeName),this.rootNode=_e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_e,rt,it){return _e&&_e.isAnimationObjectGroup?new PropertyBinding.Composite(_e,rt,it):new PropertyBinding(_e,rt,it)}static sanitizeNodeName(_e){return _e.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_e){const rt=_trackRe.exec(_e);if(rt===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_e);const it={nodeName:rt[2],objectName:rt[3],objectIndex:rt[4],propertyName:rt[5],propertyIndex:rt[6]},nt=it.nodeName&&it.nodeName.lastIndexOf(".");if(nt!==void 0&&nt!==-1){const st=it.nodeName.substring(nt+1);_supportedObjectNames.indexOf(st)!==-1&&(it.nodeName=it.nodeName.substring(0,nt),it.objectName=st)}if(it.propertyName===null||it.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_e);return it}static findNode(_e,rt){if(rt===void 0||rt===""||rt==="."||rt===-1||rt===_e.name||rt===_e.uuid)return _e;if(_e.skeleton){const it=_e.skeleton.getBoneByName(rt);if(it!==void 0)return it}if(_e.children){const it=function(st){for(let at=0;at<st.length;at++){const lt=st[at];if(lt.name===rt||lt.uuid===rt)return lt;const ot=it(lt.children);if(ot)return ot}return null},nt=it(_e.children);if(nt)return nt}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_e,rt){_e[rt]=this.targetObject[this.propertyName]}_getValue_array(_e,rt){const it=this.resolvedProperty;for(let nt=0,st=it.length;nt!==st;++nt)_e[rt++]=it[nt]}_getValue_arrayElement(_e,rt){_e[rt]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_e,rt){this.resolvedProperty.toArray(_e,rt)}_setValue_direct(_e,rt){this.targetObject[this.propertyName]=_e[rt]}_setValue_direct_setNeedsUpdate(_e,rt){this.targetObject[this.propertyName]=_e[rt],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_e,rt){this.targetObject[this.propertyName]=_e[rt],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_e,rt){const it=this.resolvedProperty;for(let nt=0,st=it.length;nt!==st;++nt)it[nt]=_e[rt++]}_setValue_array_setNeedsUpdate(_e,rt){const it=this.resolvedProperty;for(let nt=0,st=it.length;nt!==st;++nt)it[nt]=_e[rt++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_e,rt){const it=this.resolvedProperty;for(let nt=0,st=it.length;nt!==st;++nt)it[nt]=_e[rt++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_e,rt){this.resolvedProperty[this.propertyIndex]=_e[rt]}_setValue_arrayElement_setNeedsUpdate(_e,rt){this.resolvedProperty[this.propertyIndex]=_e[rt],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_e,rt){this.resolvedProperty[this.propertyIndex]=_e[rt],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_e,rt){this.resolvedProperty.fromArray(_e,rt)}_setValue_fromArray_setNeedsUpdate(_e,rt){this.resolvedProperty.fromArray(_e,rt),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_e,rt){this.resolvedProperty.fromArray(_e,rt),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_e,rt){this.bind(),this.getValue(_e,rt)}_setValue_unbound(_e,rt){this.bind(),this.setValue(_e,rt)}bind(){let _e=this.node;const rt=this.parsedPath,it=rt.objectName,nt=rt.propertyName;let st=rt.propertyIndex;if(_e||(_e=PropertyBinding.findNode(this.rootNode,rt.nodeName),this.node=_e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(it){let ct=rt.objectIndex;switch(it){case"materials":if(!_e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_e=_e.material.materials;break;case"bones":if(!_e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_e=_e.skeleton.bones;for(let ut=0;ut<_e.length;ut++)if(_e[ut].name===ct){ct=ut;break}break;case"map":if("map"in _e){_e=_e.map;break}if(!_e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_e=_e.material.map;break;default:if(_e[it]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_e=_e[it]}if(ct!==void 0){if(_e[ct]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_e);return}_e=_e[ct]}}const at=_e[nt];if(at===void 0){const ct=rt.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+ct+"."+nt+" but it wasn't found.",_e);return}let lt=this.Versioning.None;this.targetObject=_e,_e.needsUpdate!==void 0?lt=this.Versioning.NeedsUpdate:_e.matrixWorldNeedsUpdate!==void 0&&(lt=this.Versioning.MatrixWorldNeedsUpdate);let ot=this.BindingType.Direct;if(st!==void 0){if(nt==="morphTargetInfluences"){if(!_e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_e.morphTargetDictionary[st]!==void 0&&(st=_e.morphTargetDictionary[st])}ot=this.BindingType.ArrayElement,this.resolvedProperty=at,this.propertyIndex=st}else at.fromArray!==void 0&&at.toArray!==void 0?(ot=this.BindingType.HasFromToArray,this.resolvedProperty=at):Array.isArray(at)?(ot=this.BindingType.EntireArray,this.resolvedProperty=at):this.propertyName=nt;this.getValue=this.GetterByBindingType[ot],this.setValue=this.SetterByBindingTypeAndVersioning[ot][lt]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID$1(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _e={};this._indicesByUUID=_e;for(let it=0,nt=arguments.length;it!==nt;++it)_e[arguments[it].uuid]=it;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const rt=this;this.stats={objects:{get total(){return rt._objects.length},get inUse(){return this.total-rt.nCachedObjects_}},get bindingsPerObject(){return rt._bindings.length}}}add(){const _e=this._objects,rt=this._indicesByUUID,it=this._paths,nt=this._parsedPaths,st=this._bindings,at=st.length;let lt,ot=_e.length,ct=this.nCachedObjects_;for(let ut=0,ht=arguments.length;ut!==ht;++ut){const dt=arguments[ut],pt=dt.uuid;let ft=rt[pt];if(ft===void 0){ft=ot++,rt[pt]=ft,_e.push(dt);for(let gt=0,mt=at;gt!==mt;++gt)st[gt].push(new PropertyBinding(dt,it[gt],nt[gt]))}else if(ft<ct){lt=_e[ft];const gt=--ct,mt=_e[gt];rt[mt.uuid]=ft,_e[ft]=mt,rt[pt]=gt,_e[gt]=dt;for(let At=0,yt=at;At!==yt;++At){const bt=st[At],xt=bt[gt];let vt=bt[ft];bt[ft]=xt,vt===void 0&&(vt=new PropertyBinding(dt,it[At],nt[At])),bt[gt]=vt}}else _e[ft]!==lt&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=ct}remove(){const _e=this._objects,rt=this._indicesByUUID,it=this._bindings,nt=it.length;let st=this.nCachedObjects_;for(let at=0,lt=arguments.length;at!==lt;++at){const ot=arguments[at],ct=ot.uuid,ut=rt[ct];if(ut!==void 0&&ut>=st){const ht=st++,dt=_e[ht];rt[dt.uuid]=ut,_e[ut]=dt,rt[ct]=ht,_e[ht]=ot;for(let pt=0,ft=nt;pt!==ft;++pt){const gt=it[pt],mt=gt[ht],At=gt[ut];gt[ut]=mt,gt[ht]=At}}}this.nCachedObjects_=st}uncache(){const _e=this._objects,rt=this._indicesByUUID,it=this._bindings,nt=it.length;let st=this.nCachedObjects_,at=_e.length;for(let lt=0,ot=arguments.length;lt!==ot;++lt){const ct=arguments[lt],ut=ct.uuid,ht=rt[ut];if(ht!==void 0)if(delete rt[ut],ht<st){const dt=--st,pt=_e[dt],ft=--at,gt=_e[ft];rt[pt.uuid]=ht,_e[ht]=pt,rt[gt.uuid]=dt,_e[dt]=gt,_e.pop();for(let mt=0,At=nt;mt!==At;++mt){const yt=it[mt],bt=yt[dt],xt=yt[ft];yt[ht]=bt,yt[dt]=xt,yt.pop()}}else{const dt=--at,pt=_e[dt];dt>0&&(rt[pt.uuid]=ht),_e[ht]=pt,_e.pop();for(let ft=0,gt=nt;ft!==gt;++ft){const mt=it[ft];mt[ht]=mt[dt],mt.pop()}}}this.nCachedObjects_=st}subscribe_(_e,rt){const it=this._bindingsIndicesByPath;let nt=it[_e];const st=this._bindings;if(nt!==void 0)return st[nt];const at=this._paths,lt=this._parsedPaths,ot=this._objects,ct=ot.length,ut=this.nCachedObjects_,ht=new Array(ct);nt=st.length,it[_e]=nt,at.push(_e),lt.push(rt),st.push(ht);for(let dt=ut,pt=ot.length;dt!==pt;++dt){const ft=ot[dt];ht[dt]=new PropertyBinding(ft,_e,rt)}return ht}unsubscribe_(_e){const rt=this._bindingsIndicesByPath,it=rt[_e];if(it!==void 0){const nt=this._paths,st=this._parsedPaths,at=this._bindings,lt=at.length-1,ot=at[lt],ct=_e[lt];rt[ct]=it,at[it]=ot,at.pop(),st[it]=st[lt],st.pop(),nt[it]=nt[lt],nt.pop()}}}class AnimationAction{constructor(_e,rt,it=null,nt=rt.blendMode){this._mixer=_e,this._clip=rt,this._localRoot=it,this.blendMode=nt;const st=rt.tracks,at=st.length,lt=new Array(at),ot={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let ct=0;ct!==at;++ct){const ut=st[ct].createInterpolant(null);lt[ct]=ut,ut.settings=ot}this._interpolantSettings=ot,this._interpolants=lt,this._propertyBindings=new Array(at),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_e){return this._startTime=_e,this}setLoop(_e,rt){return this.loop=_e,this.repetitions=rt,this}setEffectiveWeight(_e){return this.weight=_e,this._effectiveWeight=this.enabled?_e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_e){return this._scheduleFading(_e,0,1)}fadeOut(_e){return this._scheduleFading(_e,1,0)}crossFadeFrom(_e,rt,it){if(_e.fadeOut(rt),this.fadeIn(rt),it){const nt=this._clip.duration,st=_e._clip.duration,at=st/nt,lt=nt/st;_e.warp(1,at,rt),this.warp(lt,1,rt)}return this}crossFadeTo(_e,rt,it){return _e.crossFadeFrom(this,rt,it)}stopFading(){const _e=this._weightInterpolant;return _e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_e)),this}setEffectiveTimeScale(_e){return this.timeScale=_e,this._effectiveTimeScale=this.paused?0:_e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_e){return this.timeScale=this._clip.duration/_e,this.stopWarping()}syncWith(_e){return this.time=_e.time,this.timeScale=_e.timeScale,this.stopWarping()}halt(_e){return this.warp(this._effectiveTimeScale,0,_e)}warp(_e,rt,it){const nt=this._mixer,st=nt.time,at=this.timeScale;let lt=this._timeScaleInterpolant;lt===null&&(lt=nt._lendControlInterpolant(),this._timeScaleInterpolant=lt);const ot=lt.parameterPositions,ct=lt.sampleValues;return ot[0]=st,ot[1]=st+it,ct[0]=_e/at,ct[1]=rt/at,this}stopWarping(){const _e=this._timeScaleInterpolant;return _e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_e,rt,it,nt){if(!this.enabled){this._updateWeight(_e);return}const st=this._startTime;if(st!==null){const ot=(_e-st)*it;ot<0||it===0?rt=0:(this._startTime=null,rt=it*ot)}rt*=this._updateTimeScale(_e);const at=this._updateTime(rt),lt=this._updateWeight(_e);if(lt>0){const ot=this._interpolants,ct=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let ut=0,ht=ot.length;ut!==ht;++ut)ot[ut].evaluate(at),ct[ut].accumulateAdditive(lt);break;case NormalAnimationBlendMode:default:for(let ut=0,ht=ot.length;ut!==ht;++ut)ot[ut].evaluate(at),ct[ut].accumulate(nt,lt)}}}_updateWeight(_e){let rt=0;if(this.enabled){rt=this.weight;const it=this._weightInterpolant;if(it!==null){const nt=it.evaluate(_e)[0];rt*=nt,_e>it.parameterPositions[1]&&(this.stopFading(),nt===0&&(this.enabled=!1))}}return this._effectiveWeight=rt,rt}_updateTimeScale(_e){let rt=0;if(!this.paused){rt=this.timeScale;const it=this._timeScaleInterpolant;if(it!==null){const nt=it.evaluate(_e)[0];rt*=nt,_e>it.parameterPositions[1]&&(this.stopWarping(),rt===0?this.paused=!0:this.timeScale=rt)}}return this._effectiveTimeScale=rt,rt}_updateTime(_e){const rt=this._clip.duration,it=this.loop;let nt=this.time+_e,st=this._loopCount;const at=it===LoopPingPong;if(_e===0)return st===-1?nt:at&&(st&1)===1?rt-nt:nt;if(it===LoopOnce){st===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(nt>=rt)nt=rt;else if(nt<0)nt=0;else{this.time=nt;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=nt,this._mixer.dispatchEvent({type:"finished",action:this,direction:_e<0?-1:1})}}else{if(st===-1&&(_e>=0?(st=0,this._setEndings(!0,this.repetitions===0,at)):this._setEndings(this.repetitions===0,!0,at)),nt>=rt||nt<0){const lt=Math.floor(nt/rt);nt-=rt*lt,st+=Math.abs(lt);const ot=this.repetitions-st;if(ot<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,nt=_e>0?rt:0,this.time=nt,this._mixer.dispatchEvent({type:"finished",action:this,direction:_e>0?1:-1});else{if(ot===1){const ct=_e<0;this._setEndings(ct,!ct,at)}else this._setEndings(!1,!1,at);this._loopCount=st,this.time=nt,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:lt})}}else this.time=nt;if(at&&(st&1)===1)return rt-nt}return nt}_setEndings(_e,rt,it){const nt=this._interpolantSettings;it?(nt.endingStart=ZeroSlopeEnding,nt.endingEnd=ZeroSlopeEnding):(_e?nt.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:nt.endingStart=WrapAroundEnding,rt?nt.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:nt.endingEnd=WrapAroundEnding)}_scheduleFading(_e,rt,it){const nt=this._mixer,st=nt.time;let at=this._weightInterpolant;at===null&&(at=nt._lendControlInterpolant(),this._weightInterpolant=at);const lt=at.parameterPositions,ot=at.sampleValues;return lt[0]=st,ot[0]=rt,lt[1]=st+_e,ot[1]=it,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(_e){super(),this._root=_e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_e,rt){const it=_e._localRoot||this._root,nt=_e._clip.tracks,st=nt.length,at=_e._propertyBindings,lt=_e._interpolants,ot=it.uuid,ct=this._bindingsByRootAndName;let ut=ct[ot];ut===void 0&&(ut={},ct[ot]=ut);for(let ht=0;ht!==st;++ht){const dt=nt[ht],pt=dt.name;let ft=ut[pt];if(ft!==void 0)++ft.referenceCount,at[ht]=ft;else{if(ft=at[ht],ft!==void 0){ft._cacheIndex===null&&(++ft.referenceCount,this._addInactiveBinding(ft,ot,pt));continue}const gt=rt&&rt._propertyBindings[ht].binding.parsedPath;ft=new PropertyMixer(PropertyBinding.create(it,pt,gt),dt.ValueTypeName,dt.getValueSize()),++ft.referenceCount,this._addInactiveBinding(ft,ot,pt),at[ht]=ft}lt[ht].resultBuffer=ft.buffer}}_activateAction(_e){if(!this._isActiveAction(_e)){if(_e._cacheIndex===null){const it=(_e._localRoot||this._root).uuid,nt=_e._clip.uuid,st=this._actionsByClip[nt];this._bindAction(_e,st&&st.knownActions[0]),this._addInactiveAction(_e,nt,it)}const rt=_e._propertyBindings;for(let it=0,nt=rt.length;it!==nt;++it){const st=rt[it];st.useCount++===0&&(this._lendBinding(st),st.saveOriginalState())}this._lendAction(_e)}}_deactivateAction(_e){if(this._isActiveAction(_e)){const rt=_e._propertyBindings;for(let it=0,nt=rt.length;it!==nt;++it){const st=rt[it];--st.useCount===0&&(st.restoreOriginalState(),this._takeBackBinding(st))}this._takeBackAction(_e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _e=this;this.stats={actions:{get total(){return _e._actions.length},get inUse(){return _e._nActiveActions}},bindings:{get total(){return _e._bindings.length},get inUse(){return _e._nActiveBindings}},controlInterpolants:{get total(){return _e._controlInterpolants.length},get inUse(){return _e._nActiveControlInterpolants}}}}_isActiveAction(_e){const rt=_e._cacheIndex;return rt!==null&&rt<this._nActiveActions}_addInactiveAction(_e,rt,it){const nt=this._actions,st=this._actionsByClip;let at=st[rt];if(at===void 0)at={knownActions:[_e],actionByRoot:{}},_e._byClipCacheIndex=0,st[rt]=at;else{const lt=at.knownActions;_e._byClipCacheIndex=lt.length,lt.push(_e)}_e._cacheIndex=nt.length,nt.push(_e),at.actionByRoot[it]=_e}_removeInactiveAction(_e){const rt=this._actions,it=rt[rt.length-1],nt=_e._cacheIndex;it._cacheIndex=nt,rt[nt]=it,rt.pop(),_e._cacheIndex=null;const st=_e._clip.uuid,at=this._actionsByClip,lt=at[st],ot=lt.knownActions,ct=ot[ot.length-1],ut=_e._byClipCacheIndex;ct._byClipCacheIndex=ut,ot[ut]=ct,ot.pop(),_e._byClipCacheIndex=null;const ht=lt.actionByRoot,dt=(_e._localRoot||this._root).uuid;delete ht[dt],ot.length===0&&delete at[st],this._removeInactiveBindingsForAction(_e)}_removeInactiveBindingsForAction(_e){const rt=_e._propertyBindings;for(let it=0,nt=rt.length;it!==nt;++it){const st=rt[it];--st.referenceCount===0&&this._removeInactiveBinding(st)}}_lendAction(_e){const rt=this._actions,it=_e._cacheIndex,nt=this._nActiveActions++,st=rt[nt];_e._cacheIndex=nt,rt[nt]=_e,st._cacheIndex=it,rt[it]=st}_takeBackAction(_e){const rt=this._actions,it=_e._cacheIndex,nt=--this._nActiveActions,st=rt[nt];_e._cacheIndex=nt,rt[nt]=_e,st._cacheIndex=it,rt[it]=st}_addInactiveBinding(_e,rt,it){const nt=this._bindingsByRootAndName,st=this._bindings;let at=nt[rt];at===void 0&&(at={},nt[rt]=at),at[it]=_e,_e._cacheIndex=st.length,st.push(_e)}_removeInactiveBinding(_e){const rt=this._bindings,it=_e.binding,nt=it.rootNode.uuid,st=it.path,at=this._bindingsByRootAndName,lt=at[nt],ot=rt[rt.length-1],ct=_e._cacheIndex;ot._cacheIndex=ct,rt[ct]=ot,rt.pop(),delete lt[st],Object.keys(lt).length===0&&delete at[nt]}_lendBinding(_e){const rt=this._bindings,it=_e._cacheIndex,nt=this._nActiveBindings++,st=rt[nt];_e._cacheIndex=nt,rt[nt]=_e,st._cacheIndex=it,rt[it]=st}_takeBackBinding(_e){const rt=this._bindings,it=_e._cacheIndex,nt=--this._nActiveBindings,st=rt[nt];_e._cacheIndex=nt,rt[nt]=_e,st._cacheIndex=it,rt[it]=st}_lendControlInterpolant(){const _e=this._controlInterpolants,rt=this._nActiveControlInterpolants++;let it=_e[rt];return it===void 0&&(it=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),it.__cacheIndex=rt,_e[rt]=it),it}_takeBackControlInterpolant(_e){const rt=this._controlInterpolants,it=_e.__cacheIndex,nt=--this._nActiveControlInterpolants,st=rt[nt];_e.__cacheIndex=nt,rt[nt]=_e,st.__cacheIndex=it,rt[it]=st}clipAction(_e,rt,it){const nt=rt||this._root,st=nt.uuid;let at=typeof _e=="string"?AnimationClip.findByName(nt,_e):_e;const lt=at!==null?at.uuid:_e,ot=this._actionsByClip[lt];let ct=null;if(it===void 0&&(at!==null?it=at.blendMode:it=NormalAnimationBlendMode),ot!==void 0){const ht=ot.actionByRoot[st];if(ht!==void 0&&ht.blendMode===it)return ht;ct=ot.knownActions[0],at===null&&(at=ct._clip)}if(at===null)return null;const ut=new AnimationAction(this,at,rt,it);return this._bindAction(ut,ct),this._addInactiveAction(ut,lt,st),ut}existingAction(_e,rt){const it=rt||this._root,nt=it.uuid,st=typeof _e=="string"?AnimationClip.findByName(it,_e):_e,at=st?st.uuid:_e,lt=this._actionsByClip[at];return lt!==void 0&&lt.actionByRoot[nt]||null}stopAllAction(){const _e=this._actions,rt=this._nActiveActions;for(let it=rt-1;it>=0;--it)_e[it].stop();return this}update(_e){_e*=this.timeScale;const rt=this._actions,it=this._nActiveActions,nt=this.time+=_e,st=Math.sign(_e),at=this._accuIndex^=1;for(let ct=0;ct!==it;++ct)rt[ct]._update(nt,_e,st,at);const lt=this._bindings,ot=this._nActiveBindings;for(let ct=0;ct!==ot;++ct)lt[ct].apply(at);return this}setTime(_e){this.time=0;for(let rt=0;rt<this._actions.length;rt++)this._actions[rt].time=0;return this.update(_e)}getRoot(){return this._root}uncacheClip(_e){const rt=this._actions,it=_e.uuid,nt=this._actionsByClip,st=nt[it];if(st!==void 0){const at=st.knownActions;for(let lt=0,ot=at.length;lt!==ot;++lt){const ct=at[lt];this._deactivateAction(ct);const ut=ct._cacheIndex,ht=rt[rt.length-1];ct._cacheIndex=null,ct._byClipCacheIndex=null,ht._cacheIndex=ut,rt[ut]=ht,rt.pop(),this._removeInactiveBindingsForAction(ct)}delete nt[it]}}uncacheRoot(_e){const rt=_e.uuid,it=this._actionsByClip;for(const at in it){const lt=it[at].actionByRoot,ot=lt[rt];ot!==void 0&&(this._deactivateAction(ot),this._removeInactiveAction(ot))}const nt=this._bindingsByRootAndName,st=nt[rt];if(st!==void 0)for(const at in st){const lt=st[at];lt.restoreOriginalState(),this._removeInactiveBinding(lt)}}uncacheAction(_e,rt){const it=this.existingAction(_e,rt);it!==null&&(this._deactivateAction(it),this._removeInactiveAction(it))}}class Uniform{constructor(_e){this.value=_e}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let id=0;class UniformsGroup extends EventDispatcher{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:id++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(_e){return this.uniforms.push(_e),this}remove(_e){const rt=this.uniforms.indexOf(_e);return rt!==-1&&this.uniforms.splice(rt,1),this}setName(_e){return this.name=_e,this}setUsage(_e){return this.usage=_e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(_e){this.name=_e.name,this.usage=_e.usage;const rt=_e.uniforms;this.uniforms.length=0;for(let it=0,nt=rt.length;it<nt;it++)this.uniforms.push(rt[it].clone());return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(_e,rt,it=1){super(_e,rt),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=it}copy(_e){return super.copy(_e),this.meshPerAttribute=_e.meshPerAttribute,this}clone(_e){const rt=super.clone(_e);return rt.meshPerAttribute=this.meshPerAttribute,rt}toJSON(_e){const rt=super.toJSON(_e);return rt.isInstancedInterleavedBuffer=!0,rt.meshPerAttribute=this.meshPerAttribute,rt}}class GLBufferAttribute{constructor(_e,rt,it,nt,st){this.isGLBufferAttribute=!0,this.name="",this.buffer=_e,this.type=rt,this.itemSize=it,this.elementSize=nt,this.count=st,this.version=0}set needsUpdate(_e){_e===!0&&this.version++}setBuffer(_e){return this.buffer=_e,this}setType(_e,rt){return this.type=_e,this.elementSize=rt,this}setItemSize(_e){return this.itemSize=_e,this}setCount(_e){return this.count=_e,this}}class Raycaster{constructor(_e,rt,it=0,nt=1/0){this.ray=new Ray$1(_e,rt),this.near=it,this.far=nt,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_e,rt){this.ray.set(_e,rt)}setFromCamera(_e,rt){rt.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(rt.matrixWorld),this.ray.direction.set(_e.x,_e.y,.5).unproject(rt).sub(this.ray.origin).normalize(),this.camera=rt):rt.isOrthographicCamera?(this.ray.origin.set(_e.x,_e.y,(rt.near+rt.far)/(rt.near-rt.far)).unproject(rt),this.ray.direction.set(0,0,-1).transformDirection(rt.matrixWorld),this.camera=rt):console.error("THREE.Raycaster: Unsupported camera type: "+rt.type)}intersectObject(_e,rt=!0,it=[]){return intersectObject(_e,this,it,rt),it.sort(ascSort),it}intersectObjects(_e,rt=!0,it=[]){for(let nt=0,st=_e.length;nt<st;nt++)intersectObject(_e[nt],this,it,rt);return it.sort(ascSort),it}}function ascSort(tt,_e){return tt.distance-_e.distance}function intersectObject(tt,_e,rt,it){if(tt.layers.test(_e.layers)&&tt.raycast(_e,rt),it===!0){const nt=tt.children;for(let st=0,at=nt.length;st<at;st++)intersectObject(nt[st],_e,rt,!0)}}class Spherical{constructor(_e=1,rt=0,it=0){return this.radius=_e,this.phi=rt,this.theta=it,this}set(_e,rt,it){return this.radius=_e,this.phi=rt,this.theta=it,this}copy(_e){return this.radius=_e.radius,this.phi=_e.phi,this.theta=_e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(_e){return this.setFromCartesianCoords(_e.x,_e.y,_e.z)}setFromCartesianCoords(_e,rt,it){return this.radius=Math.sqrt(_e*_e+rt*rt+it*it),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_e,it),this.phi=Math.acos(clamp$2(rt/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(_e=1,rt=0,it=0){return this.radius=_e,this.theta=rt,this.y=it,this}set(_e,rt,it){return this.radius=_e,this.theta=rt,this.y=it,this}copy(_e){return this.radius=_e.radius,this.theta=_e.theta,this.y=_e.y,this}setFromVector3(_e){return this.setFromCartesianCoords(_e.x,_e.y,_e.z)}setFromCartesianCoords(_e,rt,it){return this.radius=Math.sqrt(_e*_e+it*it),this.theta=Math.atan2(_e,it),this.y=rt,this}clone(){return new this.constructor().copy(this)}}const _vector$4=new Vector2;class Box2{constructor(_e=new Vector2(1/0,1/0),rt=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=_e,this.max=rt}set(_e,rt){return this.min.copy(_e),this.max.copy(rt),this}setFromPoints(_e){this.makeEmpty();for(let rt=0,it=_e.length;rt<it;rt++)this.expandByPoint(_e[rt]);return this}setFromCenterAndSize(_e,rt){const it=_vector$4.copy(rt).multiplyScalar(.5);return this.min.copy(_e).sub(it),this.max.copy(_e).add(it),this}clone(){return new this.constructor().copy(this)}copy(_e){return this.min.copy(_e.min),this.max.copy(_e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_e){return this.isEmpty()?_e.set(0,0):_e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_e){return this.isEmpty()?_e.set(0,0):_e.subVectors(this.max,this.min)}expandByPoint(_e){return this.min.min(_e),this.max.max(_e),this}expandByVector(_e){return this.min.sub(_e),this.max.add(_e),this}expandByScalar(_e){return this.min.addScalar(-_e),this.max.addScalar(_e),this}containsPoint(_e){return!(_e.x<this.min.x||_e.x>this.max.x||_e.y<this.min.y||_e.y>this.max.y)}containsBox(_e){return this.min.x<=_e.min.x&&_e.max.x<=this.max.x&&this.min.y<=_e.min.y&&_e.max.y<=this.max.y}getParameter(_e,rt){return rt.set((_e.x-this.min.x)/(this.max.x-this.min.x),(_e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_e){return!(_e.max.x<this.min.x||_e.min.x>this.max.x||_e.max.y<this.min.y||_e.min.y>this.max.y)}clampPoint(_e,rt){return rt.copy(_e).clamp(this.min,this.max)}distanceToPoint(_e){return this.clampPoint(_e,_vector$4).distanceTo(_e)}intersect(_e){return this.min.max(_e.min),this.max.min(_e.max),this.isEmpty()&&this.makeEmpty(),this}union(_e){return this.min.min(_e.min),this.max.max(_e.max),this}translate(_e){return this.min.add(_e),this.max.add(_e),this}equals(_e){return _e.min.equals(this.min)&&_e.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(_e=new Vector3,rt=new Vector3){this.start=_e,this.end=rt}set(_e,rt){return this.start.copy(_e),this.end.copy(rt),this}copy(_e){return this.start.copy(_e.start),this.end.copy(_e.end),this}getCenter(_e){return _e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_e){return _e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_e,rt){return this.delta(rt).multiplyScalar(_e).add(this.start)}closestPointToPointParameter(_e,rt){_startP.subVectors(_e,this.start),_startEnd.subVectors(this.end,this.start);const it=_startEnd.dot(_startEnd);let st=_startEnd.dot(_startP)/it;return rt&&(st=clamp$2(st,0,1)),st}closestPointToPoint(_e,rt,it){const nt=this.closestPointToPointParameter(_e,rt);return this.delta(it).multiplyScalar(nt).add(this.start)}applyMatrix4(_e){return this.start.applyMatrix4(_e),this.end.applyMatrix4(_e),this}equals(_e){return _e.start.equals(this.start)&&_e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3;class SpotLightHelper extends Object3D{constructor(_e,rt){super(),this.light=_e,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.color=rt,this.type="SpotLightHelper";const it=new BufferGeometry,nt=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let at=0,lt=1,ot=32;at<ot;at++,lt++){const ct=at/ot*Math.PI*2,ut=lt/ot*Math.PI*2;nt.push(Math.cos(ct),Math.sin(ct),1,Math.cos(ut),Math.sin(ut),1)}it.setAttribute("position",new Float32BufferAttribute(nt,3));const st=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(it,st),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const _e=this.light.distance?this.light.distance:1e3,rt=_e*Math.tan(this.light.angle);this.cone.scale.set(rt,rt,_e),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;class SkeletonHelper extends LineSegments{constructor(_e){const rt=getBoneList(_e),it=new BufferGeometry,nt=[],st=[],at=new Color$1(0,0,1),lt=new Color$1(0,1,0);for(let ct=0;ct<rt.length;ct++){const ut=rt[ct];ut.parent&&ut.parent.isBone&&(nt.push(0,0,0),nt.push(0,0,0),st.push(at.r,at.g,at.b),st.push(lt.r,lt.g,lt.b))}it.setAttribute("position",new Float32BufferAttribute(nt,3)),it.setAttribute("color",new Float32BufferAttribute(st,3));const ot=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(it,ot),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_e,this.bones=rt,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_e){const rt=this.bones,it=this.geometry,nt=it.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let st=0,at=0;st<rt.length;st++){const lt=rt[st];lt.parent&&lt.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,lt.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),nt.setXYZ(at,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,lt.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),nt.setXYZ(at+1,_vector$2.x,_vector$2.y,_vector$2.z),at+=2)}it.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(tt){const _e=[];tt.isBone===!0&&_e.push(tt);for(let rt=0;rt<tt.children.length;rt++)_e.push.apply(_e,getBoneList(tt.children[rt]));return _e}class PointLightHelper extends Mesh{constructor(_e,rt,it){const nt=new SphereGeometry(rt,4,2),st=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super(nt,st),this.light=_e,this.color=it,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color$1,_color2=new Color$1;class HemisphereLightHelper extends Object3D{constructor(_e,rt,it){super(),this.light=_e,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.color=it,this.type="HemisphereLightHelper";const nt=new OctahedronGeometry(rt);nt.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const st=nt.getAttribute("position"),at=new Float32Array(st.count*3);nt.setAttribute("color",new BufferAttribute(at,3)),this.add(new Mesh(nt,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const rt=_e.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let it=0,nt=rt.count;it<nt;it++){const st=it<nt/2?_color1:_color2;rt.setXYZ(it,st.r,st.g,st.b)}rt.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),_e.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(_e=10,rt=10,it=4473924,nt=8947848){it=new Color$1(it),nt=new Color$1(nt);const st=rt/2,at=_e/rt,lt=_e/2,ot=[],ct=[];for(let dt=0,pt=0,ft=-lt;dt<=rt;dt++,ft+=at){ot.push(-lt,0,ft,lt,0,ft),ot.push(ft,0,-lt,ft,0,lt);const gt=dt===st?it:nt;gt.toArray(ct,pt),pt+=3,gt.toArray(ct,pt),pt+=3,gt.toArray(ct,pt),pt+=3,gt.toArray(ct,pt),pt+=3}const ut=new BufferGeometry;ut.setAttribute("position",new Float32BufferAttribute(ot,3)),ut.setAttribute("color",new Float32BufferAttribute(ct,3));const ht=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(ut,ht),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(_e=10,rt=16,it=8,nt=64,st=4473924,at=8947848){st=new Color$1(st),at=new Color$1(at);const lt=[],ot=[];if(rt>1)for(let ht=0;ht<rt;ht++){const dt=ht/rt*(Math.PI*2),pt=Math.sin(dt)*_e,ft=Math.cos(dt)*_e;lt.push(0,0,0),lt.push(pt,0,ft);const gt=ht&1?st:at;ot.push(gt.r,gt.g,gt.b),ot.push(gt.r,gt.g,gt.b)}for(let ht=0;ht<it;ht++){const dt=ht&1?st:at,pt=_e-_e/it*ht;for(let ft=0;ft<nt;ft++){let gt=ft/nt*(Math.PI*2),mt=Math.sin(gt)*pt,At=Math.cos(gt)*pt;lt.push(mt,0,At),ot.push(dt.r,dt.g,dt.b),gt=(ft+1)/nt*(Math.PI*2),mt=Math.sin(gt)*pt,At=Math.cos(gt)*pt,lt.push(mt,0,At),ot.push(dt.r,dt.g,dt.b)}}const ct=new BufferGeometry;ct.setAttribute("position",new Float32BufferAttribute(lt,3)),ct.setAttribute("color",new Float32BufferAttribute(ot,3));const ut=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(ct,ut),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3,_v2=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(_e,rt,it){super(),this.light=_e,this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.color=it,this.type="DirectionalLightHelper",rt===void 0&&(rt=1);let nt=new BufferGeometry;nt.setAttribute("position",new Float32BufferAttribute([-rt,rt,0,rt,rt,0,rt,-rt,0,-rt,-rt,0,-rt,rt,0],3));const st=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(nt,st),this.add(this.lightPlane),nt=new BufferGeometry,nt.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(nt,st),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2,_v1),this.lightPlane.lookAt(_v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2),this.targetLine.scale.z=_v3.length()}}const _vector=new Vector3,_camera=new Camera;class CameraHelper extends LineSegments{constructor(_e){const rt=new BufferGeometry,it=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),nt=[],st=[],at={};lt("n1","n2"),lt("n2","n4"),lt("n4","n3"),lt("n3","n1"),lt("f1","f2"),lt("f2","f4"),lt("f4","f3"),lt("f3","f1"),lt("n1","f1"),lt("n2","f2"),lt("n3","f3"),lt("n4","f4"),lt("p","n1"),lt("p","n2"),lt("p","n3"),lt("p","n4"),lt("u1","u2"),lt("u2","u3"),lt("u3","u1"),lt("c","t"),lt("p","c"),lt("cn1","cn2"),lt("cn3","cn4"),lt("cf1","cf2"),lt("cf3","cf4");function lt(ft,gt){ot(ft),ot(gt)}function ot(ft){nt.push(0,0,0),st.push(0,0,0),at[ft]===void 0&&(at[ft]=[]),at[ft].push(nt.length/3-1)}rt.setAttribute("position",new Float32BufferAttribute(nt,3)),rt.setAttribute("color",new Float32BufferAttribute(st,3)),super(rt,it),this.type="CameraHelper",this.camera=_e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=at,this.update();const ct=new Color$1(16755200),ut=new Color$1(16711680),ht=new Color$1(43775),dt=new Color$1(16777215),pt=new Color$1(3355443);this.setColors(ct,ut,ht,dt,pt)}setColors(_e,rt,it,nt,st){const lt=this.geometry.getAttribute("color");lt.setXYZ(0,_e.r,_e.g,_e.b),lt.setXYZ(1,_e.r,_e.g,_e.b),lt.setXYZ(2,_e.r,_e.g,_e.b),lt.setXYZ(3,_e.r,_e.g,_e.b),lt.setXYZ(4,_e.r,_e.g,_e.b),lt.setXYZ(5,_e.r,_e.g,_e.b),lt.setXYZ(6,_e.r,_e.g,_e.b),lt.setXYZ(7,_e.r,_e.g,_e.b),lt.setXYZ(8,_e.r,_e.g,_e.b),lt.setXYZ(9,_e.r,_e.g,_e.b),lt.setXYZ(10,_e.r,_e.g,_e.b),lt.setXYZ(11,_e.r,_e.g,_e.b),lt.setXYZ(12,_e.r,_e.g,_e.b),lt.setXYZ(13,_e.r,_e.g,_e.b),lt.setXYZ(14,_e.r,_e.g,_e.b),lt.setXYZ(15,_e.r,_e.g,_e.b),lt.setXYZ(16,_e.r,_e.g,_e.b),lt.setXYZ(17,_e.r,_e.g,_e.b),lt.setXYZ(18,_e.r,_e.g,_e.b),lt.setXYZ(19,_e.r,_e.g,_e.b),lt.setXYZ(20,_e.r,_e.g,_e.b),lt.setXYZ(21,_e.r,_e.g,_e.b),lt.setXYZ(22,_e.r,_e.g,_e.b),lt.setXYZ(23,_e.r,_e.g,_e.b),lt.setXYZ(24,rt.r,rt.g,rt.b),lt.setXYZ(25,rt.r,rt.g,rt.b),lt.setXYZ(26,rt.r,rt.g,rt.b),lt.setXYZ(27,rt.r,rt.g,rt.b),lt.setXYZ(28,rt.r,rt.g,rt.b),lt.setXYZ(29,rt.r,rt.g,rt.b),lt.setXYZ(30,rt.r,rt.g,rt.b),lt.setXYZ(31,rt.r,rt.g,rt.b),lt.setXYZ(32,it.r,it.g,it.b),lt.setXYZ(33,it.r,it.g,it.b),lt.setXYZ(34,it.r,it.g,it.b),lt.setXYZ(35,it.r,it.g,it.b),lt.setXYZ(36,it.r,it.g,it.b),lt.setXYZ(37,it.r,it.g,it.b),lt.setXYZ(38,nt.r,nt.g,nt.b),lt.setXYZ(39,nt.r,nt.g,nt.b),lt.setXYZ(40,st.r,st.g,st.b),lt.setXYZ(41,st.r,st.g,st.b),lt.setXYZ(42,st.r,st.g,st.b),lt.setXYZ(43,st.r,st.g,st.b),lt.setXYZ(44,st.r,st.g,st.b),lt.setXYZ(45,st.r,st.g,st.b),lt.setXYZ(46,st.r,st.g,st.b),lt.setXYZ(47,st.r,st.g,st.b),lt.setXYZ(48,st.r,st.g,st.b),lt.setXYZ(49,st.r,st.g,st.b),lt.needsUpdate=!0}update(){const _e=this.geometry,rt=this.pointMap,it=1,nt=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",rt,_e,_camera,0,0,-1),setPoint("t",rt,_e,_camera,0,0,1),setPoint("n1",rt,_e,_camera,-it,-nt,-1),setPoint("n2",rt,_e,_camera,it,-nt,-1),setPoint("n3",rt,_e,_camera,-it,nt,-1),setPoint("n4",rt,_e,_camera,it,nt,-1),setPoint("f1",rt,_e,_camera,-it,-nt,1),setPoint("f2",rt,_e,_camera,it,-nt,1),setPoint("f3",rt,_e,_camera,-it,nt,1),setPoint("f4",rt,_e,_camera,it,nt,1),setPoint("u1",rt,_e,_camera,it*.7,nt*1.1,-1),setPoint("u2",rt,_e,_camera,-it*.7,nt*1.1,-1),setPoint("u3",rt,_e,_camera,0,nt*2,-1),setPoint("cf1",rt,_e,_camera,-it,0,1),setPoint("cf2",rt,_e,_camera,it,0,1),setPoint("cf3",rt,_e,_camera,0,-nt,1),setPoint("cf4",rt,_e,_camera,0,nt,1),setPoint("cn1",rt,_e,_camera,-it,0,-1),setPoint("cn2",rt,_e,_camera,it,0,-1),setPoint("cn3",rt,_e,_camera,0,-nt,-1),setPoint("cn4",rt,_e,_camera,0,nt,-1),_e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(tt,_e,rt,it,nt,st,at){_vector.set(nt,st,at).unproject(it);const lt=_e[tt];if(lt!==void 0){const ot=rt.getAttribute("position");for(let ct=0,ut=lt.length;ct<ut;ct++)ot.setXYZ(lt[ct],_vector.x,_vector.y,_vector.z)}}const _box=new Box3;class BoxHelper extends LineSegments{constructor(_e,rt=16776960){const it=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),nt=new Float32Array(8*3),st=new BufferGeometry;st.setIndex(new BufferAttribute(it,1)),st.setAttribute("position",new BufferAttribute(nt,3)),super(st,new LineBasicMaterial({color:rt,toneMapped:!1})),this.object=_e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(_e){if(_e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box.setFromObject(this.object),_box.isEmpty())return;const rt=_box.min,it=_box.max,nt=this.geometry.attributes.position,st=nt.array;st[0]=it.x,st[1]=it.y,st[2]=it.z,st[3]=rt.x,st[4]=it.y,st[5]=it.z,st[6]=rt.x,st[7]=rt.y,st[8]=it.z,st[9]=it.x,st[10]=rt.y,st[11]=it.z,st[12]=it.x,st[13]=it.y,st[14]=rt.z,st[15]=rt.x,st[16]=it.y,st[17]=rt.z,st[18]=rt.x,st[19]=rt.y,st[20]=rt.z,st[21]=it.x,st[22]=rt.y,st[23]=rt.z,nt.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_e){return this.object=_e,this.update(),this}copy(_e,rt){return super.copy(_e,rt),this.object=_e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(_e,rt=16776960){const it=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),nt=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],st=new BufferGeometry;st.setIndex(new BufferAttribute(it,1)),st.setAttribute("position",new Float32BufferAttribute(nt,3)),super(st,new LineBasicMaterial({color:rt,toneMapped:!1})),this.box=_e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_e){const rt=this.box;rt.isEmpty()||(rt.getCenter(this.position),rt.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line{constructor(_e,rt=1,it=16776960){const nt=it,st=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],at=new BufferGeometry;at.setAttribute("position",new Float32BufferAttribute(st,3)),at.computeBoundingSphere(),super(at,new LineBasicMaterial({color:nt,toneMapped:!1})),this.type="PlaneHelper",this.plane=_e,this.size=rt;const lt=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],ot=new BufferGeometry;ot.setAttribute("position",new Float32BufferAttribute(lt,3)),ot.computeBoundingSphere(),this.add(new Mesh(ot,new MeshBasicMaterial({color:nt,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(_e=new Vector3(0,0,1),rt=new Vector3(0,0,0),it=1,nt=16776960,st=it*.2,at=st*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(rt),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:nt,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:nt,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_e),this.setLength(it,st,at)}setDirection(_e){if(_e.y>.99999)this.quaternion.set(0,0,0,1);else if(_e.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(_e.z,0,-_e.x).normalize();const rt=Math.acos(_e.y);this.quaternion.setFromAxisAngle(_axis,rt)}}setLength(_e,rt=_e*.2,it=rt*.2){this.line.scale.set(1,Math.max(1e-4,_e-rt),1),this.line.updateMatrix(),this.cone.scale.set(it,rt,it),this.cone.position.y=_e,this.cone.updateMatrix()}setColor(_e){this.line.material.color.set(_e),this.cone.material.color.set(_e)}copy(_e){return super.copy(_e,!1),this.line.copy(_e.line),this.cone.copy(_e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(_e=1){const rt=[0,0,0,_e,0,0,0,0,0,0,_e,0,0,0,0,0,0,_e],it=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],nt=new BufferGeometry;nt.setAttribute("position",new Float32BufferAttribute(rt,3)),nt.setAttribute("color",new Float32BufferAttribute(it,3));const st=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(nt,st),this.type="AxesHelper"}setColors(_e,rt,it){const nt=new Color$1,st=this.geometry.attributes.color.array;return nt.set(_e),nt.toArray(st,0),nt.toArray(st,3),nt.set(rt),nt.toArray(st,6),nt.toArray(st,9),nt.set(it),nt.toArray(st,12),nt.toArray(st,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color$1,this.subPaths=[],this.currentPath=null}moveTo(_e,rt){return this.currentPath=new Path$1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_e,rt),this}lineTo(_e,rt){return this.currentPath.lineTo(_e,rt),this}quadraticCurveTo(_e,rt,it,nt){return this.currentPath.quadraticCurveTo(_e,rt,it,nt),this}bezierCurveTo(_e,rt,it,nt,st,at){return this.currentPath.bezierCurveTo(_e,rt,it,nt,st,at),this}splineThru(_e){return this.currentPath.splineThru(_e),this}toShapes(_e){function rt(At){const yt=[];for(let bt=0,xt=At.length;bt<xt;bt++){const vt=At[bt],_t=new Shape;_t.curves=vt.curves,yt.push(_t)}return yt}function it(At,yt){const bt=yt.length;let xt=!1;for(let vt=bt-1,_t=0;_t<bt;vt=_t++){let Ct=yt[vt],St=yt[_t],Et=St.x-Ct.x,Tt=St.y-Ct.y;if(Math.abs(Tt)>Number.EPSILON){if(Tt<0&&(Ct=yt[_t],Et=-Et,St=yt[vt],Tt=-Tt),At.y<Ct.y||At.y>St.y)continue;if(At.y===Ct.y){if(At.x===Ct.x)return!0}else{const Mt=Tt*(At.x-Ct.x)-Et*(At.y-Ct.y);if(Mt===0)return!0;if(Mt<0)continue;xt=!xt}}else{if(At.y!==Ct.y)continue;if(St.x<=At.x&&At.x<=Ct.x||Ct.x<=At.x&&At.x<=St.x)return!0}}return xt}const nt=ShapeUtils.isClockWise,st=this.subPaths;if(st.length===0)return[];let at,lt,ot;const ct=[];if(st.length===1)return lt=st[0],ot=new Shape,ot.curves=lt.curves,ct.push(ot),ct;let ut=!nt(st[0].getPoints());ut=_e?!ut:ut;const ht=[],dt=[];let pt=[],ft=0,gt;dt[ft]=void 0,pt[ft]=[];for(let At=0,yt=st.length;At<yt;At++)lt=st[At],gt=lt.getPoints(),at=nt(gt),at=_e?!at:at,at?(!ut&&dt[ft]&&ft++,dt[ft]={s:new Shape,p:gt},dt[ft].s.curves=lt.curves,ut&&ft++,pt[ft]=[]):pt[ft].push({h:lt,p:gt[0]});if(!dt[0])return rt(st);if(dt.length>1){let At=!1,yt=0;for(let bt=0,xt=dt.length;bt<xt;bt++)ht[bt]=[];for(let bt=0,xt=dt.length;bt<xt;bt++){const vt=pt[bt];for(let _t=0;_t<vt.length;_t++){const Ct=vt[_t];let St=!0;for(let Et=0;Et<dt.length;Et++)it(Ct.p,dt[Et].p)&&(bt!==Et&&yt++,St?(St=!1,ht[Et].push(Ct)):At=!0);St&&ht[bt].push(Ct)}}yt>0&&At===!1&&(pt=ht)}let mt;for(let At=0,yt=dt.length;At<yt;At++){ot=dt[At].s,ct.push(ot),mt=pt[At];for(let bt=0,xt=mt.length;bt<xt;bt++)ot.holes.push(mt[bt].h)}return ct}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const THREE=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AlphaFormat,AlwaysCompare,AlwaysDepth,AlwaysStencilFunc,AmbientLight,AmbientLightProbe,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache,Camera,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping,CircleGeometry,ClampToEdgeWrapping,Clock,Color:Color$1,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture:CompressedArrayTexture$1,CompressedTexture,CompressedTextureLoader,ConeGeometry,CubeCamera,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderGeometry,Cylindrical,Data3DTexture:Data3DTexture$1,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DisplayP3ColorSpace,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,Float64BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare,GreaterDepth,GreaterEqualCompare,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group,HalfFloatType,HemisphereLight,HemisphereLightHelper,HemisphereLightProbe,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheGeometry,Layers,LessCompare,LessDepth,LessEqualCompare,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearEncoding,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace,LinearToneMapping,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeverCompare,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualCompare,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronGeometry,OneFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path:Path$1,PerspectiveCamera,Plane,PlaneGeometry,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray:Ray$1,Raycaster,RectAreaLight,RedFormat,RedIntegerFormat,ReinhardToneMapping,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace,Scene,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape,ShapeGeometry,ShapePath,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronGeometry,Texture,TextureLoader,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,TwoPassDoubleSide,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoTexture,WebGL1Renderer,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem,WebGLCubeRenderTarget,WebGLMultipleRenderTargets,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WebGPUCoordinateSystem,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,_SRGBAFormat,sRGBEncoding},Symbol.toStringTag,{value:"Module"}));var constants={exports:{}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */reactReconcilerConstants_production_min.ConcurrentRoot=1;reactReconcilerConstants_production_min.ContinuousEventPriority=4;reactReconcilerConstants_production_min.DefaultEventPriority=16;reactReconcilerConstants_production_min.DiscreteEventPriority=1;reactReconcilerConstants_production_min.IdleEventPriority=536870912;reactReconcilerConstants_production_min.LegacyRoot=0;constants.exports=reactReconcilerConstants_production_min;var constantsExports=constants.exports;function createStore$1(tt){let _e;const rt=new Set,it=(ct,ut)=>{const ht=typeof ct=="function"?ct(_e):ct;if(ht!==_e){const dt=_e;_e=ut?ht:Object.assign({},_e,ht),rt.forEach(pt=>pt(_e,dt))}},nt=()=>_e,st=(ct,ut=nt,ht=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let dt=ut(_e);function pt(){const ft=ut(_e);if(!ht(dt,ft)){const gt=dt;ct(dt=ft,gt)}}return rt.add(pt),()=>rt.delete(pt)},ot={setState:it,getState:nt,subscribe:(ct,ut,ht)=>ut||ht?st(ct,ut,ht):(rt.add(ct),()=>rt.delete(ct)),destroy:()=>rt.clear()};return _e=tt(it,nt,ot),ot}const isSSR=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$2=isSSR?reactExports.useEffect:reactExports.useLayoutEffect;function create(tt){const _e=typeof tt=="function"?createStore$1(tt):tt,rt=(it=_e.getState,nt=Object.is)=>{const[,st]=reactExports.useReducer(mt=>mt+1,0),at=_e.getState(),lt=reactExports.useRef(at),ot=reactExports.useRef(it),ct=reactExports.useRef(nt),ut=reactExports.useRef(!1),ht=reactExports.useRef();ht.current===void 0&&(ht.current=it(at));let dt,pt=!1;(lt.current!==at||ot.current!==it||ct.current!==nt||ut.current)&&(dt=it(at),pt=!nt(ht.current,dt)),useIsomorphicLayoutEffect$2(()=>{pt&&(ht.current=dt),lt.current=at,ot.current=it,ct.current=nt,ut.current=!1});const ft=reactExports.useRef(at);useIsomorphicLayoutEffect$2(()=>{const mt=()=>{try{const yt=_e.getState(),bt=ot.current(yt);ct.current(ht.current,bt)||(lt.current=yt,ht.current=bt,st())}catch{ut.current=!0,st()}},At=_e.subscribe(mt);return _e.getState()!==ft.current&&mt(),At},[]);const gt=pt?dt:ht.current;return reactExports.useDebugValue(gt),gt};return Object.assign(rt,_e),rt[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const it=[rt,_e];return{next(){const nt=it.length<=0;return{value:it.shift(),done:nt}}}},rt}var reactReconciler={exports:{}},scheduler$1={exports:{}},scheduler_production_min$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(tt){function _e(Dt,Ft){var Ut=Dt.length;Dt.push(Ft);e:for(;0<Ut;){var $t=Ut-1>>>1,Vt=Dt[$t];if(0<nt(Vt,Ft))Dt[$t]=Ft,Dt[Ut]=Vt,Ut=$t;else break e}}function rt(Dt){return Dt.length===0?null:Dt[0]}function it(Dt){if(Dt.length===0)return null;var Ft=Dt[0],Ut=Dt.pop();if(Ut!==Ft){Dt[0]=Ut;e:for(var $t=0,Vt=Dt.length,Zt=Vt>>>1;$t<Zt;){var qt=2*($t+1)-1,sr=Dt[qt],er=qt+1,ir=Dt[er];if(0>nt(sr,Ut))er<Vt&&0>nt(ir,sr)?(Dt[$t]=ir,Dt[er]=Ut,$t=er):(Dt[$t]=sr,Dt[qt]=Ut,$t=qt);else if(er<Vt&&0>nt(ir,Ut))Dt[$t]=ir,Dt[er]=Ut,$t=er;else break e}}return Ft}function nt(Dt,Ft){var Ut=Dt.sortIndex-Ft.sortIndex;return Ut!==0?Ut:Dt.id-Ft.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;tt.unstable_now=function(){return st.now()}}else{var at=Date,lt=at.now();tt.unstable_now=function(){return at.now()-lt}}var ot=[],ct=[],ut=1,ht=null,dt=3,pt=!1,ft=!1,gt=!1,mt=typeof setTimeout=="function"?setTimeout:null,At=typeof clearTimeout=="function"?clearTimeout:null,yt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function bt(Dt){for(var Ft=rt(ct);Ft!==null;){if(Ft.callback===null)it(ct);else if(Ft.startTime<=Dt)it(ct),Ft.sortIndex=Ft.expirationTime,_e(ot,Ft);else break;Ft=rt(ct)}}function xt(Dt){if(gt=!1,bt(Dt),!ft)if(rt(ot)!==null)ft=!0,Nt(vt);else{var Ft=rt(ct);Ft!==null&&zt(xt,Ft.startTime-Dt)}}function vt(Dt,Ft){ft=!1,gt&&(gt=!1,At(St),St=-1),pt=!0;var Ut=dt;try{for(bt(Ft),ht=rt(ot);ht!==null&&(!(ht.expirationTime>Ft)||Dt&&!Mt());){var $t=ht.callback;if(typeof $t=="function"){ht.callback=null,dt=ht.priorityLevel;var Vt=$t(ht.expirationTime<=Ft);Ft=tt.unstable_now(),typeof Vt=="function"?ht.callback=Vt:ht===rt(ot)&&it(ot),bt(Ft)}else it(ot);ht=rt(ot)}if(ht!==null)var Zt=!0;else{var qt=rt(ct);qt!==null&&zt(xt,qt.startTime-Ft),Zt=!1}return Zt}finally{ht=null,dt=Ut,pt=!1}}var _t=!1,Ct=null,St=-1,Et=5,Tt=-1;function Mt(){return!(tt.unstable_now()-Tt<Et)}function Rt(){if(Ct!==null){var Dt=tt.unstable_now();Tt=Dt;var Ft=!0;try{Ft=Ct(!0,Dt)}finally{Ft?It():(_t=!1,Ct=null)}}else _t=!1}var It;if(typeof yt=="function")It=function(){yt(Rt)};else if(typeof MessageChannel<"u"){var Ot=new MessageChannel,Bt=Ot.port2;Ot.port1.onmessage=Rt,It=function(){Bt.postMessage(null)}}else It=function(){mt(Rt,0)};function Nt(Dt){Ct=Dt,_t||(_t=!0,It())}function zt(Dt,Ft){St=mt(function(){Dt(tt.unstable_now())},Ft)}tt.unstable_IdlePriority=5,tt.unstable_ImmediatePriority=1,tt.unstable_LowPriority=4,tt.unstable_NormalPriority=3,tt.unstable_Profiling=null,tt.unstable_UserBlockingPriority=2,tt.unstable_cancelCallback=function(Dt){Dt.callback=null},tt.unstable_continueExecution=function(){ft||pt||(ft=!0,Nt(vt))},tt.unstable_forceFrameRate=function(Dt){0>Dt||125<Dt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Et=0<Dt?Math.floor(1e3/Dt):5},tt.unstable_getCurrentPriorityLevel=function(){return dt},tt.unstable_getFirstCallbackNode=function(){return rt(ot)},tt.unstable_next=function(Dt){switch(dt){case 1:case 2:case 3:var Ft=3;break;default:Ft=dt}var Ut=dt;dt=Ft;try{return Dt()}finally{dt=Ut}},tt.unstable_pauseExecution=function(){},tt.unstable_requestPaint=function(){},tt.unstable_runWithPriority=function(Dt,Ft){switch(Dt){case 1:case 2:case 3:case 4:case 5:break;default:Dt=3}var Ut=dt;dt=Dt;try{return Ft()}finally{dt=Ut}},tt.unstable_scheduleCallback=function(Dt,Ft,Ut){var $t=tt.unstable_now();switch(typeof Ut=="object"&&Ut!==null?(Ut=Ut.delay,Ut=typeof Ut=="number"&&0<Ut?$t+Ut:$t):Ut=$t,Dt){case 1:var Vt=-1;break;case 2:Vt=250;break;case 5:Vt=1073741823;break;case 4:Vt=1e4;break;default:Vt=5e3}return Vt=Ut+Vt,Dt={id:ut++,callback:Ft,priorityLevel:Dt,startTime:Ut,expirationTime:Vt,sortIndex:-1},Ut>$t?(Dt.sortIndex=Ut,_e(ct,Dt),rt(ot)===null&&Dt===rt(ct)&&(gt?(At(St),St=-1):gt=!0,zt(xt,Ut-$t))):(Dt.sortIndex=Vt,_e(ot,Dt),ft||pt||(ft=!0,Nt(vt))),Dt},tt.unstable_shouldYield=Mt,tt.unstable_wrapCallback=function(Dt){var Ft=dt;return function(){var Ut=dt;dt=Ft;try{return Dt.apply(this,arguments)}finally{dt=Ut}}}}(scheduler_production_min$1)),scheduler_production_min$1}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler$1.exports=requireScheduler_production_min()),scheduler$1.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min=function(_e){var rt={},it=reactExports,nt=requireScheduler(),st=Object.assign;function at(wt){for(var Pt="https://reactjs.org/docs/error-decoder.html?invariant="+wt,kt=1;kt<arguments.length;kt++)Pt+="&args[]="+encodeURIComponent(arguments[kt]);return"Minified React error #"+wt+"; visit "+Pt+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lt=it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ot=Symbol.for("react.element"),ct=Symbol.for("react.portal"),ut=Symbol.for("react.fragment"),ht=Symbol.for("react.strict_mode"),dt=Symbol.for("react.profiler"),pt=Symbol.for("react.provider"),ft=Symbol.for("react.context"),gt=Symbol.for("react.forward_ref"),mt=Symbol.for("react.suspense"),At=Symbol.for("react.suspense_list"),yt=Symbol.for("react.memo"),bt=Symbol.for("react.lazy"),xt=Symbol.for("react.offscreen"),vt=Symbol.iterator;function _t(wt){return wt===null||typeof wt!="object"?null:(wt=vt&&wt[vt]||wt["@@iterator"],typeof wt=="function"?wt:null)}function Ct(wt){if(wt==null)return null;if(typeof wt=="function")return wt.displayName||wt.name||null;if(typeof wt=="string")return wt;switch(wt){case ut:return"Fragment";case ct:return"Portal";case dt:return"Profiler";case ht:return"StrictMode";case mt:return"Suspense";case At:return"SuspenseList"}if(typeof wt=="object")switch(wt.$$typeof){case ft:return(wt.displayName||"Context")+".Consumer";case pt:return(wt._context.displayName||"Context")+".Provider";case gt:var Pt=wt.render;return wt=wt.displayName,wt||(wt=Pt.displayName||Pt.name||"",wt=wt!==""?"ForwardRef("+wt+")":"ForwardRef"),wt;case yt:return Pt=wt.displayName||null,Pt!==null?Pt:Ct(wt.type)||"Memo";case bt:Pt=wt._payload,wt=wt._init;try{return Ct(wt(Pt))}catch{}}return null}function St(wt){var Pt=wt.type;switch(wt.tag){case 24:return"Cache";case 9:return(Pt.displayName||"Context")+".Consumer";case 10:return(Pt._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return wt=Pt.render,wt=wt.displayName||wt.name||"",Pt.displayName||(wt!==""?"ForwardRef("+wt+")":"ForwardRef");case 7:return"Fragment";case 5:return Pt;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ct(Pt);case 8:return Pt===ht?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof Pt=="function")return Pt.displayName||Pt.name||null;if(typeof Pt=="string")return Pt}return null}function Et(wt){var Pt=wt,kt=wt;if(wt.alternate)for(;Pt.return;)Pt=Pt.return;else{wt=Pt;do Pt=wt,Pt.flags&4098&&(kt=Pt.return),wt=Pt.return;while(wt)}return Pt.tag===3?kt:null}function Tt(wt){if(Et(wt)!==wt)throw Error(at(188))}function Mt(wt){var Pt=wt.alternate;if(!Pt){if(Pt=Et(wt),Pt===null)throw Error(at(188));return Pt!==wt?null:wt}for(var kt=wt,Lt=Pt;;){var Gt=kt.return;if(Gt===null)break;var Ht=Gt.alternate;if(Ht===null){if(Lt=Gt.return,Lt!==null){kt=Lt;continue}break}if(Gt.child===Ht.child){for(Ht=Gt.child;Ht;){if(Ht===kt)return Tt(Gt),wt;if(Ht===Lt)return Tt(Gt),Pt;Ht=Ht.sibling}throw Error(at(188))}if(kt.return!==Lt.return)kt=Gt,Lt=Ht;else{for(var dr=!1,Pr=Gt.child;Pr;){if(Pr===kt){dr=!0,kt=Gt,Lt=Ht;break}if(Pr===Lt){dr=!0,Lt=Gt,kt=Ht;break}Pr=Pr.sibling}if(!dr){for(Pr=Ht.child;Pr;){if(Pr===kt){dr=!0,kt=Ht,Lt=Gt;break}if(Pr===Lt){dr=!0,Lt=Ht,kt=Gt;break}Pr=Pr.sibling}if(!dr)throw Error(at(189))}}if(kt.alternate!==Lt)throw Error(at(190))}if(kt.tag!==3)throw Error(at(188));return kt.stateNode.current===kt?wt:Pt}function Rt(wt){return wt=Mt(wt),wt!==null?It(wt):null}function It(wt){if(wt.tag===5||wt.tag===6)return wt;for(wt=wt.child;wt!==null;){var Pt=It(wt);if(Pt!==null)return Pt;wt=wt.sibling}return null}function Ot(wt){if(wt.tag===5||wt.tag===6)return wt;for(wt=wt.child;wt!==null;){if(wt.tag!==4){var Pt=Ot(wt);if(Pt!==null)return Pt}wt=wt.sibling}return null}var Bt=Array.isArray,Nt=_e.getPublicInstance,zt=_e.getRootHostContext,Dt=_e.getChildHostContext,Ft=_e.prepareForCommit,Ut=_e.resetAfterCommit,$t=_e.createInstance,Vt=_e.appendInitialChild,Zt=_e.finalizeInitialChildren,qt=_e.prepareUpdate,sr=_e.shouldSetTextContent,er=_e.createTextInstance,ir=_e.scheduleTimeout,ur=_e.cancelTimeout,ar=_e.noTimeout,lr=_e.isPrimaryRenderer,gr=_e.supportsMutation,Yt=_e.supportsPersistence,nr=_e.supportsHydration,mr=_e.getInstanceFromNode,Sr=_e.preparePortalMount,Er=_e.getCurrentEventPriority,Nr=_e.detachDeletedInstance,wr=_e.supportsMicrotasks,kr=_e.scheduleMicrotask,Ur=_e.supportsTestSelectors,Or=_e.findFiberRoot,Xr=_e.getBoundingRect,Qt=_e.getTextContent,Xt=_e.isHiddenSubtree,xr=_e.matchAccessibilityRole,Lr=_e.setFocusIfFocusable,fr=_e.setupIntersectionObserver,pr=_e.appendChild,Hr=_e.appendChildToContainer,hr=_e.commitTextUpdate,Cr=_e.commitMount,tr=_e.commitUpdate,Ar=_e.insertBefore,yr=_e.insertInContainerBefore,Jt=_e.removeChild,_r=_e.removeChildFromContainer,Kt=_e.resetTextContent,Qr=_e.hideInstance,br=_e.hideTextInstance,Rr=_e.unhideInstance,Tr=_e.unhideTextInstance,Vr=_e.clearContainer,Wr=_e.cloneInstance,pn=_e.createContainerChildSet,En=_e.appendChildToContainerChildSet,rn=_e.finalizeContainerChildren,Cn=_e.replaceContainerChildren,vn=_e.cloneHiddenInstance,an=_e.cloneHiddenTextInstance,yn=_e.canHydrateInstance,Gn=_e.canHydrateTextInstance,Pn=_e.canHydrateSuspenseInstance,Sn=_e.isSuspenseInstancePending,In=_e.isSuspenseInstanceFallback,jn=_e.registerSuspenseInstanceRetry,_n=_e.getNextHydratableSibling,nn=_e.getFirstHydratableChild,Nn=_e.getFirstHydratableChildWithinContainer,bs=_e.getFirstHydratableChildWithinSuspenseInstance,Wt=_e.hydrateInstance,jt=_e.hydrateTextInstance,rr=_e.hydrateSuspenseInstance,cr=_e.getNextHydratableInstanceAfterSuspenseInstance,or=_e.commitHydratedContainer,vr=_e.commitHydratedSuspenseInstance,Br=_e.clearSuspenseBoundary,Dr=_e.clearSuspenseBoundaryFromContainer,Gr=_e.shouldDeleteUnhydratedTailInstances,zr=_e.didNotMatchHydratedContainerTextInstance,Yr=_e.didNotMatchHydratedTextInstance,Mr;function Zr(wt){if(Mr===void 0)try{throw Error()}catch(kt){var Pt=kt.stack.trim().match(/\n( *(at )?)/);Mr=Pt&&Pt[1]||""}return`
`+Mr+wt}var Kr=!1;function qr(wt,Pt){if(!wt||Kr)return"";Kr=!0;var kt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(Pt)if(Pt=function(){throw Error()},Object.defineProperty(Pt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pt,[])}catch(Jr){var Lt=Jr}Reflect.construct(wt,[],Pt)}else{try{Pt.call()}catch(Jr){Lt=Jr}wt.call(Pt.prototype)}else{try{throw Error()}catch(Jr){Lt=Jr}wt()}}catch(Jr){if(Jr&&Lt&&typeof Jr.stack=="string"){for(var Gt=Jr.stack.split(`
`),Ht=Lt.stack.split(`
`),dr=Gt.length-1,Pr=Ht.length-1;1<=dr&&0<=Pr&&Gt[dr]!==Ht[Pr];)Pr--;for(;1<=dr&&0<=Pr;dr--,Pr--)if(Gt[dr]!==Ht[Pr]){if(dr!==1||Pr!==1)do if(dr--,Pr--,0>Pr||Gt[dr]!==Ht[Pr]){var jr=`
`+Gt[dr].replace(" at new "," at ");return wt.displayName&&jr.includes("<anonymous>")&&(jr=jr.replace("<anonymous>",wt.displayName)),jr}while(1<=dr&&0<=Pr);break}}}finally{Kr=!1,Error.prepareStackTrace=kt}return(wt=wt?wt.displayName||wt.name:"")?Zr(wt):""}var ln=Object.prototype.hasOwnProperty,dn=[],cn=-1;function _i(wt){return{current:wt}}function fn(wt){0>cn||(wt.current=dn[cn],dn[cn]=null,cn--)}function on(wt,Pt){cn++,dn[cn]=wt.current,wt.current=Pt}var An={},Bn=_i(An),mn=_i(!1),Dn=An;function On(wt,Pt){var kt=wt.type.contextTypes;if(!kt)return An;var Lt=wt.stateNode;if(Lt&&Lt.__reactInternalMemoizedUnmaskedChildContext===Pt)return Lt.__reactInternalMemoizedMaskedChildContext;var Gt={},Ht;for(Ht in kt)Gt[Ht]=Pt[Ht];return Lt&&(wt=wt.stateNode,wt.__reactInternalMemoizedUnmaskedChildContext=Pt,wt.__reactInternalMemoizedMaskedChildContext=Gt),Gt}function Fn(wt){return wt=wt.childContextTypes,wt!=null}function zn(){fn(mn),fn(Bn)}function bn(wt,Pt,kt){if(Bn.current!==An)throw Error(at(168));on(Bn,Pt),on(mn,kt)}function Vn(wt,Pt,kt){var Lt=wt.stateNode;if(Pt=Pt.childContextTypes,typeof Lt.getChildContext!="function")return kt;Lt=Lt.getChildContext();for(var Gt in Lt)if(!(Gt in Pt))throw Error(at(108,St(wt)||"Unknown",Gt));return st({},kt,Lt)}function Ln(wt){return wt=(wt=wt.stateNode)&&wt.__reactInternalMemoizedMergedChildContext||An,Dn=Bn.current,on(Bn,wt),on(mn,mn.current),!0}function xn(wt,Pt,kt){var Lt=wt.stateNode;if(!Lt)throw Error(at(169));kt?(wt=Vn(wt,Pt,Dn),Lt.__reactInternalMemoizedMergedChildContext=wt,fn(mn),fn(Bn),on(Bn,wt)):fn(mn),on(mn,kt)}var Yn=Math.clz32?Math.clz32:Ts,_s=Math.log,qn=Math.LN2;function Ts(wt){return wt>>>=0,wt===0?32:31-(_s(wt)/qn|0)|0}var Js=64,qs=4194304;function Ks(wt){switch(wt&-wt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return wt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return wt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return wt}}function vo(wt,Pt){var kt=wt.pendingLanes;if(kt===0)return 0;var Lt=0,Gt=wt.suspendedLanes,Ht=wt.pingedLanes,dr=kt&268435455;if(dr!==0){var Pr=dr&~Gt;Pr!==0?Lt=Ks(Pr):(Ht&=dr,Ht!==0&&(Lt=Ks(Ht)))}else dr=kt&~Gt,dr!==0?Lt=Ks(dr):Ht!==0&&(Lt=Ks(Ht));if(Lt===0)return 0;if(Pt!==0&&Pt!==Lt&&!(Pt&Gt)&&(Gt=Lt&-Lt,Ht=Pt&-Pt,Gt>=Ht||Gt===16&&(Ht&4194240)!==0))return Pt;if(Lt&4&&(Lt|=kt&16),Pt=wt.entangledLanes,Pt!==0)for(wt=wt.entanglements,Pt&=Lt;0<Pt;)kt=31-Yn(Pt),Gt=1<<kt,Lt|=wt[kt],Pt&=~Gt;return Lt}function Il(wt,Pt){switch(wt){case 1:case 2:case 4:return Pt+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Pt+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yo(wt,Pt){for(var kt=wt.suspendedLanes,Lt=wt.pingedLanes,Gt=wt.expirationTimes,Ht=wt.pendingLanes;0<Ht;){var dr=31-Yn(Ht),Pr=1<<dr,jr=Gt[dr];jr===-1?(!(Pr&kt)||Pr&Lt)&&(Gt[dr]=Il(Pr,Pt)):jr<=Pt&&(wt.expiredLanes|=Pr),Ht&=~Pr}}function Zs(wt){return wt=wt.pendingLanes&-1073741825,wt!==0?wt:wt&1073741824?1073741824:0}function Oo(wt){for(var Pt=[],kt=0;31>kt;kt++)Pt.push(wt);return Pt}function Vs(wt,Pt,kt){wt.pendingLanes|=Pt,Pt!==536870912&&(wt.suspendedLanes=0,wt.pingedLanes=0),wt=wt.eventTimes,Pt=31-Yn(Pt),wt[Pt]=kt}function oo(wt,Pt){var kt=wt.pendingLanes&~Pt;wt.pendingLanes=Pt,wt.suspendedLanes=0,wt.pingedLanes=0,wt.expiredLanes&=Pt,wt.mutableReadLanes&=Pt,wt.entangledLanes&=Pt,Pt=wt.entanglements;var Lt=wt.eventTimes;for(wt=wt.expirationTimes;0<kt;){var Gt=31-Yn(kt),Ht=1<<Gt;Pt[Gt]=0,Lt[Gt]=-1,wt[Gt]=-1,kt&=~Ht}}function Hs(wt,Pt){var kt=wt.entangledLanes|=Pt;for(wt=wt.entanglements;kt;){var Lt=31-Yn(kt),Gt=1<<Lt;Gt&Pt|wt[Lt]&Pt&&(wt[Lt]|=Pt),kt&=~Gt}}var kn=0;function Xo(wt){return wt&=-wt,1<wt?4<wt?wt&268435455?16:536870912:4:1}var eo=nt.unstable_scheduleCallback,ko=nt.unstable_cancelCallback,Wo=nt.unstable_shouldYield,Ol=nt.unstable_requestPaint,Wn=nt.unstable_now,yo=nt.unstable_ImmediatePriority,Nl=nt.unstable_UserBlockingPriority,fs=nt.unstable_NormalPriority,Qo=nt.unstable_IdlePriority,Ao=null,ws=null;function Jo(wt){if(ws&&typeof ws.onCommitFiberRoot=="function")try{ws.onCommitFiberRoot(Ao,wt,void 0,(wt.current.flags&128)===128)}catch{}}function Ll(wt,Pt){return wt===Pt&&(wt!==0||1/wt===1/Pt)||wt!==wt&&Pt!==Pt}var Ps=typeof Object.is=="function"?Object.is:Ll,gs=null,Ys=!1,Ns=!1;function qo(wt){gs===null?gs=[wt]:gs.push(wt)}function Ko(wt){Ys=!0,qo(wt)}function Cs(){if(!Ns&&gs!==null){Ns=!0;var wt=0,Pt=kn;try{var kt=gs;for(kn=1;wt<kt.length;wt++){var Lt=kt[wt];do Lt=Lt(!0);while(Lt!==null)}gs=null,Ys=!1}catch(Gt){throw gs!==null&&(gs=gs.slice(wt+1)),eo(yo,Cs),Gt}finally{kn=Pt,Ns=!1}}return null}var bo=lt.ReactCurrentBatchConfig;function _o(wt,Pt){if(Ps(wt,Pt))return!0;if(typeof wt!="object"||wt===null||typeof Pt!="object"||Pt===null)return!1;var kt=Object.keys(wt),Lt=Object.keys(Pt);if(kt.length!==Lt.length)return!1;for(Lt=0;Lt<kt.length;Lt++){var Gt=kt[Lt];if(!ln.call(Pt,Gt)||!Ps(wt[Gt],Pt[Gt]))return!1}return!0}function Co(wt){switch(wt.tag){case 5:return Zr(wt.type);case 16:return Zr("Lazy");case 13:return Zr("Suspense");case 19:return Zr("SuspenseList");case 0:case 2:case 15:return wt=qr(wt.type,!1),wt;case 11:return wt=qr(wt.type.render,!1),wt;case 1:return wt=qr(wt.type,!0),wt;default:return""}}function ms(wt,Pt){if(wt&&wt.defaultProps){Pt=st({},Pt),wt=wt.defaultProps;for(var kt in wt)Pt[kt]===void 0&&(Pt[kt]=wt[kt]);return Pt}return Pt}var ss=_i(null),No=null,zs=null,ao=null;function Lo(){ao=zs=No=null}function Bl(wt,Pt,kt){lr?(on(ss,Pt._currentValue),Pt._currentValue=kt):(on(ss,Pt._currentValue2),Pt._currentValue2=kt)}function os(wt){var Pt=ss.current;fn(ss),lr?wt._currentValue=Pt:wt._currentValue2=Pt}function vs(wt,Pt,kt){for(;wt!==null;){var Lt=wt.alternate;if((wt.childLanes&Pt)!==Pt?(wt.childLanes|=Pt,Lt!==null&&(Lt.childLanes|=Pt)):Lt!==null&&(Lt.childLanes&Pt)!==Pt&&(Lt.childLanes|=Pt),wt===kt)break;wt=wt.return}}function Kn(wt,Pt){No=wt,ao=zs=null,wt=wt.dependencies,wt!==null&&wt.firstContext!==null&&(wt.lanes&Pt&&(Os=!0),wt.firstContext=null)}function Zn(wt){var Pt=lr?wt._currentValue:wt._currentValue2;if(ao!==wt)if(wt={context:wt,memoizedValue:Pt,next:null},zs===null){if(No===null)throw Error(at(308));zs=wt,No.dependencies={lanes:0,firstContext:wt}}else zs=zs.next=wt;return Pt}var Ms=null,lo=!1;function Cu(wt){wt.updateQueue={baseState:wt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pp(wt,Pt){wt=wt.updateQueue,Pt.updateQueue===wt&&(Pt.updateQueue={baseState:wt.baseState,firstBaseUpdate:wt.firstBaseUpdate,lastBaseUpdate:wt.lastBaseUpdate,shared:wt.shared,effects:wt.effects})}function to(wt,Pt){return{eventTime:wt,lane:Pt,tag:0,payload:null,callback:null,next:null}}function co(wt,Pt){var kt=wt.updateQueue;kt!==null&&(kt=kt.shared,ts!==null&&wt.mode&1&&!(Rn&2)?(wt=kt.interleaved,wt===null?(Pt.next=Pt,Ms===null?Ms=[kt]:Ms.push(kt)):(Pt.next=wt.next,wt.next=Pt),kt.interleaved=Pt):(wt=kt.pending,wt===null?Pt.next=Pt:(Pt.next=wt.next,wt.next=Pt),kt.pending=Pt))}function Dl(wt,Pt,kt){if(Pt=Pt.updateQueue,Pt!==null&&(Pt=Pt.shared,(kt&4194240)!==0)){var Lt=Pt.lanes;Lt&=wt.pendingLanes,kt|=Lt,Pt.lanes=kt,Hs(wt,kt)}}function fp(wt,Pt){var kt=wt.updateQueue,Lt=wt.alternate;if(Lt!==null&&(Lt=Lt.updateQueue,kt===Lt)){var Gt=null,Ht=null;if(kt=kt.firstBaseUpdate,kt!==null){do{var dr={eventTime:kt.eventTime,lane:kt.lane,tag:kt.tag,payload:kt.payload,callback:kt.callback,next:null};Ht===null?Gt=Ht=dr:Ht=Ht.next=dr,kt=kt.next}while(kt!==null);Ht===null?Gt=Ht=Pt:Ht=Ht.next=Pt}else Gt=Ht=Pt;kt={baseState:Lt.baseState,firstBaseUpdate:Gt,lastBaseUpdate:Ht,shared:Lt.shared,effects:Lt.effects},wt.updateQueue=kt;return}wt=kt.lastBaseUpdate,wt===null?kt.firstBaseUpdate=Pt:wt.next=Pt,kt.lastBaseUpdate=Pt}function Fl(wt,Pt,kt,Lt){var Gt=wt.updateQueue;lo=!1;var Ht=Gt.firstBaseUpdate,dr=Gt.lastBaseUpdate,Pr=Gt.shared.pending;if(Pr!==null){Gt.shared.pending=null;var jr=Pr,Jr=jr.next;jr.next=null,dr===null?Ht=Jr:dr.next=Jr,dr=jr;var sn=wt.alternate;sn!==null&&(sn=sn.updateQueue,Pr=sn.lastBaseUpdate,Pr!==dr&&(Pr===null?sn.firstBaseUpdate=Jr:Pr.next=Jr,sn.lastBaseUpdate=jr))}if(Ht!==null){var Tn=Gt.baseState;dr=0,sn=Jr=jr=null,Pr=Ht;do{var gn=Pr.lane,Hn=Pr.eventTime;if((Lt&gn)===gn){sn!==null&&(sn=sn.next={eventTime:Hn,lane:0,tag:Pr.tag,payload:Pr.payload,callback:Pr.callback,next:null});e:{var hn=wt,ps=Pr;switch(gn=Pt,Hn=kt,ps.tag){case 1:if(hn=ps.payload,typeof hn=="function"){Tn=hn.call(Hn,Tn,gn);break e}Tn=hn;break e;case 3:hn.flags=hn.flags&-65537|128;case 0:if(hn=ps.payload,gn=typeof hn=="function"?hn.call(Hn,Tn,gn):hn,gn==null)break e;Tn=st({},Tn,gn);break e;case 2:lo=!0}}Pr.callback!==null&&Pr.lane!==0&&(wt.flags|=64,gn=Gt.effects,gn===null?Gt.effects=[Pr]:gn.push(Pr))}else Hn={eventTime:Hn,lane:gn,tag:Pr.tag,payload:Pr.payload,callback:Pr.callback,next:null},sn===null?(Jr=sn=Hn,jr=Tn):sn=sn.next=Hn,dr|=gn;if(Pr=Pr.next,Pr===null){if(Pr=Gt.shared.pending,Pr===null)break;gn=Pr,Pr=gn.next,gn.next=null,Gt.lastBaseUpdate=gn,Gt.shared.pending=null}}while(1);if(sn===null&&(jr=Tn),Gt.baseState=jr,Gt.firstBaseUpdate=Jr,Gt.lastBaseUpdate=sn,Pt=Gt.shared.interleaved,Pt!==null){Gt=Pt;do dr|=Gt.lane,Gt=Gt.next;while(Gt!==Pt)}else Ht===null&&(Gt.shared.lanes=0);Vo|=dr,wt.lanes=dr,wt.memoizedState=Tn}}function gp(wt,Pt,kt){if(wt=Pt.effects,Pt.effects=null,wt!==null)for(Pt=0;Pt<wt.length;Pt++){var Lt=wt[Pt],Gt=Lt.callback;if(Gt!==null){if(Lt.callback=null,Lt=kt,typeof Gt!="function")throw Error(at(191,Gt));Gt.call(Lt)}}}var mp=new it.Component().refs;function xu(wt,Pt,kt,Lt){Pt=wt.memoizedState,kt=kt(Lt,Pt),kt=kt==null?Pt:st({},Pt,kt),wt.memoizedState=kt,wt.lanes===0&&(wt.updateQueue.baseState=kt)}var Ul={isMounted:function(wt){return(wt=wt._reactInternals)?Et(wt)===wt:!1},enqueueSetState:function(wt,Pt,kt){wt=wt._reactInternals;var Lt=As(),Gt=po(wt),Ht=to(Lt,Gt);Ht.payload=Pt,kt!=null&&(Ht.callback=kt),co(wt,Ht),Pt=Us(wt,Gt,Lt),Pt!==null&&Dl(Pt,wt,Gt)},enqueueReplaceState:function(wt,Pt,kt){wt=wt._reactInternals;var Lt=As(),Gt=po(wt),Ht=to(Lt,Gt);Ht.tag=1,Ht.payload=Pt,kt!=null&&(Ht.callback=kt),co(wt,Ht),Pt=Us(wt,Gt,Lt),Pt!==null&&Dl(Pt,wt,Gt)},enqueueForceUpdate:function(wt,Pt){wt=wt._reactInternals;var kt=As(),Lt=po(wt),Gt=to(kt,Lt);Gt.tag=2,Pt!=null&&(Gt.callback=Pt),co(wt,Gt),Pt=Us(wt,Lt,kt),Pt!==null&&Dl(Pt,wt,Lt)}};function vp(wt,Pt,kt,Lt,Gt,Ht,dr){return wt=wt.stateNode,typeof wt.shouldComponentUpdate=="function"?wt.shouldComponentUpdate(Lt,Ht,dr):Pt.prototype&&Pt.prototype.isPureReactComponent?!_o(kt,Lt)||!_o(Gt,Ht):!0}function yp(wt,Pt,kt){var Lt=!1,Gt=An,Ht=Pt.contextType;return typeof Ht=="object"&&Ht!==null?Ht=Zn(Ht):(Gt=Fn(Pt)?Dn:Bn.current,Lt=Pt.contextTypes,Ht=(Lt=Lt!=null)?On(wt,Gt):An),Pt=new Pt(kt,Ht),wt.memoizedState=Pt.state!==null&&Pt.state!==void 0?Pt.state:null,Pt.updater=Ul,wt.stateNode=Pt,Pt._reactInternals=wt,Lt&&(wt=wt.stateNode,wt.__reactInternalMemoizedUnmaskedChildContext=Gt,wt.__reactInternalMemoizedMaskedChildContext=Ht),Pt}function Ap(wt,Pt,kt,Lt){wt=Pt.state,typeof Pt.componentWillReceiveProps=="function"&&Pt.componentWillReceiveProps(kt,Lt),typeof Pt.UNSAFE_componentWillReceiveProps=="function"&&Pt.UNSAFE_componentWillReceiveProps(kt,Lt),Pt.state!==wt&&Ul.enqueueReplaceState(Pt,Pt.state,null)}function Eu(wt,Pt,kt,Lt){var Gt=wt.stateNode;Gt.props=kt,Gt.state=wt.memoizedState,Gt.refs=mp,Cu(wt);var Ht=Pt.contextType;typeof Ht=="object"&&Ht!==null?Gt.context=Zn(Ht):(Ht=Fn(Pt)?Dn:Bn.current,Gt.context=On(wt,Ht)),Gt.state=wt.memoizedState,Ht=Pt.getDerivedStateFromProps,typeof Ht=="function"&&(xu(wt,Pt,Ht,kt),Gt.state=wt.memoizedState),typeof Pt.getDerivedStateFromProps=="function"||typeof Gt.getSnapshotBeforeUpdate=="function"||typeof Gt.UNSAFE_componentWillMount!="function"&&typeof Gt.componentWillMount!="function"||(Pt=Gt.state,typeof Gt.componentWillMount=="function"&&Gt.componentWillMount(),typeof Gt.UNSAFE_componentWillMount=="function"&&Gt.UNSAFE_componentWillMount(),Pt!==Gt.state&&Ul.enqueueReplaceState(Gt,Gt.state,null),Fl(wt,kt,Gt,Lt),Gt.state=wt.memoizedState),typeof Gt.componentDidMount=="function"&&(wt.flags|=4194308)}var Bo=[],Do=0,$l=null,Gl=0,Ls=[],Bs=0,xo=null,ro=1,io="";function Eo(wt,Pt){Bo[Do++]=Gl,Bo[Do++]=$l,$l=wt,Gl=Pt}function bp(wt,Pt,kt){Ls[Bs++]=ro,Ls[Bs++]=io,Ls[Bs++]=xo,xo=wt;var Lt=ro;wt=io;var Gt=32-Yn(Lt)-1;Lt&=~(1<<Gt),kt+=1;var Ht=32-Yn(Pt)+Gt;if(30<Ht){var dr=Gt-Gt%5;Ht=(Lt&(1<<dr)-1).toString(32),Lt>>=dr,Gt-=dr,ro=1<<32-Yn(Pt)+Gt|kt<<Gt|Lt,io=Ht+wt}else ro=1<<Ht|kt<<Gt|Lt,io=wt}function Su(wt){wt.return!==null&&(Eo(wt,1),bp(wt,1,0))}function Tu(wt){for(;wt===$l;)$l=Bo[--Do],Bo[Do]=null,Gl=Bo[--Do],Bo[Do]=null;for(;wt===xo;)xo=Ls[--Bs],Ls[Bs]=null,io=Ls[--Bs],Ls[Bs]=null,ro=Ls[--Bs],Ls[Bs]=null}var Rs=null,Is=null,Xn=!1,Zo=!1,js=null;function _p(wt,Pt){var kt=$s(5,null,null,0);kt.elementType="DELETED",kt.stateNode=Pt,kt.return=wt,Pt=wt.deletions,Pt===null?(wt.deletions=[kt],wt.flags|=16):Pt.push(kt)}function Cp(wt,Pt){switch(wt.tag){case 5:return Pt=yn(Pt,wt.type,wt.pendingProps),Pt!==null?(wt.stateNode=Pt,Rs=wt,Is=nn(Pt),!0):!1;case 6:return Pt=Gn(Pt,wt.pendingProps),Pt!==null?(wt.stateNode=Pt,Rs=wt,Is=null,!0):!1;case 13:if(Pt=Pn(Pt),Pt!==null){var kt=xo!==null?{id:ro,overflow:io}:null;return wt.memoizedState={dehydrated:Pt,treeContext:kt,retryLane:1073741824},kt=$s(18,null,null,0),kt.stateNode=Pt,kt.return=wt,wt.child=kt,Rs=wt,Is=null,!0}return!1;default:return!1}}function wu(wt){return(wt.mode&1)!==0&&(wt.flags&128)===0}function Pu(wt){if(Xn){var Pt=Is;if(Pt){var kt=Pt;if(!Cp(wt,Pt)){if(wu(wt))throw Error(at(418));Pt=_n(kt);var Lt=Rs;Pt&&Cp(wt,Pt)?_p(Lt,kt):(wt.flags=wt.flags&-4097|2,Xn=!1,Rs=wt)}}else{if(wu(wt))throw Error(at(418));wt.flags=wt.flags&-4097|2,Xn=!1,Rs=wt}}}function xp(wt){for(wt=wt.return;wt!==null&&wt.tag!==5&&wt.tag!==3&&wt.tag!==13;)wt=wt.return;Rs=wt}function na(wt){if(!nr||wt!==Rs)return!1;if(!Xn)return xp(wt),Xn=!0,!1;if(wt.tag!==3&&(wt.tag!==5||Gr(wt.type)&&!sr(wt.type,wt.memoizedProps))){var Pt=Is;if(Pt){if(wu(wt)){for(wt=Is;wt;)wt=_n(wt);throw Error(at(418))}for(;Pt;)_p(wt,Pt),Pt=_n(Pt)}}if(xp(wt),wt.tag===13){if(!nr)throw Error(at(316));if(wt=wt.memoizedState,wt=wt!==null?wt.dehydrated:null,!wt)throw Error(at(317));Is=cr(wt)}else Is=Rs?_n(wt.stateNode):null;return!0}function Fo(){nr&&(Is=Rs=null,Zo=Xn=!1)}function Mu(wt){js===null?js=[wt]:js.push(wt)}function ga(wt,Pt,kt){if(wt=kt.ref,wt!==null&&typeof wt!="function"&&typeof wt!="object"){if(kt._owner){if(kt=kt._owner,kt){if(kt.tag!==1)throw Error(at(309));var Lt=kt.stateNode}if(!Lt)throw Error(at(147,wt));var Gt=Lt,Ht=""+wt;return Pt!==null&&Pt.ref!==null&&typeof Pt.ref=="function"&&Pt.ref._stringRef===Ht?Pt.ref:(Pt=function(dr){var Pr=Gt.refs;Pr===mp&&(Pr=Gt.refs={}),dr===null?delete Pr[Ht]:Pr[Ht]=dr},Pt._stringRef=Ht,Pt)}if(typeof wt!="string")throw Error(at(284));if(!kt._owner)throw Error(at(290,wt))}return wt}function zl(wt,Pt){throw wt=Object.prototype.toString.call(Pt),Error(at(31,wt==="[object Object]"?"object with keys {"+Object.keys(Pt).join(", ")+"}":wt))}function Ep(wt){var Pt=wt._init;return Pt(wt._payload)}function Sp(wt){function Pt(Fr,Ir){if(wt){var $r=Fr.deletions;$r===null?(Fr.deletions=[Ir],Fr.flags|=16):$r.push(Ir)}}function kt(Fr,Ir){if(!wt)return null;for(;Ir!==null;)Pt(Fr,Ir),Ir=Ir.sibling;return null}function Lt(Fr,Ir){for(Fr=new Map;Ir!==null;)Ir.key!==null?Fr.set(Ir.key,Ir):Fr.set(Ir.index,Ir),Ir=Ir.sibling;return Fr}function Gt(Fr,Ir){return Fr=go(Fr,Ir),Fr.index=0,Fr.sibling=null,Fr}function Ht(Fr,Ir,$r){return Fr.index=$r,wt?($r=Fr.alternate,$r!==null?($r=$r.index,$r<Ir?(Fr.flags|=2,Ir):$r):(Fr.flags|=2,Ir)):(Fr.flags|=1048576,Ir)}function dr(Fr){return wt&&Fr.alternate===null&&(Fr.flags|=2),Fr}function Pr(Fr,Ir,$r,tn){return Ir===null||Ir.tag!==6?(Ir=up($r,Fr.mode,tn),Ir.return=Fr,Ir):(Ir=Gt(Ir,$r),Ir.return=Fr,Ir)}function jr(Fr,Ir,$r,tn){var un=$r.type;return un===ut?sn(Fr,Ir,$r.props.children,tn,$r.key):Ir!==null&&(Ir.elementType===un||typeof un=="object"&&un!==null&&un.$$typeof===bt&&Ep(un)===Ir.type)?(tn=Gt(Ir,$r.props),tn.ref=ga(Fr,Ir,$r),tn.return=Fr,tn):(tn=bu($r.type,$r.key,$r.props,null,Fr.mode,tn),tn.ref=ga(Fr,Ir,$r),tn.return=Fr,tn)}function Jr(Fr,Ir,$r,tn){return Ir===null||Ir.tag!==4||Ir.stateNode.containerInfo!==$r.containerInfo||Ir.stateNode.implementation!==$r.implementation?(Ir=hp($r,Fr.mode,tn),Ir.return=Fr,Ir):(Ir=Gt(Ir,$r.children||[]),Ir.return=Fr,Ir)}function sn(Fr,Ir,$r,tn,un){return Ir===null||Ir.tag!==7?(Ir=Io($r,Fr.mode,tn,un),Ir.return=Fr,Ir):(Ir=Gt(Ir,$r),Ir.return=Fr,Ir)}function Tn(Fr,Ir,$r){if(typeof Ir=="string"&&Ir!==""||typeof Ir=="number")return Ir=up(""+Ir,Fr.mode,$r),Ir.return=Fr,Ir;if(typeof Ir=="object"&&Ir!==null){switch(Ir.$$typeof){case ot:return $r=bu(Ir.type,Ir.key,Ir.props,null,Fr.mode,$r),$r.ref=ga(Fr,null,Ir),$r.return=Fr,$r;case ct:return Ir=hp(Ir,Fr.mode,$r),Ir.return=Fr,Ir;case bt:var tn=Ir._init;return Tn(Fr,tn(Ir._payload),$r)}if(Bt(Ir)||_t(Ir))return Ir=Io(Ir,Fr.mode,$r,null),Ir.return=Fr,Ir;zl(Fr,Ir)}return null}function gn(Fr,Ir,$r,tn){var un=Ir!==null?Ir.key:null;if(typeof $r=="string"&&$r!==""||typeof $r=="number")return un!==null?null:Pr(Fr,Ir,""+$r,tn);if(typeof $r=="object"&&$r!==null){switch($r.$$typeof){case ot:return $r.key===un?jr(Fr,Ir,$r,tn):null;case ct:return $r.key===un?Jr(Fr,Ir,$r,tn):null;case bt:return un=$r._init,gn(Fr,Ir,un($r._payload),tn)}if(Bt($r)||_t($r))return un!==null?null:sn(Fr,Ir,$r,tn,null);zl(Fr,$r)}return null}function Hn(Fr,Ir,$r,tn,un){if(typeof tn=="string"&&tn!==""||typeof tn=="number")return Fr=Fr.get($r)||null,Pr(Ir,Fr,""+tn,un);if(typeof tn=="object"&&tn!==null){switch(tn.$$typeof){case ot:return Fr=Fr.get(tn.key===null?$r:tn.key)||null,jr(Ir,Fr,tn,un);case ct:return Fr=Fr.get(tn.key===null?$r:tn.key)||null,Jr(Ir,Fr,tn,un);case bt:var Mn=tn._init;return Hn(Fr,Ir,$r,Mn(tn._payload),un)}if(Bt(tn)||_t(tn))return Fr=Fr.get($r)||null,sn(Ir,Fr,tn,un,null);zl(Ir,tn)}return null}function hn(Fr,Ir,$r,tn){for(var un=null,Mn=null,wn=Ir,Un=Ir=0,ls=null;wn!==null&&Un<$r.length;Un++){wn.index>Un?(ls=wn,wn=null):ls=wn.sibling;var $n=gn(Fr,wn,$r[Un],tn);if($n===null){wn===null&&(wn=ls);break}wt&&wn&&$n.alternate===null&&Pt(Fr,wn),Ir=Ht($n,Ir,Un),Mn===null?un=$n:Mn.sibling=$n,Mn=$n,wn=ls}if(Un===$r.length)return kt(Fr,wn),Xn&&Eo(Fr,Un),un;if(wn===null){for(;Un<$r.length;Un++)wn=Tn(Fr,$r[Un],tn),wn!==null&&(Ir=Ht(wn,Ir,Un),Mn===null?un=wn:Mn.sibling=wn,Mn=wn);return Xn&&Eo(Fr,Un),un}for(wn=Lt(Fr,wn);Un<$r.length;Un++)ls=Hn(wn,Fr,Un,$r[Un],tn),ls!==null&&(wt&&ls.alternate!==null&&wn.delete(ls.key===null?Un:ls.key),Ir=Ht(ls,Ir,Un),Mn===null?un=ls:Mn.sibling=ls,Mn=ls);return wt&&wn.forEach(function(mo){return Pt(Fr,mo)}),Xn&&Eo(Fr,Un),un}function ps(Fr,Ir,$r,tn){var un=_t($r);if(typeof un!="function")throw Error(at(150));if($r=un.call($r),$r==null)throw Error(at(151));for(var Mn=un=null,wn=Ir,Un=Ir=0,ls=null,$n=$r.next();wn!==null&&!$n.done;Un++,$n=$r.next()){wn.index>Un?(ls=wn,wn=null):ls=wn.sibling;var mo=gn(Fr,wn,$n.value,tn);if(mo===null){wn===null&&(wn=ls);break}wt&&wn&&mo.alternate===null&&Pt(Fr,wn),Ir=Ht(mo,Ir,Un),Mn===null?un=mo:Mn.sibling=mo,Mn=mo,wn=ls}if($n.done)return kt(Fr,wn),Xn&&Eo(Fr,Un),un;if(wn===null){for(;!$n.done;Un++,$n=$r.next())$n=Tn(Fr,$n.value,tn),$n!==null&&(Ir=Ht($n,Ir,Un),Mn===null?un=$n:Mn.sibling=$n,Mn=$n);return Xn&&Eo(Fr,Un),un}for(wn=Lt(Fr,wn);!$n.done;Un++,$n=$r.next())$n=Hn(wn,Fr,Un,$n.value,tn),$n!==null&&(wt&&$n.alternate!==null&&wn.delete($n.key===null?Un:$n.key),Ir=Ht($n,Ir,Un),Mn===null?un=$n:Mn.sibling=$n,Mn=$n);return wt&&wn.forEach(function(g1){return Pt(Fr,g1)}),Xn&&Eo(Fr,Un),un}function Gs(Fr,Ir,$r,tn){if(typeof $r=="object"&&$r!==null&&$r.type===ut&&$r.key===null&&($r=$r.props.children),typeof $r=="object"&&$r!==null){switch($r.$$typeof){case ot:e:{for(var un=$r.key,Mn=Ir;Mn!==null;){if(Mn.key===un){if(un=$r.type,un===ut){if(Mn.tag===7){kt(Fr,Mn.sibling),Ir=Gt(Mn,$r.props.children),Ir.return=Fr,Fr=Ir;break e}}else if(Mn.elementType===un||typeof un=="object"&&un!==null&&un.$$typeof===bt&&Ep(un)===Mn.type){kt(Fr,Mn.sibling),Ir=Gt(Mn,$r.props),Ir.ref=ga(Fr,Mn,$r),Ir.return=Fr,Fr=Ir;break e}kt(Fr,Mn);break}else Pt(Fr,Mn);Mn=Mn.sibling}$r.type===ut?(Ir=Io($r.props.children,Fr.mode,tn,$r.key),Ir.return=Fr,Fr=Ir):(tn=bu($r.type,$r.key,$r.props,null,Fr.mode,tn),tn.ref=ga(Fr,Ir,$r),tn.return=Fr,Fr=tn)}return dr(Fr);case ct:e:{for(Mn=$r.key;Ir!==null;){if(Ir.key===Mn)if(Ir.tag===4&&Ir.stateNode.containerInfo===$r.containerInfo&&Ir.stateNode.implementation===$r.implementation){kt(Fr,Ir.sibling),Ir=Gt(Ir,$r.children||[]),Ir.return=Fr,Fr=Ir;break e}else{kt(Fr,Ir);break}else Pt(Fr,Ir);Ir=Ir.sibling}Ir=hp($r,Fr.mode,tn),Ir.return=Fr,Fr=Ir}return dr(Fr);case bt:return Mn=$r._init,Gs(Fr,Ir,Mn($r._payload),tn)}if(Bt($r))return hn(Fr,Ir,$r,tn);if(_t($r))return ps(Fr,Ir,$r,tn);zl(Fr,$r)}return typeof $r=="string"&&$r!==""||typeof $r=="number"?($r=""+$r,Ir!==null&&Ir.tag===6?(kt(Fr,Ir.sibling),Ir=Gt(Ir,$r),Ir.return=Fr,Fr=Ir):(kt(Fr,Ir),Ir=up($r,Fr.mode,tn),Ir.return=Fr,Fr=Ir),dr(Fr)):kt(Fr,Ir)}return Gs}var Uo=Sp(!0),Tp=Sp(!1),ba={},Ds=_i(ba),xa=_i(ba),$o=_i(ba);function Xs(wt){if(wt===ba)throw Error(at(174));return wt}function Ru(wt,Pt){on($o,Pt),on(xa,wt),on(Ds,ba),wt=zt(Pt),fn(Ds),on(Ds,wt)}function Go(){fn(Ds),fn(xa),fn($o)}function wp(wt){var Pt=Xs($o.current),kt=Xs(Ds.current);Pt=Dt(kt,wt.type,Pt),kt!==Pt&&(on(xa,wt),on(Ds,Pt))}function Iu(wt){xa.current===wt&&(fn(Ds),fn(xa))}var Qn=_i(0);function Vl(wt){for(var Pt=wt;Pt!==null;){if(Pt.tag===13){var kt=Pt.memoizedState;if(kt!==null&&(kt=kt.dehydrated,kt===null||Sn(kt)||In(kt)))return Pt}else if(Pt.tag===19&&Pt.memoizedProps.revealOrder!==void 0){if(Pt.flags&128)return Pt}else if(Pt.child!==null){Pt.child.return=Pt,Pt=Pt.child;continue}if(Pt===wt)break;for(;Pt.sibling===null;){if(Pt.return===null||Pt.return===wt)return null;Pt=Pt.return}Pt.sibling.return=Pt.return,Pt=Pt.sibling}return null}var Ou=[];function ku(){for(var wt=0;wt<Ou.length;wt++){var Pt=Ou[wt];lr?Pt._workInProgressVersionPrimary=null:Pt._workInProgressVersionSecondary=null}Ou.length=0}var Hl=lt.ReactCurrentDispatcher,Fs=lt.ReactCurrentBatchConfig,zo=0,Jn=null,us=null,as=null,Yl=!1,$a=!1,yl=0,$0=0;function hs(){throw Error(at(321))}function Nu(wt,Pt){if(Pt===null)return!1;for(var kt=0;kt<Pt.length&&kt<wt.length;kt++)if(!Ps(wt[kt],Pt[kt]))return!1;return!0}function Lu(wt,Pt,kt,Lt,Gt,Ht){if(zo=Ht,Jn=Pt,Pt.memoizedState=null,Pt.updateQueue=null,Pt.lanes=0,Hl.current=wt===null||wt.memoizedState===null?V0:H0,wt=kt(Lt,Gt),$a){Ht=0;do{if($a=!1,yl=0,25<=Ht)throw Error(at(301));Ht+=1,as=us=null,Pt.updateQueue=null,Hl.current=Y0,wt=kt(Lt,Gt)}while($a)}if(Hl.current=Kl,Pt=us!==null&&us.next!==null,zo=0,as=us=Jn=null,Yl=!1,Pt)throw Error(at(300));return wt}function Bu(){var wt=yl!==0;return yl=0,wt}function no(){var wt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return as===null?Jn.memoizedState=as=wt:as=as.next=wt,as}function Ws(){if(us===null){var wt=Jn.alternate;wt=wt!==null?wt.memoizedState:null}else wt=us.next;var Pt=as===null?Jn.memoizedState:as.next;if(Pt!==null)as=Pt,us=wt;else{if(wt===null)throw Error(at(310));us=wt,wt={memoizedState:us.memoizedState,baseState:us.baseState,baseQueue:us.baseQueue,queue:us.queue,next:null},as===null?Jn.memoizedState=as=wt:as=as.next=wt}return as}function So(wt,Pt){return typeof Pt=="function"?Pt(wt):Pt}function Xl(wt){var Pt=Ws(),kt=Pt.queue;if(kt===null)throw Error(at(311));kt.lastRenderedReducer=wt;var Lt=us,Gt=Lt.baseQueue,Ht=kt.pending;if(Ht!==null){if(Gt!==null){var dr=Gt.next;Gt.next=Ht.next,Ht.next=dr}Lt.baseQueue=Gt=Ht,kt.pending=null}if(Gt!==null){Ht=Gt.next,Lt=Lt.baseState;var Pr=dr=null,jr=null,Jr=Ht;do{var sn=Jr.lane;if((zo&sn)===sn)jr!==null&&(jr=jr.next={lane:0,action:Jr.action,hasEagerState:Jr.hasEagerState,eagerState:Jr.eagerState,next:null}),Lt=Jr.hasEagerState?Jr.eagerState:wt(Lt,Jr.action);else{var Tn={lane:sn,action:Jr.action,hasEagerState:Jr.hasEagerState,eagerState:Jr.eagerState,next:null};jr===null?(Pr=jr=Tn,dr=Lt):jr=jr.next=Tn,Jn.lanes|=sn,Vo|=sn}Jr=Jr.next}while(Jr!==null&&Jr!==Ht);jr===null?dr=Lt:jr.next=Pr,Ps(Lt,Pt.memoizedState)||(Os=!0),Pt.memoizedState=Lt,Pt.baseState=dr,Pt.baseQueue=jr,kt.lastRenderedState=Lt}if(wt=kt.interleaved,wt!==null){Gt=wt;do Ht=Gt.lane,Jn.lanes|=Ht,Vo|=Ht,Gt=Gt.next;while(Gt!==wt)}else Gt===null&&(kt.lanes=0);return[Pt.memoizedState,kt.dispatch]}function Wl(wt){var Pt=Ws(),kt=Pt.queue;if(kt===null)throw Error(at(311));kt.lastRenderedReducer=wt;var Lt=kt.dispatch,Gt=kt.pending,Ht=Pt.memoizedState;if(Gt!==null){kt.pending=null;var dr=Gt=Gt.next;do Ht=wt(Ht,dr.action),dr=dr.next;while(dr!==Gt);Ps(Ht,Pt.memoizedState)||(Os=!0),Pt.memoizedState=Ht,Pt.baseQueue===null&&(Pt.baseState=Ht),kt.lastRenderedState=Ht}return[Ht,Lt]}function Pp(){}function Mp(wt,Pt){var kt=Jn,Lt=Ws(),Gt=Pt(),Ht=!Ps(Lt.memoizedState,Gt);if(Ht&&(Lt.memoizedState=Gt,Os=!0),Lt=Lt.queue,_l(Op.bind(null,kt,Lt,wt),[wt]),Lt.getSnapshot!==Pt||Ht||as!==null&&as.memoizedState.tag&1){if(kt.flags|=2048,Al(9,Ip.bind(null,kt,Lt,Gt,Pt),void 0,null),ts===null)throw Error(at(349));zo&30||Rp(kt,Pt,Gt)}return Gt}function Rp(wt,Pt,kt){wt.flags|=16384,wt={getSnapshot:Pt,value:kt},Pt=Jn.updateQueue,Pt===null?(Pt={lastEffect:null,stores:null},Jn.updateQueue=Pt,Pt.stores=[wt]):(kt=Pt.stores,kt===null?Pt.stores=[wt]:kt.push(wt))}function Ip(wt,Pt,kt,Lt){Pt.value=kt,Pt.getSnapshot=Lt,kp(Pt)&&Us(wt,1,-1)}function Op(wt,Pt,kt){return kt(function(){kp(Pt)&&Us(wt,1,-1)})}function kp(wt){var Pt=wt.getSnapshot;wt=wt.value;try{var kt=Pt();return!Ps(wt,kt)}catch{return!0}}function Du(wt){var Pt=no();return typeof wt=="function"&&(wt=wt()),Pt.memoizedState=Pt.baseState=wt,wt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:wt},Pt.queue=wt,wt=wt.dispatch=j0.bind(null,Jn,wt),[Pt.memoizedState,wt]}function Al(wt,Pt,kt,Lt){return wt={tag:wt,create:Pt,destroy:kt,deps:Lt,next:null},Pt=Jn.updateQueue,Pt===null?(Pt={lastEffect:null,stores:null},Jn.updateQueue=Pt,Pt.lastEffect=wt.next=wt):(kt=Pt.lastEffect,kt===null?Pt.lastEffect=wt.next=wt:(Lt=kt.next,kt.next=wt,wt.next=Lt,Pt.lastEffect=wt)),wt}function Np(){return Ws().memoizedState}function Ql(wt,Pt,kt,Lt){var Gt=no();Jn.flags|=wt,Gt.memoizedState=Al(1|Pt,kt,void 0,Lt===void 0?null:Lt)}function Jl(wt,Pt,kt,Lt){var Gt=Ws();Lt=Lt===void 0?null:Lt;var Ht=void 0;if(us!==null){var dr=us.memoizedState;if(Ht=dr.destroy,Lt!==null&&Nu(Lt,dr.deps)){Gt.memoizedState=Al(Pt,kt,Ht,Lt);return}}Jn.flags|=wt,Gt.memoizedState=Al(1|Pt,kt,Ht,Lt)}function Fu(wt,Pt){return Ql(8390656,8,wt,Pt)}function _l(wt,Pt){return Jl(2048,8,wt,Pt)}function Lp(wt,Pt){return Jl(4,2,wt,Pt)}function Bp(wt,Pt){return Jl(4,4,wt,Pt)}function Dp(wt,Pt){if(typeof Pt=="function")return wt=wt(),Pt(wt),function(){Pt(null)};if(Pt!=null)return wt=wt(),Pt.current=wt,function(){Pt.current=null}}function Fp(wt,Pt,kt){return kt=kt!=null?kt.concat([wt]):null,Jl(4,4,Dp.bind(null,Pt,wt),kt)}function Uu(){}function Up(wt,Pt){var kt=Ws();Pt=Pt===void 0?null:Pt;var Lt=kt.memoizedState;return Lt!==null&&Pt!==null&&Nu(Pt,Lt[1])?Lt[0]:(kt.memoizedState=[wt,Pt],wt)}function $p(wt,Pt){var kt=Ws();Pt=Pt===void 0?null:Pt;var Lt=kt.memoizedState;return Lt!==null&&Pt!==null&&Nu(Pt,Lt[1])?Lt[0]:(wt=wt(),kt.memoizedState=[wt,Pt],wt)}function G0(wt,Pt){var kt=kn;kn=kt!==0&&4>kt?kt:4,wt(!0);var Lt=Fs.transition;Fs.transition={};try{wt(!1),Pt()}finally{kn=kt,Fs.transition=Lt}}function Gp(){return Ws().memoizedState}function z0(wt,Pt,kt){var Lt=po(wt);kt={lane:Lt,action:kt,hasEagerState:!1,eagerState:null,next:null},zp(wt)?jp(Pt,kt):(Vp(wt,Pt,kt),kt=As(),wt=Us(wt,Lt,kt),wt!==null&&Hp(wt,Pt,Lt))}function j0(wt,Pt,kt){var Lt=po(wt),Gt={lane:Lt,action:kt,hasEagerState:!1,eagerState:null,next:null};if(zp(wt))jp(Pt,Gt);else{Vp(wt,Pt,Gt);var Ht=wt.alternate;if(wt.lanes===0&&(Ht===null||Ht.lanes===0)&&(Ht=Pt.lastRenderedReducer,Ht!==null))try{var dr=Pt.lastRenderedState,Pr=Ht(dr,kt);if(Gt.hasEagerState=!0,Gt.eagerState=Pr,Ps(Pr,dr))return}catch{}finally{}kt=As(),wt=Us(wt,Lt,kt),wt!==null&&Hp(wt,Pt,Lt)}}function zp(wt){var Pt=wt.alternate;return wt===Jn||Pt!==null&&Pt===Jn}function jp(wt,Pt){$a=Yl=!0;var kt=wt.pending;kt===null?Pt.next=Pt:(Pt.next=kt.next,kt.next=Pt),wt.pending=Pt}function Vp(wt,Pt,kt){ts!==null&&wt.mode&1&&!(Rn&2)?(wt=Pt.interleaved,wt===null?(kt.next=kt,Ms===null?Ms=[Pt]:Ms.push(Pt)):(kt.next=wt.next,wt.next=kt),Pt.interleaved=kt):(wt=Pt.pending,wt===null?kt.next=kt:(kt.next=wt.next,wt.next=kt),Pt.pending=kt)}function Hp(wt,Pt,kt){if(kt&4194240){var Lt=Pt.lanes;Lt&=wt.pendingLanes,kt|=Lt,Pt.lanes=kt,Hs(wt,kt)}}var Kl={readContext:Zn,useCallback:hs,useContext:hs,useEffect:hs,useImperativeHandle:hs,useInsertionEffect:hs,useLayoutEffect:hs,useMemo:hs,useReducer:hs,useRef:hs,useState:hs,useDebugValue:hs,useDeferredValue:hs,useTransition:hs,useMutableSource:hs,useSyncExternalStore:hs,useId:hs,unstable_isNewReconciler:!1},V0={readContext:Zn,useCallback:function(wt,Pt){return no().memoizedState=[wt,Pt===void 0?null:Pt],wt},useContext:Zn,useEffect:Fu,useImperativeHandle:function(wt,Pt,kt){return kt=kt!=null?kt.concat([wt]):null,Ql(4194308,4,Dp.bind(null,Pt,wt),kt)},useLayoutEffect:function(wt,Pt){return Ql(4194308,4,wt,Pt)},useInsertionEffect:function(wt,Pt){return Ql(4,2,wt,Pt)},useMemo:function(wt,Pt){var kt=no();return Pt=Pt===void 0?null:Pt,wt=wt(),kt.memoizedState=[wt,Pt],wt},useReducer:function(wt,Pt,kt){var Lt=no();return Pt=kt!==void 0?kt(Pt):Pt,Lt.memoizedState=Lt.baseState=Pt,wt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wt,lastRenderedState:Pt},Lt.queue=wt,wt=wt.dispatch=z0.bind(null,Jn,wt),[Lt.memoizedState,wt]},useRef:function(wt){var Pt=no();return wt={current:wt},Pt.memoizedState=wt},useState:Du,useDebugValue:Uu,useDeferredValue:function(wt){var Pt=Du(wt),kt=Pt[0],Lt=Pt[1];return Fu(function(){var Gt=Fs.transition;Fs.transition={};try{Lt(wt)}finally{Fs.transition=Gt}},[wt]),kt},useTransition:function(){var wt=Du(!1),Pt=wt[0];return wt=G0.bind(null,wt[1]),no().memoizedState=wt,[Pt,wt]},useMutableSource:function(){},useSyncExternalStore:function(wt,Pt,kt){var Lt=Jn,Gt=no();if(Xn){if(kt===void 0)throw Error(at(407));kt=kt()}else{if(kt=Pt(),ts===null)throw Error(at(349));zo&30||Rp(Lt,Pt,kt)}Gt.memoizedState=kt;var Ht={value:kt,getSnapshot:Pt};return Gt.queue=Ht,Fu(Op.bind(null,Lt,Ht,wt),[wt]),Lt.flags|=2048,Al(9,Ip.bind(null,Lt,Ht,kt,Pt),void 0,null),kt},useId:function(){var wt=no(),Pt=ts.identifierPrefix;if(Xn){var kt=io,Lt=ro;kt=(Lt&~(1<<32-Yn(Lt)-1)).toString(32)+kt,Pt=":"+Pt+"R"+kt,kt=yl++,0<kt&&(Pt+="H"+kt.toString(32)),Pt+=":"}else kt=$0++,Pt=":"+Pt+"r"+kt.toString(32)+":";return wt.memoizedState=Pt},unstable_isNewReconciler:!1},H0={readContext:Zn,useCallback:Up,useContext:Zn,useEffect:_l,useImperativeHandle:Fp,useInsertionEffect:Lp,useLayoutEffect:Bp,useMemo:$p,useReducer:Xl,useRef:Np,useState:function(){return Xl(So)},useDebugValue:Uu,useDeferredValue:function(wt){var Pt=Xl(So),kt=Pt[0],Lt=Pt[1];return _l(function(){var Gt=Fs.transition;Fs.transition={};try{Lt(wt)}finally{Fs.transition=Gt}},[wt]),kt},useTransition:function(){var wt=Xl(So)[0],Pt=Ws().memoizedState;return[wt,Pt]},useMutableSource:Pp,useSyncExternalStore:Mp,useId:Gp,unstable_isNewReconciler:!1},Y0={readContext:Zn,useCallback:Up,useContext:Zn,useEffect:_l,useImperativeHandle:Fp,useInsertionEffect:Lp,useLayoutEffect:Bp,useMemo:$p,useReducer:Wl,useRef:Np,useState:function(){return Wl(So)},useDebugValue:Uu,useDeferredValue:function(wt){var Pt=Wl(So),kt=Pt[0],Lt=Pt[1];return _l(function(){var Gt=Fs.transition;Fs.transition={};try{Lt(wt)}finally{Fs.transition=Gt}},[wt]),kt},useTransition:function(){var wt=Wl(So)[0],Pt=Ws().memoizedState;return[wt,Pt]},useMutableSource:Pp,useSyncExternalStore:Mp,useId:Gp,unstable_isNewReconciler:!1};function $u(wt,Pt){try{var kt="",Lt=Pt;do kt+=Co(Lt),Lt=Lt.return;while(Lt);var Gt=kt}catch(Ht){Gt=`
Error generating stack: `+Ht.message+`
`+Ht.stack}return{value:wt,source:Pt,stack:Gt}}function Gu(wt,Pt){try{console.error(Pt.value)}catch(kt){setTimeout(function(){throw kt})}}var X0=typeof WeakMap=="function"?WeakMap:Map;function Yp(wt,Pt,kt){kt=to(-1,kt),kt.tag=3,kt.payload={element:null};var Lt=Pt.value;return kt.callback=function(){pu||(pu=!0,ip=Lt),Gu(wt,Pt)},kt}function Xp(wt,Pt,kt){kt=to(-1,kt),kt.tag=3;var Lt=wt.type.getDerivedStateFromError;if(typeof Lt=="function"){var Gt=Pt.value;kt.payload=function(){return Lt(Gt)},kt.callback=function(){Gu(wt,Pt)}}var Ht=wt.stateNode;return Ht!==null&&typeof Ht.componentDidCatch=="function"&&(kt.callback=function(){Gu(wt,Pt),typeof Lt!="function"&&(uo===null?uo=new Set([this]):uo.add(this));var dr=Pt.stack;this.componentDidCatch(Pt.value,{componentStack:dr!==null?dr:""})}),kt}function Wp(wt,Pt,kt){var Lt=wt.pingCache;if(Lt===null){Lt=wt.pingCache=new X0;var Gt=new Set;Lt.set(Pt,Gt)}else Gt=Lt.get(Pt),Gt===void 0&&(Gt=new Set,Lt.set(Pt,Gt));Gt.has(kt)||(Gt.add(kt),wt=a1.bind(null,wt,Pt,kt),Pt.then(wt,wt))}function Qp(wt){do{var Pt;if((Pt=wt.tag===13)&&(Pt=wt.memoizedState,Pt=Pt!==null?Pt.dehydrated!==null:!0),Pt)return wt;wt=wt.return}while(wt!==null);return null}function Jp(wt,Pt,kt,Lt,Gt){return wt.mode&1?(wt.flags|=65536,wt.lanes=Gt,wt):(wt===Pt?wt.flags|=65536:(wt.flags|=128,kt.flags|=131072,kt.flags&=-52805,kt.tag===1&&(kt.alternate===null?kt.tag=17:(Pt=to(-1,1),Pt.tag=2,co(kt,Pt))),kt.lanes|=1),wt)}function Qs(wt){wt.flags|=4}function qp(wt,Pt){if(wt!==null&&wt.child===Pt.child)return!0;if(Pt.flags&16)return!1;for(wt=Pt.child;wt!==null;){if(wt.flags&12854||wt.subtreeFlags&12854)return!1;wt=wt.sibling}return!0}var Cl,xl,Zl,_c;if(gr)Cl=function(wt,Pt){for(var kt=Pt.child;kt!==null;){if(kt.tag===5||kt.tag===6)Vt(wt,kt.stateNode);else if(kt.tag!==4&&kt.child!==null){kt.child.return=kt,kt=kt.child;continue}if(kt===Pt)break;for(;kt.sibling===null;){if(kt.return===null||kt.return===Pt)return;kt=kt.return}kt.sibling.return=kt.return,kt=kt.sibling}},xl=function(){},Zl=function(wt,Pt,kt,Lt,Gt){if(wt=wt.memoizedProps,wt!==Lt){var Ht=Pt.stateNode,dr=Xs(Ds.current);kt=qt(Ht,kt,wt,Lt,Gt,dr),(Pt.updateQueue=kt)&&Qs(Pt)}},_c=function(wt,Pt,kt,Lt){kt!==Lt&&Qs(Pt)};else if(Yt){Cl=function(wt,Pt,kt,Lt){for(var Gt=Pt.child;Gt!==null;){if(Gt.tag===5){var Ht=Gt.stateNode;kt&&Lt&&(Ht=vn(Ht,Gt.type,Gt.memoizedProps,Gt)),Vt(wt,Ht)}else if(Gt.tag===6)Ht=Gt.stateNode,kt&&Lt&&(Ht=an(Ht,Gt.memoizedProps,Gt)),Vt(wt,Ht);else if(Gt.tag!==4){if(Gt.tag===22&&Gt.memoizedState!==null)Ht=Gt.child,Ht!==null&&(Ht.return=Gt),Cl(wt,Gt,!0,!0);else if(Gt.child!==null){Gt.child.return=Gt,Gt=Gt.child;continue}}if(Gt===Pt)break;for(;Gt.sibling===null;){if(Gt.return===null||Gt.return===Pt)return;Gt=Gt.return}Gt.sibling.return=Gt.return,Gt=Gt.sibling}};var Kp=function(wt,Pt,kt,Lt){for(var Gt=Pt.child;Gt!==null;){if(Gt.tag===5){var Ht=Gt.stateNode;kt&&Lt&&(Ht=vn(Ht,Gt.type,Gt.memoizedProps,Gt)),En(wt,Ht)}else if(Gt.tag===6)Ht=Gt.stateNode,kt&&Lt&&(Ht=an(Ht,Gt.memoizedProps,Gt)),En(wt,Ht);else if(Gt.tag!==4){if(Gt.tag===22&&Gt.memoizedState!==null)Ht=Gt.child,Ht!==null&&(Ht.return=Gt),Kp(wt,Gt,!0,!0);else if(Gt.child!==null){Gt.child.return=Gt,Gt=Gt.child;continue}}if(Gt===Pt)break;for(;Gt.sibling===null;){if(Gt.return===null||Gt.return===Pt)return;Gt=Gt.return}Gt.sibling.return=Gt.return,Gt=Gt.sibling}};xl=function(wt,Pt){var kt=Pt.stateNode;if(!qp(wt,Pt)){wt=kt.containerInfo;var Lt=pn(wt);Kp(Lt,Pt,!1,!1),kt.pendingChildren=Lt,Qs(Pt),rn(wt,Lt)}},Zl=function(wt,Pt,kt,Lt,Gt){var Ht=wt.stateNode,dr=wt.memoizedProps;if((wt=qp(wt,Pt))&&dr===Lt)Pt.stateNode=Ht;else{var Pr=Pt.stateNode,jr=Xs(Ds.current),Jr=null;dr!==Lt&&(Jr=qt(Pr,kt,dr,Lt,Gt,jr)),wt&&Jr===null?Pt.stateNode=Ht:(Ht=Wr(Ht,Jr,kt,dr,Lt,Pt,wt,Pr),Zt(Ht,kt,Lt,Gt,jr)&&Qs(Pt),Pt.stateNode=Ht,wt?Qs(Pt):Cl(Ht,Pt,!1,!1))}},_c=function(wt,Pt,kt,Lt){kt!==Lt?(wt=Xs($o.current),kt=Xs(Ds.current),Pt.stateNode=er(Lt,wt,kt,Pt),Qs(Pt)):Pt.stateNode=wt.stateNode}}else xl=function(){},Zl=function(){},_c=function(){};function El(wt,Pt){if(!Xn)switch(wt.tailMode){case"hidden":Pt=wt.tail;for(var kt=null;Pt!==null;)Pt.alternate!==null&&(kt=Pt),Pt=Pt.sibling;kt===null?wt.tail=null:kt.sibling=null;break;case"collapsed":kt=wt.tail;for(var Lt=null;kt!==null;)kt.alternate!==null&&(Lt=kt),kt=kt.sibling;Lt===null?Pt||wt.tail===null?wt.tail=null:wt.tail.sibling=null:Lt.sibling=null}}function ds(wt){var Pt=wt.alternate!==null&&wt.alternate.child===wt.child,kt=0,Lt=0;if(Pt)for(var Gt=wt.child;Gt!==null;)kt|=Gt.lanes|Gt.childLanes,Lt|=Gt.subtreeFlags&14680064,Lt|=Gt.flags&14680064,Gt.return=wt,Gt=Gt.sibling;else for(Gt=wt.child;Gt!==null;)kt|=Gt.lanes|Gt.childLanes,Lt|=Gt.subtreeFlags,Lt|=Gt.flags,Gt.return=wt,Gt=Gt.sibling;return wt.subtreeFlags|=Lt,wt.childLanes=kt,Pt}function W0(wt,Pt,kt){var Lt=Pt.pendingProps;switch(Tu(Pt),Pt.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(Pt),null;case 1:return Fn(Pt.type)&&zn(),ds(Pt),null;case 3:return Lt=Pt.stateNode,Go(),fn(mn),fn(Bn),ku(),Lt.pendingContext&&(Lt.context=Lt.pendingContext,Lt.pendingContext=null),(wt===null||wt.child===null)&&(na(Pt)?Qs(Pt):wt===null||wt.memoizedState.isDehydrated&&!(Pt.flags&256)||(Pt.flags|=1024,js!==null&&(op(js),js=null))),xl(wt,Pt),ds(Pt),null;case 5:Iu(Pt),kt=Xs($o.current);var Gt=Pt.type;if(wt!==null&&Pt.stateNode!=null)Zl(wt,Pt,Gt,Lt,kt),wt.ref!==Pt.ref&&(Pt.flags|=512,Pt.flags|=2097152);else{if(!Lt){if(Pt.stateNode===null)throw Error(at(166));return ds(Pt),null}if(wt=Xs(Ds.current),na(Pt)){if(!nr)throw Error(at(175));wt=Wt(Pt.stateNode,Pt.type,Pt.memoizedProps,kt,wt,Pt,!Zo),Pt.updateQueue=wt,wt!==null&&Qs(Pt)}else{var Ht=$t(Gt,Lt,kt,wt,Pt);Cl(Ht,Pt,!1,!1),Pt.stateNode=Ht,Zt(Ht,Gt,Lt,kt,wt)&&Qs(Pt)}Pt.ref!==null&&(Pt.flags|=512,Pt.flags|=2097152)}return ds(Pt),null;case 6:if(wt&&Pt.stateNode!=null)_c(wt,Pt,wt.memoizedProps,Lt);else{if(typeof Lt!="string"&&Pt.stateNode===null)throw Error(at(166));if(wt=Xs($o.current),kt=Xs(Ds.current),na(Pt)){if(!nr)throw Error(at(176));if(wt=Pt.stateNode,Lt=Pt.memoizedProps,(kt=jt(wt,Lt,Pt,!Zo))&&(Gt=Rs,Gt!==null))switch(Ht=(Gt.mode&1)!==0,Gt.tag){case 3:zr(Gt.stateNode.containerInfo,wt,Lt,Ht);break;case 5:Yr(Gt.type,Gt.memoizedProps,Gt.stateNode,wt,Lt,Ht)}kt&&Qs(Pt)}else Pt.stateNode=er(Lt,wt,kt,Pt)}return ds(Pt),null;case 13:if(fn(Qn),Lt=Pt.memoizedState,Xn&&Is!==null&&Pt.mode&1&&!(Pt.flags&128)){for(wt=Is;wt;)wt=_n(wt);return Fo(),Pt.flags|=98560,Pt}if(Lt!==null&&Lt.dehydrated!==null){if(Lt=na(Pt),wt===null){if(!Lt)throw Error(at(318));if(!nr)throw Error(at(344));if(wt=Pt.memoizedState,wt=wt!==null?wt.dehydrated:null,!wt)throw Error(at(317));rr(wt,Pt)}else Fo(),!(Pt.flags&128)&&(Pt.memoizedState=null),Pt.flags|=4;return ds(Pt),null}return js!==null&&(op(js),js=null),Pt.flags&128?(Pt.lanes=kt,Pt):(Lt=Lt!==null,kt=!1,wt===null?na(Pt):kt=wt.memoizedState!==null,Lt&&!kt&&(Pt.child.flags|=8192,Pt.mode&1&&(wt===null||Qn.current&1?ns===0&&(ns=3):lp())),Pt.updateQueue!==null&&(Pt.flags|=4),ds(Pt),null);case 4:return Go(),xl(wt,Pt),wt===null&&Sr(Pt.stateNode.containerInfo),ds(Pt),null;case 10:return os(Pt.type._context),ds(Pt),null;case 17:return Fn(Pt.type)&&zn(),ds(Pt),null;case 19:if(fn(Qn),Gt=Pt.memoizedState,Gt===null)return ds(Pt),null;if(Lt=(Pt.flags&128)!==0,Ht=Gt.rendering,Ht===null)if(Lt)El(Gt,!1);else{if(ns!==0||wt!==null&&wt.flags&128)for(wt=Pt.child;wt!==null;){if(Ht=Vl(wt),Ht!==null){for(Pt.flags|=128,El(Gt,!1),wt=Ht.updateQueue,wt!==null&&(Pt.updateQueue=wt,Pt.flags|=4),Pt.subtreeFlags=0,wt=kt,Lt=Pt.child;Lt!==null;)kt=Lt,Gt=wt,kt.flags&=14680066,Ht=kt.alternate,Ht===null?(kt.childLanes=0,kt.lanes=Gt,kt.child=null,kt.subtreeFlags=0,kt.memoizedProps=null,kt.memoizedState=null,kt.updateQueue=null,kt.dependencies=null,kt.stateNode=null):(kt.childLanes=Ht.childLanes,kt.lanes=Ht.lanes,kt.child=Ht.child,kt.subtreeFlags=0,kt.deletions=null,kt.memoizedProps=Ht.memoizedProps,kt.memoizedState=Ht.memoizedState,kt.updateQueue=Ht.updateQueue,kt.type=Ht.type,Gt=Ht.dependencies,kt.dependencies=Gt===null?null:{lanes:Gt.lanes,firstContext:Gt.firstContext}),Lt=Lt.sibling;return on(Qn,Qn.current&1|2),Pt.child}wt=wt.sibling}Gt.tail!==null&&Wn()>rp&&(Pt.flags|=128,Lt=!0,El(Gt,!1),Pt.lanes=4194304)}else{if(!Lt)if(wt=Vl(Ht),wt!==null){if(Pt.flags|=128,Lt=!0,wt=wt.updateQueue,wt!==null&&(Pt.updateQueue=wt,Pt.flags|=4),El(Gt,!0),Gt.tail===null&&Gt.tailMode==="hidden"&&!Ht.alternate&&!Xn)return ds(Pt),null}else 2*Wn()-Gt.renderingStartTime>rp&&kt!==1073741824&&(Pt.flags|=128,Lt=!0,El(Gt,!1),Pt.lanes=4194304);Gt.isBackwards?(Ht.sibling=Pt.child,Pt.child=Ht):(wt=Gt.last,wt!==null?wt.sibling=Ht:Pt.child=Ht,Gt.last=Ht)}return Gt.tail!==null?(Pt=Gt.tail,Gt.rendering=Pt,Gt.tail=Pt.sibling,Gt.renderingStartTime=Wn(),Pt.sibling=null,wt=Qn.current,on(Qn,Lt?wt&1|2:wt&1),Pt):(ds(Pt),null);case 22:case 23:return ap(),Lt=Pt.memoizedState!==null,wt!==null&&wt.memoizedState!==null!==Lt&&(Pt.flags|=8192),Lt&&Pt.mode&1?ks&1073741824&&(ds(Pt),gr&&Pt.subtreeFlags&6&&(Pt.flags|=8192)):ds(Pt),null;case 24:return null;case 25:return null}throw Error(at(156,Pt.tag))}var Q0=lt.ReactCurrentOwner,Os=!1;function ys(wt,Pt,kt,Lt){Pt.child=wt===null?Tp(Pt,null,kt,Lt):Uo(Pt,wt.child,kt,Lt)}function Zp(wt,Pt,kt,Lt,Gt){kt=kt.render;var Ht=Pt.ref;return Kn(Pt,Gt),Lt=Lu(wt,Pt,kt,Lt,Ht,Gt),kt=Bu(),wt!==null&&!Os?(Pt.updateQueue=wt.updateQueue,Pt.flags&=-2053,wt.lanes&=~Gt,so(wt,Pt,Gt)):(Xn&&kt&&Su(Pt),Pt.flags|=1,ys(wt,Pt,Lt,Gt),Pt.child)}function _f(wt,Pt,kt,Lt,Gt){if(wt===null){var Ht=kt.type;return typeof Ht=="function"&&!cp(Ht)&&Ht.defaultProps===void 0&&kt.compare===null&&kt.defaultProps===void 0?(Pt.tag=15,Pt.type=Ht,e0(wt,Pt,Ht,Lt,Gt)):(wt=bu(kt.type,null,Lt,Pt,Pt.mode,Gt),wt.ref=Pt.ref,wt.return=Pt,Pt.child=wt)}if(Ht=wt.child,!(wt.lanes&Gt)){var dr=Ht.memoizedProps;if(kt=kt.compare,kt=kt!==null?kt:_o,kt(dr,Lt)&&wt.ref===Pt.ref)return so(wt,Pt,Gt)}return Pt.flags|=1,wt=go(Ht,Lt),wt.ref=Pt.ref,wt.return=Pt,Pt.child=wt}function e0(wt,Pt,kt,Lt,Gt){if(wt!==null&&_o(wt.memoizedProps,Lt)&&wt.ref===Pt.ref)if(Os=!1,(wt.lanes&Gt)!==0)wt.flags&131072&&(Os=!0);else return Pt.lanes=wt.lanes,so(wt,Pt,Gt);return zu(wt,Pt,kt,Lt,Gt)}function r0(wt,Pt,kt){var Lt=Pt.pendingProps,Gt=Lt.children,Ht=wt!==null?wt.memoizedState:null;if(Lt.mode==="hidden")if(!(Pt.mode&1))Pt.memoizedState={baseLanes:0,cachePool:null},on(jo,ks),ks|=kt;else if(kt&1073741824)Pt.memoizedState={baseLanes:0,cachePool:null},Lt=Ht!==null?Ht.baseLanes:kt,on(jo,ks),ks|=Lt;else return wt=Ht!==null?Ht.baseLanes|kt:kt,Pt.lanes=Pt.childLanes=1073741824,Pt.memoizedState={baseLanes:wt,cachePool:null},Pt.updateQueue=null,on(jo,ks),ks|=wt,null;else Ht!==null?(Lt=Ht.baseLanes|kt,Pt.memoizedState=null):Lt=kt,on(jo,ks),ks|=Lt;return ys(wt,Pt,Gt,kt),Pt.child}function i0(wt,Pt){var kt=Pt.ref;(wt===null&&kt!==null||wt!==null&&wt.ref!==kt)&&(Pt.flags|=512,Pt.flags|=2097152)}function zu(wt,Pt,kt,Lt,Gt){var Ht=Fn(kt)?Dn:Bn.current;return Ht=On(Pt,Ht),Kn(Pt,Gt),kt=Lu(wt,Pt,kt,Lt,Ht,Gt),Lt=Bu(),wt!==null&&!Os?(Pt.updateQueue=wt.updateQueue,Pt.flags&=-2053,wt.lanes&=~Gt,so(wt,Pt,Gt)):(Xn&&Lt&&Su(Pt),Pt.flags|=1,ys(wt,Pt,kt,Gt),Pt.child)}function n0(wt,Pt,kt,Lt,Gt){if(Fn(kt)){var Ht=!0;Ln(Pt)}else Ht=!1;if(Kn(Pt,Gt),Pt.stateNode===null)wt!==null&&(wt.alternate=null,Pt.alternate=null,Pt.flags|=2),yp(Pt,kt,Lt),Eu(Pt,kt,Lt,Gt),Lt=!0;else if(wt===null){var dr=Pt.stateNode,Pr=Pt.memoizedProps;dr.props=Pr;var jr=dr.context,Jr=kt.contextType;typeof Jr=="object"&&Jr!==null?Jr=Zn(Jr):(Jr=Fn(kt)?Dn:Bn.current,Jr=On(Pt,Jr));var sn=kt.getDerivedStateFromProps,Tn=typeof sn=="function"||typeof dr.getSnapshotBeforeUpdate=="function";Tn||typeof dr.UNSAFE_componentWillReceiveProps!="function"&&typeof dr.componentWillReceiveProps!="function"||(Pr!==Lt||jr!==Jr)&&Ap(Pt,dr,Lt,Jr),lo=!1;var gn=Pt.memoizedState;dr.state=gn,Fl(Pt,Lt,dr,Gt),jr=Pt.memoizedState,Pr!==Lt||gn!==jr||mn.current||lo?(typeof sn=="function"&&(xu(Pt,kt,sn,Lt),jr=Pt.memoizedState),(Pr=lo||vp(Pt,kt,Pr,Lt,gn,jr,Jr))?(Tn||typeof dr.UNSAFE_componentWillMount!="function"&&typeof dr.componentWillMount!="function"||(typeof dr.componentWillMount=="function"&&dr.componentWillMount(),typeof dr.UNSAFE_componentWillMount=="function"&&dr.UNSAFE_componentWillMount()),typeof dr.componentDidMount=="function"&&(Pt.flags|=4194308)):(typeof dr.componentDidMount=="function"&&(Pt.flags|=4194308),Pt.memoizedProps=Lt,Pt.memoizedState=jr),dr.props=Lt,dr.state=jr,dr.context=Jr,Lt=Pr):(typeof dr.componentDidMount=="function"&&(Pt.flags|=4194308),Lt=!1)}else{dr=Pt.stateNode,pp(wt,Pt),Pr=Pt.memoizedProps,Jr=Pt.type===Pt.elementType?Pr:ms(Pt.type,Pr),dr.props=Jr,Tn=Pt.pendingProps,gn=dr.context,jr=kt.contextType,typeof jr=="object"&&jr!==null?jr=Zn(jr):(jr=Fn(kt)?Dn:Bn.current,jr=On(Pt,jr));var Hn=kt.getDerivedStateFromProps;(sn=typeof Hn=="function"||typeof dr.getSnapshotBeforeUpdate=="function")||typeof dr.UNSAFE_componentWillReceiveProps!="function"&&typeof dr.componentWillReceiveProps!="function"||(Pr!==Tn||gn!==jr)&&Ap(Pt,dr,Lt,jr),lo=!1,gn=Pt.memoizedState,dr.state=gn,Fl(Pt,Lt,dr,Gt);var hn=Pt.memoizedState;Pr!==Tn||gn!==hn||mn.current||lo?(typeof Hn=="function"&&(xu(Pt,kt,Hn,Lt),hn=Pt.memoizedState),(Jr=lo||vp(Pt,kt,Jr,Lt,gn,hn,jr)||!1)?(sn||typeof dr.UNSAFE_componentWillUpdate!="function"&&typeof dr.componentWillUpdate!="function"||(typeof dr.componentWillUpdate=="function"&&dr.componentWillUpdate(Lt,hn,jr),typeof dr.UNSAFE_componentWillUpdate=="function"&&dr.UNSAFE_componentWillUpdate(Lt,hn,jr)),typeof dr.componentDidUpdate=="function"&&(Pt.flags|=4),typeof dr.getSnapshotBeforeUpdate=="function"&&(Pt.flags|=1024)):(typeof dr.componentDidUpdate!="function"||Pr===wt.memoizedProps&&gn===wt.memoizedState||(Pt.flags|=4),typeof dr.getSnapshotBeforeUpdate!="function"||Pr===wt.memoizedProps&&gn===wt.memoizedState||(Pt.flags|=1024),Pt.memoizedProps=Lt,Pt.memoizedState=hn),dr.props=Lt,dr.state=hn,dr.context=jr,Lt=Jr):(typeof dr.componentDidUpdate!="function"||Pr===wt.memoizedProps&&gn===wt.memoizedState||(Pt.flags|=4),typeof dr.getSnapshotBeforeUpdate!="function"||Pr===wt.memoizedProps&&gn===wt.memoizedState||(Pt.flags|=1024),Lt=!1)}return ju(wt,Pt,kt,Lt,Ht,Gt)}function ju(wt,Pt,kt,Lt,Gt,Ht){i0(wt,Pt);var dr=(Pt.flags&128)!==0;if(!Lt&&!dr)return Gt&&xn(Pt,kt,!1),so(wt,Pt,Ht);Lt=Pt.stateNode,Q0.current=Pt;var Pr=dr&&typeof kt.getDerivedStateFromError!="function"?null:Lt.render();return Pt.flags|=1,wt!==null&&dr?(Pt.child=Uo(Pt,wt.child,null,Ht),Pt.child=Uo(Pt,null,Pr,Ht)):ys(wt,Pt,Pr,Ht),Pt.memoizedState=Lt.state,Gt&&xn(Pt,kt,!0),Pt.child}function s0(wt){var Pt=wt.stateNode;Pt.pendingContext?bn(wt,Pt.pendingContext,Pt.pendingContext!==Pt.context):Pt.context&&bn(wt,Pt.context,!1),Ru(wt,Pt.containerInfo)}function o0(wt,Pt,kt,Lt,Gt){return Fo(),Mu(Gt),Pt.flags|=256,ys(wt,Pt,kt,Lt),Pt.child}var eu={dehydrated:null,treeContext:null,retryLane:0};function tu(wt){return{baseLanes:wt,cachePool:null}}function a0(wt,Pt,kt){var Lt=Pt.pendingProps,Gt=Qn.current,Ht=!1,dr=(Pt.flags&128)!==0,Pr;if((Pr=dr)||(Pr=wt!==null&&wt.memoizedState===null?!1:(Gt&2)!==0),Pr?(Ht=!0,Pt.flags&=-129):(wt===null||wt.memoizedState!==null)&&(Gt|=1),on(Qn,Gt&1),wt===null)return Pu(Pt),wt=Pt.memoizedState,wt!==null&&(wt=wt.dehydrated,wt!==null)?(Pt.mode&1?In(wt)?Pt.lanes=8:Pt.lanes=1073741824:Pt.lanes=1,null):(Gt=Lt.children,wt=Lt.fallback,Ht?(Lt=Pt.mode,Ht=Pt.child,Gt={mode:"hidden",children:Gt},!(Lt&1)&&Ht!==null?(Ht.childLanes=0,Ht.pendingProps=Gt):Ht=_u(Gt,Lt,0,null),wt=Io(wt,Lt,kt,null),Ht.return=Pt,wt.return=Pt,Ht.sibling=wt,Pt.child=Ht,Pt.child.memoizedState=tu(kt),Pt.memoizedState=eu,wt):Vu(Pt,Gt));if(Gt=wt.memoizedState,Gt!==null){if(Pr=Gt.dehydrated,Pr!==null){if(dr)return Pt.flags&256?(Pt.flags&=-257,ru(wt,Pt,kt,Error(at(422)))):Pt.memoizedState!==null?(Pt.child=wt.child,Pt.flags|=128,null):(Ht=Lt.fallback,Gt=Pt.mode,Lt=_u({mode:"visible",children:Lt.children},Gt,0,null),Ht=Io(Ht,Gt,kt,null),Ht.flags|=2,Lt.return=Pt,Ht.return=Pt,Lt.sibling=Ht,Pt.child=Lt,Pt.mode&1&&Uo(Pt,wt.child,null,kt),Pt.child.memoizedState=tu(kt),Pt.memoizedState=eu,Ht);if(!(Pt.mode&1))Pt=ru(wt,Pt,kt,null);else if(In(Pr))Pt=ru(wt,Pt,kt,Error(at(419)));else if(Lt=(kt&wt.childLanes)!==0,Os||Lt){if(Lt=ts,Lt!==null){switch(kt&-kt){case 4:Ht=2;break;case 16:Ht=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Ht=32;break;case 536870912:Ht=268435456;break;default:Ht=0}Lt=Ht&(Lt.suspendedLanes|kt)?0:Ht,Lt!==0&&Lt!==Gt.retryLane&&(Gt.retryLane=Lt,Us(wt,Lt,-1))}lp(),Pt=ru(wt,Pt,kt,Error(at(421)))}else Sn(Pr)?(Pt.flags|=128,Pt.child=wt.child,Pt=l1.bind(null,wt),jn(Pr,Pt),Pt=null):(kt=Gt.treeContext,nr&&(Is=bs(Pr),Rs=Pt,Xn=!0,js=null,Zo=!1,kt!==null&&(Ls[Bs++]=ro,Ls[Bs++]=io,Ls[Bs++]=xo,ro=kt.id,io=kt.overflow,xo=Pt)),Pt=Vu(Pt,Pt.pendingProps.children),Pt.flags|=4096);return Pt}return Ht?(Lt=c0(wt,Pt,Lt.children,Lt.fallback,kt),Ht=Pt.child,Gt=wt.child.memoizedState,Ht.memoizedState=Gt===null?tu(kt):{baseLanes:Gt.baseLanes|kt,cachePool:null},Ht.childLanes=wt.childLanes&~kt,Pt.memoizedState=eu,Lt):(kt=l0(wt,Pt,Lt.children,kt),Pt.memoizedState=null,kt)}return Ht?(Lt=c0(wt,Pt,Lt.children,Lt.fallback,kt),Ht=Pt.child,Gt=wt.child.memoizedState,Ht.memoizedState=Gt===null?tu(kt):{baseLanes:Gt.baseLanes|kt,cachePool:null},Ht.childLanes=wt.childLanes&~kt,Pt.memoizedState=eu,Lt):(kt=l0(wt,Pt,Lt.children,kt),Pt.memoizedState=null,kt)}function Vu(wt,Pt){return Pt=_u({mode:"visible",children:Pt},wt.mode,0,null),Pt.return=wt,wt.child=Pt}function l0(wt,Pt,kt,Lt){var Gt=wt.child;return wt=Gt.sibling,kt=go(Gt,{mode:"visible",children:kt}),!(Pt.mode&1)&&(kt.lanes=Lt),kt.return=Pt,kt.sibling=null,wt!==null&&(Lt=Pt.deletions,Lt===null?(Pt.deletions=[wt],Pt.flags|=16):Lt.push(wt)),Pt.child=kt}function c0(wt,Pt,kt,Lt,Gt){var Ht=Pt.mode;wt=wt.child;var dr=wt.sibling,Pr={mode:"hidden",children:kt};return!(Ht&1)&&Pt.child!==wt?(kt=Pt.child,kt.childLanes=0,kt.pendingProps=Pr,Pt.deletions=null):(kt=go(wt,Pr),kt.subtreeFlags=wt.subtreeFlags&14680064),dr!==null?Lt=go(dr,Lt):(Lt=Io(Lt,Ht,Gt,null),Lt.flags|=2),Lt.return=Pt,kt.return=Pt,kt.sibling=Lt,Pt.child=kt,Lt}function ru(wt,Pt,kt,Lt){return Lt!==null&&Mu(Lt),Uo(Pt,wt.child,null,kt),wt=Vu(Pt,Pt.pendingProps.children),wt.flags|=2,Pt.memoizedState=null,wt}function u0(wt,Pt,kt){wt.lanes|=Pt;var Lt=wt.alternate;Lt!==null&&(Lt.lanes|=Pt),vs(wt.return,Pt,kt)}function Hu(wt,Pt,kt,Lt,Gt){var Ht=wt.memoizedState;Ht===null?wt.memoizedState={isBackwards:Pt,rendering:null,renderingStartTime:0,last:Lt,tail:kt,tailMode:Gt}:(Ht.isBackwards=Pt,Ht.rendering=null,Ht.renderingStartTime=0,Ht.last=Lt,Ht.tail=kt,Ht.tailMode=Gt)}function h0(wt,Pt,kt){var Lt=Pt.pendingProps,Gt=Lt.revealOrder,Ht=Lt.tail;if(ys(wt,Pt,Lt.children,kt),Lt=Qn.current,Lt&2)Lt=Lt&1|2,Pt.flags|=128;else{if(wt!==null&&wt.flags&128)e:for(wt=Pt.child;wt!==null;){if(wt.tag===13)wt.memoizedState!==null&&u0(wt,kt,Pt);else if(wt.tag===19)u0(wt,kt,Pt);else if(wt.child!==null){wt.child.return=wt,wt=wt.child;continue}if(wt===Pt)break e;for(;wt.sibling===null;){if(wt.return===null||wt.return===Pt)break e;wt=wt.return}wt.sibling.return=wt.return,wt=wt.sibling}Lt&=1}if(on(Qn,Lt),!(Pt.mode&1))Pt.memoizedState=null;else switch(Gt){case"forwards":for(kt=Pt.child,Gt=null;kt!==null;)wt=kt.alternate,wt!==null&&Vl(wt)===null&&(Gt=kt),kt=kt.sibling;kt=Gt,kt===null?(Gt=Pt.child,Pt.child=null):(Gt=kt.sibling,kt.sibling=null),Hu(Pt,!1,Gt,kt,Ht);break;case"backwards":for(kt=null,Gt=Pt.child,Pt.child=null;Gt!==null;){if(wt=Gt.alternate,wt!==null&&Vl(wt)===null){Pt.child=Gt;break}wt=Gt.sibling,Gt.sibling=kt,kt=Gt,Gt=wt}Hu(Pt,!0,kt,null,Ht);break;case"together":Hu(Pt,!1,null,null,void 0);break;default:Pt.memoizedState=null}return Pt.child}function so(wt,Pt,kt){if(wt!==null&&(Pt.dependencies=wt.dependencies),Vo|=Pt.lanes,!(kt&Pt.childLanes))return null;if(wt!==null&&Pt.child!==wt.child)throw Error(at(153));if(Pt.child!==null){for(wt=Pt.child,kt=go(wt,wt.pendingProps),Pt.child=kt,kt.return=Pt;wt.sibling!==null;)wt=wt.sibling,kt=kt.sibling=go(wt,wt.pendingProps),kt.return=Pt;kt.sibling=null}return Pt.child}function J0(wt,Pt,kt){switch(Pt.tag){case 3:s0(Pt),Fo();break;case 5:wp(Pt);break;case 1:Fn(Pt.type)&&Ln(Pt);break;case 4:Ru(Pt,Pt.stateNode.containerInfo);break;case 10:Bl(Pt,Pt.type._context,Pt.memoizedProps.value);break;case 13:var Lt=Pt.memoizedState;if(Lt!==null)return Lt.dehydrated!==null?(on(Qn,Qn.current&1),Pt.flags|=128,null):kt&Pt.child.childLanes?a0(wt,Pt,kt):(on(Qn,Qn.current&1),wt=so(wt,Pt,kt),wt!==null?wt.sibling:null);on(Qn,Qn.current&1);break;case 19:if(Lt=(kt&Pt.childLanes)!==0,wt.flags&128){if(Lt)return h0(wt,Pt,kt);Pt.flags|=128}var Gt=Pt.memoizedState;if(Gt!==null&&(Gt.rendering=null,Gt.tail=null,Gt.lastEffect=null),on(Qn,Qn.current),Lt)break;return null;case 22:case 23:return Pt.lanes=0,r0(wt,Pt,kt)}return so(wt,Pt,kt)}function q0(wt,Pt){switch(Tu(Pt),Pt.tag){case 1:return Fn(Pt.type)&&zn(),wt=Pt.flags,wt&65536?(Pt.flags=wt&-65537|128,Pt):null;case 3:return Go(),fn(mn),fn(Bn),ku(),wt=Pt.flags,wt&65536&&!(wt&128)?(Pt.flags=wt&-65537|128,Pt):null;case 5:return Iu(Pt),null;case 13:if(fn(Qn),wt=Pt.memoizedState,wt!==null&&wt.dehydrated!==null){if(Pt.alternate===null)throw Error(at(340));Fo()}return wt=Pt.flags,wt&65536?(Pt.flags=wt&-65537|128,Pt):null;case 19:return fn(Qn),null;case 4:return Go(),null;case 10:return os(Pt.type._context),null;case 22:case 23:return ap(),null;case 24:return null;default:return null}}var iu=!1,To=!1,K0=typeof WeakSet=="function"?WeakSet:Set,en=null;function nu(wt,Pt){var kt=wt.ref;if(kt!==null)if(typeof kt=="function")try{kt(null)}catch(Lt){Ss(wt,Pt,Lt)}else kt.current=null}function Yu(wt,Pt,kt){try{kt()}catch(Lt){Ss(wt,Pt,Lt)}}var d0=!1;function Z0(wt,Pt){for(Ft(wt.containerInfo),en=Pt;en!==null;)if(wt=en,Pt=wt.child,(wt.subtreeFlags&1028)!==0&&Pt!==null)Pt.return=wt,en=Pt;else for(;en!==null;){wt=en;try{var kt=wt.alternate;if(wt.flags&1024)switch(wt.tag){case 0:case 11:case 15:break;case 1:if(kt!==null){var Lt=kt.memoizedProps,Gt=kt.memoizedState,Ht=wt.stateNode,dr=Ht.getSnapshotBeforeUpdate(wt.elementType===wt.type?Lt:ms(wt.type,Lt),Gt);Ht.__reactInternalSnapshotBeforeUpdate=dr}break;case 3:gr&&Vr(wt.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(at(163))}}catch(Pr){Ss(wt,wt.return,Pr)}if(Pt=wt.sibling,Pt!==null){Pt.return=wt.return,en=Pt;break}en=wt.return}return kt=d0,d0=!1,kt}function wo(wt,Pt,kt){var Lt=Pt.updateQueue;if(Lt=Lt!==null?Lt.lastEffect:null,Lt!==null){var Gt=Lt=Lt.next;do{if((Gt.tag&wt)===wt){var Ht=Gt.destroy;Gt.destroy=void 0,Ht!==void 0&&Yu(Pt,kt,Ht)}Gt=Gt.next}while(Gt!==Lt)}}function Sl(wt,Pt){if(Pt=Pt.updateQueue,Pt=Pt!==null?Pt.lastEffect:null,Pt!==null){var kt=Pt=Pt.next;do{if((kt.tag&wt)===wt){var Lt=kt.create;kt.destroy=Lt()}kt=kt.next}while(kt!==Pt)}}function Xu(wt){var Pt=wt.ref;if(Pt!==null){var kt=wt.stateNode;switch(wt.tag){case 5:wt=Nt(kt);break;default:wt=kt}typeof Pt=="function"?Pt(wt):Pt.current=wt}}function p0(wt,Pt,kt){if(ws&&typeof ws.onCommitFiberUnmount=="function")try{ws.onCommitFiberUnmount(Ao,Pt)}catch{}switch(Pt.tag){case 0:case 11:case 14:case 15:if(wt=Pt.updateQueue,wt!==null&&(wt=wt.lastEffect,wt!==null)){var Lt=wt=wt.next;do{var Gt=Lt,Ht=Gt.destroy;Gt=Gt.tag,Ht!==void 0&&(Gt&2||Gt&4)&&Yu(Pt,kt,Ht),Lt=Lt.next}while(Lt!==wt)}break;case 1:if(nu(Pt,kt),wt=Pt.stateNode,typeof wt.componentWillUnmount=="function")try{wt.props=Pt.memoizedProps,wt.state=Pt.memoizedState,wt.componentWillUnmount()}catch(dr){Ss(Pt,kt,dr)}break;case 5:nu(Pt,kt);break;case 4:gr?A0(wt,Pt,kt):Yt&&Yt&&(Pt=Pt.stateNode.containerInfo,kt=pn(Pt),Cn(Pt,kt))}}function f0(wt,Pt,kt){for(var Lt=Pt;;)if(p0(wt,Lt,kt),Lt.child===null||gr&&Lt.tag===4){if(Lt===Pt)break;for(;Lt.sibling===null;){if(Lt.return===null||Lt.return===Pt)return;Lt=Lt.return}Lt.sibling.return=Lt.return,Lt=Lt.sibling}else Lt.child.return=Lt,Lt=Lt.child}function g0(wt){var Pt=wt.alternate;Pt!==null&&(wt.alternate=null,g0(Pt)),wt.child=null,wt.deletions=null,wt.sibling=null,wt.tag===5&&(Pt=wt.stateNode,Pt!==null&&Nr(Pt)),wt.stateNode=null,wt.return=null,wt.dependencies=null,wt.memoizedProps=null,wt.memoizedState=null,wt.pendingProps=null,wt.stateNode=null,wt.updateQueue=null}function m0(wt){return wt.tag===5||wt.tag===3||wt.tag===4}function v0(wt){e:for(;;){for(;wt.sibling===null;){if(wt.return===null||m0(wt.return))return null;wt=wt.return}for(wt.sibling.return=wt.return,wt=wt.sibling;wt.tag!==5&&wt.tag!==6&&wt.tag!==18;){if(wt.flags&2||wt.child===null||wt.tag===4)continue e;wt.child.return=wt,wt=wt.child}if(!(wt.flags&2))return wt.stateNode}}function y0(wt){if(gr){e:{for(var Pt=wt.return;Pt!==null;){if(m0(Pt))break e;Pt=Pt.return}throw Error(at(160))}var kt=Pt;switch(kt.tag){case 5:Pt=kt.stateNode,kt.flags&32&&(Kt(Pt),kt.flags&=-33),kt=v0(wt),Qu(wt,kt,Pt);break;case 3:case 4:Pt=kt.stateNode.containerInfo,kt=v0(wt),Wu(wt,kt,Pt);break;default:throw Error(at(161))}}}function Wu(wt,Pt,kt){var Lt=wt.tag;if(Lt===5||Lt===6)wt=wt.stateNode,Pt?yr(kt,wt,Pt):Hr(kt,wt);else if(Lt!==4&&(wt=wt.child,wt!==null))for(Wu(wt,Pt,kt),wt=wt.sibling;wt!==null;)Wu(wt,Pt,kt),wt=wt.sibling}function Qu(wt,Pt,kt){var Lt=wt.tag;if(Lt===5||Lt===6)wt=wt.stateNode,Pt?Ar(kt,wt,Pt):pr(kt,wt);else if(Lt!==4&&(wt=wt.child,wt!==null))for(Qu(wt,Pt,kt),wt=wt.sibling;wt!==null;)Qu(wt,Pt,kt),wt=wt.sibling}function A0(wt,Pt,kt){for(var Lt=Pt,Gt=!1,Ht,dr;;){if(!Gt){Gt=Lt.return;e:for(;;){if(Gt===null)throw Error(at(160));switch(Ht=Gt.stateNode,Gt.tag){case 5:dr=!1;break e;case 3:Ht=Ht.containerInfo,dr=!0;break e;case 4:Ht=Ht.containerInfo,dr=!0;break e}Gt=Gt.return}Gt=!0}if(Lt.tag===5||Lt.tag===6)f0(wt,Lt,kt),dr?_r(Ht,Lt.stateNode):Jt(Ht,Lt.stateNode);else if(Lt.tag===18)dr?Dr(Ht,Lt.stateNode):Br(Ht,Lt.stateNode);else if(Lt.tag===4){if(Lt.child!==null){Ht=Lt.stateNode.containerInfo,dr=!0,Lt.child.return=Lt,Lt=Lt.child;continue}}else if(p0(wt,Lt,kt),Lt.child!==null){Lt.child.return=Lt,Lt=Lt.child;continue}if(Lt===Pt)break;for(;Lt.sibling===null;){if(Lt.return===null||Lt.return===Pt)return;Lt=Lt.return,Lt.tag===4&&(Gt=!1)}Lt.sibling.return=Lt.return,Lt=Lt.sibling}}function Ju(wt,Pt){if(gr){switch(Pt.tag){case 0:case 11:case 14:case 15:wo(3,Pt,Pt.return),Sl(3,Pt),wo(5,Pt,Pt.return);return;case 1:return;case 5:var kt=Pt.stateNode;if(kt!=null){var Lt=Pt.memoizedProps;wt=wt!==null?wt.memoizedProps:Lt;var Gt=Pt.type,Ht=Pt.updateQueue;Pt.updateQueue=null,Ht!==null&&tr(kt,Ht,Gt,wt,Lt,Pt)}return;case 6:if(Pt.stateNode===null)throw Error(at(162));kt=Pt.memoizedProps,hr(Pt.stateNode,wt!==null?wt.memoizedProps:kt,kt);return;case 3:nr&&wt!==null&&wt.memoizedState.isDehydrated&&or(Pt.stateNode.containerInfo);return;case 12:return;case 13:su(Pt);return;case 19:su(Pt);return;case 17:return}throw Error(at(163))}switch(Pt.tag){case 0:case 11:case 14:case 15:wo(3,Pt,Pt.return),Sl(3,Pt),wo(5,Pt,Pt.return);return;case 12:return;case 13:su(Pt);return;case 19:su(Pt);return;case 3:nr&&wt!==null&&wt.memoizedState.isDehydrated&&or(Pt.stateNode.containerInfo);break;case 22:case 23:return}e:if(Yt){switch(Pt.tag){case 1:case 5:case 6:break e;case 3:case 4:Pt=Pt.stateNode,Cn(Pt.containerInfo,Pt.pendingChildren);break e}throw Error(at(163))}}function su(wt){var Pt=wt.updateQueue;if(Pt!==null){wt.updateQueue=null;var kt=wt.stateNode;kt===null&&(kt=wt.stateNode=new K0),Pt.forEach(function(Lt){var Gt=c1.bind(null,wt,Lt);kt.has(Lt)||(kt.add(Lt),Lt.then(Gt,Gt))})}}function e1(wt,Pt){for(en=Pt;en!==null;){Pt=en;var kt=Pt.deletions;if(kt!==null)for(var Lt=0;Lt<kt.length;Lt++){var Gt=kt[Lt];try{var Ht=wt;gr?A0(Ht,Gt,Pt):f0(Ht,Gt,Pt);var dr=Gt.alternate;dr!==null&&(dr.return=null),Gt.return=null}catch(un){Ss(Gt,Pt,un)}}if(kt=Pt.child,Pt.subtreeFlags&12854&&kt!==null)kt.return=Pt,en=kt;else for(;en!==null;){Pt=en;try{var Pr=Pt.flags;if(Pr&32&&gr&&Kt(Pt.stateNode),Pr&512){var jr=Pt.alternate;if(jr!==null){var Jr=jr.ref;Jr!==null&&(typeof Jr=="function"?Jr(null):Jr.current=null)}}if(Pr&8192)switch(Pt.tag){case 13:if(Pt.memoizedState!==null){var sn=Pt.alternate;(sn===null||sn.memoizedState===null)&&(tp=Wn())}break;case 22:var Tn=Pt.memoizedState!==null,gn=Pt.alternate,Hn=gn!==null&&gn.memoizedState!==null;if(kt=Pt,gr){e:if(Lt=kt,Gt=Tn,Ht=null,gr)for(var hn=Lt;;){if(hn.tag===5){if(Ht===null){Ht=hn;var ps=hn.stateNode;Gt?Qr(ps):Rr(hn.stateNode,hn.memoizedProps)}}else if(hn.tag===6){if(Ht===null){var Gs=hn.stateNode;Gt?br(Gs):Tr(Gs,hn.memoizedProps)}}else if((hn.tag!==22&&hn.tag!==23||hn.memoizedState===null||hn===Lt)&&hn.child!==null){hn.child.return=hn,hn=hn.child;continue}if(hn===Lt)break;for(;hn.sibling===null;){if(hn.return===null||hn.return===Lt)break e;Ht===hn&&(Ht=null),hn=hn.return}Ht===hn&&(Ht=null),hn.sibling.return=hn.return,hn=hn.sibling}}if(Tn&&!Hn&&kt.mode&1){en=kt;for(var Fr=kt.child;Fr!==null;){for(kt=en=Fr;en!==null;){Lt=en;var Ir=Lt.child;switch(Lt.tag){case 0:case 11:case 14:case 15:wo(4,Lt,Lt.return);break;case 1:nu(Lt,Lt.return);var $r=Lt.stateNode;if(typeof $r.componentWillUnmount=="function"){var tn=Lt.return;try{$r.props=Lt.memoizedProps,$r.state=Lt.memoizedState,$r.componentWillUnmount()}catch(un){Ss(Lt,tn,un)}}break;case 5:nu(Lt,Lt.return);break;case 22:if(Lt.memoizedState!==null){C0(kt);continue}}Ir!==null?(Ir.return=Lt,en=Ir):C0(kt)}Fr=Fr.sibling}}}switch(Pr&4102){case 2:y0(Pt),Pt.flags&=-3;break;case 6:y0(Pt),Pt.flags&=-3,Ju(Pt.alternate,Pt);break;case 4096:Pt.flags&=-4097;break;case 4100:Pt.flags&=-4097,Ju(Pt.alternate,Pt);break;case 4:Ju(Pt.alternate,Pt)}}catch(un){Ss(Pt,Pt.return,un)}if(kt=Pt.sibling,kt!==null){kt.return=Pt.return,en=kt;break}en=Pt.return}}}function t1(wt,Pt,kt){en=wt,b0(wt)}function b0(wt,Pt,kt){for(var Lt=(wt.mode&1)!==0;en!==null;){var Gt=en,Ht=Gt.child;if(Gt.tag===22&&Lt){var dr=Gt.memoizedState!==null||iu;if(!dr){var Pr=Gt.alternate,jr=Pr!==null&&Pr.memoizedState!==null||To;Pr=iu;var Jr=To;if(iu=dr,(To=jr)&&!Jr)for(en=Gt;en!==null;)dr=en,jr=dr.child,dr.tag===22&&dr.memoizedState!==null?x0(Gt):jr!==null?(jr.return=dr,en=jr):x0(Gt);for(;Ht!==null;)en=Ht,b0(Ht),Ht=Ht.sibling;en=Gt,iu=Pr,To=Jr}_0(wt)}else Gt.subtreeFlags&8772&&Ht!==null?(Ht.return=Gt,en=Ht):_0(wt)}}function _0(wt){for(;en!==null;){var Pt=en;if(Pt.flags&8772){var kt=Pt.alternate;try{if(Pt.flags&8772)switch(Pt.tag){case 0:case 11:case 15:To||Sl(5,Pt);break;case 1:var Lt=Pt.stateNode;if(Pt.flags&4&&!To)if(kt===null)Lt.componentDidMount();else{var Gt=Pt.elementType===Pt.type?kt.memoizedProps:ms(Pt.type,kt.memoizedProps);Lt.componentDidUpdate(Gt,kt.memoizedState,Lt.__reactInternalSnapshotBeforeUpdate)}var Ht=Pt.updateQueue;Ht!==null&&gp(Pt,Ht,Lt);break;case 3:var dr=Pt.updateQueue;if(dr!==null){if(kt=null,Pt.child!==null)switch(Pt.child.tag){case 5:kt=Nt(Pt.child.stateNode);break;case 1:kt=Pt.child.stateNode}gp(Pt,dr,kt)}break;case 5:var Pr=Pt.stateNode;kt===null&&Pt.flags&4&&Cr(Pr,Pt.type,Pt.memoizedProps,Pt);break;case 6:break;case 4:break;case 12:break;case 13:if(nr&&Pt.memoizedState===null){var jr=Pt.alternate;if(jr!==null){var Jr=jr.memoizedState;if(Jr!==null){var sn=Jr.dehydrated;sn!==null&&vr(sn)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(at(163))}To||Pt.flags&512&&Xu(Pt)}catch(Tn){Ss(Pt,Pt.return,Tn)}}if(Pt===wt){en=null;break}if(kt=Pt.sibling,kt!==null){kt.return=Pt.return,en=kt;break}en=Pt.return}}function C0(wt){for(;en!==null;){var Pt=en;if(Pt===wt){en=null;break}var kt=Pt.sibling;if(kt!==null){kt.return=Pt.return,en=kt;break}en=Pt.return}}function x0(wt){for(;en!==null;){var Pt=en;try{switch(Pt.tag){case 0:case 11:case 15:var kt=Pt.return;try{Sl(4,Pt)}catch(jr){Ss(Pt,kt,jr)}break;case 1:var Lt=Pt.stateNode;if(typeof Lt.componentDidMount=="function"){var Gt=Pt.return;try{Lt.componentDidMount()}catch(jr){Ss(Pt,Gt,jr)}}var Ht=Pt.return;try{Xu(Pt)}catch(jr){Ss(Pt,Ht,jr)}break;case 5:var dr=Pt.return;try{Xu(Pt)}catch(jr){Ss(Pt,dr,jr)}}}catch(jr){Ss(Pt,Pt.return,jr)}if(Pt===wt){en=null;break}var Pr=Pt.sibling;if(Pr!==null){Pr.return=Pt.return,en=Pr;break}en=Pt.return}}var ou=0,au=1,lu=2,cu=3,uu=4;if(typeof Symbol=="function"&&Symbol.for){var Tl=Symbol.for;ou=Tl("selector.component"),au=Tl("selector.has_pseudo_class"),lu=Tl("selector.role"),cu=Tl("selector.test_id"),uu=Tl("selector.text")}function qu(wt){var Pt=mr(wt);if(Pt!=null){if(typeof Pt.memoizedProps["data-testname"]!="string")throw Error(at(364));return Pt}if(wt=Or(wt),wt===null)throw Error(at(362));return wt.stateNode.current}function Ku(wt,Pt){switch(Pt.$$typeof){case ou:if(wt.type===Pt.value)return!0;break;case au:e:{Pt=Pt.value,wt=[wt,0];for(var kt=0;kt<wt.length;){var Lt=wt[kt++],Gt=wt[kt++],Ht=Pt[Gt];if(Lt.tag!==5||!Xt(Lt)){for(;Ht!=null&&Ku(Lt,Ht);)Gt++,Ht=Pt[Gt];if(Gt===Pt.length){Pt=!0;break e}else for(Lt=Lt.child;Lt!==null;)wt.push(Lt,Gt),Lt=Lt.sibling}}Pt=!1}return Pt;case lu:if(wt.tag===5&&xr(wt.stateNode,Pt.value))return!0;break;case uu:if((wt.tag===5||wt.tag===6)&&(wt=Qt(wt),wt!==null&&0<=wt.indexOf(Pt.value)))return!0;break;case cu:if(wt.tag===5&&(wt=wt.memoizedProps["data-testname"],typeof wt=="string"&&wt.toLowerCase()===Pt.value.toLowerCase()))return!0;break;default:throw Error(at(365))}return!1}function Zu(wt){switch(wt.$$typeof){case ou:return"<"+(Ct(wt.value)||"Unknown")+">";case au:return":has("+(Zu(wt)||"")+")";case lu:return'[role="'+wt.value+'"]';case uu:return'"'+wt.value+'"';case cu:return'[data-testname="'+wt.value+'"]';default:throw Error(at(365))}}function E0(wt,Pt){var kt=[];wt=[wt,0];for(var Lt=0;Lt<wt.length;){var Gt=wt[Lt++],Ht=wt[Lt++],dr=Pt[Ht];if(Gt.tag!==5||!Xt(Gt)){for(;dr!=null&&Ku(Gt,dr);)Ht++,dr=Pt[Ht];if(Ht===Pt.length)kt.push(Gt);else for(Gt=Gt.child;Gt!==null;)wt.push(Gt,Ht),Gt=Gt.sibling}}return kt}function _h(wt,Pt){if(!Ur)throw Error(at(363));wt=qu(wt),wt=E0(wt,Pt),Pt=[],wt=Array.from(wt);for(var kt=0;kt<wt.length;){var Lt=wt[kt++];if(Lt.tag===5)Xt(Lt)||Pt.push(Lt.stateNode);else for(Lt=Lt.child;Lt!==null;)wt.push(Lt),Lt=Lt.sibling}return Pt}var r1=Math.ceil,hu=lt.ReactCurrentDispatcher,_d=lt.ReactCurrentOwner,es=lt.ReactCurrentBatchConfig,Rn=0,ts=null,rs=null,cs=0,ks=0,jo=_i(0),ns=0,Pl=null,Vo=0,du=0,ep=0,Ml=null,xs=null,tp=0,rp=1/0;function Ho(){rp=Wn()+500}var pu=!1,ip=null,uo=null,fu=!1,ho=null,gu=0,Rl=0,np=null,mu=-1,vu=0;function As(){return Rn&6?Wn():mu!==-1?mu:mu=Wn()}function po(wt){return wt.mode&1?Rn&2&&cs!==0?cs&-cs:bo.transition!==null?(vu===0&&(wt=Js,Js<<=1,!(Js&4194240)&&(Js=64),vu=wt),vu):(wt=kn,wt!==0?wt:Er()):1}function Us(wt,Pt,kt){if(50<Rl)throw Rl=0,np=null,Error(at(185));var Lt=yu(wt,Pt);return Lt===null?null:(Vs(Lt,Pt,kt),(!(Rn&2)||Lt!==ts)&&(Lt===ts&&(!(Rn&2)&&(du|=Pt),ns===4&&fo(Lt,cs)),Es(Lt,kt),Pt===1&&Rn===0&&!(wt.mode&1)&&(Ho(),Ys&&Cs())),Lt)}function yu(wt,Pt){wt.lanes|=Pt;var kt=wt.alternate;for(kt!==null&&(kt.lanes|=Pt),kt=wt,wt=wt.return;wt!==null;)wt.childLanes|=Pt,kt=wt.alternate,kt!==null&&(kt.childLanes|=Pt),kt=wt,wt=wt.return;return kt.tag===3?kt.stateNode:null}function Es(wt,Pt){var kt=wt.callbackNode;Yo(wt,Pt);var Lt=vo(wt,wt===ts?cs:0);if(Lt===0)kt!==null&&ko(kt),wt.callbackNode=null,wt.callbackPriority=0;else if(Pt=Lt&-Lt,wt.callbackPriority!==Pt){if(kt!=null&&ko(kt),Pt===1)wt.tag===0?Ko(T0.bind(null,wt)):qo(T0.bind(null,wt)),wr?kr(function(){Rn===0&&Cs()}):eo(yo,Cs),kt=null;else{switch(Xo(Lt)){case 1:kt=yo;break;case 4:kt=Nl;break;case 16:kt=fs;break;case 536870912:kt=Qo;break;default:kt=fs}kt=L0(kt,S0.bind(null,wt))}wt.callbackPriority=Pt,wt.callbackNode=kt}}function S0(wt,Pt){if(mu=-1,vu=0,Rn&6)throw Error(at(327));var kt=wt.callbackNode;if(Ro()&&wt.callbackNode!==kt)return null;var Lt=vo(wt,wt===ts?cs:0);if(Lt===0)return null;if(Lt&30||Lt&wt.expiredLanes||Pt)Pt=Au(wt,Lt);else{Pt=Lt;var Gt=Rn;Rn|=2;var Ht=M0();(ts!==wt||cs!==Pt)&&(Ho(),Po(wt,Pt));do try{s1();break}catch(Pr){P0(wt,Pr)}while(1);Lo(),hu.current=Ht,Rn=Gt,rs!==null?Pt=0:(ts=null,cs=0,Pt=ns)}if(Pt!==0){if(Pt===2&&(Gt=Zs(wt),Gt!==0&&(Lt=Gt,Pt=sp(wt,Gt))),Pt===1)throw kt=Pl,Po(wt,0),fo(wt,Lt),Es(wt,Wn()),kt;if(Pt===6)fo(wt,Lt);else{if(Gt=wt.current.alternate,!(Lt&30)&&!i1(Gt)&&(Pt=Au(wt,Lt),Pt===2&&(Ht=Zs(wt),Ht!==0&&(Lt=Ht,Pt=sp(wt,Ht))),Pt===1))throw kt=Pl,Po(wt,0),fo(wt,Lt),Es(wt,Wn()),kt;switch(wt.finishedWork=Gt,wt.finishedLanes=Lt,Pt){case 0:case 1:throw Error(at(345));case 2:Mo(wt,xs);break;case 3:if(fo(wt,Lt),(Lt&130023424)===Lt&&(Pt=tp+500-Wn(),10<Pt)){if(vo(wt,0)!==0)break;if(Gt=wt.suspendedLanes,(Gt&Lt)!==Lt){As(),wt.pingedLanes|=wt.suspendedLanes&Gt;break}wt.timeoutHandle=ir(Mo.bind(null,wt,xs),Pt);break}Mo(wt,xs);break;case 4:if(fo(wt,Lt),(Lt&4194240)===Lt)break;for(Pt=wt.eventTimes,Gt=-1;0<Lt;){var dr=31-Yn(Lt);Ht=1<<dr,dr=Pt[dr],dr>Gt&&(Gt=dr),Lt&=~Ht}if(Lt=Gt,Lt=Wn()-Lt,Lt=(120>Lt?120:480>Lt?480:1080>Lt?1080:1920>Lt?1920:3e3>Lt?3e3:4320>Lt?4320:1960*r1(Lt/1960))-Lt,10<Lt){wt.timeoutHandle=ir(Mo.bind(null,wt,xs),Lt);break}Mo(wt,xs);break;case 5:Mo(wt,xs);break;default:throw Error(at(329))}}}return Es(wt,Wn()),wt.callbackNode===kt?S0.bind(null,wt):null}function sp(wt,Pt){var kt=Ml;return wt.current.memoizedState.isDehydrated&&(Po(wt,Pt).flags|=256),wt=Au(wt,Pt),wt!==2&&(Pt=xs,xs=kt,Pt!==null&&op(Pt)),wt}function op(wt){xs===null?xs=wt:xs.push.apply(xs,wt)}function i1(wt){for(var Pt=wt;;){if(Pt.flags&16384){var kt=Pt.updateQueue;if(kt!==null&&(kt=kt.stores,kt!==null))for(var Lt=0;Lt<kt.length;Lt++){var Gt=kt[Lt],Ht=Gt.getSnapshot;Gt=Gt.value;try{if(!Ps(Ht(),Gt))return!1}catch{return!1}}}if(kt=Pt.child,Pt.subtreeFlags&16384&&kt!==null)kt.return=Pt,Pt=kt;else{if(Pt===wt)break;for(;Pt.sibling===null;){if(Pt.return===null||Pt.return===wt)return!0;Pt=Pt.return}Pt.sibling.return=Pt.return,Pt=Pt.sibling}}return!0}function fo(wt,Pt){for(Pt&=~ep,Pt&=~du,wt.suspendedLanes|=Pt,wt.pingedLanes&=~Pt,wt=wt.expirationTimes;0<Pt;){var kt=31-Yn(Pt),Lt=1<<kt;wt[kt]=-1,Pt&=~Lt}}function T0(wt){if(Rn&6)throw Error(at(327));Ro();var Pt=vo(wt,0);if(!(Pt&1))return Es(wt,Wn()),null;var kt=Au(wt,Pt);if(wt.tag!==0&&kt===2){var Lt=Zs(wt);Lt!==0&&(Pt=Lt,kt=sp(wt,Lt))}if(kt===1)throw kt=Pl,Po(wt,0),fo(wt,Pt),Es(wt,Wn()),kt;if(kt===6)throw Error(at(345));return wt.finishedWork=wt.current.alternate,wt.finishedLanes=Pt,Mo(wt,xs),Es(wt,Wn()),null}function w0(wt){ho!==null&&ho.tag===0&&!(Rn&6)&&Ro();var Pt=Rn;Rn|=1;var kt=es.transition,Lt=kn;try{if(es.transition=null,kn=1,wt)return wt()}finally{kn=Lt,es.transition=kt,Rn=Pt,!(Rn&6)&&Cs()}}function ap(){ks=jo.current,fn(jo)}function Po(wt,Pt){wt.finishedWork=null,wt.finishedLanes=0;var kt=wt.timeoutHandle;if(kt!==ar&&(wt.timeoutHandle=ar,ur(kt)),rs!==null)for(kt=rs.return;kt!==null;){var Lt=kt;switch(Tu(Lt),Lt.tag){case 1:Lt=Lt.type.childContextTypes,Lt!=null&&zn();break;case 3:Go(),fn(mn),fn(Bn),ku();break;case 5:Iu(Lt);break;case 4:Go();break;case 13:fn(Qn);break;case 19:fn(Qn);break;case 10:os(Lt.type._context);break;case 22:case 23:ap()}kt=kt.return}if(ts=wt,rs=wt=go(wt.current,null),cs=ks=Pt,ns=0,Pl=null,ep=du=Vo=0,xs=Ml=null,Ms!==null){for(Pt=0;Pt<Ms.length;Pt++)if(kt=Ms[Pt],Lt=kt.interleaved,Lt!==null){kt.interleaved=null;var Gt=Lt.next,Ht=kt.pending;if(Ht!==null){var dr=Ht.next;Ht.next=Gt,Lt.next=dr}kt.pending=Lt}Ms=null}return wt}function P0(wt,Pt){do{var kt=rs;try{if(Lo(),Hl.current=Kl,Yl){for(var Lt=Jn.memoizedState;Lt!==null;){var Gt=Lt.queue;Gt!==null&&(Gt.pending=null),Lt=Lt.next}Yl=!1}if(zo=0,as=us=Jn=null,$a=!1,yl=0,_d.current=null,kt===null||kt.return===null){ns=1,Pl=Pt,rs=null;break}e:{var Ht=wt,dr=kt.return,Pr=kt,jr=Pt;if(Pt=cs,Pr.flags|=32768,jr!==null&&typeof jr=="object"&&typeof jr.then=="function"){var Jr=jr,sn=Pr,Tn=sn.tag;if(!(sn.mode&1)&&(Tn===0||Tn===11||Tn===15)){var gn=sn.alternate;gn?(sn.updateQueue=gn.updateQueue,sn.memoizedState=gn.memoizedState,sn.lanes=gn.lanes):(sn.updateQueue=null,sn.memoizedState=null)}var Hn=Qp(dr);if(Hn!==null){Hn.flags&=-257,Jp(Hn,dr,Pr,Ht,Pt),Hn.mode&1&&Wp(Ht,Jr,Pt),Pt=Hn,jr=Jr;var hn=Pt.updateQueue;if(hn===null){var ps=new Set;ps.add(jr),Pt.updateQueue=ps}else hn.add(jr);break e}else{if(!(Pt&1)){Wp(Ht,Jr,Pt),lp();break e}jr=Error(at(426))}}else if(Xn&&Pr.mode&1){var Gs=Qp(dr);if(Gs!==null){!(Gs.flags&65536)&&(Gs.flags|=256),Jp(Gs,dr,Pr,Ht,Pt),Mu(jr);break e}}Ht=jr,ns!==4&&(ns=2),Ml===null?Ml=[Ht]:Ml.push(Ht),jr=$u(jr,Pr),Pr=dr;do{switch(Pr.tag){case 3:Pr.flags|=65536,Pt&=-Pt,Pr.lanes|=Pt;var Fr=Yp(Pr,jr,Pt);fp(Pr,Fr);break e;case 1:Ht=jr;var Ir=Pr.type,$r=Pr.stateNode;if(!(Pr.flags&128)&&(typeof Ir.getDerivedStateFromError=="function"||$r!==null&&typeof $r.componentDidCatch=="function"&&(uo===null||!uo.has($r)))){Pr.flags|=65536,Pt&=-Pt,Pr.lanes|=Pt;var tn=Xp(Pr,Ht,Pt);fp(Pr,tn);break e}}Pr=Pr.return}while(Pr!==null)}I0(kt)}catch(un){Pt=un,rs===kt&&kt!==null&&(rs=kt=kt.return);continue}break}while(1)}function M0(){var wt=hu.current;return hu.current=Kl,wt===null?Kl:wt}function lp(){(ns===0||ns===3||ns===2)&&(ns=4),ts===null||!(Vo&268435455)&&!(du&268435455)||fo(ts,cs)}function Au(wt,Pt){var kt=Rn;Rn|=2;var Lt=M0();ts===wt&&cs===Pt||Po(wt,Pt);do try{n1();break}catch(Gt){P0(wt,Gt)}while(1);if(Lo(),Rn=kt,hu.current=Lt,rs!==null)throw Error(at(261));return ts=null,cs=0,ns}function n1(){for(;rs!==null;)R0(rs)}function s1(){for(;rs!==null&&!Wo();)R0(rs)}function R0(wt){var Pt=N0(wt.alternate,wt,ks);wt.memoizedProps=wt.pendingProps,Pt===null?I0(wt):rs=Pt,_d.current=null}function I0(wt){var Pt=wt;do{var kt=Pt.alternate;if(wt=Pt.return,Pt.flags&32768){if(kt=q0(kt,Pt),kt!==null){kt.flags&=32767,rs=kt;return}if(wt!==null)wt.flags|=32768,wt.subtreeFlags=0,wt.deletions=null;else{ns=6,rs=null;return}}else if(kt=W0(kt,Pt,ks),kt!==null){rs=kt;return}if(Pt=Pt.sibling,Pt!==null){rs=Pt;return}rs=Pt=wt}while(Pt!==null);ns===0&&(ns=5)}function Mo(wt,Pt){var kt=kn,Lt=es.transition;try{es.transition=null,kn=1,o1(wt,Pt,kt)}finally{es.transition=Lt,kn=kt}return null}function o1(wt,Pt,kt){do Ro();while(ho!==null);if(Rn&6)throw Error(at(327));var Lt=wt.finishedWork,Gt=wt.finishedLanes;if(Lt===null)return null;if(wt.finishedWork=null,wt.finishedLanes=0,Lt===wt.current)throw Error(at(177));wt.callbackNode=null,wt.callbackPriority=0;var Ht=Lt.lanes|Lt.childLanes;if(oo(wt,Ht),wt===ts&&(rs=ts=null,cs=0),!(Lt.subtreeFlags&2064)&&!(Lt.flags&2064)||fu||(fu=!0,L0(fs,function(){return Ro(),null})),Ht=(Lt.flags&15990)!==0,Lt.subtreeFlags&15990||Ht){Ht=es.transition,es.transition=null;var dr=kn;kn=1;var Pr=Rn;Rn|=4,_d.current=null,Z0(wt,Lt),e1(wt,Lt),Ut(wt.containerInfo),wt.current=Lt,t1(Lt),Ol(),Rn=Pr,kn=dr,es.transition=Ht}else wt.current=Lt;if(fu&&(fu=!1,ho=wt,gu=Gt),Ht=wt.pendingLanes,Ht===0&&(uo=null),Jo(Lt.stateNode),Es(wt,Wn()),Pt!==null)for(kt=wt.onRecoverableError,Lt=0;Lt<Pt.length;Lt++)kt(Pt[Lt]);if(pu)throw pu=!1,wt=ip,ip=null,wt;return gu&1&&wt.tag!==0&&Ro(),Ht=wt.pendingLanes,Ht&1?wt===np?Rl++:(Rl=0,np=wt):Rl=0,Cs(),null}function Ro(){if(ho!==null){var wt=Xo(gu),Pt=es.transition,kt=kn;try{if(es.transition=null,kn=16>wt?16:wt,ho===null)var Lt=!1;else{if(wt=ho,ho=null,gu=0,Rn&6)throw Error(at(331));var Gt=Rn;for(Rn|=4,en=wt.current;en!==null;){var Ht=en,dr=Ht.child;if(en.flags&16){var Pr=Ht.deletions;if(Pr!==null){for(var jr=0;jr<Pr.length;jr++){var Jr=Pr[jr];for(en=Jr;en!==null;){var sn=en;switch(sn.tag){case 0:case 11:case 15:wo(8,sn,Ht)}var Tn=sn.child;if(Tn!==null)Tn.return=sn,en=Tn;else for(;en!==null;){sn=en;var gn=sn.sibling,Hn=sn.return;if(g0(sn),sn===Jr){en=null;break}if(gn!==null){gn.return=Hn,en=gn;break}en=Hn}}}var hn=Ht.alternate;if(hn!==null){var ps=hn.child;if(ps!==null){hn.child=null;do{var Gs=ps.sibling;ps.sibling=null,ps=Gs}while(ps!==null)}}en=Ht}}if(Ht.subtreeFlags&2064&&dr!==null)dr.return=Ht,en=dr;else e:for(;en!==null;){if(Ht=en,Ht.flags&2048)switch(Ht.tag){case 0:case 11:case 15:wo(9,Ht,Ht.return)}var Fr=Ht.sibling;if(Fr!==null){Fr.return=Ht.return,en=Fr;break e}en=Ht.return}}var Ir=wt.current;for(en=Ir;en!==null;){dr=en;var $r=dr.child;if(dr.subtreeFlags&2064&&$r!==null)$r.return=dr,en=$r;else e:for(dr=Ir;en!==null;){if(Pr=en,Pr.flags&2048)try{switch(Pr.tag){case 0:case 11:case 15:Sl(9,Pr)}}catch(un){Ss(Pr,Pr.return,un)}if(Pr===dr){en=null;break e}var tn=Pr.sibling;if(tn!==null){tn.return=Pr.return,en=tn;break e}en=Pr.return}}if(Rn=Gt,Cs(),ws&&typeof ws.onPostCommitFiberRoot=="function")try{ws.onPostCommitFiberRoot(Ao,wt)}catch{}Lt=!0}return Lt}finally{kn=kt,es.transition=Pt}}return!1}function O0(wt,Pt,kt){Pt=$u(kt,Pt),Pt=Yp(wt,Pt,1),co(wt,Pt),Pt=As(),wt=yu(wt,1),wt!==null&&(Vs(wt,1,Pt),Es(wt,Pt))}function Ss(wt,Pt,kt){if(wt.tag===3)O0(wt,wt,kt);else for(;Pt!==null;){if(Pt.tag===3){O0(Pt,wt,kt);break}else if(Pt.tag===1){var Lt=Pt.stateNode;if(typeof Pt.type.getDerivedStateFromError=="function"||typeof Lt.componentDidCatch=="function"&&(uo===null||!uo.has(Lt))){wt=$u(kt,wt),wt=Xp(Pt,wt,1),co(Pt,wt),wt=As(),Pt=yu(Pt,1),Pt!==null&&(Vs(Pt,1,wt),Es(Pt,wt));break}}Pt=Pt.return}}function a1(wt,Pt,kt){var Lt=wt.pingCache;Lt!==null&&Lt.delete(Pt),Pt=As(),wt.pingedLanes|=wt.suspendedLanes&kt,ts===wt&&(cs&kt)===kt&&(ns===4||ns===3&&(cs&130023424)===cs&&500>Wn()-tp?Po(wt,0):ep|=kt),Es(wt,Pt)}function k0(wt,Pt){Pt===0&&(wt.mode&1?(Pt=qs,qs<<=1,!(qs&130023424)&&(qs=4194304)):Pt=1);var kt=As();wt=yu(wt,Pt),wt!==null&&(Vs(wt,Pt,kt),Es(wt,kt))}function l1(wt){var Pt=wt.memoizedState,kt=0;Pt!==null&&(kt=Pt.retryLane),k0(wt,kt)}function c1(wt,Pt){var kt=0;switch(wt.tag){case 13:var Lt=wt.stateNode,Gt=wt.memoizedState;Gt!==null&&(kt=Gt.retryLane);break;case 19:Lt=wt.stateNode;break;default:throw Error(at(314))}Lt!==null&&Lt.delete(Pt),k0(wt,kt)}var N0;N0=function(wt,Pt,kt){if(wt!==null)if(wt.memoizedProps!==Pt.pendingProps||mn.current)Os=!0;else{if(!(wt.lanes&kt)&&!(Pt.flags&128))return Os=!1,J0(wt,Pt,kt);Os=!!(wt.flags&131072)}else Os=!1,Xn&&Pt.flags&1048576&&bp(Pt,Gl,Pt.index);switch(Pt.lanes=0,Pt.tag){case 2:var Lt=Pt.type;wt!==null&&(wt.alternate=null,Pt.alternate=null,Pt.flags|=2),wt=Pt.pendingProps;var Gt=On(Pt,Bn.current);Kn(Pt,kt),Gt=Lu(null,Pt,Lt,wt,Gt,kt);var Ht=Bu();return Pt.flags|=1,typeof Gt=="object"&&Gt!==null&&typeof Gt.render=="function"&&Gt.$$typeof===void 0?(Pt.tag=1,Pt.memoizedState=null,Pt.updateQueue=null,Fn(Lt)?(Ht=!0,Ln(Pt)):Ht=!1,Pt.memoizedState=Gt.state!==null&&Gt.state!==void 0?Gt.state:null,Cu(Pt),Gt.updater=Ul,Pt.stateNode=Gt,Gt._reactInternals=Pt,Eu(Pt,Lt,wt,kt),Pt=ju(null,Pt,Lt,!0,Ht,kt)):(Pt.tag=0,Xn&&Ht&&Su(Pt),ys(null,Pt,Gt,kt),Pt=Pt.child),Pt;case 16:Lt=Pt.elementType;e:{switch(wt!==null&&(wt.alternate=null,Pt.alternate=null,Pt.flags|=2),wt=Pt.pendingProps,Gt=Lt._init,Lt=Gt(Lt._payload),Pt.type=Lt,Gt=Pt.tag=h1(Lt),wt=ms(Lt,wt),Gt){case 0:Pt=zu(null,Pt,Lt,wt,kt);break e;case 1:Pt=n0(null,Pt,Lt,wt,kt);break e;case 11:Pt=Zp(null,Pt,Lt,wt,kt);break e;case 14:Pt=_f(null,Pt,Lt,ms(Lt.type,wt),kt);break e}throw Error(at(306,Lt,""))}return Pt;case 0:return Lt=Pt.type,Gt=Pt.pendingProps,Gt=Pt.elementType===Lt?Gt:ms(Lt,Gt),zu(wt,Pt,Lt,Gt,kt);case 1:return Lt=Pt.type,Gt=Pt.pendingProps,Gt=Pt.elementType===Lt?Gt:ms(Lt,Gt),n0(wt,Pt,Lt,Gt,kt);case 3:e:{if(s0(Pt),wt===null)throw Error(at(387));Lt=Pt.pendingProps,Ht=Pt.memoizedState,Gt=Ht.element,pp(wt,Pt),Fl(Pt,Lt,null,kt);var dr=Pt.memoizedState;if(Lt=dr.element,nr&&Ht.isDehydrated)if(Ht={element:Lt,isDehydrated:!1,cache:dr.cache,transitions:dr.transitions},Pt.updateQueue.baseState=Ht,Pt.memoizedState=Ht,Pt.flags&256){Gt=Error(at(423)),Pt=o0(wt,Pt,Lt,kt,Gt);break e}else if(Lt!==Gt){Gt=Error(at(424)),Pt=o0(wt,Pt,Lt,kt,Gt);break e}else for(nr&&(Is=Nn(Pt.stateNode.containerInfo),Rs=Pt,Xn=!0,js=null,Zo=!1),kt=Tp(Pt,null,Lt,kt),Pt.child=kt;kt;)kt.flags=kt.flags&-3|4096,kt=kt.sibling;else{if(Fo(),Lt===Gt){Pt=so(wt,Pt,kt);break e}ys(wt,Pt,Lt,kt)}Pt=Pt.child}return Pt;case 5:return wp(Pt),wt===null&&Pu(Pt),Lt=Pt.type,Gt=Pt.pendingProps,Ht=wt!==null?wt.memoizedProps:null,dr=Gt.children,sr(Lt,Gt)?dr=null:Ht!==null&&sr(Lt,Ht)&&(Pt.flags|=32),i0(wt,Pt),ys(wt,Pt,dr,kt),Pt.child;case 6:return wt===null&&Pu(Pt),null;case 13:return a0(wt,Pt,kt);case 4:return Ru(Pt,Pt.stateNode.containerInfo),Lt=Pt.pendingProps,wt===null?Pt.child=Uo(Pt,null,Lt,kt):ys(wt,Pt,Lt,kt),Pt.child;case 11:return Lt=Pt.type,Gt=Pt.pendingProps,Gt=Pt.elementType===Lt?Gt:ms(Lt,Gt),Zp(wt,Pt,Lt,Gt,kt);case 7:return ys(wt,Pt,Pt.pendingProps,kt),Pt.child;case 8:return ys(wt,Pt,Pt.pendingProps.children,kt),Pt.child;case 12:return ys(wt,Pt,Pt.pendingProps.children,kt),Pt.child;case 10:e:{if(Lt=Pt.type._context,Gt=Pt.pendingProps,Ht=Pt.memoizedProps,dr=Gt.value,Bl(Pt,Lt,dr),Ht!==null)if(Ps(Ht.value,dr)){if(Ht.children===Gt.children&&!mn.current){Pt=so(wt,Pt,kt);break e}}else for(Ht=Pt.child,Ht!==null&&(Ht.return=Pt);Ht!==null;){var Pr=Ht.dependencies;if(Pr!==null){dr=Ht.child;for(var jr=Pr.firstContext;jr!==null;){if(jr.context===Lt){if(Ht.tag===1){jr=to(-1,kt&-kt),jr.tag=2;var Jr=Ht.updateQueue;if(Jr!==null){Jr=Jr.shared;var sn=Jr.pending;sn===null?jr.next=jr:(jr.next=sn.next,sn.next=jr),Jr.pending=jr}}Ht.lanes|=kt,jr=Ht.alternate,jr!==null&&(jr.lanes|=kt),vs(Ht.return,kt,Pt),Pr.lanes|=kt;break}jr=jr.next}}else if(Ht.tag===10)dr=Ht.type===Pt.type?null:Ht.child;else if(Ht.tag===18){if(dr=Ht.return,dr===null)throw Error(at(341));dr.lanes|=kt,Pr=dr.alternate,Pr!==null&&(Pr.lanes|=kt),vs(dr,kt,Pt),dr=Ht.sibling}else dr=Ht.child;if(dr!==null)dr.return=Ht;else for(dr=Ht;dr!==null;){if(dr===Pt){dr=null;break}if(Ht=dr.sibling,Ht!==null){Ht.return=dr.return,dr=Ht;break}dr=dr.return}Ht=dr}ys(wt,Pt,Gt.children,kt),Pt=Pt.child}return Pt;case 9:return Gt=Pt.type,Lt=Pt.pendingProps.children,Kn(Pt,kt),Gt=Zn(Gt),Lt=Lt(Gt),Pt.flags|=1,ys(wt,Pt,Lt,kt),Pt.child;case 14:return Lt=Pt.type,Gt=ms(Lt,Pt.pendingProps),Gt=ms(Lt.type,Gt),_f(wt,Pt,Lt,Gt,kt);case 15:return e0(wt,Pt,Pt.type,Pt.pendingProps,kt);case 17:return Lt=Pt.type,Gt=Pt.pendingProps,Gt=Pt.elementType===Lt?Gt:ms(Lt,Gt),wt!==null&&(wt.alternate=null,Pt.alternate=null,Pt.flags|=2),Pt.tag=1,Fn(Lt)?(wt=!0,Ln(Pt)):wt=!1,Kn(Pt,kt),yp(Pt,Lt,Gt),Eu(Pt,Lt,Gt,kt),ju(null,Pt,Lt,!0,wt,kt);case 19:return h0(wt,Pt,kt);case 22:return r0(wt,Pt,kt)}throw Error(at(156,Pt.tag))};function L0(wt,Pt){return eo(wt,Pt)}function u1(wt,Pt,kt,Lt){this.tag=wt,this.key=kt,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=Pt,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Lt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $s(wt,Pt,kt,Lt){return new u1(wt,Pt,kt,Lt)}function cp(wt){return wt=wt.prototype,!(!wt||!wt.isReactComponent)}function h1(wt){if(typeof wt=="function")return cp(wt)?1:0;if(wt!=null){if(wt=wt.$$typeof,wt===gt)return 11;if(wt===yt)return 14}return 2}function go(wt,Pt){var kt=wt.alternate;return kt===null?(kt=$s(wt.tag,Pt,wt.key,wt.mode),kt.elementType=wt.elementType,kt.type=wt.type,kt.stateNode=wt.stateNode,kt.alternate=wt,wt.alternate=kt):(kt.pendingProps=Pt,kt.type=wt.type,kt.flags=0,kt.subtreeFlags=0,kt.deletions=null),kt.flags=wt.flags&14680064,kt.childLanes=wt.childLanes,kt.lanes=wt.lanes,kt.child=wt.child,kt.memoizedProps=wt.memoizedProps,kt.memoizedState=wt.memoizedState,kt.updateQueue=wt.updateQueue,Pt=wt.dependencies,kt.dependencies=Pt===null?null:{lanes:Pt.lanes,firstContext:Pt.firstContext},kt.sibling=wt.sibling,kt.index=wt.index,kt.ref=wt.ref,kt}function bu(wt,Pt,kt,Lt,Gt,Ht){var dr=2;if(Lt=wt,typeof wt=="function")cp(wt)&&(dr=1);else if(typeof wt=="string")dr=5;else e:switch(wt){case ut:return Io(kt.children,Gt,Ht,Pt);case ht:dr=8,Gt|=8;break;case dt:return wt=$s(12,kt,Pt,Gt|2),wt.elementType=dt,wt.lanes=Ht,wt;case mt:return wt=$s(13,kt,Pt,Gt),wt.elementType=mt,wt.lanes=Ht,wt;case At:return wt=$s(19,kt,Pt,Gt),wt.elementType=At,wt.lanes=Ht,wt;case xt:return _u(kt,Gt,Ht,Pt);default:if(typeof wt=="object"&&wt!==null)switch(wt.$$typeof){case pt:dr=10;break e;case ft:dr=9;break e;case gt:dr=11;break e;case yt:dr=14;break e;case bt:dr=16,Lt=null;break e}throw Error(at(130,wt==null?wt:typeof wt,""))}return Pt=$s(dr,kt,Pt,Gt),Pt.elementType=wt,Pt.type=Lt,Pt.lanes=Ht,Pt}function Io(wt,Pt,kt,Lt){return wt=$s(7,wt,Lt,Pt),wt.lanes=kt,wt}function _u(wt,Pt,kt,Lt){return wt=$s(22,wt,Lt,Pt),wt.elementType=xt,wt.lanes=kt,wt.stateNode={},wt}function up(wt,Pt,kt){return wt=$s(6,wt,null,Pt),wt.lanes=kt,wt}function hp(wt,Pt,kt){return Pt=$s(4,wt.children!==null?wt.children:[],wt.key,Pt),Pt.lanes=kt,Pt.stateNode={containerInfo:wt.containerInfo,pendingChildren:null,implementation:wt.implementation},Pt}function d1(wt,Pt,kt,Lt,Gt){this.tag=Pt,this.containerInfo=wt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ar,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Oo(0),this.expirationTimes=Oo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oo(0),this.identifierPrefix=Lt,this.onRecoverableError=Gt,nr&&(this.mutableSourceEagerHydrationData=null)}function B0(wt,Pt,kt,Lt,Gt,Ht,dr,Pr,jr){return wt=new d1(wt,Pt,kt,Pr,jr),Pt===1?(Pt=1,Ht===!0&&(Pt|=8)):Pt=0,Ht=$s(3,null,null,Pt),wt.current=Ht,Ht.stateNode=wt,Ht.memoizedState={element:Lt,isDehydrated:kt,cache:null,transitions:null},Cu(Ht),wt}function D0(wt){if(!wt)return An;wt=wt._reactInternals;e:{if(Et(wt)!==wt||wt.tag!==1)throw Error(at(170));var Pt=wt;do{switch(Pt.tag){case 3:Pt=Pt.stateNode.context;break e;case 1:if(Fn(Pt.type)){Pt=Pt.stateNode.__reactInternalMemoizedMergedChildContext;break e}}Pt=Pt.return}while(Pt!==null);throw Error(at(171))}if(wt.tag===1){var kt=wt.type;if(Fn(kt))return Vn(wt,kt,Pt)}return Pt}function F0(wt){var Pt=wt._reactInternals;if(Pt===void 0)throw typeof wt.render=="function"?Error(at(188)):(wt=Object.keys(wt).join(","),Error(at(268,wt)));return wt=Rt(Pt),wt===null?null:wt.stateNode}function U0(wt,Pt){if(wt=wt.memoizedState,wt!==null&&wt.dehydrated!==null){var kt=wt.retryLane;wt.retryLane=kt!==0&&kt<Pt?kt:Pt}}function dp(wt,Pt){U0(wt,Pt),(wt=wt.alternate)&&U0(wt,Pt)}function p1(wt){return wt=Rt(wt),wt===null?null:wt.stateNode}function f1(){return null}return rt.attemptContinuousHydration=function(wt){if(wt.tag===13){var Pt=As();Us(wt,134217728,Pt),dp(wt,134217728)}},rt.attemptHydrationAtCurrentPriority=function(wt){if(wt.tag===13){var Pt=As(),kt=po(wt);Us(wt,kt,Pt),dp(wt,kt)}},rt.attemptSynchronousHydration=function(wt){switch(wt.tag){case 3:var Pt=wt.stateNode;if(Pt.current.memoizedState.isDehydrated){var kt=Ks(Pt.pendingLanes);kt!==0&&(Hs(Pt,kt|1),Es(Pt,Wn()),!(Rn&6)&&(Ho(),Cs()))}break;case 13:var Lt=As();w0(function(){return Us(wt,1,Lt)}),dp(wt,1)}},rt.batchedUpdates=function(wt,Pt){var kt=Rn;Rn|=1;try{return wt(Pt)}finally{Rn=kt,Rn===0&&(Ho(),Ys&&Cs())}},rt.createComponentSelector=function(wt){return{$$typeof:ou,value:wt}},rt.createContainer=function(wt,Pt,kt,Lt,Gt,Ht,dr){return B0(wt,Pt,!1,null,kt,Lt,Gt,Ht,dr)},rt.createHasPseudoClassSelector=function(wt){return{$$typeof:au,value:wt}},rt.createHydrationContainer=function(wt,Pt,kt,Lt,Gt,Ht,dr,Pr,jr){return wt=B0(kt,Lt,!0,wt,Gt,Ht,dr,Pr,jr),wt.context=D0(null),kt=wt.current,Lt=As(),Gt=po(kt),Ht=to(Lt,Gt),Ht.callback=Pt??null,co(kt,Ht),wt.current.lanes=Gt,Vs(wt,Gt,Lt),Es(wt,Lt),wt},rt.createPortal=function(wt,Pt,kt){var Lt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ct,key:Lt==null?null:""+Lt,children:wt,containerInfo:Pt,implementation:kt}},rt.createRoleSelector=function(wt){return{$$typeof:lu,value:wt}},rt.createTestNameSelector=function(wt){return{$$typeof:cu,value:wt}},rt.createTextSelector=function(wt){return{$$typeof:uu,value:wt}},rt.deferredUpdates=function(wt){var Pt=kn,kt=es.transition;try{return es.transition=null,kn=16,wt()}finally{kn=Pt,es.transition=kt}},rt.discreteUpdates=function(wt,Pt,kt,Lt,Gt){var Ht=kn,dr=es.transition;try{return es.transition=null,kn=1,wt(Pt,kt,Lt,Gt)}finally{kn=Ht,es.transition=dr,Rn===0&&Ho()}},rt.findAllNodes=_h,rt.findBoundingRects=function(wt,Pt){if(!Ur)throw Error(at(363));Pt=_h(wt,Pt),wt=[];for(var kt=0;kt<Pt.length;kt++)wt.push(Xr(Pt[kt]));for(Pt=wt.length-1;0<Pt;Pt--){kt=wt[Pt];for(var Lt=kt.x,Gt=Lt+kt.width,Ht=kt.y,dr=Ht+kt.height,Pr=Pt-1;0<=Pr;Pr--)if(Pt!==Pr){var jr=wt[Pr],Jr=jr.x,sn=Jr+jr.width,Tn=jr.y,gn=Tn+jr.height;if(Lt>=Jr&&Ht>=Tn&&Gt<=sn&&dr<=gn){wt.splice(Pt,1);break}else if(Lt!==Jr||kt.width!==jr.width||gn<Ht||Tn>dr){if(!(Ht!==Tn||kt.height!==jr.height||sn<Lt||Jr>Gt)){Jr>Lt&&(jr.width+=Jr-Lt,jr.x=Lt),sn<Gt&&(jr.width=Gt-Jr),wt.splice(Pt,1);break}}else{Tn>Ht&&(jr.height+=Tn-Ht,jr.y=Ht),gn<dr&&(jr.height=dr-Tn),wt.splice(Pt,1);break}}}return wt},rt.findHostInstance=F0,rt.findHostInstanceWithNoPortals=function(wt){return wt=Mt(wt),wt=wt!==null?Ot(wt):null,wt===null?null:wt.stateNode},rt.findHostInstanceWithWarning=function(wt){return F0(wt)},rt.flushControlled=function(wt){var Pt=Rn;Rn|=1;var kt=es.transition,Lt=kn;try{es.transition=null,kn=1,wt()}finally{kn=Lt,es.transition=kt,Rn=Pt,Rn===0&&(Ho(),Cs())}},rt.flushPassiveEffects=Ro,rt.flushSync=w0,rt.focusWithin=function(wt,Pt){if(!Ur)throw Error(at(363));for(wt=qu(wt),Pt=E0(wt,Pt),Pt=Array.from(Pt),wt=0;wt<Pt.length;){var kt=Pt[wt++];if(!Xt(kt)){if(kt.tag===5&&Lr(kt.stateNode))return!0;for(kt=kt.child;kt!==null;)Pt.push(kt),kt=kt.sibling}}return!1},rt.getCurrentUpdatePriority=function(){return kn},rt.getFindAllNodesFailureDescription=function(wt,Pt){if(!Ur)throw Error(at(363));var kt=0,Lt=[];wt=[qu(wt),0];for(var Gt=0;Gt<wt.length;){var Ht=wt[Gt++],dr=wt[Gt++],Pr=Pt[dr];if((Ht.tag!==5||!Xt(Ht))&&(Ku(Ht,Pr)&&(Lt.push(Zu(Pr)),dr++,dr>kt&&(kt=dr)),dr<Pt.length))for(Ht=Ht.child;Ht!==null;)wt.push(Ht,dr),Ht=Ht.sibling}if(kt<Pt.length){for(wt=[];kt<Pt.length;kt++)wt.push(Zu(Pt[kt]));return`findAllNodes was able to match part of the selector:
  `+(Lt.join(" > ")+`

No matching component was found for:
  `)+wt.join(" > ")}return null},rt.getPublicRootInstance=function(wt){if(wt=wt.current,!wt.child)return null;switch(wt.child.tag){case 5:return Nt(wt.child.stateNode);default:return wt.child.stateNode}},rt.injectIntoDevTools=function(wt){if(wt={bundleType:wt.bundleType,version:wt.version,rendererPackageName:wt.rendererPackageName,rendererConfig:wt.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lt.ReactCurrentDispatcher,findHostInstanceByFiber:p1,findFiberByHostInstance:wt.findFiberByHostInstance||f1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")wt=!1;else{var Pt=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(Pt.isDisabled||!Pt.supportsFiber)wt=!0;else{try{Ao=Pt.inject(wt),ws=Pt}catch{}wt=!!Pt.checkDCE}}return wt},rt.isAlreadyRendering=function(){return!1},rt.observeVisibleRects=function(wt,Pt,kt,Lt){if(!Ur)throw Error(at(363));wt=_h(wt,Pt);var Gt=fr(wt,kt,Lt).disconnect;return{disconnect:function(){Gt()}}},rt.registerMutableSourceForHydration=function(wt,Pt){var kt=Pt._getVersion;kt=kt(Pt._source),wt.mutableSourceEagerHydrationData==null?wt.mutableSourceEagerHydrationData=[Pt,kt]:wt.mutableSourceEagerHydrationData.push(Pt,kt)},rt.runWithPriority=function(wt,Pt){var kt=kn;try{return kn=wt,Pt()}finally{kn=kt}},rt.shouldError=function(){return null},rt.shouldSuspend=function(){return!1},rt.updateContainer=function(wt,Pt,kt,Lt){var Gt=Pt.current,Ht=As(),dr=po(Gt);return kt=D0(kt),Pt.context===null?Pt.context=kt:Pt.pendingContext=kt,Pt=to(Ht,dr),Pt.payload={element:wt},Lt=Lt===void 0?null:Lt,Lt!==null&&(Pt.callback=Lt),co(Gt,Pt),wt=Us(Gt,dr,Ht),wt!==null&&Dl(wt,Gt,dr),dr},rt};reactReconciler.exports=reactReconciler_production_min;var reactReconcilerExports=reactReconciler.exports;const Reconciler=getDefaultExportFromCjs(reactReconcilerExports);var scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(tt){function _e(Dt,Ft){var Ut=Dt.length;Dt.push(Ft);e:for(;0<Ut;){var $t=Ut-1>>>1,Vt=Dt[$t];if(0<nt(Vt,Ft))Dt[$t]=Ft,Dt[Ut]=Vt,Ut=$t;else break e}}function rt(Dt){return Dt.length===0?null:Dt[0]}function it(Dt){if(Dt.length===0)return null;var Ft=Dt[0],Ut=Dt.pop();if(Ut!==Ft){Dt[0]=Ut;e:for(var $t=0,Vt=Dt.length,Zt=Vt>>>1;$t<Zt;){var qt=2*($t+1)-1,sr=Dt[qt],er=qt+1,ir=Dt[er];if(0>nt(sr,Ut))er<Vt&&0>nt(ir,sr)?(Dt[$t]=ir,Dt[er]=Ut,$t=er):(Dt[$t]=sr,Dt[qt]=Ut,$t=qt);else if(er<Vt&&0>nt(ir,Ut))Dt[$t]=ir,Dt[er]=Ut,$t=er;else break e}}return Ft}function nt(Dt,Ft){var Ut=Dt.sortIndex-Ft.sortIndex;return Ut!==0?Ut:Dt.id-Ft.id}if(typeof performance=="object"&&typeof performance.now=="function"){var st=performance;tt.unstable_now=function(){return st.now()}}else{var at=Date,lt=at.now();tt.unstable_now=function(){return at.now()-lt}}var ot=[],ct=[],ut=1,ht=null,dt=3,pt=!1,ft=!1,gt=!1,mt=typeof setTimeout=="function"?setTimeout:null,At=typeof clearTimeout=="function"?clearTimeout:null,yt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function bt(Dt){for(var Ft=rt(ct);Ft!==null;){if(Ft.callback===null)it(ct);else if(Ft.startTime<=Dt)it(ct),Ft.sortIndex=Ft.expirationTime,_e(ot,Ft);else break;Ft=rt(ct)}}function xt(Dt){if(gt=!1,bt(Dt),!ft)if(rt(ot)!==null)ft=!0,Nt(vt);else{var Ft=rt(ct);Ft!==null&&zt(xt,Ft.startTime-Dt)}}function vt(Dt,Ft){ft=!1,gt&&(gt=!1,At(St),St=-1),pt=!0;var Ut=dt;try{for(bt(Ft),ht=rt(ot);ht!==null&&(!(ht.expirationTime>Ft)||Dt&&!Mt());){var $t=ht.callback;if(typeof $t=="function"){ht.callback=null,dt=ht.priorityLevel;var Vt=$t(ht.expirationTime<=Ft);Ft=tt.unstable_now(),typeof Vt=="function"?ht.callback=Vt:ht===rt(ot)&&it(ot),bt(Ft)}else it(ot);ht=rt(ot)}if(ht!==null)var Zt=!0;else{var qt=rt(ct);qt!==null&&zt(xt,qt.startTime-Ft),Zt=!1}return Zt}finally{ht=null,dt=Ut,pt=!1}}var _t=!1,Ct=null,St=-1,Et=5,Tt=-1;function Mt(){return!(tt.unstable_now()-Tt<Et)}function Rt(){if(Ct!==null){var Dt=tt.unstable_now();Tt=Dt;var Ft=!0;try{Ft=Ct(!0,Dt)}finally{Ft?It():(_t=!1,Ct=null)}}else _t=!1}var It;if(typeof yt=="function")It=function(){yt(Rt)};else if(typeof MessageChannel<"u"){var Ot=new MessageChannel,Bt=Ot.port2;Ot.port1.onmessage=Rt,It=function(){Bt.postMessage(null)}}else It=function(){mt(Rt,0)};function Nt(Dt){Ct=Dt,_t||(_t=!0,It())}function zt(Dt,Ft){St=mt(function(){Dt(tt.unstable_now())},Ft)}tt.unstable_IdlePriority=5,tt.unstable_ImmediatePriority=1,tt.unstable_LowPriority=4,tt.unstable_NormalPriority=3,tt.unstable_Profiling=null,tt.unstable_UserBlockingPriority=2,tt.unstable_cancelCallback=function(Dt){Dt.callback=null},tt.unstable_continueExecution=function(){ft||pt||(ft=!0,Nt(vt))},tt.unstable_forceFrameRate=function(Dt){0>Dt||125<Dt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Et=0<Dt?Math.floor(1e3/Dt):5},tt.unstable_getCurrentPriorityLevel=function(){return dt},tt.unstable_getFirstCallbackNode=function(){return rt(ot)},tt.unstable_next=function(Dt){switch(dt){case 1:case 2:case 3:var Ft=3;break;default:Ft=dt}var Ut=dt;dt=Ft;try{return Dt()}finally{dt=Ut}},tt.unstable_pauseExecution=function(){},tt.unstable_requestPaint=function(){},tt.unstable_runWithPriority=function(Dt,Ft){switch(Dt){case 1:case 2:case 3:case 4:case 5:break;default:Dt=3}var Ut=dt;dt=Dt;try{return Ft()}finally{dt=Ut}},tt.unstable_scheduleCallback=function(Dt,Ft,Ut){var $t=tt.unstable_now();switch(typeof Ut=="object"&&Ut!==null?(Ut=Ut.delay,Ut=typeof Ut=="number"&&0<Ut?$t+Ut:$t):Ut=$t,Dt){case 1:var Vt=-1;break;case 2:Vt=250;break;case 5:Vt=1073741823;break;case 4:Vt=1e4;break;default:Vt=5e3}return Vt=Ut+Vt,Dt={id:ut++,callback:Ft,priorityLevel:Dt,startTime:Ut,expirationTime:Vt,sortIndex:-1},Ut>$t?(Dt.sortIndex=Ut,_e(ct,Dt),rt(ot)===null&&Dt===rt(ct)&&(gt?(At(St),St=-1):gt=!0,zt(xt,Ut-$t))):(Dt.sortIndex=Vt,_e(ot,Dt),ft||pt||(ft=!0,Nt(vt))),Dt},tt.unstable_shouldYield=Mt,tt.unstable_wrapCallback=function(Dt){var Ft=dt;return function(){var Ut=dt;dt=Ft;try{return Dt.apply(this,arguments)}finally{dt=Ut}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;const isPromise=tt=>typeof tt=="object"&&typeof tt.then=="function",globalCache=[];function shallowEqualArrays(tt,_e,rt=(it,nt)=>it===nt){if(tt===_e)return!0;if(!tt||!_e)return!1;const it=tt.length;if(_e.length!==it)return!1;for(let nt=0;nt<it;nt++)if(!rt(tt[nt],_e[nt]))return!1;return!0}function query(tt,_e=null,rt=!1,it={}){_e===null&&(_e=[tt]);for(const st of globalCache)if(shallowEqualArrays(_e,st.keys,st.equal)){if(rt)return;if(Object.prototype.hasOwnProperty.call(st,"error"))throw st.error;if(Object.prototype.hasOwnProperty.call(st,"response"))return it.lifespan&&it.lifespan>0&&(st.timeout&&clearTimeout(st.timeout),st.timeout=setTimeout(st.remove,it.lifespan)),st.response;if(!rt)throw st.promise}const nt={keys:_e,equal:it.equal,remove:()=>{const st=globalCache.indexOf(nt);st!==-1&&globalCache.splice(st,1)},promise:(isPromise(tt)?tt:tt(..._e)).then(st=>{nt.response=st,it.lifespan&&it.lifespan>0&&(nt.timeout=setTimeout(nt.remove,it.lifespan))}).catch(st=>nt.error=st)};if(globalCache.push(nt),!rt)throw nt.promise}const suspend=(tt,_e,rt)=>query(tt,_e,!1,rt),preload=(tt,_e,rt)=>void query(tt,_e,!0,rt),clear=tt=>{if(tt===void 0||tt.length===0)globalCache.splice(0,globalCache.length);else{const _e=globalCache.find(rt=>shallowEqualArrays(tt,rt.keys,rt.equal));_e&&_e.remove()}},catalogue={},extend$2=tt=>void Object.assign(catalogue,tt);function createRenderer(tt,_e){function rt(ut,{args:ht=[],attach:dt,...pt},ft){let gt=`${ut[0].toUpperCase()}${ut.slice(1)}`,mt;if(ut==="primitive"){if(pt.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const At=pt.object;mt=prepare(At,{type:ut,root:ft,attach:dt,primitive:!0})}else{const At=catalogue[gt];if(!At)throw new Error(`R3F: ${gt} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(ht))throw new Error("R3F: The args prop must be an array!");mt=prepare(new At(...ht),{type:ut,root:ft,attach:dt,memoizedProps:{args:ht}})}return mt.__r3f.attach===void 0&&(mt instanceof BufferGeometry?mt.__r3f.attach="geometry":mt instanceof Material&&(mt.__r3f.attach="material")),gt!=="inject"&&applyProps$1(mt,pt),mt}function it(ut,ht){let dt=!1;if(ht){var pt,ft;(pt=ht.__r3f)!=null&&pt.attach?attach(ut,ht,ht.__r3f.attach):ht.isObject3D&&ut.isObject3D&&(ut.add(ht),dt=!0),dt||(ft=ut.__r3f)==null||ft.objects.push(ht),ht.__r3f||prepare(ht,{}),ht.__r3f.parent=ut,updateInstance(ht),invalidateInstance(ht)}}function nt(ut,ht,dt){let pt=!1;if(ht){var ft,gt;if((ft=ht.__r3f)!=null&&ft.attach)attach(ut,ht,ht.__r3f.attach);else if(ht.isObject3D&&ut.isObject3D){ht.parent=ut,ht.dispatchEvent({type:"added"});const mt=ut.children.filter(yt=>yt!==ht),At=mt.indexOf(dt);ut.children=[...mt.slice(0,At),ht,...mt.slice(At)],pt=!0}pt||(gt=ut.__r3f)==null||gt.objects.push(ht),ht.__r3f||prepare(ht,{}),ht.__r3f.parent=ut,updateInstance(ht),invalidateInstance(ht)}}function st(ut,ht,dt=!1){ut&&[...ut].forEach(pt=>at(ht,pt,dt))}function at(ut,ht,dt){if(ht){var pt,ft,gt;if(ht.__r3f&&(ht.__r3f.parent=null),(pt=ut.__r3f)!=null&&pt.objects&&(ut.__r3f.objects=ut.__r3f.objects.filter(xt=>xt!==ht)),(ft=ht.__r3f)!=null&&ft.attach)detach(ut,ht,ht.__r3f.attach);else if(ht.isObject3D&&ut.isObject3D){var mt;ut.remove(ht),(mt=ht.__r3f)!=null&&mt.root&&removeInteractivity(ht.__r3f.root,ht)}const yt=(gt=ht.__r3f)==null?void 0:gt.primitive,bt=dt===void 0?ht.dispose!==null&&!yt:dt;if(!yt){var At;st((At=ht.__r3f)==null?void 0:At.objects,ht,bt),st(ht.children,ht,bt)}delete ht.__r3f,bt&&ht.dispose&&ht.type!=="Scene"&&schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,()=>{try{ht.dispose()}catch{}}),invalidateInstance(ut)}}function lt(ut,ht,dt,pt){var ft;const gt=(ft=ut.__r3f)==null?void 0:ft.parent;if(!gt)return;const mt=rt(ht,dt,ut.__r3f.root);if(ut.children){for(const At of ut.children)At.__r3f&&it(mt,At);ut.children=ut.children.filter(At=>!At.__r3f)}ut.__r3f.objects.forEach(At=>it(mt,At)),ut.__r3f.objects=[],ut.__r3f.autoRemovedBeforeAppend||at(gt,ut),mt.parent&&(mt.__r3f.autoRemovedBeforeAppend=!0),it(gt,mt),mt.raycast&&mt.__r3f.eventCount&&mt.__r3f.root.getState().internal.interaction.push(mt),[pt,pt.alternate].forEach(At=>{At!==null&&(At.stateNode=mt,At.ref&&(typeof At.ref=="function"?At.ref(mt):At.ref.current=mt))})}const ot=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Reconciler({createInstance:rt,removeChild:at,appendChild:it,appendInitialChild:it,insertBefore:nt,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(ut,ht)=>{if(!ht)return;const dt=ut.getState().scene;dt.__r3f&&(dt.__r3f.root=ut,it(dt,ht))},removeChildFromContainer:(ut,ht)=>{ht&&at(ut.getState().scene,ht)},insertInContainerBefore:(ut,ht,dt)=>{if(!ht||!dt)return;const pt=ut.getState().scene;pt.__r3f&&nt(pt,ht,dt)},getRootHostContext:()=>null,getChildHostContext:ut=>ut,finalizeInitialChildren(ut){var ht;return!!((ht=ut==null?void 0:ut.__r3f)!=null?ht:{}).handlers},prepareUpdate(ut,ht,dt,pt){var ft;if(((ft=ut==null?void 0:ut.__r3f)!=null?ft:{}).primitive&&pt.object&&pt.object!==ut)return[!0];{const{args:mt=[],children:At,...yt}=pt,{args:bt=[],children:xt,...vt}=dt;if(!Array.isArray(mt))throw new Error("R3F: the args prop must be an array!");if(mt.some((Ct,St)=>Ct!==bt[St]))return[!0];const _t=diffProps(ut,yt,vt,!0);return _t.changes.length?[!1,_t]:null}},commitUpdate(ut,[ht,dt],pt,ft,gt,mt){ht?lt(ut,pt,gt,mt):applyProps$1(ut,dt)},commitMount(ut,ht,dt,pt){var ft;const gt=(ft=ut.__r3f)!=null?ft:{};ut.raycast&&gt.handlers&&gt.eventCount&&ut.__r3f.root.getState().internal.interaction.push(ut)},getPublicInstance:ut=>ut,prepareForCommit:()=>null,preparePortalMount:ut=>prepare(ut.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(ut){var ht;const{attach:dt,parent:pt}=(ht=ut.__r3f)!=null?ht:{};dt&&pt&&detach(pt,ut,dt),ut.isObject3D&&(ut.visible=!1),invalidateInstance(ut)},unhideInstance(ut,ht){var dt;const{attach:pt,parent:ft}=(dt=ut.__r3f)!=null?dt:{};pt&&ft&&attach(ft,ut,pt),(ut.isObject3D&&ht.visible==null||ht.visible)&&(ut.visible=!0),invalidateInstance(ut)},createTextInstance:ot,hideTextInstance:ot,unhideTextInstance:ot,getCurrentEventPriority:()=>_e?_e():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is.fun(performance.now)?performance.now:is.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document,_window$navigator;const hasColorSpace$1=tt=>"colorSpace"in tt||"outputColorSpace"in tt,getColorManagement=()=>{var tt;return(tt=catalogue.ColorManagement)!=null?tt:null},isOrthographicCamera=tt=>tt&&tt.isOrthographicCamera,isRef$1=tt=>tt&&tt.hasOwnProperty("current"),useIsomorphicLayoutEffect$1=typeof window<"u"&&((_window$document=window.document)!=null&&_window$document.createElement||((_window$navigator=window.navigator)==null?void 0:_window$navigator.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(tt){const _e=reactExports.useRef(tt);return useIsomorphicLayoutEffect$1(()=>void(_e.current=tt),[tt]),_e}function Block({set:tt}){return useIsomorphicLayoutEffect$1(()=>(tt(new Promise(()=>null)),()=>tt(!1)),[tt]),null}class ErrorBoundary extends reactExports.Component{constructor(..._e){super(..._e),this.state={error:!1}}componentDidCatch(_e){this.props.set(_e)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=tt=>tt&&!!tt.memoized&&!!tt.changes;function calculateDpr(tt){var _e;const rt=typeof window<"u"?(_e=window.devicePixelRatio)!=null?_e:2:1;return Array.isArray(tt)?Math.min(Math.max(tt[0],rt),tt[1]):tt}const getRootState=tt=>{var _e;return(_e=tt.__r3f)==null?void 0:_e.root.getState()},is={obj:tt=>tt===Object(tt)&&!is.arr(tt)&&typeof tt!="function",fun:tt=>typeof tt=="function",str:tt=>typeof tt=="string",num:tt=>typeof tt=="number",boo:tt=>typeof tt=="boolean",und:tt=>tt===void 0,arr:tt=>Array.isArray(tt),equ(tt,_e,{arrays:rt="shallow",objects:it="reference",strict:nt=!0}={}){if(typeof tt!=typeof _e||!!tt!=!!_e)return!1;if(is.str(tt)||is.num(tt))return tt===_e;const st=is.obj(tt);if(st&&it==="reference")return tt===_e;const at=is.arr(tt);if(at&&rt==="reference")return tt===_e;if((at||st)&&tt===_e)return!0;let lt;for(lt in tt)if(!(lt in _e))return!1;if(st&&rt==="shallow"&&it==="shallow"){for(lt in nt?_e:tt)if(!is.equ(tt[lt],_e[lt],{strict:nt,objects:"reference"}))return!1}else for(lt in nt?_e:tt)if(tt[lt]!==_e[lt])return!1;if(is.und(lt)){if(at&&tt.length===0&&_e.length===0||st&&Object.keys(tt).length===0&&Object.keys(_e).length===0)return!0;if(tt!==_e)return!1}return!0}};function buildGraph(tt){const _e={nodes:{},materials:{}};return tt&&tt.traverse(rt=>{rt.name&&(_e.nodes[rt.name]=rt),rt.material&&!_e.materials[rt.material.name]&&(_e.materials[rt.material.name]=rt.material)}),_e}function dispose(tt){tt.dispose&&tt.type!=="Scene"&&tt.dispose();for(const _e in tt)_e.dispose==null||_e.dispose(),delete tt[_e]}function prepare(tt,_e){const rt=tt;return rt.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,..._e},tt}function resolve(tt,_e){let rt=tt;if(_e.includes("-")){const it=_e.split("-"),nt=it.pop();return rt=it.reduce((st,at)=>st[at],tt),{target:rt,key:nt}}else return{target:rt,key:_e}}const INDEX_REGEX=/-\d+$/;function attach(tt,_e,rt){if(is.str(rt)){if(INDEX_REGEX.test(rt)){const st=rt.replace(INDEX_REGEX,""),{target:at,key:lt}=resolve(tt,st);Array.isArray(at[lt])||(at[lt]=[])}const{target:it,key:nt}=resolve(tt,rt);_e.__r3f.previousAttach=it[nt],it[nt]=_e}else _e.__r3f.previousAttach=rt(tt,_e)}function detach(tt,_e,rt){var it,nt;if(is.str(rt)){const{target:st,key:at}=resolve(tt,rt),lt=_e.__r3f.previousAttach;lt===void 0?delete st[at]:st[at]=lt}else(it=_e.__r3f)==null||it.previousAttach==null||it.previousAttach(tt,_e);(nt=_e.__r3f)==null||delete nt.previousAttach}function diffProps(tt,{children:_e,key:rt,ref:it,...nt},{children:st,key:at,ref:lt,...ot}={},ct=!1){var ut;const ht=(ut=tt==null?void 0:tt.__r3f)!=null?ut:{},dt=Object.entries(nt),pt=[];if(ct){const gt=Object.keys(ot);for(let mt=0;mt<gt.length;mt++)nt.hasOwnProperty(gt[mt])||dt.unshift([gt[mt],DEFAULT+"remove"])}dt.forEach(([gt,mt])=>{var At;if((At=tt.__r3f)!=null&&At.primitive&&gt==="object"||is.equ(mt,ot[gt]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(gt))return pt.push([gt,mt,!0,[]]);let yt=[];gt.includes("-")&&(yt=gt.split("-")),pt.push([gt,mt,!1,yt]);for(const bt in nt){const xt=nt[bt];bt.startsWith(`${gt}-`)&&pt.push([bt,xt,!1,bt.split("-")])}});const ft={...nt};return ht.memoizedProps&&ht.memoizedProps.args&&(ft.args=ht.memoizedProps.args),ht.memoizedProps&&ht.memoizedProps.attach&&(ft.attach=ht.memoizedProps.attach),{memoized:ft,changes:pt}}function applyProps$1(tt,_e){var rt,it,nt;const st=(rt=tt.__r3f)!=null?rt:{},at=st.root,lt=(it=at==null||at.getState==null?void 0:at.getState())!=null?it:{},{memoized:ot,changes:ct}=isDiffSet(_e)?_e:diffProps(tt,_e),ut=st.eventCount;tt.__r3f&&(tt.__r3f.memoizedProps=ot);for(let dt=0;dt<ct.length;dt++){let[pt,ft,gt,mt]=ct[dt];if(hasColorSpace$1(tt)){const xt="srgb",vt="srgb-linear";pt==="encoding"?(pt="colorSpace",ft=ft===3001?xt:vt):pt==="outputEncoding"&&(pt="outputColorSpace",ft=ft===3001?xt:vt)}let At=tt,yt=At[pt];if(mt.length&&(yt=mt.reduce((bt,xt)=>bt[xt],tt),!(yt&&yt.set))){const[bt,...xt]=mt.reverse();At=xt.reverse().reduce((vt,_t)=>vt[_t],tt),pt=bt}if(ft===DEFAULT+"remove")if(At.constructor){let bt=DEFAULTS.get(At.constructor);bt||(bt=new At.constructor,DEFAULTS.set(At.constructor,bt)),ft=bt[pt]}else ft=0;if(gt)ft?st.handlers[pt]=ft:delete st.handlers[pt],st.eventCount=Object.keys(st.handlers).length;else if(yt&&yt.set&&(yt.copy||yt instanceof Layers)){if(Array.isArray(ft))yt.fromArray?yt.fromArray(ft):yt.set(...ft);else if(yt.copy&&ft&&ft.constructor&&yt.constructor===ft.constructor)yt.copy(ft);else if(ft!==void 0){const bt=yt instanceof Color$1;!bt&&yt.setScalar?yt.setScalar(ft):yt instanceof Layers&&ft instanceof Layers?yt.mask=ft.mask:yt.set(ft),!getColorManagement()&&!lt.linear&&bt&&yt.convertSRGBToLinear()}}else if(At[pt]=ft,At[pt]instanceof Texture&&At[pt].format===RGBAFormat&&At[pt].type===UnsignedByteType){const bt=At[pt];hasColorSpace$1(bt)&&hasColorSpace$1(lt.gl)?bt.colorSpace=lt.gl.outputColorSpace:bt.encoding=lt.gl.outputEncoding}invalidateInstance(tt)}if(st.parent&&lt.internal&&tt.raycast&&ut!==st.eventCount){const dt=lt.internal.interaction.indexOf(tt);dt>-1&&lt.internal.interaction.splice(dt,1),st.eventCount&&lt.internal.interaction.push(tt)}return!(ct.length===1&&ct[0][0]==="onUpdate")&&ct.length&&(nt=tt.__r3f)!=null&&nt.parent&&updateInstance(tt),tt}function invalidateInstance(tt){var _e,rt;const it=(_e=tt.__r3f)==null||(rt=_e.root)==null||rt.getState==null?void 0:rt.getState();it&&it.internal.frames===0&&it.invalidate()}function updateInstance(tt){tt.onUpdate==null||tt.onUpdate(tt)}function updateCamera(tt,_e){tt.manual||(isOrthographicCamera(tt)?(tt.left=_e.width/-2,tt.right=_e.width/2,tt.top=_e.height/2,tt.bottom=_e.height/-2):tt.aspect=_e.width/_e.height,tt.updateProjectionMatrix(),tt.updateMatrixWorld())}function makeId(tt){return(tt.eventObject||tt.object).uuid+"/"+tt.index+tt.instanceId}function getEventPriority(){var tt;const _e=typeof self<"u"&&self||typeof window<"u"&&window;if(!_e)return constantsExports.DefaultEventPriority;switch((tt=_e.event)==null?void 0:tt.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(tt,_e,rt,it){const nt=rt.get(_e);nt&&(rt.delete(_e),rt.size===0&&(tt.delete(it),nt.target.releasePointerCapture(it)))}function removeInteractivity(tt,_e){const{internal:rt}=tt.getState();rt.interaction=rt.interaction.filter(it=>it!==_e),rt.initialHits=rt.initialHits.filter(it=>it!==_e),rt.hovered.forEach((it,nt)=>{(it.eventObject===_e||it.object===_e)&&rt.hovered.delete(nt)}),rt.capturedMap.forEach((it,nt)=>{releaseInternalPointerCapture(rt.capturedMap,_e,it,nt)})}function createEvents(tt){function _e(ot){const{internal:ct}=tt.getState(),ut=ot.offsetX-ct.initialClick[0],ht=ot.offsetY-ct.initialClick[1];return Math.round(Math.sqrt(ut*ut+ht*ht))}function rt(ot){return ot.filter(ct=>["Move","Over","Enter","Out","Leave"].some(ut=>{var ht;return(ht=ct.__r3f)==null?void 0:ht.handlers["onPointer"+ut]}))}function it(ot,ct){const ut=tt.getState(),ht=new Set,dt=[],pt=ct?ct(ut.internal.interaction):ut.internal.interaction;for(let At=0;At<pt.length;At++){const yt=getRootState(pt[At]);yt&&(yt.raycaster.camera=void 0)}ut.previousRoot||ut.events.compute==null||ut.events.compute(ot,ut);function ft(At){const yt=getRootState(At);if(!yt||!yt.events.enabled||yt.raycaster.camera===null)return[];if(yt.raycaster.camera===void 0){var bt;yt.events.compute==null||yt.events.compute(ot,yt,(bt=yt.previousRoot)==null?void 0:bt.getState()),yt.raycaster.camera===void 0&&(yt.raycaster.camera=null)}return yt.raycaster.camera?yt.raycaster.intersectObject(At,!0):[]}let gt=pt.flatMap(ft).sort((At,yt)=>{const bt=getRootState(At.object),xt=getRootState(yt.object);return!bt||!xt?At.distance-yt.distance:xt.events.priority-bt.events.priority||At.distance-yt.distance}).filter(At=>{const yt=makeId(At);return ht.has(yt)?!1:(ht.add(yt),!0)});ut.events.filter&&(gt=ut.events.filter(gt,ut));for(const At of gt){let yt=At.object;for(;yt;){var mt;(mt=yt.__r3f)!=null&&mt.eventCount&&dt.push({...At,eventObject:yt}),yt=yt.parent}}if("pointerId"in ot&&ut.internal.capturedMap.has(ot.pointerId))for(let At of ut.internal.capturedMap.get(ot.pointerId).values())ht.has(makeId(At.intersection))||dt.push(At.intersection);return dt}function nt(ot,ct,ut,ht){const dt=tt.getState();if(ot.length){const pt={stopped:!1};for(const ft of ot){const gt=getRootState(ft.object)||dt,{raycaster:mt,pointer:At,camera:yt,internal:bt}=gt,xt=new Vector3(At.x,At.y,0).unproject(yt),vt=Tt=>{var Mt,Rt;return(Mt=(Rt=bt.capturedMap.get(Tt))==null?void 0:Rt.has(ft.eventObject))!=null?Mt:!1},_t=Tt=>{const Mt={intersection:ft,target:ct.target};bt.capturedMap.has(Tt)?bt.capturedMap.get(Tt).set(ft.eventObject,Mt):bt.capturedMap.set(Tt,new Map([[ft.eventObject,Mt]])),ct.target.setPointerCapture(Tt)},Ct=Tt=>{const Mt=bt.capturedMap.get(Tt);Mt&&releaseInternalPointerCapture(bt.capturedMap,ft.eventObject,Mt,Tt)};let St={};for(let Tt in ct){let Mt=ct[Tt];typeof Mt!="function"&&(St[Tt]=Mt)}let Et={...ft,...St,pointer:At,intersections:ot,stopped:pt.stopped,delta:ut,unprojectedPoint:xt,ray:mt.ray,camera:yt,stopPropagation(){const Tt="pointerId"in ct&&bt.capturedMap.get(ct.pointerId);if((!Tt||Tt.has(ft.eventObject))&&(Et.stopped=pt.stopped=!0,bt.hovered.size&&Array.from(bt.hovered.values()).find(Mt=>Mt.eventObject===ft.eventObject))){const Mt=ot.slice(0,ot.indexOf(ft));st([...Mt,ft])}},target:{hasPointerCapture:vt,setPointerCapture:_t,releasePointerCapture:Ct},currentTarget:{hasPointerCapture:vt,setPointerCapture:_t,releasePointerCapture:Ct},nativeEvent:ct};if(ht(Et),pt.stopped===!0)break}}return ot}function st(ot){const{internal:ct}=tt.getState();for(const ut of ct.hovered.values())if(!ot.length||!ot.find(ht=>ht.object===ut.object&&ht.index===ut.index&&ht.instanceId===ut.instanceId)){const dt=ut.eventObject.__r3f,pt=dt==null?void 0:dt.handlers;if(ct.hovered.delete(makeId(ut)),dt!=null&&dt.eventCount){const ft={...ut,intersections:ot};pt.onPointerOut==null||pt.onPointerOut(ft),pt.onPointerLeave==null||pt.onPointerLeave(ft)}}}function at(ot,ct){for(let ut=0;ut<ct.length;ut++){const ht=ct[ut].__r3f;ht==null||ht.handlers.onPointerMissed==null||ht.handlers.onPointerMissed(ot)}}function lt(ot){switch(ot){case"onPointerLeave":case"onPointerCancel":return()=>st([]);case"onLostPointerCapture":return ct=>{const{internal:ut}=tt.getState();"pointerId"in ct&&ut.capturedMap.has(ct.pointerId)&&requestAnimationFrame(()=>{ut.capturedMap.has(ct.pointerId)&&(ut.capturedMap.delete(ct.pointerId),st([]))})}}return function(ut){const{onPointerMissed:ht,internal:dt}=tt.getState();dt.lastEvent.current=ut;const pt=ot==="onPointerMove",ft=ot==="onClick"||ot==="onContextMenu"||ot==="onDoubleClick",mt=it(ut,pt?rt:void 0),At=ft?_e(ut):0;ot==="onPointerDown"&&(dt.initialClick=[ut.offsetX,ut.offsetY],dt.initialHits=mt.map(bt=>bt.eventObject)),ft&&!mt.length&&At<=2&&(at(ut,dt.interaction),ht&&ht(ut)),pt&&st(mt);function yt(bt){const xt=bt.eventObject,vt=xt.__r3f,_t=vt==null?void 0:vt.handlers;if(vt!=null&&vt.eventCount)if(pt){if(_t.onPointerOver||_t.onPointerEnter||_t.onPointerOut||_t.onPointerLeave){const Ct=makeId(bt),St=dt.hovered.get(Ct);St?St.stopped&&bt.stopPropagation():(dt.hovered.set(Ct,bt),_t.onPointerOver==null||_t.onPointerOver(bt),_t.onPointerEnter==null||_t.onPointerEnter(bt))}_t.onPointerMove==null||_t.onPointerMove(bt)}else{const Ct=_t[ot];Ct?(!ft||dt.initialHits.includes(xt))&&(at(ut,dt.interaction.filter(St=>!dt.initialHits.includes(St))),Ct(bt)):ft&&dt.initialHits.includes(xt)&&at(ut,dt.interaction.filter(St=>!dt.initialHits.includes(St)))}}nt(mt,ut,At,yt)}}return{handlePointer:lt}}const privateKeys=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],isRenderer=tt=>!!(tt!=null&&tt.render),context=reactExports.createContext(null),createStore=(tt,_e)=>{const rt=create((lt,ot)=>{const ct=new Vector3,ut=new Vector3,ht=new Vector3;function dt(At=ot().camera,yt=ut,bt=ot().size){const{width:xt,height:vt,top:_t,left:Ct}=bt,St=xt/vt;yt instanceof Vector3?ht.copy(yt):ht.set(...yt);const Et=At.getWorldPosition(ct).distanceTo(ht);if(isOrthographicCamera(At))return{width:xt/At.zoom,height:vt/At.zoom,top:_t,left:Ct,factor:1,distance:Et,aspect:St};{const Tt=At.fov*Math.PI/180,Mt=2*Math.tan(Tt/2)*Et,Rt=Mt*(xt/vt);return{width:Rt,height:Mt,top:_t,left:Ct,factor:xt/Rt,distance:Et,aspect:St}}}let pt;const ft=At=>lt(yt=>({performance:{...yt.performance,current:At}})),gt=new Vector2;return{set:lt,get:ot,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(At=1)=>tt(ot(),At),advance:(At,yt)=>_e(At,yt,ot()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock,pointer:gt,mouse:gt,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const At=ot();pt&&clearTimeout(pt),At.performance.current!==At.performance.min&&ft(At.performance.min),pt=setTimeout(()=>ft(ot().performance.max),At.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:dt},setEvents:At=>lt(yt=>({...yt,events:{...yt.events,...At}})),setSize:(At,yt,bt,xt,vt)=>{const _t=ot().camera,Ct={width:At,height:yt,top:xt||0,left:vt||0,updateStyle:bt};lt(St=>({size:Ct,viewport:{...St.viewport,...dt(_t,ut,Ct)}}))},setDpr:At=>lt(yt=>{const bt=calculateDpr(At);return{viewport:{...yt.viewport,dpr:bt,initialDpr:yt.viewport.initialDpr||bt}}}),setFrameloop:(At="always")=>{const yt=ot().clock;yt.stop(),yt.elapsedTime=0,At!=="never"&&(yt.start(),yt.elapsedTime=0),lt(()=>({frameloop:At}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(At,yt,bt)=>{const xt=ot().internal;return xt.priority=xt.priority+(yt>0?1:0),xt.subscribers.push({ref:At,priority:yt,store:bt}),xt.subscribers=xt.subscribers.sort((vt,_t)=>vt.priority-_t.priority),()=>{const vt=ot().internal;vt!=null&&vt.subscribers&&(vt.priority=vt.priority-(yt>0?1:0),vt.subscribers=vt.subscribers.filter(_t=>_t.ref!==At))}}}}}),it=rt.getState();let nt=it.size,st=it.viewport.dpr,at=it.camera;return rt.subscribe(()=>{const{camera:lt,size:ot,viewport:ct,gl:ut,set:ht}=rt.getState();if(ot!==nt||ct.dpr!==st){var dt;nt=ot,st=ct.dpr,updateCamera(lt,ot),ut.setPixelRatio(ct.dpr);const pt=(dt=ot.updateStyle)!=null?dt:typeof HTMLCanvasElement<"u"&&ut.domElement instanceof HTMLCanvasElement;ut.setSize(ot.width,ot.height,pt)}lt!==at&&(at=lt,ht(pt=>({viewport:{...pt.viewport,...pt.viewport.getCurrentViewport(lt)}})))}),rt.subscribe(lt=>tt(lt)),rt};function createSubs(tt,_e){const rt={callback:tt};return _e.add(rt),()=>void _e.delete(rt)}let i$6,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;const addEffect=tt=>createSubs(tt,globalEffects),addAfterEffect=tt=>createSubs(tt,globalAfterEffects);function run(tt,_e){if(tt.size)for(const{callback:rt}of tt.values())rt(_e)}function flushGlobalEffects(tt,_e){switch(tt){case"before":return run(globalEffects,_e);case"after":return run(globalAfterEffects,_e);case"tail":return run(globalTailEffects,_e)}}let subscribers,subscription;function render$1(tt,_e,rt){let it=_e.clock.getDelta();for(_e.frameloop==="never"&&typeof tt=="number"&&(it=tt-_e.clock.elapsedTime,_e.clock.oldTime=_e.clock.elapsedTime,_e.clock.elapsedTime=tt),subscribers=_e.internal.subscribers,i$6=0;i$6<subscribers.length;i$6++)subscription=subscribers[i$6],subscription.ref.current(subscription.store.getState(),it,rt);return!_e.internal.priority&&_e.gl.render&&_e.gl.render(_e.scene,_e.camera),_e.internal.frames=Math.max(0,_e.internal.frames-1),_e.frameloop==="always"?1:_e.internal.frames}function createLoop(tt){let _e=!1,rt,it,nt;function st(ot){it=requestAnimationFrame(st),_e=!0,rt=0,flushGlobalEffects("before",ot);for(const ut of tt.values()){var ct;nt=ut.store.getState(),nt.internal.active&&(nt.frameloop==="always"||nt.internal.frames>0)&&!((ct=nt.gl.xr)!=null&&ct.isPresenting)&&(rt+=render$1(ot,nt))}if(flushGlobalEffects("after",ot),rt===0)return flushGlobalEffects("tail",ot),_e=!1,cancelAnimationFrame(it)}function at(ot,ct=1){var ut;if(!ot)return tt.forEach(ht=>at(ht.store.getState()),ct);(ut=ot.gl.xr)!=null&&ut.isPresenting||!ot.internal.active||ot.frameloop==="never"||(ot.internal.frames=Math.min(60,ot.internal.frames+ct),_e||(_e=!0,requestAnimationFrame(st)))}function lt(ot,ct=!0,ut,ht){if(ct&&flushGlobalEffects("before",ot),ut)render$1(ot,ut,ht);else for(const dt of tt.values())render$1(ot,dt.store.getState());ct&&flushGlobalEffects("after",ot)}return{loop:st,invalidate:at,advance:lt}}function useStore(){const tt=reactExports.useContext(context);if(!tt)throw new Error("R3F: Hooks can only be used within the Canvas component!");return tt}function useThree(tt=rt=>rt,_e){return useStore()(tt,_e)}function useFrame(tt,_e=0){const rt=useStore(),it=rt.getState().internal.subscribe,nt=useMutableCallback(tt);return useIsomorphicLayoutEffect$1(()=>it(nt,_e,rt),[_e,it,rt]),null}function loadingFn(tt,_e){return function(rt,...it){const nt=new rt;return tt&&tt(nt),Promise.all(it.map(st=>new Promise((at,lt)=>nt.load(st,ot=>{ot.scene&&Object.assign(ot,buildGraph(ot.scene)),at(ot)},_e,ot=>lt(new Error(`Could not load ${st}: ${ot.message})`))))))}}function useLoader(tt,_e,rt,it){const nt=Array.isArray(_e)?_e:[_e],st=suspend(loadingFn(rt,it),[tt,...nt],{equal:is.equ});return Array.isArray(_e)?st:st[0]}useLoader.preload=function(tt,_e,rt){const it=Array.isArray(_e)?_e:[_e];return preload(loadingFn(rt),[tt,...it])};useLoader.clear=function(tt,_e){const rt=Array.isArray(_e)?_e:[_e];return clear([tt,...rt])};const roots=new Map,{invalidate,advance}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(tt,_e)=>{const rt=typeof tt=="function"?tt(_e):tt;return isRenderer(rt)?rt:new WebGLRenderer({powerPreference:"high-performance",canvas:_e,antialias:!0,alpha:!0,...tt})};function computeInitialSize(tt,_e){if(_e)return _e;if(typeof HTMLCanvasElement<"u"&&tt instanceof HTMLCanvasElement&&tt.parentElement){const{width:rt,height:it,top:nt,left:st}=tt.parentElement.getBoundingClientRect();return{width:rt,height:it,top:nt,left:st}}else if(typeof OffscreenCanvas<"u"&&tt instanceof OffscreenCanvas)return{width:tt.width,height:tt.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function createRoot(tt){const _e=roots.get(tt),rt=_e==null?void 0:_e.fiber,it=_e==null?void 0:_e.store;_e&&console.warn("R3F.createRoot should only be called once!");const nt=typeof reportError=="function"?reportError:console.error,st=it||createStore(invalidate,advance),at=rt||reconciler.createContainer(st,constantsExports.ConcurrentRoot,null,!1,null,"",nt,null);_e||roots.set(tt,{fiber:at,store:st});let lt,ot=!1,ct;return{configure(ut={}){let{gl:ht,size:dt,scene:pt,events:ft,onCreated:gt,shadows:mt=!1,linear:At=!1,flat:yt=!1,legacy:bt=!1,orthographic:xt=!1,frameloop:vt="always",dpr:_t=[1,2],performance:Ct,raycaster:St,camera:Et,onPointerMissed:Tt}=ut,Mt=st.getState(),Rt=Mt.gl;Mt.gl||Mt.set({gl:Rt=createRendererInstance(ht,tt)});let It=Mt.raycaster;It||Mt.set({raycaster:It=new Raycaster});const{params:Ot,...Bt}=St||{};if(is.equ(Bt,It,shallowLoose)||applyProps(It,{...Bt}),is.equ(Ot,It.params,shallowLoose)||applyProps(It,{params:{...It.params,...Ot}}),!Mt.camera||Mt.camera===ct&&!is.equ(ct,Et,shallowLoose)){ct=Et;const $t=Et instanceof Camera,Vt=$t?Et:xt?new OrthographicCamera(0,0,0,0,.1,1e3):new PerspectiveCamera(75,0,.1,1e3);$t||(Vt.position.z=5,Et&&applyProps(Vt,Et),!Mt.camera&&!(Et!=null&&Et.rotation)&&Vt.lookAt(0,0,0)),Mt.set({camera:Vt})}if(!Mt.scene){let $t;pt instanceof Scene?$t=pt:($t=new Scene,pt&&applyProps($t,pt)),Mt.set({scene:prepare($t)})}if(!Mt.xr){const $t=(qt,sr)=>{const er=st.getState();er.frameloop!=="never"&&advance(qt,!0,er,sr)},Vt=()=>{const qt=st.getState();qt.gl.xr.enabled=qt.gl.xr.isPresenting,qt.gl.xr.setAnimationLoop(qt.gl.xr.isPresenting?$t:null),qt.gl.xr.isPresenting||invalidate(qt)},Zt={connect(){const qt=st.getState().gl;qt.xr.addEventListener("sessionstart",Vt),qt.xr.addEventListener("sessionend",Vt)},disconnect(){const qt=st.getState().gl;qt.xr.removeEventListener("sessionstart",Vt),qt.xr.removeEventListener("sessionend",Vt)}};Rt.xr&&Zt.connect(),Mt.set({xr:Zt})}if(Rt.shadowMap){const $t=Rt.shadowMap.enabled,Vt=Rt.shadowMap.type;if(Rt.shadowMap.enabled=!!mt,is.boo(mt))Rt.shadowMap.type=PCFSoftShadowMap;else if(is.str(mt)){var Nt;const Zt={basic:BasicShadowMap,percentage:PCFShadowMap,soft:PCFSoftShadowMap,variance:VSMShadowMap};Rt.shadowMap.type=(Nt=Zt[mt])!=null?Nt:PCFSoftShadowMap}else is.obj(mt)&&Object.assign(Rt.shadowMap,mt);($t!==Rt.shadowMap.enabled||Vt!==Rt.shadowMap.type)&&(Rt.shadowMap.needsUpdate=!0)}const zt=getColorManagement();zt&&("enabled"in zt?zt.enabled=!bt:"legacyMode"in zt&&(zt.legacyMode=bt)),applyProps(Rt,{outputEncoding:At?3e3:3001,toneMapping:yt?NoToneMapping:ACESFilmicToneMapping}),Mt.legacy!==bt&&Mt.set(()=>({legacy:bt})),Mt.linear!==At&&Mt.set(()=>({linear:At})),Mt.flat!==yt&&Mt.set(()=>({flat:yt})),ht&&!is.fun(ht)&&!isRenderer(ht)&&!is.equ(ht,Rt,shallowLoose)&&applyProps(Rt,ht),ft&&!Mt.events.handlers&&Mt.set({events:ft(st)});const Ut=computeInitialSize(tt,dt);return is.equ(Ut,Mt.size,shallowLoose)||Mt.setSize(Ut.width,Ut.height,Ut.updateStyle,Ut.top,Ut.left),_t&&Mt.viewport.dpr!==calculateDpr(_t)&&Mt.setDpr(_t),Mt.frameloop!==vt&&Mt.setFrameloop(vt),Mt.onPointerMissed||Mt.set({onPointerMissed:Tt}),Ct&&!is.equ(Ct,Mt.performance,shallowLoose)&&Mt.set($t=>({performance:{...$t.performance,...Ct}})),lt=gt,ot=!0,this},render(ut){return ot||this.configure(),reconciler.updateContainer(reactExports.createElement(Provider,{store:st,children:ut,onCreated:lt,rootElement:tt}),at,null,()=>{}),st},unmount(){unmountComponentAtNode(tt)}}}function Provider({store:tt,children:_e,onCreated:rt,rootElement:it}){return useIsomorphicLayoutEffect$1(()=>{const nt=tt.getState();nt.set(st=>({internal:{...st.internal,active:!0}})),rt&&rt(nt),tt.getState().events.connected||nt.events.connect==null||nt.events.connect(it)},[]),reactExports.createElement(context.Provider,{value:tt},_e)}function unmountComponentAtNode(tt,_e){const rt=roots.get(tt),it=rt==null?void 0:rt.fiber;if(it){const nt=rt==null?void 0:rt.store.getState();nt&&(nt.internal.active=!1),reconciler.updateContainer(null,it,null,()=>{nt&&setTimeout(()=>{try{var st,at,lt,ot;nt.events.disconnect==null||nt.events.disconnect(),(st=nt.gl)==null||(at=st.renderLists)==null||at.dispose==null||at.dispose(),(lt=nt.gl)==null||lt.forceContextLoss==null||lt.forceContextLoss(),(ot=nt.gl)!=null&&ot.xr&&nt.xr.disconnect(),dispose(nt),roots.delete(tt),_e&&_e(tt)}catch{}},500)})}}function createPortal(tt,_e,rt){return reactExports.createElement(Portal$3,{key:_e.uuid,children:tt,container:_e,state:rt})}function Portal$3({state:tt={},children:_e,container:rt}){const{events:it,size:nt,...st}=tt,at=useStore(),[lt]=reactExports.useState(()=>new Raycaster),[ot]=reactExports.useState(()=>new Vector2),ct=reactExports.useCallback((ht,dt)=>{const pt={...ht};Object.keys(ht).forEach(gt=>{(privateKeys.includes(gt)||ht[gt]!==dt[gt]&&dt[gt])&&delete pt[gt]});let ft;if(dt&&nt){const gt=dt.camera;ft=ht.viewport.getCurrentViewport(gt,new Vector3,nt),gt!==ht.camera&&updateCamera(gt,nt)}return{...pt,scene:rt,raycaster:lt,pointer:ot,mouse:ot,previousRoot:at,events:{...ht.events,...dt==null?void 0:dt.events,...it},size:{...ht.size,...nt},viewport:{...ht.viewport,...ft},...st}},[tt]),[ut]=reactExports.useState(()=>{const ht=at.getState();return create((pt,ft)=>({...ht,scene:rt,raycaster:lt,pointer:ot,mouse:ot,previousRoot:at,events:{...ht.events,...it},size:{...ht.size,...nt},...st,set:pt,get:ft,setEvents:gt=>pt(mt=>({...mt,events:{...mt.events,...gt}}))}))});return reactExports.useEffect(()=>{const ht=at.subscribe(dt=>ut.setState(pt=>ct(dt,pt)));return()=>{ht(),ut.destroy()}},[]),reactExports.useEffect(()=>{ut.setState(ht=>ct(at.getState(),ht))},[ct]),reactExports.createElement(reactExports.Fragment,null,reconciler.createPortal(reactExports.createElement(context.Provider,{value:ut},_e),ut,null))}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});function debounce$1(tt,_e,rt){var it,nt,st,at,lt;_e==null&&(_e=100);function ot(){var ut=Date.now()-at;ut<_e&&ut>=0?it=setTimeout(ot,_e-ut):(it=null,rt||(lt=tt.apply(st,nt),st=nt=null))}var ct=function(){st=this,nt=arguments,at=Date.now();var ut=rt&&!it;return it||(it=setTimeout(ot,_e)),ut&&(lt=tt.apply(st,nt),st=nt=null),lt};return ct.clear=function(){it&&(clearTimeout(it),it=null)},ct.flush=function(){it&&(lt=tt.apply(st,nt),st=nt=null,clearTimeout(it),it=null)},ct}debounce$1.debounce=debounce$1;var debounce_1=debounce$1;const createDebounce=getDefaultExportFromCjs(debounce_1);function useMeasure(tt){let{debounce:_e,scroll:rt,polyfill:it,offsetSize:nt}=tt===void 0?{debounce:0,scroll:!1,offsetSize:!1}:tt;const st=it||(typeof window>"u"?class{}:window.ResizeObserver);if(!st)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[at,lt]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),ot=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:at}),ct=_e?typeof _e=="number"?_e:_e.scroll:null,ut=_e?typeof _e=="number"?_e:_e.resize:null,ht=reactExports.useRef(!1);reactExports.useEffect(()=>(ht.current=!0,()=>void(ht.current=!1)));const[dt,pt,ft]=reactExports.useMemo(()=>{const yt=()=>{if(!ot.current.element)return;const{left:bt,top:xt,width:vt,height:_t,bottom:Ct,right:St,x:Et,y:Tt}=ot.current.element.getBoundingClientRect(),Mt={left:bt,top:xt,width:vt,height:_t,bottom:Ct,right:St,x:Et,y:Tt};ot.current.element instanceof HTMLElement&&nt&&(Mt.height=ot.current.element.offsetHeight,Mt.width=ot.current.element.offsetWidth),Object.freeze(Mt),ht.current&&!areBoundsEqual(ot.current.lastBounds,Mt)&&lt(ot.current.lastBounds=Mt)};return[yt,ut?createDebounce(yt,ut):yt,ct?createDebounce(yt,ct):yt]},[lt,nt,ct,ut]);function gt(){ot.current.scrollContainers&&(ot.current.scrollContainers.forEach(yt=>yt.removeEventListener("scroll",ft,!0)),ot.current.scrollContainers=null),ot.current.resizeObserver&&(ot.current.resizeObserver.disconnect(),ot.current.resizeObserver=null)}function mt(){ot.current.element&&(ot.current.resizeObserver=new st(ft),ot.current.resizeObserver.observe(ot.current.element),rt&&ot.current.scrollContainers&&ot.current.scrollContainers.forEach(yt=>yt.addEventListener("scroll",ft,{capture:!0,passive:!0})))}const At=yt=>{!yt||yt===ot.current.element||(gt(),ot.current.element=yt,ot.current.scrollContainers=findScrollContainers(yt),mt())};return useOnWindowScroll(ft,!!rt),useOnWindowResize(pt),reactExports.useEffect(()=>{gt(),mt()},[rt,ft,pt]),reactExports.useEffect(()=>gt,[]),[At,at,dt]}function useOnWindowResize(tt){reactExports.useEffect(()=>{const _e=tt;return window.addEventListener("resize",_e),()=>void window.removeEventListener("resize",_e)},[tt])}function useOnWindowScroll(tt,_e){reactExports.useEffect(()=>{if(_e){const rt=tt;return window.addEventListener("scroll",rt,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",rt,!0)}},[tt,_e])}function findScrollContainers(tt){const _e=[];if(!tt||tt===document.body)return _e;const{overflow:rt,overflowX:it,overflowY:nt}=window.getComputedStyle(tt);return[rt,it,nt].some(st=>st==="auto"||st==="scroll")&&_e.push(tt),[..._e,...findScrollContainers(tt.parentElement)]}const keys$2=["x","y","top","bottom","left","right","width","height"],areBoundsEqual=(tt,_e)=>keys$2.every(rt=>tt[rt]===_e[rt]);var __defProp$1=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(tt,_e,rt)=>_e in tt?__defProp$1(tt,_e,{enumerable:!0,configurable:!0,writable:!0,value:rt}):tt[_e]=rt,__spreadValues=(tt,_e)=>{for(var rt in _e||(_e={}))__hasOwnProp.call(_e,rt)&&__defNormalProp$1(tt,rt,_e[rt]);if(__getOwnPropSymbols)for(var rt of __getOwnPropSymbols(_e))__propIsEnum.call(_e,rt)&&__defNormalProp$1(tt,rt,_e[rt]);return tt},__spreadProps=(tt,_e)=>__defProps(tt,__getOwnPropDescs(_e));function traverseFiber(tt,_e,rt){if(!tt)return;if(rt(tt)===!0)return tt;let it=_e?tt.return:tt.child;for(;it;){const nt=traverseFiber(it,_e,rt);if(nt)return nt;it=_e?null:it.sibling}}function wrapContext(tt){try{return Object.defineProperties(tt,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return tt}}const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner,ReactCurrentDispatcher}=reactExports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function useFiber(){const tt=reactExports.useContext(FiberContext);if(tt===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const _e=reactExports.useId();return reactExports.useMemo(()=>{for(const it of[ReactCurrentOwner==null?void 0:ReactCurrentOwner.current,tt,tt==null?void 0:tt.alternate]){if(!it)continue;const nt=traverseFiber(it,!1,st=>{let at=st.memoizedState;for(;at;){if(at.memoizedState===_e)return!0;at=at.next}});if(nt)return nt}},[tt,_e])}function useContextMap(){var tt,_e;const rt=useFiber(),[it]=reactExports.useState(()=>new Map);it.clear();let nt=rt;for(;nt;){const st=(tt=nt.type)==null?void 0:tt._context;st&&st!==FiberContext&&!it.has(st)&&it.set(st,(_e=ReactCurrentDispatcher==null?void 0:ReactCurrentDispatcher.current)==null?void 0:_e.readContext(wrapContext(st))),nt=nt.return}return it}function useContextBridge(){const tt=useContextMap();return reactExports.useMemo(()=>Array.from(tt.keys()).reduce((_e,rt)=>it=>reactExports.createElement(_e,null,reactExports.createElement(rt.Provider,__spreadProps(__spreadValues({},it),{value:tt.get(rt)}))),_e=>reactExports.createElement(FiberProvider,__spreadValues({},_e))),[tt])}const DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(tt){const{handlePointer:_e}=createEvents(tt);return{priority:1,enabled:!0,compute(rt,it,nt){it.pointer.set(rt.offsetX/it.size.width*2-1,-(rt.offsetY/it.size.height)*2+1),it.raycaster.setFromCamera(it.pointer,it.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((rt,it)=>({...rt,[it]:_e(it)}),{}),update:()=>{var rt;const{events:it,internal:nt}=tt.getState();(rt=nt.lastEvent)!=null&&rt.current&&it.handlers&&it.handlers.onPointerMove(nt.lastEvent.current)},connect:rt=>{var it;const{set:nt,events:st}=tt.getState();st.disconnect==null||st.disconnect(),nt(at=>({events:{...at.events,connected:rt}})),Object.entries((it=st.handlers)!=null?it:[]).forEach(([at,lt])=>{const[ot,ct]=DOM_EVENTS[at];rt.addEventListener(ot,lt,{passive:ct})})},disconnect:()=>{const{set:rt,events:it}=tt.getState();if(it.connected){var nt;Object.entries((nt=it.handlers)!=null?nt:[]).forEach(([st,at])=>{if(it&&it.connected instanceof HTMLElement){const[lt]=DOM_EVENTS[st];it.connected.removeEventListener(lt,at)}}),rt(st=>({events:{...st.events,connected:void 0}}))}}}}const CanvasImpl=reactExports.forwardRef(function({children:_e,fallback:rt,resize:it,style:nt,gl:st,events:at=createPointerEvents,eventSource:lt,eventPrefix:ot,shadows:ct,linear:ut,flat:ht,legacy:dt,orthographic:pt,frameloop:ft,dpr:gt,performance:mt,raycaster:At,camera:yt,onPointerMissed:bt,onCreated:xt,...vt},_t){reactExports.useMemo(()=>extend$2(THREE),[]);const Ct=useContextBridge(),[St,Et]=useMeasure({scroll:!0,debounce:{scroll:50,resize:0},...it}),Tt=reactExports.useRef(null),Mt=reactExports.useRef(null);reactExports.useImperativeHandle(_t,()=>Tt.current);const Rt=useMutableCallback(bt),[It,Ot]=reactExports.useState(!1),[Bt,Nt]=reactExports.useState(!1);if(It)throw It;if(Bt)throw Bt;const zt=reactExports.useRef(null);useIsomorphicLayoutEffect$1(()=>{const Ft=Tt.current;Et.width>0&&Et.height>0&&Ft&&(zt.current||(zt.current=createRoot(Ft)),zt.current.configure({gl:st,events:at,shadows:ct,linear:ut,flat:ht,legacy:dt,orthographic:pt,frameloop:ft,dpr:gt,performance:mt,raycaster:At,camera:yt,size:Et,onPointerMissed:(...Ut)=>Rt.current==null?void 0:Rt.current(...Ut),onCreated:Ut=>{Ut.events.connect==null||Ut.events.connect(lt?isRef$1(lt)?lt.current:lt:Mt.current),ot&&Ut.setEvents({compute:($t,Vt)=>{const Zt=$t[ot+"X"],qt=$t[ot+"Y"];Vt.pointer.set(Zt/Vt.size.width*2-1,-(qt/Vt.size.height)*2+1),Vt.raycaster.setFromCamera(Vt.pointer,Vt.camera)}}),xt==null||xt(Ut)}}),zt.current.render(reactExports.createElement(Ct,null,reactExports.createElement(ErrorBoundary,{set:Nt},reactExports.createElement(reactExports.Suspense,{fallback:reactExports.createElement(Block,{set:Ot})},_e)))))}),reactExports.useEffect(()=>{const Ft=Tt.current;if(Ft)return()=>unmountComponentAtNode(Ft)},[]);const Dt=lt?"none":"auto";return reactExports.createElement("div",_extends$1({ref:Mt,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Dt,...nt}},vt),reactExports.createElement("div",{ref:St,style:{width:"100%",height:"100%"}},reactExports.createElement("canvas",{ref:Tt,style:{display:"block"}},rt)))}),Canvas$1=reactExports.forwardRef(function(_e,rt){return reactExports.createElement(FiberProvider,null,reactExports.createElement(CanvasImpl,_extends$1({},_e,{ref:rt})))});class XRController extends Group{constructor(_e,rt){super(),this.inputSource=null,this.xrControllerModel=null,this.index=_e,this.controller=rt.xr.getController(_e),this.grip=rt.xr.getControllerGrip(_e),this.hand=rt.xr.getHand(_e),this.grip.userData.name="grip",this.controller.userData.name="controller",this.hand.userData.name="hand",this.visible=!1,this.add(this.controller,this.grip,this.hand),this._onConnected=this._onConnected.bind(this),this._onDisconnected=this._onDisconnected.bind(this),this.controller.addEventListener("connected",this._onConnected),this.controller.addEventListener("disconnected",this._onDisconnected)}_onConnected(_e){_e.fake||_e.data&&(this.visible=!0,this.inputSource=_e.data,this.dispatchEvent(_e))}_onDisconnected(_e){_e.fake||(this.visible=!1,this.inputSource=null,this.dispatchEvent(_e))}dispose(){this.controller.removeEventListener("connected",this._onConnected),this.controller.removeEventListener("disconnected",this._onDisconnected)}}var _a$1,_b$1;const uniq$1=tt=>Array.from(new Set(tt)),useIsomorphicLayoutEffect=typeof window<"u"&&((_a$1=window.document)!=null&&_a$1.createElement||((_b$1=window.navigator)==null?void 0:_b$1.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useCallbackRef$2(tt){const _e=reactExports.useRef(tt);return useIsomorphicLayoutEffect(()=>void(_e.current=tt),[tt]),_e}function useXREvent(tt,_e,{handedness:rt}={}){const it=useCallbackRef$2(_e),nt=useXR(st=>st.controllers);useIsomorphicLayoutEffect(()=>{const st=nt.map(at=>{if(rt&&at.inputSource&&at.inputSource.handedness!==rt)return;const lt=ot=>it.current({nativeEvent:ot,target:at});return at.controller.addEventListener(tt,lt),()=>at.controller.removeEventListener(tt,lt)});return()=>st.forEach(at=>at==null?void 0:at())},[nt,rt,tt])}const tempMatrix=new Matrix4;function InteractionManager({children:tt}){const _e=useThree(ht=>ht.events),rt=useThree(ht=>ht.get),it=useThree(ht=>ht.raycaster),nt=useXR(ht=>ht.controllers),st=useXR(ht=>ht.interactions),at=useXR(ht=>ht.hoverState),lt=useXR(ht=>ht.hasInteraction),ot=useXR(ht=>ht.getInteraction),ct=reactExports.useCallback(ht=>{const dt=Array.from(st.keys());return tempMatrix.identity().extractRotation(ht.matrixWorld),it.ray.origin.setFromMatrixPosition(ht.matrixWorld),it.ray.direction.set(0,0,-1).applyMatrix4(tempMatrix),it.intersectObjects(dt,!0)},[st,it]);useFrame(()=>{var ht;if(st.size!==0)for(const dt of nt){if(!((ht=dt.inputSource)!=null&&ht.handedness))return;const pt=at[dt.inputSource.handedness],ft=new Set;let gt=ct(dt.controller);if(_e.filter)gt=_e.filter(gt,rt());else{const mt=gt.find(At=>At==null?void 0:At.object);mt&&(gt=[mt])}for(const mt of gt){let At=mt.object;for(;At;){if(lt(At,"onHover")&&!pt.has(At)){const bt=ot(At,"onHover");for(const xt of bt)xt({target:dt,intersection:mt,intersections:gt})}const yt=ot(At,"onMove");yt==null||yt.forEach(bt=>bt({target:dt,intersection:mt,intersections:gt})),pt.set(At,mt),ft.add(At.id),At=At.parent}}for(const mt of pt.keys())if(!ft.has(mt.id)){pt.delete(mt);const At=ot(mt,"onBlur");if(!At)continue;for(const yt of At)yt({target:dt,intersections:gt})}}});const ut=reactExports.useCallback(ht=>dt=>{var pt;if(!((pt=dt.target.inputSource)!=null&&pt.handedness))return;const ft=at[dt.target.inputSource.handedness],gt=Array.from(new Set(ft.values()));st.forEach((mt,At)=>{var yt,bt,xt;if(ft.has(At)){if(!mt[ht])return;for(const vt of mt[ht])(yt=vt.current)==null||yt.call(vt,{target:dt.target,intersection:ft.get(At),intersections:gt})}else if(ht==="onSelect"&&mt.onSelectMissed)for(const vt of mt.onSelectMissed)(bt=vt.current)==null||bt.call(vt,{target:dt.target,intersections:gt});else if(ht==="onSqueeze"&&mt.onSqueezeMissed)for(const vt of mt.onSqueezeMissed)(xt=vt.current)==null||xt.call(vt,{target:dt.target,intersections:gt})})},[at,st]);return useXREvent("select",ut("onSelect")),useXREvent("selectstart",ut("onSelectStart")),useXREvent("selectend",ut("onSelectEnd")),useXREvent("squeeze",ut("onSqueeze")),useXREvent("squeezeend",ut("onSqueezeEnd")),useXREvent("squeezestart",ut("onSqueezeStart")),reactExports.createElement(reactExports.Fragment,null,tt)}function useInteraction(tt,_e,rt){const it=useXR(at=>at.addInteraction),nt=useXR(at=>at.removeInteraction),st=useCallbackRef$2(rt);useIsomorphicLayoutEffect(()=>{const at=tt.current;if(!(!at||!st.current))return it(at,_e,st),()=>nt(at,_e,st)},[tt,_e,it,nt])}const Interactive=reactExports.forwardRef(function({onHover:_e,onBlur:rt,onSelectStart:it,onSelectEnd:nt,onSelectMissed:st,onSelect:at,onSqueezeStart:lt,onSqueezeEnd:ot,onSqueezeMissed:ct,onSqueeze:ut,onMove:ht,children:dt},pt){const ft=reactExports.useRef(null);return reactExports.useImperativeHandle(pt,()=>ft.current),useInteraction(ft,"onHover",_e),useInteraction(ft,"onBlur",rt),useInteraction(ft,"onSelectStart",it),useInteraction(ft,"onSelectEnd",nt),useInteraction(ft,"onSelectMissed",st),useInteraction(ft,"onSelect",at),useInteraction(ft,"onSqueezeStart",lt),useInteraction(ft,"onSqueezeEnd",ot),useInteraction(ft,"onSqueezeMissed",ct),useInteraction(ft,"onSqueeze",ut),useInteraction(ft,"onMove",ht),reactExports.createElement("group",{ref:ft},dt)}),RayGrab=reactExports.forwardRef(function({onSelectStart:_e,onSelectEnd:rt,children:it,...nt},st){const at=reactExports.useRef(),lt=reactExports.useRef(null),ot=reactExports.useMemo(()=>new Matrix4,[]);return reactExports.useImperativeHandle(st,()=>lt.current),useFrame(()=>{const ct=at.current,ut=lt.current;ct&&(ut.applyMatrix4(ot),ut.applyMatrix4(ct.matrixWorld),ut.updateMatrixWorld(),ot.copy(ct.matrixWorld).invert())}),reactExports.createElement(Interactive,{ref:lt,onSelectStart:ct=>{at.current=ct.target.controller,ot.copy(ct.target.controller.matrixWorld).invert(),_e==null||_e(ct)},onSelectEnd:ct=>{ct.target.controller===at.current&&(at.current=void 0),rt==null||rt(ct)},...nt},it)}),XRContext=reactExports.createContext(null),globalSessionStore=create((tt,_e)=>({set:tt,get:_e,session:null,referenceSpaceType:null}));function XRManager({foveation:tt=0,frameRate:_e=void 0,referenceSpace:rt="local-floor",onSessionStart:it,onSessionEnd:nt,onVisibilityChange:st,onInputSourcesChange:at,children:lt}){const ot=useThree(bt=>bt.gl),ct=useThree(bt=>bt.camera),ut=useXR(bt=>bt.player),ht=useXR(bt=>bt.get),dt=useXR(bt=>bt.set),pt=useXR(bt=>bt.session),ft=useXR(bt=>bt.controllers),gt=useCallbackRef$2(it),mt=useCallbackRef$2(nt),At=useCallbackRef$2(st),yt=useCallbackRef$2(at);return useIsomorphicLayoutEffect(()=>{const bt=[0,1].map(xt=>{const vt=new XRController(xt,ot),_t=()=>dt(St=>({controllers:[...St.controllers,vt]})),Ct=()=>dt(St=>({controllers:St.controllers.filter(Et=>Et!==vt)}));return vt.addEventListener("connected",_t),vt.addEventListener("disconnected",Ct),()=>{vt.removeEventListener("connected",_t),vt.removeEventListener("disconnected",Ct)}});return()=>bt.forEach(xt=>xt())},[ot,dt]),useIsomorphicLayoutEffect(()=>globalSessionStore.subscribe(({session:bt})=>dt(()=>({session:bt}))),[ot.xr,dt]),useIsomorphicLayoutEffect(()=>{ot.xr.setFoveation(tt),dt(()=>({foveation:tt}))},[ot.xr,tt,dt]),useIsomorphicLayoutEffect(()=>{var bt;try{_e&&((bt=pt==null?void 0:pt.updateTargetFrameRate)==null||bt.call(pt,_e))}catch{}dt(()=>({frameRate:_e}))},[pt,_e,dt]),useIsomorphicLayoutEffect(()=>{const bt=globalSessionStore.getState();ot.xr.setReferenceSpaceType(rt),dt(()=>({referenceSpace:rt})),bt.set({referenceSpaceType:rt})},[ot.xr,rt,dt]),useIsomorphicLayoutEffect(()=>{if(!pt)return void ot.xr.setSession(null);const bt=Ct=>{var St;dt(()=>({isPresenting:!0})),(St=gt.current)==null||St.call(gt,{nativeEvent:{...Ct,target:pt},target:pt})},xt=Ct=>{var St;dt(()=>({isPresenting:!1,session:null})),globalSessionStore.setState(()=>({session:null})),(St=mt.current)==null||St.call(mt,{nativeEvent:{...Ct,target:pt},target:pt})},vt=Ct=>{var St;(St=At.current)==null||St.call(At,{nativeEvent:Ct,target:pt})},_t=Ct=>{var St;const Et=Object.values(pt.inputSources).some(Tt=>Tt.hand);dt(()=>({isHandTracking:Et})),(St=yt.current)==null||St.call(yt,{nativeEvent:Ct,target:pt})};return ot.xr.addEventListener("sessionstart",bt),ot.xr.addEventListener("sessionend",xt),pt.addEventListener("visibilitychange",vt),pt.addEventListener("inputsourceschange",_t),ot.xr.setSession(pt).then(()=>{ot.xr.setFoveation(ht().foveation)}),()=>{ot.xr.removeEventListener("sessionstart",bt),ot.xr.removeEventListener("sessionend",xt),pt.removeEventListener("visibilitychange",vt),pt.removeEventListener("inputsourceschange",_t)}},[pt,ot.xr,dt,ht]),reactExports.createElement(InteractionManager,null,reactExports.createElement("primitive",{object:ut},reactExports.createElement("primitive",{object:ct}),ft.map(bt=>reactExports.createElement("primitive",{key:bt.index,object:bt}))),lt)}function XR(tt){const _e=reactExports.useMemo(()=>create((rt,it)=>({set:rt,get:it,controllers:[],isPresenting:!1,isHandTracking:!1,player:new Group,session:null,foveation:0,referenceSpace:"local-floor",hoverState:{left:new Map,right:new Map,none:new Map},interactions:new Map,hasInteraction(nt,st){var at;return!!((at=it().interactions.get(nt))!=null&&at[st].some(lt=>lt.current))},getInteraction(nt,st){var at;return(at=it().interactions.get(nt))==null?void 0:at[st].reduce((lt,ot)=>(ot.current&&lt.push(ot.current),lt),[])},addInteraction(nt,st,at){const lt=it().interactions;lt.has(nt)||lt.set(nt,{onHover:[],onBlur:[],onSelect:[],onSelectEnd:[],onSelectStart:[],onSelectMissed:[],onSqueeze:[],onSqueezeEnd:[],onSqueezeStart:[],onSqueezeMissed:[],onMove:[]}),lt.get(nt)[st].push(at)},removeInteraction(nt,st,at){const lt=it().interactions.get(nt);if(lt){const ot=lt[st].indexOf(at);ot!==-1&&lt[st].splice(ot,1)}}})),[]);return reactExports.createElement(XRContext.Provider,{value:_e},reactExports.createElement(XRManager,{...tt}))}const getSessionOptions=(tt,_e)=>{var rt;if(!(!tt&&!_e))return tt&&!_e?{optionalFeatures:[tt]}:tt&&_e?{..._e,optionalFeatures:uniq$1([...(rt=_e.optionalFeatures)!=null?rt:[],tt])}:_e},startSession=async(tt,_e)=>{const rt=globalSessionStore.getState();if(rt.session){console.warn("@react-three/xr: session already started, please stop it first");return}const it=getSessionOptions(rt.referenceSpaceType,_e),nt=await navigator.xr.requestSession(tt,it);return rt.set(()=>({session:nt})),nt},stopSession=async()=>{const tt=globalSessionStore.getState();if(!tt.session){console.warn("@react-three/xr: no session to stop, please start it first");return}await tt.session.end(),tt.set({session:null})},toggleSession=async(tt,{sessionInit:_e,enterOnly:rt,exitOnly:it}={})=>{const nt=globalSessionStore.getState();if(!(nt.session&&rt)&&!(!nt.session&&it))return nt.session?await stopSession():await startSession(tt,_e)},getLabel=(tt,_e,rt)=>{switch(tt){case"entered":return`Exit ${_e}`;case"exited":return`Enter ${_e}`;case"unsupported":default:switch(rt){case"https":return"HTTPS needed";case"security":return`${_e} blocked`;case"unknown":default:return`${_e} unsupported`}}},XRButton=reactExports.forwardRef(function({mode:_e,sessionInit:rt,enterOnly:it=!1,exitOnly:nt=!1,onClick:st,onError:at,children:lt,...ot},ct){var ut;const[ht,dt]=reactExports.useState("exited"),[pt,ft]=reactExports.useState("unknown"),gt=getLabel(ht,_e,pt),mt=_e==="inline"?_e:`immersive-${_e.toLowerCase()}`,At=useCallbackRef$2(at);useIsomorphicLayoutEffect(()=>{if(!(navigator!=null&&navigator.xr))return void dt("unsupported");navigator.xr.isSessionSupported(mt).then(bt=>{if(bt)dt("exited");else{const xt=location.protocol==="https:";dt("unsupported"),ft(xt?"unknown":"https")}}).catch(bt=>{dt("unsupported"),"name"in bt&&bt.name==="SecurityError"?ft("security"):ft("unknown")})},[mt]),useIsomorphicLayoutEffect(()=>globalSessionStore.subscribe(bt=>{bt.session?dt("entered"):ht!=="unsupported"&&dt("exited")}),[ht]);const yt=reactExports.useCallback(async bt=>{st==null||st(bt);try{toggleSession(mt,{sessionInit:rt,enterOnly:it,exitOnly:nt})}catch(xt){const vt=At.current;if(vt&&xt instanceof Error)vt(xt);else throw xt}},[st,mt,rt,it,nt,At]);return reactExports.createElement("button",{...ot,ref:ct,onClick:ht==="unsupported"?st:yt},(ut=typeof lt=="function"?lt(ht):lt)!=null?ut:gt)}),buttonStyles={position:"absolute",bottom:"24px",left:"50%",transform:"translateX(-50%)",padding:"12px 24px",border:"1px solid white",borderRadius:"4px",background:"rgba(0, 0, 0, 0.1)",color:"white",font:"normal 0.8125rem sans-serif",outline:"none",zIndex:99999,cursor:"pointer"};reactExports.forwardRef(({style:tt=buttonStyles,sessionInit:_e={domOverlay:typeof document<"u"?{root:document.body}:void 0,optionalFeatures:["hit-test","dom-overlay","dom-overlay-for-handheld-ar"]},children:rt,...it},nt)=>reactExports.createElement(XRButton,{...it,ref:nt,mode:"AR",style:tt,sessionInit:_e},rt));const VRButton$1=reactExports.forwardRef(({style:tt=buttonStyles,sessionInit:_e={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]},children:rt,...it},nt)=>reactExports.createElement(XRButton,{...it,ref:nt,mode:"VR",style:tt,sessionInit:_e},rt));function useXR(tt=rt=>rt,_e){const rt=reactExports.useContext(XRContext);if(!rt)throw new Error("useXR must be used within an <XR /> component!");return rt(tt,_e)}var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(tt,_e){for(var rt=new u16(31),it=0;it<31;++it)rt[it]=_e+=1<<tt[it-1];for(var nt=new u32(rt[30]),it=1;it<30;++it)for(var st=rt[it];st<rt[it+1];++st)nt[st]=st-rt[it]<<5|it;return[rt,nt]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b[0],rev=new u16(32768);for(var i$5=0;i$5<32768;++i$5){var x$3=(i$5&43690)>>>1|(i$5&21845)<<1;x$3=(x$3&52428)>>>2|(x$3&13107)<<2,x$3=(x$3&61680)>>>4|(x$3&3855)<<4,rev[i$5]=((x$3&65280)>>>8|(x$3&255)<<8)>>>1}var hMap=function(tt,_e,rt){for(var it=tt.length,nt=0,st=new u16(_e);nt<it;++nt)++st[tt[nt]-1];var at=new u16(_e);for(nt=0;nt<_e;++nt)at[nt]=at[nt-1]+st[nt-1]<<1;var lt;if(rt){lt=new u16(1<<_e);var ot=15-_e;for(nt=0;nt<it;++nt)if(tt[nt])for(var ct=nt<<4|tt[nt],ut=_e-tt[nt],ht=at[tt[nt]-1]++<<ut,dt=ht|(1<<ut)-1;ht<=dt;++ht)lt[rev[ht]>>>ot]=ct}else for(lt=new u16(it),nt=0;nt<it;++nt)tt[nt]&&(lt[nt]=rev[at[tt[nt]-1]++]>>>15-tt[nt]);return lt},flt=new u8(288);for(var i$5=0;i$5<144;++i$5)flt[i$5]=8;for(var i$5=144;i$5<256;++i$5)flt[i$5]=9;for(var i$5=256;i$5<280;++i$5)flt[i$5]=7;for(var i$5=280;i$5<288;++i$5)flt[i$5]=8;var fdt=new u8(32);for(var i$5=0;i$5<32;++i$5)fdt[i$5]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(tt){for(var _e=tt[0],rt=1;rt<tt.length;++rt)tt[rt]>_e&&(_e=tt[rt]);return _e},bits=function(tt,_e,rt){var it=_e/8|0;return(tt[it]|tt[it+1]<<8)>>(_e&7)&rt},bits16=function(tt,_e){var rt=_e/8|0;return(tt[rt]|tt[rt+1]<<8|tt[rt+2]<<16)>>(_e&7)},shft=function(tt){return(tt/8|0)+(tt&7&&1)},slc=function(tt,_e,rt){(_e==null||_e<0)&&(_e=0),(rt==null||rt>tt.length)&&(rt=tt.length);var it=new(tt instanceof u16?u16:tt instanceof u32?u32:u8)(rt-_e);return it.set(tt.subarray(_e,rt)),it},inflt=function(tt,_e,rt){var it=tt.length;if(!it||rt&&!rt.l&&it<5)return _e||new u8(0);var nt=!_e||rt,st=!rt||rt.i;rt||(rt={}),_e||(_e=new u8(it*3));var at=function(er){var ir=_e.length;if(er>ir){var ur=new u8(Math.max(ir*2,er));ur.set(_e),_e=ur}},lt=rt.f||0,ot=rt.p||0,ct=rt.b||0,ut=rt.l,ht=rt.d,dt=rt.m,pt=rt.n,ft=it*8;do{if(!ut){rt.f=lt=bits(tt,ot,1);var gt=bits(tt,ot+1,3);if(ot+=3,gt)if(gt==1)ut=flrm,ht=fdrm,dt=9,pt=5;else if(gt==2){var bt=bits(tt,ot,31)+257,xt=bits(tt,ot+10,15)+4,vt=bt+bits(tt,ot+5,31)+1;ot+=14;for(var _t=new u8(vt),Ct=new u8(19),St=0;St<xt;++St)Ct[clim[St]]=bits(tt,ot+St*3,7);ot+=xt*3;for(var Et=max(Ct),Tt=(1<<Et)-1,Mt=hMap(Ct,Et,1),St=0;St<vt;){var Rt=Mt[bits(tt,ot,Tt)];ot+=Rt&15;var mt=Rt>>>4;if(mt<16)_t[St++]=mt;else{var It=0,Ot=0;for(mt==16?(Ot=3+bits(tt,ot,3),ot+=2,It=_t[St-1]):mt==17?(Ot=3+bits(tt,ot,7),ot+=3):mt==18&&(Ot=11+bits(tt,ot,127),ot+=7);Ot--;)_t[St++]=It}}var Bt=_t.subarray(0,bt),Nt=_t.subarray(bt);dt=max(Bt),pt=max(Nt),ut=hMap(Bt,dt,1),ht=hMap(Nt,pt,1)}else throw"invalid block type";else{var mt=shft(ot)+4,At=tt[mt-4]|tt[mt-3]<<8,yt=mt+At;if(yt>it){if(st)throw"unexpected EOF";break}nt&&at(ct+At),_e.set(tt.subarray(mt,yt),ct),rt.b=ct+=At,rt.p=ot=yt*8;continue}if(ot>ft){if(st)throw"unexpected EOF";break}}nt&&at(ct+131072);for(var zt=(1<<dt)-1,Dt=(1<<pt)-1,Ft=ot;;Ft=ot){var It=ut[bits16(tt,ot)&zt],Ut=It>>>4;if(ot+=It&15,ot>ft){if(st)throw"unexpected EOF";break}if(!It)throw"invalid length/literal";if(Ut<256)_e[ct++]=Ut;else if(Ut==256){Ft=ot,ut=null;break}else{var $t=Ut-254;if(Ut>264){var St=Ut-257,Vt=fleb[St];$t=bits(tt,ot,(1<<Vt)-1)+fl[St],ot+=Vt}var Zt=ht[bits16(tt,ot)&Dt],qt=Zt>>>4;if(!Zt)throw"invalid distance";ot+=Zt&15;var Nt=fd[qt];if(qt>3){var Vt=fdeb[qt];Nt+=bits16(tt,ot)&(1<<Vt)-1,ot+=Vt}if(ot>ft){if(st)throw"unexpected EOF";break}nt&&at(ct+131072);for(var sr=ct+$t;ct<sr;ct+=4)_e[ct]=_e[ct-Nt],_e[ct+1]=_e[ct+1-Nt],_e[ct+2]=_e[ct+2-Nt],_e[ct+3]=_e[ct+3-Nt];ct=sr}}rt.l=ut,rt.p=Ft,rt.b=ct,ut&&(lt=1,rt.m=dt,rt.d=ht,rt.n=pt)}while(!lt);return ct==_e.length?_e:slc(_e,0,ct)},et=new u8(0),zlv=function(tt){if((tt[0]&15)!=8||tt[0]>>>4>7||(tt[0]<<8|tt[1])%31)throw"invalid zlib data";if(tt[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function unzlibSync(tt,_e){return inflt((zlv(tt),tt.subarray(2,-4)),_e)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch{}function CharsetEncoder(){}CharsetEncoder.prototype.s2u=function(tt){for(var _e=this.s2uTable,rt="",it=0;it<tt.length;){var nt=tt[it++];if(!(nt>=0&&nt<=126||nt>=161&&nt<=223)&&it<tt.length&&(nt=nt<<8|tt[it++]),_e[nt]===void 0)return console.error("unknown char code "+nt+"."),rt;rt+=String.fromCharCode(_e[nt])}return rt};CharsetEncoder.prototype.s2uTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:65340,33120:65374,33121:8741,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:65293,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:65504,33170:65505,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:65506,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34624:9312,34625:9313,34626:9314,34627:9315,34628:9316,34629:9317,34630:9318,34631:9319,34632:9320,34633:9321,34634:9322,34635:9323,34636:9324,34637:9325,34638:9326,34639:9327,34640:9328,34641:9329,34642:9330,34643:9331,34644:8544,34645:8545,34646:8546,34647:8547,34648:8548,34649:8549,34650:8550,34651:8551,34652:8552,34653:8553,34655:13129,34656:13076,34657:13090,34658:13133,34659:13080,34660:13095,34661:13059,34662:13110,34663:13137,34664:13143,34665:13069,34666:13094,34667:13091,34668:13099,34669:13130,34670:13115,34671:13212,34672:13213,34673:13214,34674:13198,34675:13199,34676:13252,34677:13217,34686:13179,34688:12317,34689:12319,34690:8470,34691:13261,34692:8481,34693:12964,34694:12965,34695:12966,34696:12967,34697:12968,34698:12849,34699:12850,34700:12857,34701:13182,34702:13181,34703:13180,34704:8786,34705:8801,34706:8747,34707:8750,34708:8721,34709:8730,34710:8869,34711:8736,34712:8735,34713:8895,34714:8757,34715:8745,34716:8746,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081,60736:32394,60737:35100,60738:37704,60739:37512,60740:34012,60741:20425,60742:28859,60743:26161,60744:26824,60745:37625,60746:26363,60747:24389,60748:20008,60749:20193,60750:20220,60751:20224,60752:20227,60753:20281,60754:20310,60755:20370,60756:20362,60757:20378,60758:20372,60759:20429,60760:20544,60761:20514,60762:20479,60763:20510,60764:20550,60765:20592,60766:20546,60767:20628,60768:20724,60769:20696,60770:20810,60771:20836,60772:20893,60773:20926,60774:20972,60775:21013,60776:21148,60777:21158,60778:21184,60779:21211,60780:21248,60781:21255,60782:21284,60783:21362,60784:21395,60785:21426,60786:21469,60787:64014,60788:21660,60789:21642,60790:21673,60791:21759,60792:21894,60793:22361,60794:22373,60795:22444,60796:22472,60797:22471,60798:64015,60800:64016,60801:22686,60802:22706,60803:22795,60804:22867,60805:22875,60806:22877,60807:22883,60808:22948,60809:22970,60810:23382,60811:23488,60812:29999,60813:23512,60814:23532,60815:23582,60816:23718,60817:23738,60818:23797,60819:23847,60820:23891,60821:64017,60822:23874,60823:23917,60824:23992,60825:23993,60826:24016,60827:24353,60828:24372,60829:24423,60830:24503,60831:24542,60832:24669,60833:24709,60834:24714,60835:24798,60836:24789,60837:24864,60838:24818,60839:24849,60840:24887,60841:24880,60842:24984,60843:25107,60844:25254,60845:25589,60846:25696,60847:25757,60848:25806,60849:25934,60850:26112,60851:26133,60852:26171,60853:26121,60854:26158,60855:26142,60856:26148,60857:26213,60858:26199,60859:26201,60860:64018,60861:26227,60862:26265,60863:26272,60864:26290,60865:26303,60866:26362,60867:26382,60868:63785,60869:26470,60870:26555,60871:26706,60872:26560,60873:26625,60874:26692,60875:26831,60876:64019,60877:26984,60878:64020,60879:27032,60880:27106,60881:27184,60882:27243,60883:27206,60884:27251,60885:27262,60886:27362,60887:27364,60888:27606,60889:27711,60890:27740,60891:27782,60892:27759,60893:27866,60894:27908,60895:28039,60896:28015,60897:28054,60898:28076,60899:28111,60900:28152,60901:28146,60902:28156,60903:28217,60904:28252,60905:28199,60906:28220,60907:28351,60908:28552,60909:28597,60910:28661,60911:28677,60912:28679,60913:28712,60914:28805,60915:28843,60916:28943,60917:28932,60918:29020,60919:28998,60920:28999,60921:64021,60922:29121,60923:29182,60924:29361,60992:29374,60993:29476,60994:64022,60995:29559,60996:29629,60997:29641,60998:29654,60999:29667,61e3:29650,61001:29703,61002:29685,61003:29734,61004:29738,61005:29737,61006:29742,61007:29794,61008:29833,61009:29855,61010:29953,61011:30063,61012:30338,61013:30364,61014:30366,61015:30363,61016:30374,61017:64023,61018:30534,61019:21167,61020:30753,61021:30798,61022:30820,61023:30842,61024:31024,61025:64024,61026:64025,61027:64026,61028:31124,61029:64027,61030:31131,61031:31441,61032:31463,61033:64028,61034:31467,61035:31646,61036:64029,61037:32072,61038:32092,61039:32183,61040:32160,61041:32214,61042:32338,61043:32583,61044:32673,61045:64030,61046:33537,61047:33634,61048:33663,61049:33735,61050:33782,61051:33864,61052:33972,61053:34131,61054:34137,61056:34155,61057:64031,61058:34224,61059:64032,61060:64033,61061:34823,61062:35061,61063:35346,61064:35383,61065:35449,61066:35495,61067:35518,61068:35551,61069:64034,61070:35574,61071:35667,61072:35711,61073:36080,61074:36084,61075:36114,61076:36214,61077:64035,61078:36559,61079:64036,61080:64037,61081:36967,61082:37086,61083:64038,61084:37141,61085:37159,61086:37338,61087:37335,61088:37342,61089:37357,61090:37358,61091:37348,61092:37349,61093:37382,61094:37392,61095:37386,61096:37434,61097:37440,61098:37436,61099:37454,61100:37465,61101:37457,61102:37433,61103:37479,61104:37543,61105:37495,61106:37496,61107:37607,61108:37591,61109:37593,61110:37584,61111:64039,61112:37589,61113:37600,61114:37587,61115:37669,61116:37665,61117:37627,61118:64040,61119:37662,61120:37631,61121:37661,61122:37634,61123:37744,61124:37719,61125:37796,61126:37830,61127:37854,61128:37880,61129:37937,61130:37957,61131:37960,61132:38290,61133:63964,61134:64041,61135:38557,61136:38575,61137:38707,61138:38715,61139:38723,61140:38733,61141:38735,61142:38737,61143:38741,61144:38999,61145:39013,61146:64042,61147:64043,61148:39207,61149:64044,61150:39326,61151:39502,61152:39641,61153:39644,61154:39797,61155:39794,61156:39823,61157:39857,61158:39867,61159:39936,61160:40304,61161:40299,61162:64045,61163:40473,61164:40657,61167:8560,61168:8561,61169:8562,61170:8563,61171:8564,61172:8565,61173:8566,61174:8567,61175:8568,61176:8569,61177:65506,61178:65508,61179:65287,61180:65282,61504:57344,61505:57345,61506:57346,61507:57347,61508:57348,61509:57349,61510:57350,61511:57351,61512:57352,61513:57353,61514:57354,61515:57355,61516:57356,61517:57357,61518:57358,61519:57359,61520:57360,61521:57361,61522:57362,61523:57363,61524:57364,61525:57365,61526:57366,61527:57367,61528:57368,61529:57369,61530:57370,61531:57371,61532:57372,61533:57373,61534:57374,61535:57375,61536:57376,61537:57377,61538:57378,61539:57379,61540:57380,61541:57381,61542:57382,61543:57383,61544:57384,61545:57385,61546:57386,61547:57387,61548:57388,61549:57389,61550:57390,61551:57391,61552:57392,61553:57393,61554:57394,61555:57395,61556:57396,61557:57397,61558:57398,61559:57399,61560:57400,61561:57401,61562:57402,61563:57403,61564:57404,61565:57405,61566:57406,61568:57407,61569:57408,61570:57409,61571:57410,61572:57411,61573:57412,61574:57413,61575:57414,61576:57415,61577:57416,61578:57417,61579:57418,61580:57419,61581:57420,61582:57421,61583:57422,61584:57423,61585:57424,61586:57425,61587:57426,61588:57427,61589:57428,61590:57429,61591:57430,61592:57431,61593:57432,61594:57433,61595:57434,61596:57435,61597:57436,61598:57437,61599:57438,61600:57439,61601:57440,61602:57441,61603:57442,61604:57443,61605:57444,61606:57445,61607:57446,61608:57447,61609:57448,61610:57449,61611:57450,61612:57451,61613:57452,61614:57453,61615:57454,61616:57455,61617:57456,61618:57457,61619:57458,61620:57459,61621:57460,61622:57461,61623:57462,61624:57463,61625:57464,61626:57465,61627:57466,61628:57467,61629:57468,61630:57469,61631:57470,61632:57471,61633:57472,61634:57473,61635:57474,61636:57475,61637:57476,61638:57477,61639:57478,61640:57479,61641:57480,61642:57481,61643:57482,61644:57483,61645:57484,61646:57485,61647:57486,61648:57487,61649:57488,61650:57489,61651:57490,61652:57491,61653:57492,61654:57493,61655:57494,61656:57495,61657:57496,61658:57497,61659:57498,61660:57499,61661:57500,61662:57501,61663:57502,61664:57503,61665:57504,61666:57505,61667:57506,61668:57507,61669:57508,61670:57509,61671:57510,61672:57511,61673:57512,61674:57513,61675:57514,61676:57515,61677:57516,61678:57517,61679:57518,61680:57519,61681:57520,61682:57521,61683:57522,61684:57523,61685:57524,61686:57525,61687:57526,61688:57527,61689:57528,61690:57529,61691:57530,61692:57531,61760:57532,61761:57533,61762:57534,61763:57535,61764:57536,61765:57537,61766:57538,61767:57539,61768:57540,61769:57541,61770:57542,61771:57543,61772:57544,61773:57545,61774:57546,61775:57547,61776:57548,61777:57549,61778:57550,61779:57551,61780:57552,61781:57553,61782:57554,61783:57555,61784:57556,61785:57557,61786:57558,61787:57559,61788:57560,61789:57561,61790:57562,61791:57563,61792:57564,61793:57565,61794:57566,61795:57567,61796:57568,61797:57569,61798:57570,61799:57571,61800:57572,61801:57573,61802:57574,61803:57575,61804:57576,61805:57577,61806:57578,61807:57579,61808:57580,61809:57581,61810:57582,61811:57583,61812:57584,61813:57585,61814:57586,61815:57587,61816:57588,61817:57589,61818:57590,61819:57591,61820:57592,61821:57593,61822:57594,61824:57595,61825:57596,61826:57597,61827:57598,61828:57599,61829:57600,61830:57601,61831:57602,61832:57603,61833:57604,61834:57605,61835:57606,61836:57607,61837:57608,61838:57609,61839:57610,61840:57611,61841:57612,61842:57613,61843:57614,61844:57615,61845:57616,61846:57617,61847:57618,61848:57619,61849:57620,61850:57621,61851:57622,61852:57623,61853:57624,61854:57625,61855:57626,61856:57627,61857:57628,61858:57629,61859:57630,61860:57631,61861:57632,61862:57633,61863:57634,61864:57635,61865:57636,61866:57637,61867:57638,61868:57639,61869:57640,61870:57641,61871:57642,61872:57643,61873:57644,61874:57645,61875:57646,61876:57647,61877:57648,61878:57649,61879:57650,61880:57651,61881:57652,61882:57653,61883:57654,61884:57655,61885:57656,61886:57657,61887:57658,61888:57659,61889:57660,61890:57661,61891:57662,61892:57663,61893:57664,61894:57665,61895:57666,61896:57667,61897:57668,61898:57669,61899:57670,61900:57671,61901:57672,61902:57673,61903:57674,61904:57675,61905:57676,61906:57677,61907:57678,61908:57679,61909:57680,61910:57681,61911:57682,61912:57683,61913:57684,61914:57685,61915:57686,61916:57687,61917:57688,61918:57689,61919:57690,61920:57691,61921:57692,61922:57693,61923:57694,61924:57695,61925:57696,61926:57697,61927:57698,61928:57699,61929:57700,61930:57701,61931:57702,61932:57703,61933:57704,61934:57705,61935:57706,61936:57707,61937:57708,61938:57709,61939:57710,61940:57711,61941:57712,61942:57713,61943:57714,61944:57715,61945:57716,61946:57717,61947:57718,61948:57719,62016:57720,62017:57721,62018:57722,62019:57723,62020:57724,62021:57725,62022:57726,62023:57727,62024:57728,62025:57729,62026:57730,62027:57731,62028:57732,62029:57733,62030:57734,62031:57735,62032:57736,62033:57737,62034:57738,62035:57739,62036:57740,62037:57741,62038:57742,62039:57743,62040:57744,62041:57745,62042:57746,62043:57747,62044:57748,62045:57749,62046:57750,62047:57751,62048:57752,62049:57753,62050:57754,62051:57755,62052:57756,62053:57757,62054:57758,62055:57759,62056:57760,62057:57761,62058:57762,62059:57763,62060:57764,62061:57765,62062:57766,62063:57767,62064:57768,62065:57769,62066:57770,62067:57771,62068:57772,62069:57773,62070:57774,62071:57775,62072:57776,62073:57777,62074:57778,62075:57779,62076:57780,62077:57781,62078:57782,62080:57783,62081:57784,62082:57785,62083:57786,62084:57787,62085:57788,62086:57789,62087:57790,62088:57791,62089:57792,62090:57793,62091:57794,62092:57795,62093:57796,62094:57797,62095:57798,62096:57799,62097:57800,62098:57801,62099:57802,62100:57803,62101:57804,62102:57805,62103:57806,62104:57807,62105:57808,62106:57809,62107:57810,62108:57811,62109:57812,62110:57813,62111:57814,62112:57815,62113:57816,62114:57817,62115:57818,62116:57819,62117:57820,62118:57821,62119:57822,62120:57823,62121:57824,62122:57825,62123:57826,62124:57827,62125:57828,62126:57829,62127:57830,62128:57831,62129:57832,62130:57833,62131:57834,62132:57835,62133:57836,62134:57837,62135:57838,62136:57839,62137:57840,62138:57841,62139:57842,62140:57843,62141:57844,62142:57845,62143:57846,62144:57847,62145:57848,62146:57849,62147:57850,62148:57851,62149:57852,62150:57853,62151:57854,62152:57855,62153:57856,62154:57857,62155:57858,62156:57859,62157:57860,62158:57861,62159:57862,62160:57863,62161:57864,62162:57865,62163:57866,62164:57867,62165:57868,62166:57869,62167:57870,62168:57871,62169:57872,62170:57873,62171:57874,62172:57875,62173:57876,62174:57877,62175:57878,62176:57879,62177:57880,62178:57881,62179:57882,62180:57883,62181:57884,62182:57885,62183:57886,62184:57887,62185:57888,62186:57889,62187:57890,62188:57891,62189:57892,62190:57893,62191:57894,62192:57895,62193:57896,62194:57897,62195:57898,62196:57899,62197:57900,62198:57901,62199:57902,62200:57903,62201:57904,62202:57905,62203:57906,62204:57907,62272:57908,62273:57909,62274:57910,62275:57911,62276:57912,62277:57913,62278:57914,62279:57915,62280:57916,62281:57917,62282:57918,62283:57919,62284:57920,62285:57921,62286:57922,62287:57923,62288:57924,62289:57925,62290:57926,62291:57927,62292:57928,62293:57929,62294:57930,62295:57931,62296:57932,62297:57933,62298:57934,62299:57935,62300:57936,62301:57937,62302:57938,62303:57939,62304:57940,62305:57941,62306:57942,62307:57943,62308:57944,62309:57945,62310:57946,62311:57947,62312:57948,62313:57949,62314:57950,62315:57951,62316:57952,62317:57953,62318:57954,62319:57955,62320:57956,62321:57957,62322:57958,62323:57959,62324:57960,62325:57961,62326:57962,62327:57963,62328:57964,62329:57965,62330:57966,62331:57967,62332:57968,62333:57969,62334:57970,62336:57971,62337:57972,62338:57973,62339:57974,62340:57975,62341:57976,62342:57977,62343:57978,62344:57979,62345:57980,62346:57981,62347:57982,62348:57983,62349:57984,62350:57985,62351:57986,62352:57987,62353:57988,62354:57989,62355:57990,62356:57991,62357:57992,62358:57993,62359:57994,62360:57995,62361:57996,62362:57997,62363:57998,62364:57999,62365:58e3,62366:58001,62367:58002,62368:58003,62369:58004,62370:58005,62371:58006,62372:58007,62373:58008,62374:58009,62375:58010,62376:58011,62377:58012,62378:58013,62379:58014,62380:58015,62381:58016,62382:58017,62383:58018,62384:58019,62385:58020,62386:58021,62387:58022,62388:58023,62389:58024,62390:58025,62391:58026,62392:58027,62393:58028,62394:58029,62395:58030,62396:58031,62397:58032,62398:58033,62399:58034,62400:58035,62401:58036,62402:58037,62403:58038,62404:58039,62405:58040,62406:58041,62407:58042,62408:58043,62409:58044,62410:58045,62411:58046,62412:58047,62413:58048,62414:58049,62415:58050,62416:58051,62417:58052,62418:58053,62419:58054,62420:58055,62421:58056,62422:58057,62423:58058,62424:58059,62425:58060,62426:58061,62427:58062,62428:58063,62429:58064,62430:58065,62431:58066,62432:58067,62433:58068,62434:58069,62435:58070,62436:58071,62437:58072,62438:58073,62439:58074,62440:58075,62441:58076,62442:58077,62443:58078,62444:58079,62445:58080,62446:58081,62447:58082,62448:58083,62449:58084,62450:58085,62451:58086,62452:58087,62453:58088,62454:58089,62455:58090,62456:58091,62457:58092,62458:58093,62459:58094,62460:58095,62528:58096,62529:58097,62530:58098,62531:58099,62532:58100,62533:58101,62534:58102,62535:58103,62536:58104,62537:58105,62538:58106,62539:58107,62540:58108,62541:58109,62542:58110,62543:58111,62544:58112,62545:58113,62546:58114,62547:58115,62548:58116,62549:58117,62550:58118,62551:58119,62552:58120,62553:58121,62554:58122,62555:58123,62556:58124,62557:58125,62558:58126,62559:58127,62560:58128,62561:58129,62562:58130,62563:58131,62564:58132,62565:58133,62566:58134,62567:58135,62568:58136,62569:58137,62570:58138,62571:58139,62572:58140,62573:58141,62574:58142,62575:58143,62576:58144,62577:58145,62578:58146,62579:58147,62580:58148,62581:58149,62582:58150,62583:58151,62584:58152,62585:58153,62586:58154,62587:58155,62588:58156,62589:58157,62590:58158,62592:58159,62593:58160,62594:58161,62595:58162,62596:58163,62597:58164,62598:58165,62599:58166,62600:58167,62601:58168,62602:58169,62603:58170,62604:58171,62605:58172,62606:58173,62607:58174,62608:58175,62609:58176,62610:58177,62611:58178,62612:58179,62613:58180,62614:58181,62615:58182,62616:58183,62617:58184,62618:58185,62619:58186,62620:58187,62621:58188,62622:58189,62623:58190,62624:58191,62625:58192,62626:58193,62627:58194,62628:58195,62629:58196,62630:58197,62631:58198,62632:58199,62633:58200,62634:58201,62635:58202,62636:58203,62637:58204,62638:58205,62639:58206,62640:58207,62641:58208,62642:58209,62643:58210,62644:58211,62645:58212,62646:58213,62647:58214,62648:58215,62649:58216,62650:58217,62651:58218,62652:58219,62653:58220,62654:58221,62655:58222,62656:58223,62657:58224,62658:58225,62659:58226,62660:58227,62661:58228,62662:58229,62663:58230,62664:58231,62665:58232,62666:58233,62667:58234,62668:58235,62669:58236,62670:58237,62671:58238,62672:58239,62673:58240,62674:58241,62675:58242,62676:58243,62677:58244,62678:58245,62679:58246,62680:58247,62681:58248,62682:58249,62683:58250,62684:58251,62685:58252,62686:58253,62687:58254,62688:58255,62689:58256,62690:58257,62691:58258,62692:58259,62693:58260,62694:58261,62695:58262,62696:58263,62697:58264,62698:58265,62699:58266,62700:58267,62701:58268,62702:58269,62703:58270,62704:58271,62705:58272,62706:58273,62707:58274,62708:58275,62709:58276,62710:58277,62711:58278,62712:58279,62713:58280,62714:58281,62715:58282,62716:58283,62784:58284,62785:58285,62786:58286,62787:58287,62788:58288,62789:58289,62790:58290,62791:58291,62792:58292,62793:58293,62794:58294,62795:58295,62796:58296,62797:58297,62798:58298,62799:58299,62800:58300,62801:58301,62802:58302,62803:58303,62804:58304,62805:58305,62806:58306,62807:58307,62808:58308,62809:58309,62810:58310,62811:58311,62812:58312,62813:58313,62814:58314,62815:58315,62816:58316,62817:58317,62818:58318,62819:58319,62820:58320,62821:58321,62822:58322,62823:58323,62824:58324,62825:58325,62826:58326,62827:58327,62828:58328,62829:58329,62830:58330,62831:58331,62832:58332,62833:58333,62834:58334,62835:58335,62836:58336,62837:58337,62838:58338,62839:58339,62840:58340,62841:58341,62842:58342,62843:58343,62844:58344,62845:58345,62846:58346,62848:58347,62849:58348,62850:58349,62851:58350,62852:58351,62853:58352,62854:58353,62855:58354,62856:58355,62857:58356,62858:58357,62859:58358,62860:58359,62861:58360,62862:58361,62863:58362,62864:58363,62865:58364,62866:58365,62867:58366,62868:58367,62869:58368,62870:58369,62871:58370,62872:58371,62873:58372,62874:58373,62875:58374,62876:58375,62877:58376,62878:58377,62879:58378,62880:58379,62881:58380,62882:58381,62883:58382,62884:58383,62885:58384,62886:58385,62887:58386,62888:58387,62889:58388,62890:58389,62891:58390,62892:58391,62893:58392,62894:58393,62895:58394,62896:58395,62897:58396,62898:58397,62899:58398,62900:58399,62901:58400,62902:58401,62903:58402,62904:58403,62905:58404,62906:58405,62907:58406,62908:58407,62909:58408,62910:58409,62911:58410,62912:58411,62913:58412,62914:58413,62915:58414,62916:58415,62917:58416,62918:58417,62919:58418,62920:58419,62921:58420,62922:58421,62923:58422,62924:58423,62925:58424,62926:58425,62927:58426,62928:58427,62929:58428,62930:58429,62931:58430,62932:58431,62933:58432,62934:58433,62935:58434,62936:58435,62937:58436,62938:58437,62939:58438,62940:58439,62941:58440,62942:58441,62943:58442,62944:58443,62945:58444,62946:58445,62947:58446,62948:58447,62949:58448,62950:58449,62951:58450,62952:58451,62953:58452,62954:58453,62955:58454,62956:58455,62957:58456,62958:58457,62959:58458,62960:58459,62961:58460,62962:58461,62963:58462,62964:58463,62965:58464,62966:58465,62967:58466,62968:58467,62969:58468,62970:58469,62971:58470,62972:58471,63040:58472,63041:58473,63042:58474,63043:58475,63044:58476,63045:58477,63046:58478,63047:58479,63048:58480,63049:58481,63050:58482,63051:58483,63052:58484,63053:58485,63054:58486,63055:58487,63056:58488,63057:58489,63058:58490,63059:58491,63060:58492,63061:58493,63062:58494,63063:58495,63064:58496,63065:58497,63066:58498,63067:58499,63068:58500,63069:58501,63070:58502,63071:58503,63072:58504,63073:58505,63074:58506,63075:58507,63076:58508,63077:58509,63078:58510,63079:58511,63080:58512,63081:58513,63082:58514,63083:58515,63084:58516,63085:58517,63086:58518,63087:58519,63088:58520,63089:58521,63090:58522,63091:58523,63092:58524,63093:58525,63094:58526,63095:58527,63096:58528,63097:58529,63098:58530,63099:58531,63100:58532,63101:58533,63102:58534,63104:58535,63105:58536,63106:58537,63107:58538,63108:58539,63109:58540,63110:58541,63111:58542,63112:58543,63113:58544,63114:58545,63115:58546,63116:58547,63117:58548,63118:58549,63119:58550,63120:58551,63121:58552,63122:58553,63123:58554,63124:58555,63125:58556,63126:58557,63127:58558,63128:58559,63129:58560,63130:58561,63131:58562,63132:58563,63133:58564,63134:58565,63135:58566,63136:58567,63137:58568,63138:58569,63139:58570,63140:58571,63141:58572,63142:58573,63143:58574,63144:58575,63145:58576,63146:58577,63147:58578,63148:58579,63149:58580,63150:58581,63151:58582,63152:58583,63153:58584,63154:58585,63155:58586,63156:58587,63157:58588,63158:58589,63159:58590,63160:58591,63161:58592,63162:58593,63163:58594,63164:58595,63165:58596,63166:58597,63167:58598,63168:58599,63169:58600,63170:58601,63171:58602,63172:58603,63173:58604,63174:58605,63175:58606,63176:58607,63177:58608,63178:58609,63179:58610,63180:58611,63181:58612,63182:58613,63183:58614,63184:58615,63185:58616,63186:58617,63187:58618,63188:58619,63189:58620,63190:58621,63191:58622,63192:58623,63193:58624,63194:58625,63195:58626,63196:58627,63197:58628,63198:58629,63199:58630,63200:58631,63201:58632,63202:58633,63203:58634,63204:58635,63205:58636,63206:58637,63207:58638,63208:58639,63209:58640,63210:58641,63211:58642,63212:58643,63213:58644,63214:58645,63215:58646,63216:58647,63217:58648,63218:58649,63219:58650,63220:58651,63221:58652,63222:58653,63223:58654,63224:58655,63225:58656,63226:58657,63227:58658,63228:58659,63296:58660,63297:58661,63298:58662,63299:58663,63300:58664,63301:58665,63302:58666,63303:58667,63304:58668,63305:58669,63306:58670,63307:58671,63308:58672,63309:58673,63310:58674,63311:58675,63312:58676,63313:58677,63314:58678,63315:58679,63316:58680,63317:58681,63318:58682,63319:58683,63320:58684,63321:58685,63322:58686,63323:58687,63324:58688,63325:58689,63326:58690,63327:58691,63328:58692,63329:58693,63330:58694,63331:58695,63332:58696,63333:58697,63334:58698,63335:58699,63336:58700,63337:58701,63338:58702,63339:58703,63340:58704,63341:58705,63342:58706,63343:58707,63344:58708,63345:58709,63346:58710,63347:58711,63348:58712,63349:58713,63350:58714,63351:58715,63352:58716,63353:58717,63354:58718,63355:58719,63356:58720,63357:58721,63358:58722,63360:58723,63361:58724,63362:58725,63363:58726,63364:58727,63365:58728,63366:58729,63367:58730,63368:58731,63369:58732,63370:58733,63371:58734,63372:58735,63373:58736,63374:58737,63375:58738,63376:58739,63377:58740,63378:58741,63379:58742,63380:58743,63381:58744,63382:58745,63383:58746,63384:58747,63385:58748,63386:58749,63387:58750,63388:58751,63389:58752,63390:58753,63391:58754,63392:58755,63393:58756,63394:58757,63395:58758,63396:58759,63397:58760,63398:58761,63399:58762,63400:58763,63401:58764,63402:58765,63403:58766,63404:58767,63405:58768,63406:58769,63407:58770,63408:58771,63409:58772,63410:58773,63411:58774,63412:58775,63413:58776,63414:58777,63415:58778,63416:58779,63417:58780,63418:58781,63419:58782,63420:58783,63421:58784,63422:58785,63423:58786,63424:58787,63425:58788,63426:58789,63427:58790,63428:58791,63429:58792,63430:58793,63431:58794,63432:58795,63433:58796,63434:58797,63435:58798,63436:58799,63437:58800,63438:58801,63439:58802,63440:58803,63441:58804,63442:58805,63443:58806,63444:58807,63445:58808,63446:58809,63447:58810,63448:58811,63449:58812,63450:58813,63451:58814,63452:58815,63453:58816,63454:58817,63455:58818,63456:58819,63457:58820,63458:58821,63459:58822,63460:58823,63461:58824,63462:58825,63463:58826,63464:58827,63465:58828,63466:58829,63467:58830,63468:58831,63469:58832,63470:58833,63471:58834,63472:58835,63473:58836,63474:58837,63475:58838,63476:58839,63477:58840,63478:58841,63479:58842,63480:58843,63481:58844,63482:58845,63483:58846,63484:58847,63552:58848,63553:58849,63554:58850,63555:58851,63556:58852,63557:58853,63558:58854,63559:58855,63560:58856,63561:58857,63562:58858,63563:58859,63564:58860,63565:58861,63566:58862,63567:58863,63568:58864,63569:58865,63570:58866,63571:58867,63572:58868,63573:58869,63574:58870,63575:58871,63576:58872,63577:58873,63578:58874,63579:58875,63580:58876,63581:58877,63582:58878,63583:58879,63584:58880,63585:58881,63586:58882,63587:58883,63588:58884,63589:58885,63590:58886,63591:58887,63592:58888,63593:58889,63594:58890,63595:58891,63596:58892,63597:58893,63598:58894,63599:58895,63600:58896,63601:58897,63602:58898,63603:58899,63604:58900,63605:58901,63606:58902,63607:58903,63608:58904,63609:58905,63610:58906,63611:58907,63612:58908,63613:58909,63614:58910,63616:58911,63617:58912,63618:58913,63619:58914,63620:58915,63621:58916,63622:58917,63623:58918,63624:58919,63625:58920,63626:58921,63627:58922,63628:58923,63629:58924,63630:58925,63631:58926,63632:58927,63633:58928,63634:58929,63635:58930,63636:58931,63637:58932,63638:58933,63639:58934,63640:58935,63641:58936,63642:58937,63643:58938,63644:58939,63645:58940,63646:58941,63647:58942,63648:58943,63649:58944,63650:58945,63651:58946,63652:58947,63653:58948,63654:58949,63655:58950,63656:58951,63657:58952,63658:58953,63659:58954,63660:58955,63661:58956,63662:58957,63663:58958,63664:58959,63665:58960,63666:58961,63667:58962,63668:58963,63669:58964,63670:58965,63671:58966,63672:58967,63673:58968,63674:58969,63675:58970,63676:58971,63677:58972,63678:58973,63679:58974,63680:58975,63681:58976,63682:58977,63683:58978,63684:58979,63685:58980,63686:58981,63687:58982,63688:58983,63689:58984,63690:58985,63691:58986,63692:58987,63693:58988,63694:58989,63695:58990,63696:58991,63697:58992,63698:58993,63699:58994,63700:58995,63701:58996,63702:58997,63703:58998,63704:58999,63705:59e3,63706:59001,63707:59002,63708:59003,63709:59004,63710:59005,63711:59006,63712:59007,63713:59008,63714:59009,63715:59010,63716:59011,63717:59012,63718:59013,63719:59014,63720:59015,63721:59016,63722:59017,63723:59018,63724:59019,63725:59020,63726:59021,63727:59022,63728:59023,63729:59024,63730:59025,63731:59026,63732:59027,63733:59028,63734:59029,63735:59030,63736:59031,63737:59032,63738:59033,63739:59034,63740:59035,64064:8560,64065:8561,64066:8562,64067:8563,64068:8564,64069:8565,64070:8566,64071:8567,64072:8568,64073:8569,64074:8544,64075:8545,64076:8546,64077:8547,64078:8548,64079:8549,64080:8550,64081:8551,64082:8552,64083:8553,64084:65506,64085:65508,64086:65287,64087:65282,64088:12849,64089:8470,64090:8481,64091:8757,64092:32394,64093:35100,64094:37704,64095:37512,64096:34012,64097:20425,64098:28859,64099:26161,64100:26824,64101:37625,64102:26363,64103:24389,64104:20008,64105:20193,64106:20220,64107:20224,64108:20227,64109:20281,64110:20310,64111:20370,64112:20362,64113:20378,64114:20372,64115:20429,64116:20544,64117:20514,64118:20479,64119:20510,64120:20550,64121:20592,64122:20546,64123:20628,64124:20724,64125:20696,64126:20810,64128:20836,64129:20893,64130:20926,64131:20972,64132:21013,64133:21148,64134:21158,64135:21184,64136:21211,64137:21248,64138:21255,64139:21284,64140:21362,64141:21395,64142:21426,64143:21469,64144:64014,64145:21660,64146:21642,64147:21673,64148:21759,64149:21894,64150:22361,64151:22373,64152:22444,64153:22472,64154:22471,64155:64015,64156:64016,64157:22686,64158:22706,64159:22795,64160:22867,64161:22875,64162:22877,64163:22883,64164:22948,64165:22970,64166:23382,64167:23488,64168:29999,64169:23512,64170:23532,64171:23582,64172:23718,64173:23738,64174:23797,64175:23847,64176:23891,64177:64017,64178:23874,64179:23917,64180:23992,64181:23993,64182:24016,64183:24353,64184:24372,64185:24423,64186:24503,64187:24542,64188:24669,64189:24709,64190:24714,64191:24798,64192:24789,64193:24864,64194:24818,64195:24849,64196:24887,64197:24880,64198:24984,64199:25107,64200:25254,64201:25589,64202:25696,64203:25757,64204:25806,64205:25934,64206:26112,64207:26133,64208:26171,64209:26121,64210:26158,64211:26142,64212:26148,64213:26213,64214:26199,64215:26201,64216:64018,64217:26227,64218:26265,64219:26272,64220:26290,64221:26303,64222:26362,64223:26382,64224:63785,64225:26470,64226:26555,64227:26706,64228:26560,64229:26625,64230:26692,64231:26831,64232:64019,64233:26984,64234:64020,64235:27032,64236:27106,64237:27184,64238:27243,64239:27206,64240:27251,64241:27262,64242:27362,64243:27364,64244:27606,64245:27711,64246:27740,64247:27782,64248:27759,64249:27866,64250:27908,64251:28039,64252:28015,64320:28054,64321:28076,64322:28111,64323:28152,64324:28146,64325:28156,64326:28217,64327:28252,64328:28199,64329:28220,64330:28351,64331:28552,64332:28597,64333:28661,64334:28677,64335:28679,64336:28712,64337:28805,64338:28843,64339:28943,64340:28932,64341:29020,64342:28998,64343:28999,64344:64021,64345:29121,64346:29182,64347:29361,64348:29374,64349:29476,64350:64022,64351:29559,64352:29629,64353:29641,64354:29654,64355:29667,64356:29650,64357:29703,64358:29685,64359:29734,64360:29738,64361:29737,64362:29742,64363:29794,64364:29833,64365:29855,64366:29953,64367:30063,64368:30338,64369:30364,64370:30366,64371:30363,64372:30374,64373:64023,64374:30534,64375:21167,64376:30753,64377:30798,64378:30820,64379:30842,64380:31024,64381:64024,64382:64025,64384:64026,64385:31124,64386:64027,64387:31131,64388:31441,64389:31463,64390:64028,64391:31467,64392:31646,64393:64029,64394:32072,64395:32092,64396:32183,64397:32160,64398:32214,64399:32338,64400:32583,64401:32673,64402:64030,64403:33537,64404:33634,64405:33663,64406:33735,64407:33782,64408:33864,64409:33972,64410:34131,64411:34137,64412:34155,64413:64031,64414:34224,64415:64032,64416:64033,64417:34823,64418:35061,64419:35346,64420:35383,64421:35449,64422:35495,64423:35518,64424:35551,64425:64034,64426:35574,64427:35667,64428:35711,64429:36080,64430:36084,64431:36114,64432:36214,64433:64035,64434:36559,64435:64036,64436:64037,64437:36967,64438:37086,64439:64038,64440:37141,64441:37159,64442:37338,64443:37335,64444:37342,64445:37357,64446:37358,64447:37348,64448:37349,64449:37382,64450:37392,64451:37386,64452:37434,64453:37440,64454:37436,64455:37454,64456:37465,64457:37457,64458:37433,64459:37479,64460:37543,64461:37495,64462:37496,64463:37607,64464:37591,64465:37593,64466:37584,64467:64039,64468:37589,64469:37600,64470:37587,64471:37669,64472:37665,64473:37627,64474:64040,64475:37662,64476:37631,64477:37661,64478:37634,64479:37744,64480:37719,64481:37796,64482:37830,64483:37854,64484:37880,64485:37937,64486:37957,64487:37960,64488:38290,64489:63964,64490:64041,64491:38557,64492:38575,64493:38707,64494:38715,64495:38723,64496:38733,64497:38735,64498:38737,64499:38741,64500:38999,64501:39013,64502:64042,64503:64043,64504:39207,64505:64044,64506:39326,64507:39502,64508:39641,64576:39644,64577:39797,64578:39794,64579:39823,64580:39857,64581:39867,64582:39936,64583:40304,64584:40299,64585:64045,64586:40473,64587:40657};function DataViewEx(tt,_e){this.dv=new DataView(tt),this.offset=0,this.littleEndian=_e!==void 0?_e:!0,this.encoder=new CharsetEncoder}DataViewEx.prototype={constructor:DataViewEx,getInt8:function(){var tt=this.dv.getInt8(this.offset);return this.offset+=1,tt},getInt8Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getInt8());return _e},getUint8:function(){var tt=this.dv.getUint8(this.offset);return this.offset+=1,tt},getUint8Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getUint8());return _e},getInt16:function(){var tt=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,tt},getInt16Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getInt16());return _e},getUint16:function(){var tt=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,tt},getUint16Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getUint16());return _e},getInt32:function(){var tt=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,tt},getInt32Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getInt32());return _e},getUint32:function(){var tt=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,tt},getUint32Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getUint32());return _e},getFloat32:function(){var tt=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,tt},getFloat32Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getFloat32());return _e},getFloat64:function(){var tt=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,tt},getFloat64Array:function(tt){for(var _e=[],rt=0;rt<tt;rt++)_e.push(this.getFloat64());return _e},getIndex:function(tt,_e){switch(tt){case 1:return _e===!0?this.getUint8():this.getInt8();case 2:return _e===!0?this.getUint16():this.getInt16();case 4:return this.getInt32();default:throw"unknown number type "+tt+" exception."}},getIndexArray:function(tt,_e,rt){for(var it=[],nt=0;nt<_e;nt++)it.push(this.getIndex(tt,rt));return it},getChars:function(tt){for(var _e="";tt>0;){var rt=this.getUint8();if(tt--,rt===0)break;_e+=String.fromCharCode(rt)}for(;tt>0;)this.getUint8(),tt--;return _e},getSjisStringsAsUnicode:function(tt){for(var _e=[];tt>0;){var rt=this.getUint8();if(tt--,rt===0)break;_e.push(rt)}for(;tt>0;)this.getUint8(),tt--;return this.encoder.s2u(new Uint8Array(_e))},getUnicodeStrings:function(tt){for(var _e="";tt>0;){var rt=this.getUint16();if(tt-=2,rt===0)break;_e+=String.fromCharCode(rt)}for(;tt>0;)this.getUint8(),tt--;return _e},getTextBuffer:function(){var tt=this.getUint32();return this.getUnicodeStrings(tt)}};function DataCreationHelper(){}DataCreationHelper.prototype={constructor:DataCreationHelper,leftToRightVector3:function(tt){tt[2]=-tt[2]},leftToRightQuaternion:function(tt){tt[0]=-tt[0],tt[1]=-tt[1]},leftToRightEuler:function(tt){tt[0]=-tt[0],tt[1]=-tt[1]},leftToRightIndexOrder:function(tt){var _e=tt[2];tt[2]=tt[0],tt[0]=_e},leftToRightVector3Range:function(tt,_e){var rt=-_e[2];_e[2]=-tt[2],tt[2]=rt},leftToRightEulerRange:function(tt,_e){var rt=-_e[0],it=-_e[1];_e[0]=-tt[0],_e[1]=-tt[1],tt[0]=rt,tt[1]=it}};const KHR_SUPERCOMPRESSION_NONE=0,KHR_SUPERCOMPRESSION_ZSTD=2,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT=0,KHR_DF_VENDORID_KHRONOS=0,KHR_DF_VERSION=2,KHR_DF_MODEL_UNSPECIFIED=0,KHR_DF_FLAG_ALPHA_STRAIGHT=0,KHR_DF_FLAG_ALPHA_PREMULTIPLIED=1,KHR_DF_TRANSFER_SRGB=2,KHR_DF_PRIMARIES_BT709=1,KHR_DF_SAMPLE_DATATYPE_SIGNED=64,VK_FORMAT_UNDEFINED=0,VK_FORMAT_R8_UNORM=9,VK_FORMAT_R8_SRGB=15,VK_FORMAT_R8G8_UNORM=16,VK_FORMAT_R8G8_SRGB=22,VK_FORMAT_R8G8B8A8_UNORM=37,VK_FORMAT_R8G8B8A8_SRGB=43,VK_FORMAT_R16_SFLOAT=76,VK_FORMAT_R16G16_SFLOAT=83,VK_FORMAT_R16G16B16A16_SFLOAT=97,VK_FORMAT_R32_SFLOAT=100,VK_FORMAT_R32G32_SFLOAT=103,VK_FORMAT_R32G32B32A32_SFLOAT=109;class KTX2Container{constructor(){this.vkFormat=VK_FORMAT_UNDEFINED,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=KHR_SUPERCOMPRESSION_NONE,this.levels=[],this.dataFormatDescriptor=[{vendorId:KHR_DF_VENDORID_KHRONOS,descriptorType:KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT,descriptorBlockSize:0,versionNumber:KHR_DF_VERSION,colorModel:KHR_DF_MODEL_UNSPECIFIED,colorPrimaries:KHR_DF_PRIMARIES_BT709,transferFunction:KHR_DF_TRANSFER_SRGB,flags:KHR_DF_FLAG_ALPHA_STRAIGHT,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class BufferReader{constructor(_e,rt,it,nt){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(_e.buffer,_e.byteOffset+rt,it),this._littleEndian=nt,this._offset=0}_nextUint8(){const _e=this._dataView.getUint8(this._offset);return this._offset+=1,_e}_nextUint16(){const _e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,_e}_nextUint32(){const _e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,_e}_nextUint64(){const _e=this._dataView.getUint32(this._offset,this._littleEndian),rt=this._dataView.getUint32(this._offset+4,this._littleEndian),it=_e+2**32*rt;return this._offset+=8,it}_nextInt32(){const _e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,_e}_skip(_e){return this._offset+=_e,this}_scan(_e,rt=0){const it=this._offset;let nt=0;for(;this._dataView.getUint8(this._offset)!==rt&&nt<_e;)nt++,this._offset++;return nt<_e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+it,nt)}}const KTX2_ID=[171,75,84,88,32,50,48,187,13,10,26,10];function decodeText(tt){return typeof TextDecoder<"u"?new TextDecoder().decode(tt):Buffer.from(tt).toString("utf8")}function read(tt){const _e=new Uint8Array(tt.buffer,tt.byteOffset,KTX2_ID.length);if(_e[0]!==KTX2_ID[0]||_e[1]!==KTX2_ID[1]||_e[2]!==KTX2_ID[2]||_e[3]!==KTX2_ID[3]||_e[4]!==KTX2_ID[4]||_e[5]!==KTX2_ID[5]||_e[6]!==KTX2_ID[6]||_e[7]!==KTX2_ID[7]||_e[8]!==KTX2_ID[8]||_e[9]!==KTX2_ID[9]||_e[10]!==KTX2_ID[10]||_e[11]!==KTX2_ID[11])throw new Error("Missing KTX 2.0 identifier.");const rt=new KTX2Container,it=17*Uint32Array.BYTES_PER_ELEMENT,nt=new BufferReader(tt,KTX2_ID.length,it,!0);rt.vkFormat=nt._nextUint32(),rt.typeSize=nt._nextUint32(),rt.pixelWidth=nt._nextUint32(),rt.pixelHeight=nt._nextUint32(),rt.pixelDepth=nt._nextUint32(),rt.layerCount=nt._nextUint32(),rt.faceCount=nt._nextUint32();const st=nt._nextUint32();rt.supercompressionScheme=nt._nextUint32();const at=nt._nextUint32(),lt=nt._nextUint32(),ot=nt._nextUint32(),ct=nt._nextUint32(),ut=nt._nextUint64(),ht=nt._nextUint64(),dt=st*3*8,pt=new BufferReader(tt,KTX2_ID.length+it,dt,!0);for(let Ut=0;Ut<st;Ut++)rt.levels.push({levelData:new Uint8Array(tt.buffer,tt.byteOffset+pt._nextUint64(),pt._nextUint64()),uncompressedByteLength:pt._nextUint64()});const ft=new BufferReader(tt,at,lt,!0),gt={vendorId:ft._skip(4)._nextUint16(),descriptorType:ft._nextUint16(),versionNumber:ft._nextUint16(),descriptorBlockSize:ft._nextUint16(),colorModel:ft._nextUint8(),colorPrimaries:ft._nextUint8(),transferFunction:ft._nextUint8(),flags:ft._nextUint8(),texelBlockDimension:[ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8()],bytesPlane:[ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8()],samples:[]},mt=6,At=4,yt=(gt.descriptorBlockSize/4-mt)/At;for(let Ut=0;Ut<yt;Ut++){const $t={bitOffset:ft._nextUint16(),bitLength:ft._nextUint8(),channelType:ft._nextUint8(),samplePosition:[ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};$t.channelType&KHR_DF_SAMPLE_DATATYPE_SIGNED?($t.sampleLower=ft._nextInt32(),$t.sampleUpper=ft._nextInt32()):($t.sampleLower=ft._nextUint32(),$t.sampleUpper=ft._nextUint32()),gt.samples[Ut]=$t}rt.dataFormatDescriptor.length=0,rt.dataFormatDescriptor.push(gt);const bt=new BufferReader(tt,ot,ct,!0);for(;bt._offset<ct;){const Ut=bt._nextUint32(),$t=bt._scan(Ut),Vt=decodeText($t),Zt=bt._scan(Ut-$t.byteLength);rt.keyValue[Vt]=Vt.match(/^ktx/i)?decodeText(Zt):Zt,bt._offset%4&&bt._skip(4-bt._offset%4)}if(ht<=0)return rt;const xt=new BufferReader(tt,ut,ht,!0),vt=xt._nextUint16(),_t=xt._nextUint16(),Ct=xt._nextUint32(),St=xt._nextUint32(),Et=xt._nextUint32(),Tt=xt._nextUint32(),Mt=[];for(let Ut=0;Ut<st;Ut++)Mt.push({imageFlags:xt._nextUint32(),rgbSliceByteOffset:xt._nextUint32(),rgbSliceByteLength:xt._nextUint32(),alphaSliceByteOffset:xt._nextUint32(),alphaSliceByteLength:xt._nextUint32()});const Rt=ut+xt._offset,It=Rt+Ct,Ot=It+St,Bt=Ot+Et,Nt=new Uint8Array(tt.buffer,tt.byteOffset+Rt,Ct),zt=new Uint8Array(tt.buffer,tt.byteOffset+It,St),Dt=new Uint8Array(tt.buffer,tt.byteOffset+Ot,Et),Ft=new Uint8Array(tt.buffer,tt.byteOffset+Bt,Tt);return rt.globalData={endpointCount:vt,selectorCount:_t,imageDescs:Mt,endpointsData:Nt,selectorsData:zt,tablesData:Dt,extendedData:Ft},rt}let A$1,I$3,B$1;const g$4={env:{emscripten_notify_memory_growth:function(tt){B$1=new Uint8Array(I$3.exports.memory.buffer)}}};let Q$1=class{init(){return A$1||(A$1=typeof fetch<"u"?fetch("data:application/wasm;base64,"+C$1).then(_e=>_e.arrayBuffer()).then(_e=>WebAssembly.instantiate(_e,g$4)).then(this._init):WebAssembly.instantiate(Buffer.from(C$1,"base64"),g$4).then(this._init),A$1)}_init(_e){I$3=_e.instance,g$4.env.emscripten_notify_memory_growth(0)}decode(_e,rt=0){if(!I$3)throw new Error("ZSTDDecoder: Await .init() before decoding.");const it=_e.byteLength,nt=I$3.exports.malloc(it);B$1.set(_e,nt),rt=rt||Number(I$3.exports.ZSTD_findDecompressedSize(nt,it));const st=I$3.exports.malloc(rt),at=I$3.exports.ZSTD_decompress(st,rt,nt,it),lt=B$1.slice(st,st+at);return I$3.exports.free(nt),I$3.exports.free(st),lt}};const C$1="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ";/*! https://mths.be/codepointat v0.2.0 by @mathias */String.prototype.codePointAt||function(){var tt=function(){try{var rt={},it=Object.defineProperty,nt=it(rt,rt,rt)&&it}catch{}return nt}(),_e=function(rt){if(this==null)throw TypeError();var it=String(this),nt=it.length,st=rt?Number(rt):0;if(st!=st&&(st=0),!(st<0||st>=nt)){var at=it.charCodeAt(st),lt;return at>=55296&&at<=56319&&nt>st+1&&(lt=it.charCodeAt(st+1),lt>=56320&&lt<=57343)?(at-55296)*1024+lt-56320+65536:at}};tt?tt(String.prototype,"codePointAt",{value:_e,configurable:!0,writable:!0}):String.prototype.codePointAt=_e}();function Tree(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}var sltree=new Tree,sdtree=new Tree,length_bits=new Uint8Array(30),length_base=new Uint16Array(30),dist_bits=new Uint8Array(30),dist_base=new Uint16Array(30);function tinf_build_bits_base(tt,_e,rt,it){var nt,st;for(nt=0;nt<rt;++nt)tt[nt]=0;for(nt=0;nt<30-rt;++nt)tt[nt+rt]=nt/rt|0;for(st=it,nt=0;nt<30;++nt)_e[nt]=st,st+=1<<tt[nt]}function tinf_build_fixed_trees(tt,_e){var rt;for(rt=0;rt<7;++rt)tt.table[rt]=0;for(tt.table[7]=24,tt.table[8]=152,tt.table[9]=112,rt=0;rt<24;++rt)tt.trans[rt]=256+rt;for(rt=0;rt<144;++rt)tt.trans[24+rt]=rt;for(rt=0;rt<8;++rt)tt.trans[24+144+rt]=280+rt;for(rt=0;rt<112;++rt)tt.trans[24+144+8+rt]=144+rt;for(rt=0;rt<5;++rt)_e.table[rt]=0;for(_e.table[5]=32,rt=0;rt<32;++rt)_e.trans[rt]=rt}tinf_build_fixed_trees(sltree,sdtree);tinf_build_bits_base(length_bits,length_base,4,3);tinf_build_bits_base(dist_bits,dist_base,2,1);length_bits[28]=0;length_base[28]=258;function derive(tt,_e,rt,it,nt){return Math.pow(1-nt,3)*tt+3*Math.pow(1-nt,2)*nt*_e+3*(1-nt)*Math.pow(nt,2)*rt+Math.pow(nt,3)*it}function BoundingBox(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}BoundingBox.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)};BoundingBox.prototype.addPoint=function(tt,_e){typeof tt=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=tt,this.x2=tt),tt<this.x1&&(this.x1=tt),tt>this.x2&&(this.x2=tt)),typeof _e=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=_e,this.y2=_e),_e<this.y1&&(this.y1=_e),_e>this.y2&&(this.y2=_e))};BoundingBox.prototype.addX=function(tt){this.addPoint(tt,null)};BoundingBox.prototype.addY=function(tt){this.addPoint(null,tt)};BoundingBox.prototype.addBezier=function(tt,_e,rt,it,nt,st,at,lt){var ot=[tt,_e],ct=[rt,it],ut=[nt,st],ht=[at,lt];this.addPoint(tt,_e),this.addPoint(at,lt);for(var dt=0;dt<=1;dt++){var pt=6*ot[dt]-12*ct[dt]+6*ut[dt],ft=-3*ot[dt]+9*ct[dt]-9*ut[dt]+3*ht[dt],gt=3*ct[dt]-3*ot[dt];if(ft===0){if(pt===0)continue;var mt=-gt/pt;0<mt&&mt<1&&(dt===0&&this.addX(derive(ot[dt],ct[dt],ut[dt],ht[dt],mt)),dt===1&&this.addY(derive(ot[dt],ct[dt],ut[dt],ht[dt],mt)));continue}var At=Math.pow(pt,2)-4*gt*ft;if(!(At<0)){var yt=(-pt+Math.sqrt(At))/(2*ft);0<yt&&yt<1&&(dt===0&&this.addX(derive(ot[dt],ct[dt],ut[dt],ht[dt],yt)),dt===1&&this.addY(derive(ot[dt],ct[dt],ut[dt],ht[dt],yt)));var bt=(-pt-Math.sqrt(At))/(2*ft);0<bt&&bt<1&&(dt===0&&this.addX(derive(ot[dt],ct[dt],ut[dt],ht[dt],bt)),dt===1&&this.addY(derive(ot[dt],ct[dt],ut[dt],ht[dt],bt)))}}};BoundingBox.prototype.addQuad=function(tt,_e,rt,it,nt,st){var at=tt+.6666666666666666*(rt-tt),lt=_e+2/3*(it-_e),ot=at+1/3*(nt-tt),ct=lt+1/3*(st-_e);this.addBezier(tt,_e,at,lt,ot,ct,nt,st)};function Path(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}Path.prototype.moveTo=function(tt,_e){this.commands.push({type:"M",x:tt,y:_e})};Path.prototype.lineTo=function(tt,_e){this.commands.push({type:"L",x:tt,y:_e})};Path.prototype.curveTo=Path.prototype.bezierCurveTo=function(tt,_e,rt,it,nt,st){this.commands.push({type:"C",x1:tt,y1:_e,x2:rt,y2:it,x:nt,y:st})};Path.prototype.quadTo=Path.prototype.quadraticCurveTo=function(tt,_e,rt,it){this.commands.push({type:"Q",x1:tt,y1:_e,x:rt,y:it})};Path.prototype.close=Path.prototype.closePath=function(){this.commands.push({type:"Z"})};Path.prototype.extend=function(tt){if(tt.commands)tt=tt.commands;else if(tt instanceof BoundingBox){var _e=tt;this.moveTo(_e.x1,_e.y1),this.lineTo(_e.x2,_e.y1),this.lineTo(_e.x2,_e.y2),this.lineTo(_e.x1,_e.y2),this.close();return}Array.prototype.push.apply(this.commands,tt)};Path.prototype.getBoundingBox=function(){for(var tt=new BoundingBox,_e=0,rt=0,it=0,nt=0,st=0;st<this.commands.length;st++){var at=this.commands[st];switch(at.type){case"M":tt.addPoint(at.x,at.y),_e=it=at.x,rt=nt=at.y;break;case"L":tt.addPoint(at.x,at.y),it=at.x,nt=at.y;break;case"Q":tt.addQuad(it,nt,at.x1,at.y1,at.x,at.y),it=at.x,nt=at.y;break;case"C":tt.addBezier(it,nt,at.x1,at.y1,at.x2,at.y2,at.x,at.y),it=at.x,nt=at.y;break;case"Z":it=_e,nt=rt;break;default:throw new Error("Unexpected path command "+at.type)}}return tt.isEmpty()&&tt.addPoint(0,0),tt};Path.prototype.draw=function(tt){tt.beginPath();for(var _e=0;_e<this.commands.length;_e+=1){var rt=this.commands[_e];rt.type==="M"?tt.moveTo(rt.x,rt.y):rt.type==="L"?tt.lineTo(rt.x,rt.y):rt.type==="C"?tt.bezierCurveTo(rt.x1,rt.y1,rt.x2,rt.y2,rt.x,rt.y):rt.type==="Q"?tt.quadraticCurveTo(rt.x1,rt.y1,rt.x,rt.y):rt.type==="Z"&&tt.closePath()}this.fill&&(tt.fillStyle=this.fill,tt.fill()),this.stroke&&(tt.strokeStyle=this.stroke,tt.lineWidth=this.strokeWidth,tt.stroke())};Path.prototype.toPathData=function(tt){tt=tt!==void 0?tt:2;function _e(at){return Math.round(at)===at?""+Math.round(at):at.toFixed(tt)}function rt(){for(var at=arguments,lt="",ot=0;ot<arguments.length;ot+=1){var ct=at[ot];ct>=0&&ot>0&&(lt+=" "),lt+=_e(ct)}return lt}for(var it="",nt=0;nt<this.commands.length;nt+=1){var st=this.commands[nt];st.type==="M"?it+="M"+rt(st.x,st.y):st.type==="L"?it+="L"+rt(st.x,st.y):st.type==="C"?it+="C"+rt(st.x1,st.y1,st.x2,st.y2,st.x,st.y):st.type==="Q"?it+="Q"+rt(st.x1,st.y1,st.x,st.y):st.type==="Z"&&(it+="Z")}return it};Path.prototype.toSVG=function(tt){var _e='<path d="';return _e+=this.toPathData(tt),_e+='"',this.fill&&this.fill!=="black"&&(this.fill===null?_e+=' fill="none"':_e+=' fill="'+this.fill+'"'),this.stroke&&(_e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),_e+="/>",_e};Path.prototype.toDOMElement=function(tt){var _e=this.toPathData(tt),rt=document.createElementNS("http://www.w3.org/2000/svg","path");return rt.setAttribute("d",_e),rt};function fail(tt){throw new Error(tt)}function argument(tt,_e){tt||fail(_e)}var check={fail,argument,assert:argument},LIMIT16=32768,LIMIT32=2147483648,decode={},encode={},sizeOf={};function constant$2(tt){return function(){return tt}}encode.BYTE=function(tt){return check.argument(tt>=0&&tt<=255,"Byte value should be between 0 and 255."),[tt]};sizeOf.BYTE=constant$2(1);encode.CHAR=function(tt){return[tt.charCodeAt(0)]};sizeOf.CHAR=constant$2(1);encode.CHARARRAY=function(tt){typeof tt>"u"&&(tt="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var _e=[],rt=0;rt<tt.length;rt+=1)_e[rt]=tt.charCodeAt(rt);return _e};sizeOf.CHARARRAY=function(tt){return typeof tt>"u"?0:tt.length};encode.USHORT=function(tt){return[tt>>8&255,tt&255]};sizeOf.USHORT=constant$2(2);encode.SHORT=function(tt){return tt>=LIMIT16&&(tt=-(2*LIMIT16-tt)),[tt>>8&255,tt&255]};sizeOf.SHORT=constant$2(2);encode.UINT24=function(tt){return[tt>>16&255,tt>>8&255,tt&255]};sizeOf.UINT24=constant$2(3);encode.ULONG=function(tt){return[tt>>24&255,tt>>16&255,tt>>8&255,tt&255]};sizeOf.ULONG=constant$2(4);encode.LONG=function(tt){return tt>=LIMIT32&&(tt=-(2*LIMIT32-tt)),[tt>>24&255,tt>>16&255,tt>>8&255,tt&255]};sizeOf.LONG=constant$2(4);encode.FIXED=encode.ULONG;sizeOf.FIXED=sizeOf.ULONG;encode.FWORD=encode.SHORT;sizeOf.FWORD=sizeOf.SHORT;encode.UFWORD=encode.USHORT;sizeOf.UFWORD=sizeOf.USHORT;encode.LONGDATETIME=function(tt){return[0,0,0,0,tt>>24&255,tt>>16&255,tt>>8&255,tt&255]};sizeOf.LONGDATETIME=constant$2(8);encode.TAG=function(tt){return check.argument(tt.length===4,"Tag should be exactly 4 ASCII characters."),[tt.charCodeAt(0),tt.charCodeAt(1),tt.charCodeAt(2),tt.charCodeAt(3)]};sizeOf.TAG=constant$2(4);encode.Card8=encode.BYTE;sizeOf.Card8=sizeOf.BYTE;encode.Card16=encode.USHORT;sizeOf.Card16=sizeOf.USHORT;encode.OffSize=encode.BYTE;sizeOf.OffSize=sizeOf.BYTE;encode.SID=encode.USHORT;sizeOf.SID=sizeOf.USHORT;encode.NUMBER=function(tt){return tt>=-107&&tt<=107?[tt+139]:tt>=108&&tt<=1131?(tt=tt-108,[(tt>>8)+247,tt&255]):tt>=-1131&&tt<=-108?(tt=-tt-108,[(tt>>8)+251,tt&255]):tt>=-32768&&tt<=32767?encode.NUMBER16(tt):encode.NUMBER32(tt)};sizeOf.NUMBER=function(tt){return encode.NUMBER(tt).length};encode.NUMBER16=function(tt){return[28,tt>>8&255,tt&255]};sizeOf.NUMBER16=constant$2(3);encode.NUMBER32=function(tt){return[29,tt>>24&255,tt>>16&255,tt>>8&255,tt&255]};sizeOf.NUMBER32=constant$2(5);encode.REAL=function(tt){var _e=tt.toString(),rt=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(_e);if(rt){var it=parseFloat("1e"+((rt[2]?+rt[2]:0)+rt[1].length));_e=(Math.round(tt*it)/it).toString()}for(var nt="",st=0,at=_e.length;st<at;st+=1){var lt=_e[st];lt==="e"?nt+=_e[++st]==="-"?"c":"b":lt==="."?nt+="a":lt==="-"?nt+="e":nt+=lt}nt+=nt.length&1?"f":"ff";for(var ot=[30],ct=0,ut=nt.length;ct<ut;ct+=2)ot.push(parseInt(nt.substr(ct,2),16));return ot};sizeOf.REAL=function(tt){return encode.REAL(tt).length};encode.NAME=encode.CHARARRAY;sizeOf.NAME=sizeOf.CHARARRAY;encode.STRING=encode.CHARARRAY;sizeOf.STRING=sizeOf.CHARARRAY;decode.UTF8=function(tt,_e,rt){for(var it=[],nt=rt,st=0;st<nt;st++,_e+=1)it[st]=tt.getUint8(_e);return String.fromCharCode.apply(null,it)};decode.UTF16=function(tt,_e,rt){for(var it=[],nt=rt/2,st=0;st<nt;st++,_e+=2)it[st]=tt.getUint16(_e);return String.fromCharCode.apply(null,it)};encode.UTF16=function(tt){for(var _e=[],rt=0;rt<tt.length;rt+=1){var it=tt.charCodeAt(rt);_e[_e.length]=it>>8&255,_e[_e.length]=it&255}return _e};sizeOf.UTF16=function(tt){return tt.length*2};var eightBitMacEncodings={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};decode.MACSTRING=function(tt,_e,rt,it){var nt=eightBitMacEncodings[it];if(nt!==void 0){for(var st="",at=0;at<rt;at++){var lt=tt.getUint8(_e+at);lt<=127?st+=String.fromCharCode(lt):st+=nt[lt&127]}return st}};var macEncodingTableCache=typeof WeakMap=="function"&&new WeakMap,macEncodingCacheKeys,getMacEncodingTable=function(tt){if(!macEncodingCacheKeys){macEncodingCacheKeys={};for(var _e in eightBitMacEncodings)macEncodingCacheKeys[_e]=new String(_e)}var rt=macEncodingCacheKeys[tt];if(rt!==void 0){if(macEncodingTableCache){var it=macEncodingTableCache.get(rt);if(it!==void 0)return it}var nt=eightBitMacEncodings[tt];if(nt!==void 0){for(var st={},at=0;at<nt.length;at++)st[nt.charCodeAt(at)]=at+128;return macEncodingTableCache&&macEncodingTableCache.set(rt,st),st}}};encode.MACSTRING=function(tt,_e){var rt=getMacEncodingTable(_e);if(rt!==void 0){for(var it=[],nt=0;nt<tt.length;nt++){var st=tt.charCodeAt(nt);if(st>=128&&(st=rt[st],st===void 0))return;it[nt]=st}return it}};sizeOf.MACSTRING=function(tt,_e){var rt=encode.MACSTRING(tt,_e);return rt!==void 0?rt.length:0};function isByteEncodable(tt){return tt>=-128&&tt<=127}function encodeVarDeltaRunAsZeroes(tt,_e,rt){for(var it=0,nt=tt.length;_e<nt&&it<64&&tt[_e]===0;)++_e,++it;return rt.push(128|it-1),_e}function encodeVarDeltaRunAsBytes(tt,_e,rt){for(var it=0,nt=tt.length,st=_e;st<nt&&it<64;){var at=tt[st];if(!isByteEncodable(at)||at===0&&st+1<nt&&tt[st+1]===0)break;++st,++it}rt.push(it-1);for(var lt=_e;lt<st;++lt)rt.push(tt[lt]+256&255);return st}function encodeVarDeltaRunAsWords(tt,_e,rt){for(var it=0,nt=tt.length,st=_e;st<nt&&it<64;){var at=tt[st];if(at===0||isByteEncodable(at)&&st+1<nt&&isByteEncodable(tt[st+1]))break;++st,++it}rt.push(64|it-1);for(var lt=_e;lt<st;++lt){var ot=tt[lt];rt.push(ot+65536>>8&255,ot+256&255)}return st}encode.VARDELTAS=function(tt){for(var _e=0,rt=[];_e<tt.length;){var it=tt[_e];it===0?_e=encodeVarDeltaRunAsZeroes(tt,_e,rt):it>=-128&&it<=127?_e=encodeVarDeltaRunAsBytes(tt,_e,rt):_e=encodeVarDeltaRunAsWords(tt,_e,rt)}return rt};encode.INDEX=function(tt){for(var _e=1,rt=[_e],it=[],nt=0;nt<tt.length;nt+=1){var st=encode.OBJECT(tt[nt]);Array.prototype.push.apply(it,st),_e+=st.length,rt.push(_e)}if(it.length===0)return[0,0];for(var at=[],lt=1+Math.floor(Math.log(_e)/Math.log(2))/8|0,ot=[void 0,encode.BYTE,encode.USHORT,encode.UINT24,encode.ULONG][lt],ct=0;ct<rt.length;ct+=1){var ut=ot(rt[ct]);Array.prototype.push.apply(at,ut)}return Array.prototype.concat(encode.Card16(tt.length),encode.OffSize(lt),at,it)};sizeOf.INDEX=function(tt){return encode.INDEX(tt).length};encode.DICT=function(tt){for(var _e=[],rt=Object.keys(tt),it=rt.length,nt=0;nt<it;nt+=1){var st=parseInt(rt[nt],0),at=tt[st];_e=_e.concat(encode.OPERAND(at.value,at.type)),_e=_e.concat(encode.OPERATOR(st))}return _e};sizeOf.DICT=function(tt){return encode.DICT(tt).length};encode.OPERATOR=function(tt){return tt<1200?[tt]:[12,tt-1200]};encode.OPERAND=function(tt,_e){var rt=[];if(Array.isArray(_e))for(var it=0;it<_e.length;it+=1)check.argument(tt.length===_e.length,"Not enough arguments given for type"+_e),rt=rt.concat(encode.OPERAND(tt[it],_e[it]));else if(_e==="SID")rt=rt.concat(encode.NUMBER(tt));else if(_e==="offset")rt=rt.concat(encode.NUMBER32(tt));else if(_e==="number")rt=rt.concat(encode.NUMBER(tt));else if(_e==="real")rt=rt.concat(encode.REAL(tt));else throw new Error("Unknown operand type "+_e);return rt};encode.OP=encode.BYTE;sizeOf.OP=sizeOf.BYTE;var wmm=typeof WeakMap=="function"&&new WeakMap;encode.CHARSTRING=function(tt){if(wmm){var _e=wmm.get(tt);if(_e!==void 0)return _e}for(var rt=[],it=tt.length,nt=0;nt<it;nt+=1){var st=tt[nt];rt=rt.concat(encode[st.type](st.value))}return wmm&&wmm.set(tt,rt),rt};sizeOf.CHARSTRING=function(tt){return encode.CHARSTRING(tt).length};encode.OBJECT=function(tt){var _e=encode[tt.type];return check.argument(_e!==void 0,"No encoding function for type "+tt.type),_e(tt.value)};sizeOf.OBJECT=function(tt){var _e=sizeOf[tt.type];return check.argument(_e!==void 0,"No sizeOf function for type "+tt.type),_e(tt.value)};encode.TABLE=function(tt){for(var _e=[],rt=tt.fields.length,it=[],nt=[],st=0;st<rt;st+=1){var at=tt.fields[st],lt=encode[at.type];check.argument(lt!==void 0,"No encoding function for field type "+at.type+" ("+at.name+")");var ot=tt[at.name];ot===void 0&&(ot=at.value);var ct=lt(ot);at.type==="TABLE"?(nt.push(_e.length),_e=_e.concat([0,0]),it.push(ct)):_e=_e.concat(ct)}for(var ut=0;ut<it.length;ut+=1){var ht=nt[ut],dt=_e.length;check.argument(dt<65536,"Table "+tt.tableName+" too big."),_e[ht]=dt>>8,_e[ht+1]=dt&255,_e=_e.concat(it[ut])}return _e};sizeOf.TABLE=function(tt){for(var _e=0,rt=tt.fields.length,it=0;it<rt;it+=1){var nt=tt.fields[it],st=sizeOf[nt.type];check.argument(st!==void 0,"No sizeOf function for field type "+nt.type+" ("+nt.name+")");var at=tt[nt.name];at===void 0&&(at=nt.value),_e+=st(at),nt.type==="TABLE"&&(_e+=2)}return _e};encode.RECORD=encode.TABLE;sizeOf.RECORD=sizeOf.TABLE;encode.LITERAL=function(tt){return tt};sizeOf.LITERAL=function(tt){return tt.length};function Table(tt,_e,rt){if(_e.length&&(_e[0].name!=="coverageFormat"||_e[0].value===1))for(var it=0;it<_e.length;it+=1){var nt=_e[it];this[nt.name]=nt.value}if(this.tableName=tt,this.fields=_e,rt)for(var st=Object.keys(rt),at=0;at<st.length;at+=1){var lt=st[at],ot=rt[lt];this[lt]!==void 0&&(this[lt]=ot)}}Table.prototype.encode=function(){return encode.TABLE(this)};Table.prototype.sizeOf=function(){return sizeOf.TABLE(this)};function ushortList(tt,_e,rt){rt===void 0&&(rt=_e.length);var it=new Array(_e.length+1);it[0]={name:tt+"Count",type:"USHORT",value:rt};for(var nt=0;nt<_e.length;nt++)it[nt+1]={name:tt+nt,type:"USHORT",value:_e[nt]};return it}function tableList(tt,_e,rt){var it=_e.length,nt=new Array(it+1);nt[0]={name:tt+"Count",type:"USHORT",value:it};for(var st=0;st<it;st++)nt[st+1]={name:tt+st,type:"TABLE",value:rt(_e[st],st)};return nt}function recordList(tt,_e,rt){var it=_e.length,nt=[];nt[0]={name:tt+"Count",type:"USHORT",value:it};for(var st=0;st<it;st++)nt=nt.concat(rt(_e[st],st));return nt}function Coverage(tt){tt.format===1?Table.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(ushortList("glyph",tt.glyphs))):tt.format===2?Table.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(recordList("rangeRecord",tt.ranges,function(_e){return[{name:"startGlyphID",type:"USHORT",value:_e.start},{name:"endGlyphID",type:"USHORT",value:_e.end},{name:"startCoverageIndex",type:"USHORT",value:_e.index}]}))):check.assert(!1,"Coverage format must be 1 or 2.")}Coverage.prototype=Object.create(Table.prototype);Coverage.prototype.constructor=Coverage;function ScriptList(tt){Table.call(this,"scriptListTable",recordList("scriptRecord",tt,function(_e,rt){var it=_e.script,nt=it.defaultLangSys;return check.assert(!!nt,"Unable to write GSUB: script "+_e.tag+" has no default language system."),[{name:"scriptTag"+rt,type:"TAG",value:_e.tag},{name:"script"+rt,type:"TABLE",value:new Table("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Table("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:nt.reqFeatureIndex}].concat(ushortList("featureIndex",nt.featureIndexes)))}].concat(recordList("langSys",it.langSysRecords,function(st,at){var lt=st.langSys;return[{name:"langSysTag"+at,type:"TAG",value:st.tag},{name:"langSys"+at,type:"TABLE",value:new Table("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:lt.reqFeatureIndex}].concat(ushortList("featureIndex",lt.featureIndexes)))}]})))}]}))}ScriptList.prototype=Object.create(Table.prototype);ScriptList.prototype.constructor=ScriptList;function FeatureList(tt){Table.call(this,"featureListTable",recordList("featureRecord",tt,function(_e,rt){var it=_e.feature;return[{name:"featureTag"+rt,type:"TAG",value:_e.tag},{name:"feature"+rt,type:"TABLE",value:new Table("featureTable",[{name:"featureParams",type:"USHORT",value:it.featureParams}].concat(ushortList("lookupListIndex",it.lookupListIndexes)))}]}))}FeatureList.prototype=Object.create(Table.prototype);FeatureList.prototype.constructor=FeatureList;function LookupList(tt,_e){Table.call(this,"lookupListTable",tableList("lookup",tt,function(rt){var it=_e[rt.lookupType];return check.assert(!!it,"Unable to write GSUB lookup type "+rt.lookupType+" tables."),new Table("lookupTable",[{name:"lookupType",type:"USHORT",value:rt.lookupType},{name:"lookupFlag",type:"USHORT",value:rt.lookupFlag}].concat(tableList("subtable",rt.subtables,it)))}))}LookupList.prototype=Object.create(Table.prototype);LookupList.prototype.constructor=LookupList;var table={Table,Record:Table,Coverage,ScriptList,FeatureList,LookupList,ushortList,tableList,recordList};function getByte(tt,_e){return tt.getUint8(_e)}function getUShort(tt,_e){return tt.getUint16(_e,!1)}function getShort(tt,_e){return tt.getInt16(_e,!1)}function getULong(tt,_e){return tt.getUint32(_e,!1)}function getFixed(tt,_e){var rt=tt.getInt16(_e,!1),it=tt.getUint16(_e+2,!1);return rt+it/65535}function getTag$2(tt,_e){for(var rt="",it=_e;it<_e+4;it+=1)rt+=String.fromCharCode(tt.getInt8(it));return rt}function getOffset(tt,_e,rt){for(var it=0,nt=0;nt<rt;nt+=1)it<<=8,it+=tt.getUint8(_e+nt);return it}function getBytes(tt,_e,rt){for(var it=[],nt=_e;nt<rt;nt+=1)it.push(tt.getUint8(nt));return it}function bytesToString(tt){for(var _e="",rt=0;rt<tt.length;rt+=1)_e+=String.fromCharCode(tt[rt]);return _e}var typeOffsets={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Parser$1(tt,_e){this.data=tt,this.offset=_e,this.relativeOffset=0}Parser$1.prototype.parseByte=function(){var tt=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,tt};Parser$1.prototype.parseChar=function(){var tt=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,tt};Parser$1.prototype.parseCard8=Parser$1.prototype.parseByte;Parser$1.prototype.parseUShort=function(){var tt=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,tt};Parser$1.prototype.parseCard16=Parser$1.prototype.parseUShort;Parser$1.prototype.parseSID=Parser$1.prototype.parseUShort;Parser$1.prototype.parseOffset16=Parser$1.prototype.parseUShort;Parser$1.prototype.parseShort=function(){var tt=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,tt};Parser$1.prototype.parseF2Dot14=function(){var tt=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,tt};Parser$1.prototype.parseULong=function(){var tt=getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,tt};Parser$1.prototype.parseOffset32=Parser$1.prototype.parseULong;Parser$1.prototype.parseFixed=function(){var tt=getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,tt};Parser$1.prototype.parseString=function(tt){var _e=this.data,rt=this.offset+this.relativeOffset,it="";this.relativeOffset+=tt;for(var nt=0;nt<tt;nt++)it+=String.fromCharCode(_e.getUint8(rt+nt));return it};Parser$1.prototype.parseTag=function(){return this.parseString(4)};Parser$1.prototype.parseLongDateTime=function(){var tt=getULong(this.data,this.offset+this.relativeOffset+4);return tt-=2082844800,this.relativeOffset+=8,tt};Parser$1.prototype.parseVersion=function(tt){var _e=getUShort(this.data,this.offset+this.relativeOffset),rt=getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,tt===void 0&&(tt=4096),_e+rt/tt/10};Parser$1.prototype.skip=function(tt,_e){_e===void 0&&(_e=1),this.relativeOffset+=typeOffsets[tt]*_e};Parser$1.prototype.parseULongList=function(tt){tt===void 0&&(tt=this.parseULong());for(var _e=new Array(tt),rt=this.data,it=this.offset+this.relativeOffset,nt=0;nt<tt;nt++)_e[nt]=rt.getUint32(it),it+=4;return this.relativeOffset+=tt*4,_e};Parser$1.prototype.parseOffset16List=Parser$1.prototype.parseUShortList=function(tt){tt===void 0&&(tt=this.parseUShort());for(var _e=new Array(tt),rt=this.data,it=this.offset+this.relativeOffset,nt=0;nt<tt;nt++)_e[nt]=rt.getUint16(it),it+=2;return this.relativeOffset+=tt*2,_e};Parser$1.prototype.parseShortList=function(tt){for(var _e=new Array(tt),rt=this.data,it=this.offset+this.relativeOffset,nt=0;nt<tt;nt++)_e[nt]=rt.getInt16(it),it+=2;return this.relativeOffset+=tt*2,_e};Parser$1.prototype.parseByteList=function(tt){for(var _e=new Array(tt),rt=this.data,it=this.offset+this.relativeOffset,nt=0;nt<tt;nt++)_e[nt]=rt.getUint8(it++);return this.relativeOffset+=tt,_e};Parser$1.prototype.parseList=function(tt,_e){_e||(_e=tt,tt=this.parseUShort());for(var rt=new Array(tt),it=0;it<tt;it++)rt[it]=_e.call(this);return rt};Parser$1.prototype.parseList32=function(tt,_e){_e||(_e=tt,tt=this.parseULong());for(var rt=new Array(tt),it=0;it<tt;it++)rt[it]=_e.call(this);return rt};Parser$1.prototype.parseRecordList=function(tt,_e){_e||(_e=tt,tt=this.parseUShort());for(var rt=new Array(tt),it=Object.keys(_e),nt=0;nt<tt;nt++){for(var st={},at=0;at<it.length;at++){var lt=it[at],ot=_e[lt];st[lt]=ot.call(this)}rt[nt]=st}return rt};Parser$1.prototype.parseRecordList32=function(tt,_e){_e||(_e=tt,tt=this.parseULong());for(var rt=new Array(tt),it=Object.keys(_e),nt=0;nt<tt;nt++){for(var st={},at=0;at<it.length;at++){var lt=it[at],ot=_e[lt];st[lt]=ot.call(this)}rt[nt]=st}return rt};Parser$1.prototype.parseStruct=function(tt){if(typeof tt=="function")return tt.call(this);for(var _e=Object.keys(tt),rt={},it=0;it<_e.length;it++){var nt=_e[it],st=tt[nt];rt[nt]=st.call(this)}return rt};Parser$1.prototype.parseValueRecord=function(tt){if(tt===void 0&&(tt=this.parseUShort()),tt!==0){var _e={};return tt&1&&(_e.xPlacement=this.parseShort()),tt&2&&(_e.yPlacement=this.parseShort()),tt&4&&(_e.xAdvance=this.parseShort()),tt&8&&(_e.yAdvance=this.parseShort()),tt&16&&(_e.xPlaDevice=void 0,this.parseShort()),tt&32&&(_e.yPlaDevice=void 0,this.parseShort()),tt&64&&(_e.xAdvDevice=void 0,this.parseShort()),tt&128&&(_e.yAdvDevice=void 0,this.parseShort()),_e}};Parser$1.prototype.parseValueRecordList=function(){for(var tt=this.parseUShort(),_e=this.parseUShort(),rt=new Array(_e),it=0;it<_e;it++)rt[it]=this.parseValueRecord(tt);return rt};Parser$1.prototype.parsePointer=function(tt){var _e=this.parseOffset16();if(_e>0)return new Parser$1(this.data,this.offset+_e).parseStruct(tt)};Parser$1.prototype.parsePointer32=function(tt){var _e=this.parseOffset32();if(_e>0)return new Parser$1(this.data,this.offset+_e).parseStruct(tt)};Parser$1.prototype.parseListOfLists=function(tt){for(var _e=this.parseOffset16List(),rt=_e.length,it=this.relativeOffset,nt=new Array(rt),st=0;st<rt;st++){var at=_e[st];if(at===0){nt[st]=void 0;continue}if(this.relativeOffset=at,tt){for(var lt=this.parseOffset16List(),ot=new Array(lt.length),ct=0;ct<lt.length;ct++)this.relativeOffset=at+lt[ct],ot[ct]=tt.call(this);nt[st]=ot}else nt[st]=this.parseUShortList()}return this.relativeOffset=it,nt};Parser$1.prototype.parseCoverage=function(){var tt=this.offset+this.relativeOffset,_e=this.parseUShort(),rt=this.parseUShort();if(_e===1)return{format:1,glyphs:this.parseUShortList(rt)};if(_e===2){for(var it=new Array(rt),nt=0;nt<rt;nt++)it[nt]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:it}}throw new Error("0x"+tt.toString(16)+": Coverage format must be 1 or 2.")};Parser$1.prototype.parseClassDef=function(){var tt=this.offset+this.relativeOffset,_e=this.parseUShort();if(_e===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(_e===2)return{format:2,ranges:this.parseRecordList({start:Parser$1.uShort,end:Parser$1.uShort,classId:Parser$1.uShort})};throw new Error("0x"+tt.toString(16)+": ClassDef format must be 1 or 2.")};Parser$1.list=function(tt,_e){return function(){return this.parseList(tt,_e)}};Parser$1.list32=function(tt,_e){return function(){return this.parseList32(tt,_e)}};Parser$1.recordList=function(tt,_e){return function(){return this.parseRecordList(tt,_e)}};Parser$1.recordList32=function(tt,_e){return function(){return this.parseRecordList32(tt,_e)}};Parser$1.pointer=function(tt){return function(){return this.parsePointer(tt)}};Parser$1.pointer32=function(tt){return function(){return this.parsePointer32(tt)}};Parser$1.tag=Parser$1.prototype.parseTag;Parser$1.byte=Parser$1.prototype.parseByte;Parser$1.uShort=Parser$1.offset16=Parser$1.prototype.parseUShort;Parser$1.uShortList=Parser$1.prototype.parseUShortList;Parser$1.uLong=Parser$1.offset32=Parser$1.prototype.parseULong;Parser$1.uLongList=Parser$1.prototype.parseULongList;Parser$1.struct=Parser$1.prototype.parseStruct;Parser$1.coverage=Parser$1.prototype.parseCoverage;Parser$1.classDef=Parser$1.prototype.parseClassDef;var langSysTable={reserved:Parser$1.uShort,reqFeatureIndex:Parser$1.uShort,featureIndexes:Parser$1.uShortList};Parser$1.prototype.parseScriptList=function(){return this.parsePointer(Parser$1.recordList({tag:Parser$1.tag,script:Parser$1.pointer({defaultLangSys:Parser$1.pointer(langSysTable),langSysRecords:Parser$1.recordList({tag:Parser$1.tag,langSys:Parser$1.pointer(langSysTable)})})}))||[]};Parser$1.prototype.parseFeatureList=function(){return this.parsePointer(Parser$1.recordList({tag:Parser$1.tag,feature:Parser$1.pointer({featureParams:Parser$1.offset16,lookupListIndexes:Parser$1.uShortList})}))||[]};Parser$1.prototype.parseLookupList=function(tt){return this.parsePointer(Parser$1.list(Parser$1.pointer(function(){var _e=this.parseUShort();check.argument(1<=_e&&_e<=9,"GPOS/GSUB lookup type "+_e+" unknown.");var rt=this.parseUShort(),it=rt&16;return{lookupType:_e,lookupFlag:rt,subtables:this.parseList(Parser$1.pointer(tt[_e])),markFilteringSet:it?this.parseUShort():void 0}})))||[]};Parser$1.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var tt=this.parseUShort(),_e=this.parseUShort();check.argument(tt===1&&_e<1,"GPOS/GSUB feature variations table unknown.");var rt=this.parseRecordList32({conditionSetOffset:Parser$1.offset32,featureTableSubstitutionOffset:Parser$1.offset32});return rt})||[]};var parse$2={getByte,getCard8:getByte,getUShort,getCard16:getUShort,getShort,getULong,getFixed,getTag:getTag$2,getOffset,getBytes,bytesToString,Parser:Parser$1};function parseCmapTableFormat12(tt,_e){_e.parseUShort(),tt.length=_e.parseULong(),tt.language=_e.parseULong();var rt;tt.groupCount=rt=_e.parseULong(),tt.glyphIndexMap={};for(var it=0;it<rt;it+=1)for(var nt=_e.parseULong(),st=_e.parseULong(),at=_e.parseULong(),lt=nt;lt<=st;lt+=1)tt.glyphIndexMap[lt]=at,at++}function parseCmapTableFormat4(tt,_e,rt,it,nt){tt.length=_e.parseUShort(),tt.language=_e.parseUShort();var st;tt.segCount=st=_e.parseUShort()>>1,_e.skip("uShort",3),tt.glyphIndexMap={};for(var at=new parse$2.Parser(rt,it+nt+14),lt=new parse$2.Parser(rt,it+nt+16+st*2),ot=new parse$2.Parser(rt,it+nt+16+st*4),ct=new parse$2.Parser(rt,it+nt+16+st*6),ut=it+nt+16+st*8,ht=0;ht<st-1;ht+=1)for(var dt=void 0,pt=at.parseUShort(),ft=lt.parseUShort(),gt=ot.parseShort(),mt=ct.parseUShort(),At=ft;At<=pt;At+=1)mt!==0?(ut=ct.offset+ct.relativeOffset-2,ut+=mt,ut+=(At-ft)*2,dt=parse$2.getUShort(rt,ut),dt!==0&&(dt=dt+gt&65535)):dt=At+gt&65535,tt.glyphIndexMap[At]=dt}function parseCmapTable(tt,_e){var rt={};rt.version=parse$2.getUShort(tt,_e),check.argument(rt.version===0,"cmap table version should be 0."),rt.numTables=parse$2.getUShort(tt,_e+2);for(var it=-1,nt=rt.numTables-1;nt>=0;nt-=1){var st=parse$2.getUShort(tt,_e+4+nt*8),at=parse$2.getUShort(tt,_e+4+nt*8+2);if(st===3&&(at===0||at===1||at===10)||st===0&&(at===0||at===1||at===2||at===3||at===4)){it=parse$2.getULong(tt,_e+4+nt*8+4);break}}if(it===-1)throw new Error("No valid cmap sub-tables found.");var lt=new parse$2.Parser(tt,_e+it);if(rt.format=lt.parseUShort(),rt.format===12)parseCmapTableFormat12(rt,lt);else if(rt.format===4)parseCmapTableFormat4(rt,lt,tt,_e,it);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+rt.format+").");return rt}function addSegment(tt,_e,rt){tt.segments.push({end:_e,start:_e,delta:-(_e-rt),offset:0,glyphIndex:rt})}function addTerminatorSegment(tt){tt.segments.push({end:65535,start:65535,delta:1,offset:0})}function makeCmapTable(tt){var _e=!0,rt;for(rt=tt.length-1;rt>0;rt-=1){var it=tt.get(rt);if(it.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),_e=!1;break}}var nt=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:_e?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:_e?12:12+8}];_e||(nt=nt.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),nt=nt.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var st=new table.Table("cmap",nt);for(st.segments=[],rt=0;rt<tt.length;rt+=1){for(var at=tt.get(rt),lt=0;lt<at.unicodes.length;lt+=1)addSegment(st,at.unicodes[lt],rt);st.segments=st.segments.sort(function(yt,bt){return yt.start-bt.start})}addTerminatorSegment(st);var ot=st.segments.length,ct=0,ut=[],ht=[],dt=[],pt=[],ft=[],gt=[];for(rt=0;rt<ot;rt+=1){var mt=st.segments[rt];mt.end<=65535&&mt.start<=65535?(ut=ut.concat({name:"end_"+rt,type:"USHORT",value:mt.end}),ht=ht.concat({name:"start_"+rt,type:"USHORT",value:mt.start}),dt=dt.concat({name:"idDelta_"+rt,type:"SHORT",value:mt.delta}),pt=pt.concat({name:"idRangeOffset_"+rt,type:"USHORT",value:mt.offset}),mt.glyphId!==void 0&&(ft=ft.concat({name:"glyph_"+rt,type:"USHORT",value:mt.glyphId}))):ct+=1,!_e&&mt.glyphIndex!==void 0&&(gt=gt.concat({name:"cmap12Start_"+rt,type:"ULONG",value:mt.start}),gt=gt.concat({name:"cmap12End_"+rt,type:"ULONG",value:mt.end}),gt=gt.concat({name:"cmap12Glyph_"+rt,type:"ULONG",value:mt.glyphIndex}))}if(st.segCountX2=(ot-ct)*2,st.searchRange=Math.pow(2,Math.floor(Math.log(ot-ct)/Math.log(2)))*2,st.entrySelector=Math.log(st.searchRange/2)/Math.log(2),st.rangeShift=st.segCountX2-st.searchRange,st.fields=st.fields.concat(ut),st.fields.push({name:"reservedPad",type:"USHORT",value:0}),st.fields=st.fields.concat(ht),st.fields=st.fields.concat(dt),st.fields=st.fields.concat(pt),st.fields=st.fields.concat(ft),st.cmap4Length=14+ut.length*2+2+ht.length*2+dt.length*2+pt.length*2+ft.length*2,!_e){var At=16+gt.length*4;st.cmap12Offset=12+2*2+4+st.cmap4Length,st.fields=st.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:At},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:gt.length/3}]),st.fields=st.fields.concat(gt)}return st}var cmap={parse:parseCmapTable,make:makeCmapTable},cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function DefaultEncoding(tt){this.font=tt}DefaultEncoding.prototype.charToGlyphIndex=function(tt){var _e=tt.codePointAt(0),rt=this.font.glyphs;if(rt){for(var it=0;it<rt.length;it+=1)for(var nt=rt.get(it),st=0;st<nt.unicodes.length;st+=1)if(nt.unicodes[st]===_e)return it}return null};function CffEncoding(tt,_e){this.encoding=tt,this.charset=_e}CffEncoding.prototype.charToGlyphIndex=function(tt){var _e=tt.codePointAt(0),rt=this.encoding[_e];return this.charset.indexOf(rt)};function line(tt,_e,rt,it,nt){tt.beginPath(),tt.moveTo(_e,rt),tt.lineTo(it,nt),tt.stroke()}var draw={line};function getPathDefinition(tt,_e){var rt=_e||new Path;return{configurable:!0,get:function(){return typeof rt=="function"&&(rt=rt()),rt},set:function(it){rt=it}}}function Glyph(tt){this.bindConstructorValues(tt)}Glyph.prototype.bindConstructorValues=function(tt){this.index=tt.index||0,this.name=tt.name||null,this.unicode=tt.unicode||void 0,this.unicodes=tt.unicodes||tt.unicode!==void 0?[tt.unicode]:[],"xMin"in tt&&(this.xMin=tt.xMin),"yMin"in tt&&(this.yMin=tt.yMin),"xMax"in tt&&(this.xMax=tt.xMax),"yMax"in tt&&(this.yMax=tt.yMax),"advanceWidth"in tt&&(this.advanceWidth=tt.advanceWidth),Object.defineProperty(this,"path",getPathDefinition(this,tt.path))};Glyph.prototype.addUnicode=function(tt){this.unicodes.length===0&&(this.unicode=tt),this.unicodes.push(tt)};Glyph.prototype.getBoundingBox=function(){return this.path.getBoundingBox()};Glyph.prototype.getPath=function(tt,_e,rt,it,nt){tt=tt!==void 0?tt:0,_e=_e!==void 0?_e:0,rt=rt!==void 0?rt:72;var st,at;it||(it={});var lt=it.xScale,ot=it.yScale;if(it.hinting&&nt&&nt.hinting&&(at=this.path&&nt.hinting.exec(this,rt)),at)st=nt.hinting.getCommands(at),tt=Math.round(tt),_e=Math.round(_e),lt=ot=1;else{st=this.path.commands;var ct=1/(this.path.unitsPerEm||1e3)*rt;lt===void 0&&(lt=ct),ot===void 0&&(ot=ct)}for(var ut=new Path,ht=0;ht<st.length;ht+=1){var dt=st[ht];dt.type==="M"?ut.moveTo(tt+dt.x*lt,_e+-dt.y*ot):dt.type==="L"?ut.lineTo(tt+dt.x*lt,_e+-dt.y*ot):dt.type==="Q"?ut.quadraticCurveTo(tt+dt.x1*lt,_e+-dt.y1*ot,tt+dt.x*lt,_e+-dt.y*ot):dt.type==="C"?ut.curveTo(tt+dt.x1*lt,_e+-dt.y1*ot,tt+dt.x2*lt,_e+-dt.y2*ot,tt+dt.x*lt,_e+-dt.y*ot):dt.type==="Z"&&ut.closePath()}return ut};Glyph.prototype.getContours=function(){if(this.points===void 0)return[];for(var tt=[],_e=[],rt=0;rt<this.points.length;rt+=1){var it=this.points[rt];_e.push(it),it.lastPointOfContour&&(tt.push(_e),_e=[])}return check.argument(_e.length===0,"There are still points left in the current contour."),tt};Glyph.prototype.getMetrics=function(){for(var tt=this.path.commands,_e=[],rt=[],it=0;it<tt.length;it+=1){var nt=tt[it];nt.type!=="Z"&&(_e.push(nt.x),rt.push(nt.y)),(nt.type==="Q"||nt.type==="C")&&(_e.push(nt.x1),rt.push(nt.y1)),nt.type==="C"&&(_e.push(nt.x2),rt.push(nt.y2))}var st={xMin:Math.min.apply(null,_e),yMin:Math.min.apply(null,rt),xMax:Math.max.apply(null,_e),yMax:Math.max.apply(null,rt),leftSideBearing:this.leftSideBearing};return isFinite(st.xMin)||(st.xMin=0),isFinite(st.xMax)||(st.xMax=this.advanceWidth),isFinite(st.yMin)||(st.yMin=0),isFinite(st.yMax)||(st.yMax=0),st.rightSideBearing=this.advanceWidth-st.leftSideBearing-(st.xMax-st.xMin),st};Glyph.prototype.draw=function(tt,_e,rt,it,nt){this.getPath(_e,rt,it,nt).draw(tt)};Glyph.prototype.drawPoints=function(tt,_e,rt,it){function nt(ht,dt,pt,ft){tt.beginPath();for(var gt=0;gt<ht.length;gt+=1)tt.moveTo(dt+ht[gt].x*ft,pt+ht[gt].y*ft),tt.arc(dt+ht[gt].x*ft,pt+ht[gt].y*ft,2,0,Math.PI*2,!1);tt.closePath(),tt.fill()}_e=_e!==void 0?_e:0,rt=rt!==void 0?rt:0,it=it!==void 0?it:24;for(var st=1/this.path.unitsPerEm*it,at=[],lt=[],ot=this.path,ct=0;ct<ot.commands.length;ct+=1){var ut=ot.commands[ct];ut.x!==void 0&&at.push({x:ut.x,y:-ut.y}),ut.x1!==void 0&&lt.push({x:ut.x1,y:-ut.y1}),ut.x2!==void 0&&lt.push({x:ut.x2,y:-ut.y2})}tt.fillStyle="blue",nt(at,_e,rt,st),tt.fillStyle="red",nt(lt,_e,rt,st)};Glyph.prototype.drawMetrics=function(tt,_e,rt,it){var nt;_e=_e!==void 0?_e:0,rt=rt!==void 0?rt:0,it=it!==void 0?it:24,nt=1/this.path.unitsPerEm*it,tt.lineWidth=1,tt.strokeStyle="black",draw.line(tt,_e,-1e4,_e,1e4),draw.line(tt,-1e4,rt,1e4,rt);var st=this.xMin||0,at=this.yMin||0,lt=this.xMax||0,ot=this.yMax||0,ct=this.advanceWidth||0;tt.strokeStyle="blue",draw.line(tt,_e+st*nt,-1e4,_e+st*nt,1e4),draw.line(tt,_e+lt*nt,-1e4,_e+lt*nt,1e4),draw.line(tt,-1e4,rt+-at*nt,1e4,rt+-at*nt),draw.line(tt,-1e4,rt+-ot*nt,1e4,rt+-ot*nt),tt.strokeStyle="green",draw.line(tt,_e+ct*nt,-1e4,_e+ct*nt,1e4)};function defineDependentProperty(tt,_e,rt){Object.defineProperty(tt,_e,{get:function(){return tt.path,tt[rt]},set:function(it){tt[rt]=it},enumerable:!0,configurable:!0})}function GlyphSet(tt,_e){if(this.font=tt,this.glyphs={},Array.isArray(_e))for(var rt=0;rt<_e.length;rt++){var it=_e[rt];it.path.unitsPerEm=tt.unitsPerEm,this.glyphs[rt]=it}this.length=_e&&_e.length||0}GlyphSet.prototype.get=function(tt){if(this.glyphs[tt]===void 0){this.font._push(tt),typeof this.glyphs[tt]=="function"&&(this.glyphs[tt]=this.glyphs[tt]());var _e=this.glyphs[tt],rt=this.font._IndexToUnicodeMap[tt];if(rt)for(var it=0;it<rt.unicodes.length;it++)_e.addUnicode(rt.unicodes[it]);this.font.cffEncoding?this.font.isCIDFont?_e.name="gid"+tt:_e.name=this.font.cffEncoding.charset[tt]:this.font.glyphNames.names&&(_e.name=this.font.glyphNames.glyphIndexToName(tt)),this.glyphs[tt].advanceWidth=this.font._hmtxTableData[tt].advanceWidth,this.glyphs[tt].leftSideBearing=this.font._hmtxTableData[tt].leftSideBearing}else typeof this.glyphs[tt]=="function"&&(this.glyphs[tt]=this.glyphs[tt]());return this.glyphs[tt]};GlyphSet.prototype.push=function(tt,_e){this.glyphs[tt]=_e,this.length++};function glyphLoader(tt,_e){return new Glyph({index:_e,font:tt})}function ttfGlyphLoader(tt,_e,rt,it,nt,st){return function(){var at=new Glyph({index:_e,font:tt});return at.path=function(){rt(at,it,nt);var lt=st(tt.glyphs,at);return lt.unitsPerEm=tt.unitsPerEm,lt},defineDependentProperty(at,"xMin","_xMin"),defineDependentProperty(at,"xMax","_xMax"),defineDependentProperty(at,"yMin","_yMin"),defineDependentProperty(at,"yMax","_yMax"),at}}function cffGlyphLoader(tt,_e,rt,it){return function(){var nt=new Glyph({index:_e,font:tt});return nt.path=function(){var st=rt(tt,nt,it);return st.unitsPerEm=tt.unitsPerEm,st},nt}}var glyphset={GlyphSet,glyphLoader,ttfGlyphLoader,cffGlyphLoader};function equals(tt,_e){if(tt===_e)return!0;if(Array.isArray(tt)&&Array.isArray(_e)){if(tt.length!==_e.length)return!1;for(var rt=0;rt<tt.length;rt+=1)if(!equals(tt[rt],_e[rt]))return!1;return!0}else return!1}function calcCFFSubroutineBias(tt){var _e;return tt.length<1240?_e=107:tt.length<33900?_e=1131:_e=32768,_e}function parseCFFIndex(tt,_e,rt){var it=[],nt=[],st=parse$2.getCard16(tt,_e),at,lt;if(st!==0){var ot=parse$2.getByte(tt,_e+2);at=_e+(st+1)*ot+2;for(var ct=_e+3,ut=0;ut<st+1;ut+=1)it.push(parse$2.getOffset(tt,ct,ot)),ct+=ot;lt=at+it[st]}else lt=_e+2;for(var ht=0;ht<it.length-1;ht+=1){var dt=parse$2.getBytes(tt,at+it[ht],at+it[ht+1]);rt&&(dt=rt(dt)),nt.push(dt)}return{objects:nt,startOffset:_e,endOffset:lt}}function parseCFFIndexLowMemory(tt,_e){var rt=[],it=parse$2.getCard16(tt,_e),nt,st;if(it!==0){var at=parse$2.getByte(tt,_e+2);nt=_e+(it+1)*at+2;for(var lt=_e+3,ot=0;ot<it+1;ot+=1)rt.push(parse$2.getOffset(tt,lt,at)),lt+=at;st=nt+rt[it]}else st=_e+2;return{offsets:rt,startOffset:_e,endOffset:st}}function getCffIndexObject(tt,_e,rt,it,nt){var st=parse$2.getCard16(rt,it),at=0;if(st!==0){var lt=parse$2.getByte(rt,it+2);at=it+(st+1)*lt+2}var ot=parse$2.getBytes(rt,at+_e[tt],at+_e[tt+1]);return nt&&(ot=nt(ot)),ot}function parseFloatOperand(tt){for(var _e="",rt=15,it=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var nt=tt.parseByte(),st=nt>>4,at=nt&15;if(st===rt||(_e+=it[st],at===rt))break;_e+=it[at]}return parseFloat(_e)}function parseOperand(tt,_e){var rt,it,nt,st;if(_e===28)return rt=tt.parseByte(),it=tt.parseByte(),rt<<8|it;if(_e===29)return rt=tt.parseByte(),it=tt.parseByte(),nt=tt.parseByte(),st=tt.parseByte(),rt<<24|it<<16|nt<<8|st;if(_e===30)return parseFloatOperand(tt);if(_e>=32&&_e<=246)return _e-139;if(_e>=247&&_e<=250)return rt=tt.parseByte(),(_e-247)*256+rt+108;if(_e>=251&&_e<=254)return rt=tt.parseByte(),-(_e-251)*256-rt-108;throw new Error("Invalid b0 "+_e)}function entriesToObject(tt){for(var _e={},rt=0;rt<tt.length;rt+=1){var it=tt[rt][0],nt=tt[rt][1],st=void 0;if(nt.length===1?st=nt[0]:st=nt,_e.hasOwnProperty(it)&&!isNaN(_e[it]))throw new Error("Object "+_e+" already has key "+it);_e[it]=st}return _e}function parseCFFDict(tt,_e,rt){_e=_e!==void 0?_e:0;var it=new parse$2.Parser(tt,_e),nt=[],st=[];for(rt=rt!==void 0?rt:tt.length;it.relativeOffset<rt;){var at=it.parseByte();at<=21?(at===12&&(at=1200+it.parseByte()),nt.push([at,st]),st=[]):st.push(parseOperand(it,at))}return entriesToObject(nt)}function getCFFString(tt,_e){return _e<=390?_e=cffStandardStrings[_e]:_e=tt[_e-391],_e}function interpretDict(tt,_e,rt){for(var it={},nt,st=0;st<_e.length;st+=1){var at=_e[st];if(Array.isArray(at.type)){var lt=[];lt.length=at.type.length;for(var ot=0;ot<at.type.length;ot++)nt=tt[at.op]!==void 0?tt[at.op][ot]:void 0,nt===void 0&&(nt=at.value!==void 0&&at.value[ot]!==void 0?at.value[ot]:null),at.type[ot]==="SID"&&(nt=getCFFString(rt,nt)),lt[ot]=nt;it[at.name]=lt}else nt=tt[at.op],nt===void 0&&(nt=at.value!==void 0?at.value:null),at.type==="SID"&&(nt=getCFFString(rt,nt)),it[at.name]=nt}return it}function parseCFFHeader(tt,_e){var rt={};return rt.formatMajor=parse$2.getCard8(tt,_e),rt.formatMinor=parse$2.getCard8(tt,_e+1),rt.size=parse$2.getCard8(tt,_e+2),rt.offsetSize=parse$2.getCard8(tt,_e+3),rt.startOffset=_e,rt.endOffset=_e+4,rt}var TOP_DICT_META=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],PRIVATE_DICT_META=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function parseCFFTopDict(tt,_e){var rt=parseCFFDict(tt,0,tt.byteLength);return interpretDict(rt,TOP_DICT_META,_e)}function parseCFFPrivateDict(tt,_e,rt,it){var nt=parseCFFDict(tt,_e,rt);return interpretDict(nt,PRIVATE_DICT_META,it)}function gatherCFFTopDicts(tt,_e,rt,it){for(var nt=[],st=0;st<rt.length;st+=1){var at=new DataView(new Uint8Array(rt[st]).buffer),lt=parseCFFTopDict(at,it);lt._subrs=[],lt._subrsBias=0,lt._defaultWidthX=0,lt._nominalWidthX=0;var ot=lt.private[0],ct=lt.private[1];if(ot!==0&&ct!==0){var ut=parseCFFPrivateDict(tt,ct+_e,ot,it);if(lt._defaultWidthX=ut.defaultWidthX,lt._nominalWidthX=ut.nominalWidthX,ut.subrs!==0){var ht=ct+ut.subrs,dt=parseCFFIndex(tt,ht+_e);lt._subrs=dt.objects,lt._subrsBias=calcCFFSubroutineBias(lt._subrs)}lt._privateDict=ut}nt.push(lt)}return nt}function parseCFFCharset(tt,_e,rt,it){var nt,st,at=new parse$2.Parser(tt,_e);rt-=1;var lt=[".notdef"],ot=at.parseCard8();if(ot===0)for(var ct=0;ct<rt;ct+=1)nt=at.parseSID(),lt.push(getCFFString(it,nt));else if(ot===1)for(;lt.length<=rt;){nt=at.parseSID(),st=at.parseCard8();for(var ut=0;ut<=st;ut+=1)lt.push(getCFFString(it,nt)),nt+=1}else if(ot===2)for(;lt.length<=rt;){nt=at.parseSID(),st=at.parseCard16();for(var ht=0;ht<=st;ht+=1)lt.push(getCFFString(it,nt)),nt+=1}else throw new Error("Unknown charset format "+ot);return lt}function parseCFFEncoding(tt,_e,rt){var it,nt={},st=new parse$2.Parser(tt,_e),at=st.parseCard8();if(at===0)for(var lt=st.parseCard8(),ot=0;ot<lt;ot+=1)it=st.parseCard8(),nt[it]=ot;else if(at===1){var ct=st.parseCard8();it=1;for(var ut=0;ut<ct;ut+=1)for(var ht=st.parseCard8(),dt=st.parseCard8(),pt=ht;pt<=ht+dt;pt+=1)nt[pt]=it,it+=1}else throw new Error("Unknown encoding format "+at);return new CffEncoding(nt,rt)}function parseCFFCharstring(tt,_e,rt){var it,nt,st,at,lt=new Path,ot=[],ct=0,ut=!1,ht=!1,dt=0,pt=0,ft,gt,mt,At;if(tt.isCIDFont){var yt=tt.tables.cff.topDict._fdSelect[_e.index],bt=tt.tables.cff.topDict._fdArray[yt];ft=bt._subrs,gt=bt._subrsBias,mt=bt._defaultWidthX,At=bt._nominalWidthX}else ft=tt.tables.cff.topDict._subrs,gt=tt.tables.cff.topDict._subrsBias,mt=tt.tables.cff.topDict._defaultWidthX,At=tt.tables.cff.topDict._nominalWidthX;var xt=mt;function vt(St,Et){ht&&lt.closePath(),lt.moveTo(St,Et),ht=!0}function _t(){var St;St=ot.length%2!==0,St&&!ut&&(xt=ot.shift()+At),ct+=ot.length>>1,ot.length=0,ut=!0}function Ct(St){for(var Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft,Ut,$t=0;$t<St.length;){var Vt=St[$t];switch($t+=1,Vt){case 1:_t();break;case 3:_t();break;case 4:ot.length>1&&!ut&&(xt=ot.shift()+At,ut=!0),pt+=ot.pop(),vt(dt,pt);break;case 5:for(;ot.length>0;)dt+=ot.shift(),pt+=ot.shift(),lt.lineTo(dt,pt);break;case 6:for(;ot.length>0&&(dt+=ot.shift(),lt.lineTo(dt,pt),ot.length!==0);)pt+=ot.shift(),lt.lineTo(dt,pt);break;case 7:for(;ot.length>0&&(pt+=ot.shift(),lt.lineTo(dt,pt),ot.length!==0);)dt+=ot.shift(),lt.lineTo(dt,pt);break;case 8:for(;ot.length>0;)it=dt+ot.shift(),nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),dt=st+ot.shift(),pt=at+ot.shift(),lt.curveTo(it,nt,st,at,dt,pt);break;case 10:It=ot.pop()+gt,Ot=ft[It],Ot&&Ct(Ot);break;case 11:return;case 12:switch(Vt=St[$t],$t+=1,Vt){case 35:it=dt+ot.shift(),nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),Bt=st+ot.shift(),Nt=at+ot.shift(),zt=Bt+ot.shift(),Dt=Nt+ot.shift(),Ft=zt+ot.shift(),Ut=Dt+ot.shift(),dt=Ft+ot.shift(),pt=Ut+ot.shift(),ot.shift(),lt.curveTo(it,nt,st,at,Bt,Nt),lt.curveTo(zt,Dt,Ft,Ut,dt,pt);break;case 34:it=dt+ot.shift(),nt=pt,st=it+ot.shift(),at=nt+ot.shift(),Bt=st+ot.shift(),Nt=at,zt=Bt+ot.shift(),Dt=at,Ft=zt+ot.shift(),Ut=pt,dt=Ft+ot.shift(),lt.curveTo(it,nt,st,at,Bt,Nt),lt.curveTo(zt,Dt,Ft,Ut,dt,pt);break;case 36:it=dt+ot.shift(),nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),Bt=st+ot.shift(),Nt=at,zt=Bt+ot.shift(),Dt=at,Ft=zt+ot.shift(),Ut=Dt+ot.shift(),dt=Ft+ot.shift(),lt.curveTo(it,nt,st,at,Bt,Nt),lt.curveTo(zt,Dt,Ft,Ut,dt,pt);break;case 37:it=dt+ot.shift(),nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),Bt=st+ot.shift(),Nt=at+ot.shift(),zt=Bt+ot.shift(),Dt=Nt+ot.shift(),Ft=zt+ot.shift(),Ut=Dt+ot.shift(),Math.abs(Ft-dt)>Math.abs(Ut-pt)?dt=Ft+ot.shift():pt=Ut+ot.shift(),lt.curveTo(it,nt,st,at,Bt,Nt),lt.curveTo(zt,Dt,Ft,Ut,dt,pt);break;default:console.log("Glyph "+_e.index+": unknown operator 1200"+Vt),ot.length=0}break;case 14:ot.length>0&&!ut&&(xt=ot.shift()+At,ut=!0),ht&&(lt.closePath(),ht=!1);break;case 18:_t();break;case 19:case 20:_t(),$t+=ct+7>>3;break;case 21:ot.length>2&&!ut&&(xt=ot.shift()+At,ut=!0),pt+=ot.pop(),dt+=ot.pop(),vt(dt,pt);break;case 22:ot.length>1&&!ut&&(xt=ot.shift()+At,ut=!0),dt+=ot.pop(),vt(dt,pt);break;case 23:_t();break;case 24:for(;ot.length>2;)it=dt+ot.shift(),nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),dt=st+ot.shift(),pt=at+ot.shift(),lt.curveTo(it,nt,st,at,dt,pt);dt+=ot.shift(),pt+=ot.shift(),lt.lineTo(dt,pt);break;case 25:for(;ot.length>6;)dt+=ot.shift(),pt+=ot.shift(),lt.lineTo(dt,pt);it=dt+ot.shift(),nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),dt=st+ot.shift(),pt=at+ot.shift(),lt.curveTo(it,nt,st,at,dt,pt);break;case 26:for(ot.length%2&&(dt+=ot.shift());ot.length>0;)it=dt,nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),dt=st,pt=at+ot.shift(),lt.curveTo(it,nt,st,at,dt,pt);break;case 27:for(ot.length%2&&(pt+=ot.shift());ot.length>0;)it=dt+ot.shift(),nt=pt,st=it+ot.shift(),at=nt+ot.shift(),dt=st+ot.shift(),pt=at,lt.curveTo(it,nt,st,at,dt,pt);break;case 28:Et=St[$t],Tt=St[$t+1],ot.push((Et<<24|Tt<<16)>>16),$t+=2;break;case 29:It=ot.pop()+tt.gsubrsBias,Ot=tt.gsubrs[It],Ot&&Ct(Ot);break;case 30:for(;ot.length>0&&(it=dt,nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),dt=st+ot.shift(),pt=at+(ot.length===1?ot.shift():0),lt.curveTo(it,nt,st,at,dt,pt),ot.length!==0);)it=dt+ot.shift(),nt=pt,st=it+ot.shift(),at=nt+ot.shift(),pt=at+ot.shift(),dt=st+(ot.length===1?ot.shift():0),lt.curveTo(it,nt,st,at,dt,pt);break;case 31:for(;ot.length>0&&(it=dt+ot.shift(),nt=pt,st=it+ot.shift(),at=nt+ot.shift(),pt=at+ot.shift(),dt=st+(ot.length===1?ot.shift():0),lt.curveTo(it,nt,st,at,dt,pt),ot.length!==0);)it=dt,nt=pt+ot.shift(),st=it+ot.shift(),at=nt+ot.shift(),dt=st+ot.shift(),pt=at+(ot.length===1?ot.shift():0),lt.curveTo(it,nt,st,at,dt,pt);break;default:Vt<32?console.log("Glyph "+_e.index+": unknown operator "+Vt):Vt<247?ot.push(Vt-139):Vt<251?(Et=St[$t],$t+=1,ot.push((Vt-247)*256+Et+108)):Vt<255?(Et=St[$t],$t+=1,ot.push(-(Vt-251)*256-Et-108)):(Et=St[$t],Tt=St[$t+1],Mt=St[$t+2],Rt=St[$t+3],$t+=4,ot.push((Et<<24|Tt<<16|Mt<<8|Rt)/65536))}}}return Ct(rt),_e.advanceWidth=xt,lt}function parseCFFFDSelect(tt,_e,rt,it){var nt=[],st,at=new parse$2.Parser(tt,_e),lt=at.parseCard8();if(lt===0)for(var ot=0;ot<rt;ot++){if(st=at.parseCard8(),st>=it)throw new Error("CFF table CID Font FDSelect has bad FD index value "+st+" (FD count "+it+")");nt.push(st)}else if(lt===3){var ct=at.parseCard16(),ut=at.parseCard16();if(ut!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+ut);for(var ht,dt=0;dt<ct;dt++){if(st=at.parseCard8(),ht=at.parseCard16(),st>=it)throw new Error("CFF table CID Font FDSelect has bad FD index value "+st+" (FD count "+it+")");if(ht>rt)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+ht);for(;ut<ht;ut++)nt.push(st);ut=ht}if(ht!==rt)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+ht)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+lt);return nt}function parseCFFTable(tt,_e,rt,it){rt.tables.cff={};var nt=parseCFFHeader(tt,_e),st=parseCFFIndex(tt,nt.endOffset,parse$2.bytesToString),at=parseCFFIndex(tt,st.endOffset),lt=parseCFFIndex(tt,at.endOffset,parse$2.bytesToString),ot=parseCFFIndex(tt,lt.endOffset);rt.gsubrs=ot.objects,rt.gsubrsBias=calcCFFSubroutineBias(rt.gsubrs);var ct=gatherCFFTopDicts(tt,_e,at.objects,lt.objects);if(ct.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+ct.length);var ut=ct[0];if(rt.tables.cff.topDict=ut,ut._privateDict&&(rt.defaultWidthX=ut._privateDict.defaultWidthX,rt.nominalWidthX=ut._privateDict.nominalWidthX),ut.ros[0]!==void 0&&ut.ros[1]!==void 0&&(rt.isCIDFont=!0),rt.isCIDFont){var ht=ut.fdArray,dt=ut.fdSelect;if(ht===0||dt===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");ht+=_e;var pt=parseCFFIndex(tt,ht),ft=gatherCFFTopDicts(tt,_e,pt.objects,lt.objects);ut._fdArray=ft,dt+=_e,ut._fdSelect=parseCFFFDSelect(tt,dt,rt.numGlyphs,ft.length)}var gt=_e+ut.private[1],mt=parseCFFPrivateDict(tt,gt,ut.private[0],lt.objects);if(rt.defaultWidthX=mt.defaultWidthX,rt.nominalWidthX=mt.nominalWidthX,mt.subrs!==0){var At=gt+mt.subrs,yt=parseCFFIndex(tt,At);rt.subrs=yt.objects,rt.subrsBias=calcCFFSubroutineBias(rt.subrs)}else rt.subrs=[],rt.subrsBias=0;var bt;it.lowMemory?(bt=parseCFFIndexLowMemory(tt,_e+ut.charStrings),rt.nGlyphs=bt.offsets.length):(bt=parseCFFIndex(tt,_e+ut.charStrings),rt.nGlyphs=bt.objects.length);var xt=parseCFFCharset(tt,_e+ut.charset,rt.nGlyphs,lt.objects);if(ut.encoding===0?rt.cffEncoding=new CffEncoding(cffStandardEncoding,xt):ut.encoding===1?rt.cffEncoding=new CffEncoding(cffExpertEncoding,xt):rt.cffEncoding=parseCFFEncoding(tt,_e+ut.encoding,xt),rt.encoding=rt.encoding||rt.cffEncoding,rt.glyphs=new glyphset.GlyphSet(rt),it.lowMemory)rt._push=function(Ct){var St=getCffIndexObject(Ct,bt.offsets,tt,_e+ut.charStrings);rt.glyphs.push(Ct,glyphset.cffGlyphLoader(rt,Ct,parseCFFCharstring,St))};else for(var vt=0;vt<rt.nGlyphs;vt+=1){var _t=bt.objects[vt];rt.glyphs.push(vt,glyphset.cffGlyphLoader(rt,vt,parseCFFCharstring,_t))}}function encodeString(tt,_e){var rt,it=cffStandardStrings.indexOf(tt);return it>=0&&(rt=it),it=_e.indexOf(tt),it>=0?rt=it+cffStandardStrings.length:(rt=cffStandardStrings.length+_e.length,_e.push(tt)),rt}function makeHeader(){return new table.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function makeNameIndex(tt){var _e=new table.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);_e.names=[];for(var rt=0;rt<tt.length;rt+=1)_e.names.push({name:"name_"+rt,type:"NAME",value:tt[rt]});return _e}function makeDict(tt,_e,rt){for(var it={},nt=0;nt<tt.length;nt+=1){var st=tt[nt],at=_e[st.name];at!==void 0&&!equals(at,st.value)&&(st.type==="SID"&&(at=encodeString(at,rt)),it[st.op]={name:st.name,type:st.type,value:at})}return it}function makeTopDict(tt,_e){var rt=new table.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return rt.dict=makeDict(TOP_DICT_META,tt,_e),rt}function makeTopDictIndex(tt){var _e=new table.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return _e.topDicts=[{name:"topDict_0",type:"TABLE",value:tt}],_e}function makeStringIndex(tt){var _e=new table.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);_e.strings=[];for(var rt=0;rt<tt.length;rt+=1)_e.strings.push({name:"string_"+rt,type:"STRING",value:tt[rt]});return _e}function makeGlobalSubrIndex(){return new table.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function makeCharsets(tt,_e){for(var rt=new table.Record("Charsets",[{name:"format",type:"Card8",value:0}]),it=0;it<tt.length;it+=1){var nt=tt[it],st=encodeString(nt,_e);rt.fields.push({name:"glyph_"+it,type:"SID",value:st})}return rt}function glyphToOps(tt){var _e=[],rt=tt.path;_e.push({name:"width",type:"NUMBER",value:tt.advanceWidth});for(var it=0,nt=0,st=0;st<rt.commands.length;st+=1){var at=void 0,lt=void 0,ot=rt.commands[st];if(ot.type==="Q"){var ct=.3333333333333333,ut=2/3;ot={type:"C",x:ot.x,y:ot.y,x1:Math.round(ct*it+ut*ot.x1),y1:Math.round(ct*nt+ut*ot.y1),x2:Math.round(ct*ot.x+ut*ot.x1),y2:Math.round(ct*ot.y+ut*ot.y1)}}if(ot.type==="M")at=Math.round(ot.x-it),lt=Math.round(ot.y-nt),_e.push({name:"dx",type:"NUMBER",value:at}),_e.push({name:"dy",type:"NUMBER",value:lt}),_e.push({name:"rmoveto",type:"OP",value:21}),it=Math.round(ot.x),nt=Math.round(ot.y);else if(ot.type==="L")at=Math.round(ot.x-it),lt=Math.round(ot.y-nt),_e.push({name:"dx",type:"NUMBER",value:at}),_e.push({name:"dy",type:"NUMBER",value:lt}),_e.push({name:"rlineto",type:"OP",value:5}),it=Math.round(ot.x),nt=Math.round(ot.y);else if(ot.type==="C"){var ht=Math.round(ot.x1-it),dt=Math.round(ot.y1-nt),pt=Math.round(ot.x2-ot.x1),ft=Math.round(ot.y2-ot.y1);at=Math.round(ot.x-ot.x2),lt=Math.round(ot.y-ot.y2),_e.push({name:"dx1",type:"NUMBER",value:ht}),_e.push({name:"dy1",type:"NUMBER",value:dt}),_e.push({name:"dx2",type:"NUMBER",value:pt}),_e.push({name:"dy2",type:"NUMBER",value:ft}),_e.push({name:"dx",type:"NUMBER",value:at}),_e.push({name:"dy",type:"NUMBER",value:lt}),_e.push({name:"rrcurveto",type:"OP",value:8}),it=Math.round(ot.x),nt=Math.round(ot.y)}}return _e.push({name:"endchar",type:"OP",value:14}),_e}function makeCharStringsIndex(tt){for(var _e=new table.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),rt=0;rt<tt.length;rt+=1){var it=tt.get(rt),nt=glyphToOps(it);_e.charStrings.push({name:it.name,type:"CHARSTRING",value:nt})}return _e}function makePrivateDict(tt,_e){var rt=new table.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return rt.dict=makeDict(PRIVATE_DICT_META,tt,_e),rt}function makeCFFTable(tt,_e){for(var rt=new table.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),it=1/_e.unitsPerEm,nt={version:_e.version,fullName:_e.fullName,familyName:_e.familyName,weight:_e.weightName,fontBBox:_e.fontBBox||[0,0,0,0],fontMatrix:[it,0,0,it,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},st={},at=[],lt,ot=1;ot<tt.length;ot+=1)lt=tt.get(ot),at.push(lt.name);var ct=[];rt.header=makeHeader(),rt.nameIndex=makeNameIndex([_e.postScriptName]);var ut=makeTopDict(nt,ct);rt.topDictIndex=makeTopDictIndex(ut),rt.globalSubrIndex=makeGlobalSubrIndex(),rt.charsets=makeCharsets(at,ct),rt.charStringsIndex=makeCharStringsIndex(tt),rt.privateDict=makePrivateDict(st,ct),rt.stringIndex=makeStringIndex(ct);var ht=rt.header.sizeOf()+rt.nameIndex.sizeOf()+rt.topDictIndex.sizeOf()+rt.stringIndex.sizeOf()+rt.globalSubrIndex.sizeOf();return nt.charset=ht,nt.encoding=0,nt.charStrings=nt.charset+rt.charsets.sizeOf(),nt.private[1]=nt.charStrings+rt.charStringsIndex.sizeOf(),ut=makeTopDict(nt,ct),rt.topDictIndex=makeTopDictIndex(ut),rt}var cff={parse:parseCFFTable,make:makeCFFTable};function parseHeadTable(tt,_e){var rt={},it=new parse$2.Parser(tt,_e);return rt.version=it.parseVersion(),rt.fontRevision=Math.round(it.parseFixed()*1e3)/1e3,rt.checkSumAdjustment=it.parseULong(),rt.magicNumber=it.parseULong(),check.argument(rt.magicNumber===1594834165,"Font header has wrong magic number."),rt.flags=it.parseUShort(),rt.unitsPerEm=it.parseUShort(),rt.created=it.parseLongDateTime(),rt.modified=it.parseLongDateTime(),rt.xMin=it.parseShort(),rt.yMin=it.parseShort(),rt.xMax=it.parseShort(),rt.yMax=it.parseShort(),rt.macStyle=it.parseUShort(),rt.lowestRecPPEM=it.parseUShort(),rt.fontDirectionHint=it.parseShort(),rt.indexToLocFormat=it.parseShort(),rt.glyphDataFormat=it.parseShort(),rt}function makeHeadTable(tt){var _e=Math.round(new Date().getTime()/1e3)+2082844800,rt=_e;return tt.createdTimestamp&&(rt=tt.createdTimestamp+2082844800),new table.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:rt},{name:"modified",type:"LONGDATETIME",value:_e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],tt)}var head$1={parse:parseHeadTable,make:makeHeadTable};function parseHheaTable(tt,_e){var rt={},it=new parse$2.Parser(tt,_e);return rt.version=it.parseVersion(),rt.ascender=it.parseShort(),rt.descender=it.parseShort(),rt.lineGap=it.parseShort(),rt.advanceWidthMax=it.parseUShort(),rt.minLeftSideBearing=it.parseShort(),rt.minRightSideBearing=it.parseShort(),rt.xMaxExtent=it.parseShort(),rt.caretSlopeRise=it.parseShort(),rt.caretSlopeRun=it.parseShort(),rt.caretOffset=it.parseShort(),it.relativeOffset+=8,rt.metricDataFormat=it.parseShort(),rt.numberOfHMetrics=it.parseUShort(),rt}function makeHheaTable(tt){return new table.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],tt)}var hhea={parse:parseHheaTable,make:makeHheaTable};function parseHmtxTableAll(tt,_e,rt,it,nt){for(var st,at,lt=new parse$2.Parser(tt,_e),ot=0;ot<it;ot+=1){ot<rt&&(st=lt.parseUShort(),at=lt.parseShort());var ct=nt.get(ot);ct.advanceWidth=st,ct.leftSideBearing=at}}function parseHmtxTableOnLowMemory(tt,_e,rt,it,nt){tt._hmtxTableData={};for(var st,at,lt=new parse$2.Parser(_e,rt),ot=0;ot<nt;ot+=1)ot<it&&(st=lt.parseUShort(),at=lt.parseShort()),tt._hmtxTableData[ot]={advanceWidth:st,leftSideBearing:at}}function parseHmtxTable(tt,_e,rt,it,nt,st,at){at.lowMemory?parseHmtxTableOnLowMemory(tt,_e,rt,it,nt):parseHmtxTableAll(_e,rt,it,nt,st)}function makeHmtxTable(tt){for(var _e=new table.Table("hmtx",[]),rt=0;rt<tt.length;rt+=1){var it=tt.get(rt),nt=it.advanceWidth||0,st=it.leftSideBearing||0;_e.fields.push({name:"advanceWidth_"+rt,type:"USHORT",value:nt}),_e.fields.push({name:"leftSideBearing_"+rt,type:"SHORT",value:st})}return _e}var hmtx={parse:parseHmtxTable,make:makeHmtxTable};function makeLtagTable(tt){for(var _e=new table.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:tt.length}]),rt="",it=12+tt.length*4,nt=0;nt<tt.length;++nt){var st=rt.indexOf(tt[nt]);st<0&&(st=rt.length,rt+=tt[nt]),_e.fields.push({name:"offset "+nt,type:"USHORT",value:it+st}),_e.fields.push({name:"length "+nt,type:"USHORT",value:tt[nt].length})}return _e.fields.push({name:"stringPool",type:"CHARARRAY",value:rt}),_e}function parseLtagTable(tt,_e){var rt=new parse$2.Parser(tt,_e),it=rt.parseULong();check.argument(it===1,"Unsupported ltag table version."),rt.skip("uLong",1);for(var nt=rt.parseULong(),st=[],at=0;at<nt;at++){for(var lt="",ot=_e+rt.parseUShort(),ct=rt.parseUShort(),ut=ot;ut<ot+ct;++ut)lt+=String.fromCharCode(tt.getInt8(ut));st.push(lt)}return st}var ltag={make:makeLtagTable,parse:parseLtagTable};function parseMaxpTable(tt,_e){var rt={},it=new parse$2.Parser(tt,_e);return rt.version=it.parseVersion(),rt.numGlyphs=it.parseUShort(),rt.version===1&&(rt.maxPoints=it.parseUShort(),rt.maxContours=it.parseUShort(),rt.maxCompositePoints=it.parseUShort(),rt.maxCompositeContours=it.parseUShort(),rt.maxZones=it.parseUShort(),rt.maxTwilightPoints=it.parseUShort(),rt.maxStorage=it.parseUShort(),rt.maxFunctionDefs=it.parseUShort(),rt.maxInstructionDefs=it.parseUShort(),rt.maxStackElements=it.parseUShort(),rt.maxSizeOfInstructions=it.parseUShort(),rt.maxComponentElements=it.parseUShort(),rt.maxComponentDepth=it.parseUShort()),rt}function makeMaxpTable(tt){return new table.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:tt}])}var maxp={parse:parseMaxpTable,make:makeMaxpTable},nameTableNames=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],macLanguages={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},macLanguageToScript={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},windowsLanguages={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function getLanguageCode(tt,_e,rt){switch(tt){case 0:if(_e===65535)return"und";if(rt)return rt[_e];break;case 1:return macLanguages[_e];case 3:return windowsLanguages[_e]}}var utf16="utf-16",macScriptEncodings={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},macLanguageEncodings={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function getEncoding(tt,_e,rt){switch(tt){case 0:return utf16;case 1:return macLanguageEncodings[rt]||macScriptEncodings[_e];case 3:if(_e===1||_e===10)return utf16;break}}function parseNameTable(tt,_e,rt){for(var it={},nt=new parse$2.Parser(tt,_e),st=nt.parseUShort(),at=nt.parseUShort(),lt=nt.offset+nt.parseUShort(),ot=0;ot<at;ot++){var ct=nt.parseUShort(),ut=nt.parseUShort(),ht=nt.parseUShort(),dt=nt.parseUShort(),pt=nameTableNames[dt]||dt,ft=nt.parseUShort(),gt=nt.parseUShort(),mt=getLanguageCode(ct,ht,rt),At=getEncoding(ct,ut,ht);if(At!==void 0&&mt!==void 0){var yt=void 0;if(At===utf16?yt=decode.UTF16(tt,lt+gt,ft):yt=decode.MACSTRING(tt,lt+gt,ft,At),yt){var bt=it[pt];bt===void 0&&(bt=it[pt]={}),bt[mt]=yt}}}return st===1&&nt.parseUShort(),it}function reverseDict(tt){var _e={};for(var rt in tt)_e[tt[rt]]=parseInt(rt);return _e}function makeNameRecord(tt,_e,rt,it,nt,st){return new table.Record("NameRecord",[{name:"platformID",type:"USHORT",value:tt},{name:"encodingID",type:"USHORT",value:_e},{name:"languageID",type:"USHORT",value:rt},{name:"nameID",type:"USHORT",value:it},{name:"length",type:"USHORT",value:nt},{name:"offset",type:"USHORT",value:st}])}function findSubArray(tt,_e){var rt=tt.length,it=_e.length-rt+1;e:for(var nt=0;nt<it;nt++)for(;nt<it;nt++){for(var st=0;st<rt;st++)if(_e[nt+st]!==tt[st])continue e;return nt}return-1}function addStringToPool(tt,_e){var rt=findSubArray(tt,_e);if(rt<0){rt=_e.length;for(var it=0,nt=tt.length;it<nt;++it)_e.push(tt[it])}return rt}function makeNameTable(tt,_e){var rt,it=[],nt={},st=reverseDict(nameTableNames);for(var at in tt){var lt=st[at];if(lt===void 0&&(lt=at),rt=parseInt(lt),isNaN(rt))throw new Error('Name table entry "'+at+'" does not exist, see nameTableNames for complete list.');nt[rt]=tt[at],it.push(rt)}for(var ot=reverseDict(macLanguages),ct=reverseDict(windowsLanguages),ut=[],ht=[],dt=0;dt<it.length;dt++){rt=it[dt];var pt=nt[rt];for(var ft in pt){var gt=pt[ft],mt=1,At=ot[ft],yt=macLanguageToScript[At],bt=getEncoding(mt,yt,At),xt=encode.MACSTRING(gt,bt);xt===void 0&&(mt=0,At=_e.indexOf(ft),At<0&&(At=_e.length,_e.push(ft)),yt=4,xt=encode.UTF16(gt));var vt=addStringToPool(xt,ht);ut.push(makeNameRecord(mt,yt,At,rt,xt.length,vt));var _t=ct[ft];if(_t!==void 0){var Ct=encode.UTF16(gt),St=addStringToPool(Ct,ht);ut.push(makeNameRecord(3,1,_t,rt,Ct.length,St))}}}ut.sort(function(Mt,Rt){return Mt.platformID-Rt.platformID||Mt.encodingID-Rt.encodingID||Mt.languageID-Rt.languageID||Mt.nameID-Rt.nameID});for(var Et=new table.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:ut.length},{name:"stringOffset",type:"USHORT",value:6+ut.length*12}]),Tt=0;Tt<ut.length;Tt++)Et.fields.push({name:"record_"+Tt,type:"RECORD",value:ut[Tt]});return Et.fields.push({name:"strings",type:"LITERAL",value:ht}),Et}var _name={parse:parseNameTable,make:makeNameTable},unicodeRanges=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function getUnicodeRange(tt){for(var _e=0;_e<unicodeRanges.length;_e+=1){var rt=unicodeRanges[_e];if(tt>=rt.begin&&tt<rt.end)return _e}return-1}function parseOS2Table(tt,_e){var rt={},it=new parse$2.Parser(tt,_e);rt.version=it.parseUShort(),rt.xAvgCharWidth=it.parseShort(),rt.usWeightClass=it.parseUShort(),rt.usWidthClass=it.parseUShort(),rt.fsType=it.parseUShort(),rt.ySubscriptXSize=it.parseShort(),rt.ySubscriptYSize=it.parseShort(),rt.ySubscriptXOffset=it.parseShort(),rt.ySubscriptYOffset=it.parseShort(),rt.ySuperscriptXSize=it.parseShort(),rt.ySuperscriptYSize=it.parseShort(),rt.ySuperscriptXOffset=it.parseShort(),rt.ySuperscriptYOffset=it.parseShort(),rt.yStrikeoutSize=it.parseShort(),rt.yStrikeoutPosition=it.parseShort(),rt.sFamilyClass=it.parseShort(),rt.panose=[];for(var nt=0;nt<10;nt++)rt.panose[nt]=it.parseByte();return rt.ulUnicodeRange1=it.parseULong(),rt.ulUnicodeRange2=it.parseULong(),rt.ulUnicodeRange3=it.parseULong(),rt.ulUnicodeRange4=it.parseULong(),rt.achVendID=String.fromCharCode(it.parseByte(),it.parseByte(),it.parseByte(),it.parseByte()),rt.fsSelection=it.parseUShort(),rt.usFirstCharIndex=it.parseUShort(),rt.usLastCharIndex=it.parseUShort(),rt.sTypoAscender=it.parseShort(),rt.sTypoDescender=it.parseShort(),rt.sTypoLineGap=it.parseShort(),rt.usWinAscent=it.parseUShort(),rt.usWinDescent=it.parseUShort(),rt.version>=1&&(rt.ulCodePageRange1=it.parseULong(),rt.ulCodePageRange2=it.parseULong()),rt.version>=2&&(rt.sxHeight=it.parseShort(),rt.sCapHeight=it.parseShort(),rt.usDefaultChar=it.parseUShort(),rt.usBreakChar=it.parseUShort(),rt.usMaxContent=it.parseUShort()),rt}function makeOS2Table(tt){return new table.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],tt)}var os2={parse:parseOS2Table,make:makeOS2Table,unicodeRanges,getUnicodeRange};function parsePostTable(tt,_e){var rt={},it=new parse$2.Parser(tt,_e);switch(rt.version=it.parseVersion(),rt.italicAngle=it.parseFixed(),rt.underlinePosition=it.parseShort(),rt.underlineThickness=it.parseShort(),rt.isFixedPitch=it.parseULong(),rt.minMemType42=it.parseULong(),rt.maxMemType42=it.parseULong(),rt.minMemType1=it.parseULong(),rt.maxMemType1=it.parseULong(),rt.version){case 1:rt.names=standardNames.slice();break;case 2:rt.numberOfGlyphs=it.parseUShort(),rt.glyphNameIndex=new Array(rt.numberOfGlyphs);for(var nt=0;nt<rt.numberOfGlyphs;nt++)rt.glyphNameIndex[nt]=it.parseUShort();rt.names=[];for(var st=0;st<rt.numberOfGlyphs;st++)if(rt.glyphNameIndex[st]>=standardNames.length){var at=it.parseChar();rt.names.push(it.parseString(at))}break;case 2.5:rt.numberOfGlyphs=it.parseUShort(),rt.offset=new Array(rt.numberOfGlyphs);for(var lt=0;lt<rt.numberOfGlyphs;lt++)rt.offset[lt]=it.parseChar();break}return rt}function makePostTable(){return new table.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var post={parse:parsePostTable,make:makePostTable},subtableParsers=new Array(9);subtableParsers[1]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();if(rt===1)return{substFormat:1,coverage:this.parsePointer(Parser$1.coverage),deltaGlyphId:this.parseUShort()};if(rt===2)return{substFormat:2,coverage:this.parsePointer(Parser$1.coverage),substitute:this.parseOffset16List()};check.assert(!1,"0x"+_e.toString(16)+": lookup type 1 format must be 1 or 2.")};subtableParsers[2]=function(){var _e=this.parseUShort();return check.argument(_e===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:_e,coverage:this.parsePointer(Parser$1.coverage),sequences:this.parseListOfLists()}};subtableParsers[3]=function(){var _e=this.parseUShort();return check.argument(_e===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:_e,coverage:this.parsePointer(Parser$1.coverage),alternateSets:this.parseListOfLists()}};subtableParsers[4]=function(){var _e=this.parseUShort();return check.argument(_e===1,"GSUB ligature table identifier-format must be 1"),{substFormat:_e,coverage:this.parsePointer(Parser$1.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var lookupRecordDesc={sequenceIndex:Parser$1.uShort,lookupListIndex:Parser$1.uShort};subtableParsers[5]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();if(rt===1)return{substFormat:rt,coverage:this.parsePointer(Parser$1.coverage),ruleSets:this.parseListOfLists(function(){var st=this.parseUShort(),at=this.parseUShort();return{input:this.parseUShortList(st-1),lookupRecords:this.parseRecordList(at,lookupRecordDesc)}})};if(rt===2)return{substFormat:rt,coverage:this.parsePointer(Parser$1.coverage),classDef:this.parsePointer(Parser$1.classDef),classSets:this.parseListOfLists(function(){var st=this.parseUShort(),at=this.parseUShort();return{classes:this.parseUShortList(st-1),lookupRecords:this.parseRecordList(at,lookupRecordDesc)}})};if(rt===3){var it=this.parseUShort(),nt=this.parseUShort();return{substFormat:rt,coverages:this.parseList(it,Parser$1.pointer(Parser$1.coverage)),lookupRecords:this.parseRecordList(nt,lookupRecordDesc)}}check.assert(!1,"0x"+_e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")};subtableParsers[6]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();if(rt===1)return{substFormat:1,coverage:this.parsePointer(Parser$1.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)}})};if(rt===2)return{substFormat:2,coverage:this.parsePointer(Parser$1.coverage),backtrackClassDef:this.parsePointer(Parser$1.classDef),inputClassDef:this.parsePointer(Parser$1.classDef),lookaheadClassDef:this.parsePointer(Parser$1.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)}})};if(rt===3)return{substFormat:3,backtrackCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),inputCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),lookaheadCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),lookupRecords:this.parseRecordList(lookupRecordDesc)};check.assert(!1,"0x"+_e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")};subtableParsers[7]=function(){var _e=this.parseUShort();check.argument(_e===1,"GSUB Extension Substitution subtable identifier-format must be 1");var rt=this.parseUShort(),it=new Parser$1(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:rt,extension:subtableParsers[rt].call(it)}};subtableParsers[8]=function(){var _e=this.parseUShort();return check.argument(_e===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:_e,coverage:this.parsePointer(Parser$1.coverage),backtrackCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),lookaheadCoverage:this.parseList(Parser$1.pointer(Parser$1.coverage)),substitutes:this.parseUShortList()}};function parseGsubTable(tt,_e){_e=_e||0;var rt=new Parser$1(tt,_e),it=rt.parseVersion(1);return check.argument(it===1||it===1.1,"Unsupported GSUB table version."),it===1?{version:it,scripts:rt.parseScriptList(),features:rt.parseFeatureList(),lookups:rt.parseLookupList(subtableParsers)}:{version:it,scripts:rt.parseScriptList(),features:rt.parseFeatureList(),lookups:rt.parseLookupList(subtableParsers),variations:rt.parseFeatureVariationsList()}}var subtableMakers=new Array(9);subtableMakers[1]=function(_e){return _e.substFormat===1?new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:_e.deltaGlyphId}]):new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.ushortList("substitute",_e.substitute)))};subtableMakers[2]=function(_e){return check.assert(_e.substFormat===1,"Lookup type 2 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.tableList("seqSet",_e.sequences,function(rt){return new table.Table("sequenceSetTable",table.ushortList("sequence",rt))})))};subtableMakers[3]=function(_e){return check.assert(_e.substFormat===1,"Lookup type 3 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.tableList("altSet",_e.alternateSets,function(rt){return new table.Table("alternateSetTable",table.ushortList("alternate",rt))})))};subtableMakers[4]=function(_e){return check.assert(_e.substFormat===1,"Lookup type 4 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.tableList("ligSet",_e.ligatureSets,function(rt){return new table.Table("ligatureSetTable",table.tableList("ligature",rt,function(it){return new table.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:it.ligGlyph}].concat(table.ushortList("component",it.components,it.components.length+1)))}))})))};subtableMakers[6]=function(_e){if(_e.substFormat===1){var rt=new table.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:_e.substFormat},{name:"coverage",type:"TABLE",value:new table.Coverage(_e.coverage)}].concat(table.tableList("chainRuleSet",_e.chainRuleSets,function(st){return new table.Table("chainRuleSetTable",table.tableList("chainRule",st,function(at){var lt=table.ushortList("backtrackGlyph",at.backtrack,at.backtrack.length).concat(table.ushortList("inputGlyph",at.input,at.input.length+1)).concat(table.ushortList("lookaheadGlyph",at.lookahead,at.lookahead.length)).concat(table.ushortList("substitution",[],at.lookupRecords.length));return at.lookupRecords.forEach(function(ot,ct){lt=lt.concat({name:"sequenceIndex"+ct,type:"USHORT",value:ot.sequenceIndex}).concat({name:"lookupListIndex"+ct,type:"USHORT",value:ot.lookupListIndex})}),new table.Table("chainRuleTable",lt)}))})));return rt}else if(_e.substFormat===2)check.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(_e.substFormat===3){var it=[{name:"substFormat",type:"USHORT",value:_e.substFormat}];it.push({name:"backtrackGlyphCount",type:"USHORT",value:_e.backtrackCoverage.length}),_e.backtrackCoverage.forEach(function(st,at){it.push({name:"backtrackCoverage"+at,type:"TABLE",value:new table.Coverage(st)})}),it.push({name:"inputGlyphCount",type:"USHORT",value:_e.inputCoverage.length}),_e.inputCoverage.forEach(function(st,at){it.push({name:"inputCoverage"+at,type:"TABLE",value:new table.Coverage(st)})}),it.push({name:"lookaheadGlyphCount",type:"USHORT",value:_e.lookaheadCoverage.length}),_e.lookaheadCoverage.forEach(function(st,at){it.push({name:"lookaheadCoverage"+at,type:"TABLE",value:new table.Coverage(st)})}),it.push({name:"substitutionCount",type:"USHORT",value:_e.lookupRecords.length}),_e.lookupRecords.forEach(function(st,at){it=it.concat({name:"sequenceIndex"+at,type:"USHORT",value:st.sequenceIndex}).concat({name:"lookupListIndex"+at,type:"USHORT",value:st.lookupListIndex})});var nt=new table.Table("chainContextTable",it);return nt}check.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function makeGsubTable(tt){return new table.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new table.ScriptList(tt.scripts)},{name:"features",type:"TABLE",value:new table.FeatureList(tt.features)},{name:"lookups",type:"TABLE",value:new table.LookupList(tt.lookups,subtableMakers)}])}var gsub={parse:parseGsubTable,make:makeGsubTable};function parseMetaTable(tt,_e){var rt=new parse$2.Parser(tt,_e),it=rt.parseULong();check.argument(it===1,"Unsupported META table version."),rt.parseULong(),rt.parseULong();for(var nt=rt.parseULong(),st={},at=0;at<nt;at++){var lt=rt.parseTag(),ot=rt.parseULong(),ct=rt.parseULong(),ut=decode.UTF8(tt,_e+ot,ct);st[lt]=ut}return st}function makeMetaTable(tt){var _e=Object.keys(tt).length,rt="",it=16+_e*12,nt=new table.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:it},{name:"numTags",type:"ULONG",value:_e}]);for(var st in tt){var at=rt.length;rt+=tt[st],nt.fields.push({name:"tag "+st,type:"TAG",value:st}),nt.fields.push({name:"offset "+st,type:"ULONG",value:it+at}),nt.fields.push({name:"length "+st,type:"ULONG",value:tt[st].length})}return nt.fields.push({name:"stringPool",type:"CHARARRAY",value:rt}),nt}var meta={parse:parseMetaTable,make:makeMetaTable};function log2(tt){return Math.log(tt)/Math.log(2)|0}function computeCheckSum(tt){for(;tt.length%4!==0;)tt.push(0);for(var _e=0,rt=0;rt<tt.length;rt+=4)_e+=(tt[rt]<<24)+(tt[rt+1]<<16)+(tt[rt+2]<<8)+tt[rt+3];return _e%=Math.pow(2,32),_e}function makeTableRecord(tt,_e,rt,it){return new table.Record("Table Record",[{name:"tag",type:"TAG",value:tt!==void 0?tt:""},{name:"checkSum",type:"ULONG",value:_e!==void 0?_e:0},{name:"offset",type:"ULONG",value:rt!==void 0?rt:0},{name:"length",type:"ULONG",value:it!==void 0?it:0}])}function makeSfntTable(tt){var _e=new table.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);_e.tables=tt,_e.numTables=tt.length;var rt=Math.pow(2,log2(_e.numTables));_e.searchRange=16*rt,_e.entrySelector=log2(rt),_e.rangeShift=_e.numTables*16-_e.searchRange;for(var it=[],nt=[],st=_e.sizeOf()+makeTableRecord().sizeOf()*_e.numTables;st%4!==0;)st+=1,nt.push({name:"padding",type:"BYTE",value:0});for(var at=0;at<tt.length;at+=1){var lt=tt[at];check.argument(lt.tableName.length===4,"Table name"+lt.tableName+" is invalid.");var ot=lt.sizeOf(),ct=makeTableRecord(lt.tableName,computeCheckSum(lt.encode()),st,ot);for(it.push({name:ct.tag+" Table Record",type:"RECORD",value:ct}),nt.push({name:lt.tableName+" table",type:"RECORD",value:lt}),st+=ot,check.argument(!isNaN(st),"Something went wrong calculating the offset.");st%4!==0;)st+=1,nt.push({name:"padding",type:"BYTE",value:0})}return it.sort(function(ut,ht){return ut.value.tag>ht.value.tag?1:-1}),_e.fields=_e.fields.concat(it),_e.fields=_e.fields.concat(nt),_e}function metricsForChar(tt,_e,rt){for(var it=0;it<_e.length;it+=1){var nt=tt.charToGlyphIndex(_e[it]);if(nt>0){var st=tt.glyphs.get(nt);return st.getMetrics()}}return rt}function average(tt){for(var _e=0,rt=0;rt<tt.length;rt+=1)_e+=tt[rt];return _e/tt.length}function fontToSfntTable(tt){for(var _e=[],rt=[],it=[],nt=[],st=[],at=[],lt=[],ot,ct=0,ut=0,ht=0,dt=0,pt=0,ft=0;ft<tt.glyphs.length;ft+=1){var gt=tt.glyphs.get(ft),mt=gt.unicode|0;if(isNaN(gt.advanceWidth))throw new Error("Glyph "+gt.name+" ("+ft+"): advanceWidth is not a number.");(ot>mt||ot===void 0)&&mt>0&&(ot=mt),ct<mt&&(ct=mt);var At=os2.getUnicodeRange(mt);if(At<32)ut|=1<<At;else if(At<64)ht|=1<<At-32;else if(At<96)dt|=1<<At-64;else if(At<123)pt|=1<<At-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(gt.name!==".notdef"){var yt=gt.getMetrics();_e.push(yt.xMin),rt.push(yt.yMin),it.push(yt.xMax),nt.push(yt.yMax),at.push(yt.leftSideBearing),lt.push(yt.rightSideBearing),st.push(gt.advanceWidth)}}var bt={xMin:Math.min.apply(null,_e),yMin:Math.min.apply(null,rt),xMax:Math.max.apply(null,it),yMax:Math.max.apply(null,nt),advanceWidthMax:Math.max.apply(null,st),advanceWidthAvg:average(st),minLeftSideBearing:Math.min.apply(null,at),maxLeftSideBearing:Math.max.apply(null,at),minRightSideBearing:Math.min.apply(null,lt)};bt.ascender=tt.ascender,bt.descender=tt.descender;var xt=head$1.make({flags:3,unitsPerEm:tt.unitsPerEm,xMin:bt.xMin,yMin:bt.yMin,xMax:bt.xMax,yMax:bt.yMax,lowestRecPPEM:3,createdTimestamp:tt.createdTimestamp}),vt=hhea.make({ascender:bt.ascender,descender:bt.descender,advanceWidthMax:bt.advanceWidthMax,minLeftSideBearing:bt.minLeftSideBearing,minRightSideBearing:bt.minRightSideBearing,xMaxExtent:bt.maxLeftSideBearing+(bt.xMax-bt.xMin),numberOfHMetrics:tt.glyphs.length}),_t=maxp.make(tt.glyphs.length),Ct=os2.make(Object.assign({xAvgCharWidth:Math.round(bt.advanceWidthAvg),usFirstCharIndex:ot,usLastCharIndex:ct,ulUnicodeRange1:ut,ulUnicodeRange2:ht,ulUnicodeRange3:dt,ulUnicodeRange4:pt,sTypoAscender:bt.ascender,sTypoDescender:bt.descender,sTypoLineGap:0,usWinAscent:bt.yMax,usWinDescent:Math.abs(bt.yMin),ulCodePageRange1:1,sxHeight:metricsForChar(tt,"xyvw",{yMax:Math.round(bt.ascender/2)}).yMax,sCapHeight:metricsForChar(tt,"HIKLEFJMNTZBDPRAGOQSUVWXY",bt).yMax,usDefaultChar:tt.hasChar(" ")?32:0,usBreakChar:tt.hasChar(" ")?32:0},tt.tables.os2)),St=hmtx.make(tt.glyphs),Et=cmap.make(tt.glyphs),Tt=tt.getEnglishName("fontFamily"),Mt=tt.getEnglishName("fontSubfamily"),Rt=Tt+" "+Mt,It=tt.getEnglishName("postScriptName");It||(It=Tt.replace(/\s/g,"")+"-"+Mt);var Ot={};for(var Bt in tt.names)Ot[Bt]=tt.names[Bt];Ot.uniqueID||(Ot.uniqueID={en:tt.getEnglishName("manufacturer")+":"+Rt}),Ot.postScriptName||(Ot.postScriptName={en:It}),Ot.preferredFamily||(Ot.preferredFamily=tt.names.fontFamily),Ot.preferredSubfamily||(Ot.preferredSubfamily=tt.names.fontSubfamily);var Nt=[],zt=_name.make(Ot,Nt),Dt=Nt.length>0?ltag.make(Nt):void 0,Ft=post.make(),Ut=cff.make(tt.glyphs,{version:tt.getEnglishName("version"),fullName:Rt,familyName:Tt,weightName:Mt,postScriptName:It,unitsPerEm:tt.unitsPerEm,fontBBox:[0,bt.yMin,bt.ascender,bt.advanceWidthMax]}),$t=tt.metas&&Object.keys(tt.metas).length>0?meta.make(tt.metas):void 0,Vt=[xt,vt,_t,Ct,zt,Et,Ft,Ut,St];Dt&&Vt.push(Dt),tt.tables.gsub&&Vt.push(gsub.make(tt.tables.gsub)),$t&&Vt.push($t);for(var Zt=makeSfntTable(Vt),qt=Zt.encode(),sr=computeCheckSum(qt),er=Zt.fields,ir=!1,ur=0;ur<er.length;ur+=1)if(er[ur].name==="head table"){er[ur].value.checkSumAdjustment=2981146554-sr,ir=!0;break}if(!ir)throw new Error("Could not find head table with checkSum to adjust.");return Zt}var sfnt={make:makeSfntTable,fontToTable:fontToSfntTable,computeCheckSum};function searchTag(tt,_e){for(var rt=0,it=tt.length-1;rt<=it;){var nt=rt+it>>>1,st=tt[nt].tag;if(st===_e)return nt;st<_e?rt=nt+1:it=nt-1}return-rt-1}function binSearch(tt,_e){for(var rt=0,it=tt.length-1;rt<=it;){var nt=rt+it>>>1,st=tt[nt];if(st===_e)return nt;st<_e?rt=nt+1:it=nt-1}return-rt-1}function searchRange(tt,_e){for(var rt,it=0,nt=tt.length-1;it<=nt;){var st=it+nt>>>1;rt=tt[st];var at=rt.start;if(at===_e)return rt;at<_e?it=st+1:nt=st-1}if(it>0)return rt=tt[it-1],_e>rt.end?0:rt}function Layout(tt,_e){this.font=tt,this.tableName=_e}Layout.prototype={searchTag,binSearch,getTable:function(tt){var _e=this.font.tables[this.tableName];return!_e&&tt&&(_e=this.font.tables[this.tableName]=this.createDefaultTable()),_e},getScriptNames:function(){var tt=this.getTable();return tt?tt.scripts.map(function(_e){return _e.tag}):[]},getDefaultScriptName:function(){var tt=this.getTable();if(tt){for(var _e=!1,rt=0;rt<tt.scripts.length;rt++){var it=tt.scripts[rt].tag;if(it==="DFLT")return it;it==="latn"&&(_e=!0)}if(_e)return"latn"}},getScriptTable:function(tt,_e){var rt=this.getTable(_e);if(rt){tt=tt||"DFLT";var it=rt.scripts,nt=searchTag(rt.scripts,tt);if(nt>=0)return it[nt].script;if(_e){var st={tag:tt,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return it.splice(-1-nt,0,st),st.script}}},getLangSysTable:function(tt,_e,rt){var it=this.getScriptTable(tt,rt);if(it){if(!_e||_e==="dflt"||_e==="DFLT")return it.defaultLangSys;var nt=searchTag(it.langSysRecords,_e);if(nt>=0)return it.langSysRecords[nt].langSys;if(rt){var st={tag:_e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return it.langSysRecords.splice(-1-nt,0,st),st.langSys}}},getFeatureTable:function(tt,_e,rt,it){var nt=this.getLangSysTable(tt,_e,it);if(nt){for(var st,at=nt.featureIndexes,lt=this.font.tables[this.tableName].features,ot=0;ot<at.length;ot++)if(st=lt[at[ot]],st.tag===rt)return st.feature;if(it){var ct=lt.length;return check.assert(ct===0||rt>=lt[ct-1].tag,"Features must be added in alphabetical order."),st={tag:rt,feature:{params:0,lookupListIndexes:[]}},lt.push(st),at.push(ct),st.feature}}},getLookupTables:function(tt,_e,rt,it,nt){var st=this.getFeatureTable(tt,_e,rt,nt),at=[];if(st){for(var lt,ot=st.lookupListIndexes,ct=this.font.tables[this.tableName].lookups,ut=0;ut<ot.length;ut++)lt=ct[ot[ut]],lt.lookupType===it&&at.push(lt);if(at.length===0&&nt){lt={lookupType:it,lookupFlag:0,subtables:[],markFilteringSet:void 0};var ht=ct.length;return ct.push(lt),ot.push(ht),[lt]}}return at},getGlyphClass:function(tt,_e){switch(tt.format){case 1:return tt.startGlyph<=_e&&_e<tt.startGlyph+tt.classes.length?tt.classes[_e-tt.startGlyph]:0;case 2:var rt=searchRange(tt.ranges,_e);return rt?rt.classId:0}},getCoverageIndex:function(tt,_e){switch(tt.format){case 1:var rt=binSearch(tt.glyphs,_e);return rt>=0?rt:-1;case 2:var it=searchRange(tt.ranges,_e);return it?it.index+_e-it.start:-1}},expandCoverage:function(tt){if(tt.format===1)return tt.glyphs;for(var _e=[],rt=tt.ranges,it=0;it<rt.length;it++)for(var nt=rt[it],st=nt.start,at=nt.end,lt=st;lt<=at;lt++)_e.push(lt);return _e}};function Position(tt){Layout.call(this,tt,"gpos")}Position.prototype=Layout.prototype;Position.prototype.init=function(){var tt=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(tt)};Position.prototype.getKerningValue=function(tt,_e,rt){for(var it=0;it<tt.length;it++)for(var nt=tt[it].subtables,st=0;st<nt.length;st++){var at=nt[st],lt=this.getCoverageIndex(at.coverage,_e);if(!(lt<0))switch(at.posFormat){case 1:for(var ot=at.pairSets[lt],ct=0;ct<ot.length;ct++){var ut=ot[ct];if(ut.secondGlyph===rt)return ut.value1&&ut.value1.xAdvance||0}break;case 2:var ht=this.getGlyphClass(at.classDef1,_e),dt=this.getGlyphClass(at.classDef2,rt),pt=at.classRecords[ht][dt];return pt.value1&&pt.value1.xAdvance||0}}return 0};Position.prototype.getKerningTables=function(tt,_e){if(this.font.tables.gpos)return this.getLookupTables(tt,_e,"kern",2)};function Substitution(tt){Layout.call(this,tt,"gsub")}function arraysEqual(tt,_e){var rt=tt.length;if(rt!==_e.length)return!1;for(var it=0;it<rt;it++)if(tt[it]!==_e[it])return!1;return!0}function getSubstFormat(tt,_e,rt){for(var it=tt.subtables,nt=0;nt<it.length;nt++){var st=it[nt];if(st.substFormat===_e)return st}if(rt)return it.push(rt),rt}Substitution.prototype=Layout.prototype;Substitution.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}};Substitution.prototype.getSingle=function(tt,_e,rt){for(var it=[],nt=this.getLookupTables(_e,rt,tt,1),st=0;st<nt.length;st++)for(var at=nt[st].subtables,lt=0;lt<at.length;lt++){var ot=at[lt],ct=this.expandCoverage(ot.coverage),ut=void 0;if(ot.substFormat===1){var ht=ot.deltaGlyphId;for(ut=0;ut<ct.length;ut++){var dt=ct[ut];it.push({sub:dt,by:dt+ht})}}else{var pt=ot.substitute;for(ut=0;ut<ct.length;ut++)it.push({sub:ct[ut],by:pt[ut]})}}return it};Substitution.prototype.getMultiple=function(tt,_e,rt){for(var it=[],nt=this.getLookupTables(_e,rt,tt,2),st=0;st<nt.length;st++)for(var at=nt[st].subtables,lt=0;lt<at.length;lt++){var ot=at[lt],ct=this.expandCoverage(ot.coverage),ut=void 0;for(ut=0;ut<ct.length;ut++){var ht=ct[ut],dt=ot.sequences[ut];it.push({sub:ht,by:dt})}}return it};Substitution.prototype.getAlternates=function(tt,_e,rt){for(var it=[],nt=this.getLookupTables(_e,rt,tt,3),st=0;st<nt.length;st++)for(var at=nt[st].subtables,lt=0;lt<at.length;lt++)for(var ot=at[lt],ct=this.expandCoverage(ot.coverage),ut=ot.alternateSets,ht=0;ht<ct.length;ht++)it.push({sub:ct[ht],by:ut[ht]});return it};Substitution.prototype.getLigatures=function(tt,_e,rt){for(var it=[],nt=this.getLookupTables(_e,rt,tt,4),st=0;st<nt.length;st++)for(var at=nt[st].subtables,lt=0;lt<at.length;lt++)for(var ot=at[lt],ct=this.expandCoverage(ot.coverage),ut=ot.ligatureSets,ht=0;ht<ct.length;ht++)for(var dt=ct[ht],pt=ut[ht],ft=0;ft<pt.length;ft++){var gt=pt[ft];it.push({sub:[dt].concat(gt.components),by:gt.ligGlyph})}return it};Substitution.prototype.addSingle=function(tt,_e,rt,it){var nt=this.getLookupTables(rt,it,tt,1,!0)[0],st=getSubstFormat(nt,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});check.assert(st.coverage.format===1,"Single: unable to modify coverage table format "+st.coverage.format);var at=_e.sub,lt=this.binSearch(st.coverage.glyphs,at);lt<0&&(lt=-1-lt,st.coverage.glyphs.splice(lt,0,at),st.substitute.splice(lt,0,0)),st.substitute[lt]=_e.by};Substitution.prototype.addMultiple=function(tt,_e,rt,it){check.assert(_e.by instanceof Array&&_e.by.length>1,'Multiple: "by" must be an array of two or more ids');var nt=this.getLookupTables(rt,it,tt,2,!0)[0],st=getSubstFormat(nt,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});check.assert(st.coverage.format===1,"Multiple: unable to modify coverage table format "+st.coverage.format);var at=_e.sub,lt=this.binSearch(st.coverage.glyphs,at);lt<0&&(lt=-1-lt,st.coverage.glyphs.splice(lt,0,at),st.sequences.splice(lt,0,0)),st.sequences[lt]=_e.by};Substitution.prototype.addAlternate=function(tt,_e,rt,it){var nt=this.getLookupTables(rt,it,tt,3,!0)[0],st=getSubstFormat(nt,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});check.assert(st.coverage.format===1,"Alternate: unable to modify coverage table format "+st.coverage.format);var at=_e.sub,lt=this.binSearch(st.coverage.glyphs,at);lt<0&&(lt=-1-lt,st.coverage.glyphs.splice(lt,0,at),st.alternateSets.splice(lt,0,0)),st.alternateSets[lt]=_e.by};Substitution.prototype.addLigature=function(tt,_e,rt,it){var nt=this.getLookupTables(rt,it,tt,4,!0)[0],st=nt.subtables[0];st||(st={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},nt.subtables[0]=st),check.assert(st.coverage.format===1,"Ligature: unable to modify coverage table format "+st.coverage.format);var at=_e.sub[0],lt=_e.sub.slice(1),ot={ligGlyph:_e.by,components:lt},ct=this.binSearch(st.coverage.glyphs,at);if(ct>=0){for(var ut=st.ligatureSets[ct],ht=0;ht<ut.length;ht++)if(arraysEqual(ut[ht].components,lt))return;ut.push(ot)}else ct=-1-ct,st.coverage.glyphs.splice(ct,0,at),st.ligatureSets.splice(ct,0,[ot])};Substitution.prototype.getFeature=function(tt,_e,rt){if(/ss\d\d/.test(tt))return this.getSingle(tt,_e,rt);switch(tt){case"aalt":case"salt":return this.getSingle(tt,_e,rt).concat(this.getAlternates(tt,_e,rt));case"dlig":case"liga":case"rlig":return this.getLigatures(tt,_e,rt);case"ccmp":return this.getMultiple(tt,_e,rt).concat(this.getLigatures(tt,_e,rt));case"stch":return this.getMultiple(tt,_e,rt)}};Substitution.prototype.add=function(tt,_e,rt,it){if(/ss\d\d/.test(tt))return this.addSingle(tt,_e,rt,it);switch(tt){case"aalt":case"salt":return typeof _e.by=="number"?this.addSingle(tt,_e,rt,it):this.addAlternate(tt,_e,rt,it);case"dlig":case"liga":case"rlig":return this.addLigature(tt,_e,rt,it);case"ccmp":return _e.by instanceof Array?this.addMultiple(tt,_e,rt,it):this.addLigature(tt,_e,rt,it)}};function isBrowser$1(){return typeof window<"u"}function arrayBufferToNodeBuffer(tt){for(var _e=new Buffer(tt.byteLength),rt=new Uint8Array(tt),it=0;it<_e.length;++it)_e[it]=rt[it];return _e}function checkArgument(tt,_e){if(!tt)throw _e}function parseGlyphCoordinate(tt,_e,rt,it,nt){var st;return(_e&it)>0?(st=tt.parseByte(),_e&nt||(st=-st),st=rt+st):(_e&nt)>0?st=rt:st=rt+tt.parseShort(),st}function parseGlyph(tt,_e,rt){var it=new parse$2.Parser(_e,rt);tt.numberOfContours=it.parseShort(),tt._xMin=it.parseShort(),tt._yMin=it.parseShort(),tt._xMax=it.parseShort(),tt._yMax=it.parseShort();var nt,st;if(tt.numberOfContours>0){for(var at=tt.endPointIndices=[],lt=0;lt<tt.numberOfContours;lt+=1)at.push(it.parseUShort());tt.instructionLength=it.parseUShort(),tt.instructions=[];for(var ot=0;ot<tt.instructionLength;ot+=1)tt.instructions.push(it.parseByte());var ct=at[at.length-1]+1;nt=[];for(var ut=0;ut<ct;ut+=1)if(st=it.parseByte(),nt.push(st),(st&8)>0)for(var ht=it.parseByte(),dt=0;dt<ht;dt+=1)nt.push(st),ut+=1;if(check.argument(nt.length===ct,"Bad flags."),at.length>0){var pt=[],ft;if(ct>0){for(var gt=0;gt<ct;gt+=1)st=nt[gt],ft={},ft.onCurve=!!(st&1),ft.lastPointOfContour=at.indexOf(gt)>=0,pt.push(ft);for(var mt=0,At=0;At<ct;At+=1)st=nt[At],ft=pt[At],ft.x=parseGlyphCoordinate(it,st,mt,2,16),mt=ft.x;for(var yt=0,bt=0;bt<ct;bt+=1)st=nt[bt],ft=pt[bt],ft.y=parseGlyphCoordinate(it,st,yt,4,32),yt=ft.y}tt.points=pt}else tt.points=[]}else if(tt.numberOfContours===0)tt.points=[];else{tt.isComposite=!0,tt.points=[],tt.components=[];for(var xt=!0;xt;){nt=it.parseUShort();var vt={glyphIndex:it.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(nt&1)>0?(nt&2)>0?(vt.dx=it.parseShort(),vt.dy=it.parseShort()):vt.matchedPoints=[it.parseUShort(),it.parseUShort()]:(nt&2)>0?(vt.dx=it.parseChar(),vt.dy=it.parseChar()):vt.matchedPoints=[it.parseByte(),it.parseByte()],(nt&8)>0?vt.xScale=vt.yScale=it.parseF2Dot14():(nt&64)>0?(vt.xScale=it.parseF2Dot14(),vt.yScale=it.parseF2Dot14()):(nt&128)>0&&(vt.xScale=it.parseF2Dot14(),vt.scale01=it.parseF2Dot14(),vt.scale10=it.parseF2Dot14(),vt.yScale=it.parseF2Dot14()),tt.components.push(vt),xt=!!(nt&32)}if(nt&256){tt.instructionLength=it.parseUShort(),tt.instructions=[];for(var _t=0;_t<tt.instructionLength;_t+=1)tt.instructions.push(it.parseByte())}}}function transformPoints(tt,_e){for(var rt=[],it=0;it<tt.length;it+=1){var nt=tt[it],st={x:_e.xScale*nt.x+_e.scale01*nt.y+_e.dx,y:_e.scale10*nt.x+_e.yScale*nt.y+_e.dy,onCurve:nt.onCurve,lastPointOfContour:nt.lastPointOfContour};rt.push(st)}return rt}function getContours(tt){for(var _e=[],rt=[],it=0;it<tt.length;it+=1){var nt=tt[it];rt.push(nt),nt.lastPointOfContour&&(_e.push(rt),rt=[])}return check.argument(rt.length===0,"There are still points left in the current contour."),_e}function getPath(tt){var _e=new Path;if(!tt)return _e;for(var rt=getContours(tt),it=0;it<rt.length;++it){var nt=rt[it],st=null,at=nt[nt.length-1],lt=nt[0];if(at.onCurve)_e.moveTo(at.x,at.y);else if(lt.onCurve)_e.moveTo(lt.x,lt.y);else{var ot={x:(at.x+lt.x)*.5,y:(at.y+lt.y)*.5};_e.moveTo(ot.x,ot.y)}for(var ct=0;ct<nt.length;++ct)if(st=at,at=lt,lt=nt[(ct+1)%nt.length],at.onCurve)_e.lineTo(at.x,at.y);else{var ut=lt;st.onCurve||((at.x+st.x)*.5,(at.y+st.y)*.5),lt.onCurve||(ut={x:(at.x+lt.x)*.5,y:(at.y+lt.y)*.5}),_e.quadraticCurveTo(at.x,at.y,ut.x,ut.y)}_e.closePath()}return _e}function buildPath(tt,_e){if(_e.isComposite)for(var rt=0;rt<_e.components.length;rt+=1){var it=_e.components[rt],nt=tt.get(it.glyphIndex);if(nt.getPath(),nt.points){var st=void 0;if(it.matchedPoints===void 0)st=transformPoints(nt.points,it);else{if(it.matchedPoints[0]>_e.points.length-1||it.matchedPoints[1]>nt.points.length-1)throw Error("Matched points out of range in "+_e.name);var at=_e.points[it.matchedPoints[0]],lt=nt.points[it.matchedPoints[1]],ot={xScale:it.xScale,scale01:it.scale01,scale10:it.scale10,yScale:it.yScale,dx:0,dy:0};lt=transformPoints([lt],ot)[0],ot.dx=at.x-lt.x,ot.dy=at.y-lt.y,st=transformPoints(nt.points,ot)}_e.points=_e.points.concat(st)}}return getPath(_e.points)}function parseGlyfTableAll(tt,_e,rt,it){for(var nt=new glyphset.GlyphSet(it),st=0;st<rt.length-1;st+=1){var at=rt[st],lt=rt[st+1];at!==lt?nt.push(st,glyphset.ttfGlyphLoader(it,st,parseGlyph,tt,_e+at,buildPath)):nt.push(st,glyphset.glyphLoader(it,st))}return nt}function parseGlyfTableOnLowMemory(tt,_e,rt,it){var nt=new glyphset.GlyphSet(it);return it._push=function(st){var at=rt[st],lt=rt[st+1];at!==lt?nt.push(st,glyphset.ttfGlyphLoader(it,st,parseGlyph,tt,_e+at,buildPath)):nt.push(st,glyphset.glyphLoader(it,st))},nt}function parseGlyfTable(tt,_e,rt,it,nt){return nt.lowMemory?parseGlyfTableOnLowMemory(tt,_e,rt,it):parseGlyfTableAll(tt,_e,rt,it)}var glyf={getPath,parse:parseGlyfTable},instructionTable,exec,execGlyph,execComponent;function Hinting(tt){this.font=tt,this.getCommands=function(_e){return glyf.getPath(_e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function roundOff(tt){return tt}function roundToGrid(tt){return Math.sign(tt)*Math.round(Math.abs(tt))}function roundToDoubleGrid(tt){return Math.sign(tt)*Math.round(Math.abs(tt*2))/2}function roundToHalfGrid(tt){return Math.sign(tt)*(Math.round(Math.abs(tt)+.5)-.5)}function roundUpToGrid(tt){return Math.sign(tt)*Math.ceil(Math.abs(tt))}function roundDownToGrid(tt){return Math.sign(tt)*Math.floor(Math.abs(tt))}var roundSuper=function(tt){var _e=this.srPeriod,rt=this.srPhase,it=this.srThreshold,nt=1;return tt<0&&(tt=-tt,nt=-1),tt+=it-rt,tt=Math.trunc(tt/_e)*_e,tt+=rt,tt<0?rt*nt:tt*nt},xUnitVector={x:1,y:0,axis:"x",distance:function(tt,_e,rt,it){return(rt?tt.xo:tt.x)-(it?_e.xo:_e.x)},interpolate:function(tt,_e,rt,it){var nt,st,at,lt,ot,ct,ut;if(!it||it===this){if(nt=tt.xo-_e.xo,st=tt.xo-rt.xo,ot=_e.x-_e.xo,ct=rt.x-rt.xo,at=Math.abs(nt),lt=Math.abs(st),ut=at+lt,ut===0){tt.x=tt.xo+(ot+ct)/2;return}tt.x=tt.xo+(ot*lt+ct*at)/ut;return}if(nt=it.distance(tt,_e,!0,!0),st=it.distance(tt,rt,!0,!0),ot=it.distance(_e,_e,!1,!0),ct=it.distance(rt,rt,!1,!0),at=Math.abs(nt),lt=Math.abs(st),ut=at+lt,ut===0){xUnitVector.setRelative(tt,tt,(ot+ct)/2,it,!0);return}xUnitVector.setRelative(tt,tt,(ot*lt+ct*at)/ut,it,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(tt,_e,rt,it,nt){if(!it||it===this){tt.x=(nt?_e.xo:_e.x)+rt;return}var st=nt?_e.xo:_e.x,at=nt?_e.yo:_e.y,lt=st+rt*it.x,ot=at+rt*it.y;tt.x=lt+(tt.y-ot)/it.normalSlope},slope:0,touch:function(tt){tt.xTouched=!0},touched:function(tt){return tt.xTouched},untouch:function(tt){tt.xTouched=!1}},yUnitVector={x:0,y:1,axis:"y",distance:function(tt,_e,rt,it){return(rt?tt.yo:tt.y)-(it?_e.yo:_e.y)},interpolate:function(tt,_e,rt,it){var nt,st,at,lt,ot,ct,ut;if(!it||it===this){if(nt=tt.yo-_e.yo,st=tt.yo-rt.yo,ot=_e.y-_e.yo,ct=rt.y-rt.yo,at=Math.abs(nt),lt=Math.abs(st),ut=at+lt,ut===0){tt.y=tt.yo+(ot+ct)/2;return}tt.y=tt.yo+(ot*lt+ct*at)/ut;return}if(nt=it.distance(tt,_e,!0,!0),st=it.distance(tt,rt,!0,!0),ot=it.distance(_e,_e,!1,!0),ct=it.distance(rt,rt,!1,!0),at=Math.abs(nt),lt=Math.abs(st),ut=at+lt,ut===0){yUnitVector.setRelative(tt,tt,(ot+ct)/2,it,!0);return}yUnitVector.setRelative(tt,tt,(ot*lt+ct*at)/ut,it,!0)},normalSlope:0,setRelative:function(tt,_e,rt,it,nt){if(!it||it===this){tt.y=(nt?_e.yo:_e.y)+rt;return}var st=nt?_e.xo:_e.x,at=nt?_e.yo:_e.y,lt=st+rt*it.x,ot=at+rt*it.y;tt.y=ot+it.normalSlope*(tt.x-lt)},slope:Number.POSITIVE_INFINITY,touch:function(tt){tt.yTouched=!0},touched:function(tt){return tt.yTouched},untouch:function(tt){tt.yTouched=!1}};Object.freeze(xUnitVector);Object.freeze(yUnitVector);function UnitVector(tt,_e){this.x=tt,this.y=_e,this.axis=void 0,this.slope=_e/tt,this.normalSlope=-tt/_e,Object.freeze(this)}UnitVector.prototype.distance=function(tt,_e,rt,it){return this.x*xUnitVector.distance(tt,_e,rt,it)+this.y*yUnitVector.distance(tt,_e,rt,it)};UnitVector.prototype.interpolate=function(tt,_e,rt,it){var nt,st,at,lt,ot,ct,ut;if(at=it.distance(tt,_e,!0,!0),lt=it.distance(tt,rt,!0,!0),nt=it.distance(_e,_e,!1,!0),st=it.distance(rt,rt,!1,!0),ot=Math.abs(at),ct=Math.abs(lt),ut=ot+ct,ut===0){this.setRelative(tt,tt,(nt+st)/2,it,!0);return}this.setRelative(tt,tt,(nt*ct+st*ot)/ut,it,!0)};UnitVector.prototype.setRelative=function(tt,_e,rt,it,nt){it=it||this;var st=nt?_e.xo:_e.x,at=nt?_e.yo:_e.y,lt=st+rt*it.x,ot=at+rt*it.y,ct=it.normalSlope,ut=this.slope,ht=tt.x,dt=tt.y;tt.x=(ut*ht-ct*lt+ot-dt)/(ut-ct),tt.y=ut*(tt.x-ht)+dt};UnitVector.prototype.touch=function(tt){tt.xTouched=!0,tt.yTouched=!0};function getUnitVector(tt,_e){var rt=Math.sqrt(tt*tt+_e*_e);return tt/=rt,_e/=rt,tt===1&&_e===0?xUnitVector:tt===0&&_e===1?yUnitVector:new UnitVector(tt,_e)}function HPoint(tt,_e,rt,it){this.x=this.xo=Math.round(tt*64)/64,this.y=this.yo=Math.round(_e*64)/64,this.lastPointOfContour=rt,this.onCurve=it,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}HPoint.prototype.nextTouched=function(tt){for(var _e=this.nextPointOnContour;!tt.touched(_e)&&_e!==this;)_e=_e.nextPointOnContour;return _e};HPoint.prototype.prevTouched=function(tt){for(var _e=this.prevPointOnContour;!tt.touched(_e)&&_e!==this;)_e=_e.prevPointOnContour;return _e};var HPZero=Object.freeze(new HPoint(0,0)),defaultState={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function State(tt,_e){switch(this.env=tt,this.stack=[],this.prog=_e,tt){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=xUnitVector,this.round=roundToGrid}}Hinting.prototype.exec=function(tt,_e){if(typeof _e!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var rt=this.font,it=this._prepState;if(!it||it.ppem!==_e){var nt=this._fpgmState;if(!nt){State.prototype=defaultState,nt=this._fpgmState=new State("fpgm",rt.tables.fpgm),nt.funcs=[],nt.font=rt,exports.DEBUG&&(console.log("---EXEC FPGM---"),nt.step=-1);try{exec(nt)}catch(ct){console.log("Hinting error in FPGM:"+ct),this._errorState=3;return}}State.prototype=nt,it=this._prepState=new State("prep",rt.tables.prep),it.ppem=_e;var st=rt.tables.cvt;if(st)for(var at=it.cvt=new Array(st.length),lt=_e/rt.unitsPerEm,ot=0;ot<st.length;ot++)at[ot]=st[ot]*lt;else it.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),it.step=-1);try{exec(it)}catch(ct){this._errorState<2&&console.log("Hinting error in PREP:"+ct),this._errorState=2}}if(!(this._errorState>1))try{return execGlyph(tt,it)}catch(ct){this._errorState<1&&(console.log("Hinting error:"+ct),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}};execGlyph=function(tt,_e){var rt=_e.ppem/_e.font.unitsPerEm,it=rt,nt=tt.components,st,at,lt;if(State.prototype=_e,!nt)lt=new State("glyf",tt.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),lt.step=-1),execComponent(tt,lt,rt,it),at=lt.gZone;else{var ot=_e.font;at=[],st=[];for(var ct=0;ct<nt.length;ct++){var ut=nt[ct],ht=ot.glyphs.get(ut.glyphIndex);lt=new State("glyf",ht.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+ct+"---"),lt.step=-1),execComponent(ht,lt,rt,it);for(var dt=Math.round(ut.dx*rt),pt=Math.round(ut.dy*it),ft=lt.gZone,gt=lt.contours,mt=0;mt<ft.length;mt++){var At=ft[mt];At.xTouched=At.yTouched=!1,At.xo=At.x=At.x+dt,At.yo=At.y=At.y+pt}var yt=at.length;at.push.apply(at,ft);for(var bt=0;bt<gt.length;bt++)st.push(gt[bt]+yt)}tt.instructions&&!lt.inhibitGridFit&&(lt=new State("glyf",tt.instructions),lt.gZone=lt.z0=lt.z1=lt.z2=at,lt.contours=st,at.push(new HPoint(0,0),new HPoint(Math.round(tt.advanceWidth*rt),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),lt.step=-1),exec(lt),at.length-=2)}return at};execComponent=function(tt,_e,rt,it){for(var nt=tt.points||[],st=nt.length,at=_e.gZone=_e.z0=_e.z1=_e.z2=[],lt=_e.contours=[],ot,ct=0;ct<st;ct++)ot=nt[ct],at[ct]=new HPoint(ot.x*rt,ot.y*it,ot.lastPointOfContour,ot.onCurve);for(var ut,ht,dt=0;dt<st;dt++)ot=at[dt],ut||(ut=ot,lt.push(dt)),ot.lastPointOfContour?(ot.nextPointOnContour=ut,ut.prevPointOnContour=ot,ut=void 0):(ht=at[dt+1],ot.nextPointOnContour=ht,ht.prevPointOnContour=ot);if(!_e.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",_e.stack);for(var pt=0;pt<st;pt++)console.log(pt,at[pt].x,at[pt].y)}if(at.push(new HPoint(0,0),new HPoint(Math.round(tt.advanceWidth*rt),0)),exec(_e),at.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",_e.stack);for(var ft=0;ft<st;ft++)console.log(ft,at[ft].x,at[ft].y)}}};exec=function(tt){var _e=tt.prog;if(_e){var rt=_e.length,it;for(tt.ip=0;tt.ip<rt;tt.ip++){if(exports.DEBUG&&tt.step++,it=instructionTable[_e[tt.ip]],!it)throw new Error("unknown instruction: 0x"+Number(_e[tt.ip]).toString(16));it(tt)}}};function initTZone(tt){for(var _e=tt.tZone=new Array(tt.gZone.length),rt=0;rt<_e.length;rt++)_e[rt]=new HPoint(0,0)}function skip(tt,_e){var rt=tt.prog,it=tt.ip,nt=1,st;do if(st=rt[++it],st===88)nt++;else if(st===89)nt--;else if(st===64)it+=rt[it+1]+1;else if(st===65)it+=2*rt[it+1]+1;else if(st>=176&&st<=183)it+=st-176+1;else if(st>=184&&st<=191)it+=(st-184+1)*2;else if(_e&&nt===1&&st===27)break;while(nt>0);tt.ip=it}function SVTCA(tt,_e){exports.DEBUG&&console.log(_e.step,"SVTCA["+tt.axis+"]"),_e.fv=_e.pv=_e.dpv=tt}function SPVTCA(tt,_e){exports.DEBUG&&console.log(_e.step,"SPVTCA["+tt.axis+"]"),_e.pv=_e.dpv=tt}function SFVTCA(tt,_e){exports.DEBUG&&console.log(_e.step,"SFVTCA["+tt.axis+"]"),_e.fv=tt}function SPVTL(tt,_e){var rt=_e.stack,it=rt.pop(),nt=rt.pop(),st=_e.z2[it],at=_e.z1[nt];exports.DEBUG&&console.log("SPVTL["+tt+"]",it,nt);var lt,ot;tt?(lt=st.y-at.y,ot=at.x-st.x):(lt=at.x-st.x,ot=at.y-st.y),_e.pv=_e.dpv=getUnitVector(lt,ot)}function SFVTL(tt,_e){var rt=_e.stack,it=rt.pop(),nt=rt.pop(),st=_e.z2[it],at=_e.z1[nt];exports.DEBUG&&console.log("SFVTL["+tt+"]",it,nt);var lt,ot;tt?(lt=st.y-at.y,ot=at.x-st.x):(lt=at.x-st.x,ot=at.y-st.y),_e.fv=getUnitVector(lt,ot)}function SPVFS(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"SPVFS[]",rt,it),tt.pv=tt.dpv=getUnitVector(it,rt)}function SFVFS(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"SPVFS[]",rt,it),tt.fv=getUnitVector(it,rt)}function GPV(tt){var _e=tt.stack,rt=tt.pv;exports.DEBUG&&console.log(tt.step,"GPV[]"),_e.push(rt.x*16384),_e.push(rt.y*16384)}function GFV(tt){var _e=tt.stack,rt=tt.fv;exports.DEBUG&&console.log(tt.step,"GFV[]"),_e.push(rt.x*16384),_e.push(rt.y*16384)}function SFVTPV(tt){tt.fv=tt.pv,exports.DEBUG&&console.log(tt.step,"SFVTPV[]")}function ISECT(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop(),nt=_e.pop(),st=_e.pop(),at=_e.pop(),lt=tt.z0,ot=tt.z1,ct=lt[rt],ut=lt[it],ht=ot[nt],dt=ot[st],pt=tt.z2[at];exports.DEBUG&&console.log("ISECT[], ",rt,it,nt,st,at);var ft=ct.x,gt=ct.y,mt=ut.x,At=ut.y,yt=ht.x,bt=ht.y,xt=dt.x,vt=dt.y,_t=(ft-mt)*(bt-vt)-(gt-At)*(yt-xt),Ct=ft*At-gt*mt,St=yt*vt-bt*xt;pt.x=(Ct*(yt-xt)-St*(ft-mt))/_t,pt.y=(Ct*(bt-vt)-St*(gt-At))/_t}function SRP0(tt){tt.rp0=tt.stack.pop(),exports.DEBUG&&console.log(tt.step,"SRP0[]",tt.rp0)}function SRP1(tt){tt.rp1=tt.stack.pop(),exports.DEBUG&&console.log(tt.step,"SRP1[]",tt.rp1)}function SRP2(tt){tt.rp2=tt.stack.pop(),exports.DEBUG&&console.log(tt.step,"SRP2[]",tt.rp2)}function SZP0(tt){var _e=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"SZP0[]",_e),tt.zp0=_e,_e){case 0:tt.tZone||initTZone(tt),tt.z0=tt.tZone;break;case 1:tt.z0=tt.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZP1(tt){var _e=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"SZP1[]",_e),tt.zp1=_e,_e){case 0:tt.tZone||initTZone(tt),tt.z1=tt.tZone;break;case 1:tt.z1=tt.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZP2(tt){var _e=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"SZP2[]",_e),tt.zp2=_e,_e){case 0:tt.tZone||initTZone(tt),tt.z2=tt.tZone;break;case 1:tt.z2=tt.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZPS(tt){var _e=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"SZPS[]",_e),tt.zp0=tt.zp1=tt.zp2=_e,_e){case 0:tt.tZone||initTZone(tt),tt.z0=tt.z1=tt.z2=tt.tZone;break;case 1:tt.z0=tt.z1=tt.z2=tt.gZone;break;default:throw new Error("Invalid zone pointer")}}function SLOOP(tt){tt.loop=tt.stack.pop(),exports.DEBUG&&console.log(tt.step,"SLOOP[]",tt.loop)}function RTG(tt){exports.DEBUG&&console.log(tt.step,"RTG[]"),tt.round=roundToGrid}function RTHG(tt){exports.DEBUG&&console.log(tt.step,"RTHG[]"),tt.round=roundToHalfGrid}function SMD(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SMD[]",_e),tt.minDis=_e/64}function ELSE(tt){exports.DEBUG&&console.log(tt.step,"ELSE[]"),skip(tt,!1)}function JMPR(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"JMPR[]",_e),tt.ip+=_e-1}function SCVTCI(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SCVTCI[]",_e),tt.cvCutIn=_e/64}function DUP(tt){var _e=tt.stack;exports.DEBUG&&console.log(tt.step,"DUP[]"),_e.push(_e[_e.length-1])}function POP(tt){exports.DEBUG&&console.log(tt.step,"POP[]"),tt.stack.pop()}function CLEAR(tt){exports.DEBUG&&console.log(tt.step,"CLEAR[]"),tt.stack.length=0}function SWAP(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"SWAP[]"),_e.push(rt),_e.push(it)}function DEPTH(tt){var _e=tt.stack;exports.DEBUG&&console.log(tt.step,"DEPTH[]"),_e.push(_e.length)}function LOOPCALL(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"LOOPCALL[]",rt,it);var nt=tt.ip,st=tt.prog;tt.prog=tt.funcs[rt];for(var at=0;at<it;at++)exec(tt),exports.DEBUG&&console.log(++tt.step,at+1<it?"next loopcall":"done loopcall",at);tt.ip=nt,tt.prog=st}function CALL(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"CALL[]",_e);var rt=tt.ip,it=tt.prog;tt.prog=tt.funcs[_e],exec(tt),tt.ip=rt,tt.prog=it,exports.DEBUG&&console.log(++tt.step,"returning from",_e)}function CINDEX(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"CINDEX[]",rt),_e.push(_e[_e.length-rt])}function MINDEX(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"MINDEX[]",rt),_e.push(_e.splice(_e.length-rt,1)[0])}function FDEF(tt){if(tt.env!=="fpgm")throw new Error("FDEF not allowed here");var _e=tt.stack,rt=tt.prog,it=tt.ip,nt=_e.pop(),st=it;for(exports.DEBUG&&console.log(tt.step,"FDEF[]",nt);rt[++it]!==45;);tt.ip=it,tt.funcs[nt]=rt.slice(st+1,it)}function MDAP(tt,_e){var rt=_e.stack.pop(),it=_e.z0[rt],nt=_e.fv,st=_e.pv;exports.DEBUG&&console.log(_e.step,"MDAP["+tt+"]",rt);var at=st.distance(it,HPZero);tt&&(at=_e.round(at)),nt.setRelative(it,HPZero,at,st),nt.touch(it),_e.rp0=_e.rp1=rt}function IUP(tt,_e){var rt=_e.z2,it=rt.length-2,nt,st,at;exports.DEBUG&&console.log(_e.step,"IUP["+tt.axis+"]");for(var lt=0;lt<it;lt++)nt=rt[lt],!tt.touched(nt)&&(st=nt.prevTouched(tt),st!==nt&&(at=nt.nextTouched(tt),st===at&&tt.setRelative(nt,nt,tt.distance(st,st,!1,!0),tt,!0),tt.interpolate(nt,st,at,tt)))}function SHP(tt,_e){for(var rt=_e.stack,it=tt?_e.rp1:_e.rp2,nt=(tt?_e.z0:_e.z1)[it],st=_e.fv,at=_e.pv,lt=_e.loop,ot=_e.z2;lt--;){var ct=rt.pop(),ut=ot[ct],ht=at.distance(nt,nt,!1,!0);st.setRelative(ut,ut,ht,at),st.touch(ut),exports.DEBUG&&console.log(_e.step,(_e.loop>1?"loop "+(_e.loop-lt)+": ":"")+"SHP["+(tt?"rp1":"rp2")+"]",ct)}_e.loop=1}function SHC(tt,_e){var rt=_e.stack,it=tt?_e.rp1:_e.rp2,nt=(tt?_e.z0:_e.z1)[it],st=_e.fv,at=_e.pv,lt=rt.pop(),ot=_e.z2[_e.contours[lt]],ct=ot;exports.DEBUG&&console.log(_e.step,"SHC["+tt+"]",lt);var ut=at.distance(nt,nt,!1,!0);do ct!==nt&&st.setRelative(ct,ct,ut,at),ct=ct.nextPointOnContour;while(ct!==ot)}function SHZ(tt,_e){var rt=_e.stack,it=tt?_e.rp1:_e.rp2,nt=(tt?_e.z0:_e.z1)[it],st=_e.fv,at=_e.pv,lt=rt.pop();exports.DEBUG&&console.log(_e.step,"SHZ["+tt+"]",lt);var ot;switch(lt){case 0:ot=_e.tZone;break;case 1:ot=_e.gZone;break;default:throw new Error("Invalid zone")}for(var ct,ut=at.distance(nt,nt,!1,!0),ht=ot.length-2,dt=0;dt<ht;dt++)ct=ot[dt],st.setRelative(ct,ct,ut,at)}function SHPIX(tt){for(var _e=tt.stack,rt=tt.loop,it=tt.fv,nt=_e.pop()/64,st=tt.z2;rt--;){var at=_e.pop(),lt=st[at];exports.DEBUG&&console.log(tt.step,(tt.loop>1?"loop "+(tt.loop-rt)+": ":"")+"SHPIX[]",at,nt),it.setRelative(lt,lt,nt),it.touch(lt)}tt.loop=1}function IP(tt){for(var _e=tt.stack,rt=tt.rp1,it=tt.rp2,nt=tt.loop,st=tt.z0[rt],at=tt.z1[it],lt=tt.fv,ot=tt.dpv,ct=tt.z2;nt--;){var ut=_e.pop(),ht=ct[ut];exports.DEBUG&&console.log(tt.step,(tt.loop>1?"loop "+(tt.loop-nt)+": ":"")+"IP[]",ut,rt,"<->",it),lt.interpolate(ht,st,at,ot),lt.touch(ht)}tt.loop=1}function MSIRP(tt,_e){var rt=_e.stack,it=rt.pop()/64,nt=rt.pop(),st=_e.z1[nt],at=_e.z0[_e.rp0],lt=_e.fv,ot=_e.pv;lt.setRelative(st,at,it,ot),lt.touch(st),exports.DEBUG&&console.log(_e.step,"MSIRP["+tt+"]",it,nt),_e.rp1=_e.rp0,_e.rp2=nt,tt&&(_e.rp0=nt)}function ALIGNRP(tt){for(var _e=tt.stack,rt=tt.rp0,it=tt.z0[rt],nt=tt.loop,st=tt.fv,at=tt.pv,lt=tt.z1;nt--;){var ot=_e.pop(),ct=lt[ot];exports.DEBUG&&console.log(tt.step,(tt.loop>1?"loop "+(tt.loop-nt)+": ":"")+"ALIGNRP[]",ot),st.setRelative(ct,it,0,at),st.touch(ct)}tt.loop=1}function RTDG(tt){exports.DEBUG&&console.log(tt.step,"RTDG[]"),tt.round=roundToDoubleGrid}function MIAP(tt,_e){var rt=_e.stack,it=rt.pop(),nt=rt.pop(),st=_e.z0[nt],at=_e.fv,lt=_e.pv,ot=_e.cvt[it];exports.DEBUG&&console.log(_e.step,"MIAP["+tt+"]",it,"(",ot,")",nt);var ct=lt.distance(st,HPZero);tt&&(Math.abs(ct-ot)<_e.cvCutIn&&(ct=ot),ct=_e.round(ct)),at.setRelative(st,HPZero,ct,lt),_e.zp0===0&&(st.xo=st.x,st.yo=st.y),at.touch(st),_e.rp0=_e.rp1=nt}function NPUSHB(tt){var _e=tt.prog,rt=tt.ip,it=tt.stack,nt=_e[++rt];exports.DEBUG&&console.log(tt.step,"NPUSHB[]",nt);for(var st=0;st<nt;st++)it.push(_e[++rt]);tt.ip=rt}function NPUSHW(tt){var _e=tt.ip,rt=tt.prog,it=tt.stack,nt=rt[++_e];exports.DEBUG&&console.log(tt.step,"NPUSHW[]",nt);for(var st=0;st<nt;st++){var at=rt[++_e]<<8|rt[++_e];at&32768&&(at=-((at^65535)+1)),it.push(at)}tt.ip=_e}function WS(tt){var _e=tt.stack,rt=tt.store;rt||(rt=tt.store=[]);var it=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"WS",it,nt),rt[nt]=it}function RS(tt){var _e=tt.stack,rt=tt.store,it=_e.pop();exports.DEBUG&&console.log(tt.step,"RS",it);var nt=rt&&rt[it]||0;_e.push(nt)}function WCVTP(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"WCVTP",rt,it),tt.cvt[it]=rt/64}function RCVT(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"RCVT",rt),_e.push(tt.cvt[rt]*64)}function GC(tt,_e){var rt=_e.stack,it=rt.pop(),nt=_e.z2[it];exports.DEBUG&&console.log(_e.step,"GC["+tt+"]",it),rt.push(_e.dpv.distance(nt,HPZero,tt,!1)*64)}function MD(tt,_e){var rt=_e.stack,it=rt.pop(),nt=rt.pop(),st=_e.z1[it],at=_e.z0[nt],lt=_e.dpv.distance(at,st,tt,tt);exports.DEBUG&&console.log(_e.step,"MD["+tt+"]",it,nt,"->",lt),_e.stack.push(Math.round(lt*64))}function MPPEM(tt){exports.DEBUG&&console.log(tt.step,"MPPEM[]"),tt.stack.push(tt.ppem)}function FLIPON(tt){exports.DEBUG&&console.log(tt.step,"FLIPON[]"),tt.autoFlip=!0}function LT(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"LT[]",rt,it),_e.push(it<rt?1:0)}function LTEQ(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"LTEQ[]",rt,it),_e.push(it<=rt?1:0)}function GT(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"GT[]",rt,it),_e.push(it>rt?1:0)}function GTEQ(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"GTEQ[]",rt,it),_e.push(it>=rt?1:0)}function EQ(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"EQ[]",rt,it),_e.push(rt===it?1:0)}function NEQ(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"NEQ[]",rt,it),_e.push(rt!==it?1:0)}function ODD(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"ODD[]",rt),_e.push(Math.trunc(rt)%2?1:0)}function EVEN(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"EVEN[]",rt),_e.push(Math.trunc(rt)%2?0:1)}function IF(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"IF[]",_e),_e||(skip(tt,!0),exports.DEBUG&&console.log(tt.step,"EIF[]"))}function EIF(tt){exports.DEBUG&&console.log(tt.step,"EIF[]")}function AND(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"AND[]",rt,it),_e.push(rt&&it?1:0)}function OR(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"OR[]",rt,it),_e.push(rt||it?1:0)}function NOT(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"NOT[]",rt),_e.push(rt?0:1)}function DELTAP123(tt,_e){var rt=_e.stack,it=rt.pop(),nt=_e.fv,st=_e.pv,at=_e.ppem,lt=_e.deltaBase+(tt-1)*16,ot=_e.deltaShift,ct=_e.z0;exports.DEBUG&&console.log(_e.step,"DELTAP["+tt+"]",it,rt);for(var ut=0;ut<it;ut++){var ht=rt.pop(),dt=rt.pop(),pt=lt+((dt&240)>>4);if(pt===at){var ft=(dt&15)-8;ft>=0&&ft++,exports.DEBUG&&console.log(_e.step,"DELTAPFIX",ht,"by",ft*ot);var gt=ct[ht];nt.setRelative(gt,gt,ft*ot,st)}}}function SDB(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"SDB[]",rt),tt.deltaBase=rt}function SDS(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"SDS[]",rt),tt.deltaShift=Math.pow(.5,rt)}function ADD(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"ADD[]",rt,it),_e.push(it+rt)}function SUB(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"SUB[]",rt,it),_e.push(it-rt)}function DIV(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"DIV[]",rt,it),_e.push(it*64/rt)}function MUL(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"MUL[]",rt,it),_e.push(it*rt/64)}function ABS(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"ABS[]",rt),_e.push(Math.abs(rt))}function NEG(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"NEG[]",rt),_e.push(-rt)}function FLOOR(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"FLOOR[]",rt),_e.push(Math.floor(rt/64)*64)}function CEILING(tt){var _e=tt.stack,rt=_e.pop();exports.DEBUG&&console.log(tt.step,"CEILING[]",rt),_e.push(Math.ceil(rt/64)*64)}function ROUND(tt,_e){var rt=_e.stack,it=rt.pop();exports.DEBUG&&console.log(_e.step,"ROUND[]"),rt.push(_e.round(it/64)*64)}function WCVTF(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"WCVTF[]",rt,it),tt.cvt[it]=rt*tt.ppem/tt.font.unitsPerEm}function DELTAC123(tt,_e){var rt=_e.stack,it=rt.pop(),nt=_e.ppem,st=_e.deltaBase+(tt-1)*16,at=_e.deltaShift;exports.DEBUG&&console.log(_e.step,"DELTAC["+tt+"]",it,rt);for(var lt=0;lt<it;lt++){var ot=rt.pop(),ct=rt.pop(),ut=st+((ct&240)>>4);if(ut===nt){var ht=(ct&15)-8;ht>=0&&ht++;var dt=ht*at;exports.DEBUG&&console.log(_e.step,"DELTACFIX",ot,"by",dt),_e.cvt[ot]+=dt}}}function SROUND(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SROUND[]",_e),tt.round=roundSuper;var rt;switch(_e&192){case 0:rt=.5;break;case 64:rt=1;break;case 128:rt=2;break;default:throw new Error("invalid SROUND value")}switch(tt.srPeriod=rt,_e&48){case 0:tt.srPhase=0;break;case 16:tt.srPhase=.25*rt;break;case 32:tt.srPhase=.5*rt;break;case 48:tt.srPhase=.75*rt;break;default:throw new Error("invalid SROUND value")}_e&=15,_e===0?tt.srThreshold=0:tt.srThreshold=(_e/8-.5)*rt}function S45ROUND(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"S45ROUND[]",_e),tt.round=roundSuper;var rt;switch(_e&192){case 0:rt=Math.sqrt(2)/2;break;case 64:rt=Math.sqrt(2);break;case 128:rt=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(tt.srPeriod=rt,_e&48){case 0:tt.srPhase=0;break;case 16:tt.srPhase=.25*rt;break;case 32:tt.srPhase=.5*rt;break;case 48:tt.srPhase=.75*rt;break;default:throw new Error("invalid S45ROUND value")}_e&=15,_e===0?tt.srThreshold=0:tt.srThreshold=(_e/8-.5)*rt}function ROFF(tt){exports.DEBUG&&console.log(tt.step,"ROFF[]"),tt.round=roundOff}function RUTG(tt){exports.DEBUG&&console.log(tt.step,"RUTG[]"),tt.round=roundUpToGrid}function RDTG(tt){exports.DEBUG&&console.log(tt.step,"RDTG[]"),tt.round=roundDownToGrid}function SCANCTRL(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SCANCTRL[]",_e)}function SDPVTL(tt,_e){var rt=_e.stack,it=rt.pop(),nt=rt.pop(),st=_e.z2[it],at=_e.z1[nt];exports.DEBUG&&console.log(_e.step,"SDPVTL["+tt+"]",it,nt);var lt,ot;tt?(lt=st.y-at.y,ot=at.x-st.x):(lt=at.x-st.x,ot=at.y-st.y),_e.dpv=getUnitVector(lt,ot)}function GETINFO(tt){var _e=tt.stack,rt=_e.pop(),it=0;exports.DEBUG&&console.log(tt.step,"GETINFO[]",rt),rt&1&&(it=35),rt&32&&(it|=4096),_e.push(it)}function ROLL(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop(),nt=_e.pop();exports.DEBUG&&console.log(tt.step,"ROLL[]"),_e.push(it),_e.push(rt),_e.push(nt)}function MAX(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"MAX[]",rt,it),_e.push(Math.max(it,rt))}function MIN(tt){var _e=tt.stack,rt=_e.pop(),it=_e.pop();exports.DEBUG&&console.log(tt.step,"MIN[]",rt,it),_e.push(Math.min(it,rt))}function SCANTYPE(tt){var _e=tt.stack.pop();exports.DEBUG&&console.log(tt.step,"SCANTYPE[]",_e)}function INSTCTRL(tt){var _e=tt.stack.pop(),rt=tt.stack.pop();switch(exports.DEBUG&&console.log(tt.step,"INSTCTRL[]",_e,rt),_e){case 1:tt.inhibitGridFit=!!rt;return;case 2:tt.ignoreCvt=!!rt;return;default:throw new Error("invalid INSTCTRL[] selector")}}function PUSHB(tt,_e){var rt=_e.stack,it=_e.prog,nt=_e.ip;exports.DEBUG&&console.log(_e.step,"PUSHB["+tt+"]");for(var st=0;st<tt;st++)rt.push(it[++nt]);_e.ip=nt}function PUSHW(tt,_e){var rt=_e.ip,it=_e.prog,nt=_e.stack;exports.DEBUG&&console.log(_e.ip,"PUSHW["+tt+"]");for(var st=0;st<tt;st++){var at=it[++rt]<<8|it[++rt];at&32768&&(at=-((at^65535)+1)),nt.push(at)}_e.ip=rt}function MDRP_MIRP(tt,_e,rt,it,nt,st){var at=st.stack,lt=tt&&at.pop(),ot=at.pop(),ct=st.rp0,ut=st.z0[ct],ht=st.z1[ot],dt=st.minDis,pt=st.fv,ft=st.dpv,gt,mt,At,yt;mt=gt=ft.distance(ht,ut,!0,!0),At=mt>=0?1:-1,mt=Math.abs(mt),tt&&(yt=st.cvt[lt],it&&Math.abs(mt-yt)<st.cvCutIn&&(mt=yt)),rt&&mt<dt&&(mt=dt),it&&(mt=st.round(mt)),pt.setRelative(ht,ut,At*mt,ft),pt.touch(ht),exports.DEBUG&&console.log(st.step,(tt?"MIRP[":"MDRP[")+(_e?"M":"m")+(rt?">":"_")+(it?"R":"_")+(nt===0?"Gr":nt===1?"Bl":nt===2?"Wh":"")+"]",tt?lt+"("+st.cvt[lt]+","+yt+")":"",ot,"(d =",gt,"->",At*mt,")"),st.rp1=st.rp0,st.rp2=ot,_e&&(st.rp0=ot)}instructionTable=[SVTCA.bind(void 0,yUnitVector),SVTCA.bind(void 0,xUnitVector),SPVTCA.bind(void 0,yUnitVector),SPVTCA.bind(void 0,xUnitVector),SFVTCA.bind(void 0,yUnitVector),SFVTCA.bind(void 0,xUnitVector),SPVTL.bind(void 0,0),SPVTL.bind(void 0,1),SFVTL.bind(void 0,0),SFVTL.bind(void 0,1),SPVFS,SFVFS,GPV,GFV,SFVTPV,ISECT,SRP0,SRP1,SRP2,SZP0,SZP1,SZP2,SZPS,SLOOP,RTG,RTHG,SMD,ELSE,JMPR,SCVTCI,void 0,void 0,DUP,POP,CLEAR,SWAP,DEPTH,CINDEX,MINDEX,void 0,void 0,void 0,LOOPCALL,CALL,FDEF,void 0,MDAP.bind(void 0,0),MDAP.bind(void 0,1),IUP.bind(void 0,yUnitVector),IUP.bind(void 0,xUnitVector),SHP.bind(void 0,0),SHP.bind(void 0,1),SHC.bind(void 0,0),SHC.bind(void 0,1),SHZ.bind(void 0,0),SHZ.bind(void 0,1),SHPIX,IP,MSIRP.bind(void 0,0),MSIRP.bind(void 0,1),ALIGNRP,RTDG,MIAP.bind(void 0,0),MIAP.bind(void 0,1),NPUSHB,NPUSHW,WS,RS,WCVTP,RCVT,GC.bind(void 0,0),GC.bind(void 0,1),void 0,MD.bind(void 0,0),MD.bind(void 0,1),MPPEM,void 0,FLIPON,void 0,void 0,LT,LTEQ,GT,GTEQ,EQ,NEQ,ODD,EVEN,IF,EIF,AND,OR,NOT,DELTAP123.bind(void 0,1),SDB,SDS,ADD,SUB,DIV,MUL,ABS,NEG,FLOOR,CEILING,ROUND.bind(void 0,0),ROUND.bind(void 0,1),ROUND.bind(void 0,2),ROUND.bind(void 0,3),void 0,void 0,void 0,void 0,WCVTF,DELTAP123.bind(void 0,2),DELTAP123.bind(void 0,3),DELTAC123.bind(void 0,1),DELTAC123.bind(void 0,2),DELTAC123.bind(void 0,3),SROUND,S45ROUND,void 0,void 0,ROFF,void 0,RUTG,RDTG,POP,POP,void 0,void 0,void 0,void 0,void 0,SCANCTRL,SDPVTL.bind(void 0,0),SDPVTL.bind(void 0,1),GETINFO,void 0,ROLL,MAX,MIN,SCANTYPE,INSTCTRL,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,PUSHB.bind(void 0,1),PUSHB.bind(void 0,2),PUSHB.bind(void 0,3),PUSHB.bind(void 0,4),PUSHB.bind(void 0,5),PUSHB.bind(void 0,6),PUSHB.bind(void 0,7),PUSHB.bind(void 0,8),PUSHW.bind(void 0,1),PUSHW.bind(void 0,2),PUSHW.bind(void 0,3),PUSHW.bind(void 0,4),PUSHW.bind(void 0,5),PUSHW.bind(void 0,6),PUSHW.bind(void 0,7),PUSHW.bind(void 0,8),MDRP_MIRP.bind(void 0,0,0,0,0,0),MDRP_MIRP.bind(void 0,0,0,0,0,1),MDRP_MIRP.bind(void 0,0,0,0,0,2),MDRP_MIRP.bind(void 0,0,0,0,0,3),MDRP_MIRP.bind(void 0,0,0,0,1,0),MDRP_MIRP.bind(void 0,0,0,0,1,1),MDRP_MIRP.bind(void 0,0,0,0,1,2),MDRP_MIRP.bind(void 0,0,0,0,1,3),MDRP_MIRP.bind(void 0,0,0,1,0,0),MDRP_MIRP.bind(void 0,0,0,1,0,1),MDRP_MIRP.bind(void 0,0,0,1,0,2),MDRP_MIRP.bind(void 0,0,0,1,0,3),MDRP_MIRP.bind(void 0,0,0,1,1,0),MDRP_MIRP.bind(void 0,0,0,1,1,1),MDRP_MIRP.bind(void 0,0,0,1,1,2),MDRP_MIRP.bind(void 0,0,0,1,1,3),MDRP_MIRP.bind(void 0,0,1,0,0,0),MDRP_MIRP.bind(void 0,0,1,0,0,1),MDRP_MIRP.bind(void 0,0,1,0,0,2),MDRP_MIRP.bind(void 0,0,1,0,0,3),MDRP_MIRP.bind(void 0,0,1,0,1,0),MDRP_MIRP.bind(void 0,0,1,0,1,1),MDRP_MIRP.bind(void 0,0,1,0,1,2),MDRP_MIRP.bind(void 0,0,1,0,1,3),MDRP_MIRP.bind(void 0,0,1,1,0,0),MDRP_MIRP.bind(void 0,0,1,1,0,1),MDRP_MIRP.bind(void 0,0,1,1,0,2),MDRP_MIRP.bind(void 0,0,1,1,0,3),MDRP_MIRP.bind(void 0,0,1,1,1,0),MDRP_MIRP.bind(void 0,0,1,1,1,1),MDRP_MIRP.bind(void 0,0,1,1,1,2),MDRP_MIRP.bind(void 0,0,1,1,1,3),MDRP_MIRP.bind(void 0,1,0,0,0,0),MDRP_MIRP.bind(void 0,1,0,0,0,1),MDRP_MIRP.bind(void 0,1,0,0,0,2),MDRP_MIRP.bind(void 0,1,0,0,0,3),MDRP_MIRP.bind(void 0,1,0,0,1,0),MDRP_MIRP.bind(void 0,1,0,0,1,1),MDRP_MIRP.bind(void 0,1,0,0,1,2),MDRP_MIRP.bind(void 0,1,0,0,1,3),MDRP_MIRP.bind(void 0,1,0,1,0,0),MDRP_MIRP.bind(void 0,1,0,1,0,1),MDRP_MIRP.bind(void 0,1,0,1,0,2),MDRP_MIRP.bind(void 0,1,0,1,0,3),MDRP_MIRP.bind(void 0,1,0,1,1,0),MDRP_MIRP.bind(void 0,1,0,1,1,1),MDRP_MIRP.bind(void 0,1,0,1,1,2),MDRP_MIRP.bind(void 0,1,0,1,1,3),MDRP_MIRP.bind(void 0,1,1,0,0,0),MDRP_MIRP.bind(void 0,1,1,0,0,1),MDRP_MIRP.bind(void 0,1,1,0,0,2),MDRP_MIRP.bind(void 0,1,1,0,0,3),MDRP_MIRP.bind(void 0,1,1,0,1,0),MDRP_MIRP.bind(void 0,1,1,0,1,1),MDRP_MIRP.bind(void 0,1,1,0,1,2),MDRP_MIRP.bind(void 0,1,1,0,1,3),MDRP_MIRP.bind(void 0,1,1,1,0,0),MDRP_MIRP.bind(void 0,1,1,1,0,1),MDRP_MIRP.bind(void 0,1,1,1,0,2),MDRP_MIRP.bind(void 0,1,1,1,0,3),MDRP_MIRP.bind(void 0,1,1,1,1,0),MDRP_MIRP.bind(void 0,1,1,1,1,1),MDRP_MIRP.bind(void 0,1,1,1,1,2),MDRP_MIRP.bind(void 0,1,1,1,1,3)];function Token(tt){this.char=tt,this.state={},this.activeState=null}function ContextRange(tt,_e,rt){this.contextName=rt,this.startIndex=tt,this.endOffset=_e}function ContextChecker(tt,_e,rt){this.contextName=tt,this.openRange=null,this.ranges=[],this.checkStart=_e,this.checkEnd=rt}function ContextParams(tt,_e){this.context=tt,this.index=_e,this.length=tt.length,this.current=tt[_e],this.backtrack=tt.slice(0,_e),this.lookahead=tt.slice(_e+1)}function Event(tt){this.eventId=tt,this.subscribers=[]}function initializeCoreEvents(tt){var _e=this,rt=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];rt.forEach(function(nt){Object.defineProperty(_e.events,nt,{value:new Event(nt)})}),tt&&rt.forEach(function(nt){var st=tt[nt];typeof st=="function"&&_e.events[nt].subscribe(st)});var it=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];it.forEach(function(nt){_e.events[nt].subscribe(_e.updateContextsRanges)})}function Tokenizer(tt){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],initializeCoreEvents.call(this,tt)}Token.prototype.setState=function(tt,_e){return this.state[tt]=_e,this.activeState={key:tt,value:this.state[tt]},this.activeState};Token.prototype.getState=function(tt){return this.state[tt]||null};Tokenizer.prototype.inboundIndex=function(tt){return tt>=0&&tt<this.tokens.length};Tokenizer.prototype.composeRUD=function(tt){var _e=this,rt=!0,it=tt.map(function(st){return _e[st[0]].apply(_e,st.slice(1).concat(rt))}),nt=function(st){return typeof st=="object"&&st.hasOwnProperty("FAIL")};if(it.every(nt))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:it.filter(nt)};this.dispatch("composeRUD",[it.filter(function(st){return!nt(st)})])};Tokenizer.prototype.replaceRange=function(tt,_e,rt,it){_e=_e!==null?_e:this.tokens.length;var nt=rt.every(function(at){return at instanceof Token});if(!isNaN(tt)&&this.inboundIndex(tt)&&nt){var st=this.tokens.splice.apply(this.tokens,[tt,_e].concat(rt));return it||this.dispatch("replaceToken",[tt,_e,rt]),[st,rt]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}};Tokenizer.prototype.replaceToken=function(tt,_e,rt){if(!isNaN(tt)&&this.inboundIndex(tt)&&_e instanceof Token){var it=this.tokens.splice(tt,1,_e);return rt||this.dispatch("replaceToken",[tt,_e]),[it[0],_e]}else return{FAIL:"replaceToken: invalid token or index."}};Tokenizer.prototype.removeRange=function(tt,_e,rt){_e=isNaN(_e)?this.tokens.length:_e;var it=this.tokens.splice(tt,_e);return rt||this.dispatch("removeRange",[it,tt,_e]),it};Tokenizer.prototype.removeToken=function(tt,_e){if(!isNaN(tt)&&this.inboundIndex(tt)){var rt=this.tokens.splice(tt,1);return _e||this.dispatch("removeToken",[rt,tt]),rt}else return{FAIL:"removeToken: invalid token index."}};Tokenizer.prototype.insertToken=function(tt,_e,rt){var it=tt.every(function(nt){return nt instanceof Token});return it?(this.tokens.splice.apply(this.tokens,[_e,0].concat(tt)),rt||this.dispatch("insertToken",[tt,_e]),tt):{FAIL:"insertToken: invalid token(s)."}};Tokenizer.prototype.registerModifier=function(tt,_e,rt){this.events.newToken.subscribe(function(it,nt){var st=[it,nt],at=_e===null||_e.apply(this,st)===!0,lt=[it,nt];if(at){var ot=rt.apply(this,lt);it.setState(tt,ot)}}),this.registeredModifiers.push(tt)};Event.prototype.subscribe=function(tt){return typeof tt=="function"?this.subscribers.push(tt)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}};Event.prototype.unsubscribe=function(tt){this.subscribers.splice(tt,1)};ContextParams.prototype.setCurrentIndex=function(tt){this.index=tt,this.current=this.context[tt],this.backtrack=this.context.slice(0,tt),this.lookahead=this.context.slice(tt+1)};ContextParams.prototype.get=function(tt){switch(!0){case tt===0:return this.current;case(tt<0&&Math.abs(tt)<=this.backtrack.length):return this.backtrack.slice(tt)[0];case(tt>0&&tt<=this.lookahead.length):return this.lookahead[tt-1];default:return null}};Tokenizer.prototype.rangeToText=function(tt){if(tt instanceof ContextRange)return this.getRangeTokens(tt).map(function(_e){return _e.char}).join("")};Tokenizer.prototype.getText=function(){return this.tokens.map(function(tt){return tt.char}).join("")};Tokenizer.prototype.getContext=function(tt){var _e=this.registeredContexts[tt];return _e||null};Tokenizer.prototype.on=function(tt,_e){var rt=this.events[tt];return rt?rt.subscribe(_e):null};Tokenizer.prototype.dispatch=function(tt,_e){var rt=this,it=this.events[tt];it instanceof Event&&it.subscribers.forEach(function(nt){nt.apply(rt,_e||[])})};Tokenizer.prototype.registerContextChecker=function(tt,_e,rt){if(this.getContext(tt))return{FAIL:"context name '"+tt+"' is already registered."};if(typeof _e!="function")return{FAIL:"missing context start check."};if(typeof rt!="function")return{FAIL:"missing context end check."};var it=new ContextChecker(tt,_e,rt);return this.registeredContexts[tt]=it,this.contextCheckers.push(it),it};Tokenizer.prototype.getRangeTokens=function(tt){var _e=tt.startIndex+tt.endOffset;return[].concat(this.tokens.slice(tt.startIndex,_e))};Tokenizer.prototype.getContextRanges=function(tt){var _e=this.getContext(tt);return _e?_e.ranges:{FAIL:"context checker '"+tt+"' is not registered."}};Tokenizer.prototype.resetContextsRanges=function(){var tt=this.registeredContexts;for(var _e in tt)if(tt.hasOwnProperty(_e)){var rt=tt[_e];rt.ranges=[]}};Tokenizer.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var tt=this.tokens.map(function(it){return it.char}),_e=0;_e<tt.length;_e++){var rt=new ContextParams(tt,_e);this.runContextCheck(rt)}this.dispatch("updateContextsRanges",[this.registeredContexts])};Tokenizer.prototype.setEndOffset=function(tt,_e){var rt=this.getContext(_e).openRange.startIndex,it=new ContextRange(rt,tt,_e),nt=this.getContext(_e).ranges;return it.rangeId=_e+"."+nt.length,nt.push(it),this.getContext(_e).openRange=null,it};Tokenizer.prototype.runContextCheck=function(tt){var _e=this,rt=tt.index;this.contextCheckers.forEach(function(it){var nt=it.contextName,st=_e.getContext(nt).openRange;if(!st&&it.checkStart(tt)&&(st=new ContextRange(rt,null,nt),_e.getContext(nt).openRange=st,_e.dispatch("contextStart",[nt,rt])),st&&it.checkEnd(tt)){var at=rt-st.startIndex+1,lt=_e.setEndOffset(at,nt);_e.dispatch("contextEnd",[nt,lt])}})};Tokenizer.prototype.tokenize=function(tt){this.tokens=[],this.resetContextsRanges();var _e=Array.from(tt);this.dispatch("start");for(var rt=0;rt<_e.length;rt++){var it=_e[rt],nt=new ContextParams(_e,rt);this.dispatch("next",[nt]),this.runContextCheck(nt);var st=new Token(it);this.tokens.push(st),this.dispatch("newToken",[st,nt])}return this.dispatch("end",[this.tokens]),this.tokens};function isArabicChar(tt){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(tt)}function isIsolatedArabicChar(tt){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(tt)}function isTashkeelArabicChar(tt){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(tt)}function isLatinChar(tt){return/[A-z]/.test(tt)}function isWhiteSpace(tt){return/\s/.test(tt)}function FeatureQuery(tt){this.font=tt,this.features={}}function SubstitutionAction(tt){this.id=tt.id,this.tag=tt.tag,this.substitution=tt.substitution}function lookupCoverage(tt,_e){if(!tt)return-1;switch(_e.format){case 1:return _e.glyphs.indexOf(tt);case 2:for(var rt=_e.ranges,it=0;it<rt.length;it++){var nt=rt[it];if(tt>=nt.start&&tt<=nt.end){var st=tt-nt.start;return nt.index+st}}break;default:return-1}return-1}function singleSubstitutionFormat1(tt,_e){var rt=lookupCoverage(tt,_e.coverage);return rt===-1?null:tt+_e.deltaGlyphId}function singleSubstitutionFormat2(tt,_e){var rt=lookupCoverage(tt,_e.coverage);return rt===-1?null:_e.substitute[rt]}function lookupCoverageList(tt,_e){for(var rt=[],it=0;it<tt.length;it++){var nt=tt[it],st=_e.current;st=Array.isArray(st)?st[0]:st;var at=lookupCoverage(st,nt);at!==-1&&rt.push(at)}return rt.length!==tt.length?-1:rt}function chainingSubstitutionFormat3(tt,_e){var rt=_e.inputCoverage.length+_e.lookaheadCoverage.length+_e.backtrackCoverage.length;if(tt.context.length<rt)return[];var it=lookupCoverageList(_e.inputCoverage,tt);if(it===-1)return[];var nt=_e.inputCoverage.length-1;if(tt.lookahead.length<_e.lookaheadCoverage.length)return[];for(var st=tt.lookahead.slice(nt);st.length&&isTashkeelArabicChar(st[0].char);)st.shift();var at=new ContextParams(st,0),lt=lookupCoverageList(_e.lookaheadCoverage,at),ot=[].concat(tt.backtrack);for(ot.reverse();ot.length&&isTashkeelArabicChar(ot[0].char);)ot.shift();if(ot.length<_e.backtrackCoverage.length)return[];var ct=new ContextParams(ot,0),ut=lookupCoverageList(_e.backtrackCoverage,ct),ht=it.length===_e.inputCoverage.length&&lt.length===_e.lookaheadCoverage.length&&ut.length===_e.backtrackCoverage.length,dt=[];if(ht)for(var pt=0;pt<_e.lookupRecords.length;pt++)for(var ft=_e.lookupRecords[pt],gt=ft.lookupListIndex,mt=this.getLookupByIndex(gt),At=0;At<mt.subtables.length;At++){var yt=mt.subtables[At],bt=this.getLookupMethod(mt,yt),xt=this.getSubstitutionType(mt,yt);if(xt==="12")for(var vt=0;vt<it.length;vt++){var _t=tt.get(vt),Ct=bt(_t);Ct&&dt.push(Ct)}}return dt}function ligatureSubstitutionFormat1(tt,_e){var rt=tt.current,it=lookupCoverage(rt,_e.coverage);if(it===-1)return null;for(var nt,st=_e.ligatureSets[it],at=0;at<st.length;at++){nt=st[at];for(var lt=0;lt<nt.components.length;lt++){var ot=tt.lookahead[lt],ct=nt.components[lt];if(ot!==ct)break;if(lt===nt.components.length-1)return nt}}return null}function decompositionSubstitutionFormat1(tt,_e){var rt=lookupCoverage(tt,_e.coverage);return rt===-1?null:_e.sequences[rt]}FeatureQuery.prototype.getDefaultScriptFeaturesIndexes=function(){for(var tt=this.font.tables.gsub.scripts,_e=0;_e<tt.length;_e++){var rt=tt[_e];if(rt.tag==="DFLT")return rt.script.defaultLangSys.featureIndexes}return[]};FeatureQuery.prototype.getScriptFeaturesIndexes=function(tt){var _e=this.font.tables;if(!_e.gsub)return[];if(!tt)return this.getDefaultScriptFeaturesIndexes();for(var rt=this.font.tables.gsub.scripts,it=0;it<rt.length;it++){var nt=rt[it];if(nt.tag===tt&&nt.script.defaultLangSys)return nt.script.defaultLangSys.featureIndexes;var st=nt.langSysRecords;if(st)for(var at=0;at<st.length;at++){var lt=st[at];if(lt.tag===tt){var ot=lt.langSys;return ot.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()};FeatureQuery.prototype.mapTagsToFeatures=function(tt,_e){for(var rt={},it=0;it<tt.length;it++){var nt=tt[it].tag,st=tt[it].feature;rt[nt]=st}this.features[_e].tags=rt};FeatureQuery.prototype.getScriptFeatures=function(tt){var _e=this.features[tt];if(this.features.hasOwnProperty(tt))return _e;var rt=this.getScriptFeaturesIndexes(tt);if(!rt)return null;var it=this.font.tables.gsub;return _e=rt.map(function(nt){return it.features[nt]}),this.features[tt]=_e,this.mapTagsToFeatures(_e,tt),_e};FeatureQuery.prototype.getSubstitutionType=function(tt,_e){var rt=tt.lookupType.toString(),it=_e.substFormat.toString();return rt+it};FeatureQuery.prototype.getLookupMethod=function(tt,_e){var rt=this,it=this.getSubstitutionType(tt,_e);switch(it){case"11":return function(nt){return singleSubstitutionFormat1.apply(rt,[nt,_e])};case"12":return function(nt){return singleSubstitutionFormat2.apply(rt,[nt,_e])};case"63":return function(nt){return chainingSubstitutionFormat3.apply(rt,[nt,_e])};case"41":return function(nt){return ligatureSubstitutionFormat1.apply(rt,[nt,_e])};case"21":return function(nt){return decompositionSubstitutionFormat1.apply(rt,[nt,_e])};default:throw new Error("lookupType: "+tt.lookupType+" - substFormat: "+_e.substFormat+" is not yet supported")}};FeatureQuery.prototype.lookupFeature=function(tt){var _e=tt.contextParams,rt=_e.index,it=this.getFeature({tag:tt.tag,script:tt.script});if(!it)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+tt.tag+"' for script '"+tt.script+"'.");for(var nt=this.getFeatureLookups(it),st=[].concat(_e.context),at=0;at<nt.length;at++)for(var lt=nt[at],ot=this.getLookupSubtables(lt),ct=0;ct<ot.length;ct++){var ut=ot[ct],ht=this.getSubstitutionType(lt,ut),dt=this.getLookupMethod(lt,ut),pt=void 0;switch(ht){case"11":pt=dt(_e.current),pt&&st.splice(rt,1,new SubstitutionAction({id:11,tag:tt.tag,substitution:pt}));break;case"12":pt=dt(_e.current),pt&&st.splice(rt,1,new SubstitutionAction({id:12,tag:tt.tag,substitution:pt}));break;case"63":pt=dt(_e),Array.isArray(pt)&&pt.length&&st.splice(rt,1,new SubstitutionAction({id:63,tag:tt.tag,substitution:pt}));break;case"41":pt=dt(_e),pt&&st.splice(rt,1,new SubstitutionAction({id:41,tag:tt.tag,substitution:pt}));break;case"21":pt=dt(_e.current),pt&&st.splice(rt,1,new SubstitutionAction({id:21,tag:tt.tag,substitution:pt}));break}_e=new ContextParams(st,rt),!(Array.isArray(pt)&&!pt.length)&&(pt=null)}return st.length?st:null};FeatureQuery.prototype.supports=function(tt){if(!tt.script)return!1;this.getScriptFeatures(tt.script);var _e=this.features.hasOwnProperty(tt.script);if(!tt.tag)return _e;var rt=this.features[tt.script].some(function(it){return it.tag===tt.tag});return _e&&rt};FeatureQuery.prototype.getLookupSubtables=function(tt){return tt.subtables||null};FeatureQuery.prototype.getLookupByIndex=function(tt){var _e=this.font.tables.gsub.lookups;return _e[tt]||null};FeatureQuery.prototype.getFeatureLookups=function(tt){return tt.lookupListIndexes.map(this.getLookupByIndex.bind(this))};FeatureQuery.prototype.getFeature=function(_e){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(_e.script)||this.getScriptFeatures(_e.script);var rt=this.features[_e.script];return rt?rt.tags[_e.tag]?this.features[_e.script].tags[_e.tag]:null:{FAIL:"No feature for script "+_e.script}};function arabicWordStartCheck(tt){var _e=tt.current,rt=tt.get(-1);return rt===null&&isArabicChar(_e)||!isArabicChar(rt)&&isArabicChar(_e)}function arabicWordEndCheck(tt){var _e=tt.get(1);return _e===null||!isArabicChar(_e)}var arabicWordCheck={startCheck:arabicWordStartCheck,endCheck:arabicWordEndCheck};function arabicSentenceStartCheck(tt){var _e=tt.current,rt=tt.get(-1);return(isArabicChar(_e)||isTashkeelArabicChar(_e))&&!isArabicChar(rt)}function arabicSentenceEndCheck(tt){var _e=tt.get(1);switch(!0){case _e===null:return!0;case(!isArabicChar(_e)&&!isTashkeelArabicChar(_e)):var rt=isWhiteSpace(_e);if(!rt)return!0;if(rt){var it=!1;if(it=tt.lookahead.some(function(nt){return isArabicChar(nt)||isTashkeelArabicChar(nt)}),!it)return!0}break;default:return!1}}var arabicSentenceCheck={startCheck:arabicSentenceStartCheck,endCheck:arabicSentenceEndCheck};function singleSubstitutionFormat1$1(tt,_e,rt){_e[rt].setState(tt.tag,tt.substitution)}function singleSubstitutionFormat2$1(tt,_e,rt){_e[rt].setState(tt.tag,tt.substitution)}function chainingSubstitutionFormat3$1(tt,_e,rt){tt.substitution.forEach(function(it,nt){var st=_e[rt+nt];st.setState(tt.tag,it)})}function ligatureSubstitutionFormat1$1(tt,_e,rt){var it=_e[rt];it.setState(tt.tag,tt.substitution.ligGlyph);for(var nt=tt.substitution.components.length,st=0;st<nt;st++)it=_e[rt+st+1],it.setState("deleted",!0)}var SUBSTITUTIONS={11:singleSubstitutionFormat1$1,12:singleSubstitutionFormat2$1,63:chainingSubstitutionFormat3$1,41:ligatureSubstitutionFormat1$1};function applySubstitution(tt,_e,rt){tt instanceof SubstitutionAction&&SUBSTITUTIONS[tt.id]&&SUBSTITUTIONS[tt.id](tt,_e,rt)}function willConnectPrev(tt){for(var _e=[].concat(tt.backtrack),rt=_e.length-1;rt>=0;rt--){var it=_e[rt],nt=isIsolatedArabicChar(it),st=isTashkeelArabicChar(it);if(!nt&&!st)return!0;if(nt)return!1}return!1}function willConnectNext(tt){if(isIsolatedArabicChar(tt.current))return!1;for(var _e=0;_e<tt.lookahead.length;_e++){var rt=tt.lookahead[_e],it=isTashkeelArabicChar(rt);if(!it)return!0}return!1}function arabicPresentationForms(tt){var _e=this,rt="arab",it=this.featuresTags[rt],nt=this.tokenizer.getRangeTokens(tt);if(nt.length!==1){var st=new ContextParams(nt.map(function(lt){return lt.getState("glyphIndex")}),0),at=new ContextParams(nt.map(function(lt){return lt.char}),0);nt.forEach(function(lt,ot){if(!isTashkeelArabicChar(lt.char)){st.setCurrentIndex(ot),at.setCurrentIndex(ot);var ct=0;willConnectPrev(at)&&(ct|=1),willConnectNext(at)&&(ct|=2);var ut;switch(ct){case 1:ut="fina";break;case 2:ut="init";break;case 3:ut="medi";break}if(it.indexOf(ut)!==-1){var ht=_e.query.lookupFeature({tag:ut,script:rt,contextParams:st});if(ht instanceof Error)return console.info(ht.message);ht.forEach(function(dt,pt){dt instanceof SubstitutionAction&&(applySubstitution(dt,nt,pt),st.context[pt]=dt.substitution)})}}})}}function getContextParams(tt,_e){var rt=tt.map(function(it){return it.activeState.value});return new ContextParams(rt,_e||0)}function arabicRequiredLigatures(tt){var _e=this,rt="arab",it=this.tokenizer.getRangeTokens(tt),nt=getContextParams(it);nt.context.forEach(function(st,at){nt.setCurrentIndex(at);var lt=_e.query.lookupFeature({tag:"rlig",script:rt,contextParams:nt});lt.length&&(lt.forEach(function(ot){return applySubstitution(ot,it,at)}),nt=getContextParams(it))})}function latinWordStartCheck(tt){var _e=tt.current,rt=tt.get(-1);return rt===null&&isLatinChar(_e)||!isLatinChar(rt)&&isLatinChar(_e)}function latinWordEndCheck(tt){var _e=tt.get(1);return _e===null||!isLatinChar(_e)}var latinWordCheck={startCheck:latinWordStartCheck,endCheck:latinWordEndCheck};function getContextParams$1(tt,_e){var rt=tt.map(function(it){return it.activeState.value});return new ContextParams(rt,_e||0)}function latinLigature(tt){var _e=this,rt="latn",it=this.tokenizer.getRangeTokens(tt),nt=getContextParams$1(it);nt.context.forEach(function(st,at){nt.setCurrentIndex(at);var lt=_e.query.lookupFeature({tag:"liga",script:rt,contextParams:nt});lt.length&&(lt.forEach(function(ot){return applySubstitution(ot,it,at)}),nt=getContextParams$1(it))})}function Bidi(tt){this.baseDir=tt||"ltr",this.tokenizer=new Tokenizer,this.featuresTags={}}Bidi.prototype.setText=function(tt){this.text=tt};Bidi.prototype.contextChecks={latinWordCheck,arabicWordCheck,arabicSentenceCheck};function registerContextChecker(tt){var _e=this.contextChecks[tt+"Check"];return this.tokenizer.registerContextChecker(tt,_e.startCheck,_e.endCheck)}function tokenizeText(){return registerContextChecker.call(this,"latinWord"),registerContextChecker.call(this,"arabicWord"),registerContextChecker.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function reverseArabicSentences(){var tt=this,_e=this.tokenizer.getContextRanges("arabicSentence");_e.forEach(function(rt){var it=tt.tokenizer.getRangeTokens(rt);tt.tokenizer.replaceRange(rt.startIndex,rt.endOffset,it.reverse())})}Bidi.prototype.registerFeatures=function(tt,_e){var rt=this,it=_e.filter(function(nt){return rt.query.supports({script:tt,tag:nt})});this.featuresTags.hasOwnProperty(tt)?this.featuresTags[tt]=this.featuresTags[tt].concat(it):this.featuresTags[tt]=it};Bidi.prototype.applyFeatures=function(tt,_e){if(!tt)throw new Error("No valid font was provided to apply features");this.query||(this.query=new FeatureQuery(tt));for(var rt=0;rt<_e.length;rt++){var it=_e[rt];this.query.supports({script:it.script})&&this.registerFeatures(it.script,it.tags)}};Bidi.prototype.registerModifier=function(tt,_e,rt){this.tokenizer.registerModifier(tt,_e,rt)};function checkGlyphIndexStatus(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function applyArabicPresentationForms(){var tt=this,_e="arab";if(this.featuresTags.hasOwnProperty(_e)){checkGlyphIndexStatus.call(this);var rt=this.tokenizer.getContextRanges("arabicWord");rt.forEach(function(it){arabicPresentationForms.call(tt,it)})}}function applyArabicRequireLigatures(){var tt=this,_e="arab";if(this.featuresTags.hasOwnProperty(_e)){var rt=this.featuresTags[_e];if(rt.indexOf("rlig")!==-1){checkGlyphIndexStatus.call(this);var it=this.tokenizer.getContextRanges("arabicWord");it.forEach(function(nt){arabicRequiredLigatures.call(tt,nt)})}}}function applyLatinLigatures(){var tt=this,_e="latn";if(this.featuresTags.hasOwnProperty(_e)){var rt=this.featuresTags[_e];if(rt.indexOf("liga")!==-1){checkGlyphIndexStatus.call(this);var it=this.tokenizer.getContextRanges("latinWord");it.forEach(function(nt){latinLigature.call(tt,nt)})}}}Bidi.prototype.checkContextReady=function(tt){return!!this.tokenizer.getContext(tt)};Bidi.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(applyArabicPresentationForms.call(this),applyArabicRequireLigatures.call(this)),this.checkContextReady("latinWord")&&applyLatinLigatures.call(this),this.checkContextReady("arabicSentence")&&reverseArabicSentences.call(this)};Bidi.prototype.processText=function(tt){(!this.text||this.text!==tt)&&(this.setText(tt),tokenizeText.call(this),this.applyFeaturesToContexts())};Bidi.prototype.getBidiText=function(tt){return this.processText(tt),this.tokenizer.getText()};Bidi.prototype.getTextGlyphs=function(tt){this.processText(tt);for(var _e=[],rt=0;rt<this.tokenizer.tokens.length;rt++){var it=this.tokenizer.tokens[rt];if(!it.state.deleted){var nt=it.activeState.value;_e.push(Array.isArray(nt)?nt[0]:nt)}}return _e};function Font$1(tt){tt=tt||{},tt.tables=tt.tables||{},tt.empty||(checkArgument(tt.familyName,"When creating a new Font object, familyName is required."),checkArgument(tt.styleName,"When creating a new Font object, styleName is required."),checkArgument(tt.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),checkArgument(tt.ascender,"When creating a new Font object, ascender is required."),checkArgument(tt.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:tt.familyName||" "},fontSubfamily:{en:tt.styleName||" "},fullName:{en:tt.fullName||tt.familyName+" "+tt.styleName},postScriptName:{en:tt.postScriptName||(tt.familyName+tt.styleName).replace(/\s/g,"")},designer:{en:tt.designer||" "},designerURL:{en:tt.designerURL||" "},manufacturer:{en:tt.manufacturer||" "},manufacturerURL:{en:tt.manufacturerURL||" "},license:{en:tt.license||" "},licenseURL:{en:tt.licenseURL||" "},version:{en:tt.version||"Version 0.1"},description:{en:tt.description||" "},copyright:{en:tt.copyright||" "},trademark:{en:tt.trademark||" "}},this.unitsPerEm=tt.unitsPerEm||1e3,this.ascender=tt.ascender,this.descender=tt.descender,this.createdTimestamp=tt.createdTimestamp,this.tables=Object.assign(tt.tables,{os2:Object.assign({usWeightClass:tt.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:tt.widthClass||this.usWidthClasses.MEDIUM,fsSelection:tt.fsSelection||this.fsSelectionValues.REGULAR},tt.tables.os2)})),this.supported=!0,this.glyphs=new glyphset.GlyphSet(this,tt.glyphs||[]),this.encoding=new DefaultEncoding(this),this.position=new Position(this),this.substitution=new Substitution(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new Hinting(this)}})}Font$1.prototype.hasChar=function(tt){return this.encoding.charToGlyphIndex(tt)!==null};Font$1.prototype.charToGlyphIndex=function(tt){return this.encoding.charToGlyphIndex(tt)};Font$1.prototype.charToGlyph=function(tt){var _e=this.charToGlyphIndex(tt),rt=this.glyphs.get(_e);return rt||(rt=this.glyphs.get(0)),rt};Font$1.prototype.updateFeatures=function(tt){return this.defaultRenderOptions.features.map(function(_e){return _e.script==="latn"?{script:"latn",tags:_e.tags.filter(function(rt){return tt[rt]})}:_e})};Font$1.prototype.stringToGlyphs=function(tt,_e){var rt=this,it=new Bidi,nt=function(ht){return rt.charToGlyphIndex(ht.char)};it.registerModifier("glyphIndex",null,nt);var st=_e?this.updateFeatures(_e.features):this.defaultRenderOptions.features;it.applyFeatures(this,st);for(var at=it.getTextGlyphs(tt),lt=at.length,ot=new Array(lt),ct=this.glyphs.get(0),ut=0;ut<lt;ut+=1)ot[ut]=this.glyphs.get(at[ut])||ct;return ot};Font$1.prototype.nameToGlyphIndex=function(tt){return this.glyphNames.nameToGlyphIndex(tt)};Font$1.prototype.nameToGlyph=function(tt){var _e=this.nameToGlyphIndex(tt),rt=this.glyphs.get(_e);return rt||(rt=this.glyphs.get(0)),rt};Font$1.prototype.glyphIndexToName=function(tt){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(tt):""};Font$1.prototype.getKerningValue=function(tt,_e){tt=tt.index||tt,_e=_e.index||_e;var rt=this.position.defaultKerningTables;return rt?this.position.getKerningValue(rt,tt,_e):this.kerningPairs[tt+","+_e]||0};Font$1.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]};Font$1.prototype.forEachGlyph=function(tt,_e,rt,it,nt,st){_e=_e!==void 0?_e:0,rt=rt!==void 0?rt:0,it=it!==void 0?it:72,nt=Object.assign({},this.defaultRenderOptions,nt);var at=1/this.unitsPerEm*it,lt=this.stringToGlyphs(tt,nt),ot;if(nt.kerning){var ct=nt.script||this.position.getDefaultScriptName();ot=this.position.getKerningTables(ct,nt.language)}for(var ut=0;ut<lt.length;ut+=1){var ht=lt[ut];if(st.call(this,ht,_e,rt,it,nt),ht.advanceWidth&&(_e+=ht.advanceWidth*at),nt.kerning&&ut<lt.length-1){var dt=ot?this.position.getKerningValue(ot,ht.index,lt[ut+1].index):this.getKerningValue(ht,lt[ut+1]);_e+=dt*at}nt.letterSpacing?_e+=nt.letterSpacing*it:nt.tracking&&(_e+=nt.tracking/1e3*it)}return _e};Font$1.prototype.getPath=function(tt,_e,rt,it,nt){var st=new Path;return this.forEachGlyph(tt,_e,rt,it,nt,function(at,lt,ot,ct){var ut=at.getPath(lt,ot,ct,nt,this);st.extend(ut)}),st};Font$1.prototype.getPaths=function(tt,_e,rt,it,nt){var st=[];return this.forEachGlyph(tt,_e,rt,it,nt,function(at,lt,ot,ct){var ut=at.getPath(lt,ot,ct,nt,this);st.push(ut)}),st};Font$1.prototype.getAdvanceWidth=function(tt,_e,rt){return this.forEachGlyph(tt,0,0,_e,rt,function(){})};Font$1.prototype.draw=function(tt,_e,rt,it,nt,st){this.getPath(_e,rt,it,nt,st).draw(tt)};Font$1.prototype.drawPoints=function(tt,_e,rt,it,nt,st){this.forEachGlyph(_e,rt,it,nt,st,function(at,lt,ot,ct){at.drawPoints(tt,lt,ot,ct)})};Font$1.prototype.drawMetrics=function(tt,_e,rt,it,nt,st){this.forEachGlyph(_e,rt,it,nt,st,function(at,lt,ot,ct){at.drawMetrics(tt,lt,ot,ct)})};Font$1.prototype.getEnglishName=function(tt){var _e=this.names[tt];if(_e)return _e.en};Font$1.prototype.validate=function(){var tt=this;function _e(it,nt){}function rt(it){var nt=tt.getEnglishName(it);nt&&nt.trim().length>0}rt("fontFamily"),rt("weightName"),rt("manufacturer"),rt("copyright"),rt("version"),this.unitsPerEm>0};Font$1.prototype.toTables=function(){return sfnt.fontToTable(this)};Font$1.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()};Font$1.prototype.toArrayBuffer=function(){for(var tt=this.toTables(),_e=tt.encode(),rt=new ArrayBuffer(_e.length),it=new Uint8Array(rt),nt=0;nt<_e.length;nt++)it[nt]=_e[nt];return rt};Font$1.prototype.download=function(tt){var _e=this.getEnglishName("fontFamily"),rt=this.getEnglishName("fontSubfamily");tt=tt||_e.replace(/\s/g,"")+"-"+rt+".otf";var it=this.toArrayBuffer();if(isBrowser$1())if(window.URL=window.URL||window.webkitURL,window.URL){var nt=new DataView(it),st=new Blob([nt],{type:"font/opentype"}),at=document.createElement("a");at.href=window.URL.createObjectURL(st),at.download=tt;var lt=document.createEvent("MouseEvents");lt.initEvent("click",!0,!1),at.dispatchEvent(lt)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var ot=require("fs"),ct=arrayBufferToNodeBuffer(it);ot.writeFileSync(tt,ct)}};Font$1.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512};Font$1.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};Font$1.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var subtableParsers$1=new Array(10);subtableParsers$1[1]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();if(rt===1)return{posFormat:1,coverage:this.parsePointer(Parser$1.coverage),value:this.parseValueRecord()};if(rt===2)return{posFormat:2,coverage:this.parsePointer(Parser$1.coverage),values:this.parseValueRecordList()};check.assert(!1,"0x"+_e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")};subtableParsers$1[2]=function(){var _e=this.offset+this.relativeOffset,rt=this.parseUShort();check.assert(rt===1||rt===2,"0x"+_e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var it=this.parsePointer(Parser$1.coverage),nt=this.parseUShort(),st=this.parseUShort();if(rt===1)return{posFormat:rt,coverage:it,valueFormat1:nt,valueFormat2:st,pairSets:this.parseList(Parser$1.pointer(Parser$1.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(nt),value2:this.parseValueRecord(st)}})))};if(rt===2){var at=this.parsePointer(Parser$1.classDef),lt=this.parsePointer(Parser$1.classDef),ot=this.parseUShort(),ct=this.parseUShort();return{posFormat:rt,coverage:it,valueFormat1:nt,valueFormat2:st,classDef1:at,classDef2:lt,class1Count:ot,class2Count:ct,classRecords:this.parseList(ot,Parser$1.list(ct,function(){return{value1:this.parseValueRecord(nt),value2:this.parseValueRecord(st)}}))}}};subtableParsers$1[3]=function(){return{error:"GPOS Lookup 3 not supported"}};subtableParsers$1[4]=function(){return{error:"GPOS Lookup 4 not supported"}};subtableParsers$1[5]=function(){return{error:"GPOS Lookup 5 not supported"}};subtableParsers$1[6]=function(){return{error:"GPOS Lookup 6 not supported"}};subtableParsers$1[7]=function(){return{error:"GPOS Lookup 7 not supported"}};subtableParsers$1[8]=function(){return{error:"GPOS Lookup 8 not supported"}};subtableParsers$1[9]=function(){return{error:"GPOS Lookup 9 not supported"}};new Array(10);var __defProp=Object.defineProperty,__defNormalProp=(tt,_e,rt)=>_e in tt?__defProp(tt,_e,{enumerable:!0,configurable:!0,writable:!0,value:rt}):tt[_e]=rt,__publicField=(tt,_e,rt)=>(__defNormalProp(tt,typeof _e!="symbol"?_e+"":_e,rt),rt);function toTrianglesDrawMode$1(tt,_e){if(_e===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),tt;if(_e===TriangleFanDrawMode||_e===TriangleStripDrawMode){let rt=tt.getIndex();if(rt===null){const at=[],lt=tt.getAttribute("position");if(lt!==void 0){for(let ot=0;ot<lt.count;ot++)at.push(ot);tt.setIndex(at),rt=tt.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),tt}const it=rt.count-2,nt=[];if(rt)if(_e===TriangleFanDrawMode)for(let at=1;at<=it;at++)nt.push(rt.getX(0)),nt.push(rt.getX(at)),nt.push(rt.getX(at+1));else for(let at=0;at<it;at++)at%2===0?(nt.push(rt.getX(at)),nt.push(rt.getX(at+1)),nt.push(rt.getX(at+2))):(nt.push(rt.getX(at+2)),nt.push(rt.getX(at+1)),nt.push(rt.getX(at)));nt.length/3!==it&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const st=tt.clone();return st.setIndex(nt),st.clearGroups(),st}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_e),tt}new Color$1;const _DRACOExporter=class{parse(tt,_e={decodeSpeed:5,encodeSpeed:5,encoderMethod:_DRACOExporter.MESH_EDGEBREAKER_ENCODING,quantization:[16,8,8,8,8],exportUvs:!0,exportNormals:!0,exportColor:!1}){if(tt instanceof BufferGeometry&&tt.isBufferGeometry)throw new Error("DRACOExporter: The first parameter of parse() is now an instance of Mesh or Points.");if(DracoEncoderModule===void 0)throw new Error("THREE.DRACOExporter: required the draco_encoder to work.");const rt=tt.geometry,it=DracoEncoderModule(),nt=new it.Encoder;let st,at;if(!rt.isBufferGeometry)throw new Error("THREE.DRACOExporter.parse(geometry, options): geometry is not a THREE.BufferGeometry instance.");if(tt instanceof Mesh&&tt.isMesh){st=new it.MeshBuilder,at=new it.Mesh;const dt=rt.getAttribute("position");st.AddFloatAttributeToMesh(at,it.POSITION,dt.count,dt.itemSize,dt.array);const pt=rt.getIndex();if(pt!==null)st.AddFacesToMesh(at,pt.count/3,pt.array);else{const ft=new(dt.count>65535?Uint32Array:Uint16Array)(dt.count);for(let gt=0;gt<ft.length;gt++)ft[gt]=gt;st.AddFacesToMesh(at,dt.count,ft)}if(_e.exportNormals){const ft=rt.getAttribute("normal");ft!==void 0&&st.AddFloatAttributeToMesh(at,it.NORMAL,ft.count,ft.itemSize,ft.array)}if(_e.exportUvs){const ft=rt.getAttribute("uv");ft!==void 0&&st.AddFloatAttributeToMesh(at,it.TEX_COORD,ft.count,ft.itemSize,ft.array)}if(_e.exportColor){const ft=rt.getAttribute("color");ft!==void 0&&st.AddFloatAttributeToMesh(at,it.COLOR,ft.count,ft.itemSize,ft.array)}}else if(tt instanceof Points&&tt.isPoints){st=new it.PointCloudBuilder,at=new it.PointCloud;const dt=rt.getAttribute("position");if(st.AddFloatAttribute(at,it.POSITION,dt.count,dt.itemSize,dt.array),_e.exportColor){const pt=rt.getAttribute("color");pt!==void 0&&st.AddFloatAttribute(at,it.COLOR,pt.count,pt.itemSize,pt.array)}}else throw new Error("DRACOExporter: Unsupported object type.");const lt=new it.DracoInt8Array,ot=_e.encodeSpeed!==void 0?_e.encodeSpeed:5,ct=_e.decodeSpeed!==void 0?_e.decodeSpeed:5;if(nt.SetSpeedOptions(ot,ct),_e.encoderMethod!==void 0&&nt.SetEncodingMethod(_e.encoderMethod),_e.quantization!==void 0)for(let dt=0;dt<5;dt++)_e.quantization[dt]!==void 0&&nt.SetAttributeQuantization(dt,_e.quantization[dt]);let ut;if(tt instanceof Mesh&&tt.isMesh?ut=nt.EncodeMeshToDracoBuffer(at,lt):ut=nt.EncodePointCloudToDracoBuffer(at,!0,lt),it.destroy(at),ut===0)throw new Error("THREE.DRACOExporter: Draco encoding failed.");const ht=new Int8Array(new ArrayBuffer(ut));for(let dt=0;dt<ut;dt++)ht[dt]=lt.GetValue(dt);return it.destroy(lt),it.destroy(nt),it.destroy(st),ht}};let DRACOExporter=_DRACOExporter;__publicField(DRACOExporter,"MESH_EDGEBREAKER_ENCODING",1);__publicField(DRACOExporter,"MESH_SEQUENTIAL_ENCODING",0);__publicField(DRACOExporter,"POINT_CLOUD",0);__publicField(DRACOExporter,"TRIANGULAR_MESH",1);__publicField(DRACOExporter,"INVALID",-1);__publicField(DRACOExporter,"POSITION",0);__publicField(DRACOExporter,"NORMAL",1);__publicField(DRACOExporter,"COLOR",2);__publicField(DRACOExporter,"TEX_COORD",3);__publicField(DRACOExporter,"GENERIC",4);const _Reflector=class extends Mesh{constructor(tt,_e={}){super(tt),this.isReflector=!0,this.type="Reflector",this.camera=new PerspectiveCamera;const rt=this,it=_e.color!==void 0?new Color$1(_e.color):new Color$1(8355711),nt=_e.textureWidth||512,st=_e.textureHeight||512,at=_e.clipBias||0,lt=_e.shader||_Reflector.ReflectorShader,ot=_e.multisample!==void 0?_e.multisample:4,ct=new Plane,ut=new Vector3,ht=new Vector3,dt=new Vector3,pt=new Matrix4,ft=new Vector3(0,0,-1),gt=new Vector4,mt=new Vector3,At=new Vector3,yt=new Vector4,bt=new Matrix4,xt=this.camera,vt=new WebGLRenderTarget(nt,st,{samples:ot,type:HalfFloatType}),_t=new ShaderMaterial({uniforms:UniformsUtils.clone(lt.uniforms),fragmentShader:lt.fragmentShader,vertexShader:lt.vertexShader});_t.uniforms.tDiffuse.value=vt.texture,_t.uniforms.color.value=it,_t.uniforms.textureMatrix.value=bt,this.material=_t,this.onBeforeRender=function(Ct,St,Et){if(ht.setFromMatrixPosition(rt.matrixWorld),dt.setFromMatrixPosition(Et.matrixWorld),pt.extractRotation(rt.matrixWorld),ut.set(0,0,1),ut.applyMatrix4(pt),mt.subVectors(ht,dt),mt.dot(ut)>0)return;mt.reflect(ut).negate(),mt.add(ht),pt.extractRotation(Et.matrixWorld),ft.set(0,0,-1),ft.applyMatrix4(pt),ft.add(dt),At.subVectors(ht,ft),At.reflect(ut).negate(),At.add(ht),xt.position.copy(mt),xt.up.set(0,1,0),xt.up.applyMatrix4(pt),xt.up.reflect(ut),xt.lookAt(At),xt.far=Et.far,xt.updateMatrixWorld(),xt.projectionMatrix.copy(Et.projectionMatrix),bt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),bt.multiply(xt.projectionMatrix),bt.multiply(xt.matrixWorldInverse),bt.multiply(rt.matrixWorld),ct.setFromNormalAndCoplanarPoint(ut,ht),ct.applyMatrix4(xt.matrixWorldInverse),gt.set(ct.normal.x,ct.normal.y,ct.normal.z,ct.constant);const Tt=xt.projectionMatrix;yt.x=(Math.sign(gt.x)+Tt.elements[8])/Tt.elements[0],yt.y=(Math.sign(gt.y)+Tt.elements[9])/Tt.elements[5],yt.z=-1,yt.w=(1+Tt.elements[10])/Tt.elements[14],gt.multiplyScalar(2/gt.dot(yt)),Tt.elements[2]=gt.x,Tt.elements[6]=gt.y,Tt.elements[10]=gt.z+1-at,Tt.elements[14]=gt.w,rt.visible=!1;const Mt=Ct.getRenderTarget(),Rt=Ct.xr.enabled,It=Ct.shadowMap.autoUpdate,Ot=Ct.toneMapping;let Bt=!1;"outputColorSpace"in Ct?Bt=Ct.outputColorSpace==="srgb":Bt=Ct.outputEncoding===3001,Ct.xr.enabled=!1,Ct.shadowMap.autoUpdate=!1,"outputColorSpace"in Ct?Ct.outputColorSpace="linear-srgb":Ct.outputEncoding=3e3,Ct.toneMapping=NoToneMapping,Ct.setRenderTarget(vt),Ct.state.buffers.depth.setMask(!0),Ct.autoClear===!1&&Ct.clear(),Ct.render(St,xt),Ct.xr.enabled=Rt,Ct.shadowMap.autoUpdate=It,Ct.toneMapping=Ot,"outputColorSpace"in Ct?Ct.outputColorSpace=Bt?"srgb":"srgb-linear":Ct.outputEncoding=Bt?3001:3e3,Ct.setRenderTarget(Mt);const Nt=Et.viewport;Nt!==void 0&&Ct.state.viewport(Nt),rt.visible=!0},this.getRenderTarget=function(){return vt},this.dispose=function(){vt.dispose(),rt.material.dispose()}}};let Reflector=_Reflector;__publicField(Reflector,"ReflectorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>

		}`});const _Refractor=class extends Mesh{constructor(tt,_e={}){super(tt),this.isRefractor=!0,this.type="Refractor",this.camera=new PerspectiveCamera;const rt=this,it=_e.color!==void 0?new Color$1(_e.color):new Color$1(8355711),nt=_e.textureWidth||512,st=_e.textureHeight||512,at=_e.clipBias||0,lt=_e.shader||_Refractor.RefractorShader,ot=_e.multisample!==void 0?_e.multisample:4,ct=this.camera;ct.matrixAutoUpdate=!1,ct.userData.refractor=!0;const ut=new Plane,ht=new Matrix4,dt=new WebGLRenderTarget(nt,st,{samples:ot,type:HalfFloatType});this.material=new ShaderMaterial({uniforms:UniformsUtils.clone(lt.uniforms),vertexShader:lt.vertexShader,fragmentShader:lt.fragmentShader,transparent:!0}),this.material.uniforms.color.value=it,this.material.uniforms.tDiffuse.value=dt.texture,this.material.uniforms.textureMatrix.value=ht;const pt=function(){const yt=new Vector3,bt=new Vector3,xt=new Matrix4,vt=new Vector3,_t=new Vector3;return function(St){return yt.setFromMatrixPosition(rt.matrixWorld),bt.setFromMatrixPosition(St.matrixWorld),vt.subVectors(yt,bt),xt.extractRotation(rt.matrixWorld),_t.set(0,0,1),_t.applyMatrix4(xt),vt.dot(_t)<0}}(),ft=function(){const yt=new Vector3,bt=new Vector3,xt=new Quaternion,vt=new Vector3;return function(){rt.matrixWorld.decompose(bt,xt,vt),yt.set(0,0,1).applyQuaternion(xt).normalize(),yt.negate(),ut.setFromNormalAndCoplanarPoint(yt,bt)}}(),gt=function(){const yt=new Plane,bt=new Vector4,xt=new Vector4;return function(_t){ct.matrixWorld.copy(_t.matrixWorld),ct.matrixWorldInverse.copy(ct.matrixWorld).invert(),ct.projectionMatrix.copy(_t.projectionMatrix),ct.far=_t.far,yt.copy(ut),yt.applyMatrix4(ct.matrixWorldInverse),bt.set(yt.normal.x,yt.normal.y,yt.normal.z,yt.constant);const Ct=ct.projectionMatrix;xt.x=(Math.sign(bt.x)+Ct.elements[8])/Ct.elements[0],xt.y=(Math.sign(bt.y)+Ct.elements[9])/Ct.elements[5],xt.z=-1,xt.w=(1+Ct.elements[10])/Ct.elements[14],bt.multiplyScalar(2/bt.dot(xt)),Ct.elements[2]=bt.x,Ct.elements[6]=bt.y,Ct.elements[10]=bt.z+1-at,Ct.elements[14]=bt.w}}();function mt(yt){ht.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ht.multiply(yt.projectionMatrix),ht.multiply(yt.matrixWorldInverse),ht.multiply(rt.matrixWorld)}function At(yt,bt,xt){rt.visible=!1;const vt=yt.getRenderTarget(),_t=yt.xr.enabled,Ct=yt.shadowMap.autoUpdate,St=yt.toneMapping;let Et=!1;"outputColorSpace"in yt?Et=yt.outputColorSpace==="srgb":Et=yt.outputEncoding===3001,yt.xr.enabled=!1,yt.shadowMap.autoUpdate=!1,"outputColorSpace"in yt?yt.outputColorSpace="linear-srgb":yt.outputEncoding=3e3,yt.toneMapping=NoToneMapping,yt.setRenderTarget(dt),yt.autoClear===!1&&yt.clear(),yt.render(bt,ct),yt.xr.enabled=_t,yt.shadowMap.autoUpdate=Ct,yt.toneMapping=St,yt.setRenderTarget(vt),"outputColorSpace"in yt?yt.outputColorSpace=Et?"srgb":"srgb-linear":yt.outputEncoding=Et?3001:3e3;const Tt=xt.viewport;Tt!==void 0&&yt.state.viewport(Tt),rt.visible=!0}this.onBeforeRender=function(yt,bt,xt){xt.userData.refractor!==!0&&pt(xt)&&(ft(),mt(xt),gt(xt),At(yt,bt,xt))},this.getRenderTarget=function(){return dt},this.dispose=function(){dt.dispose(),rt.material.dispose()}}};let Refractor=_Refractor;__publicField(Refractor,"RefractorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`

		uniform mat4 textureMatrix;

		varying vec4 vUv;

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform vec3 color;
		uniform sampler2D tDiffuse;

		varying vec4 vUv;

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>

		}`});const geometry=new BufferGeometry,_Lensflare=class extends Mesh{constructor(){super(_Lensflare.Geometry,new MeshBasicMaterial({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const tt=new Vector3,_e=new Vector3,rt=new DataTexture(new Uint8Array(16*16*3),16,16,RGBAFormat);rt.minFilter=NearestFilter,rt.magFilter=NearestFilter,rt.wrapS=ClampToEdgeWrapping,rt.wrapT=ClampToEdgeWrapping;const it=new DataTexture(new Uint8Array(16*16*3),16,16,RGBAFormat);it.minFilter=NearestFilter,it.magFilter=NearestFilter,it.wrapS=ClampToEdgeWrapping,it.wrapT=ClampToEdgeWrapping;const nt=_Lensflare.Geometry,st=new RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),at=new RawShaderMaterial({uniforms:{map:{value:rt},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),lt=new Mesh(nt,st),ot=[],ct=LensflareElement.Shader,ut=new RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:it},color:{value:new Color$1(16777215)},scale:{value:new Vector2},screenPosition:{value:new Vector3}},vertexShader:ct.vertexShader,fragmentShader:ct.fragmentShader,blending:AdditiveBlending,transparent:!0,depthWrite:!1}),ht=new Mesh(nt,ut);this.addElement=function(mt){ot.push(mt)};const dt=new Vector2,pt=new Vector2,ft=new Box2,gt=new Vector4;this.onBeforeRender=function(mt,At,yt){mt.getCurrentViewport(gt);const bt=gt.w/gt.z,xt=gt.z/2,vt=gt.w/2;let _t=16/gt.w;if(dt.set(_t*bt,_t),ft.min.set(gt.x,gt.y),ft.max.set(gt.x+(gt.z-16),gt.y+(gt.w-16)),_e.setFromMatrixPosition(this.matrixWorld),_e.applyMatrix4(yt.matrixWorldInverse),!(_e.z>0)&&(tt.copy(_e).applyMatrix4(yt.projectionMatrix),pt.x=gt.x+tt.x*xt+xt-8,pt.y=gt.y+tt.y*vt+vt-8,ft.containsPoint(pt))){mt.copyFramebufferToTexture(pt,rt);let Ct=st.uniforms;Ct.scale.value=dt,Ct.screenPosition.value=tt,mt.renderBufferDirect(yt,null,nt,st,lt,null),mt.copyFramebufferToTexture(pt,it),Ct=at.uniforms,Ct.scale.value=dt,Ct.screenPosition.value=tt,mt.renderBufferDirect(yt,null,nt,at,lt,null);const St=-tt.x*2,Et=-tt.y*2;for(let Tt=0,Mt=ot.length;Tt<Mt;Tt++){const Rt=ot[Tt],It=ut.uniforms;It.color.value.copy(Rt.color),It.map.value=Rt.texture,It.screenPosition.value.x=tt.x+St*Rt.distance,It.screenPosition.value.y=tt.y+Et*Rt.distance,_t=Rt.size/gt.w;const Ot=gt.w/gt.z;It.scale.value.set(_t*Ot,_t),ut.uniformsNeedUpdate=!0,mt.renderBufferDirect(yt,null,nt,ut,ht,null)}}},this.dispose=function(){st.dispose(),at.dispose(),ut.dispose(),rt.dispose(),it.dispose();for(let mt=0,At=ot.length;mt<At;mt++)ot[mt].texture.dispose()}}};let Lensflare=_Lensflare;__publicField(Lensflare,"Geometry",geometry);class LensflareElement{constructor(_e,rt=1,it=0,nt=new Color$1(16777215)){this.texture=_e,this.size=rt,this.distance=it,this.color=nt}}__publicField(LensflareElement,"Shader",{uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`});class SimplexNoise{constructor(_e=Math){__publicField(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),__publicField(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),__publicField(this,"p",[]),__publicField(this,"perm",[]),__publicField(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),__publicField(this,"dot",(rt,it,nt)=>rt[0]*it+rt[1]*nt),__publicField(this,"dot3",(rt,it,nt,st)=>rt[0]*it+rt[1]*nt+rt[2]*st),__publicField(this,"dot4",(rt,it,nt,st,at)=>rt[0]*it+rt[1]*nt+rt[2]*st+rt[3]*at),__publicField(this,"noise",(rt,it)=>{let nt,st,at;const lt=.5*(Math.sqrt(3)-1),ot=(rt+it)*lt,ct=Math.floor(rt+ot),ut=Math.floor(it+ot),ht=(3-Math.sqrt(3))/6,dt=(ct+ut)*ht,pt=ct-dt,ft=ut-dt,gt=rt-pt,mt=it-ft;let At=0,yt=1;gt>mt&&(At=1,yt=0);const bt=gt-At+ht,xt=mt-yt+ht,vt=gt-1+2*ht,_t=mt-1+2*ht,Ct=ct&255,St=ut&255,Et=this.perm[Ct+this.perm[St]]%12,Tt=this.perm[Ct+At+this.perm[St+yt]]%12,Mt=this.perm[Ct+1+this.perm[St+1]]%12;let Rt=.5-gt*gt-mt*mt;Rt<0?nt=0:(Rt*=Rt,nt=Rt*Rt*this.dot(this.grad3[Et],gt,mt));let It=.5-bt*bt-xt*xt;It<0?st=0:(It*=It,st=It*It*this.dot(this.grad3[Tt],bt,xt));let Ot=.5-vt*vt-_t*_t;return Ot<0?at=0:(Ot*=Ot,at=Ot*Ot*this.dot(this.grad3[Mt],vt,_t)),70*(nt+st+at)}),__publicField(this,"noise3d",(rt,it,nt)=>{let st,at,lt,ot;const ct=.3333333333333333,ut=(rt+it+nt)*ct,ht=Math.floor(rt+ut),dt=Math.floor(it+ut),pt=Math.floor(nt+ut),ft=1/6,gt=(ht+dt+pt)*ft,mt=ht-gt,At=dt-gt,yt=pt-gt,bt=rt-mt,xt=it-At,vt=nt-yt;let _t,Ct,St,Et,Tt,Mt;bt>=xt?xt>=vt?(_t=1,Ct=0,St=0,Et=1,Tt=1,Mt=0):bt>=vt?(_t=1,Ct=0,St=0,Et=1,Tt=0,Mt=1):(_t=0,Ct=0,St=1,Et=1,Tt=0,Mt=1):xt<vt?(_t=0,Ct=0,St=1,Et=0,Tt=1,Mt=1):bt<vt?(_t=0,Ct=1,St=0,Et=0,Tt=1,Mt=1):(_t=0,Ct=1,St=0,Et=1,Tt=1,Mt=0);const Rt=bt-_t+ft,It=xt-Ct+ft,Ot=vt-St+ft,Bt=bt-Et+2*ft,Nt=xt-Tt+2*ft,zt=vt-Mt+2*ft,Dt=bt-1+3*ft,Ft=xt-1+3*ft,Ut=vt-1+3*ft,$t=ht&255,Vt=dt&255,Zt=pt&255,qt=this.perm[$t+this.perm[Vt+this.perm[Zt]]]%12,sr=this.perm[$t+_t+this.perm[Vt+Ct+this.perm[Zt+St]]]%12,er=this.perm[$t+Et+this.perm[Vt+Tt+this.perm[Zt+Mt]]]%12,ir=this.perm[$t+1+this.perm[Vt+1+this.perm[Zt+1]]]%12;let ur=.6-bt*bt-xt*xt-vt*vt;ur<0?st=0:(ur*=ur,st=ur*ur*this.dot3(this.grad3[qt],bt,xt,vt));let ar=.6-Rt*Rt-It*It-Ot*Ot;ar<0?at=0:(ar*=ar,at=ar*ar*this.dot3(this.grad3[sr],Rt,It,Ot));let lr=.6-Bt*Bt-Nt*Nt-zt*zt;lr<0?lt=0:(lr*=lr,lt=lr*lr*this.dot3(this.grad3[er],Bt,Nt,zt));let gr=.6-Dt*Dt-Ft*Ft-Ut*Ut;return gr<0?ot=0:(gr*=gr,ot=gr*gr*this.dot3(this.grad3[ir],Dt,Ft,Ut)),32*(st+at+lt+ot)}),__publicField(this,"noise4d",(rt,it,nt,st)=>{const at=this.grad4,lt=this.simplex,ot=this.perm,ct=(Math.sqrt(5)-1)/4,ut=(5-Math.sqrt(5))/20;let ht,dt,pt,ft,gt;const mt=(rt+it+nt+st)*ct,At=Math.floor(rt+mt),yt=Math.floor(it+mt),bt=Math.floor(nt+mt),xt=Math.floor(st+mt),vt=(At+yt+bt+xt)*ut,_t=At-vt,Ct=yt-vt,St=bt-vt,Et=xt-vt,Tt=rt-_t,Mt=it-Ct,Rt=nt-St,It=st-Et,Ot=Tt>Mt?32:0,Bt=Tt>Rt?16:0,Nt=Mt>Rt?8:0,zt=Tt>It?4:0,Dt=Mt>It?2:0,Ft=Rt>It?1:0,Ut=Ot+Bt+Nt+zt+Dt+Ft;let $t,Vt,Zt,qt,sr,er,ir,ur,ar,lr,gr,Yt;$t=lt[Ut][0]>=3?1:0,Vt=lt[Ut][1]>=3?1:0,Zt=lt[Ut][2]>=3?1:0,qt=lt[Ut][3]>=3?1:0,sr=lt[Ut][0]>=2?1:0,er=lt[Ut][1]>=2?1:0,ir=lt[Ut][2]>=2?1:0,ur=lt[Ut][3]>=2?1:0,ar=lt[Ut][0]>=1?1:0,lr=lt[Ut][1]>=1?1:0,gr=lt[Ut][2]>=1?1:0,Yt=lt[Ut][3]>=1?1:0;const nr=Tt-$t+ut,mr=Mt-Vt+ut,Sr=Rt-Zt+ut,Er=It-qt+ut,Nr=Tt-sr+2*ut,wr=Mt-er+2*ut,kr=Rt-ir+2*ut,Ur=It-ur+2*ut,Or=Tt-ar+3*ut,Xr=Mt-lr+3*ut,Qt=Rt-gr+3*ut,Xt=It-Yt+3*ut,xr=Tt-1+4*ut,Lr=Mt-1+4*ut,fr=Rt-1+4*ut,pr=It-1+4*ut,Hr=At&255,hr=yt&255,Cr=bt&255,tr=xt&255,Ar=ot[Hr+ot[hr+ot[Cr+ot[tr]]]]%32,yr=ot[Hr+$t+ot[hr+Vt+ot[Cr+Zt+ot[tr+qt]]]]%32,Jt=ot[Hr+sr+ot[hr+er+ot[Cr+ir+ot[tr+ur]]]]%32,_r=ot[Hr+ar+ot[hr+lr+ot[Cr+gr+ot[tr+Yt]]]]%32,Kt=ot[Hr+1+ot[hr+1+ot[Cr+1+ot[tr+1]]]]%32;let Qr=.6-Tt*Tt-Mt*Mt-Rt*Rt-It*It;Qr<0?ht=0:(Qr*=Qr,ht=Qr*Qr*this.dot4(at[Ar],Tt,Mt,Rt,It));let br=.6-nr*nr-mr*mr-Sr*Sr-Er*Er;br<0?dt=0:(br*=br,dt=br*br*this.dot4(at[yr],nr,mr,Sr,Er));let Rr=.6-Nr*Nr-wr*wr-kr*kr-Ur*Ur;Rr<0?pt=0:(Rr*=Rr,pt=Rr*Rr*this.dot4(at[Jt],Nr,wr,kr,Ur));let Tr=.6-Or*Or-Xr*Xr-Qt*Qt-Xt*Xt;Tr<0?ft=0:(Tr*=Tr,ft=Tr*Tr*this.dot4(at[_r],Or,Xr,Qt,Xt));let Vr=.6-xr*xr-Lr*Lr-fr*fr-pr*pr;return Vr<0?gt=0:(Vr*=Vr,gt=Vr*Vr*this.dot4(at[Kt],xr,Lr,fr,pr)),27*(ht+dt+pt+ft+gt)});for(let rt=0;rt<256;rt++)this.p[rt]=Math.floor(_e.random()*256);for(let rt=0;rt<512;rt++)this.perm[rt]=this.p[rt&255]}}const _LightningStrike=class extends BufferGeometry{constructor(tt={}){super(),this.isLightningStrike=!0,this.type="LightningStrike",this.init(_LightningStrike.copyParameters(tt,tt)),this.createMesh()}static createRandomGenerator(){const _e=[];for(let it=0;it<2053;it++)_e.push(Math.random());const rt={currentSeed:0,random:function(){const it=_e[rt.currentSeed];return rt.currentSeed=(rt.currentSeed+1)%2053,it},getSeed:function(){return rt.currentSeed/2053},setSeed:function(it){rt.currentSeed=Math.floor(it*2053)%2053}};return rt}static copyParameters(tt={},_e={}){const rt=function(it){return _e===tt?it:it.clone()};return tt.sourceOffset=_e.sourceOffset!==void 0?rt(_e.sourceOffset):new Vector3(0,100,0),tt.destOffset=_e.destOffset!==void 0?rt(_e.destOffset):new Vector3(0,0,0),tt.timeScale=_e.timeScale!==void 0?_e.timeScale:1,tt.roughness=_e.roughness!==void 0?_e.roughness:.9,tt.straightness=_e.straightness!==void 0?_e.straightness:.7,tt.up0=_e.up0!==void 0?rt(_e.up0):new Vector3(0,0,1),tt.up1=_e.up1!==void 0?rt(_e.up1):new Vector3(0,0,1),tt.radius0=_e.radius0!==void 0?_e.radius0:1,tt.radius1=_e.radius1!==void 0?_e.radius1:1,tt.radius0Factor=_e.radius0Factor!==void 0?_e.radius0Factor:.5,tt.radius1Factor=_e.radius1Factor!==void 0?_e.radius1Factor:.2,tt.minRadius=_e.minRadius!==void 0?_e.minRadius:.2,tt.isEternal=_e.isEternal!==void 0?_e.isEternal:_e.birthTime===void 0||_e.deathTime===void 0,tt.birthTime=_e.birthTime,tt.deathTime=_e.deathTime,tt.propagationTimeFactor=_e.propagationTimeFactor!==void 0?_e.propagationTimeFactor:.1,tt.vanishingTimeFactor=_e.vanishingTimeFactor!==void 0?_e.vanishingTimeFactor:.9,tt.subrayPeriod=_e.subrayPeriod!==void 0?_e.subrayPeriod:4,tt.subrayDutyCycle=_e.subrayDutyCycle!==void 0?_e.subrayDutyCycle:.6,tt.maxIterations=_e.maxIterations!==void 0?_e.maxIterations:9,tt.isStatic=_e.isStatic!==void 0?_e.isStatic:!1,tt.ramification=_e.ramification!==void 0?_e.ramification:5,tt.maxSubrayRecursion=_e.maxSubrayRecursion!==void 0?_e.maxSubrayRecursion:3,tt.recursionProbability=_e.recursionProbability!==void 0?_e.recursionProbability:.6,tt.generateUVs=_e.generateUVs!==void 0?_e.generateUVs:!1,tt.randomGenerator=_e.randomGenerator,tt.noiseSeed=_e.noiseSeed,tt.onDecideSubrayCreation=_e.onDecideSubrayCreation,tt.onSubrayCreation=_e.onSubrayCreation,tt}update(tt){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=tt&&tt<=this.rayParameters.deathTime?(this.updateMesh(tt),tt<this.subrays[0].endPropagationTime?this.state=_LightningStrike.RAY_PROPAGATING:tt>this.subrays[0].beginVanishingTime?this.state=_LightningStrike.RAY_VANISHING:this.state=_LightningStrike.RAY_STEADY,this.visible=!0):(this.visible=!1,tt<this.rayParameters.birthTime?this.state=_LightningStrike.RAY_UNBORN:this.state=_LightningStrike.RAY_EXTINGUISHED))}init(tt){this.rayParameters=tt,this.maxIterations=tt.maxIterations!==void 0?Math.floor(tt.maxIterations):9,tt.maxIterations=this.maxIterations,this.isStatic=tt.isStatic!==void 0?tt.isStatic:!1,tt.isStatic=this.isStatic,this.ramification=tt.ramification!==void 0?Math.floor(tt.ramification):5,tt.ramification=this.ramification,this.maxSubrayRecursion=tt.maxSubrayRecursion!==void 0?Math.floor(tt.maxSubrayRecursion):3,tt.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=tt.recursionProbability!==void 0?tt.recursionProbability:.6,tt.recursionProbability=this.recursionProbability,this.generateUVs=tt.generateUVs!==void 0?tt.generateUVs:!1,tt.generateUVs=this.generateUVs,tt.randomGenerator!==void 0?(this.randomGenerator=tt.randomGenerator,this.seedGenerator=tt.randomGenerator,tt.noiseSeed!==void 0&&this.seedGenerator.setSeed(tt.noiseSeed)):(this.randomGenerator=_LightningStrike.createRandomGenerator(),this.seedGenerator=Math),tt.onDecideSubrayCreation!==void 0?this.onDecideSubrayCreation=tt.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),tt.onSubrayCreation!==void 0&&(this.onSubrayCreation=tt.onSubrayCreation)),this.state=_LightningStrike.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),tt.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(let _e=0;_e<this.maxSubrays;_e++)this.subrays.push(this.createSubray());this.raySegments=[];for(let _e=0;_e<this.maxRaySegments;_e++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new SimplexNoise(this.seedGenerator),this.simplexY=new SimplexNoise(this.seedGenerator),this.simplexZ=new SimplexNoise(this.seedGenerator),this.forwards=new Vector3,this.forwardsFill=new Vector3,this.side=new Vector3,this.down=new Vector3,this.middlePos=new Vector3,this.middleLinPos=new Vector3,this.newPos=new Vector3,this.vPos=new Vector3,this.cross1=new Vector3}createMesh(){const tt=1<<this.maxIterations,_e=3*(tt+1)*this.maxSubrays,rt=18*tt*this.maxSubrays;this.vertices=new Float32Array(_e*3),this.indices=new Uint32Array(rt),this.generateUVs&&(this.uvs=new Float32Array(_e*2)),this.fillMesh(0),this.setIndex(new Uint32BufferAttribute(this.indices,1)),this.positionAttribute=new Float32BufferAttribute(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new Float32BufferAttribute(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=DynamicDrawUsage,this.positionAttribute.usage=DynamicDrawUsage,this.generateUVs&&(this.uvsAttribute.usage=DynamicDrawUsage)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)}updateMesh(tt){this.fillMesh(tt),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)}fillMesh(tt){const _e=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(tt,function(it){const nt=_e.currentSubray;tt<nt.birthTime||(this.rayParameters.isEternal&&_e.currentSubray.recursion==0?(_e.createPrism(it),_e.onDecideSubrayCreation(it,_e)):tt<nt.endPropagationTime?_e.timeFraction>=it.fraction0*nt.propagationTimeFactor&&(_e.createPrism(it),_e.onDecideSubrayCreation(it,_e)):tt<nt.beginVanishingTime?(_e.createPrism(it),_e.onDecideSubrayCreation(it,_e)):(_e.timeFraction<=nt.vanishingTimeFactor+it.fraction1*(1-nt.vanishingTimeFactor)&&_e.createPrism(it),_e.onDecideSubrayCreation(it,_e)))})}addNewSubray(){return this.subrays[this.numSubrays++]}initSubray(tt,_e){tt.pos0.copy(_e.sourceOffset),tt.pos1.copy(_e.destOffset),tt.up0.copy(_e.up0),tt.up1.copy(_e.up1),tt.radius0=_e.radius0,tt.radius1=_e.radius1,tt.birthTime=_e.birthTime,tt.deathTime=_e.deathTime,tt.timeScale=_e.timeScale,tt.roughness=_e.roughness,tt.straightness=_e.straightness,tt.propagationTimeFactor=_e.propagationTimeFactor,tt.vanishingTimeFactor=_e.vanishingTimeFactor,tt.maxIterations=this.maxIterations,tt.seed=_e.noiseSeed!==void 0?_e.noiseSeed:0,tt.recursion=0}fractalRay(tt,_e){this.time=tt,this.currentSegmentCallback=_e,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(let rt=0;rt<this.numSubrays;rt++){const it=this.subrays[rt];this.currentSubray=it,this.randomGenerator.setSeed(it.seed),it.endPropagationTime=MathUtils.lerp(it.birthTime,it.deathTime,it.propagationTimeFactor),it.beginVanishingTime=MathUtils.lerp(it.deathTime,it.birthTime,1-it.vanishingTimeFactor);const nt=this.randomGenerator.random;it.linPos0.set(nt(),nt(),nt()).multiplyScalar(1e3),it.linPos1.set(nt(),nt(),nt()).multiplyScalar(1e3),this.timeFraction=(tt-it.birthTime)/(it.deathTime-it.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;const st=this.getNewSegment();st.iteration=0,st.pos0.copy(it.pos0),st.pos1.copy(it.pos1),st.linPos0.copy(it.linPos0),st.linPos1.copy(it.linPos1),st.up0.copy(it.up0),st.up1.copy(it.up1),st.radius0=it.radius0,st.radius1=it.radius1,st.fraction0=0,st.fraction1=1,st.positionVariationFactor=1-it.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,it.recursion)/(1<<it.maxIterations),this.fractalRayRecursive(st)}this.currentSegmentCallback=null,this.currentSubray=null}fractalRayRecursive(tt){if(tt.iteration>=this.currentSubray.maxIterations){this.currentSegmentCallback(tt);return}this.forwards.subVectors(tt.pos1,tt.pos0);let _e=this.forwards.length();_e<1e-6&&(this.forwards.set(0,0,.01),_e=this.forwards.length());const rt=(tt.radius0+tt.radius1)*.5,it=(tt.fraction0+tt.fraction1)*.5,nt=this.time*this.currentSubray.timeScale*Math.pow(2,tt.iteration);this.middlePos.lerpVectors(tt.pos0,tt.pos1,.5),this.middleLinPos.lerpVectors(tt.linPos0,tt.linPos1,.5);const st=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(st.x,st.y,st.z,nt),this.simplexY.noise4d(st.x,st.y,st.z,nt),this.simplexZ.noise4d(st.x,st.y,st.z,nt)),this.newPos.multiplyScalar(tt.positionVariationFactor*_e),this.newPos.add(this.middlePos);const at=this.getNewSegment();at.pos0.copy(tt.pos0),at.pos1.copy(this.newPos),at.linPos0.copy(tt.linPos0),at.linPos1.copy(this.middleLinPos),at.up0.copy(tt.up0),at.up1.copy(tt.up1),at.radius0=tt.radius0,at.radius1=rt,at.fraction0=tt.fraction0,at.fraction1=it,at.positionVariationFactor=tt.positionVariationFactor*this.currentSubray.roughness,at.iteration=tt.iteration+1;const lt=this.getNewSegment();lt.pos0.copy(this.newPos),lt.pos1.copy(tt.pos1),lt.linPos0.copy(this.middleLinPos),lt.linPos1.copy(tt.linPos1),this.cross1.crossVectors(tt.up0,this.forwards.normalize()),lt.up0.crossVectors(this.forwards,this.cross1).normalize(),lt.up1.copy(tt.up1),lt.radius0=rt,lt.radius1=tt.radius1,lt.fraction0=it,lt.fraction1=tt.fraction1,lt.positionVariationFactor=tt.positionVariationFactor*this.currentSubray.roughness,lt.iteration=tt.iteration+1,this.fractalRayRecursive(at),this.fractalRayRecursive(lt)}createPrism(tt){this.forwardsFill.subVectors(tt.pos1,tt.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(tt.pos0,tt.up0,this.forwardsFill,tt.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(tt.pos1,tt.up0,this.forwardsFill,tt.radius1,tt.fraction1),this.createPrismFaces()}createTriangleVerticesWithoutUVs(tt,_e,rt,it){this.side.crossVectors(_e,rt).multiplyScalar(it*_LightningStrike.COS30DEG),this.down.copy(_e).multiplyScalar(-it*_LightningStrike.SIN30DEG);const nt=this.vPos,st=this.vertices;nt.copy(tt).sub(this.side).add(this.down),st[this.currentCoordinate++]=nt.x,st[this.currentCoordinate++]=nt.y,st[this.currentCoordinate++]=nt.z,nt.copy(tt).add(this.side).add(this.down),st[this.currentCoordinate++]=nt.x,st[this.currentCoordinate++]=nt.y,st[this.currentCoordinate++]=nt.z,nt.copy(_e).multiplyScalar(it).add(tt),st[this.currentCoordinate++]=nt.x,st[this.currentCoordinate++]=nt.y,st[this.currentCoordinate++]=nt.z,this.currentVertex+=3}createTriangleVerticesWithUVs(tt,_e,rt,it,nt){this.side.crossVectors(_e,rt).multiplyScalar(it*_LightningStrike.COS30DEG),this.down.copy(_e).multiplyScalar(-it*_LightningStrike.SIN30DEG);const st=this.vPos,at=this.vertices,lt=this.uvs;st.copy(tt).sub(this.side).add(this.down),at[this.currentCoordinate++]=st.x,at[this.currentCoordinate++]=st.y,at[this.currentCoordinate++]=st.z,lt[this.currentUVCoordinate++]=nt,lt[this.currentUVCoordinate++]=0,st.copy(tt).add(this.side).add(this.down),at[this.currentCoordinate++]=st.x,at[this.currentCoordinate++]=st.y,at[this.currentCoordinate++]=st.z,lt[this.currentUVCoordinate++]=nt,lt[this.currentUVCoordinate++]=.5,st.copy(_e).multiplyScalar(it).add(tt),at[this.currentCoordinate++]=st.x,at[this.currentCoordinate++]=st.y,at[this.currentCoordinate++]=st.z,lt[this.currentUVCoordinate++]=nt,lt[this.currentUVCoordinate++]=1,this.currentVertex+=3}createPrismFaces(tt){const _e=this.indices;tt=this.currentVertex-6,_e[this.currentIndex++]=tt+1,_e[this.currentIndex++]=tt+2,_e[this.currentIndex++]=tt+5,_e[this.currentIndex++]=tt+1,_e[this.currentIndex++]=tt+5,_e[this.currentIndex++]=tt+4,_e[this.currentIndex++]=tt+0,_e[this.currentIndex++]=tt+1,_e[this.currentIndex++]=tt+4,_e[this.currentIndex++]=tt+0,_e[this.currentIndex++]=tt+4,_e[this.currentIndex++]=tt+3,_e[this.currentIndex++]=tt+2,_e[this.currentIndex++]=tt+0,_e[this.currentIndex++]=tt+3,_e[this.currentIndex++]=tt+2,_e[this.currentIndex++]=tt+3,_e[this.currentIndex++]=tt+5}createDefaultSubrayCreationCallbacks(){const tt=this.randomGenerator.random;this.onDecideSubrayCreation=function(st,at){const lt=at.currentSubray,ot=at.rayParameters.subrayPeriod,ct=at.rayParameters.subrayDutyCycle,ut=at.rayParameters.isEternal&&lt.recursion==0?-tt()*ot:MathUtils.lerp(lt.birthTime,lt.endPropagationTime,st.fraction0)-tt()*ot,ht=at.time-ut,dt=Math.floor(ht/ot),pt=tt()*(dt+1),ft=ht%ot<=ct*ot;let gt=0;if(ft&&(gt=at.subrayProbability),lt.recursion<at.maxSubrayRecursion&&at.numSubrays<at.maxSubrays&&tt()<gt){const mt=at.addNewSubray(),At=at.randomGenerator.getSeed();mt.seed=pt,at.randomGenerator.setSeed(pt),mt.recursion=lt.recursion+1,mt.maxIterations=Math.max(1,lt.maxIterations-1),mt.linPos0.set(tt(),tt(),tt()).multiplyScalar(1e3),mt.linPos1.set(tt(),tt(),tt()).multiplyScalar(1e3),mt.up0.copy(lt.up0),mt.up1.copy(lt.up1),mt.radius0=st.radius0*at.rayParameters.radius0Factor,mt.radius1=Math.min(at.rayParameters.minRadius,st.radius1*at.rayParameters.radius1Factor),mt.birthTime=ut+dt*ot,mt.deathTime=mt.birthTime+ot*ct,!at.rayParameters.isEternal&&lt.recursion==0&&(mt.birthTime=Math.max(mt.birthTime,lt.birthTime),mt.deathTime=Math.min(mt.deathTime,lt.deathTime)),mt.timeScale=lt.timeScale*2,mt.roughness=lt.roughness,mt.straightness=lt.straightness,mt.propagationTimeFactor=lt.propagationTimeFactor,mt.vanishingTimeFactor=lt.vanishingTimeFactor,at.onSubrayCreation(st,lt,mt,at),at.randomGenerator.setSeed(At)}};const _e=new Vector3,rt=new Vector3,it=new Vector3,nt=new Vector3;this.onSubrayCreation=function(st,at,lt,ot){ot.subrayCylinderPosition(st,at,lt,.5,.6,.2)},this.subrayConePosition=function(st,at,lt,ot,ct,ut){lt.pos0.copy(st.pos0),_e.subVectors(at.pos1,at.pos0),rt.copy(_e).normalize(),_e.multiplyScalar(st.fraction0+(1-st.fraction0)*(tt()*ot));const ht=_e.length();it.crossVectors(at.up0,rt);const dt=2*Math.PI*tt();it.multiplyScalar(Math.cos(dt)),nt.copy(at.up0).multiplyScalar(Math.sin(dt)),lt.pos1.copy(it).add(nt).multiplyScalar(ht*ct*(ut+tt()*(1-ut))).add(_e).add(at.pos0)},this.subrayCylinderPosition=function(st,at,lt,ot,ct,ut){lt.pos0.copy(st.pos0),_e.subVectors(at.pos1,at.pos0),rt.copy(_e).normalize(),_e.multiplyScalar(st.fraction0+(1-st.fraction0)*((2*tt()-1)*ot));const ht=_e.length();it.crossVectors(at.up0,rt);const dt=2*Math.PI*tt();it.multiplyScalar(Math.cos(dt)),nt.copy(at.up0).multiplyScalar(Math.sin(dt)),lt.pos1.copy(it).add(nt).multiplyScalar(ht*ct*(ut+tt()*(1-ut))).add(_e).add(at.pos0)}}createSubray(){return{seed:0,maxIterations:0,recursion:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}createSegment(){return{iteration:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}getNewSegment(){return this.raySegments[this.currentSegmentIndex++]}copy(tt){return super.copy(tt),this.init(_LightningStrike.copyParameters({},tt.rayParameters)),this}clone(){return new this.constructor(_LightningStrike.copyParameters({},this.rayParameters))}};let LightningStrike=_LightningStrike;__publicField(LightningStrike,"RAY_INITIALIZED",0);__publicField(LightningStrike,"RAY_UNBORN",1);__publicField(LightningStrike,"RAY_PROPAGATING",2);__publicField(LightningStrike,"RAY_STEADY",3);__publicField(LightningStrike,"RAY_VANISHING",4);__publicField(LightningStrike,"RAY_EXTINGUISHED",5);__publicField(LightningStrike,"COS30DEG",Math.cos(30*Math.PI/180));__publicField(LightningStrike,"SIN30DEG",Math.sin(30*Math.PI/180));const _ReflectorForSSRPass=class extends Mesh{constructor(tt,_e={}){super(tt),this.isReflectorForSSRPass=!0,this.type="ReflectorForSSRPass";const rt=this,it=_e.color!==void 0?new Color$1(_e.color):new Color$1(8355711),nt=_e.textureWidth||512,st=_e.textureHeight||512,at=_e.clipBias||0,lt=_e.shader||_ReflectorForSSRPass.ReflectorShader,ot=_e.useDepthTexture===!0,ct=new Vector3(0,1,0),ut=new Vector3,ht=new Vector3;rt.needsUpdate=!1,rt.maxDistance=_ReflectorForSSRPass.ReflectorShader.uniforms.maxDistance.value,rt.opacity=_ReflectorForSSRPass.ReflectorShader.uniforms.opacity.value,rt.color=it,rt.resolution=_e.resolution||new Vector2(window.innerWidth,window.innerHeight),rt._distanceAttenuation=_ReflectorForSSRPass.ReflectorShader.defines.DISTANCE_ATTENUATION,Object.defineProperty(rt,"distanceAttenuation",{get(){return rt._distanceAttenuation},set(Mt){rt._distanceAttenuation!==Mt&&(rt._distanceAttenuation=Mt,rt.material.defines.DISTANCE_ATTENUATION=Mt,rt.material.needsUpdate=!0)}}),rt._fresnel=_ReflectorForSSRPass.ReflectorShader.defines.FRESNEL,Object.defineProperty(rt,"fresnel",{get(){return rt._fresnel},set(Mt){rt._fresnel!==Mt&&(rt._fresnel=Mt,rt.material.defines.FRESNEL=Mt,rt.material.needsUpdate=!0)}});const dt=new Vector3,pt=new Vector3,ft=new Vector3,gt=new Matrix4,mt=new Vector3(0,0,-1),At=new Vector3,yt=new Vector3,bt=new Matrix4,xt=new PerspectiveCamera;let vt;ot&&(vt=new DepthTexture,vt.type=UnsignedShortType,vt.minFilter=NearestFilter,vt.magFilter=NearestFilter);const _t={depthTexture:ot?vt:null,type:HalfFloatType},Ct=new WebGLRenderTarget(nt,st,_t),St=new ShaderMaterial({transparent:ot,defines:Object.assign({},_ReflectorForSSRPass.ReflectorShader.defines,{useDepthTexture:ot}),uniforms:UniformsUtils.clone(lt.uniforms),fragmentShader:lt.fragmentShader,vertexShader:lt.vertexShader});St.uniforms.tDiffuse.value=Ct.texture,St.uniforms.color.value=rt.color,St.uniforms.textureMatrix.value=bt,ot&&(St.uniforms.tDepth.value=Ct.depthTexture),this.material=St;const Tt=[new Plane(new Vector3(0,1,0),at)];this.doRender=function(Mt,Rt,It){if(St.uniforms.maxDistance.value=rt.maxDistance,St.uniforms.color.value=rt.color,St.uniforms.opacity.value=rt.opacity,ut.copy(It.position).normalize(),ht.copy(ut).reflect(ct),St.uniforms.fresnelCoe.value=(ut.dot(ht)+1)/2,pt.setFromMatrixPosition(rt.matrixWorld),ft.setFromMatrixPosition(It.matrixWorld),gt.extractRotation(rt.matrixWorld),dt.set(0,0,1),dt.applyMatrix4(gt),At.subVectors(pt,ft),At.dot(dt)>0)return;At.reflect(dt).negate(),At.add(pt),gt.extractRotation(It.matrixWorld),mt.set(0,0,-1),mt.applyMatrix4(gt),mt.add(ft),yt.subVectors(pt,mt),yt.reflect(dt).negate(),yt.add(pt),xt.position.copy(At),xt.up.set(0,1,0),xt.up.applyMatrix4(gt),xt.up.reflect(dt),xt.lookAt(yt),xt.far=It.far,xt.updateMatrixWorld(),xt.projectionMatrix.copy(It.projectionMatrix),St.uniforms.virtualCameraNear.value=It.near,St.uniforms.virtualCameraFar.value=It.far,St.uniforms.virtualCameraMatrixWorld.value=xt.matrixWorld,St.uniforms.virtualCameraProjectionMatrix.value=It.projectionMatrix,St.uniforms.virtualCameraProjectionMatrixInverse.value=It.projectionMatrixInverse,St.uniforms.resolution.value=rt.resolution,bt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),bt.multiply(xt.projectionMatrix),bt.multiply(xt.matrixWorldInverse),bt.multiply(rt.matrixWorld);const Ot=Mt.getRenderTarget(),Bt=Mt.xr.enabled,Nt=Mt.shadowMap.autoUpdate,zt=Mt.clippingPlanes;Mt.xr.enabled=!1,Mt.shadowMap.autoUpdate=!1,Mt.clippingPlanes=Tt,Mt.setRenderTarget(Ct),Mt.state.buffers.depth.setMask(!0),Mt.autoClear===!1&&Mt.clear(),Mt.render(Rt,xt),Mt.xr.enabled=Bt,Mt.shadowMap.autoUpdate=Nt,Mt.clippingPlanes=zt,Mt.setRenderTarget(Ot);const Dt=It.viewport;Dt!==void 0&&Mt.state.viewport(Dt)},this.getRenderTarget=function(){return Ct}}};let ReflectorForSSRPass=_ReflectorForSSRPass;__publicField(ReflectorForSSRPass,"ReflectorShader",{defines:{DISTANCE_ATTENUATION:!0,FRESNEL:!0},uniforms:{color:{value:null},tDiffuse:{value:null},tDepth:{value:null},textureMatrix:{value:new Matrix4},maxDistance:{value:180},opacity:{value:.5},fresnelCoe:{value:null},virtualCameraNear:{value:null},virtualCameraFar:{value:null},virtualCameraProjectionMatrix:{value:new Matrix4},virtualCameraMatrixWorld:{value:new Matrix4},virtualCameraProjectionMatrixInverse:{value:new Matrix4},resolution:{value:new Vector2}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		uniform sampler2D tDepth;
		uniform float maxDistance;
		uniform float opacity;
		uniform float fresnelCoe;
		uniform float virtualCameraNear;
		uniform float virtualCameraFar;
		uniform mat4 virtualCameraProjectionMatrix;
		uniform mat4 virtualCameraProjectionMatrixInverse;
		uniform mat4 virtualCameraMatrixWorld;
		uniform vec2 resolution;
		varying vec4 vUv;
		#include <packing>
		float blendOverlay( float base, float blend ) {
			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );
		}
		vec3 blendOverlay( vec3 base, vec3 blend ) {
			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );
		}
		float getDepth( const in vec2 uv ) {
			return texture2D( tDepth, uv ).x;
		}
		float getViewZ( const in float depth ) {
			return perspectiveDepthToViewZ( depth, virtualCameraNear, virtualCameraFar );
		}
		vec3 getViewPosition( const in vec2 uv, const in float depth/*clip space*/, const in float clipW ) {
			vec4 clipPosition = vec4( ( vec3( uv, depth ) - 0.5 ) * 2.0, 1.0 );//ndc
			clipPosition *= clipW; //clip
			return ( virtualCameraProjectionMatrixInverse * clipPosition ).xyz;//view
		}
		void main() {
			vec4 base = texture2DProj( tDiffuse, vUv );
			#ifdef useDepthTexture
				vec2 uv=(gl_FragCoord.xy-.5)/resolution.xy;
				uv.x=1.-uv.x;
				float depth = texture2DProj( tDepth, vUv ).r;
				float viewZ = getViewZ( depth );
				float clipW = virtualCameraProjectionMatrix[2][3] * viewZ+virtualCameraProjectionMatrix[3][3];
				vec3 viewPosition=getViewPosition( uv, depth, clipW );
				vec3 worldPosition=(virtualCameraMatrixWorld*vec4(viewPosition,1)).xyz;
				if(worldPosition.y>maxDistance) discard;
				float op=opacity;
				#ifdef DISTANCE_ATTENUATION
					float ratio=1.-(worldPosition.y/maxDistance);
					float attenuation=ratio*ratio;
					op=opacity*attenuation;
				#endif
				#ifdef FRESNEL
					op*=fresnelCoe;
				#endif
				gl_FragColor = vec4( blendOverlay( base.rgb, color ), op );
			#else
				gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );
			#endif
		}
	`});const SkyShader={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3},up:{value:new Vector3(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},material=new ShaderMaterial({name:"SkyShader",fragmentShader:SkyShader.fragmentShader,vertexShader:SkyShader.vertexShader,uniforms:UniformsUtils.clone(SkyShader.uniforms),side:BackSide,depthWrite:!1});let Sky$1=class extends Mesh{constructor(){super(new BoxGeometry(1,1,1),material)}};__publicField(Sky$1,"SkyShader",SkyShader);__publicField(Sky$1,"material",material);const _Water2=class extends Mesh{constructor(tt,_e={}){super(tt),this.isWater=!0,this.type="Water";const rt=this,it=_e.color!==void 0?new Color$1(_e.color):new Color$1(16777215),nt=_e.textureWidth||512,st=_e.textureHeight||512,at=_e.clipBias||0,lt=_e.flowDirection||new Vector2(1,0),ot=_e.flowSpeed||.03,ct=_e.reflectivity||.02,ut=_e.scale||1,ht=_e.shader||_Water2.WaterShader,dt=_e.encoding!==void 0?_e.encoding:3e3,pt=_e.flowMap||void 0,ft=_e.normalMap0,gt=_e.normalMap1,mt=.15,At=mt*.5,yt=new Matrix4,bt=new Clock;if(Reflector===void 0){console.error("THREE.Water: Required component Reflector not found.");return}if(Refractor===void 0){console.error("THREE.Water: Required component Refractor not found.");return}const xt=new Reflector(tt,{textureWidth:nt,textureHeight:st,clipBias:at,encoding:dt}),vt=new Refractor(tt,{textureWidth:nt,textureHeight:st,clipBias:at,encoding:dt});xt.matrixAutoUpdate=!1,vt.matrixAutoUpdate=!1,this.material=new ShaderMaterial({uniforms:UniformsUtils.merge([UniformsLib.fog,ht.uniforms]),vertexShader:ht.vertexShader,fragmentShader:ht.fragmentShader,transparent:!0,fog:!0}),pt!==void 0?(this.material.defines.USE_FLOWMAP="",this.material.uniforms.tFlowMap={type:"t",value:pt}):this.material.uniforms.flowDirection={type:"v2",value:lt},ft.wrapS=ft.wrapT=RepeatWrapping,gt.wrapS=gt.wrapT=RepeatWrapping,this.material.uniforms.tReflectionMap.value=xt.getRenderTarget().texture,this.material.uniforms.tRefractionMap.value=vt.getRenderTarget().texture,this.material.uniforms.tNormalMap0.value=ft,this.material.uniforms.tNormalMap1.value=gt,this.material.uniforms.color.value=it,this.material.uniforms.reflectivity.value=ct,this.material.uniforms.textureMatrix.value=yt,this.material.uniforms.config.value.x=0,this.material.uniforms.config.value.y=At,this.material.uniforms.config.value.z=At,this.material.uniforms.config.value.w=ut;function _t(St){yt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),yt.multiply(St.projectionMatrix),yt.multiply(St.matrixWorldInverse),yt.multiply(rt.matrixWorld)}function Ct(){const St=bt.getDelta(),Et=rt.material.uniforms.config;Et.value.x+=ot*St,Et.value.y=Et.value.x+At,Et.value.x>=mt?(Et.value.x=0,Et.value.y=At):Et.value.y>=mt&&(Et.value.y=Et.value.y-mt)}this.onBeforeRender=function(St,Et,Tt){_t(Tt),Ct(),rt.visible=!1,xt.matrixWorld.copy(rt.matrixWorld),vt.matrixWorld.copy(rt.matrixWorld),xt.onBeforeRender(St,Et,Tt),vt.onBeforeRender(St,Et,Tt),rt.visible=!0}}};let Water2=_Water2;__publicField(Water2,"WaterShader",{uniforms:{color:{value:null},reflectivity:{value:0},tReflectionMap:{value:null},tRefractionMap:{value:null},tNormalMap0:{value:null},tNormalMap1:{value:null},textureMatrix:{value:null},config:{value:new Vector4}},vertexShader:`

		#include <common>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>

		uniform mat4 textureMatrix;

		varying vec4 vCoord;
		varying vec2 vUv;
		varying vec3 vToEye;

		void main() {

			vUv = uv;
			vCoord = textureMatrix * vec4( position, 1.0 );

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vToEye = cameraPosition - worldPosition.xyz;

			vec4 mvPosition =  viewMatrix * worldPosition; // used in fog_vertex
			gl_Position = projectionMatrix * mvPosition;

			#include <logdepthbuf_vertex>
			#include <fog_vertex>

		}`,fragmentShader:`

		#include <common>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>

		uniform sampler2D tReflectionMap;
		uniform sampler2D tRefractionMap;
		uniform sampler2D tNormalMap0;
		uniform sampler2D tNormalMap1;

		#ifdef USE_FLOWMAP
			uniform sampler2D tFlowMap;
		#else
			uniform vec2 flowDirection;
		#endif

		uniform vec3 color;
		uniform float reflectivity;
		uniform vec4 config;

		varying vec4 vCoord;
		varying vec2 vUv;
		varying vec3 vToEye;

		void main() {

			#include <logdepthbuf_fragment>

			float flowMapOffset0 = config.x;
			float flowMapOffset1 = config.y;
			float halfCycle = config.z;
			float scale = config.w;

			vec3 toEye = normalize( vToEye );

			// determine flow direction
			vec2 flow;
			#ifdef USE_FLOWMAP
				flow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;
			#else
				flow = flowDirection;
			#endif
			flow.x *= - 1.0;

			// sample normal maps (distort uvs with flowdata)
			vec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );
			vec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );

			// linear interpolate to get the final normal color
			float flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;
			vec4 normalColor = mix( normalColor0, normalColor1, flowLerp );

			// calculate normal vector
			vec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );

			// calculate the fresnel term to blend reflection and refraction maps
			float theta = max( dot( toEye, normal ), 0.0 );
			float reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );

			// calculate final uv coords
			vec3 coord = vCoord.xyz / vCoord.w;
			vec2 uv = coord.xy + coord.z * normal.xz * 0.05;

			vec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );
			vec4 refractColor = texture2D( tRefractionMap, uv );

			// multiply water color with the mix of both textures
			gl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );

			#include <tonemapping_fragment>
			#include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
			#include <fog_fragment>

		}`});const isCubeTexture=tt=>tt&&tt.isCubeTexture;class GroundProjectedEnv extends Mesh{constructor(_e,rt){var it,nt;const st=isCubeTexture(_e),lt=((nt=st?(it=_e.image[0])==null?void 0:it.width:_e.image.width)!=null?nt:1024)/4,ot=Math.floor(Math.log2(lt)),ct=Math.pow(2,ot),ut=3*Math.max(ct,16*7),ht=4*ct,dt=[st?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/ut}`,`#define CUBEUV_TEXEL_HEIGHT ${1/ht}`,`#define CUBEUV_MAX_MIP ${ot}.0`],pt=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,ft=dt.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,gt={map:{value:_e},height:{value:(rt==null?void 0:rt.height)||15},radius:{value:(rt==null?void 0:rt.radius)||100}},mt=new IcosahedronGeometry(1,16),At=new ShaderMaterial({uniforms:gt,fragmentShader:ft,vertexShader:pt,side:DoubleSide});super(mt,At)}set radius(_e){this.material.uniforms.radius.value=_e}get radius(){return this.material.uniforms.radius.value}set height(_e){this.material.uniforms.height.value=_e}get height(){return this.material.uniforms.height.value}}const UnpackDepthRGBAShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","	float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","	gl_FragColor = vec4( vec3( depth ), opacity );","}"].join(`
`)},moduloWrapAround=(tt,_e)=>(tt%_e+_e)%_e;let OrbitControls$1=class extends EventDispatcher{constructor(_e,rt){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"target",new Vector3),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"minZoom",0),__publicField(this,"maxZoom",1/0),__publicField(this,"minPolarAngle",0),__publicField(this,"maxPolarAngle",Math.PI),__publicField(this,"minAzimuthAngle",-1/0),__publicField(this,"maxAzimuthAngle",1/0),__publicField(this,"enableDamping",!1),__publicField(this,"dampingFactor",.05),__publicField(this,"enableZoom",!0),__publicField(this,"zoomSpeed",1),__publicField(this,"enableRotate",!0),__publicField(this,"rotateSpeed",1),__publicField(this,"enablePan",!0),__publicField(this,"panSpeed",1),__publicField(this,"screenSpacePanning",!0),__publicField(this,"keyPanSpeed",7),__publicField(this,"autoRotate",!1),__publicField(this,"autoRotateSpeed",2),__publicField(this,"reverseOrbit",!1),__publicField(this,"reverseHorizontalOrbit",!1),__publicField(this,"reverseVerticalOrbit",!1),__publicField(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"zoom0"),__publicField(this,"_domElementKeyEvents",null),__publicField(this,"getPolarAngle"),__publicField(this,"getAzimuthalAngle"),__publicField(this,"setPolarAngle"),__publicField(this,"setAzimuthalAngle"),__publicField(this,"getDistance"),__publicField(this,"listenToKeyEvents"),__publicField(this,"stopListenToKeyEvents"),__publicField(this,"saveState"),__publicField(this,"reset"),__publicField(this,"update"),__publicField(this,"connect"),__publicField(this,"dispose"),this.object=_e,this.domElement=rt,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>ut.phi,this.getAzimuthalAngle=()=>ut.theta,this.setPolarAngle=tr=>{let Ar=moduloWrapAround(tr,2*Math.PI),yr=ut.phi;yr<0&&(yr+=2*Math.PI),Ar<0&&(Ar+=2*Math.PI);let Jt=Math.abs(Ar-yr);2*Math.PI-Jt<Jt&&(Ar<yr?Ar+=2*Math.PI:yr+=2*Math.PI),ht.phi=Ar-yr,it.update()},this.setAzimuthalAngle=tr=>{let Ar=moduloWrapAround(tr,2*Math.PI),yr=ut.theta;yr<0&&(yr+=2*Math.PI),Ar<0&&(Ar+=2*Math.PI);let Jt=Math.abs(Ar-yr);2*Math.PI-Jt<Jt&&(Ar<yr?Ar+=2*Math.PI:yr+=2*Math.PI),ht.theta=Ar-yr,it.update()},this.getDistance=()=>it.object.position.distanceTo(it.target),this.listenToKeyEvents=tr=>{tr.addEventListener("keydown",Xt),this._domElementKeyEvents=tr},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Xt),this._domElementKeyEvents=null},this.saveState=()=>{it.target0.copy(it.target),it.position0.copy(it.object.position),it.zoom0=it.object.zoom},this.reset=()=>{it.target.copy(it.target0),it.object.position.copy(it.position0),it.object.zoom=it.zoom0,it.object.updateProjectionMatrix(),it.dispatchEvent(nt),it.update(),ot=lt.NONE},this.update=(()=>{const tr=new Vector3,Ar=new Vector3(0,1,0),yr=new Quaternion().setFromUnitVectors(_e.up,Ar),Jt=yr.clone().invert(),_r=new Vector3,Kt=new Quaternion,Qr=2*Math.PI;return function(){const Rr=it.object.position;yr.setFromUnitVectors(_e.up,Ar),Jt.copy(yr).invert(),tr.copy(Rr).sub(it.target),tr.applyQuaternion(yr),ut.setFromVector3(tr),it.autoRotate&&ot===lt.NONE&&Rt(Tt()),it.enableDamping?(ut.theta+=ht.theta*it.dampingFactor,ut.phi+=ht.phi*it.dampingFactor):(ut.theta+=ht.theta,ut.phi+=ht.phi);let Tr=it.minAzimuthAngle,Vr=it.maxAzimuthAngle;return isFinite(Tr)&&isFinite(Vr)&&(Tr<-Math.PI?Tr+=Qr:Tr>Math.PI&&(Tr-=Qr),Vr<-Math.PI?Vr+=Qr:Vr>Math.PI&&(Vr-=Qr),Tr<=Vr?ut.theta=Math.max(Tr,Math.min(Vr,ut.theta)):ut.theta=ut.theta>(Tr+Vr)/2?Math.max(Tr,ut.theta):Math.min(Vr,ut.theta)),ut.phi=Math.max(it.minPolarAngle,Math.min(it.maxPolarAngle,ut.phi)),ut.makeSafe(),ut.radius*=dt,ut.radius=Math.max(it.minDistance,Math.min(it.maxDistance,ut.radius)),it.enableDamping===!0?it.target.addScaledVector(pt,it.dampingFactor):it.target.add(pt),tr.setFromSpherical(ut),tr.applyQuaternion(Jt),Rr.copy(it.target).add(tr),it.object.lookAt(it.target),it.enableDamping===!0?(ht.theta*=1-it.dampingFactor,ht.phi*=1-it.dampingFactor,pt.multiplyScalar(1-it.dampingFactor)):(ht.set(0,0,0),pt.set(0,0,0)),dt=1,ft||_r.distanceToSquared(it.object.position)>ct||8*(1-Kt.dot(it.object.quaternion))>ct?(it.dispatchEvent(nt),_r.copy(it.object.position),Kt.copy(it.object.quaternion),ft=!1,!0):!1}})(),this.connect=tr=>{tr===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),it.domElement=tr,it.domElement.style.touchAction="none",it.domElement.addEventListener("contextmenu",fr),it.domElement.addEventListener("pointerdown",Nr),it.domElement.addEventListener("pointercancel",Ur),it.domElement.addEventListener("wheel",Qt)},this.dispose=()=>{var tr,Ar,yr,Jt,_r,Kt;(tr=it.domElement)==null||tr.removeEventListener("contextmenu",fr),(Ar=it.domElement)==null||Ar.removeEventListener("pointerdown",Nr),(yr=it.domElement)==null||yr.removeEventListener("pointercancel",Ur),(Jt=it.domElement)==null||Jt.removeEventListener("wheel",Qt),(_r=it.domElement)==null||_r.ownerDocument.removeEventListener("pointermove",wr),(Kt=it.domElement)==null||Kt.ownerDocument.removeEventListener("pointerup",kr),it._domElementKeyEvents!==null&&it._domElementKeyEvents.removeEventListener("keydown",Xt)};const it=this,nt={type:"change"},st={type:"start"},at={type:"end"},lt={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let ot=lt.NONE;const ct=1e-6,ut=new Spherical,ht=new Spherical;let dt=1;const pt=new Vector3;let ft=!1;const gt=new Vector2,mt=new Vector2,At=new Vector2,yt=new Vector2,bt=new Vector2,xt=new Vector2,vt=new Vector2,_t=new Vector2,Ct=new Vector2,St=[],Et={};function Tt(){return 2*Math.PI/60/60*it.autoRotateSpeed}function Mt(){return Math.pow(.95,it.zoomSpeed)}function Rt(tr){it.reverseOrbit||it.reverseHorizontalOrbit?ht.theta+=tr:ht.theta-=tr}function It(tr){it.reverseOrbit||it.reverseVerticalOrbit?ht.phi+=tr:ht.phi-=tr}const Ot=(()=>{const tr=new Vector3;return function(yr,Jt){tr.setFromMatrixColumn(Jt,0),tr.multiplyScalar(-yr),pt.add(tr)}})(),Bt=(()=>{const tr=new Vector3;return function(yr,Jt){it.screenSpacePanning===!0?tr.setFromMatrixColumn(Jt,1):(tr.setFromMatrixColumn(Jt,0),tr.crossVectors(it.object.up,tr)),tr.multiplyScalar(yr),pt.add(tr)}})(),Nt=(()=>{const tr=new Vector3;return function(yr,Jt){const _r=it.domElement;if(_r&&it.object instanceof PerspectiveCamera&&it.object.isPerspectiveCamera){const Kt=it.object.position;tr.copy(Kt).sub(it.target);let Qr=tr.length();Qr*=Math.tan(it.object.fov/2*Math.PI/180),Ot(2*yr*Qr/_r.clientHeight,it.object.matrix),Bt(2*Jt*Qr/_r.clientHeight,it.object.matrix)}else _r&&it.object instanceof OrthographicCamera&&it.object.isOrthographicCamera?(Ot(yr*(it.object.right-it.object.left)/it.object.zoom/_r.clientWidth,it.object.matrix),Bt(Jt*(it.object.top-it.object.bottom)/it.object.zoom/_r.clientHeight,it.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),it.enablePan=!1)}})();function zt(tr){it.object instanceof PerspectiveCamera&&it.object.isPerspectiveCamera?dt/=tr:it.object instanceof OrthographicCamera&&it.object.isOrthographicCamera?(it.object.zoom=Math.max(it.minZoom,Math.min(it.maxZoom,it.object.zoom*tr)),it.object.updateProjectionMatrix(),ft=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),it.enableZoom=!1)}function Dt(tr){it.object instanceof PerspectiveCamera&&it.object.isPerspectiveCamera?dt*=tr:it.object instanceof OrthographicCamera&&it.object.isOrthographicCamera?(it.object.zoom=Math.max(it.minZoom,Math.min(it.maxZoom,it.object.zoom/tr)),it.object.updateProjectionMatrix(),ft=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),it.enableZoom=!1)}function Ft(tr){gt.set(tr.clientX,tr.clientY)}function Ut(tr){vt.set(tr.clientX,tr.clientY)}function $t(tr){yt.set(tr.clientX,tr.clientY)}function Vt(tr){mt.set(tr.clientX,tr.clientY),At.subVectors(mt,gt).multiplyScalar(it.rotateSpeed);const Ar=it.domElement;Ar&&(Rt(2*Math.PI*At.x/Ar.clientHeight),It(2*Math.PI*At.y/Ar.clientHeight)),gt.copy(mt),it.update()}function Zt(tr){_t.set(tr.clientX,tr.clientY),Ct.subVectors(_t,vt),Ct.y>0?zt(Mt()):Ct.y<0&&Dt(Mt()),vt.copy(_t),it.update()}function qt(tr){bt.set(tr.clientX,tr.clientY),xt.subVectors(bt,yt).multiplyScalar(it.panSpeed),Nt(xt.x,xt.y),yt.copy(bt),it.update()}function sr(tr){tr.deltaY<0?Dt(Mt()):tr.deltaY>0&&zt(Mt()),it.update()}function er(tr){let Ar=!1;switch(tr.code){case it.keys.UP:Nt(0,it.keyPanSpeed),Ar=!0;break;case it.keys.BOTTOM:Nt(0,-it.keyPanSpeed),Ar=!0;break;case it.keys.LEFT:Nt(it.keyPanSpeed,0),Ar=!0;break;case it.keys.RIGHT:Nt(-it.keyPanSpeed,0),Ar=!0;break}Ar&&(tr.preventDefault(),it.update())}function ir(){if(St.length==1)gt.set(St[0].pageX,St[0].pageY);else{const tr=.5*(St[0].pageX+St[1].pageX),Ar=.5*(St[0].pageY+St[1].pageY);gt.set(tr,Ar)}}function ur(){if(St.length==1)yt.set(St[0].pageX,St[0].pageY);else{const tr=.5*(St[0].pageX+St[1].pageX),Ar=.5*(St[0].pageY+St[1].pageY);yt.set(tr,Ar)}}function ar(){const tr=St[0].pageX-St[1].pageX,Ar=St[0].pageY-St[1].pageY,yr=Math.sqrt(tr*tr+Ar*Ar);vt.set(0,yr)}function lr(){it.enableZoom&&ar(),it.enablePan&&ur()}function gr(){it.enableZoom&&ar(),it.enableRotate&&ir()}function Yt(tr){if(St.length==1)mt.set(tr.pageX,tr.pageY);else{const yr=Cr(tr),Jt=.5*(tr.pageX+yr.x),_r=.5*(tr.pageY+yr.y);mt.set(Jt,_r)}At.subVectors(mt,gt).multiplyScalar(it.rotateSpeed);const Ar=it.domElement;Ar&&(Rt(2*Math.PI*At.x/Ar.clientHeight),It(2*Math.PI*At.y/Ar.clientHeight)),gt.copy(mt)}function nr(tr){if(St.length==1)bt.set(tr.pageX,tr.pageY);else{const Ar=Cr(tr),yr=.5*(tr.pageX+Ar.x),Jt=.5*(tr.pageY+Ar.y);bt.set(yr,Jt)}xt.subVectors(bt,yt).multiplyScalar(it.panSpeed),Nt(xt.x,xt.y),yt.copy(bt)}function mr(tr){const Ar=Cr(tr),yr=tr.pageX-Ar.x,Jt=tr.pageY-Ar.y,_r=Math.sqrt(yr*yr+Jt*Jt);_t.set(0,_r),Ct.set(0,Math.pow(_t.y/vt.y,it.zoomSpeed)),zt(Ct.y),vt.copy(_t)}function Sr(tr){it.enableZoom&&mr(tr),it.enablePan&&nr(tr)}function Er(tr){it.enableZoom&&mr(tr),it.enableRotate&&Yt(tr)}function Nr(tr){var Ar,yr;it.enabled!==!1&&(St.length===0&&((Ar=it.domElement)==null||Ar.ownerDocument.addEventListener("pointermove",wr),(yr=it.domElement)==null||yr.ownerDocument.addEventListener("pointerup",kr)),pr(tr),tr.pointerType==="touch"?xr(tr):Or(tr))}function wr(tr){it.enabled!==!1&&(tr.pointerType==="touch"?Lr(tr):Xr(tr))}function kr(tr){var Ar,yr,Jt;Hr(tr),St.length===0&&((Ar=it.domElement)==null||Ar.releasePointerCapture(tr.pointerId),(yr=it.domElement)==null||yr.ownerDocument.removeEventListener("pointermove",wr),(Jt=it.domElement)==null||Jt.ownerDocument.removeEventListener("pointerup",kr)),it.dispatchEvent(at),ot=lt.NONE}function Ur(tr){Hr(tr)}function Or(tr){let Ar;switch(tr.button){case 0:Ar=it.mouseButtons.LEFT;break;case 1:Ar=it.mouseButtons.MIDDLE;break;case 2:Ar=it.mouseButtons.RIGHT;break;default:Ar=-1}switch(Ar){case MOUSE.DOLLY:if(it.enableZoom===!1)return;Ut(tr),ot=lt.DOLLY;break;case MOUSE.ROTATE:if(tr.ctrlKey||tr.metaKey||tr.shiftKey){if(it.enablePan===!1)return;$t(tr),ot=lt.PAN}else{if(it.enableRotate===!1)return;Ft(tr),ot=lt.ROTATE}break;case MOUSE.PAN:if(tr.ctrlKey||tr.metaKey||tr.shiftKey){if(it.enableRotate===!1)return;Ft(tr),ot=lt.ROTATE}else{if(it.enablePan===!1)return;$t(tr),ot=lt.PAN}break;default:ot=lt.NONE}ot!==lt.NONE&&it.dispatchEvent(st)}function Xr(tr){if(it.enabled!==!1)switch(ot){case lt.ROTATE:if(it.enableRotate===!1)return;Vt(tr);break;case lt.DOLLY:if(it.enableZoom===!1)return;Zt(tr);break;case lt.PAN:if(it.enablePan===!1)return;qt(tr);break}}function Qt(tr){it.enabled===!1||it.enableZoom===!1||ot!==lt.NONE&&ot!==lt.ROTATE||(tr.preventDefault(),it.dispatchEvent(st),sr(tr),it.dispatchEvent(at))}function Xt(tr){it.enabled===!1||it.enablePan===!1||er(tr)}function xr(tr){switch(hr(tr),St.length){case 1:switch(it.touches.ONE){case TOUCH.ROTATE:if(it.enableRotate===!1)return;ir(),ot=lt.TOUCH_ROTATE;break;case TOUCH.PAN:if(it.enablePan===!1)return;ur(),ot=lt.TOUCH_PAN;break;default:ot=lt.NONE}break;case 2:switch(it.touches.TWO){case TOUCH.DOLLY_PAN:if(it.enableZoom===!1&&it.enablePan===!1)return;lr(),ot=lt.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(it.enableZoom===!1&&it.enableRotate===!1)return;gr(),ot=lt.TOUCH_DOLLY_ROTATE;break;default:ot=lt.NONE}break;default:ot=lt.NONE}ot!==lt.NONE&&it.dispatchEvent(st)}function Lr(tr){switch(hr(tr),ot){case lt.TOUCH_ROTATE:if(it.enableRotate===!1)return;Yt(tr),it.update();break;case lt.TOUCH_PAN:if(it.enablePan===!1)return;nr(tr),it.update();break;case lt.TOUCH_DOLLY_PAN:if(it.enableZoom===!1&&it.enablePan===!1)return;Sr(tr),it.update();break;case lt.TOUCH_DOLLY_ROTATE:if(it.enableZoom===!1&&it.enableRotate===!1)return;Er(tr),it.update();break;default:ot=lt.NONE}}function fr(tr){it.enabled!==!1&&tr.preventDefault()}function pr(tr){St.push(tr)}function Hr(tr){delete Et[tr.pointerId];for(let Ar=0;Ar<St.length;Ar++)if(St[Ar].pointerId==tr.pointerId){St.splice(Ar,1);return}}function hr(tr){let Ar=Et[tr.pointerId];Ar===void 0&&(Ar=new Vector2,Et[tr.pointerId]=Ar),Ar.set(tr.pageX,tr.pageY)}function Cr(tr){const Ar=tr.pointerId===St[0].pointerId?St[1]:St[0];return Et[Ar.pointerId]}rt!==void 0&&this.connect(rt),this.update()}};class Pass{constructor(){__publicField(this,"enabled",!0),__publicField(this,"needsSwap",!0),__publicField(this,"clear",!1),__publicField(this,"renderToScreen",!1)}setSize(_e,rt){}render(_e,rt,it,nt,st){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}class FullScreenQuad{constructor(_e){__publicField(this,"camera",new OrthographicCamera(-1,1,1,-1,0,1)),__publicField(this,"geometry",new PlaneGeometry(2,2)),__publicField(this,"mesh"),this.mesh=new Mesh(this.geometry,_e)}get material(){return this.mesh.material}set material(_e){this.mesh.material=_e}dispose(){this.mesh.geometry.dispose()}render(_e){_e.render(this.mesh,this.camera)}}const CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","	vec4 texel = texture2D( tDiffuse, vUv );","	gl_FragColor = opacity * texel;","}"].join(`
`)},SSAOShader={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new Vector2},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","	return texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","	#if PERSPECTIVE_CAMERA == 1","		float fragCoordZ = texture2D( tDepth, screenPosition ).x;","		float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","		return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","	#else","		return texture2D( tDepth, screenPosition ).x;","	#endif","}","float getViewZ( const in float depth ) {","	#if PERSPECTIVE_CAMERA == 1","		return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","	#else","		return orthographicDepthToViewZ( depth, cameraNear, cameraFar );","	#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","	float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","	vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","	clipPosition *= clipW; // unprojection.","	return ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","	return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","	float depth = getDepth( vUv );","	float viewZ = getViewZ( depth );","	vec3 viewPosition = getViewPosition( vUv, depth, viewZ );","	vec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","	vec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","	vec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","	vec3 bitangent = cross( viewNormal, tangent );","	mat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","		vec3 sampleVector = kernelMatrix * kernel[ i ];","		vec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","		vec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","		samplePointNDC /= samplePointNDC.w;","		vec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","		float realDepth = getLinearDepth( samplePointUv );","		float sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","		float delta = sampleDepth - realDepth;","		if ( delta > minDistance && delta < maxDistance ) {","			occlusion += 1.0;","		}","	}","	occlusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","	gl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join(`
`)},SSAODepthShader={defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","	#if PERSPECTIVE_CAMERA == 1","		float fragCoordZ = texture2D( tDepth, screenPosition ).x;","		float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","		return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","	#else","		return texture2D( tDepth, screenPosition ).x;","	#endif","}","void main() {","	float depth = getLinearDepth( vUv );","	gl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join(`
`)},SSAOBlurShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","	vec2 texelSize = ( 1.0 / resolution );","	float result = 0.0;","	for ( int i = - 2; i <= 2; i ++ ) {","		for ( int j = - 2; j <= 2; j ++ ) {","			vec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","			result += texture2D( tDiffuse, vUv + offset ).r;","		}","	}","	gl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join(`
`)},_SSAOPass=class extends Pass{constructor(tt,_e,rt,it){super(),this.width=rt!==void 0?rt:512,this.height=it!==void 0?it:512,this.clear=!0,this.camera=_e,this.scene=tt,this.kernelRadius=8,this.kernelSize=32,this.kernel=[],this.noiseTexture=null,this.output=0,this.minDistance=.005,this.maxDistance=.1,this._visibilityCache=new Map,this.generateSampleKernel(),this.generateRandomKernelRotations();const nt=new DepthTexture;nt.format=DepthStencilFormat,nt.type=UnsignedInt248Type,this.beautyRenderTarget=new WebGLRenderTarget(this.width,this.height),this.normalRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,depthTexture:nt}),this.ssaoRenderTarget=new WebGLRenderTarget(this.width,this.height),this.blurRenderTarget=this.ssaoRenderTarget.clone(),SSAOShader===void 0&&console.error("THREE.SSAOPass: The pass relies on SSAOShader."),this.ssaoMaterial=new ShaderMaterial({defines:Object.assign({},SSAOShader.defines),uniforms:UniformsUtils.clone(SSAOShader.uniforms),vertexShader:SSAOShader.vertexShader,fragmentShader:SSAOShader.fragmentShader,blending:NoBlending}),this.ssaoMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssaoMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.ssaoMaterial.uniforms.tNoise.value=this.noiseTexture,this.ssaoMaterial.uniforms.kernel.value=this.kernel,this.ssaoMaterial.uniforms.cameraNear.value=this.camera.near,this.ssaoMaterial.uniforms.cameraFar.value=this.camera.far,this.ssaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,this.blurMaterial=new ShaderMaterial({defines:Object.assign({},SSAOBlurShader.defines),uniforms:UniformsUtils.clone(SSAOBlurShader.uniforms),vertexShader:SSAOBlurShader.vertexShader,fragmentShader:SSAOBlurShader.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new ShaderMaterial({defines:Object.assign({},SSAODepthShader.defines),uniforms:UniformsUtils.clone(SSAODepthShader.uniforms),vertexShader:SSAODepthShader.vertexShader,fragmentShader:SSAODepthShader.fragmentShader,blending:NoBlending}),this.depthRenderMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:DstColorFactor,blendDst:ZeroFactor,blendEquation:AddEquation,blendSrcAlpha:DstAlphaFactor,blendDstAlpha:ZeroFactor,blendEquationAlpha:AddEquation}),this.fsQuad=new FullScreenQuad(null),this.originalClearColor=new Color$1}dispose(){this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(tt,_e){switch(tt.capabilities.isWebGL2===!1&&(this.noiseTexture.format=LuminanceFormat),tt.setRenderTarget(this.beautyRenderTarget),tt.clear(),tt.render(this.scene,this.camera),this.overrideVisibility(),this.renderOverride(tt,this.normalMaterial,this.normalRenderTarget,7829503,1),this.restoreVisibility(),this.ssaoMaterial.uniforms.kernelRadius.value=this.kernelRadius,this.ssaoMaterial.uniforms.minDistance.value=this.minDistance,this.ssaoMaterial.uniforms.maxDistance.value=this.maxDistance,this.renderPass(tt,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(tt,this.blurMaterial,this.blurRenderTarget),this.output){case _SSAOPass.OUTPUT.SSAO:this.copyMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Blur:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Depth:this.renderPass(tt,this.depthRenderMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSAOPass.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=CustomBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;default:console.warn("THREE.SSAOPass: Unknown output type.")}}renderPass(tt,_e,rt,it,nt){tt.getClearColor(this.originalClearColor);const st=tt.getClearAlpha(),at=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,it!=null&&(tt.setClearColor(it),tt.setClearAlpha(nt||0),tt.clear()),this.fsQuad.material=_e,this.fsQuad.render(tt),tt.autoClear=at,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}renderOverride(tt,_e,rt,it,nt){tt.getClearColor(this.originalClearColor);const st=tt.getClearAlpha(),at=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,it=_e.clearColor||it,nt=_e.clearAlpha||nt,it!=null&&(tt.setClearColor(it),tt.setClearAlpha(nt||0),tt.clear()),this.scene.overrideMaterial=_e,tt.render(this.scene,this.camera),this.scene.overrideMaterial=null,tt.autoClear=at,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}setSize(tt,_e){this.width=tt,this.height=_e,this.beautyRenderTarget.setSize(tt,_e),this.ssaoRenderTarget.setSize(tt,_e),this.normalRenderTarget.setSize(tt,_e),this.blurRenderTarget.setSize(tt,_e),this.ssaoMaterial.uniforms.resolution.value.set(tt,_e),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(tt,_e)}generateSampleKernel(){const tt=this.kernelSize,_e=this.kernel;for(let rt=0;rt<tt;rt++){const it=new Vector3;it.x=Math.random()*2-1,it.y=Math.random()*2-1,it.z=Math.random(),it.normalize();let nt=rt/tt;nt=MathUtils.lerp(.1,1,nt*nt),it.multiplyScalar(nt),_e.push(it)}}generateRandomKernelRotations(){SimplexNoise===void 0&&console.error("THREE.SSAOPass: The pass relies on SimplexNoise.");const rt=new SimplexNoise,it=4*4,nt=new Float32Array(it);for(let st=0;st<it;st++){const at=Math.random()*2-1,lt=Math.random()*2-1,ot=0;nt[st]=rt.noise3d(at,lt,ot)}this.noiseTexture=new DataTexture(nt,4,4,RedFormat,FloatType),this.noiseTexture.wrapS=RepeatWrapping,this.noiseTexture.wrapT=RepeatWrapping,this.noiseTexture.needsUpdate=!0}overrideVisibility(){const tt=this.scene,_e=this._visibilityCache;tt.traverse(function(rt){_e.set(rt,rt.visible),(rt.isPoints||rt.isLine)&&(rt.visible=!1)})}restoreVisibility(){const tt=this.scene,_e=this._visibilityCache;tt.traverse(function(rt){const it=_e.get(rt);rt.visible=it}),_e.clear()}};let SSAOPass=_SSAOPass;__publicField(SSAOPass,"OUTPUT",{Default:0,SSAO:1,Blur:2,Beauty:3,Depth:4,Normal:5});const LuminosityHighPassShader={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Color$1(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","	vec4 texel = texture2D( tDiffuse, vUv );","	vec3 luma = vec3( 0.299, 0.587, 0.114 );","	float v = dot( texel.xyz, luma );","	vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","	float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","	gl_FragColor = mix( outputColor, texel, alpha );","}"].join(`
`)},_UnrealBloomPass=class extends Pass{constructor(tt,_e,rt,it){super(),this.strength=_e!==void 0?_e:1,this.radius=rt,this.threshold=it,this.resolution=tt!==void 0?new Vector2(tt.x,tt.y):new Vector2(256,256),this.clearColor=new Color$1(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let nt=Math.round(this.resolution.x/2),st=Math.round(this.resolution.y/2);this.renderTargetBright=new WebGLRenderTarget(nt,st,{type:HalfFloatType}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let ut=0;ut<this.nMips;ut++){const ht=new WebGLRenderTarget(nt,st,{type:HalfFloatType});ht.texture.name="UnrealBloomPass.h"+ut,ht.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(ht);const dt=new WebGLRenderTarget(nt,st,{type:HalfFloatType});dt.texture.name="UnrealBloomPass.v"+ut,dt.texture.generateMipmaps=!1,this.renderTargetsVertical.push(dt),nt=Math.round(nt/2),st=Math.round(st/2)}const at=LuminosityHighPassShader;this.highPassUniforms=UniformsUtils.clone(at.uniforms),this.highPassUniforms.luminosityThreshold.value=it,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:at.vertexShader,fragmentShader:at.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const lt=[3,5,7,9,11];nt=Math.round(this.resolution.x/2),st=Math.round(this.resolution.y/2);for(let ut=0;ut<this.nMips;ut++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(lt[ut])),this.separableBlurMaterials[ut].uniforms.texSize.value=new Vector2(nt,st),nt=Math.round(nt/2),st=Math.round(st/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=_e,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const ot=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=ot,this.bloomTintColors=[new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const ct=CopyShader;this.copyUniforms=UniformsUtils.clone(ct.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ct.vertexShader,fragmentShader:ct.fragmentShader,blending:AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Color$1,this.oldClearAlpha=1,this.basic=new MeshBasicMaterial,this.fsQuad=new FullScreenQuad(null)}dispose(){for(let tt=0;tt<this.renderTargetsHorizontal.length;tt++)this.renderTargetsHorizontal[tt].dispose();for(let tt=0;tt<this.renderTargetsVertical.length;tt++)this.renderTargetsVertical[tt].dispose();this.renderTargetBright.dispose();for(let tt=0;tt<this.separableBlurMaterials.length;tt++)this.separableBlurMaterials[tt].dispose();this.compositeMaterial.dispose(),this.materialCopy.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(tt,_e){let rt=Math.round(tt/2),it=Math.round(_e/2);this.renderTargetBright.setSize(rt,it);for(let nt=0;nt<this.nMips;nt++)this.renderTargetsHorizontal[nt].setSize(rt,it),this.renderTargetsVertical[nt].setSize(rt,it),this.separableBlurMaterials[nt].uniforms.texSize.value=new Vector2(rt,it),rt=Math.round(rt/2),it=Math.round(it/2)}render(tt,_e,rt,it,nt){tt.getClearColor(this._oldClearColor),this.oldClearAlpha=tt.getClearAlpha();const st=tt.autoClear;tt.autoClear=!1,tt.setClearColor(this.clearColor,0),nt&&tt.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=rt.texture,tt.setRenderTarget(null),tt.clear(),this.fsQuad.render(tt)),this.highPassUniforms.tDiffuse.value=rt.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,tt.setRenderTarget(this.renderTargetBright),tt.clear(),this.fsQuad.render(tt);let at=this.renderTargetBright;for(let lt=0;lt<this.nMips;lt++)this.fsQuad.material=this.separableBlurMaterials[lt],this.separableBlurMaterials[lt].uniforms.colorTexture.value=at.texture,this.separableBlurMaterials[lt].uniforms.direction.value=_UnrealBloomPass.BlurDirectionX,tt.setRenderTarget(this.renderTargetsHorizontal[lt]),tt.clear(),this.fsQuad.render(tt),this.separableBlurMaterials[lt].uniforms.colorTexture.value=this.renderTargetsHorizontal[lt].texture,this.separableBlurMaterials[lt].uniforms.direction.value=_UnrealBloomPass.BlurDirectionY,tt.setRenderTarget(this.renderTargetsVertical[lt]),tt.clear(),this.fsQuad.render(tt),at=this.renderTargetsVertical[lt];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,tt.setRenderTarget(this.renderTargetsHorizontal[0]),tt.clear(),this.fsQuad.render(tt),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,nt&&tt.state.buffers.stencil.setTest(!0),this.renderToScreen?(tt.setRenderTarget(null),this.fsQuad.render(tt)):(tt.setRenderTarget(rt),this.fsQuad.render(tt)),tt.setClearColor(this._oldClearColor,this.oldClearAlpha),tt.autoClear=st}getSeperableBlurMaterial(tt){return new ShaderMaterial({defines:{KERNEL_RADIUS:tt,SIGMA:tt},uniforms:{colorTexture:{value:null},texSize:{value:new Vector2(.5,.5)},direction:{value:new Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(tt){return new ShaderMaterial({defines:{NUM_MIPS:tt},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}};let UnrealBloomPass=_UnrealBloomPass;__publicField(UnrealBloomPass,"BlurDirectionX",new Vector2(1,0));__publicField(UnrealBloomPass,"BlurDirectionY",new Vector2(0,1));const SAOShader={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","	#if DIFFUSE_TEXTURE == 1","	return texture2D( tDiffuse, vUv );","	#else","	return vec4( 1.0 );","	#endif","}","float getDepth( const in vec2 screenPosition ) {","	#if DEPTH_PACKING == 1","	return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","	#else","	return texture2D( tDepth, screenPosition ).x;","	#endif","}","float getViewZ( const in float depth ) {","	#if PERSPECTIVE_CAMERA == 1","	return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","	#else","	return orthographicDepthToViewZ( depth, cameraNear, cameraFar );","	#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","	float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","	vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","	clipPosition *= clipW; // unprojection.","	return ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","	#if NORMAL_TEXTURE == 1","	return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","	#else","	return normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","	#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","	vec3 viewDelta = sampleViewPosition - centerViewPosition;","	float viewDistance = length( viewDelta );","	float scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","	return max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","	// precompute some variables require in getOcclusion.","	scaleDividedByCameraFar = scale / cameraFar;","	minResolutionMultipliedByCameraFar = minResolution * cameraFar;","	vec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","	// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","	float angle = rand( vUv + randomSeed ) * PI2;","	vec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","	vec2 radiusStep = radius;","	float occlusionSum = 0.0;","	float weightSum = 0.0;","	for( int i = 0; i < NUM_SAMPLES; i ++ ) {","		vec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","		radius += radiusStep;","		angle += ANGLE_STEP;","		float sampleDepth = getDepth( sampleUv );","		if( sampleDepth >= ( 1.0 - EPSILON ) ) {","			continue;","		}","		float sampleViewZ = getViewZ( sampleDepth );","		vec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","		occlusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","		weightSum += 1.0;","	}","	if( weightSum == 0.0 ) discard;","	return occlusionSum * ( intensity / weightSum );","}","void main() {","	float centerDepth = getDepth( vUv );","	if( centerDepth >= ( 1.0 - EPSILON ) ) {","		discard;","	}","	float centerViewZ = getViewZ( centerDepth );","	vec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","	float ambientOcclusion = getAmbientOcclusion( viewPosition );","	gl_FragColor = getDefaultColor( vUv );","	gl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join(`
`)},DepthLimitedBlurShader={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new Vector2(512,512)},sampleUvOffsets:{value:[new Vector2(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","	vUv = uv;","	vInvSize = 1.0 / size;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","	#if DEPTH_PACKING == 1","	return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","	#else","	return texture2D( tDepth, screenPosition ).x;","	#endif","}","float getViewZ( const in float depth ) {","	#if PERSPECTIVE_CAMERA == 1","	return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","	#else","	return orthographicDepthToViewZ( depth, cameraNear, cameraFar );","	#endif","}","void main() {","	float depth = getDepth( vUv );","	if( depth >= ( 1.0 - EPSILON ) ) {","		discard;","	}","	float centerViewZ = -getViewZ( depth );","	bool rBreak = false, lBreak = false;","	float weightSum = sampleWeights[0];","	vec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","	for( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","		float sampleWeight = sampleWeights[i];","		vec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","		vec2 sampleUv = vUv + sampleUvOffset;","		float viewZ = -getViewZ( getDepth( sampleUv ) );","		if( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","		if( ! rBreak ) {","			diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","			weightSum += sampleWeight;","		}","		sampleUv = vUv - sampleUvOffset;","		viewZ = -getViewZ( getDepth( sampleUv ) );","		if( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","		if( ! lBreak ) {","			diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","			weightSum += sampleWeight;","		}","	}","	gl_FragColor = diffuseSum / weightSum;","}"].join(`
`)},BlurShaderUtils={createSampleWeights:(tt,_e)=>{const rt=(nt,st)=>Math.exp(-(nt*nt)/(2*(st*st)))/(Math.sqrt(2*Math.PI)*st),it=[];for(let nt=0;nt<=tt;nt++)it.push(rt(nt,_e));return it},createSampleOffsets:(tt,_e)=>{const rt=[];for(let it=0;it<=tt;it++)rt.push(_e.clone().multiplyScalar(it));return rt},configure:(tt,_e,rt,it)=>{tt.defines.KERNEL_RADIUS=_e,tt.uniforms.sampleUvOffsets.value=BlurShaderUtils.createSampleOffsets(_e,it),tt.uniforms.sampleWeights.value=BlurShaderUtils.createSampleWeights(_e,rt),tt.needsUpdate=!0}};class SAOPass extends Pass{constructor(_e,rt,it=!1,nt=!1,st=new Vector2(256,256)){super(),this.scene=_e,this.camera=rt,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=it,this.supportsNormalTexture=nt,this.originalClearColor=new Color$1,this._oldClearColor=new Color$1,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=new Vector2(st.x,st.y),this.saoRenderTarget=new WebGLRenderTarget(this.resolution.x,this.resolution.y,{type:HalfFloatType}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType}),this.depthRenderTarget=this.normalRenderTarget.clone();let at;this.supportsDepthTextureExtension&&(at=new DepthTexture,at.type=UnsignedShortType,this.beautyRenderTarget.depthTexture=at,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new MeshDepthMaterial,this.depthMaterial.depthPacking=RGBADepthPacking,this.depthMaterial.blending=NoBlending,this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,this.saoMaterial=new ShaderMaterial({defines:Object.assign({},SAOShader.defines),fragmentShader:SAOShader.fragmentShader,vertexShader:SAOShader.vertexShader,uniforms:UniformsUtils.clone(SAOShader.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?at:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=NoBlending,this.vBlurMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(DepthLimitedBlurShader.uniforms),defines:Object.assign({},DepthLimitedBlurShader.defines),vertexShader:DepthLimitedBlurShader.vertexShader,fragmentShader:DepthLimitedBlurShader.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?at:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=NoBlending,this.hBlurMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(DepthLimitedBlurShader.uniforms),defines:Object.assign({},DepthLimitedBlurShader.defines),vertexShader:DepthLimitedBlurShader.vertexShader,fragmentShader:DepthLimitedBlurShader.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?at:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=NoBlending,this.materialCopy=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,blending:NoBlending}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=CustomBlending,this.materialCopy.blendSrc=DstColorFactor,this.materialCopy.blendDst=ZeroFactor,this.materialCopy.blendEquation=AddEquation,this.materialCopy.blendSrcAlpha=DstAlphaFactor,this.materialCopy.blendDstAlpha=ZeroFactor,this.materialCopy.blendEquationAlpha=AddEquation,this.depthCopy=new ShaderMaterial({uniforms:UniformsUtils.clone(UnpackDepthRGBAShader.uniforms),vertexShader:UnpackDepthRGBAShader.vertexShader,fragmentShader:UnpackDepthRGBAShader.fragmentShader,blending:NoBlending}),this.fsQuad=new FullScreenQuad(null)}render(_e,rt,it){if(this.renderToScreen&&(this.materialCopy.blending=NoBlending,this.materialCopy.uniforms.tDiffuse.value=it.texture,this.materialCopy.needsUpdate=!0,this.renderPass(_e,this.materialCopy,null)),this.params.output===1)return;_e.getClearColor(this._oldClearColor),this.oldClearAlpha=_e.getClearAlpha();const nt=_e.autoClear;_e.autoClear=!1,_e.setRenderTarget(this.depthRenderTarget),_e.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;const st=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=st,this.hBlurMaterial.uniforms.depthCutoff.value=st,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(BlurShaderUtils.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new Vector2(0,1)),BlurShaderUtils.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new Vector2(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),_e.setClearColor(0),_e.setRenderTarget(this.beautyRenderTarget),_e.clear(),_e.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(_e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(_e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(_e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(_e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(_e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let at=this.materialCopy;this.params.output===3?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,at=this.depthCopy):this.params.output===4?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),this.params.output===0?at.blending=CustomBlending:at.blending=NoBlending,this.renderPass(_e,at,this.renderToScreen?null:it),_e.setClearColor(this._oldClearColor,this.oldClearAlpha),_e.autoClear=nt}renderPass(_e,rt,it,nt,st){_e.getClearColor(this.originalClearColor);const at=_e.getClearAlpha(),lt=_e.autoClear;_e.setRenderTarget(it),_e.autoClear=!1,nt!=null&&(_e.setClearColor(nt),_e.setClearAlpha(st||0),_e.clear()),this.fsQuad.material=rt,this.fsQuad.render(_e),_e.autoClear=lt,_e.setClearColor(this.originalClearColor),_e.setClearAlpha(at)}renderOverride(_e,rt,it,nt,st){_e.getClearColor(this.originalClearColor);const at=_e.getClearAlpha(),lt=_e.autoClear;_e.setRenderTarget(it),_e.autoClear=!1,nt=rt.clearColor||nt,st=rt.clearAlpha||st,nt!=null&&(_e.setClearColor(nt),_e.setClearAlpha(st||0),_e.clear()),this.scene.overrideMaterial=rt,_e.render(this.scene,this.camera),this.scene.overrideMaterial=null,_e.autoClear=lt,_e.setClearColor(this.originalClearColor),_e.setClearAlpha(at)}setSize(_e,rt){this.beautyRenderTarget.setSize(_e,rt),this.saoRenderTarget.setSize(_e,rt),this.blurIntermediateRenderTarget.setSize(_e,rt),this.normalRenderTarget.setSize(_e,rt),this.depthRenderTarget.setSize(_e,rt),this.saoMaterial.uniforms.size.value.set(_e,rt),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(_e,rt),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(_e,rt),this.hBlurMaterial.needsUpdate=!0}dispose(){this.saoRenderTarget.dispose(),this.blurIntermediateRenderTarget.dispose(),this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.depthRenderTarget.dispose(),this.depthMaterial.dispose(),this.normalMaterial.dispose(),this.saoMaterial.dispose(),this.vBlurMaterial.dispose(),this.hBlurMaterial.dispose(),this.materialCopy.dispose(),this.depthCopy.dispose(),this.fsQuad.dispose()}}__publicField(SAOPass,"OUTPUT",{Beauty:1,Default:0,SAO:2,Depth:3,Normal:4});const SSRShader={defines:{MAX_STEP:0,isPerspectiveCamera:!0,isDistanceAttenuation:!0,isFresnel:!0,isInfiniteThick:!1,isSelective:!1},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tMetalness:{value:null},tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new Vector2},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},opacity:{value:.5},maxDistance:{value:180},cameraRange:{value:0},surfDist:{value:.007},thickTolerance:{value:.03}},vertexShader:`

    varying vec2 vUv;

    void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }

  `,fragmentShader:`
		// precision highp float;
		precision highp sampler2D;
		varying vec2 vUv;
		uniform sampler2D tDepth;
		uniform sampler2D tNormal;
		uniform sampler2D tMetalness;
		uniform sampler2D tDiffuse;
		uniform float cameraRange;
		uniform vec2 resolution;
		uniform float opacity;
		uniform float cameraNear;
		uniform float cameraFar;
		uniform float maxDistance;
		uniform float surfDist;
		uniform mat4 cameraProjectionMatrix;
		uniform mat4 cameraInverseProjectionMatrix;
		uniform float thickTolerance;
		#include <packing>
		float pointToLineDistance(vec3 x0, vec3 x1, vec3 x2) {
			//x0: point, x1: linePointA, x2: linePointB
			//https://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html
			return length(cross(x0-x1,x0-x2))/length(x2-x1);
		}
		float pointPlaneDistance(vec3 point,vec3 planePoint,vec3 planeNormal){
			// https://mathworld.wolfram.com/Point-PlaneDistance.html
			//// https://en.wikipedia.org/wiki/Plane_(geometry)
			//// http://paulbourke.net/geometry/pointlineplane/
			float a=planeNormal.x,b=planeNormal.y,c=planeNormal.z;
			float x0=point.x,y0=point.y,z0=point.z;
			float x=planePoint.x,y=planePoint.y,z=planePoint.z;
			float d=-(a*x+b*y+c*z);
			float distance=(a*x0+b*y0+c*z0+d)/sqrt(a*a+b*b+c*c);
			return distance;
		}
		float getDepth( const in vec2 uv ) {
			return texture2D( tDepth, uv ).x;
		}
		float getViewZ( const in float depth ) {
			#ifdef isPerspectiveCamera
				return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
				return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}
		vec3 getViewPosition( const in vec2 uv, const in float depth/*clip space*/, const in float clipW ) {
			vec4 clipPosition = vec4( ( vec3( uv, depth ) - 0.5 ) * 2.0, 1.0 );//ndc
			clipPosition *= clipW; //clip
			return ( cameraInverseProjectionMatrix * clipPosition ).xyz;//view
		}
		vec3 getViewNormal( const in vec2 uv ) {
			return unpackRGBToNormal( texture2D( tNormal, uv ).xyz );
		}
		vec2 viewPositionToXY(vec3 viewPosition){
			vec2 xy;
			vec4 clip=cameraProjectionMatrix*vec4(viewPosition,1);
			xy=clip.xy;//clip
			float clipW=clip.w;
			xy/=clipW;//NDC
			xy=(xy+1.)/2.;//uv
			xy*=resolution;//screen
			return xy;
		}
		void main(){
			#ifdef isSelective
				float metalness=texture2D(tMetalness,vUv).r;
				if(metalness==0.) return;
			#endif

			float depth = getDepth( vUv );
			float viewZ = getViewZ( depth );
			if(-viewZ>=cameraFar) return;

			float clipW = cameraProjectionMatrix[2][3] * viewZ+cameraProjectionMatrix[3][3];
			vec3 viewPosition=getViewPosition( vUv, depth, clipW );

			vec2 d0=gl_FragCoord.xy;
			vec2 d1;

			vec3 viewNormal=getViewNormal( vUv );

			#ifdef isPerspectiveCamera
				vec3 viewIncidenceDir=normalize(viewPosition);
				vec3 viewReflectDir=reflect(viewIncidenceDir,viewNormal);
			#else
				vec3 viewIncidenceDir=vec3(0,0,-1);
				vec3 viewReflectDir=reflect(viewIncidenceDir,viewNormal);
			#endif

			float maxReflectRayLen=maxDistance/dot(-viewIncidenceDir,viewNormal);
			// dot(a,b)==length(a)*length(b)*cos(theta) // https://www.mathsisfun.com/algebra/vectors-dot-product.html
			// if(a.isNormalized&&b.isNormalized) dot(a,b)==cos(theta)
			// maxDistance/maxReflectRayLen=cos(theta)
			// maxDistance/maxReflectRayLen==dot(a,b)
			// maxReflectRayLen==maxDistance/dot(a,b)

			vec3 d1viewPosition=viewPosition+viewReflectDir*maxReflectRayLen;
			#ifdef isPerspectiveCamera
				if(d1viewPosition.z>-cameraNear){
					//https://tutorial.math.lamar.edu/Classes/CalcIII/EqnsOfLines.aspx
					float t=(-cameraNear-viewPosition.z)/viewReflectDir.z;
					d1viewPosition=viewPosition+viewReflectDir*t;
				}
			#endif
			d1=viewPositionToXY(d1viewPosition);

			float totalLen=length(d1-d0);
			float xLen=d1.x-d0.x;
			float yLen=d1.y-d0.y;
			float totalStep=max(abs(xLen),abs(yLen));
			float xSpan=xLen/totalStep;
			float ySpan=yLen/totalStep;
			for(float i=0.;i<MAX_STEP;i++){
				if(i>=totalStep) break;
				vec2 xy=vec2(d0.x+i*xSpan,d0.y+i*ySpan);
				if(xy.x<0.||xy.x>resolution.x||xy.y<0.||xy.y>resolution.y) break;
				float s=length(xy-d0)/totalLen;
				vec2 uv=xy/resolution;

				float d = getDepth(uv);
				float vZ = getViewZ( d );
				if(-vZ>=cameraFar) continue;
				float cW = cameraProjectionMatrix[2][3] * vZ+cameraProjectionMatrix[3][3];
				vec3 vP=getViewPosition( uv, d, cW );

				#ifdef isPerspectiveCamera
					// https://www.comp.nus.edu.sg/~lowkl/publications/lowk_persp_interp_techrep.pdf
					float recipVPZ=1./viewPosition.z;
					float viewReflectRayZ=1./(recipVPZ+s*(1./d1viewPosition.z-recipVPZ));
					float sD=surfDist*cW;
				#else
					float viewReflectRayZ=viewPosition.z+s*(d1viewPosition.z-viewPosition.z);
					float sD=surfDist;
				#endif
				if(viewReflectRayZ-sD>vZ) continue;

				#ifdef isInfiniteThick
					if(viewReflectRayZ+thickTolerance*clipW<vP.z) break;
				#endif
				float away=pointToLineDistance(vP,viewPosition,d1viewPosition);

				float op=opacity;

				if(away<sD){
					vec3 vN=getViewNormal( uv );
					if(dot(viewReflectDir,vN)>=0.) continue;
					float distance=pointPlaneDistance(vP,viewPosition,viewNormal);
					if(distance>maxDistance) break;
					#ifdef isDistanceAttenuation
						float ratio=1.-(distance/maxDistance);
						float attenuation=ratio*ratio;
						op=opacity*attenuation;
					#endif
					#ifdef isFresnel
						float fresnel=(dot(viewIncidenceDir,viewReflectDir)+1.)/2.;
						op*=fresnel;
					#endif
					vec4 reflectColor=texture2D(tDiffuse,uv);
					gl_FragColor.xyz=reflectColor.xyz;
					gl_FragColor.a=op;
					break;
				}
			}
		}
	`},SSRDepthShader={defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:`

    varying vec2 vUv;

    void main() {

    	vUv = uv;
    	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }

  `,fragmentShader:`

    uniform sampler2D tDepth;

    uniform float cameraNear;
    uniform float cameraFar;

    varying vec2 vUv;

    #include <packing>

		float getLinearDepth( const in vec2 uv ) {

			#if PERSPECTIVE_CAMERA == 1

				float fragCoordZ = texture2D( tDepth, uv ).x;
				float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );
				return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );

			#else

				return texture2D( tDepth, uv ).x;

			#endif

		}

    void main() {

    	float depth = getLinearDepth( vUv );
			float d = 1.0 - depth;
			// d=(d-.999)*1000.;
    	gl_FragColor = vec4( vec3( d ), 1.0 );

    }

  `},SSRBlurShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2},opacity:{value:.5}},vertexShader:`

    varying vec2 vUv;

    void main() {

    	vUv = uv;
    	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }

  `,fragmentShader:`

    uniform sampler2D tDiffuse;
    uniform vec2 resolution;
    varying vec2 vUv;
    void main() {
			//reverse engineering from PhotoShop blur filter, then change coefficient

    	vec2 texelSize = ( 1.0 / resolution );

			vec4 c=texture2D(tDiffuse,vUv);

			vec2 offset;

			offset=(vec2(-1,0))*texelSize;
			vec4 cl=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(1,0))*texelSize;
			vec4 cr=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(0,-1))*texelSize;
			vec4 cb=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(0,1))*texelSize;
			vec4 ct=texture2D(tDiffuse,vUv+offset);

			// float coeCenter=.5;
			// float coeSide=.125;
			float coeCenter=.2;
			float coeSide=.2;
			float a=c.a*coeCenter+cl.a*coeSide+cr.a*coeSide+cb.a*coeSide+ct.a*coeSide;
			vec3 rgb=(c.rgb*c.a*coeCenter+cl.rgb*cl.a*coeSide+cr.rgb*cr.a*coeSide+cb.rgb*cb.a*coeSide+ct.rgb*ct.a*coeSide)/a;
			gl_FragColor=vec4(rgb,a);

		}
	`},_SSRPass=class extends Pass{constructor({renderer:tt,scene:_e,camera:rt,width:it,height:nt,selects:st,bouncing:at=!1,groundReflector:lt}){super(),this.width=it!==void 0?it:512,this.height=nt!==void 0?nt:512,this.clear=!0,this.renderer=tt,this.scene=_e,this.camera=rt,this.groundReflector=lt,this.opacity=SSRShader.uniforms.opacity.value,this.output=0,this.maxDistance=SSRShader.uniforms.maxDistance.value,this.thickness=SSRShader.uniforms.thickness.value,this.tempColor=new Color$1,this._selects=st,this.selective=Array.isArray(this._selects),Object.defineProperty(this,"selects",{get(){return this._selects},set(ct){this._selects!==ct&&(this._selects=ct,Array.isArray(ct)?(this.selective=!0,this.ssrMaterial.defines.SELECTIVE=!0,this.ssrMaterial.needsUpdate=!0):(this.selective=!1,this.ssrMaterial.defines.SELECTIVE=!1,this.ssrMaterial.needsUpdate=!0))}}),this._bouncing=at,Object.defineProperty(this,"bouncing",{get(){return this._bouncing},set(ct){this._bouncing!==ct&&(this._bouncing=ct,ct?this.ssrMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture:this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture)}}),this.blur=!0,this._distanceAttenuation=SSRShader.defines.DISTANCE_ATTENUATION,Object.defineProperty(this,"distanceAttenuation",{get(){return this._distanceAttenuation},set(ct){this._distanceAttenuation!==ct&&(this._distanceAttenuation=ct,this.ssrMaterial.defines.DISTANCE_ATTENUATION=ct,this.ssrMaterial.needsUpdate=!0)}}),this._fresnel=SSRShader.defines.FRESNEL,Object.defineProperty(this,"fresnel",{get(){return this._fresnel},set(ct){this._fresnel!==ct&&(this._fresnel=ct,this.ssrMaterial.defines.FRESNEL=ct,this.ssrMaterial.needsUpdate=!0)}}),this._infiniteThick=SSRShader.defines.INFINITE_THICK,Object.defineProperty(this,"infiniteThick",{get(){return this._infiniteThick},set(ct){this._infiniteThick!==ct&&(this._infiniteThick=ct,this.ssrMaterial.defines.INFINITE_THICK=ct,this.ssrMaterial.needsUpdate=!0)}});const ot=new DepthTexture;ot.type=UnsignedShortType,ot.minFilter=NearestFilter,ot.magFilter=NearestFilter,this.beautyRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType,depthTexture:ot,depthBuffer:!0}),this.prevRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter}),this.normalRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType}),this.metalnessRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType}),this.ssrRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter}),this.blurRenderTarget=this.ssrRenderTarget.clone(),this.blurRenderTarget2=this.ssrRenderTarget.clone(),this.ssrMaterial=new ShaderMaterial({defines:Object.assign({},SSRShader.defines,{MAX_STEP:Math.sqrt(this.width*this.width+this.height*this.height)}),uniforms:UniformsUtils.clone(SSRShader.uniforms),vertexShader:SSRShader.vertexShader,fragmentShader:SSRShader.fragmentShader,blending:NoBlending}),this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssrMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssrMaterial.defines.SELECTIVE=this.selective,this.ssrMaterial.needsUpdate=!0,this.ssrMaterial.uniforms.tMetalness.value=this.metalnessRenderTarget.texture,this.ssrMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.ssrMaterial.uniforms.cameraNear.value=this.camera.near,this.ssrMaterial.uniforms.cameraFar.value=this.camera.far,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.ssrMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,this.metalnessOnMaterial=new MeshBasicMaterial({color:"white"}),this.metalnessOffMaterial=new MeshBasicMaterial({color:"black"}),this.blurMaterial=new ShaderMaterial({defines:Object.assign({},SSRBlurShader.defines),uniforms:UniformsUtils.clone(SSRBlurShader.uniforms),vertexShader:SSRBlurShader.vertexShader,fragmentShader:SSRBlurShader.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.blurMaterial2=new ShaderMaterial({defines:Object.assign({},SSRBlurShader.defines),uniforms:UniformsUtils.clone(SSRBlurShader.uniforms),vertexShader:SSRBlurShader.vertexShader,fragmentShader:SSRBlurShader.fragmentShader}),this.blurMaterial2.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.blurMaterial2.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new ShaderMaterial({defines:Object.assign({},SSRDepthShader.defines),uniforms:UniformsUtils.clone(SSRDepthShader.uniforms),vertexShader:SSRDepthShader.vertexShader,fragmentShader:SSRDepthShader.fragmentShader,blending:NoBlending}),this.depthRenderMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:SrcAlphaFactor,blendDst:OneMinusSrcAlphaFactor,blendEquation:AddEquation,blendSrcAlpha:SrcAlphaFactor,blendDstAlpha:OneMinusSrcAlphaFactor,blendEquationAlpha:AddEquation}),this.fsQuad=new FullScreenQuad(null),this.originalClearColor=new Color$1}dispose(){this.beautyRenderTarget.dispose(),this.prevRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.metalnessRenderTarget.dispose(),this.ssrRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.blurRenderTarget2.dispose(),this.normalMaterial.dispose(),this.metalnessOnMaterial.dispose(),this.metalnessOffMaterial.dispose(),this.blurMaterial.dispose(),this.blurMaterial2.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(tt,_e){switch(tt.setRenderTarget(this.beautyRenderTarget),tt.clear(),this.groundReflector&&(this.groundReflector.visible=!1,this.groundReflector.doRender(this.renderer,this.scene,this.camera),this.groundReflector.visible=!0),tt.render(this.scene,this.camera),this.groundReflector&&(this.groundReflector.visible=!1),this.renderOverride(tt,this.normalMaterial,this.normalRenderTarget,0,0),this.selective&&this.renderMetalness(tt,this.metalnessOnMaterial,this.metalnessRenderTarget,0,0),this.ssrMaterial.uniforms.opacity.value=this.opacity,this.ssrMaterial.uniforms.maxDistance.value=this.maxDistance,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.renderPass(tt,this.ssrMaterial,this.ssrRenderTarget),this.blur&&(this.renderPass(tt,this.blurMaterial,this.blurRenderTarget),this.renderPass(tt,this.blurMaterial2,this.blurRenderTarget2)),this.output){case _SSRPass.OUTPUT.Default:this.bouncing?(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.prevRenderTarget),this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=NormalBlending,this.renderPass(tt,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e)):(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e),this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=NormalBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e));break;case _SSRPass.OUTPUT.SSR:this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e),this.bouncing&&(this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=NormalBlending,this.renderPass(tt,this.copyMaterial,this.prevRenderTarget));break;case _SSRPass.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSRPass.OUTPUT.Depth:this.renderPass(tt,this.depthRenderMaterial,this.renderToScreen?null:_e);break;case _SSRPass.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;case _SSRPass.OUTPUT.Metalness:this.copyMaterial.uniforms.tDiffuse.value=this.metalnessRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(tt,this.copyMaterial,this.renderToScreen?null:_e);break;default:console.warn("THREE.SSRPass: Unknown output type.")}}renderPass(tt,_e,rt,it,nt){this.originalClearColor.copy(tt.getClearColor(this.tempColor));const st=tt.getClearAlpha(this.tempColor),at=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,it!=null&&(tt.setClearColor(it),tt.setClearAlpha(nt||0),tt.clear()),this.fsQuad.material=_e,this.fsQuad.render(tt),tt.autoClear=at,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}renderOverride(tt,_e,rt,it,nt){this.originalClearColor.copy(tt.getClearColor(this.tempColor));const st=tt.getClearAlpha(this.tempColor),at=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,it=_e.clearColor||it,nt=_e.clearAlpha||nt,it!=null&&(tt.setClearColor(it),tt.setClearAlpha(nt||0),tt.clear()),this.scene.overrideMaterial=_e,tt.render(this.scene,this.camera),this.scene.overrideMaterial=null,tt.autoClear=at,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}renderMetalness(tt,_e,rt,it,nt){this.originalClearColor.copy(tt.getClearColor(this.tempColor));const st=tt.getClearAlpha(this.tempColor),at=tt.autoClear;tt.setRenderTarget(rt),tt.autoClear=!1,it=_e.clearColor||it,nt=_e.clearAlpha||nt,it!=null&&(tt.setClearColor(it),tt.setClearAlpha(nt||0),tt.clear()),this.scene.traverseVisible(lt=>{lt._SSRPassBackupMaterial=lt.material,this._selects.includes(lt)?lt.material=this.metalnessOnMaterial:lt.material=this.metalnessOffMaterial}),tt.render(this.scene,this.camera),this.scene.traverseVisible(lt=>{lt.material=lt._SSRPassBackupMaterial}),tt.autoClear=at,tt.setClearColor(this.originalClearColor),tt.setClearAlpha(st)}setSize(tt,_e){this.width=tt,this.height=_e,this.ssrMaterial.defines.MAX_STEP=Math.sqrt(tt*tt+_e*_e),this.ssrMaterial.needsUpdate=!0,this.beautyRenderTarget.setSize(tt,_e),this.prevRenderTarget.setSize(tt,_e),this.ssrRenderTarget.setSize(tt,_e),this.normalRenderTarget.setSize(tt,_e),this.metalnessRenderTarget.setSize(tt,_e),this.blurRenderTarget.setSize(tt,_e),this.blurRenderTarget2.setSize(tt,_e),this.ssrMaterial.uniforms.resolution.value.set(tt,_e),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(tt,_e),this.blurMaterial2.uniforms.resolution.value.set(tt,_e)}};let SSRPass=_SSRPass;__publicField(SSRPass,"OUTPUT",{Default:0,SSR:1,Beauty:3,Depth:4,Normal:5,Metalness:7});let GLTFLoader$1=class extends Loader{constructor(_e){super(_e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(rt){return new GLTFMaterialsClearcoatExtension2(rt)}),this.register(function(rt){return new GLTFTextureBasisUExtension$1(rt)}),this.register(function(rt){return new GLTFTextureWebPExtension$1(rt)}),this.register(function(rt){return new GLTFTextureAVIFExtension$1(rt)}),this.register(function(rt){return new GLTFMaterialsSheenExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsTransmissionExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsVolumeExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsIorExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsEmissiveStrengthExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsSpecularExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsIridescenceExtension2(rt)}),this.register(function(rt){return new GLTFMaterialsAnisotropyExtension2(rt)}),this.register(function(rt){return new GLTFLightsExtension$1(rt)}),this.register(function(rt){return new GLTFMeshoptCompression$1(rt)}),this.register(function(rt){return new GLTFMeshGpuInstancing$1(rt)})}load(_e,rt,it,nt){const st=this;let at;this.resourcePath!==""?at=this.resourcePath:this.path!==""?at=this.path:at=LoaderUtils.extractUrlBase(_e),this.manager.itemStart(_e);const lt=function(ct){nt?nt(ct):console.error(ct),st.manager.itemError(_e),st.manager.itemEnd(_e)},ot=new FileLoader(this.manager);ot.setPath(this.path),ot.setResponseType("arraybuffer"),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(this.withCredentials),ot.load(_e,function(ct){try{st.parse(ct,at,function(ut){rt(ut),st.manager.itemEnd(_e)},lt)}catch(ut){lt(ut)}},it,lt)}setDRACOLoader(_e){return this.dracoLoader=_e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_e){return this.ktx2Loader=_e,this}setMeshoptDecoder(_e){return this.meshoptDecoder=_e,this}register(_e){return this.pluginCallbacks.indexOf(_e)===-1&&this.pluginCallbacks.push(_e),this}unregister(_e){return this.pluginCallbacks.indexOf(_e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_e),1),this}parse(_e,rt,it,nt){let st;const at={},lt={};if(typeof _e=="string")st=JSON.parse(_e);else if(_e instanceof ArrayBuffer)if(LoaderUtils.decodeText(new Uint8Array(_e.slice(0,4)))===BINARY_EXTENSION_HEADER_MAGIC$1){try{at[EXTENSIONS$1.KHR_BINARY_GLTF]=new GLTFBinaryExtension$1(_e)}catch(ut){nt&&nt(ut);return}st=JSON.parse(at[EXTENSIONS$1.KHR_BINARY_GLTF].content)}else st=JSON.parse(LoaderUtils.decodeText(new Uint8Array(_e)));else st=_e;if(st.asset===void 0||st.asset.version[0]<2){nt&&nt(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const ot=new GLTFParser$1(st,{path:rt||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ot.fileLoader.setRequestHeader(this.requestHeader);for(let ct=0;ct<this.pluginCallbacks.length;ct++){const ut=this.pluginCallbacks[ct](ot);lt[ut.name]=ut,at[ut.name]=!0}if(st.extensionsUsed)for(let ct=0;ct<st.extensionsUsed.length;++ct){const ut=st.extensionsUsed[ct],ht=st.extensionsRequired||[];switch(ut){case EXTENSIONS$1.KHR_MATERIALS_UNLIT:at[ut]=new GLTFMaterialsUnlitExtension2;break;case EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION:at[ut]=new GLTFDracoMeshCompressionExtension$1(st,this.dracoLoader);break;case EXTENSIONS$1.KHR_TEXTURE_TRANSFORM:at[ut]=new GLTFTextureTransformExtension$1;break;case EXTENSIONS$1.KHR_MESH_QUANTIZATION:at[ut]=new GLTFMeshQuantizationExtension$1;break;default:ht.indexOf(ut)>=0&&lt[ut]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ut+'".')}}ot.setExtensions(at),ot.setPlugins(lt),ot.parse(it,nt)}parseAsync(_e,rt){const it=this;return new Promise(function(nt,st){it.parse(_e,rt,nt,st)})}};function GLTFRegistry$1(){let tt={};return{get:function(_e){return tt[_e]},add:function(_e,rt){tt[_e]=rt},remove:function(_e){delete tt[_e]},removeAll:function(){tt={}}}}const EXTENSIONS$1={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let GLTFLightsExtension$1=class{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _e=this.parser,rt=this.parser.json.nodes||[];for(let it=0,nt=rt.length;it<nt;it++){const st=rt[it];st.extensions&&st.extensions[this.name]&&st.extensions[this.name].light!==void 0&&_e._addNodeRef(this.cache,st.extensions[this.name].light)}}_loadLight(_e){const rt=this.parser,it="light:"+_e;let nt=rt.cache.get(it);if(nt)return nt;const st=rt.json,ot=((st.extensions&&st.extensions[this.name]||{}).lights||[])[_e];let ct;const ut=new Color$1(16777215);ot.color!==void 0&&ut.fromArray(ot.color);const ht=ot.range!==void 0?ot.range:0;switch(ot.type){case"directional":ct=new DirectionalLight(ut),ct.target.position.set(0,0,-1),ct.add(ct.target);break;case"point":ct=new PointLight(ut),ct.distance=ht;break;case"spot":ct=new SpotLight(ut),ct.distance=ht,ot.spot=ot.spot||{},ot.spot.innerConeAngle=ot.spot.innerConeAngle!==void 0?ot.spot.innerConeAngle:0,ot.spot.outerConeAngle=ot.spot.outerConeAngle!==void 0?ot.spot.outerConeAngle:Math.PI/4,ct.angle=ot.spot.outerConeAngle,ct.penumbra=1-ot.spot.innerConeAngle/ot.spot.outerConeAngle,ct.target.position.set(0,0,-1),ct.add(ct.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+ot.type)}return ct.position.set(0,0,0),ct.decay=2,assignExtrasToUserData$1(ct,ot),ot.intensity!==void 0&&(ct.intensity=ot.intensity),ct.name=rt.createUniqueName(ot.name||"light_"+_e),nt=Promise.resolve(ct),rt.cache.add(it,nt),nt}getDependency(_e,rt){if(_e==="light")return this._loadLight(rt)}createNodeAttachment(_e){const rt=this,it=this.parser,st=it.json.nodes[_e],lt=(st.extensions&&st.extensions[this.name]||{}).light;return lt===void 0?null:this._loadLight(lt).then(function(ot){return it._getNodeRef(rt.cache,lt,ot)})}};class GLTFMaterialsUnlitExtension2{constructor(){this.name=EXTENSIONS$1.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_e,rt,it){const nt=[];_e.color=new Color$1(1,1,1),_e.opacity=1;const st=rt.pbrMetallicRoughness;if(st){if(Array.isArray(st.baseColorFactor)){const at=st.baseColorFactor;_e.color.fromArray(at),_e.opacity=at[3]}st.baseColorTexture!==void 0&&nt.push(it.assignTexture(_e,"map",st.baseColorTexture,3001))}return Promise.all(nt)}}class GLTFMaterialsEmissiveStrengthExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_e,rt){const nt=this.parser.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=nt.extensions[this.name].emissiveStrength;return st!==void 0&&(rt.emissiveIntensity=st),Promise.resolve()}}class GLTFMaterialsClearcoatExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_CLEARCOAT}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];if(at.clearcoatFactor!==void 0&&(rt.clearcoat=at.clearcoatFactor),at.clearcoatTexture!==void 0&&st.push(it.assignTexture(rt,"clearcoatMap",at.clearcoatTexture)),at.clearcoatRoughnessFactor!==void 0&&(rt.clearcoatRoughness=at.clearcoatRoughnessFactor),at.clearcoatRoughnessTexture!==void 0&&st.push(it.assignTexture(rt,"clearcoatRoughnessMap",at.clearcoatRoughnessTexture)),at.clearcoatNormalTexture!==void 0&&(st.push(it.assignTexture(rt,"clearcoatNormalMap",at.clearcoatNormalTexture)),at.clearcoatNormalTexture.scale!==void 0)){const lt=at.clearcoatNormalTexture.scale;rt.clearcoatNormalScale=new Vector2(lt,lt)}return Promise.all(st)}}class GLTFMaterialsIridescenceExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];return at.iridescenceFactor!==void 0&&(rt.iridescence=at.iridescenceFactor),at.iridescenceTexture!==void 0&&st.push(it.assignTexture(rt,"iridescenceMap",at.iridescenceTexture)),at.iridescenceIor!==void 0&&(rt.iridescenceIOR=at.iridescenceIor),rt.iridescenceThicknessRange===void 0&&(rt.iridescenceThicknessRange=[100,400]),at.iridescenceThicknessMinimum!==void 0&&(rt.iridescenceThicknessRange[0]=at.iridescenceThicknessMinimum),at.iridescenceThicknessMaximum!==void 0&&(rt.iridescenceThicknessRange[1]=at.iridescenceThicknessMaximum),at.iridescenceThicknessTexture!==void 0&&st.push(it.assignTexture(rt,"iridescenceThicknessMap",at.iridescenceThicknessTexture)),Promise.all(st)}}class GLTFMaterialsSheenExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_SHEEN}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[];rt.sheenColor=new Color$1(0,0,0),rt.sheenRoughness=0,rt.sheen=1;const at=nt.extensions[this.name];return at.sheenColorFactor!==void 0&&rt.sheenColor.fromArray(at.sheenColorFactor),at.sheenRoughnessFactor!==void 0&&(rt.sheenRoughness=at.sheenRoughnessFactor),at.sheenColorTexture!==void 0&&st.push(it.assignTexture(rt,"sheenColorMap",at.sheenColorTexture,3001)),at.sheenRoughnessTexture!==void 0&&st.push(it.assignTexture(rt,"sheenRoughnessMap",at.sheenRoughnessTexture)),Promise.all(st)}}class GLTFMaterialsTransmissionExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_TRANSMISSION}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];return at.transmissionFactor!==void 0&&(rt.transmission=at.transmissionFactor),at.transmissionTexture!==void 0&&st.push(it.assignTexture(rt,"transmissionMap",at.transmissionTexture)),Promise.all(st)}}class GLTFMaterialsVolumeExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_VOLUME}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];rt.thickness=at.thicknessFactor!==void 0?at.thicknessFactor:0,at.thicknessTexture!==void 0&&st.push(it.assignTexture(rt,"thicknessMap",at.thicknessTexture)),rt.attenuationDistance=at.attenuationDistance||1/0;const lt=at.attenuationColor||[1,1,1];return rt.attenuationColor=new Color$1(lt[0],lt[1],lt[2]),Promise.all(st)}}class GLTFMaterialsIorExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_IOR}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=nt.extensions[this.name];return rt.ior=st.ior!==void 0?st.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_SPECULAR}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];rt.specularIntensity=at.specularFactor!==void 0?at.specularFactor:1,at.specularTexture!==void 0&&st.push(it.assignTexture(rt,"specularIntensityMap",at.specularTexture));const lt=at.specularColorFactor||[1,1,1];return rt.specularColor=new Color$1(lt[0],lt[1],lt[2]),at.specularColorTexture!==void 0&&st.push(it.assignTexture(rt,"specularColorMap",at.specularColorTexture,3001)),Promise.all(st)}}class GLTFMaterialsAnisotropyExtension2{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_MATERIALS_ANISOTROPY}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];return at.anisotropyStrength!==void 0&&(rt.anisotropy=at.anisotropyStrength),at.anisotropyRotation!==void 0&&(rt.anisotropyRotation=at.anisotropyRotation),at.anisotropyTexture!==void 0&&st.push(it.assignTexture(rt,"anisotropyMap",at.anisotropyTexture)),Promise.all(st)}}let GLTFTextureBasisUExtension$1=class{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.KHR_TEXTURE_BASISU}loadTexture(_e){const rt=this.parser,it=rt.json,nt=it.textures[_e];if(!nt.extensions||!nt.extensions[this.name])return null;const st=nt.extensions[this.name],at=rt.options.ktx2Loader;if(!at){if(it.extensionsRequired&&it.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return rt.loadTextureImage(_e,st.source,at)}},GLTFTextureWebPExtension$1=class{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_e){const rt=this.name,it=this.parser,nt=it.json,st=nt.textures[_e];if(!st.extensions||!st.extensions[rt])return null;const at=st.extensions[rt],lt=nt.images[at.source];let ot=it.textureLoader;if(lt.uri){const ct=it.options.manager.getHandler(lt.uri);ct!==null&&(ot=ct)}return this.detectSupport().then(function(ct){if(ct)return it.loadTextureImage(_e,at.source,ot);if(nt.extensionsRequired&&nt.extensionsRequired.indexOf(rt)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return it.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const rt=new Image;rt.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",rt.onload=rt.onerror=function(){_e(rt.height===1)}})),this.isSupported}},GLTFTextureAVIFExtension$1=class{constructor(_e){this.parser=_e,this.name=EXTENSIONS$1.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_e){const rt=this.name,it=this.parser,nt=it.json,st=nt.textures[_e];if(!st.extensions||!st.extensions[rt])return null;const at=st.extensions[rt],lt=nt.images[at.source];let ot=it.textureLoader;if(lt.uri){const ct=it.options.manager.getHandler(lt.uri);ct!==null&&(ot=ct)}return this.detectSupport().then(function(ct){if(ct)return it.loadTextureImage(_e,at.source,ot);if(nt.extensionsRequired&&nt.extensionsRequired.indexOf(rt)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return it.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const rt=new Image;rt.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",rt.onload=rt.onerror=function(){_e(rt.height===1)}})),this.isSupported}},GLTFMeshoptCompression$1=class{constructor(_e){this.name=EXTENSIONS$1.EXT_MESHOPT_COMPRESSION,this.parser=_e}loadBufferView(_e){const rt=this.parser.json,it=rt.bufferViews[_e];if(it.extensions&&it.extensions[this.name]){const nt=it.extensions[this.name],st=this.parser.getDependency("buffer",nt.buffer),at=this.parser.options.meshoptDecoder;if(!at||!at.supported){if(rt.extensionsRequired&&rt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return st.then(function(lt){const ot=nt.byteOffset||0,ct=nt.byteLength||0,ut=nt.count,ht=nt.byteStride,dt=new Uint8Array(lt,ot,ct);return at.decodeGltfBufferAsync?at.decodeGltfBufferAsync(ut,ht,dt,nt.mode,nt.filter).then(function(pt){return pt.buffer}):at.ready.then(function(){const pt=new ArrayBuffer(ut*ht);return at.decodeGltfBuffer(new Uint8Array(pt),ut,ht,dt,nt.mode,nt.filter),pt})})}else return null}},GLTFMeshGpuInstancing$1=class{constructor(_e){this.name=EXTENSIONS$1.EXT_MESH_GPU_INSTANCING,this.parser=_e}createNodeMesh(_e){const rt=this.parser.json,it=rt.nodes[_e];if(!it.extensions||!it.extensions[this.name]||it.mesh===void 0)return null;const nt=rt.meshes[it.mesh];for(const ct of nt.primitives)if(ct.mode!==WEBGL_CONSTANTS$1.TRIANGLES&&ct.mode!==WEBGL_CONSTANTS$1.TRIANGLE_STRIP&&ct.mode!==WEBGL_CONSTANTS$1.TRIANGLE_FAN&&ct.mode!==void 0)return null;const at=it.extensions[this.name].attributes,lt=[],ot={};for(const ct in at)lt.push(this.parser.getDependency("accessor",at[ct]).then(ut=>(ot[ct]=ut,ot[ct])));return lt.length<1?null:(lt.push(this.parser.createNodeMesh(_e)),Promise.all(lt).then(ct=>{const ut=ct.pop(),ht=ut.isGroup?ut.children:[ut],dt=ct[0].count,pt=[];for(const ft of ht){const gt=new Matrix4,mt=new Vector3,At=new Quaternion,yt=new Vector3(1,1,1),bt=new InstancedMesh(ft.geometry,ft.material,dt);for(let xt=0;xt<dt;xt++)ot.TRANSLATION&&mt.fromBufferAttribute(ot.TRANSLATION,xt),ot.ROTATION&&At.fromBufferAttribute(ot.ROTATION,xt),ot.SCALE&&yt.fromBufferAttribute(ot.SCALE,xt),bt.setMatrixAt(xt,gt.compose(mt,At,yt));for(const xt in ot)xt!=="TRANSLATION"&&xt!=="ROTATION"&&xt!=="SCALE"&&ft.geometry.setAttribute(xt,ot[xt]);Object3D.prototype.copy.call(bt,ft),this.parser.assignFinalMaterial(bt),pt.push(bt)}return ut.isGroup?(ut.clear(),ut.add(...pt),ut):pt[0]}))}};const BINARY_EXTENSION_HEADER_MAGIC$1="glTF",BINARY_EXTENSION_HEADER_LENGTH$1=12,BINARY_EXTENSION_CHUNK_TYPES$1={JSON:1313821514,BIN:5130562};let GLTFBinaryExtension$1=class{constructor(_e){this.name=EXTENSIONS$1.KHR_BINARY_GLTF,this.content=null,this.body=null;const rt=new DataView(_e,0,BINARY_EXTENSION_HEADER_LENGTH$1);if(this.header={magic:LoaderUtils.decodeText(new Uint8Array(_e.slice(0,4))),version:rt.getUint32(4,!0),length:rt.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC$1)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const it=this.header.length-BINARY_EXTENSION_HEADER_LENGTH$1,nt=new DataView(_e,BINARY_EXTENSION_HEADER_LENGTH$1);let st=0;for(;st<it;){const at=nt.getUint32(st,!0);st+=4;const lt=nt.getUint32(st,!0);if(st+=4,lt===BINARY_EXTENSION_CHUNK_TYPES$1.JSON){const ot=new Uint8Array(_e,BINARY_EXTENSION_HEADER_LENGTH$1+st,at);this.content=LoaderUtils.decodeText(ot)}else if(lt===BINARY_EXTENSION_CHUNK_TYPES$1.BIN){const ot=BINARY_EXTENSION_HEADER_LENGTH$1+st;this.body=_e.slice(ot,ot+at)}st+=at}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},GLTFDracoMeshCompressionExtension$1=class{constructor(_e,rt){if(!rt)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION,this.json=_e,this.dracoLoader=rt,this.dracoLoader.preload()}decodePrimitive(_e,rt){const it=this.json,nt=this.dracoLoader,st=_e.extensions[this.name].bufferView,at=_e.extensions[this.name].attributes,lt={},ot={},ct={};for(const ut in at){const ht=ATTRIBUTES$1[ut]||ut.toLowerCase();lt[ht]=at[ut]}for(const ut in _e.attributes){const ht=ATTRIBUTES$1[ut]||ut.toLowerCase();if(at[ut]!==void 0){const dt=it.accessors[_e.attributes[ut]],pt=WEBGL_COMPONENT_TYPES$1[dt.componentType];ct[ht]=pt.name,ot[ht]=dt.normalized===!0}}return rt.getDependency("bufferView",st).then(function(ut){return new Promise(function(ht){nt.decodeDracoFile(ut,function(dt){for(const pt in dt.attributes){const ft=dt.attributes[pt],gt=ot[pt];gt!==void 0&&(ft.normalized=gt)}ht(dt)},lt,ct)})})}},GLTFTextureTransformExtension$1=class{constructor(){this.name=EXTENSIONS$1.KHR_TEXTURE_TRANSFORM}extendTexture(_e,rt){return(rt.texCoord===void 0||rt.texCoord===_e.channel)&&rt.offset===void 0&&rt.rotation===void 0&&rt.scale===void 0||(_e=_e.clone(),rt.texCoord!==void 0&&(_e.channel=rt.texCoord),rt.offset!==void 0&&_e.offset.fromArray(rt.offset),rt.rotation!==void 0&&(_e.rotation=rt.rotation),rt.scale!==void 0&&_e.repeat.fromArray(rt.scale),_e.needsUpdate=!0),_e}},GLTFMeshQuantizationExtension$1=class{constructor(){this.name=EXTENSIONS$1.KHR_MESH_QUANTIZATION}},GLTFCubicSplineInterpolant$1=class extends Interpolant{constructor(_e,rt,it,nt){super(_e,rt,it,nt)}copySampleValue_(_e){const rt=this.resultBuffer,it=this.sampleValues,nt=this.valueSize,st=_e*nt*3+nt;for(let at=0;at!==nt;at++)rt[at]=it[st+at];return rt}interpolate_(_e,rt,it,nt){const st=this.resultBuffer,at=this.sampleValues,lt=this.valueSize,ot=lt*2,ct=lt*3,ut=nt-rt,ht=(it-rt)/ut,dt=ht*ht,pt=dt*ht,ft=_e*ct,gt=ft-ct,mt=-2*pt+3*dt,At=pt-dt,yt=1-mt,bt=At-dt+ht;for(let xt=0;xt!==lt;xt++){const vt=at[gt+xt+lt],_t=at[gt+xt+ot]*ut,Ct=at[ft+xt+lt],St=at[ft+xt]*ut;st[xt]=yt*vt+bt*_t+mt*Ct+At*St}return st}};const _q$1=new Quaternion;let GLTFCubicSplineQuaternionInterpolant$1=class extends GLTFCubicSplineInterpolant$1{interpolate_(_e,rt,it,nt){const st=super.interpolate_(_e,rt,it,nt);return _q$1.fromArray(st).normalize().toArray(st),st}};const WEBGL_CONSTANTS$1={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES$1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS$1={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS$1={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES$1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES$1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...REVISION.replace(/\D+/g,"")>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES$1={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION$1={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES$1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial$1(tt){return tt.DefaultMaterial===void 0&&(tt.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),tt.DefaultMaterial}function addUnknownExtensionsToUserData$1(tt,_e,rt){for(const it in rt.extensions)tt[it]===void 0&&(_e.userData.gltfExtensions=_e.userData.gltfExtensions||{},_e.userData.gltfExtensions[it]=rt.extensions[it])}function assignExtrasToUserData$1(tt,_e){_e.extras!==void 0&&(typeof _e.extras=="object"?Object.assign(tt.userData,_e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_e.extras))}function addMorphTargets$1(tt,_e,rt){let it=!1,nt=!1,st=!1;for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(ht.POSITION!==void 0&&(it=!0),ht.NORMAL!==void 0&&(nt=!0),ht.COLOR_0!==void 0&&(st=!0),it&&nt&&st)break}if(!it&&!nt&&!st)return Promise.resolve(tt);const at=[],lt=[],ot=[];for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(it){const dt=ht.POSITION!==void 0?rt.getDependency("accessor",ht.POSITION):tt.attributes.position;at.push(dt)}if(nt){const dt=ht.NORMAL!==void 0?rt.getDependency("accessor",ht.NORMAL):tt.attributes.normal;lt.push(dt)}if(st){const dt=ht.COLOR_0!==void 0?rt.getDependency("accessor",ht.COLOR_0):tt.attributes.color;ot.push(dt)}}return Promise.all([Promise.all(at),Promise.all(lt),Promise.all(ot)]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];return it&&(tt.morphAttributes.position=ut),nt&&(tt.morphAttributes.normal=ht),st&&(tt.morphAttributes.color=dt),tt.morphTargetsRelative=!0,tt})}function updateMorphTargets$1(tt,_e){if(tt.updateMorphTargets(),_e.weights!==void 0)for(let rt=0,it=_e.weights.length;rt<it;rt++)tt.morphTargetInfluences[rt]=_e.weights[rt];if(_e.extras&&Array.isArray(_e.extras.targetNames)){const rt=_e.extras.targetNames;if(tt.morphTargetInfluences.length===rt.length){tt.morphTargetDictionary={};for(let it=0,nt=rt.length;it<nt;it++)tt.morphTargetDictionary[rt[it]]=it}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey$1(tt){let _e;const rt=tt.extensions&&tt.extensions[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION];if(rt?_e="draco:"+rt.bufferView+":"+rt.indices+":"+createAttributesKey$1(rt.attributes):_e=tt.indices+":"+createAttributesKey$1(tt.attributes)+":"+tt.mode,tt.targets!==void 0)for(let it=0,nt=tt.targets.length;it<nt;it++)_e+=":"+createAttributesKey$1(tt.targets[it]);return _e}function createAttributesKey$1(tt){let _e="";const rt=Object.keys(tt).sort();for(let it=0,nt=rt.length;it<nt;it++)_e+=rt[it]+":"+tt[rt[it]]+";";return _e}function getNormalizedComponentScale$1(tt){switch(tt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType$1(tt){return tt.search(/\.jpe?g($|\?)/i)>0||tt.search(/^data\:image\/jpeg/)===0?"image/jpeg":tt.search(/\.webp($|\?)/i)>0||tt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix$1=new Matrix4;let GLTFParser$1=class{constructor(_e={},rt={}){this.json=_e,this.extensions={},this.plugins={},this.options=rt,this.cache=new GLTFRegistry$1,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let it=!1,nt=!1,st=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(it=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,nt=navigator.userAgent.indexOf("Firefox")>-1,st=nt?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||it||nt&&st<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_e){this.extensions=_e}setPlugins(_e){this.plugins=_e}parse(_e,rt){const it=this,nt=this.json,st=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(at){return at._markDefs&&at._markDefs()}),Promise.all(this._invokeAll(function(at){return at.beforeRoot&&at.beforeRoot()})).then(function(){return Promise.all([it.getDependencies("scene"),it.getDependencies("animation"),it.getDependencies("camera")])}).then(function(at){const lt={scene:at[0][nt.scene||0],scenes:at[0],animations:at[1],cameras:at[2],asset:nt.asset,parser:it,userData:{}};addUnknownExtensionsToUserData$1(st,lt,nt),assignExtrasToUserData$1(lt,nt),Promise.all(it._invokeAll(function(ot){return ot.afterRoot&&ot.afterRoot(lt)})).then(function(){_e(lt)})}).catch(rt)}_markDefs(){const _e=this.json.nodes||[],rt=this.json.skins||[],it=this.json.meshes||[];for(let nt=0,st=rt.length;nt<st;nt++){const at=rt[nt].joints;for(let lt=0,ot=at.length;lt<ot;lt++)_e[at[lt]].isBone=!0}for(let nt=0,st=_e.length;nt<st;nt++){const at=_e[nt];at.mesh!==void 0&&(this._addNodeRef(this.meshCache,at.mesh),at.skin!==void 0&&(it[at.mesh].isSkinnedMesh=!0)),at.camera!==void 0&&this._addNodeRef(this.cameraCache,at.camera)}}_addNodeRef(_e,rt){rt!==void 0&&(_e.refs[rt]===void 0&&(_e.refs[rt]=_e.uses[rt]=0),_e.refs[rt]++)}_getNodeRef(_e,rt,it){if(_e.refs[rt]<=1)return it;const nt=it.clone(),st=(at,lt)=>{const ot=this.associations.get(at);ot!=null&&this.associations.set(lt,ot);for(const[ct,ut]of at.children.entries())st(ut,lt.children[ct])};return st(it,nt),nt.name+="_instance_"+_e.uses[rt]++,nt}_invokeOne(_e){const rt=Object.values(this.plugins);rt.push(this);for(let it=0;it<rt.length;it++){const nt=_e(rt[it]);if(nt)return nt}return null}_invokeAll(_e){const rt=Object.values(this.plugins);rt.unshift(this);const it=[];for(let nt=0;nt<rt.length;nt++){const st=_e(rt[nt]);st&&it.push(st)}return it}getDependency(_e,rt){const it=_e+":"+rt;let nt=this.cache.get(it);if(!nt){switch(_e){case"scene":nt=this.loadScene(rt);break;case"node":nt=this._invokeOne(function(st){return st.loadNode&&st.loadNode(rt)});break;case"mesh":nt=this._invokeOne(function(st){return st.loadMesh&&st.loadMesh(rt)});break;case"accessor":nt=this.loadAccessor(rt);break;case"bufferView":nt=this._invokeOne(function(st){return st.loadBufferView&&st.loadBufferView(rt)});break;case"buffer":nt=this.loadBuffer(rt);break;case"material":nt=this._invokeOne(function(st){return st.loadMaterial&&st.loadMaterial(rt)});break;case"texture":nt=this._invokeOne(function(st){return st.loadTexture&&st.loadTexture(rt)});break;case"skin":nt=this.loadSkin(rt);break;case"animation":nt=this._invokeOne(function(st){return st.loadAnimation&&st.loadAnimation(rt)});break;case"camera":nt=this.loadCamera(rt);break;default:if(nt=this._invokeOne(function(st){return st!=this&&st.getDependency&&st.getDependency(_e,rt)}),!nt)throw new Error("Unknown type: "+_e);break}this.cache.add(it,nt)}return nt}getDependencies(_e){let rt=this.cache.get(_e);if(!rt){const it=this,nt=this.json[_e+(_e==="mesh"?"es":"s")]||[];rt=Promise.all(nt.map(function(st,at){return it.getDependency(_e,at)})),this.cache.add(_e,rt)}return rt}loadBuffer(_e){const rt=this.json.buffers[_e],it=this.fileLoader;if(rt.type&&rt.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+rt.type+" buffer type is not supported.");if(rt.uri===void 0&&_e===0)return Promise.resolve(this.extensions[EXTENSIONS$1.KHR_BINARY_GLTF].body);const nt=this.options;return new Promise(function(st,at){it.load(LoaderUtils.resolveURL(rt.uri,nt.path),st,void 0,function(){at(new Error('THREE.GLTFLoader: Failed to load buffer "'+rt.uri+'".'))})})}loadBufferView(_e){const rt=this.json.bufferViews[_e];return this.getDependency("buffer",rt.buffer).then(function(it){const nt=rt.byteLength||0,st=rt.byteOffset||0;return it.slice(st,st+nt)})}loadAccessor(_e){const rt=this,it=this.json,nt=this.json.accessors[_e];if(nt.bufferView===void 0&&nt.sparse===void 0){const at=WEBGL_TYPE_SIZES$1[nt.type],lt=WEBGL_COMPONENT_TYPES$1[nt.componentType],ot=nt.normalized===!0,ct=new lt(nt.count*at);return Promise.resolve(new BufferAttribute(ct,at,ot))}const st=[];return nt.bufferView!==void 0?st.push(this.getDependency("bufferView",nt.bufferView)):st.push(null),nt.sparse!==void 0&&(st.push(this.getDependency("bufferView",nt.sparse.indices.bufferView)),st.push(this.getDependency("bufferView",nt.sparse.values.bufferView))),Promise.all(st).then(function(at){const lt=at[0],ot=WEBGL_TYPE_SIZES$1[nt.type],ct=WEBGL_COMPONENT_TYPES$1[nt.componentType],ut=ct.BYTES_PER_ELEMENT,ht=ut*ot,dt=nt.byteOffset||0,pt=nt.bufferView!==void 0?it.bufferViews[nt.bufferView].byteStride:void 0,ft=nt.normalized===!0;let gt,mt;if(pt&&pt!==ht){const At=Math.floor(dt/pt),yt="InterleavedBuffer:"+nt.bufferView+":"+nt.componentType+":"+At+":"+nt.count;let bt=rt.cache.get(yt);bt||(gt=new ct(lt,At*pt,nt.count*pt/ut),bt=new InterleavedBuffer(gt,pt/ut),rt.cache.add(yt,bt)),mt=new InterleavedBufferAttribute(bt,ot,dt%pt/ut,ft)}else lt===null?gt=new ct(nt.count*ot):gt=new ct(lt,dt,nt.count*ot),mt=new BufferAttribute(gt,ot,ft);if(nt.sparse!==void 0){const At=WEBGL_TYPE_SIZES$1.SCALAR,yt=WEBGL_COMPONENT_TYPES$1[nt.sparse.indices.componentType],bt=nt.sparse.indices.byteOffset||0,xt=nt.sparse.values.byteOffset||0,vt=new yt(at[1],bt,nt.sparse.count*At),_t=new ct(at[2],xt,nt.sparse.count*ot);lt!==null&&(mt=new BufferAttribute(mt.array.slice(),mt.itemSize,mt.normalized));for(let Ct=0,St=vt.length;Ct<St;Ct++){const Et=vt[Ct];if(mt.setX(Et,_t[Ct*ot]),ot>=2&&mt.setY(Et,_t[Ct*ot+1]),ot>=3&&mt.setZ(Et,_t[Ct*ot+2]),ot>=4&&mt.setW(Et,_t[Ct*ot+3]),ot>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return mt})}loadTexture(_e){const rt=this.json,it=this.options,st=rt.textures[_e].source,at=rt.images[st];let lt=this.textureLoader;if(at.uri){const ot=it.manager.getHandler(at.uri);ot!==null&&(lt=ot)}return this.loadTextureImage(_e,st,lt)}loadTextureImage(_e,rt,it){const nt=this,st=this.json,at=st.textures[_e],lt=st.images[rt],ot=(lt.uri||lt.bufferView)+":"+at.sampler;if(this.textureCache[ot])return this.textureCache[ot];const ct=this.loadImageSource(rt,it).then(function(ut){ut.flipY=!1,ut.name=at.name||lt.name||"",ut.name===""&&typeof lt.uri=="string"&&lt.uri.startsWith("data:image/")===!1&&(ut.name=lt.uri);const dt=(st.samplers||{})[at.sampler]||{};return ut.magFilter=WEBGL_FILTERS$1[dt.magFilter]||LinearFilter,ut.minFilter=WEBGL_FILTERS$1[dt.minFilter]||LinearMipmapLinearFilter,ut.wrapS=WEBGL_WRAPPINGS$1[dt.wrapS]||RepeatWrapping,ut.wrapT=WEBGL_WRAPPINGS$1[dt.wrapT]||RepeatWrapping,nt.associations.set(ut,{textures:_e}),ut}).catch(function(){return null});return this.textureCache[ot]=ct,ct}loadImageSource(_e,rt){const it=this,nt=this.json,st=this.options;if(this.sourceCache[_e]!==void 0)return this.sourceCache[_e].then(ht=>ht.clone());const at=nt.images[_e],lt=self.URL||self.webkitURL;let ot=at.uri||"",ct=!1;if(at.bufferView!==void 0)ot=it.getDependency("bufferView",at.bufferView).then(function(ht){ct=!0;const dt=new Blob([ht],{type:at.mimeType});return ot=lt.createObjectURL(dt),ot});else if(at.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_e+" is missing URI and bufferView");const ut=Promise.resolve(ot).then(function(ht){return new Promise(function(dt,pt){let ft=dt;rt.isImageBitmapLoader===!0&&(ft=function(gt){const mt=new Texture(gt);mt.needsUpdate=!0,dt(mt)}),rt.load(LoaderUtils.resolveURL(ht,st.path),ft,void 0,pt)})}).then(function(ht){return ct===!0&&lt.revokeObjectURL(ot),ht.userData.mimeType=at.mimeType||getImageURIMimeType$1(at.uri),ht}).catch(function(ht){throw console.error("THREE.GLTFLoader: Couldn't load texture",ot),ht});return this.sourceCache[_e]=ut,ut}assignTexture(_e,rt,it,nt){const st=this;return this.getDependency("texture",it.index).then(function(at){if(!at)return null;if(it.texCoord!==void 0&&it.texCoord>0&&(at=at.clone(),at.channel=it.texCoord),st.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM]){const lt=it.extensions!==void 0?it.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM]:void 0;if(lt){const ot=st.associations.get(at);at=st.extensions[EXTENSIONS$1.KHR_TEXTURE_TRANSFORM].extendTexture(at,lt),st.associations.set(at,ot)}}return nt!==void 0&&("colorSpace"in at?at.colorSpace=nt===3001?"srgb":"srgb-linear":at.encoding=nt),_e[rt]=at,at})}assignFinalMaterial(_e){const rt=_e.geometry;let it=_e.material;const nt=rt.attributes.tangent===void 0,st=rt.attributes.color!==void 0,at=rt.attributes.normal===void 0;if(_e.isPoints){const lt="PointsMaterial:"+it.uuid;let ot=this.cache.get(lt);ot||(ot=new PointsMaterial,Material.prototype.copy.call(ot,it),ot.color.copy(it.color),ot.map=it.map,ot.sizeAttenuation=!1,this.cache.add(lt,ot)),it=ot}else if(_e.isLine){const lt="LineBasicMaterial:"+it.uuid;let ot=this.cache.get(lt);ot||(ot=new LineBasicMaterial,Material.prototype.copy.call(ot,it),ot.color.copy(it.color),ot.map=it.map,this.cache.add(lt,ot)),it=ot}if(nt||st||at){let lt="ClonedMaterial:"+it.uuid+":";nt&&(lt+="derivative-tangents:"),st&&(lt+="vertex-colors:"),at&&(lt+="flat-shading:");let ot=this.cache.get(lt);ot||(ot=it.clone(),st&&(ot.vertexColors=!0),at&&(ot.flatShading=!0),nt&&(ot.normalScale&&(ot.normalScale.y*=-1),ot.clearcoatNormalScale&&(ot.clearcoatNormalScale.y*=-1)),this.cache.add(lt,ot),this.associations.set(ot,this.associations.get(it))),it=ot}_e.material=it}getMaterialType(){return MeshStandardMaterial}loadMaterial(_e){const rt=this,it=this.json,nt=this.extensions,st=it.materials[_e];let at;const lt={},ot=st.extensions||{},ct=[];if(ot[EXTENSIONS$1.KHR_MATERIALS_UNLIT]){const ht=nt[EXTENSIONS$1.KHR_MATERIALS_UNLIT];at=ht.getMaterialType(),ct.push(ht.extendParams(lt,st,rt))}else{const ht=st.pbrMetallicRoughness||{};if(lt.color=new Color$1(1,1,1),lt.opacity=1,Array.isArray(ht.baseColorFactor)){const dt=ht.baseColorFactor;lt.color.fromArray(dt),lt.opacity=dt[3]}ht.baseColorTexture!==void 0&&ct.push(rt.assignTexture(lt,"map",ht.baseColorTexture,3001)),lt.metalness=ht.metallicFactor!==void 0?ht.metallicFactor:1,lt.roughness=ht.roughnessFactor!==void 0?ht.roughnessFactor:1,ht.metallicRoughnessTexture!==void 0&&(ct.push(rt.assignTexture(lt,"metalnessMap",ht.metallicRoughnessTexture)),ct.push(rt.assignTexture(lt,"roughnessMap",ht.metallicRoughnessTexture))),at=this._invokeOne(function(dt){return dt.getMaterialType&&dt.getMaterialType(_e)}),ct.push(Promise.all(this._invokeAll(function(dt){return dt.extendMaterialParams&&dt.extendMaterialParams(_e,lt)})))}st.doubleSided===!0&&(lt.side=DoubleSide);const ut=st.alphaMode||ALPHA_MODES$1.OPAQUE;if(ut===ALPHA_MODES$1.BLEND?(lt.transparent=!0,lt.depthWrite=!1):(lt.transparent=!1,ut===ALPHA_MODES$1.MASK&&(lt.alphaTest=st.alphaCutoff!==void 0?st.alphaCutoff:.5)),st.normalTexture!==void 0&&at!==MeshBasicMaterial&&(ct.push(rt.assignTexture(lt,"normalMap",st.normalTexture)),lt.normalScale=new Vector2(1,1),st.normalTexture.scale!==void 0)){const ht=st.normalTexture.scale;lt.normalScale.set(ht,ht)}return st.occlusionTexture!==void 0&&at!==MeshBasicMaterial&&(ct.push(rt.assignTexture(lt,"aoMap",st.occlusionTexture)),st.occlusionTexture.strength!==void 0&&(lt.aoMapIntensity=st.occlusionTexture.strength)),st.emissiveFactor!==void 0&&at!==MeshBasicMaterial&&(lt.emissive=new Color$1().fromArray(st.emissiveFactor)),st.emissiveTexture!==void 0&&at!==MeshBasicMaterial&&ct.push(rt.assignTexture(lt,"emissiveMap",st.emissiveTexture,3001)),Promise.all(ct).then(function(){const ht=new at(lt);return st.name&&(ht.name=st.name),assignExtrasToUserData$1(ht,st),rt.associations.set(ht,{materials:_e}),st.extensions&&addUnknownExtensionsToUserData$1(nt,ht,st),ht})}createUniqueName(_e){const rt=PropertyBinding.sanitizeNodeName(_e||"");return rt in this.nodeNamesUsed?rt+"_"+ ++this.nodeNamesUsed[rt]:(this.nodeNamesUsed[rt]=0,rt)}loadGeometries(_e){const rt=this,it=this.extensions,nt=this.primitiveCache;function st(lt){return it[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(lt,rt).then(function(ot){return addPrimitiveAttributes$1(ot,lt,rt)})}const at=[];for(let lt=0,ot=_e.length;lt<ot;lt++){const ct=_e[lt],ut=createPrimitiveKey$1(ct),ht=nt[ut];if(ht)at.push(ht.promise);else{let dt;ct.extensions&&ct.extensions[EXTENSIONS$1.KHR_DRACO_MESH_COMPRESSION]?dt=st(ct):dt=addPrimitiveAttributes$1(new BufferGeometry,ct,rt),nt[ut]={primitive:ct,promise:dt},at.push(dt)}}return Promise.all(at)}loadMesh(_e){const rt=this,it=this.json,nt=this.extensions,st=it.meshes[_e],at=st.primitives,lt=[];for(let ot=0,ct=at.length;ot<ct;ot++){const ut=at[ot].material===void 0?createDefaultMaterial$1(this.cache):this.getDependency("material",at[ot].material);lt.push(ut)}return lt.push(rt.loadGeometries(at)),Promise.all(lt).then(function(ot){const ct=ot.slice(0,ot.length-1),ut=ot[ot.length-1],ht=[];for(let pt=0,ft=ut.length;pt<ft;pt++){const gt=ut[pt],mt=at[pt];let At;const yt=ct[pt];if(mt.mode===WEBGL_CONSTANTS$1.TRIANGLES||mt.mode===WEBGL_CONSTANTS$1.TRIANGLE_STRIP||mt.mode===WEBGL_CONSTANTS$1.TRIANGLE_FAN||mt.mode===void 0)At=st.isSkinnedMesh===!0?new SkinnedMesh(gt,yt):new Mesh(gt,yt),At.isSkinnedMesh===!0&&At.normalizeSkinWeights(),mt.mode===WEBGL_CONSTANTS$1.TRIANGLE_STRIP?At.geometry=toTrianglesDrawMode$1(At.geometry,TriangleStripDrawMode):mt.mode===WEBGL_CONSTANTS$1.TRIANGLE_FAN&&(At.geometry=toTrianglesDrawMode$1(At.geometry,TriangleFanDrawMode));else if(mt.mode===WEBGL_CONSTANTS$1.LINES)At=new LineSegments(gt,yt);else if(mt.mode===WEBGL_CONSTANTS$1.LINE_STRIP)At=new Line(gt,yt);else if(mt.mode===WEBGL_CONSTANTS$1.LINE_LOOP)At=new LineLoop(gt,yt);else if(mt.mode===WEBGL_CONSTANTS$1.POINTS)At=new Points(gt,yt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+mt.mode);Object.keys(At.geometry.morphAttributes).length>0&&updateMorphTargets$1(At,st),At.name=rt.createUniqueName(st.name||"mesh_"+_e),assignExtrasToUserData$1(At,st),mt.extensions&&addUnknownExtensionsToUserData$1(nt,At,mt),rt.assignFinalMaterial(At),ht.push(At)}for(let pt=0,ft=ht.length;pt<ft;pt++)rt.associations.set(ht[pt],{meshes:_e,primitives:pt});if(ht.length===1)return st.extensions&&addUnknownExtensionsToUserData$1(nt,ht[0],st),ht[0];const dt=new Group;st.extensions&&addUnknownExtensionsToUserData$1(nt,dt,st),rt.associations.set(dt,{meshes:_e});for(let pt=0,ft=ht.length;pt<ft;pt++)dt.add(ht[pt]);return dt})}loadCamera(_e){let rt;const it=this.json.cameras[_e],nt=it[it.type];if(!nt){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return it.type==="perspective"?rt=new PerspectiveCamera(MathUtils.radToDeg(nt.yfov),nt.aspectRatio||1,nt.znear||1,nt.zfar||2e6):it.type==="orthographic"&&(rt=new OrthographicCamera(-nt.xmag,nt.xmag,nt.ymag,-nt.ymag,nt.znear,nt.zfar)),it.name&&(rt.name=this.createUniqueName(it.name)),assignExtrasToUserData$1(rt,it),Promise.resolve(rt)}loadSkin(_e){const rt=this.json.skins[_e],it=[];for(let nt=0,st=rt.joints.length;nt<st;nt++)it.push(this._loadNodeShallow(rt.joints[nt]));return rt.inverseBindMatrices!==void 0?it.push(this.getDependency("accessor",rt.inverseBindMatrices)):it.push(null),Promise.all(it).then(function(nt){const st=nt.pop(),at=nt,lt=[],ot=[];for(let ct=0,ut=at.length;ct<ut;ct++){const ht=at[ct];if(ht){lt.push(ht);const dt=new Matrix4;st!==null&&dt.fromArray(st.array,ct*16),ot.push(dt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',rt.joints[ct])}return new Skeleton(lt,ot)})}loadAnimation(_e){const it=this.json.animations[_e],nt=it.name?it.name:"animation_"+_e,st=[],at=[],lt=[],ot=[],ct=[];for(let ut=0,ht=it.channels.length;ut<ht;ut++){const dt=it.channels[ut],pt=it.samplers[dt.sampler],ft=dt.target,gt=ft.node,mt=it.parameters!==void 0?it.parameters[pt.input]:pt.input,At=it.parameters!==void 0?it.parameters[pt.output]:pt.output;ft.node!==void 0&&(st.push(this.getDependency("node",gt)),at.push(this.getDependency("accessor",mt)),lt.push(this.getDependency("accessor",At)),ot.push(pt),ct.push(ft))}return Promise.all([Promise.all(st),Promise.all(at),Promise.all(lt),Promise.all(ot),Promise.all(ct)]).then(function(ut){const ht=ut[0],dt=ut[1],pt=ut[2],ft=ut[3],gt=ut[4],mt=[];for(let At=0,yt=ht.length;At<yt;At++){const bt=ht[At],xt=dt[At],vt=pt[At],_t=ft[At],Ct=gt[At];if(bt===void 0)continue;bt.updateMatrix();let St;switch(PATH_PROPERTIES$1[Ct.path]){case PATH_PROPERTIES$1.weights:St=NumberKeyframeTrack;break;case PATH_PROPERTIES$1.rotation:St=QuaternionKeyframeTrack;break;case PATH_PROPERTIES$1.position:case PATH_PROPERTIES$1.scale:default:St=VectorKeyframeTrack;break}const Et=bt.name?bt.name:bt.uuid,Tt=_t.interpolation!==void 0?INTERPOLATION$1[_t.interpolation]:InterpolateLinear,Mt=[];PATH_PROPERTIES$1[Ct.path]===PATH_PROPERTIES$1.weights?bt.traverse(function(It){It.morphTargetInfluences&&Mt.push(It.name?It.name:It.uuid)}):Mt.push(Et);let Rt=vt.array;if(vt.normalized){const It=getNormalizedComponentScale$1(Rt.constructor),Ot=new Float32Array(Rt.length);for(let Bt=0,Nt=Rt.length;Bt<Nt;Bt++)Ot[Bt]=Rt[Bt]*It;Rt=Ot}for(let It=0,Ot=Mt.length;It<Ot;It++){const Bt=new St(Mt[It]+"."+PATH_PROPERTIES$1[Ct.path],xt.array,Rt,Tt);_t.interpolation==="CUBICSPLINE"&&(Bt.createInterpolant=function(zt){const Dt=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant$1:GLTFCubicSplineInterpolant$1;return new Dt(this.times,this.values,this.getValueSize()/3,zt)},Bt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),mt.push(Bt)}}return new AnimationClip(nt,void 0,mt)})}createNodeMesh(_e){const rt=this.json,it=this,nt=rt.nodes[_e];return nt.mesh===void 0?null:it.getDependency("mesh",nt.mesh).then(function(st){const at=it._getNodeRef(it.meshCache,nt.mesh,st);return nt.weights!==void 0&&at.traverse(function(lt){if(lt.isMesh)for(let ot=0,ct=nt.weights.length;ot<ct;ot++)lt.morphTargetInfluences[ot]=nt.weights[ot]}),at})}loadNode(_e){const rt=this.json,it=this,nt=rt.nodes[_e],st=it._loadNodeShallow(_e),at=[],lt=nt.children||[];for(let ct=0,ut=lt.length;ct<ut;ct++)at.push(it.getDependency("node",lt[ct]));const ot=nt.skin===void 0?Promise.resolve(null):it.getDependency("skin",nt.skin);return Promise.all([st,Promise.all(at),ot]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];dt!==null&&ut.traverse(function(pt){pt.isSkinnedMesh&&pt.bind(dt,_identityMatrix$1)});for(let pt=0,ft=ht.length;pt<ft;pt++)ut.add(ht[pt]);return ut})}_loadNodeShallow(_e){const rt=this.json,it=this.extensions,nt=this;if(this.nodeCache[_e]!==void 0)return this.nodeCache[_e];const st=rt.nodes[_e],at=st.name?nt.createUniqueName(st.name):"",lt=[],ot=nt._invokeOne(function(ct){return ct.createNodeMesh&&ct.createNodeMesh(_e)});return ot&&lt.push(ot),st.camera!==void 0&&lt.push(nt.getDependency("camera",st.camera).then(function(ct){return nt._getNodeRef(nt.cameraCache,st.camera,ct)})),nt._invokeAll(function(ct){return ct.createNodeAttachment&&ct.createNodeAttachment(_e)}).forEach(function(ct){lt.push(ct)}),this.nodeCache[_e]=Promise.all(lt).then(function(ct){let ut;if(st.isBone===!0?ut=new Bone:ct.length>1?ut=new Group:ct.length===1?ut=ct[0]:ut=new Object3D,ut!==ct[0])for(let ht=0,dt=ct.length;ht<dt;ht++)ut.add(ct[ht]);if(st.name&&(ut.userData.name=st.name,ut.name=at),assignExtrasToUserData$1(ut,st),st.extensions&&addUnknownExtensionsToUserData$1(it,ut,st),st.matrix!==void 0){const ht=new Matrix4;ht.fromArray(st.matrix),ut.applyMatrix4(ht)}else st.translation!==void 0&&ut.position.fromArray(st.translation),st.rotation!==void 0&&ut.quaternion.fromArray(st.rotation),st.scale!==void 0&&ut.scale.fromArray(st.scale);return nt.associations.has(ut)||nt.associations.set(ut,{}),nt.associations.get(ut).nodes=_e,ut}),this.nodeCache[_e]}loadScene(_e){const rt=this.extensions,it=this.json.scenes[_e],nt=this,st=new Group;it.name&&(st.name=nt.createUniqueName(it.name)),assignExtrasToUserData$1(st,it),it.extensions&&addUnknownExtensionsToUserData$1(rt,st,it);const at=it.nodes||[],lt=[];for(let ot=0,ct=at.length;ot<ct;ot++)lt.push(nt.getDependency("node",at[ot]));return Promise.all(lt).then(function(ot){for(let ut=0,ht=ot.length;ut<ht;ut++)st.add(ot[ut]);const ct=ut=>{const ht=new Map;for(const[dt,pt]of nt.associations)(dt instanceof Material||dt instanceof Texture)&&ht.set(dt,pt);return ut.traverse(dt=>{const pt=nt.associations.get(dt);pt!=null&&ht.set(dt,pt)}),ht};return nt.associations=ct(st),st})}};function computeBounds$1(tt,_e,rt){const it=_e.attributes,nt=new Box3;if(it.POSITION!==void 0){const lt=rt.json.accessors[it.POSITION],ot=lt.min,ct=lt.max;if(ot!==void 0&&ct!==void 0){if(nt.set(new Vector3(ot[0],ot[1],ot[2]),new Vector3(ct[0],ct[1],ct[2])),lt.normalized){const ut=getNormalizedComponentScale$1(WEBGL_COMPONENT_TYPES$1[lt.componentType]);nt.min.multiplyScalar(ut),nt.max.multiplyScalar(ut)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const st=_e.targets;if(st!==void 0){const lt=new Vector3,ot=new Vector3;for(let ct=0,ut=st.length;ct<ut;ct++){const ht=st[ct];if(ht.POSITION!==void 0){const dt=rt.json.accessors[ht.POSITION],pt=dt.min,ft=dt.max;if(pt!==void 0&&ft!==void 0){if(ot.setX(Math.max(Math.abs(pt[0]),Math.abs(ft[0]))),ot.setY(Math.max(Math.abs(pt[1]),Math.abs(ft[1]))),ot.setZ(Math.max(Math.abs(pt[2]),Math.abs(ft[2]))),dt.normalized){const gt=getNormalizedComponentScale$1(WEBGL_COMPONENT_TYPES$1[dt.componentType]);ot.multiplyScalar(gt)}lt.max(ot)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}nt.expandByVector(lt)}tt.boundingBox=nt;const at=new Sphere;nt.getCenter(at.center),at.radius=nt.min.distanceTo(nt.max)/2,tt.boundingSphere=at}function addPrimitiveAttributes$1(tt,_e,rt){const it=_e.attributes,nt=[];function st(at,lt){return rt.getDependency("accessor",at).then(function(ot){tt.setAttribute(lt,ot)})}for(const at in it){const lt=ATTRIBUTES$1[at]||at.toLowerCase();lt in tt.attributes||nt.push(st(it[at],lt))}if(_e.indices!==void 0&&!tt.index){const at=rt.getDependency("accessor",_e.indices).then(function(lt){tt.setIndex(lt)});nt.push(at)}return assignExtrasToUserData$1(tt,_e),computeBounds$1(tt,_e,rt),Promise.all(nt).then(function(){return _e.targets!==void 0?addMorphTargets$1(tt,_e.targets,rt):tt})}const _VRButton=class{static createButton(tt,_e={}){const rt=document.createElement("button");function it(){let lt=null;async function ot(ut){ut.addEventListener("end",ct),await tt.xr.setSession(ut),rt.textContent="EXIT VR",lt=ut}function ct(){lt.removeEventListener("end",ct),rt.textContent="ENTER VR",lt=null}rt.style.display="",rt.style.cursor="pointer",rt.style.left="calc(50% - 50px)",rt.style.width="100px",rt.textContent="ENTER VR",rt.onmouseenter=()=>{rt.style.opacity="1.0"},rt.onmouseleave=()=>{rt.style.opacity="0.5"},rt.onclick=()=>{var ut;if(lt===null){const ht=[_e.optionalFeatures,"local-floor","bounded-floor","hand-tracking"].flat().filter(Boolean);(ut=navigator.xr)==null||ut.requestSession("immersive-vr",{..._e,optionalFeatures:ht}).then(ot)}else lt.end()}}function nt(){rt.style.display="",rt.style.cursor="auto",rt.style.left="calc(50% - 75px)",rt.style.width="150px",rt.onmouseenter=null,rt.onmouseleave=null,rt.onclick=null}function st(){nt(),rt.textContent="VR NOT SUPPORTED"}function at(lt){lt.style.position="absolute",lt.style.bottom="20px",lt.style.padding="12px 6px",lt.style.border="1px solid #fff",lt.style.borderRadius="4px",lt.style.background="rgba(0,0,0,0.1)",lt.style.color="#fff",lt.style.font="normal 13px sans-serif",lt.style.textAlign="center",lt.style.opacity="0.5",lt.style.outline="none",lt.style.zIndex="999"}if("xr"in navigator)return at(rt),rt.id="VRButton",rt.style.display="none",navigator.xr.isSessionSupported("immersive-vr").then(lt=>{lt?it():st(),lt&&_VRButton.xrSessionIsGranted&&rt.click()}),rt;{const lt=document.createElement("a");return window.isSecureContext===!1?(lt.href=document.location.href.replace(/^http:/,"https:"),lt.innerHTML="WEBXR NEEDS HTTPS"):(lt.href="https://immersiveweb.dev/",lt.innerHTML="WEBXR NOT AVAILABLE"),lt.style.left="calc(50% - 90px)",lt.style.width="180px",lt.style.textDecoration="none",at(lt),lt}}static registerSessionGrantedListener(){"xr"in navigator&&navigator.xr.addEventListener("sessiongranted",()=>{_VRButton.xrSessionIsGranted=!0})}};let VRButton=_VRButton;__publicField(VRButton,"xrSessionIsGranted",!1);const MotionControllerConstants={Handedness:{NONE:"none",LEFT:"left",RIGHT:"right"},ComponentState:{DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"},ComponentProperty:{BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"},ComponentType:{TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"},ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:{TRANSFORM:"transform",VISIBILITY:"visibility"}};async function fetchJsonFile(tt){const _e=await fetch(tt);if(_e.ok)return _e.json();throw new Error(_e.statusText)}async function fetchProfilesList(tt){if(!tt)throw new Error("No basePath supplied");return await fetchJsonFile(`${tt}/profilesList.json`)}async function fetchProfile(tt,_e,rt=null,it=!0){if(!tt)throw new Error("No xrInputSource supplied");if(!_e)throw new Error("No basePath supplied");const nt=await fetchProfilesList(_e);let st;if(tt.profiles.some(ot=>{const ct=nt[ot];return ct&&(st={profileId:ot,profilePath:`${_e}/${ct.path}`,deprecated:!!ct.deprecated}),!!st}),!st){if(!rt)throw new Error("No matching profile name found");const ot=nt[rt];if(!ot)throw new Error(`No matching profile name found and default profile "${rt}" missing.`);st={profileId:rt,profilePath:`${_e}/${ot.path}`,deprecated:!!ot.deprecated}}const at=await fetchJsonFile(st.profilePath);let lt;if(it){let ot;if(tt.handedness==="any"?ot=at.layouts[Object.keys(at.layouts)[0]]:ot=at.layouts[tt.handedness],!ot)throw new Error(`No matching handedness, ${tt.handedness}, in profile ${st.profileId}`);ot.assetPath&&(lt=st.profilePath.replace("profile.json",ot.assetPath))}return{profile:at,assetPath:lt}}const defaultComponentValues={xAxis:0,yAxis:0,button:0,state:MotionControllerConstants.ComponentState.DEFAULT};function normalizeAxes(tt=0,_e=0){let rt=tt,it=_e;if(Math.sqrt(tt*tt+_e*_e)>1){const at=Math.atan2(_e,tt);rt=Math.cos(at),it=Math.sin(at)}return{normalizedXAxis:rt*.5+.5,normalizedYAxis:it*.5+.5}}class VisualResponse{constructor(_e){__publicField(this,"value"),__publicField(this,"componentProperty"),__publicField(this,"states"),__publicField(this,"valueNodeName"),__publicField(this,"valueNodeProperty"),__publicField(this,"minNodeName"),__publicField(this,"maxNodeName"),__publicField(this,"valueNode"),__publicField(this,"minNode"),__publicField(this,"maxNode"),this.componentProperty=_e.componentProperty,this.states=_e.states,this.valueNodeName=_e.valueNodeName,this.valueNodeProperty=_e.valueNodeProperty,this.valueNodeProperty===MotionControllerConstants.VisualResponseProperty.TRANSFORM&&(this.minNodeName=_e.minNodeName,this.maxNodeName=_e.maxNodeName),this.value=0,this.updateFromComponent(defaultComponentValues)}updateFromComponent({xAxis:_e,yAxis:rt,button:it,state:nt}){const{normalizedXAxis:st,normalizedYAxis:at}=normalizeAxes(_e,rt);switch(this.componentProperty){case MotionControllerConstants.ComponentProperty.X_AXIS:this.value=this.states.includes(nt)?st:.5;break;case MotionControllerConstants.ComponentProperty.Y_AXIS:this.value=this.states.includes(nt)?at:.5;break;case MotionControllerConstants.ComponentProperty.BUTTON:this.value=this.states.includes(nt)&&it?it:0;break;case MotionControllerConstants.ComponentProperty.STATE:this.valueNodeProperty===MotionControllerConstants.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(nt):this.value=this.states.includes(nt)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class Component{constructor(_e,rt){if(__publicField(this,"id"),__publicField(this,"values"),__publicField(this,"type"),__publicField(this,"gamepadIndices"),__publicField(this,"rootNodeName"),__publicField(this,"visualResponses"),__publicField(this,"touchPointNodeName"),__publicField(this,"touchPointNode"),!_e||!rt||!rt.visualResponses||!rt.gamepadIndices||Object.keys(rt.gamepadIndices).length===0)throw new Error("Invalid arguments supplied");this.id=_e,this.type=rt.type,this.rootNodeName=rt.rootNodeName,this.touchPointNodeName=rt.touchPointNodeName,this.visualResponses={},Object.keys(rt.visualResponses).forEach(it=>{const nt=new VisualResponse(rt.visualResponses[it]);this.visualResponses[it]=nt}),this.gamepadIndices=Object.assign({},rt.gamepadIndices),this.values={state:MotionControllerConstants.ComponentState.DEFAULT,button:this.gamepadIndices.button!==void 0?0:void 0,xAxis:this.gamepadIndices.xAxis!==void 0?0:void 0,yAxis:this.gamepadIndices.yAxis!==void 0?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(_e){if(this.values.state=MotionControllerConstants.ComponentState.DEFAULT,this.gamepadIndices.button!==void 0&&_e.buttons.length>this.gamepadIndices.button){const rt=_e.buttons[this.gamepadIndices.button];this.values.button=rt.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,rt.pressed||this.values.button===1?this.values.state=MotionControllerConstants.ComponentState.PRESSED:(rt.touched||this.values.button>MotionControllerConstants.ButtonTouchThreshold)&&(this.values.state=MotionControllerConstants.ComponentState.TOUCHED)}this.gamepadIndices.xAxis!==void 0&&_e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=_e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===MotionControllerConstants.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>MotionControllerConstants.AxisTouchThreshold&&(this.values.state=MotionControllerConstants.ComponentState.TOUCHED)),this.gamepadIndices.yAxis!==void 0&&_e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=_e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===MotionControllerConstants.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>MotionControllerConstants.AxisTouchThreshold&&(this.values.state=MotionControllerConstants.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(rt=>{rt.updateFromComponent(this.values)})}}class MotionController{constructor(_e,rt,it){if(__publicField(this,"xrInputSource"),__publicField(this,"assetUrl"),__publicField(this,"layoutDescription"),__publicField(this,"id"),__publicField(this,"components"),!_e)throw new Error("No xrInputSource supplied");if(!rt)throw new Error("No profile supplied");if(!rt.layouts[_e.handedness])throw new Error("No layout for "+_e.handedness+" handedness");this.xrInputSource=_e,this.assetUrl=it,this.id=rt.profileId,this.layoutDescription=rt.layouts[_e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(nt=>{const st=this.layoutDescription.components[nt];this.components[nt]=new Component(nt,st)}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const _e=[];return Object.values(this.components).forEach(rt=>{_e.push(rt.data)}),_e}updateFromGamepad(){Object.values(this.components).forEach(_e=>{_e.updateFromGamepad(this.xrInputSource.gamepad)})}}class Font{constructor(_e){__publicField(this,"data"),this.data=_e}generateShapes(_e,rt=100,it){const nt=[],st={letterSpacing:0,lineHeight:1,...it},at=createPaths(_e,rt,this.data,st);for(let lt=0,ot=at.length;lt<ot;lt++)Array.prototype.push.apply(nt,at[lt].toShapes(!1));return nt}}__publicField(Font,"isFont");__publicField(Font,"type");function createPaths(tt,_e,rt,it){const nt=Array.from(tt),st=_e/rt.resolution,at=(rt.boundingBox.yMax-rt.boundingBox.yMin+rt.underlineThickness)*st,lt=[];let ot=0,ct=0;for(let ut=0;ut<nt.length;ut++){const ht=nt[ut];if(ht===`
`)ot=0,ct-=at*it.lineHeight;else{const dt=createPath(ht,st,ot,ct,rt);dt&&(ot+=dt.offsetX+it.letterSpacing,lt.push(dt.path))}}return lt}function createPath(tt,_e,rt,it,nt){const st=nt.glyphs[tt]||nt.glyphs["?"];if(!st){console.error('THREE.Font: character "'+tt+'" does not exists in font family '+nt.familyName+".");return}const at=new ShapePath;let lt,ot,ct,ut,ht,dt,pt,ft;if(st.o){const gt=st._cachedOutline||(st._cachedOutline=st.o.split(" "));for(let mt=0,At=gt.length;mt<At;)switch(gt[mt++]){case"m":lt=parseInt(gt[mt++])*_e+rt,ot=parseInt(gt[mt++])*_e+it,at.moveTo(lt,ot);break;case"l":lt=parseInt(gt[mt++])*_e+rt,ot=parseInt(gt[mt++])*_e+it,at.lineTo(lt,ot);break;case"q":ct=parseInt(gt[mt++])*_e+rt,ut=parseInt(gt[mt++])*_e+it,ht=parseInt(gt[mt++])*_e+rt,dt=parseInt(gt[mt++])*_e+it,at.quadraticCurveTo(ht,dt,ct,ut);break;case"b":ct=parseInt(gt[mt++])*_e+rt,ut=parseInt(gt[mt++])*_e+it,ht=parseInt(gt[mt++])*_e+rt,dt=parseInt(gt[mt++])*_e+it,pt=parseInt(gt[mt++])*_e+rt,ft=parseInt(gt[mt++])*_e+it,at.bezierCurveTo(ht,dt,pt,ft,ct,ut);break}}return{offsetX:st.ha*_e,path:at}}class Data3DTexture extends Texture{constructor(_e=null,rt=1,it=1,nt=1){super(null),this.isData3DTexture=!0,this.image={data:_e,width:rt,height:it,depth:nt},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}var freeGlobal$1=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$1$1=freeGlobal$1;var freeSelf$1=typeof self=="object"&&self&&self.Object===Object&&self,root$1=freeGlobal$1$1||freeSelf$1||Function("return this")();const root$1$1=root$1;var Symbol$1$1=root$1$1.Symbol;const Symbol$2=Symbol$1$1;var objectProto$j=Object.prototype,hasOwnProperty$g=objectProto$j.hasOwnProperty,nativeObjectToString$1$1=objectProto$j.toString,symToStringTag$1$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag$1(tt){var _e=hasOwnProperty$g.call(tt,symToStringTag$1$1),rt=tt[symToStringTag$1$1];try{tt[symToStringTag$1$1]=void 0;var it=!0}catch{}var nt=nativeObjectToString$1$1.call(tt);return it&&(_e?tt[symToStringTag$1$1]=rt:delete tt[symToStringTag$1$1]),nt}var objectProto$i=Object.prototype,nativeObjectToString$2=objectProto$i.toString;function objectToString$1(tt){return nativeObjectToString$2.call(tt)}var nullTag$1="[object Null]",undefinedTag$1="[object Undefined]",symToStringTag$2=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag$1(tt){return tt==null?tt===void 0?undefinedTag$1:nullTag$1:symToStringTag$2&&symToStringTag$2 in Object(tt)?getRawTag$1(tt):objectToString$1(tt)}function isObjectLike$1(tt){return tt!=null&&typeof tt=="object"}var symbolTag$3="[object Symbol]";function isSymbol(tt){return typeof tt=="symbol"||isObjectLike$1(tt)&&baseGetTag$1(tt)==symbolTag$3}function arrayMap(tt,_e){for(var rt=-1,it=tt==null?0:tt.length,nt=Array(it);++rt<it;)nt[rt]=_e(tt[rt],rt,tt);return nt}var isArray$2=Array.isArray;const isArray$1$1=isArray$2;var INFINITY$3=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(tt){if(typeof tt=="string")return tt;if(isArray$1$1(tt))return arrayMap(tt,baseToString)+"";if(isSymbol(tt))return symbolToString?symbolToString.call(tt):"";var _e=tt+"";return _e=="0"&&1/tt==-INFINITY$3?"-0":_e}var reWhitespace=/\s/;function trimmedEndIndex(tt){for(var _e=tt.length;_e--&&reWhitespace.test(tt.charAt(_e)););return _e}var reTrimStart=/^\s+/;function baseTrim(tt){return tt&&tt.slice(0,trimmedEndIndex(tt)+1).replace(reTrimStart,"")}function isObject$a(tt){var _e=typeof tt;return tt!=null&&(_e=="object"||_e=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(tt){if(typeof tt=="number")return tt;if(isSymbol(tt))return NAN;if(isObject$a(tt)){var _e=typeof tt.valueOf=="function"?tt.valueOf():tt;tt=isObject$a(_e)?_e+"":_e}if(typeof tt!="string")return tt===0?tt:+tt;tt=baseTrim(tt);var rt=reIsBinary.test(tt);return rt||reIsOctal.test(tt)?freeParseInt(tt.slice(2),rt?2:8):reIsBadHex.test(tt)?NAN:+tt}var INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(tt){if(!tt)return tt===0?tt:0;if(tt=toNumber(tt),tt===INFINITY$2||tt===-INFINITY$2){var _e=tt<0?-1:1;return _e*MAX_INTEGER}return tt===tt?tt:0}function toInteger(tt){var _e=toFinite(tt),rt=_e%1;return _e===_e?rt?_e-rt:_e:0}function identity$2(tt){return tt}var asyncTag$1="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag$1="[object Proxy]";function isFunction$1(tt){if(!isObject$a(tt))return!1;var _e=baseGetTag$1(tt);return _e==funcTag$2||_e==genTag$1||_e==asyncTag$1||_e==proxyTag$1}var coreJsData$1=root$1$1["__core-js_shared__"];const coreJsData$1$1=coreJsData$1;var maskSrcKey$1=function(){var tt=/[^.]+$/.exec(coreJsData$1$1&&coreJsData$1$1.keys&&coreJsData$1$1.keys.IE_PROTO||"");return tt?"Symbol(src)_1."+tt:""}();function isMasked$1(tt){return!!maskSrcKey$1&&maskSrcKey$1 in tt}var funcProto$1$1=Function.prototype,funcToString$1$1=funcProto$1$1.toString;function toSource$1(tt){if(tt!=null){try{return funcToString$1$1.call(tt)}catch{}try{return tt+""}catch{}}return""}var reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor$1=/^\[object .+?Constructor\]$/,funcProto$2=Function.prototype,objectProto$h=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$f=objectProto$h.hasOwnProperty,reIsNative$1=RegExp("^"+funcToString$2.call(hasOwnProperty$f).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$1(tt){if(!isObject$a(tt)||isMasked$1(tt))return!1;var _e=isFunction$1(tt)?reIsNative$1:reIsHostCtor$1;return _e.test(toSource$1(tt))}function getValue$3(tt,_e){return tt==null?void 0:tt[_e]}function getNative$1(tt,_e){var rt=getValue$3(tt,_e);return baseIsNative$1(rt)?rt:void 0}var WeakMap$1=getNative$1(root$1$1,"WeakMap");const WeakMap$2=WeakMap$1;var objectCreate=Object.create,baseCreate=function(){function tt(){}return function(_e){if(!isObject$a(_e))return{};if(objectCreate)return objectCreate(_e);tt.prototype=_e;var rt=new tt;return tt.prototype=void 0,rt}}();const baseCreate$1=baseCreate;function apply$1(tt,_e,rt){switch(rt.length){case 0:return tt.call(_e);case 1:return tt.call(_e,rt[0]);case 2:return tt.call(_e,rt[0],rt[1]);case 3:return tt.call(_e,rt[0],rt[1],rt[2])}return tt.apply(_e,rt)}function noop$2(){}function copyArray(tt,_e){var rt=-1,it=tt.length;for(_e||(_e=Array(it));++rt<it;)_e[rt]=tt[rt];return _e}var HOT_COUNT$1=800,HOT_SPAN$1=16,nativeNow$1=Date.now;function shortOut$1(tt){var _e=0,rt=0;return function(){var it=nativeNow$1(),nt=HOT_SPAN$1-(it-rt);if(rt=it,nt>0){if(++_e>=HOT_COUNT$1)return arguments[0]}else _e=0;return tt.apply(void 0,arguments)}}function constant$1(tt){return function(){return tt}}var defineProperty$1=function(){try{var tt=getNative$1(Object,"defineProperty");return tt({},"",{}),tt}catch{}}();const defineProperty$1$1=defineProperty$1;var baseSetToString$1=defineProperty$1$1?function(tt,_e){return defineProperty$1$1(tt,"toString",{configurable:!0,enumerable:!1,value:constant$1(_e),writable:!0})}:identity$2;const baseSetToString$1$1=baseSetToString$1;var setToString$1=shortOut$1(baseSetToString$1$1);const setToString$1$1=setToString$1;function arrayEach(tt,_e){for(var rt=-1,it=tt==null?0:tt.length;++rt<it&&_e(tt[rt],rt,tt)!==!1;);return tt}function baseFindIndex(tt,_e,rt,it){for(var nt=tt.length,st=rt+(it?1:-1);it?st--:++st<nt;)if(_e(tt[st],st,tt))return st;return-1}function baseIsNaN(tt){return tt!==tt}function strictIndexOf(tt,_e,rt){for(var it=rt-1,nt=tt.length;++it<nt;)if(tt[it]===_e)return it;return-1}function baseIndexOf(tt,_e,rt){return _e===_e?strictIndexOf(tt,_e,rt):baseFindIndex(tt,baseIsNaN,rt)}function arrayIncludes(tt,_e){var rt=tt==null?0:tt.length;return!!rt&&baseIndexOf(tt,_e,0)>-1}var MAX_SAFE_INTEGER$1$1=9007199254740991,reIsUint$1=/^(?:0|[1-9]\d*)$/;function isIndex$1(tt,_e){var rt=typeof tt;return _e=_e??MAX_SAFE_INTEGER$1$1,!!_e&&(rt=="number"||rt!="symbol"&&reIsUint$1.test(tt))&&tt>-1&&tt%1==0&&tt<_e}function baseAssignValue$1(tt,_e,rt){_e=="__proto__"&&defineProperty$1$1?defineProperty$1$1(tt,_e,{configurable:!0,enumerable:!0,value:rt,writable:!0}):tt[_e]=rt}function eq$1(tt,_e){return tt===_e||tt!==tt&&_e!==_e}var objectProto$g=Object.prototype,hasOwnProperty$e=objectProto$g.hasOwnProperty;function assignValue$1(tt,_e,rt){var it=tt[_e];(!(hasOwnProperty$e.call(tt,_e)&&eq$1(it,rt))||rt===void 0&&!(_e in tt))&&baseAssignValue$1(tt,_e,rt)}function copyObject$1(tt,_e,rt,it){var nt=!rt;rt||(rt={});for(var st=-1,at=_e.length;++st<at;){var lt=_e[st],ot=it?it(rt[lt],tt[lt],lt,rt,tt):void 0;ot===void 0&&(ot=tt[lt]),nt?baseAssignValue$1(rt,lt,ot):assignValue$1(rt,lt,ot)}return rt}var nativeMax$3=Math.max;function overRest$1(tt,_e,rt){return _e=nativeMax$3(_e===void 0?tt.length-1:_e,0),function(){for(var it=arguments,nt=-1,st=nativeMax$3(it.length-_e,0),at=Array(st);++nt<st;)at[nt]=it[_e+nt];nt=-1;for(var lt=Array(_e+1);++nt<_e;)lt[nt]=it[nt];return lt[_e]=rt(at),apply$1(tt,this,lt)}}function baseRest$1(tt,_e){return setToString$1$1(overRest$1(tt,_e,identity$2),tt+"")}var MAX_SAFE_INTEGER$2=9007199254740991;function isLength$1(tt){return typeof tt=="number"&&tt>-1&&tt%1==0&&tt<=MAX_SAFE_INTEGER$2}function isArrayLike$1(tt){return tt!=null&&isLength$1(tt.length)&&!isFunction$1(tt)}function isIterateeCall$1(tt,_e,rt){if(!isObject$a(rt))return!1;var it=typeof _e;return(it=="number"?isArrayLike$1(rt)&&isIndex$1(_e,rt.length):it=="string"&&_e in rt)?eq$1(rt[_e],tt):!1}function createAssigner$1(tt){return baseRest$1(function(_e,rt){var it=-1,nt=rt.length,st=nt>1?rt[nt-1]:void 0,at=nt>2?rt[2]:void 0;for(st=tt.length>3&&typeof st=="function"?(nt--,st):void 0,at&&isIterateeCall$1(rt[0],rt[1],at)&&(st=nt<3?void 0:st,nt=1),_e=Object(_e);++it<nt;){var lt=rt[it];lt&&tt(_e,lt,it,st)}return _e})}var objectProto$f=Object.prototype;function isPrototype$1(tt){var _e=tt&&tt.constructor,rt=typeof _e=="function"&&_e.prototype||objectProto$f;return tt===rt}function baseTimes$1(tt,_e){for(var rt=-1,it=Array(tt);++rt<tt;)it[rt]=_e(rt);return it}var argsTag$3="[object Arguments]";function baseIsArguments$1(tt){return isObjectLike$1(tt)&&baseGetTag$1(tt)==argsTag$3}var objectProto$e=Object.prototype,hasOwnProperty$d=objectProto$e.hasOwnProperty,propertyIsEnumerable$1=objectProto$e.propertyIsEnumerable,isArguments$1=baseIsArguments$1(function(){return arguments}())?baseIsArguments$1:function(tt){return isObjectLike$1(tt)&&hasOwnProperty$d.call(tt,"callee")&&!propertyIsEnumerable$1.call(tt,"callee")};const isArguments$1$1=isArguments$1;function stubFalse$1(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root$1$1.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse$1;const isBuffer$1=isBuffer;var argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1$1="[object Function]",mapTag$6="[object Map]",numberTag$3="[object Number]",objectTag$3="[object Object]",regexpTag$4="[object RegExp]",setTag$6="[object Set]",stringTag$4="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags$1={};typedArrayTags$1[float32Tag$2]=typedArrayTags$1[float64Tag$2]=typedArrayTags$1[int8Tag$2]=typedArrayTags$1[int16Tag$2]=typedArrayTags$1[int32Tag$2]=typedArrayTags$1[uint8Tag$2]=typedArrayTags$1[uint8ClampedTag$2]=typedArrayTags$1[uint16Tag$2]=typedArrayTags$1[uint32Tag$2]=!0;typedArrayTags$1[argsTag$2]=typedArrayTags$1[arrayTag$2]=typedArrayTags$1[arrayBufferTag$3]=typedArrayTags$1[boolTag$3]=typedArrayTags$1[dataViewTag$4]=typedArrayTags$1[dateTag$3]=typedArrayTags$1[errorTag$2]=typedArrayTags$1[funcTag$1$1]=typedArrayTags$1[mapTag$6]=typedArrayTags$1[numberTag$3]=typedArrayTags$1[objectTag$3]=typedArrayTags$1[regexpTag$4]=typedArrayTags$1[setTag$6]=typedArrayTags$1[stringTag$4]=typedArrayTags$1[weakMapTag$2]=!1;function baseIsTypedArray$1(tt){return isObjectLike$1(tt)&&isLength$1(tt.length)&&!!typedArrayTags$1[baseGetTag$1(tt)]}function baseUnary$1(tt){return function(_e){return tt(_e)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1$1.process,nodeUtil=function(){try{var tt=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return tt||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}();const nodeUtil$1=nodeUtil;var nodeIsTypedArray$1=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray$1?baseUnary$1(nodeIsTypedArray$1):baseIsTypedArray$1;const isTypedArray$1$1=isTypedArray$1;var objectProto$d=Object.prototype,hasOwnProperty$c=objectProto$d.hasOwnProperty;function arrayLikeKeys$1(tt,_e){var rt=isArray$1$1(tt),it=!rt&&isArguments$1$1(tt),nt=!rt&&!it&&isBuffer$1(tt),st=!rt&&!it&&!nt&&isTypedArray$1$1(tt),at=rt||it||nt||st,lt=at?baseTimes$1(tt.length,String):[],ot=lt.length;for(var ct in tt)(_e||hasOwnProperty$c.call(tt,ct))&&!(at&&(ct=="length"||nt&&(ct=="offset"||ct=="parent")||st&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||isIndex$1(ct,ot)))&&lt.push(ct);return lt}function overArg$1(tt,_e){return function(rt){return tt(_e(rt))}}var nativeKeys$1=overArg$1(Object.keys,Object);const nativeKeys$1$1=nativeKeys$1;var objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function baseKeys$1(tt){if(!isPrototype$1(tt))return nativeKeys$1$1(tt);var _e=[];for(var rt in Object(tt))hasOwnProperty$b.call(tt,rt)&&rt!="constructor"&&_e.push(rt);return _e}function keys$1(tt){return isArrayLike$1(tt)?arrayLikeKeys$1(tt):baseKeys$1(tt)}var objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty,assign$5=createAssigner$1(function(tt,_e){if(isPrototype$1(_e)||isArrayLike$1(_e)){copyObject$1(_e,keys$1(_e),tt);return}for(var rt in _e)hasOwnProperty$a.call(_e,rt)&&assignValue$1(tt,rt,_e[rt])});const assign$1$1=assign$5;function nativeKeysIn(tt){var _e=[];if(tt!=null)for(var rt in Object(tt))_e.push(rt);return _e}var objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function baseKeysIn(tt){if(!isObject$a(tt))return nativeKeysIn(tt);var _e=isPrototype$1(tt),rt=[];for(var it in tt)it=="constructor"&&(_e||!hasOwnProperty$9.call(tt,it))||rt.push(it);return rt}function keysIn(tt){return isArrayLike$1(tt)?arrayLikeKeys$1(tt,!0):baseKeysIn(tt)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(tt,_e){if(isArray$1$1(tt))return!1;var rt=typeof tt;return rt=="number"||rt=="symbol"||rt=="boolean"||tt==null||isSymbol(tt)?!0:reIsPlainProp.test(tt)||!reIsDeepProp.test(tt)||_e!=null&&tt in Object(_e)}var nativeCreate=getNative$1(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(tt){var _e=this.has(tt)&&delete this.__data__[tt];return this.size-=_e?1:0,_e}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function hashGet(tt){var _e=this.__data__;if(nativeCreate$1){var rt=_e[tt];return rt===HASH_UNDEFINED$2?void 0:rt}return hasOwnProperty$8.call(_e,tt)?_e[tt]:void 0}var objectProto$8$1=Object.prototype,hasOwnProperty$7=objectProto$8$1.hasOwnProperty;function hashHas(tt){var _e=this.__data__;return nativeCreate$1?_e[tt]!==void 0:hasOwnProperty$7.call(_e,tt)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(tt,_e){var rt=this.__data__;return this.size+=this.has(tt)?0:1,rt[tt]=nativeCreate$1&&_e===void 0?HASH_UNDEFINED$1:_e,this}function Hash(tt){var _e=-1,rt=tt==null?0:tt.length;for(this.clear();++_e<rt;){var it=tt[_e];this.set(it[0],it[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(tt,_e){for(var rt=tt.length;rt--;)if(eq$1(tt[rt][0],_e))return rt;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(tt){var _e=this.__data__,rt=assocIndexOf(_e,tt);if(rt<0)return!1;var it=_e.length-1;return rt==it?_e.pop():splice.call(_e,rt,1),--this.size,!0}function listCacheGet(tt){var _e=this.__data__,rt=assocIndexOf(_e,tt);return rt<0?void 0:_e[rt][1]}function listCacheHas(tt){return assocIndexOf(this.__data__,tt)>-1}function listCacheSet(tt,_e){var rt=this.__data__,it=assocIndexOf(rt,tt);return it<0?(++this.size,rt.push([tt,_e])):rt[it][1]=_e,this}function ListCache(tt){var _e=-1,rt=tt==null?0:tt.length;for(this.clear();++_e<rt;){var it=tt[_e];this.set(it[0],it[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative$1(root$1$1,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(tt){var _e=typeof tt;return _e=="string"||_e=="number"||_e=="symbol"||_e=="boolean"?tt!=="__proto__":tt===null}function getMapData(tt,_e){var rt=tt.__data__;return isKeyable(_e)?rt[typeof _e=="string"?"string":"hash"]:rt.map}function mapCacheDelete(tt){var _e=getMapData(this,tt).delete(tt);return this.size-=_e?1:0,_e}function mapCacheGet(tt){return getMapData(this,tt).get(tt)}function mapCacheHas(tt){return getMapData(this,tt).has(tt)}function mapCacheSet(tt,_e){var rt=getMapData(this,tt),it=rt.size;return rt.set(tt,_e),this.size+=rt.size==it?0:1,this}function MapCache(tt){var _e=-1,rt=tt==null?0:tt.length;for(this.clear();++_e<rt;){var it=tt[_e];this.set(it[0],it[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$1="Expected a function";function memoize(tt,_e){if(typeof tt!="function"||_e!=null&&typeof _e!="function")throw new TypeError(FUNC_ERROR_TEXT$1);var rt=function(){var it=arguments,nt=_e?_e.apply(this,it):it[0],st=rt.cache;if(st.has(nt))return st.get(nt);var at=tt.apply(this,it);return rt.cache=st.set(nt,at)||st,at};return rt.cache=new(memoize.Cache||MapCache),rt}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(tt){var _e=memoize(tt,function(it){return rt.size===MAX_MEMOIZE_SIZE&&rt.clear(),it}),rt=_e.cache;return _e}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(tt){var _e=[];return tt.charCodeAt(0)===46&&_e.push(""),tt.replace(rePropName,function(rt,it,nt,st){_e.push(nt?st.replace(reEscapeChar,"$1"):it||rt)}),_e});const stringToPath$1=stringToPath;function toString$1(tt){return tt==null?"":baseToString(tt)}function castPath(tt,_e){return isArray$1$1(tt)?tt:isKey(tt,_e)?[tt]:stringToPath$1(toString$1(tt))}var INFINITY$1=1/0;function toKey(tt){if(typeof tt=="string"||isSymbol(tt))return tt;var _e=tt+"";return _e=="0"&&1/tt==-INFINITY$1?"-0":_e}function baseGet(tt,_e){_e=castPath(_e,tt);for(var rt=0,it=_e.length;tt!=null&&rt<it;)tt=tt[toKey(_e[rt++])];return rt&&rt==it?tt:void 0}function get$1(tt,_e,rt){var it=tt==null?void 0:baseGet(tt,_e);return it===void 0?rt:it}function arrayPush(tt,_e){for(var rt=-1,it=_e.length,nt=tt.length;++rt<it;)tt[nt+rt]=_e[rt];return tt}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(tt){return isArray$1$1(tt)||isArguments$1$1(tt)||!!(spreadableSymbol&&tt&&tt[spreadableSymbol])}function baseFlatten(tt,_e,rt,it,nt){var st=-1,at=tt.length;for(rt||(rt=isFlattenable),nt||(nt=[]);++st<at;){var lt=tt[st];_e>0&&rt(lt)?_e>1?baseFlatten(lt,_e-1,rt,it,nt):arrayPush(nt,lt):it||(nt[nt.length]=lt)}return nt}function flatten$1(tt){var _e=tt==null?0:tt.length;return _e?baseFlatten(tt,1):[]}var getPrototype=overArg$1(Object.getPrototypeOf,Object);const getPrototype$1=getPrototype;function baseSlice(tt,_e,rt){var it=-1,nt=tt.length;_e<0&&(_e=-_e>nt?0:nt+_e),rt=rt>nt?nt:rt,rt<0&&(rt+=nt),nt=_e>rt?0:rt-_e>>>0,_e>>>=0;for(var st=Array(nt);++it<nt;)st[it]=tt[it+_e];return st}function arrayReduce(tt,_e,rt,it){var nt=-1,st=tt==null?0:tt.length;for(it&&st&&(rt=tt[++nt]);++nt<st;)rt=_e(rt,tt[nt],nt,tt);return rt}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(tt){var _e=this.__data__,rt=_e.delete(tt);return this.size=_e.size,rt}function stackGet(tt){return this.__data__.get(tt)}function stackHas(tt){return this.__data__.has(tt)}var LARGE_ARRAY_SIZE$2=200;function stackSet(tt,_e){var rt=this.__data__;if(rt instanceof ListCache){var it=rt.__data__;if(!Map$2||it.length<LARGE_ARRAY_SIZE$2-1)return it.push([tt,_e]),this.size=++rt.size,this;rt=this.__data__=new MapCache(it)}return rt.set(tt,_e),this.size=rt.size,this}function Stack(tt){var _e=this.__data__=new ListCache(tt);this.size=_e.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(tt,_e){return tt&&copyObject$1(_e,keys$1(_e),tt)}function baseAssignIn(tt,_e){return tt&&copyObject$1(_e,keysIn(_e),tt)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer2=moduleExports?root$1$1.Buffer:void 0,allocUnsafe=Buffer2?Buffer2.allocUnsafe:void 0;function cloneBuffer(tt,_e){if(_e)return tt.slice();var rt=tt.length,it=allocUnsafe?allocUnsafe(rt):new tt.constructor(rt);return tt.copy(it),it}function arrayFilter(tt,_e){for(var rt=-1,it=tt==null?0:tt.length,nt=0,st=[];++rt<it;){var at=tt[rt];_e(at,rt,tt)&&(st[nt++]=at)}return st}function stubArray(){return[]}var objectProto$7$1=Object.prototype,propertyIsEnumerable$2=objectProto$7$1.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(tt){return tt==null?[]:(tt=Object(tt),arrayFilter(nativeGetSymbols$1(tt),function(_e){return propertyIsEnumerable$2.call(tt,_e)}))}:stubArray;const getSymbols$1=getSymbols;function copySymbols(tt,_e){return copyObject$1(tt,getSymbols$1(tt),_e)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(tt){for(var _e=[];tt;)arrayPush(_e,getSymbols$1(tt)),tt=getPrototype$1(tt);return _e}:stubArray;const getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(tt,_e){return copyObject$1(tt,getSymbolsIn$1(tt),_e)}function baseGetAllKeys(tt,_e,rt){var it=_e(tt);return isArray$1$1(tt)?it:arrayPush(it,rt(tt))}function getAllKeys(tt){return baseGetAllKeys(tt,keys$1,getSymbols$1)}function getAllKeysIn(tt){return baseGetAllKeys(tt,keysIn,getSymbolsIn$1)}var DataView$1=getNative$1(root$1$1,"DataView");const DataView$2=DataView$1;var Promise$1=getNative$1(root$1$1,"Promise");const Promise$2=Promise$1;var Set$1=getNative$1(root$1$1,"Set");const Set$2=Set$1;var mapTag$5="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$5="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource$1(DataView$2),mapCtorString=toSource$1(Map$2),promiseCtorString=toSource$1(Promise$2),setCtorString=toSource$1(Set$2),weakMapCtorString=toSource$1(WeakMap$2),getTag=baseGetTag$1;(DataView$2&&getTag(new DataView$2(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$5||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$5||WeakMap$2&&getTag(new WeakMap$2)!=weakMapTag$1)&&(getTag=function(tt){var _e=baseGetTag$1(tt),rt=_e==objectTag$2?tt.constructor:void 0,it=rt?toSource$1(rt):"";if(it)switch(it){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$5;case promiseCtorString:return promiseTag;case setCtorString:return setTag$5;case weakMapCtorString:return weakMapTag$1}return _e});const getTag$1=getTag;var objectProto$6$1=Object.prototype,hasOwnProperty$6$1=objectProto$6$1.hasOwnProperty;function initCloneArray(tt){var _e=tt.length,rt=new tt.constructor(_e);return _e&&typeof tt[0]=="string"&&hasOwnProperty$6$1.call(tt,"index")&&(rt.index=tt.index,rt.input=tt.input),rt}var Uint8Array$1=root$1$1.Uint8Array;const Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(tt){var _e=new tt.constructor(tt.byteLength);return new Uint8Array$2(_e).set(new Uint8Array$2(tt)),_e}function cloneDataView(tt,_e){var rt=_e?cloneArrayBuffer(tt.buffer):tt.buffer;return new tt.constructor(rt,tt.byteOffset,tt.byteLength)}var reFlags=/\w*$/;function cloneRegExp(tt){var _e=new tt.constructor(tt.source,reFlags.exec(tt));return _e.lastIndex=tt.lastIndex,_e}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(tt){return symbolValueOf$1?Object(symbolValueOf$1.call(tt)):{}}function cloneTypedArray(tt,_e){var rt=_e?cloneArrayBuffer(tt.buffer):tt.buffer;return new tt.constructor(rt,tt.byteOffset,tt.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$4="[object Map]",numberTag$2="[object Number]",regexpTag$3="[object RegExp]",setTag$4="[object Set]",stringTag$3="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(tt,_e,rt){var it=tt.constructor;switch(_e){case arrayBufferTag$2:return cloneArrayBuffer(tt);case boolTag$2:case dateTag$2:return new it(+tt);case dataViewTag$2:return cloneDataView(tt,rt);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(tt,rt);case mapTag$4:return new it;case numberTag$2:case stringTag$3:return new it(tt);case regexpTag$3:return cloneRegExp(tt);case setTag$4:return new it;case symbolTag$2:return cloneSymbol(tt)}}function initCloneObject(tt){return typeof tt.constructor=="function"&&!isPrototype$1(tt)?baseCreate$1(getPrototype$1(tt)):{}}var mapTag$3="[object Map]";function baseIsMap(tt){return isObjectLike$1(tt)&&getTag$1(tt)==mapTag$3}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap=nodeIsMap?baseUnary$1(nodeIsMap):baseIsMap;const isMap$1=isMap;var setTag$3="[object Set]";function baseIsSet(tt){return isObjectLike$1(tt)&&getTag$1(tt)==setTag$3}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet,isSet=nodeIsSet?baseUnary$1(nodeIsSet):baseIsSet;const isSet$1=isSet;var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag$1$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag$3="[object Function]",genTag$2="[object GeneratorFunction]",mapTag$2="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$2="[object RegExp]",setTag$2="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag$3="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$3="[object Float32Array]",float64Tag$3="[object Float64Array]",int8Tag$3="[object Int8Array]",int16Tag$3="[object Int16Array]",int32Tag$3="[object Int32Array]",uint8Tag$3="[object Uint8Array]",uint8ClampedTag$3="[object Uint8ClampedArray]",uint16Tag$3="[object Uint16Array]",uint32Tag$3="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag$3]=cloneableTags[float64Tag$3]=cloneableTags[int8Tag$3]=cloneableTags[int16Tag$3]=cloneableTags[int32Tag$3]=cloneableTags[mapTag$2]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$2]=cloneableTags[setTag$2]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag$3]=cloneableTags[uint8ClampedTag$3]=cloneableTags[uint16Tag$3]=cloneableTags[uint32Tag$3]=!0;cloneableTags[errorTag$1]=cloneableTags[funcTag$3]=cloneableTags[weakMapTag$3]=!1;function baseClone(tt,_e,rt,it,nt,st){var at,lt=_e&CLONE_DEEP_FLAG,ot=_e&CLONE_FLAT_FLAG,ct=_e&CLONE_SYMBOLS_FLAG$1;if(rt&&(at=nt?rt(tt,it,nt,st):rt(tt)),at!==void 0)return at;if(!isObject$a(tt))return tt;var ut=isArray$1$1(tt);if(ut){if(at=initCloneArray(tt),!lt)return copyArray(tt,at)}else{var ht=getTag$1(tt),dt=ht==funcTag$3||ht==genTag$2;if(isBuffer$1(tt))return cloneBuffer(tt,lt);if(ht==objectTag$1||ht==argsTag$1$1||dt&&!nt){if(at=ot||dt?{}:initCloneObject(tt),!lt)return ot?copySymbolsIn(tt,baseAssignIn(at,tt)):copySymbols(tt,baseAssign(at,tt))}else{if(!cloneableTags[ht])return nt?tt:{};at=initCloneByTag(tt,ht,lt)}}st||(st=new Stack);var pt=st.get(tt);if(pt)return pt;st.set(tt,at),isSet$1(tt)?tt.forEach(function(mt){at.add(baseClone(mt,_e,rt,mt,tt,st))}):isMap$1(tt)&&tt.forEach(function(mt,At){at.set(At,baseClone(mt,_e,rt,At,tt,st))});var ft=ct?ot?getAllKeysIn:getAllKeys:ot?keysIn:keys$1,gt=ut?void 0:ft(tt);return arrayEach(gt||tt,function(mt,At){gt&&(At=mt,mt=tt[At]),assignValue$1(at,At,baseClone(mt,_e,rt,At,tt,st))}),at}var CLONE_SYMBOLS_FLAG=4;function clone(tt){return baseClone(tt,CLONE_SYMBOLS_FLAG)}function compact(tt){for(var _e=-1,rt=tt==null?0:tt.length,it=0,nt=[];++_e<rt;){var st=tt[_e];st&&(nt[it++]=st)}return nt}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(tt){return this.__data__.set(tt,HASH_UNDEFINED),this}function setCacheHas(tt){return this.__data__.has(tt)}function SetCache(tt){var _e=-1,rt=tt==null?0:tt.length;for(this.__data__=new MapCache;++_e<rt;)this.add(tt[_e])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(tt,_e){for(var rt=-1,it=tt==null?0:tt.length;++rt<it;)if(_e(tt[rt],rt,tt))return!0;return!1}function cacheHas(tt,_e){return tt.has(_e)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(tt,_e,rt,it,nt,st){var at=rt&COMPARE_PARTIAL_FLAG$5,lt=tt.length,ot=_e.length;if(lt!=ot&&!(at&&ot>lt))return!1;var ct=st.get(tt),ut=st.get(_e);if(ct&&ut)return ct==_e&&ut==tt;var ht=-1,dt=!0,pt=rt&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(st.set(tt,_e),st.set(_e,tt);++ht<lt;){var ft=tt[ht],gt=_e[ht];if(it)var mt=at?it(gt,ft,ht,_e,tt,st):it(ft,gt,ht,tt,_e,st);if(mt!==void 0){if(mt)continue;dt=!1;break}if(pt){if(!arraySome(_e,function(At,yt){if(!cacheHas(pt,yt)&&(ft===At||nt(ft,At,rt,it,st)))return pt.push(yt)})){dt=!1;break}}else if(!(ft===gt||nt(ft,gt,rt,it,st))){dt=!1;break}}return st.delete(tt),st.delete(_e),dt}function mapToArray(tt){var _e=-1,rt=Array(tt.size);return tt.forEach(function(it,nt){rt[++_e]=[nt,it]}),rt}function setToArray(tt){var _e=-1,rt=Array(tt.size);return tt.forEach(function(it){rt[++_e]=it}),rt}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag$4="[object Boolean]",dateTag$4="[object Date]",errorTag$3="[object Error]",mapTag$1="[object Map]",numberTag$4="[object Number]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$4="[object ArrayBuffer]",dataViewTag$5="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(tt,_e,rt,it,nt,st,at){switch(rt){case dataViewTag$5:if(tt.byteLength!=_e.byteLength||tt.byteOffset!=_e.byteOffset)return!1;tt=tt.buffer,_e=_e.buffer;case arrayBufferTag$4:return!(tt.byteLength!=_e.byteLength||!st(new Uint8Array$2(tt),new Uint8Array$2(_e)));case boolTag$4:case dateTag$4:case numberTag$4:return eq$1(+tt,+_e);case errorTag$3:return tt.name==_e.name&&tt.message==_e.message;case regexpTag$1:case stringTag$1:return tt==_e+"";case mapTag$1:var lt=mapToArray;case setTag$1:var ot=it&COMPARE_PARTIAL_FLAG$4;if(lt||(lt=setToArray),tt.size!=_e.size&&!ot)return!1;var ct=at.get(tt);if(ct)return ct==_e;it|=COMPARE_UNORDERED_FLAG$2,at.set(tt,_e);var ut=equalArrays(lt(tt),lt(_e),it,nt,st,at);return at.delete(tt),ut;case symbolTag:if(symbolValueOf)return symbolValueOf.call(tt)==symbolValueOf.call(_e)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$5$1=Object.prototype,hasOwnProperty$5$1=objectProto$5$1.hasOwnProperty;function equalObjects(tt,_e,rt,it,nt,st){var at=rt&COMPARE_PARTIAL_FLAG$3,lt=getAllKeys(tt),ot=lt.length,ct=getAllKeys(_e),ut=ct.length;if(ot!=ut&&!at)return!1;for(var ht=ot;ht--;){var dt=lt[ht];if(!(at?dt in _e:hasOwnProperty$5$1.call(_e,dt)))return!1}var pt=st.get(tt),ft=st.get(_e);if(pt&&ft)return pt==_e&&ft==tt;var gt=!0;st.set(tt,_e),st.set(_e,tt);for(var mt=at;++ht<ot;){dt=lt[ht];var At=tt[dt],yt=_e[dt];if(it)var bt=at?it(yt,At,dt,_e,tt,st):it(At,yt,dt,tt,_e,st);if(!(bt===void 0?At===yt||nt(At,yt,rt,it,st):bt)){gt=!1;break}mt||(mt=dt=="constructor")}if(gt&&!mt){var xt=tt.constructor,vt=_e.constructor;xt!=vt&&"constructor"in tt&&"constructor"in _e&&!(typeof xt=="function"&&xt instanceof xt&&typeof vt=="function"&&vt instanceof vt)&&(gt=!1)}return st.delete(tt),st.delete(_e),gt}var COMPARE_PARTIAL_FLAG$2=1,argsTag$4="[object Arguments]",arrayTag$3="[object Array]",objectTag$4="[object Object]",objectProto$4$1=Object.prototype,hasOwnProperty$4$1=objectProto$4$1.hasOwnProperty;function baseIsEqualDeep(tt,_e,rt,it,nt,st){var at=isArray$1$1(tt),lt=isArray$1$1(_e),ot=at?arrayTag$3:getTag$1(tt),ct=lt?arrayTag$3:getTag$1(_e);ot=ot==argsTag$4?objectTag$4:ot,ct=ct==argsTag$4?objectTag$4:ct;var ut=ot==objectTag$4,ht=ct==objectTag$4,dt=ot==ct;if(dt&&isBuffer$1(tt)){if(!isBuffer$1(_e))return!1;at=!0,ut=!1}if(dt&&!ut)return st||(st=new Stack),at||isTypedArray$1$1(tt)?equalArrays(tt,_e,rt,it,nt,st):equalByTag(tt,_e,ot,rt,it,nt,st);if(!(rt&COMPARE_PARTIAL_FLAG$2)){var pt=ut&&hasOwnProperty$4$1.call(tt,"__wrapped__"),ft=ht&&hasOwnProperty$4$1.call(_e,"__wrapped__");if(pt||ft){var gt=pt?tt.value():tt,mt=ft?_e.value():_e;return st||(st=new Stack),nt(gt,mt,rt,it,st)}}return dt?(st||(st=new Stack),equalObjects(tt,_e,rt,it,nt,st)):!1}function baseIsEqual(tt,_e,rt,it,nt){return tt===_e?!0:tt==null||_e==null||!isObjectLike$1(tt)&&!isObjectLike$1(_e)?tt!==tt&&_e!==_e:baseIsEqualDeep(tt,_e,rt,it,baseIsEqual,nt)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(tt,_e,rt,it){var nt=rt.length,st=nt,at=!it;if(tt==null)return!st;for(tt=Object(tt);nt--;){var lt=rt[nt];if(at&&lt[2]?lt[1]!==tt[lt[0]]:!(lt[0]in tt))return!1}for(;++nt<st;){lt=rt[nt];var ot=lt[0],ct=tt[ot],ut=lt[1];if(at&&lt[2]){if(ct===void 0&&!(ot in tt))return!1}else{var ht=new Stack;if(it)var dt=it(ct,ut,ot,tt,_e,ht);if(!(dt===void 0?baseIsEqual(ut,ct,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,it,ht):dt))return!1}}return!0}function isStrictComparable(tt){return tt===tt&&!isObject$a(tt)}function getMatchData(tt){for(var _e=keys$1(tt),rt=_e.length;rt--;){var it=_e[rt],nt=tt[it];_e[rt]=[it,nt,isStrictComparable(nt)]}return _e}function matchesStrictComparable(tt,_e){return function(rt){return rt==null?!1:rt[tt]===_e&&(_e!==void 0||tt in Object(rt))}}function baseMatches(tt){var _e=getMatchData(tt);return _e.length==1&&_e[0][2]?matchesStrictComparable(_e[0][0],_e[0][1]):function(rt){return rt===tt||baseIsMatch(rt,tt,_e)}}function baseHasIn(tt,_e){return tt!=null&&_e in Object(tt)}function hasPath(tt,_e,rt){_e=castPath(_e,tt);for(var it=-1,nt=_e.length,st=!1;++it<nt;){var at=toKey(_e[it]);if(!(st=tt!=null&&rt(tt,at)))break;tt=tt[at]}return st||++it!=nt?st:(nt=tt==null?0:tt.length,!!nt&&isLength$1(nt)&&isIndex$1(at,nt)&&(isArray$1$1(tt)||isArguments$1$1(tt)))}function hasIn(tt,_e){return tt!=null&&hasPath(tt,_e,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(tt,_e){return isKey(tt)&&isStrictComparable(_e)?matchesStrictComparable(toKey(tt),_e):function(rt){var it=get$1(rt,tt);return it===void 0&&it===_e?hasIn(rt,tt):baseIsEqual(_e,it,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(tt){return function(_e){return _e==null?void 0:_e[tt]}}function basePropertyDeep(tt){return function(_e){return baseGet(_e,tt)}}function property(tt){return isKey(tt)?baseProperty(toKey(tt)):basePropertyDeep(tt)}function baseIteratee(tt){return typeof tt=="function"?tt:tt==null?identity$2:typeof tt=="object"?isArray$1$1(tt)?baseMatchesProperty(tt[0],tt[1]):baseMatches(tt):property(tt)}function arrayAggregator(tt,_e,rt,it){for(var nt=-1,st=tt==null?0:tt.length;++nt<st;){var at=tt[nt];_e(it,at,rt(at),tt)}return it}function createBaseFor(tt){return function(_e,rt,it){for(var nt=-1,st=Object(_e),at=it(_e),lt=at.length;lt--;){var ot=at[tt?lt:++nt];if(rt(st[ot],ot,st)===!1)break}return _e}}var baseFor=createBaseFor();const baseFor$1=baseFor;function baseForOwn(tt,_e){return tt&&baseFor$1(tt,_e,keys$1)}function createBaseEach(tt,_e){return function(rt,it){if(rt==null)return rt;if(!isArrayLike$1(rt))return tt(rt,it);for(var nt=rt.length,st=_e?nt:-1,at=Object(rt);(_e?st--:++st<nt)&&it(at[st],st,at)!==!1;);return rt}}var baseEach=createBaseEach(baseForOwn);const baseEach$1=baseEach;function baseAggregator(tt,_e,rt,it){return baseEach$1(tt,function(nt,st,at){_e(it,nt,rt(nt),at)}),it}function createAggregator(tt,_e){return function(rt,it){var nt=isArray$1$1(rt)?arrayAggregator:baseAggregator,st=_e?_e():{};return nt(rt,tt,baseIteratee(it),st)}}var objectProto$3$1=Object.prototype,hasOwnProperty$3$1=objectProto$3$1.hasOwnProperty,defaults=baseRest$1(function(tt,_e){tt=Object(tt);var rt=-1,it=_e.length,nt=it>2?_e[2]:void 0;for(nt&&isIterateeCall$1(_e[0],_e[1],nt)&&(it=1);++rt<it;)for(var st=_e[rt],at=keysIn(st),lt=-1,ot=at.length;++lt<ot;){var ct=at[lt],ut=tt[ct];(ut===void 0||eq$1(ut,objectProto$3$1[ct])&&!hasOwnProperty$3$1.call(tt,ct))&&(tt[ct]=st[ct])}return tt});const defaults$1=defaults;function isArrayLikeObject(tt){return isObjectLike$1(tt)&&isArrayLike$1(tt)}function arrayIncludesWith(tt,_e,rt){for(var it=-1,nt=tt==null?0:tt.length;++it<nt;)if(rt(_e,tt[it]))return!0;return!1}var LARGE_ARRAY_SIZE$1=200;function baseDifference(tt,_e,rt,it){var nt=-1,st=arrayIncludes,at=!0,lt=tt.length,ot=[],ct=_e.length;if(!lt)return ot;rt&&(_e=arrayMap(_e,baseUnary$1(rt))),it?(st=arrayIncludesWith,at=!1):_e.length>=LARGE_ARRAY_SIZE$1&&(st=cacheHas,at=!1,_e=new SetCache(_e));e:for(;++nt<lt;){var ut=tt[nt],ht=rt==null?ut:rt(ut);if(ut=it||ut!==0?ut:0,at&&ht===ht){for(var dt=ct;dt--;)if(_e[dt]===ht)continue e;ot.push(ut)}else st(_e,ht,it)||ot.push(ut)}return ot}var difference=baseRest$1(function(tt,_e){return isArrayLikeObject(tt)?baseDifference(tt,baseFlatten(_e,1,isArrayLikeObject,!0)):[]});const difference$1=difference;function last(tt){var _e=tt==null?0:tt.length;return _e?tt[_e-1]:void 0}function drop(tt,_e,rt){var it=tt==null?0:tt.length;return it?(_e=rt||_e===void 0?1:toInteger(_e),baseSlice(tt,_e<0?0:_e,it)):[]}function dropRight(tt,_e,rt){var it=tt==null?0:tt.length;return it?(_e=rt||_e===void 0?1:toInteger(_e),_e=it-_e,baseSlice(tt,0,_e<0?0:_e)):[]}function castFunction(tt){return typeof tt=="function"?tt:identity$2}function forEach(tt,_e){var rt=isArray$1$1(tt)?arrayEach:baseEach$1;return rt(tt,castFunction(_e))}function arrayEvery(tt,_e){for(var rt=-1,it=tt==null?0:tt.length;++rt<it;)if(!_e(tt[rt],rt,tt))return!1;return!0}function baseEvery(tt,_e){var rt=!0;return baseEach$1(tt,function(it,nt,st){return rt=!!_e(it,nt,st),rt}),rt}function every(tt,_e,rt){var it=isArray$1$1(tt)?arrayEvery:baseEvery;return rt&&isIterateeCall$1(tt,_e,rt)&&(_e=void 0),it(tt,baseIteratee(_e))}function baseFilter(tt,_e){var rt=[];return baseEach$1(tt,function(it,nt,st){_e(it,nt,st)&&rt.push(it)}),rt}function filter(tt,_e){var rt=isArray$1$1(tt)?arrayFilter:baseFilter;return rt(tt,baseIteratee(_e))}function createFind(tt){return function(_e,rt,it){var nt=Object(_e);if(!isArrayLike$1(_e)){var st=baseIteratee(rt);_e=keys$1(_e),rt=function(lt){return st(nt[lt],lt,nt)}}var at=tt(_e,rt,it);return at>-1?nt[st?_e[at]:at]:void 0}}var nativeMax$2=Math.max;function findIndex(tt,_e,rt){var it=tt==null?0:tt.length;if(!it)return-1;var nt=rt==null?0:toInteger(rt);return nt<0&&(nt=nativeMax$2(it+nt,0)),baseFindIndex(tt,baseIteratee(_e),nt)}var find=createFind(findIndex);const find$1=find;function head(tt){return tt&&tt.length?tt[0]:void 0}function baseMap(tt,_e){var rt=-1,it=isArrayLike$1(tt)?Array(tt.length):[];return baseEach$1(tt,function(nt,st,at){it[++rt]=_e(nt,st,at)}),it}function map(tt,_e){var rt=isArray$1$1(tt)?arrayMap:baseMap;return rt(tt,baseIteratee(_e))}function flatMap(tt,_e){return baseFlatten(map(tt,_e),1)}var objectProto$2$1=Object.prototype,hasOwnProperty$2$1=objectProto$2$1.hasOwnProperty,groupBy=createAggregator(function(tt,_e,rt){hasOwnProperty$2$1.call(tt,rt)?tt[rt].push(_e):baseAssignValue$1(tt,rt,[_e])});const groupBy$1=groupBy;var objectProto$1$1=Object.prototype,hasOwnProperty$1$1=objectProto$1$1.hasOwnProperty;function baseHas(tt,_e){return tt!=null&&hasOwnProperty$1$1.call(tt,_e)}function has$1(tt,_e){return tt!=null&&hasPath(tt,_e,baseHas)}var stringTag$5="[object String]";function isString$1(tt){return typeof tt=="string"||!isArray$1$1(tt)&&isObjectLike$1(tt)&&baseGetTag$1(tt)==stringTag$5}function baseValues(tt,_e){return arrayMap(_e,function(rt){return tt[rt]})}function values(tt){return tt==null?[]:baseValues(tt,keys$1(tt))}var nativeMax$1=Math.max;function includes(tt,_e,rt,it){tt=isArrayLike$1(tt)?tt:values(tt),rt=rt&&!it?toInteger(rt):0;var nt=tt.length;return rt<0&&(rt=nativeMax$1(nt+rt,0)),isString$1(tt)?rt<=nt&&tt.indexOf(_e,rt)>-1:!!nt&&baseIndexOf(tt,_e,rt)>-1}var nativeMax$4=Math.max;function indexOf(tt,_e,rt){var it=tt==null?0:tt.length;if(!it)return-1;var nt=rt==null?0:toInteger(rt);return nt<0&&(nt=nativeMax$4(it+nt,0)),baseIndexOf(tt,_e,nt)}var mapTag$7="[object Map]",setTag$7="[object Set]",objectProto$k=Object.prototype,hasOwnProperty$h=objectProto$k.hasOwnProperty;function isEmpty(tt){if(tt==null)return!0;if(isArrayLike$1(tt)&&(isArray$1$1(tt)||typeof tt=="string"||typeof tt.splice=="function"||isBuffer$1(tt)||isTypedArray$1$1(tt)||isArguments$1$1(tt)))return!tt.length;var _e=getTag$1(tt);if(_e==mapTag$7||_e==setTag$7)return!tt.size;if(isPrototype$1(tt))return!baseKeys$1(tt).length;for(var rt in tt)if(hasOwnProperty$h.call(tt,rt))return!1;return!0}var regexpTag$5="[object RegExp]";function baseIsRegExp(tt){return isObjectLike$1(tt)&&baseGetTag$1(tt)==regexpTag$5}var nodeIsRegExp=nodeUtil$1&&nodeUtil$1.isRegExp,isRegExp=nodeIsRegExp?baseUnary$1(nodeIsRegExp):baseIsRegExp;const isRegExp$1=isRegExp;function isUndefined(tt){return tt===void 0}var FUNC_ERROR_TEXT="Expected a function";function negate(tt){if(typeof tt!="function")throw new TypeError(FUNC_ERROR_TEXT);return function(){var _e=arguments;switch(_e.length){case 0:return!tt.call(this);case 1:return!tt.call(this,_e[0]);case 2:return!tt.call(this,_e[0],_e[1]);case 3:return!tt.call(this,_e[0],_e[1],_e[2])}return!tt.apply(this,_e)}}function baseSet(tt,_e,rt,it){if(!isObject$a(tt))return tt;_e=castPath(_e,tt);for(var nt=-1,st=_e.length,at=st-1,lt=tt;lt!=null&&++nt<st;){var ot=toKey(_e[nt]),ct=rt;if(ot==="__proto__"||ot==="constructor"||ot==="prototype")return tt;if(nt!=at){var ut=lt[ot];ct=it?it(ut,ot,lt):void 0,ct===void 0&&(ct=isObject$a(ut)?ut:isIndex$1(_e[nt+1])?[]:{})}assignValue$1(lt,ot,ct),lt=lt[ot]}return tt}function basePickBy(tt,_e,rt){for(var it=-1,nt=_e.length,st={};++it<nt;){var at=_e[it],lt=baseGet(tt,at);rt(lt,at)&&baseSet(st,castPath(at,tt),lt)}return st}function pickBy(tt,_e){if(tt==null)return{};var rt=arrayMap(getAllKeysIn(tt),function(it){return[it]});return _e=baseIteratee(_e),basePickBy(tt,rt,function(it,nt){return _e(it,nt[0])})}function baseReduce(tt,_e,rt,it,nt){return nt(tt,function(st,at,lt){rt=it?(it=!1,st):_e(rt,st,at,lt)}),rt}function reduce(tt,_e,rt){var it=isArray$1$1(tt)?arrayReduce:baseReduce,nt=arguments.length<3;return it(tt,baseIteratee(_e),rt,nt,baseEach$1)}function reject(tt,_e){var rt=isArray$1$1(tt)?arrayFilter:baseFilter;return rt(tt,negate(baseIteratee(_e)))}function baseSome(tt,_e){var rt;return baseEach$1(tt,function(it,nt,st){return rt=_e(it,nt,st),!rt}),!!rt}function some(tt,_e,rt){var it=isArray$1$1(tt)?arraySome:baseSome;return rt&&isIterateeCall$1(tt,_e,rt)&&(_e=void 0),it(tt,baseIteratee(_e))}var INFINITY=1/0,createSet=Set$2&&1/setToArray(new Set$2([,-0]))[1]==INFINITY?function(tt){return new Set$2(tt)}:noop$2;const createSet$1=createSet;var LARGE_ARRAY_SIZE=200;function baseUniq(tt,_e,rt){var it=-1,nt=arrayIncludes,st=tt.length,at=!0,lt=[],ot=lt;if(rt)at=!1,nt=arrayIncludesWith;else if(st>=LARGE_ARRAY_SIZE){var ct=_e?null:createSet$1(tt);if(ct)return setToArray(ct);at=!1,nt=cacheHas,ot=new SetCache}else ot=_e?[]:lt;e:for(;++it<st;){var ut=tt[it],ht=_e?_e(ut):ut;if(ut=rt||ut!==0?ut:0,at&&ht===ht){for(var dt=ot.length;dt--;)if(ot[dt]===ht)continue e;_e&&ot.push(ht),lt.push(ut)}else nt(ot,ht,rt)||(ot!==lt&&ot.push(ht),lt.push(ut))}return lt}function uniq(tt){return tt&&tt.length?baseUniq(tt):[]}function PRINT_ERROR(tt){console&&console.error&&console.error(`Error: ${tt}`)}function PRINT_WARNING(tt){console&&console.warn&&console.warn(`Warning: ${tt}`)}function timer$1(tt){const _e=new Date().getTime(),rt=tt();return{time:new Date().getTime()-_e,value:rt}}function toFastProperties(tt){function _e(){}_e.prototype=tt;const rt=new _e;function it(){return typeof rt.bar}return it(),it(),tt}function tokenLabel$1(tt){return hasTokenLabel$1(tt)?tt.LABEL:tt.name}function hasTokenLabel$1(tt){return isString$1(tt.LABEL)&&tt.LABEL!==""}class AbstractProduction{get definition(){return this._definition}set definition(_e){this._definition=_e}constructor(_e){this._definition=_e}accept(_e){_e.visit(this),forEach(this.definition,rt=>{rt.accept(_e)})}}class NonTerminal extends AbstractProduction{constructor(_e){super([]),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}set definition(_e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(_e){_e.visit(this)}}let Rule$1=class extends AbstractProduction{constructor(_e){super(_e.definition),this.orgText="",assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}};class Alternative extends AbstractProduction{constructor(_e){super(_e.definition),this.ignoreAmbiguities=!1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class Option extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class RepetitionMandatory extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class RepetitionMandatoryWithSeparator extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class Repetition extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class RepetitionWithSeparator extends AbstractProduction{constructor(_e){super(_e.definition),this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class Alternation extends AbstractProduction{get definition(){return this._definition}set definition(_e){this._definition=_e}constructor(_e){super(_e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}}class Terminal{constructor(_e){this.idx=1,assign$1$1(this,pickBy(_e,rt=>rt!==void 0))}accept(_e){_e.visit(this)}}function serializeGrammar(tt){return map(tt,serializeProduction)}function serializeProduction(tt){function _e(rt){return map(rt,serializeProduction)}if(tt instanceof NonTerminal){const rt={type:"NonTerminal",name:tt.nonTerminalName,idx:tt.idx};return isString$1(tt.label)&&(rt.label=tt.label),rt}else{if(tt instanceof Alternative)return{type:"Alternative",definition:_e(tt.definition)};if(tt instanceof Option)return{type:"Option",idx:tt.idx,definition:_e(tt.definition)};if(tt instanceof RepetitionMandatory)return{type:"RepetitionMandatory",idx:tt.idx,definition:_e(tt.definition)};if(tt instanceof RepetitionMandatoryWithSeparator)return{type:"RepetitionMandatoryWithSeparator",idx:tt.idx,separator:serializeProduction(new Terminal({terminalType:tt.separator})),definition:_e(tt.definition)};if(tt instanceof RepetitionWithSeparator)return{type:"RepetitionWithSeparator",idx:tt.idx,separator:serializeProduction(new Terminal({terminalType:tt.separator})),definition:_e(tt.definition)};if(tt instanceof Repetition)return{type:"Repetition",idx:tt.idx,definition:_e(tt.definition)};if(tt instanceof Alternation)return{type:"Alternation",idx:tt.idx,definition:_e(tt.definition)};if(tt instanceof Terminal){const rt={type:"Terminal",name:tt.terminalType.name,label:tokenLabel$1(tt.terminalType),idx:tt.idx};isString$1(tt.label)&&(rt.terminalLabel=tt.label);const it=tt.terminalType.PATTERN;return tt.terminalType.PATTERN&&(rt.pattern=isRegExp$1(it)?it.source:it),rt}else{if(tt instanceof Rule$1)return{type:"Rule",name:tt.name,orgText:tt.orgText,definition:_e(tt.definition)};throw Error("non exhaustive match")}}}class GAstVisitor{visit(_e){const rt=_e;switch(rt.constructor){case NonTerminal:return this.visitNonTerminal(rt);case Alternative:return this.visitAlternative(rt);case Option:return this.visitOption(rt);case RepetitionMandatory:return this.visitRepetitionMandatory(rt);case RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(rt);case RepetitionWithSeparator:return this.visitRepetitionWithSeparator(rt);case Repetition:return this.visitRepetition(rt);case Alternation:return this.visitAlternation(rt);case Terminal:return this.visitTerminal(rt);case Rule$1:return this.visitRule(rt);default:throw Error("non exhaustive match")}}visitNonTerminal(_e){}visitAlternative(_e){}visitOption(_e){}visitRepetition(_e){}visitRepetitionMandatory(_e){}visitRepetitionMandatoryWithSeparator(_e){}visitRepetitionWithSeparator(_e){}visitAlternation(_e){}visitTerminal(_e){}visitRule(_e){}}function isSequenceProd(tt){return tt instanceof Alternative||tt instanceof Option||tt instanceof Repetition||tt instanceof RepetitionMandatory||tt instanceof RepetitionMandatoryWithSeparator||tt instanceof RepetitionWithSeparator||tt instanceof Terminal||tt instanceof Rule$1}function isOptionalProd(tt,_e=[]){return tt instanceof Option||tt instanceof Repetition||tt instanceof RepetitionWithSeparator?!0:tt instanceof Alternation?some(tt.definition,it=>isOptionalProd(it,_e)):tt instanceof NonTerminal&&includes(_e,tt)?!1:tt instanceof AbstractProduction?(tt instanceof NonTerminal&&_e.push(tt),every(tt.definition,it=>isOptionalProd(it,_e))):!1}function isBranchingProd(tt){return tt instanceof Alternation}function getProductionDslName(tt){if(tt instanceof NonTerminal)return"SUBRULE";if(tt instanceof Option)return"OPTION";if(tt instanceof Alternation)return"OR";if(tt instanceof RepetitionMandatory)return"AT_LEAST_ONE";if(tt instanceof RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(tt instanceof RepetitionWithSeparator)return"MANY_SEP";if(tt instanceof Repetition)return"MANY";if(tt instanceof Terminal)return"CONSUME";throw Error("non exhaustive match")}class RestWalker{walk(_e,rt=[]){forEach(_e.definition,(it,nt)=>{const st=drop(_e.definition,nt+1);if(it instanceof NonTerminal)this.walkProdRef(it,st,rt);else if(it instanceof Terminal)this.walkTerminal(it,st,rt);else if(it instanceof Alternative)this.walkFlat(it,st,rt);else if(it instanceof Option)this.walkOption(it,st,rt);else if(it instanceof RepetitionMandatory)this.walkAtLeastOne(it,st,rt);else if(it instanceof RepetitionMandatoryWithSeparator)this.walkAtLeastOneSep(it,st,rt);else if(it instanceof RepetitionWithSeparator)this.walkManySep(it,st,rt);else if(it instanceof Repetition)this.walkMany(it,st,rt);else if(it instanceof Alternation)this.walkOr(it,st,rt);else throw Error("non exhaustive match")})}walkTerminal(_e,rt,it){}walkProdRef(_e,rt,it){}walkFlat(_e,rt,it){const nt=rt.concat(it);this.walk(_e,nt)}walkOption(_e,rt,it){const nt=rt.concat(it);this.walk(_e,nt)}walkAtLeastOne(_e,rt,it){const nt=[new Option({definition:_e.definition})].concat(rt,it);this.walk(_e,nt)}walkAtLeastOneSep(_e,rt,it){const nt=restForRepetitionWithSeparator(_e,rt,it);this.walk(_e,nt)}walkMany(_e,rt,it){const nt=[new Option({definition:_e.definition})].concat(rt,it);this.walk(_e,nt)}walkManySep(_e,rt,it){const nt=restForRepetitionWithSeparator(_e,rt,it);this.walk(_e,nt)}walkOr(_e,rt,it){const nt=rt.concat(it);forEach(_e.definition,st=>{const at=new Alternative({definition:[st]});this.walk(at,nt)})}}function restForRepetitionWithSeparator(tt,_e,rt){return[new Option({definition:[new Terminal({terminalType:tt.separator})].concat(tt.definition)})].concat(_e,rt)}function first$1(tt){if(tt instanceof NonTerminal)return first$1(tt.referencedRule);if(tt instanceof Terminal)return firstForTerminal(tt);if(isSequenceProd(tt))return firstForSequence(tt);if(isBranchingProd(tt))return firstForBranching(tt);throw Error("non exhaustive match")}function firstForSequence(tt){let _e=[];const rt=tt.definition;let it=0,nt=rt.length>it,st,at=!0;for(;nt&&at;)st=rt[it],at=isOptionalProd(st),_e=_e.concat(first$1(st)),it=it+1,nt=rt.length>it;return uniq(_e)}function firstForBranching(tt){const _e=map(tt.definition,rt=>first$1(rt));return uniq(flatten$1(_e))}function firstForTerminal(tt){return[tt.terminalType]}const IN="_~IN~_";class ResyncFollowsWalker extends RestWalker{constructor(_e){super(),this.topProd=_e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(_e,rt,it){}walkProdRef(_e,rt,it){const nt=buildBetweenProdsFollowPrefix(_e.referencedRule,_e.idx)+this.topProd.name,st=rt.concat(it),at=new Alternative({definition:st}),lt=first$1(at);this.follows[nt]=lt}}function computeAllProdsFollows(tt){const _e={};return forEach(tt,rt=>{const it=new ResyncFollowsWalker(rt).startWalking();assign$1$1(_e,it)}),_e}function buildBetweenProdsFollowPrefix(tt,_e){return tt.name+_e+IN}function cc(tt){return tt.charCodeAt(0)}function insertToSet(tt,_e){Array.isArray(tt)?tt.forEach(function(rt){_e.push(rt)}):_e.push(tt)}function addFlag(tt,_e){if(tt[_e]===!0)throw"duplicate flag "+_e;tt[_e],tt[_e]=!0}function ASSERT_EXISTS(tt){if(tt===void 0)throw Error("Internal Error - Should never get here!");return!0}function ASSERT_NEVER_REACH_HERE(){throw Error("Internal Error - Should never get here!")}function isCharacter(tt){return tt.type==="Character"}const digitsCharCodes=[];for(let tt=cc("0");tt<=cc("9");tt++)digitsCharCodes.push(tt);const wordCharCodes=[cc("_")].concat(digitsCharCodes);for(let tt=cc("a");tt<=cc("z");tt++)wordCharCodes.push(tt);for(let tt=cc("A");tt<=cc("Z");tt++)wordCharCodes.push(tt);const whitespaceCodes=[cc(" "),cc("\f"),cc(`
`),cc("\r"),cc("	"),cc("\v"),cc("	"),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc(" "),cc("\u2028"),cc("\u2029"),cc(" "),cc(" "),cc("　"),cc("\uFEFF")],hexDigitPattern=/[0-9a-fA-F]/,decimalPattern=/[0-9]/,decimalPatternNoZero=/[1-9]/;class RegExpParser{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(_e){this.idx=_e.idx,this.input=_e.input,this.groupIdx=_e.groupIdx}pattern(_e){this.idx=0,this.input=_e,this.groupIdx=0,this.consumeChar("/");const rt=this.disjunction();this.consumeChar("/");const it={type:"Flags",loc:{begin:this.idx,end:_e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":addFlag(it,"global");break;case"i":addFlag(it,"ignoreCase");break;case"m":addFlag(it,"multiLine");break;case"u":addFlag(it,"unicode");break;case"y":addFlag(it,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:it,value:rt,loc:this.loc(0)}}disjunction(){const _e=[],rt=this.idx;for(_e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),_e.push(this.alternative());return{type:"Disjunction",value:_e,loc:this.loc(rt)}}alternative(){const _e=[],rt=this.idx;for(;this.isTerm();)_e.push(this.term());return{type:"Alternative",value:_e,loc:this.loc(rt)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const _e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(_e)};case"$":return{type:"EndAnchor",loc:this.loc(_e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(_e)};case"B":return{type:"NonWordBoundary",loc:this.loc(_e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let rt;switch(this.popChar()){case"=":rt="Lookahead";break;case"!":rt="NegativeLookahead";break}ASSERT_EXISTS(rt);const it=this.disjunction();return this.consumeChar(")"),{type:rt,value:it,loc:this.loc(_e)}}return ASSERT_NEVER_REACH_HERE()}quantifier(_e=!1){let rt;const it=this.idx;switch(this.popChar()){case"*":rt={atLeast:0,atMost:1/0};break;case"+":rt={atLeast:1,atMost:1/0};break;case"?":rt={atLeast:0,atMost:1};break;case"{":const nt=this.integerIncludingZero();switch(this.popChar()){case"}":rt={atLeast:nt,atMost:nt};break;case",":let st;this.isDigit()?(st=this.integerIncludingZero(),rt={atLeast:nt,atMost:st}):rt={atLeast:nt,atMost:1/0},this.consumeChar("}");break}if(_e===!0&&rt===void 0)return;ASSERT_EXISTS(rt);break}if(!(_e===!0&&rt===void 0)&&ASSERT_EXISTS(rt))return this.peekChar(0)==="?"?(this.consumeChar("?"),rt.greedy=!1):rt.greedy=!0,rt.type="Quantifier",rt.loc=this.loc(it),rt}atom(){let _e;const rt=this.idx;switch(this.peekChar()){case".":_e=this.dotAll();break;case"\\":_e=this.atomEscape();break;case"[":_e=this.characterClass();break;case"(":_e=this.group();break}if(_e===void 0&&this.isPatternCharacter()&&(_e=this.patternCharacter()),ASSERT_EXISTS(_e))return _e.loc=this.loc(rt),this.isQuantifier()&&(_e.quantifier=this.quantifier()),_e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[cc(`
`),cc("\r"),cc("\u2028"),cc("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let _e,rt=!1;switch(this.popChar()){case"d":_e=digitsCharCodes;break;case"D":_e=digitsCharCodes,rt=!0;break;case"s":_e=whitespaceCodes;break;case"S":_e=whitespaceCodes,rt=!0;break;case"w":_e=wordCharCodes;break;case"W":_e=wordCharCodes,rt=!0;break}if(ASSERT_EXISTS(_e))return{type:"Set",value:_e,complement:rt}}controlEscapeAtom(){let _e;switch(this.popChar()){case"f":_e=cc("\f");break;case"n":_e=cc(`
`);break;case"r":_e=cc("\r");break;case"t":_e=cc("	");break;case"v":_e=cc("\v");break}if(ASSERT_EXISTS(_e))return{type:"Character",value:_e}}controlLetterEscapeAtom(){this.consumeChar("c");const _e=this.popChar();if(/[a-zA-Z]/.test(_e)===!1)throw Error("Invalid ");return{type:"Character",value:_e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:cc("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const _e=this.popChar();return{type:"Character",value:cc(_e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const _e=this.popChar();return{type:"Character",value:cc(_e)}}}characterClass(){const _e=[];let rt=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),rt=!0);this.isClassAtom();){const it=this.classAtom();if(it.type,isCharacter(it)&&this.isRangeDash()){this.consumeChar("-");const nt=this.classAtom();if(nt.type,isCharacter(nt)){if(nt.value<it.value)throw Error("Range out of order in character class");_e.push({from:it.value,to:nt.value})}else insertToSet(it.value,_e),_e.push(cc("-")),insertToSet(nt.value,_e)}else insertToSet(it.value,_e)}return this.consumeChar("]"),{type:"Set",complement:rt,value:_e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:cc("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let _e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),_e=!1;break;default:this.groupIdx++;break}const rt=this.disjunction();this.consumeChar(")");const it={type:"Group",capturing:_e,value:rt};return _e&&(it.idx=this.groupIdx),it}positiveInteger(){let _e=this.popChar();if(decimalPatternNoZero.test(_e)===!1)throw Error("Expecting a positive integer");for(;decimalPattern.test(this.peekChar(0));)_e+=this.popChar();return parseInt(_e,10)}integerIncludingZero(){let _e=this.popChar();if(decimalPattern.test(_e)===!1)throw Error("Expecting an integer");for(;decimalPattern.test(this.peekChar(0));)_e+=this.popChar();return parseInt(_e,10)}patternCharacter(){const _e=this.popChar();switch(_e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:cc(_e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return decimalPattern.test(this.peekChar(0))}isClassAtom(_e=0){switch(this.peekChar(_e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const _e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(_e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(_e){let rt="";for(let nt=0;nt<_e;nt++){const st=this.popChar();if(hexDigitPattern.test(st)===!1)throw Error("Expecting a HexDecimal digits");rt+=st}return{type:"Character",value:parseInt(rt,16)}}peekChar(_e=0){return this.input[this.idx+_e]}popChar(){const _e=this.peekChar(0);return this.consumeChar(void 0),_e}consumeChar(_e){if(_e!==void 0&&this.input[this.idx]!==_e)throw Error("Expected: '"+_e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(_e){return{begin:_e,end:this.idx}}}class BaseRegExpVisitor{visitChildren(_e){for(const rt in _e){const it=_e[rt];_e.hasOwnProperty(rt)&&(it.type!==void 0?this.visit(it):Array.isArray(it)&&it.forEach(nt=>{this.visit(nt)},this))}}visit(_e){switch(_e.type){case"Pattern":this.visitPattern(_e);break;case"Flags":this.visitFlags(_e);break;case"Disjunction":this.visitDisjunction(_e);break;case"Alternative":this.visitAlternative(_e);break;case"StartAnchor":this.visitStartAnchor(_e);break;case"EndAnchor":this.visitEndAnchor(_e);break;case"WordBoundary":this.visitWordBoundary(_e);break;case"NonWordBoundary":this.visitNonWordBoundary(_e);break;case"Lookahead":this.visitLookahead(_e);break;case"NegativeLookahead":this.visitNegativeLookahead(_e);break;case"Character":this.visitCharacter(_e);break;case"Set":this.visitSet(_e);break;case"Group":this.visitGroup(_e);break;case"GroupBackReference":this.visitGroupBackReference(_e);break;case"Quantifier":this.visitQuantifier(_e);break}this.visitChildren(_e)}visitPattern(_e){}visitFlags(_e){}visitDisjunction(_e){}visitAlternative(_e){}visitStartAnchor(_e){}visitEndAnchor(_e){}visitWordBoundary(_e){}visitNonWordBoundary(_e){}visitLookahead(_e){}visitNegativeLookahead(_e){}visitCharacter(_e){}visitSet(_e){}visitGroup(_e){}visitGroupBackReference(_e){}visitQuantifier(_e){}}let regExpAstCache={};const regExpParser=new RegExpParser;function getRegExpAst(tt){const _e=tt.toString();if(regExpAstCache.hasOwnProperty(_e))return regExpAstCache[_e];{const rt=regExpParser.pattern(_e);return regExpAstCache[_e]=rt,rt}}function clearRegExpParserCache(){regExpAstCache={}}const complementErrorMessage="Complement Sets are not supported for first char optimization",failedOptimizationPrefixMsg=`Unable to use "first char" lexer optimizations:
`;function getOptimizedStartCodesIndices(tt,_e=!1){try{const rt=getRegExpAst(tt);return firstCharOptimizedIndices(rt.value,{},rt.flags.ignoreCase)}catch(rt){if(rt.message===complementErrorMessage)_e&&PRINT_WARNING(`${failedOptimizationPrefixMsg}	Unable to optimize: < ${tt.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let it="";_e&&(it=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),PRINT_ERROR(`${failedOptimizationPrefixMsg}
	Failed parsing: < ${tt.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+it)}}return[]}function firstCharOptimizedIndices(tt,_e,rt){switch(tt.type){case"Disjunction":for(let nt=0;nt<tt.value.length;nt++)firstCharOptimizedIndices(tt.value[nt],_e,rt);break;case"Alternative":const it=tt.value;for(let nt=0;nt<it.length;nt++){const st=it[nt];switch(st.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const at=st;switch(at.type){case"Character":addOptimizedIdxToResult(at.value,_e,rt);break;case"Set":if(at.complement===!0)throw Error(complementErrorMessage);forEach(at.value,ot=>{if(typeof ot=="number")addOptimizedIdxToResult(ot,_e,rt);else{const ct=ot;if(rt===!0)for(let ut=ct.from;ut<=ct.to;ut++)addOptimizedIdxToResult(ut,_e,rt);else{for(let ut=ct.from;ut<=ct.to&&ut<minOptimizationVal;ut++)addOptimizedIdxToResult(ut,_e,rt);if(ct.to>=minOptimizationVal){const ut=ct.from>=minOptimizationVal?ct.from:minOptimizationVal,ht=ct.to,dt=charCodeToOptimizedIndex(ut),pt=charCodeToOptimizedIndex(ht);for(let ft=dt;ft<=pt;ft++)_e[ft]=ft}}}});break;case"Group":firstCharOptimizedIndices(at.value,_e,rt);break;default:throw Error("Non Exhaustive Match")}const lt=at.quantifier!==void 0&&at.quantifier.atLeast===0;if(at.type==="Group"&&isWholeOptional(at)===!1||at.type!=="Group"&&lt===!1)break}break;default:throw Error("non exhaustive match!")}return values(_e)}function addOptimizedIdxToResult(tt,_e,rt){const it=charCodeToOptimizedIndex(tt);_e[it]=it,rt===!0&&handleIgnoreCase(tt,_e)}function handleIgnoreCase(tt,_e){const rt=String.fromCharCode(tt),it=rt.toUpperCase();if(it!==rt){const nt=charCodeToOptimizedIndex(it.charCodeAt(0));_e[nt]=nt}else{const nt=rt.toLowerCase();if(nt!==rt){const st=charCodeToOptimizedIndex(nt.charCodeAt(0));_e[st]=st}}}function findCode(tt,_e){return find$1(tt.value,rt=>{if(typeof rt=="number")return includes(_e,rt);{const it=rt;return find$1(_e,nt=>it.from<=nt&&nt<=it.to)!==void 0}})}function isWholeOptional(tt){const _e=tt.quantifier;return _e&&_e.atLeast===0?!0:tt.value?isArray$1$1(tt.value)?every(tt.value,isWholeOptional):isWholeOptional(tt.value):!1}class CharCodeFinder extends BaseRegExpVisitor{constructor(_e){super(),this.targetCharCodes=_e,this.found=!1}visitChildren(_e){if(this.found!==!0){switch(_e.type){case"Lookahead":this.visitLookahead(_e);return;case"NegativeLookahead":this.visitNegativeLookahead(_e);return}super.visitChildren(_e)}}visitCharacter(_e){includes(this.targetCharCodes,_e.value)&&(this.found=!0)}visitSet(_e){_e.complement?findCode(_e,this.targetCharCodes)===void 0&&(this.found=!0):findCode(_e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function canMatchCharCode(tt,_e){if(_e instanceof RegExp){const rt=getRegExpAst(_e),it=new CharCodeFinder(tt);return it.visit(rt),it.found}else return find$1(_e,rt=>includes(tt,rt.charCodeAt(0)))!==void 0}const PATTERN="PATTERN",DEFAULT_MODE="defaultMode",MODES="modes";let SUPPORT_STICKY=typeof new RegExp("(?:)").sticky=="boolean";function analyzeTokenTypes(tt,_e){_e=defaults$1(_e,{useSticky:SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(yt,bt)=>bt()});const rt=_e.tracer;rt("initCharCodeToOptimizedIndexMap",()=>{initCharCodeToOptimizedIndexMap()});let it;rt("Reject Lexer.NA",()=>{it=reject(tt,yt=>yt[PATTERN]===Lexer.NA)});let nt=!1,st;rt("Transform Patterns",()=>{nt=!1,st=map(it,yt=>{const bt=yt[PATTERN];if(isRegExp$1(bt)){const xt=bt.source;return xt.length===1&&xt!=="^"&&xt!=="$"&&xt!=="."&&!bt.ignoreCase?xt:xt.length===2&&xt[0]==="\\"&&!includes(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],xt[1])?xt[1]:_e.useSticky?addStickyFlag(bt):addStartOfInput(bt)}else{if(isFunction$1(bt))return nt=!0,{exec:bt};if(typeof bt=="object")return nt=!0,bt;if(typeof bt=="string"){if(bt.length===1)return bt;{const xt=bt.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),vt=new RegExp(xt);return _e.useSticky?addStickyFlag(vt):addStartOfInput(vt)}}else throw Error("non exhaustive match")}})});let at,lt,ot,ct,ut;rt("misc mapping",()=>{at=map(it,yt=>yt.tokenTypeIdx),lt=map(it,yt=>{const bt=yt.GROUP;if(bt!==Lexer.SKIPPED){if(isString$1(bt))return bt;if(isUndefined(bt))return!1;throw Error("non exhaustive match")}}),ot=map(it,yt=>{const bt=yt.LONGER_ALT;if(bt)return isArray$1$1(bt)?map(bt,vt=>indexOf(it,vt)):[indexOf(it,bt)]}),ct=map(it,yt=>yt.PUSH_MODE),ut=map(it,yt=>has$1(yt,"POP_MODE"))});let ht;rt("Line Terminator Handling",()=>{const yt=getCharCodes(_e.lineTerminatorCharacters);ht=map(it,bt=>!1),_e.positionTracking!=="onlyOffset"&&(ht=map(it,bt=>has$1(bt,"LINE_BREAKS")?!!bt.LINE_BREAKS:checkLineBreaksIssues(bt,yt)===!1&&canMatchCharCode(yt,bt.PATTERN)))});let dt,pt,ft,gt;rt("Misc Mapping #2",()=>{dt=map(it,isCustomPattern),pt=map(st,isShortPattern),ft=reduce(it,(yt,bt)=>{const xt=bt.GROUP;return isString$1(xt)&&xt!==Lexer.SKIPPED&&(yt[xt]=[]),yt},{}),gt=map(st,(yt,bt)=>({pattern:st[bt],longerAlt:ot[bt],canLineTerminator:ht[bt],isCustom:dt[bt],short:pt[bt],group:lt[bt],push:ct[bt],pop:ut[bt],tokenTypeIdx:at[bt],tokenType:it[bt]}))});let mt=!0,At=[];return _e.safeMode||rt("First Char Optimization",()=>{At=reduce(it,(yt,bt,xt)=>{if(typeof bt.PATTERN=="string"){const vt=bt.PATTERN.charCodeAt(0),_t=charCodeToOptimizedIndex(vt);addToMapOfArrays(yt,_t,gt[xt])}else if(isArray$1$1(bt.START_CHARS_HINT)){let vt;forEach(bt.START_CHARS_HINT,_t=>{const Ct=typeof _t=="string"?_t.charCodeAt(0):_t,St=charCodeToOptimizedIndex(Ct);vt!==St&&(vt=St,addToMapOfArrays(yt,St,gt[xt]))})}else if(isRegExp$1(bt.PATTERN))if(bt.PATTERN.unicode)mt=!1,_e.ensureOptimizations&&PRINT_ERROR(`${failedOptimizationPrefixMsg}	Unable to analyze < ${bt.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const vt=getOptimizedStartCodesIndices(bt.PATTERN,_e.ensureOptimizations);isEmpty(vt)&&(mt=!1),forEach(vt,_t=>{addToMapOfArrays(yt,_t,gt[xt])})}else _e.ensureOptimizations&&PRINT_ERROR(`${failedOptimizationPrefixMsg}	TokenType: <${bt.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),mt=!1;return yt},[])}),{emptyGroups:ft,patternIdxToConfig:gt,charCodeToPatternIdxToConfig:At,hasCustom:nt,canBeOptimized:mt}}function validatePatterns(tt,_e){let rt=[];const it=findMissingPatterns(tt);rt=rt.concat(it.errors);const nt=findInvalidPatterns(it.valid),st=nt.valid;return rt=rt.concat(nt.errors),rt=rt.concat(validateRegExpPattern(st)),rt=rt.concat(findInvalidGroupType(st)),rt=rt.concat(findModesThatDoNotExist(st,_e)),rt=rt.concat(findUnreachablePatterns(st)),rt}function validateRegExpPattern(tt){let _e=[];const rt=filter(tt,it=>isRegExp$1(it[PATTERN]));return _e=_e.concat(findEndOfInputAnchor(rt)),_e=_e.concat(findStartOfInputAnchor(rt)),_e=_e.concat(findUnsupportedFlags(rt)),_e=_e.concat(findDuplicatePatterns(rt)),_e=_e.concat(findEmptyMatchRegExps(rt)),_e}function findMissingPatterns(tt){const _e=filter(tt,nt=>!has$1(nt,PATTERN)),rt=map(_e,nt=>({message:"Token Type: ->"+nt.name+"<- missing static 'PATTERN' property",type:LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[nt]})),it=difference$1(tt,_e);return{errors:rt,valid:it}}function findInvalidPatterns(tt){const _e=filter(tt,nt=>{const st=nt[PATTERN];return!isRegExp$1(st)&&!isFunction$1(st)&&!has$1(st,"exec")&&!isString$1(st)}),rt=map(_e,nt=>({message:"Token Type: ->"+nt.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[nt]})),it=difference$1(tt,_e);return{errors:rt,valid:it}}const end_of_input=/[^\\][$]/;function findEndOfInputAnchor(tt){class _e extends BaseRegExpVisitor{constructor(){super(...arguments),this.found=!1}visitEndAnchor(st){this.found=!0}}const rt=filter(tt,nt=>{const st=nt.PATTERN;try{const at=getRegExpAst(st),lt=new _e;return lt.visit(at),lt.found}catch{return end_of_input.test(st.source)}});return map(rt,nt=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+nt.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[nt]}))}function findEmptyMatchRegExps(tt){const _e=filter(tt,it=>it.PATTERN.test(""));return map(_e,it=>({message:"Token Type: ->"+it.name+"<- static 'PATTERN' must not match an empty string",type:LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[it]}))}const start_of_input=/[^\\[][\^]|^\^/;function findStartOfInputAnchor(tt){class _e extends BaseRegExpVisitor{constructor(){super(...arguments),this.found=!1}visitStartAnchor(st){this.found=!0}}const rt=filter(tt,nt=>{const st=nt.PATTERN;try{const at=getRegExpAst(st),lt=new _e;return lt.visit(at),lt.found}catch{return start_of_input.test(st.source)}});return map(rt,nt=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+nt.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[nt]}))}function findUnsupportedFlags(tt){const _e=filter(tt,it=>{const nt=it[PATTERN];return nt instanceof RegExp&&(nt.multiline||nt.global)});return map(_e,it=>({message:"Token Type: ->"+it.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[it]}))}function findDuplicatePatterns(tt){const _e=[];let rt=map(tt,st=>reduce(tt,(at,lt)=>(st.PATTERN.source===lt.PATTERN.source&&!includes(_e,lt)&&lt.PATTERN!==Lexer.NA&&(_e.push(lt),at.push(lt)),at),[]));rt=compact(rt);const it=filter(rt,st=>st.length>1);return map(it,st=>{const at=map(st,ot=>ot.name);return{message:`The same RegExp pattern ->${head(st).PATTERN}<-has been used in all of the following Token Types: ${at.join(", ")} <-`,type:LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:st}})}function findInvalidGroupType(tt){const _e=filter(tt,it=>{if(!has$1(it,"GROUP"))return!1;const nt=it.GROUP;return nt!==Lexer.SKIPPED&&nt!==Lexer.NA&&!isString$1(nt)});return map(_e,it=>({message:"Token Type: ->"+it.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[it]}))}function findModesThatDoNotExist(tt,_e){const rt=filter(tt,nt=>nt.PUSH_MODE!==void 0&&!includes(_e,nt.PUSH_MODE));return map(rt,nt=>({message:`Token Type: ->${nt.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${nt.PUSH_MODE}<-which does not exist`,type:LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[nt]}))}function findUnreachablePatterns(tt){const _e=[],rt=reduce(tt,(it,nt,st)=>{const at=nt.PATTERN;return at===Lexer.NA||(isString$1(at)?it.push({str:at,idx:st,tokenType:nt}):isRegExp$1(at)&&noMetaChar(at)&&it.push({str:at.source,idx:st,tokenType:nt})),it},[]);return forEach(tt,(it,nt)=>{forEach(rt,({str:st,idx:at,tokenType:lt})=>{if(nt<at&&testTokenType(st,it.PATTERN)){const ot=`Token: ->${lt.name}<- can never be matched.
Because it appears AFTER the Token Type ->${it.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;_e.push({message:ot,type:LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[it,lt]})}})}),_e}function testTokenType(tt,_e){if(isRegExp$1(_e)){const rt=_e.exec(tt);return rt!==null&&rt.index===0}else{if(isFunction$1(_e))return _e(tt,0,[],{});if(has$1(_e,"exec"))return _e.exec(tt,0,[],{});if(typeof _e=="string")return _e===tt;throw Error("non exhaustive match")}}function noMetaChar(tt){return find$1([".","\\","[","]","|","^","$","(",")","?","*","+","{"],rt=>tt.source.indexOf(rt)!==-1)===void 0}function addStartOfInput(tt){const _e=tt.ignoreCase?"i":"";return new RegExp(`^(?:${tt.source})`,_e)}function addStickyFlag(tt){const _e=tt.ignoreCase?"iy":"y";return new RegExp(`${tt.source}`,_e)}function performRuntimeChecks(tt,_e,rt){const it=[];return has$1(tt,DEFAULT_MODE)||it.push({message:"A MultiMode Lexer cannot be initialized without a <"+DEFAULT_MODE+`> property in its definition
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),has$1(tt,MODES)||it.push({message:"A MultiMode Lexer cannot be initialized without a <"+MODES+`> property in its definition
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),has$1(tt,MODES)&&has$1(tt,DEFAULT_MODE)&&!has$1(tt.modes,tt.defaultMode)&&it.push({message:`A MultiMode Lexer cannot be initialized with a ${DEFAULT_MODE}: <${tt.defaultMode}>which does not exist
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),has$1(tt,MODES)&&forEach(tt.modes,(nt,st)=>{forEach(nt,(at,lt)=>{if(isUndefined(at))it.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${st}> at index: <${lt}>
`,type:LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(has$1(at,"LONGER_ALT")){const ot=isArray$1$1(at.LONGER_ALT)?at.LONGER_ALT:[at.LONGER_ALT];forEach(ot,ct=>{!isUndefined(ct)&&!includes(nt,ct)&&it.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${ct.name}> on token <${at.name}> outside of mode <${st}>
`,type:LexerDefinitionErrorType.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),it}function performWarningRuntimeChecks(tt,_e,rt){const it=[];let nt=!1;const st=compact(flatten$1(values(tt.modes))),at=reject(st,ot=>ot[PATTERN]===Lexer.NA),lt=getCharCodes(rt);return _e&&forEach(at,ot=>{const ct=checkLineBreaksIssues(ot,lt);if(ct!==!1){const ht={message:buildLineBreakIssueMessage(ot,ct),type:ct.issue,tokenType:ot};it.push(ht)}else has$1(ot,"LINE_BREAKS")?ot.LINE_BREAKS===!0&&(nt=!0):canMatchCharCode(lt,ot.PATTERN)&&(nt=!0)}),_e&&!nt&&it.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),it}function cloneEmptyGroups(tt){const _e={},rt=keys$1(tt);return forEach(rt,it=>{const nt=tt[it];if(isArray$1$1(nt))_e[it]=[];else throw Error("non exhaustive match")}),_e}function isCustomPattern(tt){const _e=tt.PATTERN;if(isRegExp$1(_e))return!1;if(isFunction$1(_e))return!0;if(has$1(_e,"exec"))return!0;if(isString$1(_e))return!1;throw Error("non exhaustive match")}function isShortPattern(tt){return isString$1(tt)&&tt.length===1?tt.charCodeAt(0):!1}const LineTerminatorOptimizedTester={test:function(tt){const _e=tt.length;for(let rt=this.lastIndex;rt<_e;rt++){const it=tt.charCodeAt(rt);if(it===10)return this.lastIndex=rt+1,!0;if(it===13)return tt.charCodeAt(rt+1)===10?this.lastIndex=rt+2:this.lastIndex=rt+1,!0}return!1},lastIndex:0};function checkLineBreaksIssues(tt,_e){if(has$1(tt,"LINE_BREAKS"))return!1;if(isRegExp$1(tt.PATTERN)){try{canMatchCharCode(_e,tt.PATTERN)}catch(rt){return{issue:LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:rt.message}}return!1}else{if(isString$1(tt.PATTERN))return!1;if(isCustomPattern(tt))return{issue:LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function buildLineBreakIssueMessage(tt,_e){if(_e.issue===LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${tt.name}> Token Type
	 Root cause: ${_e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(_e.issue===LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${tt.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function getCharCodes(tt){return map(tt,rt=>isString$1(rt)?rt.charCodeAt(0):rt)}function addToMapOfArrays(tt,_e,rt){tt[_e]===void 0?tt[_e]=[rt]:tt[_e].push(rt)}const minOptimizationVal=256;let charCodeToOptimizedIdxMap=[];function charCodeToOptimizedIndex(tt){return tt<minOptimizationVal?tt:charCodeToOptimizedIdxMap[tt]}function initCharCodeToOptimizedIndexMap(){if(isEmpty(charCodeToOptimizedIdxMap)){charCodeToOptimizedIdxMap=new Array(65536);for(let tt=0;tt<65536;tt++)charCodeToOptimizedIdxMap[tt]=tt>255?255+~~(tt/255):tt}}function tokenStructuredMatcher(tt,_e){const rt=tt.tokenTypeIdx;return rt===_e.tokenTypeIdx?!0:_e.isParent===!0&&_e.categoryMatchesMap[rt]===!0}function tokenStructuredMatcherNoCategories(tt,_e){return tt.tokenTypeIdx===_e.tokenTypeIdx}let tokenShortNameIdx=1;const tokenIdxToClass={};function augmentTokenTypes(tt){const _e=expandCategories(tt);assignTokenDefaultProps(_e),assignCategoriesMapProp(_e),assignCategoriesTokensProp(_e),forEach(_e,rt=>{rt.isParent=rt.categoryMatches.length>0})}function expandCategories(tt){let _e=clone(tt),rt=tt,it=!0;for(;it;){rt=compact(flatten$1(map(rt,st=>st.CATEGORIES)));const nt=difference$1(rt,_e);_e=_e.concat(nt),isEmpty(nt)?it=!1:rt=nt}return _e}function assignTokenDefaultProps(tt){forEach(tt,_e=>{hasShortKeyProperty(_e)||(tokenIdxToClass[tokenShortNameIdx]=_e,_e.tokenTypeIdx=tokenShortNameIdx++),hasCategoriesProperty(_e)&&!isArray$1$1(_e.CATEGORIES)&&(_e.CATEGORIES=[_e.CATEGORIES]),hasCategoriesProperty(_e)||(_e.CATEGORIES=[]),hasExtendingTokensTypesProperty(_e)||(_e.categoryMatches=[]),hasExtendingTokensTypesMapProperty(_e)||(_e.categoryMatchesMap={})})}function assignCategoriesTokensProp(tt){forEach(tt,_e=>{_e.categoryMatches=[],forEach(_e.categoryMatchesMap,(rt,it)=>{_e.categoryMatches.push(tokenIdxToClass[it].tokenTypeIdx)})})}function assignCategoriesMapProp(tt){forEach(tt,_e=>{singleAssignCategoriesToksMap([],_e)})}function singleAssignCategoriesToksMap(tt,_e){forEach(tt,rt=>{_e.categoryMatchesMap[rt.tokenTypeIdx]=!0}),forEach(_e.CATEGORIES,rt=>{const it=tt.concat(_e);includes(it,rt)||singleAssignCategoriesToksMap(it,rt)})}function hasShortKeyProperty(tt){return has$1(tt,"tokenTypeIdx")}function hasCategoriesProperty(tt){return has$1(tt,"CATEGORIES")}function hasExtendingTokensTypesProperty(tt){return has$1(tt,"categoryMatches")}function hasExtendingTokensTypesMapProperty(tt){return has$1(tt,"categoryMatchesMap")}function isTokenType(tt){return has$1(tt,"tokenTypeIdx")}const defaultLexerErrorProvider={buildUnableToPopLexerModeMessage(tt){return`Unable to pop Lexer Mode after encountering Token ->${tt.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(tt,_e,rt,it,nt){return`unexpected character: ->${tt.charAt(_e)}<- at offset: ${_e}, skipped ${rt} characters.`}};var LexerDefinitionErrorType;(function(tt){tt[tt.MISSING_PATTERN=0]="MISSING_PATTERN",tt[tt.INVALID_PATTERN=1]="INVALID_PATTERN",tt[tt.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",tt[tt.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",tt[tt.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",tt[tt.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",tt[tt.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",tt[tt.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",tt[tt.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",tt[tt.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",tt[tt.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",tt[tt.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",tt[tt.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",tt[tt.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",tt[tt.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",tt[tt.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",tt[tt.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",tt[tt.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(LexerDefinitionErrorType||(LexerDefinitionErrorType={}));const DEFAULT_LEXER_CONFIG={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(DEFAULT_LEXER_CONFIG);class Lexer{constructor(_e,rt=DEFAULT_LEXER_CONFIG){if(this.lexerDefinition=_e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(nt,st)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const at=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${at}--> <${nt}>`);const{time:lt,value:ot}=timer$1(st),ct=lt>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&ct(`${at}<-- <${nt}> time: ${lt}ms`),this.traceInitIndent--,ot}else return st()},typeof rt=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=assign$1$1({},DEFAULT_LEXER_CONFIG,rt);const it=this.config.traceInitPerf;it===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof it=="number"&&(this.traceInitMaxIdent=it,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let nt,st=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===DEFAULT_LEXER_CONFIG.lineTerminatorsPattern)this.config.lineTerminatorsPattern=LineTerminatorOptimizedTester;else if(this.config.lineTerminatorCharacters===DEFAULT_LEXER_CONFIG.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(rt.safeMode&&rt.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),isArray$1$1(_e)?nt={modes:{defaultMode:clone(_e)},defaultMode:DEFAULT_MODE}:(st=!1,nt=clone(_e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(performRuntimeChecks(nt,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(performWarningRuntimeChecks(nt,this.trackStartLines,this.config.lineTerminatorCharacters))})),nt.modes=nt.modes?nt.modes:{},forEach(nt.modes,(lt,ot)=>{nt.modes[ot]=reject(lt,ct=>isUndefined(ct))});const at=keys$1(nt.modes);if(forEach(nt.modes,(lt,ot)=>{this.TRACE_INIT(`Mode: <${ot}> processing`,()=>{if(this.modes.push(ot),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(validatePatterns(lt,at))}),isEmpty(this.lexerDefinitionErrors)){augmentTokenTypes(lt);let ct;this.TRACE_INIT("analyzeTokenTypes",()=>{ct=analyzeTokenTypes(lt,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:rt.positionTracking,ensureOptimizations:rt.ensureOptimizations,safeMode:rt.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[ot]=ct.patternIdxToConfig,this.charCodeToPatternIdxToConfig[ot]=ct.charCodeToPatternIdxToConfig,this.emptyGroups=assign$1$1({},this.emptyGroups,ct.emptyGroups),this.hasCustom=ct.hasCustom||this.hasCustom,this.canModeBeOptimized[ot]=ct.canBeOptimized}})}),this.defaultMode=nt.defaultMode,!isEmpty(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const ot=map(this.lexerDefinitionErrors,ct=>ct.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+ot)}forEach(this.lexerDefinitionWarning,lt=>{PRINT_WARNING(lt.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(SUPPORT_STICKY?(this.chopInput=identity$2,this.match=this.matchWithTest):(this.updateLastIndex=noop$2,this.match=this.matchWithExec),st&&(this.handleModes=noop$2),this.trackStartLines===!1&&(this.computeNewColumn=identity$2),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=noop$2),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const lt=reduce(this.canModeBeOptimized,(ot,ct,ut)=>(ct===!1&&ot.push(ut),ot),[]);if(rt.ensureOptimizations&&!isEmpty(lt))throw Error(`Lexer Modes: < ${lt.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{clearRegExpParserCache()}),this.TRACE_INIT("toFastProperties",()=>{toFastProperties(this)})})}tokenize(_e,rt=this.defaultMode){if(!isEmpty(this.lexerDefinitionErrors)){const nt=map(this.lexerDefinitionErrors,st=>st.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+nt)}return this.tokenizeInternal(_e,rt)}tokenizeInternal(_e,rt){let it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At;const yt=_e,bt=yt.length;let xt=0,vt=0;const _t=this.hasCustom?0:Math.floor(_e.length/10),Ct=new Array(_t),St=[];let Et=this.trackStartLines?1:void 0,Tt=this.trackStartLines?1:void 0;const Mt=cloneEmptyGroups(this.emptyGroups),Rt=this.trackStartLines,It=this.config.lineTerminatorsPattern;let Ot=0,Bt=[],Nt=[];const zt=[],Dt=[];Object.freeze(Dt);let Ft;function Ut(){return Bt}function $t(er){const ir=charCodeToOptimizedIndex(er),ur=Nt[ir];return ur===void 0?Dt:ur}const Vt=er=>{if(zt.length===1&&er.tokenType.PUSH_MODE===void 0){const ir=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(er);St.push({offset:er.startOffset,line:er.startLine,column:er.startColumn,length:er.image.length,message:ir})}else{zt.pop();const ir=last(zt);Bt=this.patternIdxToConfig[ir],Nt=this.charCodeToPatternIdxToConfig[ir],Ot=Bt.length;const ur=this.canModeBeOptimized[ir]&&this.config.safeMode===!1;Nt&&ur?Ft=$t:Ft=Ut}};function Zt(er){zt.push(er),Nt=this.charCodeToPatternIdxToConfig[er],Bt=this.patternIdxToConfig[er],Ot=Bt.length,Ot=Bt.length;const ir=this.canModeBeOptimized[er]&&this.config.safeMode===!1;Nt&&ir?Ft=$t:Ft=Ut}Zt.call(this,rt);let qt;const sr=this.config.recoveryEnabled;for(;xt<bt;){ot=null;const er=yt.charCodeAt(xt),ir=Ft(er),ur=ir.length;for(it=0;it<ur;it++){qt=ir[it];const ar=qt.pattern;ct=null;const lr=qt.short;if(lr!==!1?er===lr&&(ot=ar):qt.isCustom===!0?(At=ar.exec(yt,xt,Ct,Mt),At!==null?(ot=At[0],At.payload!==void 0&&(ct=At.payload)):ot=null):(this.updateLastIndex(ar,xt),ot=this.match(ar,_e,xt)),ot!==null){if(lt=qt.longerAlt,lt!==void 0){const gr=lt.length;for(st=0;st<gr;st++){const Yt=Bt[lt[st]],nr=Yt.pattern;if(ut=null,Yt.isCustom===!0?(At=nr.exec(yt,xt,Ct,Mt),At!==null?(at=At[0],At.payload!==void 0&&(ut=At.payload)):at=null):(this.updateLastIndex(nr,xt),at=this.match(nr,_e,xt)),at&&at.length>ot.length){ot=at,ct=ut,qt=Yt;break}}}break}}if(ot!==null){if(ht=ot.length,dt=qt.group,dt!==void 0&&(pt=qt.tokenTypeIdx,ft=this.createTokenInstance(ot,xt,pt,qt.tokenType,Et,Tt,ht),this.handlePayload(ft,ct),dt===!1?vt=this.addToken(Ct,vt,ft):Mt[dt].push(ft)),_e=this.chopInput(_e,ht),xt=xt+ht,Tt=this.computeNewColumn(Tt,ht),Rt===!0&&qt.canLineTerminator===!0){let ar=0,lr,gr;It.lastIndex=0;do lr=It.test(ot),lr===!0&&(gr=It.lastIndex-1,ar++);while(lr===!0);ar!==0&&(Et=Et+ar,Tt=ht-gr,this.updateTokenEndLineColumnLocation(ft,dt,gr,ar,Et,Tt,ht))}this.handleModes(qt,Vt,Zt,ft)}else{const ar=xt,lr=Et,gr=Tt;let Yt=sr===!1;for(;Yt===!1&&xt<bt;)for(_e=this.chopInput(_e,1),xt++,nt=0;nt<Ot;nt++){const nr=Bt[nt],mr=nr.pattern,Sr=nr.short;if(Sr!==!1?yt.charCodeAt(xt)===Sr&&(Yt=!0):nr.isCustom===!0?Yt=mr.exec(yt,xt,Ct,Mt)!==null:(this.updateLastIndex(mr,xt),Yt=mr.exec(_e)!==null),Yt===!0)break}if(gt=xt-ar,Tt=this.computeNewColumn(Tt,gt),mt=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(yt,ar,gt,lr,gr),St.push({offset:ar,line:lr,column:gr,length:gt,message:mt}),sr===!1)break}}return this.hasCustom||(Ct.length=vt),{tokens:Ct,groups:Mt,errors:St}}handleModes(_e,rt,it,nt){if(_e.pop===!0){const st=_e.push;rt(nt),st!==void 0&&it.call(this,st)}else _e.push!==void 0&&it.call(this,_e.push)}chopInput(_e,rt){return _e.substring(rt)}updateLastIndex(_e,rt){_e.lastIndex=rt}updateTokenEndLineColumnLocation(_e,rt,it,nt,st,at,lt){let ot,ct;rt!==void 0&&(ot=it===lt-1,ct=ot?-1:0,nt===1&&ot===!0||(_e.endLine=st+ct,_e.endColumn=at-1+-ct))}computeNewColumn(_e,rt){return _e+rt}createOffsetOnlyToken(_e,rt,it,nt){return{image:_e,startOffset:rt,tokenTypeIdx:it,tokenType:nt}}createStartOnlyToken(_e,rt,it,nt,st,at){return{image:_e,startOffset:rt,startLine:st,startColumn:at,tokenTypeIdx:it,tokenType:nt}}createFullToken(_e,rt,it,nt,st,at,lt){return{image:_e,startOffset:rt,endOffset:rt+lt-1,startLine:st,endLine:st,startColumn:at,endColumn:at+lt-1,tokenTypeIdx:it,tokenType:nt}}addTokenUsingPush(_e,rt,it){return _e.push(it),rt}addTokenUsingMemberAccess(_e,rt,it){return _e[rt]=it,rt++,rt}handlePayloadNoCustom(_e,rt){}handlePayloadWithCustom(_e,rt){rt!==null&&(_e.payload=rt)}matchWithTest(_e,rt,it){return _e.test(rt)===!0?rt.substring(it,_e.lastIndex):null}matchWithExec(_e,rt){const it=_e.exec(rt);return it!==null?it[0]:null}}Lexer.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Lexer.NA=/NOT_APPLICABLE/;function tokenLabel(tt){return hasTokenLabel(tt)?tt.LABEL:tt.name}function hasTokenLabel(tt){return isString$1(tt.LABEL)&&tt.LABEL!==""}const PARENT="parent",CATEGORIES="categories",LABEL="label",GROUP="group",PUSH_MODE="push_mode",POP_MODE="pop_mode",LONGER_ALT="longer_alt",LINE_BREAKS="line_breaks",START_CHARS_HINT="start_chars_hint";function createToken(tt){return createTokenInternal(tt)}function createTokenInternal(tt){const _e=tt.pattern,rt={};if(rt.name=tt.name,isUndefined(_e)||(rt.PATTERN=_e),has$1(tt,PARENT))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return has$1(tt,CATEGORIES)&&(rt.CATEGORIES=tt[CATEGORIES]),augmentTokenTypes([rt]),has$1(tt,LABEL)&&(rt.LABEL=tt[LABEL]),has$1(tt,GROUP)&&(rt.GROUP=tt[GROUP]),has$1(tt,POP_MODE)&&(rt.POP_MODE=tt[POP_MODE]),has$1(tt,PUSH_MODE)&&(rt.PUSH_MODE=tt[PUSH_MODE]),has$1(tt,LONGER_ALT)&&(rt.LONGER_ALT=tt[LONGER_ALT]),has$1(tt,LINE_BREAKS)&&(rt.LINE_BREAKS=tt[LINE_BREAKS]),has$1(tt,START_CHARS_HINT)&&(rt.START_CHARS_HINT=tt[START_CHARS_HINT]),rt}const EOF=createToken({name:"EOF",pattern:Lexer.NA});augmentTokenTypes([EOF]);function createTokenInstance(tt,_e,rt,it,nt,st,at,lt){return{image:_e,startOffset:rt,endOffset:it,startLine:nt,endLine:st,startColumn:at,endColumn:lt,tokenTypeIdx:tt.tokenTypeIdx,tokenType:tt}}function tokenMatcher(tt,_e){return tokenStructuredMatcher(tt,_e)}const defaultParserErrorProvider={buildMismatchTokenMessage({expected:tt,actual:_e,previous:rt,ruleName:it}){return`Expecting ${hasTokenLabel(tt)?`--> ${tokenLabel(tt)} <--`:`token of type --> ${tt.name} <--`} but found --> '${_e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:tt,ruleName:_e}){return"Redundant input, expecting EOF but found: "+tt.image},buildNoViableAltMessage({expectedPathsPerAlt:tt,actual:_e,previous:rt,customUserDescription:it,ruleName:nt}){const st="Expecting: ",lt=`
but found: '`+head(_e).image+"'";if(it)return st+it+lt;{const ot=reduce(tt,(dt,pt)=>dt.concat(pt),[]),ct=map(ot,dt=>`[${map(dt,pt=>tokenLabel(pt)).join(", ")}]`),ht=`one of these possible Token sequences:
${map(ct,(dt,pt)=>`  ${pt+1}. ${dt}`).join(`
`)}`;return st+ht+lt}},buildEarlyExitMessage({expectedIterationPaths:tt,actual:_e,customUserDescription:rt,ruleName:it}){const nt="Expecting: ",at=`
but found: '`+head(_e).image+"'";if(rt)return nt+rt+at;{const ot=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${map(tt,ct=>`[${map(ct,ut=>tokenLabel(ut)).join(",")}]`).join(" ,")}>`;return nt+ot+at}}};Object.freeze(defaultParserErrorProvider);const defaultGrammarResolverErrorProvider={buildRuleNotFoundError(tt,_e){return"Invalid grammar, reference to a rule which is not defined: ->"+_e.nonTerminalName+`<-
inside top level rule: ->`+tt.name+"<-"}},defaultGrammarValidatorErrorProvider={buildDuplicateFoundError(tt,_e){function rt(ut){return ut instanceof Terminal?ut.terminalType.name:ut instanceof NonTerminal?ut.nonTerminalName:""}const it=tt.name,nt=head(_e),st=nt.idx,at=getProductionDslName(nt),lt=rt(nt),ot=st>0;let ct=`->${at}${ot?st:""}<- ${lt?`with argument: ->${lt}<-`:""}
                  appears more than once (${_e.length} times) in the top level rule: ->${it}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return ct=ct.replace(/[ \t]+/g," "),ct=ct.replace(/\s\s+/g,`
`),ct},buildNamespaceConflictError(tt){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${tt.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(tt){const _e=map(tt.prefixPath,nt=>tokenLabel(nt)).join(", "),rt=tt.alternation.idx===0?"":tt.alternation.idx;return`Ambiguous alternatives: <${tt.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${rt}> inside <${tt.topLevelRule.name}> Rule,
<${_e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(tt){const _e=map(tt.prefixPath,nt=>tokenLabel(nt)).join(", "),rt=tt.alternation.idx===0?"":tt.alternation.idx;let it=`Ambiguous Alternatives Detected: <${tt.ambiguityIndices.join(" ,")}> in <OR${rt}> inside <${tt.topLevelRule.name}> Rule,
<${_e}> may appears as a prefix path in all these alternatives.
`;return it=it+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,it},buildEmptyRepetitionError(tt){let _e=getProductionDslName(tt.repetition);return tt.repetition.idx!==0&&(_e+=tt.repetition.idx),`The repetition <${_e}> within Rule <${tt.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(tt){return"deprecated"},buildEmptyAlternationError(tt){return`Ambiguous empty alternative: <${tt.emptyChoiceIdx+1}> in <OR${tt.alternation.idx}> inside <${tt.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(tt){return`An Alternation cannot have more than 256 alternatives:
<OR${tt.alternation.idx}> inside <${tt.topLevelRule.name}> Rule.
 has ${tt.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(tt){const _e=tt.topLevelRule.name,rt=map(tt.leftRecursionPath,st=>st.name),it=`${_e} --> ${rt.concat([_e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${_e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${it}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(tt){return"deprecated"},buildDuplicateRuleNameError(tt){let _e;return tt.topLevelRule instanceof Rule$1?_e=tt.topLevelRule.name:_e=tt.topLevelRule,`Duplicate definition, rule: ->${_e}<- is already defined in the grammar: ->${tt.grammarName}<-`}};function resolveGrammar$1(tt,_e){const rt=new GastRefResolverVisitor(tt,_e);return rt.resolveRefs(),rt.errors}class GastRefResolverVisitor extends GAstVisitor{constructor(_e,rt){super(),this.nameToTopRule=_e,this.errMsgProvider=rt,this.errors=[]}resolveRefs(){forEach(values(this.nameToTopRule),_e=>{this.currTopLevel=_e,_e.accept(this)})}visitNonTerminal(_e){const rt=this.nameToTopRule[_e.nonTerminalName];if(rt)_e.referencedRule=rt;else{const it=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,_e);this.errors.push({message:it,type:ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:_e.nonTerminalName})}}}class AbstractNextPossibleTokensWalker extends RestWalker{constructor(_e,rt){super(),this.topProd=_e,this.path=rt,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=clone(this.path.ruleStack).reverse(),this.occurrenceStack=clone(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(_e,rt=[]){this.found||super.walk(_e,rt)}walkProdRef(_e,rt,it){if(_e.referencedRule.name===this.nextProductionName&&_e.idx===this.nextProductionOccurrence){const nt=rt.concat(it);this.updateExpectedNext(),this.walk(_e.referencedRule,nt)}}updateExpectedNext(){isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class NextAfterTokenWalker extends AbstractNextPossibleTokensWalker{constructor(_e,rt){super(_e,rt),this.path=rt,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(_e,rt,it){if(this.isAtEndOfPath&&_e.terminalType.name===this.nextTerminalName&&_e.idx===this.nextTerminalOccurrence&&!this.found){const nt=rt.concat(it),st=new Alternative({definition:nt});this.possibleTokTypes=first$1(st),this.found=!0}}}class AbstractNextTerminalAfterProductionWalker extends RestWalker{constructor(_e,rt){super(),this.topRule=_e,this.occurrence=rt,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class NextTerminalAfterManyWalker extends AbstractNextTerminalAfterProductionWalker{walkMany(_e,rt,it){if(_e.idx===this.occurrence){const nt=head(rt.concat(it));this.result.isEndOfRule=nt===void 0,nt instanceof Terminal&&(this.result.token=nt.terminalType,this.result.occurrence=nt.idx)}else super.walkMany(_e,rt,it)}}class NextTerminalAfterManySepWalker extends AbstractNextTerminalAfterProductionWalker{walkManySep(_e,rt,it){if(_e.idx===this.occurrence){const nt=head(rt.concat(it));this.result.isEndOfRule=nt===void 0,nt instanceof Terminal&&(this.result.token=nt.terminalType,this.result.occurrence=nt.idx)}else super.walkManySep(_e,rt,it)}}class NextTerminalAfterAtLeastOneWalker extends AbstractNextTerminalAfterProductionWalker{walkAtLeastOne(_e,rt,it){if(_e.idx===this.occurrence){const nt=head(rt.concat(it));this.result.isEndOfRule=nt===void 0,nt instanceof Terminal&&(this.result.token=nt.terminalType,this.result.occurrence=nt.idx)}else super.walkAtLeastOne(_e,rt,it)}}class NextTerminalAfterAtLeastOneSepWalker extends AbstractNextTerminalAfterProductionWalker{walkAtLeastOneSep(_e,rt,it){if(_e.idx===this.occurrence){const nt=head(rt.concat(it));this.result.isEndOfRule=nt===void 0,nt instanceof Terminal&&(this.result.token=nt.terminalType,this.result.occurrence=nt.idx)}else super.walkAtLeastOneSep(_e,rt,it)}}function possiblePathsFrom(tt,_e,rt=[]){rt=clone(rt);let it=[],nt=0;function st(lt){return lt.concat(drop(tt,nt+1))}function at(lt){const ot=possiblePathsFrom(st(lt),_e,rt);return it.concat(ot)}for(;rt.length<_e&&nt<tt.length;){const lt=tt[nt];if(lt instanceof Alternative)return at(lt.definition);if(lt instanceof NonTerminal)return at(lt.definition);if(lt instanceof Option)it=at(lt.definition);else if(lt instanceof RepetitionMandatory){const ot=lt.definition.concat([new Repetition({definition:lt.definition})]);return at(ot)}else if(lt instanceof RepetitionMandatoryWithSeparator){const ot=[new Alternative({definition:lt.definition}),new Repetition({definition:[new Terminal({terminalType:lt.separator})].concat(lt.definition)})];return at(ot)}else if(lt instanceof RepetitionWithSeparator){const ot=lt.definition.concat([new Repetition({definition:[new Terminal({terminalType:lt.separator})].concat(lt.definition)})]);it=at(ot)}else if(lt instanceof Repetition){const ot=lt.definition.concat([new Repetition({definition:lt.definition})]);it=at(ot)}else{if(lt instanceof Alternation)return forEach(lt.definition,ot=>{isEmpty(ot.definition)===!1&&(it=at(ot.definition))}),it;if(lt instanceof Terminal)rt.push(lt.terminalType);else throw Error("non exhaustive match")}nt++}return it.push({partialPath:rt,suffixDef:drop(tt,nt)}),it}function nextPossibleTokensAfter(tt,_e,rt,it){const nt="EXIT_NONE_TERMINAL",st=[nt],at="EXIT_ALTERNATIVE";let lt=!1;const ot=_e.length,ct=ot-it-1,ut=[],ht=[];for(ht.push({idx:-1,def:tt,ruleStack:[],occurrenceStack:[]});!isEmpty(ht);){const dt=ht.pop();if(dt===at){lt&&last(ht).idx<=ct&&ht.pop();continue}const pt=dt.def,ft=dt.idx,gt=dt.ruleStack,mt=dt.occurrenceStack;if(isEmpty(pt))continue;const At=pt[0];if(At===nt){const yt={idx:ft,def:drop(pt),ruleStack:dropRight(gt),occurrenceStack:dropRight(mt)};ht.push(yt)}else if(At instanceof Terminal)if(ft<ot-1){const yt=ft+1,bt=_e[yt];if(rt(bt,At.terminalType)){const xt={idx:yt,def:drop(pt),ruleStack:gt,occurrenceStack:mt};ht.push(xt)}}else if(ft===ot-1)ut.push({nextTokenType:At.terminalType,nextTokenOccurrence:At.idx,ruleStack:gt,occurrenceStack:mt}),lt=!0;else throw Error("non exhaustive match");else if(At instanceof NonTerminal){const yt=clone(gt);yt.push(At.nonTerminalName);const bt=clone(mt);bt.push(At.idx);const xt={idx:ft,def:At.definition.concat(st,drop(pt)),ruleStack:yt,occurrenceStack:bt};ht.push(xt)}else if(At instanceof Option){const yt={idx:ft,def:drop(pt),ruleStack:gt,occurrenceStack:mt};ht.push(yt),ht.push(at);const bt={idx:ft,def:At.definition.concat(drop(pt)),ruleStack:gt,occurrenceStack:mt};ht.push(bt)}else if(At instanceof RepetitionMandatory){const yt=new Repetition({definition:At.definition,idx:At.idx}),bt=At.definition.concat([yt],drop(pt)),xt={idx:ft,def:bt,ruleStack:gt,occurrenceStack:mt};ht.push(xt)}else if(At instanceof RepetitionMandatoryWithSeparator){const yt=new Terminal({terminalType:At.separator}),bt=new Repetition({definition:[yt].concat(At.definition),idx:At.idx}),xt=At.definition.concat([bt],drop(pt)),vt={idx:ft,def:xt,ruleStack:gt,occurrenceStack:mt};ht.push(vt)}else if(At instanceof RepetitionWithSeparator){const yt={idx:ft,def:drop(pt),ruleStack:gt,occurrenceStack:mt};ht.push(yt),ht.push(at);const bt=new Terminal({terminalType:At.separator}),xt=new Repetition({definition:[bt].concat(At.definition),idx:At.idx}),vt=At.definition.concat([xt],drop(pt)),_t={idx:ft,def:vt,ruleStack:gt,occurrenceStack:mt};ht.push(_t)}else if(At instanceof Repetition){const yt={idx:ft,def:drop(pt),ruleStack:gt,occurrenceStack:mt};ht.push(yt),ht.push(at);const bt=new Repetition({definition:At.definition,idx:At.idx}),xt=At.definition.concat([bt],drop(pt)),vt={idx:ft,def:xt,ruleStack:gt,occurrenceStack:mt};ht.push(vt)}else if(At instanceof Alternation)for(let yt=At.definition.length-1;yt>=0;yt--){const bt=At.definition[yt],xt={idx:ft,def:bt.definition.concat(drop(pt)),ruleStack:gt,occurrenceStack:mt};ht.push(xt),ht.push(at)}else if(At instanceof Alternative)ht.push({idx:ft,def:At.definition.concat(drop(pt)),ruleStack:gt,occurrenceStack:mt});else if(At instanceof Rule$1)ht.push(expandTopLevelRule(At,ft,gt,mt));else throw Error("non exhaustive match")}return ut}function expandTopLevelRule(tt,_e,rt,it){const nt=clone(rt);nt.push(tt.name);const st=clone(it);return st.push(1),{idx:_e,def:tt.definition,ruleStack:nt,occurrenceStack:st}}var PROD_TYPE;(function(tt){tt[tt.OPTION=0]="OPTION",tt[tt.REPETITION=1]="REPETITION",tt[tt.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",tt[tt.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",tt[tt.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",tt[tt.ALTERNATION=5]="ALTERNATION"})(PROD_TYPE||(PROD_TYPE={}));function getProdType(tt){if(tt instanceof Option||tt==="Option")return PROD_TYPE.OPTION;if(tt instanceof Repetition||tt==="Repetition")return PROD_TYPE.REPETITION;if(tt instanceof RepetitionMandatory||tt==="RepetitionMandatory")return PROD_TYPE.REPETITION_MANDATORY;if(tt instanceof RepetitionMandatoryWithSeparator||tt==="RepetitionMandatoryWithSeparator")return PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR;if(tt instanceof RepetitionWithSeparator||tt==="RepetitionWithSeparator")return PROD_TYPE.REPETITION_WITH_SEPARATOR;if(tt instanceof Alternation||tt==="Alternation")return PROD_TYPE.ALTERNATION;throw Error("non exhaustive match")}function buildLookaheadFuncForOr(tt,_e,rt,it,nt,st){const at=getLookaheadPathsForOr(tt,_e,rt),lt=areTokenCategoriesNotUsed(at)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return st(at,it,lt,nt)}function buildLookaheadFuncForOptionalProd(tt,_e,rt,it,nt,st){const at=getLookaheadPathsForOptionalProd(tt,_e,nt,rt),lt=areTokenCategoriesNotUsed(at)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return st(at[0],lt,it)}function buildAlternativesLookAheadFunc(tt,_e,rt,it){const nt=tt.length,st=every(tt,at=>every(at,lt=>lt.length===1));if(_e)return function(at){const lt=map(at,ot=>ot.GATE);for(let ot=0;ot<nt;ot++){const ct=tt[ot],ut=ct.length,ht=lt[ot];if(!(ht!==void 0&&ht.call(this)===!1))e:for(let dt=0;dt<ut;dt++){const pt=ct[dt],ft=pt.length;for(let gt=0;gt<ft;gt++){const mt=this.LA(gt+1);if(rt(mt,pt[gt])===!1)continue e}return ot}}};if(st&&!it){const at=map(tt,ot=>flatten$1(ot)),lt=reduce(at,(ot,ct,ut)=>(forEach(ct,ht=>{has$1(ot,ht.tokenTypeIdx)||(ot[ht.tokenTypeIdx]=ut),forEach(ht.categoryMatches,dt=>{has$1(ot,dt)||(ot[dt]=ut)})}),ot),{});return function(){const ot=this.LA(1);return lt[ot.tokenTypeIdx]}}else return function(){for(let at=0;at<nt;at++){const lt=tt[at],ot=lt.length;e:for(let ct=0;ct<ot;ct++){const ut=lt[ct],ht=ut.length;for(let dt=0;dt<ht;dt++){const pt=this.LA(dt+1);if(rt(pt,ut[dt])===!1)continue e}return at}}}}function buildSingleAlternativeLookaheadFunction(tt,_e,rt){const it=every(tt,st=>st.length===1),nt=tt.length;if(it&&!rt){const st=flatten$1(tt);if(st.length===1&&isEmpty(st[0].categoryMatches)){const lt=st[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===lt}}else{const at=reduce(st,(lt,ot,ct)=>(lt[ot.tokenTypeIdx]=!0,forEach(ot.categoryMatches,ut=>{lt[ut]=!0}),lt),[]);return function(){const lt=this.LA(1);return at[lt.tokenTypeIdx]===!0}}}else return function(){e:for(let st=0;st<nt;st++){const at=tt[st],lt=at.length;for(let ot=0;ot<lt;ot++){const ct=this.LA(ot+1);if(_e(ct,at[ot])===!1)continue e}return!0}return!1}}class RestDefinitionFinderWalker extends RestWalker{constructor(_e,rt,it){super(),this.topProd=_e,this.targetOccurrence=rt,this.targetProdType=it}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(_e,rt,it,nt){return _e.idx===this.targetOccurrence&&this.targetProdType===rt?(this.restDef=it.concat(nt),!0):!1}walkOption(_e,rt,it){this.checkIsTarget(_e,PROD_TYPE.OPTION,rt,it)||super.walkOption(_e,rt,it)}walkAtLeastOne(_e,rt,it){this.checkIsTarget(_e,PROD_TYPE.REPETITION_MANDATORY,rt,it)||super.walkOption(_e,rt,it)}walkAtLeastOneSep(_e,rt,it){this.checkIsTarget(_e,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,rt,it)||super.walkOption(_e,rt,it)}walkMany(_e,rt,it){this.checkIsTarget(_e,PROD_TYPE.REPETITION,rt,it)||super.walkOption(_e,rt,it)}walkManySep(_e,rt,it){this.checkIsTarget(_e,PROD_TYPE.REPETITION_WITH_SEPARATOR,rt,it)||super.walkOption(_e,rt,it)}}class InsideDefinitionFinderVisitor extends GAstVisitor{constructor(_e,rt,it){super(),this.targetOccurrence=_e,this.targetProdType=rt,this.targetRef=it,this.result=[]}checkIsTarget(_e,rt){_e.idx===this.targetOccurrence&&this.targetProdType===rt&&(this.targetRef===void 0||_e===this.targetRef)&&(this.result=_e.definition)}visitOption(_e){this.checkIsTarget(_e,PROD_TYPE.OPTION)}visitRepetition(_e){this.checkIsTarget(_e,PROD_TYPE.REPETITION)}visitRepetitionMandatory(_e){this.checkIsTarget(_e,PROD_TYPE.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(_e){this.checkIsTarget(_e,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(_e){this.checkIsTarget(_e,PROD_TYPE.REPETITION_WITH_SEPARATOR)}visitAlternation(_e){this.checkIsTarget(_e,PROD_TYPE.ALTERNATION)}}function initializeArrayOfArrays(tt){const _e=new Array(tt);for(let rt=0;rt<tt;rt++)_e[rt]=[];return _e}function pathToHashKeys(tt){let _e=[""];for(let rt=0;rt<tt.length;rt++){const it=tt[rt],nt=[];for(let st=0;st<_e.length;st++){const at=_e[st];nt.push(at+"_"+it.tokenTypeIdx);for(let lt=0;lt<it.categoryMatches.length;lt++){const ot="_"+it.categoryMatches[lt];nt.push(at+ot)}}_e=nt}return _e}function isUniquePrefixHash(tt,_e,rt){for(let it=0;it<tt.length;it++){if(it===rt)continue;const nt=tt[it];for(let st=0;st<_e.length;st++){const at=_e[st];if(nt[at]===!0)return!1}}return!0}function lookAheadSequenceFromAlternatives(tt,_e){const rt=map(tt,at=>possiblePathsFrom([at],1)),it=initializeArrayOfArrays(rt.length),nt=map(rt,at=>{const lt={};return forEach(at,ot=>{const ct=pathToHashKeys(ot.partialPath);forEach(ct,ut=>{lt[ut]=!0})}),lt});let st=rt;for(let at=1;at<=_e;at++){const lt=st;st=initializeArrayOfArrays(lt.length);for(let ot=0;ot<lt.length;ot++){const ct=lt[ot];for(let ut=0;ut<ct.length;ut++){const ht=ct[ut].partialPath,dt=ct[ut].suffixDef,pt=pathToHashKeys(ht);if(isUniquePrefixHash(nt,pt,ot)||isEmpty(dt)||ht.length===_e){const gt=it[ot];if(containsPath(gt,ht)===!1){gt.push(ht);for(let mt=0;mt<pt.length;mt++){const At=pt[mt];nt[ot][At]=!0}}}else{const gt=possiblePathsFrom(dt,at+1,ht);st[ot]=st[ot].concat(gt),forEach(gt,mt=>{const At=pathToHashKeys(mt.partialPath);forEach(At,yt=>{nt[ot][yt]=!0})})}}}}return it}function getLookaheadPathsForOr(tt,_e,rt,it){const nt=new InsideDefinitionFinderVisitor(tt,PROD_TYPE.ALTERNATION,it);return _e.accept(nt),lookAheadSequenceFromAlternatives(nt.result,rt)}function getLookaheadPathsForOptionalProd(tt,_e,rt,it){const nt=new InsideDefinitionFinderVisitor(tt,rt);_e.accept(nt);const st=nt.result,lt=new RestDefinitionFinderWalker(_e,tt,rt).startWalking(),ot=new Alternative({definition:st}),ct=new Alternative({definition:lt});return lookAheadSequenceFromAlternatives([ot,ct],it)}function containsPath(tt,_e){e:for(let rt=0;rt<tt.length;rt++){const it=tt[rt];if(it.length===_e.length){for(let nt=0;nt<it.length;nt++){const st=_e[nt],at=it[nt];if((st===at||at.categoryMatchesMap[st.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function isStrictPrefixOfPath(tt,_e){return tt.length<_e.length&&every(tt,(rt,it)=>{const nt=_e[it];return rt===nt||nt.categoryMatchesMap[rt.tokenTypeIdx]})}function areTokenCategoriesNotUsed(tt){return every(tt,_e=>every(_e,rt=>every(rt,it=>isEmpty(it.categoryMatches))))}function validateLookahead(tt){const _e=tt.lookaheadStrategy.validate({rules:tt.rules,tokenTypes:tt.tokenTypes,grammarName:tt.grammarName});return map(_e,rt=>Object.assign({type:ParserDefinitionErrorType.CUSTOM_LOOKAHEAD_VALIDATION},rt))}function validateGrammar$1(tt,_e,rt,it){const nt=flatMap(tt,ot=>validateDuplicateProductions(ot,rt)),st=checkTerminalAndNoneTerminalsNameSpace(tt,_e,rt),at=flatMap(tt,ot=>validateTooManyAlts(ot,rt)),lt=flatMap(tt,ot=>validateRuleDoesNotAlreadyExist(ot,tt,it,rt));return nt.concat(st,at,lt)}function validateDuplicateProductions(tt,_e){const rt=new OccurrenceValidationCollector;tt.accept(rt);const it=rt.allProductions,nt=groupBy$1(it,identifyProductionForDuplicates),st=pickBy(nt,lt=>lt.length>1);return map(values(st),lt=>{const ot=head(lt),ct=_e.buildDuplicateFoundError(tt,lt),ut=getProductionDslName(ot),ht={message:ct,type:ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:tt.name,dslName:ut,occurrence:ot.idx},dt=getExtraProductionArgument(ot);return dt&&(ht.parameter=dt),ht})}function identifyProductionForDuplicates(tt){return`${getProductionDslName(tt)}_#_${tt.idx}_#_${getExtraProductionArgument(tt)}`}function getExtraProductionArgument(tt){return tt instanceof Terminal?tt.terminalType.name:tt instanceof NonTerminal?tt.nonTerminalName:""}class OccurrenceValidationCollector extends GAstVisitor{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(_e){this.allProductions.push(_e)}visitOption(_e){this.allProductions.push(_e)}visitRepetitionWithSeparator(_e){this.allProductions.push(_e)}visitRepetitionMandatory(_e){this.allProductions.push(_e)}visitRepetitionMandatoryWithSeparator(_e){this.allProductions.push(_e)}visitRepetition(_e){this.allProductions.push(_e)}visitAlternation(_e){this.allProductions.push(_e)}visitTerminal(_e){this.allProductions.push(_e)}}function validateRuleDoesNotAlreadyExist(tt,_e,rt,it){const nt=[];if(reduce(_e,(at,lt)=>lt.name===tt.name?at+1:at,0)>1){const at=it.buildDuplicateRuleNameError({topLevelRule:tt,grammarName:rt});nt.push({message:at,type:ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:tt.name})}return nt}function validateRuleIsOverridden(tt,_e,rt){const it=[];let nt;return includes(_e,tt)||(nt=`Invalid rule override, rule: ->${tt}<- cannot be overridden in the grammar: ->${rt}<-as it is not defined in any of the super grammars `,it.push({message:nt,type:ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:tt})),it}function validateNoLeftRecursion(tt,_e,rt,it=[]){const nt=[],st=getFirstNoneTerminal(_e.definition);if(isEmpty(st))return[];{const at=tt.name;includes(st,tt)&&nt.push({message:rt.buildLeftRecursionError({topLevelRule:tt,leftRecursionPath:it}),type:ParserDefinitionErrorType.LEFT_RECURSION,ruleName:at});const ot=difference$1(st,it.concat([tt])),ct=flatMap(ot,ut=>{const ht=clone(it);return ht.push(ut),validateNoLeftRecursion(tt,ut,rt,ht)});return nt.concat(ct)}}function getFirstNoneTerminal(tt){let _e=[];if(isEmpty(tt))return _e;const rt=head(tt);if(rt instanceof NonTerminal)_e.push(rt.referencedRule);else if(rt instanceof Alternative||rt instanceof Option||rt instanceof RepetitionMandatory||rt instanceof RepetitionMandatoryWithSeparator||rt instanceof RepetitionWithSeparator||rt instanceof Repetition)_e=_e.concat(getFirstNoneTerminal(rt.definition));else if(rt instanceof Alternation)_e=flatten$1(map(rt.definition,st=>getFirstNoneTerminal(st.definition)));else if(!(rt instanceof Terminal))throw Error("non exhaustive match");const it=isOptionalProd(rt),nt=tt.length>1;if(it&&nt){const st=drop(tt);return _e.concat(getFirstNoneTerminal(st))}else return _e}class OrCollector extends GAstVisitor{constructor(){super(...arguments),this.alternations=[]}visitAlternation(_e){this.alternations.push(_e)}}function validateEmptyOrAlternative(tt,_e){const rt=new OrCollector;tt.accept(rt);const it=rt.alternations;return flatMap(it,st=>{const at=dropRight(st.definition);return flatMap(at,(lt,ot)=>{const ct=nextPossibleTokensAfter([lt],[],tokenStructuredMatcher,1);return isEmpty(ct)?[{message:_e.buildEmptyAlternationError({topLevelRule:tt,alternation:st,emptyChoiceIdx:ot}),type:ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:tt.name,occurrence:st.idx,alternative:ot+1}]:[]})})}function validateAmbiguousAlternationAlternatives(tt,_e,rt){const it=new OrCollector;tt.accept(it);let nt=it.alternations;return nt=reject(nt,at=>at.ignoreAmbiguities===!0),flatMap(nt,at=>{const lt=at.idx,ot=at.maxLookahead||_e,ct=getLookaheadPathsForOr(lt,tt,ot,at),ut=checkAlternativesAmbiguities(ct,at,tt,rt),ht=checkPrefixAlternativesAmbiguities(ct,at,tt,rt);return ut.concat(ht)})}class RepetitionCollector extends GAstVisitor{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(_e){this.allProductions.push(_e)}visitRepetitionMandatory(_e){this.allProductions.push(_e)}visitRepetitionMandatoryWithSeparator(_e){this.allProductions.push(_e)}visitRepetition(_e){this.allProductions.push(_e)}}function validateTooManyAlts(tt,_e){const rt=new OrCollector;tt.accept(rt);const it=rt.alternations;return flatMap(it,st=>st.definition.length>255?[{message:_e.buildTooManyAlternativesError({topLevelRule:tt,alternation:st}),type:ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:tt.name,occurrence:st.idx}]:[])}function validateSomeNonEmptyLookaheadPath(tt,_e,rt){const it=[];return forEach(tt,nt=>{const st=new RepetitionCollector;nt.accept(st);const at=st.allProductions;forEach(at,lt=>{const ot=getProdType(lt),ct=lt.maxLookahead||_e,ut=lt.idx,dt=getLookaheadPathsForOptionalProd(ut,nt,ot,ct)[0];if(isEmpty(flatten$1(dt))){const pt=rt.buildEmptyRepetitionError({topLevelRule:nt,repetition:lt});it.push({message:pt,type:ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:nt.name})}})}),it}function checkAlternativesAmbiguities(tt,_e,rt,it){const nt=[],st=reduce(tt,(lt,ot,ct)=>(_e.definition[ct].ignoreAmbiguities===!0||forEach(ot,ut=>{const ht=[ct];forEach(tt,(dt,pt)=>{ct!==pt&&containsPath(dt,ut)&&_e.definition[pt].ignoreAmbiguities!==!0&&ht.push(pt)}),ht.length>1&&!containsPath(nt,ut)&&(nt.push(ut),lt.push({alts:ht,path:ut}))}),lt),[]);return map(st,lt=>{const ot=map(lt.alts,ut=>ut+1);return{message:it.buildAlternationAmbiguityError({topLevelRule:rt,alternation:_e,ambiguityIndices:ot,prefixPath:lt.path}),type:ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:rt.name,occurrence:_e.idx,alternatives:lt.alts}})}function checkPrefixAlternativesAmbiguities(tt,_e,rt,it){const nt=reduce(tt,(at,lt,ot)=>{const ct=map(lt,ut=>({idx:ot,path:ut}));return at.concat(ct)},[]);return compact(flatMap(nt,at=>{if(_e.definition[at.idx].ignoreAmbiguities===!0)return[];const ot=at.idx,ct=at.path,ut=filter(nt,dt=>_e.definition[dt.idx].ignoreAmbiguities!==!0&&dt.idx<ot&&isStrictPrefixOfPath(dt.path,ct));return map(ut,dt=>{const pt=[dt.idx+1,ot+1],ft=_e.idx===0?"":_e.idx;return{message:it.buildAlternationPrefixAmbiguityError({topLevelRule:rt,alternation:_e,ambiguityIndices:pt,prefixPath:dt.path}),type:ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:rt.name,occurrence:ft,alternatives:pt}})}))}function checkTerminalAndNoneTerminalsNameSpace(tt,_e,rt){const it=[],nt=map(_e,st=>st.name);return forEach(tt,st=>{const at=st.name;if(includes(nt,at)){const lt=rt.buildNamespaceConflictError(st);it.push({message:lt,type:ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:at})}}),it}function resolveGrammar(tt){const _e=defaults$1(tt,{errMsgProvider:defaultGrammarResolverErrorProvider}),rt={};return forEach(tt.rules,it=>{rt[it.name]=it}),resolveGrammar$1(rt,_e.errMsgProvider)}function validateGrammar(tt){return tt=defaults$1(tt,{errMsgProvider:defaultGrammarValidatorErrorProvider}),validateGrammar$1(tt.rules,tt.tokenTypes,tt.errMsgProvider,tt.grammarName)}const MISMATCHED_TOKEN_EXCEPTION="MismatchedTokenException",NO_VIABLE_ALT_EXCEPTION="NoViableAltException",EARLY_EXIT_EXCEPTION="EarlyExitException",NOT_ALL_INPUT_PARSED_EXCEPTION="NotAllInputParsedException",RECOGNITION_EXCEPTION_NAMES=[MISMATCHED_TOKEN_EXCEPTION,NO_VIABLE_ALT_EXCEPTION,EARLY_EXIT_EXCEPTION,NOT_ALL_INPUT_PARSED_EXCEPTION];Object.freeze(RECOGNITION_EXCEPTION_NAMES);function isRecognitionException(tt){return includes(RECOGNITION_EXCEPTION_NAMES,tt.name)}class RecognitionException extends Error{constructor(_e,rt){super(_e),this.token=rt,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class MismatchedTokenException extends RecognitionException{constructor(_e,rt,it){super(_e,rt),this.previousToken=it,this.name=MISMATCHED_TOKEN_EXCEPTION}}class NoViableAltException extends RecognitionException{constructor(_e,rt,it){super(_e,rt),this.previousToken=it,this.name=NO_VIABLE_ALT_EXCEPTION}}class NotAllInputParsedException extends RecognitionException{constructor(_e,rt){super(_e,rt),this.name=NOT_ALL_INPUT_PARSED_EXCEPTION}}class EarlyExitException extends RecognitionException{constructor(_e,rt,it){super(_e,rt),this.previousToken=it,this.name=EARLY_EXIT_EXCEPTION}}const EOF_FOLLOW_KEY={},IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException";class InRuleRecoveryException extends Error{constructor(_e){super(_e),this.name=IN_RULE_RECOVERY_EXCEPTION}}class Recoverable{initRecoverable(_e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=has$1(_e,"recoveryEnabled")?_e.recoveryEnabled:DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=attemptInRepetitionRecovery)}getTokenToInsert(_e){const rt=createTokenInstance(_e,"",NaN,NaN,NaN,NaN,NaN,NaN);return rt.isInsertedInRecovery=!0,rt}canTokenTypeBeInsertedInRecovery(_e){return!0}canTokenTypeBeDeletedInRecovery(_e){return!0}tryInRepetitionRecovery(_e,rt,it,nt){const st=this.findReSyncTokenType(),at=this.exportLexerState(),lt=[];let ot=!1;const ct=this.LA(1);let ut=this.LA(1);const ht=()=>{const dt=this.LA(0),pt=this.errorMessageProvider.buildMismatchTokenMessage({expected:nt,actual:ct,previous:dt,ruleName:this.getCurrRuleFullName()}),ft=new MismatchedTokenException(pt,ct,this.LA(0));ft.resyncedTokens=dropRight(lt),this.SAVE_ERROR(ft)};for(;!ot;)if(this.tokenMatcher(ut,nt)){ht();return}else if(it.call(this)){ht(),_e.apply(this,rt);return}else this.tokenMatcher(ut,st)?ot=!0:(ut=this.SKIP_TOKEN(),this.addToResyncTokens(ut,lt));this.importLexerState(at)}shouldInRepetitionRecoveryBeTried(_e,rt,it){return!(it===!1||this.tokenMatcher(this.LA(1),_e)||this.isBackTracking()||this.canPerformInRuleRecovery(_e,this.getFollowsForInRuleRecovery(_e,rt)))}getFollowsForInRuleRecovery(_e,rt){const it=this.getCurrentGrammarPath(_e,rt);return this.getNextPossibleTokenTypes(it)}tryInRuleRecovery(_e,rt){if(this.canRecoverWithSingleTokenInsertion(_e,rt))return this.getTokenToInsert(_e);if(this.canRecoverWithSingleTokenDeletion(_e)){const it=this.SKIP_TOKEN();return this.consumeToken(),it}throw new InRuleRecoveryException("sad sad panda")}canPerformInRuleRecovery(_e,rt){return this.canRecoverWithSingleTokenInsertion(_e,rt)||this.canRecoverWithSingleTokenDeletion(_e)}canRecoverWithSingleTokenInsertion(_e,rt){if(!this.canTokenTypeBeInsertedInRecovery(_e)||isEmpty(rt))return!1;const it=this.LA(1);return find$1(rt,st=>this.tokenMatcher(it,st))!==void 0}canRecoverWithSingleTokenDeletion(_e){return this.canTokenTypeBeDeletedInRecovery(_e)?this.tokenMatcher(this.LA(2),_e):!1}isInCurrentRuleReSyncSet(_e){const rt=this.getCurrFollowKey(),it=this.getFollowSetFromFollowKey(rt);return includes(it,_e)}findReSyncTokenType(){const _e=this.flattenFollowSet();let rt=this.LA(1),it=2;for(;;){const nt=find$1(_e,st=>tokenMatcher(rt,st));if(nt!==void 0)return nt;rt=this.LA(it),it++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return EOF_FOLLOW_KEY;const _e=this.getLastExplicitRuleShortName(),rt=this.getLastExplicitRuleOccurrenceIndex(),it=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(_e),idxInCallingRule:rt,inRule:this.shortRuleNameToFullName(it)}}buildFullFollowKeyStack(){const _e=this.RULE_STACK,rt=this.RULE_OCCURRENCE_STACK;return map(_e,(it,nt)=>nt===0?EOF_FOLLOW_KEY:{ruleName:this.shortRuleNameToFullName(it),idxInCallingRule:rt[nt],inRule:this.shortRuleNameToFullName(_e[nt-1])})}flattenFollowSet(){const _e=map(this.buildFullFollowKeyStack(),rt=>this.getFollowSetFromFollowKey(rt));return flatten$1(_e)}getFollowSetFromFollowKey(_e){if(_e===EOF_FOLLOW_KEY)return[EOF];const rt=_e.ruleName+_e.idxInCallingRule+IN+_e.inRule;return this.resyncFollows[rt]}addToResyncTokens(_e,rt){return this.tokenMatcher(_e,EOF)||rt.push(_e),rt}reSyncTo(_e){const rt=[];let it=this.LA(1);for(;this.tokenMatcher(it,_e)===!1;)it=this.SKIP_TOKEN(),this.addToResyncTokens(it,rt);return dropRight(rt)}attemptInRepetitionRecovery(_e,rt,it,nt,st,at,lt){}getCurrentGrammarPath(_e,rt){const it=this.getHumanReadableRuleStack(),nt=clone(this.RULE_OCCURRENCE_STACK);return{ruleStack:it,occurrenceStack:nt,lastTok:_e,lastTokOccurrence:rt}}getHumanReadableRuleStack(){return map(this.RULE_STACK,_e=>this.shortRuleNameToFullName(_e))}}function attemptInRepetitionRecovery(tt,_e,rt,it,nt,st,at){const lt=this.getKeyForAutomaticLookahead(it,nt);let ot=this.firstAfterRepMap[lt];if(ot===void 0){const dt=this.getCurrRuleFullName(),pt=this.getGAstProductions()[dt];ot=new st(pt,nt).startWalking(),this.firstAfterRepMap[lt]=ot}let ct=ot.token,ut=ot.occurrence;const ht=ot.isEndOfRule;this.RULE_STACK.length===1&&ht&&ct===void 0&&(ct=EOF,ut=1),!(ct===void 0||ut===void 0)&&this.shouldInRepetitionRecoveryBeTried(ct,ut,at)&&this.tryInRepetitionRecovery(tt,_e,rt,ct)}const BITS_FOR_METHOD_TYPE=4,BITS_FOR_OCCURRENCE_IDX=8,OR_IDX=1<<BITS_FOR_OCCURRENCE_IDX,OPTION_IDX=2<<BITS_FOR_OCCURRENCE_IDX,MANY_IDX=3<<BITS_FOR_OCCURRENCE_IDX,AT_LEAST_ONE_IDX=4<<BITS_FOR_OCCURRENCE_IDX,MANY_SEP_IDX=5<<BITS_FOR_OCCURRENCE_IDX,AT_LEAST_ONE_SEP_IDX=6<<BITS_FOR_OCCURRENCE_IDX;function getKeyForAutomaticLookahead(tt,_e,rt){return rt|_e|tt}class LLkLookaheadStrategy{constructor(_e){var rt;this.maxLookahead=(rt=_e==null?void 0:_e.maxLookahead)!==null&&rt!==void 0?rt:DEFAULT_PARSER_CONFIG.maxLookahead}validate(_e){const rt=this.validateNoLeftRecursion(_e.rules);if(isEmpty(rt)){const it=this.validateEmptyOrAlternatives(_e.rules),nt=this.validateAmbiguousAlternationAlternatives(_e.rules,this.maxLookahead),st=this.validateSomeNonEmptyLookaheadPath(_e.rules,this.maxLookahead);return[...rt,...it,...nt,...st]}return rt}validateNoLeftRecursion(_e){return flatMap(_e,rt=>validateNoLeftRecursion(rt,rt,defaultGrammarValidatorErrorProvider))}validateEmptyOrAlternatives(_e){return flatMap(_e,rt=>validateEmptyOrAlternative(rt,defaultGrammarValidatorErrorProvider))}validateAmbiguousAlternationAlternatives(_e,rt){return flatMap(_e,it=>validateAmbiguousAlternationAlternatives(it,rt,defaultGrammarValidatorErrorProvider))}validateSomeNonEmptyLookaheadPath(_e,rt){return validateSomeNonEmptyLookaheadPath(_e,rt,defaultGrammarValidatorErrorProvider)}buildLookaheadForAlternation(_e){return buildLookaheadFuncForOr(_e.prodOccurrence,_e.rule,_e.maxLookahead,_e.hasPredicates,_e.dynamicTokensEnabled,buildAlternativesLookAheadFunc)}buildLookaheadForOptional(_e){return buildLookaheadFuncForOptionalProd(_e.prodOccurrence,_e.rule,_e.maxLookahead,_e.dynamicTokensEnabled,getProdType(_e.prodType),buildSingleAlternativeLookaheadFunction)}}class LooksAhead{initLooksAhead(_e){this.dynamicTokensEnabled=has$1(_e,"dynamicTokensEnabled")?_e.dynamicTokensEnabled:DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=has$1(_e,"maxLookahead")?_e.maxLookahead:DEFAULT_PARSER_CONFIG.maxLookahead,this.lookaheadStrategy=has$1(_e,"lookaheadStrategy")?_e.lookaheadStrategy:new LLkLookaheadStrategy({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(_e){forEach(_e,rt=>{this.TRACE_INIT(`${rt.name} Rule Lookahead`,()=>{const{alternation:it,repetition:nt,option:st,repetitionMandatory:at,repetitionMandatoryWithSeparator:lt,repetitionWithSeparator:ot}=collectMethods(rt);forEach(it,ct=>{const ut=ct.idx===0?"":ct.idx;this.TRACE_INIT(`${getProductionDslName(ct)}${ut}`,()=>{const ht=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:ct.idx,rule:rt,maxLookahead:ct.maxLookahead||this.maxLookahead,hasPredicates:ct.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),dt=getKeyForAutomaticLookahead(this.fullRuleNameToShort[rt.name],OR_IDX,ct.idx);this.setLaFuncCache(dt,ht)})}),forEach(nt,ct=>{this.computeLookaheadFunc(rt,ct.idx,MANY_IDX,"Repetition",ct.maxLookahead,getProductionDslName(ct))}),forEach(st,ct=>{this.computeLookaheadFunc(rt,ct.idx,OPTION_IDX,"Option",ct.maxLookahead,getProductionDslName(ct))}),forEach(at,ct=>{this.computeLookaheadFunc(rt,ct.idx,AT_LEAST_ONE_IDX,"RepetitionMandatory",ct.maxLookahead,getProductionDslName(ct))}),forEach(lt,ct=>{this.computeLookaheadFunc(rt,ct.idx,AT_LEAST_ONE_SEP_IDX,"RepetitionMandatoryWithSeparator",ct.maxLookahead,getProductionDslName(ct))}),forEach(ot,ct=>{this.computeLookaheadFunc(rt,ct.idx,MANY_SEP_IDX,"RepetitionWithSeparator",ct.maxLookahead,getProductionDslName(ct))})})})}computeLookaheadFunc(_e,rt,it,nt,st,at){this.TRACE_INIT(`${at}${rt===0?"":rt}`,()=>{const lt=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:rt,rule:_e,maxLookahead:st||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:nt}),ot=getKeyForAutomaticLookahead(this.fullRuleNameToShort[_e.name],it,rt);this.setLaFuncCache(ot,lt)})}getKeyForAutomaticLookahead(_e,rt){const it=this.getLastExplicitRuleShortName();return getKeyForAutomaticLookahead(it,_e,rt)}getLaFuncFromCache(_e){return this.lookAheadFuncsCache.get(_e)}setLaFuncCache(_e,rt){this.lookAheadFuncsCache.set(_e,rt)}}class DslMethodsCollectorVisitor extends GAstVisitor{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(_e){this.dslMethods.option.push(_e)}visitRepetitionWithSeparator(_e){this.dslMethods.repetitionWithSeparator.push(_e)}visitRepetitionMandatory(_e){this.dslMethods.repetitionMandatory.push(_e)}visitRepetitionMandatoryWithSeparator(_e){this.dslMethods.repetitionMandatoryWithSeparator.push(_e)}visitRepetition(_e){this.dslMethods.repetition.push(_e)}visitAlternation(_e){this.dslMethods.alternation.push(_e)}}const collectorVisitor=new DslMethodsCollectorVisitor;function collectMethods(tt){collectorVisitor.reset(),tt.accept(collectorVisitor);const _e=collectorVisitor.dslMethods;return collectorVisitor.reset(),_e}function setNodeLocationOnlyOffset(tt,_e){isNaN(tt.startOffset)===!0?(tt.startOffset=_e.startOffset,tt.endOffset=_e.endOffset):tt.endOffset<_e.endOffset&&(tt.endOffset=_e.endOffset)}function setNodeLocationFull(tt,_e){isNaN(tt.startOffset)===!0?(tt.startOffset=_e.startOffset,tt.startColumn=_e.startColumn,tt.startLine=_e.startLine,tt.endOffset=_e.endOffset,tt.endColumn=_e.endColumn,tt.endLine=_e.endLine):tt.endOffset<_e.endOffset&&(tt.endOffset=_e.endOffset,tt.endColumn=_e.endColumn,tt.endLine=_e.endLine)}function addTerminalToCst(tt,_e,rt){tt.children[rt]===void 0?tt.children[rt]=[_e]:tt.children[rt].push(_e)}function addNoneTerminalToCst(tt,_e,rt){tt.children[_e]===void 0?tt.children[_e]=[rt]:tt.children[_e].push(rt)}const NAME="name";function defineNameProp(tt,_e){Object.defineProperty(tt,NAME,{enumerable:!1,configurable:!0,writable:!1,value:_e})}function defaultVisit(tt,_e){const rt=keys$1(tt),it=rt.length;for(let nt=0;nt<it;nt++){const st=rt[nt],at=tt[st],lt=at.length;for(let ot=0;ot<lt;ot++){const ct=at[ot];ct.tokenTypeIdx===void 0&&this[ct.name](ct.children,_e)}}}function createBaseSemanticVisitorConstructor(tt,_e){const rt=function(){};defineNameProp(rt,tt+"BaseSemantics");const it={visit:function(nt,st){if(isArray$1$1(nt)&&(nt=nt[0]),!isUndefined(nt))return this[nt.name](nt.children,st)},validateVisitor:function(){const nt=validateVisitor(this,_e);if(!isEmpty(nt)){const st=map(nt,at=>at.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${st.join(`

`).replace(/\n/g,`
	`)}`)}}};return rt.prototype=it,rt.prototype.constructor=rt,rt._RULE_NAMES=_e,rt}function createBaseVisitorConstructorWithDefaults(tt,_e,rt){const it=function(){};defineNameProp(it,tt+"BaseSemanticsWithDefaults");const nt=Object.create(rt.prototype);return forEach(_e,st=>{nt[st]=defaultVisit}),it.prototype=nt,it.prototype.constructor=it,it}var CstVisitorDefinitionError;(function(tt){tt[tt.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",tt[tt.MISSING_METHOD=1]="MISSING_METHOD"})(CstVisitorDefinitionError||(CstVisitorDefinitionError={}));function validateVisitor(tt,_e){return validateMissingCstMethods(tt,_e)}function validateMissingCstMethods(tt,_e){const rt=filter(_e,nt=>isFunction$1(tt[nt])===!1),it=map(rt,nt=>({msg:`Missing visitor method: <${nt}> on ${tt.constructor.name} CST Visitor.`,type:CstVisitorDefinitionError.MISSING_METHOD,methodName:nt}));return compact(it)}class TreeBuilder{initTreeBuilder(_e){if(this.CST_STACK=[],this.outputCst=_e.outputCst,this.nodeLocationTracking=has$1(_e,"nodeLocationTracking")?_e.nodeLocationTracking:DEFAULT_PARSER_CONFIG.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=noop$2,this.cstFinallyStateUpdate=noop$2,this.cstPostTerminal=noop$2,this.cstPostNonTerminal=noop$2,this.cstPostRule=noop$2;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=setNodeLocationFull,this.setNodeLocationFromNode=setNodeLocationFull,this.cstPostRule=noop$2,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=noop$2,this.setNodeLocationFromNode=noop$2,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=setNodeLocationOnlyOffset,this.setNodeLocationFromNode=setNodeLocationOnlyOffset,this.cstPostRule=noop$2,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=noop$2,this.setNodeLocationFromNode=noop$2,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=noop$2,this.setNodeLocationFromNode=noop$2,this.cstPostRule=noop$2,this.setInitialNodeLocation=noop$2;else throw Error(`Invalid <nodeLocationTracking> config option: "${_e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(_e){_e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(_e){_e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(_e){_e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(_e){const rt=this.LA(1);_e.location={startOffset:rt.startOffset,startLine:rt.startLine,startColumn:rt.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(_e){const rt={name:_e,children:Object.create(null)};this.setInitialNodeLocation(rt),this.CST_STACK.push(rt)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(_e){const rt=this.LA(0),it=_e.location;it.startOffset<=rt.startOffset?(it.endOffset=rt.endOffset,it.endLine=rt.endLine,it.endColumn=rt.endColumn):(it.startOffset=NaN,it.startLine=NaN,it.startColumn=NaN)}cstPostRuleOnlyOffset(_e){const rt=this.LA(0),it=_e.location;it.startOffset<=rt.startOffset?it.endOffset=rt.endOffset:it.startOffset=NaN}cstPostTerminal(_e,rt){const it=this.CST_STACK[this.CST_STACK.length-1];addTerminalToCst(it,rt,_e),this.setNodeLocationFromToken(it.location,rt)}cstPostNonTerminal(_e,rt){const it=this.CST_STACK[this.CST_STACK.length-1];addNoneTerminalToCst(it,rt,_e),this.setNodeLocationFromNode(it.location,_e.location)}getBaseCstVisitorConstructor(){if(isUndefined(this.baseCstVisitorConstructor)){const _e=createBaseSemanticVisitorConstructor(this.className,keys$1(this.gastProductionsCache));return this.baseCstVisitorConstructor=_e,_e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(isUndefined(this.baseCstVisitorWithDefaultsConstructor)){const _e=createBaseVisitorConstructorWithDefaults(this.className,keys$1(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=_e,_e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const _e=this.RULE_STACK;return _e[_e.length-1]}getPreviousExplicitRuleShortName(){const _e=this.RULE_STACK;return _e[_e.length-2]}getLastExplicitRuleOccurrenceIndex(){const _e=this.RULE_OCCURRENCE_STACK;return _e[_e.length-1]}}class LexerAdapter{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(_e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=_e,this.tokVectorLength=_e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):END_OF_FILE}LA(_e){const rt=this.currIdx+_e;return rt<0||this.tokVectorLength<=rt?END_OF_FILE:this.tokVector[rt]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(_e){this.currIdx=_e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class RecognizerApi{ACTION(_e){return _e.call(this)}consume(_e,rt,it){return this.consumeInternal(rt,_e,it)}subrule(_e,rt,it){return this.subruleInternal(rt,_e,it)}option(_e,rt){return this.optionInternal(rt,_e)}or(_e,rt){return this.orInternal(rt,_e)}many(_e,rt){return this.manyInternal(_e,rt)}atLeastOne(_e,rt){return this.atLeastOneInternal(_e,rt)}CONSUME(_e,rt){return this.consumeInternal(_e,0,rt)}CONSUME1(_e,rt){return this.consumeInternal(_e,1,rt)}CONSUME2(_e,rt){return this.consumeInternal(_e,2,rt)}CONSUME3(_e,rt){return this.consumeInternal(_e,3,rt)}CONSUME4(_e,rt){return this.consumeInternal(_e,4,rt)}CONSUME5(_e,rt){return this.consumeInternal(_e,5,rt)}CONSUME6(_e,rt){return this.consumeInternal(_e,6,rt)}CONSUME7(_e,rt){return this.consumeInternal(_e,7,rt)}CONSUME8(_e,rt){return this.consumeInternal(_e,8,rt)}CONSUME9(_e,rt){return this.consumeInternal(_e,9,rt)}SUBRULE(_e,rt){return this.subruleInternal(_e,0,rt)}SUBRULE1(_e,rt){return this.subruleInternal(_e,1,rt)}SUBRULE2(_e,rt){return this.subruleInternal(_e,2,rt)}SUBRULE3(_e,rt){return this.subruleInternal(_e,3,rt)}SUBRULE4(_e,rt){return this.subruleInternal(_e,4,rt)}SUBRULE5(_e,rt){return this.subruleInternal(_e,5,rt)}SUBRULE6(_e,rt){return this.subruleInternal(_e,6,rt)}SUBRULE7(_e,rt){return this.subruleInternal(_e,7,rt)}SUBRULE8(_e,rt){return this.subruleInternal(_e,8,rt)}SUBRULE9(_e,rt){return this.subruleInternal(_e,9,rt)}OPTION(_e){return this.optionInternal(_e,0)}OPTION1(_e){return this.optionInternal(_e,1)}OPTION2(_e){return this.optionInternal(_e,2)}OPTION3(_e){return this.optionInternal(_e,3)}OPTION4(_e){return this.optionInternal(_e,4)}OPTION5(_e){return this.optionInternal(_e,5)}OPTION6(_e){return this.optionInternal(_e,6)}OPTION7(_e){return this.optionInternal(_e,7)}OPTION8(_e){return this.optionInternal(_e,8)}OPTION9(_e){return this.optionInternal(_e,9)}OR(_e){return this.orInternal(_e,0)}OR1(_e){return this.orInternal(_e,1)}OR2(_e){return this.orInternal(_e,2)}OR3(_e){return this.orInternal(_e,3)}OR4(_e){return this.orInternal(_e,4)}OR5(_e){return this.orInternal(_e,5)}OR6(_e){return this.orInternal(_e,6)}OR7(_e){return this.orInternal(_e,7)}OR8(_e){return this.orInternal(_e,8)}OR9(_e){return this.orInternal(_e,9)}MANY(_e){this.manyInternal(0,_e)}MANY1(_e){this.manyInternal(1,_e)}MANY2(_e){this.manyInternal(2,_e)}MANY3(_e){this.manyInternal(3,_e)}MANY4(_e){this.manyInternal(4,_e)}MANY5(_e){this.manyInternal(5,_e)}MANY6(_e){this.manyInternal(6,_e)}MANY7(_e){this.manyInternal(7,_e)}MANY8(_e){this.manyInternal(8,_e)}MANY9(_e){this.manyInternal(9,_e)}MANY_SEP(_e){this.manySepFirstInternal(0,_e)}MANY_SEP1(_e){this.manySepFirstInternal(1,_e)}MANY_SEP2(_e){this.manySepFirstInternal(2,_e)}MANY_SEP3(_e){this.manySepFirstInternal(3,_e)}MANY_SEP4(_e){this.manySepFirstInternal(4,_e)}MANY_SEP5(_e){this.manySepFirstInternal(5,_e)}MANY_SEP6(_e){this.manySepFirstInternal(6,_e)}MANY_SEP7(_e){this.manySepFirstInternal(7,_e)}MANY_SEP8(_e){this.manySepFirstInternal(8,_e)}MANY_SEP9(_e){this.manySepFirstInternal(9,_e)}AT_LEAST_ONE(_e){this.atLeastOneInternal(0,_e)}AT_LEAST_ONE1(_e){return this.atLeastOneInternal(1,_e)}AT_LEAST_ONE2(_e){this.atLeastOneInternal(2,_e)}AT_LEAST_ONE3(_e){this.atLeastOneInternal(3,_e)}AT_LEAST_ONE4(_e){this.atLeastOneInternal(4,_e)}AT_LEAST_ONE5(_e){this.atLeastOneInternal(5,_e)}AT_LEAST_ONE6(_e){this.atLeastOneInternal(6,_e)}AT_LEAST_ONE7(_e){this.atLeastOneInternal(7,_e)}AT_LEAST_ONE8(_e){this.atLeastOneInternal(8,_e)}AT_LEAST_ONE9(_e){this.atLeastOneInternal(9,_e)}AT_LEAST_ONE_SEP(_e){this.atLeastOneSepFirstInternal(0,_e)}AT_LEAST_ONE_SEP1(_e){this.atLeastOneSepFirstInternal(1,_e)}AT_LEAST_ONE_SEP2(_e){this.atLeastOneSepFirstInternal(2,_e)}AT_LEAST_ONE_SEP3(_e){this.atLeastOneSepFirstInternal(3,_e)}AT_LEAST_ONE_SEP4(_e){this.atLeastOneSepFirstInternal(4,_e)}AT_LEAST_ONE_SEP5(_e){this.atLeastOneSepFirstInternal(5,_e)}AT_LEAST_ONE_SEP6(_e){this.atLeastOneSepFirstInternal(6,_e)}AT_LEAST_ONE_SEP7(_e){this.atLeastOneSepFirstInternal(7,_e)}AT_LEAST_ONE_SEP8(_e){this.atLeastOneSepFirstInternal(8,_e)}AT_LEAST_ONE_SEP9(_e){this.atLeastOneSepFirstInternal(9,_e)}RULE(_e,rt,it=DEFAULT_RULE_CONFIG){if(includes(this.definedRulesNames,_e)){const at={message:defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:_e,grammarName:this.className}),type:ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:_e};this.definitionErrors.push(at)}this.definedRulesNames.push(_e);const nt=this.defineRule(_e,rt,it);return this[_e]=nt,nt}OVERRIDE_RULE(_e,rt,it=DEFAULT_RULE_CONFIG){const nt=validateRuleIsOverridden(_e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(nt);const st=this.defineRule(_e,rt,it);return this[_e]=st,st}BACKTRACK(_e,rt){return function(){this.isBackTrackingStack.push(1);const it=this.saveRecogState();try{return _e.apply(this,rt),!0}catch(nt){if(isRecognitionException(nt))return!1;throw nt}finally{this.reloadRecogState(it),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return serializeGrammar(values(this.gastProductionsCache))}}class RecognizerEngine{initRecognizerEngine(_e,rt){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=tokenStructuredMatcherNoCategories,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},has$1(rt,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(isArray$1$1(_e)){if(isEmpty(_e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof _e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(isArray$1$1(_e))this.tokensMap=reduce(_e,(st,at)=>(st[at.name]=at,st),{});else if(has$1(_e,"modes")&&every(flatten$1(values(_e.modes)),isTokenType)){const st=flatten$1(values(_e.modes)),at=uniq(st);this.tokensMap=reduce(at,(lt,ot)=>(lt[ot.name]=ot,lt),{})}else if(isObject$a(_e))this.tokensMap=clone(_e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=EOF;const it=has$1(_e,"modes")?flatten$1(values(_e.modes)):values(_e),nt=every(it,st=>isEmpty(st.categoryMatches));this.tokenMatcher=nt?tokenStructuredMatcherNoCategories:tokenStructuredMatcher,augmentTokenTypes(values(this.tokensMap))}defineRule(_e,rt,it){if(this.selfAnalysisDone)throw Error(`Grammar rule <${_e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const nt=has$1(it,"resyncEnabled")?it.resyncEnabled:DEFAULT_RULE_CONFIG.resyncEnabled,st=has$1(it,"recoveryValueFunc")?it.recoveryValueFunc:DEFAULT_RULE_CONFIG.recoveryValueFunc,at=this.ruleShortNameIdx<<BITS_FOR_METHOD_TYPE+BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[at]=_e,this.fullRuleNameToShort[_e]=at;let lt;return this.outputCst===!0?lt=function(...ut){try{this.ruleInvocationStateUpdate(at,_e,this.subruleIdx),rt.apply(this,ut);const ht=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(ht),ht}catch(ht){return this.invokeRuleCatch(ht,nt,st)}finally{this.ruleFinallyStateUpdate()}}:lt=function(...ut){try{return this.ruleInvocationStateUpdate(at,_e,this.subruleIdx),rt.apply(this,ut)}catch(ht){return this.invokeRuleCatch(ht,nt,st)}finally{this.ruleFinallyStateUpdate()}},Object.assign(lt,{ruleName:_e,originalGrammarAction:rt})}invokeRuleCatch(_e,rt,it){const nt=this.RULE_STACK.length===1,st=rt&&!this.isBackTracking()&&this.recoveryEnabled;if(isRecognitionException(_e)){const at=_e;if(st){const lt=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(lt))if(at.resyncedTokens=this.reSyncTo(lt),this.outputCst){const ot=this.CST_STACK[this.CST_STACK.length-1];return ot.recoveredNode=!0,ot}else return it(_e);else{if(this.outputCst){const ot=this.CST_STACK[this.CST_STACK.length-1];ot.recoveredNode=!0,at.partialCstResult=ot}throw at}}else{if(nt)return this.moveToTerminatedState(),it(_e);throw at}}else throw _e}optionInternal(_e,rt){const it=this.getKeyForAutomaticLookahead(OPTION_IDX,rt);return this.optionInternalLogic(_e,rt,it)}optionInternalLogic(_e,rt,it){let nt=this.getLaFuncFromCache(it),st;if(typeof _e!="function"){st=_e.DEF;const at=_e.GATE;if(at!==void 0){const lt=nt;nt=()=>at.call(this)&&lt.call(this)}}else st=_e;if(nt.call(this)===!0)return st.call(this)}atLeastOneInternal(_e,rt){const it=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_IDX,_e);return this.atLeastOneInternalLogic(_e,rt,it)}atLeastOneInternalLogic(_e,rt,it){let nt=this.getLaFuncFromCache(it),st;if(typeof rt!="function"){st=rt.DEF;const at=rt.GATE;if(at!==void 0){const lt=nt;nt=()=>at.call(this)&&lt.call(this)}}else st=rt;if(nt.call(this)===!0){let at=this.doSingleRepetition(st);for(;nt.call(this)===!0&&at===!0;)at=this.doSingleRepetition(st)}else throw this.raiseEarlyExitException(_e,PROD_TYPE.REPETITION_MANDATORY,rt.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[_e,rt],nt,AT_LEAST_ONE_IDX,_e,NextTerminalAfterAtLeastOneWalker)}atLeastOneSepFirstInternal(_e,rt){const it=this.getKeyForAutomaticLookahead(AT_LEAST_ONE_SEP_IDX,_e);this.atLeastOneSepFirstInternalLogic(_e,rt,it)}atLeastOneSepFirstInternalLogic(_e,rt,it){const nt=rt.DEF,st=rt.SEP;if(this.getLaFuncFromCache(it).call(this)===!0){nt.call(this);const lt=()=>this.tokenMatcher(this.LA(1),st);for(;this.tokenMatcher(this.LA(1),st)===!0;)this.CONSUME(st),nt.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[_e,st,lt,nt,NextTerminalAfterAtLeastOneSepWalker],lt,AT_LEAST_ONE_SEP_IDX,_e,NextTerminalAfterAtLeastOneSepWalker)}else throw this.raiseEarlyExitException(_e,PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,rt.ERR_MSG)}manyInternal(_e,rt){const it=this.getKeyForAutomaticLookahead(MANY_IDX,_e);return this.manyInternalLogic(_e,rt,it)}manyInternalLogic(_e,rt,it){let nt=this.getLaFuncFromCache(it),st;if(typeof rt!="function"){st=rt.DEF;const lt=rt.GATE;if(lt!==void 0){const ot=nt;nt=()=>lt.call(this)&&ot.call(this)}}else st=rt;let at=!0;for(;nt.call(this)===!0&&at===!0;)at=this.doSingleRepetition(st);this.attemptInRepetitionRecovery(this.manyInternal,[_e,rt],nt,MANY_IDX,_e,NextTerminalAfterManyWalker,at)}manySepFirstInternal(_e,rt){const it=this.getKeyForAutomaticLookahead(MANY_SEP_IDX,_e);this.manySepFirstInternalLogic(_e,rt,it)}manySepFirstInternalLogic(_e,rt,it){const nt=rt.DEF,st=rt.SEP;if(this.getLaFuncFromCache(it).call(this)===!0){nt.call(this);const lt=()=>this.tokenMatcher(this.LA(1),st);for(;this.tokenMatcher(this.LA(1),st)===!0;)this.CONSUME(st),nt.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[_e,st,lt,nt,NextTerminalAfterManySepWalker],lt,MANY_SEP_IDX,_e,NextTerminalAfterManySepWalker)}}repetitionSepSecondInternal(_e,rt,it,nt,st){for(;it();)this.CONSUME(rt),nt.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[_e,rt,it,nt,st],it,AT_LEAST_ONE_SEP_IDX,_e,st)}doSingleRepetition(_e){const rt=this.getLexerPosition();return _e.call(this),this.getLexerPosition()>rt}orInternal(_e,rt){const it=this.getKeyForAutomaticLookahead(OR_IDX,rt),nt=isArray$1$1(_e)?_e:_e.DEF,at=this.getLaFuncFromCache(it).call(this,nt);if(at!==void 0)return nt[at].ALT.call(this);this.raiseNoAltException(rt,_e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const _e=this.LA(1),rt=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:_e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new NotAllInputParsedException(rt,_e))}}subruleInternal(_e,rt,it){let nt;try{const st=it!==void 0?it.ARGS:void 0;return this.subruleIdx=rt,nt=_e.apply(this,st),this.cstPostNonTerminal(nt,it!==void 0&&it.LABEL!==void 0?it.LABEL:_e.ruleName),nt}catch(st){throw this.subruleInternalError(st,it,_e.ruleName)}}subruleInternalError(_e,rt,it){throw isRecognitionException(_e)&&_e.partialCstResult!==void 0&&(this.cstPostNonTerminal(_e.partialCstResult,rt!==void 0&&rt.LABEL!==void 0?rt.LABEL:it),delete _e.partialCstResult),_e}consumeInternal(_e,rt,it){let nt;try{const st=this.LA(1);this.tokenMatcher(st,_e)===!0?(this.consumeToken(),nt=st):this.consumeInternalError(_e,st,it)}catch(st){nt=this.consumeInternalRecovery(_e,rt,st)}return this.cstPostTerminal(it!==void 0&&it.LABEL!==void 0?it.LABEL:_e.name,nt),nt}consumeInternalError(_e,rt,it){let nt;const st=this.LA(0);throw it!==void 0&&it.ERR_MSG?nt=it.ERR_MSG:nt=this.errorMessageProvider.buildMismatchTokenMessage({expected:_e,actual:rt,previous:st,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new MismatchedTokenException(nt,rt,st))}consumeInternalRecovery(_e,rt,it){if(this.recoveryEnabled&&it.name==="MismatchedTokenException"&&!this.isBackTracking()){const nt=this.getFollowsForInRuleRecovery(_e,rt);try{return this.tryInRuleRecovery(_e,nt)}catch(st){throw st.name===IN_RULE_RECOVERY_EXCEPTION?it:st}}else throw it}saveRecogState(){const _e=this.errors,rt=clone(this.RULE_STACK);return{errors:_e,lexerState:this.exportLexerState(),RULE_STACK:rt,CST_STACK:this.CST_STACK}}reloadRecogState(_e){this.errors=_e.errors,this.importLexerState(_e.lexerState),this.RULE_STACK=_e.RULE_STACK}ruleInvocationStateUpdate(_e,rt,it){this.RULE_OCCURRENCE_STACK.push(it),this.RULE_STACK.push(_e),this.cstInvocationStateUpdate(rt)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const _e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[_e]}shortRuleNameToFullName(_e){return this.shortRuleNameToFull[_e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),EOF)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class ErrorHandler{initErrorHandler(_e){this._errors=[],this.errorMessageProvider=has$1(_e,"errorMessageProvider")?_e.errorMessageProvider:DEFAULT_PARSER_CONFIG.errorMessageProvider}SAVE_ERROR(_e){if(isRecognitionException(_e))return _e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:clone(this.RULE_OCCURRENCE_STACK)},this._errors.push(_e),_e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return clone(this._errors)}set errors(_e){this._errors=_e}raiseEarlyExitException(_e,rt,it){const nt=this.getCurrRuleFullName(),st=this.getGAstProductions()[nt],lt=getLookaheadPathsForOptionalProd(_e,st,rt,this.maxLookahead)[0],ot=[];for(let ut=1;ut<=this.maxLookahead;ut++)ot.push(this.LA(ut));const ct=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:lt,actual:ot,previous:this.LA(0),customUserDescription:it,ruleName:nt});throw this.SAVE_ERROR(new EarlyExitException(ct,this.LA(1),this.LA(0)))}raiseNoAltException(_e,rt){const it=this.getCurrRuleFullName(),nt=this.getGAstProductions()[it],st=getLookaheadPathsForOr(_e,nt,this.maxLookahead),at=[];for(let ct=1;ct<=this.maxLookahead;ct++)at.push(this.LA(ct));const lt=this.LA(0),ot=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:st,actual:at,previous:lt,customUserDescription:rt,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new NoViableAltException(ot,this.LA(1),lt))}}class ContentAssist{initContentAssist(){}computeContentAssist(_e,rt){const it=this.gastProductionsCache[_e];if(isUndefined(it))throw Error(`Rule ->${_e}<- does not exist in this grammar.`);return nextPossibleTokensAfter([it],rt,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(_e){const rt=head(_e.ruleStack),nt=this.getGAstProductions()[rt];return new NextAfterTokenWalker(nt,_e).startWalking()}}const RECORDING_NULL_OBJECT={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(RECORDING_NULL_OBJECT);const HANDLE_SEPARATOR=!0,MAX_METHOD_IDX=Math.pow(2,BITS_FOR_OCCURRENCE_IDX)-1,RFT=createToken({name:"RECORDING_PHASE_TOKEN",pattern:Lexer.NA});augmentTokenTypes([RFT]);const RECORDING_PHASE_TOKEN=createTokenInstance(RFT,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(RECORDING_PHASE_TOKEN);const RECORDING_PHASE_CSTNODE={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class GastRecorder{initGastRecorder(_e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let _e=0;_e<10;_e++){const rt=_e>0?_e:"";this[`CONSUME${rt}`]=function(it,nt){return this.consumeInternalRecord(it,_e,nt)},this[`SUBRULE${rt}`]=function(it,nt){return this.subruleInternalRecord(it,_e,nt)},this[`OPTION${rt}`]=function(it){return this.optionInternalRecord(it,_e)},this[`OR${rt}`]=function(it){return this.orInternalRecord(it,_e)},this[`MANY${rt}`]=function(it){this.manyInternalRecord(_e,it)},this[`MANY_SEP${rt}`]=function(it){this.manySepFirstInternalRecord(_e,it)},this[`AT_LEAST_ONE${rt}`]=function(it){this.atLeastOneInternalRecord(_e,it)},this[`AT_LEAST_ONE_SEP${rt}`]=function(it){this.atLeastOneSepFirstInternalRecord(_e,it)}}this.consume=function(_e,rt,it){return this.consumeInternalRecord(rt,_e,it)},this.subrule=function(_e,rt,it){return this.subruleInternalRecord(rt,_e,it)},this.option=function(_e,rt){return this.optionInternalRecord(rt,_e)},this.or=function(_e,rt){return this.orInternalRecord(rt,_e)},this.many=function(_e,rt){this.manyInternalRecord(_e,rt)},this.atLeastOne=function(_e,rt){this.atLeastOneInternalRecord(_e,rt)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const _e=this;for(let rt=0;rt<10;rt++){const it=rt>0?rt:"";delete _e[`CONSUME${it}`],delete _e[`SUBRULE${it}`],delete _e[`OPTION${it}`],delete _e[`OR${it}`],delete _e[`MANY${it}`],delete _e[`MANY_SEP${it}`],delete _e[`AT_LEAST_ONE${it}`],delete _e[`AT_LEAST_ONE_SEP${it}`]}delete _e.consume,delete _e.subrule,delete _e.option,delete _e.or,delete _e.many,delete _e.atLeastOne,delete _e.ACTION,delete _e.BACKTRACK,delete _e.LA})}ACTION_RECORD(_e){}BACKTRACK_RECORD(_e,rt){return()=>!0}LA_RECORD(_e){return END_OF_FILE}topLevelRuleRecord(_e,rt){try{const it=new Rule$1({definition:[],name:_e});return it.name=_e,this.recordingProdStack.push(it),rt.call(this),this.recordingProdStack.pop(),it}catch(it){if(it.KNOWN_RECORDER_ERROR!==!0)try{it.message=it.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw it}throw it}}optionInternalRecord(_e,rt){return recordProd.call(this,Option,_e,rt)}atLeastOneInternalRecord(_e,rt){recordProd.call(this,RepetitionMandatory,rt,_e)}atLeastOneSepFirstInternalRecord(_e,rt){recordProd.call(this,RepetitionMandatoryWithSeparator,rt,_e,HANDLE_SEPARATOR)}manyInternalRecord(_e,rt){recordProd.call(this,Repetition,rt,_e)}manySepFirstInternalRecord(_e,rt){recordProd.call(this,RepetitionWithSeparator,rt,_e,HANDLE_SEPARATOR)}orInternalRecord(_e,rt){return recordOrProd.call(this,_e,rt)}subruleInternalRecord(_e,rt,it){if(assertMethodIdxIsValid(rt),!_e||has$1(_e,"ruleName")===!1){const lt=new Error(`<SUBRULE${getIdxSuffix(rt)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(_e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw lt.KNOWN_RECORDER_ERROR=!0,lt}const nt=last(this.recordingProdStack),st=_e.ruleName,at=new NonTerminal({idx:rt,nonTerminalName:st,label:it==null?void 0:it.LABEL,referencedRule:void 0});return nt.definition.push(at),this.outputCst?RECORDING_PHASE_CSTNODE:RECORDING_NULL_OBJECT}consumeInternalRecord(_e,rt,it){if(assertMethodIdxIsValid(rt),!hasShortKeyProperty(_e)){const at=new Error(`<CONSUME${getIdxSuffix(rt)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(_e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw at.KNOWN_RECORDER_ERROR=!0,at}const nt=last(this.recordingProdStack),st=new Terminal({idx:rt,terminalType:_e,label:it==null?void 0:it.LABEL});return nt.definition.push(st),RECORDING_PHASE_TOKEN}}function recordProd(tt,_e,rt,it=!1){assertMethodIdxIsValid(rt);const nt=last(this.recordingProdStack),st=isFunction$1(_e)?_e:_e.DEF,at=new tt({definition:[],idx:rt});return it&&(at.separator=_e.SEP),has$1(_e,"MAX_LOOKAHEAD")&&(at.maxLookahead=_e.MAX_LOOKAHEAD),this.recordingProdStack.push(at),st.call(this),nt.definition.push(at),this.recordingProdStack.pop(),RECORDING_NULL_OBJECT}function recordOrProd(tt,_e){assertMethodIdxIsValid(_e);const rt=last(this.recordingProdStack),it=isArray$1$1(tt)===!1,nt=it===!1?tt:tt.DEF,st=new Alternation({definition:[],idx:_e,ignoreAmbiguities:it&&tt.IGNORE_AMBIGUITIES===!0});has$1(tt,"MAX_LOOKAHEAD")&&(st.maxLookahead=tt.MAX_LOOKAHEAD);const at=some(nt,lt=>isFunction$1(lt.GATE));return st.hasPredicates=at,rt.definition.push(st),forEach(nt,lt=>{const ot=new Alternative({definition:[]});st.definition.push(ot),has$1(lt,"IGNORE_AMBIGUITIES")?ot.ignoreAmbiguities=lt.IGNORE_AMBIGUITIES:has$1(lt,"GATE")&&(ot.ignoreAmbiguities=!0),this.recordingProdStack.push(ot),lt.ALT.call(this),this.recordingProdStack.pop()}),RECORDING_NULL_OBJECT}function getIdxSuffix(tt){return tt===0?"":`${tt}`}function assertMethodIdxIsValid(tt){if(tt<0||tt>MAX_METHOD_IDX){const _e=new Error(`Invalid DSL Method idx value: <${tt}>
	Idx value must be a none negative value smaller than ${MAX_METHOD_IDX+1}`);throw _e.KNOWN_RECORDER_ERROR=!0,_e}}class PerformanceTracer{initPerformanceTracer(_e){if(has$1(_e,"traceInitPerf")){const rt=_e.traceInitPerf,it=typeof rt=="number";this.traceInitMaxIdent=it?rt:1/0,this.traceInitPerf=it?rt>0:rt}else this.traceInitMaxIdent=0,this.traceInitPerf=DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(_e,rt){if(this.traceInitPerf===!0){this.traceInitIndent++;const it=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${it}--> <${_e}>`);const{time:nt,value:st}=timer$1(rt),at=nt>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&at(`${it}<-- <${_e}> time: ${nt}ms`),this.traceInitIndent--,st}else return rt()}}function applyMixins(tt,_e){_e.forEach(rt=>{const it=rt.prototype;Object.getOwnPropertyNames(it).forEach(nt=>{if(nt==="constructor")return;const st=Object.getOwnPropertyDescriptor(it,nt);st&&(st.get||st.set)?Object.defineProperty(tt.prototype,nt,st):tt.prototype[nt]=rt.prototype[nt]})})}const END_OF_FILE=createTokenInstance(EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(END_OF_FILE);const DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var ParserDefinitionErrorType;(function(tt){tt[tt.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",tt[tt.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",tt[tt.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",tt[tt.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",tt[tt.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",tt[tt.LEFT_RECURSION=5]="LEFT_RECURSION",tt[tt.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",tt[tt.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",tt[tt.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",tt[tt.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",tt[tt.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",tt[tt.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",tt[tt.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",tt[tt.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(ParserDefinitionErrorType||(ParserDefinitionErrorType={}));class Parser{static performSelfAnalysis(_e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let _e;this.selfAnalysisDone=!0;const rt=this.className;this.TRACE_INIT("toFastProps",()=>{toFastProperties(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),forEach(this.definedRulesNames,nt=>{const at=this[nt].originalGrammarAction;let lt;this.TRACE_INIT(`${nt} Rule`,()=>{lt=this.topLevelRuleRecord(nt,at)}),this.gastProductionsCache[nt]=lt})}finally{this.disableRecording()}});let it=[];if(this.TRACE_INIT("Grammar Resolving",()=>{it=resolveGrammar({rules:values(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(it)}),this.TRACE_INIT("Grammar Validations",()=>{if(isEmpty(it)&&this.skipValidations===!1){const nt=validateGrammar({rules:values(this.gastProductionsCache),tokenTypes:values(this.tokensMap),errMsgProvider:defaultGrammarValidatorErrorProvider,grammarName:rt}),st=validateLookahead({lookaheadStrategy:this.lookaheadStrategy,rules:values(this.gastProductionsCache),tokenTypes:values(this.tokensMap),grammarName:rt});this.definitionErrors=this.definitionErrors.concat(nt,st)}}),isEmpty(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const nt=computeAllProdsFollows(values(this.gastProductionsCache));this.resyncFollows=nt}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var nt,st;(st=(nt=this.lookaheadStrategy).initialize)===null||st===void 0||st.call(nt,{rules:values(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(values(this.gastProductionsCache))})),!Parser.DEFER_DEFINITION_ERRORS_HANDLING&&!isEmpty(this.definitionErrors))throw _e=map(this.definitionErrors,nt=>nt.message),new Error(`Parser Definition Errors detected:
 ${_e.join(`
-------------------------------
`)}`)})}constructor(_e,rt){this.definitionErrors=[],this.selfAnalysisDone=!1;const it=this;if(it.initErrorHandler(rt),it.initLexerAdapter(),it.initLooksAhead(rt),it.initRecognizerEngine(_e,rt),it.initRecoverable(rt),it.initTreeBuilder(rt),it.initContentAssist(),it.initGastRecorder(rt),it.initPerformanceTracer(rt),has$1(rt,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=has$1(rt,"skipValidations")?rt.skipValidations:DEFAULT_PARSER_CONFIG.skipValidations}}Parser.DEFER_DEFINITION_ERRORS_HANDLING=!1;applyMixins(Parser,[Recoverable,LooksAhead,TreeBuilder,LexerAdapter,RecognizerEngine,RecognizerApi,ErrorHandler,ContentAssist,GastRecorder,PerformanceTracer]);class WorkerPool{constructor(_e=4){this.pool=_e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(_e){if(!this.workers[_e]){const rt=this.workerCreator();rt.addEventListener("message",this._onMessage.bind(this,_e)),this.workers[_e]=rt}}_getIdleWorker(){for(let _e=0;_e<this.pool;_e++)if(!(this.workerStatus&1<<_e))return _e;return-1}_onMessage(_e,rt){const it=this.workersResolve[_e];if(it&&it(rt),this.queue.length){const{resolve:nt,msg:st,transfer:at}=this.queue.shift();this.workersResolve[_e]=nt,this.workers[_e].postMessage(st,at)}else this.workerStatus^=1<<_e}setWorkerCreator(_e){this.workerCreator=_e}setWorkerLimit(_e){this.pool=_e}postMessage(_e,rt){return new Promise(it=>{const nt=this._getIdleWorker();nt!==-1?(this._initWorker(nt),this.workerStatus|=1<<nt,this.workersResolve[nt]=it,this.workers[nt].postMessage(_e,rt)):this.queue.push({resolve:it,msg:_e,transfer:rt})})}dispose(){this.workers.forEach(_e=>_e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}class CompressedArrayTexture extends CompressedTexture{constructor(_e,rt,it,nt,st,at){super(_e,rt,it,st,at),this.isCompressedArrayTexture=!0,this.image.depth=nt,this.wrapR=ClampToEdgeWrapping}}const _taskCache$3=new WeakMap;let _activeLoaders=0,_zstd;const _KTX2Loader=class extends Loader{constructor(tt){super(tt),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(tt){return this.transcoderPath=tt,this}setWorkerLimit(tt){return this.workerPool.setWorkerLimit(tt),this}detectSupport(tt){return this.workerConfig={astcSupported:tt.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:tt.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:tt.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:tt.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:tt.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:tt.extensions.has("WEBGL_compressed_texture_pvrtc")||tt.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},tt.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const tt=new FileLoader(this.manager);tt.setPath(this.transcoderPath),tt.setWithCredentials(this.withCredentials);const _e=tt.loadAsync("basis_transcoder.js"),rt=new FileLoader(this.manager);rt.setPath(this.transcoderPath),rt.setResponseType("arraybuffer"),rt.setWithCredentials(this.withCredentials);const it=rt.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([_e,it]).then(([nt,st])=>{const at=_KTX2Loader.BasisWorker.toString(),lt=["/* constants */","let _EngineFormat = "+JSON.stringify(_KTX2Loader.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(_KTX2Loader.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(_KTX2Loader.BasisFormat),"/* basis_transcoder.js */",nt,"/* worker */",at.substring(at.indexOf("{")+1,at.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([lt])),this.transcoderBinary=st,this.workerPool.setWorkerCreator(()=>{const ot=new Worker(this.workerSourceURL),ct=this.transcoderBinary.slice(0);return ot.postMessage({type:"init",config:this.workerConfig,transcoderBinary:ct},[ct]),ot})}),_activeLoaders>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),_activeLoaders++}return this.transcoderPending}load(tt,_e,rt,it){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const nt=new FileLoader(this.manager);nt.setResponseType("arraybuffer"),nt.setWithCredentials(this.withCredentials),nt.load(tt,st=>{if(_taskCache$3.has(st))return _taskCache$3.get(st).promise.then(_e).catch(it);this._createTexture(st).then(at=>_e?_e(at):null).catch(it)},rt,it)}_createTextureFrom(tt,_e){const{mipmaps:rt,width:it,height:nt,format:st,type:at,error:lt,dfdTransferFn:ot,dfdFlags:ct}=tt;if(at==="error")return Promise.reject(lt);const ut=_e.layerCount>1?new CompressedArrayTexture(rt,it,nt,_e.layerCount,st,UnsignedByteType):new CompressedTexture(rt,it,nt,st,UnsignedByteType);return ut.minFilter=rt.length===1?LinearFilter:LinearMipmapLinearFilter,ut.magFilter=LinearFilter,ut.generateMipmaps=!1,ut.needsUpdate=!0,"colorSpace"in ut?ut.colorSpace=ot===KHR_DF_TRANSFER_SRGB?"srgb":"srgb-linear":ut.encoding=ot===KHR_DF_TRANSFER_SRGB?3001:3e3,ut.premultiplyAlpha=!!(ct&KHR_DF_FLAG_ALPHA_PREMULTIPLIED),ut}async _createTexture(tt,_e={}){const rt=read(new Uint8Array(tt));if(rt.vkFormat!==VK_FORMAT_UNDEFINED)return createDataTexture(rt);const it=_e,nt=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:tt,taskConfig:it},[tt])).then(st=>this._createTextureFrom(st.data,rt));return _taskCache$3.set(tt,{promise:nt}),nt}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),_activeLoaders--,this}};let KTX2Loader=_KTX2Loader;__publicField(KTX2Loader,"BasisFormat",{ETC1S:0,UASTC_4x4:1});__publicField(KTX2Loader,"TranscoderFormat",{ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16});__publicField(KTX2Loader,"EngineFormat",{RGBAFormat,RGBA_ASTC_4x4_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format});__publicField(KTX2Loader,"BasisWorker",function(){let tt,_e,rt;const it=_EngineFormat,nt=_TranscoderFormat,st=_BasisFormat;self.addEventListener("message",function(ft){const gt=ft.data;switch(gt.type){case"init":tt=gt.config,at(gt.transcoderBinary);break;case"transcode":_e.then(()=>{try{const{width:mt,height:At,hasAlpha:yt,mipmaps:bt,format:xt,dfdTransferFn:vt,dfdFlags:_t}=lt(gt.buffer),Ct=[];for(let St=0;St<bt.length;++St)Ct.push(bt[St].data.buffer);self.postMessage({type:"transcode",id:gt.id,width:mt,height:At,hasAlpha:yt,mipmaps:bt,format:xt,dfdTransferFn:vt,dfdFlags:_t},Ct)}catch(mt){console.error(mt),self.postMessage({type:"error",id:gt.id,error:mt.message})}});break}});function at(ft){_e=new Promise(gt=>{rt={wasmBinary:ft,onRuntimeInitialized:gt},BASIS(rt)}).then(()=>{rt.initializeBasis(),rt.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function lt(ft){const gt=new rt.KTX2File(new Uint8Array(ft));function mt(){gt.close(),gt.delete()}if(!gt.isValid())throw mt(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const At=gt.isUASTC()?st.UASTC_4x4:st.ETC1S,yt=gt.getWidth(),bt=gt.getHeight(),xt=gt.getLayers()||1,vt=gt.getLevels(),_t=gt.getHasAlpha(),Ct=gt.getDFDTransferFunc(),St=gt.getDFDFlags(),{transcoderFormat:Et,engineFormat:Tt}=ht(At,yt,bt,_t);if(!yt||!bt||!vt)throw mt(),new Error("THREE.KTX2Loader:	Invalid texture");if(!gt.startTranscoding())throw mt(),new Error("THREE.KTX2Loader: .startTranscoding failed");const Mt=[];for(let Rt=0;Rt<vt;Rt++){const It=[];let Ot,Bt;for(let Nt=0;Nt<xt;Nt++){const zt=gt.getImageLevelInfo(Rt,Nt,0);Ot=zt.origWidth<4?zt.origWidth:zt.width,Bt=zt.origHeight<4?zt.origHeight:zt.height;const Dt=new Uint8Array(gt.getImageTranscodedSizeInBytes(Rt,Nt,0,Et));if(!gt.transcodeImage(Dt,Rt,Nt,0,Et,0,-1,-1))throw mt(),new Error("THREE.KTX2Loader: .transcodeImage failed.");It.push(Dt)}Mt.push({data:pt(It),width:Ot,height:Bt})}return mt(),{width:yt,height:bt,hasAlpha:_t,mipmaps:Mt,format:Tt,dfdTransferFn:Ct,dfdFlags:St}}const ot=[{if:"astcSupported",basisFormat:[st.UASTC_4x4],transcoderFormat:[nt.ASTC_4x4,nt.ASTC_4x4],engineFormat:[it.RGBA_ASTC_4x4_Format,it.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.BC7_M5,nt.BC7_M5],engineFormat:[it.RGBA_BPTC_Format,it.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.BC1,nt.BC3],engineFormat:[it.RGB_S3TC_DXT1_Format,it.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.ETC1,nt.ETC2],engineFormat:[it.RGB_ETC2_Format,it.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.ETC1],engineFormat:[it.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.PVRTC1_4_RGB,nt.PVRTC1_4_RGBA],engineFormat:[it.RGB_PVRTC_4BPPV1_Format,it.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],ct=ot.sort(function(ft,gt){return ft.priorityETC1S-gt.priorityETC1S}),ut=ot.sort(function(ft,gt){return ft.priorityUASTC-gt.priorityUASTC});function ht(ft,gt,mt,At){let yt,bt;const xt=ft===st.ETC1S?ct:ut;for(let vt=0;vt<xt.length;vt++){const _t=xt[vt];if(tt[_t.if]&&_t.basisFormat.includes(ft)&&!(At&&_t.transcoderFormat.length<2)&&!(_t.needsPowerOfTwo&&!(dt(gt)&&dt(mt))))return yt=_t.transcoderFormat[At?1:0],bt=_t.engineFormat[At?1:0],{transcoderFormat:yt,engineFormat:bt}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),yt=nt.RGBA32,bt=it.RGBAFormat,{transcoderFormat:yt,engineFormat:bt}}function dt(ft){return ft<=2?!0:(ft&ft-1)===0&&ft!==0}function pt(ft){let gt=0;for(let yt=0;yt<ft.length;yt++){const bt=ft[yt];gt+=bt.byteLength}const mt=new Uint8Array(gt);let At=0;for(let yt=0;yt<ft.length;yt++){const bt=ft[yt];mt.set(bt,At),At+=bt.byteLength}return mt}});const FORMAT_MAP={[VK_FORMAT_R32G32B32A32_SFLOAT]:RGBAFormat,[VK_FORMAT_R16G16B16A16_SFLOAT]:RGBAFormat,[VK_FORMAT_R8G8B8A8_UNORM]:RGBAFormat,[VK_FORMAT_R8G8B8A8_SRGB]:RGBAFormat,[VK_FORMAT_R32G32_SFLOAT]:RGFormat,[VK_FORMAT_R16G16_SFLOAT]:RGFormat,[VK_FORMAT_R8G8_UNORM]:RGFormat,[VK_FORMAT_R8G8_SRGB]:RGFormat,[VK_FORMAT_R32_SFLOAT]:RedFormat,[VK_FORMAT_R16_SFLOAT]:RedFormat,[VK_FORMAT_R8_SRGB]:RedFormat,[VK_FORMAT_R8_UNORM]:RedFormat},TYPE_MAP={[VK_FORMAT_R32G32B32A32_SFLOAT]:FloatType,[VK_FORMAT_R16G16B16A16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8G8B8A8_UNORM]:UnsignedByteType,[VK_FORMAT_R8G8B8A8_SRGB]:UnsignedByteType,[VK_FORMAT_R32G32_SFLOAT]:FloatType,[VK_FORMAT_R16G16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8G8_UNORM]:UnsignedByteType,[VK_FORMAT_R8G8_SRGB]:UnsignedByteType,[VK_FORMAT_R32_SFLOAT]:FloatType,[VK_FORMAT_R16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8_SRGB]:UnsignedByteType,[VK_FORMAT_R8_UNORM]:UnsignedByteType},ENCODING_MAP={[VK_FORMAT_R8G8B8A8_SRGB]:3001,[VK_FORMAT_R8G8_SRGB]:3001,[VK_FORMAT_R8_SRGB]:3001};async function createDataTexture(tt){const{vkFormat:_e,pixelWidth:rt,pixelHeight:it,pixelDepth:nt}=tt;if(FORMAT_MAP[_e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");const st=tt.levels[0];let at,lt;if(tt.supercompressionScheme===KHR_SUPERCOMPRESSION_NONE)at=st.levelData;else if(tt.supercompressionScheme===KHR_SUPERCOMPRESSION_ZSTD)_zstd||(_zstd=new Promise(async ct=>{const ut=new Q$1;await ut.init(),ct(ut)})),at=(await _zstd).decode(st.levelData,st.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");TYPE_MAP[_e]===FloatType?lt=new Float32Array(at.buffer,at.byteOffset,at.byteLength/Float32Array.BYTES_PER_ELEMENT):TYPE_MAP[_e]===HalfFloatType?lt=new Uint16Array(at.buffer,at.byteOffset,at.byteLength/Uint16Array.BYTES_PER_ELEMENT):lt=at;const ot=nt===0?new DataTexture(lt,rt,it):new Data3DTexture(lt,rt,it,nt);return ot.type=TYPE_MAP[_e],ot.format=FORMAT_MAP[_e],ot.encoding=ENCODING_MAP[_e]||3e3,ot.needsUpdate=!0,Promise.resolve(ot)}class RGBELoader extends DataTextureLoader{constructor(_e){super(_e),this.type=HalfFloatType}parse(_e){const lt=function(bt,xt){switch(bt){case 1:console.error("THREE.RGBELoader Read Error: "+(xt||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(xt||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(xt||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(xt||""))}return-1},ht=`
`,dt=function(bt,xt,vt){xt=xt||1024;let Ct=bt.pos,St=-1,Et=0,Tt="",Mt=String.fromCharCode.apply(null,new Uint16Array(bt.subarray(Ct,Ct+128)));for(;0>(St=Mt.indexOf(ht))&&Et<xt&&Ct<bt.byteLength;)Tt+=Mt,Et+=Mt.length,Ct+=128,Mt+=String.fromCharCode.apply(null,new Uint16Array(bt.subarray(Ct,Ct+128)));return-1<St?(vt!==!1&&(bt.pos+=Et+St+1),Tt+Mt.slice(0,St)):!1},pt=function(bt){const xt=/^#\?(\S+)/,vt=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,_t=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Ct=/^\s*FORMAT=(\S+)\s*$/,St=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Et={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let Tt,Mt;if(bt.pos>=bt.byteLength||!(Tt=dt(bt)))return lt(1,"no header found");if(!(Mt=Tt.match(xt)))return lt(3,"bad initial token");for(Et.valid|=1,Et.programtype=Mt[1],Et.string+=Tt+`
`;Tt=dt(bt),Tt!==!1;){if(Et.string+=Tt+`
`,Tt.charAt(0)==="#"){Et.comments+=Tt+`
`;continue}if((Mt=Tt.match(vt))&&(Et.gamma=parseFloat(Mt[1])),(Mt=Tt.match(_t))&&(Et.exposure=parseFloat(Mt[1])),(Mt=Tt.match(Ct))&&(Et.valid|=2,Et.format=Mt[1]),(Mt=Tt.match(St))&&(Et.valid|=4,Et.height=parseInt(Mt[1],10),Et.width=parseInt(Mt[2],10)),Et.valid&2&&Et.valid&4)break}return Et.valid&2?Et.valid&4?Et:lt(3,"missing image size specifier"):lt(3,"missing format specifier")},ft=function(bt,xt,vt){const _t=xt;if(_t<8||_t>32767||bt[0]!==2||bt[1]!==2||bt[2]&128)return new Uint8Array(bt);if(_t!==(bt[2]<<8|bt[3]))return lt(3,"wrong scanline width");const Ct=new Uint8Array(4*xt*vt);if(!Ct.length)return lt(4,"unable to allocate buffer space");let St=0,Et=0;const Tt=4*_t,Mt=new Uint8Array(4),Rt=new Uint8Array(Tt);let It=vt;for(;It>0&&Et<bt.byteLength;){if(Et+4>bt.byteLength)return lt(1);if(Mt[0]=bt[Et++],Mt[1]=bt[Et++],Mt[2]=bt[Et++],Mt[3]=bt[Et++],Mt[0]!=2||Mt[1]!=2||(Mt[2]<<8|Mt[3])!=_t)return lt(3,"bad rgbe scanline format");let Ot=0,Bt;for(;Ot<Tt&&Et<bt.byteLength;){Bt=bt[Et++];const zt=Bt>128;if(zt&&(Bt-=128),Bt===0||Ot+Bt>Tt)return lt(3,"bad scanline data");if(zt){const Dt=bt[Et++];for(let Ft=0;Ft<Bt;Ft++)Rt[Ot++]=Dt}else Rt.set(bt.subarray(Et,Et+Bt),Ot),Ot+=Bt,Et+=Bt}const Nt=_t;for(let zt=0;zt<Nt;zt++){let Dt=0;Ct[St]=Rt[zt+Dt],Dt+=_t,Ct[St+1]=Rt[zt+Dt],Dt+=_t,Ct[St+2]=Rt[zt+Dt],Dt+=_t,Ct[St+3]=Rt[zt+Dt],St+=4}It--}return Ct},gt=function(bt,xt,vt,_t){const Ct=bt[xt+3],St=Math.pow(2,Ct-128)/255;vt[_t+0]=bt[xt+0]*St,vt[_t+1]=bt[xt+1]*St,vt[_t+2]=bt[xt+2]*St,vt[_t+3]=1},mt=function(bt,xt,vt,_t){const Ct=bt[xt+3],St=Math.pow(2,Ct-128)/255;vt[_t+0]=DataUtils.toHalfFloat(Math.min(bt[xt+0]*St,65504)),vt[_t+1]=DataUtils.toHalfFloat(Math.min(bt[xt+1]*St,65504)),vt[_t+2]=DataUtils.toHalfFloat(Math.min(bt[xt+2]*St,65504)),vt[_t+3]=DataUtils.toHalfFloat(1)},At=new Uint8Array(_e);At.pos=0;const yt=pt(At);if(yt!==-1){const bt=yt.width,xt=yt.height,vt=ft(At.subarray(At.pos),bt,xt);if(vt!==-1){let _t,Ct,St;switch(this.type){case FloatType:St=vt.length/4;const Et=new Float32Array(St*4);for(let Mt=0;Mt<St;Mt++)gt(vt,Mt*4,Et,Mt*4);_t=Et,Ct=FloatType;break;case HalfFloatType:St=vt.length/4;const Tt=new Uint16Array(St*4);for(let Mt=0;Mt<St;Mt++)mt(vt,Mt*4,Tt,Mt*4);_t=Tt,Ct=HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:bt,height:xt,data:_t,header:yt.string,gamma:yt.gamma,exposure:yt.exposure,type:Ct}}}return null}setDataType(_e){return this.type=_e,this}load(_e,rt,it,nt){function st(at,lt){switch(at.type){case FloatType:case HalfFloatType:"colorSpace"in at?at.colorSpace="srgb-linear":at.encoding=3e3,at.minFilter=LinearFilter,at.magFilter=LinearFilter,at.generateMipmaps=!1,at.flipY=!0;break}rt&&rt(at,lt)}return super.load(_e,st,it,nt)}}const hasColorSpace="colorSpace"in new Texture;class EXRLoader extends DataTextureLoader{constructor(_e){super(_e),this.type=HalfFloatType}parse(_e){const Et=Math.pow(2.7182818,2.2);function Tt(Wt,jt){for(var rr=0,cr=0;cr<65536;++cr)(cr==0||Wt[cr>>3]&1<<(cr&7))&&(jt[rr++]=cr);for(var or=rr-1;rr<65536;)jt[rr++]=0;return or}function Mt(Wt){for(var jt=0;jt<16384;jt++)Wt[jt]={},Wt[jt].len=0,Wt[jt].lit=0,Wt[jt].p=null}const Rt={l:0,c:0,lc:0};function It(Wt,jt,rr,cr,or){for(;rr<Wt;)jt=jt<<8|Jt(cr,or),rr+=8;rr-=Wt,Rt.l=jt>>rr&(1<<Wt)-1,Rt.c=jt,Rt.lc=rr}const Ot=new Array(59);function Bt(Wt){for(var jt=0;jt<=58;++jt)Ot[jt]=0;for(var jt=0;jt<65537;++jt)Ot[Wt[jt]]+=1;for(var rr=0,jt=58;jt>0;--jt){var cr=rr+Ot[jt]>>1;Ot[jt]=rr,rr=cr}for(var jt=0;jt<65537;++jt){var or=Wt[jt];or>0&&(Wt[jt]=or|Ot[or]++<<6)}}function Nt(Wt,jt,rr,cr,or,vr,Br){for(var Dr=rr,Gr=0,zr=0;or<=vr;or++){if(Dr.value-rr.value>cr)return!1;It(6,Gr,zr,Wt,Dr);var Yr=Rt.l;if(Gr=Rt.c,zr=Rt.lc,Br[or]=Yr,Yr==63){if(Dr.value-rr.value>cr)throw"Something wrong with hufUnpackEncTable";It(8,Gr,zr,Wt,Dr);var Mr=Rt.l+6;if(Gr=Rt.c,zr=Rt.lc,or+Mr>vr+1)throw"Something wrong with hufUnpackEncTable";for(;Mr--;)Br[or++]=0;or--}else if(Yr>=59){var Mr=Yr-59+2;if(or+Mr>vr+1)throw"Something wrong with hufUnpackEncTable";for(;Mr--;)Br[or++]=0;or--}}Bt(Br)}function zt(Wt){return Wt&63}function Dt(Wt){return Wt>>6}function Ft(Wt,jt,rr,cr){for(;jt<=rr;jt++){var or=Dt(Wt[jt]),vr=zt(Wt[jt]);if(or>>vr)throw"Invalid table entry";if(vr>14){var Br=cr[or>>vr-14];if(Br.len)throw"Invalid table entry";if(Br.lit++,Br.p){var Dr=Br.p;Br.p=new Array(Br.lit);for(var Gr=0;Gr<Br.lit-1;++Gr)Br.p[Gr]=Dr[Gr]}else Br.p=new Array(1);Br.p[Br.lit-1]=jt}else if(vr)for(var zr=0,Gr=1<<14-vr;Gr>0;Gr--){var Br=cr[(or<<14-vr)+zr];if(Br.len||Br.p)throw"Invalid table entry";Br.len=vr,Br.lit=jt,zr++}}return!0}const Ut={c:0,lc:0};function $t(Wt,jt,rr,cr){Wt=Wt<<8|Jt(rr,cr),jt+=8,Ut.c=Wt,Ut.lc=jt}const Vt={c:0,lc:0};function Zt(Wt,jt,rr,cr,or,vr,Br,Dr,Gr,zr){if(Wt==jt){cr<8&&($t(rr,cr,or,Br),rr=Ut.c,cr=Ut.lc),cr-=8;var Yr=rr>>cr,Yr=new Uint8Array([Yr])[0];if(Gr.value+Yr>zr)return!1;for(var Mr=Dr[Gr.value-1];Yr-- >0;)Dr[Gr.value++]=Mr}else if(Gr.value<zr)Dr[Gr.value++]=Wt;else return!1;Vt.c=rr,Vt.lc=cr}function qt(Wt){return Wt&65535}function sr(Wt){var jt=qt(Wt);return jt>32767?jt-65536:jt}const er={a:0,b:0};function ir(Wt,jt){var rr=sr(Wt),cr=sr(jt),or=cr,vr=rr+(or&1)+(or>>1),Br=vr,Dr=vr-or;er.a=Br,er.b=Dr}function ur(Wt,jt){var rr=qt(Wt),cr=qt(jt),or=rr-(cr>>1)&65535,vr=cr+or-32768&65535;er.a=vr,er.b=or}function ar(Wt,jt,rr,cr,or,vr,Br){for(var Dr=Br<16384,Gr=rr>or?or:rr,zr=1,Yr;zr<=Gr;)zr<<=1;for(zr>>=1,Yr=zr,zr>>=1;zr>=1;){for(var Mr=0,Zr=Mr+vr*(or-Yr),Kr=vr*zr,qr=vr*Yr,ln=cr*zr,dn=cr*Yr,cn,_i,fn,on;Mr<=Zr;Mr+=qr){for(var An=Mr,Bn=Mr+cr*(rr-Yr);An<=Bn;An+=dn){var mn=An+ln,Dn=An+Kr,On=Dn+ln;Dr?(ir(Wt[An+jt],Wt[Dn+jt]),cn=er.a,fn=er.b,ir(Wt[mn+jt],Wt[On+jt]),_i=er.a,on=er.b,ir(cn,_i),Wt[An+jt]=er.a,Wt[mn+jt]=er.b,ir(fn,on),Wt[Dn+jt]=er.a,Wt[On+jt]=er.b):(ur(Wt[An+jt],Wt[Dn+jt]),cn=er.a,fn=er.b,ur(Wt[mn+jt],Wt[On+jt]),_i=er.a,on=er.b,ur(cn,_i),Wt[An+jt]=er.a,Wt[mn+jt]=er.b,ur(fn,on),Wt[Dn+jt]=er.a,Wt[On+jt]=er.b)}if(rr&zr){var Dn=An+Kr;Dr?ir(Wt[An+jt],Wt[Dn+jt]):ur(Wt[An+jt],Wt[Dn+jt]),cn=er.a,Wt[Dn+jt]=er.b,Wt[An+jt]=cn}}if(or&zr)for(var An=Mr,Bn=Mr+cr*(rr-Yr);An<=Bn;An+=dn){var mn=An+ln;Dr?ir(Wt[An+jt],Wt[mn+jt]):ur(Wt[An+jt],Wt[mn+jt]),cn=er.a,Wt[mn+jt]=er.b,Wt[An+jt]=cn}Yr=zr,zr>>=1}return Mr}function lr(Wt,jt,rr,cr,or,vr,Br,Dr,Gr,zr){for(var Yr=0,Mr=0,Zr=Dr,Kr=Math.trunc(or.value+(vr+7)/8);or.value<Kr;)for($t(Yr,Mr,rr,or),Yr=Ut.c,Mr=Ut.lc;Mr>=14;){var qr=Yr>>Mr-14&16383,ln=jt[qr];if(ln.len)Mr-=ln.len,Zt(ln.lit,Br,Yr,Mr,rr,cr,or,Gr,zr,Zr),Yr=Vt.c,Mr=Vt.lc;else{if(!ln.p)throw"hufDecode issues";var dn;for(dn=0;dn<ln.lit;dn++){for(var cn=zt(Wt[ln.p[dn]]);Mr<cn&&or.value<Kr;)$t(Yr,Mr,rr,or),Yr=Ut.c,Mr=Ut.lc;if(Mr>=cn&&Dt(Wt[ln.p[dn]])==(Yr>>Mr-cn&(1<<cn)-1)){Mr-=cn,Zt(ln.p[dn],Br,Yr,Mr,rr,cr,or,Gr,zr,Zr),Yr=Vt.c,Mr=Vt.lc;break}}if(dn==ln.lit)throw"hufDecode issues"}}var _i=8-vr&7;for(Yr>>=_i,Mr-=_i;Mr>0;){var ln=jt[Yr<<14-Mr&16383];if(ln.len)Mr-=ln.len,Zt(ln.lit,Br,Yr,Mr,rr,cr,or,Gr,zr,Zr),Yr=Vt.c,Mr=Vt.lc;else throw"hufDecode issues"}return!0}function gr(Wt,jt,rr,cr,or,vr){var Br={value:0},Dr=rr.value,Gr=yr(jt,rr),zr=yr(jt,rr);rr.value+=4;var Yr=yr(jt,rr);if(rr.value+=4,Gr<0||Gr>=65537||zr<0||zr>=65537)throw"Something wrong with HUF_ENCSIZE";var Mr=new Array(65537),Zr=new Array(16384);Mt(Zr);var Kr=cr-(rr.value-Dr);if(Nt(Wt,jt,rr,Kr,Gr,zr,Mr),Yr>8*(cr-(rr.value-Dr)))throw"Something wrong with hufUncompress";Ft(Mr,Gr,zr,Zr),lr(Mr,Zr,Wt,jt,rr,Yr,zr,vr,or,Br)}function Yt(Wt,jt,rr){for(var cr=0;cr<rr;++cr)jt[cr]=Wt[jt[cr]]}function nr(Wt){for(var jt=1;jt<Wt.length;jt++){var rr=Wt[jt-1]+Wt[jt]-128;Wt[jt]=rr}}function mr(Wt,jt){for(var rr=0,cr=Math.floor((Wt.length+1)/2),or=0,vr=Wt.length-1;!(or>vr||(jt[or++]=Wt[rr++],or>vr));)jt[or++]=Wt[cr++]}function Sr(Wt){for(var jt=Wt.byteLength,rr=new Array,cr=0,or=new DataView(Wt);jt>0;){var vr=or.getInt8(cr++);if(vr<0){var Br=-vr;jt-=Br+1;for(var Dr=0;Dr<Br;Dr++)rr.push(or.getUint8(cr++))}else{var Br=vr;jt-=2;for(var Gr=or.getUint8(cr++),Dr=0;Dr<Br+1;Dr++)rr.push(Gr)}}return rr}function Er(Wt,jt,rr,cr,or,vr){var mn=new DataView(vr.buffer),Br=rr[Wt.idx[0]].width,Dr=rr[Wt.idx[0]].height,Gr=3,zr=Math.floor(Br/8),Yr=Math.ceil(Br/8),Mr=Math.ceil(Dr/8),Zr=Br-(Yr-1)*8,Kr=Dr-(Mr-1)*8,qr={value:0},ln=new Array(Gr),dn=new Array(Gr),cn=new Array(Gr),_i=new Array(Gr),fn=new Array(Gr);for(let bn=0;bn<Gr;++bn)fn[bn]=jt[Wt.idx[bn]],ln[bn]=bn<1?0:ln[bn-1]+Yr*Mr,dn[bn]=new Float32Array(64),cn[bn]=new Uint16Array(64),_i[bn]=new Uint16Array(Yr*64);for(let bn=0;bn<Mr;++bn){var on=8;bn==Mr-1&&(on=Kr);var An=8;for(let Ln=0;Ln<Yr;++Ln){Ln==Yr-1&&(An=Zr);for(let xn=0;xn<Gr;++xn)cn[xn].fill(0),cn[xn][0]=or[ln[xn]++],Nr(qr,cr,cn[xn]),wr(cn[xn],dn[xn]),kr(dn[xn]);Ur(dn);for(let xn=0;xn<Gr;++xn)Or(dn[xn],_i[xn],Ln*64)}let Vn=0;for(let Ln=0;Ln<Gr;++Ln){const xn=rr[Wt.idx[Ln]].type;for(let Yn=8*bn;Yn<8*bn+on;++Yn){Vn=fn[Ln][Yn];for(let _s=0;_s<zr;++_s){const qn=_s*64+(Yn&7)*8;mn.setUint16(Vn+0*2*xn,_i[Ln][qn+0],!0),mn.setUint16(Vn+1*2*xn,_i[Ln][qn+1],!0),mn.setUint16(Vn+2*2*xn,_i[Ln][qn+2],!0),mn.setUint16(Vn+3*2*xn,_i[Ln][qn+3],!0),mn.setUint16(Vn+4*2*xn,_i[Ln][qn+4],!0),mn.setUint16(Vn+5*2*xn,_i[Ln][qn+5],!0),mn.setUint16(Vn+6*2*xn,_i[Ln][qn+6],!0),mn.setUint16(Vn+7*2*xn,_i[Ln][qn+7],!0),Vn+=8*2*xn}}if(zr!=Yr)for(let Yn=8*bn;Yn<8*bn+on;++Yn){const _s=fn[Ln][Yn]+8*zr*2*xn,qn=zr*64+(Yn&7)*8;for(let Ts=0;Ts<An;++Ts)mn.setUint16(_s+Ts*2*xn,_i[Ln][qn+Ts],!0)}}}for(var Bn=new Uint16Array(Br),mn=new DataView(vr.buffer),Dn=0;Dn<Gr;++Dn){rr[Wt.idx[Dn]].decoded=!0;var On=rr[Wt.idx[Dn]].type;if(rr[Dn].type==2)for(var Fn=0;Fn<Dr;++Fn){const bn=fn[Dn][Fn];for(var zn=0;zn<Br;++zn)Bn[zn]=mn.getUint16(bn+zn*2*On,!0);for(var zn=0;zn<Br;++zn)mn.setFloat32(bn+zn*2*On,Rr(Bn[zn]),!0)}}}function Nr(Wt,jt,rr){for(var cr,or=1;or<64;)cr=jt[Wt.value],cr==65280?or=64:cr>>8==255?or+=cr&255:(rr[or]=cr,or++),Wt.value++}function wr(Wt,jt){jt[0]=Rr(Wt[0]),jt[1]=Rr(Wt[1]),jt[2]=Rr(Wt[5]),jt[3]=Rr(Wt[6]),jt[4]=Rr(Wt[14]),jt[5]=Rr(Wt[15]),jt[6]=Rr(Wt[27]),jt[7]=Rr(Wt[28]),jt[8]=Rr(Wt[2]),jt[9]=Rr(Wt[4]),jt[10]=Rr(Wt[7]),jt[11]=Rr(Wt[13]),jt[12]=Rr(Wt[16]),jt[13]=Rr(Wt[26]),jt[14]=Rr(Wt[29]),jt[15]=Rr(Wt[42]),jt[16]=Rr(Wt[3]),jt[17]=Rr(Wt[8]),jt[18]=Rr(Wt[12]),jt[19]=Rr(Wt[17]),jt[20]=Rr(Wt[25]),jt[21]=Rr(Wt[30]),jt[22]=Rr(Wt[41]),jt[23]=Rr(Wt[43]),jt[24]=Rr(Wt[9]),jt[25]=Rr(Wt[11]),jt[26]=Rr(Wt[18]),jt[27]=Rr(Wt[24]),jt[28]=Rr(Wt[31]),jt[29]=Rr(Wt[40]),jt[30]=Rr(Wt[44]),jt[31]=Rr(Wt[53]),jt[32]=Rr(Wt[10]),jt[33]=Rr(Wt[19]),jt[34]=Rr(Wt[23]),jt[35]=Rr(Wt[32]),jt[36]=Rr(Wt[39]),jt[37]=Rr(Wt[45]),jt[38]=Rr(Wt[52]),jt[39]=Rr(Wt[54]),jt[40]=Rr(Wt[20]),jt[41]=Rr(Wt[22]),jt[42]=Rr(Wt[33]),jt[43]=Rr(Wt[38]),jt[44]=Rr(Wt[46]),jt[45]=Rr(Wt[51]),jt[46]=Rr(Wt[55]),jt[47]=Rr(Wt[60]),jt[48]=Rr(Wt[21]),jt[49]=Rr(Wt[34]),jt[50]=Rr(Wt[37]),jt[51]=Rr(Wt[47]),jt[52]=Rr(Wt[50]),jt[53]=Rr(Wt[56]),jt[54]=Rr(Wt[59]),jt[55]=Rr(Wt[61]),jt[56]=Rr(Wt[35]),jt[57]=Rr(Wt[36]),jt[58]=Rr(Wt[48]),jt[59]=Rr(Wt[49]),jt[60]=Rr(Wt[57]),jt[61]=Rr(Wt[58]),jt[62]=Rr(Wt[62]),jt[63]=Rr(Wt[63])}function kr(Wt){const jt=.5*Math.cos(.7853975),rr=.5*Math.cos(3.14159/16),cr=.5*Math.cos(3.14159/8),or=.5*Math.cos(3*3.14159/16),vr=.5*Math.cos(5*3.14159/16),Br=.5*Math.cos(3*3.14159/8),Dr=.5*Math.cos(7*3.14159/16);for(var Gr=new Array(4),zr=new Array(4),Yr=new Array(4),Mr=new Array(4),Zr=0;Zr<8;++Zr){var Kr=Zr*8;Gr[0]=cr*Wt[Kr+2],Gr[1]=Br*Wt[Kr+2],Gr[2]=cr*Wt[Kr+6],Gr[3]=Br*Wt[Kr+6],zr[0]=rr*Wt[Kr+1]+or*Wt[Kr+3]+vr*Wt[Kr+5]+Dr*Wt[Kr+7],zr[1]=or*Wt[Kr+1]-Dr*Wt[Kr+3]-rr*Wt[Kr+5]-vr*Wt[Kr+7],zr[2]=vr*Wt[Kr+1]-rr*Wt[Kr+3]+Dr*Wt[Kr+5]+or*Wt[Kr+7],zr[3]=Dr*Wt[Kr+1]-vr*Wt[Kr+3]+or*Wt[Kr+5]-rr*Wt[Kr+7],Yr[0]=jt*(Wt[Kr+0]+Wt[Kr+4]),Yr[3]=jt*(Wt[Kr+0]-Wt[Kr+4]),Yr[1]=Gr[0]+Gr[3],Yr[2]=Gr[1]-Gr[2],Mr[0]=Yr[0]+Yr[1],Mr[1]=Yr[3]+Yr[2],Mr[2]=Yr[3]-Yr[2],Mr[3]=Yr[0]-Yr[1],Wt[Kr+0]=Mr[0]+zr[0],Wt[Kr+1]=Mr[1]+zr[1],Wt[Kr+2]=Mr[2]+zr[2],Wt[Kr+3]=Mr[3]+zr[3],Wt[Kr+4]=Mr[3]-zr[3],Wt[Kr+5]=Mr[2]-zr[2],Wt[Kr+6]=Mr[1]-zr[1],Wt[Kr+7]=Mr[0]-zr[0]}for(var qr=0;qr<8;++qr)Gr[0]=cr*Wt[16+qr],Gr[1]=Br*Wt[16+qr],Gr[2]=cr*Wt[48+qr],Gr[3]=Br*Wt[48+qr],zr[0]=rr*Wt[8+qr]+or*Wt[24+qr]+vr*Wt[40+qr]+Dr*Wt[56+qr],zr[1]=or*Wt[8+qr]-Dr*Wt[24+qr]-rr*Wt[40+qr]-vr*Wt[56+qr],zr[2]=vr*Wt[8+qr]-rr*Wt[24+qr]+Dr*Wt[40+qr]+or*Wt[56+qr],zr[3]=Dr*Wt[8+qr]-vr*Wt[24+qr]+or*Wt[40+qr]-rr*Wt[56+qr],Yr[0]=jt*(Wt[qr]+Wt[32+qr]),Yr[3]=jt*(Wt[qr]-Wt[32+qr]),Yr[1]=Gr[0]+Gr[3],Yr[2]=Gr[1]-Gr[2],Mr[0]=Yr[0]+Yr[1],Mr[1]=Yr[3]+Yr[2],Mr[2]=Yr[3]-Yr[2],Mr[3]=Yr[0]-Yr[1],Wt[0+qr]=Mr[0]+zr[0],Wt[8+qr]=Mr[1]+zr[1],Wt[16+qr]=Mr[2]+zr[2],Wt[24+qr]=Mr[3]+zr[3],Wt[32+qr]=Mr[3]-zr[3],Wt[40+qr]=Mr[2]-zr[2],Wt[48+qr]=Mr[1]-zr[1],Wt[56+qr]=Mr[0]-zr[0]}function Ur(Wt){for(var jt=0;jt<64;++jt){var rr=Wt[0][jt],cr=Wt[1][jt],or=Wt[2][jt];Wt[0][jt]=rr+1.5747*or,Wt[1][jt]=rr-.1873*cr-.4682*or,Wt[2][jt]=rr+1.8556*cr}}function Or(Wt,jt,rr){for(var cr=0;cr<64;++cr)jt[rr+cr]=DataUtils.toHalfFloat(Xr(Wt[cr]))}function Xr(Wt){return Wt<=1?Math.sign(Wt)*Math.pow(Math.abs(Wt),2.2):Math.sign(Wt)*Math.pow(Et,Math.abs(Wt)-1)}function Qt(Wt){return new DataView(Wt.array.buffer,Wt.offset.value,Wt.size)}function Xt(Wt){var jt=Wt.viewer.buffer.slice(Wt.offset.value,Wt.offset.value+Wt.size),rr=new Uint8Array(Sr(jt)),cr=new Uint8Array(rr.length);return nr(rr),mr(rr,cr),new DataView(cr.buffer)}function xr(Wt){var jt=Wt.array.slice(Wt.offset.value,Wt.offset.value+Wt.size),rr=unzlibSync(jt),cr=new Uint8Array(rr.length);return nr(rr),mr(rr,cr),new DataView(cr.buffer)}function Lr(Wt){for(var jt=Wt.viewer,rr={value:Wt.offset.value},cr=new Uint16Array(Wt.width*Wt.scanlineBlockSize*(Wt.channels*Wt.type)),or=new Uint8Array(8192),vr=0,Br=new Array(Wt.channels),Dr=0;Dr<Wt.channels;Dr++)Br[Dr]={},Br[Dr].start=vr,Br[Dr].end=Br[Dr].start,Br[Dr].nx=Wt.width,Br[Dr].ny=Wt.lines,Br[Dr].size=Wt.type,vr+=Br[Dr].nx*Br[Dr].ny*Br[Dr].size;var Gr=Tr(jt,rr),zr=Tr(jt,rr);if(zr>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Gr<=zr)for(var Dr=0;Dr<zr-Gr+1;Dr++)or[Dr+Gr]=_r(jt,rr);var Yr=new Uint16Array(65536),Mr=Tt(or,Yr),Zr=yr(jt,rr);gr(Wt.array,jt,rr,Zr,cr,vr);for(var Dr=0;Dr<Wt.channels;++Dr)for(var Kr=Br[Dr],qr=0;qr<Br[Dr].size;++qr)ar(cr,Kr.start+qr,Kr.nx,Kr.size,Kr.ny,Kr.nx*Kr.size,Mr);Yt(Yr,cr,vr);for(var ln=0,dn=new Uint8Array(cr.buffer.byteLength),cn=0;cn<Wt.lines;cn++)for(var _i=0;_i<Wt.channels;_i++){var Kr=Br[_i],fn=Kr.nx*Kr.size,on=new Uint8Array(cr.buffer,Kr.end*2,fn*2);dn.set(on,ln),ln+=fn*2,Kr.end+=fn}return new DataView(dn.buffer)}function fr(Wt){var jt=Wt.array.slice(Wt.offset.value,Wt.offset.value+Wt.size),rr=unzlibSync(jt);const cr=Wt.lines*Wt.channels*Wt.width,or=Wt.type==1?new Uint16Array(cr):new Uint32Array(cr);let vr=0,Br=0;const Dr=new Array(4);for(let Gr=0;Gr<Wt.lines;Gr++)for(let zr=0;zr<Wt.channels;zr++){let Yr=0;switch(Wt.type){case 1:Dr[0]=vr,Dr[1]=Dr[0]+Wt.width,vr=Dr[1]+Wt.width;for(let Mr=0;Mr<Wt.width;++Mr){const Zr=rr[Dr[0]++]<<8|rr[Dr[1]++];Yr+=Zr,or[Br]=Yr,Br++}break;case 2:Dr[0]=vr,Dr[1]=Dr[0]+Wt.width,Dr[2]=Dr[1]+Wt.width,vr=Dr[2]+Wt.width;for(let Mr=0;Mr<Wt.width;++Mr){const Zr=rr[Dr[0]++]<<24|rr[Dr[1]++]<<16|rr[Dr[2]++]<<8;Yr+=Zr,or[Br]=Yr,Br++}break}}return new DataView(or.buffer)}function pr(Wt){var jt=Wt.viewer,rr={value:Wt.offset.value},cr=new Uint8Array(Wt.width*Wt.lines*(Wt.channels*Wt.type*2)),or={version:Kt(jt,rr),unknownUncompressedSize:Kt(jt,rr),unknownCompressedSize:Kt(jt,rr),acCompressedSize:Kt(jt,rr),dcCompressedSize:Kt(jt,rr),rleCompressedSize:Kt(jt,rr),rleUncompressedSize:Kt(jt,rr),rleRawSize:Kt(jt,rr),totalAcUncompressedCount:Kt(jt,rr),totalDcUncompressedCount:Kt(jt,rr),acCompression:Kt(jt,rr)};if(or.version<2)throw"EXRLoader.parse: "+_n.compression+" version "+or.version+" is unsupported";for(var vr=new Array,Br=Tr(jt,rr)-2;Br>0;){var Dr=Hr(jt.buffer,rr),Gr=_r(jt,rr),zr=Gr>>2&3,Yr=(Gr>>4)-1,Mr=new Int8Array([Yr])[0],Zr=_r(jt,rr);vr.push({name:Dr,index:Mr,type:Zr,compression:zr}),Br-=Dr.length+3}for(var Kr=_n.channels,qr=new Array(Wt.channels),ln=0;ln<Wt.channels;++ln){var dn=qr[ln]={},cn=Kr[ln];dn.name=cn.name,dn.compression=0,dn.decoded=!1,dn.type=cn.pixelType,dn.pLinear=cn.pLinear,dn.width=Wt.width,dn.height=Wt.lines}for(var _i={idx:new Array(3)},fn=0;fn<Wt.channels;++fn)for(var dn=qr[fn],ln=0;ln<vr.length;++ln){var on=vr[ln];dn.name==on.name&&(dn.compression=on.compression,on.index>=0&&(_i.idx[on.index]=fn),dn.offset=fn)}if(or.acCompressedSize>0)switch(or.acCompression){case 0:var mn=new Uint16Array(or.totalAcUncompressedCount);gr(Wt.array,jt,rr,or.acCompressedSize,mn,or.totalAcUncompressedCount);break;case 1:var An=Wt.array.slice(rr.value,rr.value+or.totalAcUncompressedCount),Bn=unzlibSync(An),mn=new Uint16Array(Bn.buffer);rr.value+=or.totalAcUncompressedCount;break}if(or.dcCompressedSize>0){var Dn={array:Wt.array,offset:rr,size:or.dcCompressedSize},On=new Uint16Array(xr(Dn).buffer);rr.value+=or.dcCompressedSize}if(or.rleRawSize>0){var An=Wt.array.slice(rr.value,rr.value+or.rleCompressedSize),Bn=unzlibSync(An),Fn=Sr(Bn.buffer);rr.value+=or.rleCompressedSize}for(var zn=0,bn=new Array(qr.length),ln=0;ln<bn.length;++ln)bn[ln]=new Array;for(var Vn=0;Vn<Wt.lines;++Vn)for(var Ln=0;Ln<qr.length;++Ln)bn[Ln].push(zn),zn+=qr[Ln].width*Wt.type*2;Er(_i,bn,qr,mn,On,cr);for(var ln=0;ln<qr.length;++ln){var dn=qr[ln];if(!dn.decoded)switch(dn.compression){case 2:for(var xn=0,Yn=0,Vn=0;Vn<Wt.lines;++Vn){for(var _s=bn[ln][xn],qn=0;qn<dn.width;++qn){for(var Ts=0;Ts<2*dn.type;++Ts)cr[_s++]=Fn[Yn+Ts*dn.width*dn.height];Yn++}xn++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(cr.buffer)}function Hr(Wt,jt){for(var rr=new Uint8Array(Wt),cr=0;rr[jt.value+cr]!=0;)cr+=1;var or=new TextDecoder().decode(rr.slice(jt.value,jt.value+cr));return jt.value=jt.value+cr+1,or}function hr(Wt,jt,rr){var cr=new TextDecoder().decode(new Uint8Array(Wt).slice(jt.value,jt.value+rr));return jt.value=jt.value+rr,cr}function Cr(Wt,jt){var rr=Ar(Wt,jt),cr=yr(Wt,jt);return[rr,cr]}function tr(Wt,jt){var rr=yr(Wt,jt),cr=yr(Wt,jt);return[rr,cr]}function Ar(Wt,jt){var rr=Wt.getInt32(jt.value,!0);return jt.value=jt.value+4,rr}function yr(Wt,jt){var rr=Wt.getUint32(jt.value,!0);return jt.value=jt.value+4,rr}function Jt(Wt,jt){var rr=Wt[jt.value];return jt.value=jt.value+1,rr}function _r(Wt,jt){var rr=Wt.getUint8(jt.value);return jt.value=jt.value+1,rr}const Kt=function(Wt,jt){let rr;return"getBigInt64"in DataView.prototype?rr=Number(Wt.getBigInt64(jt.value,!0)):rr=Wt.getUint32(jt.value+4,!0)+Number(Wt.getUint32(jt.value,!0)<<32),jt.value+=8,rr};function Qr(Wt,jt){var rr=Wt.getFloat32(jt.value,!0);return jt.value+=4,rr}function br(Wt,jt){return DataUtils.toHalfFloat(Qr(Wt,jt))}function Rr(Wt){var jt=(Wt&31744)>>10,rr=Wt&1023;return(Wt>>15?-1:1)*(jt?jt===31?rr?NaN:1/0:Math.pow(2,jt-15)*(1+rr/1024):6103515625e-14*(rr/1024))}function Tr(Wt,jt){var rr=Wt.getUint16(jt.value,!0);return jt.value+=2,rr}function Vr(Wt,jt){return Rr(Tr(Wt,jt))}function Wr(Wt,jt,rr,cr){for(var or=rr.value,vr=[];rr.value<or+cr-1;){var Br=Hr(jt,rr),Dr=Ar(Wt,rr),Gr=_r(Wt,rr);rr.value+=3;var zr=Ar(Wt,rr),Yr=Ar(Wt,rr);vr.push({name:Br,pixelType:Dr,pLinear:Gr,xSampling:zr,ySampling:Yr})}return rr.value+=1,vr}function pn(Wt,jt){var rr=Qr(Wt,jt),cr=Qr(Wt,jt),or=Qr(Wt,jt),vr=Qr(Wt,jt),Br=Qr(Wt,jt),Dr=Qr(Wt,jt),Gr=Qr(Wt,jt),zr=Qr(Wt,jt);return{redX:rr,redY:cr,greenX:or,greenY:vr,blueX:Br,blueY:Dr,whiteX:Gr,whiteY:zr}}function En(Wt,jt){var rr=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],cr=_r(Wt,jt);return rr[cr]}function rn(Wt,jt){var rr=yr(Wt,jt),cr=yr(Wt,jt),or=yr(Wt,jt),vr=yr(Wt,jt);return{xMin:rr,yMin:cr,xMax:or,yMax:vr}}function Cn(Wt,jt){var rr=["INCREASING_Y"],cr=_r(Wt,jt);return rr[cr]}function vn(Wt,jt){var rr=Qr(Wt,jt),cr=Qr(Wt,jt);return[rr,cr]}function an(Wt,jt){var rr=Qr(Wt,jt),cr=Qr(Wt,jt),or=Qr(Wt,jt);return[rr,cr,or]}function yn(Wt,jt,rr,cr,or){if(cr==="string"||cr==="stringvector"||cr==="iccProfile")return hr(jt,rr,or);if(cr==="chlist")return Wr(Wt,jt,rr,or);if(cr==="chromaticities")return pn(Wt,rr);if(cr==="compression")return En(Wt,rr);if(cr==="box2i")return rn(Wt,rr);if(cr==="lineOrder")return Cn(Wt,rr);if(cr==="float")return Qr(Wt,rr);if(cr==="v2f")return vn(Wt,rr);if(cr==="v3f")return an(Wt,rr);if(cr==="int")return Ar(Wt,rr);if(cr==="rational")return Cr(Wt,rr);if(cr==="timecode")return tr(Wt,rr);if(cr==="preview")return rr.value+=or,"skipped";rr.value+=or}function Gn(Wt,jt,rr){const cr={};if(Wt.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";cr.version=Wt.getUint8(4);const or=Wt.getUint8(5);cr.spec={singleTile:!!(or&2),longName:!!(or&4),deepFormat:!!(or&8),multiPart:!!(or&16)},rr.value=8;for(var vr=!0;vr;){var Br=Hr(jt,rr);if(Br==0)vr=!1;else{var Dr=Hr(jt,rr),Gr=yr(Wt,rr),zr=yn(Wt,jt,rr,Dr,Gr);zr===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Dr}'.`):cr[Br]=zr}}if(or!=0)throw console.error("EXRHeader:",cr),"THREE.EXRLoader: provided file is currently unsupported.";return cr}function Pn(Wt,jt,rr,cr,or){const vr={size:0,viewer:jt,array:rr,offset:cr,width:Wt.dataWindow.xMax-Wt.dataWindow.xMin+1,height:Wt.dataWindow.yMax-Wt.dataWindow.yMin+1,channels:Wt.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:Wt.channels[0].pixelType,uncompress:null,getter:null,format:null,[hasColorSpace?"colorSpace":"encoding"]:null};switch(Wt.compression){case"NO_COMPRESSION":vr.lines=1,vr.uncompress=Qt;break;case"RLE_COMPRESSION":vr.lines=1,vr.uncompress=Xt;break;case"ZIPS_COMPRESSION":vr.lines=1,vr.uncompress=xr;break;case"ZIP_COMPRESSION":vr.lines=16,vr.uncompress=xr;break;case"PIZ_COMPRESSION":vr.lines=32,vr.uncompress=Lr;break;case"PXR24_COMPRESSION":vr.lines=16,vr.uncompress=fr;break;case"DWAA_COMPRESSION":vr.lines=32,vr.uncompress=pr;break;case"DWAB_COMPRESSION":vr.lines=256,vr.uncompress=pr;break;default:throw"EXRLoader.parse: "+Wt.compression+" is unsupported"}if(vr.scanlineBlockSize=vr.lines,vr.type==1)switch(or){case FloatType:vr.getter=Vr,vr.inputSize=2;break;case HalfFloatType:vr.getter=Tr,vr.inputSize=2;break}else if(vr.type==2)switch(or){case FloatType:vr.getter=Qr,vr.inputSize=4;break;case HalfFloatType:vr.getter=br,vr.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+vr.type+" for "+Wt.compression+".";vr.blockCount=(Wt.dataWindow.yMax+1)/vr.scanlineBlockSize;for(var Br=0;Br<vr.blockCount;Br++)Kt(jt,cr);vr.outputChannels=vr.channels==3?4:vr.channels;const Dr=vr.width*vr.height*vr.outputChannels;switch(or){case FloatType:vr.byteArray=new Float32Array(Dr),vr.channels<vr.outputChannels&&vr.byteArray.fill(1,0,Dr);break;case HalfFloatType:vr.byteArray=new Uint16Array(Dr),vr.channels<vr.outputChannels&&vr.byteArray.fill(15360,0,Dr);break;default:console.error("THREE.EXRLoader: unsupported type: ",or);break}return vr.bytesPerLine=vr.width*vr.inputSize*vr.channels,vr.outputChannels==4?vr.format=RGBAFormat:vr.format=RedFormat,hasColorSpace?vr.colorSpace="srgb-linear":vr.encoding=3e3,vr}const Sn=new DataView(_e),In=new Uint8Array(_e),jn={value:0},_n=Gn(Sn,_e,jn),nn=Pn(_n,Sn,In,jn,this.type),Nn={value:0},bs={R:0,G:1,B:2,A:3,Y:0};for(let Wt=0;Wt<nn.height/nn.scanlineBlockSize;Wt++){const jt=yr(Sn,jn);nn.size=yr(Sn,jn),nn.lines=jt+nn.scanlineBlockSize>nn.height?nn.height-jt:nn.scanlineBlockSize;const cr=nn.size<nn.lines*nn.bytesPerLine?nn.uncompress(nn):Qt(nn);jn.value+=nn.size;for(let or=0;or<nn.scanlineBlockSize;or++){const vr=or+Wt*nn.scanlineBlockSize;if(vr>=nn.height)break;for(let Br=0;Br<nn.channels;Br++){const Dr=bs[_n.channels[Br].name];for(let Gr=0;Gr<nn.width;Gr++){Nn.value=(or*(nn.channels*nn.width)+Br*nn.width+Gr)*nn.inputSize;const zr=(nn.height-1-vr)*(nn.width*nn.outputChannels)+Gr*nn.outputChannels+Dr;nn.byteArray[zr]=nn.getter(cr,Nn)}}}}return{header:_n,width:nn.width,height:nn.height,data:nn.byteArray,format:nn.format,[hasColorSpace?"colorSpace":"encoding"]:nn[hasColorSpace?"colorSpace":"encoding"],type:this.type}}setDataType(_e){return this.type=_e,this}load(_e,rt,it,nt){function st(at,lt){hasColorSpace?at.colorSpace=lt.colorSpace:at.encoding=lt.encoding,at.minFilter=LinearFilter,at.magFilter=LinearFilter,at.generateMipmaps=!1,at.flipY=!1,rt&&rt(at,lt)}return super.load(_e,st,it,nt)}}const _taskCache$2=new WeakMap,_BasisTextureLoader=class extends Loader{constructor(tt){super(tt),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig=null}setTranscoderPath(tt){return this.transcoderPath=tt,this}setWorkerLimit(tt){return this.workerLimit=tt,this}detectSupport(tt){return this.workerConfig={astcSupported:tt.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:tt.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:tt.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:tt.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:tt.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:tt.extensions.has("WEBGL_compressed_texture_pvrtc")||tt.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}load(tt,_e,rt,it){const nt=new FileLoader(this.manager);nt.setResponseType("arraybuffer"),nt.setWithCredentials(this.withCredentials);const st=new CompressedTexture;return nt.load(tt,at=>{if(_taskCache$2.has(at))return _taskCache$2.get(at).promise.then(_e).catch(it);this._createTexture([at]).then(function(lt){st.copy(lt),st.needsUpdate=!0,_e&&_e(st)}).catch(it)},rt,it),st}parseInternalAsync(tt){const{levels:_e}=tt,rt=new Set;for(let it=0;it<_e.length;it++)rt.add(_e[it].data.buffer);return this._createTexture(Array.from(rt),{...tt,lowLevel:!0})}_createTexture(tt,_e={}){let rt,it;const nt=_e;let st=0;for(let lt=0;lt<tt.length;lt++)st+=tt[lt].byteLength;const at=this._allocateWorker(st).then(lt=>(rt=lt,it=this.workerNextTaskID++,new Promise((ot,ct)=>{rt._callbacks[it]={resolve:ot,reject:ct},rt.postMessage({type:"transcode",id:it,buffers:tt,taskConfig:nt},tt)}))).then(lt=>{const{mipmaps:ot,width:ct,height:ut,format:ht}=lt,dt=new CompressedTexture(ot,ct,ut,ht,UnsignedByteType);return dt.minFilter=ot.length===1?LinearFilter:LinearMipmapLinearFilter,dt.magFilter=LinearFilter,dt.generateMipmaps=!1,dt.needsUpdate=!0,dt});return at.catch(()=>!0).then(()=>{rt&&it&&(rt._taskLoad-=st,delete rt._callbacks[it])}),_taskCache$2.set(tt[0],{promise:at}),at}_initTranscoder(){if(!this.transcoderPending){const tt=new FileLoader(this.manager);tt.setPath(this.transcoderPath),tt.setWithCredentials(this.withCredentials);const _e=new Promise((nt,st)=>{tt.load("basis_transcoder.js",nt,void 0,st)}),rt=new FileLoader(this.manager);rt.setPath(this.transcoderPath),rt.setResponseType("arraybuffer"),rt.setWithCredentials(this.withCredentials);const it=new Promise((nt,st)=>{rt.load("basis_transcoder.wasm",nt,void 0,st)});this.transcoderPending=Promise.all([_e,it]).then(([nt,st])=>{const at=_BasisTextureLoader.BasisWorker.toString(),lt=["/* constants */","let _EngineFormat = "+JSON.stringify(_BasisTextureLoader.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(_BasisTextureLoader.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(_BasisTextureLoader.BasisFormat),"/* basis_transcoder.js */",nt,"/* worker */",at.substring(at.indexOf("{")+1,at.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([lt])),this.transcoderBinary=st})}return this.transcoderPending}_allocateWorker(tt){return this._initTranscoder().then(()=>{if(this.workerPool.length<this.workerLimit){const rt=new Worker(this.workerSourceURL);rt._callbacks={},rt._taskLoad=0,rt.postMessage({type:"init",config:this.workerConfig,transcoderBinary:this.transcoderBinary}),rt.onmessage=function(it){const nt=it.data;switch(nt.type){case"transcode":rt._callbacks[nt.id].resolve(nt);break;case"error":rt._callbacks[nt.id].reject(nt);break;default:console.error('THREE.BasisTextureLoader: Unexpected message, "'+nt.type+'"')}},this.workerPool.push(rt)}else this.workerPool.sort(function(rt,it){return rt._taskLoad>it._taskLoad?-1:1});const _e=this.workerPool[this.workerPool.length-1];return _e._taskLoad+=tt,_e})}dispose(){for(let tt=0;tt<this.workerPool.length;tt++)this.workerPool[tt].terminate();return this.workerPool.length=0,this}};let BasisTextureLoader=_BasisTextureLoader;__publicField(BasisTextureLoader,"BasisFormat",{ETC1S:0,UASTC_4x4:1});__publicField(BasisTextureLoader,"TranscoderFormat",{ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16});__publicField(BasisTextureLoader,"EngineFormat",{RGBAFormat,RGBA_ASTC_4x4_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format});__publicField(BasisTextureLoader,"BasisWorker",function(){let tt,_e,rt;const it=_EngineFormat,nt=_TranscoderFormat,st=_BasisFormat;onmessage=function(yt){const bt=yt.data;switch(bt.type){case"init":tt=bt.config,at(bt.transcoderBinary);break;case"transcode":_e.then(()=>{try{const{width:xt,height:vt,hasAlpha:_t,mipmaps:Ct,format:St}=bt.taskConfig.lowLevel?lt(bt.taskConfig):ot(bt.buffers[0]),Et=[];for(let Tt=0;Tt<Ct.length;++Tt)Et.push(Ct[Tt].data.buffer);self.postMessage({type:"transcode",id:bt.id,width:xt,height:vt,hasAlpha:_t,mipmaps:Ct,format:St},Et)}catch(xt){console.error(xt),self.postMessage({type:"error",id:bt.id,error:xt.message})}});break}};function at(yt){_e=new Promise(bt=>{rt={wasmBinary:yt,onRuntimeInitialized:bt},BASIS(rt)}).then(()=>{rt.initializeBasis()})}function lt(yt){const{basisFormat:bt,width:xt,height:vt,hasAlpha:_t}=yt,{transcoderFormat:Ct,engineFormat:St}=dt(bt,xt,vt,_t),Et=rt.getBytesPerBlockOrPixel(Ct);pt(rt.isFormatSupported(Ct),"THREE.BasisTextureLoader: Unsupported format.");const Tt=[];if(bt===st.ETC1S){const Mt=new rt.LowLevelETC1SImageTranscoder,{endpointCount:Rt,endpointsData:It,selectorCount:Ot,selectorsData:Bt,tablesData:Nt}=yt.globalData;try{let zt;zt=Mt.decodePalettes(Rt,It,Ot,Bt),pt(zt,"THREE.BasisTextureLoader: decodePalettes() failed."),zt=Mt.decodeTables(Nt),pt(zt,"THREE.BasisTextureLoader: decodeTables() failed.");for(let Dt=0;Dt<yt.levels.length;Dt++){const Ft=yt.levels[Dt],Ut=yt.globalData.imageDescs[Dt],$t=mt(Ct,Ft.width,Ft.height),Vt=new Uint8Array($t);zt=Mt.transcodeImage(Ct,Vt,$t/Et,Ft.data,ft(Ct,Ft.width),gt(Ct,Ft.height),Ft.width,Ft.height,Ft.index,Ut.rgbSliceByteOffset,Ut.rgbSliceByteLength,Ut.alphaSliceByteOffset,Ut.alphaSliceByteLength,Ut.imageFlags,_t,!1,0,0),pt(zt,"THREE.BasisTextureLoader: transcodeImage() failed for level "+Ft.index+"."),Tt.push({data:Vt,width:Ft.width,height:Ft.height})}}finally{Mt.delete()}}else for(let Mt=0;Mt<yt.levels.length;Mt++){const Rt=yt.levels[Mt],It=mt(Ct,Rt.width,Rt.height),Ot=new Uint8Array(It),Bt=rt.transcodeUASTCImage(Ct,Ot,It/Et,Rt.data,ft(Ct,Rt.width),gt(Ct,Rt.height),Rt.width,Rt.height,Rt.index,0,Rt.data.byteLength,0,_t,!1,0,0,-1,-1);pt(Bt,"THREE.BasisTextureLoader: transcodeUASTCImage() failed for level "+Rt.index+"."),Tt.push({data:Ot,width:Rt.width,height:Rt.height})}return{width:xt,height:vt,hasAlpha:_t,mipmaps:Tt,format:St}}function ot(yt){const bt=new rt.BasisFile(new Uint8Array(yt)),xt=bt.isUASTC()?st.UASTC_4x4:st.ETC1S,vt=bt.getImageWidth(0,0),_t=bt.getImageHeight(0,0),Ct=bt.getNumLevels(0),St=bt.getHasAlpha();function Et(){bt.close(),bt.delete()}const{transcoderFormat:Tt,engineFormat:Mt}=dt(xt,vt,_t,St);if(!vt||!_t||!Ct)throw Et(),new Error("THREE.BasisTextureLoader:	Invalid texture");if(!bt.startTranscoding())throw Et(),new Error("THREE.BasisTextureLoader: .startTranscoding failed");const Rt=[];for(let It=0;It<Ct;It++){const Ot=bt.getImageWidth(0,It),Bt=bt.getImageHeight(0,It),Nt=new Uint8Array(bt.getImageTranscodedSizeInBytes(0,It,Tt));if(!bt.transcodeImage(Nt,0,It,Tt,0,St))throw Et(),new Error("THREE.BasisTextureLoader: .transcodeImage failed.");Rt.push({data:Nt,width:Ot,height:Bt})}return Et(),{width:vt,height:_t,hasAlpha:St,mipmaps:Rt,format:Mt}}const ct=[{if:"astcSupported",basisFormat:[st.UASTC_4x4],transcoderFormat:[nt.ASTC_4x4,nt.ASTC_4x4],engineFormat:[it.RGBA_ASTC_4x4_Format,it.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.BC7_M5,nt.BC7_M5],engineFormat:[it.RGBA_BPTC_Format,it.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.BC1,nt.BC3],engineFormat:[it.RGB_S3TC_DXT1_Format,it.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.ETC1,nt.ETC2],engineFormat:[it.RGB_ETC2_Format,it.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.ETC1,nt.ETC1],engineFormat:[it.RGB_ETC1_Format,it.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[st.ETC1S,st.UASTC_4x4],transcoderFormat:[nt.PVRTC1_4_RGB,nt.PVRTC1_4_RGBA],engineFormat:[it.RGB_PVRTC_4BPPV1_Format,it.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],ut=ct.sort(function(yt,bt){return yt.priorityETC1S-bt.priorityETC1S}),ht=ct.sort(function(yt,bt){return yt.priorityUASTC-bt.priorityUASTC});function dt(yt,bt,xt,vt){let _t,Ct;const St=yt===st.ETC1S?ut:ht;for(let Et=0;Et<St.length;Et++){const Tt=St[Et];if(tt[Tt.if]&&Tt.basisFormat.includes(yt)&&!(Tt.needsPowerOfTwo&&!(At(bt)&&At(xt))))return _t=Tt.transcoderFormat[vt?1:0],Ct=Tt.engineFormat[vt?1:0],{transcoderFormat:_t,engineFormat:Ct}}return console.warn("THREE.BasisTextureLoader: No suitable compressed texture format found. Decoding to RGBA32."),_t=nt.RGBA32,Ct=it.RGBAFormat,{transcoderFormat:_t,engineFormat:Ct}}function pt(yt,bt){if(!yt)throw new Error(bt)}function ft(yt,bt){return Math.ceil(bt/rt.getFormatBlockWidth(yt))}function gt(yt,bt){return Math.ceil(bt/rt.getFormatBlockHeight(yt))}function mt(yt,bt,xt){const vt=rt.getBytesPerBlockOrPixel(yt);if(rt.formatIsUncompressed(yt))return bt*xt*vt;if(yt===nt.PVRTC1_4_RGB||yt===nt.PVRTC1_4_RGBA){const _t=bt+3&-4,Ct=xt+3&-4;return(Math.max(8,_t)*Math.max(8,Ct)*4+7)/8}return ft(yt,bt)*gt(yt,xt)*vt}function At(yt){return yt<=2?!0:(yt&yt-1)===0&&yt!==0}});const DEFAULT_PROFILES_PATH="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",DEFAULT_PROFILE="generic-trigger";class XRControllerModelFactory{constructor(_e=null,rt=DEFAULT_PROFILES_PATH){this.gltfLoader=_e??new GLTFLoader$1,this.path=rt,this._assetCache={}}initializeControllerModel(_e,rt){return rt.targetRayMode!=="tracked-pointer"||!rt.gamepad?Promise.resolve():fetchProfile(rt,this.path,DEFAULT_PROFILE).then(({profile:it,assetPath:nt})=>{if(!nt)throw new Error("no asset path");const st=new MotionController(rt,it,nt);_e.connectMotionController(st);const at=st.assetUrl,lt=this._assetCache[at];if(lt){const ot=lt.scene.clone();_e.connectModel(ot)}else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(at,ot=>{if(!_e.motionController){console.warn("motionController gone while gltf load, bailing...");return}this._assetCache[at]=ot;const ct=ot.scene.clone();_e.connectModel(ct)},void 0,()=>{throw new Error(`Asset ${at} missing or malformed.`)})}}).catch(it=>{console.warn(it)})}}const isEnvMapApplicable=tt=>"envMap"in tt,updateEnvMap=(tt,_e)=>{tt.envMap=_e,tt.needsUpdate=!0},applyEnvironmentMap=(tt,_e)=>{_e instanceof Mesh&&(Array.isArray(_e.material)?_e.material.forEach(rt=>isEnvMapApplicable(rt)?updateEnvMap(rt,tt):void 0):isEnvMapApplicable(_e.material)&&updateEnvMap(_e.material,tt))},isEnvMapIntensityApplicable=tt=>"envMapIntensity"in tt,updateEnvMapIntensity=(tt,_e)=>{tt.envMapIntensity=_e,tt.needsUpdate=!0},applyEnvironmentMapIntensity=(tt,_e)=>{_e instanceof Mesh&&(Array.isArray(_e.material)?_e.material.forEach(rt=>isEnvMapIntensityApplicable(rt)?updateEnvMapIntensity(rt,tt):void 0):isEnvMapIntensityApplicable(_e.material)&&updateEnvMapIntensity(_e.material,tt))};function findNodes(tt,_e){Object.values(tt.components).forEach(rt=>{const{type:it,touchPointNodeName:nt,visualResponses:st}=rt;if(it===MotionControllerConstants.ComponentType.TOUCHPAD&&nt)if(rt.touchPointNode=_e.getObjectByName(nt),rt.touchPointNode){const at=new SphereGeometry(.001),lt=new MeshBasicMaterial({color:255}),ot=new Mesh(at,lt);rt.touchPointNode.add(ot)}else console.warn(`Could not find touch dot, ${rt.touchPointNodeName}, in touchpad component ${rt.id}`);Object.values(st).forEach(at=>{const{valueNodeName:lt,minNodeName:ot,maxNodeName:ct,valueNodeProperty:ut}=at;if(ut===MotionControllerConstants.VisualResponseProperty.TRANSFORM&&ot&&ct){if(at.minNode=_e.getObjectByName(ot),at.maxNode=_e.getObjectByName(ct),!at.minNode){console.warn(`Could not find ${ot} in the model`);return}if(!at.maxNode){console.warn(`Could not find ${ct} in the model`);return}}at.valueNode=_e.getObjectByName(lt),at.valueNode||console.warn(`Could not find ${lt} in the model`)})})}function addAssetSceneToControllerModel(tt,_e){findNodes(tt.motionController,_e),(tt.envMap||tt.envMapIntensity!=null)&&_e.traverse(rt=>{tt.envMap&&applyEnvironmentMap(tt.envMap,rt),tt.envMapIntensity!=null&&applyEnvironmentMapIntensity(tt.envMapIntensity,rt)}),tt.add(_e)}class XRControllerModel extends Group{constructor(){super(),this.motionController=null,this.envMap=null,this.envMapIntensity=1,this.scene=null}setEnvironmentMap(_e,rt=1){var it;return this.envMap===_e&&this.envMapIntensity===rt?this:(this.envMap=_e,this.envMapIntensity=rt,(it=this.scene)==null||it.traverse(nt=>{applyEnvironmentMap(_e,nt),applyEnvironmentMapIntensity(rt,nt)}),this)}setEnvironmentMapIntensity(_e){var rt;return this.envMapIntensity===_e?this:(this.envMapIntensity=_e,(rt=this.scene)==null||rt.traverse(it=>applyEnvironmentMapIntensity(_e,it)),this)}connectModel(_e){if(!this.motionController){console.warn("scene tried to add, but no motion controller");return}this.scene=_e,addAssetSceneToControllerModel(this,_e),this.dispatchEvent({type:"modelconnected",data:_e})}connectMotionController(_e){this.motionController=_e,this.dispatchEvent({type:"motionconnected",data:_e})}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(rt=>{Object.values(rt.visualResponses).forEach(it=>{const{valueNode:nt,minNode:st,maxNode:at,value:lt,valueNodeProperty:ot}=it;nt&&(ot===MotionControllerConstants.VisualResponseProperty.VISIBILITY&&typeof lt=="boolean"?nt.visible=lt:ot===MotionControllerConstants.VisualResponseProperty.TRANSFORM&&st&&at&&typeof lt=="number"&&(nt.quaternion.slerpQuaternions(st.quaternion,at.quaternion,lt),nt.position.lerpVectors(st.position,at.position,lt)))})}))}disconnect(){this.dispatchEvent({type:"motiondisconnected",data:this.motionController}),this.dispatchEvent({type:"modeldisconnected",data:this.scene}),this.motionController=null,this.scene&&this.remove(this.scene),this.scene=null}dispose(){this.disconnect()}}const Ray=reactExports.forwardRef(function({target:_e,hideOnBlur:rt=!1,...it},nt){const st=useXR(ot=>ot.hoverState),at=reactExports.useRef(null),lt=reactExports.useMemo(()=>new BufferGeometry().setFromPoints([new Vector3(0,0,0),new Vector3(0,0,-1)]),[]);return reactExports.useImperativeHandle(nt,()=>at.current),useFrame(()=>{if(!_e.inputSource)return;let ot=1;const ct=st[_e.inputSource.handedness].values().next().value;ct&&_e.inputSource.handedness!=="none"?(ot=ct.distance,rt&&(at.current.visible=!1)):rt&&(at.current.visible=!0);const ut=-.01;at.current.scale.z=ot+ut}),reactExports.createElement("line",{ref:at,geometry:lt,"material-opacity":.8,"material-transparent":!0,...it})}),modelFactory=new XRControllerModelFactory,ControllerModel=({target:tt,envMap:_e,envMapIntensity:rt})=>{const it=reactExports.useRef(null),nt=useCallbackRef$2(ot=>{_e!=null&&ot.setEnvironmentMap(_e)}),st=useCallbackRef$2(ot=>ot.setEnvironmentMap(null)),at=useCallbackRef$2(ot=>{rt!=null&&ot.setEnvironmentMapIntensity(rt)}),lt=reactExports.useCallback(ot=>{var ct,ut,ht;if(it.current=ot,ot){if(tt.xrControllerModel=ot,(ct=tt.inputSource)!=null&&ct.hand)return;nt.current(ot),at.current(ot),tt.inputSource?modelFactory.initializeControllerModel(ot,tt.inputSource):console.warn("no input source on XRController when handleControllerModel")}else{if((ut=tt.inputSource)!=null&&ut.hand)return;(ht=tt.xrControllerModel)==null||ht.disconnect(),tt.xrControllerModel=null}},[tt,at,nt]);return reactExports.useLayoutEffect(()=>{it.current&&(_e?nt.current(it.current):st.current(it.current))},[_e,nt,st]),reactExports.useLayoutEffect(()=>{it.current&&at.current(it.current)},[rt,at]),reactExports.createElement("xRControllerModel",{ref:lt})};function Controllers({rayMaterial:tt={},hideRaysOnBlur:_e=!1,envMap:rt,envMapIntensity:it}){const nt=useXR(lt=>lt.controllers),st=useXR(lt=>lt.isHandTracking),at=reactExports.useMemo(()=>Object.entries(tt).reduce((lt,[ot,ct])=>({...lt,[`material-${ot}`]:ct}),{}),[JSON.stringify(tt)]);return reactExports.useMemo(()=>extend$2({XRControllerModel}),[]),reactExports.createElement(reactExports.Fragment,null,nt.map((lt,ot)=>reactExports.createElement(reactExports.Fragment,{key:ot},createPortal(reactExports.createElement(ControllerModel,{target:lt,envMap:rt,envMapIntensity:it}),lt.grip),createPortal(reactExports.createElement(Ray,{visible:!st,hideOnBlur:_e,target:lt,...at}),lt.controller))))}const DEFAULT_HAND_PROFILE_PATH="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/generic-hand/";class XRHandMeshModel{constructor(_e,rt,it=DEFAULT_HAND_PROFILE_PATH,nt,st){this.controller=rt,this.handModel=_e,this.bones=[];const at=new GLTFLoader$1;st||at.setPath(it),at.load(st??`${nt}.glb`,lt=>{const ot=lt.scene.children[0];this.handModel.add(ot),this.scene=ot;const ct=ot.getObjectByProperty("type","SkinnedMesh");ct.frustumCulled=!1,ct.castShadow=!0,ct.receiveShadow=!0,["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"].forEach(ht=>{const dt=ot.getObjectByName(ht);dt!==void 0?dt.jointName=ht:console.warn(`Couldn't find ${ht} in ${nt} hand mesh`),this.bones.push(dt)})})}updateMesh(){const _e=this.controller.joints;let rt=!0;for(let it=0;it<this.bones.length;it++){const nt=this.bones[it];if(nt){const st=_e[nt.jointName];if(st.visible){const at=st.position;nt.position.copy(at),nt.quaternion.copy(st.quaternion),rt=!1}}}rt&&this.scene?this.scene.visible=!1:this.scene&&(this.scene.visible=!0)}dispose(){this.scene&&this.handModel.remove(this.scene)}}const TOUCH_RADIUS=.01,POINTING_JOINT="index-finger-tip";class OculusHandModel extends Object3D{constructor(_e,rt,it){super(),this._onConnected=nt=>{const st=nt.data;st.hand&&!this.motionController&&(this.xrInputSource=st,this.motionController=new XRHandMeshModel(this,this.controller,void 0,st.handedness,st.handedness==="left"?this.leftModelPath:this.rightModelPath))},this._onDisconnected=()=>{var nt;(nt=this.xrInputSource)!=null&&nt.hand&&this.motionControllerCleanup()},this.controller=_e,this.motionController=null,this.envMap=null,this.leftModelPath=rt,this.rightModelPath=it,this.mesh=null,this.xrInputSource=null,_e.addEventListener("connected",this._onConnected),_e.addEventListener("disconnected",this._onDisconnected)}motionControllerCleanup(){var _e;this.clear(),(_e=this.motionController)==null||_e.dispose(),this.motionController=null}updateMatrixWorld(_e){super.updateMatrixWorld(_e),this.motionController&&this.motionController.updateMesh()}getPointerPosition(){const _e=this.controller.joints[POINTING_JOINT];return _e?_e.position:null}intersectBoxObject(_e){const rt=this.getPointerPosition();if(rt){const it=new Sphere(rt,TOUCH_RADIUS),nt=new Box3().setFromObject(_e);return it.intersectsBox(nt)}else return!1}checkButton(_e){this.intersectBoxObject(_e)?_e.onPress():_e.onClear(),_e.isPressed()&&_e.whilePressed()}dispose(){this.motionControllerCleanup(),this.controller.removeEventListener("connected",this._onConnected),this.controller.removeEventListener("disconnected",this._onDisconnected)}}function Hands({modelLeft:tt,modelRight:_e}){const rt=useXR(it=>it.controllers);return reactExports.useMemo(()=>extend$2({OculusHandModel}),[]),useIsomorphicLayoutEffect(()=>{for(const it of rt)it.hand.dispatchEvent({type:"connected",data:it.inputSource,fake:!0})},[rt,tt,_e]),reactExports.createElement(reactExports.Fragment,null,rt.map(({hand:it})=>createPortal(reactExports.createElement("oculusHandModel",{args:[it,tt,_e]}),it)))}function Polyhedron({polyhedron_shape:tt,color:_e,wireframe:rt,...it}){const nt=reactExports.useRef(),[st,at]=reactExports.useState(2);return jsxRuntimeExports.jsx("mesh",{...it,ref:nt,onPointerDown:()=>{at((st+1)%3),console.log(st)},geometry:tt,children:jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:_e,wireframe:rt})})}function Floor(){return jsxRuntimeExports.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[40,40]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"#666"})]})}const NUMBER="[-+]?\\d*\\.?\\d+",PERCENTAGE=NUMBER+"%";function call$2(...tt){return"\\(\\s*("+tt.join(")\\s*,\\s*(")+")\\s*\\)"}new RegExp("rgb"+call$2(NUMBER,NUMBER,NUMBER));new RegExp("rgba"+call$2(NUMBER,NUMBER,NUMBER,NUMBER));new RegExp("hsl"+call$2(NUMBER,PERCENTAGE,PERCENTAGE));new RegExp("hsla"+call$2(NUMBER,PERCENTAGE,PERCENTAGE,NUMBER));const prefix="react-spring: ",once=tt=>{const _e=tt;let rt=!1;if(typeof _e!="function")throw new TypeError(`${prefix}once requires a function parameter`);return(...it)=>{rt||(_e(...it),rt=!0)}};once(console.warn);once(console.warn);function clamp$1(tt,_e,rt){return Math.max(_e,Math.min(tt,rt))}const V$2={toVector(tt,_e){return tt===void 0&&(tt=_e),Array.isArray(tt)?tt:[tt,tt]},add(tt,_e){return[tt[0]+_e[0],tt[1]+_e[1]]},sub(tt,_e){return[tt[0]-_e[0],tt[1]-_e[1]]},addTo(tt,_e){tt[0]+=_e[0],tt[1]+=_e[1]},subTo(tt,_e){tt[0]-=_e[0],tt[1]-=_e[1]}};function rubberband(tt,_e,rt){return _e===0||Math.abs(_e)===1/0?Math.pow(tt,rt*5):tt*_e*rt/(_e+rt*tt)}function rubberbandIfOutOfBounds(tt,_e,rt,it=.15){return it===0?clamp$1(tt,_e,rt):tt<_e?-rubberband(_e-tt,rt-_e,it)+_e:tt>rt?+rubberband(tt-rt,rt-_e,it)+rt:tt}function computeRubberband(tt,[_e,rt],[it,nt]){const[[st,at],[lt,ot]]=tt;return[rubberbandIfOutOfBounds(_e,st,at,it),rubberbandIfOutOfBounds(rt,lt,ot,nt)]}function _toPrimitive(tt,_e){if(typeof tt!="object"||tt===null)return tt;var rt=tt[Symbol.toPrimitive];if(rt!==void 0){var it=rt.call(tt,_e||"default");if(typeof it!="object")return it;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(tt)}function _toPropertyKey(tt){var _e=_toPrimitive(tt,"string");return typeof _e=="symbol"?_e:String(_e)}function _defineProperty$4(tt,_e,rt){return _e=_toPropertyKey(_e),_e in tt?Object.defineProperty(tt,_e,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[_e]=rt,tt}function ownKeys$3(tt,_e){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var it=Object.getOwnPropertySymbols(tt);_e&&(it=it.filter(function(nt){return Object.getOwnPropertyDescriptor(tt,nt).enumerable})),rt.push.apply(rt,it)}return rt}function _objectSpread2$1(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$3(Object(rt),!0).forEach(function(it){_defineProperty$4(tt,it,rt[it])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ownKeys$3(Object(rt)).forEach(function(it){Object.defineProperty(tt,it,Object.getOwnPropertyDescriptor(rt,it))})}return tt}const EVENT_TYPE_MAP={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function capitalize(tt){return tt?tt[0].toUpperCase()+tt.slice(1):""}const actionsWithoutCaptureSupported=["enter","leave"];function hasCapture(tt=!1,_e){return tt&&!actionsWithoutCaptureSupported.includes(_e)}function toHandlerProp(tt,_e="",rt=!1){const it=EVENT_TYPE_MAP[tt],nt=it&&it[_e]||_e;return"on"+capitalize(tt)+capitalize(nt)+(hasCapture(rt,nt)?"Capture":"")}const pointerCaptureEvents=["gotpointercapture","lostpointercapture"];function parseProp(tt){let _e=tt.substring(2).toLowerCase();const rt=!!~_e.indexOf("passive");rt&&(_e=_e.replace("passive",""));const it=pointerCaptureEvents.includes(_e)?"capturecapture":"capture",nt=!!~_e.indexOf(it);return nt&&(_e=_e.replace("capture","")),{device:_e,capture:nt,passive:rt}}function toDomEventType(tt,_e=""){const rt=EVENT_TYPE_MAP[tt],it=rt&&rt[_e]||_e;return tt+it}function isTouch(tt){return"touches"in tt}function getPointerType(tt){return isTouch(tt)?"touch":"pointerType"in tt?tt.pointerType:"mouse"}function getCurrentTargetTouchList(tt){return Array.from(tt.touches).filter(_e=>{var rt,it;return _e.target===tt.currentTarget||((rt=tt.currentTarget)===null||rt===void 0||(it=rt.contains)===null||it===void 0?void 0:it.call(rt,_e.target))})}function getTouchList(tt){return tt.type==="touchend"||tt.type==="touchcancel"?tt.changedTouches:tt.targetTouches}function getValueEvent(tt){return isTouch(tt)?getTouchList(tt)[0]:tt}function touchIds(tt){return getCurrentTargetTouchList(tt).map(_e=>_e.identifier)}function pointerId(tt){const _e=getValueEvent(tt);return isTouch(tt)?_e.identifier:_e.pointerId}function pointerValues(tt){const _e=getValueEvent(tt);return[_e.clientX,_e.clientY]}function getEventDetails(tt){const _e={};if("buttons"in tt&&(_e.buttons=tt.buttons),"shiftKey"in tt){const{shiftKey:rt,altKey:it,metaKey:nt,ctrlKey:st}=tt;Object.assign(_e,{shiftKey:rt,altKey:it,metaKey:nt,ctrlKey:st})}return _e}function call$1(tt,..._e){return typeof tt=="function"?tt(..._e):tt}function noop$1(){}function chain(...tt){return tt.length===0?noop$1:tt.length===1?tt[0]:function(){let _e;for(const rt of tt)_e=rt.apply(this,arguments)||_e;return _e}}function assignDefault(tt,_e){return Object.assign({},_e,tt||{})}const BEFORE_LAST_KINEMATICS_DELAY=32;class Engine{constructor(_e,rt,it){this.ctrl=_e,this.args=rt,this.key=it,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(_e){this.ctrl.state[this.key]=_e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:_e,shared:rt,ingKey:it,args:nt}=this;rt[it]=_e._active=_e.active=_e._blocked=_e._force=!1,_e._step=[!1,!1],_e.intentional=!1,_e._movement=[0,0],_e._distance=[0,0],_e._direction=[0,0],_e._delta=[0,0],_e._bounds=[[-1/0,1/0],[-1/0,1/0]],_e.args=nt,_e.axis=void 0,_e.memo=void 0,_e.elapsedTime=_e.timeDelta=0,_e.direction=[0,0],_e.distance=[0,0],_e.overflow=[0,0],_e._movementBound=[!1,!1],_e.velocity=[0,0],_e.movement=[0,0],_e.delta=[0,0],_e.timeStamp=0}start(_e){const rt=this.state,it=this.config;rt._active||(this.reset(),this.computeInitial(),rt._active=!0,rt.target=_e.target,rt.currentTarget=_e.currentTarget,rt.lastOffset=it.from?call$1(it.from,rt):rt.offset,rt.offset=rt.lastOffset,rt.startTime=rt.timeStamp=_e.timeStamp)}computeValues(_e){const rt=this.state;rt._values=_e,rt.values=this.config.transform(_e)}computeInitial(){const _e=this.state;_e._initial=_e._values,_e.initial=_e.values}compute(_e){const{state:rt,config:it,shared:nt}=this;rt.args=this.args;let st=0;if(_e&&(rt.event=_e,it.preventDefault&&_e.cancelable&&rt.event.preventDefault(),rt.type=_e.type,nt.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,nt.locked=!!document.pointerLockElement,Object.assign(nt,getEventDetails(_e)),nt.down=nt.pressed=nt.buttons%2===1||nt.touches>0,st=_e.timeStamp-rt.timeStamp,rt.timeStamp=_e.timeStamp,rt.elapsedTime=rt.timeStamp-rt.startTime),rt._active){const _t=rt._delta.map(Math.abs);V$2.addTo(rt._distance,_t)}this.axisIntent&&this.axisIntent(_e);const[at,lt]=rt._movement,[ot,ct]=it.threshold,{_step:ut,values:ht}=rt;if(it.hasCustomTransform?(ut[0]===!1&&(ut[0]=Math.abs(at)>=ot&&ht[0]),ut[1]===!1&&(ut[1]=Math.abs(lt)>=ct&&ht[1])):(ut[0]===!1&&(ut[0]=Math.abs(at)>=ot&&Math.sign(at)*ot),ut[1]===!1&&(ut[1]=Math.abs(lt)>=ct&&Math.sign(lt)*ct)),rt.intentional=ut[0]!==!1||ut[1]!==!1,!rt.intentional)return;const dt=[0,0];if(it.hasCustomTransform){const[_t,Ct]=ht;dt[0]=ut[0]!==!1?_t-ut[0]:0,dt[1]=ut[1]!==!1?Ct-ut[1]:0}else dt[0]=ut[0]!==!1?at-ut[0]:0,dt[1]=ut[1]!==!1?lt-ut[1]:0;this.restrictToAxis&&!rt._blocked&&this.restrictToAxis(dt);const pt=rt.offset,ft=rt._active&&!rt._blocked||rt.active;ft&&(rt.first=rt._active&&!rt.active,rt.last=!rt._active&&rt.active,rt.active=nt[this.ingKey]=rt._active,_e&&(rt.first&&("bounds"in it&&(rt._bounds=call$1(it.bounds,rt)),this.setup&&this.setup()),rt.movement=dt,this.computeOffset()));const[gt,mt]=rt.offset,[[At,yt],[bt,xt]]=rt._bounds;rt.overflow=[gt<At?-1:gt>yt?1:0,mt<bt?-1:mt>xt?1:0],rt._movementBound[0]=rt.overflow[0]?rt._movementBound[0]===!1?rt._movement[0]:rt._movementBound[0]:!1,rt._movementBound[1]=rt.overflow[1]?rt._movementBound[1]===!1?rt._movement[1]:rt._movementBound[1]:!1;const vt=rt._active?it.rubberband||[0,0]:[0,0];if(rt.offset=computeRubberband(rt._bounds,rt.offset,vt),rt.delta=V$2.sub(rt.offset,pt),this.computeMovement(),ft&&(!rt.last||st>BEFORE_LAST_KINEMATICS_DELAY)){rt.delta=V$2.sub(rt.offset,pt);const _t=rt.delta.map(Math.abs);V$2.addTo(rt.distance,_t),rt.direction=rt.delta.map(Math.sign),rt._direction=rt._delta.map(Math.sign),!rt.first&&st>0&&(rt.velocity=[_t[0]/st,_t[1]/st],rt.timeDelta=st)}}emit(){const _e=this.state,rt=this.shared,it=this.config;if(_e._active||this.clean(),(_e._blocked||!_e.intentional)&&!_e._force&&!it.triggerAllEvents)return;const nt=this.handler(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({},rt),_e),{},{[this.aliasKey]:_e.values}));nt!==void 0&&(_e.memo=nt)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function selectAxis([tt,_e],rt){const it=Math.abs(tt),nt=Math.abs(_e);if(it>nt&&it>rt)return"x";if(nt>it&&nt>rt)return"y"}class CoordinatesEngine extends Engine{constructor(..._e){super(..._e),_defineProperty$4(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=V$2.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=V$2.sub(this.state.offset,this.state.lastOffset)}axisIntent(_e){const rt=this.state,it=this.config;if(!rt.axis&&_e){const nt=typeof it.axisThreshold=="object"?it.axisThreshold[getPointerType(_e)]:it.axisThreshold;rt.axis=selectAxis(rt._movement,nt)}rt._blocked=(it.lockDirection||!!it.axis)&&!rt.axis||!!it.axis&&it.axis!==rt.axis}restrictToAxis(_e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":_e[1]=0;break;case"y":_e[0]=0;break}}}const identity$1=tt=>tt,DEFAULT_RUBBERBAND=.15,commonConfigResolver={enabled(tt=!0){return tt},eventOptions(tt,_e,rt){return _objectSpread2$1(_objectSpread2$1({},rt.shared.eventOptions),tt)},preventDefault(tt=!1){return tt},triggerAllEvents(tt=!1){return tt},rubberband(tt=0){switch(tt){case!0:return[DEFAULT_RUBBERBAND,DEFAULT_RUBBERBAND];case!1:return[0,0];default:return V$2.toVector(tt)}},from(tt){if(typeof tt=="function")return tt;if(tt!=null)return V$2.toVector(tt)},transform(tt,_e,rt){const it=tt||rt.shared.transform;return this.hasCustomTransform=!!it,it||identity$1},threshold(tt){return V$2.toVector(tt,0)}},DEFAULT_AXIS_THRESHOLD=0,coordinatesConfigResolver=_objectSpread2$1(_objectSpread2$1({},commonConfigResolver),{},{axis(tt,_e,{axis:rt}){if(this.lockDirection=rt==="lock",!this.lockDirection)return rt},axisThreshold(tt=DEFAULT_AXIS_THRESHOLD){return tt},bounds(tt={}){if(typeof tt=="function")return st=>coordinatesConfigResolver.bounds(tt(st));if("current"in tt)return()=>tt.current;if(typeof HTMLElement=="function"&&tt instanceof HTMLElement)return tt;const{left:_e=-1/0,right:rt=1/0,top:it=-1/0,bottom:nt=1/0}=tt;return[[_e,rt],[it,nt]]}}),KEYS_DELTA_MAP={ArrowRight:(tt,_e=1)=>[tt*_e,0],ArrowLeft:(tt,_e=1)=>[-1*tt*_e,0],ArrowUp:(tt,_e=1)=>[0,-1*tt*_e],ArrowDown:(tt,_e=1)=>[0,tt*_e]};class DragEngine extends CoordinatesEngine{constructor(..._e){super(..._e),_defineProperty$4(this,"ingKey","dragging")}reset(){super.reset();const _e=this.state;_e._pointerId=void 0,_e._pointerActive=!1,_e._keyboardActive=!1,_e._preventScroll=!1,_e._delayed=!1,_e.swipe=[0,0],_e.tap=!1,_e.canceled=!1,_e.cancel=this.cancel.bind(this)}setup(){const _e=this.state;if(_e._bounds instanceof HTMLElement){const rt=_e._bounds.getBoundingClientRect(),it=_e.currentTarget.getBoundingClientRect(),nt={left:rt.left-it.left+_e.offset[0],right:rt.right-it.right+_e.offset[0],top:rt.top-it.top+_e.offset[1],bottom:rt.bottom-it.bottom+_e.offset[1]};_e._bounds=coordinatesConfigResolver.bounds(nt)}}cancel(){const _e=this.state;_e.canceled||(_e.canceled=!0,_e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(_e){const rt=this.config,it=this.state;if(_e.buttons!=null&&(Array.isArray(rt.pointerButtons)?!rt.pointerButtons.includes(_e.buttons):rt.pointerButtons!==-1&&rt.pointerButtons!==_e.buttons))return;const nt=this.ctrl.setEventIds(_e);rt.pointerCapture&&_e.target.setPointerCapture(_e.pointerId),!(nt&&nt.size>1&&it._pointerActive)&&(this.start(_e),this.setupPointer(_e),it._pointerId=pointerId(_e),it._pointerActive=!0,this.computeValues(pointerValues(_e)),this.computeInitial(),rt.preventScrollAxis&&getPointerType(_e)!=="mouse"?(it._active=!1,this.setupScrollPrevention(_e)):rt.delay>0?(this.setupDelayTrigger(_e),rt.triggerAllEvents&&(this.compute(_e),this.emit())):this.startPointerDrag(_e))}startPointerDrag(_e){const rt=this.state;rt._active=!0,rt._preventScroll=!0,rt._delayed=!1,this.compute(_e),this.emit()}pointerMove(_e){const rt=this.state,it=this.config;if(!rt._pointerActive)return;const nt=pointerId(_e);if(rt._pointerId!==void 0&&nt!==rt._pointerId)return;const st=pointerValues(_e);if(document.pointerLockElement===_e.target?rt._delta=[_e.movementX,_e.movementY]:(rt._delta=V$2.sub(st,rt._values),this.computeValues(st)),V$2.addTo(rt._movement,rt._delta),this.compute(_e),rt._delayed&&rt.intentional){this.timeoutStore.remove("dragDelay"),rt.active=!1,this.startPointerDrag(_e);return}if(it.preventScrollAxis&&!rt._preventScroll)if(rt.axis)if(rt.axis===it.preventScrollAxis||it.preventScrollAxis==="xy"){rt._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(_e);return}else return;this.emit()}pointerUp(_e){this.ctrl.setEventIds(_e);try{this.config.pointerCapture&&_e.target.hasPointerCapture(_e.pointerId)&&_e.target.releasePointerCapture(_e.pointerId)}catch{}const rt=this.state,it=this.config;if(!rt._active||!rt._pointerActive)return;const nt=pointerId(_e);if(rt._pointerId!==void 0&&nt!==rt._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(_e);const[st,at]=rt._distance;if(rt.tap=st<=it.tapsThreshold&&at<=it.tapsThreshold,rt.tap&&it.filterTaps)rt._force=!0;else{const[lt,ot]=rt._delta,[ct,ut]=rt._movement,[ht,dt]=it.swipe.velocity,[pt,ft]=it.swipe.distance,gt=it.swipe.duration;if(rt.elapsedTime<gt){const mt=Math.abs(lt/rt.timeDelta),At=Math.abs(ot/rt.timeDelta);mt>ht&&Math.abs(ct)>pt&&(rt.swipe[0]=Math.sign(lt)),At>dt&&Math.abs(ut)>ft&&(rt.swipe[1]=Math.sign(ot))}}this.emit()}pointerClick(_e){!this.state.tap&&_e.detail>0&&(_e.preventDefault(),_e.stopPropagation())}setupPointer(_e){const rt=this.config,it=rt.device;rt.pointerLock&&_e.currentTarget.requestPointerLock(),rt.pointerCapture||(this.eventStore.add(this.sharedConfig.window,it,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,it,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,it,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(_e){this.state._preventScroll&&_e.cancelable&&_e.preventDefault()}setupScrollPrevention(_e){this.state._preventScroll=!1,persistEvent(_e);const rt=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",rt),this.eventStore.add(this.sharedConfig.window,"touch","cancel",rt),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,_e)}setupDelayTrigger(_e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(_e)},this.config.delay)}keyDown(_e){const rt=KEYS_DELTA_MAP[_e.key];if(rt){const it=this.state,nt=_e.shiftKey?10:_e.altKey?.1:1;this.start(_e),it._delta=rt(this.config.keyboardDisplacement,nt),it._keyboardActive=!0,V$2.addTo(it._movement,it._delta),this.compute(_e),this.emit()}}keyUp(_e){_e.key in KEYS_DELTA_MAP&&(this.state._keyboardActive=!1,this.setActive(),this.compute(_e),this.emit())}bind(_e){const rt=this.config.device;_e(rt,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(_e(rt,"change",this.pointerMove.bind(this)),_e(rt,"end",this.pointerUp.bind(this)),_e(rt,"cancel",this.pointerUp.bind(this)),_e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(_e("key","down",this.keyDown.bind(this)),_e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&_e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function persistEvent(tt){"persist"in tt&&typeof tt.persist=="function"&&tt.persist()}const isBrowser=typeof window<"u"&&window.document&&window.document.createElement;function supportsTouchEvents(){return isBrowser&&"ontouchstart"in window}function isTouchScreen(){return supportsTouchEvents()||isBrowser&&window.navigator.maxTouchPoints>1}function supportsPointerEvents(){return isBrowser&&"onpointerdown"in window}function supportsPointerLock(){return isBrowser&&"exitPointerLock"in window.document}function supportsGestureEvents(){try{return"constructor"in GestureEvent}catch{return!1}}const SUPPORT={isBrowser,gesture:supportsGestureEvents(),touch:isTouchScreen(),touchscreen:isTouchScreen(),pointer:supportsPointerEvents(),pointerLock:supportsPointerLock()},DEFAULT_PREVENT_SCROLL_DELAY=250,DEFAULT_DRAG_DELAY=180,DEFAULT_SWIPE_VELOCITY=.5,DEFAULT_SWIPE_DISTANCE=50,DEFAULT_SWIPE_DURATION=250,DEFAULT_KEYBOARD_DISPLACEMENT=10,DEFAULT_DRAG_AXIS_THRESHOLD={mouse:0,touch:0,pen:8},dragConfigResolver=_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{device(tt,_e,{pointer:{touch:rt=!1,lock:it=!1,mouse:nt=!1}={}}){return this.pointerLock=it&&SUPPORT.pointerLock,SUPPORT.touch&&rt?"touch":this.pointerLock?"mouse":SUPPORT.pointer&&!nt?"pointer":SUPPORT.touch?"touch":"mouse"},preventScrollAxis(tt,_e,{preventScroll:rt}){if(this.preventScrollDelay=typeof rt=="number"?rt:rt||rt===void 0&&tt?DEFAULT_PREVENT_SCROLL_DELAY:void 0,!(!SUPPORT.touchscreen||rt===!1))return tt||(rt!==void 0?"y":void 0)},pointerCapture(tt,_e,{pointer:{capture:rt=!0,buttons:it=1,keys:nt=!0}={}}){return this.pointerButtons=it,this.keys=nt,!this.pointerLock&&this.device==="pointer"&&rt},threshold(tt,_e,{filterTaps:rt=!1,tapsThreshold:it=3,axis:nt=void 0}){const st=V$2.toVector(tt,rt?it:nt?1:0);return this.filterTaps=rt,this.tapsThreshold=it,st},swipe({velocity:tt=DEFAULT_SWIPE_VELOCITY,distance:_e=DEFAULT_SWIPE_DISTANCE,duration:rt=DEFAULT_SWIPE_DURATION}={}){return{velocity:this.transform(V$2.toVector(tt)),distance:this.transform(V$2.toVector(_e)),duration:rt}},delay(tt=0){switch(tt){case!0:return DEFAULT_DRAG_DELAY;case!1:return 0;default:return tt}},axisThreshold(tt){return tt?_objectSpread2$1(_objectSpread2$1({},DEFAULT_DRAG_AXIS_THRESHOLD),tt):DEFAULT_DRAG_AXIS_THRESHOLD},keyboardDisplacement(tt=DEFAULT_KEYBOARD_DISPLACEMENT){return tt}});_objectSpread2$1(_objectSpread2$1({},commonConfigResolver),{},{device(tt,_e,{shared:rt,pointer:{touch:it=!1}={}}){if(rt.target&&!SUPPORT.touch&&SUPPORT.gesture)return"gesture";if(SUPPORT.touch&&it)return"touch";if(SUPPORT.touchscreen){if(SUPPORT.pointer)return"pointer";if(SUPPORT.touch)return"touch"}},bounds(tt,_e,{scaleBounds:rt={},angleBounds:it={}}){const nt=at=>{const lt=assignDefault(call$1(rt,at),{min:-1/0,max:1/0});return[lt.min,lt.max]},st=at=>{const lt=assignDefault(call$1(it,at),{min:-1/0,max:1/0});return[lt.min,lt.max]};return typeof rt!="function"&&typeof it!="function"?[nt(),st()]:at=>[nt(at),st(at)]},threshold(tt,_e,rt){return this.lockDirection=rt.axis==="lock",V$2.toVector(tt,this.lockDirection?[.1,3]:0)},modifierKey(tt){return tt===void 0?"ctrlKey":tt},pinchOnWheel(tt=!0){return tt}});_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{mouseOnly:(tt=!0)=>tt});_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{mouseOnly:(tt=!0)=>tt});const EngineMap=new Map,ConfigResolverMap=new Map;function registerAction(tt){EngineMap.set(tt.key,tt.engine),ConfigResolverMap.set(tt.key,tt.resolver)}const dragAction={key:"drag",engine:DragEngine,resolver:dragConfigResolver};function _objectWithoutPropertiesLoose$2(tt,_e){if(tt==null)return{};var rt={},it=Object.keys(tt),nt,st;for(st=0;st<it.length;st++)nt=it[st],!(_e.indexOf(nt)>=0)&&(rt[nt]=tt[nt]);return rt}function _objectWithoutProperties$2(tt,_e){if(tt==null)return{};var rt=_objectWithoutPropertiesLoose$2(tt,_e),it,nt;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(tt);for(nt=0;nt<st.length;nt++)it=st[nt],!(_e.indexOf(it)>=0)&&Object.prototype.propertyIsEnumerable.call(tt,it)&&(rt[it]=tt[it])}return rt}const sharedConfigResolver={target(tt){if(tt)return()=>"current"in tt?tt.current:tt},enabled(tt=!0){return tt},window(tt=SUPPORT.isBrowser?window:void 0){return tt},eventOptions({passive:tt=!0,capture:_e=!1}={}){return{passive:tt,capture:_e}},transform(tt){return tt}},_excluded$c=["target","eventOptions","window","enabled","transform"];function resolveWith(tt={},_e){const rt={};for(const[it,nt]of Object.entries(_e))switch(typeof nt){case"function":rt[it]=nt.call(rt,tt[it],it,tt);break;case"object":rt[it]=resolveWith(tt[it],nt);break;case"boolean":nt&&(rt[it]=tt[it]);break}return rt}function parse$1(tt,_e,rt={}){const it=tt,{target:nt,eventOptions:st,window:at,enabled:lt,transform:ot}=it,ct=_objectWithoutProperties$2(it,_excluded$c);if(rt.shared=resolveWith({target:nt,eventOptions:st,window:at,enabled:lt,transform:ot},sharedConfigResolver),_e){const ut=ConfigResolverMap.get(_e);rt[_e]=resolveWith(_objectSpread2$1({shared:rt.shared},ct),ut)}else for(const ut in ct){const ht=ConfigResolverMap.get(ut);ht&&(rt[ut]=resolveWith(_objectSpread2$1({shared:rt.shared},ct[ut]),ht))}return rt}class EventStore{constructor(_e,rt){_defineProperty$4(this,"_listeners",new Set),this._ctrl=_e,this._gestureKey=rt}add(_e,rt,it,nt,st){const at=this._listeners,lt=toDomEventType(rt,it),ot=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},ct=_objectSpread2$1(_objectSpread2$1({},ot),st);_e.addEventListener(lt,nt,ct);const ut=()=>{_e.removeEventListener(lt,nt,ct),at.delete(ut)};return at.add(ut),ut}clean(){this._listeners.forEach(_e=>_e()),this._listeners.clear()}}class TimeoutStore{constructor(){_defineProperty$4(this,"_timeouts",new Map)}add(_e,rt,it=140,...nt){this.remove(_e),this._timeouts.set(_e,window.setTimeout(rt,it,...nt))}remove(_e){const rt=this._timeouts.get(_e);rt&&window.clearTimeout(rt)}clean(){this._timeouts.forEach(_e=>void window.clearTimeout(_e)),this._timeouts.clear()}}class Controller{constructor(_e){_defineProperty$4(this,"gestures",new Set),_defineProperty$4(this,"_targetEventStore",new EventStore(this)),_defineProperty$4(this,"gestureEventStores",{}),_defineProperty$4(this,"gestureTimeoutStores",{}),_defineProperty$4(this,"handlers",{}),_defineProperty$4(this,"config",{}),_defineProperty$4(this,"pointerIds",new Set),_defineProperty$4(this,"touchIds",new Set),_defineProperty$4(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),resolveGestures(this,_e)}setEventIds(_e){if(isTouch(_e))return this.touchIds=new Set(touchIds(_e)),this.touchIds;if("pointerId"in _e)return _e.type==="pointerup"||_e.type==="pointercancel"?this.pointerIds.delete(_e.pointerId):_e.type==="pointerdown"&&this.pointerIds.add(_e.pointerId),this.pointerIds}applyHandlers(_e,rt){this.handlers=_e,this.nativeHandlers=rt}applyConfig(_e,rt){this.config=parse$1(_e,rt,this.config)}clean(){this._targetEventStore.clean();for(const _e of this.gestures)this.gestureEventStores[_e].clean(),this.gestureTimeoutStores[_e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(..._e){const rt=this.config.shared,it={};let nt;if(!(rt.target&&(nt=rt.target(),!nt))){if(rt.enabled){for(const at of this.gestures){const lt=this.config[at],ot=bindToProps(it,lt.eventOptions,!!nt);if(lt.enabled){const ct=EngineMap.get(at);new ct(this,_e,at).bind(ot)}}const st=bindToProps(it,rt.eventOptions,!!nt);for(const at in this.nativeHandlers)st(at,"",lt=>this.nativeHandlers[at](_objectSpread2$1(_objectSpread2$1({},this.state.shared),{},{event:lt,args:_e})),void 0,!0)}for(const st in it)it[st]=chain(...it[st]);if(!nt)return it;for(const st in it){const{device:at,capture:lt,passive:ot}=parseProp(st);this._targetEventStore.add(nt,at,"",it[st],{capture:lt,passive:ot})}}}}function setupGesture(tt,_e){tt.gestures.add(_e),tt.gestureEventStores[_e]=new EventStore(tt,_e),tt.gestureTimeoutStores[_e]=new TimeoutStore}function resolveGestures(tt,_e){_e.drag&&setupGesture(tt,"drag"),_e.wheel&&setupGesture(tt,"wheel"),_e.scroll&&setupGesture(tt,"scroll"),_e.move&&setupGesture(tt,"move"),_e.pinch&&setupGesture(tt,"pinch"),_e.hover&&setupGesture(tt,"hover")}const bindToProps=(tt,_e,rt)=>(it,nt,st,at={},lt=!1)=>{var ot,ct;const ut=(ot=at.capture)!==null&&ot!==void 0?ot:_e.capture,ht=(ct=at.passive)!==null&&ct!==void 0?ct:_e.passive;let dt=lt?it:toHandlerProp(it,nt,ut);rt&&ht&&(dt+="Passive"),tt[dt]=tt[dt]||[],tt[dt].push(st)};function useRecognizers(tt,_e={},rt,it){const nt=React.useMemo(()=>new Controller(tt),[]);if(nt.applyHandlers(tt,it),nt.applyConfig(_e,rt),React.useEffect(nt.effect.bind(nt)),React.useEffect(()=>nt.clean.bind(nt),[]),_e.target===void 0)return nt.bind.bind(nt)}function useDrag$1(tt,_e){return registerAction(dragAction),useRecognizers({drag:tt},_e||{},"drag")}const subscribeWithSelector=tt=>(_e,rt,it)=>{const nt=it.subscribe;return it.subscribe=(at,lt,ot)=>{let ct=at;if(lt){const ut=(ot==null?void 0:ot.equalityFn)||Object.is;let ht=at(it.getState());ct=dt=>{const pt=at(dt);if(!ut(ht,pt)){const ft=ht;lt(ht=pt,ft)}},ot!=null&&ot.fireImmediately&&lt(ht,ht)}return nt(ct)},tt(_e,rt,it)};function shallow(tt,_e){if(Object.is(tt,_e))return!0;if(typeof tt!="object"||tt===null||typeof _e!="object"||_e===null)return!1;const rt=Object.keys(tt);if(rt.length!==Object.keys(_e).length)return!1;for(let it=0;it<rt.length;it++)if(!Object.prototype.hasOwnProperty.call(_e,rt[it])||!Object.is(tt[rt[it]],_e[rt[it]]))return!1;return!0}function workerBootstrap(){var tt=Object.create(null);function _e(nt,st){var at=nt.id,lt=nt.name,ot=nt.dependencies;ot===void 0&&(ot=[]);var ct=nt.init;ct===void 0&&(ct=function(){});var ut=nt.getTransferables;if(ut===void 0&&(ut=null),!tt[at])try{ot=ot.map(function(dt){return dt&&dt.isWorkerModule&&(_e(dt,function(pt){if(pt instanceof Error)throw pt}),dt=tt[dt.id].value),dt}),ct=it("<"+lt+">.init",ct),ut&&(ut=it("<"+lt+">.getTransferables",ut));var ht=null;typeof ct=="function"?ht=ct.apply(void 0,ot):console.error("worker module init function failed to rehydrate"),tt[at]={id:at,value:ht,getTransferables:ut},st(ht)}catch(dt){dt&&dt.noLog||console.error(dt),st(dt)}}function rt(nt,st){var at,lt=nt.id,ot=nt.args;(!tt[lt]||typeof tt[lt].value!="function")&&st(new Error("Worker module "+lt+": not found or its 'init' did not return a function"));try{var ct=(at=tt[lt]).value.apply(at,ot);ct&&typeof ct.then=="function"?ct.then(ut,function(ht){return st(ht instanceof Error?ht:new Error(""+ht))}):ut(ct)}catch(ht){st(ht)}function ut(ht){try{var dt=tt[lt].getTransferables&&tt[lt].getTransferables(ht);(!dt||!Array.isArray(dt)||!dt.length)&&(dt=void 0),st(ht,dt)}catch(pt){console.error(pt),st(pt)}}}function it(nt,st){var at=void 0;self.troikaDefine=function(ot){return at=ot};var lt=URL.createObjectURL(new Blob(["/** "+nt.replace(/\*/g,"")+` **/

troikaDefine(
`+st+`
)`],{type:"application/javascript"}));try{importScripts(lt)}catch(ot){console.error(ot)}return URL.revokeObjectURL(lt),delete self.troikaDefine,at}self.addEventListener("message",function(nt){var st=nt.data,at=st.messageId,lt=st.action,ot=st.data;try{lt==="registerModule"&&_e(ot,function(ct){ct instanceof Error?postMessage({messageId:at,success:!1,error:ct.message}):postMessage({messageId:at,success:!0,result:{isCallable:typeof ct=="function"}})}),lt==="callModule"&&rt(ot,function(ct,ut){ct instanceof Error?postMessage({messageId:at,success:!1,error:ct.message}):postMessage({messageId:at,success:!0,result:ct},ut||void 0)})}catch(ct){postMessage({messageId:at,success:!1,error:ct.stack})}})}function defineMainThreadModule(tt){var _e=function(){for(var rt=[],it=arguments.length;it--;)rt[it]=arguments[it];return _e._getInitResult().then(function(nt){if(typeof nt=="function")return nt.apply(void 0,rt);throw new Error("Worker module function was called but `init` did not return a callable function")})};return _e._getInitResult=function(){var rt=tt.dependencies,it=tt.init;rt=Array.isArray(rt)?rt.map(function(st){return st&&st._getInitResult?st._getInitResult():st}):[];var nt=Promise.all(rt).then(function(st){return it.apply(null,st)});return _e._getInitResult=function(){return nt},nt},_e}var supportsWorkers=function(){var tt=!1;if(typeof window<"u"&&typeof window.document<"u")try{var _e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));_e.terminate(),tt=!0}catch(rt){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+rt.message+"]")}return supportsWorkers=function(){return tt},tt},_workerModuleId=0,_messageId=0,_allowInitAsString=!1,workers=Object.create(null),registeredModules=Object.create(null),openRequests=Object.create(null);function defineWorkerModule(tt){if((!tt||typeof tt.init!="function")&&!_allowInitAsString)throw new Error("requires `options.init` function");var _e=tt.dependencies,rt=tt.init,it=tt.getTransferables,nt=tt.workerId;if(!supportsWorkers())return defineMainThreadModule(tt);nt==null&&(nt="#default");var st="workerModule"+ ++_workerModuleId,at=tt.name||st,lt=null;_e=_e&&_e.map(function(ct){return typeof ct=="function"&&!ct.workerModuleData&&(_allowInitAsString=!0,ct=defineWorkerModule({workerId:nt,name:"<"+at+"> function dependency: "+ct.name,init:`function(){return (
`+stringifyFunction(ct)+`
)}`}),_allowInitAsString=!1),ct&&ct.workerModuleData&&(ct=ct.workerModuleData),ct});function ot(){for(var ct=[],ut=arguments.length;ut--;)ct[ut]=arguments[ut];if(!lt){lt=callWorker(nt,"registerModule",ot.workerModuleData);var ht=function(){lt=null,registeredModules[nt].delete(ht)};(registeredModules[nt]||(registeredModules[nt]=new Set)).add(ht)}return lt.then(function(dt){var pt=dt.isCallable;if(pt)return callWorker(nt,"callModule",{id:st,args:ct});throw new Error("Worker module function was called but `init` did not return a callable function")})}return ot.workerModuleData={isWorkerModule:!0,id:st,name:at,dependencies:_e,init:stringifyFunction(rt),getTransferables:it&&stringifyFunction(it)},ot}function terminateWorker(tt){registeredModules[tt]&&registeredModules[tt].forEach(function(_e){_e()}),workers[tt]&&(workers[tt].terminate(),delete workers[tt])}function stringifyFunction(tt){var _e=tt.toString();return!/^function/.test(_e)&&/^\w+\s*\(/.test(_e)&&(_e="function "+_e),_e}function getWorker(tt){var _e=workers[tt];if(!_e){var rt=stringifyFunction(workerBootstrap);_e=workers[tt]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+tt.replace(/\*/g,"")+` **/

;(`+rt+")()"],{type:"application/javascript"}))),_e.onmessage=function(it){var nt=it.data,st=nt.messageId,at=openRequests[st];if(!at)throw new Error("WorkerModule response with empty or unknown messageId");delete openRequests[st],at(nt)}}return _e}function callWorker(tt,_e,rt){return new Promise(function(it,nt){var st=++_messageId;openRequests[st]=function(at){at.success?it(at.result):nt(new Error("Error in worker "+_e+" call: "+at.error))},getWorker(tt).postMessage({messageId:st,action:_e,data:rt})})}function SDFGenerator(){var tt=function(_e){function rt(Ft,Ut,$t,Vt,Zt,qt,sr,er){var ir=1-sr;er.x=ir*ir*Ft+2*ir*sr*$t+sr*sr*Zt,er.y=ir*ir*Ut+2*ir*sr*Vt+sr*sr*qt}function it(Ft,Ut,$t,Vt,Zt,qt,sr,er,ir,ur){var ar=1-ir;ur.x=ar*ar*ar*Ft+3*ar*ar*ir*$t+3*ar*ir*ir*Zt+ir*ir*ir*sr,ur.y=ar*ar*ar*Ut+3*ar*ar*ir*Vt+3*ar*ir*ir*qt+ir*ir*ir*er}function nt(Ft,Ut){for(var $t=/([MLQCZ])([^MLQCZ]*)/g,Vt,Zt,qt,sr,er;Vt=$t.exec(Ft);){var ir=Vt[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(ur){return parseFloat(ur)});switch(Vt[1]){case"M":sr=Zt=ir[0],er=qt=ir[1];break;case"L":(ir[0]!==sr||ir[1]!==er)&&Ut("L",sr,er,sr=ir[0],er=ir[1]);break;case"Q":{Ut("Q",sr,er,sr=ir[2],er=ir[3],ir[0],ir[1]);break}case"C":{Ut("C",sr,er,sr=ir[4],er=ir[5],ir[0],ir[1],ir[2],ir[3]);break}case"Z":(sr!==Zt||er!==qt)&&Ut("L",sr,er,Zt,qt);break}}}function st(Ft,Ut,$t){$t===void 0&&($t=16);var Vt={x:0,y:0};nt(Ft,function(Zt,qt,sr,er,ir,ur,ar,lr,gr){switch(Zt){case"L":Ut(qt,sr,er,ir);break;case"Q":{for(var Yt=qt,nr=sr,mr=1;mr<$t;mr++)rt(qt,sr,ur,ar,er,ir,mr/($t-1),Vt),Ut(Yt,nr,Vt.x,Vt.y),Yt=Vt.x,nr=Vt.y;break}case"C":{for(var Sr=qt,Er=sr,Nr=1;Nr<$t;Nr++)it(qt,sr,ur,ar,lr,gr,er,ir,Nr/($t-1),Vt),Ut(Sr,Er,Vt.x,Vt.y),Sr=Vt.x,Er=Vt.y;break}}})}var at="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",lt="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",ot=new WeakMap,ct={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function ut(Ft,Ut){var $t=Ft.getContext?Ft.getContext("webgl",ct):Ft,Vt=ot.get($t);if(!Vt){let Sr=function(Or){var Xr=qt[Or];if(!Xr&&(Xr=qt[Or]=$t.getExtension(Or),!Xr))throw new Error(Or+" not supported");return Xr},Er=function(Or,Xr){var Qt=$t.createShader(Xr);return $t.shaderSource(Qt,Or),$t.compileShader(Qt),Qt},Nr=function(Or,Xr,Qt,Xt){if(!sr[Or]){var xr={},Lr={},fr=$t.createProgram();$t.attachShader(fr,Er(Xr,$t.VERTEX_SHADER)),$t.attachShader(fr,Er(Qt,$t.FRAGMENT_SHADER)),$t.linkProgram(fr),sr[Or]={program:fr,transaction:function(Hr){$t.useProgram(fr),Hr({setUniform:function(Cr,tr){for(var Ar=[],yr=arguments.length-2;yr-- >0;)Ar[yr]=arguments[yr+2];var Jt=Lr[tr]||(Lr[tr]=$t.getUniformLocation(fr,tr));$t["uniform"+Cr].apply($t,[Jt].concat(Ar))},setAttribute:function(Cr,tr,Ar,yr,Jt){var _r=xr[Cr];_r||(_r=xr[Cr]={buf:$t.createBuffer(),loc:$t.getAttribLocation(fr,Cr),data:null}),$t.bindBuffer($t.ARRAY_BUFFER,_r.buf),$t.vertexAttribPointer(_r.loc,tr,$t.FLOAT,!1,0,0),$t.enableVertexAttribArray(_r.loc),Zt?$t.vertexAttribDivisor(_r.loc,yr):Sr("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(_r.loc,yr),Jt!==_r.data&&($t.bufferData($t.ARRAY_BUFFER,Jt,Ar),_r.data=Jt)}})}}}sr[Or].transaction(Xt)},wr=function(Or,Xr){ir++;try{$t.activeTexture($t.TEXTURE0+ir);var Qt=er[Or];Qt||(Qt=er[Or]=$t.createTexture(),$t.bindTexture($t.TEXTURE_2D,Qt),$t.texParameteri($t.TEXTURE_2D,$t.TEXTURE_MIN_FILTER,$t.NEAREST),$t.texParameteri($t.TEXTURE_2D,$t.TEXTURE_MAG_FILTER,$t.NEAREST)),$t.bindTexture($t.TEXTURE_2D,Qt),Xr(Qt,ir)}finally{ir--}},kr=function(Or,Xr,Qt){var Xt=$t.createFramebuffer();ur.push(Xt),$t.bindFramebuffer($t.FRAMEBUFFER,Xt),$t.activeTexture($t.TEXTURE0+Xr),$t.bindTexture($t.TEXTURE_2D,Or),$t.framebufferTexture2D($t.FRAMEBUFFER,$t.COLOR_ATTACHMENT0,$t.TEXTURE_2D,Or,0);try{Qt(Xt)}finally{$t.deleteFramebuffer(Xt),$t.bindFramebuffer($t.FRAMEBUFFER,ur[--ur.length-1]||null)}},Ur=function(){qt={},sr={},er={},ir=-1,ur.length=0};var ar=Sr,lr=Er,gr=Nr,Yt=wr,nr=kr,mr=Ur,Zt=typeof WebGL2RenderingContext<"u"&&$t instanceof WebGL2RenderingContext,qt={},sr={},er={},ir=-1,ur=[];$t.canvas.addEventListener("webglcontextlost",function(Or){Ur(),Or.preventDefault()},!1),ot.set($t,Vt={gl:$t,isWebGL2:Zt,getExtension:Sr,withProgram:Nr,withTexture:wr,withTextureFramebuffer:kr,handleContextLoss:Ur})}Ut(Vt)}function ht(Ft,Ut,$t,Vt,Zt,qt,sr,er){sr===void 0&&(sr=15),er===void 0&&(er=null),ut(Ft,function(ir){var ur=ir.gl,ar=ir.withProgram,lr=ir.withTexture;lr("copy",function(gr,Yt){ur.texImage2D(ur.TEXTURE_2D,0,ur.RGBA,Zt,qt,0,ur.RGBA,ur.UNSIGNED_BYTE,Ut),ar("copy",at,lt,function(nr){var mr=nr.setUniform,Sr=nr.setAttribute;Sr("aUV",2,ur.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),mr("1i","image",Yt),ur.bindFramebuffer(ur.FRAMEBUFFER,er||null),ur.disable(ur.BLEND),ur.colorMask(sr&8,sr&4,sr&2,sr&1),ur.viewport($t,Vt,Zt,qt),ur.scissor($t,Vt,Zt,qt),ur.drawArrays(ur.TRIANGLES,0,3)})})})}function dt(Ft,Ut,$t){var Vt=Ft.width,Zt=Ft.height;ut(Ft,function(qt){var sr=qt.gl,er=new Uint8Array(Vt*Zt*4);sr.readPixels(0,0,Vt,Zt,sr.RGBA,sr.UNSIGNED_BYTE,er),Ft.width=Ut,Ft.height=$t,ht(sr,er,0,0,Vt,Zt)})}var pt=Object.freeze({__proto__:null,withWebGLContext:ut,renderImageData:ht,resizeWebGLCanvasWithoutClearing:dt});function ft(Ft,Ut,$t,Vt,Zt,qt){qt===void 0&&(qt=1);var sr=new Uint8Array(Ft*Ut),er=Vt[2]-Vt[0],ir=Vt[3]-Vt[1],ur=[];st($t,function(Sr,Er,Nr,wr){ur.push({x1:Sr,y1:Er,x2:Nr,y2:wr,minX:Math.min(Sr,Nr),minY:Math.min(Er,wr),maxX:Math.max(Sr,Nr),maxY:Math.max(Er,wr)})}),ur.sort(function(Sr,Er){return Sr.maxX-Er.maxX});for(var ar=0;ar<Ft;ar++)for(var lr=0;lr<Ut;lr++){var gr=nr(Vt[0]+er*(ar+.5)/Ft,Vt[1]+ir*(lr+.5)/Ut),Yt=Math.pow(1-Math.abs(gr)/Zt,qt)/2;gr<0&&(Yt=1-Yt),Yt=Math.max(0,Math.min(255,Math.round(Yt*255))),sr[lr*Ft+ar]=Yt}return sr;function nr(Sr,Er){for(var Nr=1/0,wr=1/0,kr=ur.length;kr--;){var Ur=ur[kr];if(Ur.maxX+wr<=Sr)break;if(Sr+wr>Ur.minX&&Er-wr<Ur.maxY&&Er+wr>Ur.minY){var Or=At(Sr,Er,Ur.x1,Ur.y1,Ur.x2,Ur.y2);Or<Nr&&(Nr=Or,wr=Math.sqrt(Nr))}}return mr(Sr,Er)&&(wr=-wr),wr}function mr(Sr,Er){for(var Nr=0,wr=ur.length;wr--;){var kr=ur[wr];if(kr.maxX<=Sr)break;var Ur=kr.y1>Er!=kr.y2>Er&&Sr<(kr.x2-kr.x1)*(Er-kr.y1)/(kr.y2-kr.y1)+kr.x1;Ur&&(Nr+=kr.y1<kr.y2?1:-1)}return Nr!==0}}function gt(Ft,Ut,$t,Vt,Zt,qt,sr,er,ir,ur){qt===void 0&&(qt=1),er===void 0&&(er=0),ir===void 0&&(ir=0),ur===void 0&&(ur=0),mt(Ft,Ut,$t,Vt,Zt,qt,sr,null,er,ir,ur)}function mt(Ft,Ut,$t,Vt,Zt,qt,sr,er,ir,ur,ar){qt===void 0&&(qt=1),ir===void 0&&(ir=0),ur===void 0&&(ur=0),ar===void 0&&(ar=0);for(var lr=ft(Ft,Ut,$t,Vt,Zt,qt),gr=new Uint8Array(lr.length*4),Yt=0;Yt<lr.length;Yt++)gr[Yt*4+ar]=lr[Yt];ht(sr,gr,ir,ur,Ft,Ut,1<<3-ar,er)}function At(Ft,Ut,$t,Vt,Zt,qt){var sr=Zt-$t,er=qt-Vt,ir=sr*sr+er*er,ur=ir?Math.max(0,Math.min(1,((Ft-$t)*sr+(Ut-Vt)*er)/ir)):0,ar=Ft-($t+ur*sr),lr=Ut-(Vt+ur*er);return ar*ar+lr*lr}var yt=Object.freeze({__proto__:null,generate:ft,generateIntoCanvas:gt,generateIntoFramebuffer:mt}),bt="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",xt="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",vt="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",_t=new Float32Array([0,0,2,0,0,2]),Ct=null,St=!1,Et={},Tt=new WeakMap;function Mt(Ft){if(!St&&!Bt(Ft))throw new Error("WebGL generation not supported")}function Rt(Ft,Ut,$t,Vt,Zt,qt,sr){if(qt===void 0&&(qt=1),sr===void 0&&(sr=null),!sr&&(sr=Ct,!sr)){var er=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!er)throw new Error("OffscreenCanvas or DOM canvas not supported");sr=Ct=er.getContext("webgl",{depth:!1})}Mt(sr);var ir=new Uint8Array(Ft*Ut*4);ut(sr,function(gr){var Yt=gr.gl,nr=gr.withTexture,mr=gr.withTextureFramebuffer;nr("readable",function(Sr,Er){Yt.texImage2D(Yt.TEXTURE_2D,0,Yt.RGBA,Ft,Ut,0,Yt.RGBA,Yt.UNSIGNED_BYTE,null),mr(Sr,Er,function(Nr){Ot(Ft,Ut,$t,Vt,Zt,qt,Yt,Nr,0,0,0),Yt.readPixels(0,0,Ft,Ut,Yt.RGBA,Yt.UNSIGNED_BYTE,ir)})})});for(var ur=new Uint8Array(Ft*Ut),ar=0,lr=0;ar<ir.length;ar+=4)ur[lr++]=ir[ar];return ur}function It(Ft,Ut,$t,Vt,Zt,qt,sr,er,ir,ur){qt===void 0&&(qt=1),er===void 0&&(er=0),ir===void 0&&(ir=0),ur===void 0&&(ur=0),Ot(Ft,Ut,$t,Vt,Zt,qt,sr,null,er,ir,ur)}function Ot(Ft,Ut,$t,Vt,Zt,qt,sr,er,ir,ur,ar){qt===void 0&&(qt=1),ir===void 0&&(ir=0),ur===void 0&&(ur=0),ar===void 0&&(ar=0),Mt(sr);var lr=[];st($t,function(gr,Yt,nr,mr){lr.push(gr,Yt,nr,mr)}),lr=new Float32Array(lr),ut(sr,function(gr){var Yt=gr.gl,nr=gr.isWebGL2,mr=gr.getExtension,Sr=gr.withProgram,Er=gr.withTexture,Nr=gr.withTextureFramebuffer,wr=gr.handleContextLoss;if(Er("rawDistances",function(kr,Ur){(Ft!==kr._lastWidth||Ut!==kr._lastHeight)&&Yt.texImage2D(Yt.TEXTURE_2D,0,Yt.RGBA,kr._lastWidth=Ft,kr._lastHeight=Ut,0,Yt.RGBA,Yt.UNSIGNED_BYTE,null),Sr("main",bt,xt,function(Or){var Xr=Or.setAttribute,Qt=Or.setUniform,Xt=!nr&&mr("ANGLE_instanced_arrays"),xr=!nr&&mr("EXT_blend_minmax");Xr("aUV",2,Yt.STATIC_DRAW,0,_t),Xr("aLineSegment",4,Yt.DYNAMIC_DRAW,1,lr),Qt.apply(void 0,["4f","uGlyphBounds"].concat(Vt)),Qt("1f","uMaxDistance",Zt),Qt("1f","uExponent",qt),Nr(kr,Ur,function(Lr){Yt.enable(Yt.BLEND),Yt.colorMask(!0,!0,!0,!0),Yt.viewport(0,0,Ft,Ut),Yt.scissor(0,0,Ft,Ut),Yt.blendFunc(Yt.ONE,Yt.ONE),Yt.blendEquationSeparate(Yt.FUNC_ADD,nr?Yt.MAX:xr.MAX_EXT),Yt.clear(Yt.COLOR_BUFFER_BIT),nr?Yt.drawArraysInstanced(Yt.TRIANGLES,0,3,lr.length/4):Xt.drawArraysInstancedANGLE(Yt.TRIANGLES,0,3,lr.length/4)})}),Sr("post",at,vt,function(Or){Or.setAttribute("aUV",2,Yt.STATIC_DRAW,0,_t),Or.setUniform("1i","tex",Ur),Yt.bindFramebuffer(Yt.FRAMEBUFFER,er),Yt.disable(Yt.BLEND),Yt.colorMask(ar===0,ar===1,ar===2,ar===3),Yt.viewport(ir,ur,Ft,Ut),Yt.scissor(ir,ur,Ft,Ut),Yt.drawArrays(Yt.TRIANGLES,0,3)})}),Yt.isContextLost())throw wr(),new Error("webgl context lost")})}function Bt(Ft){var Ut=!Ft||Ft===Ct?Et:Ft.canvas||Ft,$t=Tt.get(Ut);if($t===void 0){St=!0;var Vt=null;try{var Zt=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],qt=Rt(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,Ft);$t=qt&&Zt.length===qt.length&&qt.every(function(sr,er){return sr===Zt[er]}),$t||(Vt="bad trial run results",console.info(Zt,qt))}catch(sr){$t=!1,Vt=sr.message}Vt&&console.warn("WebGL SDF generation not supported:",Vt),St=!1,Tt.set(Ut,$t)}return $t}var Nt=Object.freeze({__proto__:null,generate:Rt,generateIntoCanvas:It,generateIntoFramebuffer:Ot,isSupported:Bt});function zt(Ft,Ut,$t,Vt,Zt,qt){Zt===void 0&&(Zt=Math.max(Vt[2]-Vt[0],Vt[3]-Vt[1])/2),qt===void 0&&(qt=1);try{return Rt.apply(Nt,arguments)}catch(sr){return console.info("WebGL SDF generation failed, falling back to JS",sr),ft.apply(yt,arguments)}}function Dt(Ft,Ut,$t,Vt,Zt,qt,sr,er,ir,ur){Zt===void 0&&(Zt=Math.max(Vt[2]-Vt[0],Vt[3]-Vt[1])/2),qt===void 0&&(qt=1),er===void 0&&(er=0),ir===void 0&&(ir=0),ur===void 0&&(ur=0);try{return It.apply(Nt,arguments)}catch(ar){return console.info("WebGL SDF generation failed, falling back to JS",ar),gt.apply(yt,arguments)}}return _e.forEachPathCommand=nt,_e.generate=zt,_e.generateIntoCanvas=Dt,_e.javascript=yt,_e.pathToLineSegments=st,_e.webgl=Nt,_e.webglUtils=pt,Object.defineProperty(_e,"__esModule",{value:!0}),_e}({});return tt}function bidiFactory(){var tt=function(_e){var rt={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},it={},nt={};it.L=1,nt[1]="L",Object.keys(rt).forEach(function(wr,kr){it[wr]=1<<kr+1,nt[it[wr]]=wr}),Object.freeze(it);var st=it.LRI|it.RLI|it.FSI,at=it.L|it.R|it.AL,lt=it.B|it.S|it.WS|it.ON|it.FSI|it.LRI|it.RLI|it.PDI,ot=it.BN|it.RLE|it.LRE|it.RLO|it.LRO|it.PDF,ct=it.S|it.WS|it.B|st|it.PDI|ot,ut=null;function ht(){if(!ut){ut=new Map;var wr=function(Ur){if(rt.hasOwnProperty(Ur)){var Or=0;rt[Ur].split(",").forEach(function(Xr){var Qt=Xr.split("+"),Xt=Qt[0],xr=Qt[1];Xt=parseInt(Xt,36),xr=xr?parseInt(xr,36):0,ut.set(Or+=Xt,it[Ur]);for(var Lr=0;Lr<xr;Lr++)ut.set(++Or,it[Ur])})}};for(var kr in rt)wr(kr)}}function dt(wr){return ht(),ut.get(wr.codePointAt(0))||it.L}function pt(wr){return nt[dt(wr)]}var ft={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function gt(wr,kr){var Ur=36,Or=0,Xr=new Map,Qt=kr&&new Map,Xt;return wr.split(",").forEach(function xr(Lr){if(Lr.indexOf("+")!==-1)for(var fr=+Lr;fr--;)xr(Xt);else{Xt=Lr;var pr=Lr.split(">"),Hr=pr[0],hr=pr[1];Hr=String.fromCodePoint(Or+=parseInt(Hr,Ur)),hr=String.fromCodePoint(Or+=parseInt(hr,Ur)),Xr.set(Hr,hr),kr&&Qt.set(hr,Hr)}}),{map:Xr,reverseMap:Qt}}var mt,At,yt;function bt(){if(!mt){var wr=gt(ft.pairs,!0),kr=wr.map,Ur=wr.reverseMap;mt=kr,At=Ur,yt=gt(ft.canonical,!1).map}}function xt(wr){return bt(),mt.get(wr)||null}function vt(wr){return bt(),At.get(wr)||null}function _t(wr){return bt(),yt.get(wr)||null}var Ct=it.L,St=it.R,Et=it.EN,Tt=it.ES,Mt=it.ET,Rt=it.AN,It=it.CS,Ot=it.B,Bt=it.S,Nt=it.ON,zt=it.BN,Dt=it.NSM,Ft=it.AL,Ut=it.LRO,$t=it.RLO,Vt=it.LRE,Zt=it.RLE,qt=it.PDF,sr=it.LRI,er=it.RLI,ir=it.FSI,ur=it.PDI;function ar(wr,kr){for(var Ur=125,Or=new Uint32Array(wr.length),Xr=0;Xr<wr.length;Xr++)Or[Xr]=dt(wr[Xr]);var Qt=new Map;function Xt(os,vs){var Kn=Or[os];Or[os]=vs,Qt.set(Kn,Qt.get(Kn)-1),Kn&lt&&Qt.set(lt,Qt.get(lt)-1),Qt.set(vs,(Qt.get(vs)||0)+1),vs&lt&&Qt.set(lt,(Qt.get(lt)||0)+1)}for(var xr=new Uint8Array(wr.length),Lr=new Map,fr=[],pr=null,Hr=0;Hr<wr.length;Hr++)pr||fr.push(pr={start:Hr,end:wr.length-1,level:kr==="rtl"?1:kr==="ltr"?0:Lo(Hr,!1)}),Or[Hr]&Ot&&(pr.end=Hr,pr=null);for(var hr=Zt|Vt|$t|Ut|st|ur|qt|Ot,Cr=function(os){return os+(os&1?1:2)},tr=function(os){return os+(os&1?2:1)},Ar=0;Ar<fr.length;Ar++){pr=fr[Ar];var yr=[{_level:pr.level,_override:0,_isolate:0}],Jt=void 0,_r=0,Kt=0,Qr=0;Qt.clear();for(var br=pr.start;br<=pr.end;br++){var Rr=Or[br];if(Jt=yr[yr.length-1],Qt.set(Rr,(Qt.get(Rr)||0)+1),Rr&lt&&Qt.set(lt,(Qt.get(lt)||0)+1),Rr&hr)if(Rr&(Zt|Vt)){xr[br]=Jt._level;var Tr=(Rr===Zt?tr:Cr)(Jt._level);Tr<=Ur&&!_r&&!Kt?yr.push({_level:Tr,_override:0,_isolate:0}):_r||Kt++}else if(Rr&($t|Ut)){xr[br]=Jt._level;var Vr=(Rr===$t?tr:Cr)(Jt._level);Vr<=Ur&&!_r&&!Kt?yr.push({_level:Vr,_override:Rr&$t?St:Ct,_isolate:0}):_r||Kt++}else if(Rr&st){Rr&ir&&(Rr=Lo(br+1,!0)===1?er:sr),xr[br]=Jt._level,Jt._override&&Xt(br,Jt._override);var Wr=(Rr===er?tr:Cr)(Jt._level);Wr<=Ur&&_r===0&&Kt===0?(Qr++,yr.push({_level:Wr,_override:0,_isolate:1,_isolInitIndex:br})):_r++}else if(Rr&ur){if(_r>0)_r--;else if(Qr>0){for(Kt=0;!yr[yr.length-1]._isolate;)yr.pop();var pn=yr[yr.length-1]._isolInitIndex;pn!=null&&(Lr.set(pn,br),Lr.set(br,pn)),yr.pop(),Qr--}Jt=yr[yr.length-1],xr[br]=Jt._level,Jt._override&&Xt(br,Jt._override)}else Rr&qt?(_r===0&&(Kt>0?Kt--:!Jt._isolate&&yr.length>1&&(yr.pop(),Jt=yr[yr.length-1])),xr[br]=Jt._level):Rr&Ot&&(xr[br]=pr.level);else xr[br]=Jt._level,Jt._override&&Rr!==zt&&Xt(br,Jt._override)}for(var En=[],rn=null,Cn=pr.start;Cn<=pr.end;Cn++){var vn=Or[Cn];if(!(vn&ot)){var an=xr[Cn],yn=vn&st,Gn=vn===ur;rn&&an===rn._level?(rn._end=Cn,rn._endsWithIsolInit=yn):En.push(rn={_start:Cn,_end:Cn,_level:an,_startsWithPDI:Gn,_endsWithIsolInit:yn})}}for(var Pn=[],Sn=0;Sn<En.length;Sn++){var In=En[Sn];if(!In._startsWithPDI||In._startsWithPDI&&!Lr.has(In._start)){for(var jn=[rn=In],_n=void 0;rn&&rn._endsWithIsolInit&&(_n=Lr.get(rn._end))!=null;)for(var nn=Sn+1;nn<En.length;nn++)if(En[nn]._start===_n){jn.push(rn=En[nn]);break}for(var Nn=[],bs=0;bs<jn.length;bs++)for(var Wt=jn[bs],jt=Wt._start;jt<=Wt._end;jt++)Nn.push(jt);for(var rr=xr[Nn[0]],cr=pr.level,or=Nn[0]-1;or>=0;or--)if(!(Or[or]&ot)){cr=xr[or];break}var vr=Nn[Nn.length-1],Br=xr[vr],Dr=pr.level;if(!(Or[vr]&st)){for(var Gr=vr+1;Gr<=pr.end;Gr++)if(!(Or[Gr]&ot)){Dr=xr[Gr];break}}Pn.push({_seqIndices:Nn,_sosType:Math.max(cr,rr)%2?St:Ct,_eosType:Math.max(Dr,Br)%2?St:Ct})}}for(var zr=0;zr<Pn.length;zr++){var Yr=Pn[zr],Mr=Yr._seqIndices,Zr=Yr._sosType,Kr=Yr._eosType,qr=xr[Mr[0]]&1?St:Ct;if(Qt.get(Dt))for(var ln=0;ln<Mr.length;ln++){var dn=Mr[ln];if(Or[dn]&Dt){for(var cn=Zr,_i=ln-1;_i>=0;_i--)if(!(Or[Mr[_i]]&ot)){cn=Or[Mr[_i]];break}Xt(dn,cn&(st|ur)?Nt:cn)}}if(Qt.get(Et))for(var fn=0;fn<Mr.length;fn++){var on=Mr[fn];if(Or[on]&Et)for(var An=fn-1;An>=-1;An--){var Bn=An===-1?Zr:Or[Mr[An]];if(Bn&at){Bn===Ft&&Xt(on,Rt);break}}}if(Qt.get(Ft))for(var mn=0;mn<Mr.length;mn++){var Dn=Mr[mn];Or[Dn]&Ft&&Xt(Dn,St)}if(Qt.get(Tt)||Qt.get(It))for(var On=1;On<Mr.length-1;On++){var Fn=Mr[On];if(Or[Fn]&(Tt|It)){for(var zn=0,bn=0,Vn=On-1;Vn>=0&&(zn=Or[Mr[Vn]],!!(zn&ot));Vn--);for(var Ln=On+1;Ln<Mr.length&&(bn=Or[Mr[Ln]],!!(bn&ot));Ln++);zn===bn&&(Or[Fn]===Tt?zn===Et:zn&(Et|Rt))&&Xt(Fn,zn)}}if(Qt.get(Et))for(var xn=0;xn<Mr.length;xn++){var Yn=Mr[xn];if(Or[Yn]&Et){for(var _s=xn-1;_s>=0&&Or[Mr[_s]]&(Mt|ot);_s--)Xt(Mr[_s],Et);for(xn++;xn<Mr.length&&Or[Mr[xn]]&(Mt|ot|Et);xn++)Or[Mr[xn]]!==Et&&Xt(Mr[xn],Et)}}if(Qt.get(Mt)||Qt.get(Tt)||Qt.get(It))for(var qn=0;qn<Mr.length;qn++){var Ts=Mr[qn];if(Or[Ts]&(Mt|Tt|It)){Xt(Ts,Nt);for(var Js=qn-1;Js>=0&&Or[Mr[Js]]&ot;Js--)Xt(Mr[Js],Nt);for(var qs=qn+1;qs<Mr.length&&Or[Mr[qs]]&ot;qs++)Xt(Mr[qs],Nt)}}if(Qt.get(Et))for(var Ks=0,vo=Zr;Ks<Mr.length;Ks++){var Il=Mr[Ks],Yo=Or[Il];Yo&Et?vo===Ct&&Xt(Il,Ct):Yo&at&&(vo=Yo)}if(Qt.get(lt)){var Zs=St|Et|Rt,Oo=Zs|Ct,Vs=[];{for(var oo=[],Hs=0;Hs<Mr.length;Hs++)if(Or[Mr[Hs]]&lt){var kn=wr[Mr[Hs]],Xo=void 0;if(xt(kn)!==null)if(oo.length<63)oo.push({char:kn,seqIndex:Hs});else break;else if((Xo=vt(kn))!==null)for(var eo=oo.length-1;eo>=0;eo--){var ko=oo[eo].char;if(ko===Xo||ko===vt(_t(kn))||xt(_t(ko))===kn){Vs.push([oo[eo].seqIndex,Hs]),oo.length=eo;break}}}Vs.sort(function(os,vs){return os[0]-vs[0]})}for(var Wo=0;Wo<Vs.length;Wo++){for(var Ol=Vs[Wo],Wn=Ol[0],yo=Ol[1],Nl=!1,fs=0,Qo=Wn+1;Qo<yo;Qo++){var Ao=Mr[Qo];if(Or[Ao]&Oo){Nl=!0;var ws=Or[Ao]&Zs?St:Ct;if(ws===qr){fs=ws;break}}}if(Nl&&!fs){fs=Zr;for(var Jo=Wn-1;Jo>=0;Jo--){var Ll=Mr[Jo];if(Or[Ll]&Oo){var Ps=Or[Ll]&Zs?St:Ct;Ps!==qr?fs=Ps:fs=qr;break}}}if(fs){if(Or[Mr[Wn]]=Or[Mr[yo]]=fs,fs!==qr){for(var gs=Wn+1;gs<Mr.length;gs++)if(!(Or[Mr[gs]]&ot)){dt(wr[Mr[gs]])&Dt&&(Or[Mr[gs]]=fs);break}}if(fs!==qr){for(var Ys=yo+1;Ys<Mr.length;Ys++)if(!(Or[Mr[Ys]]&ot)){dt(wr[Mr[Ys]])&Dt&&(Or[Mr[Ys]]=fs);break}}}}for(var Ns=0;Ns<Mr.length;Ns++)if(Or[Mr[Ns]]&lt){for(var qo=Ns,Ko=Ns,Cs=Zr,bo=Ns-1;bo>=0;bo--)if(Or[Mr[bo]]&ot)qo=bo;else{Cs=Or[Mr[bo]]&Zs?St:Ct;break}for(var _o=Kr,Co=Ns+1;Co<Mr.length;Co++)if(Or[Mr[Co]]&(lt|ot))Ko=Co;else{_o=Or[Mr[Co]]&Zs?St:Ct;break}for(var ms=qo;ms<=Ko;ms++)Or[Mr[ms]]=Cs===_o?Cs:qr;Ns=Ko}}}for(var ss=pr.start;ss<=pr.end;ss++){var No=xr[ss],zs=Or[ss];if(No&1?zs&(Ct|Et|Rt)&&xr[ss]++:zs&St?xr[ss]++:zs&(Rt|Et)&&(xr[ss]+=2),zs&ot&&(xr[ss]=ss===0?pr.level:xr[ss-1]),ss===pr.end||dt(wr[ss])&(Bt|Ot))for(var ao=ss;ao>=0&&dt(wr[ao])&ct;ao--)xr[ao]=pr.level}}return{levels:xr,paragraphs:fr};function Lo(os,vs){for(var Kn=os;Kn<wr.length;Kn++){var Zn=Or[Kn];if(Zn&(St|Ft))return 1;if(Zn&(Ot|Ct)||vs&&Zn===ur)return 0;if(Zn&st){var Ms=Bl(Kn);Kn=Ms===-1?wr.length:Ms}}return 0}function Bl(os){for(var vs=1,Kn=os+1;Kn<wr.length;Kn++){var Zn=Or[Kn];if(Zn&Ot)break;if(Zn&ur){if(--vs===0)return Kn}else Zn&st&&vs++}return-1}}var lr="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",gr;function Yt(){if(!gr){var wr=gt(lr,!0),kr=wr.map,Ur=wr.reverseMap;Ur.forEach(function(Or,Xr){kr.set(Xr,Or)}),gr=kr}}function nr(wr){return Yt(),gr.get(wr)||null}function mr(wr,kr,Ur,Or){var Xr=wr.length;Ur=Math.max(0,Ur==null?0:+Ur),Or=Math.min(Xr-1,Or==null?Xr-1:+Or);for(var Qt=new Map,Xt=Ur;Xt<=Or;Xt++)if(kr[Xt]&1){var xr=nr(wr[Xt]);xr!==null&&Qt.set(Xt,xr)}return Qt}function Sr(wr,kr,Ur,Or){var Xr=wr.length;Ur=Math.max(0,Ur==null?0:+Ur),Or=Math.min(Xr-1,Or==null?Xr-1:+Or);var Qt=[];return kr.paragraphs.forEach(function(Xt){var xr=Math.max(Ur,Xt.start),Lr=Math.min(Or,Xt.end);if(xr<Lr){for(var fr=kr.levels.slice(xr,Lr+1),pr=Lr;pr>=xr&&dt(wr[pr])&ct;pr--)fr[pr]=Xt.level;for(var Hr=Xt.level,hr=1/0,Cr=0;Cr<fr.length;Cr++){var tr=fr[Cr];tr>Hr&&(Hr=tr),tr<hr&&(hr=tr|1)}for(var Ar=Hr;Ar>=hr;Ar--)for(var yr=0;yr<fr.length;yr++)if(fr[yr]>=Ar){for(var Jt=yr;yr+1<fr.length&&fr[yr+1]>=Ar;)yr++;yr>Jt&&Qt.push([Jt+xr,yr+xr])}}}),Qt}function Er(wr,kr,Ur,Or){var Xr=Nr(wr,kr,Ur,Or),Qt=[].concat(wr);return Xr.forEach(function(Xt,xr){Qt[xr]=(kr.levels[Xt]&1?nr(wr[Xt]):null)||wr[Xt]}),Qt.join("")}function Nr(wr,kr,Ur,Or){for(var Xr=Sr(wr,kr,Ur,Or),Qt=[],Xt=0;Xt<wr.length;Xt++)Qt[Xt]=Xt;return Xr.forEach(function(xr){for(var Lr=xr[0],fr=xr[1],pr=Qt.slice(Lr,fr+1),Hr=pr.length;Hr--;)Qt[fr-Hr]=pr[Hr]}),Qt}return _e.closingToOpeningBracket=vt,_e.getBidiCharType=dt,_e.getBidiCharTypeName=pt,_e.getCanonicalBracket=_t,_e.getEmbeddingLevels=ar,_e.getMirroredCharacter=nr,_e.getMirroredCharactersMap=mr,_e.getReorderSegments=Sr,_e.getReorderedIndices=Nr,_e.getReorderedString=Er,_e.openingToClosingBracket=xt,Object.defineProperty(_e,"__esModule",{value:!0}),_e}({});return tt}const voidMainRegExp=/\bvoid\s+main\s*\(\s*\)\s*{/g;function expandShaderIncludes(tt){const _e=/^[ \t]*#include +<([\w\d./]+)>/gm;function rt(it,nt){let st=ShaderChunk[nt];return st?expandShaderIncludes(st):it}return tt.replace(_e,rt)}const _lut=[];for(let tt=0;tt<256;tt++)_lut[tt]=(tt<16?"0":"")+tt.toString(16);function generateUUID(){const tt=Math.random()*4294967295|0,_e=Math.random()*4294967295|0,rt=Math.random()*4294967295|0,it=Math.random()*4294967295|0;return(_lut[tt&255]+_lut[tt>>8&255]+_lut[tt>>16&255]+_lut[tt>>24&255]+"-"+_lut[_e&255]+_lut[_e>>8&255]+"-"+_lut[_e>>16&15|64]+_lut[_e>>24&255]+"-"+_lut[rt&63|128]+_lut[rt>>8&255]+"-"+_lut[rt>>16&255]+_lut[rt>>24&255]+_lut[it&255]+_lut[it>>8&255]+_lut[it>>16&255]+_lut[it>>24&255]).toUpperCase()}const assign$4=Object.assign||function(){let tt=arguments[0];for(let _e=1,rt=arguments.length;_e<rt;_e++){let it=arguments[_e];if(it)for(let nt in it)Object.prototype.hasOwnProperty.call(it,nt)&&(tt[nt]=it[nt])}return tt},epoch=Date.now(),CONSTRUCTOR_CACHE=new WeakMap,SHADER_UPGRADE_CACHE=new Map;let materialInstanceId=1e10;function createDerivedMaterial(tt,_e){const rt=getKeyForOptions(_e);let it=CONSTRUCTOR_CACHE.get(tt);if(it||CONSTRUCTOR_CACHE.set(tt,it=Object.create(null)),it[rt])return new it[rt];const nt=`_onBeforeCompile${rt}`,st=function(ct,ut){tt.onBeforeCompile.call(this,ct,ut);const ht=this.customProgramCacheKey()+"|"+ct.vertexShader+"|"+ct.fragmentShader;let dt=SHADER_UPGRADE_CACHE[ht];if(!dt){const pt=upgradeShaders(this,ct,_e,rt);dt=SHADER_UPGRADE_CACHE[ht]=pt}ct.vertexShader=dt.vertexShader,ct.fragmentShader=dt.fragmentShader,assign$4(ct.uniforms,this.uniforms),_e.timeUniform&&(ct.uniforms[_e.timeUniform]={get value(){return Date.now()-epoch}}),this[nt]&&this[nt](ct)},at=function(){return lt(_e.chained?tt:tt.clone())},lt=function(ct){const ut=Object.create(ct,ot);return Object.defineProperty(ut,"baseMaterial",{value:tt}),Object.defineProperty(ut,"id",{value:materialInstanceId++}),ut.uuid=generateUUID(),ut.uniforms=assign$4({},ct.uniforms,_e.uniforms),ut.defines=assign$4({},ct.defines,_e.defines),ut.defines[`TROIKA_DERIVED_MATERIAL_${rt}`]="",ut.extensions=assign$4({},ct.extensions,_e.extensions),ut._listeners=void 0,ut},ot={constructor:{value:at},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return tt.customProgramCacheKey()+"|"+rt}},onBeforeCompile:{get(){return st},set(ct){this[nt]=ct}},copy:{writable:!0,configurable:!0,value:function(ct){return tt.copy.call(this,ct),!tt.isShaderMaterial&&!tt.isDerivedMaterial&&(assign$4(this.extensions,ct.extensions),assign$4(this.defines,ct.defines),assign$4(this.uniforms,UniformsUtils.clone(ct.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const ct=new tt.constructor;return lt(ct).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let ct=this._depthMaterial;return ct||(ct=this._depthMaterial=createDerivedMaterial(tt.isDerivedMaterial?tt.getDepthMaterial():new MeshDepthMaterial({depthPacking:RGBADepthPacking}),_e),ct.defines.IS_DEPTH_MATERIAL="",ct.uniforms=this.uniforms),ct}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let ct=this._distanceMaterial;return ct||(ct=this._distanceMaterial=createDerivedMaterial(tt.isDerivedMaterial?tt.getDistanceMaterial():new MeshDistanceMaterial,_e),ct.defines.IS_DISTANCE_MATERIAL="",ct.uniforms=this.uniforms),ct}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:ct,_distanceMaterial:ut}=this;ct&&ct.dispose(),ut&&ut.dispose(),tt.dispose.call(this)}}};return it[rt]=at,new at}function upgradeShaders(tt,{vertexShader:_e,fragmentShader:rt},it,nt){let{vertexDefs:st,vertexMainIntro:at,vertexMainOutro:lt,vertexTransform:ot,fragmentDefs:ct,fragmentMainIntro:ut,fragmentMainOutro:ht,fragmentColorTransform:dt,customRewriter:pt,timeUniform:ft}=it;if(st=st||"",at=at||"",lt=lt||"",ct=ct||"",ut=ut||"",ht=ht||"",(ot||pt)&&(_e=expandShaderIncludes(_e)),(dt||pt)&&(rt=rt.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),rt=expandShaderIncludes(rt)),pt){let gt=pt({vertexShader:_e,fragmentShader:rt});_e=gt.vertexShader,rt=gt.fragmentShader}if(dt){let gt=[];rt=rt.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,mt=>(gt.push(mt),"")),ht=`${dt}
${gt.join(`
`)}
${ht}`}if(ft){const gt=`
uniform float ${ft};
`;st=gt+st,ct=gt+ct}return ot&&(_e=`vec3 troika_position_${nt};
vec3 troika_normal_${nt};
vec2 troika_uv_${nt};
${_e}
`,st=`${st}
void troikaVertexTransform${nt}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${ot}
}
`,at=`
troika_position_${nt} = vec3(position);
troika_normal_${nt} = vec3(normal);
troika_uv_${nt} = vec2(uv);
troikaVertexTransform${nt}(troika_position_${nt}, troika_normal_${nt}, troika_uv_${nt});
${at}
`,_e=_e.replace(/\b(position|normal|uv)\b/g,(gt,mt,At,yt)=>/\battribute\s+vec[23]\s+$/.test(yt.substr(0,At))?mt:`troika_${mt}_${nt}`),tt.map&&tt.map.channel>0||(_e=_e.replace(/\bMAP_UV\b/g,`troika_uv_${nt}`))),_e=injectIntoShaderCode(_e,nt,st,at,lt),rt=injectIntoShaderCode(rt,nt,ct,ut,ht),{vertexShader:_e,fragmentShader:rt}}function injectIntoShaderCode(tt,_e,rt,it,nt){return(it||nt||rt)&&(tt=tt.replace(voidMainRegExp,`
${rt}
void troikaOrigMain${_e}() {`),tt+=`
void main() {
  ${it}
  troikaOrigMain${_e}();
  ${nt}
}`),tt}function optionsJsonReplacer(tt,_e){return tt==="uniforms"?void 0:typeof _e=="function"?_e.toString():_e}let _idCtr=0;const optionsHashesToIds=new Map;function getKeyForOptions(tt){const _e=JSON.stringify(tt,optionsJsonReplacer);let rt=optionsHashesToIds.get(_e);return rt==null&&optionsHashesToIds.set(_e,rt=++_idCtr),rt}function createTypesetter(tt,_e,rt){const{defaultFontURL:it}=rt,nt=Object.create(null),st=1/0,at=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,lt="[^\\S\\u00A0]",ot=new RegExp(`${lt}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function ct(yt,bt){function xt(){const vt=_t=>{console.error(`Failure loading font ${yt}${yt===it?"":"; trying fallback"}`,_t),yt!==it&&(yt=it,xt())};try{const _t=new XMLHttpRequest;_t.open("get",yt,!0),_t.responseType="arraybuffer",_t.onload=function(){if(_t.status>=400)vt(new Error(_t.statusText));else if(_t.status>0)try{const Ct=tt(_t.response);bt(Ct)}catch(Ct){vt(Ct)}},_t.onerror=vt,_t.send()}catch(_t){vt(_t)}}xt()}function ut(yt,bt){yt||(yt=it);let xt=nt[yt];xt?xt.pending?xt.pending.push(bt):bt(xt):(nt[yt]={pending:[bt]},ct(yt,vt=>{let _t=nt[yt].pending;nt[yt]=vt,_t.forEach(Ct=>Ct(vt))}))}function ht({text:yt="",font:bt=it,sdfGlyphSize:xt=64,fontSize:vt=1,letterSpacing:_t=0,lineHeight:Ct="normal",maxWidth:St=st,direction:Et,textAlign:Tt="left",textIndent:Mt=0,whiteSpace:Rt="normal",overflowWrap:It="normal",anchorX:Ot=0,anchorY:Bt=0,includeCaretPositions:Nt=!1,chunkedBoundsSize:zt=8192,colorRanges:Dt=null},Ft,Ut=!1){const $t=gt(),Vt={fontLoad:0,typesetting:0};yt.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),yt=yt.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),vt=+vt,_t=+_t,St=+St,Ct=Ct||"normal",Mt=+Mt,ut(bt,Zt=>{const qt=isFinite(St);let sr=null,er=null,ir=null,ur=null,ar=null,lr=null,gr=null,Yt=0,nr=0,mr=Rt!=="nowrap";const{ascender:Sr,descender:Er,unitsPerEm:Nr,lineGap:wr,capHeight:kr,xHeight:Ur}=Zt;Vt.fontLoad=gt()-$t;const Or=gt(),Xr=vt/Nr;Ct==="normal"&&(Ct=(Sr-Er+wr)/Nr),Ct=Ct*vt;const Qt=(Ct-(Sr-Er)*Xr)/2,Xt=-(Sr*Xr+Qt),xr=Math.min(Ct,(Sr-Er)*Xr),Lr=(Sr+Er)/2*Xr-xr/2;let fr=Mt,pr=new mt;const Hr=[pr];Zt.forEachGlyph(yt,vt,_t,(tr,Ar,yr)=>{const Jt=yt.charAt(yr),_r=tr.advanceWidth*Xr,Kt=pr.count;let Qr;if("isEmpty"in tr||(tr.isWhitespace=!!Jt&&new RegExp(lt).test(Jt),tr.canBreakAfter=!!Jt&&ot.test(Jt),tr.isEmpty=tr.xMin===tr.xMax||tr.yMin===tr.yMax||at.test(Jt)),!tr.isWhitespace&&!tr.isEmpty&&nr++,mr&&qt&&!tr.isWhitespace&&Ar+_r+fr>St&&Kt){if(pr.glyphAt(Kt-1).glyphObj.canBreakAfter)Qr=new mt,fr=-Ar;else for(let Rr=Kt;Rr--;)if(Rr===0&&It==="break-word"){Qr=new mt,fr=-Ar;break}else if(pr.glyphAt(Rr).glyphObj.canBreakAfter){Qr=pr.splitAt(Rr+1);const Tr=Qr.glyphAt(0).x;fr-=Tr;for(let Vr=Qr.count;Vr--;)Qr.glyphAt(Vr).x-=Tr;break}Qr&&(pr.isSoftWrapped=!0,pr=Qr,Hr.push(pr),Yt=St)}let br=pr.glyphAt(pr.count);br.glyphObj=tr,br.x=Ar+fr,br.width=_r,br.charIndex=yr,Jt===`
`&&(pr=new mt,Hr.push(pr),fr=-(Ar+_r+_t*vt)+Mt)}),Hr.forEach(tr=>{for(let Ar=tr.count;Ar--;){let{glyphObj:yr,x:Jt,width:_r}=tr.glyphAt(Ar);if(!yr.isWhitespace){tr.width=Jt+_r,tr.width>Yt&&(Yt=tr.width);return}}});let hr=0,Cr=0;if(Ot&&(typeof Ot=="number"?hr=-Ot:typeof Ot=="string"&&(hr=-Yt*(Ot==="left"?0:Ot==="center"?.5:Ot==="right"?1:pt(Ot)))),Bt){if(typeof Bt=="number")Cr=-Bt;else if(typeof Bt=="string"){let tr=Hr.length*Ct;Cr=Bt==="top"?0:Bt==="top-baseline"?-Xt:Bt==="top-cap"?-Xt-kr*Xr:Bt==="top-ex"?-Xt-Ur*Xr:Bt==="middle"?tr/2:Bt==="bottom"?tr:Bt==="bottom-baseline"?tr-Qt+Er*Xr:pt(Bt)*tr}}if(!Ut){const tr=_e.getEmbeddingLevels(yt,Et);sr=new Uint16Array(nr),er=new Float32Array(nr*2),ir={},lr=[st,st,-st,-st],gr=[];let Ar=Xt;Nt&&(ar=new Float32Array(yt.length*3)),Dt&&(ur=new Uint8Array(nr*3));let yr=0,Jt=-1,_r=-1,Kt,Qr;if(Hr.forEach((br,Rr)=>{let{count:Tr,width:Vr}=br;if(Tr>0){let Wr=0;for(let an=Tr;an--&&br.glyphAt(an).glyphObj.isWhitespace;)Wr++;let pn=0,En=0;if(Tt==="center")pn=(Yt-Vr)/2;else if(Tt==="right")pn=Yt-Vr;else if(Tt==="justify"&&br.isSoftWrapped){let an=0;for(let yn=Tr-Wr;yn--;)br.glyphAt(yn).glyphObj.isWhitespace&&an++;En=(Yt-Vr)/an}if(En||pn){let an=0;for(let yn=0;yn<Tr;yn++){let Gn=br.glyphAt(yn);const Pn=Gn.glyphObj;Gn.x+=pn+an,En!==0&&Pn.isWhitespace&&yn<Tr-Wr&&(an+=En,Gn.width+=En)}}const rn=_e.getReorderSegments(yt,tr,br.glyphAt(0).charIndex,br.glyphAt(br.count-1).charIndex);for(let an=0;an<rn.length;an++){const[yn,Gn]=rn[an];let Pn=1/0,Sn=-1/0;for(let In=0;In<Tr;In++)if(br.glyphAt(In).charIndex>=yn){let jn=In,_n=In;for(;_n<Tr;_n++){let nn=br.glyphAt(_n);if(nn.charIndex>Gn)break;_n<Tr-Wr&&(Pn=Math.min(Pn,nn.x),Sn=Math.max(Sn,nn.x+nn.width))}for(let nn=jn;nn<_n;nn++){const Nn=br.glyphAt(nn);Nn.x=Sn-(Nn.x+Nn.width-Pn)}break}}let Cn;const vn=an=>Cn=an;for(let an=0;an<Tr;an++){let yn=br.glyphAt(an);Cn=yn.glyphObj;const Gn=Cn.index,Pn=tr.levels[yn.charIndex]&1;if(Pn){const Sn=_e.getMirroredCharacter(yt[yn.charIndex]);Sn&&Zt.forEachGlyph(Sn,0,0,vn)}if(Nt){const{charIndex:Sn}=yn,In=yn.x+hr,jn=yn.x+yn.width+hr;ar[Sn*3]=Pn?jn:In,ar[Sn*3+1]=Pn?In:jn,ar[Sn*3+2]=Ar+Lr+Cr;const _n=Sn-Jt;_n>1&&ft(ar,Jt,_n),Jt=Sn}if(Dt){const{charIndex:Sn}=yn;for(;Sn>_r;)_r++,Dt.hasOwnProperty(_r)&&(Qr=Dt[_r])}if(!Cn.isWhitespace&&!Cn.isEmpty){const Sn=yr++;ir[Gn]||(ir[Gn]={path:Cn.path,pathBounds:[Cn.xMin,Cn.yMin,Cn.xMax,Cn.yMax]});const In=yn.x+hr,jn=Ar+Cr;er[Sn*2]=In,er[Sn*2+1]=jn;const _n=In+Cn.xMin*Xr,nn=jn+Cn.yMin*Xr,Nn=In+Cn.xMax*Xr,bs=jn+Cn.yMax*Xr;_n<lr[0]&&(lr[0]=_n),nn<lr[1]&&(lr[1]=nn),Nn>lr[2]&&(lr[2]=Nn),bs>lr[3]&&(lr[3]=bs),Sn%zt===0&&(Kt={start:Sn,end:Sn,rect:[st,st,-st,-st]},gr.push(Kt)),Kt.end++;const Wt=Kt.rect;if(_n<Wt[0]&&(Wt[0]=_n),nn<Wt[1]&&(Wt[1]=nn),Nn>Wt[2]&&(Wt[2]=Nn),bs>Wt[3]&&(Wt[3]=bs),sr[Sn]=Gn,Dt){const jt=Sn*3;ur[jt]=Qr>>16&255,ur[jt+1]=Qr>>8&255,ur[jt+2]=Qr&255}}}}Ar-=Ct}),ar){const br=yt.length-Jt;br>1&&ft(ar,Jt,br)}}Vt.typesetting=gt()-Or,Ft({glyphIds:sr,glyphPositions:er,glyphData:ir,caretPositions:ar,caretHeight:xr,glyphColors:ur,chunkedBounds:gr,fontSize:vt,unitsPerEm:Nr,ascender:Sr*Xr,descender:Er*Xr,capHeight:kr*Xr,xHeight:Ur*Xr,lineHeight:Ct,topBaseline:Xt,blockBounds:[hr,Cr-Hr.length*Ct,hr+Yt,Cr],visibleBounds:lr,timings:Vt})})}function dt(yt,bt){ht(yt,xt=>{const[vt,_t,Ct,St]=xt.blockBounds;bt({width:Ct-vt,height:St-_t})},{metricsOnly:!0})}function pt(yt){let bt=yt.match(/^([\d.]+)%$/),xt=bt?parseFloat(bt[1]):NaN;return isNaN(xt)?0:xt/100}function ft(yt,bt,xt){const vt=yt[bt*3],_t=yt[bt*3+1],Ct=yt[bt*3+2],St=(_t-vt)/xt;for(let Et=0;Et<xt;Et++){const Tt=(bt+Et)*3;yt[Tt]=vt+St*Et,yt[Tt+1]=vt+St*(Et+1),yt[Tt+2]=Ct}}function gt(){return(self.performance||Date).now()}function mt(){this.data=[]}const At=["glyphObj","x","width","charIndex"];return mt.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/At.length)},glyphAt(yt){let bt=mt.flyweight;return bt.data=this.data,bt.index=yt,bt},splitAt(yt){let bt=new mt;return bt.data=this.data.splice(yt*At.length),bt}},mt.flyweight=At.reduce((yt,bt,xt,vt)=>(Object.defineProperty(yt,bt,{get(){return this.data[this.index*At.length+xt]},set(_t){this.data[this.index*At.length+xt]=_t}}),yt),{data:null,index:0}),{typeset:ht,measure:dt,loadFont:ut}}const now=()=>(self.performance||Date).now(),mainThreadGenerator=SDFGenerator();let warned;function generateSDF(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut=!0){return ut?generateSDF_GL(tt,_e,rt,it,nt,st,at,lt,ot,ct).then(null,ht=>(warned||(console.warn("WebGL SDF generation failed, falling back to JS",ht),warned=!0),generateSDF_JS_Worker(tt,_e,rt,it,nt,st,at,lt,ot,ct))):generateSDF_JS_Worker(tt,_e,rt,it,nt,st,at,lt,ot,ct)}const queue=[],chunkTimeBudget=5;let timer=0;function nextChunk(){const tt=now();for(;queue.length&&now()-tt<chunkTimeBudget;)queue.shift()();timer=queue.length?setTimeout(nextChunk,0):0}const generateSDF_GL=(...tt)=>new Promise((_e,rt)=>{queue.push(()=>{const it=now();try{mainThreadGenerator.webgl.generateIntoCanvas(...tt),_e({timing:now()-it})}catch(nt){rt(nt)}}),timer||(timer=setTimeout(nextChunk,0))}),threadCount=4,idleTimeout=2e3,threads={};let callNum=0;function generateSDF_JS_Worker(tt,_e,rt,it,nt,st,at,lt,ot,ct){const ut="TroikaTextSDFGenerator_JS_"+callNum++%threadCount;let ht=threads[ut];return ht||(ht=threads[ut]={workerModule:defineWorkerModule({name:ut,workerId:ut,dependencies:[SDFGenerator,now],init(dt,pt){const ft=dt().javascript.generate;return function(...gt){const mt=pt();return{textureData:ft(...gt),timing:pt()-mt}}},getTransferables(dt){return[dt.textureData.buffer]}}),requests:0,idleTimer:null}),ht.requests++,clearTimeout(ht.idleTimer),ht.workerModule(tt,_e,rt,it,nt,st).then(({textureData:dt,timing:pt})=>{const ft=now(),gt=new Uint8Array(dt.length*4);for(let mt=0;mt<dt.length;mt++)gt[mt*4+ct]=dt[mt];return mainThreadGenerator.webglUtils.renderImageData(at,gt,lt,ot,tt,_e,1<<3-ct),pt+=now()-ft,--ht.requests===0&&(ht.idleTimer=setTimeout(()=>{terminateWorker(ut)},idleTimeout)),{timing:pt}})}function warmUpSDFCanvas(tt){tt._warm||(mainThreadGenerator.webgl.isSupported(tt),tt._warm=!0)}const resizeWebGLCanvasWithoutClearing=mainThreadGenerator.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function typrFactory(){return typeof window>"u"&&(self.window=self),function(tt){var _e={parse:function(nt){var st=_e._bin,at=new Uint8Array(nt);if(st.readASCII(at,0,4)=="ttcf"){var lt=4;st.readUshort(at,lt),lt+=2,st.readUshort(at,lt),lt+=2;var ot=st.readUint(at,lt);lt+=4;for(var ct=[],ut=0;ut<ot;ut++){var ht=st.readUint(at,lt);lt+=4,ct.push(_e._readFont(at,ht))}return ct}return[_e._readFont(at,0)]},_readFont:function(nt,st){var at=_e._bin,lt=st;at.readFixed(nt,st),st+=4;var ot=at.readUshort(nt,st);st+=2,at.readUshort(nt,st),st+=2,at.readUshort(nt,st),st+=2,at.readUshort(nt,st),st+=2;for(var ct=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],ut={_data:nt,_offset:lt},ht={},dt=0;dt<ot;dt++){var pt=at.readASCII(nt,st,4);st+=4,at.readUint(nt,st),st+=4;var ft=at.readUint(nt,st);st+=4;var gt=at.readUint(nt,st);st+=4,ht[pt]={offset:ft,length:gt}}for(dt=0;dt<ct.length;dt++){var mt=ct[dt];ht[mt]&&(ut[mt.trim()]=_e[mt.trim()].parse(nt,ht[mt].offset,ht[mt].length,ut))}return ut},_tabOffset:function(nt,st,at){for(var lt=_e._bin,ot=lt.readUshort(nt,at+4),ct=at+12,ut=0;ut<ot;ut++){var ht=lt.readASCII(nt,ct,4);ct+=4,lt.readUint(nt,ct),ct+=4;var dt=lt.readUint(nt,ct);if(ct+=4,lt.readUint(nt,ct),ct+=4,ht==st)return dt}return 0}};_e._bin={readFixed:function(nt,st){return(nt[st]<<8|nt[st+1])+(nt[st+2]<<8|nt[st+3])/65540},readF2dot14:function(nt,st){return _e._bin.readShort(nt,st)/16384},readInt:function(nt,st){return _e._bin._view(nt).getInt32(st)},readInt8:function(nt,st){return _e._bin._view(nt).getInt8(st)},readShort:function(nt,st){return _e._bin._view(nt).getInt16(st)},readUshort:function(nt,st){return _e._bin._view(nt).getUint16(st)},readUshorts:function(nt,st,at){for(var lt=[],ot=0;ot<at;ot++)lt.push(_e._bin.readUshort(nt,st+2*ot));return lt},readUint:function(nt,st){return _e._bin._view(nt).getUint32(st)},readUint64:function(nt,st){return 4294967296*_e._bin.readUint(nt,st)+_e._bin.readUint(nt,st+4)},readASCII:function(nt,st,at){for(var lt="",ot=0;ot<at;ot++)lt+=String.fromCharCode(nt[st+ot]);return lt},readUnicode:function(nt,st,at){for(var lt="",ot=0;ot<at;ot++){var ct=nt[st++]<<8|nt[st++];lt+=String.fromCharCode(ct)}return lt},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(nt,st,at){var lt=_e._bin._tdec;return lt&&st==0&&at==nt.length?lt.decode(nt):_e._bin.readASCII(nt,st,at)},readBytes:function(nt,st,at){for(var lt=[],ot=0;ot<at;ot++)lt.push(nt[st+ot]);return lt},readASCIIArray:function(nt,st,at){for(var lt=[],ot=0;ot<at;ot++)lt.push(String.fromCharCode(nt[st+ot]));return lt},_view:function(nt){return nt._dataView||(nt._dataView=nt.buffer?new DataView(nt.buffer,nt.byteOffset,nt.byteLength):new DataView(new Uint8Array(nt).buffer))}},_e._lctf={},_e._lctf.parse=function(nt,st,at,lt,ot){var ct=_e._bin,ut={},ht=st;ct.readFixed(nt,st),st+=4;var dt=ct.readUshort(nt,st);st+=2;var pt=ct.readUshort(nt,st);st+=2;var ft=ct.readUshort(nt,st);return st+=2,ut.scriptList=_e._lctf.readScriptList(nt,ht+dt),ut.featureList=_e._lctf.readFeatureList(nt,ht+pt),ut.lookupList=_e._lctf.readLookupList(nt,ht+ft,ot),ut},_e._lctf.readLookupList=function(nt,st,at){var lt=_e._bin,ot=st,ct=[],ut=lt.readUshort(nt,st);st+=2;for(var ht=0;ht<ut;ht++){var dt=lt.readUshort(nt,st);st+=2;var pt=_e._lctf.readLookupTable(nt,ot+dt,at);ct.push(pt)}return ct},_e._lctf.readLookupTable=function(nt,st,at){var lt=_e._bin,ot=st,ct={tabs:[]};ct.ltype=lt.readUshort(nt,st),st+=2,ct.flag=lt.readUshort(nt,st),st+=2;var ut=lt.readUshort(nt,st);st+=2;for(var ht=ct.ltype,dt=0;dt<ut;dt++){var pt=lt.readUshort(nt,st);st+=2;var ft=at(nt,ht,ot+pt,ct);ct.tabs.push(ft)}return ct},_e._lctf.numOfOnes=function(nt){for(var st=0,at=0;at<32;at++)nt>>>at&1&&st++;return st},_e._lctf.readClassDef=function(nt,st){var at=_e._bin,lt=[],ot=at.readUshort(nt,st);if(st+=2,ot==1){var ct=at.readUshort(nt,st);st+=2;var ut=at.readUshort(nt,st);st+=2;for(var ht=0;ht<ut;ht++)lt.push(ct+ht),lt.push(ct+ht),lt.push(at.readUshort(nt,st)),st+=2}if(ot==2){var dt=at.readUshort(nt,st);for(st+=2,ht=0;ht<dt;ht++)lt.push(at.readUshort(nt,st)),st+=2,lt.push(at.readUshort(nt,st)),st+=2,lt.push(at.readUshort(nt,st)),st+=2}return lt},_e._lctf.getInterval=function(nt,st){for(var at=0;at<nt.length;at+=3){var lt=nt[at],ot=nt[at+1];if(nt[at+2],lt<=st&&st<=ot)return at}return-1},_e._lctf.readCoverage=function(nt,st){var at=_e._bin,lt={};lt.fmt=at.readUshort(nt,st),st+=2;var ot=at.readUshort(nt,st);return st+=2,lt.fmt==1&&(lt.tab=at.readUshorts(nt,st,ot)),lt.fmt==2&&(lt.tab=at.readUshorts(nt,st,3*ot)),lt},_e._lctf.coverageIndex=function(nt,st){var at=nt.tab;if(nt.fmt==1)return at.indexOf(st);if(nt.fmt==2){var lt=_e._lctf.getInterval(at,st);if(lt!=-1)return at[lt+2]+(st-at[lt])}return-1},_e._lctf.readFeatureList=function(nt,st){var at=_e._bin,lt=st,ot=[],ct=at.readUshort(nt,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=at.readASCII(nt,st,4);st+=4;var dt=at.readUshort(nt,st);st+=2;var pt=_e._lctf.readFeatureTable(nt,lt+dt);pt.tag=ht.trim(),ot.push(pt)}return ot},_e._lctf.readFeatureTable=function(nt,st){var at=_e._bin,lt=st,ot={},ct=at.readUshort(nt,st);st+=2,ct>0&&(ot.featureParams=lt+ct);var ut=at.readUshort(nt,st);st+=2,ot.tab=[];for(var ht=0;ht<ut;ht++)ot.tab.push(at.readUshort(nt,st+2*ht));return ot},_e._lctf.readScriptList=function(nt,st){var at=_e._bin,lt=st,ot={},ct=at.readUshort(nt,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=at.readASCII(nt,st,4);st+=4;var dt=at.readUshort(nt,st);st+=2,ot[ht.trim()]=_e._lctf.readScriptTable(nt,lt+dt)}return ot},_e._lctf.readScriptTable=function(nt,st){var at=_e._bin,lt=st,ot={},ct=at.readUshort(nt,st);st+=2,ot.default=_e._lctf.readLangSysTable(nt,lt+ct);var ut=at.readUshort(nt,st);st+=2;for(var ht=0;ht<ut;ht++){var dt=at.readASCII(nt,st,4);st+=4;var pt=at.readUshort(nt,st);st+=2,ot[dt.trim()]=_e._lctf.readLangSysTable(nt,lt+pt)}return ot},_e._lctf.readLangSysTable=function(nt,st){var at=_e._bin,lt={};at.readUshort(nt,st),st+=2,lt.reqFeature=at.readUshort(nt,st),st+=2;var ot=at.readUshort(nt,st);return st+=2,lt.features=at.readUshorts(nt,st,ot),lt},_e.CFF={},_e.CFF.parse=function(nt,st,at){var lt=_e._bin;(nt=new Uint8Array(nt.buffer,st,at))[st=0],nt[++st],nt[++st],nt[++st],st++;var ot=[];st=_e.CFF.readIndex(nt,st,ot);for(var ct=[],ut=0;ut<ot.length-1;ut++)ct.push(lt.readASCII(nt,st+ot[ut],ot[ut+1]-ot[ut]));st+=ot[ot.length-1];var ht=[];st=_e.CFF.readIndex(nt,st,ht);var dt=[];for(ut=0;ut<ht.length-1;ut++)dt.push(_e.CFF.readDict(nt,st+ht[ut],st+ht[ut+1]));st+=ht[ht.length-1];var pt=dt[0],ft=[];st=_e.CFF.readIndex(nt,st,ft);var gt=[];for(ut=0;ut<ft.length-1;ut++)gt.push(lt.readASCII(nt,st+ft[ut],ft[ut+1]-ft[ut]));if(st+=ft[ft.length-1],_e.CFF.readSubrs(nt,st,pt),pt.CharStrings){st=pt.CharStrings,ft=[],st=_e.CFF.readIndex(nt,st,ft);var mt=[];for(ut=0;ut<ft.length-1;ut++)mt.push(lt.readBytes(nt,st+ft[ut],ft[ut+1]-ft[ut]));pt.CharStrings=mt}if(pt.ROS){st=pt.FDArray;var At=[];for(st=_e.CFF.readIndex(nt,st,At),pt.FDArray=[],ut=0;ut<At.length-1;ut++){var yt=_e.CFF.readDict(nt,st+At[ut],st+At[ut+1]);_e.CFF._readFDict(nt,yt,gt),pt.FDArray.push(yt)}st+=At[At.length-1],st=pt.FDSelect,pt.FDSelect=[];var bt=nt[st];if(st++,bt!=3)throw bt;var xt=lt.readUshort(nt,st);for(st+=2,ut=0;ut<xt+1;ut++)pt.FDSelect.push(lt.readUshort(nt,st),nt[st+2]),st+=3}return pt.Encoding&&(pt.Encoding=_e.CFF.readEncoding(nt,pt.Encoding,pt.CharStrings.length)),pt.charset&&(pt.charset=_e.CFF.readCharset(nt,pt.charset,pt.CharStrings.length)),_e.CFF._readFDict(nt,pt,gt),pt},_e.CFF._readFDict=function(nt,st,at){var lt;for(var ot in st.Private&&(lt=st.Private[1],st.Private=_e.CFF.readDict(nt,lt,lt+st.Private[0]),st.Private.Subrs&&_e.CFF.readSubrs(nt,lt+st.Private.Subrs,st.Private)),st)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(ot)!=-1&&(st[ot]=at[st[ot]-426+35])},_e.CFF.readSubrs=function(nt,st,at){var lt=_e._bin,ot=[];st=_e.CFF.readIndex(nt,st,ot);var ct,ut=ot.length;ct=ut<1240?107:ut<33900?1131:32768,at.Bias=ct,at.Subrs=[];for(var ht=0;ht<ot.length-1;ht++)at.Subrs.push(lt.readBytes(nt,st+ot[ht],ot[ht+1]-ot[ht]))},_e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],_e.CFF.glyphByUnicode=function(nt,st){for(var at=0;at<nt.charset.length;at++)if(nt.charset[at]==st)return at;return-1},_e.CFF.glyphBySE=function(nt,st){return st<0||st>255?-1:_e.CFF.glyphByUnicode(nt,_e.CFF.tableSE[st])},_e.CFF.readEncoding=function(nt,st,at){_e._bin;var lt=[".notdef"],ot=nt[st];if(st++,ot!=0)throw"error: unknown encoding format: "+ot;var ct=nt[st];st++;for(var ut=0;ut<ct;ut++)lt.push(nt[st+ut]);return lt},_e.CFF.readCharset=function(nt,st,at){var lt=_e._bin,ot=[".notdef"],ct=nt[st];if(st++,ct==0)for(var ut=0;ut<at;ut++){var ht=lt.readUshort(nt,st);st+=2,ot.push(ht)}else{if(ct!=1&&ct!=2)throw"error: format: "+ct;for(;ot.length<at;){ht=lt.readUshort(nt,st),st+=2;var dt=0;for(ct==1?(dt=nt[st],st++):(dt=lt.readUshort(nt,st),st+=2),ut=0;ut<=dt;ut++)ot.push(ht),ht++}}return ot},_e.CFF.readIndex=function(nt,st,at){var lt=_e._bin,ot=lt.readUshort(nt,st)+1,ct=nt[st+=2];if(st++,ct==1)for(var ut=0;ut<ot;ut++)at.push(nt[st+ut]);else if(ct==2)for(ut=0;ut<ot;ut++)at.push(lt.readUshort(nt,st+2*ut));else if(ct==3)for(ut=0;ut<ot;ut++)at.push(16777215&lt.readUint(nt,st+3*ut-1));else if(ot!=1)throw"unsupported offset size: "+ct+", count: "+ot;return(st+=ot*ct)-1},_e.CFF.getCharString=function(nt,st,at){var lt=_e._bin,ot=nt[st],ct=nt[st+1];nt[st+2],nt[st+3],nt[st+4];var ut=1,ht=null,dt=null;ot<=20&&(ht=ot,ut=1),ot==12&&(ht=100*ot+ct,ut=2),21<=ot&&ot<=27&&(ht=ot,ut=1),ot==28&&(dt=lt.readShort(nt,st+1),ut=3),29<=ot&&ot<=31&&(ht=ot,ut=1),32<=ot&&ot<=246&&(dt=ot-139,ut=1),247<=ot&&ot<=250&&(dt=256*(ot-247)+ct+108,ut=2),251<=ot&&ot<=254&&(dt=256*-(ot-251)-ct-108,ut=2),ot==255&&(dt=lt.readInt(nt,st+1)/65535,ut=5),at.val=dt??"o"+ht,at.size=ut},_e.CFF.readCharString=function(nt,st,at){for(var lt=st+at,ot=_e._bin,ct=[];st<lt;){var ut=nt[st],ht=nt[st+1];nt[st+2],nt[st+3],nt[st+4];var dt=1,pt=null,ft=null;ut<=20&&(pt=ut,dt=1),ut==12&&(pt=100*ut+ht,dt=2),ut!=19&&ut!=20||(pt=ut,dt=2),21<=ut&&ut<=27&&(pt=ut,dt=1),ut==28&&(ft=ot.readShort(nt,st+1),dt=3),29<=ut&&ut<=31&&(pt=ut,dt=1),32<=ut&&ut<=246&&(ft=ut-139,dt=1),247<=ut&&ut<=250&&(ft=256*(ut-247)+ht+108,dt=2),251<=ut&&ut<=254&&(ft=256*-(ut-251)-ht-108,dt=2),ut==255&&(ft=ot.readInt(nt,st+1)/65535,dt=5),ct.push(ft??"o"+pt),st+=dt}return ct},_e.CFF.readDict=function(nt,st,at){for(var lt=_e._bin,ot={},ct=[];st<at;){var ut=nt[st],ht=nt[st+1];nt[st+2],nt[st+3],nt[st+4];var dt=1,pt=null,ft=null;if(ut==28&&(ft=lt.readShort(nt,st+1),dt=3),ut==29&&(ft=lt.readInt(nt,st+1),dt=5),32<=ut&&ut<=246&&(ft=ut-139,dt=1),247<=ut&&ut<=250&&(ft=256*(ut-247)+ht+108,dt=2),251<=ut&&ut<=254&&(ft=256*-(ut-251)-ht-108,dt=2),ut==255)throw ft=lt.readInt(nt,st+1)/65535,dt=5,"unknown number";if(ut==30){var gt=[];for(dt=1;;){var mt=nt[st+dt];dt++;var At=mt>>4,yt=15&mt;if(At!=15&&gt.push(At),yt!=15&&gt.push(yt),yt==15)break}for(var bt="",xt=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],vt=0;vt<gt.length;vt++)bt+=xt[gt[vt]];ft=parseFloat(bt)}ut<=21&&(pt=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][ut],dt=1,ut==12&&(pt=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][ht],dt=2)),pt!=null?(ot[pt]=ct.length==1?ct[0]:ct,ct=[]):ct.push(ft),st+=dt}return ot},_e.cmap={},_e.cmap.parse=function(nt,st,at){nt=new Uint8Array(nt.buffer,st,at),st=0;var lt=_e._bin,ot={};lt.readUshort(nt,st),st+=2;var ct=lt.readUshort(nt,st);st+=2;var ut=[];ot.tables=[];for(var ht=0;ht<ct;ht++){var dt=lt.readUshort(nt,st);st+=2;var pt=lt.readUshort(nt,st);st+=2;var ft=lt.readUint(nt,st);st+=4;var gt="p"+dt+"e"+pt,mt=ut.indexOf(ft);if(mt==-1){var At;mt=ot.tables.length,ut.push(ft);var yt=lt.readUshort(nt,ft);yt==0?At=_e.cmap.parse0(nt,ft):yt==4?At=_e.cmap.parse4(nt,ft):yt==6?At=_e.cmap.parse6(nt,ft):yt==12?At=_e.cmap.parse12(nt,ft):console.debug("unknown format: "+yt,dt,pt,ft),ot.tables.push(At)}if(ot[gt]!=null)throw"multiple tables for one platform+encoding";ot[gt]=mt}return ot},_e.cmap.parse0=function(nt,st){var at=_e._bin,lt={};lt.format=at.readUshort(nt,st),st+=2;var ot=at.readUshort(nt,st);st+=2,at.readUshort(nt,st),st+=2,lt.map=[];for(var ct=0;ct<ot-6;ct++)lt.map.push(nt[st+ct]);return lt},_e.cmap.parse4=function(nt,st){var at=_e._bin,lt=st,ot={};ot.format=at.readUshort(nt,st),st+=2;var ct=at.readUshort(nt,st);st+=2,at.readUshort(nt,st),st+=2;var ut=at.readUshort(nt,st);st+=2;var ht=ut/2;ot.searchRange=at.readUshort(nt,st),st+=2,ot.entrySelector=at.readUshort(nt,st),st+=2,ot.rangeShift=at.readUshort(nt,st),st+=2,ot.endCount=at.readUshorts(nt,st,ht),st+=2*ht,st+=2,ot.startCount=at.readUshorts(nt,st,ht),st+=2*ht,ot.idDelta=[];for(var dt=0;dt<ht;dt++)ot.idDelta.push(at.readShort(nt,st)),st+=2;for(ot.idRangeOffset=at.readUshorts(nt,st,ht),st+=2*ht,ot.glyphIdArray=[];st<lt+ct;)ot.glyphIdArray.push(at.readUshort(nt,st)),st+=2;return ot},_e.cmap.parse6=function(nt,st){var at=_e._bin,lt={};lt.format=at.readUshort(nt,st),st+=2,at.readUshort(nt,st),st+=2,at.readUshort(nt,st),st+=2,lt.firstCode=at.readUshort(nt,st),st+=2;var ot=at.readUshort(nt,st);st+=2,lt.glyphIdArray=[];for(var ct=0;ct<ot;ct++)lt.glyphIdArray.push(at.readUshort(nt,st)),st+=2;return lt},_e.cmap.parse12=function(nt,st){var at=_e._bin,lt={};lt.format=at.readUshort(nt,st),st+=2,st+=2,at.readUint(nt,st),st+=4,at.readUint(nt,st),st+=4;var ot=at.readUint(nt,st);st+=4,lt.groups=[];for(var ct=0;ct<ot;ct++){var ut=st+12*ct,ht=at.readUint(nt,ut+0),dt=at.readUint(nt,ut+4),pt=at.readUint(nt,ut+8);lt.groups.push([ht,dt,pt])}return lt},_e.glyf={},_e.glyf.parse=function(nt,st,at,lt){for(var ot=[],ct=0;ct<lt.maxp.numGlyphs;ct++)ot.push(null);return ot},_e.glyf._parseGlyf=function(nt,st){var at=_e._bin,lt=nt._data,ot=_e._tabOffset(lt,"glyf",nt._offset)+nt.loca[st];if(nt.loca[st]==nt.loca[st+1])return null;var ct={};if(ct.noc=at.readShort(lt,ot),ot+=2,ct.xMin=at.readShort(lt,ot),ot+=2,ct.yMin=at.readShort(lt,ot),ot+=2,ct.xMax=at.readShort(lt,ot),ot+=2,ct.yMax=at.readShort(lt,ot),ot+=2,ct.xMin>=ct.xMax||ct.yMin>=ct.yMax)return null;if(ct.noc>0){ct.endPts=[];for(var ut=0;ut<ct.noc;ut++)ct.endPts.push(at.readUshort(lt,ot)),ot+=2;var ht=at.readUshort(lt,ot);if(ot+=2,lt.length-ot<ht)return null;ct.instructions=at.readBytes(lt,ot,ht),ot+=ht;var dt=ct.endPts[ct.noc-1]+1;for(ct.flags=[],ut=0;ut<dt;ut++){var pt=lt[ot];if(ot++,ct.flags.push(pt),(8&pt)!=0){var ft=lt[ot];ot++;for(var gt=0;gt<ft;gt++)ct.flags.push(pt),ut++}}for(ct.xs=[],ut=0;ut<dt;ut++){var mt=(2&ct.flags[ut])!=0,At=(16&ct.flags[ut])!=0;mt?(ct.xs.push(At?lt[ot]:-lt[ot]),ot++):At?ct.xs.push(0):(ct.xs.push(at.readShort(lt,ot)),ot+=2)}for(ct.ys=[],ut=0;ut<dt;ut++)mt=(4&ct.flags[ut])!=0,At=(32&ct.flags[ut])!=0,mt?(ct.ys.push(At?lt[ot]:-lt[ot]),ot++):At?ct.ys.push(0):(ct.ys.push(at.readShort(lt,ot)),ot+=2);var yt=0,bt=0;for(ut=0;ut<dt;ut++)yt+=ct.xs[ut],bt+=ct.ys[ut],ct.xs[ut]=yt,ct.ys[ut]=bt}else{var xt;ct.parts=[];do{xt=at.readUshort(lt,ot),ot+=2;var vt={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(ct.parts.push(vt),vt.glyphIndex=at.readUshort(lt,ot),ot+=2,1&xt){var _t=at.readShort(lt,ot);ot+=2;var Ct=at.readShort(lt,ot);ot+=2}else _t=at.readInt8(lt,ot),ot++,Ct=at.readInt8(lt,ot),ot++;2&xt?(vt.m.tx=_t,vt.m.ty=Ct):(vt.p1=_t,vt.p2=Ct),8&xt?(vt.m.a=vt.m.d=at.readF2dot14(lt,ot),ot+=2):64&xt?(vt.m.a=at.readF2dot14(lt,ot),ot+=2,vt.m.d=at.readF2dot14(lt,ot),ot+=2):128&xt&&(vt.m.a=at.readF2dot14(lt,ot),ot+=2,vt.m.b=at.readF2dot14(lt,ot),ot+=2,vt.m.c=at.readF2dot14(lt,ot),ot+=2,vt.m.d=at.readF2dot14(lt,ot),ot+=2)}while(32&xt);if(256&xt){var St=at.readUshort(lt,ot);for(ot+=2,ct.instr=[],ut=0;ut<St;ut++)ct.instr.push(lt[ot]),ot++}}return ct},_e.GPOS={},_e.GPOS.parse=function(nt,st,at,lt){return _e._lctf.parse(nt,st,at,lt,_e.GPOS.subt)},_e.GPOS.subt=function(nt,st,at,lt){var ot=_e._bin,ct=at,ut={};if(ut.fmt=ot.readUshort(nt,at),at+=2,st==1||st==2||st==3||st==7||st==8&&ut.fmt<=2){var ht=ot.readUshort(nt,at);at+=2,ut.coverage=_e._lctf.readCoverage(nt,ht+ct)}if(st==1&&ut.fmt==1){var dt=ot.readUshort(nt,at);at+=2;var pt=_e._lctf.numOfOnes(dt);dt!=0&&(ut.pos=_e.GPOS.readValueRecord(nt,at,dt))}else if(st==2&&ut.fmt>=1&&ut.fmt<=2){dt=ot.readUshort(nt,at),at+=2;var ft=ot.readUshort(nt,at);at+=2,pt=_e._lctf.numOfOnes(dt);var gt=_e._lctf.numOfOnes(ft);if(ut.fmt==1){ut.pairsets=[];var mt=ot.readUshort(nt,at);at+=2;for(var At=0;At<mt;At++){var yt=ct+ot.readUshort(nt,at);at+=2;var bt=ot.readUshort(nt,yt);yt+=2;for(var xt=[],vt=0;vt<bt;vt++){var _t=ot.readUshort(nt,yt);yt+=2,dt!=0&&(Rt=_e.GPOS.readValueRecord(nt,yt,dt),yt+=2*pt),ft!=0&&(It=_e.GPOS.readValueRecord(nt,yt,ft),yt+=2*gt),xt.push({gid2:_t,val1:Rt,val2:It})}ut.pairsets.push(xt)}}if(ut.fmt==2){var Ct=ot.readUshort(nt,at);at+=2;var St=ot.readUshort(nt,at);at+=2;var Et=ot.readUshort(nt,at);at+=2;var Tt=ot.readUshort(nt,at);for(at+=2,ut.classDef1=_e._lctf.readClassDef(nt,ct+Ct),ut.classDef2=_e._lctf.readClassDef(nt,ct+St),ut.matrix=[],At=0;At<Et;At++){var Mt=[];for(vt=0;vt<Tt;vt++){var Rt=null,It=null;dt!=0&&(Rt=_e.GPOS.readValueRecord(nt,at,dt),at+=2*pt),ft!=0&&(It=_e.GPOS.readValueRecord(nt,at,ft),at+=2*gt),Mt.push({val1:Rt,val2:It})}ut.matrix.push(Mt)}}}else{if(st==9&&ut.fmt==1){var Ot=ot.readUshort(nt,at);at+=2;var Bt=ot.readUint(nt,at);if(at+=4,lt.ltype==9)lt.ltype=Ot;else if(lt.ltype!=Ot)throw"invalid extension substitution";return _e.GPOS.subt(nt,lt.ltype,ct+Bt)}console.debug("unsupported GPOS table LookupType",st,"format",ut.fmt)}return ut},_e.GPOS.readValueRecord=function(nt,st,at){var lt=_e._bin,ot=[];return ot.push(1&at?lt.readShort(nt,st):0),st+=1&at?2:0,ot.push(2&at?lt.readShort(nt,st):0),st+=2&at?2:0,ot.push(4&at?lt.readShort(nt,st):0),st+=4&at?2:0,ot.push(8&at?lt.readShort(nt,st):0),st+=8&at?2:0,ot},_e.GSUB={},_e.GSUB.parse=function(nt,st,at,lt){return _e._lctf.parse(nt,st,at,lt,_e.GSUB.subt)},_e.GSUB.subt=function(nt,st,at,lt){var ot=_e._bin,ct=at,ut={};if(ut.fmt=ot.readUshort(nt,at),at+=2,st!=1&&st!=4&&st!=5&&st!=6)return null;if(st==1||st==4||st==5&&ut.fmt<=2||st==6&&ut.fmt<=2){var ht=ot.readUshort(nt,at);at+=2,ut.coverage=_e._lctf.readCoverage(nt,ct+ht)}if(st==1&&ut.fmt>=1&&ut.fmt<=2){if(ut.fmt==1)ut.delta=ot.readShort(nt,at),at+=2;else if(ut.fmt==2){var dt=ot.readUshort(nt,at);at+=2,ut.newg=ot.readUshorts(nt,at,dt),at+=2*ut.newg.length}}else if(st==4){ut.vals=[],dt=ot.readUshort(nt,at),at+=2;for(var pt=0;pt<dt;pt++){var ft=ot.readUshort(nt,at);at+=2,ut.vals.push(_e.GSUB.readLigatureSet(nt,ct+ft))}}else if(st==5&&ut.fmt==2){if(ut.fmt==2){var gt=ot.readUshort(nt,at);at+=2,ut.cDef=_e._lctf.readClassDef(nt,ct+gt),ut.scset=[];var mt=ot.readUshort(nt,at);for(at+=2,pt=0;pt<mt;pt++){var At=ot.readUshort(nt,at);at+=2,ut.scset.push(At==0?null:_e.GSUB.readSubClassSet(nt,ct+At))}}}else if(st==6&&ut.fmt==3){if(ut.fmt==3){for(pt=0;pt<3;pt++){dt=ot.readUshort(nt,at),at+=2;for(var yt=[],bt=0;bt<dt;bt++)yt.push(_e._lctf.readCoverage(nt,ct+ot.readUshort(nt,at+2*bt)));at+=2*dt,pt==0&&(ut.backCvg=yt),pt==1&&(ut.inptCvg=yt),pt==2&&(ut.ahedCvg=yt)}dt=ot.readUshort(nt,at),at+=2,ut.lookupRec=_e.GSUB.readSubstLookupRecords(nt,at,dt)}}else{if(st==7&&ut.fmt==1){var xt=ot.readUshort(nt,at);at+=2;var vt=ot.readUint(nt,at);if(at+=4,lt.ltype==9)lt.ltype=xt;else if(lt.ltype!=xt)throw"invalid extension substitution";return _e.GSUB.subt(nt,lt.ltype,ct+vt)}console.debug("unsupported GSUB table LookupType",st,"format",ut.fmt)}return ut},_e.GSUB.readSubClassSet=function(nt,st){var at=_e._bin.readUshort,lt=st,ot=[],ct=at(nt,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=at(nt,st);st+=2,ot.push(_e.GSUB.readSubClassRule(nt,lt+ht))}return ot},_e.GSUB.readSubClassRule=function(nt,st){var at=_e._bin.readUshort,lt={},ot=at(nt,st),ct=at(nt,st+=2);st+=2,lt.input=[];for(var ut=0;ut<ot-1;ut++)lt.input.push(at(nt,st)),st+=2;return lt.substLookupRecords=_e.GSUB.readSubstLookupRecords(nt,st,ct),lt},_e.GSUB.readSubstLookupRecords=function(nt,st,at){for(var lt=_e._bin.readUshort,ot=[],ct=0;ct<at;ct++)ot.push(lt(nt,st),lt(nt,st+2)),st+=4;return ot},_e.GSUB.readChainSubClassSet=function(nt,st){var at=_e._bin,lt=st,ot=[],ct=at.readUshort(nt,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=at.readUshort(nt,st);st+=2,ot.push(_e.GSUB.readChainSubClassRule(nt,lt+ht))}return ot},_e.GSUB.readChainSubClassRule=function(nt,st){for(var at=_e._bin,lt={},ot=["backtrack","input","lookahead"],ct=0;ct<ot.length;ct++){var ut=at.readUshort(nt,st);st+=2,ct==1&&ut--,lt[ot[ct]]=at.readUshorts(nt,st,ut),st+=2*lt[ot[ct]].length}return ut=at.readUshort(nt,st),st+=2,lt.subst=at.readUshorts(nt,st,2*ut),st+=2*lt.subst.length,lt},_e.GSUB.readLigatureSet=function(nt,st){var at=_e._bin,lt=st,ot=[],ct=at.readUshort(nt,st);st+=2;for(var ut=0;ut<ct;ut++){var ht=at.readUshort(nt,st);st+=2,ot.push(_e.GSUB.readLigature(nt,lt+ht))}return ot},_e.GSUB.readLigature=function(nt,st){var at=_e._bin,lt={chain:[]};lt.nglyph=at.readUshort(nt,st),st+=2;var ot=at.readUshort(nt,st);st+=2;for(var ct=0;ct<ot-1;ct++)lt.chain.push(at.readUshort(nt,st)),st+=2;return lt},_e.head={},_e.head.parse=function(nt,st,at){var lt=_e._bin,ot={};return lt.readFixed(nt,st),st+=4,ot.fontRevision=lt.readFixed(nt,st),st+=4,lt.readUint(nt,st),st+=4,lt.readUint(nt,st),st+=4,ot.flags=lt.readUshort(nt,st),st+=2,ot.unitsPerEm=lt.readUshort(nt,st),st+=2,ot.created=lt.readUint64(nt,st),st+=8,ot.modified=lt.readUint64(nt,st),st+=8,ot.xMin=lt.readShort(nt,st),st+=2,ot.yMin=lt.readShort(nt,st),st+=2,ot.xMax=lt.readShort(nt,st),st+=2,ot.yMax=lt.readShort(nt,st),st+=2,ot.macStyle=lt.readUshort(nt,st),st+=2,ot.lowestRecPPEM=lt.readUshort(nt,st),st+=2,ot.fontDirectionHint=lt.readShort(nt,st),st+=2,ot.indexToLocFormat=lt.readShort(nt,st),st+=2,ot.glyphDataFormat=lt.readShort(nt,st),st+=2,ot},_e.hhea={},_e.hhea.parse=function(nt,st,at){var lt=_e._bin,ot={};return lt.readFixed(nt,st),st+=4,ot.ascender=lt.readShort(nt,st),st+=2,ot.descender=lt.readShort(nt,st),st+=2,ot.lineGap=lt.readShort(nt,st),st+=2,ot.advanceWidthMax=lt.readUshort(nt,st),st+=2,ot.minLeftSideBearing=lt.readShort(nt,st),st+=2,ot.minRightSideBearing=lt.readShort(nt,st),st+=2,ot.xMaxExtent=lt.readShort(nt,st),st+=2,ot.caretSlopeRise=lt.readShort(nt,st),st+=2,ot.caretSlopeRun=lt.readShort(nt,st),st+=2,ot.caretOffset=lt.readShort(nt,st),st+=2,st+=8,ot.metricDataFormat=lt.readShort(nt,st),st+=2,ot.numberOfHMetrics=lt.readUshort(nt,st),st+=2,ot},_e.hmtx={},_e.hmtx.parse=function(nt,st,at,lt){for(var ot=_e._bin,ct={aWidth:[],lsBearing:[]},ut=0,ht=0,dt=0;dt<lt.maxp.numGlyphs;dt++)dt<lt.hhea.numberOfHMetrics&&(ut=ot.readUshort(nt,st),st+=2,ht=ot.readShort(nt,st),st+=2),ct.aWidth.push(ut),ct.lsBearing.push(ht);return ct},_e.kern={},_e.kern.parse=function(nt,st,at,lt){var ot=_e._bin,ct=ot.readUshort(nt,st);if(st+=2,ct==1)return _e.kern.parseV1(nt,st-2,at,lt);var ut=ot.readUshort(nt,st);st+=2;for(var ht={glyph1:[],rval:[]},dt=0;dt<ut;dt++){st+=2,at=ot.readUshort(nt,st),st+=2;var pt=ot.readUshort(nt,st);st+=2;var ft=pt>>>8;if((ft&=15)!=0)throw"unknown kern table format: "+ft;st=_e.kern.readFormat0(nt,st,ht)}return ht},_e.kern.parseV1=function(nt,st,at,lt){var ot=_e._bin;ot.readFixed(nt,st),st+=4;var ct=ot.readUint(nt,st);st+=4;for(var ut={glyph1:[],rval:[]},ht=0;ht<ct;ht++){ot.readUint(nt,st),st+=4;var dt=ot.readUshort(nt,st);st+=2,ot.readUshort(nt,st),st+=2;var pt=dt>>>8;if((pt&=15)!=0)throw"unknown kern table format: "+pt;st=_e.kern.readFormat0(nt,st,ut)}return ut},_e.kern.readFormat0=function(nt,st,at){var lt=_e._bin,ot=-1,ct=lt.readUshort(nt,st);st+=2,lt.readUshort(nt,st),st+=2,lt.readUshort(nt,st),st+=2,lt.readUshort(nt,st),st+=2;for(var ut=0;ut<ct;ut++){var ht=lt.readUshort(nt,st);st+=2;var dt=lt.readUshort(nt,st);st+=2;var pt=lt.readShort(nt,st);st+=2,ht!=ot&&(at.glyph1.push(ht),at.rval.push({glyph2:[],vals:[]}));var ft=at.rval[at.rval.length-1];ft.glyph2.push(dt),ft.vals.push(pt),ot=ht}return st},_e.loca={},_e.loca.parse=function(nt,st,at,lt){var ot=_e._bin,ct=[],ut=lt.head.indexToLocFormat,ht=lt.maxp.numGlyphs+1;if(ut==0)for(var dt=0;dt<ht;dt++)ct.push(ot.readUshort(nt,st+(dt<<1))<<1);if(ut==1)for(dt=0;dt<ht;dt++)ct.push(ot.readUint(nt,st+(dt<<2)));return ct},_e.maxp={},_e.maxp.parse=function(nt,st,at){var lt=_e._bin,ot={},ct=lt.readUint(nt,st);return st+=4,ot.numGlyphs=lt.readUshort(nt,st),st+=2,ct==65536&&(ot.maxPoints=lt.readUshort(nt,st),st+=2,ot.maxContours=lt.readUshort(nt,st),st+=2,ot.maxCompositePoints=lt.readUshort(nt,st),st+=2,ot.maxCompositeContours=lt.readUshort(nt,st),st+=2,ot.maxZones=lt.readUshort(nt,st),st+=2,ot.maxTwilightPoints=lt.readUshort(nt,st),st+=2,ot.maxStorage=lt.readUshort(nt,st),st+=2,ot.maxFunctionDefs=lt.readUshort(nt,st),st+=2,ot.maxInstructionDefs=lt.readUshort(nt,st),st+=2,ot.maxStackElements=lt.readUshort(nt,st),st+=2,ot.maxSizeOfInstructions=lt.readUshort(nt,st),st+=2,ot.maxComponentElements=lt.readUshort(nt,st),st+=2,ot.maxComponentDepth=lt.readUshort(nt,st),st+=2),ot},_e.name={},_e.name.parse=function(nt,st,at){var lt=_e._bin,ot={};lt.readUshort(nt,st),st+=2;var ct=lt.readUshort(nt,st);st+=2,lt.readUshort(nt,st);for(var ut,ht=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],dt=st+=2,pt=0;pt<ct;pt++){var ft=lt.readUshort(nt,st);st+=2;var gt=lt.readUshort(nt,st);st+=2;var mt=lt.readUshort(nt,st);st+=2;var At=lt.readUshort(nt,st);st+=2;var yt=lt.readUshort(nt,st);st+=2;var bt=lt.readUshort(nt,st);st+=2;var xt,vt=ht[At],_t=dt+12*ct+bt;if(ft==0)xt=lt.readUnicode(nt,_t,yt/2);else if(ft==3&&gt==0)xt=lt.readUnicode(nt,_t,yt/2);else if(gt==0)xt=lt.readASCII(nt,_t,yt);else if(gt==1)xt=lt.readUnicode(nt,_t,yt/2);else if(gt==3)xt=lt.readUnicode(nt,_t,yt/2);else{if(ft!=1)throw"unknown encoding "+gt+", platformID: "+ft;xt=lt.readASCII(nt,_t,yt),console.debug("reading unknown MAC encoding "+gt+" as ASCII")}var Ct="p"+ft+","+mt.toString(16);ot[Ct]==null&&(ot[Ct]={}),ot[Ct][vt!==void 0?vt:At]=xt,ot[Ct]._lang=mt}for(var St in ot)if(ot[St].postScriptName!=null&&ot[St]._lang==1033)return ot[St];for(var St in ot)if(ot[St].postScriptName!=null&&ot[St]._lang==0)return ot[St];for(var St in ot)if(ot[St].postScriptName!=null&&ot[St]._lang==3084)return ot[St];for(var St in ot)if(ot[St].postScriptName!=null)return ot[St];for(var St in ot){ut=St;break}return console.debug("returning name table with languageID "+ot[ut]._lang),ot[ut]},_e["OS/2"]={},_e["OS/2"].parse=function(nt,st,at){var lt=_e._bin.readUshort(nt,st);st+=2;var ot={};if(lt==0)_e["OS/2"].version0(nt,st,ot);else if(lt==1)_e["OS/2"].version1(nt,st,ot);else if(lt==2||lt==3||lt==4)_e["OS/2"].version2(nt,st,ot);else{if(lt!=5)throw"unknown OS/2 table version: "+lt;_e["OS/2"].version5(nt,st,ot)}return ot},_e["OS/2"].version0=function(nt,st,at){var lt=_e._bin;return at.xAvgCharWidth=lt.readShort(nt,st),st+=2,at.usWeightClass=lt.readUshort(nt,st),st+=2,at.usWidthClass=lt.readUshort(nt,st),st+=2,at.fsType=lt.readUshort(nt,st),st+=2,at.ySubscriptXSize=lt.readShort(nt,st),st+=2,at.ySubscriptYSize=lt.readShort(nt,st),st+=2,at.ySubscriptXOffset=lt.readShort(nt,st),st+=2,at.ySubscriptYOffset=lt.readShort(nt,st),st+=2,at.ySuperscriptXSize=lt.readShort(nt,st),st+=2,at.ySuperscriptYSize=lt.readShort(nt,st),st+=2,at.ySuperscriptXOffset=lt.readShort(nt,st),st+=2,at.ySuperscriptYOffset=lt.readShort(nt,st),st+=2,at.yStrikeoutSize=lt.readShort(nt,st),st+=2,at.yStrikeoutPosition=lt.readShort(nt,st),st+=2,at.sFamilyClass=lt.readShort(nt,st),st+=2,at.panose=lt.readBytes(nt,st,10),st+=10,at.ulUnicodeRange1=lt.readUint(nt,st),st+=4,at.ulUnicodeRange2=lt.readUint(nt,st),st+=4,at.ulUnicodeRange3=lt.readUint(nt,st),st+=4,at.ulUnicodeRange4=lt.readUint(nt,st),st+=4,at.achVendID=[lt.readInt8(nt,st),lt.readInt8(nt,st+1),lt.readInt8(nt,st+2),lt.readInt8(nt,st+3)],st+=4,at.fsSelection=lt.readUshort(nt,st),st+=2,at.usFirstCharIndex=lt.readUshort(nt,st),st+=2,at.usLastCharIndex=lt.readUshort(nt,st),st+=2,at.sTypoAscender=lt.readShort(nt,st),st+=2,at.sTypoDescender=lt.readShort(nt,st),st+=2,at.sTypoLineGap=lt.readShort(nt,st),st+=2,at.usWinAscent=lt.readUshort(nt,st),st+=2,at.usWinDescent=lt.readUshort(nt,st),st+=2},_e["OS/2"].version1=function(nt,st,at){var lt=_e._bin;return st=_e["OS/2"].version0(nt,st,at),at.ulCodePageRange1=lt.readUint(nt,st),st+=4,at.ulCodePageRange2=lt.readUint(nt,st),st+=4},_e["OS/2"].version2=function(nt,st,at){var lt=_e._bin;return st=_e["OS/2"].version1(nt,st,at),at.sxHeight=lt.readShort(nt,st),st+=2,at.sCapHeight=lt.readShort(nt,st),st+=2,at.usDefault=lt.readUshort(nt,st),st+=2,at.usBreak=lt.readUshort(nt,st),st+=2,at.usMaxContext=lt.readUshort(nt,st),st+=2},_e["OS/2"].version5=function(nt,st,at){var lt=_e._bin;return st=_e["OS/2"].version2(nt,st,at),at.usLowerOpticalPointSize=lt.readUshort(nt,st),st+=2,at.usUpperOpticalPointSize=lt.readUshort(nt,st),st+=2},_e.post={},_e.post.parse=function(nt,st,at){var lt=_e._bin,ot={};return ot.version=lt.readFixed(nt,st),st+=4,ot.italicAngle=lt.readFixed(nt,st),st+=4,ot.underlinePosition=lt.readShort(nt,st),st+=2,ot.underlineThickness=lt.readShort(nt,st),st+=2,ot},_e==null&&(_e={}),_e.U==null&&(_e.U={}),_e.U.codeToGlyph=function(nt,st){var at=nt.cmap,lt=-1;if(at.p0e4!=null?lt=at.p0e4:at.p3e1!=null?lt=at.p3e1:at.p1e0!=null?lt=at.p1e0:at.p0e3!=null&&(lt=at.p0e3),lt==-1)throw"no familiar platform and encoding!";var ot=at.tables[lt];if(ot.format==0)return st>=ot.map.length?0:ot.map[st];if(ot.format==4){for(var ct=-1,ut=0;ut<ot.endCount.length;ut++)if(st<=ot.endCount[ut]){ct=ut;break}return ct==-1||ot.startCount[ct]>st?0:65535&(ot.idRangeOffset[ct]!=0?ot.glyphIdArray[st-ot.startCount[ct]+(ot.idRangeOffset[ct]>>1)-(ot.idRangeOffset.length-ct)]:st+ot.idDelta[ct])}if(ot.format==12){if(st>ot.groups[ot.groups.length-1][1])return 0;for(ut=0;ut<ot.groups.length;ut++){var ht=ot.groups[ut];if(ht[0]<=st&&st<=ht[1])return ht[2]+(st-ht[0])}return 0}throw"unknown cmap table format "+ot.format},_e.U.glyphToPath=function(nt,st){var at={cmds:[],crds:[]};if(nt.SVG&&nt.SVG.entries[st]){var lt=nt.SVG.entries[st];return lt==null?at:(typeof lt=="string"&&(lt=_e.SVG.toPath(lt),nt.SVG.entries[st]=lt),lt)}if(nt.CFF){var ot={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:nt.CFF.Private?nt.CFF.Private.defaultWidthX:0,open:!1},ct=nt.CFF,ut=nt.CFF.Private;if(ct.ROS){for(var ht=0;ct.FDSelect[ht+2]<=st;)ht+=2;ut=ct.FDArray[ct.FDSelect[ht+1]].Private}_e.U._drawCFF(nt.CFF.CharStrings[st],ot,ct,ut,at)}else nt.glyf&&_e.U._drawGlyf(st,nt,at);return at},_e.U._drawGlyf=function(nt,st,at){var lt=st.glyf[nt];lt==null&&(lt=st.glyf[nt]=_e.glyf._parseGlyf(st,nt)),lt!=null&&(lt.noc>-1?_e.U._simpleGlyph(lt,at):_e.U._compoGlyph(lt,st,at))},_e.U._simpleGlyph=function(nt,st){for(var at=0;at<nt.noc;at++){for(var lt=at==0?0:nt.endPts[at-1]+1,ot=nt.endPts[at],ct=lt;ct<=ot;ct++){var ut=ct==lt?ot:ct-1,ht=ct==ot?lt:ct+1,dt=1&nt.flags[ct],pt=1&nt.flags[ut],ft=1&nt.flags[ht],gt=nt.xs[ct],mt=nt.ys[ct];if(ct==lt)if(dt){if(!pt){_e.U.P.moveTo(st,gt,mt);continue}_e.U.P.moveTo(st,nt.xs[ut],nt.ys[ut])}else pt?_e.U.P.moveTo(st,nt.xs[ut],nt.ys[ut]):_e.U.P.moveTo(st,(nt.xs[ut]+gt)/2,(nt.ys[ut]+mt)/2);dt?pt&&_e.U.P.lineTo(st,gt,mt):ft?_e.U.P.qcurveTo(st,gt,mt,nt.xs[ht],nt.ys[ht]):_e.U.P.qcurveTo(st,gt,mt,(gt+nt.xs[ht])/2,(mt+nt.ys[ht])/2)}_e.U.P.closePath(st)}},_e.U._compoGlyph=function(nt,st,at){for(var lt=0;lt<nt.parts.length;lt++){var ot={cmds:[],crds:[]},ct=nt.parts[lt];_e.U._drawGlyf(ct.glyphIndex,st,ot);for(var ut=ct.m,ht=0;ht<ot.crds.length;ht+=2){var dt=ot.crds[ht],pt=ot.crds[ht+1];at.crds.push(dt*ut.a+pt*ut.b+ut.tx),at.crds.push(dt*ut.c+pt*ut.d+ut.ty)}for(ht=0;ht<ot.cmds.length;ht++)at.cmds.push(ot.cmds[ht])}},_e.U._getGlyphClass=function(nt,st){var at=_e._lctf.getInterval(st,nt);return at==-1?0:st[at+2]},_e.U.getPairAdjustment=function(nt,st,at){var lt=!1;if(nt.GPOS)for(var ot=nt.GPOS,ct=ot.lookupList,ut=ot.featureList,ht=[],dt=0;dt<ut.length;dt++){var pt=ut[dt];if(pt.tag=="kern"){lt=!0;for(var ft=0;ft<pt.tab.length;ft++)if(!ht[pt.tab[ft]]){ht[pt.tab[ft]]=!0;for(var gt=ct[pt.tab[ft]],mt=0;mt<gt.tabs.length;mt++)if(gt.tabs[mt]!=null){var At,yt=gt.tabs[mt];if((!yt.coverage||(At=_e._lctf.coverageIndex(yt.coverage,st))!=-1)&&gt.ltype!=1){if(gt.ltype==2){var bt=null;if(yt.fmt==1){var xt=yt.pairsets[At];for(dt=0;dt<xt.length;dt++)xt[dt].gid2==at&&(bt=xt[dt])}else if(yt.fmt==2){var vt=_e.U._getGlyphClass(st,yt.classDef1),_t=_e.U._getGlyphClass(at,yt.classDef2);bt=yt.matrix[vt][_t]}if(bt){var Ct=0;return bt.val1&&bt.val1[2]&&(Ct+=bt.val1[2]),bt.val2&&bt.val2[0]&&(Ct+=bt.val2[0]),Ct}}}}}}}if(nt.kern&&!lt){var St=nt.kern.glyph1.indexOf(st);if(St!=-1){var Et=nt.kern.rval[St].glyph2.indexOf(at);if(Et!=-1)return nt.kern.rval[St].vals[Et]}}return 0},_e.U._applySubs=function(nt,st,at,lt){for(var ot=nt.length-st-1,ct=0;ct<at.tabs.length;ct++)if(at.tabs[ct]!=null){var ut,ht=at.tabs[ct];if(!ht.coverage||(ut=_e._lctf.coverageIndex(ht.coverage,nt[st]))!=-1){if(at.ltype==1)nt[st],ht.fmt==1?nt[st]=nt[st]+ht.delta:nt[st]=ht.newg[ut];else if(at.ltype==4)for(var dt=ht.vals[ut],pt=0;pt<dt.length;pt++){var ft=dt[pt],gt=ft.chain.length;if(!(gt>ot)){for(var mt=!0,At=0,yt=0;yt<gt;yt++){for(;nt[st+At+(1+yt)]==-1;)At++;ft.chain[yt]!=nt[st+At+(1+yt)]&&(mt=!1)}if(mt){for(nt[st]=ft.nglyph,yt=0;yt<gt+At;yt++)nt[st+yt+1]=-1;break}}}else if(at.ltype==5&&ht.fmt==2)for(var bt=_e._lctf.getInterval(ht.cDef,nt[st]),xt=ht.cDef[bt+2],vt=ht.scset[xt],_t=0;_t<vt.length;_t++){var Ct=vt[_t],St=Ct.input;if(!(St.length>ot)){for(mt=!0,yt=0;yt<St.length;yt++){var Et=_e._lctf.getInterval(ht.cDef,nt[st+1+yt]);if(bt==-1&&ht.cDef[Et+2]!=St[yt]){mt=!1;break}}if(mt){var Tt=Ct.substLookupRecords;for(pt=0;pt<Tt.length;pt+=2)Tt[pt],Tt[pt+1]}}}else if(at.ltype==6&&ht.fmt==3){if(!_e.U._glsCovered(nt,ht.backCvg,st-ht.backCvg.length)||!_e.U._glsCovered(nt,ht.inptCvg,st)||!_e.U._glsCovered(nt,ht.ahedCvg,st+ht.inptCvg.length))continue;var Mt=ht.lookupRec;for(_t=0;_t<Mt.length;_t+=2){bt=Mt[_t];var Rt=lt[Mt[_t+1]];_e.U._applySubs(nt,st+bt,Rt,lt)}}}}},_e.U._glsCovered=function(nt,st,at){for(var lt=0;lt<st.length;lt++)if(_e._lctf.coverageIndex(st[lt],nt[at+lt])==-1)return!1;return!0},_e.U.glyphsToPath=function(nt,st,at){for(var lt={cmds:[],crds:[]},ot=0,ct=0;ct<st.length;ct++){var ut=st[ct];if(ut!=-1){for(var ht=ct<st.length-1&&st[ct+1]!=-1?st[ct+1]:0,dt=_e.U.glyphToPath(nt,ut),pt=0;pt<dt.crds.length;pt+=2)lt.crds.push(dt.crds[pt]+ot),lt.crds.push(dt.crds[pt+1]);for(at&&lt.cmds.push(at),pt=0;pt<dt.cmds.length;pt++)lt.cmds.push(dt.cmds[pt]);at&&lt.cmds.push("X"),ot+=nt.hmtx.aWidth[ut],ct<st.length-1&&(ot+=_e.U.getPairAdjustment(nt,ut,ht))}}return lt},_e.U.P={},_e.U.P.moveTo=function(nt,st,at){nt.cmds.push("M"),nt.crds.push(st,at)},_e.U.P.lineTo=function(nt,st,at){nt.cmds.push("L"),nt.crds.push(st,at)},_e.U.P.curveTo=function(nt,st,at,lt,ot,ct,ut){nt.cmds.push("C"),nt.crds.push(st,at,lt,ot,ct,ut)},_e.U.P.qcurveTo=function(nt,st,at,lt,ot){nt.cmds.push("Q"),nt.crds.push(st,at,lt,ot)},_e.U.P.closePath=function(nt){nt.cmds.push("Z")},_e.U._drawCFF=function(nt,st,at,lt,ot){for(var ct=st.stack,ut=st.nStems,ht=st.haveWidth,dt=st.width,pt=st.open,ft=0,gt=st.x,mt=st.y,At=0,yt=0,bt=0,xt=0,vt=0,_t=0,Ct=0,St=0,Et=0,Tt=0,Mt={val:0,size:0};ft<nt.length;){_e.CFF.getCharString(nt,ft,Mt);var Rt=Mt.val;if(ft+=Mt.size,Rt=="o1"||Rt=="o18")ct.length%2!=0&&!ht&&(dt=ct.shift()+lt.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0;else if(Rt=="o3"||Rt=="o23")ct.length%2!=0&&!ht&&(dt=ct.shift()+lt.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0;else if(Rt=="o4")ct.length>1&&!ht&&(dt=ct.shift()+lt.nominalWidthX,ht=!0),pt&&_e.U.P.closePath(ot),mt+=ct.pop(),_e.U.P.moveTo(ot,gt,mt),pt=!0;else if(Rt=="o5")for(;ct.length>0;)gt+=ct.shift(),mt+=ct.shift(),_e.U.P.lineTo(ot,gt,mt);else if(Rt=="o6"||Rt=="o7")for(var It=ct.length,Ot=Rt=="o6",Bt=0;Bt<It;Bt++){var Nt=ct.shift();Ot?gt+=Nt:mt+=Nt,Ot=!Ot,_e.U.P.lineTo(ot,gt,mt)}else if(Rt=="o8"||Rt=="o24"){It=ct.length;for(var zt=0;zt+6<=It;)At=gt+ct.shift(),yt=mt+ct.shift(),bt=At+ct.shift(),xt=yt+ct.shift(),gt=bt+ct.shift(),mt=xt+ct.shift(),_e.U.P.curveTo(ot,At,yt,bt,xt,gt,mt),zt+=6;Rt=="o24"&&(gt+=ct.shift(),mt+=ct.shift(),_e.U.P.lineTo(ot,gt,mt))}else{if(Rt=="o11")break;if(Rt=="o1234"||Rt=="o1235"||Rt=="o1236"||Rt=="o1237")Rt=="o1234"&&(yt=mt,bt=(At=gt+ct.shift())+ct.shift(),Tt=xt=yt+ct.shift(),_t=xt,St=mt,gt=(Ct=(vt=(Et=bt+ct.shift())+ct.shift())+ct.shift())+ct.shift(),_e.U.P.curveTo(ot,At,yt,bt,xt,Et,Tt),_e.U.P.curveTo(ot,vt,_t,Ct,St,gt,mt)),Rt=="o1235"&&(At=gt+ct.shift(),yt=mt+ct.shift(),bt=At+ct.shift(),xt=yt+ct.shift(),Et=bt+ct.shift(),Tt=xt+ct.shift(),vt=Et+ct.shift(),_t=Tt+ct.shift(),Ct=vt+ct.shift(),St=_t+ct.shift(),gt=Ct+ct.shift(),mt=St+ct.shift(),ct.shift(),_e.U.P.curveTo(ot,At,yt,bt,xt,Et,Tt),_e.U.P.curveTo(ot,vt,_t,Ct,St,gt,mt)),Rt=="o1236"&&(At=gt+ct.shift(),yt=mt+ct.shift(),bt=At+ct.shift(),Tt=xt=yt+ct.shift(),_t=xt,Ct=(vt=(Et=bt+ct.shift())+ct.shift())+ct.shift(),St=_t+ct.shift(),gt=Ct+ct.shift(),_e.U.P.curveTo(ot,At,yt,bt,xt,Et,Tt),_e.U.P.curveTo(ot,vt,_t,Ct,St,gt,mt)),Rt=="o1237"&&(At=gt+ct.shift(),yt=mt+ct.shift(),bt=At+ct.shift(),xt=yt+ct.shift(),Et=bt+ct.shift(),Tt=xt+ct.shift(),vt=Et+ct.shift(),_t=Tt+ct.shift(),Ct=vt+ct.shift(),St=_t+ct.shift(),Math.abs(Ct-gt)>Math.abs(St-mt)?gt=Ct+ct.shift():mt=St+ct.shift(),_e.U.P.curveTo(ot,At,yt,bt,xt,Et,Tt),_e.U.P.curveTo(ot,vt,_t,Ct,St,gt,mt));else if(Rt=="o14"){if(ct.length>0&&!ht&&(dt=ct.shift()+at.nominalWidthX,ht=!0),ct.length==4){var Dt=ct.shift(),Ft=ct.shift(),Ut=ct.shift(),$t=ct.shift(),Vt=_e.CFF.glyphBySE(at,Ut),Zt=_e.CFF.glyphBySE(at,$t);_e.U._drawCFF(at.CharStrings[Vt],st,at,lt,ot),st.x=Dt,st.y=Ft,_e.U._drawCFF(at.CharStrings[Zt],st,at,lt,ot)}pt&&(_e.U.P.closePath(ot),pt=!1)}else if(Rt=="o19"||Rt=="o20")ct.length%2!=0&&!ht&&(dt=ct.shift()+lt.nominalWidthX),ut+=ct.length>>1,ct.length=0,ht=!0,ft+=ut+7>>3;else if(Rt=="o21")ct.length>2&&!ht&&(dt=ct.shift()+lt.nominalWidthX,ht=!0),mt+=ct.pop(),gt+=ct.pop(),pt&&_e.U.P.closePath(ot),_e.U.P.moveTo(ot,gt,mt),pt=!0;else if(Rt=="o22")ct.length>1&&!ht&&(dt=ct.shift()+lt.nominalWidthX,ht=!0),gt+=ct.pop(),pt&&_e.U.P.closePath(ot),_e.U.P.moveTo(ot,gt,mt),pt=!0;else if(Rt=="o25"){for(;ct.length>6;)gt+=ct.shift(),mt+=ct.shift(),_e.U.P.lineTo(ot,gt,mt);At=gt+ct.shift(),yt=mt+ct.shift(),bt=At+ct.shift(),xt=yt+ct.shift(),gt=bt+ct.shift(),mt=xt+ct.shift(),_e.U.P.curveTo(ot,At,yt,bt,xt,gt,mt)}else if(Rt=="o26")for(ct.length%2&&(gt+=ct.shift());ct.length>0;)At=gt,yt=mt+ct.shift(),gt=bt=At+ct.shift(),mt=(xt=yt+ct.shift())+ct.shift(),_e.U.P.curveTo(ot,At,yt,bt,xt,gt,mt);else if(Rt=="o27")for(ct.length%2&&(mt+=ct.shift());ct.length>0;)yt=mt,bt=(At=gt+ct.shift())+ct.shift(),xt=yt+ct.shift(),gt=bt+ct.shift(),mt=xt,_e.U.P.curveTo(ot,At,yt,bt,xt,gt,mt);else if(Rt=="o10"||Rt=="o29"){var qt=Rt=="o10"?lt:at;if(ct.length==0)console.debug("error: empty stack");else{var sr=ct.pop(),er=qt.Subrs[sr+qt.Bias];st.x=gt,st.y=mt,st.nStems=ut,st.haveWidth=ht,st.width=dt,st.open=pt,_e.U._drawCFF(er,st,at,lt,ot),gt=st.x,mt=st.y,ut=st.nStems,ht=st.haveWidth,dt=st.width,pt=st.open}}else if(Rt=="o30"||Rt=="o31"){var ir=ct.length,ur=(zt=0,Rt=="o31");for(zt+=ir-(It=-3&ir);zt<It;)ur?(yt=mt,bt=(At=gt+ct.shift())+ct.shift(),mt=(xt=yt+ct.shift())+ct.shift(),It-zt==5?(gt=bt+ct.shift(),zt++):gt=bt,ur=!1):(At=gt,yt=mt+ct.shift(),bt=At+ct.shift(),xt=yt+ct.shift(),gt=bt+ct.shift(),It-zt==5?(mt=xt+ct.shift(),zt++):mt=xt,ur=!0),_e.U.P.curveTo(ot,At,yt,bt,xt,gt,mt),zt+=4}else{if((Rt+"").charAt(0)=="o")throw console.debug("Unknown operation: "+Rt,nt),Rt;ct.push(Rt)}}}st.x=gt,st.y=mt,st.nStems=ut,st.haveWidth=ht,st.width=dt,st.open=pt};var rt=_e,it={Typr:rt};return tt.Typr=rt,tt.default=it,Object.defineProperty(tt,"__esModule",{value:!0}),tt}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function woff2otfFactory(){return function(tt){var _e=Uint8Array,rt=Uint16Array,it=Uint32Array,nt=new _e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),st=new _e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),at=new _e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lt=function(Rt,It){for(var Ot=new rt(31),Bt=0;Bt<31;++Bt)Ot[Bt]=It+=1<<Rt[Bt-1];var Nt=new it(Ot[30]);for(Bt=1;Bt<30;++Bt)for(var zt=Ot[Bt];zt<Ot[Bt+1];++zt)Nt[zt]=zt-Ot[Bt]<<5|Bt;return[Ot,Nt]},ot=lt(nt,2),ct=ot[0],ut=ot[1];ct[28]=258,ut[258]=28;for(var ht=lt(st,0)[0],dt=new rt(32768),pt=0;pt<32768;++pt){var ft=(43690&pt)>>>1|(21845&pt)<<1;ft=(61680&(ft=(52428&ft)>>>2|(13107&ft)<<2))>>>4|(3855&ft)<<4,dt[pt]=((65280&ft)>>>8|(255&ft)<<8)>>>1}var gt=function(Rt,It,Ot){for(var Bt=Rt.length,Nt=0,zt=new rt(It);Nt<Bt;++Nt)++zt[Rt[Nt]-1];var Dt,Ft=new rt(It);for(Nt=0;Nt<It;++Nt)Ft[Nt]=Ft[Nt-1]+zt[Nt-1]<<1;if(Ot){Dt=new rt(1<<It);var Ut=15-It;for(Nt=0;Nt<Bt;++Nt)if(Rt[Nt])for(var $t=Nt<<4|Rt[Nt],Vt=It-Rt[Nt],Zt=Ft[Rt[Nt]-1]++<<Vt,qt=Zt|(1<<Vt)-1;Zt<=qt;++Zt)Dt[dt[Zt]>>>Ut]=$t}else for(Dt=new rt(Bt),Nt=0;Nt<Bt;++Nt)Rt[Nt]&&(Dt[Nt]=dt[Ft[Rt[Nt]-1]++]>>>15-Rt[Nt]);return Dt},mt=new _e(288);for(pt=0;pt<144;++pt)mt[pt]=8;for(pt=144;pt<256;++pt)mt[pt]=9;for(pt=256;pt<280;++pt)mt[pt]=7;for(pt=280;pt<288;++pt)mt[pt]=8;var At=new _e(32);for(pt=0;pt<32;++pt)At[pt]=5;var yt=gt(mt,9,1),bt=gt(At,5,1),xt=function(Rt){for(var It=Rt[0],Ot=1;Ot<Rt.length;++Ot)Rt[Ot]>It&&(It=Rt[Ot]);return It},vt=function(Rt,It,Ot){var Bt=It/8|0;return(Rt[Bt]|Rt[Bt+1]<<8)>>(7&It)&Ot},_t=function(Rt,It){var Ot=It/8|0;return(Rt[Ot]|Rt[Ot+1]<<8|Rt[Ot+2]<<16)>>(7&It)},Ct=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],St=function(Rt,It,Ot){var Bt=new Error(It||Ct[Rt]);if(Bt.code=Rt,Error.captureStackTrace&&Error.captureStackTrace(Bt,St),!Ot)throw Bt;return Bt},Et=function(Rt,It,Ot){var Bt=Rt.length;if(!Bt||Ot&&!Ot.l&&Bt<5)return It||new _e(0);var Nt=!It||Ot,zt=!Ot||Ot.i;Ot||(Ot={}),It||(It=new _e(3*Bt));var Dt,Ft=function(Jt){var _r=It.length;if(Jt>_r){var Kt=new _e(Math.max(2*_r,Jt));Kt.set(It),It=Kt}},Ut=Ot.f||0,$t=Ot.p||0,Vt=Ot.b||0,Zt=Ot.l,qt=Ot.d,sr=Ot.m,er=Ot.n,ir=8*Bt;do{if(!Zt){Ot.f=Ut=vt(Rt,$t,1);var ur=vt(Rt,$t+1,3);if($t+=3,!ur){var ar=Rt[(Ur=((Dt=$t)/8|0)+(7&Dt&&1)+4)-4]|Rt[Ur-3]<<8,lr=Ur+ar;if(lr>Bt){zt&&St(0);break}Nt&&Ft(Vt+ar),It.set(Rt.subarray(Ur,lr),Vt),Ot.b=Vt+=ar,Ot.p=$t=8*lr;continue}if(ur==1)Zt=yt,qt=bt,sr=9,er=5;else if(ur==2){var gr=vt(Rt,$t,31)+257,Yt=vt(Rt,$t+10,15)+4,nr=gr+vt(Rt,$t+5,31)+1;$t+=14;for(var mr=new _e(nr),Sr=new _e(19),Er=0;Er<Yt;++Er)Sr[at[Er]]=vt(Rt,$t+3*Er,7);$t+=3*Yt;var Nr=xt(Sr),wr=(1<<Nr)-1,kr=gt(Sr,Nr,1);for(Er=0;Er<nr;){var Ur,Or=kr[vt(Rt,$t,wr)];if($t+=15&Or,(Ur=Or>>>4)<16)mr[Er++]=Ur;else{var Xr=0,Qt=0;for(Ur==16?(Qt=3+vt(Rt,$t,3),$t+=2,Xr=mr[Er-1]):Ur==17?(Qt=3+vt(Rt,$t,7),$t+=3):Ur==18&&(Qt=11+vt(Rt,$t,127),$t+=7);Qt--;)mr[Er++]=Xr}}var Xt=mr.subarray(0,gr),xr=mr.subarray(gr);sr=xt(Xt),er=xt(xr),Zt=gt(Xt,sr,1),qt=gt(xr,er,1)}else St(1);if($t>ir){zt&&St(0);break}}Nt&&Ft(Vt+131072);for(var Lr=(1<<sr)-1,fr=(1<<er)-1,pr=$t;;pr=$t){var Hr=(Xr=Zt[_t(Rt,$t)&Lr])>>>4;if(($t+=15&Xr)>ir){zt&&St(0);break}if(Xr||St(2),Hr<256)It[Vt++]=Hr;else{if(Hr==256){pr=$t,Zt=null;break}var hr=Hr-254;if(Hr>264){var Cr=nt[Er=Hr-257];hr=vt(Rt,$t,(1<<Cr)-1)+ct[Er],$t+=Cr}var tr=qt[_t(Rt,$t)&fr],Ar=tr>>>4;if(tr||St(3),$t+=15&tr,xr=ht[Ar],Ar>3&&(Cr=st[Ar],xr+=_t(Rt,$t)&(1<<Cr)-1,$t+=Cr),$t>ir){zt&&St(0);break}Nt&&Ft(Vt+131072);for(var yr=Vt+hr;Vt<yr;Vt+=4)It[Vt]=It[Vt-xr],It[Vt+1]=It[Vt+1-xr],It[Vt+2]=It[Vt+2-xr],It[Vt+3]=It[Vt+3-xr];Vt=yr}}Ot.l=Zt,Ot.p=pr,Ot.b=Vt,Zt&&(Ut=1,Ot.m=sr,Ot.d=qt,Ot.n=er)}while(!Ut);return Vt==It.length?It:function(Jt,_r,Kt){(_r==null||_r<0)&&(_r=0),(Kt==null||Kt>Jt.length)&&(Kt=Jt.length);var Qr=new(Jt instanceof rt?rt:Jt instanceof it?it:_e)(Kt-_r);return Qr.set(Jt.subarray(_r,Kt)),Qr}(It,0,Vt)},Tt=new _e(0),Mt=typeof TextDecoder<"u"&&new TextDecoder;try{Mt.decode(Tt,{stream:!0})}catch{}return tt.convert_streams=function(Rt){var It=new DataView(Rt),Ot=0;function Bt(){var gr=It.getUint16(Ot);return Ot+=2,gr}function Nt(){var gr=It.getUint32(Ot);return Ot+=4,gr}function zt(gr){ar.setUint16(lr,gr),lr+=2}function Dt(gr){ar.setUint32(lr,gr),lr+=4}for(var Ft={signature:Nt(),flavor:Nt(),length:Nt(),numTables:Bt(),reserved:Bt(),totalSfntSize:Nt(),majorVersion:Bt(),minorVersion:Bt(),metaOffset:Nt(),metaLength:Nt(),metaOrigLength:Nt(),privOffset:Nt(),privLength:Nt()},Ut=0;Math.pow(2,Ut)<=Ft.numTables;)Ut++;Ut--;for(var $t=16*Math.pow(2,Ut),Vt=16*Ft.numTables-$t,Zt=12,qt=[],sr=0;sr<Ft.numTables;sr++)qt.push({tag:Nt(),offset:Nt(),compLength:Nt(),origLength:Nt(),origChecksum:Nt()}),Zt+=16;var er,ir=new Uint8Array(12+16*qt.length+qt.reduce(function(gr,Yt){return gr+Yt.origLength+4},0)),ur=ir.buffer,ar=new DataView(ur),lr=0;return Dt(Ft.flavor),zt(Ft.numTables),zt($t),zt(Ut),zt(Vt),qt.forEach(function(gr){Dt(gr.tag),Dt(gr.origChecksum),Dt(Zt),Dt(gr.origLength),gr.outOffset=Zt,(Zt+=gr.origLength)%4!=0&&(Zt+=4-Zt%4)}),qt.forEach(function(gr){var Yt,nr=Rt.slice(gr.offset,gr.offset+gr.compLength);if(gr.compLength!=gr.origLength){var mr=new Uint8Array(gr.origLength);Yt=new Uint8Array(nr,2),Et(Yt,mr)}else mr=new Uint8Array(nr);ir.set(mr,gr.outOffset);var Sr=0;(Zt=gr.outOffset+gr.origLength)%4!=0&&(Sr=4-Zt%4),ir.set(new Uint8Array(Sr).buffer,gr.outOffset+gr.origLength),er=Zt+Sr}),ur.slice(0,er)},Object.defineProperty(tt,"__esModule",{value:!0}),tt}({}).convert_streams}function parserFactory(tt,_e){const rt={M:2,L:2,Q:4,C:6,Z:0},it={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},nt=1,st=2,at=4,lt=8,ot=16,ct=32;let ut;function ht(vt){if(!ut){const _t={R:st,L:nt,D:at,C:ot,U:ct,T:lt};ut=new Map;for(let Ct in it){let St=0;it[Ct].split(",").forEach(Et=>{let[Tt,Mt]=Et.split("+");Tt=parseInt(Tt,36),Mt=Mt?parseInt(Mt,36):0,ut.set(St+=Tt,_t[Ct]);for(let Rt=Mt;Rt--;)ut.set(++St,_t[Ct])})}}return ut.get(vt)||ct}const dt=1,pt=2,ft=3,gt=4,mt=[null,"isol","init","fina","medi"];function At(vt){const _t=new Uint8Array(vt.length);let Ct=ct,St=dt,Et=-1;for(let Tt=0;Tt<vt.length;Tt++){const Mt=vt.codePointAt(Tt);let Rt=ht(Mt)|0,It=dt;Rt&lt||(Ct&(nt|at|ot)?Rt&(st|at|ot)?(It=ft,(St===dt||St===ft)&&_t[Et]++):Rt&(nt|ct)&&(St===pt||St===gt)&&_t[Et]--:Ct&(st|ct)&&(St===pt||St===gt)&&_t[Et]--,St=_t[Tt]=It,Ct=Rt,Et=Tt,Mt>65535&&Tt++)}return _t}function yt(vt,_t){const Ct=[];for(let Et=0;Et<_t.length;Et++){const Tt=_t.codePointAt(Et);Tt>65535&&Et++,Ct.push(tt.U.codeToGlyph(vt,Tt))}const St=vt.GSUB;if(St){const{lookupList:Et,featureList:Tt}=St;let Mt;const Rt=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,It=[];Tt.forEach(Ot=>{if(Rt.test(Ot.tag))for(let Bt=0;Bt<Ot.tab.length;Bt++){if(It[Ot.tab[Bt]])continue;It[Ot.tab[Bt]]=!0;const Nt=Et[Ot.tab[Bt]],zt=/^(isol|init|fina|medi)$/.test(Ot.tag);zt&&!Mt&&(Mt=At(_t));for(let Dt=0;Dt<Ct.length;Dt++)(!Mt||!zt||mt[Mt[Dt]]===Ot.tag)&&tt.U._applySubs(Ct,Dt,Nt,Et)}})}return Ct}function bt(...vt){for(let _t=0;_t<vt.length;_t++)if(typeof vt[_t]=="number")return vt[_t]}function xt(vt){const _t=Object.create(null),Ct=vt["OS/2"],St=vt.hhea,Et=vt.head.unitsPerEm,Tt=bt(Ct&&Ct.sTypoAscender,St&&St.ascender,Et),Mt={unitsPerEm:Et,ascender:Tt,descender:bt(Ct&&Ct.sTypoDescender,St&&St.descender,0),capHeight:bt(Ct&&Ct.sCapHeight,Tt),xHeight:bt(Ct&&Ct.sxHeight,Tt),lineGap:bt(Ct&&Ct.sTypoLineGap,St&&St.lineGap),forEachGlyph(Rt,It,Ot,Bt){let Nt=0;const zt=1/Mt.unitsPerEm*It,Dt=yt(vt,Rt);let Ft=0,Ut=-1;return Dt.forEach(($t,Vt)=>{if($t!==-1){let Zt=_t[$t];if(!Zt){const{cmds:qt,crds:sr}=tt.U.glyphToPath(vt,$t);let er="",ir=0;for(let Yt=0,nr=qt.length;Yt<nr;Yt++){const mr=rt[qt[Yt]];er+=qt[Yt];for(let Sr=1;Sr<=mr;Sr++)er+=(Sr>1?",":"")+sr[ir++]}let ur,ar,lr,gr;if(sr.length){ur=ar=1/0,lr=gr=-1/0;for(let Yt=0,nr=sr.length;Yt<nr;Yt+=2){let mr=sr[Yt],Sr=sr[Yt+1];mr<ur&&(ur=mr),Sr<ar&&(ar=Sr),mr>lr&&(lr=mr),Sr>gr&&(gr=Sr)}}else ur=lr=ar=gr=0;Zt=_t[$t]={index:$t,advanceWidth:vt.hmtx.aWidth[$t],xMin:ur,yMin:ar,xMax:lr,yMax:gr,path:er,pathCommandCount:qt.length}}Ut!==-1&&(Nt+=tt.U.getPairAdjustment(vt,Ut,$t)*zt),Bt.call(null,Zt,Nt,Ft),Zt.advanceWidth&&(Nt+=Zt.advanceWidth*zt),Ot&&(Nt+=Ot*It),Ut=$t}Ft+=Rt.codePointAt(Ft)>65535?2:1}),Nt}};return Mt}return function(_t){const Ct=new Uint8Array(_t,0,4),St=tt._bin.readASCII(Ct,0,4);if(St==="wOFF")_t=_e(_t);else if(St==="wOF2")throw new Error("woff2 fonts not supported");return xt(tt.parse(_t)[0])}}const workerModule=defineWorkerModule({name:"Typr Font Parser",dependencies:[typrFactory,woff2otfFactory,parserFactory],init(tt,_e,rt){const it=tt(),nt=_e();return rt(it,nt)}}),CONFIG={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},tempColor=new Color$1;function now$1(){return(self.performance||Date).now()}const atlases=Object.create(null);function getTextRenderInfo(tt,_e){tt=assign$3({},tt);const rt=now$1();if(tt.font=toAbsoluteURL(tt.font||CONFIG.defaultFontURL),tt.text=""+tt.text,tt.sdfGlyphSize=tt.sdfGlyphSize||CONFIG.sdfGlyphSize,tt.colorRanges!=null){let ht={};for(let dt in tt.colorRanges)if(tt.colorRanges.hasOwnProperty(dt)){let pt=tt.colorRanges[dt];typeof pt!="number"&&(pt=tempColor.set(pt).getHex()),ht[dt]=pt}tt.colorRanges=ht}Object.freeze(tt);const{textureWidth:it,sdfExponent:nt}=CONFIG,{sdfGlyphSize:st}=tt,at=it/st*4;let lt=atlases[st];if(!lt){const ht=document.createElement("canvas");ht.width=it,ht.height=st*256/at,lt=atlases[st]={glyphCount:0,sdfGlyphSize:st,sdfCanvas:ht,sdfTexture:new Texture(ht,void 0,void 0,void 0,LinearFilter,LinearFilter),contextLost:!1,glyphsByFont:new Map},lt.sdfTexture.generateMipmaps=!1,initContextLossHandling(lt)}const{sdfTexture:ot,sdfCanvas:ct}=lt;let ut=lt.glyphsByFont.get(tt.font);ut||lt.glyphsByFont.set(tt.font,ut=new Map),typesetInWorker(tt).then(ht=>{const{glyphIds:dt,glyphPositions:pt,fontSize:ft,unitsPerEm:gt,timings:mt}=ht,At=[],yt=new Float32Array(dt.length*4),bt=ft/gt;let xt=0,vt=0;const _t=now$1();dt.forEach((Mt,Rt)=>{let It=ut.get(Mt);if(!It){const{path:zt,pathBounds:Dt}=ht.glyphData[Mt],Ft=Math.max(Dt[2]-Dt[0],Dt[3]-Dt[1])/st*(CONFIG.sdfMargin*st+.5),Ut=lt.glyphCount++,$t=[Dt[0]-Ft,Dt[1]-Ft,Dt[2]+Ft,Dt[3]+Ft];ut.set(Mt,It={path:zt,atlasIndex:Ut,sdfViewBox:$t}),At.push(It)}const{sdfViewBox:Ot}=It,Bt=pt[vt++],Nt=pt[vt++];yt[xt++]=Bt+Ot[0]*bt,yt[xt++]=Nt+Ot[1]*bt,yt[xt++]=Bt+Ot[2]*bt,yt[xt++]=Nt+Ot[3]*bt,dt[Rt]=It.atlasIndex}),mt.quads=(mt.quads||0)+(now$1()-_t);const Ct=now$1();mt.sdf={};const St=ct.height,Et=Math.ceil(lt.glyphCount/at),Tt=Math.pow(2,Math.ceil(Math.log2(Et*st)));Tt>St&&(console.info(`Increasing SDF texture size ${St}->${Tt}`),resizeWebGLCanvasWithoutClearing(ct,it,Tt),ot.dispose()),Promise.all(At.map(Mt=>generateGlyphSDF(Mt,lt,tt.gpuAccelerateSDF).then(({timing:Rt})=>{mt.sdf[Mt.atlasIndex]=Rt}))).then(()=>{At.length&&!lt.contextLost&&(safariPre15Workaround(lt),ot.needsUpdate=!0),mt.sdfTotal=now$1()-Ct,mt.total=now$1()-rt,_e(Object.freeze({parameters:tt,sdfTexture:ot,sdfGlyphSize:st,sdfExponent:nt,glyphBounds:yt,glyphAtlasIndices:dt,glyphColors:ht.glyphColors,caretPositions:ht.caretPositions,caretHeight:ht.caretHeight,chunkedBounds:ht.chunkedBounds,ascender:ht.ascender,descender:ht.descender,lineHeight:ht.lineHeight,capHeight:ht.capHeight,xHeight:ht.xHeight,topBaseline:ht.topBaseline,blockBounds:ht.blockBounds,visibleBounds:ht.visibleBounds,timings:ht.timings}))})}),Promise.resolve().then(()=>{lt.contextLost||warmUpSDFCanvas(ct)})}function generateGlyphSDF({path:tt,atlasIndex:_e,sdfViewBox:rt},{sdfGlyphSize:it,sdfCanvas:nt,contextLost:st},at){if(st)return Promise.resolve({timing:-1});const{textureWidth:lt,sdfExponent:ot}=CONFIG,ct=Math.max(rt[2]-rt[0],rt[3]-rt[1]),ut=Math.floor(_e/4),ht=ut%(lt/it)*it,dt=Math.floor(ut/(lt/it))*it,pt=_e%4;return generateSDF(it,it,tt,rt,ct,ot,nt,ht,dt,pt,at)}function initContextLossHandling(tt){const _e=tt.sdfCanvas;_e.addEventListener("webglcontextlost",rt=>{console.log("Context Lost",rt),rt.preventDefault(),tt.contextLost=!0}),_e.addEventListener("webglcontextrestored",rt=>{console.log("Context Restored",rt),tt.contextLost=!1;const it=[];tt.glyphsByFont.forEach(nt=>{nt.forEach(st=>{it.push(generateGlyphSDF(st,tt,!0))})}),Promise.all(it).then(()=>{safariPre15Workaround(tt),tt.sdfTexture.needsUpdate=!0})})}function preloadFont({font:tt,characters:_e,sdfGlyphSize:rt},it){let nt=Array.isArray(_e)?_e.join(`
`):""+_e;getTextRenderInfo({font:tt,sdfGlyphSize:rt,text:nt},it)}function assign$3(tt,_e){for(let rt in _e)_e.hasOwnProperty(rt)&&(tt[rt]=_e[rt]);return tt}let linkEl;function toAbsoluteURL(tt){return linkEl||(linkEl=typeof document>"u"?{}:document.createElement("a")),linkEl.href=tt,linkEl.href}function safariPre15Workaround(tt){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:_e,sdfTexture:rt}=tt,{width:it,height:nt}=_e,st=tt.sdfCanvas.getContext("webgl");let at=rt.image.data;(!at||at.length!==it*nt*4)&&(at=new Uint8Array(it*nt*4),rt.image={width:it,height:nt,data:at},rt.flipY=!1,rt.isDataTexture=!0),st.readPixels(0,0,it,nt,st.RGBA,st.UNSIGNED_BYTE,at)}}const typesetterWorkerModule=defineWorkerModule({name:"Typesetter",dependencies:[CONFIG,workerModule,createTypesetter,bidiFactory],init(tt,_e,rt,it){const{defaultFontURL:nt}=tt;return rt(_e,it(),{defaultFontURL:nt})}}),typesetInWorker=defineWorkerModule({name:"Typesetter",dependencies:[typesetterWorkerModule],init(tt){return function(_e){return new Promise(rt=>{tt.typeset(_e,rt)})}},getTransferables(tt){const _e=[tt.glyphPositions.buffer,tt.glyphIds.buffer];return tt.caretPositions&&_e.push(tt.caretPositions.buffer),tt.glyphColors&&_e.push(tt.glyphColors.buffer),_e}}),templateGeometries={};function getTemplateGeometry(tt){let _e=templateGeometries[tt];if(!_e){const rt=new PlaneGeometry(1,1,tt,tt),it=rt.clone(),nt=rt.attributes,st=it.attributes,at=new BufferGeometry,lt=nt.uv.count;for(let ot=0;ot<lt;ot++)st.position.array[ot*3]*=-1,st.normal.array[ot*3+2]*=-1;["position","normal","uv"].forEach(ot=>{at.setAttribute(ot,new Float32BufferAttribute([...nt[ot].array,...st[ot].array],nt[ot].itemSize))}),at.setIndex([...rt.index.array,...it.index.array.map(ot=>ot+lt)]),at.translate(.5,.5,0),_e=templateGeometries[tt]=at}return _e}const glyphBoundsAttrName="aTroikaGlyphBounds",glyphIndexAttrName="aTroikaGlyphIndex",glyphColorAttrName="aTroikaGlyphColor";class GlyphsGeometry extends InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Sphere,this.boundingBox=new Box3}computeBoundingSphere(){}computeBoundingBox(){}setSide(_e){const rt=this.getIndex().count;this.setDrawRange(_e===BackSide?rt/2:0,_e===DoubleSide?rt:rt/2)}set detail(_e){if(_e!==this._detail){this._detail=_e,(typeof _e!="number"||_e<1)&&(_e=1);let rt=getTemplateGeometry(_e);["position","normal","uv"].forEach(it=>{this.attributes[it]=rt.attributes[it].clone()}),this.setIndex(rt.getIndex().clone())}}get detail(){return this._detail}set curveRadius(_e){_e!==this._curveRadius&&(this._curveRadius=_e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(_e,rt,it,nt,st){updateBufferAttr(this,glyphBoundsAttrName,_e,4),updateBufferAttr(this,glyphIndexAttrName,rt,1),updateBufferAttr(this,glyphColorAttrName,st,3),this._blockBounds=it,this._chunkedBounds=nt,this.instanceCount=rt.length,this._updateBounds()}_updateBounds(){const _e=this._blockBounds;if(_e){const{curveRadius:rt,boundingBox:it}=this;if(rt){const{PI:nt,floor:st,min:at,max:lt,sin:ot,cos:ct}=Math,ut=nt/2,ht=nt*2,dt=Math.abs(rt),pt=_e[0]/dt,ft=_e[2]/dt,gt=st((pt+ut)/ht)!==st((ft+ut)/ht)?-dt:at(ot(pt)*dt,ot(ft)*dt),mt=st((pt-ut)/ht)!==st((ft-ut)/ht)?dt:lt(ot(pt)*dt,ot(ft)*dt),At=st((pt+nt)/ht)!==st((ft+nt)/ht)?dt*2:lt(dt-ct(pt)*dt,dt-ct(ft)*dt);it.min.set(gt,_e[1],rt<0?-At:0),it.max.set(mt,_e[3],rt<0?0:At)}else it.min.set(_e[0],_e[1],0),it.max.set(_e[2],_e[3],0);it.getBoundingSphere(this.boundingSphere)}}applyClipRect(_e){let rt=this.getAttribute(glyphIndexAttrName).count,it=this._chunkedBounds;if(it)for(let nt=it.length;nt--;){rt=it[nt].end;let st=it[nt].rect;if(st[1]<_e.w&&st[3]>_e.y&&st[0]<_e.z&&st[2]>_e.x)break}this.instanceCount=rt}}function updateBufferAttr(tt,_e,rt,it){const nt=tt.getAttribute(_e);rt?nt&&nt.array.length===rt.length?(nt.array.set(rt),nt.needsUpdate=!0):(tt.setAttribute(_e,new InstancedBufferAttribute(rt,it)),delete tt._maxInstanceCount,tt.dispose()):nt&&tt.deleteAttribute(_e)}const VERTEX_DEFS=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,VERTEX_TRANSFORM=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,FRAGMENT_DEFS=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,FRAGMENT_TRANSFORM=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function createTextDerivedMaterial(tt){const _e=createDerivedMaterial(tt,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Vector4(0,0,0,0)},uTroikaClipRect:{value:new Vector4(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Color$1},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:VERTEX_DEFS,vertexTransform:VERTEX_TRANSFORM,fragmentDefs:FRAGMENT_DEFS,fragmentColorTransform:FRAGMENT_TRANSFORM,customRewriter({vertexShader:rt,fragmentShader:it}){let nt=/\buniform\s+vec3\s+diffuse\b/;return nt.test(it)&&(it=it.replace(nt,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),nt.test(rt)||(rt=rt.replace(voidMainRegExp,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:rt,fragmentShader:it}}});return _e.transparent=!0,Object.defineProperties(_e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),_e}const defaultMaterial=new MeshBasicMaterial({color:16777215,side:DoubleSide,transparent:!0}),defaultStrokeColor=8421504,tempMat4=new Matrix4,tempVec3a=new Vector3,tempVec3b=new Vector3,tempArray=[],origin=new Vector3,defaultOrient="+x+y";function first(tt){return Array.isArray(tt)?tt[0]:tt}let getFlatRaycastMesh=()=>{const tt=new Mesh(new PlaneGeometry(1,1),defaultMaterial);return getFlatRaycastMesh=()=>tt,tt},getCurvedRaycastMesh=()=>{const tt=new Mesh(new PlaneGeometry(1,1,32,1),defaultMaterial);return getCurvedRaycastMesh=()=>tt,tt};const syncStartEvent={type:"syncstart"},syncCompleteEvent={type:"synccomplete"},SYNCABLE_PROPS=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],COPYABLE_PROPS=SYNCABLE_PROPS.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Text$1=class extends Mesh{constructor(){const _e=new GlyphsGeometry;super(_e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=defaultStrokeColor,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=defaultOrient,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(_e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(_e):(this._isSyncing=!0,this.dispatchEvent(syncStartEvent),getTextRenderInfo({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},rt=>{this._isSyncing=!1,this._textRenderInfo=rt,this.geometry.updateGlyphs(rt.glyphBounds,rt.glyphAtlasIndices,rt.blockBounds,rt.chunkedBounds,rt.glyphColors);const it=this._queuedSyncs;it&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{it.forEach(nt=>nt&&nt())})),this.dispatchEvent(syncCompleteEvent),_e&&_e()})))}onBeforeRender(_e,rt,it,nt,st,at){this.sync(),st.isTroikaTextMaterial&&this._prepareForRender(st),st._hadOwnSide=st.hasOwnProperty("side"),this.geometry.setSide(st._actualSide=st.side),st.side=FrontSide}onAfterRender(_e,rt,it,nt,st,at){st._hadOwnSide?st.side=st._actualSide:delete st.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let _e=this._derivedMaterial;const rt=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=defaultMaterial.clone());if((!_e||_e.baseMaterial!==rt)&&(_e=this._derivedMaterial=createTextDerivedMaterial(rt),rt.addEventListener("dispose",function it(){rt.removeEventListener("dispose",it),_e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let it=_e._outlineMtl;return it||(it=_e._outlineMtl=Object.create(_e,{id:{value:_e.id+.1}}),it.isTextOutlineMaterial=!0,it.depthWrite=!1,it.map=null,_e.addEventListener("dispose",function nt(){_e.removeEventListener("dispose",nt),it.dispose()})),[it,_e]}else return _e}set material(_e){_e&&_e.isTroikaTextMaterial?(this._derivedMaterial=_e,this._baseMaterial=_e.baseMaterial):this._baseMaterial=_e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(_e){this.geometry.detail=_e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(_e){this.geometry.curveRadius=_e}get customDepthMaterial(){return first(this.material).getDepthMaterial()}get customDistanceMaterial(){return first(this.material).getDistanceMaterial()}_prepareForRender(_e){const rt=_e.isTextOutlineMaterial,it=_e.uniforms,nt=this.textRenderInfo;if(nt){const{sdfTexture:lt,blockBounds:ot}=nt;it.uTroikaSDFTexture.value=lt,it.uTroikaSDFTextureSize.value.set(lt.image.width,lt.image.height),it.uTroikaSDFGlyphSize.value=nt.sdfGlyphSize,it.uTroikaSDFExponent.value=nt.sdfExponent,it.uTroikaTotalBounds.value.fromArray(ot),it.uTroikaUseGlyphColors.value=!rt&&!!nt.glyphColors;let ct=0,ut=0,ht=0,dt,pt,ft,gt=0,mt=0;if(rt){let{outlineWidth:yt,outlineOffsetX:bt,outlineOffsetY:xt,outlineBlur:vt,outlineOpacity:_t}=this;ct=this._parsePercent(yt)||0,ut=Math.max(0,this._parsePercent(vt)||0),dt=_t,gt=this._parsePercent(bt)||0,mt=this._parsePercent(xt)||0}else ht=Math.max(0,this._parsePercent(this.strokeWidth)||0),ht&&(ft=this.strokeColor,it.uTroikaStrokeColor.value.set(ft??defaultStrokeColor),pt=this.strokeOpacity,pt==null&&(pt=1)),dt=this.fillOpacity;it.uTroikaDistanceOffset.value=ct,it.uTroikaPositionOffset.value.set(gt,mt),it.uTroikaBlurRadius.value=ut,it.uTroikaStrokeWidth.value=ht,it.uTroikaStrokeOpacity.value=pt,it.uTroikaFillOpacity.value=dt??1,it.uTroikaCurveRadius.value=this.curveRadius||0;let At=this.clipRect;if(At&&Array.isArray(At)&&At.length===4)it.uTroikaClipRect.value.fromArray(At);else{const yt=(this.fontSize||.1)*100;it.uTroikaClipRect.value.set(ot[0]-yt,ot[1]-yt,ot[2]+yt,ot[3]+yt)}this.geometry.applyClipRect(it.uTroikaClipRect.value)}it.uTroikaSDFDebug.value=!!this.debugSDF,_e.polygonOffset=!!this.depthOffset,_e.polygonOffsetFactor=_e.polygonOffsetUnits=this.depthOffset||0;const st=rt?this.outlineColor||0:this.color;if(st==null)delete _e.color;else{const lt=_e.hasOwnProperty("color")?_e.color:_e.color=new Color$1;(st!==lt._input||typeof st=="object")&&lt.set(lt._input=st)}let at=this.orientation||defaultOrient;if(at!==_e._orientation){let lt=it.uTroikaOrient.value;at=at.replace(/[^-+xyz]/g,"");let ot=at!==defaultOrient&&at.match(/^([-+])([xyz])([-+])([xyz])$/);if(ot){let[,ct,ut,ht,dt]=ot;tempVec3a.set(0,0,0)[ut]=ct==="-"?1:-1,tempVec3b.set(0,0,0)[dt]=ht==="-"?-1:1,tempMat4.lookAt(origin,tempVec3a.cross(tempVec3b),tempVec3b),lt.setFromMatrix4(tempMat4)}else lt.identity();_e._orientation=at}}_parsePercent(_e){if(typeof _e=="string"){let rt=_e.match(/^(-?[\d.]+)%$/),it=rt?parseFloat(rt[1]):NaN;_e=(isNaN(it)?0:it/100)*this.fontSize}return _e}localPositionToTextCoords(_e,rt=new Vector2){rt.copy(_e);const it=this.curveRadius;return it&&(rt.x=Math.atan2(_e.x,Math.abs(it)-Math.abs(_e.z))*Math.abs(it)),rt}worldPositionToTextCoords(_e,rt=new Vector2){return tempVec3a.copy(_e),this.localPositionToTextCoords(this.worldToLocal(tempVec3a),rt)}raycast(_e,rt){const{textRenderInfo:it,curveRadius:nt}=this;if(it){const st=it.blockBounds,at=nt?getCurvedRaycastMesh():getFlatRaycastMesh(),lt=at.geometry,{position:ot,uv:ct}=lt.attributes;for(let ut=0;ut<ct.count;ut++){let ht=st[0]+ct.getX(ut)*(st[2]-st[0]);const dt=st[1]+ct.getY(ut)*(st[3]-st[1]);let pt=0;nt&&(pt=nt-Math.cos(ht/nt)*nt,ht=Math.sin(ht/nt)*nt),ot.setXYZ(ut,ht,dt,pt)}lt.boundingSphere=this.geometry.boundingSphere,lt.boundingBox=this.geometry.boundingBox,at.matrixWorld=this.matrixWorld,at.material.side=this.material.side,tempArray.length=0,at.raycast(_e,tempArray);for(let ut=0;ut<tempArray.length;ut++)tempArray[ut].object=this,rt.push(tempArray[ut])}}copy(_e){const rt=this.geometry;return super.copy(_e),this.geometry=rt,COPYABLE_PROPS.forEach(it=>{this[it]=_e[it]}),this}clone(){return new this.constructor().copy(this)}};SYNCABLE_PROPS.forEach(tt=>{const _e="_private_"+tt;Object.defineProperty(Text$1.prototype,tt,{get(){return this[_e]},set(rt){rt!==this[_e]&&(this[_e]=rt,this._needsSync=!0)}})});const Text=reactExports.forwardRef(({sdfGlyphSize:tt=64,anchorX:_e="center",anchorY:rt="middle",font:it,fontSize:nt=1,children:st,characters:at,onSync:lt,...ot},ct)=>{const ut=useThree(({invalidate:ft})=>ft),[ht]=reactExports.useState(()=>new Text$1),[dt,pt]=reactExports.useMemo(()=>{const ft=[];let gt="";return reactExports.Children.forEach(st,mt=>{typeof mt=="string"||typeof mt=="number"?gt+=mt:ft.push(mt)}),[ft,gt]},[st]);return suspend(()=>new Promise(ft=>preloadFont({font:it,characters:at},ft)),["troika-text",it,at]),reactExports.useLayoutEffect(()=>void ht.sync(()=>{ut(),lt&&lt(ht)})),reactExports.useEffect(()=>()=>ht.dispose(),[ht]),reactExports.createElement("primitive",_extends$1({object:ht,ref:ct,font:it,text:pt,anchorX:_e,anchorY:rt,fontSize:nt,sdfGlyphSize:tt},ot),dt)}),OrbitControls=reactExports.forwardRef(({makeDefault:tt,camera:_e,regress:rt,domElement:it,enableDamping:nt=!0,keyEvents:st=!1,onChange:at,onStart:lt,onEnd:ot,...ct},ut)=>{const ht=useThree(_t=>_t.invalidate),dt=useThree(_t=>_t.camera),pt=useThree(_t=>_t.gl),ft=useThree(_t=>_t.events),gt=useThree(_t=>_t.setEvents),mt=useThree(_t=>_t.set),At=useThree(_t=>_t.get),yt=useThree(_t=>_t.performance),bt=_e||dt,xt=it||ft.connected||pt.domElement,vt=reactExports.useMemo(()=>new OrbitControls$1(bt),[bt]);return useFrame(()=>{vt.enabled&&vt.update()},-1),reactExports.useEffect(()=>(st&&vt.connect(st===!0?xt:st),vt.connect(xt),()=>void vt.dispose()),[st,xt,rt,vt,ht]),reactExports.useEffect(()=>{const _t=Et=>{ht(),rt&&yt.regress(),at&&at(Et)},Ct=Et=>{lt&&lt(Et)},St=Et=>{ot&&ot(Et)};return vt.addEventListener("change",_t),vt.addEventListener("start",Ct),vt.addEventListener("end",St),()=>{vt.removeEventListener("start",Ct),vt.removeEventListener("end",St),vt.removeEventListener("change",_t)}},[at,lt,ot,vt,ht,gt]),reactExports.useEffect(()=>{if(tt){const _t=At().controls;return mt({controls:vt}),()=>mt({controls:_t})}},[tt,vt]),reactExports.createElement("primitive",_extends$1({ref:ut,object:vt,enableDamping:nt},ct))});var stats_min={exports:{}};(function(tt,_e){(function(rt,it){tt.exports=it()})(commonjsGlobal$1,function(){var rt=function(){function it(pt){return at.appendChild(pt.dom),pt}function nt(pt){for(var ft=0;ft<at.children.length;ft++)at.children[ft].style.display=ft===pt?"block":"none";st=pt}var st=0,at=document.createElement("div");at.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",at.addEventListener("click",function(pt){pt.preventDefault(),nt(++st%at.children.length)},!1);var lt=(performance||Date).now(),ot=lt,ct=0,ut=it(new rt.Panel("FPS","#0ff","#002")),ht=it(new rt.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var dt=it(new rt.Panel("MB","#f08","#201"));return nt(0),{REVISION:16,dom:at,addPanel:it,showPanel:nt,begin:function(){lt=(performance||Date).now()},end:function(){ct++;var pt=(performance||Date).now();if(ht.update(pt-lt,200),pt>ot+1e3&&(ut.update(1e3*ct/(pt-ot),100),ot=pt,ct=0,dt)){var ft=performance.memory;dt.update(ft.usedJSHeapSize/1048576,ft.jsHeapSizeLimit/1048576)}return pt},update:function(){lt=this.end()},domElement:at,setMode:nt}};return rt.Panel=function(it,nt,st){var at=1/0,lt=0,ot=Math.round,ct=ot(window.devicePixelRatio||1),ut=80*ct,ht=48*ct,dt=3*ct,pt=2*ct,ft=3*ct,gt=15*ct,mt=74*ct,At=30*ct,yt=document.createElement("canvas");yt.width=ut,yt.height=ht,yt.style.cssText="width:80px;height:48px";var bt=yt.getContext("2d");return bt.font="bold "+9*ct+"px Helvetica,Arial,sans-serif",bt.textBaseline="top",bt.fillStyle=st,bt.fillRect(0,0,ut,ht),bt.fillStyle=nt,bt.fillText(it,dt,pt),bt.fillRect(ft,gt,mt,At),bt.fillStyle=st,bt.globalAlpha=.9,bt.fillRect(ft,gt,mt,At),{dom:yt,update:function(xt,vt){at=Math.min(at,xt),lt=Math.max(lt,xt),bt.fillStyle=st,bt.globalAlpha=1,bt.fillRect(0,0,ut,gt),bt.fillStyle=nt,bt.fillText(ot(xt)+" "+it+" ("+ot(at)+"-"+ot(lt)+")",dt,pt),bt.drawImage(yt,ft+ct,gt,mt-ct,At,ft,gt,mt-ct,At),bt.fillRect(ft+mt-ct,gt,ct,At),bt.fillStyle=st,bt.globalAlpha=.9,bt.fillRect(ft+mt-ct,gt,ct,ot((1-xt/vt)*At))}}},rt})})(stats_min);var stats_minExports=stats_min.exports;const StatsImpl=getDefaultExportFromCjs(stats_minExports);function call(tt,_e){typeof tt=="function"?tt(_e):tt!=null&&(tt.current=_e)}function useEffectfulState(tt,_e=[],rt){const[it,nt]=reactExports.useState();return reactExports.useLayoutEffect(()=>{const st=tt();return nt(st),call(rt,st),()=>call(rt,null)},_e),it}function Stats({showPanel:tt=0,className:_e,parent:rt}){const it=useEffectfulState(()=>new StatsImpl,[]);return reactExports.useEffect(()=>{if(it){const nt=rt&&rt.current||document.body;it.showPanel(tt),nt==null||nt.appendChild(it.dom),_e&&it.dom.classList.add(..._e.split(" ").filter(lt=>lt));const st=addEffect(()=>it.begin()),at=addAfterEffect(()=>it.end());return()=>{nt==null||nt.removeChild(it.dom),st(),at()}}},[rt,it,_e,tt]),null}const presetsObj={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},CUBEMAP_ROOT="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",isArray$1=tt=>Array.isArray(tt);function useEnvironment({files:tt=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:_e="",preset:rt=void 0,encoding:it=void 0,extensions:nt}={}){var st;let at=null,lt=!1,ot;if(rt){if(!(rt in presetsObj))throw new Error("Preset must be one of: "+Object.keys(presetsObj).join(", "));tt=presetsObj[rt],_e=CUBEMAP_ROOT}if(lt=isArray$1(tt),ot=isArray$1(tt)?"cube":tt.startsWith("data:application/exr")?"exr":tt.startsWith("data:application/hdr")?"hdr":(st=tt.split(".").pop())==null?void 0:st.toLowerCase(),at=lt?CubeTextureLoader:ot==="hdr"?RGBELoader:ot==="exr"?EXRLoader:null,!at)throw new Error("useEnvironment: Unrecognized file extension: "+tt);const ct=useLoader(at,lt?[tt]:tt,pt=>{pt.setPath==null||pt.setPath(_e),nt&&nt(pt)}),ut=lt?ct[0]:ct;ut.mapping=lt?CubeReflectionMapping:EquirectangularReflectionMapping;const ht=3001,dt=3e3;return"colorSpace"in ut?ut.colorSpace=it??lt?"srgb":"srgb-linear":ut.encoding=it??lt?ht:dt,ut}const isRef=tt=>tt.current&&tt.current.isScene,resolveScene=tt=>isRef(tt)?tt.current:tt;function setEnvProps(tt,_e,rt,it,nt=0){const st=resolveScene(_e||rt),at=st.background,lt=st.environment,ot=st.backgroundBlurriness||0;return tt!=="only"&&(st.environment=it),tt&&(st.background=it),tt&&st.backgroundBlurriness!==void 0&&(st.backgroundBlurriness=nt),()=>{tt!=="only"&&(st.environment=lt),tt&&(st.background=at),tt&&st.backgroundBlurriness!==void 0&&(st.backgroundBlurriness=ot)}}function EnvironmentMap({scene:tt,background:_e=!1,blur:rt,map:it}){const nt=useThree(st=>st.scene);return reactExports.useLayoutEffect(()=>{if(it)return setEnvProps(_e,tt,nt,it,rt)},[nt,tt,it,_e,rt]),null}function EnvironmentCube({background:tt=!1,scene:_e,blur:rt,...it}){const nt=useEnvironment(it),st=useThree(at=>at.scene);return reactExports.useLayoutEffect(()=>setEnvProps(tt,_e,st,nt,rt),[nt,tt,_e,st,rt]),null}function EnvironmentPortal({children:tt,near:_e=1,far:rt=1e3,resolution:it=256,frames:nt=1,map:st,background:at=!1,blur:lt,scene:ot,files:ct,path:ut,preset:ht=void 0,extensions:dt}){const pt=useThree(bt=>bt.gl),ft=useThree(bt=>bt.scene),gt=reactExports.useRef(null),[mt]=reactExports.useState(()=>new Scene),At=reactExports.useMemo(()=>{const bt=new WebGLCubeRenderTarget(it);return bt.texture.type=HalfFloatType,bt},[it]);reactExports.useLayoutEffect(()=>(nt===1&&gt.current.update(pt,mt),setEnvProps(at,ot,ft,At.texture,lt)),[tt,mt,At.texture,ot,ft,at,nt,pt]);let yt=1;return useFrame(()=>{(nt===1/0||yt<nt)&&(gt.current.update(pt,mt),yt++)}),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(reactExports.Fragment,null,tt,reactExports.createElement("cubeCamera",{ref:gt,args:[_e,rt,At]}),ct||ht?reactExports.createElement(EnvironmentCube,{background:!0,files:ct,preset:ht,path:ut,extensions:dt}):st?reactExports.createElement(EnvironmentMap,{background:!0,map:st,extensions:dt}):null),mt))}function EnvironmentGround(tt){var _e,rt,it,nt;const st=useEnvironment(tt),at=tt.map||st;reactExports.useMemo(()=>extend$2({GroundProjectedEnvImpl:GroundProjectedEnv}),[]);const lt=reactExports.useMemo(()=>[at],[at]),ot=(_e=tt.ground)==null?void 0:_e.height,ct=(rt=tt.ground)==null?void 0:rt.radius,ut=(it=(nt=tt.ground)==null?void 0:nt.scale)!==null&&it!==void 0?it:1e3;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(EnvironmentMap,_extends$1({},tt,{map:at})),reactExports.createElement("groundProjectedEnvImpl",{args:lt,scale:ut,height:ot,radius:ct}))}function Environment(tt){return tt.ground?reactExports.createElement(EnvironmentGround,tt):tt.map?reactExports.createElement(EnvironmentMap,tt):tt.children?reactExports.createElement(EnvironmentPortal,tt):reactExports.createElement(EnvironmentCube,tt)}function calcPosFromAngles(tt,_e,rt=new Vector3){const it=Math.PI*(tt-.5),nt=2*Math.PI*(_e-.5);return rt.x=Math.cos(nt),rt.y=Math.sin(it),rt.z=Math.sin(nt),rt}const Sky=reactExports.forwardRef(({inclination:tt=.6,azimuth:_e=.1,distance:rt=1e3,mieCoefficient:it=.005,mieDirectionalG:nt=.8,rayleigh:st=.5,turbidity:at=10,sunPosition:lt=calcPosFromAngles(tt,_e),...ot},ct)=>{const ut=reactExports.useMemo(()=>new Vector3().setScalar(rt),[rt]),[ht]=reactExports.useState(()=>new Sky$1);return reactExports.createElement("primitive",_extends$1({object:ht,ref:ct,"material-uniforms-mieCoefficient-value":it,"material-uniforms-mieDirectionalG-value":nt,"material-uniforms-rayleigh-value":st,"material-uniforms-sunPosition-value":lt,"material-uniforms-turbidity-value":at,scale:ut},ot))});function Box({color:tt,size:_e,scale:rt,children:it,...nt}){return jsxRuntimeExports.jsxs("mesh",{scale:rt,...nt,children:[jsxRuntimeExports.jsx("boxGeometry",{args:_e}),jsxRuntimeExports.jsx("meshPhongMaterial",{color:tt}),it]})}function Button3D(tt){const[_e,rt]=reactExports.useState(!1),[it,nt]=reactExports.useState(4292273),st=reactExports.useRef(),at=()=>{nt(Math.random()*16777215|0),window.opener&&window.close()};return jsxRuntimeExports.jsx("mesh",{ref:st,onPointerDown:()=>{window.close()},children:jsxRuntimeExports.jsx(Interactive,{onSelect:at,onHover:()=>rt(!0),onBlur:()=>rt(!1),children:jsxRuntimeExports.jsx(Box,{color:it,scale:_e?[7.5,7.5,7.5]:[5,5,5],size:[.6,.1,.05],...tt,children:jsxRuntimeExports.jsx(Text,{position:[0,0,.05],fontSize:.05,color:"#000",anchorX:"center",anchorY:"middle",children:tt.text})})})})}const styles="";function composeRefs$2(...tt){return _e=>tt.forEach(rt=>function(it,nt){typeof it=="function"?it(nt):it!=null&&(it.current=nt)}(rt,_e))}const Slot$1=reactExports.forwardRef((tt,_e)=>{const{children:rt,...it}=tt;return reactExports.Children.toArray(rt).some(l$4)?reactExports.createElement(reactExports.Fragment,null,reactExports.Children.map(rt,nt=>l$4(nt)?reactExports.createElement(n$4,_extends$1({},it,{ref:_e}),nt.props.children):nt)):reactExports.createElement(n$4,_extends$1({},it,{ref:_e}),rt)});Slot$1.displayName="Slot";const n$4=reactExports.forwardRef((tt,_e)=>{const{children:rt,...it}=tt;return reactExports.isValidElement(rt)?reactExports.cloneElement(rt,{...o$5(it,rt.props),ref:composeRefs$2(_e,rt.ref)}):reactExports.Children.count(rt)>1?reactExports.Children.only(null):null});n$4.displayName="SlotClone";const Slottable$1=({children:tt})=>reactExports.createElement(reactExports.Fragment,null,tt);function l$4(tt){return reactExports.isValidElement(tt)&&tt.type===Slottable$1}function o$5(tt,_e){const rt={..._e};for(const it in _e){const nt=tt[it],st=_e[it];/^on[A-Z]/.test(it)?rt[it]=(...at)=>{st==null||st(...at),nt==null||nt(...at)}:it==="style"?rt[it]={...nt,...st}:it==="className"&&(rt[it]=[nt,st].filter(Boolean).join(" "))}return{...tt,...rt}}const Primitive$1=["a","button","div","h2","h3","img","li","nav","ol","p","span","svg","ul"].reduce((tt,_e)=>({...tt,[_e]:reactExports.forwardRef((rt,it)=>{const{asChild:nt,...st}=rt,at=nt?Slot$1:_e;return reactExports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),reactExports.createElement(at,_extends$1({},st,{ref:it}))})}),{}),useLayoutEffect$3=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},Portal$2=reactExports.forwardRef((tt,_e)=>{var rt,it;const{containerRef:nt,style:st,...at}=tt,lt=(rt=nt==null?void 0:nt.current)!==null&&rt!==void 0?rt:globalThis==null||(it=globalThis.document)===null||it===void 0?void 0:it.body,[,ot]=reactExports.useState({});return useLayoutEffect$3(()=>{ot({})},[]),lt?ReactDOM.createPortal(reactExports.createElement(Primitive$1.div,_extends$1({"data-radix-portal":""},at,{ref:_e,style:lt===document.body?{position:"absolute",top:0,left:0,zIndex:2147483647,...st}:void 0})),lt):null}),Root$4=Portal$2;var has=Object.prototype.hasOwnProperty;function dequal(tt,_e){var rt,it;if(tt===_e)return!0;if(tt&&_e&&(rt=tt.constructor)===_e.constructor){if(rt===Date)return tt.getTime()===_e.getTime();if(rt===RegExp)return tt.toString()===_e.toString();if(rt===Array){if((it=tt.length)===_e.length)for(;it--&&dequal(tt[it],_e[it]););return it===-1}if(!rt||typeof tt=="object"){it=0;for(rt in tt)if(has.call(tt,rt)&&++it&&!has.call(_e,rt)||!(rt in _e)||!dequal(tt[rt],_e[rt]))return!1;return Object.keys(_e).length===it}}return tt!==tt&&_e!==_e}var Rule=function(_e,rt,it,nt){this.name=_e,this.fn=rt,this.args=it,this.modifiers=nt};Rule.prototype._test=function(_e){var rt=this.fn;try{testAux(this.modifiers.slice(),rt,this)(_e)}catch{rt=function(){return!1}}try{return testAux(this.modifiers.slice(),rt,this)(_e)}catch{return!1}};Rule.prototype._check=function(_e){try{testAux(this.modifiers.slice(),this.fn,this)(_e)}catch{if(testAux(this.modifiers.slice(),function(it){return it},this)(!1))return}if(!testAux(this.modifiers.slice(),this.fn,this)(_e))throw null};Rule.prototype._testAsync=function(_e){var rt=this;return new Promise(function(it,nt){testAsyncAux(rt.modifiers.slice(),rt.fn,rt)(_e).then(function(st){st?it(_e):nt(null)}).catch(function(st){return nt(st)})})};function pickFn(tt,_e){return _e===void 0&&(_e="simple"),typeof tt=="object"?tt[_e]:tt}function testAux(tt,_e,rt){if(tt.length){var it=tt.shift(),nt=testAux(tt,_e,rt);return it.perform(nt,rt)}else return pickFn(_e)}function testAsyncAux(tt,_e,rt){if(tt.length){var it=tt.shift(),nt=testAsyncAux(tt,_e,rt);return it.performAsync(nt,rt)}else return function(st){return Promise.resolve(pickFn(_e,"async")(st))}}var Modifier=function(_e,rt,it){this.name=_e,this.perform=rt,this.performAsync=it},ValidationError=function(tt){function _e(rt,it,nt,st){for(var at=[],lt=arguments.length-4;lt-- >0;)at[lt]=arguments[lt+4];tt.call(this,at),tt.captureStackTrace&&tt.captureStackTrace(this,_e),this.rule=rt,this.value=it,this.cause=nt,this.target=st}return tt&&(_e.__proto__=tt),_e.prototype=Object.create(tt&&tt.prototype),_e.prototype.constructor=_e,_e}(Error),Context=function(_e,rt){_e===void 0&&(_e=[]),rt===void 0&&(rt=[]),this.chain=_e,this.nextRuleModifiers=rt};Context.prototype._applyRule=function(_e,rt){var it=this;return function(){for(var nt=[],st=arguments.length;st--;)nt[st]=arguments[st];return it.chain.push(new Rule(rt,_e.apply(it,nt),nt,it.nextRuleModifiers)),it.nextRuleModifiers=[],it}};Context.prototype._applyModifier=function(_e,rt){return this.nextRuleModifiers.push(new Modifier(rt,_e.simple,_e.async)),this};Context.prototype._clone=function(){return new Context(this.chain.slice(),this.nextRuleModifiers.slice())};Context.prototype.test=function(_e){return this.chain.every(function(rt){return rt._test(_e)})};Context.prototype.testAll=function(_e){var rt=[];return this.chain.forEach(function(it){try{it._check(_e)}catch(nt){rt.push(new ValidationError(it,_e,nt))}}),rt};Context.prototype.check=function(_e){this.chain.forEach(function(rt){try{rt._check(_e)}catch(it){throw new ValidationError(rt,_e,it)}})};Context.prototype.testAsync=function(_e){var rt=this;return new Promise(function(it,nt){executeAsyncRules(_e,rt.chain.slice(),it,nt)})};function executeAsyncRules(tt,_e,rt,it){if(_e.length){var nt=_e.shift();nt._testAsync(tt).then(function(){executeAsyncRules(tt,_e,rt,it)},function(st){it(new ValidationError(nt,tt,st))})}else rt(tt)}var consideredEmpty=function(tt,_e){return _e&&typeof tt=="string"&&tt.trim().length===0?!0:tt==null};function optional(tt,_e){return _e===void 0&&(_e=!1),{simple:function(rt){return consideredEmpty(rt,_e)||tt.check(rt)===void 0},async:function(rt){return consideredEmpty(rt,_e)||tt.testAsync(rt)}}}function v8n(){return typeof Proxy<"u"?proxyContext(new Context):proxylessContext(new Context)}var customRules={};v8n.extend=function(tt){Object.assign(customRules,tt)};v8n.clearCustomRules=function(){customRules={}};function proxyContext(tt){return new Proxy(tt,{get:function(rt,it){if(it in rt)return rt[it];var nt=proxyContext(tt._clone());if(it in availableModifiers)return nt._applyModifier(availableModifiers[it],it);if(it in customRules)return nt._applyRule(customRules[it],it);if(it in availableRules)return nt._applyRule(availableRules[it],it)}})}function proxylessContext(tt){var _e=function(nt,st){return Object.keys(nt).forEach(function(at){st[at]=function(){for(var lt=[],ot=arguments.length;ot--;)lt[ot]=arguments[ot];var ct=proxylessContext(st._clone()),ut=ct._applyRule(nt[at],at).apply(void 0,lt);return ut}}),st},rt=_e(availableRules,tt),it=_e(customRules,rt);return Object.keys(availableModifiers).forEach(function(nt){Object.defineProperty(it,nt,{get:function(){var st=proxylessContext(it._clone());return st._applyModifier(availableModifiers[nt],nt)}})}),it}var availableModifiers={not:{simple:function(tt){return function(_e){return!tt(_e)}},async:function(tt){return function(_e){return Promise.resolve(tt(_e)).then(function(rt){return!rt}).catch(function(){return!0})}}},some:{simple:function(tt){return function(_e){return split$1(_e).some(function(rt){try{return tt(rt)}catch{return!1}})}},async:function(tt){return function(_e){return Promise.all(split$1(_e).map(function(rt){try{return tt(rt).catch(function(){return!1})}catch{return!1}})).then(function(rt){return rt.some(Boolean)})}}},every:{simple:function(tt){return function(_e){return _e!==!1&&split$1(_e).every(tt)}},async:function(tt){return function(_e){return Promise.all(split$1(_e).map(tt)).then(function(rt){return rt.every(Boolean)})}}},strict:{simple:function(tt,_e){return function(rt){return isSchemaRule(_e)&&rt&&typeof rt=="object"?Object.keys(_e.args[0]).length===Object.keys(rt).length&&tt(rt):tt(rt)}},async:function(tt,_e){return function(rt){return Promise.resolve(tt(rt)).then(function(it){return isSchemaRule(_e)&&rt&&typeof rt=="object"?Object.keys(_e.args[0]).length===Object.keys(rt).length&&it:it}).catch(function(){return!1})}}}};function isSchemaRule(tt){return tt&&tt.name==="schema"&&tt.args.length>0&&typeof tt.args[0]=="object"}function split$1(tt){return typeof tt=="string"?tt.split(""):tt}var availableRules={equal:function(tt){return function(_e){return _e==tt}},exact:function(tt){return function(_e){return _e===tt}},number:function(tt){return tt===void 0&&(tt=!0),function(_e){return typeof _e=="number"&&(tt||isFinite(_e))}},integer:function(){return function(tt){var _e=Number.isInteger||isIntegerPolyfill;return _e(tt)}},numeric:function(){return function(tt){return!isNaN(parseFloat(tt))&&isFinite(tt)}},string:function(){return testType("string")},boolean:function(){return testType("boolean")},undefined:function(){return testType("undefined")},null:function(){return testType("null")},array:function(){return testType("array")},object:function(){return testType("object")},instanceOf:function(tt){return function(_e){return _e instanceof tt}},pattern:function(tt){return function(_e){return tt.test(_e)}},lowercase:function(){return function(tt){return typeof tt=="boolean"||tt===tt.toLowerCase()&&tt.trim()!==""}},uppercase:function(){return function(tt){return tt===tt.toUpperCase()&&tt.trim()!==""}},vowel:function(){return function(tt){return/^[aeiou]+$/i.test(tt)}},consonant:function(){return function(tt){return/^(?=[^aeiou])([a-z]+)$/i.test(tt)}},first:function(tt){return function(_e){return _e[0]==tt}},last:function(tt){return function(_e){return _e[_e.length-1]==tt}},empty:function(){return function(tt){return tt.length===0}},length:function(tt,_e){return function(rt){return rt.length>=tt&&rt.length<=(_e||tt)}},minLength:function(tt){return function(_e){return _e.length>=tt}},maxLength:function(tt){return function(_e){return _e.length<=tt}},negative:function(){return function(tt){return tt<0}},positive:function(){return function(tt){return tt>=0}},between:function(tt,_e){return function(rt){return rt>=tt&&rt<=_e}},range:function(tt,_e){return function(rt){return rt>=tt&&rt<=_e}},lessThan:function(tt){return function(_e){return _e<tt}},lessThanOrEqual:function(tt){return function(_e){return _e<=tt}},greaterThan:function(tt){return function(_e){return _e>tt}},greaterThanOrEqual:function(tt){return function(_e){return _e>=tt}},even:function(){return function(tt){return tt%2===0}},odd:function(){return function(tt){return tt%2!==0}},includes:function(tt){return function(_e){return~_e.indexOf(tt)}},schema:function(tt){return testSchema(tt)},passesAnyOf:function(){for(var tt=[],_e=arguments.length;_e--;)tt[_e]=arguments[_e];return function(rt){return tt.some(function(it){return it.test(rt)})}},optional};function testType(tt){return function(_e){return Array.isArray(_e)&&tt==="array"||_e===null&&tt==="null"||typeof _e===tt}}function isIntegerPolyfill(tt){return typeof tt=="number"&&isFinite(tt)&&Math.floor(tt)===tt}function testSchema(tt){return{simple:function(_e){var rt=[];if(Object.keys(tt).forEach(function(it){var nt=tt[it];try{nt.check((_e||{})[it])}catch(st){st.target=it,rt.push(st)}}),rt.length>0)throw rt;return!0},async:function(_e){var rt=[],it=Object.keys(tt).map(function(nt){var st=tt[nt];return st.testAsync((_e||{})[nt]).catch(function(at){at.target=nt,rt.push(at)})});return Promise.all(it).then(function(){if(rt.length>0)throw rt;return!0})}}}var e$3="colors",t$4="sizes",r$4="space",n$3={gap:r$4,gridGap:r$4,columnGap:r$4,gridColumnGap:r$4,rowGap:r$4,gridRowGap:r$4,inset:r$4,insetBlock:r$4,insetBlockEnd:r$4,insetBlockStart:r$4,insetInline:r$4,insetInlineEnd:r$4,insetInlineStart:r$4,margin:r$4,marginTop:r$4,marginRight:r$4,marginBottom:r$4,marginLeft:r$4,marginBlock:r$4,marginBlockEnd:r$4,marginBlockStart:r$4,marginInline:r$4,marginInlineEnd:r$4,marginInlineStart:r$4,padding:r$4,paddingTop:r$4,paddingRight:r$4,paddingBottom:r$4,paddingLeft:r$4,paddingBlock:r$4,paddingBlockEnd:r$4,paddingBlockStart:r$4,paddingInline:r$4,paddingInlineEnd:r$4,paddingInlineStart:r$4,top:r$4,right:r$4,bottom:r$4,left:r$4,scrollMargin:r$4,scrollMarginTop:r$4,scrollMarginRight:r$4,scrollMarginBottom:r$4,scrollMarginLeft:r$4,scrollMarginX:r$4,scrollMarginY:r$4,scrollMarginBlock:r$4,scrollMarginBlockEnd:r$4,scrollMarginBlockStart:r$4,scrollMarginInline:r$4,scrollMarginInlineEnd:r$4,scrollMarginInlineStart:r$4,scrollPadding:r$4,scrollPaddingTop:r$4,scrollPaddingRight:r$4,scrollPaddingBottom:r$4,scrollPaddingLeft:r$4,scrollPaddingX:r$4,scrollPaddingY:r$4,scrollPaddingBlock:r$4,scrollPaddingBlockEnd:r$4,scrollPaddingBlockStart:r$4,scrollPaddingInline:r$4,scrollPaddingInlineEnd:r$4,scrollPaddingInlineStart:r$4,fontSize:"fontSizes",background:e$3,backgroundColor:e$3,backgroundImage:e$3,borderImage:e$3,border:e$3,borderBlock:e$3,borderBlockEnd:e$3,borderBlockStart:e$3,borderBottom:e$3,borderBottomColor:e$3,borderColor:e$3,borderInline:e$3,borderInlineEnd:e$3,borderInlineStart:e$3,borderLeft:e$3,borderLeftColor:e$3,borderRight:e$3,borderRightColor:e$3,borderTop:e$3,borderTopColor:e$3,caretColor:e$3,color:e$3,columnRuleColor:e$3,fill:e$3,outline:e$3,outlineColor:e$3,stroke:e$3,textDecorationColor:e$3,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:t$4,minBlockSize:t$4,maxBlockSize:t$4,inlineSize:t$4,minInlineSize:t$4,maxInlineSize:t$4,width:t$4,minWidth:t$4,maxWidth:t$4,height:t$4,minHeight:t$4,maxHeight:t$4,flexBasis:t$4,gridTemplateColumns:t$4,gridTemplateRows:t$4,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},i$4=(tt,_e)=>typeof _e=="function"?{"()":Function.prototype.toString.call(_e)}:_e,o$4=()=>{const tt=Object.create(null);return(_e,rt,...it)=>{const nt=(st=>JSON.stringify(st,i$4))(_e);return nt in tt?tt[nt]:tt[nt]=rt(_e,...it)}},l$3=Symbol.for("sxs.internal"),s$3=(tt,_e)=>Object.defineProperties(tt,Object.getOwnPropertyDescriptors(_e)),a$2=tt=>{for(const _e in tt)return!0;return!1},{hasOwnProperty:c$4}=Object.prototype,d$3=tt=>tt.includes("-")?tt:tt.replace(/[A-Z]/g,_e=>"-"+_e.toLowerCase()),g$3=/\s+(?![^()]*\))/,p$3=tt=>_e=>tt(...typeof _e=="string"?String(_e).split(g$3):[_e]),u$3={appearance:tt=>({WebkitAppearance:tt,appearance:tt}),backfaceVisibility:tt=>({WebkitBackfaceVisibility:tt,backfaceVisibility:tt}),backdropFilter:tt=>({WebkitBackdropFilter:tt,backdropFilter:tt}),backgroundClip:tt=>({WebkitBackgroundClip:tt,backgroundClip:tt}),boxDecorationBreak:tt=>({WebkitBoxDecorationBreak:tt,boxDecorationBreak:tt}),clipPath:tt=>({WebkitClipPath:tt,clipPath:tt}),content:tt=>({content:tt.includes('"')||tt.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(tt)?tt:`"${tt}"`}),hyphens:tt=>({WebkitHyphens:tt,hyphens:tt}),maskImage:tt=>({WebkitMaskImage:tt,maskImage:tt}),maskSize:tt=>({WebkitMaskSize:tt,maskSize:tt}),tabSize:tt=>({MozTabSize:tt,tabSize:tt}),textSizeAdjust:tt=>({WebkitTextSizeAdjust:tt,textSizeAdjust:tt}),userSelect:tt=>({WebkitUserSelect:tt,userSelect:tt}),marginBlock:p$3((tt,_e)=>({marginBlockStart:tt,marginBlockEnd:_e||tt})),marginInline:p$3((tt,_e)=>({marginInlineStart:tt,marginInlineEnd:_e||tt})),maxSize:p$3((tt,_e)=>({maxBlockSize:tt,maxInlineSize:_e||tt})),minSize:p$3((tt,_e)=>({minBlockSize:tt,minInlineSize:_e||tt})),paddingBlock:p$3((tt,_e)=>({paddingBlockStart:tt,paddingBlockEnd:_e||tt})),paddingInline:p$3((tt,_e)=>({paddingInlineStart:tt,paddingInlineEnd:_e||tt}))},h$3=/([\d.]+)([^]*)/,f$3=(tt,_e)=>tt.length?tt.reduce((rt,it)=>(rt.push(..._e.map(nt=>nt.includes("&")?nt.replace(/&/g,/[ +>|~]/.test(it)&&/&.*&/.test(nt)?`:is(${it})`:it):it+" "+nt)),rt),[]):_e,m$3=(tt,_e)=>tt in b$3&&typeof _e=="string"?_e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(rt,it,nt,st)=>it+(nt==="stretch"?`-moz-available${st};${d$3(tt)}:${it}-webkit-fill-available`:`-moz-fit-content${st};${d$3(tt)}:${it}fit-content`)+st):String(_e),b$3={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},S$2=tt=>tt?tt+"-":"",k$3=(tt,_e,rt)=>tt.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(it,nt,st,at,lt)=>at=="$"==!!st?it:(nt||at=="--"?"calc(":"")+"var(--"+(at==="$"?S$2(_e)+(lt.includes("$")?"":S$2(rt))+lt.replace(/\$/g,"-"):lt)+")"+(nt||at=="--"?"*"+(nt||"")+(st||"1")+")":"")),y$3=/\s*,\s*(?![^()]*\))/,B=Object.prototype.toString,$$2=(tt,_e,rt,it,nt)=>{let st,at,lt;const ot=(ct,ut,ht)=>{let dt,pt;const ft=gt=>{for(dt in gt){const yt=dt.charCodeAt(0)===64,bt=yt&&Array.isArray(gt[dt])?gt[dt]:[gt[dt]];for(pt of bt){const xt=/[A-Z]/.test(At=dt)?At:At.replace(/-[^]/g,_t=>_t[1].toUpperCase()),vt=typeof pt=="object"&&pt&&pt.toString===B&&(!it.utils[xt]||!ut.length);if(xt in it.utils&&!vt){const _t=it.utils[xt];if(_t!==at){at=_t,ft(_t(pt)),at=null;continue}}else if(xt in u$3){const _t=u$3[xt];if(_t!==lt){lt=_t,ft(_t(pt)),lt=null;continue}}if(yt&&(mt=dt.slice(1)in it.media?"@media "+it.media[dt.slice(1)]:dt,dt=mt.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(_t,Ct,St,Et,Tt,Mt)=>{const Rt=h$3.test(Ct),It=.0625*(Rt?-1:1),[Ot,Bt]=Rt?[Et,Ct]:[Ct,Et];return"("+(St[0]==="="?"":St[0]===">"===Rt?"max-":"min-")+Ot+":"+(St[0]!=="="&&St.length===1?Bt.replace(h$3,(Nt,zt,Dt)=>Number(zt)+It*(St===">"?1:-1)+Dt):Bt)+(Tt?") and ("+(Tt[0]===">"?"min-":"max-")+Ot+":"+(Tt.length===1?Mt.replace(h$3,(Nt,zt,Dt)=>Number(zt)+It*(Tt===">"?-1:1)+Dt):Mt):"")+")"})),vt){const _t=yt?ht.concat(dt):[...ht],Ct=yt?[...ut]:f$3(ut,dt.split(y$3));st!==void 0&&nt(x$2(...st)),st=void 0,ot(pt,Ct,_t)}else st===void 0&&(st=[[],ut,ht]),dt=yt||dt.charCodeAt(0)!==36?dt:`--${S$2(it.prefix)}${dt.slice(1).replace(/\$/g,"-")}`,pt=vt?pt:typeof pt=="number"?pt&&xt in I$2?String(pt)+"px":String(pt):k$3(m$3(xt,pt??""),it.prefix,it.themeMap[xt]),st[0].push(`${yt?`${dt} `:`${d$3(dt)}:`}${pt}`)}}var mt,At};ft(ct),st!==void 0&&nt(x$2(...st)),st=void 0};ot(tt,_e,rt)},x$2=(tt,_e,rt)=>`${rt.map(it=>`${it}{`).join("")}${_e.length?`${_e.join(",")}{`:""}${tt.join(";")}${_e.length?"}":""}${Array(rt.length?rt.length+1:0).join("}")}`,I$2={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},R=tt=>String.fromCharCode(tt+(tt>25?39:97)),z=tt=>(_e=>{let rt,it="";for(rt=Math.abs(_e);rt>52;rt=rt/52|0)it=R(rt%52)+it;return R(rt%52)+it})(((_e,rt)=>{let it=rt.length;for(;it;)_e=33*_e^rt.charCodeAt(--it);return _e})(5381,JSON.stringify(tt))>>>0),W=["themed","global","styled","onevar","resonevar","allvar","inline"],j$1=tt=>{if(tt.href&&!tt.href.startsWith(location.origin))return!1;try{return!!tt.cssRules}catch{return!1}},E$1=tt=>{let _e;const rt=()=>{const{cssRules:nt}=_e.sheet;return[].map.call(nt,(st,at)=>{const{cssText:lt}=st;let ot="";if(lt.startsWith("--sxs"))return"";if(nt[at-1]&&(ot=nt[at-1].cssText).startsWith("--sxs")){if(!st.cssRules.length)return"";for(const ct in _e.rules)if(_e.rules[ct].group===st)return`--sxs{--sxs:${[..._e.rules[ct].cache].join(" ")}}${lt}`;return st.cssRules.length?`${ot}${lt}`:""}return lt}).join("")},it=()=>{if(_e){const{rules:lt,sheet:ot}=_e;if(!ot.deleteRule){for(;Object(Object(ot.cssRules)[0]).type===3;)ot.cssRules.splice(0,1);ot.cssRules=[]}for(const ct in lt)delete lt[ct]}const nt=Object(tt).styleSheets||[];for(const lt of nt)if(j$1(lt)){for(let ot=0,ct=lt.cssRules;ct[ot];++ot){const ut=Object(ct[ot]);if(ut.type!==1)continue;const ht=Object(ct[ot+1]);if(ht.type!==4)continue;++ot;const{cssText:dt}=ut;if(!dt.startsWith("--sxs"))continue;const pt=dt.slice(14,-3).trim().split(/\s+/),ft=W[pt[0]];ft&&(_e||(_e={sheet:lt,reset:it,rules:{},toString:rt}),_e.rules[ft]={group:ht,index:ot,cache:new Set(pt)})}if(_e)break}if(!_e){const lt=(ot,ct)=>({type:ct,cssRules:[],insertRule(ut,ht){this.cssRules.splice(ht,0,lt(ut,{import:3,undefined:1}[(ut.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return ot==="@media{}"?`@media{${[].map.call(this.cssRules,ut=>ut.cssText).join("")}}`:ot}});_e={sheet:tt?(tt.head||tt).appendChild(document.createElement("style")).sheet:lt("","text/css"),rules:{},reset:it,toString:rt}}const{sheet:st,rules:at}=_e;for(let lt=W.length-1;lt>=0;--lt){const ot=W[lt];if(!at[ot]){const ct=W[lt+1],ut=at[ct]?at[ct].index:st.cssRules.length;st.insertRule("@media{}",ut),st.insertRule(`--sxs{--sxs:${lt}}`,ut),at[ot]={group:st.cssRules[ut+1],index:ut,cache:new Set([lt])}}v$3(at[ot])}};return it(),_e},v$3=tt=>{const _e=tt.group;let rt=_e.cssRules.length;tt.apply=it=>{try{_e.insertRule(it,rt),++rt}catch{}}},T$1=Symbol(),w$2=o$4(),M$1=(tt,_e)=>w$2(tt,()=>(...rt)=>{let it={type:null,composers:new Set};for(const nt of rt)if(nt!=null)if(nt[l$3]){it.type==null&&(it.type=nt[l$3].type);for(const st of nt[l$3].composers)it.composers.add(st)}else nt.constructor!==Object||nt.$$typeof?it.type==null&&(it.type=nt):it.composers.add(C(nt,tt));return it.type==null&&(it.type="span"),it.composers.size||it.composers.add(["PJLV",{},[],[],{},[]]),P(tt,it,_e)}),C=({variants:tt,compoundVariants:_e,defaultVariants:rt,...it},nt)=>{const st=`${S$2(nt.prefix)}c-${z(it)}`,at=[],lt=[],ot=Object.create(null),ct=[];for(const dt in rt)ot[dt]=String(rt[dt]);if(typeof tt=="object"&&tt)for(const dt in tt){ut=ot,ht=dt,c$4.call(ut,ht)||(ot[dt]="undefined");const pt=tt[dt];for(const ft in pt){const gt={[dt]:String(ft)};String(ft)==="undefined"&&ct.push(dt);const mt=pt[ft],At=[gt,mt,!a$2(mt)];at.push(At)}}var ut,ht;if(typeof _e=="object"&&_e)for(const dt of _e){let{css:pt,...ft}=dt;pt=typeof pt=="object"&&pt||{};for(const mt in ft)ft[mt]=String(ft[mt]);const gt=[ft,pt,!a$2(pt)];lt.push(gt)}return[st,it,at,lt,ot,ct]},P=(tt,_e,rt)=>{const[it,nt,st,at]=L$1(_e.composers),lt=typeof _e.type=="function"||_e.type.$$typeof?(ht=>{function dt(){for(let pt=0;pt<dt[T$1].length;pt++){const[ft,gt]=dt[T$1][pt];ht.rules[ft].apply(gt)}return dt[T$1]=[],null}return dt[T$1]=[],dt.rules={},W.forEach(pt=>dt.rules[pt]={apply:ft=>dt[T$1].push([pt,ft])}),dt})(rt):null,ot=(lt||rt).rules,ct=`.${it}${nt.length>1?`:where(.${nt.slice(1).join(".")})`:""}`,ut=ht=>{ht=typeof ht=="object"&&ht||A;const{css:dt,...pt}=ht,ft={};for(const At in st)if(delete pt[At],At in ht){let yt=ht[At];typeof yt=="object"&&yt?ft[At]={"@initial":st[At],...yt}:(yt=String(yt),ft[At]=yt!=="undefined"||at.has(At)?yt:st[At])}else ft[At]=st[At];const gt=new Set([...nt]);for(const[At,yt,bt,xt]of _e.composers){rt.rules.styled.cache.has(At)||(rt.rules.styled.cache.add(At),$$2(yt,[`.${At}`],[],tt,Ct=>{ot.styled.apply(Ct)}));const vt=O(bt,ft,tt.media),_t=O(xt,ft,tt.media,!0);for(const Ct of vt)if(Ct!==void 0)for(const[St,Et,Tt]of Ct){const Mt=`${At}-${z(Et)}-${St}`;gt.add(Mt);const Rt=(Tt?rt.rules.resonevar:rt.rules.onevar).cache,It=Tt?ot.resonevar:ot.onevar;Rt.has(Mt)||(Rt.add(Mt),$$2(Et,[`.${Mt}`],[],tt,Ot=>{It.apply(Ot)}))}for(const Ct of _t)if(Ct!==void 0)for(const[St,Et]of Ct){const Tt=`${At}-${z(Et)}-${St}`;gt.add(Tt),rt.rules.allvar.cache.has(Tt)||(rt.rules.allvar.cache.add(Tt),$$2(Et,[`.${Tt}`],[],tt,Mt=>{ot.allvar.apply(Mt)}))}}if(typeof dt=="object"&&dt){const At=`${it}-i${z(dt)}-css`;gt.add(At),rt.rules.inline.cache.has(At)||(rt.rules.inline.cache.add(At),$$2(dt,[`.${At}`],[],tt,yt=>{ot.inline.apply(yt)}))}for(const At of String(ht.className||"").trim().split(/\s+/))At&&gt.add(At);const mt=pt.className=[...gt].join(" ");return{type:_e.type,className:mt,selector:ct,props:pt,toString:()=>mt,deferredInjector:lt}};return s$3(ut,{className:it,selector:ct,[l$3]:_e,toString:()=>(rt.rules.styled.cache.has(it)||ut(),it)})},L$1=tt=>{let _e="";const rt=[],it={},nt=[];for(const[st,,,,at,lt]of tt){_e===""&&(_e=st),rt.push(st),nt.push(...lt);for(const ot in at){const ct=at[ot];(it[ot]===void 0||ct!=="undefined"||lt.includes(ct))&&(it[ot]=ct)}}return[_e,rt,it,new Set(nt)]},O=(tt,_e,rt,it)=>{const nt=[];e:for(let[st,at,lt]of tt){if(lt)continue;let ot,ct=0,ut=!1;for(ot in st){const ht=st[ot];let dt=_e[ot];if(dt!==ht){if(typeof dt!="object"||!dt)continue e;{let pt,ft,gt=0;for(const mt in dt){if(ht===String(dt[mt])){if(mt!=="@initial"){const At=mt.slice(1);(ft=ft||[]).push(At in rt?rt[At]:mt.replace(/^@media ?/,"")),ut=!0}ct+=gt,pt=!0}++gt}if(ft&&ft.length&&(at={["@media "+ft.join(", ")]:at}),!pt)continue e}}}(nt[ct]=nt[ct]||[]).push([it?"cv":`${ot}-${st[ot]}`,at,ut])}return nt},A={},N$1=o$4(),D=(tt,_e)=>N$1(tt,()=>(...rt)=>{const it=()=>{for(let nt of rt){nt=typeof nt=="object"&&nt||{};let st=z(nt);if(!_e.rules.global.cache.has(st)){if(_e.rules.global.cache.add(st),"@import"in nt){let at=[].indexOf.call(_e.sheet.cssRules,_e.rules.themed.group)-1;for(let lt of[].concat(nt["@import"]))lt=lt.includes('"')||lt.includes("'")?lt:`"${lt}"`,_e.sheet.insertRule(`@import ${lt};`,at++);delete nt["@import"]}$$2(nt,[],[],tt,at=>{_e.rules.global.apply(at)})}}return""};return s$3(it,{toString:it})}),H$1=o$4(),V$1=(tt,_e)=>H$1(tt,()=>rt=>{const it=`${S$2(tt.prefix)}k-${z(rt)}`,nt=()=>{if(!_e.rules.global.cache.has(it)){_e.rules.global.cache.add(it);const st=[];$$2(rt,[],[],tt,lt=>st.push(lt));const at=`@keyframes ${it}{${st.join("")}}`;_e.rules.global.apply(at)}return it};return s$3(nt,{get name(){return nt()},toString:nt})}),G=class{constructor(tt,_e,rt,it){this.token=tt==null?"":String(tt),this.value=_e==null?"":String(_e),this.scale=rt==null?"":String(rt),this.prefix=it==null?"":String(it)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+S$2(this.prefix)+S$2(this.scale)+this.token}toString(){return this.computedValue}},F$1=o$4(),J$1=(tt,_e)=>F$1(tt,()=>(rt,it)=>{it=typeof rt=="object"&&rt||Object(it);const nt=`.${rt=(rt=typeof rt=="string"?rt:"")||`${S$2(tt.prefix)}t-${z(it)}`}`,st={},at=[];for(const ot in it){st[ot]={};for(const ct in it[ot]){const ut=`--${S$2(tt.prefix)}${ot}-${ct}`,ht=k$3(String(it[ot][ct]),tt.prefix,ot);st[ot][ct]=new G(ct,ht,ot,tt.prefix),at.push(`${ut}:${ht}`)}}const lt=()=>{if(at.length&&!_e.rules.themed.cache.has(rt)){_e.rules.themed.cache.add(rt);const ot=`${it===tt.theme?":root,":""}.${rt}{${at.join(";")}}`;_e.rules.themed.apply(ot)}return rt};return{...st,get className(){return lt()},selector:nt,toString:lt}}),U$1=o$4(),Y$1=o$4(),q$1=tt=>{const _e=(rt=>{let it=!1;const nt=U$1(rt,st=>{it=!0;const at="prefix"in(st=typeof st=="object"&&st||{})?String(st.prefix):"",lt=typeof st.media=="object"&&st.media||{},ot=typeof st.root=="object"?st.root||null:globalThis.document||null,ct=typeof st.theme=="object"&&st.theme||{},ut={prefix:at,media:lt,theme:ct,themeMap:typeof st.themeMap=="object"&&st.themeMap||{...n$3},utils:typeof st.utils=="object"&&st.utils||{}},ht=E$1(ot),dt={css:M$1(ut,ht),globalCss:D(ut,ht),keyframes:V$1(ut,ht),createTheme:J$1(ut,ht),reset(){ht.reset(),dt.theme.toString()},theme:{},sheet:ht,config:ut,prefix:at,getCssText:ht.toString,toString:ht.toString};return String(dt.theme=dt.createTheme(ct)),dt});return it||nt.reset(),nt})(tt);return _e.styled=(({config:rt,sheet:it})=>Y$1(rt,()=>{const nt=M$1(rt,it);return(...st)=>{const at=nt(...st),lt=at[l$3].type,ot=React.forwardRef((ct,ut)=>{const ht=ct&&ct.as||lt,{props:dt,deferredInjector:pt}=at(ct);return delete dt.as,dt.ref=ut,pt?React.createElement(React.Fragment,null,React.createElement(ht,dt),React.createElement(pt,null)):React.createElement(ht,dt)});return ot.className=at.className,ot.displayName=`Styled.${lt.displayName||lt.name||lt}`,ot.selector=at.selector,ot.toString=()=>at.selector,ot[l$3]=at[l$3],ot}}))(_e),_e};const useLayoutEffect$2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},r$3=t$5["useId".toString()]||(()=>{});let i$3=0;function useId(tt){const[_e,rt]=reactExports.useState(r$3());return useLayoutEffect$2(()=>{tt||rt(it=>it??String(i$3++))},[tt]),tt||(_e?`radix-${_e}`:"")}function composeRefs$1(...tt){return _e=>tt.forEach(rt=>function(it,nt){typeof it=="function"?it(nt):it!=null&&(it.current=nt)}(rt,_e))}function useComposedRefs$1(...tt){return reactExports.useCallback(composeRefs$1(...tt),tt)}const Slot=reactExports.forwardRef((tt,_e)=>{const{children:rt,...it}=tt;return reactExports.Children.toArray(rt).some(l$2)?reactExports.createElement(reactExports.Fragment,null,reactExports.Children.map(rt,nt=>l$2(nt)?reactExports.createElement(n$2,_extends$1({},it,{ref:_e}),nt.props.children):nt)):reactExports.createElement(n$2,_extends$1({},it,{ref:_e}),rt)});Slot.displayName="Slot";const n$2=reactExports.forwardRef((tt,_e)=>{const{children:rt,...it}=tt;return reactExports.isValidElement(rt)?reactExports.cloneElement(rt,{...o$3(it,rt.props),ref:composeRefs$1(_e,rt.ref)}):reactExports.Children.count(rt)>1?reactExports.Children.only(null):null});n$2.displayName="SlotClone";const Slottable=({children:tt})=>reactExports.createElement(reactExports.Fragment,null,tt);function l$2(tt){return reactExports.isValidElement(tt)&&tt.type===Slottable}function o$3(tt,_e){const rt={..._e};for(const it in _e){const nt=tt[it],st=_e[it];/^on[A-Z]/.test(it)?rt[it]=(...at)=>{st==null||st(...at),nt==null||nt(...at)}:it==="style"?rt[it]={...nt,...st}:it==="className"&&(rt[it]=[nt,st].filter(Boolean).join(" "))}return{...tt,...rt}}const Primitive=["a","button","div","h2","h3","img","li","nav","p","span","svg","ul"].reduce((tt,_e)=>({...tt,[_e]:reactExports.forwardRef((rt,it)=>{const{asChild:nt,...st}=rt,at=nt?Slot:_e;return reactExports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),rt.as&&console.error(o$2),reactExports.createElement(at,_extends$1({},st,{ref:it}))})}),{}),o$2="Warning: The `as` prop has been removed in favour of `asChild`. For details, see https://radix-ui.com/docs/primitives/overview/styling#changing-the-rendered-element",VisuallyHidden=reactExports.forwardRef((tt,_e)=>reactExports.createElement(Primitive.span,_extends$1({},tt,{ref:_e,style:{...tt.style,position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}}))),Root$3=VisuallyHidden,useLayoutEffect$1=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},Portal$1=reactExports.forwardRef((tt,_e)=>{var rt,it;const{containerRef:nt,style:st,...at}=tt,lt=(rt=nt==null?void 0:nt.current)!==null&&rt!==void 0?rt:globalThis==null||(it=globalThis.document)===null||it===void 0?void 0:it.body,[,ot]=reactExports.useState({});return useLayoutEffect$1(()=>{ot({})},[]),lt?ReactDOM.createPortal(reactExports.createElement(Primitive.div,_extends$1({"data-radix-portal":""},at,{ref:_e,style:lt===document.body?{position:"absolute",top:0,left:0,zIndex:2147483647,...st}:void 0})),lt):null}),Arrow$2=reactExports.forwardRef((tt,_e)=>{const{children:rt,width:it=10,height:nt=5,...st}=tt;return reactExports.createElement(Primitive.svg,_extends$1({},st,{ref:_e,width:it,height:nt,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),tt.asChild?rt:reactExports.createElement("polygon",{points:"0,0 30,0 15,10"}))}),Root$2=Arrow$2;function useSize(tt){const[_e,rt]=reactExports.useState(void 0);return reactExports.useEffect(()=>{if(tt){const it=new ResizeObserver(nt=>{if(!Array.isArray(nt)||!nt.length)return;const st=nt[0];let at,lt;if("borderBoxSize"in st){const ot=st.borderBoxSize,ct=Array.isArray(ot)?ot[0]:ot;at=ct.inlineSize,lt=ct.blockSize}else{const ot=tt.getBoundingClientRect();at=ot.width,lt=ot.height}rt({width:at,height:lt})});return it.observe(tt,{box:"border-box"}),()=>{rt(void 0),it.unobserve(tt)}}},[tt]),_e}function observeElementRect(tt,_e){const rt=e$2.get(tt);return rt===void 0?(e$2.set(tt,{rect:{},callbacks:[_e]}),e$2.size===1&&(t$3=requestAnimationFrame(c$3))):(rt.callbacks.push(_e),_e(tt.getBoundingClientRect())),()=>{const it=e$2.get(tt);if(it===void 0)return;const nt=it.callbacks.indexOf(_e);nt>-1&&it.callbacks.splice(nt,1),it.callbacks.length===0&&(e$2.delete(tt),e$2.size===0&&cancelAnimationFrame(t$3))}}let t$3;const e$2=new Map;function c$3(){const tt=[];e$2.forEach((_e,rt)=>{const it=rt.getBoundingClientRect();var nt,st;nt=_e.rect,st=it,(nt.width!==st.width||nt.height!==st.height||nt.top!==st.top||nt.right!==st.right||nt.bottom!==st.bottom||nt.left!==st.left)&&(_e.rect=it,tt.push(_e))}),tt.forEach(_e=>{_e.callbacks.forEach(rt=>rt(_e.rect))}),t$3=requestAnimationFrame(c$3)}function useRect(tt){const[_e,rt]=reactExports.useState();return reactExports.useEffect(()=>{if(tt){const it=observeElementRect(tt,rt);return()=>{rt(void 0),it()}}},[tt]),_e}function createContextScope(tt,_e=[]){let rt=[];const it=()=>{const nt=rt.map(st=>reactExports.createContext(st));return function(st){const at=(st==null?void 0:st[tt])||nt;return reactExports.useMemo(()=>({[`__scope${tt}`]:{...st,[tt]:at}}),[st,at])}};return it.scopeName=tt,[function(nt,st){const at=reactExports.createContext(st),lt=rt.length;function ot(ct){const{scope:ut,children:ht,...dt}=ct,pt=(ut==null?void 0:ut[tt][lt])||at,ft=reactExports.useMemo(()=>dt,Object.values(dt));return reactExports.createElement(pt.Provider,{value:ft},ht)}return rt=[...rt,st],ot.displayName=nt+"Provider",[ot,function(ct,ut){const ht=(ut==null?void 0:ut[tt][lt])||at,dt=reactExports.useContext(ht);if(dt)return dt;if(st!==void 0)return st;throw new Error(`\`${ct}\` must be used within \`${nt}\``)}]},t$2(it,..._e)]}function t$2(...tt){const _e=tt[0];if(tt.length===1)return _e;const rt=()=>{const it=tt.map(nt=>({useScope:nt(),scopeName:nt.scopeName}));return function(nt){const st=it.reduce((at,{useScope:lt,scopeName:ot})=>({...at,...lt(nt)[`__scope${ot}`]}),{});return reactExports.useMemo(()=>({[`__scope${_e.scopeName}`]:st}),[st])}};return rt.scopeName=_e.scopeName,rt}function getPlacementData({anchorRect:tt,popperSize:_e,arrowSize:rt,arrowOffset:it=0,side:nt,sideOffset:st=0,align:at,alignOffset:lt=0,shouldAvoidCollisions:ot=!0,collisionBoundariesRect:ct,collisionTolerance:ut=0}){if(!tt||!_e||!ct)return{popperStyles:o$1,arrowStyles:n$1};const ht=function(Ct,St,Et=0,Tt=0,Mt){const Rt=Mt?Mt.height:0,It=t$1(St,Ct,"x"),Ot=t$1(St,Ct,"y"),Bt=Ot.before-Et-Rt,Nt=Ot.after+Et+Rt,zt=It.before-Et-Rt,Dt=It.after+Et+Rt;return{top:{start:{x:It.start+Tt,y:Bt},center:{x:It.center,y:Bt},end:{x:It.end-Tt,y:Bt}},right:{start:{x:Dt,y:Ot.start+Tt},center:{x:Dt,y:Ot.center},end:{x:Dt,y:Ot.end-Tt}},bottom:{start:{x:It.start+Tt,y:Nt},center:{x:It.center,y:Nt},end:{x:It.end-Tt,y:Nt}},left:{start:{x:zt,y:Ot.start+Tt},center:{x:zt,y:Ot.center},end:{x:zt,y:Ot.end-Tt}}}}(_e,tt,st,lt,rt),dt=ht[nt][at];if(ot===!1){const Ct=e$1(dt);let St=n$1;return rt&&(St=i$2({popperSize:_e,arrowSize:rt,arrowOffset:it,side:nt,align:at})),{popperStyles:{...Ct,"--radix-popper-transform-origin":r$2(_e,nt,at,it,rt)},arrowStyles:St,placedSide:nt,placedAlign:at}}const pt=DOMRect.fromRect({..._e,...dt}),ft=(gt=ct,mt=ut,DOMRect.fromRect({width:gt.width-2*mt,height:gt.height-2*mt,x:gt.left+mt,y:gt.top+mt}));var gt,mt;const At=s$2(pt,ft),yt=ht[a$1(nt)][at],bt=function(Ct,St,Et){const Tt=a$1(Ct);return St[Ct]&&!Et[Tt]?Tt:Ct}(nt,At,s$2(DOMRect.fromRect({..._e,...yt}),ft)),xt=function(Ct,St,Et,Tt,Mt){const Rt=Et==="top"||Et==="bottom",It=Rt?"left":"top",Ot=Rt?"right":"bottom",Bt=Rt?"width":"height",Nt=St[Bt]>Ct[Bt];return(Tt==="start"||Tt==="center")&&(Mt[It]&&Nt||Mt[Ot]&&!Nt)?"end":(Tt==="end"||Tt==="center")&&(Mt[Ot]&&Nt||Mt[It]&&!Nt)?"start":Tt}(_e,tt,nt,at,At),vt=e$1(ht[bt][xt]);let _t=n$1;return rt&&(_t=i$2({popperSize:_e,arrowSize:rt,arrowOffset:it,side:bt,align:xt})),{popperStyles:{...vt,"--radix-popper-transform-origin":r$2(_e,bt,xt,it,rt)},arrowStyles:_t,placedSide:bt,placedAlign:xt}}function t$1(tt,_e,rt){const it=tt[rt==="x"?"left":"top"],nt=rt==="x"?"width":"height",st=tt[nt],at=_e[nt];return{before:it-at,start:it,center:it+(st-at)/2,end:it+st-at,after:it+st}}function e$1(tt){return{position:"absolute",top:0,left:0,minWidth:"max-content",willChange:"transform",transform:`translate3d(${Math.round(tt.x+window.scrollX)}px, ${Math.round(tt.y+window.scrollY)}px, 0)`}}function r$2(tt,_e,rt,it,nt){const st=_e==="top"||_e==="bottom",at=nt?nt.width:0,lt=nt?nt.height:0,ot=at/2+it;let ct="",ut="";return st?(ct={start:`${ot}px`,center:"center",end:tt.width-ot+"px"}[rt],ut=_e==="top"?`${tt.height+lt}px`:-lt+"px"):(ct=_e==="left"?`${tt.width+lt}px`:-lt+"px",ut={start:`${ot}px`,center:"center",end:tt.height-ot+"px"}[rt]),`${ct} ${ut}`}const o$1={position:"fixed",top:0,left:0,opacity:0,transform:"translate3d(0, -200%, 0)"},n$1={position:"absolute",opacity:0};function i$2({popperSize:tt,arrowSize:_e,arrowOffset:rt,side:it,align:nt}){const st=(tt.width-_e.width)/2,at=(tt.height-_e.width)/2,lt={top:0,right:90,bottom:180,left:-90}[it],ot=Math.max(_e.width,_e.height),ct={width:`${ot}px`,height:`${ot}px`,transform:`rotate(${lt}deg)`,willChange:"transform",position:"absolute",[it]:"100%",direction:p$2(it,nt)};return it!=="top"&&it!=="bottom"||(nt==="start"&&(ct.left=`${rt}px`),nt==="center"&&(ct.left=`${st}px`),nt==="end"&&(ct.right=`${rt}px`)),it!=="left"&&it!=="right"||(nt==="start"&&(ct.top=`${rt}px`),nt==="center"&&(ct.top=`${at}px`),nt==="end"&&(ct.bottom=`${rt}px`)),ct}function p$2(tt,_e){return(tt!=="top"&&tt!=="right"||_e!=="end")&&(tt!=="bottom"&&tt!=="left"||_e==="end")?"ltr":"rtl"}function a$1(tt){return{top:"bottom",right:"left",bottom:"top",left:"right"}[tt]}function s$2(tt,_e){return{top:tt.top<_e.top,right:tt.right>_e.right,bottom:tt.bottom>_e.bottom,left:tt.left<_e.left}}const[c$2,l$1]=createContextScope("Popper"),[f$2,d$2]=c$2("Popper"),Popper=tt=>{const{__scopePopper:_e,children:rt}=tt,[it,nt]=reactExports.useState(null);return reactExports.createElement(f$2,{scope:_e,anchor:it,onAnchorChange:nt},rt)},PopperAnchor=reactExports.forwardRef((tt,_e)=>{const{__scopePopper:rt,virtualRef:it,...nt}=tt,st=d$2("PopperAnchor",rt),at=reactExports.useRef(null),lt=useComposedRefs$1(_e,at);return reactExports.useEffect(()=>{st.onAnchorChange((it==null?void 0:it.current)||at.current)}),it?null:reactExports.createElement(Primitive.div,_extends$1({},nt,{ref:lt}))}),[u$2,m$2]=c$2("PopperContent"),PopperContent=reactExports.forwardRef((tt,_e)=>{const{__scopePopper:rt,side:it="bottom",sideOffset:nt,align:st="center",alignOffset:at,collisionTolerance:lt,avoidCollisions:ot=!0,...ct}=tt,ut=d$2("PopperContent",rt),[ht,dt]=reactExports.useState(),pt=useRect(ut.anchor),[ft,gt]=reactExports.useState(null),mt=useSize(ft),[At,yt]=reactExports.useState(null),bt=useSize(At),xt=useComposedRefs$1(_e,Rt=>gt(Rt)),vt=function(){const[Rt,It]=reactExports.useState(void 0);return reactExports.useEffect(()=>{let Ot;function Bt(){It({width:window.innerWidth,height:window.innerHeight})}function Nt(){window.clearTimeout(Ot),Ot=window.setTimeout(Bt,100)}return Bt(),window.addEventListener("resize",Nt),()=>window.removeEventListener("resize",Nt)},[]),Rt}(),_t=vt?DOMRect.fromRect({...vt,x:0,y:0}):void 0,{popperStyles:Ct,arrowStyles:St,placedSide:Et,placedAlign:Tt}=getPlacementData({anchorRect:pt,popperSize:mt,arrowSize:bt,arrowOffset:ht,side:it,sideOffset:nt,align:st,alignOffset:at,shouldAvoidCollisions:ot,collisionBoundariesRect:_t,collisionTolerance:lt}),Mt=Et!==void 0;return reactExports.createElement("div",{style:Ct,"data-radix-popper-content-wrapper":""},reactExports.createElement(u$2,{scope:rt,arrowStyles:St,onArrowChange:yt,onArrowOffsetChange:dt},reactExports.createElement(Primitive.div,_extends$1({"data-side":Et,"data-align":Tt},ct,{style:{...ct.style,animation:Mt?void 0:"none"},ref:xt}))))}),PopperArrow=reactExports.forwardRef(function(tt,_e){const{__scopePopper:rt,offset:it,...nt}=tt,st=m$2("PopperArrow",rt),{onArrowOffsetChange:at}=st;return reactExports.useEffect(()=>at(it),[at,it]),reactExports.createElement("span",{style:{...st.arrowStyles,pointerEvents:"none"}},reactExports.createElement("span",{ref:st.onArrowChange,style:{display:"inline-block",verticalAlign:"top",pointerEvents:"auto"}},reactExports.createElement(Root$2,_extends$1({},nt,{ref:_e,style:{...nt.style,display:"block"}}))))}),Root$1=Popper,Anchor=PopperAnchor,Content$1=PopperContent,Arrow$1=PopperArrow,useLayoutEffect=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{};function composeRefs(...tt){return _e=>tt.forEach(rt=>function(it,nt){typeof it=="function"?it(nt):it!=null&&(it.current=nt)}(rt,_e))}function useComposedRefs(...tt){return reactExports.useCallback(composeRefs(...tt),tt)}const Presence=tt=>{const{present:_e,children:rt}=tt,it=function(at){const[lt,ot]=reactExports.useState(),ct=reactExports.useRef({}),ut=reactExports.useRef(at),ht=reactExports.useRef("none"),dt=at?"mounted":"unmounted",[pt,ft]=function(gt,mt){return reactExports.useReducer((At,yt)=>{const bt=mt[At][yt];return bt??At},gt)}(dt,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const gt=r$1(ct.current);ht.current=pt==="mounted"?gt:"none"},[pt]),useLayoutEffect(()=>{const gt=ct.current,mt=ut.current;if(mt!==at){const At=ht.current,yt=r$1(gt);at?ft("MOUNT"):yt==="none"||(gt==null?void 0:gt.display)==="none"?ft("UNMOUNT"):ft(mt&&At!==yt?"ANIMATION_OUT":"UNMOUNT"),ut.current=at}},[at,ft]),useLayoutEffect(()=>{if(lt){const gt=At=>{const yt=r$1(ct.current).includes(At.animationName);At.target===lt&&yt&&ft("ANIMATION_END")},mt=At=>{At.target===lt&&(ht.current=r$1(ct.current))};return lt.addEventListener("animationstart",mt),lt.addEventListener("animationcancel",gt),lt.addEventListener("animationend",gt),()=>{lt.removeEventListener("animationstart",mt),lt.removeEventListener("animationcancel",gt),lt.removeEventListener("animationend",gt)}}},[lt,ft]),{isPresent:["mounted","unmountSuspended"].includes(pt),ref:reactExports.useCallback(gt=>{gt&&(ct.current=getComputedStyle(gt)),ot(gt)},[])}}(_e),nt=typeof rt=="function"?rt({present:it.isPresent}):reactExports.Children.only(rt),st=useComposedRefs(it.ref,nt.ref);return typeof rt=="function"||it.isPresent?reactExports.cloneElement(nt,{ref:st}):null};function r$1(tt){return(tt==null?void 0:tt.animationName)||"none"}Presence.displayName="Presence";function usePrevious(tt){const _e=reactExports.useRef(tt);return reactExports.useEffect(()=>{_e.current=tt},[tt]),_e.current}function useCallbackRef$1(tt){const _e=reactExports.useRef(tt);return reactExports.useEffect(()=>{_e.current=tt}),reactExports.useMemo(()=>(...rt)=>{var it;return(it=_e.current)===null||it===void 0?void 0:it.call(_e,...rt)},[])}function useEscapeKeydown(tt){const _e=useCallbackRef$1(tt);reactExports.useEffect(()=>{const rt=it=>{it.key==="Escape"&&_e(it)};return document.addEventListener("keydown",rt),()=>document.removeEventListener("keydown",rt)},[_e])}function useCallbackRef(tt){const _e=reactExports.useRef(tt);return reactExports.useEffect(()=>{_e.current=tt}),reactExports.useMemo(()=>(...rt)=>{var it;return(it=_e.current)===null||it===void 0?void 0:it.call(_e,...rt)},[])}function useControllableState({prop:tt,defaultProp:_e,onChange:rt=()=>{}}){const[it,nt]=function({defaultProp:ot,onChange:ct}){const ut=reactExports.useState(ot),[ht]=ut,dt=reactExports.useRef(ht),pt=useCallbackRef(ct);return reactExports.useEffect(()=>{dt.current!==ht&&(pt(ht),dt.current=ht)},[ht,dt,pt]),ut}({defaultProp:_e,onChange:rt}),st=tt!==void 0,at=st?tt:it,lt=useCallbackRef(rt);return[at,reactExports.useCallback(ot=>{if(st){const ct=ot,ut=typeof ot=="function"?ct(tt):ot;ut!==tt&&lt(ut)}else nt(ot)},[st,tt,nt,lt])]}function composeEventHandlers$1(tt,_e,{checkForDefaultPrevented:rt=!0}={}){return function(it){if(tt==null||tt(it),rt===!1||!it.defaultPrevented)return _e==null?void 0:_e(it)}}const[w$1,x$1]=createContextScope("Tooltip",[l$1]),g$2=l$1(),E=700,[v$2,b$2]=w$1("TooltipProvider",{isOpenDelayed:!0,delayDuration:E,onOpen:()=>{},onClose:()=>{}}),[y$2,_]=w$1("Tooltip"),Tooltip=tt=>{const{__scopeTooltip:_e,children:rt,open:it,defaultOpen:nt=!1,onOpenChange:st,delayDuration:at}=tt,lt=b$2("Tooltip",_e),ot=g$2(_e),[ct,ut]=reactExports.useState(null),ht=useId(),dt=reactExports.useRef(0),pt=at??lt.delayDuration,ft=reactExports.useRef(!1),{onOpen:gt,onClose:mt}=lt,[At=!1,yt]=useControllableState({prop:it,defaultProp:nt,onChange:_t=>{_t&&(document.dispatchEvent(new CustomEvent("tooltip.open")),gt()),st==null||st(_t)}}),bt=reactExports.useMemo(()=>At?ft.current?"delayed-open":"instant-open":"closed",[At]),xt=reactExports.useCallback(()=>{window.clearTimeout(dt.current),ft.current=!1,yt(!0)},[yt]),vt=reactExports.useCallback(()=>{window.clearTimeout(dt.current),dt.current=window.setTimeout(()=>{ft.current=!0,yt(!0)},pt)},[pt,yt]);return reactExports.useEffect(()=>()=>window.clearTimeout(dt.current),[]),reactExports.createElement(Root$1,ot,reactExports.createElement(y$2,{scope:_e,contentId:ht,open:At,stateAttribute:bt,trigger:ct,onTriggerChange:ut,onTriggerEnter:reactExports.useCallback(()=>{lt.isOpenDelayed?vt():xt()},[lt.isOpenDelayed,vt,xt]),onOpen:reactExports.useCallback(xt,[xt]),onClose:reactExports.useCallback(()=>{window.clearTimeout(dt.current),yt(!1),mt()},[yt,mt])},rt))},TooltipTrigger=reactExports.forwardRef((tt,_e)=>{const{__scopeTooltip:rt,...it}=tt,nt=_("TooltipTrigger",rt),st=g$2(rt),at=useComposedRefs$1(_e,nt.onTriggerChange),lt=reactExports.useRef(!1),ot=reactExports.useCallback(()=>lt.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("mouseup",ot),[ot]),reactExports.createElement(Anchor,_extends$1({asChild:!0},st),reactExports.createElement(Primitive.button,_extends$1({"aria-describedby":nt.open?nt.contentId:void 0,"data-state":nt.stateAttribute},it,{ref:at,onMouseEnter:composeEventHandlers$1(tt.onMouseEnter,nt.onTriggerEnter),onMouseLeave:composeEventHandlers$1(tt.onMouseLeave,nt.onClose),onMouseDown:composeEventHandlers$1(tt.onMouseDown,()=>{nt.onClose(),lt.current=!0,document.addEventListener("mouseup",ot,{once:!0})}),onFocus:composeEventHandlers$1(tt.onFocus,()=>{lt.current||nt.onOpen()}),onBlur:composeEventHandlers$1(tt.onBlur,nt.onClose),onClick:composeEventHandlers$1(tt.onClick,nt.onClose)})))}),TooltipContent=reactExports.forwardRef((tt,_e)=>{const{forceMount:rt,...it}=tt,nt=_("TooltipContent",tt.__scopeTooltip);return reactExports.createElement(Presence,{present:rt||nt.open},reactExports.createElement(h$2,_extends$1({ref:_e},it)))}),h$2=reactExports.forwardRef((tt,_e)=>{const{__scopeTooltip:rt,children:it,"aria-label":nt,portalled:st=!0,...at}=tt,lt=_("TooltipContent",rt),ot=g$2(rt),ct=st?Portal$1:reactExports.Fragment,{onClose:ut}=lt;return useEscapeKeydown(()=>ut()),reactExports.useEffect(()=>(document.addEventListener("tooltip.open",ut),()=>document.removeEventListener("tooltip.open",ut)),[ut]),reactExports.createElement(ct,null,reactExports.createElement(k$2,{__scopeTooltip:rt}),reactExports.createElement(Content$1,_extends$1({"data-state":lt.stateAttribute},ot,at,{ref:_e,style:{...at.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)"}}),reactExports.createElement(Slottable,null,it),reactExports.createElement(Root$3,{id:lt.contentId,role:"tooltip"},nt||it)))}),TooltipArrow=reactExports.forwardRef((tt,_e)=>{const{__scopeTooltip:rt,...it}=tt,nt=g$2(rt);return reactExports.createElement(Arrow$1,_extends$1({},nt,it,{ref:_e}))});function k$2(tt){const{__scopeTooltip:_e}=tt,rt=_("CheckTriggerMoved",_e),it=useRect(rt.trigger),nt=it==null?void 0:it.left,st=usePrevious(nt),at=it==null?void 0:it.top,lt=usePrevious(at),ot=rt.onClose;return reactExports.useEffect(()=>{(st!==void 0&&st!==nt||lt!==void 0&&lt!==at)&&ot()},[ot,st,lt,nt,at]),null}const Root=Tooltip,Trigger=TooltipTrigger,Content=TooltipContent,Arrow=TooltipArrow;function _objectWithoutPropertiesLoose$1(tt,_e){if(tt==null)return{};var rt={},it=Object.keys(tt),nt,st;for(st=0;st<it.length;st++)nt=it[st],!(_e.indexOf(nt)>=0)&&(rt[nt]=tt[nt]);return rt}function _objectWithoutProperties$1(tt,_e){if(tt==null)return{};var rt=_objectWithoutPropertiesLoose$1(tt,_e),it,nt;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(tt);for(nt=0;nt<st.length;nt++)it=st[nt],!(_e.indexOf(it)>=0)&&Object.prototype.propertyIsEnumerable.call(tt,it)&&(rt[it]=tt[it])}return rt}let LevaErrors;(function(tt){tt[tt.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",tt[tt.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",tt[tt.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",tt[tt.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",tt[tt.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",tt[tt.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",tt[tt.THEME_ERROR=6]="THEME_ERROR",tt[tt.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",tt[tt.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",tt[tt.EMPTY_KEY=9]="EMPTY_KEY"})(LevaErrors||(LevaErrors={}));const ErrorList={[LevaErrors.UNSUPPORTED_INPUT]:(tt,_e)=>[`An input with type \`${tt}\` input was found at path \`${_e}\` but it's not supported yet.`],[LevaErrors.NO_COMPONENT_FOR_TYPE]:(tt,_e)=>[`Type \`${tt}\` found at path \`${_e}\` can't be displayed in panel because no component supports it yet.`],[LevaErrors.UNKNOWN_INPUT]:(tt,_e)=>[`input at path \`${tt}\` is not recognized.`,_e],[LevaErrors.DUPLICATE_KEYS]:(tt,_e,rt)=>[`Key \`${tt}\` of path \`${_e}\` already exists at path \`${rt}\`. Even nested keys need to be unique. Rename one of the keys.`],[LevaErrors.ALREADY_REGISTERED_TYPE]:tt=>[`Type ${tt} has already been registered. You can't register a component with the same type.`],[LevaErrors.CLIPBOARD_ERROR]:tt=>["Error copying the value",tt],[LevaErrors.THEME_ERROR]:(tt,_e)=>[`Error accessing the theme \`${tt}.${_e}\` value.`],[LevaErrors.PATH_DOESNT_EXIST]:tt=>[`Error getting the value at path \`${tt}\`. There is probably an error in your \`render\` function.`],[LevaErrors.PATH_DOESNT_EXIST]:tt=>[`Error accessing the value at path \`${tt}\``],[LevaErrors.INPUT_TYPE_OVERRIDE]:(tt,_e,rt)=>[`Input at path \`${tt}\` already exists with type: \`${_e}\`. Its type cannot be overridden with type \`${rt}\`.`],[LevaErrors.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function _log(tt,_e,...rt){const[it,...nt]=ErrorList[_e](...rt);console[tt]("LEVA: "+it,...nt)}const warn=_log.bind(null,"warn"),log=_log.bind(null,"log"),_excluded$a=["value"],_excluded2$4=["schema"],_excluded3$1=["value"],Schemas=[],Plugins={};function getValueType(tt){let{value:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$a);for(let it of Schemas){const nt=it(_e,rt);if(nt)return nt}}function register(tt,_e){let{schema:rt}=_e,it=_objectWithoutProperties$1(_e,_excluded2$4);if(tt in Plugins){warn(LevaErrors.ALREADY_REGISTERED_TYPE,tt);return}Schemas.push((nt,st)=>rt(nt,st)&&tt),Plugins[tt]=it}function createInternalPlugin(tt){return tt}function normalize$3$1(tt,_e,rt,it){const{normalize:nt}=Plugins[tt];if(nt)return nt(_e,rt,it);if(typeof _e!="object"||!("value"in _e))return{value:_e};const{value:st}=_e,at=_objectWithoutProperties$1(_e,_excluded3$1);return{value:st,settings:at}}function sanitize$4(tt,_e,rt,it,nt,st){const{sanitize:at}=Plugins[tt];return at?at(_e,rt,it,nt,st):_e}function format$2(tt,_e,rt){const{format:it}=Plugins[tt];return it?it(_e,rt):_e}function _defineProperty$3(tt,_e,rt){return _e in tt?Object.defineProperty(tt,_e,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[_e]=rt,tt}function ownKeys$2(tt,_e){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var it=Object.getOwnPropertySymbols(tt);_e&&(it=it.filter(function(nt){return Object.getOwnPropertyDescriptor(tt,nt).enumerable})),rt.push.apply(rt,it)}return rt}function _objectSpread2(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$2(Object(rt),!0).forEach(function(it){_defineProperty$3(tt,it,rt[it])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ownKeys$2(Object(rt)).forEach(function(it){Object.defineProperty(tt,it,Object.getOwnPropertyDescriptor(rt,it))})}return tt}const clamp=(tt,_e,rt)=>tt>rt?rt:tt<_e?_e:tt,parseNumber=tt=>{if(tt===""||typeof tt=="number")return tt;try{const _e=evaluate(tt);if(!isNaN(_e))return _e}catch{}return parseFloat(tt)},log10=Math.log(10);function getStep(tt){let _e=Math.abs(+String(tt).replace(".",""));if(_e===0)return .01;for(;_e!==0&&_e%10===0;)_e/=10;const rt=Math.floor(Math.log(_e)/log10)+1,it=Math.floor(Math.log10(Math.abs(tt))),nt=Math.pow(10,it-rt);return Math.max(nt,.001)}const range=(tt,_e,rt)=>rt===_e?0:(clamp(tt,_e,rt)-_e)/(rt-_e),invertedRange=(tt,_e,rt)=>tt*(rt-_e)+_e,getUid=()=>"_"+Math.random().toString(36).substr(2,9),parens=/\(([0-9+\-*/^ .]+)\)/,exp=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,mul=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,div=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,add=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,sub=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function evaluate(tt){if(isNaN(Number(tt)))if(parens.test(tt)){const _e=tt.replace(parens,(rt,it)=>String(evaluate(it)));return evaluate(_e)}else if(exp.test(tt)){const _e=tt.replace(exp,(rt,it,nt)=>String(Math.pow(Number(it),Number(nt))));return evaluate(_e)}else if(mul.test(tt)){const _e=tt.replace(mul,(rt,it,nt)=>String(Number(it)*Number(nt)));return evaluate(_e)}else if(div.test(tt)){const _e=tt.replace(div,(rt,it,nt)=>{if(nt!=0)return String(Number(it)/Number(nt));throw new Error("Division by zero")});return evaluate(_e)}else if(add.test(tt)){const _e=tt.replace(add,(rt,it,nt)=>String(Number(it)+Number(nt)));return evaluate(_e)}else if(sub.test(tt)){const _e=tt.replace(sub,(rt,it,nt)=>String(Number(it)-Number(nt)));return evaluate(_e)}else return Number(tt);return Number(tt)}function pick(tt,_e){return _e.reduce((rt,it)=>(tt&&tt.hasOwnProperty(it)&&(rt[it]=tt[it]),rt),{})}function omit(tt,_e){const rt=_objectSpread2({},tt);return _e.forEach(it=>it in tt&&delete rt[it]),rt}function mapArrayToKeys(tt,_e){return tt.reduce((rt,it,nt)=>Object.assign(rt,{[_e[nt]]:it}),{})}function isObject$9(tt){return Object.prototype.toString.call(tt)==="[object Object]"}const isEmptyObject=tt=>isObject$9(tt)&&Object.keys(tt).length===0;let SpecialInputs;(function(tt){tt.BUTTON="BUTTON",tt.BUTTON_GROUP="BUTTON_GROUP",tt.MONITOR="MONITOR",tt.FOLDER="FOLDER"})(SpecialInputs||(SpecialInputs={}));let LevaInputs;(function(tt){tt.SELECT="SELECT",tt.IMAGE="IMAGE",tt.NUMBER="NUMBER",tt.COLOR="COLOR",tt.STRING="STRING",tt.BOOLEAN="BOOLEAN",tt.INTERVAL="INTERVAL",tt.VECTOR3D="VECTOR3D",tt.VECTOR2D="VECTOR2D"})(LevaInputs||(LevaInputs={}));const _excluded$9=["type","__customInput"],_excluded2$3=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],_excluded3$2=["type"];function parseOptions(tt,_e,rt={},it){var nt,st;if(typeof tt!="object"||Array.isArray(tt))return{type:it,input:tt,options:_objectSpread2({key:_e,label:_e,optional:!1,disabled:!1,order:0},rt)};if("__customInput"in tt){const{type:vt,__customInput:_t}=tt,Ct=_objectWithoutProperties$1(tt,_excluded$9);return parseOptions(_t,_e,Ct,vt)}const{render:at,label:lt,optional:ot,order:ct=0,disabled:ut,hint:ht,onChange:dt,onEditStart:pt,onEditEnd:ft,transient:gt}=tt,mt=_objectWithoutProperties$1(tt,_excluded2$3),At=_objectSpread2({render:at,key:_e,label:lt??_e,hint:ht,transient:gt??!!dt,onEditStart:pt,onEditEnd:ft,disabled:ut,optional:ot,order:ct},rt);let{type:yt}=mt,bt=_objectWithoutProperties$1(mt,_excluded3$2);if(yt=it??yt,yt in SpecialInputs)return{type:yt,input:bt,options:At};let xt;return it&&isObject$9(bt)&&"value"in bt?xt=bt.value:xt=isEmptyObject(bt)?void 0:bt,{type:yt,input:xt,options:_objectSpread2(_objectSpread2({},At),{},{onChange:dt,optional:(nt=At.optional)!==null&&nt!==void 0?nt:!1,disabled:(st=At.disabled)!==null&&st!==void 0?st:!1})}}function normalizeInput(tt,_e,rt,it){const nt=parseOptions(tt,_e),{type:st,input:at,options:lt}=nt;if(st)return st in SpecialInputs?nt:{type:st,input:normalize$3$1(st,at,rt,it),options:lt};let ot=getValueType(at);return ot?{type:ot,input:normalize$3$1(ot,at,rt,it),options:lt}:(ot=getValueType({value:at}),ot?{type:ot,input:normalize$3$1(ot,{value:at},rt,it),options:lt}:!1)}function updateInput(tt,_e,rt,it,nt){const{value:st,type:at,settings:lt}=tt;tt.value=sanitizeValue({type:at,value:st,settings:lt},_e,rt,it),tt.fromPanel=nt}const ValueError=function(_e,rt,it){this.type="LEVA_ERROR",this.message="LEVA: "+_e,this.previousValue=rt,this.error=it};function sanitizeValue({type:tt,value:_e,settings:rt},it,nt,st){const at=tt!=="SELECT"&&typeof it=="function"?it(_e):it;let lt;try{lt=sanitize$4(tt,at,rt,_e,nt,st)}catch(ot){throw new ValueError(`The value \`${it}\` did not result in a correct value.`,_e,ot)}return dequal(lt,_e)?_e:lt}const debounce=(tt,_e,rt=!1)=>{let it=0;return function(){const nt=arguments,st=rt&&!it,at=()=>tt.apply(this,nt);window.clearTimeout(it),it=window.setTimeout(at,_e),st&&at()}},multiplyStep=tt=>tt.shiftKey?5:tt.altKey?1/5:1;function render(tt,_e){const rt=console.error;console.error=()=>{},ReactDOM.render(tt,_e),console.error=rt}const _excluded$8=["value"],_excluded2$2$1=["min","max"],schema$3=tt=>{if(typeof tt=="number")return!0;if(typeof tt=="string"){const _e=parseFloat(tt);return isNaN(_e)?!1:tt.substring((""+_e).length).trim().length<4}return!1},sanitize$3=(tt,{min:_e=-1/0,max:rt=1/0,suffix:it})=>{const nt=parseFloat(tt);if(tt===""||isNaN(nt))throw Error("Invalid number");const st=clamp(nt,_e,rt);return it?st+it:st},format$1$1=(tt,{pad:_e=0,suffix:rt})=>{const it=parseFloat(tt).toFixed(_e);return rt?it+rt:it},normalize$2$1=tt=>{let{value:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$8);const{min:it=-1/0,max:nt=1/0}=rt,st=_objectWithoutProperties$1(rt,_excluded2$2$1);let at=parseFloat(_e);const lt=typeof _e=="string"?_e.substring((""+at).length):void 0;at=clamp(at,it,nt);let ot=rt.step;ot||(Number.isFinite(it)?Number.isFinite(nt)?ot=+(Math.abs(nt-it)/100).toPrecision(1):ot=+(Math.abs(at-it)/100).toPrecision(1):Number.isFinite(nt)&&(ot=+(Math.abs(nt-at)/100).toPrecision(1)));const ct=ot?getStep(ot)*10:getStep(at);ot=ot||ct/10;const ut=Math.round(clamp(Math.log10(1/ct),0,2));return{value:lt?at+lt:at,settings:_objectSpread2({initialValue:at,step:ot,pad:ut,min:it,max:nt,suffix:lt},st)}},sanitizeStep$1=(tt,{step:_e,initialValue:rt})=>{const it=Math.round((tt-rt)/_e);return rt+it*_e};var props$3=Object.freeze({__proto__:null,schema:schema$3,sanitize:sanitize$3,format:format$1$1,normalize:normalize$2$1,sanitizeStep:sanitizeStep$1});function _extends(){return _extends=Object.assign?Object.assign.bind():function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var it in rt)Object.prototype.hasOwnProperty.call(rt,it)&&(tt[it]=rt[it])}return tt},_extends.apply(this,arguments)}const InputContext=reactExports.createContext({});function useInputContext(){return reactExports.useContext(InputContext)}const ThemeContext=reactExports.createContext(null),StoreContext=reactExports.createContext(null),PanelSettingsContext=reactExports.createContext(null);function useStoreContext(){return reactExports.useContext(StoreContext)}function usePanelSettingsContext(){return reactExports.useContext(PanelSettingsContext)}const getDefaultTheme=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function createStateClass(tt,_e){const[rt,it]=tt.split(" "),nt={};return rt!=="none"&&(nt.boxShadow=`${_e.inset?"inset ":""}0 0 0 $borderWidths${[_e.key]} $colors${rt!=="default"&&rt||_e.borderColor}`),it&&(nt.backgroundColor=it),nt}const utils={$inputStyle:()=>tt=>createStateClass(tt,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>tt=>createStateClass(tt,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>tt=>createStateClass(tt,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>tt=>createStateClass(tt,{key:"$active",borderColor:"$accent1",inset:!0})},{styled,css,createTheme,globalCss,keyframes}=q$1({prefix:"leva",theme:getDefaultTheme(),utils:_objectSpread2(_objectSpread2({},utils),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:tt=>({"&:focus":utils.$focusStyle()(tt)}),$focusWithin:tt=>({"&:focus-within":utils.$focusStyle()(tt)}),$hover:tt=>({"&:hover":utils.$hoverStyle()(tt)}),$active:tt=>({"&:active":utils.$activeStyle()(tt)})})}),globalStyles=globalCss({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function mergeTheme(tt){const _e=getDefaultTheme();if(!tt)return{theme:_e,className:""};Object.keys(tt).forEach(it=>{Object.assign(_e[it],tt[it])});const rt=createTheme(_e);return{theme:_e,className:rt.className}}function useTh(tt,_e){const{theme:rt}=reactExports.useContext(ThemeContext);if(!(tt in rt)||!(_e in rt[tt]))return warn(LevaErrors.THEME_ERROR,tt,_e),"";let it=_e;for(;;){let nt=rt[tt][it];if(typeof nt=="string"&&nt.charAt(0)==="$")it=nt.substr(1);else return nt}}const StyledInput=styled("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),InnerLabel=styled("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${StyledInput}`]:{paddingLeft:0}}),InnerNumberLabel=styled(InnerLabel,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),InputContainer=styled("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),_excluded$7$1=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],_excluded2$1$1=["onUpdate"];function ValueInput(tt){let{innerLabel:_e,value:rt,onUpdate:it,onChange:nt,onKeyDown:st,type:at,id:lt,inputType:ot="text",rows:ct=0}=tt,ut=_objectWithoutProperties$1(tt,_excluded$7$1);const{id:ht,emitOnEditStart:dt,emitOnEditEnd:pt,disabled:ft}=useInputContext(),gt=lt||ht,mt=reactExports.useRef(null),At=ct>0,yt=At?"textarea":"input",bt=reactExports.useCallback(_t=>Ct=>{const St=Ct.currentTarget.value;_t(St)},[]);React.useEffect(()=>{const _t=mt.current,Ct=bt(St=>{it(St),pt()});return _t==null||_t.addEventListener("blur",Ct),()=>_t==null?void 0:_t.removeEventListener("blur",Ct)},[bt,it,pt]);const xt=reactExports.useCallback(_t=>{_t.key==="Enter"&&bt(it)(_t)},[bt,it]),vt=Object.assign({as:yt},At?{rows:ct}:{},ut);return React.createElement(InputContainer,{textArea:At},_e&&typeof _e=="string"?React.createElement(InnerLabel,null,_e):_e,React.createElement(StyledInput,_extends({levaType:at,ref:mt,id:gt,type:ot,autoComplete:"off",spellCheck:"false",value:rt,onChange:bt(nt),onFocus:()=>dt(),onKeyPress:xt,onKeyDown:st,disabled:ft},vt)))}function NumberInput(tt){let{onUpdate:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded2$1$1);const it=reactExports.useCallback(st=>_e(parseNumber(st)),[_e]),nt=reactExports.useCallback(st=>{const at=st.key==="ArrowUp"?1:st.key==="ArrowDown"?-1:0;if(at){st.preventDefault();const lt=st.altKey?.1:st.shiftKey?10:1;_e(ot=>parseFloat(ot)+at*lt)}},[_e]);return React.createElement(ValueInput,_extends({},rt,{onUpdate:it,onKeyDown:nt,type:"number"}))}const StyledFolder=styled("div",{}),StyledWrapper=styled("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),StyledTitle=styled("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & > svg`]:{opacity:1}}),StyledContent=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${StyledFolder}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),StyledRow=styled("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${StyledContent} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),StyledInputRow=styled(StyledRow,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),CopyLabelContainer=styled("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),StyledOptionalToggle=styled("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),StyledLabel=styled("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),StyledInputWrapper$1=styled("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${StyledLabel}`]:{pointerEvents:"auto"}}}}}),Overlay=styled("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),StyledToolTipContent=styled("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),ToolTipArrow=styled(Arrow,{fill:"$toolTipBackground"});function Portal({children:tt}){const{className:_e}=reactExports.useContext(ThemeContext);return React.createElement(Root$4,{className:_e},tt)}const _excluded$6$1=["align"];function OptionalToggle(){const{id:tt,disable:_e,disabled:rt}=useInputContext();return React.createElement(React.Fragment,null,React.createElement(StyledOptionalToggle,{id:tt+"__disable",type:"checkbox",checked:!rt,onChange:()=>_e(!rt)}),React.createElement("label",{htmlFor:tt+"__disable"}))}function RawLabel(tt){const{id:_e,optional:rt,hint:it}=useInputContext(),nt=tt.htmlFor||(_e?{htmlFor:_e}:null),st=!it&&typeof tt.children=="string"?{title:tt.children}:null;return React.createElement(React.Fragment,null,rt&&React.createElement(OptionalToggle,null),it!==void 0?React.createElement(Root,null,React.createElement(Trigger,{asChild:!0},React.createElement(StyledLabel,_extends({},nt,tt))),React.createElement(Content,{side:"top",sideOffset:2},React.createElement(StyledToolTipContent,null,it,React.createElement(ToolTipArrow,null)))):React.createElement(StyledLabel,_extends({},nt,st,tt)))}function Label(tt){let{align:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$6$1);const{value:it,label:nt,key:st,disabled:at}=useInputContext(),{hideCopyButton:lt}=usePanelSettingsContext(),ot=!lt&&st!==void 0,[ct,ut]=reactExports.useState(!1),ht=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[st]:it??""})),ut(!0)}catch{warn(LevaErrors.CLIPBOARD_ERROR,{[st]:it})}};return React.createElement(CopyLabelContainer,{align:_e,onPointerLeave:()=>ut(!1)},React.createElement(RawLabel,rt),ot&&!at&&React.createElement("div",{title:`Click to copy ${typeof nt=="string"?nt:st} value`},ct?React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),React.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):React.createElement("svg",{onClick:ht,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),React.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const _excluded$5$1=["toggled"],Svg=styled("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function Chevron(tt){let{toggled:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$5$1);return React.createElement(Svg,_extends({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${_e?0:-90}deg)`}},rt),React.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const _excluded$4$1=["input"];function Row(tt){let{input:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$4$1);return _e?React.createElement(StyledInputRow,rt):React.createElement(StyledRow,rt)}function useInputSetters({value:tt,type:_e,settings:rt,setValue:it}){const[nt,st]=reactExports.useState(format$2(_e,tt,rt)),at=reactExports.useRef(tt),lt=reactExports.useRef(rt);lt.current=rt;const ot=reactExports.useCallback(ut=>st(format$2(_e,ut,lt.current)),[_e]),ct=reactExports.useCallback(ut=>{try{it(ut)}catch(ht){const{type:dt,previousValue:pt}=ht;if(dt!=="LEVA_ERROR")throw ht;ot(pt)}},[ot,it]);return reactExports.useEffect(()=>{dequal(tt,at.current)||ot(tt),at.current=tt},[tt,ot]),{displayValue:nt,onChange:st,onUpdate:ct}}function useDrag(tt,_e){const{emitOnEditStart:rt,emitOnEditEnd:it}=useInputContext();return useDrag$1(nt=>{nt.first&&(document.body.classList.add("leva__panel__dragged"),rt==null||rt());const st=tt(nt);return nt.last&&(document.body.classList.remove("leva__panel__dragged"),it==null||it()),st},_e)}function useCanvas2d(tt){const _e=reactExports.useRef(null),rt=reactExports.useRef(null),it=reactExports.useRef(!1);return reactExports.useEffect(()=>{const nt=debounce(()=>{_e.current.width=_e.current.offsetWidth*window.devicePixelRatio,_e.current.height=_e.current.offsetHeight*window.devicePixelRatio,tt(_e.current,rt.current)},250);return window.addEventListener("resize",nt),it.current||(nt(),it.current=!0),()=>window.removeEventListener("resize",nt)},[tt]),reactExports.useEffect(()=>{rt.current=_e.current.getContext("2d")},[]),[_e,rt]}function useTransform(){const tt=reactExports.useRef(null),_e=reactExports.useRef({x:0,y:0}),rt=reactExports.useCallback(it=>{Object.assign(_e.current,it),tt.current&&(tt.current.style.transform=`translate3d(${_e.current.x}px, ${_e.current.y}px, 0)`)},[]);return[tt,rt]}const _excluded$3$1=["__refCount"],getInputAtPath=(tt,_e)=>{if(!tt[_e])return null;const rt=tt[_e];return _objectWithoutProperties$1(rt,_excluded$3$1)};function useInput(tt){const _e=useStoreContext(),[rt,it]=reactExports.useState(getInputAtPath(_e.getData(),tt)),nt=reactExports.useCallback(ct=>_e.setValueAtPath(tt,ct,!0),[tt,_e]),st=reactExports.useCallback(ct=>_e.setSettingsAtPath(tt,ct),[tt,_e]),at=reactExports.useCallback(ct=>_e.disableInputAtPath(tt,ct),[tt,_e]),lt=reactExports.useCallback(()=>_e.emitOnEditStart(tt),[tt,_e]),ot=reactExports.useCallback(()=>_e.emitOnEditEnd(tt),[tt,_e]);return reactExports.useEffect(()=>{it(getInputAtPath(_e.getData(),tt));const ct=_e.useStore.subscribe(ut=>getInputAtPath(ut.data,tt),it,{equalityFn:shallow});return()=>ct()},[_e,tt]),[rt,{set:nt,setSettings:st,disable:at,storeId:_e.storeId,emitOnEditStart:lt,emitOnEditEnd:ot}]}const RangeGrid=styled("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),Range=styled("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),Scrubber=styled("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),RangeWrapper=styled("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),Indicator=styled("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function RangeSlider({value:tt,min:_e,max:rt,onDrag:it,step:nt,initialValue:st}){const at=reactExports.useRef(null),lt=reactExports.useRef(null),ot=reactExports.useRef(0),ct=useTh("sizes","scrubberWidth"),ut=useDrag(({event:dt,first:pt,xy:[ft],movement:[gt],memo:mt})=>{if(pt){const{width:yt,left:bt}=at.current.getBoundingClientRect();ot.current=yt-parseFloat(ct),mt=(dt==null?void 0:dt.target)===lt.current?tt:invertedRange((ft-bt)/yt,_e,rt)}const At=mt+invertedRange(gt/ot.current,0,rt-_e);return it(sanitizeStep$1(At,{step:nt,initialValue:st})),mt}),ht=range(tt,_e,rt);return React.createElement(RangeWrapper,_extends({ref:at},ut()),React.createElement(Range,null,React.createElement(Indicator,{style:{left:0,right:`${(1-ht)*100}%`}})),React.createElement(Scrubber,{ref:lt,style:{left:`calc(${ht} * (100% - ${ct}))`}}))}const DraggableLabel=React.memo(({label:tt,onUpdate:_e,step:rt,innerLabelTrim:it})=>{const[nt,st]=reactExports.useState(!1),at=useDrag(({active:lt,delta:[ot],event:ct,memo:ut=0})=>(st(lt),ut+=ot/2,Math.abs(ut)>=1&&(_e(ht=>parseFloat(ht)+Math.floor(ut)*rt*multiplyStep(ct)),ut=0),ut));return React.createElement(InnerNumberLabel,_extends({dragging:nt,title:tt.length>1?tt:""},at()),tt.slice(0,it))});function Number$1({label:tt,id:_e,displayValue:rt,onUpdate:it,onChange:nt,settings:st,innerLabelTrim:at=1}){const lt=at>0&&React.createElement(DraggableLabel,{label:tt,step:st.step,onUpdate:it,innerLabelTrim:at});return React.createElement(NumberInput,{id:_e,value:String(rt),onUpdate:it,onChange:nt,innerLabel:lt})}function NumberComponent(){const tt=useInputContext(),{label:_e,value:rt,onUpdate:it,settings:nt,id:st}=tt,{min:at,max:lt}=nt,ot=lt!==1/0&&at!==-1/0;return React.createElement(Row,{input:!0},React.createElement(Label,null,_e),React.createElement(RangeGrid,{hasRange:ot},ot&&React.createElement(RangeSlider,_extends({value:parseFloat(rt),onDrag:it},nt)),React.createElement(Number$1,_extends({},tt,{id:st,label:"value",innerLabelTrim:ot?0:1}))))}const{sanitizeStep}=props$3,rest=_objectWithoutProperties$1(props$3,["sanitizeStep"]);var number$1=_objectSpread2({component:NumberComponent},rest);const schema$2$1=(tt,_e)=>v8n().schema({options:v8n().passesAnyOf(v8n().object(),v8n().array())}).test(_e),sanitize$2$1=(tt,{values:_e})=>{if(_e.indexOf(tt)<0)throw Error("Selected value doesn't match Select options");return tt},format$3=(tt,{values:_e})=>_e.indexOf(tt),normalize$1$1=tt=>{let{value:_e,options:rt}=tt,it,nt;return Array.isArray(rt)?(nt=rt,it=rt.map(st=>String(st))):(nt=Object.values(rt),it=Object.keys(rt)),"value"in tt?nt.includes(_e)||(it.unshift(String(_e)),nt.unshift(_e)):_e=nt[0],Object.values(rt).includes(_e)||(rt[String(_e)]=_e),{value:_e,settings:{keys:it,values:nt}}};var props$2$1=Object.freeze({__proto__:null,schema:schema$2$1,sanitize:sanitize$2$1,format:format$3,normalize:normalize$1$1});const SelectContainer=styled("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),NativeSelect=styled("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),PresentationalSelect=styled("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${NativeSelect}:focus + &`]:{$focusStyle:""},[`${NativeSelect}:hover + &`]:{$hoverStyle:""}});function Select({displayValue:tt,value:_e,onUpdate:rt,id:it,settings:nt,disabled:st}){const{keys:at,values:lt}=nt,ot=reactExports.useRef();return _e===lt[tt]&&(ot.current=at[tt]),React.createElement(SelectContainer,null,React.createElement(NativeSelect,{id:it,value:tt,onChange:ct=>rt(lt[Number(ct.currentTarget.value)]),disabled:st},at.map((ct,ut)=>React.createElement("option",{key:ct,value:ut},ct))),React.createElement(PresentationalSelect,null,ot.current),React.createElement(Chevron,{toggled:!0}))}function SelectComponent(){const{label:tt,value:_e,displayValue:rt,onUpdate:it,id:nt,disabled:st,settings:at}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Select,{id:nt,value:_e,displayValue:rt,onUpdate:it,settings:at,disabled:st}))}var select=_objectSpread2({component:SelectComponent},props$2$1);const schema$1$1=tt=>v8n().string().test(tt),sanitize$1$1=tt=>{if(typeof tt!="string")throw Error("Invalid string");return tt},normalize$4=({value:tt,editable:_e=!0,rows:rt=!1})=>({value:tt,settings:{editable:_e,rows:typeof rt=="number"?rt:rt?5:0}});var props$1$1=Object.freeze({__proto__:null,schema:schema$1$1,sanitize:sanitize$1$1,normalize:normalize$4});const _excluded$2$1=["displayValue","onUpdate","onChange","editable"],NonEditableString=styled("div",{whiteSpace:"pre-wrap"});function String$1(tt){let{displayValue:_e,onUpdate:rt,onChange:it,editable:nt=!0}=tt,st=_objectWithoutProperties$1(tt,_excluded$2$1);return nt?React.createElement(ValueInput,_extends({value:_e,onUpdate:rt,onChange:it},st)):React.createElement(NonEditableString,null,_e)}function StringComponent(){const{label:tt,settings:_e,displayValue:rt,onUpdate:it,onChange:nt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(String$1,_extends({displayValue:rt,onUpdate:it,onChange:nt},_e)))}var string=_objectSpread2({component:StringComponent},props$1$1);const schema$4=tt=>v8n().boolean().test(tt),sanitize$5=tt=>{if(typeof tt!="boolean")throw Error("Invalid boolean");return tt};var props$4=Object.freeze({__proto__:null,schema:schema$4,sanitize:sanitize$5});const StyledInputWrapper=styled("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function Boolean$1({value:tt,onUpdate:_e,id:rt,disabled:it}){return React.createElement(StyledInputWrapper,null,React.createElement("input",{id:rt,type:"checkbox",checked:tt,onChange:nt=>_e(nt.currentTarget.checked),disabled:it}),React.createElement("label",{htmlFor:rt},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function BooleanComponent(){const{label:tt,value:_e,onUpdate:rt,disabled:it,id:nt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Boolean$1,{value:_e,onUpdate:rt,id:nt,disabled:it}))}var boolean=_objectSpread2({component:BooleanComponent},props$4);const _excluded$1$1=["locked"];function Coordinate({value:tt,id:_e,valueKey:rt,settings:it,onUpdate:nt,innerLabelTrim:st}){const at=reactExports.useRef(tt[rt]);at.current=tt[rt];const lt=reactExports.useCallback(ct=>nt({[rt]:sanitizeValue({type:"NUMBER",value:at.current,settings:it},ct)}),[nt,it,rt]),ot=useInputSetters({type:"NUMBER",value:tt[rt],settings:it,setValue:lt});return React.createElement(Number$1,{id:_e,label:rt,value:tt[rt],displayValue:ot.displayValue,onUpdate:ot.onUpdate,onChange:ot.onChange,settings:it,innerLabelTrim:st})}const Container$2=styled("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function Lock(tt){let{locked:_e}=tt,rt=_objectWithoutProperties$1(tt,_excluded$1$1);return React.createElement("svg",_extends({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},rt),_e?React.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):React.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function Vector({value:tt,onUpdate:_e,settings:rt,innerLabelTrim:it}){const{id:nt,setSettings:st}=useInputContext(),{lock:at,locked:lt}=rt;return React.createElement(Container$2,{withLock:at},at&&React.createElement(Lock,{locked:lt,onClick:()=>st({locked:!lt})}),Object.keys(tt).map((ot,ct)=>React.createElement(Coordinate,{id:ct===0?nt:`${nt}.${ot}`,key:ot,valueKey:ot,value:tt,settings:rt[ot],onUpdate:_e,innerLabelTrim:it})))}const normalizeKeyedNumberSettings=(tt,_e)=>{const rt={};let it=0,nt=1/0;Object.entries(tt).forEach(([st,at])=>{rt[st]=normalize$2$1(_objectSpread2({value:at},_e[st])).settings,it=Math.max(it,rt[st].step),nt=Math.min(nt,rt[st].pad)});for(let st in rt){const{step:at,min:lt,max:ot}=_e[st]||{};!isFinite(at)&&(!isFinite(lt)||!isFinite(ot))&&(rt[st].step=it,rt[st].pad=nt)}return rt},_excluded$b=["lock"],_excluded2$5=["value"];function getVectorSchema(tt){const _e=v8n().array().length(tt).every.number(),rt=it=>{if(!it||typeof it!="object")return!1;const nt=Object.values(it);return nt.length===tt&&nt.every(st=>isFinite(st))};return it=>_e.test(it)||rt(it)}function getVectorType(tt){return Array.isArray(tt)?"array":"object"}function convert$1(tt,_e,rt){return getVectorType(tt)===_e?tt:_e==="array"?Object.values(tt):mapArrayToKeys(tt,rt)}const sanitizeVector=(tt,_e,rt)=>{const it=convert$1(tt,"object",_e.keys);for(let at in it)it[at]=sanitize$3(it[at],_e[at]);const nt=Object.keys(it);let st={};if(nt.length===_e.keys.length)st=it;else{const at=convert$1(rt,"object",_e.keys);if(nt.length===1&&_e.locked){const lt=nt[0],ot=it[lt],ct=at[lt],ut=ct!==0?ot/ct:1;for(let ht in at)ht===lt?st[lt]=ot:st[ht]=at[ht]*ut}else st=_objectSpread2(_objectSpread2({},at),it)}return convert$1(st,_e.format,_e.keys)},formatVector=(tt,_e)=>convert$1(tt,"object",_e.keys),isNumberSettings=tt=>!!tt&&("step"in tt||"min"in tt||"max"in tt);function normalizeVector(tt,_e,rt=[]){const{lock:it=!1}=_e,nt=_objectWithoutProperties$1(_e,_excluded$b),st=Array.isArray(tt)?"array":"object",at=st==="object"?Object.keys(tt):rt,lt=convert$1(tt,"object",at),ot=isNumberSettings(nt)?at.reduce((ut,ht)=>Object.assign(ut,{[ht]:nt}),{}):nt,ct=normalizeKeyedNumberSettings(lt,ot);return{value:st==="array"?tt:lt,settings:_objectSpread2(_objectSpread2({},ct),{},{format:st,keys:at,lock:it,locked:!1})}}function getVectorPlugin(tt){return{schema:getVectorSchema(tt.length),normalize:_e=>{let{value:rt}=_e,it=_objectWithoutProperties$1(_e,_excluded2$5);return normalizeVector(rt,it,tt)},format:(_e,rt)=>formatVector(_e,rt),sanitize:(_e,rt,it)=>sanitizeVector(_e,rt,it)}}var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(tt){return typeof tt=="string"?tt.length>0:typeof tt=="number"},n=function(tt,_e,rt){return _e===void 0&&(_e=0),rt===void 0&&(rt=Math.pow(10,_e)),Math.round(rt*tt)/rt+0},e=function(tt,_e,rt){return _e===void 0&&(_e=0),rt===void 0&&(rt=1),tt>rt?rt:tt>_e?tt:_e},u$1=function(tt){return(tt=isFinite(tt)?tt%360:0)>0?tt:tt+360},a=function(tt){return{r:e(tt.r,0,255),g:e(tt.g,0,255),b:e(tt.b,0,255),a:e(tt.a)}},o=function(tt){return{r:n(tt.r),g:n(tt.g),b:n(tt.b),a:n(tt.a,3)}},i$1=/^#([0-9a-f]{3,8})$/i,s$1=function(tt){var _e=tt.toString(16);return _e.length<2?"0"+_e:_e},h$1=function(tt){var _e=tt.r,rt=tt.g,it=tt.b,nt=tt.a,st=Math.max(_e,rt,it),at=st-Math.min(_e,rt,it),lt=at?st===_e?(rt-it)/at:st===rt?2+(it-_e)/at:4+(_e-rt)/at:0;return{h:60*(lt<0?lt+6:lt),s:st?at/st*100:0,v:st/255*100,a:nt}},b$1=function(tt){var _e=tt.h,rt=tt.s,it=tt.v,nt=tt.a;_e=_e/360*6,rt/=100,it/=100;var st=Math.floor(_e),at=it*(1-rt),lt=it*(1-(_e-st)*rt),ot=it*(1-(1-_e+st)*rt),ct=st%6;return{r:255*[it,lt,at,at,ot,it][ct],g:255*[ot,it,it,lt,at,at][ct],b:255*[at,at,ot,it,it,lt][ct],a:nt}},g$1=function(tt){return{h:u$1(tt.h),s:e(tt.s,0,100),l:e(tt.l,0,100),a:e(tt.a)}},d$1=function(tt){return{h:n(tt.h),s:n(tt.s),l:n(tt.l),a:n(tt.a,3)}},f$1=function(tt){return b$1((rt=(_e=tt).s,{h:_e.h,s:(rt*=((it=_e.l)<50?it:100-it)/100)>0?2*rt/(it+rt)*100:0,v:it+rt,a:_e.a}));var _e,rt,it},c$1=function(tt){return{h:(_e=h$1(tt)).h,s:(nt=(200-(rt=_e.s))*(it=_e.v)/100)>0&&nt<200?rt*it/100/(nt<=100?nt:200-nt)*100:0,l:nt/2,a:_e.a};var _e,rt,it,nt},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p$1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y$1={string:[[function(tt){var _e=i$1.exec(tt);return _e?(tt=_e[1]).length<=4?{r:parseInt(tt[0]+tt[0],16),g:parseInt(tt[1]+tt[1],16),b:parseInt(tt[2]+tt[2],16),a:tt.length===4?n(parseInt(tt[3]+tt[3],16)/255,2):1}:tt.length===6||tt.length===8?{r:parseInt(tt.substr(0,2),16),g:parseInt(tt.substr(2,2),16),b:parseInt(tt.substr(4,2),16),a:tt.length===8?n(parseInt(tt.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(tt){var _e=v$1.exec(tt)||m$1.exec(tt);return _e?_e[2]!==_e[4]||_e[4]!==_e[6]?null:a({r:Number(_e[1])/(_e[2]?100/255:1),g:Number(_e[3])/(_e[4]?100/255:1),b:Number(_e[5])/(_e[6]?100/255:1),a:_e[7]===void 0?1:Number(_e[7])/(_e[8]?100:1)}):null},"rgb"],[function(tt){var _e=l.exec(tt)||p$1.exec(tt);if(!_e)return null;var rt,it,nt=g$1({h:(rt=_e[1],it=_e[2],it===void 0&&(it="deg"),Number(rt)*(r[it]||1)),s:Number(_e[3]),l:Number(_e[4]),a:_e[5]===void 0?1:Number(_e[5])/(_e[6]?100:1)});return f$1(nt)},"hsl"]],object:[[function(tt){var _e=tt.r,rt=tt.g,it=tt.b,nt=tt.a,st=nt===void 0?1:nt;return t(_e)&&t(rt)&&t(it)?a({r:Number(_e),g:Number(rt),b:Number(it),a:Number(st)}):null},"rgb"],[function(tt){var _e=tt.h,rt=tt.s,it=tt.l,nt=tt.a,st=nt===void 0?1:nt;if(!t(_e)||!t(rt)||!t(it))return null;var at=g$1({h:Number(_e),s:Number(rt),l:Number(it),a:Number(st)});return f$1(at)},"hsl"],[function(tt){var _e=tt.h,rt=tt.s,it=tt.v,nt=tt.a,st=nt===void 0?1:nt;if(!t(_e)||!t(rt)||!t(it))return null;var at=function(lt){return{h:u$1(lt.h),s:e(lt.s,0,100),v:e(lt.v,0,100),a:e(lt.a)}}({h:Number(_e),s:Number(rt),v:Number(it),a:Number(st)});return b$1(at)},"hsv"]]},N=function(tt,_e){for(var rt=0;rt<_e.length;rt++){var it=_e[rt][0](tt);if(it)return[it,_e[rt][1]]}return[null,void 0]},x=function(tt){return typeof tt=="string"?N(tt.trim(),y$1.string):typeof tt=="object"&&tt!==null?N(tt,y$1.object):[null,void 0]},I$1=function(tt){return x(tt)[1]},M=function(tt,_e){var rt=c$1(tt);return{h:rt.h,s:e(rt.s+100*_e,0,100),l:rt.l,a:rt.a}},H=function(tt){return(299*tt.r+587*tt.g+114*tt.b)/1e3/255},$$1=function(tt,_e){var rt=c$1(tt);return{h:rt.h,s:rt.s,l:e(rt.l+100*_e,0,100),a:rt.a}},j=function(){function tt(_e){this.parsed=x(_e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return tt.prototype.isValid=function(){return this.parsed!==null},tt.prototype.brightness=function(){return n(H(this.rgba),2)},tt.prototype.isDark=function(){return H(this.rgba)<.5},tt.prototype.isLight=function(){return H(this.rgba)>=.5},tt.prototype.toHex=function(){return _e=o(this.rgba),rt=_e.r,it=_e.g,nt=_e.b,at=(st=_e.a)<1?s$1(n(255*st)):"","#"+s$1(rt)+s$1(it)+s$1(nt)+at;var _e,rt,it,nt,st,at},tt.prototype.toRgb=function(){return o(this.rgba)},tt.prototype.toRgbString=function(){return _e=o(this.rgba),rt=_e.r,it=_e.g,nt=_e.b,(st=_e.a)<1?"rgba("+rt+", "+it+", "+nt+", "+st+")":"rgb("+rt+", "+it+", "+nt+")";var _e,rt,it,nt,st},tt.prototype.toHsl=function(){return d$1(c$1(this.rgba))},tt.prototype.toHslString=function(){return _e=d$1(c$1(this.rgba)),rt=_e.h,it=_e.s,nt=_e.l,(st=_e.a)<1?"hsla("+rt+", "+it+"%, "+nt+"%, "+st+")":"hsl("+rt+", "+it+"%, "+nt+"%)";var _e,rt,it,nt,st},tt.prototype.toHsv=function(){return _e=h$1(this.rgba),{h:n(_e.h),s:n(_e.s),v:n(_e.v),a:n(_e.a,3)};var _e},tt.prototype.invert=function(){return w({r:255-(_e=this.rgba).r,g:255-_e.g,b:255-_e.b,a:_e.a});var _e},tt.prototype.saturate=function(_e){return _e===void 0&&(_e=.1),w(M(this.rgba,_e))},tt.prototype.desaturate=function(_e){return _e===void 0&&(_e=.1),w(M(this.rgba,-_e))},tt.prototype.grayscale=function(){return w(M(this.rgba,-1))},tt.prototype.lighten=function(_e){return _e===void 0&&(_e=.1),w($$1(this.rgba,_e))},tt.prototype.darken=function(_e){return _e===void 0&&(_e=.1),w($$1(this.rgba,-_e))},tt.prototype.rotate=function(_e){return _e===void 0&&(_e=15),this.hue(this.hue()+_e)},tt.prototype.alpha=function(_e){return typeof _e=="number"?w({r:(rt=this.rgba).r,g:rt.g,b:rt.b,a:_e}):n(this.rgba.a,3);var rt},tt.prototype.hue=function(_e){var rt=c$1(this.rgba);return typeof _e=="number"?w({h:_e,s:rt.s,l:rt.l,a:rt.a}):n(rt.h)},tt.prototype.isEqual=function(_e){return this.toHex()===w(_e).toHex()},tt}(),w=function(tt){return tt instanceof j?tt:new j(tt)},S$1=[],k$1=function(tt){tt.forEach(function(_e){S$1.indexOf(_e)<0&&(_e(j,y$1),S$1.push(_e))})};function namesPlugin(tt,_e){var rt={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},it={};for(var nt in rt)it[rt[nt]]=nt;var st={};tt.prototype.toName=function(at){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var lt,ot,ct=it[this.toHex()];if(ct)return ct;if(at!=null&&at.closest){var ut=this.toRgb(),ht=1/0,dt="black";if(!st.length)for(var pt in rt)st[pt]=new tt(rt[pt]).toRgb();for(var ft in rt){var gt=(lt=ut,ot=st[ft],Math.pow(lt.r-ot.r,2)+Math.pow(lt.g-ot.g,2)+Math.pow(lt.b-ot.b,2));gt<ht&&(ht=gt,dt=ft)}return dt}},_e.string.push([function(at){var lt=at.toLowerCase(),ot=lt==="transparent"?"#0000":rt[lt];return ot?new tt(ot).toRgb():null},"name"])}function u(){return(u=Object.assign||function(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];for(var it in rt)Object.prototype.hasOwnProperty.call(rt,it)&&(tt[it]=rt[it])}return tt}).apply(this,arguments)}function c(tt,_e){if(tt==null)return{};var rt,it,nt={},st=Object.keys(tt);for(it=0;it<st.length;it++)_e.indexOf(rt=st[it])>=0||(nt[rt]=tt[rt]);return nt}function i(tt){var _e=reactExports.useRef(tt),rt=reactExports.useRef(function(it){_e.current&&_e.current(it)});return _e.current=tt,rt.current}var s=function(tt,_e,rt){return _e===void 0&&(_e=0),rt===void 0&&(rt=1),tt>rt?rt:tt<_e?_e:tt},f=function(tt){return"touches"in tt},v=function(tt){return tt&&tt.ownerDocument.defaultView||self},d=function(tt,_e,rt){var it=tt.getBoundingClientRect(),nt=f(_e)?function(st,at){for(var lt=0;lt<st.length;lt++)if(st[lt].identifier===at)return st[lt];return st[0]}(_e.touches,rt):_e;return{left:s((nt.pageX-(it.left+v(tt).pageXOffset))/it.width),top:s((nt.pageY-(it.top+v(tt).pageYOffset))/it.height)}},h=function(tt){!f(tt)&&tt.preventDefault()},m=React.memo(function(tt){var _e=tt.onMove,rt=tt.onKey,it=c(tt,["onMove","onKey"]),nt=reactExports.useRef(null),st=i(_e),at=i(rt),lt=reactExports.useRef(null),ot=reactExports.useRef(!1),ct=reactExports.useMemo(function(){var pt=function(mt){h(mt),(f(mt)?mt.touches.length>0:mt.buttons>0)&&nt.current?st(d(nt.current,mt,lt.current)):gt(!1)},ft=function(){return gt(!1)};function gt(mt){var At=ot.current,yt=v(nt.current),bt=mt?yt.addEventListener:yt.removeEventListener;bt(At?"touchmove":"mousemove",pt),bt(At?"touchend":"mouseup",ft)}return[function(mt){var At=mt.nativeEvent,yt=nt.current;if(yt&&(h(At),!function(xt,vt){return vt&&!f(xt)}(At,ot.current)&&yt)){if(f(At)){ot.current=!0;var bt=At.changedTouches||[];bt.length&&(lt.current=bt[0].identifier)}yt.focus(),st(d(yt,At,lt.current)),gt(!0)}},function(mt){var At=mt.which||mt.keyCode;At<37||At>40||(mt.preventDefault(),at({left:At===39?.05:At===37?-.05:0,top:At===40?.05:At===38?-.05:0}))},gt]},[at,st]),ut=ct[0],ht=ct[1],dt=ct[2];return reactExports.useEffect(function(){return dt},[dt]),React.createElement("div",u({},it,{onTouchStart:ut,onMouseDown:ut,className:"react-colorful__interactive",ref:nt,onKeyDown:ht,tabIndex:0,role:"slider"}))}),g=function(tt){return tt.filter(Boolean).join(" ")},p=function(tt){var _e=tt.color,rt=tt.left,it=tt.top,nt=it===void 0?.5:it,st=g(["react-colorful__pointer",tt.className]);return React.createElement("div",{className:st,style:{top:100*nt+"%",left:100*rt+"%"}},React.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:_e}}))},b=function(tt,_e,rt){return _e===void 0&&(_e=0),rt===void 0&&(rt=Math.pow(10,_e)),Math.round(rt*tt)/rt},y=function(tt){var _e=tt.s,rt=tt.v,it=tt.a,nt=(200-_e)*rt/100;return{h:b(tt.h),s:b(nt>0&&nt<200?_e*rt/100/(nt<=100?nt:200-nt)*100:0),l:b(nt/2),a:b(it,2)}},q=function(tt){var _e=y(tt);return"hsl("+_e.h+", "+_e.s+"%, "+_e.l+"%)"},k=function(tt){var _e=y(tt);return"hsla("+_e.h+", "+_e.s+"%, "+_e.l+"%, "+_e.a+")"},I=function(tt){var _e=tt.h,rt=tt.s,it=tt.v,nt=tt.a;_e=_e/360*6,rt/=100,it/=100;var st=Math.floor(_e),at=it*(1-rt),lt=it*(1-(_e-st)*rt),ot=it*(1-(1-_e+st)*rt),ct=st%6;return{r:b(255*[it,lt,at,at,ot,it][ct]),g:b(255*[ot,it,it,lt,at,at][ct]),b:b(255*[at,at,ot,it,it,lt][ct]),a:b(nt,2)}},L=function(tt){var _e=tt.r,rt=tt.g,it=tt.b,nt=tt.a,st=Math.max(_e,rt,it),at=st-Math.min(_e,rt,it),lt=at?st===_e?(rt-it)/at:st===rt?2+(it-_e)/at:4+(_e-rt)/at:0;return{h:b(60*(lt<0?lt+6:lt)),s:b(st?at/st*100:0),v:b(st/255*100),a:nt}},S=React.memo(function(tt){var _e=tt.hue,rt=tt.onChange,it=g(["react-colorful__hue",tt.className]);return React.createElement("div",{className:it},React.createElement(m,{onMove:function(nt){rt({h:360*nt.left})},onKey:function(nt){rt({h:s(_e+360*nt.left,0,360)})},"aria-label":"Hue","aria-valuenow":b(_e),"aria-valuemax":"360","aria-valuemin":"0"},React.createElement(p,{className:"react-colorful__hue-pointer",left:_e/360,color:q({h:_e,s:100,v:100,a:1})})))}),T=React.memo(function(tt){var _e=tt.hsva,rt=tt.onChange,it={backgroundColor:q({h:_e.h,s:100,v:100,a:1})};return React.createElement("div",{className:"react-colorful__saturation",style:it},React.createElement(m,{onMove:function(nt){rt({s:100*nt.left,v:100-100*nt.top})},onKey:function(nt){rt({s:s(_e.s+100*nt.left,0,100),v:s(_e.v-100*nt.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+b(_e.s)+"%, Brightness "+b(_e.v)+"%"},React.createElement(p,{className:"react-colorful__saturation-pointer",top:1-_e.v/100,left:_e.s/100,color:q(_e)})))}),F=function(tt,_e){if(tt===_e)return!0;for(var rt in tt)if(tt[rt]!==_e[rt])return!1;return!0};function Y(tt,_e,rt){var it=i(rt),nt=reactExports.useState(function(){return tt.toHsva(_e)}),st=nt[0],at=nt[1],lt=reactExports.useRef({color:_e,hsva:st});reactExports.useEffect(function(){if(!tt.equal(_e,lt.current.color)){var ct=tt.toHsva(_e);lt.current={hsva:ct,color:_e},at(ct)}},[_e,tt]),reactExports.useEffect(function(){var ct;F(st,lt.current.hsva)||tt.equal(ct=tt.fromHsva(st),lt.current.color)||(lt.current={hsva:st,color:ct},it(ct))},[st,tt,it]);var ot=reactExports.useCallback(function(ct){at(function(ut){return Object.assign({},ut,ct)})},[]);return[st,ot]}var V=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,$=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},J=new Map,Q=function(tt){V(function(){var _e=tt.current?tt.current.ownerDocument:document;if(_e!==void 0&&!J.has(_e)){var rt=_e.createElement("style");rt.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,J.set(_e,rt);var it=$();it&&rt.setAttribute("nonce",it),_e.head.appendChild(rt)}},[])},U=function(tt){var _e=tt.className,rt=tt.colorModel,it=tt.color,nt=it===void 0?rt.defaultColor:it,st=tt.onChange,at=c(tt,["className","colorModel","color","onChange"]),lt=reactExports.useRef(null);Q(lt);var ot=Y(rt,nt,st),ct=ot[0],ut=ot[1],ht=g(["react-colorful",_e]);return React.createElement("div",u({},at,{ref:lt,className:ht}),React.createElement(T,{hsva:ct,onChange:ut}),React.createElement(S,{hue:ct.h,onChange:ut,className:"react-colorful__last-control"}))},ee=function(tt){var _e=tt.className,rt=tt.hsva,it=tt.onChange,nt={backgroundImage:"linear-gradient(90deg, "+k(Object.assign({},rt,{a:0}))+", "+k(Object.assign({},rt,{a:1}))+")"},st=g(["react-colorful__alpha",_e]),at=b(100*rt.a);return React.createElement("div",{className:st},React.createElement("div",{className:"react-colorful__alpha-gradient",style:nt}),React.createElement(m,{onMove:function(lt){it({a:lt.left})},onKey:function(lt){it({a:s(rt.a+lt.left)})},"aria-label":"Alpha","aria-valuetext":at+"%","aria-valuenow":at,"aria-valuemin":"0","aria-valuemax":"100"},React.createElement(p,{className:"react-colorful__alpha-pointer",left:rt.a,color:k(rt)})))},re=function(tt){var _e=tt.className,rt=tt.colorModel,it=tt.color,nt=it===void 0?rt.defaultColor:it,st=tt.onChange,at=c(tt,["className","colorModel","color","onChange"]),lt=reactExports.useRef(null);Q(lt);var ot=Y(rt,nt,st),ct=ot[0],ut=ot[1],ht=g(["react-colorful",_e]);return React.createElement("div",u({},at,{ref:lt,className:ht}),React.createElement(T,{hsva:ct,onChange:ut}),React.createElement(S,{hue:ct.h,onChange:ut}),React.createElement(ee,{hsva:ct,onChange:ut,className:"react-colorful__last-control"}))},xe={defaultColor:{r:0,g:0,b:0,a:1},toHsva:L,fromHsva:I,equal:F},Ce=function(tt){return React.createElement(re,u({},tt,{colorModel:xe}))},Me={defaultColor:{r:0,g:0,b:0},toHsva:function(tt){return L({r:tt.r,g:tt.g,b:tt.b,a:1})},fromHsva:function(tt){return{r:(_e=I(tt)).r,g:_e.g,b:_e.b};var _e},equal:F},Ne=function(tt){return React.createElement(U,u({},tt,{colorModel:Me}))};function __awaiter(tt,_e,rt,it){function nt(st){return st instanceof rt?st:new rt(function(at){at(st)})}return new(rt||(rt=Promise))(function(st,at){function lt(ut){try{ct(it.next(ut))}catch(ht){at(ht)}}function ot(ut){try{ct(it.throw(ut))}catch(ht){at(ht)}}function ct(ut){ut.done?st(ut.value):nt(ut.value).then(lt,ot)}ct((it=it.apply(tt,_e||[])).next())})}function __generator(tt,_e){var rt={label:0,sent:function(){if(st[0]&1)throw st[1];return st[1]},trys:[],ops:[]},it,nt,st,at;return at={next:lt(0),throw:lt(1),return:lt(2)},typeof Symbol=="function"&&(at[Symbol.iterator]=function(){return this}),at;function lt(ct){return function(ut){return ot([ct,ut])}}function ot(ct){if(it)throw new TypeError("Generator is already executing.");for(;at&&(at=0,ct[0]&&(rt=0)),rt;)try{if(it=1,nt&&(st=ct[0]&2?nt.return:ct[0]?nt.throw||((st=nt.return)&&st.call(nt),0):nt.next)&&!(st=st.call(nt,ct[1])).done)return st;switch(nt=0,st&&(ct=[ct[0]&2,st.value]),ct[0]){case 0:case 1:st=ct;break;case 4:return rt.label++,{value:ct[1],done:!1};case 5:rt.label++,nt=ct[1],ct=[0];continue;case 7:ct=rt.ops.pop(),rt.trys.pop();continue;default:if(st=rt.trys,!(st=st.length>0&&st[st.length-1])&&(ct[0]===6||ct[0]===2)){rt=0;continue}if(ct[0]===3&&(!st||ct[1]>st[0]&&ct[1]<st[3])){rt.label=ct[1];break}if(ct[0]===6&&rt.label<st[1]){rt.label=st[1],st=ct;break}if(st&&rt.label<st[2]){rt.label=st[2],rt.ops.push(ct);break}st[2]&&rt.ops.pop(),rt.trys.pop();continue}ct=_e.call(tt,rt)}catch(ut){ct=[6,ut],nt=0}finally{it=st=0}if(ct[0]&5)throw ct[1];return{value:ct[0]?ct[1]:void 0,done:!0}}}function __read(tt,_e){var rt=typeof Symbol=="function"&&tt[Symbol.iterator];if(!rt)return tt;var it=rt.call(tt),nt,st=[],at;try{for(;(_e===void 0||_e-- >0)&&!(nt=it.next()).done;)st.push(nt.value)}catch(lt){at={error:lt}}finally{try{nt&&!nt.done&&(rt=it.return)&&rt.call(it)}finally{if(at)throw at.error}}return st}function __spread(){for(var tt=[],_e=0;_e<arguments.length;_e++)tt=tt.concat(__read(arguments[_e]));return tt}typeof SuppressedError=="function"&&SuppressedError;var COMMON_MIME_TYPES=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function toFileWithPath(tt,_e){var rt=withMimeType(tt);if(typeof rt.path!="string"){var it=tt.webkitRelativePath;Object.defineProperty(rt,"path",{value:typeof _e=="string"?_e:typeof it=="string"&&it.length>0?it:tt.name,writable:!1,configurable:!1,enumerable:!0})}return rt}function withMimeType(tt){var _e=tt.name,rt=_e&&_e.lastIndexOf(".")!==-1;if(rt&&!tt.type){var it=_e.split(".").pop().toLowerCase(),nt=COMMON_MIME_TYPES.get(it);nt&&Object.defineProperty(tt,"type",{value:nt,writable:!1,configurable:!1,enumerable:!0})}return tt}var FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(tt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return isObject$8(tt)&&isDataTransfer(tt)?[2,getDataTransferFiles(tt.dataTransfer,tt.type)]:isChangeEvt(tt)?[2,getInputFiles(tt)]:Array.isArray(tt)&&tt.every(function(rt){return"getFile"in rt&&typeof rt.getFile=="function"})?[2,getFsHandleFiles(tt)]:[2,[]]})})}function isDataTransfer(tt){return isObject$8(tt.dataTransfer)}function isChangeEvt(tt){return isObject$8(tt)&&isObject$8(tt.target)}function isObject$8(tt){return typeof tt=="object"&&tt!==null}function getInputFiles(tt){return fromList(tt.target.files).map(function(_e){return toFileWithPath(_e)})}function getFsHandleFiles(tt){return __awaiter(this,void 0,void 0,function(){var _e;return __generator(this,function(rt){switch(rt.label){case 0:return[4,Promise.all(tt.map(function(it){return it.getFile()}))];case 1:return _e=rt.sent(),[2,_e.map(function(it){return toFileWithPath(it)})]}})})}function getDataTransferFiles(tt,_e){return __awaiter(this,void 0,void 0,function(){var rt,it;return __generator(this,function(nt){switch(nt.label){case 0:return tt===null?[2,[]]:tt.items?(rt=fromList(tt.items).filter(function(st){return st.kind==="file"}),_e!=="drop"?[2,rt]:[4,Promise.all(rt.map(toFilePromises))]):[3,2];case 1:return it=nt.sent(),[2,noIgnoredFiles(flatten(it))];case 2:return[2,noIgnoredFiles(fromList(tt.files).map(function(st){return toFileWithPath(st)}))]}})})}function noIgnoredFiles(tt){return tt.filter(function(_e){return FILES_TO_IGNORE.indexOf(_e.name)===-1})}function fromList(tt){if(tt===null)return[];for(var _e=[],rt=0;rt<tt.length;rt++){var it=tt[rt];_e.push(it)}return _e}function toFilePromises(tt){if(typeof tt.webkitGetAsEntry!="function")return fromDataTransferItem(tt);var _e=tt.webkitGetAsEntry();return _e&&_e.isDirectory?fromDirEntry(_e):fromDataTransferItem(tt)}function flatten(tt){return tt.reduce(function(_e,rt){return __spread(_e,Array.isArray(rt)?flatten(rt):[rt])},[])}function fromDataTransferItem(tt){var _e=tt.getAsFile();if(!_e)return Promise.reject(tt+" is not a File");var rt=toFileWithPath(_e);return Promise.resolve(rt)}function fromEntry(tt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return[2,tt.isDirectory?fromDirEntry(tt):fromFileEntry(tt)]})})}function fromDirEntry(tt){var _e=tt.createReader();return new Promise(function(rt,it){var nt=[];function st(){var at=this;_e.readEntries(function(lt){return __awaiter(at,void 0,void 0,function(){var ot,ct,ut;return __generator(this,function(ht){switch(ht.label){case 0:if(lt.length)return[3,5];ht.label=1;case 1:return ht.trys.push([1,3,,4]),[4,Promise.all(nt)];case 2:return ot=ht.sent(),rt(ot),[3,4];case 3:return ct=ht.sent(),it(ct),[3,4];case 4:return[3,6];case 5:ut=Promise.all(lt.map(fromEntry)),nt.push(ut),st(),ht.label=6;case 6:return[2]}})})},function(lt){it(lt)})}st()})}function fromFileEntry(tt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_e){return[2,new Promise(function(rt,it){tt.file(function(nt){var st=toFileWithPath(nt,tt.fullPath);rt(st)},function(nt){it(nt)})})]})})}var _default=function(tt,_e){if(tt&&_e){var rt=Array.isArray(_e)?_e:_e.split(","),it=tt.name||"",nt=(tt.type||"").toLowerCase(),st=nt.replace(/\/.*$/,"");return rt.some(function(at){var lt=at.trim().toLowerCase();return lt.charAt(0)==="."?it.toLowerCase().endsWith(lt):lt.endsWith("/*")?st===lt.replace(/\/.*$/,""):nt===lt})}return!0};function ownKeys$1(tt,_e){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var it=Object.getOwnPropertySymbols(tt);_e&&(it=it.filter(function(nt){return Object.getOwnPropertyDescriptor(tt,nt).enumerable})),rt.push.apply(rt,it)}return rt}function _objectSpread$1(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys$1(Object(rt),!0).forEach(function(it){_defineProperty$2(tt,it,rt[it])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ownKeys$1(Object(rt)).forEach(function(it){Object.defineProperty(tt,it,Object.getOwnPropertyDescriptor(rt,it))})}return tt}function _defineProperty$2(tt,_e,rt){return _e in tt?Object.defineProperty(tt,_e,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[_e]=rt,tt}function _slicedToArray$1(tt,_e){return _arrayWithHoles$1(tt)||_iterableToArrayLimit$1(tt,_e)||_unsupportedIterableToArray$1(tt,_e)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(tt,_e){if(tt){if(typeof tt=="string")return _arrayLikeToArray$1(tt,_e);var rt=Object.prototype.toString.call(tt).slice(8,-1);if(rt==="Object"&&tt.constructor&&(rt=tt.constructor.name),rt==="Map"||rt==="Set")return Array.from(tt);if(rt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rt))return _arrayLikeToArray$1(tt,_e)}}function _arrayLikeToArray$1(tt,_e){(_e==null||_e>tt.length)&&(_e=tt.length);for(var rt=0,it=new Array(_e);rt<_e;rt++)it[rt]=tt[rt];return it}function _iterableToArrayLimit$1(tt,_e){var rt=tt==null?null:typeof Symbol<"u"&&tt[Symbol.iterator]||tt["@@iterator"];if(rt!=null){var it=[],nt=!0,st=!1,at,lt;try{for(rt=rt.call(tt);!(nt=(at=rt.next()).done)&&(it.push(at.value),!(_e&&it.length===_e));nt=!0);}catch(ot){st=!0,lt=ot}finally{try{!nt&&rt.return!=null&&rt.return()}finally{if(st)throw lt}}return it}}function _arrayWithHoles$1(tt){if(Array.isArray(tt))return tt}var FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function(_e){_e=Array.isArray(_e)&&_e.length===1?_e[0]:_e;var rt=Array.isArray(_e)?"one of ".concat(_e.join(", ")):_e;return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(rt)}},getTooLargeRejectionErr=function(_e){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(_e," ").concat(_e===1?"byte":"bytes")}},getTooSmallRejectionErr=function(_e){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(_e," ").concat(_e===1?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(tt,_e){var rt=tt.type==="application/x-moz-file"||_default(tt,_e);return[rt,rt?null:getInvalidTypeRejectionErr(_e)]}function fileMatchSize(tt,_e,rt){if(isDefined(tt.size))if(isDefined(_e)&&isDefined(rt)){if(tt.size>rt)return[!1,getTooLargeRejectionErr(rt)];if(tt.size<_e)return[!1,getTooSmallRejectionErr(_e)]}else{if(isDefined(_e)&&tt.size<_e)return[!1,getTooSmallRejectionErr(_e)];if(isDefined(rt)&&tt.size>rt)return[!1,getTooLargeRejectionErr(rt)]}return[!0,null]}function isDefined(tt){return tt!=null}function allFilesAccepted(tt){var _e=tt.files,rt=tt.accept,it=tt.minSize,nt=tt.maxSize,st=tt.multiple,at=tt.maxFiles;return!st&&_e.length>1||st&&at>=1&&_e.length>at?!1:_e.every(function(lt){var ot=fileAccepted(lt,rt),ct=_slicedToArray$1(ot,1),ut=ct[0],ht=fileMatchSize(lt,it,nt),dt=_slicedToArray$1(ht,1),pt=dt[0];return ut&&pt})}function isPropagationStopped(tt){return typeof tt.isPropagationStopped=="function"?tt.isPropagationStopped():typeof tt.cancelBubble<"u"?tt.cancelBubble:!1}function isEvtWithFiles(tt){return tt.dataTransfer?Array.prototype.some.call(tt.dataTransfer.types,function(_e){return _e==="Files"||_e==="application/x-moz-file"}):!!tt.target&&!!tt.target.files}function onDocumentDragOver(tt){tt.preventDefault()}function isIe(tt){return tt.indexOf("MSIE")!==-1||tt.indexOf("Trident/")!==-1}function isEdge(tt){return tt.indexOf("Edge/")!==-1}function isIeOrEdge(){var tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return isIe(tt)||isEdge(tt)}function composeEventHandlers(){for(var tt=arguments.length,_e=new Array(tt),rt=0;rt<tt;rt++)_e[rt]=arguments[rt];return function(it){for(var nt=arguments.length,st=new Array(nt>1?nt-1:0),at=1;at<nt;at++)st[at-1]=arguments[at];return _e.some(function(lt){return!isPropagationStopped(it)&&lt&&lt.apply(void 0,[it].concat(st)),isPropagationStopped(it)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function filePickerOptionsTypes(tt){return tt=typeof tt=="string"?tt.split(","):tt,[{description:"everything",accept:Array.isArray(tt)?tt.filter(function(_e){return _e==="audio/*"||_e==="video/*"||_e==="image/*"||_e==="text/*"||/\w+\/[-+.\w]+/g.test(_e)}).reduce(function(_e,rt){return _objectSpread$1(_objectSpread$1({},_e),{},_defineProperty$2({},rt,[]))},{}):{}}]}function isAbort(tt){return tt instanceof DOMException&&(tt.name==="AbortError"||tt.code===tt.ABORT_ERR)}function isSecurityError(tt){return tt instanceof DOMException&&(tt.name==="SecurityError"||tt.code===tt.SECURITY_ERR)}var _excluded=["children"],_excluded2$2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray(tt){return _arrayWithoutHoles(tt)||_iterableToArray(tt)||_unsupportedIterableToArray(tt)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(tt){if(typeof Symbol<"u"&&tt[Symbol.iterator]!=null||tt["@@iterator"]!=null)return Array.from(tt)}function _arrayWithoutHoles(tt){if(Array.isArray(tt))return _arrayLikeToArray(tt)}function _slicedToArray(tt,_e){return _arrayWithHoles(tt)||_iterableToArrayLimit(tt,_e)||_unsupportedIterableToArray(tt,_e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(tt,_e){if(tt){if(typeof tt=="string")return _arrayLikeToArray(tt,_e);var rt=Object.prototype.toString.call(tt).slice(8,-1);if(rt==="Object"&&tt.constructor&&(rt=tt.constructor.name),rt==="Map"||rt==="Set")return Array.from(tt);if(rt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rt))return _arrayLikeToArray(tt,_e)}}function _arrayLikeToArray(tt,_e){(_e==null||_e>tt.length)&&(_e=tt.length);for(var rt=0,it=new Array(_e);rt<_e;rt++)it[rt]=tt[rt];return it}function _iterableToArrayLimit(tt,_e){var rt=tt==null?null:typeof Symbol<"u"&&tt[Symbol.iterator]||tt["@@iterator"];if(rt!=null){var it=[],nt=!0,st=!1,at,lt;try{for(rt=rt.call(tt);!(nt=(at=rt.next()).done)&&(it.push(at.value),!(_e&&it.length===_e));nt=!0);}catch(ot){st=!0,lt=ot}finally{try{!nt&&rt.return!=null&&rt.return()}finally{if(st)throw lt}}return it}}function _arrayWithHoles(tt){if(Array.isArray(tt))return tt}function ownKeys(tt,_e){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var it=Object.getOwnPropertySymbols(tt);_e&&(it=it.filter(function(nt){return Object.getOwnPropertyDescriptor(tt,nt).enumerable})),rt.push.apply(rt,it)}return rt}function _objectSpread(tt){for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e]!=null?arguments[_e]:{};_e%2?ownKeys(Object(rt),!0).forEach(function(it){_defineProperty$1(tt,it,rt[it])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ownKeys(Object(rt)).forEach(function(it){Object.defineProperty(tt,it,Object.getOwnPropertyDescriptor(rt,it))})}return tt}function _defineProperty$1(tt,_e,rt){return _e in tt?Object.defineProperty(tt,_e,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[_e]=rt,tt}function _objectWithoutProperties(tt,_e){if(tt==null)return{};var rt=_objectWithoutPropertiesLoose(tt,_e),it,nt;if(Object.getOwnPropertySymbols){var st=Object.getOwnPropertySymbols(tt);for(nt=0;nt<st.length;nt++)it=st[nt],!(_e.indexOf(it)>=0)&&Object.prototype.propertyIsEnumerable.call(tt,it)&&(rt[it]=tt[it])}return rt}function _objectWithoutPropertiesLoose(tt,_e){if(tt==null)return{};var rt={},it=Object.keys(tt),nt,st;for(st=0;st<it.length;st++)nt=it[st],!(_e.indexOf(nt)>=0)&&(rt[nt]=tt[nt]);return rt}var Dropzone=reactExports.forwardRef(function(tt,_e){var rt=tt.children,it=_objectWithoutProperties(tt,_excluded),nt=useDropzone(it),st=nt.open,at=_objectWithoutProperties(nt,_excluded2$2);return reactExports.useImperativeHandle(_e,function(){return{open:st}},[st]),React.createElement(reactExports.Fragment,null,rt(_objectSpread(_objectSpread({},at),{},{open:st})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};Dropzone.defaultProps=defaultProps;Dropzone.propTypes={children:PropTypes.func,accept:PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,validator:PropTypes.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function useDropzone(){var tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_e=_objectSpread(_objectSpread({},defaultProps),tt),rt=_e.accept,it=_e.disabled,nt=_e.getFilesFromEvent,st=_e.maxSize,at=_e.minSize,lt=_e.multiple,ot=_e.maxFiles,ct=_e.onDragEnter,ut=_e.onDragLeave,ht=_e.onDragOver,dt=_e.onDrop,pt=_e.onDropAccepted,ft=_e.onDropRejected,gt=_e.onFileDialogCancel,mt=_e.onFileDialogOpen,At=_e.useFsAccessApi,yt=_e.preventDropOnDocument,bt=_e.noClick,xt=_e.noKeyboard,vt=_e.noDrag,_t=_e.noDragEventsBubbling,Ct=_e.validator,St=reactExports.useMemo(function(){return typeof mt=="function"?mt:noop},[mt]),Et=reactExports.useMemo(function(){return typeof gt=="function"?gt:noop},[gt]),Tt=reactExports.useRef(null),Mt=reactExports.useRef(null),Rt=reactExports.useReducer(reducer,initialState),It=_slicedToArray(Rt,2),Ot=It[0],Bt=It[1],Nt=Ot.isFocused,zt=Ot.isFileDialogActive,Dt=Ot.draggedFiles,Ft=reactExports.useRef(typeof window<"u"&&window.isSecureContext&&At&&canUseFileSystemAccessAPI()),Ut=function(){!Ft.current&&zt&&setTimeout(function(){if(Mt.current){var Xt=Mt.current.files;Xt.length||(Bt({type:"closeDialog"}),Et())}},300)};reactExports.useEffect(function(){return window.addEventListener("focus",Ut,!1),function(){window.removeEventListener("focus",Ut,!1)}},[Mt,zt,Et,Ft]);var $t=reactExports.useRef([]),Vt=function(Xt){Tt.current&&Tt.current.contains(Xt.target)||(Xt.preventDefault(),$t.current=[])};reactExports.useEffect(function(){return yt&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",Vt,!1)),function(){yt&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",Vt))}},[Tt,yt]);var Zt=reactExports.useCallback(function(Qt){Qt.preventDefault(),Qt.persist(),Er(Qt),$t.current=[].concat(_toConsumableArray($t.current),[Qt.target]),isEvtWithFiles(Qt)&&Promise.resolve(nt(Qt)).then(function(Xt){isPropagationStopped(Qt)&&!_t||(Bt({draggedFiles:Xt,isDragActive:!0,type:"setDraggedFiles"}),ct&&ct(Qt))})},[nt,ct,_t]),qt=reactExports.useCallback(function(Qt){Qt.preventDefault(),Qt.persist(),Er(Qt);var Xt=isEvtWithFiles(Qt);if(Xt&&Qt.dataTransfer)try{Qt.dataTransfer.dropEffect="copy"}catch{}return Xt&&ht&&ht(Qt),!1},[ht,_t]),sr=reactExports.useCallback(function(Qt){Qt.preventDefault(),Qt.persist(),Er(Qt);var Xt=$t.current.filter(function(Lr){return Tt.current&&Tt.current.contains(Lr)}),xr=Xt.indexOf(Qt.target);xr!==-1&&Xt.splice(xr,1),$t.current=Xt,!(Xt.length>0)&&(Bt({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),isEvtWithFiles(Qt)&&ut&&ut(Qt))},[Tt,ut,_t]),er=reactExports.useCallback(function(Qt,Xt){var xr=[],Lr=[];Qt.forEach(function(fr){var pr=fileAccepted(fr,rt),Hr=_slicedToArray(pr,2),hr=Hr[0],Cr=Hr[1],tr=fileMatchSize(fr,at,st),Ar=_slicedToArray(tr,2),yr=Ar[0],Jt=Ar[1],_r=Ct?Ct(fr):null;if(hr&&yr&&!_r)xr.push(fr);else{var Kt=[Cr,Jt];_r&&(Kt=Kt.concat(_r)),Lr.push({file:fr,errors:Kt.filter(function(Qr){return Qr})})}}),(!lt&&xr.length>1||lt&&ot>=1&&xr.length>ot)&&(xr.forEach(function(fr){Lr.push({file:fr,errors:[TOO_MANY_FILES_REJECTION]})}),xr.splice(0)),Bt({acceptedFiles:xr,fileRejections:Lr,type:"setFiles"}),dt&&dt(xr,Lr,Xt),Lr.length>0&&ft&&ft(Lr,Xt),xr.length>0&&pt&&pt(xr,Xt)},[Bt,lt,rt,at,st,ot,dt,pt,ft,Ct]),ir=reactExports.useCallback(function(Qt){Qt.preventDefault(),Qt.persist(),Er(Qt),$t.current=[],isEvtWithFiles(Qt)&&Promise.resolve(nt(Qt)).then(function(Xt){isPropagationStopped(Qt)&&!_t||er(Xt,Qt)}),Bt({type:"reset"})},[nt,er,_t]),ur=reactExports.useCallback(function(){if(Ft.current){Bt({type:"openDialog"}),St();var Qt={multiple:lt,types:filePickerOptionsTypes(rt)};window.showOpenFilePicker(Qt).then(function(Xt){return nt(Xt)}).then(function(Xt){er(Xt,null),Bt({type:"closeDialog"})}).catch(function(Xt){isAbort(Xt)?(Et(Xt),Bt({type:"closeDialog"})):isSecurityError(Xt)&&(Ft.current=!1,Mt.current&&(Mt.current.value=null,Mt.current.click()))});return}Mt.current&&(Bt({type:"openDialog"}),St(),Mt.current.value=null,Mt.current.click())},[Bt,St,Et,At,er,rt,lt]),ar=reactExports.useCallback(function(Qt){!Tt.current||!Tt.current.isEqualNode(Qt.target)||(Qt.key===" "||Qt.key==="Enter"||Qt.keyCode===32||Qt.keyCode===13)&&(Qt.preventDefault(),ur())},[Tt,ur]),lr=reactExports.useCallback(function(){Bt({type:"focus"})},[]),gr=reactExports.useCallback(function(){Bt({type:"blur"})},[]),Yt=reactExports.useCallback(function(){bt||(isIeOrEdge()?setTimeout(ur,0):ur())},[bt,ur]),nr=function(Xt){return it?null:Xt},mr=function(Xt){return xt?null:nr(Xt)},Sr=function(Xt){return vt?null:nr(Xt)},Er=function(Xt){_t&&Xt.stopPropagation()},Nr=reactExports.useMemo(function(){return function(){var Qt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Xt=Qt.refKey,xr=Xt===void 0?"ref":Xt,Lr=Qt.role,fr=Qt.onKeyDown,pr=Qt.onFocus,Hr=Qt.onBlur,hr=Qt.onClick,Cr=Qt.onDragEnter,tr=Qt.onDragOver,Ar=Qt.onDragLeave,yr=Qt.onDrop,Jt=_objectWithoutProperties(Qt,_excluded3);return _objectSpread(_objectSpread(_defineProperty$1({onKeyDown:mr(composeEventHandlers(fr,ar)),onFocus:mr(composeEventHandlers(pr,lr)),onBlur:mr(composeEventHandlers(Hr,gr)),onClick:nr(composeEventHandlers(hr,Yt)),onDragEnter:Sr(composeEventHandlers(Cr,Zt)),onDragOver:Sr(composeEventHandlers(tr,qt)),onDragLeave:Sr(composeEventHandlers(Ar,sr)),onDrop:Sr(composeEventHandlers(yr,ir)),role:typeof Lr=="string"&&Lr!==""?Lr:"button"},xr,Tt),!it&&!xt?{tabIndex:0}:{}),Jt)}},[Tt,ar,lr,gr,Yt,Zt,qt,sr,ir,xt,vt,it]),wr=reactExports.useCallback(function(Qt){Qt.stopPropagation()},[]),kr=reactExports.useMemo(function(){return function(){var Qt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Xt=Qt.refKey,xr=Xt===void 0?"ref":Xt,Lr=Qt.onChange,fr=Qt.onClick,pr=_objectWithoutProperties(Qt,_excluded4),Hr=_defineProperty$1({accept:rt,multiple:lt,type:"file",style:{display:"none"},onChange:nr(composeEventHandlers(Lr,ir)),onClick:nr(composeEventHandlers(fr,wr)),tabIndex:-1},xr,Mt);return _objectSpread(_objectSpread({},Hr),pr)}},[Mt,rt,lt,ir,it]),Ur=Dt.length,Or=Ur>0&&allFilesAccepted({files:Dt,accept:rt,minSize:at,maxSize:st,multiple:lt,maxFiles:ot}),Xr=Ur>0&&!Or;return _objectSpread(_objectSpread({},Ot),{},{isDragAccept:Or,isDragReject:Xr,isFocused:Nt&&!it,getRootProps:Nr,getInputProps:kr,rootRef:Tt,inputRef:Mt,open:nr(ur)})}function reducer(tt,_e){switch(_e.type){case"focus":return _objectSpread(_objectSpread({},tt),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},tt),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},tt),{},{isFileDialogActive:!1});case"setDraggedFiles":var rt=_e.isDragActive,it=_e.draggedFiles;return _objectSpread(_objectSpread({},tt),{},{draggedFiles:it,isDragActive:rt});case"setFiles":return _objectSpread(_objectSpread({},tt),{},{acceptedFiles:_e.acceptedFiles,fileRejections:_e.fileRejections});case"reset":return _objectSpread({},initialState);default:return tt}}function noop(){}/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isobject=function(_e){return _e!=null&&typeof _e=="object"&&Array.isArray(_e)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isObject$7=isobject;function isObjectObject(tt){return isObject$7(tt)===!0&&Object.prototype.toString.call(tt)==="[object Object]"}var isPlainObject$2=function(_e){var rt,it;return!(isObjectObject(_e)===!1||(rt=_e.constructor,typeof rt!="function")||(it=rt.prototype,isObjectObject(it)===!1)||it.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isPlainObject$1=isPlainObject$2,isExtendable$4=function(_e){return isPlainObject$1(_e)||typeof _e=="function"||Array.isArray(_e)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var forIn$1=function(_e,rt,it){for(var nt in _e)if(rt.call(it,_e[nt],nt,_e)===!1)break},isExtendable$3=isExtendable$4,forIn=forIn$1;function mixinDeep(tt,_e){for(var rt=arguments.length,it=0;++it<rt;){var nt=arguments[it];isObject$6(nt)&&forIn(nt,copy,tt)}return tt}function copy(tt,_e){if(isValidKey$1(_e)){var rt=this[_e];isObject$6(tt)&&isObject$6(rt)?mixinDeep(rt,tt):this[_e]=tt}}function isObject$6(tt){return isExtendable$3(tt)&&!Array.isArray(tt)}function isValidKey$1(tt){return tt!=="__proto__"&&tt!=="constructor"&&tt!=="prototype"}var mixinDeep_1=mixinDeep;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var getValue$2=function(tt,_e,rt,it,nt){if(!isObject$5(tt)||!_e)return tt;if(_e=toString(_e),rt&&(_e+="."+toString(rt)),it&&(_e+="."+toString(it)),nt&&(_e+="."+toString(nt)),_e in tt)return tt[_e];for(var st=_e.split("."),at=st.length,lt=-1;tt&&++lt<at;){for(var ot=st[lt];ot[ot.length-1]==="\\";)ot=ot.slice(0,-1)+"."+st[++lt];tt=tt[ot]}return tt};function isObject$5(tt){return tt!==null&&(typeof tt=="object"||typeof tt=="function")}function toString(tt){return tt?Array.isArray(tt)?tt.join("."):tt:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var assignSymbols$1=function(tt,_e){if(tt===null||typeof tt>"u")throw new TypeError("expected first argument to be an object.");if(typeof _e>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return tt;for(var rt=Object.prototype.propertyIsEnumerable,it=Object(tt),nt=arguments.length,st=0;++st<nt;)for(var at=Object(arguments[st]),lt=Object.getOwnPropertySymbols(at),ot=0;ot<lt.length;ot++){var ct=lt[ot];rt.call(at,ct)&&(it[ct]=at[ct])}return it},isExtendable$2=isExtendable$4,assignSymbols=assignSymbols$1,extendShallow$1=Object.assign||function(tt){if(tt===null||typeof tt>"u")throw new TypeError("Cannot convert undefined or null to object");isObject$4(tt)||(tt={});for(var _e=1;_e<arguments.length;_e++){var rt=arguments[_e];isString(rt)&&(rt=toObject(rt)),isObject$4(rt)&&(assign$2(tt,rt),assignSymbols(tt,rt))}return tt};function assign$2(tt,_e){for(var rt in _e)hasOwn$1(_e,rt)&&(tt[rt]=_e[rt])}function isString(tt){return tt&&typeof tt=="string"}function toObject(tt){var _e={};for(var rt in tt)_e[rt]=tt[rt];return _e}function isObject$4(tt){return tt&&typeof tt=="object"||isExtendable$2(tt)}function hasOwn$1(tt,_e){return Object.prototype.hasOwnProperty.call(tt,_e)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var extend$1=extendShallow$1,splitString=function(tt,_e,rt){if(typeof tt!="string")throw new TypeError("expected a string");typeof _e=="function"&&(rt=_e,_e=null),typeof _e=="string"&&(_e={sep:_e});var it=extend$1({sep:"."},_e),nt=it.quotes||['"',"'","`"],st;it.brackets===!0?st={"<":">","(":")","[":"]","{":"}"}:it.brackets&&(st=it.brackets);var at=[],lt=[],ot=[""],ct=it.sep,ut=tt.length,ht=-1,dt;function pt(){if(st&&lt.length)return st[lt[lt.length-1]]}for(;++ht<ut;){var ft=tt[ht],gt=tt[ht+1],mt={val:ft,idx:ht,arr:ot,str:tt};if(at.push(mt),ft==="\\"){mt.val=keepEscaping(it,tt,ht)===!0?ft+gt:gt,mt.escaped=!0,typeof rt=="function"&&rt(mt),ot[ot.length-1]+=mt.val,ht++;continue}if(st&&st[ft]){lt.push(ft);var At=pt(),yt=ht+1;if(tt.indexOf(At,yt+1)!==-1)for(;lt.length&&yt<ut;){var bt=tt[++yt];if(bt==="\\"){bt++;continue}if(nt.indexOf(bt)!==-1){yt=getClosingQuote(tt,bt,yt+1);continue}if(At=pt(),lt.length&&tt.indexOf(At,yt+1)===-1)break;if(st[bt]){lt.push(bt);continue}At===bt&&lt.pop()}if(dt=yt,dt===-1){ot[ot.length-1]+=ft;continue}ft=tt.slice(ht,dt+1),mt.val=ft,mt.idx=ht=dt}if(nt.indexOf(ft)!==-1){if(dt=getClosingQuote(tt,ft,ht+1),dt===-1){ot[ot.length-1]+=ft;continue}keepQuotes(ft,it)===!0?ft=tt.slice(ht,dt+1):ft=tt.slice(ht+1,dt),mt.val=ft,mt.idx=ht=dt}if(typeof rt=="function"&&(rt(mt,at),ft=mt.val,ht=mt.idx),mt.val===ct&&mt.split!==!1){ot.push("");continue}ot[ot.length-1]+=mt.val}return ot};function getClosingQuote(tt,_e,rt,it){var nt=tt.indexOf(_e,rt);return tt.charAt(nt-1)==="\\"?getClosingQuote(tt,_e,nt+1):nt}function keepQuotes(tt,_e){return _e.keepDoubleQuotes===!0&&tt==='"'||_e.keepSingleQuotes===!0&&tt==="'"?!0:_e.keepQuotes}function keepEscaping(tt,_e,rt){return typeof tt.keepEscaping=="function"?tt.keepEscaping(_e,rt):tt.keepEscaping===!0||_e[rt+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable$1=function(_e){return typeof _e<"u"&&_e!==null&&(typeof _e=="object"||typeof _e=="function")},isObject$3=isExtendable$1,extendShallow=function(_e){isObject$3(_e)||(_e={});for(var rt=arguments.length,it=1;it<rt;it++){var nt=arguments[it];isObject$3(nt)&&assign$1(_e,nt)}return _e};function assign$1(tt,_e){for(var rt in _e)hasOwn(_e,rt)&&(tt[rt]=_e[rt])}function hasOwn(tt,_e){return Object.prototype.hasOwnProperty.call(tt,_e)}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable=function(_e){return typeof _e<"u"&&_e!==null&&(typeof _e=="object"||typeof _e=="function")};/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var split=splitString,extend=extendShallow,isPlainObject=isPlainObject$2,isObject$2=isExtendable,setValue=function(tt,_e,rt){if(!isObject$2(tt)||(Array.isArray(_e)&&(_e=[].concat.apply([],_e).join(".")),typeof _e!="string"))return tt;for(var it=split(_e,{sep:".",brackets:!0}).filter(isValidKey),nt=it.length,st=-1,at=tt;++st<nt;){var lt=it[st];if(st!==nt-1){isObject$2(at[lt])||(at[lt]={}),at=at[lt];continue}isPlainObject(at[lt])&&isPlainObject(rt)?at[lt]=extend({},at[lt],rt):at[lt]=rt}return tt};function isValidKey(tt){return tt!=="__proto__"&&tt!=="constructor"&&tt!=="prototype"}var isObject$1=isExtendable$4,merge=mixinDeep_1,get=getValue$2,set=setValue,mergeValue=function(_e,rt,it){if(!isObject$1(_e))throw new TypeError("expected an object");if(typeof rt!="string"||it==null)return merge.apply(null,arguments);if(typeof it=="string")return set(_e,rt,it),_e;var nt=get(_e,rt);return isObject$1(it)&&isObject$1(nt)&&(it=merge({},nt,it)),set(_e,rt,it),_e};const merge$1=getDefaultExportFromCjs(mergeValue),join=(...tt)=>tt.filter(Boolean).join(".");function getKeyPath(tt){const _e=tt.split(".");return[_e.pop(),_e.join(".")||void 0]}function getValuesForPaths(tt,_e){return Object.entries(pick(tt,_e)).reduce((rt,[,{value:it,disabled:nt,key:st}])=>(rt[st]=nt?void 0:it,rt),{})}function useCompareMemoize(tt,_e){const rt=reactExports.useRef();return(_e?dequal:shallow)(tt,rt.current)||(rt.current=tt),rt.current}function useDeepMemo(tt,_e){return reactExports.useMemo(tt,useCompareMemoize(_e,!0))}function useToggle(tt){const _e=reactExports.useRef(null),rt=reactExports.useRef(null),it=reactExports.useRef(!0);return reactExports.useLayoutEffect(()=>{tt||(_e.current.style.height="0px",_e.current.style.overflow="hidden")},[]),reactExports.useEffect(()=>{if(it.current){it.current=!1;return}let nt;const st=_e.current,at=()=>{tt&&(st.style.removeProperty("height"),st.style.removeProperty("overflow"),rt.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};st.addEventListener("transitionend",at,{once:!0});const{height:lt}=rt.current.getBoundingClientRect();return st.style.height=lt+"px",tt||(st.style.overflow="hidden",nt=window.setTimeout(()=>st.style.height="0px",50)),()=>{st.removeEventListener("transitionend",at),clearTimeout(nt)}},[tt]),{wrapperRef:_e,contentRef:rt}}const useVisiblePaths=tt=>{const[_e,rt]=reactExports.useState(tt.getVisiblePaths());return reactExports.useEffect(()=>{rt(tt.getVisiblePaths());const it=tt.useStore.subscribe(tt.getVisiblePaths,rt,{equalityFn:shallow});return()=>it()},[tt]),_e};function useValuesForPath(tt,_e,rt){return tt.useStore(nt=>{const st=_objectSpread2(_objectSpread2({},rt),nt.data);return getValuesForPaths(st,_e)},shallow)}function usePopin(tt=3){const _e=reactExports.useRef(null),rt=reactExports.useRef(null),[it,nt]=reactExports.useState(!1),st=reactExports.useCallback(()=>nt(!0),[]),at=reactExports.useCallback(()=>nt(!1),[]);return reactExports.useLayoutEffect(()=>{if(it){const{bottom:lt,top:ot,left:ct}=_e.current.getBoundingClientRect(),{height:ut}=rt.current.getBoundingClientRect(),ht=lt+ut>window.innerHeight-40?"up":"down";rt.current.style.position="fixed",rt.current.style.zIndex="10000",rt.current.style.left=ct+"px",ht==="down"?rt.current.style.top=lt+tt+"px":rt.current.style.bottom=window.innerHeight-ot+tt+"px"}},[tt,it]),{popinRef:_e,wrapperRef:rt,shown:it,show:st,hide:at}}k$1([namesPlugin]);const convertMap={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};v8n.extend({color:()=>tt=>w(tt).isValid()});const schema$2=tt=>v8n().color().test(tt);function convert(tt,{format:_e,hasAlpha:rt,isString:it}){const nt=convertMap[_e]+(it&&_e!=="hex"?"String":""),st=tt[nt]();return typeof st=="object"&&!rt?omit(st,["a"]):st}const sanitize$2=(tt,_e)=>{const rt=w(tt);if(!rt.isValid())throw Error("Invalid color");return convert(rt,_e)},format$1=(tt,_e)=>convert(w(tt),_objectSpread2(_objectSpread2({},_e),{},{isString:!0,format:"hex"})),normalize$3=({value:tt})=>{const _e=I$1(tt),rt=_e==="name"?"hex":_e,it=typeof tt=="object"?"a"in tt:_e==="hex"&&tt.length===8||/^(rgba)|(hsla)|(hsva)/.test(tt),nt={format:rt,hasAlpha:it,isString:typeof tt=="string"};return{value:sanitize$2(tt,nt),settings:nt}};var props$2=Object.freeze({__proto__:null,schema:schema$2,sanitize:sanitize$2,format:format$1,normalize:normalize$3});const ColorPreview=styled("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),PickerContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),PickerWrapper=styled("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function convertToRgb(tt,_e){return _e!=="rgb"?w(tt).toRgb():tt}function Color({value:tt,displayValue:_e,settings:rt,onUpdate:it}){const{emitOnEditStart:nt,emitOnEditEnd:st}=useInputContext(),{format:at,hasAlpha:lt}=rt,{popinRef:ot,wrapperRef:ct,shown:ut,show:ht,hide:dt}=usePopin(),pt=reactExports.useRef(0),[ft,gt]=reactExports.useState(()=>convertToRgb(tt,at)),mt=lt?Ce:Ne,At=()=>{gt(convertToRgb(tt,at)),ht(),nt()},yt=()=>{dt(),st(),window.clearTimeout(pt.current)},bt=()=>{pt.current=window.setTimeout(yt,500)};return reactExports.useEffect(()=>()=>window.clearTimeout(pt.current),[]),React.createElement(React.Fragment,null,React.createElement(ColorPreview,{ref:ot,active:ut,onClick:()=>At(),style:{color:_e}}),ut&&React.createElement(Portal,null,React.createElement(Overlay,{onPointerUp:yt}),React.createElement(PickerWrapper,{ref:ct,onMouseEnter:()=>window.clearTimeout(pt.current),onMouseLeave:xt=>xt.buttons===0&&bt()},React.createElement(mt,{color:ft,onChange:it}))))}function ColorComponent(){const{value:tt,displayValue:_e,label:rt,onChange:it,onUpdate:nt,settings:st}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(PickerContainer,null,React.createElement(Color,{value:tt,displayValue:_e,onChange:it,onUpdate:nt,settings:st}),React.createElement(ValueInput,{value:_e,onChange:it,onUpdate:nt})))}var color=_objectSpread2({component:ColorComponent},props$2);function Vector3dComponent(){const{label:tt,displayValue:_e,onUpdate:rt,settings:it}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Vector,{value:_e,settings:it,onUpdate:rt}))}var vector3d=_objectSpread2({component:Vector3dComponent},getVectorPlugin(["x","y","z"]));const JoystickTrigger=styled("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),JoystickPlayground=styled("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function Joystick({value:tt,settings:_e,onUpdate:rt}){const it=reactExports.useRef(),nt=reactExports.useRef(0),st=reactExports.useRef(0),at=reactExports.useRef(1),[lt,ot]=reactExports.useState(!1),[ct,ut]=reactExports.useState(!1),[ht,dt]=useTransform(),pt=reactExports.useRef(null),ft=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{if(lt){const{top:Rt,left:It,width:Ot,height:Bt}=pt.current.getBoundingClientRect();ft.current.style.left=It+Ot/2+"px",ft.current.style.top=Rt+Bt/2+"px"}},[lt]);const{keys:[gt,mt],joystick:At}=_e,yt=At==="invertY"?1:-1,{[gt]:{step:bt},[mt]:{step:xt}}=_e,vt=useTh("sizes","joystickWidth"),_t=useTh("sizes","joystickHeight"),Ct=parseFloat(vt)*.8/2,St=parseFloat(_t)*.8/2,Et=reactExports.useCallback(()=>{it.current||(ut(!0),nt.current&&dt({x:nt.current*Ct}),st.current&&dt({y:st.current*-St}),it.current=window.setInterval(()=>{rt(Rt=>{const It=bt*nt.current*at.current,Ot=yt*xt*st.current*at.current;return Array.isArray(Rt)?{[gt]:Rt[0]+It,[mt]:Rt[1]+Ot}:{[gt]:Rt[gt]+It,[mt]:Rt[mt]+Ot}})},16))},[Ct,St,rt,dt,bt,xt,gt,mt,yt]),Tt=reactExports.useCallback(()=>{window.clearTimeout(it.current),it.current=void 0,ut(!1)},[]);reactExports.useEffect(()=>{function Rt(It){at.current=multiplyStep(It)}return window.addEventListener("keydown",Rt),window.addEventListener("keyup",Rt),()=>{window.clearTimeout(it.current),window.removeEventListener("keydown",Rt),window.removeEventListener("keyup",Rt)}},[]);const Mt=useDrag(({first:Rt,active:It,delta:[Ot,Bt],movement:[Nt,zt]})=>{Rt&&ot(!0);const Dt=clamp(Nt,-Ct,Ct),Ft=clamp(zt,-St,St);nt.current=Math.abs(Nt)>Math.abs(Dt)?Math.sign(Nt-Dt):0,st.current=Math.abs(zt)>Math.abs(Ft)?Math.sign(Ft-zt):0;let Ut=tt[gt],$t=tt[mt];It?(nt.current||(Ut+=Ot*bt*at.current,dt({x:Dt})),st.current||($t-=yt*Bt*xt*at.current,dt({y:Ft})),nt.current||st.current?Et():Tt(),rt({[gt]:Ut,[mt]:$t})):(ot(!1),nt.current=0,st.current=0,dt({x:0,y:0}),Tt())});return React.createElement(JoystickTrigger,_extends({ref:pt},Mt()),lt&&React.createElement(Portal,null,React.createElement(JoystickPlayground,{ref:ft,isOutOfBounds:ct},React.createElement("div",null),React.createElement("span",{ref:ht}))))}const Container$1=styled("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function Vector2dComponent(){const{label:tt,displayValue:_e,onUpdate:rt,settings:it}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Container$1,{withJoystick:!!it.joystick},it.joystick&&React.createElement(Joystick,{value:_e,settings:it,onUpdate:rt}),React.createElement(Vector,{value:_e,settings:it,onUpdate:rt})))}const _excluded$7=["joystick"],plugin=getVectorPlugin(["x","y"]),normalize$2=tt=>{let{joystick:_e=!0}=tt,rt=_objectWithoutProperties$1(tt,_excluded$7);const{value:it,settings:nt}=plugin.normalize(rt);return{value:it,settings:_objectSpread2(_objectSpread2({},nt),{},{joystick:_e})}};var vector2d=_objectSpread2(_objectSpread2({component:Vector2dComponent},plugin),{},{normalize:normalize$2});const sanitize$1=tt=>{if(tt!==void 0){if(tt instanceof File)try{return URL.createObjectURL(tt)}catch{return}if(typeof tt=="string"&&tt.indexOf("blob:")===0)return tt;throw Error("Invalid image format [undefined | blob | File].")}},schema$1=(tt,_e)=>typeof _e=="object"&&"image"in _e,normalize$1=({image:tt})=>({value:tt});var props$1=Object.freeze({__proto__:null,sanitize:sanitize$1,schema:schema$1,normalize:normalize$1});const ImageContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),DropZone=styled("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),ImagePreview=styled("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),ImageLargePreview=styled("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),Instructions=styled("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),Remove=styled("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function ImageComponent(){const{label:tt,value:_e,onUpdate:rt,disabled:it}=useInputContext(),{popinRef:nt,wrapperRef:st,shown:at,show:lt,hide:ot}=usePopin(),ct=reactExports.useCallback(ft=>{ft.length&&rt(ft[0])},[rt]),ut=reactExports.useCallback(ft=>{ft.stopPropagation(),rt(void 0)},[rt]),{getRootProps:ht,getInputProps:dt,isDragAccept:pt}=useDropzone({maxFiles:1,accept:"image/*",onDrop:ct,disabled:it});return React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(ImageContainer,null,React.createElement(ImagePreview,{ref:nt,hasImage:!!_e,onPointerDown:()=>!!_e&&lt(),onPointerUp:ot,style:{backgroundImage:_e?`url(${_e})`:"none"}}),at&&!!_e&&React.createElement(Portal,null,React.createElement(Overlay,{onPointerUp:ot,style:{cursor:"pointer"}}),React.createElement(ImageLargePreview,{ref:st,style:{backgroundImage:`url(${_e})`}})),React.createElement(DropZone,ht({isDragAccept:pt}),React.createElement("input",dt()),React.createElement(Instructions,null,pt?"drop image":"click or drop")),React.createElement(Remove,{onClick:ut,disabled:!_e})))}var image=_objectSpread2({component:ImageComponent},props$1);const number=v8n().number(),schema=(tt,_e)=>v8n().array().length(2).every.number().test(tt)&&v8n().schema({min:number,max:number}).test(_e),format=tt=>({min:tt[0],max:tt[1]}),sanitize=(tt,{bounds:[_e,rt]},it)=>{const nt=Array.isArray(tt)?format(tt):tt,st={min:it[0],max:it[1]},{min:at,max:lt}=_objectSpread2(_objectSpread2({},st),nt);return[clamp(Number(at),_e,Math.max(_e,lt)),clamp(Number(lt),Math.min(rt,at),rt)]},normalize=({value:tt,min:_e,max:rt})=>{const it={min:_e,max:rt},nt=normalizeKeyedNumberSettings(format(tt),{min:it,max:it}),st=[_e,rt],at=_objectSpread2(_objectSpread2({},nt),{},{bounds:st});return{value:sanitize(format(tt),at,tt),settings:at}};var props=Object.freeze({__proto__:null,schema,format,sanitize,normalize});const _excluded$6=["value","bounds","onDrag"],_excluded2$1=["bounds"],Container=styled("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function IntervalSlider(tt){let{value:_e,bounds:[rt,it],onDrag:nt}=tt,st=_objectWithoutProperties$1(tt,_excluded$6);const at=reactExports.useRef(null),lt=reactExports.useRef(null),ot=reactExports.useRef(null),ct=reactExports.useRef(0),ut=useTh("sizes","scrubberWidth"),ht=useDrag(({event:ft,first:gt,xy:[mt],movement:[At],memo:yt={}})=>{if(gt){const{width:xt,left:vt}=at.current.getBoundingClientRect();ct.current=xt-parseFloat(ut);const _t=(ft==null?void 0:ft.target)===lt.current||(ft==null?void 0:ft.target)===ot.current;yt.pos=invertedRange((mt-vt)/xt,rt,it);const Ct=Math.abs(yt.pos-_e.min)-Math.abs(yt.pos-_e.max);yt.key=Ct<0||Ct===0&&yt.pos<=_e.min?"min":"max",_t&&(yt.pos=_e[yt.key])}const bt=yt.pos+invertedRange(At/ct.current,0,it-rt);return nt({[yt.key]:sanitizeStep(bt,st[yt.key])}),yt}),dt=`calc(${range(_e.min,rt,it)} * (100% - ${ut} - 8px) + 4px)`,pt=`calc(${1-range(_e.max,rt,it)} * (100% - ${ut} - 8px) + 4px)`;return React.createElement(RangeWrapper,_extends({ref:at},ht()),React.createElement(Range,null,React.createElement(Indicator,{style:{left:dt,right:pt}})),React.createElement(Scrubber,{position:"left",ref:lt,style:{left:dt}}),React.createElement(Scrubber,{position:"right",ref:ot,style:{right:pt}}))}function IntervalComponent(){const{label:tt,displayValue:_e,onUpdate:rt,settings:it}=useInputContext(),nt=_objectWithoutProperties$1(it,_excluded2$1);return React.createElement(React.Fragment,null,React.createElement(Row,{input:!0},React.createElement(Label,null,tt),React.createElement(Container,null,React.createElement(IntervalSlider,_extends({value:_e},it,{onDrag:rt})),React.createElement(Vector,{value:_e,settings:nt,onUpdate:rt,innerLabelTrim:0}))))}var interval=_objectSpread2({component:IntervalComponent},props);const createEventEmitter=()=>{const tt=new Map;return{on:(_e,rt)=>{let it=tt.get(_e);it===void 0&&(it=new Set,tt.set(_e,it)),it.add(rt)},off:(_e,rt)=>{const it=tt.get(_e);it!==void 0&&(it.delete(rt),it.size===0&&tt.delete(_e))},emit:(_e,...rt)=>{const it=tt.get(_e);if(it!==void 0)for(const nt of it)nt(...rt)}}},_excluded$5=["type","value"],_excluded2=["onChange","transient","onEditStart","onEditEnd"],Store=function(){const _e=create(subscribeWithSelector(()=>({data:{}}))),rt=createEventEmitter();this.storeId=getUid(),this.useStore=_e;const it={},nt=new Set;this.getVisiblePaths=()=>{const at=this.getData(),lt=Object.keys(at),ot=[];Object.entries(it).forEach(([ut,ht])=>{ht.render&&lt.some(dt=>dt.indexOf(ut)===0)&&!ht.render(this.get)&&ot.push(ut+".")});const ct=[];return nt.forEach(ut=>{ut in at&&at[ut].__refCount>0&&ot.every(ht=>ut.indexOf(ht)===-1)&&(!at[ut].render||at[ut].render(this.get))&&ct.push(ut)}),ct},this.setOrderedPaths=at=>{at.forEach(lt=>nt.add(lt))},this.orderPaths=at=>(this.setOrderedPaths(at),at),this.disposePaths=at=>{_e.setState(lt=>{const ot=lt.data;return at.forEach(ct=>{if(ct in ot){const ut=ot[ct];ut.__refCount--,ut.__refCount===0&&ut.type in SpecialInputs&&delete ot[ct]}}),{data:ot}})},this.dispose=()=>{_e.setState(()=>({data:{}}))},this.getFolderSettings=at=>it[at]||{},this.getData=()=>_e.getState().data,this.addData=(at,lt)=>{_e.setState(ot=>{const ct=ot.data;return Object.entries(at).forEach(([ut,ht])=>{let dt=ct[ut];if(dt){const{type:pt,value:ft}=ht,gt=_objectWithoutProperties$1(ht,_excluded$5);pt!==dt.type?warn(LevaErrors.INPUT_TYPE_OVERRIDE,pt):((dt.__refCount===0||lt)&&Object.assign(dt,gt),dt.__refCount++)}else ct[ut]=_objectSpread2(_objectSpread2({},ht),{},{__refCount:1})}),{data:ct}})},this.setValueAtPath=(at,lt,ot)=>{_e.setState(ct=>{const ut=ct.data;return updateInput(ut[at],lt,at,this,ot),{data:ut}})},this.setSettingsAtPath=(at,lt)=>{_e.setState(ot=>{const ct=ot.data;return ct[at].settings=_objectSpread2(_objectSpread2({},ct[at].settings),lt),{data:ct}})},this.disableInputAtPath=(at,lt)=>{_e.setState(ot=>{const ct=ot.data;return ct[at].disabled=lt,{data:ct}})},this.set=(at,lt)=>{_e.setState(ot=>{const ct=ot.data;return Object.entries(at).forEach(([ut,ht])=>{try{updateInput(ct[ut],ht,void 0,void 0,lt)}catch{}}),{data:ct}})},this.getInput=at=>{try{return this.getData()[at]}catch{warn(LevaErrors.PATH_DOESNT_EXIST,at)}},this.get=at=>{var lt;return(lt=this.getInput(at))===null||lt===void 0?void 0:lt.value},this.emitOnEditStart=at=>{rt.emit(`onEditStart:${at}`,this.get(at),at,_objectSpread2(_objectSpread2({},this.getInput(at)),{},{get:this.get}))},this.emitOnEditEnd=at=>{rt.emit(`onEditEnd:${at}`,this.get(at),at,_objectSpread2(_objectSpread2({},this.getInput(at)),{},{get:this.get}))},this.subscribeToEditStart=(at,lt)=>{const ot=`onEditStart:${at}`;return rt.on(ot,lt),()=>rt.off(ot,lt)},this.subscribeToEditEnd=(at,lt)=>{const ot=`onEditEnd:${at}`;return rt.on(ot,lt),()=>rt.off(ot,lt)};const st=(at,lt,ot)=>{const ct={};return Object.entries(at).forEach(([ut,ht])=>{if(ut==="")return warn(LevaErrors.EMPTY_KEY);let dt=join(lt,ut);if(ht.type===SpecialInputs.FOLDER){const pt=st(ht.schema,dt,ot);Object.assign(ct,pt),dt in it||(it[dt]=ht.settings)}else if(ut in ot)warn(LevaErrors.DUPLICATE_KEYS,ut,dt,ot[ut].path);else{const pt=normalizeInput(ht,ut,dt,ct);if(pt){const{type:ft,options:gt,input:mt}=pt,{onChange:At,transient:yt,onEditStart:bt,onEditEnd:xt}=gt,vt=_objectWithoutProperties$1(gt,_excluded2);ct[dt]=_objectSpread2(_objectSpread2(_objectSpread2({type:ft},vt),mt),{},{fromPanel:!0}),ot[ut]={path:dt,onChange:At,transient:yt,onEditStart:bt,onEditEnd:xt}}else warn(LevaErrors.UNKNOWN_INPUT,dt,ht)}}),ct};this.getDataFromSchema=at=>{const lt={};return[st(at,"",lt),lt]}},levaStore=new Store,defaultSettings$2={collapsed:!1};function folder(tt,_e){return{type:SpecialInputs.FOLDER,schema:tt,settings:_objectSpread2(_objectSpread2({},defaultSettings$2),_e)}}const defaultSettings$1={disabled:!1};function button(tt,_e){return{type:SpecialInputs.BUTTON,onClick:tt,settings:_objectSpread2(_objectSpread2({},defaultSettings$1),_e)}}const isInput=tt=>"__levaInput"in tt,buildTree=(tt,_e)=>{const rt={},it=_e?_e.toLowerCase():null;return tt.forEach(nt=>{const[st,at]=getKeyPath(nt);(!it||st.toLowerCase().indexOf(it)>-1)&&merge$1(rt,at,{[st]:{__levaInput:!0,path:nt}})}),rt},_excluded$4=["type","label","path","valueKey","value","settings","setValue","disabled"];function ControlInput(tt){let{type:_e,label:rt,path:it,valueKey:nt,value:st,settings:at,setValue:lt,disabled:ot}=tt,ct=_objectWithoutProperties$1(tt,_excluded$4);const{displayValue:ut,onChange:ht,onUpdate:dt}=useInputSetters({type:_e,value:st,settings:at,setValue:lt}),pt=Plugins[_e].component;return pt?React.createElement(InputContext.Provider,{value:_objectSpread2({key:nt,path:it,id:""+it,label:rt,displayValue:ut,value:st,onChange:ht,onUpdate:dt,settings:at,setValue:lt,disabled:ot},ct)},React.createElement(StyledInputWrapper$1,{disabled:ot},React.createElement(pt,null))):(warn(LevaErrors.NO_COMPONENT_FOR_TYPE,_e,it),null)}const StyledButton=styled("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function Button$1({onClick:tt,settings:_e,label:rt}){const it=useStoreContext();return React.createElement(Row,null,React.createElement(StyledButton,{disabled:_e.disabled,onClick:()=>tt(it.get)},rt))}const StyledButtonGroup=styled("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),StyledButtonGroupButton=styled("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),getOpts=({label:tt,opts:_e})=>{let rt=typeof tt=="string"&&tt.trim()===""?null:tt,it=_e;return typeof _e.opts=="object"&&(it.label!==void 0&&(rt=_e.label),it=_e.opts),{label:rt,opts:it}};function ButtonGroup(tt){const{label:_e,opts:rt}=getOpts(tt),it=useStoreContext();return React.createElement(Row,{input:!!_e},_e&&React.createElement(Label,null,_e),React.createElement(StyledButtonGroup,null,Object.entries(rt).map(([nt,st])=>React.createElement(StyledButtonGroupButton,{key:nt,onClick:()=>st(it.get)},nt))))}const Canvas=styled("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),POINTS=100;function push(tt,_e){tt.push(_e),tt.length>POINTS&&tt.shift()}const MonitorCanvas=reactExports.forwardRef(function({initialValue:tt},_e){const rt=useTh("colors","highlight3"),it=useTh("colors","elevation2"),nt=useTh("colors","highlight1"),[st,at]=reactExports.useMemo(()=>[w(nt).alpha(.4).toRgbString(),w(nt).alpha(.1).toRgbString()],[nt]),lt=reactExports.useRef([tt]),ot=reactExports.useRef(tt),ct=reactExports.useRef(tt),ut=reactExports.useRef(),ht=reactExports.useCallback((ft,gt)=>{if(!ft)return;const{width:mt,height:At}=ft,yt=new Path2D,bt=mt/POINTS,xt=At*.05;for(let Ct=0;Ct<lt.current.length;Ct++){const St=range(lt.current[Ct],ot.current,ct.current),Et=bt*Ct,Tt=At-St*(At-xt*2)-xt;yt.lineTo(Et,Tt)}gt.clearRect(0,0,mt,At);const vt=new Path2D(yt);vt.lineTo(bt*(lt.current.length+1),At),vt.lineTo(0,At),vt.lineTo(0,0);const _t=gt.createLinearGradient(0,0,0,At);_t.addColorStop(0,st),_t.addColorStop(1,at),gt.fillStyle=_t,gt.fill(vt),gt.strokeStyle=it,gt.lineJoin="round",gt.lineWidth=14,gt.stroke(yt),gt.strokeStyle=rt,gt.lineWidth=2,gt.stroke(yt)},[rt,it,st,at]),[dt,pt]=useCanvas2d(ht);return reactExports.useImperativeHandle(_e,()=>({frame:ft=>{(ot.current===void 0||ft<ot.current)&&(ot.current=ft),(ct.current===void 0||ft>ct.current)&&(ct.current=ft),push(lt.current,ft),ut.current=requestAnimationFrame(()=>ht(dt.current,pt.current))}}),[dt,pt,ht]),reactExports.useEffect(()=>()=>cancelAnimationFrame(ut.current),[]),React.createElement(Canvas,{ref:dt})}),parse=tt=>Number.isFinite(tt)?tt.toPrecision(2):tt.toString(),MonitorLog=reactExports.forwardRef(function({initialValue:tt},_e){const[rt,it]=reactExports.useState(parse(tt));return reactExports.useImperativeHandle(_e,()=>({frame:nt=>it(parse(nt))}),[]),React.createElement("div",null,rt)});function getValue$1(tt){return typeof tt=="function"?tt():tt.current}function Monitor({label:tt,objectOrFn:_e,settings:rt}){const it=reactExports.useRef(),nt=reactExports.useRef(getValue$1(_e));return reactExports.useEffect(()=>{const st=window.setInterval(()=>{var at;document.hidden||(at=it.current)===null||at===void 0||at.frame(getValue$1(_e))},rt.interval);return()=>window.clearInterval(st)},[_e,rt.interval]),React.createElement(Row,{input:!0},React.createElement(Label,{align:"top"},tt),rt.graph?React.createElement(MonitorCanvas,{ref:it,initialValue:nt.current}):React.createElement(MonitorLog,{ref:it,initialValue:nt.current}))}const _excluded$3=["type","label","key"],specialComponents={[SpecialInputs.BUTTON]:Button$1,[SpecialInputs.BUTTON_GROUP]:ButtonGroup,[SpecialInputs.MONITOR]:Monitor},Control=React.memo(({path:tt})=>{const[_e,{set:rt,setSettings:it,disable:nt,storeId:st,emitOnEditStart:at,emitOnEditEnd:lt}]=useInput(tt);if(!_e)return null;const{type:ot,label:ct,key:ut}=_e,ht=_objectWithoutProperties$1(_e,_excluded$3);if(ot in SpecialInputs){const dt=specialComponents[ot];return React.createElement(dt,_extends({label:ct,path:tt},ht))}return ot in Plugins?React.createElement(ControlInput,_extends({key:st+tt,type:ot,label:ct,storeId:st,path:tt,valueKey:ut,setValue:rt,setSettings:it,disable:nt,emitOnEditStart:at,emitOnEditEnd:lt},ht)):(log(LevaErrors.UNSUPPORTED_INPUT,ot,tt),null)});function FolderTitle({toggle:tt,toggled:_e,name:rt}){return React.createElement(StyledTitle,{onClick:()=>tt()},React.createElement(Chevron,{toggled:_e}),React.createElement("div",null,rt))}const Folder=({name:tt,path:_e,tree:rt})=>{const it=useStoreContext(),nt=join(_e,tt),{collapsed:st,color:at}=it.getFolderSettings(nt),[lt,ot]=reactExports.useState(!st),ct=reactExports.useRef(null),ut=useTh("colors","folderWidgetColor"),ht=useTh("colors","folderTextColor");return reactExports.useLayoutEffect(()=>{ct.current.style.setProperty("--leva-colors-folderWidgetColor",at||ut),ct.current.style.setProperty("--leva-colors-folderTextColor",at||ht)},[at,ut,ht]),React.createElement(StyledFolder,{ref:ct},React.createElement(FolderTitle,{name:tt,toggled:lt,toggle:()=>ot(dt=>!dt)}),React.createElement(TreeWrapper,{parent:nt,tree:rt,toggled:lt}))},TreeWrapper=React.memo(({isRoot:tt=!1,fill:_e=!1,flat:rt=!1,parent:it,tree:nt,toggled:st})=>{const{wrapperRef:at,contentRef:lt}=useToggle(st),ot=useStoreContext(),ct=([ht,dt])=>{var pt;return(isInput(dt)?(pt=ot.getInput(dt.path))===null||pt===void 0?void 0:pt.order:ot.getFolderSettings(join(it,ht)).order)||0},ut=Object.entries(nt).sort((ht,dt)=>ct(ht)-ct(dt));return React.createElement(StyledWrapper,{ref:at,isRoot:tt,fill:_e,flat:rt},React.createElement(StyledContent,{ref:lt,isRoot:tt,toggled:st},ut.map(([ht,dt])=>isInput(dt)?React.createElement(Control,{key:dt.path,valueKey:dt.valueKey,path:dt.path}):React.createElement(Folder,{key:ht,name:ht,path:it,tree:dt}))))}),StyledRoot=styled("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${StyledInputRow}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),iconWidth=40,Icon=styled("i",{$flexCenter:"",width:iconWidth,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),StyledTitleWithFilter=styled("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),FilterWrapper=styled("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${Icon}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),StyledFilterInput=styled("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),TitleContainer=styled("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:iconWidth}}}}),FilterInput=React.forwardRef(({setFilter:tt,toggle:_e},rt)=>{const[it,nt]=reactExports.useState(""),st=reactExports.useMemo(()=>debounce(tt,250),[tt]),at=()=>{tt(""),nt("")},lt=ot=>{const ct=ot.currentTarget.value;_e(!0),nt(ct)};return reactExports.useEffect(()=>{st(it)},[it,st]),React.createElement(React.Fragment,null,React.createElement(StyledFilterInput,{ref:rt,value:it,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:ot=>ot.stopPropagation(),onChange:lt}),React.createElement(Icon,{onClick:()=>at(),style:{visibility:it?"visible":"hidden"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function TitleWithFilter({setFilter:tt,onDrag:_e,onDragStart:rt,onDragEnd:it,toggle:nt,toggled:st,title:at,drag:lt,filterEnabled:ot,from:ct}){const[ut,ht]=reactExports.useState(!1),dt=reactExports.useRef(null);reactExports.useEffect(()=>{var ft,gt;ut?(ft=dt.current)===null||ft===void 0||ft.focus():(gt=dt.current)===null||gt===void 0||gt.blur()},[ut]);const pt=useDrag(({offset:[ft,gt],first:mt,last:At})=>{_e({x:ft,y:gt}),mt&&rt({x:ft,y:gt}),At&&it({x:ft,y:gt})},{filterTaps:!0,from:({offset:[ft,gt]})=>[(ct==null?void 0:ct.x)||ft,(ct==null?void 0:ct.y)||gt]});return reactExports.useEffect(()=>{const ft=gt=>{gt.key==="L"&&gt.shiftKey&&gt.metaKey&&ht(mt=>!mt)};return window.addEventListener("keydown",ft),()=>window.removeEventListener("keydown",ft)},[]),React.createElement(React.Fragment,null,React.createElement(StyledTitleWithFilter,{mode:lt?"drag":void 0},React.createElement(Icon,{active:!st,onClick:()=>nt()},React.createElement(Chevron,{toggled:st,width:12,height:8})),React.createElement(TitleContainer,_extends({},lt?pt():{},{drag:lt,filterEnabled:ot}),at===void 0&&lt?React.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},React.createElement("circle",{cx:"2",cy:"2",r:"2"}),React.createElement("circle",{cx:"14",cy:"2",r:"2"}),React.createElement("circle",{cx:"26",cy:"2",r:"2"}),React.createElement("circle",{cx:"2",cy:"12",r:"2"}),React.createElement("circle",{cx:"14",cy:"12",r:"2"}),React.createElement("circle",{cx:"26",cy:"12",r:"2"})):at),ot&&React.createElement(Icon,{active:ut,onClick:()=>ht(ft=>!ft)},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},React.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),React.createElement(FilterWrapper,{toggled:ut},React.createElement(FilterInput,{ref:dt,setFilter:tt,toggle:nt})))}const _excluded$2=["store","hidden","theme","collapsed"];function LevaRoot(tt){let{store:_e,hidden:rt=!1,theme:it,collapsed:nt=!1}=tt,st=_objectWithoutProperties$1(tt,_excluded$2);const at=useDeepMemo(()=>mergeTheme(it),[it]),[lt,ot]=reactExports.useState(!nt),ct=typeof nt=="object"?!nt.collapsed:lt,ut=reactExports.useMemo(()=>typeof nt=="object"?ht=>{typeof ht=="function"?nt.onChange(!ht(!nt.collapsed)):nt.onChange(!ht)}:ot,[nt]);return!_e||rt?null:React.createElement(ThemeContext.Provider,{value:at},React.createElement(LevaCore,_extends({store:_e},st,{toggled:ct,setToggle:ut,rootClass:at.className})))}const LevaCore=React.memo(({store:tt,rootClass:_e,fill:rt=!1,flat:it=!1,neverHide:nt=!1,oneLineLabels:st=!1,titleBar:at={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:lt=!1,toggled:ot,setToggle:ct})=>{var ut,ht;const dt=useVisiblePaths(tt),[pt,ft]=reactExports.useState(""),gt=reactExports.useMemo(()=>buildTree(dt,pt),[dt,pt]),[mt,At]=useTransform(),yt=nt||dt.length>0,bt=typeof at=="object"&&at.title||void 0,xt=typeof at=="object"&&(ut=at.drag)!==null&&ut!==void 0?ut:!0,vt=typeof at=="object"&&(ht=at.filter)!==null&&ht!==void 0?ht:!0,_t=typeof at=="object"&&at.position||void 0,Ct=typeof at=="object"&&at.onDrag||void 0,St=typeof at=="object"&&at.onDragStart||void 0,Et=typeof at=="object"&&at.onDragEnd||void 0;return React.useEffect(()=>{At({x:_t==null?void 0:_t.x,y:_t==null?void 0:_t.y})},[_t,At]),globalStyles(),React.createElement(PanelSettingsContext.Provider,{value:{hideCopyButton:lt}},React.createElement(StyledRoot,{ref:mt,className:_e,fill:rt,flat:it,oneLineLabels:st,hideTitleBar:!at,style:{display:yt?"block":"none"}},at&&React.createElement(TitleWithFilter,{onDrag:Tt=>{At(Tt),Ct==null||Ct(Tt)},onDragStart:Tt=>St==null?void 0:St(Tt),onDragEnd:Tt=>Et==null?void 0:Et(Tt),setFilter:ft,toggle:Tt=>ct(Mt=>Tt??!Mt),toggled:ot,title:bt,drag:xt,filterEnabled:vt,from:_t}),yt&&React.createElement(StoreContext.Provider,{value:tt},React.createElement(TreeWrapper,{isRoot:!0,fill:rt,flat:it,tree:gt,toggled:ot}))))}),_excluded$1=["isRoot"];let rootInitialized=!1,rootEl=null;function Leva(tt){let{isRoot:_e=!1}=tt,rt=_objectWithoutProperties$1(tt,_excluded$1);return reactExports.useEffect(()=>(rootInitialized=!0,!_e&&rootEl&&(rootEl.remove(),rootEl=null),()=>{_e||(rootInitialized=!1)}),[_e]),React.createElement(LevaRoot,_extends({store:levaStore},rt))}function useRenderRoot(tt){reactExports.useEffect(()=>{tt&&!rootInitialized&&(rootEl||(rootEl=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(rootEl),render(React.createElement(Leva,{isRoot:!0}),rootEl))),rootInitialized=!0)},[tt])}function parseArgs(tt,_e,rt,it,nt){let st,at,lt,ot,ct;return typeof tt=="string"?(at=tt,st=_e,Array.isArray(rt)?ct=rt:rt&&("store"in rt?(ot=rt,ct=it):(lt=rt,Array.isArray(it)?ct=it:(ot=it,ct=nt)))):(st=tt,Array.isArray(_e)?ct=_e:(ot=_e,ct=rt)),{schema:st,folderName:at,folderSettings:lt,hookSettings:ot,deps:ct||[]}}function useControls(tt,_e,rt,it,nt){const{folderName:st,schema:at,folderSettings:lt,hookSettings:ot,deps:ct}=parseArgs(tt,_e,rt,it,nt),ut=typeof at=="function",ht=reactExports.useRef(!1),dt=reactExports.useRef(!0),pt=useDeepMemo(()=>{ht.current=!0;const Mt=typeof at=="function"?at():at;return st?{[st]:folder(Mt,lt)}:Mt},ct),ft=!(ot!=null&&ot.store);useRenderRoot(ft);const[gt]=reactExports.useState(()=>(ot==null?void 0:ot.store)||levaStore),[mt,At]=reactExports.useMemo(()=>gt.getDataFromSchema(pt),[gt,pt]),[yt,bt,xt,vt,_t]=reactExports.useMemo(()=>{const Mt=[],Rt=[],It={},Ot={},Bt={};return Object.values(At).forEach(({path:Nt,onChange:zt,onEditStart:Dt,onEditEnd:Ft,transient:Ut})=>{Mt.push(Nt),zt?(It[Nt]=zt,Ut||Rt.push(Nt)):Rt.push(Nt),Dt&&(Ot[Nt]=Dt),Ft&&(Bt[Nt]=Ft)}),[Mt,Rt,It,Ot,Bt]},[At]),Ct=reactExports.useMemo(()=>gt.orderPaths(yt),[yt,gt]),St=useValuesForPath(gt,bt,mt),Et=reactExports.useCallback(Mt=>{const Rt=Object.entries(Mt).reduce((It,[Ot,Bt])=>Object.assign(It,{[At[Ot].path]:Bt}),{});gt.set(Rt,!1)},[gt,At]),Tt=reactExports.useCallback(Mt=>gt.get(At[Mt].path),[gt,At]);return reactExports.useEffect(()=>{const Mt=!dt.current&&ht.current;return gt.addData(mt,Mt),dt.current=!1,ht.current=!1,()=>gt.disposePaths(Ct)},[gt,Ct,mt]),reactExports.useEffect(()=>{const Mt=[];return Object.entries(xt).forEach(([Rt,It])=>{It(gt.get(Rt),Rt,_objectSpread2({initial:!0,get:gt.get},gt.getInput(Rt)));const Ot=gt.useStore.subscribe(Bt=>{const Nt=Bt.data[Rt];return[Nt.disabled?void 0:Nt.value,Nt]},([Bt,Nt])=>It(Bt,Rt,_objectSpread2({initial:!1,get:gt.get},Nt)),{equalityFn:shallow});Mt.push(Ot)}),()=>Mt.forEach(Rt=>Rt())},[gt,xt]),reactExports.useEffect(()=>{const Mt=[];return Object.entries(vt).forEach(([Rt,It])=>Mt.push(gt.subscribeToEditStart(Rt,It))),Object.entries(_t).forEach(([Rt,It])=>Mt.push(gt.subscribeToEditEnd(Rt,It))),()=>Mt.forEach(Rt=>Rt())},[vt,_t,gt]),ut?[St,Et,Tt]:St}register(LevaInputs.SELECT,select);register(LevaInputs.IMAGE,image);register(LevaInputs.NUMBER,number$1);register(LevaInputs.COLOR,color);register(LevaInputs.STRING,string);register(LevaInputs.BOOLEAN,boolean);register(LevaInputs.INTERVAL,interval);register(LevaInputs.VECTOR3D,vector3d);register(LevaInputs.VECTOR2D,vector2d);function Button(){const tt=useControls({"Exit Room!":button(_e=>{window.confirm("Are you sure to exit XR Room?")?(window.opener&&window.close(),console.log("User confirmed")):console.log("User cancelled")})});return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("pre",{children:JSON.stringify(tt,null,"  ")})})}const my_polyhedron={Box:new BoxGeometry,Sphere:new SphereGeometry(.785398),Dodecahedron:new DodecahedronGeometry(.785398)},options={x:{value:0,min:0,max:Math.PI*2,step:.01},y:{value:0,min:0,max:Math.PI*2,step:.01},z:{value:0,min:0,max:Math.PI*2,step:.01},visible:!0,color:{value:"lime"},wireframe:!1,model:{value:"Box",options:Object.keys(my_polyhedron)}};function PlayerExample(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Environment,{preset:"sunset",background:!0})})}function VRApp(){const tt=useControls("Polyhedron A",options),_e=useControls("Polyhedron B",options);return Button(),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(VRButton$1,{}),jsxRuntimeExports.jsx(Canvas$1,{camera:{position:[-10,10,10],fov:50},shadows:!0,children:jsxRuntimeExports.jsxs(XR,{children:[jsxRuntimeExports.jsx(Sky,{sunPosition:[0,1,0]}),jsxRuntimeExports.jsx(Floor,{}),jsxRuntimeExports.jsx("ambientLight",{intensity:.5}),jsxRuntimeExports.jsx("pointLight",{position:[5,5,5]}),jsxRuntimeExports.jsx(Hands,{}),jsxRuntimeExports.jsx(RayGrab,{children:jsxRuntimeExports.jsx(Polyhedron,{position:[-2,2,2],rotation:[tt.x,tt.y,tt.z],visible:tt.visible,color:tt.color,wireframe:tt.wireframe,polyhedron_shape:my_polyhedron[tt.model]},"polyhedronA")}),jsxRuntimeExports.jsx(RayGrab,{children:jsxRuntimeExports.jsx(Polyhedron,{position:[2,2,2],rotation:[_e.x,_e.y,_e.z],visible:_e.visible,color:_e.color,wireframe:_e.wireframe,polyhedron_shape:my_polyhedron[_e.model]},"polyhedronB")}),jsxRuntimeExports.jsx(Controllers,{}),jsxRuntimeExports.jsx(Button3D,{position:[0,.8,-4]}),jsxRuntimeExports.jsx(PlayerExample,{}),jsxRuntimeExports.jsx(OrbitControls,{"target-y":1}),jsxRuntimeExports.jsx("axesHelper",{args:[5]}),jsxRuntimeExports.jsx("gridHelper",{}),jsxRuntimeExports.jsx(Stats,{})]})})]})}var commonjsGlobal=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function createCommonjsModule(tt,_e){return _e={exports:{}},tt(_e,_e.exports),_e.exports}var freeGlobal=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")(),_root=root,Symbol$1=_root.Symbol,_Symbol=Symbol$1,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(tt){var _e=hasOwnProperty.call(tt,symToStringTag),rt=tt[symToStringTag];try{tt[symToStringTag]=void 0}catch{}var it=nativeObjectToString.call(tt);return _e?tt[symToStringTag]=rt:delete tt[symToStringTag],it}var _getRawTag=getRawTag,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(tt){return nativeObjectToString$1.call(tt)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(tt){return tt==null?tt===void 0?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(tt)?_getRawTag(tt):_objectToString(tt)}var _baseGetTag=baseGetTag;function isObject(tt){var _e=typeof tt;return tt!=null&&(_e=="object"||_e=="function")}var isObject_1=isObject,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(tt){if(!isObject_1(tt))return!1;var _e=_baseGetTag(tt);return _e==funcTag||_e==genTag||_e==asyncTag||_e==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=function(){var tt=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||"");return tt?"Symbol(src)_1."+tt:""}();function isMasked(tt){return!!maskSrcKey&&maskSrcKey in tt}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(tt){if(tt!=null){try{return funcToString.call(tt)}catch{}try{return tt+""}catch{}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(tt){if(!isObject_1(tt)||_isMasked(tt))return!1;var _e=isFunction_1(tt)?reIsNative:reIsHostCtor;return _e.test(_toSource(tt))}var _baseIsNative=baseIsNative;function getValue(tt,_e){return tt==null?void 0:tt[_e]}var _getValue=getValue;function getNative(tt,_e){var rt=_getValue(tt,_e);return _baseIsNative(rt)?rt:void 0}var _getNative=getNative,defineProperty=function(){try{var tt=_getNative(Object,"defineProperty");return tt({},"",{}),tt}catch{}}(),_defineProperty=defineProperty;function baseAssignValue(tt,_e,rt){_e=="__proto__"&&_defineProperty?_defineProperty(tt,_e,{configurable:!0,enumerable:!0,value:rt,writable:!0}):tt[_e]=rt}var _baseAssignValue=baseAssignValue;function eq(tt,_e){return tt===_e||tt!==tt&&_e!==_e}var eq_1=eq,objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty;function assignValue(tt,_e,rt){var it=tt[_e];(!(hasOwnProperty$2.call(tt,_e)&&eq_1(it,rt))||rt===void 0&&!(_e in tt))&&_baseAssignValue(tt,_e,rt)}var _assignValue=assignValue;function copyObject(tt,_e,rt,it){var nt=!rt;rt||(rt={});for(var st=-1,at=_e.length;++st<at;){var lt=_e[st],ot=it?it(rt[lt],tt[lt],lt,rt,tt):void 0;ot===void 0&&(ot=tt[lt]),nt?_baseAssignValue(rt,lt,ot):_assignValue(rt,lt,ot)}return rt}var _copyObject=copyObject;function identity(tt){return tt}var identity_1=identity;function apply(tt,_e,rt){switch(rt.length){case 0:return tt.call(_e);case 1:return tt.call(_e,rt[0]);case 2:return tt.call(_e,rt[0],rt[1]);case 3:return tt.call(_e,rt[0],rt[1],rt[2])}return tt.apply(_e,rt)}var _apply=apply,nativeMax=Math.max;function overRest(tt,_e,rt){return _e=nativeMax(_e===void 0?tt.length-1:_e,0),function(){for(var it=arguments,nt=-1,st=nativeMax(it.length-_e,0),at=Array(st);++nt<st;)at[nt]=it[_e+nt];nt=-1;for(var lt=Array(_e+1);++nt<_e;)lt[nt]=it[nt];return lt[_e]=rt(at),_apply(tt,this,lt)}}var _overRest=overRest;function constant(tt){return function(){return tt}}var constant_1=constant,baseSetToString=_defineProperty?function(tt,_e){return _defineProperty(tt,"toString",{configurable:!0,enumerable:!1,value:constant_1(_e),writable:!0})}:identity_1,_baseSetToString=baseSetToString,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(tt){var _e=0,rt=0;return function(){var it=nativeNow(),nt=HOT_SPAN-(it-rt);if(rt=it,nt>0){if(++_e>=HOT_COUNT)return arguments[0]}else _e=0;return tt.apply(void 0,arguments)}}var _shortOut=shortOut,setToString=_shortOut(_baseSetToString),_setToString=setToString;function baseRest(tt,_e){return _setToString(_overRest(tt,_e,identity_1),tt+"")}var _baseRest=baseRest,MAX_SAFE_INTEGER=9007199254740991;function isLength(tt){return typeof tt=="number"&&tt>-1&&tt%1==0&&tt<=MAX_SAFE_INTEGER}var isLength_1=isLength;function isArrayLike(tt){return tt!=null&&isLength_1(tt.length)&&!isFunction_1(tt)}var isArrayLike_1=isArrayLike,MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(tt,_e){var rt=typeof tt;return _e=_e??MAX_SAFE_INTEGER$1,!!_e&&(rt=="number"||rt!="symbol"&&reIsUint.test(tt))&&tt>-1&&tt%1==0&&tt<_e}var _isIndex=isIndex;function isIterateeCall(tt,_e,rt){if(!isObject_1(rt))return!1;var it=typeof _e;return(it=="number"?isArrayLike_1(rt)&&_isIndex(_e,rt.length):it=="string"&&_e in rt)?eq_1(rt[_e],tt):!1}var _isIterateeCall=isIterateeCall;function createAssigner(tt){return _baseRest(function(_e,rt){var it=-1,nt=rt.length,st=nt>1?rt[nt-1]:void 0,at=nt>2?rt[2]:void 0;for(st=tt.length>3&&typeof st=="function"?(nt--,st):void 0,at&&_isIterateeCall(rt[0],rt[1],at)&&(st=nt<3?void 0:st,nt=1),_e=Object(_e);++it<nt;){var lt=rt[it];lt&&tt(_e,lt,it,st)}return _e})}var _createAssigner=createAssigner,objectProto$4=Object.prototype;function isPrototype(tt){var _e=tt&&tt.constructor,rt=typeof _e=="function"&&_e.prototype||objectProto$4;return tt===rt}var _isPrototype=isPrototype;function baseTimes(tt,_e){for(var rt=-1,it=Array(tt);++rt<tt;)it[rt]=_e(rt);return it}var _baseTimes=baseTimes;function isObjectLike(tt){return tt!=null&&typeof tt=="object"}var isObjectLike_1=isObjectLike,argsTag="[object Arguments]";function baseIsArguments(tt){return isObjectLike_1(tt)&&_baseGetTag(tt)==argsTag}var _baseIsArguments=baseIsArguments,objectProto$5=Object.prototype,hasOwnProperty$3=objectProto$5.hasOwnProperty,propertyIsEnumerable=objectProto$5.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(tt){return isObjectLike_1(tt)&&hasOwnProperty$3.call(tt,"callee")&&!propertyIsEnumerable.call(tt,"callee")},isArguments_1=isArguments,isArray=Array.isArray,isArray_1=isArray;function stubFalse(){return!1}var stubFalse_1=stubFalse,isBuffer_1=createCommonjsModule(function(tt,_e){var rt=_e&&!_e.nodeType&&_e,it=rt&&!0&&tt&&!tt.nodeType&&tt,nt=it&&it.exports===rt,st=nt?_root.Buffer:void 0,at=st?st.isBuffer:void 0,lt=at||stubFalse_1;tt.exports=lt}),argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;function baseIsTypedArray(tt){return isObjectLike_1(tt)&&isLength_1(tt.length)&&!!typedArrayTags[_baseGetTag(tt)]}var _baseIsTypedArray=baseIsTypedArray;function baseUnary(tt){return function(_e){return tt(_e)}}var _baseUnary=baseUnary,_nodeUtil=createCommonjsModule(function(tt,_e){var rt=_e&&!_e.nodeType&&_e,it=rt&&!0&&tt&&!tt.nodeType&&tt,nt=it&&it.exports===rt,st=nt&&_freeGlobal.process,at=function(){try{var lt=it&&it.require&&it.require("util").types;return lt||st&&st.binding&&st.binding("util")}catch{}}();tt.exports=at}),nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray,isTypedArray_1=isTypedArray,objectProto$6=Object.prototype,hasOwnProperty$4=objectProto$6.hasOwnProperty;function arrayLikeKeys(tt,_e){var rt=isArray_1(tt),it=!rt&&isArguments_1(tt),nt=!rt&&!it&&isBuffer_1(tt),st=!rt&&!it&&!nt&&isTypedArray_1(tt),at=rt||it||nt||st,lt=at?_baseTimes(tt.length,String):[],ot=lt.length;for(var ct in tt)(_e||hasOwnProperty$4.call(tt,ct))&&!(at&&(ct=="length"||nt&&(ct=="offset"||ct=="parent")||st&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||_isIndex(ct,ot)))&&lt.push(ct);return lt}var _arrayLikeKeys=arrayLikeKeys;function overArg(tt,_e){return function(rt){return tt(_e(rt))}}var _overArg=overArg,nativeKeys=_overArg(Object.keys,Object),_nativeKeys=nativeKeys,objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function baseKeys(tt){if(!_isPrototype(tt))return _nativeKeys(tt);var _e=[];for(var rt in Object(tt))hasOwnProperty$5.call(tt,rt)&&rt!="constructor"&&_e.push(rt);return _e}var _baseKeys=baseKeys;function keys(tt){return isArrayLike_1(tt)?_arrayLikeKeys(tt):_baseKeys(tt)}var keys_1=keys,objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty,assign=_createAssigner(function(tt,_e){if(_isPrototype(_e)||isArrayLike_1(_e)){_copyObject(_e,keys_1(_e),tt);return}for(var rt in _e)hasOwnProperty$6.call(_e,rt)&&_assignValue(tt,rt,_e[rt])}),assign_1=assign,jsxgraphcore$1=createCommonjsModule(function(module,exports){(function(tt,_e){module.exports?module.exports=_e():tt.returnExports=_e()})(commonjsGlobal,function(){var requirejs,require,define;return function(tt){function _e(vt,_t){return yt.call(vt,_t)}function rt(vt,_t){var Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft=_t&&_t.split("/"),Ut=mt.map,$t=Ut&&Ut["*"]||{};if(vt){for(vt=vt.split("/"),Mt=vt.length-1,mt.nodeIdCompat&&xt.test(vt[Mt])&&(vt[Mt]=vt[Mt].replace(xt,"")),vt[0].charAt(0)==="."&&Ft&&(Dt=Ft.slice(0,Ft.length-1),vt=Dt.concat(vt)),Bt=0;Bt<vt.length;Bt++)if((zt=vt[Bt])===".")vt.splice(Bt,1),Bt-=1;else if(zt===".."){if(Bt===0||Bt===1&&vt[2]===".."||vt[Bt-1]==="..")continue;Bt>0&&(vt.splice(Bt-1,2),Bt-=2)}vt=vt.join("/")}if((Ft||$t)&&Ut){for(Ct=vt.split("/"),Bt=Ct.length;Bt>0;Bt-=1){if(St=Ct.slice(0,Bt).join("/"),Ft){for(Nt=Ft.length;Nt>0;Nt-=1)if((Et=Ut[Ft.slice(0,Nt).join("/")])&&(Et=Et[St])){Tt=Et,Rt=Bt;break}}if(Tt)break;!It&&$t&&$t[St]&&(It=$t[St],Ot=Bt)}!Tt&&It&&(Tt=It,Rt=Ot),Tt&&(Ct.splice(0,Rt,Tt),vt=Ct.join("/"))}return vt}function it(vt,_t){return function(){var Ct=bt.call(arguments,0);return typeof Ct[0]!="string"&&Ct.length===1&&Ct.push(null),ht.apply(tt,Ct.concat([vt,_t]))}}function nt(vt){return function(_t){return rt(_t,vt)}}function st(vt){return function(_t){ft[vt]=_t}}function at(vt){if(_e(gt,vt)){var _t=gt[vt];delete gt[vt],At[vt]=!0,ut.apply(tt,_t)}if(!_e(ft,vt)&&!_e(At,vt))throw new Error("No "+vt);return ft[vt]}function lt(vt){var _t,Ct=vt?vt.indexOf("!"):-1;return Ct>-1&&(_t=vt.substring(0,Ct),vt=vt.substring(Ct+1,vt.length)),[_t,vt]}function ot(vt){return vt?lt(vt):[]}function ct(vt){return function(){return mt&&mt.config&&mt.config[vt]||{}}}var ut,ht,dt,pt,ft={},gt={},mt={},At={},yt=Object.prototype.hasOwnProperty,bt=[].slice,xt=/\.js$/;dt=function(vt,_t){var Ct,St=lt(vt),Et=St[0],Tt=_t[1];return vt=St[1],Et&&(Et=rt(Et,Tt),Ct=at(Et)),Et?vt=Ct&&Ct.normalize?Ct.normalize(vt,nt(Tt)):rt(vt,Tt):(vt=rt(vt,Tt),St=lt(vt),Et=St[0],vt=St[1],Et&&(Ct=at(Et))),{f:Et?Et+"!"+vt:vt,n:vt,pr:Et,p:Ct}},pt={require:function(vt){return it(vt)},exports:function(vt){var _t=ft[vt];return _t!==void 0?_t:ft[vt]={}},module:function(vt){return{id:vt,uri:"",exports:ft[vt],config:ct(vt)}}},ut=function(vt,_t,Ct,St){var Et,Tt,Mt,Rt,It,Ot,Bt,Nt=[],zt=typeof Ct;if(St=St||vt,Ot=ot(St),zt==="undefined"||zt==="function"){for(_t=!_t.length&&Ct.length?["require","exports","module"]:_t,It=0;It<_t.length;It+=1)if(Rt=dt(_t[It],Ot),(Tt=Rt.f)==="require")Nt[It]=pt.require(vt);else if(Tt==="exports")Nt[It]=pt.exports(vt),Bt=!0;else if(Tt==="module")Et=Nt[It]=pt.module(vt);else if(_e(ft,Tt)||_e(gt,Tt)||_e(At,Tt))Nt[It]=at(Tt);else{if(!Rt.p)throw new Error(vt+" missing "+Tt);Rt.p.load(Rt.n,it(St,!0),st(Tt),{}),Nt[It]=ft[Tt]}Mt=Ct?Ct.apply(ft[vt],Nt):void 0,vt&&(Et&&Et.exports!==tt&&Et.exports!==ft[vt]?ft[vt]=Et.exports:Mt===tt&&Bt||(ft[vt]=Mt))}else vt&&(ft[vt]=Ct)},requirejs=require=ht=function(vt,_t,Ct,St,Et){if(typeof vt=="string")return pt[vt]?pt[vt](_t):at(dt(vt,ot(_t)).f);if(!vt.splice){if(mt=vt,mt.deps&&ht(mt.deps,mt.callback),!_t)return;_t.splice?(vt=_t,_t=Ct,Ct=null):vt=tt}return _t=_t||function(){},typeof Ct=="function"&&(Ct=St,St=Et),St?ut(tt,vt,_t,Ct):setTimeout(function(){ut(tt,vt,_t,Ct)},4),ht},ht.config=function(vt){return ht(vt)},requirejs._defined=ft,define=function(vt,_t,Ct){if(typeof vt!="string")throw new Error("See almond README: incorrect module build, no module name");_t.splice||(Ct=_t,_t=[]),_e(ft,vt)||_e(gt,vt)||(gt[vt]=[vt,_t,Ct])},define.amd={jQuery:!0}}(),define("../node_modules/almond/almond",function(){}),define("jxg",[],function(){var tt={};return typeof JXG!="object"||JXG.extend||(tt=JXG),tt.extend=function(_e,rt,it,nt){var st,at;it=it||!1,nt=nt||!1;for(st in rt)(!it||it&&rt.hasOwnProperty(st))&&(at=nt?st.toLowerCase():st,_e[at]=rt[st])},tt.extend(tt,{boards:{},readers:{},elements:{},registerElement:function(_e,rt){_e=_e.toLowerCase(),this.elements[_e]=rt},registerReader:function(_e,rt){var it,nt;for(it=0;it<rt.length;it++)nt=rt[it].toLowerCase(),typeof this.readers[nt]!="function"&&(this.readers[nt]=_e)},shortcut:function(_e,rt){return function(){return _e[rt].apply(this,arguments)}},getRef:function(_e,rt){return tt.deprecated("JXG.getRef()","Board.select()"),_e.select(rt)},getReference:function(_e,rt){return tt.deprecated("JXG.getReference()","Board.select()"),_e.select(rt)},getBoardByContainerId:function(_e){var rt;for(rt in JXG.boards)if(JXG.boards.hasOwnProperty(rt)&&JXG.boards[rt].container===_e)return JXG.boards[rt];return null},deprecated:function(_e,rt){var it=_e+" is deprecated.";rt&&(it+=" Please use "+rt+" instead."),tt.warn(it)},warn:function(_e){typeof window=="object"&&window.console&&console.warn?console.warn("WARNING:",_e):typeof document=="object"&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+_e+"<br />")},debugInt:function(_e){var rt,it;for(rt=0;rt<arguments.length;rt++)it=arguments[rt],typeof window=="object"&&window.console&&console.log?console.log(it):typeof document=="object"&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=it+"<br/>")},debugWST:function(_e){var rt=new Error;tt.debugInt.apply(this,arguments),rt&&rt.stack&&(tt.debugInt("stacktrace"),tt.debugInt(rt.stack.split(`
`).slice(1).join(`
`)))},debugLine:function(_e){var rt=new Error;tt.debugInt.apply(this,arguments),rt&&rt.stack&&tt.debugInt("Called from",rt.stack.split(`
`).slice(2,3).join(`
`))},debug:function(_e){tt.debugInt.apply(this,arguments)}}),tt}),define("base/constants",["jxg"],function(tt){var _e;return _e={version:"0.99.7",licenseText:"JSXGraph v0.99.7 Copyright (C) see http://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82},tt.extend(tt,_e),_e}),define("utils/type",["jxg","base/constants"],function(tt,_e){return tt.extend(tt,{isId:function(rt,it){return typeof it=="string"&&!!rt.objects[it]},isName:function(rt,it){return typeof it=="string"&&!!rt.elementsByName[it]},isGroup:function(rt,it){return typeof it=="string"&&!!rt.groups[it]},isString:function(rt){return typeof rt=="string"},isNumber:function(rt){return typeof rt=="number"||Object.prototype.toString.call(rt)==="[Object Number]"},isFunction:function(rt){return typeof rt=="function"},isArray:function(rt){return Array.isArray?Array.isArray(rt):rt!==null&&typeof rt=="object"&&typeof rt.splice=="function"&&typeof rt.join=="function"},isObject:function(rt){return typeof rt=="object"&&!this.isArray(rt)},isPoint:function(rt){return rt!==null&&typeof rt=="object"&&rt.elementClass===_e.OBJECT_CLASS_POINT},isPointType:function(rt,it){var nt,st;return!!this.isArray(it)||!!(this.isFunction(it)&&(nt=it(),this.isArray(nt)&&nt.length>1))||(st=rt.select(it),this.isPoint(st))},isTransformationOrArray:function(rt){if(rt!==null){if(this.isArray(rt)&&rt.length>0)return this.isTransformationOrArray(rt[0]);if(typeof rt=="object")return rt.type===_e.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(rt){return function(it){return it!=null}}(),def:function(rt,it){return this.exists(rt)?rt:it},str2Bool:function(rt){return!this.exists(rt)||(typeof rt=="boolean"?rt:!!this.isString(rt)&&rt.toLowerCase()==="true")},createEvalFunction:function(rt,it,nt){var st,at=[];for(st=0;st<nt;st++)at[st]=tt.createFunction(it[st],rt,"",!0);return function(lt){return at[lt]()}},createFunction:function(rt,it,nt,st){var at=null;return this.exists(st)&&!st||!this.isString(rt)?this.isFunction(rt)?at=rt:this.isNumber(rt)?at=function(){return rt}:this.isString(rt)&&(at=function(){return rt}):at=it.jc.snippet(rt,!0,nt,!0),at!==null&&(at.origin=rt),at},providePoints:function(rt,it,nt,st,at){var lt,ot,ct,ut,ht,dt=0,pt=[];for(this.isArray(it)||(it=[it]),ct=it.length,this.exists(at)&&(dt=at.length),dt===0&&(ut=this.copyAttributes(nt,rt.options,st)),lt=0;lt<ct;++lt)if(dt>0&&(ot=Math.min(lt,dt-1),ut=this.copyAttributes(nt,rt.options,st,at[ot])),this.isArray(it[lt])&&it[lt].length>1?pt.push(rt.create("point",it[lt],ut)):this.isFunction(it[lt])?(ht=it[lt](),this.isArray(ht)&&ht.length>1&&pt.push(rt.create("point",[it[lt]],ut))):pt.push(rt.select(it[lt])),!this.isPoint(pt[lt]))return!1;return pt},bind:function(rt,it){return function(){return rt.apply(it,arguments)}},evaluate:function(rt){return this.isFunction(rt)?rt():rt},indexOf:function(rt,it,nt){var st,at=this.exists(nt);if(Array.indexOf&&!at)return rt.indexOf(it);for(st=0;st<rt.length;st++)if(at&&rt[st][nt]===it||!at&&rt[st]===it)return st;return-1},eliminateDuplicates:function(rt){var it,nt=rt.length,st=[],at={};for(it=0;it<nt;it++)at[rt[it]]=0;for(it in at)at.hasOwnProperty(it)&&st.push(it);return st},swap:function(rt,it,nt){var st;return st=rt[it],rt[it]=rt[nt],rt[nt]=st,rt},uniqueArray:function(rt){var it,nt,st,at=[];if(rt.length===0)return[];for(it=0;it<rt.length;it++)if(st=this.isArray(rt[it]),this.exists(rt[it]))for(nt=it+1;nt<rt.length;nt++)st&&tt.cmpArrays(rt[it],rt[nt])?rt[it]=[]:st||rt[it]!==rt[nt]||(rt[it]="");else rt[it]="";for(nt=0,it=0;it<rt.length;it++)st=this.isArray(rt[it]),st||rt[it]===""?st&&rt[it].length!==0&&(at[nt]=rt[it].slice(0),nt++):(at[nt]=rt[it],nt++);return rt=at,at},isInArray:function(rt,it){return tt.indexOf(rt,it)>-1},coordsArrayToMatrix:function(rt,it){var nt,st=[],at=[];for(nt=0;nt<rt.length;nt++)it?(st.push(rt[nt].usrCoords[1]),at.push(rt[nt].usrCoords[2])):at.push([rt[nt].usrCoords[1],rt[nt].usrCoords[2]]);return it&&(at=[st,at]),at},cmpArrays:function(rt,it){var nt;if(rt===it)return!0;if(rt.length!==it.length)return!1;for(nt=0;nt<rt.length;nt++)if(this.isArray(rt[nt])&&this.isArray(it[nt])){if(!this.cmpArrays(rt[nt],it[nt]))return!1}else if(rt[nt]!==it[nt])return!1;return!0},removeElementFromArray:function(rt,it){var nt;for(nt=0;nt<rt.length;nt++)if(rt[nt]===it)return rt.splice(nt,1),rt;return rt},trunc:function(rt,it){return it=tt.def(it,0),this.toFixed(rt,it)},_decimalAdjust:function(rt,it,nt){return nt===void 0||+nt==0?Math[rt](it):(it=+it,nt=+nt,isNaN(it)||typeof nt!="number"||nt%1!=0?NaN:(it=it.toString().split("e"),it=Math[rt](+(it[0]+"e"+(it[1]?+it[1]-nt:-nt))),it=it.toString().split("e"),+(it[0]+"e"+(it[1]?+it[1]+nt:nt))))},_round10:function(rt,it){return this._decimalAdjust("round",rt,it)},_floor10:function(rt,it){return this._decimalAdjust("floor",rt,it)},_ceil10:function(rt,it){return this._decimalAdjust("ceil",rt,it)},toFixed:function(rt,it){return this._round10(rt,-it).toFixed(it)},autoDigits:function(rt){var it=Math.abs(rt);return it>.1?this.toFixed(rt,2):it>=.01?this.toFixed(rt,4):it>=1e-4?this.toFixed(rt,6):rt},keys:function(rt,it){var nt,st=[];for(nt in rt)it?rt.hasOwnProperty(nt)&&st.push(nt):st.push(nt);return st},clone:function(rt){var it={};return it.prototype=rt,it},cloneAndCopy:function(rt,it){var nt,st=function(){};st.prototype=rt;for(nt in it)st[nt]=it[nt];return st},merge:function(rt,it){var nt,st;for(nt in it)if(it.hasOwnProperty(nt))if(this.isArray(it[nt]))for(rt[nt]||(rt[nt]=[]),st=0;st<it[nt].length;st++)typeof it[nt][st]=="object"?rt[nt][st]=this.merge(rt[nt][st],it[nt][st]):rt[nt][st]=it[nt][st];else typeof it[nt]=="object"?(rt[nt]||(rt[nt]={}),rt[nt]=this.merge(rt[nt],it[nt])):rt[nt]=it[nt];return rt},deepCopy:function(rt,it,nt){var st,at,lt,ot;if(nt=nt||!1,typeof rt!="object"||rt===null)return rt;if(this.isArray(rt))for(st=[],at=0;at<rt.length;at++)lt=rt[at],typeof lt=="object"?this.exists(lt.board)?st[at]=lt.id:st[at]=this.deepCopy(lt):st[at]=lt;else{st={};for(at in rt)rt.hasOwnProperty(at)&&(ot=nt?at.toLowerCase():at,lt=rt[at],lt!==null&&typeof lt=="object"?this.exists(lt.board)?st[ot]=lt.id:st[ot]=this.deepCopy(lt):st[ot]=lt);for(at in it)it.hasOwnProperty(at)&&(ot=nt?at.toLowerCase():at,lt=it[at],typeof lt=="object"?this.isArray(lt)||!this.exists(st[ot])?st[ot]=this.deepCopy(lt):st[ot]=this.deepCopy(st[ot],lt,nt):st[ot]=lt)}return st},copyAttributes:function(rt,it,nt){var st,at,lt,ot,ct,ut={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(lt=arguments.length,st=lt<3||ut[nt]?tt.deepCopy(it.elements,null,!0):{},lt<4&&this.exists(nt)&&this.exists(it.layer[nt])&&(st.layer=it.layer[nt]),ot=it,ct=!0,at=2;at<lt;at++){if(!this.exists(ot[arguments[at]])){ct=!1;break}ot=ot[arguments[at]]}for(ct&&(st=tt.deepCopy(st,ot,!0)),ot=rt,ct=!0,at=3;at<lt;at++){if(!this.exists(ot[arguments[at]])){ct=!1;break}ot=ot[arguments[at]]}for(ct&&this.extend(st,ot,null,!0),ot=it,ct=!0,at=2;at<lt;at++){if(!this.exists(ot[arguments[at]])){ct=!1;break}ot=ot[arguments[at]]}return ct&&this.exists(ot.label)&&(st.label=tt.deepCopy(ot.label,st.label)),st.label=tt.deepCopy(it.label,st.label),st},copyPrototypeMethods:function(rt,it,nt){var st;rt.prototype[nt]=it.prototype.constructor;for(st in it.prototype)it.prototype.hasOwnProperty(st)&&(rt.prototype[st]=it.prototype[st])},toJSON:function(rt,it){var nt,st,at,lt;if(it=tt.def(it,!1),JSON.stringify&&!it)try{return JSON.stringify(rt)}catch{}switch(typeof rt){case"object":if(rt){if(nt=[],this.isArray(rt)){for(at=0;at<rt.length;at++)nt.push(tt.toJSON(rt[at],it));return"["+nt.join(",")+"]"}for(st in rt)if(rt.hasOwnProperty(st)){try{lt=tt.toJSON(rt[st],it)}catch{lt=""}it?nt.push(st+":"+lt):nt.push('"'+st+'":'+lt)}return"{"+nt.join(",")+"} "}return"null";case"string":return"'"+rt.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return rt.toString()}return"0"},clearVisPropOld:function(rt){return rt.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",transitionduration:0,top:-1e5,visible:null},rt},isInObject:function(rt,it){var nt;for(nt in rt)if(rt.hasOwnProperty(nt)&&rt[nt]===it)return!0;return!1},escapeHTML:function(rt){return rt.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(rt){return rt.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(rt){return rt.charAt(0).toUpperCase()+rt.substring(1).toLowerCase()},trimNumber:function(rt){return rt=rt.replace(/^0+/,""),rt=rt.replace(/0+$/,""),rt[rt.length-1]!=="."&&rt[rt.length-1]!==","||(rt=rt.slice(0,-1)),rt[0]!=="."&&rt[0]!==","||(rt="0"+rt),rt},filterElements:function(rt,it){var nt,st,at,lt,ot,ct,ut,ht=rt.length,dt=[];if(typeof it!="function"&&typeof it!="object")return dt;for(nt=0;nt<ht;nt++){if(ut=!0,at=rt[nt],typeof it=="object"){for(st in it)if(it.hasOwnProperty(st)&&(lt=st.toLowerCase(),ot=typeof at[st]=="function"?at[st]():at[st],ct=at.visProp&&typeof at.visProp[lt]=="function"?at.visProp[lt]():at.visProp&&at.visProp[lt],!(ut=typeof it[st]=="function"?it[st](ot)||it[st](ct):ot===it[st]||ct===it[st])))break}else typeof it=="function"&&(ut=it(at));ut&&dt.push(at)}return dt},trim:function(rt){return rt.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(rt,it){return typeof html_sanitize=="function"&&it?html_sanitize(rt,function(){},function(nt){return nt}):(rt&&(rt=rt.replace(/</g,"&lt;").replace(/>/g,"&gt;")),rt)},evalSlider:function(rt){return rt&&rt.type===_e.OBJECT_TYPE_GLIDER&&typeof rt.Value=="function"?rt.Value():rt}}),tt}),define("utils/env",["jxg","utils/type"],function(tt,_e){return tt.extend(tt,{touchProperty:"touches",isBrowser:typeof window=="object"&&typeof document=="object",supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var rt,it=!1;if(this.isNode())try{rt=module.require("canvas"),it=!!rt}catch{}return it||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&(!!module.exports||typeof commonjsGlobal=="object"&&commonjsGlobal.requirejsVars&&!commonjsGlobal.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&typeof self=="object"&&typeof self.postMessage=="function"},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&window.ontouchstart!==void 0},isAndroid:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return _e.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z\.]*Safari/)>-1},isMetroApp:function(){return typeof window=="object"&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1},isFirefoxOS:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")===-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var rt,it,nt=3;if(typeof document!="object")return 0;rt=document.createElement("div"),it=rt.getElementsByTagName("i");do rt.innerHTML="<!--[if gt IE "+ ++nt+"]><i></i><![endif]-->";while(it[0]);return nt>4?nt:void 0}(),getDimensions:function(rt,it){var nt,st,at,lt,ot,ct,ut,ht,dt,pt=/\d+(\.\d*)?px/;if(!this.isBrowser||rt===null)return{width:500,height:500};if(it=it||document,nt=it.getElementById(rt),!_e.exists(nt))throw new Error(`
JSXGraph: HTML container element '`+rt+"' not found.");return(st=nt.style.display)!=="none"&&st!==null?nt.clientWidth>0&&nt.clientHeight>0?{width:nt.clientWidth,height:nt.clientHeight}:(dt=window.getComputedStyle?window.getComputedStyle(nt):nt.style,{width:pt.test(dt.width)?parseFloat(dt.width):0,height:pt.test(dt.height)?parseFloat(dt.height):0}):(at=nt.style,lt=at.visibility,ot=at.position,ct=at.display,at.visibility="hidden",at.position="absolute",at.display="block",ut=nt.clientWidth,ht=nt.clientHeight,at.display=ct,at.position=ot,at.visibility=lt,{width:ut,height:ht})},addEvent:function(rt,it,nt,st){var at=function(){return nt.apply(st,arguments)};at.origin=nt,st["x_internal"+it]=st["x_internal"+it]||[],st["x_internal"+it].push(at),_e.exists(rt)&&_e.exists(rt.addEventListener)&&rt.addEventListener(it,at,!1),_e.exists(rt)&&_e.exists(rt.attachEvent)&&rt.attachEvent("on"+it,at)},removeEvent:function(rt,it,nt,st){var at;if(!_e.exists(st))return void tt.debug("no such owner");if(!_e.exists(st["x_internal"+it]))return void tt.debug("no such type: "+it);if(!_e.isArray(st["x_internal"+it]))return void tt.debug("owner[x_internal + "+it+"] is not an array");if((at=_e.indexOf(st["x_internal"+it],nt,"origin"))===-1)return void tt.debug("no such event function in internal list: "+nt);try{_e.exists(rt)&&_e.exists(rt.removeEventListener)&&rt.removeEventListener(it,st["x_internal"+it][at],!1),_e.exists(rt)&&_e.exists(rt.detachEvent)&&rt.detachEvent("on"+it,st["x_internal"+it][at])}catch{tt.debug("event not registered in browser: ("+it+" -- "+nt+")")}st["x_internal"+it].splice(at,1)},removeAllEvents:function(rt,it,nt){var st,at;if(nt["x_internal"+it]){for(at=nt["x_internal"+it].length,st=at-1;st>=0;st--)tt.removeEvent(rt,it,nt["x_internal"+it][st].origin,nt);nt["x_internal"+it].length>0&&tt.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(rt,it,nt){var st,at,lt,ot=0,ct=0;if(rt||(rt=window.event),lt=rt[tt.touchProperty],_e.exists(lt)&&lt.length===0&&(lt=rt.changedTouches),_e.exists(it)&&_e.exists(lt))if(it===-1){for(at=lt.length,st=0;st<at;st++)if(lt[st]){rt=lt[st];break}}else rt=lt[it];return rt.clientX&&(ot=rt.clientX,ct=rt.clientY),[ot,ct]},getOffset:function(rt){var it,nt=rt,st=rt,at=nt.offsetLeft-nt.scrollLeft,lt=nt.offsetTop-nt.scrollTop;for(it=this.getCSSTransform([at,lt],nt),at=it[0],lt=it[1],nt=nt.offsetParent;nt;){for(at+=nt.offsetLeft,lt+=nt.offsetTop,nt.offsetParent&&(at+=nt.clientLeft-nt.scrollLeft,lt+=nt.clientTop-nt.scrollTop),it=this.getCSSTransform([at,lt],nt),at=it[0],lt=it[1],st=st.parentNode;st!==nt;)at+=st.clientLeft-st.scrollLeft,lt+=st.clientTop-st.scrollTop,it=this.getCSSTransform([at,lt],st),at=it[0],lt=it[1],st=st.parentNode;nt=nt.offsetParent}return[at,lt]},getStyle:function(rt,it){var nt,st=rt.ownerDocument;return st.defaultView&&st.defaultView.getComputedStyle?nt=st.defaultView.getComputedStyle(rt,null).getPropertyValue(it):rt.currentStyle&&tt.ieVersion>=9?nt=rt.currentStyle[it]:rt.style&&(it=it.replace(/-([a-z]|[0-9])/gi,function(at,lt){return lt.toUpperCase()}),nt=rt.style[it]),nt},getProp:function(rt,it){var nt=parseInt(this.getStyle(rt,it),10);return isNaN(nt)?0:nt},getCSSTransform:function(rt,it){var nt,st,at,lt,ot,ct,ut,ht,dt=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(ct=dt.length,nt=0,at="";nt<ct;nt++)if(_e.exists(it.style[dt[nt]])){at=it.style[dt[nt]];break}if(at!==""&&(ot=at.indexOf("("))>0){for(ct=at.length,lt=at.substring(ot+1,ct-1),ht=lt.split(","),st=0,ut=ht.length;st<ut;st++)ht[st]=parseFloat(ht[st]);at.indexOf("matrix")===0?(rt[0]+=ht[4],rt[1]+=ht[5]):at.indexOf("translateX")===0?rt[0]+=ht[0]:at.indexOf("translateY")===0?rt[1]+=ht[0]:at.indexOf("translate")===0&&(rt[0]+=ht[0],rt[1]+=ht[1])}return _e.exists(it.style.zoom)&&(at=it.style.zoom)!==""&&(rt[0]*=parseFloat(at),rt[1]*=parseFloat(at)),rt},getCSSTransformMatrix:function(rt){var it,nt,st,at,lt,ot,ct,ut,ht,dt=rt.ownerDocument,pt=["transform","webkitTransform","MozTransform","msTransform","oTransform"],ft=[[1,0,0],[0,1,0],[0,0,1]];if(dt.defaultView&&dt.defaultView.getComputedStyle)ht=dt.defaultView.getComputedStyle(rt,null),st=ht.getPropertyValue("-webkit-transform")||ht.getPropertyValue("-moz-transform")||ht.getPropertyValue("-ms-transform")||ht.getPropertyValue("-o-transform")||ht.getPropertyValue("transform");else for(ot=pt.length,it=0,st="";it<ot;it++)if(_e.exists(rt.style[pt[it]])){st=rt.style[pt[it]];break}if(st!==""&&(lt=st.indexOf("("))>0){for(ot=st.length,at=st.substring(lt+1,ot-1),ut=at.split(","),nt=0,ct=ut.length;nt<ct;nt++)ut[nt]=parseFloat(ut[nt]);st.indexOf("matrix")===0?ft=[[1,0,0],[0,ut[0],ut[1]],[0,ut[2],ut[3]]]:st.indexOf("scaleX")===0?ft[1][1]=ut[0]:st.indexOf("scaleY")===0?ft[2][2]=ut[0]:st.indexOf("scale")===0&&(ft[1][1]=ut[0],ft[2][2]=ut[1])}return _e.exists(rt.style.zoom)&&(st=rt.style.zoom)!==""&&(ft[1][1]*=parseFloat(st),ft[2][2]*=parseFloat(st)),ft},timedChunk:function(rt,it,nt,st){var at=rt.concat(),lt=function(){var ot=+new Date;do it.call(nt,at.shift());while(at.length>0&&+new Date-ot<300);at.length>0?window.setTimeout(lt,1):st(rt)};window.setTimeout(lt,1)}}),tt}),define("utils/xml",["jxg","utils/type"],function(tt,_e){return tt.XML={cleanWhitespace:function(rt){for(var it=rt.firstChild;_e.exists(it);)it.nodeType!==3||/\S/.test(it.nodeValue)?it.nodeType===1&&this.cleanWhitespace(it):rt.removeChild(it),it=it.nextSibling},parse:function(rt){var it,nt,st;return st=typeof DOMParser=="function"||typeof DOMParser=="object"?DOMParser:function(){this.parseFromString=function(at){var lt;return typeof ActiveXObject=="function"&&(lt=new ActiveXObject("MSXML.DomDocument"),lt.loadXML(at)),lt}},it=new st,nt=it.parseFromString(rt,"text/xml"),this.cleanWhitespace(nt),nt}},tt.XML}),define("utils/event",["jxg","utils/type"],function(tt,_e){return tt.EventEmitter={eventHandlers:{},suspended:{},trigger:function(rt,it){var nt,st,at,lt,ot,ct;for(ot=rt.length,st=0;st<ot;st++)if(lt=this.eventHandlers[rt[st]],!this.suspended[rt[st]]){if(this.suspended[rt[st]]=!0,lt)for(ct=lt.length,nt=0;nt<ct;nt++)at=lt[nt],at.handler.apply(at.context,it);this.suspended[rt[st]]=!1}return this},on:function(rt,it,nt){return _e.isArray(this.eventHandlers[rt])||(this.eventHandlers[rt]=[]),nt=_e.def(nt,this),this.eventHandlers[rt].push({handler:it,context:nt}),this},off:function(rt,it){var nt;return rt&&_e.isArray(this.eventHandlers[rt])?(it?(nt=_e.indexOf(this.eventHandlers[rt],it,"handler"),nt>-1&&this.eventHandlers[rt].splice(nt,1),this.eventHandlers[rt].length===0&&delete this.eventHandlers[rt]):delete this.eventHandlers[rt],this):this},eventify:function(rt){rt.eventHandlers={},rt.on=this.on,rt.off=this.off,rt.triggerEventHandlers=this.trigger,rt.trigger=this.trigger,rt.suspended={}}},tt.EventEmitter}),define("math/math",["jxg","utils/type"],function(tt,_e){var rt=function(it){var nt,st;return it.memo||(nt={},st=Array.prototype.join,it.memo=function(){var at=st.call(arguments);return nt[at]!==void 0?nt[at]:nt[at]=it.apply(this,arguments)}),it.memo};return tt.Math={eps:1e-6,relDif:function(it,nt){var st=Math.abs(it),at=Math.abs(nt);return at=Math.max(st,at),at===0?0:Math.abs(it-nt)/at},mod:function(it,nt){return it-Math.floor(it/nt)*nt},vector:function(it,nt){var st,at;for(nt=nt||0,st=[],at=0;at<it;at++)st[at]=nt;return st},matrix:function(it,nt,st){var at,lt,ot;for(st=st||0,nt=nt||it,at=[],lt=0;lt<it;lt++)for(at[lt]=[],ot=0;ot<nt;ot++)at[lt][ot]=st;return at},identity:function(it,nt){var st,at;for(nt===void 0&&typeof nt!="number"&&(nt=it),st=this.matrix(it,nt),at=0;at<Math.min(it,nt);at++)st[at][at]=1;return st},frustum:function(it,nt,st,at,lt,ot){var ct=this.matrix(4,4);return ct[0][0]=2*lt/(nt-it),ct[0][1]=0,ct[0][2]=(nt+it)/(nt-it),ct[0][3]=0,ct[1][0]=0,ct[1][1]=2*lt/(at-st),ct[1][2]=(at+st)/(at-st),ct[1][3]=0,ct[2][0]=0,ct[2][1]=0,ct[2][2]=-(ot+lt)/(ot-lt),ct[2][3]=-ot*lt*2/(ot-lt),ct[3][0]=0,ct[3][1]=0,ct[3][2]=-1,ct[3][3]=0,ct},projection:function(it,nt,st,at){var lt=st*Math.tan(it/2),ot=lt*nt;return this.frustum(-ot,ot,-lt,lt,st,at)},matVecMult:function(it,nt){var st,at,lt,ot=it.length,ct=nt.length,ut=[];if(ct===3)for(st=0;st<ot;st++)ut[st]=it[st][0]*nt[0]+it[st][1]*nt[1]+it[st][2]*nt[2];else for(st=0;st<ot;st++){for(at=0,lt=0;lt<ct;lt++)at+=it[st][lt]*nt[lt];ut[st]=at}return ut},matMatMult:function(it,nt){var st,at,lt,ot,ct=it.length,ut=ct>0?nt[0].length:0,ht=nt.length,dt=this.matrix(ct,ut);for(st=0;st<ct;st++)for(at=0;at<ut;at++){for(lt=0,ot=0;ot<ht;ot++)lt+=it[st][ot]*nt[ot][at];dt[st][at]=lt}return dt},transpose:function(it){var nt,st,at,lt,ot;for(lt=it.length,ot=it.length>0?it[0].length:0,nt=this.matrix(ot,lt),st=0;st<ot;st++)for(at=0;at<lt;at++)nt[st][at]=it[at][st];return nt},inverse:function(it){var nt,st,at,lt,ot,ct,ut,ht=it.length,dt=[],pt=[],ft=[];for(nt=0;nt<ht;nt++){for(dt[nt]=[],st=0;st<ht;st++)dt[nt][st]=it[nt][st];pt[nt]=nt}for(st=0;st<ht;st++){for(ot=Math.abs(dt[st][st]),ct=st,nt=st+1;nt<ht;nt++)Math.abs(dt[nt][st])>ot&&(ot=Math.abs(dt[nt][st]),ct=nt);if(ot<=this.eps)return[];if(ct>st){for(at=0;at<ht;at++)ut=dt[st][at],dt[st][at]=dt[ct][at],dt[ct][at]=ut;ut=pt[st],pt[st]=pt[ct],pt[ct]=ut}for(lt=1/dt[st][st],nt=0;nt<ht;nt++)dt[nt][st]*=lt;for(dt[st][st]=lt,at=0;at<ht;at++)if(at!==st){for(nt=0;nt<ht;nt++)nt!==st&&(dt[nt][at]-=dt[nt][st]*dt[st][at]);dt[st][at]=-lt*dt[st][at]}}for(nt=0;nt<ht;nt++){for(at=0;at<ht;at++)ft[pt[at]]=dt[nt][at];for(at=0;at<ht;at++)dt[nt][at]=ft[at]}return dt},innerProduct:function(it,nt,st){var at,lt=0;for(st!==void 0&&_e.isNumber(st)||(st=it.length),at=0;at<st;at++)lt+=it[at]*nt[at];return lt},crossProduct:function(it,nt){return[it[1]*nt[2]-it[2]*nt[1],it[2]*nt[0]-it[0]*nt[2],it[0]*nt[1]-it[1]*nt[0]]},factorial:rt(function(it){return it<0?NaN:(it=Math.floor(it),it===0||it===1?1:it*this.factorial(it-1))}),binomial:rt(function(it,nt){var st,at;if(nt>it||nt<0)return NaN;if(nt=Math.round(nt),it=Math.round(it),nt===0||nt===it)return 1;for(st=1,at=0;at<nt;at++)st*=it-at,st/=at+1;return st}),cosh:function(it){return .5*(Math.exp(it)+Math.exp(-it))},sinh:function(it){return .5*(Math.exp(it)-Math.exp(-it))},pow:function(it,nt){return it===0?nt===0?1:0:Math.floor(nt)===nt?Math.pow(it,nt):it>0?Math.exp(nt*Math.log(Math.abs(it))):NaN},log10:function(it){return Math.log(it)/Math.log(10)},log2:function(it){return Math.log(it)/Math.log(2)},log:function(it,nt){return nt!==void 0&&_e.isNumber(nt)?Math.log(it)/Math.log(nt):Math.log(it)},sign:Math.sign||function(it){return it=+it,it===0||isNaN(it)?it:it>0?1:-1},squampow:function(it,nt){var st;if(Math.floor(nt)===nt){for(st=1,nt<0&&(it=1/it,nt*=-1);nt!==0;)1&nt&&(st*=it),nt>>=1,it*=it;return st}return this.pow(it,nt)},gcd:function(it,nt){if(it=Math.abs(it),nt=Math.abs(nt),!_e.isNumber(it)||!_e.isNumber(nt))return NaN;if(nt>it){var st=it;it=nt,nt=st}for(;;){if((it%=nt)===0)return nt;if((nt%=it)===0)return it}},lcm:function(it,nt){var st;return _e.isNumber(it)&&_e.isNumber(nt)?(st=it*nt,st!==0?st/this.gcd(it,nt):0):NaN},normalize:function(it){var nt,st,at=2*it[3],lt=it[4]/at;return it[5]=lt,it[6]=-it[1]/at,it[7]=-it[2]/at,isFinite(lt)?Math.abs(lt)>=1?(it[0]=(it[6]*it[6]+it[7]*it[7]-lt*lt)/(2*lt),it[1]=-it[6]/lt,it[2]=-it[7]/lt,it[3]=1/(2*lt),it[4]=1):(st=lt<=0?-1:1,it[0]=st*(it[6]*it[6]+it[7]*it[7]-lt*lt)*.5,it[1]=-st*it[6],it[2]=-st*it[7],it[3]=st/2,it[4]=st*lt):(nt=Math.sqrt(it[1]*it[1]+it[2]*it[2]),it[0]/=nt,it[1]/=nt,it[2]/=nt,it[3]=0,it[4]=1),it},toGL:function(it){var nt,st,at;if(nt=typeof Float32Array=="function"?new Float32Array(16):new Array(16),it.length!==4&&it[0].length!==4)return nt;for(st=0;st<4;st++)for(at=0;at<4;at++)nt[st+4*at]=it[st][at];return nt}},tt.Math}),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],function(tt,_e,rt,it,nt){return tt.Coords=function(st,at,lt,ot){this.board=lt,this.usrCoords=[],this.scrCoords=[],this.emitter=!it.exists(ot)||ot,this.emitter&&rt.eventify(this),this.setCoordinates(st,at,!0,!0)},tt.extend(tt.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>nt.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(st){var at=Math.round,lt=this.board,ot=this.usrCoords,ct=lt.origin.scrCoords;st===!0?(this.scrCoords[0]=at(ot[0]),this.scrCoords[1]=at(ot[0]*ct[1]+ot[1]*lt.unitX),this.scrCoords[2]=at(ot[0]*ct[2]-ot[2]*lt.unitY)):(this.scrCoords[0]=ot[0],this.scrCoords[1]=ot[0]*ct[1]+ot[1]*lt.unitX,this.scrCoords[2]=ot[0]*ct[2]-ot[2]*lt.unitY)},screen2usr:function(){var st=this.board.origin.scrCoords,at=this.scrCoords,lt=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(at[1]-st[1])/lt.unitX,this.usrCoords[2]=(st[2]-at[2])/lt.unitY},distance:function(st,at){var lt,ot,ct=0,ut=this.usrCoords,ht=this.scrCoords;if(st===_e.COORDS_BY_USER){if(lt=at.usrCoords,ot=ut[0]-lt[0],(ct=ot*ot)>nt.eps*nt.eps)return Number.POSITIVE_INFINITY;ot=ut[1]-lt[1],ct+=ot*ot,ot=ut[2]-lt[2],ct+=ot*ot}else lt=at.scrCoords,ot=ht[1]-lt[1],ct+=ot*ot,ot=ht[2]-lt[2],ct+=ot*ot;return Math.sqrt(ct)},setCoordinates:function(st,at,lt,ot){var ct=this.usrCoords,ut=this.scrCoords,ht=[ct[0],ct[1],ct[2]],dt=[ut[0],ut[1],ut[2]];return st===_e.COORDS_BY_USER?(at.length===2?(ct[0]=1,ct[1]=at[0],ct[2]=at[1]):(ct[0]=at[0],ct[1]=at[1],ct[2]=at[2],this.normalizeUsrCoords()),this.usr2screen(lt)):(at.length===2?(ut[1]=at[0],ut[2]=at[1]):(ut[1]=at[1],ut[2]=at[2]),this.screen2usr()),!this.emitter||ot||dt[1]===ut[1]&&dt[2]===ut[2]||this.triggerEventHandlers(["update"],[ht,dt]),this},copy:function(st,at){return at===void 0&&(at=0),this[st].slice(at)},__evt__update:function(st,at){},__evt:function(){}}),tt.Coords}),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],function(tt,_e,rt,it){var nt={each:function(st,at,lt){var ot,ct,ut=[];if(_e.exists(st.length))for(ct=st.length,ot=0;ot<ct;ot++)ut.push(at.call(this,st[ot],lt));return ut},coords:function(st,at){var lt=st;return st&&st.elementClass===rt.OBJECT_CLASS_POINT?lt=st.coords:st.usrCoords&&st.scrCoords&&st.usr2screen&&(lt=st),at&&(lt=new it(rt.COORDS_BY_USER,lt.usrCoords,lt.board)),lt},coordsArray:function(st,at){var lt;return lt=_e.isArray(st)?st:this.coords(st).usrCoords,lt.length<3&&lt.unshift(1),at&&(lt=[lt[0],lt[1],lt[2]]),lt}};return tt.Expect=nt,nt}),define("math/qdt",["math/math","utils/type"],function(tt,_e){var rt=function(it){this.capacity=10,this.points=[],this.xlb=it[0],this.xub=it[2],this.ylb=it[3],this.yub=it[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null};return _e.extend(rt.prototype,{contains:function(it,nt){return this.xlb<it&&it<=this.xub&&this.ylb<nt&&nt<=this.yub},insert:function(it){return!!this.contains(it.usrCoords[1],it.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(it),!0):(this.northWest===null&&this.subdivide(),!!this.northWest.insert(it)||!!this.northEast.insert(it)||!!this.southEast.insert(it)||!!this.southWest.insert(it)))},subdivide:function(){var it,nt=this.points.length,st=this.xlb+(this.xub-this.xlb)/2,at=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new rt([this.xlb,this.yub,st,at]),this.northEast=new rt([st,this.yub,this.xub,at]),this.southEast=new rt([this.xlb,at,st,this.ylb]),this.southWest=new rt([st,at,this.xub,this.ylb]),it=0;it<nt;it+=1)this.northWest.insert(this.points[it]),this.northEast.insert(this.points[it]),this.southEast.insert(this.points[it]),this.southWest.insert(this.points[it])},_query:function(it,nt){var st;if(this.contains(it,nt)){if(this.northWest===null)return this;if((st=this.northWest._query(it,nt))||(st=this.northEast._query(it,nt))||(st=this.southEast._query(it,nt))||(st=this.southWest._query(it,nt)))return st}return!1},query:function(it,nt){var st,at;return _e.exists(nt)?(st=it,at=nt):(st=it.usrCoords[1],at=it.usrCoords[2]),this._query(st,at)}}),tt.Quadtree=rt,rt}),define("math/numerics",["jxg","utils/type","math/math"],function(tt,_e,rt){var it={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[.16666666666666666,.3333333333333333,.3333333333333333,.16666666666666666],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return rt.Numerics={Gauss:function(nt,st){var at,lt,ot,ct,ut,ht=rt.eps,dt=nt.length>0?nt[0].length:0;if(dt!==st.length||dt!==nt.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(ct=[],ut=st.slice(0,dt),at=0;at<dt;at++)ct[at]=nt[at].slice(0,dt);for(lt=0;lt<dt;lt++){for(at=dt-1;at>lt;at--)if(Math.abs(ct[at][lt])>ht)if(Math.abs(ct[lt][lt])<ht)_e.swap(ct,at,lt),_e.swap(ut,at,lt);else for(ct[at][lt]/=ct[lt][lt],ut[at]-=ct[at][lt]*ut[lt],ot=lt+1;ot<dt;ot++)ct[at][ot]-=ct[at][lt]*ct[lt][ot];if(Math.abs(ct[lt][lt])<ht)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(ct,ut,!0),ut},backwardSolve:function(nt,st,at){var lt,ot,ct,ut,ht;for(lt=at?st:st.slice(0,st.length),ot=nt.length,ct=nt.length>0?nt[0].length:0,ut=ot-1;ut>=0;ut--){for(ht=ct-1;ht>ut;ht--)lt[ut]-=nt[ut][ht]*lt[ht];lt[ut]/=nt[ut][ut]}return lt},gaussBareiss:function(nt){var st,at,lt,ot,ct,ut,ht,dt,pt,ft=rt.eps;if((ht=nt.length)<=0)return 0;for(nt[0].length<ht&&(ht=nt[0].length),dt=[],ot=0;ot<ht;ot++)dt[ot]=nt[ot].slice(0,ht);for(at=1,lt=1,st=0;st<ht-1;st++){if(ut=dt[st][st],Math.abs(ut)<ft){for(ot=st+1;ot<ht&&!(Math.abs(dt[ot][st])>=ft);ot++);if(ot===ht)return 0;for(ct=st;ct<ht;ct++)pt=dt[ot][ct],dt[ot][ct]=dt[st][ct],dt[st][ct]=pt;lt=-lt,ut=dt[st][st]}for(ot=st+1;ot<ht;ot++)for(ct=st+1;ct<ht;ct++)pt=ut*dt[ot][ct]-dt[ot][st]*dt[st][ct],dt[ot][ct]=pt/at;at=ut}return lt*dt[ht-1][ht-1]},det:function(nt){return nt.length===2&&nt[0].length===2?nt[0][0]*nt[1][1]-nt[1][0]*nt[0][1]:this.gaussBareiss(nt)},Jacobi:function(nt){var st,at,lt,ot,ct,ut,ht,dt,pt=rt.eps,ft=0,gt=nt.length,mt=[[0,0,0],[0,0,0],[0,0,0]],At=[[0,0,0],[0,0,0],[0,0,0]],yt=0;for(st=0;st<gt;st++){for(at=0;at<gt;at++)mt[st][at]=0,At[st][at]=nt[st][at],ft+=Math.abs(At[st][at]);mt[st][st]=1}if(gt===1)return[At,mt];if(ft<=0)return[At,mt];ft/=gt*gt;do{for(dt=0,at=1;at<gt;at++)for(st=0;st<at;st++)if(ot=Math.abs(At[st][at]),dt+=ot,ot>=pt){for(ot=.5*Math.atan2(2*At[st][at],At[st][st]-At[at][at]),ct=Math.sin(ot),ut=Math.cos(ot),lt=0;lt<gt;lt++)ht=At[lt][st],At[lt][st]=ut*ht+ct*At[lt][at],At[lt][at]=-ct*ht+ut*At[lt][at],ht=mt[lt][st],mt[lt][st]=ut*ht+ct*mt[lt][at],mt[lt][at]=-ct*ht+ut*mt[lt][at];for(At[st][st]=ut*At[st][st]+ct*At[at][st],At[at][at]=-ct*At[st][at]+ut*At[at][at],At[st][at]=0,lt=0;lt<gt;lt++)At[st][lt]=At[lt][st],At[at][lt]=At[lt][at]}yt+=1}while(Math.abs(dt)/ft>pt&&yt<2e3);return[At,mt]},NewtonCotes:function(nt,st,at){var lt,ot,ct,ut=0,ht=at&&_e.isNumber(at.number_of_nodes)?at.number_of_nodes:28,dt={trapez:!0,simpson:!0,milne:!0},pt=at&&at.integration_type&&dt.hasOwnProperty(at.integration_type)&&dt[at.integration_type]?at.integration_type:"milne",ft=(nt[1]-nt[0])/ht;switch(pt){case"trapez":for(ut=.5*(st(nt[0])+st(nt[1])),lt=nt[0],ot=0;ot<ht-1;ot++)lt+=ft,ut+=st(lt);ut*=ft;break;case"simpson":if(ht%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(ct=ht/2,ut=st(nt[0])+st(nt[1]),lt=nt[0],ot=0;ot<ct-1;ot++)lt+=2*ft,ut+=2*st(lt);for(lt=nt[0]-ft,ot=0;ot<ct;ot++)lt+=2*ft,ut+=4*st(lt);ut*=ft/3;break;default:if(ht%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(ct=.25*ht,ut=7*(st(nt[0])+st(nt[1])),lt=nt[0],ot=0;ot<ct-1;ot++)lt+=4*ft,ut+=14*st(lt);for(lt=nt[0]-3*ft,ot=0;ot<ct;ot++)lt+=4*ft,ut+=32*(st(lt)+st(lt+2*ft));for(lt=nt[0]-2*ft,ot=0;ot<ct;ot++)lt+=4*ft,ut+=12*st(lt);ut*=2*ft/45}return ut},Romberg:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt=[],mt=0,At=1/0,yt=at&&_e.isNumber(at.max_iterations)?at.max_iterations:20,bt=at&&_e.isNumber(at.eps)?at.eps:at.eps||1e-7;for(lt=nt[0],ot=nt[1],ct=ot-lt,ht=1,gt[0]=.5*ct*(st(lt)+st(ot)),dt=0;dt<yt;++dt){for(ut=0,ct*=.5,ht*=2,ft=1,pt=1;pt<ht;pt+=2)ut+=st(lt+pt*ct);for(gt[dt+1]=.5*gt[dt]+ut*ct,mt=gt[dt+1],pt=dt-1;pt>=0;--pt)ft*=4,gt[pt]=gt[pt+1]+(gt[pt+1]-gt[pt])/(ft-1),mt=gt[pt];if(Math.abs(mt-At)<bt*Math.abs(mt))break;At=mt}return mt},GaussLegendre:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt=0,mt=[],At=[],yt=at&&_e.isNumber(at.n)?at.n:12;if(yt>18&&(yt=18),mt[2]=[.5773502691896257],At[2]=[1],mt[4]=[.33998104358485626,.8611363115940526],At[4]=[.6521451548625461,.34785484513745385],mt[6]=[.2386191860831969,.6612093864662645,.932469514203152],At[6]=[.46791393457269104,.3607615730481386,.17132449237917036],mt[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],At[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],mt[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],At[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],mt[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],At[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],mt[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],At[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],mt[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],At[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],mt[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],At[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],mt[3]=[0,.7745966692414834],At[3]=[.8888888888888888,.5555555555555556],mt[5]=[0,.5384693101056831,.906179845938664],At[5]=[.5688888888888889,.47862867049936647,.23692688505618908],mt[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],At[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],mt[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],At[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],mt[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],At[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],mt[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],At[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],mt[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],At[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],mt[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],At[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],lt=nt[0],ot=nt[1],ut=yt+1>>1,pt=mt[yt],ft=At[yt],dt=.5*(ot-lt),ht=.5*(ot+lt),!0&yt)for(gt=ft[0]*st(ht),ct=1;ct<ut;++ct)gt+=ft[ct]*(st(ht+dt*pt[ct])+st(ht-dt*pt[ct]));else for(gt=0,ct=0;ct<ut;++ct)gt+=ft[ct]*(st(ht+dt*pt[ct])+st(ht-dt*pt[ct]));return dt*gt},_rescale_error:function(nt,st,at){var lt,ot;return nt=Math.abs(nt),at!==0&&nt!==0&&(lt=Math.pow(200*nt/at,1.5),nt=lt<1?at*lt:at),st>20041683600089728e-310&&(ot=11102230246251565e-30*st)>nt&&(nt=ot),nt},_gaussKronrod:function(nt,st,at,lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt=nt[0],vt=nt[1],_t=.5*(xt+vt),Ct=.5*(vt-xt),St=Math.abs(Ct),Et=st(_t),Tt=0,Mt=Et*ct[at-1],Rt=Math.abs(Mt),It=0,Ot=0,Bt=0,Nt=[],zt=[];for(at%2==0&&(Tt=Et*ot[at/2-1]),ht=Math.floor((at-1)/2),pt=0;pt<ht;pt++)ft=2*pt+1,gt=Ct*lt[ft],mt=st(_t-gt),At=st(_t+gt),yt=mt+At,Nt[ft]=mt,zt[ft]=At,Tt+=ot[pt]*yt,Mt+=ct[ft]*yt,Rt+=ct[ft]*(Math.abs(mt)+Math.abs(At));for(ht=Math.floor(at/2),pt=0;pt<ht;pt++)bt=2*pt,gt=Ct*lt[bt],mt=st(_t-gt),At=st(_t+gt),Nt[bt]=mt,zt[bt]=At,Mt+=ct[bt]*(mt+At),Rt+=ct[bt]*(Math.abs(mt)+Math.abs(At));for(Ot=.5*Mt,It=ct[at-1]*Math.abs(Et-Ot),pt=0;pt<at-1;pt++)It+=ct[pt]*(Math.abs(Nt[pt]-Ot)+Math.abs(zt[pt]-Ot));return Bt=(Mt-Tt)*Ct,Mt*=Ct,Rt*=St,It*=St,dt=Mt,ut.abserr=this._rescale_error(Bt,Rt,It),ut.resabs=Rt,ut.resasc=It,dt},GaussKronrod15:function(nt,st,at){var lt=[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],ot=[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],ct=[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782];return this._gaussKronrod(nt,st,8,lt,ot,ct,at)},GaussKronrod21:function(nt,st,at){var lt=[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],ot=[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],ct=[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169];return this._gaussKronrod(nt,st,11,lt,ot,ct,at)},GaussKronrod31:function(nt,st,at){var lt=[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],ot=[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],ct=[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154];return this._gaussKronrod(nt,st,16,lt,ot,ct,at)},_workspace:function(nt,st){return{limit:st,size:0,nrmax:0,i:0,alist:[nt[0]],blist:[nt[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var at,lt,ot,ct,ut,ht=this.size-1,dt=this.limit,pt=this.nrmax,ft=this.order[pt];if(ht<2)return this.order[0]=0,this.order[1]=1,void(this.i=ft);for(at=this.elist[ft];pt>0&&at>this.elist[this.order[pt-1]];)this.order[pt]=this.order[pt-1],pt--;for(ut=ht<dt/2+2?ht:dt-ht+1,ot=pt+1;ot<ut&&at<this.elist[this.order[ot]];)this.order[ot-1]=this.order[ot],ot++;for(this.order[ot-1]=ft,lt=this.elist[ht],ct=ut-1;ct>ot-2&&lt>=this.elist[this.order[ct]];)this.order[ct+1]=this.order[ct],ct--;this.order[ct+1]=ht,ft=this.order[pt],this.i=ft,this.nrmax=pt},set_initial_result:function(at,lt){this.size=1,this.rlist[0]=at,this.elist[0]=lt},update:function(at,lt,ot,ct,ut,ht,dt,pt){var ft=this.i,gt=this.size,mt=this.level[this.i]+1;pt>ct?(this.alist[ft]=ut,this.rlist[ft]=dt,this.elist[ft]=pt,this.level[ft]=mt,this.alist[gt]=at,this.blist[gt]=lt,this.rlist[gt]=ot,this.elist[gt]=ct,this.level[gt]=mt):(this.blist[ft]=lt,this.rlist[ft]=ot,this.elist[ft]=ct,this.level[ft]=mt,this.alist[gt]=ut,this.blist[gt]=ht,this.rlist[gt]=dt,this.elist[gt]=pt,this.level[gt]=mt),this.size++,mt>this.maximum_level&&(this.maximum_level=mt),this.qpsrt()},retrieve:function(){var at=this.i;return{a:this.alist[at],b:this.blist[at],r:this.rlist[at],e:this.elist[at]}},sum_results:function(){var at,lt=this.size,ot=0;for(at=0;at<lt;at++)ot+=this.rlist[at];return ot},subinterval_too_small:function(at,lt,ot){var ct=1.0000000000000222*(Math.abs(lt)+22250738585072014e-321);return Math.abs(at)<=ct&&Math.abs(ot)<=ct}}},Qag:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt=this._workspace(nt,1e3),It=at&&_e.isNumber(at.limit)?at.limit:15,Ot=at&&_e.isNumber(at.epsrel)?at.epsrel:1e-7,Bt=at&&_e.isNumber(at.epsabs)?at.epsabs:1e-7,Nt=at&&_e.isFunction(at.q)?at.q:this.GaussKronrod15,zt={},Dt=0,Ft=0,Ut=0,$t=0,Vt=0,Zt=0,qt=0,sr=0,er=0,ir=0;if(It>Rt.limit&&tt.warn("iteration limit exceeds available workspace"),Bt<=0&&(Ot<50*rt.eps||Ot<5e-29)&&tt.warn("tolerance cannot be acheived with given epsabs and epsrel"),ct=Nt.apply(this,[nt,st,zt]),ut=zt.abserr,ht=zt.resabs,dt=zt.resasc,Rt.set_initial_result(ct,ut),ft=Math.max(Bt,Ot*Math.abs(ct)),gt=11102230246251565e-30*ht,ut<=gt&&ut>ft)return pt=ct,tt.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(ut<=ft&&ut!==dt||ut===0)return pt=ct,pt;if(It===1)return pt=ct,tt.warn("a maximum of one iteration was insufficient"),-1/0;lt=ct,ot=ut,Dt=1;do Vt=0,Zt=0,qt=0,sr=0,er=0,ir=0,Tt=Rt.retrieve(),xt=Tt.a,vt=Tt.b,_t=Tt.r,Ct=Tt.e,mt=xt,At=.5*(xt+vt),yt=At,bt=vt,Vt=Nt.apply(this,[[mt,At],st,zt]),sr=zt.abserr,St=zt.resasc,Zt=Nt.apply(this,[[yt,bt],st,zt]),er=zt.abserr,Et=zt.resasc,qt=Vt+Zt,ir=sr+er,ot+=ir-Ct,lt+=qt-_t,St!==sr&&Et!==er&&(Mt=_t-qt,Math.abs(Mt)<=1e-5*Math.abs(qt)&&ir>=.99*Ct&&Ft++,Dt>=10&&ir>Ct&&Ut++),ft=Math.max(Bt,Ot*Math.abs(lt)),ot>ft&&((Ft>=6||Ut>=20)&&($t=2),Rt.subinterval_too_small(mt,yt,bt)&&($t=3)),Rt.update(mt,At,Vt,sr,yt,bt,Zt,er),Tt=Rt.retrieve(),xt=Tt.a_i,vt=Tt.b_i,_t=Tt.r_i,Ct=Tt.e_i,Dt++;while(Dt<It&&!$t&&ot>ft);return pt=Rt.sum_results(),pt},I:function(nt,st){return this.Qag(nt,st,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(nt,st,at){var lt,ot=0,ct=rt.eps,ut=nt.apply(at,[st]);for(_e.isArray(st)&&(st=st[0]);ot<50&&Math.abs(ut)>ct;)lt=this.D(nt,at)(st),Math.abs(lt)>ct?st-=ut/lt:st+=.2*Math.random()-1,ut=nt.apply(at,[st]),ot+=1;return st},root:function(nt,st,at){return this.fzero(nt,st,at)},generalizedNewton:function(nt,st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t=0;for(this.generalizedNewton.t1memo?(ot=this.generalizedNewton.t1memo,ct=this.generalizedNewton.t2memo):(ot=at,ct=lt),gt=nt.X(ot)-st.X(ct),mt=nt.Y(ot)-st.Y(ct),At=gt*gt+mt*mt,yt=this.D(nt.X,nt),bt=this.D(st.X,st),xt=this.D(nt.Y,nt),vt=this.D(st.Y,st);At>rt.eps&&_t<10;)ut=yt(ot),ht=-bt(ct),dt=xt(ot),pt=-vt(ct),ft=ut*pt-ht*dt,ot-=(pt*gt-ht*mt)/ft,ct-=(ut*mt-dt*gt)/ft,gt=nt.X(ot)-st.X(ct),mt=nt.Y(ot)-st.Y(ct),At=gt*gt+mt*mt,_t+=1;return this.generalizedNewton.t1memo=ot,this.generalizedNewton.t2memo=ct,Math.abs(ot)<Math.abs(ct)?[nt.X(ot),nt.Y(ot)]:[st.X(ct),st.Y(ct)]},Neville:function(nt){var st=[],at=function(lt){return function(ot,ct){var ut,ht,dt,pt=rt.binomial,ft=nt.length,gt=ft-1,mt=0,At=0;if(!ct)for(dt=1,ut=0;ut<ft;ut++)st[ut]=pt(gt,ut)*dt,dt*=-1;for(ht=ot,ut=0;ut<ft;ut++){if(ht===0)return nt[ut][lt]();dt=st[ut]/ht,ht-=1,mt+=nt[ut][lt]()*dt,At+=dt}return mt/At}};return[at("X"),at("Y"),0,function(){return nt.length-1}]},splineDef:function(nt,st){var at,lt,ot,ct=Math.min(nt.length,st.length),ut=[],ht=[],dt=[],pt=[],ft=[],gt=[];if(ct===2)return[0,0];for(lt=0;lt<ct;lt++)at={X:nt[lt],Y:st[lt]},dt.push(at);for(dt.sort(function(mt,At){return mt.X-At.X}),lt=0;lt<ct;lt++)nt[lt]=dt[lt].X,st[lt]=dt[lt].Y;for(lt=0;lt<ct-1;lt++)pt.push(nt[lt+1]-nt[lt]);for(lt=0;lt<ct-2;lt++)ft.push(6*(st[lt+2]-st[lt+1])/pt[lt+1]-6*(st[lt+1]-st[lt])/pt[lt]);for(ut.push(2*(pt[0]+pt[1])),ht.push(ft[0]),lt=0;lt<ct-3;lt++)ot=pt[lt+1]/ut[lt],ut.push(2*(pt[lt+1]+pt[lt+2])-ot*pt[lt+1]),ht.push(ft[lt+1]-ot*ht[lt]);for(gt[ct-3]=ht[ct-3]/ut[ct-3],lt=ct-4;lt>=0;lt--)gt[lt]=(ht[lt]-pt[lt+1]*gt[lt+1])/ut[lt];for(lt=ct-3;lt>=0;lt--)gt[lt+1]=gt[lt];return gt[0]=0,gt[ct-1]=0,gt},splineEval:function(nt,st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt=Math.min(st.length,at.length),mt=1,At=!1,yt=[];for(_e.isArray(nt)?(mt=nt.length,At=!0):nt=[nt],ot=0;ot<mt;ot++){if(nt[ot]<st[0]||st[ot]>st[gt-1])return NaN;for(ct=1;ct<gt&&!(nt[ot]<=st[ct]);ct++);ct-=1,ut=at[ct],ht=(at[ct+1]-at[ct])/(st[ct+1]-st[ct])-(st[ct+1]-st[ct])/6*(lt[ct+1]+2*lt[ct]),dt=lt[ct]/2,pt=(lt[ct+1]-lt[ct])/(6*(st[ct+1]-st[ct])),ft=nt[ot]-st[ct],yt.push(ut+(ht+(dt+pt*ft)*ft)*ft)}return At?yt:yt[0]},generatePolynomialTerm:function(nt,st,at,lt){var ot,ct=[];for(ot=st;ot>=0;ot--)ct=ct.concat(["(",nt[ot].toPrecision(lt),")"]),ot>1?ct=ct.concat(["*",at,"<sup>",ot,"<","/sup> + "]):ot===1&&(ct=ct.concat(["*",at," + "]));return ct.join("")},lagrangePolynomial:function(nt){var st=[],at=function(lt,ot){var ct,ut,ht,dt,pt=nt.length,ft=0,gt=0;if(!ot)for(ct=0;ct<pt;ct++){for(st[ct]=1,ht=nt[ct].X(),ut=0;ut<pt;ut++)ut!==ct&&(st[ct]*=ht-nt[ut].X());st[ct]=1/st[ct]}for(ct=0;ct<pt;ct++){if(ht=nt[ct].X(),lt===ht)return nt[ct].Y();dt=st[ct]/(lt-ht),gt+=dt,ft+=dt*nt[ct].Y()}return ft/gt};return at.getTerm=function(){return""},at},_initCubicPoly:function(nt,st,at,lt){return[nt,at,-3*nt+3*st-2*at-lt,2*nt-2*st+at+lt]},CardinalSpline:function(nt,st,at){var lt,ot,ct,ut,ht=[],dt=this;return ut=_e.isFunction(st)?st:function(){return st},at===void 0&&(at="uniform"),ot=function(pt){return function(ft,gt){var mt,At,yt,bt,xt,vt,_t,Ct,St,Et;if(nt.length<2)return NaN;if(!gt)for(ct=ut(),yt={X:function(){return 2*nt[0].X()-nt[1].X()},Y:function(){return 2*nt[0].Y()-nt[1].Y()},Dist:function(Tt){var Mt=this.X()-Tt.X(),Rt=this.Y()-Tt.Y();return Math.sqrt(Mt*Mt+Rt*Rt)}},bt={X:function(){return 2*nt[nt.length-1].X()-nt[nt.length-2].X()},Y:function(){return 2*nt[nt.length-1].Y()-nt[nt.length-2].Y()},Dist:function(Tt){var Mt=this.X()-Tt.X(),Rt=this.Y()-Tt.Y();return Math.sqrt(Mt*Mt+Rt*Rt)}},lt=[yt].concat(nt,[bt]),Et=lt.length,ht[pt]=[],mt=0;mt<Et-3;mt++)at==="centripetal"?(_t=lt[mt].Dist(lt[mt+1]),Ct=lt[mt+2].Dist(lt[mt+1]),St=lt[mt+3].Dist(lt[mt+2]),_t=Math.sqrt(_t),Ct=Math.sqrt(Ct),St=Math.sqrt(St),Ct<rt.eps&&(Ct=1),_t<rt.eps&&(_t=Ct),St<rt.eps&&(St=Ct),xt=(lt[mt+1][pt]()-lt[mt][pt]())/_t-(lt[mt+2][pt]()-lt[mt][pt]())/(Ct+_t)+(lt[mt+2][pt]()-lt[mt+1][pt]())/Ct,vt=(lt[mt+2][pt]()-lt[mt+1][pt]())/Ct-(lt[mt+3][pt]()-lt[mt+1][pt]())/(St+Ct)+(lt[mt+3][pt]()-lt[mt+2][pt]())/St,xt*=Ct,vt*=Ct,ht[pt][mt]=dt._initCubicPoly(lt[mt+1][pt](),lt[mt+2][pt](),ct*xt,ct*vt)):ht[pt][mt]=dt._initCubicPoly(lt[mt+1][pt](),lt[mt+2][pt](),ct*(lt[mt+2][pt]()-lt[mt][pt]()),ct*(lt[mt+3][pt]()-lt[mt+1][pt]()));return isNaN(ft)?NaN:(Et=nt.length,ft<=0?nt[0][pt]():ft>=Et?nt[Et-1][pt]():(mt=Math.floor(ft))===ft?nt[mt][pt]():(ft-=mt,At=ht[pt][mt],At===void 0?NaN:((At[3]*ft+At[2])*ft+At[1])*ft+At[0]))}},[ot("X"),ot("Y"),0,function(){return nt.length-1}]},CatmullRomSpline:function(nt,st){return this.CardinalSpline(nt,.5,st)},regressionPolynomial:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt="";if(_e.isPoint(nt)&&_e.isFunction(nt.Value))ot=function(){return nt.Value()};else if(_e.isFunction(nt))ot=nt;else{if(!_e.isNumber(nt))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof nt+"'.");ot=function(){return nt}}if(arguments.length===3&&_e.isArray(st)&&_e.isArray(at))ht=0;else if(arguments.length===2&&_e.isArray(st)&&st.length>0&&_e.isPoint(st[0]))ht=1;else{if(!(arguments.length===2&&_e.isArray(st)&&st.length>0&&st[0].usrCoords&&st[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");ht=2}return dt=function(ft,gt){var mt,At,yt,bt,xt,vt,_t,Ct,St,Et=st.length;if(St=Math.floor(ot()),!gt){if(ht===1)for(ct=[],ut=[],mt=0;mt<Et;mt++)ct[mt]=st[mt].X(),ut[mt]=st[mt].Y();if(ht===2)for(ct=[],ut=[],mt=0;mt<Et;mt++)ct[mt]=st[mt].usrCoords[1],ut[mt]=st[mt].usrCoords[2];if(ht===0)for(ct=[],ut=[],mt=0;mt<Et;mt++)_e.isFunction(st[mt])?ct.push(st[mt]()):ct.push(st[mt]),_e.isFunction(at[mt])?ut.push(at[mt]()):ut.push(at[mt]);for(yt=[],At=0;At<Et;At++)yt.push([1]);for(mt=1;mt<=St;mt++)for(At=0;At<Et;At++)yt[At][mt]=yt[At][mt-1]*ct[At];xt=ut,bt=rt.transpose(yt),vt=rt.matMatMult(bt,yt),_t=rt.matVecMult(bt,xt),lt=rt.Numerics.Gauss(vt,_t),pt=rt.Numerics.generatePolynomialTerm(lt,St,"x",3)}for(Ct=lt[St],mt=St-1;mt>=0;mt--)Ct=Ct*ft+lt[mt];return Ct},dt.getTerm=function(){return pt},dt},bezier:function(nt){var st,at,lt=function(ot){return function(ct,ut){var ht=3*Math.floor(ct),dt=ct%1,pt=1-dt;return ut||(at=3*Math.floor((nt.length-1)/3),st=Math.floor(at/3)),ct<0?nt[0][ot]():ct>=st?nt[at][ot]():isNaN(ct)?NaN:pt*pt*(pt*nt[ht][ot]()+3*dt*nt[ht+1][ot]())+(3*pt*nt[ht+2][ot]()+dt*nt[ht+3][ot]())*dt*dt}};return[lt("X"),lt("Y"),0,function(){return Math.floor(nt.length/3)}]},bspline:function(nt,st){var at,lt=[],ot=function(ht,dt){var pt,ft=[];for(pt=0;pt<ht+dt+1;pt++)ft[pt]=pt<dt?0:pt<=ht?pt-dt+1:ht-dt+2;return ft},ct=function(ht,dt,pt,ft,gt){var mt,At,yt,bt,xt,vt=[];for(dt[gt]<=ht&&ht<dt[gt+1]?vt[gt]=1:vt[gt]=0,mt=2;mt<=ft;mt++)for(At=gt-mt+1;At<=gt;At++)yt=At<=gt-mt+1||At<0?0:vt[At],bt=At>=gt?0:vt[At+1],xt=dt[At+mt-1]-dt[At],vt[At]=xt===0?0:(ht-dt[At])/xt*yt,(xt=dt[At+mt]-dt[At+1])!==0&&(vt[At]+=(dt[At+mt]-ht)/xt*bt);return vt},ut=function(ht){return function(dt,pt){var ft,gt,mt,At=nt.length,yt=At-1,bt=st;if(yt<=0)return NaN;if(yt+2<=bt&&(bt=yt+1),dt<=0)return nt[0][ht]();if(dt>=yt-bt+2)return nt[yt][ht]();for(mt=Math.floor(dt)+bt-1,at=ot(yt,bt),lt=ct(dt,at,0,bt,mt),ft=0,gt=mt-bt+1;gt<=mt;gt++)gt<At&&gt>=0&&(ft+=nt[gt][ht]()*lt[gt]);return ft}};return[ut("X"),ut("Y"),0,function(){return nt.length-1}]},D:function(nt,st){return _e.exists(st)?function(at,lt){var ot=1e-5;return(nt.apply(st,[at+ot,lt])-nt.apply(st,[at-ot,lt]))/2e-5}:function(at,lt){var ot=1e-5;return(nt(at+ot,lt)-nt(at-ot,lt))/2e-5}},_riemannValue:function(nt,st,at,lt){var ot,ct,ut,ht;if(lt<0&&(at!=="trapezoidal"&&(nt+=lt),lt*=-1,at==="lower"?at="upper":at==="upper"&&(at="lower")),ht=.01*lt,at==="right")ot=st(nt+lt);else if(at==="middle")ot=st(nt+.5*lt);else if(at==="left"||at==="trapezoidal")ot=st(nt);else if(at==="lower"){for(ot=st(nt),ut=nt+ht;ut<=nt+lt;ut+=ht)(ct=st(ut))<ot&&(ot=ct);ct=st(nt+lt),ct<ot&&(ot=ct)}else if(at==="upper"){for(ot=st(nt),ut=nt+ht;ut<=nt+lt;ut+=ht)(ct=st(ut))>ot&&(ot=ct);ct=st(nt+lt),ct>ot&&(ot=ct)}else ot=at==="random"?st(nt+lt*Math.random()):at==="simpson"?(st(nt)+4*st(nt+.5*lt)+st(nt+lt))/6:st(nt);return ot},riemann:function(nt,st,at,lt,ot){var ct,ut,ht,dt,pt,ft,gt,mt=[],At=[],yt=0,bt=lt,xt=0;if(_e.isArray(nt)?(pt=nt[0],dt=nt[1]):dt=nt,(st=Math.floor(st))<=0)return[mt,At,xt];for(ut=(ot-lt)/st,ct=0;ct<st;ct++)ht=this._riemannValue(bt,dt,at,ut),mt[yt]=bt,At[yt]=ht,yt+=1,bt+=ut,at==="trapezoidal"&&(ht=dt(bt)),mt[yt]=bt,At[yt]=ht,yt+=1;for(ct=0;ct<st;ct++)ht=pt?this._riemannValue(bt,pt,at,-ut):0,mt[yt]=bt,At[yt]=ht,yt+=1,bt-=ut,at==="trapezoidal"&&pt&&(ht=pt(bt)),mt[yt]=bt,At[yt]=ht,at!=="trapezoidal"?(ft=ht,gt=At[2*(st-1)-2*ct]):(gt=.5*(dt(bt+ut)+dt(bt)),ft=pt?.5*(pt(bt+ut)+pt(bt)):0),xt+=(gt-ft)*ut,yt+=1,mt[yt]=bt,At[yt]=At[2*(st-1)-2*ct],yt+=1;return[mt,At,xt]},riemannsum:function(nt,st,at,lt,ot){return tt.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(nt,st,at,lt,ot)[2]},rungeKutta:function(nt,st,at,lt,ot){var ct,ut,ht,dt,pt,ft,gt=[],mt=[],At=(at[1]-at[0])/lt,yt=at[0],bt=st.length,xt=[],vt=0;for(_e.isString(nt)&&(nt=it[nt]||it.euler),ft=nt.s,ct=0;ct<bt;ct++)gt[ct]=st[ct];for(ut=0;ut<lt;ut++){for(xt[vt]=[],ct=0;ct<bt;ct++)xt[vt][ct]=gt[ct];for(vt+=1,dt=[],ht=0;ht<ft;ht++){for(ct=0;ct<bt;ct++)mt[ct]=0;for(pt=0;pt<ht;pt++)for(ct=0;ct<bt;ct++)mt[ct]+=nt.A[ht][pt]*At*dt[pt][ct];for(ct=0;ct<bt;ct++)mt[ct]+=gt[ct];dt.push(ot(yt+nt.c[ht]*At,mt))}for(ct=0;ct<bt;ct++)mt[ct]=0;for(pt=0;pt<ft;pt++)for(ct=0;ct<bt;ct++)mt[ct]+=nt.b[pt]*dt[pt][ct];for(ct=0;ct<bt;ct++)gt[ct]=gt[ct]+At*mt[ct];yt+=At}return xt},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt=rt.eps,Rt=this.maxIterationsRoot,It=0;if(_e.isArray(st)){if(st.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");lt=st[0],ut=nt.call(at,lt),ot=st[1],ht=nt.call(at,ot)}else{for(lt=st,ut=nt.call(at,lt),pt=lt===0?1:lt,ft=[.9*pt,1.1*pt,pt-1,pt+1,.5*pt,1.5*pt,-pt,2*pt,-10*pt,10*pt],mt=ft.length,gt=0;gt<mt&&(ot=ft[gt],ht=nt.call(at,ot),!(ut*ht<=0));gt++);ot<lt&&(At=lt,lt=ot,ot=At,yt=ut,ut=ht,ht=yt)}if(ut*ht>0)return _e.isArray(st)?this.fminbr(nt,[lt,ot],at):this.Newton(nt,lt,at);for(ct=lt,dt=ut;It<Rt;){if(bt=ot-lt,Math.abs(dt)<Math.abs(ht)&&(lt=ot,ot=ct,ct=lt,ut=ht,ht=dt,dt=ut),Ct=2*Mt*Math.abs(ot)+.5*Mt,Tt=.5*(ct-ot),Math.abs(Tt)<=Ct&&Math.abs(ht)<=Mt)return ot;Math.abs(bt)>=Ct&&Math.abs(ut)>Math.abs(ht)&&(vt=ct-ot,lt===ct?(xt=ht/ut,St=vt*xt,Et=1-xt):(Et=ut/dt,xt=ht/dt,_t=ht/ut,St=_t*(vt*Et*(Et-xt)-(ot-lt)*(xt-1)),Et=(Et-1)*(xt-1)*(_t-1)),St>0?Et=-Et:St=-St,St<.75*vt*Et-.5*Math.abs(Ct*Et)&&St<Math.abs(bt*Et*.5)&&(Tt=St/Et)),Math.abs(Tt)<Ct&&(Tt=Tt>0?Ct:-Ct),lt=ot,ut=ht,ot+=Tt,ht=nt.call(at,ot),(ht>0&&dt>0||ht<0&&dt<0)&&(ct=lt,dt=ut),It++}return ot},fminbr:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=.5*(3-Math.sqrt(5)),St=rt.eps,Et=rt.eps,Tt=this.maxIterationsMinimize,Mt=0;if(!_e.isArray(st)||st.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(lt=st[0],ot=st[1],ut=lt+Ct*(ot-lt),pt=nt.call(at,ut),ct=ut,ht=ut,dt=pt,ft=pt;Mt<Tt;){if(gt=ot-lt,mt=.5*(lt+ot),At=Et*Math.abs(ct)+St/3,Math.abs(ct-mt)+.5*gt<=2*At)return ct;yt=Ct*(ct<mt?ot-ct:lt-ct),Math.abs(ct-ht)>=At&&(vt=(ct-ht)*(dt-pt),xt=(ct-ut)*(dt-ft),bt=(ct-ut)*xt-(ct-ht)*vt,xt=2*(xt-vt),xt>0?bt=-bt:xt=-xt,Math.abs(bt)<Math.abs(yt*xt)&&bt>xt*(lt-ct+2*At)&&bt<xt*(ot-ct-2*At)&&(yt=bt/xt)),Math.abs(yt)<At&&(yt=yt>0?At:-At),vt=ct+yt,_t=nt.call(at,vt),_t<=dt?(vt<ct?ot=ct:lt=ct,ut=ht,ht=ct,ct=vt,pt=ft,ft=dt,dt=_t):(vt<ct?lt=vt:ot=vt,_t<=ft||ht===ct?(ut=ht,ht=vt,pt=ft,ft=_t):(_t<=pt||ut===ct||ut===ht)&&(ut=vt,pt=_t)),Mt+=1}return ct},RamerDouglasPeucker:function(nt,st){var at,lt,ot,ct=[],ut=function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt=0,Mt=pt;if(ft-pt<2)return[-1,0];if(At=dt[pt].scrCoords,yt=dt[ft].scrCoords,isNaN(At[1]+At[2]))return[NaN,pt];if(isNaN(yt[1]+yt[2]))return[NaN,ft];for(mt=pt+1;mt<ft;mt++){if(bt=dt[mt].scrCoords,isNaN(bt[1]+bt[2]))return[NaN,mt];xt=bt[1]-At[1],vt=bt[2]-At[2],_t=yt[1]-At[1],Ct=yt[2]-At[2],St=_t*_t+Ct*Ct,St>=rt.eps?(Et=(xt*_t+vt*Ct)/St,Et<0?Et=0:Et>1&&(Et=1),xt-=Et*_t,vt-=Et*Ct,gt=xt*xt+vt*vt):(Et=0,gt=xt*xt+vt*vt),gt>Tt&&(Tt=gt,Mt=mt)}return[Math.sqrt(Tt),Mt]},ht=function(dt,pt,ft,gt,mt){var At=ut(dt,pt,ft),yt=At[1];if(isNaN(At[0])){ht(dt,pt,yt-1,gt,mt),mt.push(dt[yt]);do++yt;while(yt<=ft&&isNaN(dt[yt].scrCoords[1]+dt[yt].scrCoords[2]));yt<=ft&&mt.push(dt[yt]),ht(dt,yt+1,ft,gt,mt)}else At[0]>gt?(ht(dt,pt,yt,gt,mt),ht(dt,yt,ft,gt,mt)):mt.push(dt[ft])};for(ot=nt.length,at=0;at<ot&&isNaN(nt[at].scrCoords[1]+nt[at].scrCoords[2]);)at+=1;for(lt=ot-1;lt>at&&isNaN(nt[lt].scrCoords[1]+nt[lt].scrCoords[2]);)lt-=1;return at>lt||at===ot||(ct[0]=nt[at],ht(nt,at,lt,st,ct)),ct},RamerDouglasPeuker:function(nt,st){return tt.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(nt,st)},Visvalingam:function(nt,st){var at,lt,ot,ct,ut,ht,dt,pt,ft,gt=[],mt=[],At=[];if((lt=nt.length)<=2)return nt;for(gt[0]={used:!0,lft:null,node:null},ut=0,at=1;at<lt-1;at++)ot=Math.abs(tt.Math.Numerics.det([nt[at-1].usrCoords,nt[at].usrCoords,nt[at+1].usrCoords])),isNaN(ot)||(ft={v:ot,idx:at},mt.push(ft),gt[at]={used:!0,lft:ut,node:ft},gt[ut].rt=at,ut=at);for(gt[lt-1]={used:!0,rt:null,lft:ut,node:null},gt[ut].rt=lt-1,ct=-1/0;mt.length>st;)mt.sort(function(yt,bt){return bt.v-yt.v}),at=mt.pop().idx,gt[at].used=!1,ct=gt[at].node.v,ut=gt[at].lft,ht=gt[at].rt,gt[ut].rt=ht,gt[ht].lft=ut,dt=gt[ut].lft,dt!==null&&(ot=Math.abs(tt.Math.Numerics.det([nt[dt].usrCoords,nt[ut].usrCoords,nt[ht].usrCoords])),gt[ut].node.v=ot>=ct?ot:ct),(pt=gt[ht].rt)!==null&&(ot=Math.abs(tt.Math.Numerics.det([nt[ut].usrCoords,nt[ht].usrCoords,nt[pt].usrCoords])),gt[ht].node.v=ot>=ct?ot:ct);at=0,At=[nt[at]];do at=gt[at].rt,At.push(nt[at]);while(gt[at].rt!==null);return At}},rt.Numerics}),define("math/statistics",["jxg","math/math","utils/type"],function(tt,_e,rt){return _e.Statistics={sum:function(it){var nt,st=it.length,at=0;for(nt=0;nt<st;nt++)at+=it[nt];return at},prod:function(it){var nt,st=it.length,at=1;for(nt=0;nt<st;nt++)at*=it[nt];return at},mean:function(it){return it.length>0?this.sum(it)/it.length:0},median:function(it){var nt,st;return it.length>0?(nt=it.slice(0),nt.sort(function(at,lt){return at-lt}),st=nt.length,st%2==1?nt[parseInt(.5*st,10)]:.5*(nt[.5*st-1]+nt[.5*st])):0},variance:function(it){var nt,st,at,lt=it.length;if(lt>1){for(nt=this.mean(it),st=0,at=0;at<lt;at++)st+=(it[at]-nt)*(it[at]-nt);return st/(it.length-1)}return 0},sd:function(it){return Math.sqrt(this.variance(it))},weightedMean:function(it,nt){if(it.length!==nt.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return it.length>0?this.mean(this.multiply(it,nt)):0},max:function(it){return Math.max.apply(this,it)},min:function(it){return Math.min.apply(this,it)},range:function(it){return[this.min(it),this.max(it)]},abs:function(it){var nt,st,at;if(rt.isArray(it))for(st=it.length,at=[],nt=0;nt<st;nt++)at[nt]=Math.abs(it[nt]);else at=Math.abs(it);return at},add:function(it,nt){var st,at,lt=[];if(it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(at=it.length,st=0;st<at;st++)lt[st]=it[st]+nt;else if(rt.isNumber(it)&&rt.isArray(nt))for(at=nt.length,st=0;st<at;st++)lt[st]=it+nt[st];else if(rt.isArray(it)&&rt.isArray(nt))for(at=Math.min(it.length,nt.length),st=0;st<at;st++)lt[st]=it[st]+nt[st];else lt=it+nt;return lt},div:function(it,nt){var st,at,lt=[];if(it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(at=it.length,st=0;st<at;st++)lt[st]=it[st]/nt;else if(rt.isNumber(it)&&rt.isArray(nt))for(at=nt.length,st=0;st<at;st++)lt[st]=it/nt[st];else if(rt.isArray(it)&&rt.isArray(nt))for(at=Math.min(it.length,nt.length),st=0;st<at;st++)lt[st]=it[st]/nt[st];else lt=it/nt;return lt},divide:function(){tt.deprecated("Statistics.divide()","Statistics.div()"),_e.Statistics.div.apply(_e.Statistics,arguments)},mod:function(it,nt,st){var at,lt,ot=[],ct=function(ut,ht){return ut%ht};if(st=rt.def(st,!1),st&&(ct=_e.mod),it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(lt=it.length,at=0;at<lt;at++)ot[at]=ct(it[at],nt);else if(rt.isNumber(it)&&rt.isArray(nt))for(lt=nt.length,at=0;at<lt;at++)ot[at]=ct(it,nt[at]);else if(rt.isArray(it)&&rt.isArray(nt))for(lt=Math.min(it.length,nt.length),at=0;at<lt;at++)ot[at]=ct(it[at],nt[at]);else ot=ct(it,nt);return ot},multiply:function(it,nt){var st,at,lt=[];if(it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(at=it.length,st=0;st<at;st++)lt[st]=it[st]*nt;else if(rt.isNumber(it)&&rt.isArray(nt))for(at=nt.length,st=0;st<at;st++)lt[st]=it*nt[st];else if(rt.isArray(it)&&rt.isArray(nt))for(at=Math.min(it.length,nt.length),st=0;st<at;st++)lt[st]=it[st]*nt[st];else lt=it*nt;return lt},subtract:function(it,nt){var st,at,lt=[];if(it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(at=it.length,st=0;st<at;st++)lt[st]=it[st]-nt;else if(rt.isNumber(it)&&rt.isArray(nt))for(at=nt.length,st=0;st<at;st++)lt[st]=it-nt[st];else if(rt.isArray(it)&&rt.isArray(nt))for(at=Math.min(it.length,nt.length),st=0;st<at;st++)lt[st]=it[st]-nt[st];else lt=it-nt;return lt},TheilSenRegression:function(it){var nt,st,at=[],lt=[],ot=[];for(nt=0;nt<it.length;nt++){for(lt.length=0,st=0;st<it.length;st++)Math.abs(it[st].usrCoords[1]-it[nt].usrCoords[1])>_e.eps&&(lt[st]=(it[st].usrCoords[2]-it[nt].usrCoords[2])/(it[st].usrCoords[1]-it[nt].usrCoords[1]));at[nt]=this.median(lt),ot.push(it[nt].usrCoords[2]-at[nt]*it[nt].usrCoords[1])}return[this.median(ot),this.median(at),-1]}},_e.Statistics}),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],function(tt,_e,rt,it,nt,st,at){return it.Geometry={},tt.extend(it.Geometry,{angle:function(lt,ot,ct){var ut,ht,dt,pt,ft=[],gt=[],mt=[];return tt.deprecated("Geometry.angle()","Geometry.rad()"),lt.coords?(ft[0]=lt.coords.usrCoords[1],ft[1]=lt.coords.usrCoords[2]):(ft[0]=lt[0],ft[1]=lt[1]),ot.coords?(gt[0]=ot.coords.usrCoords[1],gt[1]=ot.coords.usrCoords[2]):(gt[0]=ot[0],gt[1]=ot[1]),ct.coords?(mt[0]=ct.coords.usrCoords[1],mt[1]=ct.coords.usrCoords[2]):(mt[0]=ct[0],mt[1]=ct[1]),ut=ft[0]-gt[0],ht=ft[1]-gt[1],dt=mt[0]-gt[0],pt=mt[1]-gt[1],Math.atan2(ut*pt-ht*dt,ut*dt+ht*pt)},trueAngle:function(lt,ot,ct){return 57.29577951308232*this.rad(lt,ot,ct)},rad:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt;return lt.coords?(ut=lt.coords.usrCoords[1],ht=lt.coords.usrCoords[2]):(ut=lt[0],ht=lt[1]),ot.coords?(dt=ot.coords.usrCoords[1],pt=ot.coords.usrCoords[2]):(dt=ot[0],pt=ot[1]),ct.coords?(ft=ct.coords.usrCoords[1],gt=ct.coords.usrCoords[2]):(ft=ct[0],gt=ct[1]),mt=Math.atan2(gt-pt,ft-dt)-Math.atan2(ht-pt,ut-dt),mt<0&&(mt+=6.283185307179586),mt},angleBisector:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt=lt.coords.usrCoords,At=ot.coords.usrCoords,yt=ct.coords.usrCoords;return st.exists(ut)||(ut=lt.board),At[0]===0?new rt(_e.COORDS_BY_USER,[1,.5*(mt[1]+yt[1]),.5*(mt[2]+yt[2])],ut):(ft=mt[1]-At[1],gt=mt[2]-At[2],ht=Math.atan2(gt,ft),ft=yt[1]-At[1],gt=yt[2]-At[2],dt=Math.atan2(gt,ft),pt=.5*(ht+dt),ht>dt&&(pt+=Math.PI),ft=Math.cos(pt)+At[1],gt=Math.sin(pt)+At[2],new rt(_e.COORDS_BY_USER,[1,ft,gt],ut))},reflection:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At=ot.coords.usrCoords,yt=lt.point1.coords.usrCoords,bt=lt.point2.coords.usrCoords;return st.exists(ct)||(ct=ot.board),ft=bt[1]-yt[1],gt=bt[2]-yt[2],ut=At[1]-yt[1],ht=At[2]-yt[2],mt=(ft*ht-gt*ut)/(ft*ft+gt*gt),dt=At[1]+2*mt*gt,pt=At[2]-2*mt*ft,new rt(_e.COORDS_BY_USER,[dt,pt],ct)},rotation:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At=ot.coords.usrCoords,yt=lt.coords.usrCoords;return st.exists(ut)||(ut=ot.board),ht=At[1]-yt[1],dt=At[2]-yt[2],pt=Math.cos(ct),ft=Math.sin(ct),gt=ht*pt-dt*ft+yt[1],mt=ht*ft+dt*pt+yt[2],new rt(_e.COORDS_BY_USER,[gt,mt],ut)},perpendicular:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt=lt.point1.coords.usrCoords,mt=lt.point2.coords.usrCoords,At=ot.coords.usrCoords;return st.exists(ct)||(ct=ot.board),ot===lt.point1?(ut=gt[1]+mt[2]-gt[2],ht=gt[2]-mt[1]+gt[1],ft=gt[0]*mt[0],Math.abs(ft)<it.eps&&(ut=mt[2],ht=-mt[1]),pt=[ft,ut,ht],dt=!0):ot===lt.point2?(ut=mt[1]+gt[2]-mt[2],ht=mt[2]-gt[1]+mt[1],ft=gt[0]*mt[0],Math.abs(ft)<it.eps&&(ut=gt[2],ht=-gt[1]),pt=[ft,ut,ht],dt=!1):Math.abs(it.innerProduct(At,lt.stdform,3))<it.eps?(ut=At[1]+mt[2]-At[2],ht=At[2]-mt[1]+At[1],ft=mt[0],Math.abs(ft)<it.eps&&(ut=mt[2],ht=-mt[1]),dt=!0,Math.abs(ft)>it.eps&&Math.abs(ut-At[1])<it.eps&&Math.abs(ht-At[2])<it.eps&&(ut=At[1]+gt[2]-At[2],ht=At[2]-gt[1]+At[1],dt=!1),pt=[ft,ut,ht]):(pt=[0,lt.stdform[1],lt.stdform[2]],pt=it.crossProduct(pt,At),pt=it.crossProduct(pt,lt.stdform),dt=!0),[new rt(_e.COORDS_BY_USER,pt,ct),dt]},circumcenterMidpoint:function(){tt.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt=lt.coords.usrCoords,mt=ot.coords.usrCoords,At=ct.coords.usrCoords;return st.exists(ut)||(ut=lt.board),ht=[mt[0]-gt[0],-mt[2]+gt[2],mt[1]-gt[1]],dt=[.5*(gt[0]+mt[0]),.5*(gt[1]+mt[1]),.5*(gt[2]+mt[2])],pt=it.crossProduct(ht,dt),ht=[At[0]-mt[0],-At[2]+mt[2],At[1]-mt[1]],dt=[.5*(mt[0]+At[0]),.5*(mt[1]+At[1]),.5*(mt[2]+At[2])],ft=it.crossProduct(ht,dt),new rt(_e.COORDS_BY_USER,it.crossProduct(pt,ft),ut)},distance:function(lt,ot,ct){var ut,ht=0;for(ct||(ct=Math.min(lt.length,ot.length)),ut=0;ut<ct;ut++)ht+=(lt[ut]-ot[ut])*(lt[ut]-ot[ut]);return Math.sqrt(ht)},affineDistance:function(lt,ot,ct){var ut;return ut=this.distance(lt,ot,ct),ut>it.eps&&(Math.abs(lt[0])<it.eps||Math.abs(ot[0])<it.eps)?1/0:ut},sortVertices:function(lt){var ot,ct,ut=at.each(lt,at.coordsArray),ht=ut.length;for(ot=1;ot<ht;ot++)(ut[ot][2]<ut[0][2]||Math.abs(ut[ot][2]-ut[0][2])<it.eps&&ut[ot][1]<ut[0][1])&&(ut=st.swap(ut,ot,0));return ct=ut.shift(),ut.sort(function(dt,pt){return Math.atan2(dt[2]-ct[2],dt[1]-ct[1])-Math.atan2(pt[2]-ct[2],pt[1]-ct[1])}),ut.unshift(ct),ut.unshift(ut[ut.length-1]),ut},signedTriangle:function(lt,ot,ct){var ut=at.coordsArray(lt),ht=at.coordsArray(ot),dt=at.coordsArray(ct);return .5*((ht[1]-ut[1])*(dt[2]-ut[2])-(ht[2]-ut[2])*(dt[1]-ut[1]))},signedPolygon:function(lt,ot){var ct,ut,ht=0,dt=at.each(lt,at.coordsArray);for(ot===void 0&&(ot=!0),ot?dt.unshift(dt[dt.length-1]):dt=this.sortVertices(dt),ut=dt.length,ct=1;ct<ut;ct++)ht+=dt[ct-1][1]*dt[ct][2]-dt[ct][1]*dt[ct-1][2];return .5*ht},GrahamScan:function(lt){var ot,ct=1,ut=at.each(lt,at.coordsArray),ht=ut.length;for(ut=this.sortVertices(ut),ht=ut.length,ot=2;ot<ht;ot++){for(;this.signedTriangle(ut[ct-1],ut[ct],ut[ot])<=0;)if(ct>1)ct-=1;else{if(ot===ht-1)break;ot+=1}ct+=1,ut=st.swap(ut,ct,ot)}return ut.slice(0,ct)},calcStraight:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt;if(st.exists(ut)||(ut=10),mt=st.evaluate(lt.visProp.straightfirst),At=st.evaluate(lt.visProp.straightlast),Math.abs(ot.scrCoords[0])<it.eps&&(mt=!0),Math.abs(ct.scrCoords[0])<it.eps&&(At=!0),(mt||At)&&(yt=[],yt[0]=lt.stdform[0]-lt.stdform[1]*lt.board.origin.scrCoords[1]/lt.board.unitX+lt.stdform[2]*lt.board.origin.scrCoords[2]/lt.board.unitY,yt[1]=lt.stdform[1]/lt.board.unitX,yt[2]=-lt.stdform[2]/lt.board.unitY,!isNaN(yt[0]+yt[1]+yt[2]))){if(ht=!1,dt=!1,ht=!mt&&Math.abs(ot.usrCoords[0])>=it.eps&&ot.scrCoords[1]>=0&&ot.scrCoords[1]<=lt.board.canvasWidth&&ot.scrCoords[2]>=0&&ot.scrCoords[2]<=lt.board.canvasHeight,dt=!At&&Math.abs(ct.usrCoords[0])>=it.eps&&ct.scrCoords[1]>=0&&ct.scrCoords[1]<=lt.board.canvasWidth&&ct.scrCoords[2]>=0&&ct.scrCoords[2]<=lt.board.canvasHeight,pt=this.meetLineBoard(yt,lt.board,ut),ft=pt[0],gt=pt[1],!ht&&!dt&&(!mt&&At&&!this.isSameDirection(ot,ct,ft)&&!this.isSameDirection(ot,ct,gt)||mt&&!At&&!this.isSameDirection(ct,ot,ft)&&!this.isSameDirection(ct,ot,gt)))return;ht?dt||(xt=this.isSameDir(ot,ct,ft,gt)?gt:ft):dt?bt=this.isSameDir(ot,ct,ft,gt)?ft:gt:this.isSameDir(ot,ct,ft,gt)?(bt=ft,xt=gt):(xt=ft,bt=gt),bt&&ot.setCoordinates(_e.COORDS_BY_USER,bt.usrCoords),xt&&ct.setCoordinates(_e.COORDS_BY_USER,xt.usrCoords)}},calcLineDelimitingPoints:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt=!1,vt=!1;if(gt=st.evaluate(lt.visProp.straightfirst),mt=st.evaluate(lt.visProp.straightlast),Math.abs(ot.scrCoords[0])<it.eps&&(gt=!0),Math.abs(ct.scrCoords[0])<it.eps&&(mt=!0),At=[],At[0]=lt.stdform[0]-lt.stdform[1]*lt.board.origin.scrCoords[1]/lt.board.unitX+lt.stdform[2]*lt.board.origin.scrCoords[2]/lt.board.unitY,At[1]=lt.stdform[1]/lt.board.unitX,At[2]=-lt.stdform[2]/lt.board.unitY,!isNaN(At[0]+At[1]+At[2])){if(xt=!gt,vt=!mt,ht=lt.board.getBoundingBox(),dt=lt.getSlope(),dt>=0?(pt=this.projectPointToLine({coords:{usrCoords:[1,ht[2],ht[1]]}},lt,lt.board),ft=this.projectPointToLine({coords:{usrCoords:[1,ht[0],ht[3]]}},lt,lt.board)):(pt=this.projectPointToLine({coords:{usrCoords:[1,ht[0],ht[1]]}},lt,lt.board),ft=this.projectPointToLine({coords:{usrCoords:[1,ht[2],ht[3]]}},lt,lt.board)),!xt&&!vt&&(!gt&&!mt&&(ut=ot.distance(_e.COORDS_BY_USER,ct),Math.abs(ot.distance(_e.COORDS_BY_USER,pt)+pt.distance(_e.COORDS_BY_USER,ct)-ut)>it.eps||Math.abs(ot.distance(_e.COORDS_BY_USER,ft)+ft.distance(_e.COORDS_BY_USER,ct)-ut)>it.eps)||!gt&&mt&&!this.isSameDirection(ot,ct,pt)&&!this.isSameDirection(ot,ct,ft)||gt&&!mt&&!this.isSameDirection(ct,ot,pt)&&!this.isSameDirection(ct,ot,ft)))return;xt?vt||(bt=this.isSameDir(ot,ct,pt,ft)?ft:pt):vt?yt=this.isSameDir(ot,ct,pt,ft)?pt:ft:this.isSameDir(ot,ct,pt,ft)?(yt=pt,bt=ft):(bt=pt,yt=ft),yt&&ot.setCoordinates(_e.COORDS_BY_USER,yt.usrCoords),bt&&ct.setCoordinates(_e.COORDS_BY_USER,bt.usrCoords)}},calcLabelQuadrant:function(lt){var ot;return lt<0&&(lt+=2*Math.PI),ot=Math.floor((lt+Math.PI/8)/(Math.PI/4))%8,["rt","urt","top","ulft","lft","llft","lrt"][ot]},isSameDir:function(lt,ot,ct,ut){var ht=ot.usrCoords[1]-lt.usrCoords[1],dt=ot.usrCoords[2]-lt.usrCoords[2],pt=ut.usrCoords[1]-ct.usrCoords[1],ft=ut.usrCoords[2]-ct.usrCoords[2];return Math.abs(ot.usrCoords[0])<it.eps&&(ht=ot.usrCoords[1],dt=ot.usrCoords[2]),Math.abs(lt.usrCoords[0])<it.eps&&(ht=-lt.usrCoords[1],dt=-lt.usrCoords[2]),ht*pt+dt*ft>=0},isSameDirection:function(lt,ot,ct){var ut,ht,dt,pt,ft=!1;return ut=ot.usrCoords[1]-lt.usrCoords[1],ht=ot.usrCoords[2]-lt.usrCoords[2],dt=ct.usrCoords[1]-lt.usrCoords[1],pt=ct.usrCoords[2]-lt.usrCoords[2],Math.abs(ut)<it.eps&&(ut=0),Math.abs(ht)<it.eps&&(ht=0),Math.abs(dt)<it.eps&&(dt=0),Math.abs(pt)<it.eps&&(pt=0),(ut>=0&&dt>=0||ut<=0&&dt<=0)&&(ft=ht>=0&&pt>=0||ht<=0&&pt<=0),ft},intersectionFunction:function(lt,ot,ct,ut,ht,dt){var pt=this;return ot.elementClass===_e.OBJECT_CLASS_CURVE&&ct.elementClass===_e.OBJECT_CLASS_CURVE?function(){return pt.meetCurveCurve(ot,ct,ut,ht,ot.board)}:ot.elementClass===_e.OBJECT_CLASS_CURVE&&ct.elementClass===_e.OBJECT_CLASS_LINE||ct.elementClass===_e.OBJECT_CLASS_CURVE&&ot.elementClass===_e.OBJECT_CLASS_LINE?function(){return pt.meetCurveLine(ot,ct,ut,ot.board,dt)}:ot.elementClass===_e.OBJECT_CLASS_LINE&&ct.elementClass===_e.OBJECT_CLASS_LINE?function(){var ft,gt,mt,At,yt,bt;return mt=At=st.evaluate(ot.visProp.straightfirst),yt=bt=st.evaluate(ot.visProp.straightlast),st.evaluate(dt)||mt&&yt&&At&&bt?pt.meet(ot.stdform,ct.stdform,ut,ot.board):(ft=pt.meetSegmentSegment(ot.point1.coords.usrCoords,ot.point2.coords.usrCoords,ct.point1.coords.usrCoords,ct.point2.coords.usrCoords,ot.board),gt=!mt&&ft[1]<0||!yt&&ft[1]>1||!At&&ft[2]<0||!bt&&ft[2]>1?[0,NaN,NaN]:ft[0],new rt(_e.COORDS_BY_USER,gt,ot.board))}:function(){return pt.meet(ot.stdform,ct.stdform,ut,ot.board)}},meet:function(lt,ot,ct,ut){var ht=it.eps;return Math.abs(lt[3])<ht&&Math.abs(ot[3])<ht?this.meetLineLine(lt,ot,ct,ut):Math.abs(lt[3])>=ht&&Math.abs(ot[3])<ht?this.meetLineCircle(ot,lt,ct,ut):Math.abs(lt[3])<ht&&Math.abs(ot[3])>=ht?this.meetLineCircle(lt,ot,ct,ut):this.meetCircleCircle(lt,ot,ct,ut)},meetLineBoard:function(lt,ot,ct){var ut,ht,dt,pt,ft=[];for(st.exists(ct)||(ct=0),ft[0]=it.crossProduct(lt,[ct,0,1]),ft[1]=it.crossProduct(lt,[ct,1,0]),ft[2]=it.crossProduct(lt,[-ct-ot.canvasHeight,0,1]),ft[3]=it.crossProduct(lt,[-ct-ot.canvasWidth,1,0]),dt=0;dt<4;dt++)if(Math.abs(ft[dt][0])>it.eps){for(pt=2;pt>0;pt--)ft[dt][pt]/=ft[dt][0];ft[dt][0]=1}return Math.abs(ft[1][0])<it.eps?(ut=ft[0],ht=ft[2]):Math.abs(ft[0][0])<it.eps?(ut=ft[1],ht=ft[3]):ft[1][2]<0?(ut=ft[0],ht=ft[3][2]>ot.canvasHeight?ft[2]:ft[3]):ft[1][2]>ot.canvasHeight?(ut=ft[2],ht=ft[3][2]<0?ft[0]:ft[3]):(ut=ft[1],ht=ft[3][2]<0?ft[0]:ft[3][2]>ot.canvasHeight?ft[2]:ft[3]),ut=new rt(_e.COORDS_BY_SCREEN,ut.slice(1),ot),ht=new rt(_e.COORDS_BY_SCREEN,ht.slice(1),ot),[ut,ht]},meetLineLine:function(lt,ot,ct,ut){var ht=isNaN(lt[5]+ot[5])?[0,0,0]:it.crossProduct(lt,ot);return new rt(_e.COORDS_BY_USER,ht,ut)},meetLineCircle:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt;return ot[4]<it.eps?Math.abs(it.innerProduct([1,ot[6],ot[7]],lt,3))<it.eps?new rt(_e.COORDS_BY_USER,ot.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[NaN,NaN],ut):(pt=ot[0],dt=ot.slice(1,3),ht=ot[3],ft=lt[0],gt=lt.slice(1,3),mt=ht,At=dt[0]*gt[1]-dt[1]*gt[0],yt=ht*ft*ft-(dt[0]*gt[0]+dt[1]*gt[1])*ft+pt,bt=At*At-4*mt*yt,bt>-it.eps*it.eps?(bt=Math.sqrt(Math.abs(bt)),xt=[(-At+bt)/(2*mt),(-At-bt)/(2*mt)],ct===0?new rt(_e.COORDS_BY_USER,[-xt[0]*-gt[1]-ft*gt[0],-xt[0]*gt[0]-ft*gt[1]],ut):new rt(_e.COORDS_BY_USER,[-xt[1]*-gt[1]-ft*gt[0],-xt[1]*gt[0]-ft*gt[1]],ut)):new rt(_e.COORDS_BY_USER,[0,0,0],ut))},meetCircleCircle:function(lt,ot,ct,ut){var ht;return lt[4]<it.eps?Math.abs(this.distance(lt.slice(6,2),ot.slice(6,8))-ot[4])<it.eps?new rt(_e.COORDS_BY_USER,lt.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[0,0,0],ut):ot[4]<it.eps?Math.abs(this.distance(ot.slice(6,2),lt.slice(6,8))-lt[4])<it.eps?new rt(_e.COORDS_BY_USER,ot.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[0,0,0],ut):(ht=[ot[3]*lt[0]-lt[3]*ot[0],ot[3]*lt[1]-lt[3]*ot[1],ot[3]*lt[2]-lt[3]*ot[2],0,1,1/0,1/0,1/0],ht=it.normalize(ht),this.meetLineCircle(ht,lt,ct,ut))},meetCurveCurve:function(lt,ot,ct,ut,ht,dt){var pt;return pt=st.exists(dt)&&dt==="newton"?nt.generalizedNewton(lt,ot,ct,ut):lt.bezierDegree===3&&ot.bezierDegree===3?this.meetBezierCurveRedBlueSegments(lt,ot,ct):this.meetCurveRedBlueSegments(lt,ot,ct),new rt(_e.COORDS_BY_USER,pt,ht)},meetCurveLine:function(lt,ot,ct,ut,ht){var dt,pt;return st.exists(ut)||(ut=lt.board),lt.elementClass===_e.OBJECT_CLASS_CURVE?(dt=lt,pt=ot):(dt=ot,pt=lt),this.meetCurveLineDiscrete(dt,pt,ct,ut,!ht)},meetCurveLineContinuous:function(lt,ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt=it.eps,Mt=it.eps;for(gt=this.meetCurveLineDiscrete(lt,ot,ct,ut,ht),mt=gt.usrCoords[1],At=gt.usrCoords[2],pt=function(Rt){var It,Ot;return Rt>lt.maxX()||Rt<lt.minX()?1/0:(It=mt-lt.X(Rt),Ot=At-lt.Y(Rt),It*It+Ot*Ot)},ft=function(Rt){var It=ot.stdform[0]+ot.stdform[1]*lt.X(Rt)+ot.stdform[2]*lt.Y(Rt);return It*It},bt=50,xt=(lt.maxX()-lt.minX())/bt,vt=lt.minX(),St=1e-4,Ct=NaN,_t=0;_t<bt&&(dt=nt.root(pt,[Math.max(vt,lt.minX()),Math.min(vt+xt,lt.maxX())]),!((Et=Math.abs(pt(dt)))<=St&&(St=Et,Ct=dt,St<Tt)));_t++)vt+=xt;return dt=Ct,dt=nt.root(ft,[Math.max(dt-xt,lt.minX()),Math.min(dt+xt,lt.maxX())]),Et=ft(dt),yt=isNaN(Et)||Math.abs(Et)>Mt?0:1,new rt(_e.COORDS_BY_USER,[yt,lt.X(dt),lt.Y(dt)],ut)},meetCurveLineContinuousOld:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=10*it.eps;if(tt.deprecated("Geometry.meetCurveLineContinuousOld()","Geometry.meetCurveLineContinuous()"),ft=function(St){var Et=ot.stdform[0]+ot.stdform[1]*lt.X(St)+ot.stdform[2]*lt.Y(St);return Et*Et},this.meetCurveLineContinuous.t1memo?(bt=this.meetCurveLineContinuous.t1memo,ht=nt.root(ft,bt)):(bt=lt.minX(),xt=lt.maxX(),ht=nt.root(ft,[bt,xt])),this.meetCurveLineContinuous.t1memo=ht,vt=lt.X(ht),_t=lt.Y(ht),ct===1){if(this.meetCurveLineContinuous.t2memo&&(bt=this.meetCurveLineContinuous.t2memo),dt=nt.root(ft,bt),!(Math.abs(dt-ht)>.1&&Math.abs(vt-lt.X(dt))>.1&&Math.abs(_t-lt.Y(dt))>.1))for(At=20,yt=(lt.maxX()-lt.minX())/At,mt=lt.minX(),pt=0;pt<At&&(dt=nt.root(ft,[mt,mt+yt]),!(Math.abs(ft(dt))<=Ct&&Math.abs(dt-ht)>.1&&Math.abs(vt-lt.X(dt))>.1&&Math.abs(_t-lt.Y(dt))>.1));pt++)mt+=yt;ht=dt,this.meetCurveLineContinuous.t2memo=ht}return gt=Math.abs(ft(ht))>Ct?NaN:1,new rt(_e.COORDS_BY_USER,[gt,lt.X(ht),lt.Y(ht)],ut)},meetCurveLineDiscrete:function(lt,ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt=ot.point1.coords.usrCoords,xt=ot.point2.coords.usrCoords,vt=0,_t=lt.numberPoints,Ct=st.evaluate(ot.visProp.straightfirst),St=st.evaluate(ot.visProp.straightlast);for(At=new rt(_e.COORDS_BY_USER,[0,NaN,NaN],ut),bt[0]===0?bt=[1,xt[1]+ot.stdform[2],xt[2]-ot.stdform[1]]:xt[0]===0&&(xt=[1,bt[1]+ot.stdform[2],bt[2]-ot.stdform[1]]),gt=lt.points[0].usrCoords,dt=1;dt<_t;dt++)if(ft=gt.slice(0),gt=lt.points[dt].usrCoords,this.distance(ft,gt)>it.eps){for(lt.bezierDegree===3?(yt=this.meetBeziersegmentBeziersegment([lt.points[dt-1].usrCoords.slice(1),lt.points[dt].usrCoords.slice(1),lt.points[dt+1].usrCoords.slice(1),lt.points[dt+2].usrCoords.slice(1)],[bt.slice(1),xt.slice(1)],ht),dt+=2):yt=[this.meetSegmentSegment(ft,gt,bt,xt)],pt=0;pt<yt.length;pt++)if(mt=yt[pt],0<=mt[1]&&mt[1]<=1){if(vt===ct)return ht&&(!Ct&&mt[2]<0||!St&&mt[2]>1)?At:At=new rt(_e.COORDS_BY_USER,mt[0],ut);vt+=1}}return At},meetCurveRedBlueSegments:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt=0,xt=ot.numberPoints,vt=lt.numberPoints;if(xt<=1||vt<=1)return[0,NaN,NaN];for(ut=1;ut<vt;ut++)for(dt=lt.points[ut-1].usrCoords,pt=lt.points[ut].usrCoords,At=Math.min(dt[1],pt[1]),yt=Math.max(dt[1],pt[1]),gt=ot.points[0].usrCoords,ht=1;ht<xt;ht++)if(ft=gt,gt=ot.points[ht].usrCoords,Math.min(ft[1],gt[1])<yt&&Math.max(ft[1],gt[1])>At&&(mt=this.meetSegmentSegment(dt,pt,ft,gt),mt[1]>=0&&mt[2]>=0&&(mt[1]<1&&mt[2]<1||ut===vt-1&&mt[1]===1||ht===xt-1&&mt[2]===1))){if(bt===ct)return mt[0];bt++}return[0,NaN,NaN]},meetSegmentSegment:function(lt,ot,ct,ut){var ht,dt,pt,ft=it.crossProduct(lt,ot),gt=it.crossProduct(ct,ut),mt=it.crossProduct(ft,gt),At=mt[0];return Math.abs(At)<it.eps?[mt,1/0,1/0]:(pt=[ct[1]-lt[1],ct[2]-lt[2]],ht=(pt[0]*(ut[2]-ct[2])-pt[1]*(ut[1]-ct[1]))/At,dt=(pt[0]*(ot[2]-lt[2])-pt[1]*(ot[1]-lt[1]))/At,[mt,ht,dt])},_bezierSplit:function(lt){var ot,ct,ut,ht,dt,pt;return ot=[.5*(lt[0][0]+lt[1][0]),.5*(lt[0][1]+lt[1][1])],ct=[.5*(lt[1][0]+lt[2][0]),.5*(lt[1][1]+lt[2][1])],ut=[.5*(lt[2][0]+lt[3][0]),.5*(lt[2][1]+lt[3][1])],ht=[.5*(ot[0]+ct[0]),.5*(ot[1]+ct[1])],dt=[.5*(ct[0]+ut[0]),.5*(ct[1]+ut[1])],pt=[.5*(ht[0]+dt[0]),.5*(ht[1]+dt[1])],[[lt[0],ot,ht,pt],[pt,dt,ut,lt[3]]]},_bezierBbox:function(lt){var ot=[];return lt.length===4?(ot[0]=Math.min(lt[0][0],lt[1][0],lt[2][0],lt[3][0]),ot[1]=Math.max(lt[0][1],lt[1][1],lt[2][1],lt[3][1]),ot[2]=Math.max(lt[0][0],lt[1][0],lt[2][0],lt[3][0]),ot[3]=Math.min(lt[0][1],lt[1][1],lt[2][1],lt[3][1])):(ot[0]=Math.min(lt[0][0],lt[1][0]),ot[1]=Math.max(lt[0][1],lt[1][1]),ot[2]=Math.max(lt[0][0],lt[1][0]),ot[3]=Math.min(lt[0][1],lt[1][1])),ot},_bezierOverlap:function(lt,ot){return lt[2]>=ot[0]&&lt[0]<=ot[2]&&lt[1]>=ot[3]&&lt[3]<=ot[1]},_bezierListConcat:function(lt,ot,ct,ut){var ht,dt=st.exists(ut),pt=0,ft=ot.length,gt=lt.length;for(gt>0&&ft>0&&(lt[gt-1][1]===1&&ot[0][1]===0||dt&&lt[gt-1][2]===1&&ot[0][2]===0)&&(pt=1),ht=pt;ht<ft;ht++)dt&&(ot[ht][2]*=.5,ot[ht][2]+=ut),ot[ht][1]*=.5,ot[ht][1]+=ct,lt.push(ot[ht])},_bezierMeetSubdivision:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t=[];return ht=this._bezierBbox(ot),ut=this._bezierBbox(lt),this._bezierOverlap(ht,ut)?ct<5?(dt=this._bezierSplit(lt),gt=dt[0],mt=dt[1],dt=this._bezierSplit(ot),pt=dt[0],ft=dt[1],this._bezierListConcat(_t,this._bezierMeetSubdivision(gt,pt,ct+1),0,0),this._bezierListConcat(_t,this._bezierMeetSubdivision(gt,ft,ct+1),0,.5),this._bezierListConcat(_t,this._bezierMeetSubdivision(mt,pt,ct+1),.5,0),this._bezierListConcat(_t,this._bezierMeetSubdivision(mt,ft,ct+1),.5,.5),_t):(xt=[1].concat(lt[0]),vt=[1].concat(lt[3]),yt=[1].concat(ot[0]),bt=[1].concat(ot[3]),At=this.meetSegmentSegment(xt,vt,yt,bt),At[1]>=0&&At[2]>=0&&At[1]<=1&&At[2]<=1?[At]:[]):[]},_bezierLineMeetSubdivision:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt=[];return ht=this._bezierBbox(ot),dt=this._bezierBbox(lt),ut&&!this._bezierOverlap(dt,ht)?[]:ct<5?(pt=this._bezierSplit(lt),ft=pt[0],gt=pt[1],this._bezierListConcat(vt,this._bezierLineMeetSubdivision(ft,ot,ct+1),0),this._bezierListConcat(vt,this._bezierLineMeetSubdivision(gt,ot,ct+1),.5),vt):(bt=[1].concat(lt[0]),xt=[1].concat(lt[3]),At=[1].concat(ot[0]),yt=[1].concat(ot[1]),mt=this.meetSegmentSegment(bt,xt,At,yt),mt[1]>=0&&mt[1]<=1&&(!ut||mt[2]>=0&&mt[2]<=1)?[mt]:[])},meetBeziersegmentBeziersegment:function(lt,ot,ct){var ut,ht,dt;for(ut=lt.length===4&&ot.length===4?this._bezierMeetSubdivision(lt,ot,0):this._bezierLineMeetSubdivision(lt,ot,0,ct),ut.sort(function(pt,ft){return 1e7*(pt[1]-ft[1])+(pt[2]-ft[2])}),ht=[],dt=0;dt<ut.length;dt++)dt!==0&&ut[dt][1]===ut[dt-1][1]&&ut[dt][2]===ut[dt-1][2]||ht.push(ut[dt]);return ht},meetBezierCurveRedBlueSegments:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At=ot.numberPoints,yt=lt.numberPoints,bt=[];if(At<4||yt<4)return[0,NaN,NaN];for(ht=0;ht<yt-3;ht+=3)for(ut=lt.points,pt=[[ut[ht].usrCoords[1],ut[ht].usrCoords[2]],[ut[ht+1].usrCoords[1],ut[ht+1].usrCoords[2]],[ut[ht+2].usrCoords[1],ut[ht+2].usrCoords[2]],[ut[ht+3].usrCoords[1],ut[ht+3].usrCoords[2]]],gt=this._bezierBbox(pt),dt=0;dt<At-3;dt+=3)if(ut=ot.points,ft=[[ut[dt].usrCoords[1],ut[dt].usrCoords[2]],[ut[dt+1].usrCoords[1],ut[dt+1].usrCoords[2]],[ut[dt+2].usrCoords[1],ut[dt+2].usrCoords[2]],[ut[dt+3].usrCoords[1],ut[dt+3].usrCoords[2]]],mt=this._bezierBbox(ft),this._bezierOverlap(gt,mt)&&(bt=bt.concat(this.meetBeziersegmentBeziersegment(pt,ft)),bt.length>ct))return bt[ct][0];return bt.length>ct?bt[ct][0]:[0,NaN,NaN]},bezierSegmentEval:function(lt,ot){var ct,ut,ht,dt=1-lt;return ut=0,ht=0,ct=dt*dt*dt,ut+=ct*ot[0][0],ht+=ct*ot[0][1],ct=3*lt*dt*dt,ut+=ct*ot[1][0],ht+=ct*ot[1][1],ct=3*lt*lt*dt,ut+=ct*ot[2][0],ht+=ct*ot[2][1],ct=lt*lt*lt,ut+=ct*ot[3][0],ht+=ct*ot[3][1],[1,ut,ht]},bezierArc:function(lt,ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It=.5*Math.PI,Ot=ot[1],Bt=ot[2],Nt=ot[0],zt=[],Dt=[];for(mt=this.distance(ot,lt),Ot/=Nt,Bt/=Nt,At=this.rad(lt.slice(1),ot.slice(1),ct.slice(1)),ht===-1&&(At=2*Math.PI-At),dt=lt,dt[1]/=dt[0],dt[2]/=dt[0],dt[0]/=dt[0],gt=dt.slice(0),ut?(zt=[Ot,Ot+.333*(dt[1]-Ot),Ot+.666*(dt[1]-Ot),dt[1]],Dt=[Bt,Bt+.333*(dt[2]-Bt),Bt+.666*(dt[2]-Bt),dt[2]]):(zt=[dt[1]],Dt=[dt[2]]);At>it.eps;)At>It?(yt=It,At-=It):(yt=At,At=0),bt=Math.cos(ht*yt),xt=Math.sin(ht*yt),Rt=[[1,0,0],[Ot*(1-bt)+Bt*xt,bt,-xt],[Bt*(1-bt)-Ot*xt,xt,bt]],Tt=it.matVecMult(Rt,dt),gt=[Tt[0]/Tt[0],Tt[1]/Tt[0],Tt[2]/Tt[0]],vt=dt[1]-Ot,_t=dt[2]-Bt,Ct=gt[1]-Ot,St=gt[2]-Bt,Mt=Math.sqrt((vt+Ct)*(vt+Ct)+(_t+St)*(_t+St)),Et=Math.abs(St-_t)>it.eps?(vt+Ct)*(mt/Mt-.5)/(St-_t)*8/3:(_t+St)*(mt/Mt-.5)/(vt-Ct)*8/3,pt=[1,dt[1]-Et*_t,dt[2]+Et*vt],ft=[1,gt[1]+Et*St,gt[2]-Et*Ct],zt=zt.concat([pt[1],ft[1],gt[1]]),Dt=Dt.concat([pt[2],ft[2],gt[2]]),dt=gt.slice(0);return ut&&(zt=zt.concat([gt[1]+.333*(Ot-gt[1]),gt[1]+.666*(Ot-gt[1]),Ot]),Dt=Dt.concat([gt[2]+.333*(Bt-gt[2]),gt[2]+.666*(Bt-gt[2]),Bt])),[zt,Dt]},projectPointToCircle:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt=ot.center.coords.usrCoords;return st.exists(ct)||(ct=lt.board),st.isPoint(lt)?(ut=lt.coords.distance(_e.COORDS_BY_USER,ot.center.coords),ht=lt.coords.usrCoords):(ut=lt.distance(_e.COORDS_BY_USER,ot.center.coords),ht=lt.usrCoords),Math.abs(ut)<it.eps&&(ut=it.eps),ft=ot.Radius()/ut,dt=gt[1]+ft*(ht[1]-gt[1]),pt=gt[2]+ft*(ht[2]-gt[2]),new rt(_e.COORDS_BY_USER,[dt,pt],ct)},projectPointToLine:function(lt,ot,ct){var ut=[0,ot.stdform[1],ot.stdform[2]];return st.exists(ct)||(ct=lt.board),ut=it.crossProduct(ut,lt.coords.usrCoords),new rt(_e.COORDS_BY_USER,it.crossProduct(ut,ot.stdform),ct)},projectCoordsToSegment:function(lt,ot,ct){var ut,ht,dt=[ct[1]-ot[1],ct[2]-ot[2]],pt=[lt[1]-ot[1],lt[2]-ot[2]];return Math.abs(dt[0])<it.eps&&Math.abs(dt[1])<it.eps?[ot,0]:(ut=it.innerProduct(pt,dt),ht=it.innerProduct(dt,dt),ut/=ht,[[1,ut*dt[0]+ot[1],ut*dt[1]+ot[2]],ut])},projectCoordsToBeziersegment:function(lt,ot,ct){var ut,ht=function(dt){var pt=[1,ot.X(ct+dt),ot.Y(ct+dt)];return pt[1]-=lt[1],pt[2]-=lt[2],pt[1]*pt[1]+pt[2]*pt[2]};return ut=tt.Math.Numerics.fminbr(ht,[0,1]),[[1,ot.X(ut+ct),ot.Y(ut+ct)],ut]},projectPointToCurve:function(lt,ot,ct){st.exists(ct)||(ct=lt.board);var ut=lt.X(),ht=lt.Y(),dt=lt.position||0,pt=this.projectCoordsToCurve(ut,ht,dt,ot,ct);return lt.position=pt[1],pt[0]},projectCoordsToCurve:function(lt,ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt=Number.POSITIVE_INFINITY;if(st.exists(ht)||(ht=ut.board),st.evaluate(ut.visProp.curvetype)==="plot"){if(ct=0,mt=zt,dt=ut.numberPoints===0?[0,1,1]:[ut.Z(0),ut.X(0),ut.Y(0)],ut.numberPoints>1)for(bt=[1,lt,ot],ut.bezierDegree===3?gt=0:_t=[ut.Z(0),ut.X(0),ut.Y(0)],ft=0;ft<ut.numberPoints-1;ft++)ut.bezierDegree===3?St=this.projectCoordsToBeziersegment(bt,ut,gt):(Ct=[ut.Z(ft+1),ut.X(ft+1),ut.Y(ft+1)],St=this.projectCoordsToSegment(bt,_t,Ct)),yt=St[1],xt=St[0],0<=yt&&yt<=1?(At=this.distance(xt,bt),vt=ft+yt):yt<0?(xt=_t,At=this.distance(_t,bt),vt=ft):yt>1&&ft===ut.numberPoints-2&&(xt=Ct,At=this.distance(xt,bt),vt=ut.numberPoints-1),At<mt&&(mt=At,ct=vt,dt=xt),ut.bezierDegree===3?(gt++,ft+=2):_t=Ct;pt=new rt(_e.COORDS_BY_USER,dt,ht)}else{for(Et=function(Dt){var Ft,Ut;return Dt<ut.minX()||Dt>ut.maxX()?NaN:(Ft=lt-ut.X(Dt),Ut=ot-ut.Y(Dt),Ft*Ft+Ut*Ut)},Rt=Et(ct),Ot=50,It=(ut.maxX()-ut.minX())/Ot,Tt=ut.minX(),ft=0;ft<Ot;ft++)Mt=Et(Tt),(Mt<Rt||isNaN(Rt))&&(ct=Tt,Rt=Mt),Tt+=It;ct=nt.fminbr(Et,[ct-It,ct+It]),Bt=ut.minX(),Nt=ut.maxX(),ct=ct<Bt?Bt:ct,ct=ct>Nt?Nt:ct,pt=new rt(_e.COORDS_BY_USER,[ut.X(ct),ut.Y(ct)],ht)}return[ut.updateTransform(pt),ct]},projectCoordsToPolygon:function(lt,ot){var ct,ut,ht,dt,pt=ot.vertices.length,ft=1/0;for(ct=0;ct<pt;ct++)ht=tt.Math.Geometry.projectCoordsToSegment(lt,ot.vertices[ct].coords.usrCoords,ot.vertices[(ct+1)%pt].coords.usrCoords),ut=tt.Math.Geometry.distance(ht[0],lt,3),0<=ht[1]&&ht[1]<=1&&ut<ft&&(dt=ht[0].slice(0),ft=ut);return dt},projectPointToTurtle:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt=0,bt=0,xt=Number.POSITIVE_INFINITY,vt=ot.objects.length;for(st.exists(ct)||(ct=lt.board),ft=0;ft<vt;ft++)mt=ot.objects[ft],mt.elementClass===_e.OBJECT_CLASS_CURVE&&(ut=this.projectPointToCurve(lt,mt),gt=this.distance(ut.usrCoords,lt.coords.usrCoords),gt<xt&&(dt=ut.usrCoords[1],pt=ut.usrCoords[2],ht=lt.position,xt=gt,At=mt,bt=yt),yt+=mt.numberPoints);return ut=new rt(_e.COORDS_BY_USER,[dt,pt],ct),lt.position=ht+bt,At.updateTransform(ut)},projectPointToPoint:function(lt,ot){return ot.coords},projectPointToBoard:function(lt,ot){var ct,ut,ht,dt=ot||lt.board,pt=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],ft=lt.coords||lt,gt=dt.getBoundingBox();for(ct=0;ct<4;ct++)ht=pt[ct],ht[0]*ft.usrCoords[ht[1]]<ht[0]*gt[ht[2]]&&(ut=it.crossProduct([1,gt[ht[3]],gt[ht[4]]],[1,gt[ht[5]],gt[ht[6]]]),ut[3]=0,ut=it.normalize(ut),ft=this.projectPointToLine({coords:ft},{stdform:ut},dt));return ft},distPointLine:function(lt,ot){var ct,ut=ot[1],ht=ot[2],dt=ot[0];return Math.abs(ut)+Math.abs(ht)<it.eps?Number.POSITIVE_INFINITY:(ct=ut*lt[1]+ht*lt[2]+dt,ut*=ut,ht*=ht,Math.abs(ct)/Math.sqrt(ut+ht))},reuleauxPolygon:function(lt,ot){var ct,ut=2*Math.PI,ht=ut/ot,dt=(ot-1)/2,pt=0,ft=function(gt,mt){return function(At,yt){var bt=(At%ut+ut)%ut,xt=Math.floor(bt/ht)%ot;return yt||(pt=lt[0].Dist(lt[dt]),ct=it.Geometry.rad([lt[0].X()+1,lt[0].Y()],lt[0],lt[dt%ot])),isNaN(xt)?xt:(bt=.5*bt+xt*ht*.5+ct,lt[xt][gt]()+pt*Math[mt](bt))}};return[ft("X","cos"),ft("Y","sin"),0,ut]}}),it.Geometry}),define("utils/zip",["jxg"],function(tt){var _e=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],rt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],it=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],nt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],st=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],at=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],lt=256;return tt.Util=tt.Util||{},tt.Util.Unzip=function(ot){function ct(){return zt<Nt?ot[zt++]:-1}function ut(){Dt=1}function ht(){var er;try{return er=1&Dt,Dt>>=1,Dt===0&&(Dt=ct(),er=1&Dt,Dt=Dt>>1|128),er}catch(ir){throw ir}}function dt(er){var ir=0,ur=er;try{for(;ur--;)ir=ir<<1|ht();er&&(ir=_e[ir]>>8-er)}catch(ar){throw ar}return ir}function pt(){Ot=0}function ft(er){It[Ot++]=er,Tt.push(String.fromCharCode(er)),Ot===32768&&(Ot=0)}function gt(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function mt(){for(;;){if(qt[Zt]>=St)return-1;if(Ct[qt[Zt]]===Zt)return qt[Zt]++;qt[Zt]++}}function At(){var er,ir=Vt[$t];if(Zt===17)return-1;if($t++,Zt++,(er=mt())>=0)ir.b0=er;else if(ir.b0=32768,At())return-1;if((er=mt())>=0)ir.b1=er,ir.jump=null;else if(ir.b1=32768,ir.jump=Vt[$t],ir.jumppos=$t,At())return-1;return Zt--,0}function yt(er,ir,ur,ar){var lr;for(Vt=er,$t=0,Ct=ur,St=ir,lr=0;lr<17;lr++)qt[lr]=0;return Zt=0,At()?-1:0}function bt(er){for(var ir,ur,ar=0,lr=er[ar];;)if(ht()){if(!(32768&lr.b1))return lr.b1;for(lr=lr.jump,ir=er.length,ur=0;ur<ir;ur++)if(er[ur]===lr){ar=ur;break}}else{if(!(32768&lr.b0))return lr.b0;ar++,lr=er[ar]}}function xt(){var er,ir,ur,ar,lr,gr,Yt,nr,mr,Sr,Er,Nr,wr,kr,Ur,Or;do if(er=ht(),(ur=dt(2))===0)for(ut(),Sr=ct(),Sr|=ct()<<8,Nr=ct(),Nr|=ct()<<8,65535&(Sr^~Nr)&&tt.debug(`BlockLen checksum mismatch
`);Sr--;)ir=ct(),ft(ir);else if(ur===1)for(;;)if(lr=_e[dt(7)]>>1,lr>23?(lr=lr<<1|ht(),lr>199?(lr-=128,lr=lr<<1|ht()):(lr-=48)>143&&(lr+=136)):lr+=256,lr<256)ft(lr);else{if(lr===256)break;for(lr-=257,mr=dt(it[lr])+rt[lr],lr=_e[dt(5)]>>3,st[lr]>8?(Er=dt(8),Er|=dt(st[lr]-8)<<8):Er=dt(st[lr]),Er+=nt[lr],lr=0;lr<mr;lr++)ir=It[Ot-Er&32767],ft(ir)}else if(ur===2){for(Yt=new Array(320),kr=257+dt(5),Ur=1+dt(5),Or=4+dt(4),lr=0;lr<19;lr++)Yt[lr]=0;for(lr=0;lr<Or;lr++)Yt[at[lr]]=dt(3);for(mr=Ut.length,ar=0;ar<mr;ar++)Ut[ar]=new gt;if(yt(Ut,19,Yt))return pt(),1;for(wr=kr+Ur,ar=0,-1;ar<wr;)if((lr=bt(Ut))<16)Yt[ar++]=lr;else if(lr===16){if(lr=3+dt(2),ar+lr>wr)return pt(),1;for(gr=ar?Yt[ar-1]:0;lr--;)Yt[ar++]=gr}else{if(lr=lr===17?3+dt(3):11+dt(7),ar+lr>wr)return pt(),1;for(;lr--;)Yt[ar++]=0}for(mr=Ft.length,ar=0;ar<mr;ar++)Ft[ar]=new gt;if(yt(Ft,kr,Yt))return pt(),1;for(mr=Ft.length,ar=0;ar<mr;ar++)Ut[ar]=new gt;for(nr=[],ar=kr;ar<Yt.length;ar++)nr[ar-kr]=Yt[ar];if(yt(Ut,Ur,nr))return pt(),1;for(;;)if((lr=bt(Ft))>=256){if((lr-=256)===0)break;for(lr-=1,mr=dt(it[lr])+rt[lr],lr=bt(Ut),st[lr]>8?(Er=dt(8),Er|=dt(st[lr]-8)<<8):Er=dt(st[lr]),Er+=nt[lr];mr--;)ir=It[Ot-Er&32767],ft(ir)}else ft(lr)}while(!er);return pt(),ut(),0}function vt(){var er,ir,ur,ar,lr,gr,Yt,nr,mr=[];try{if(Tt=[],Bt=!1,mr[0]=ct(),mr[1]=ct(),mr[0]===120&&mr[1]===218&&(xt(),Rt[Mt]=[Tt.join(""),"geonext.gxt"],Mt++),mr[0]===31&&mr[1]===139&&(Et(),Rt[Mt]=[Tt.join(""),"file"],Mt++),mr[0]===80&&mr[1]===75&&(Bt=!0,mr[2]=ct(),mr[3]=ct(),mr[2]===3&&mr[3]===4)){for(mr[0]=ct(),mr[1]=ct(),_t=ct(),_t|=ct()<<8,nr=ct(),nr|=ct()<<8,ct(),ct(),ct(),ct(),Yt=ct(),Yt|=ct()<<8,Yt|=ct()<<16,Yt|=ct()<<24,gr=ct(),gr|=ct()<<8,gr|=ct()<<16,gr|=ct()<<24,lr=ct(),lr|=ct()<<8,lr|=ct()<<16,lr|=ct()<<24,ar=ct(),ar|=ct()<<8,ur=ct(),ur|=ct()<<8,er=0,sr=[];ar--;)ir=ct(),ir==="/"|ir===":"?er=0:er<lt-1&&(sr[er++]=String.fromCharCode(ir));for(er=0;er<ur;)ir=ct(),er++;nr===8&&(xt(),Rt[Mt]=new Array(2),Rt[Mt][0]=Tt.join(""),Rt[Mt][1]=sr.join(""),Mt++),Et()}}catch(Sr){throw Sr}}var _t,Ct,St,Et,Tt=[],Mt=0,Rt=[],It=new Array(32768),Ot=0,Bt=!1,Nt=ot.length,zt=0,Dt=1,Ft=new Array(288),Ut=new Array(32),$t=0,Vt=null,Zt=0,qt=new Array(17),sr=[];qt[0]=0,Et=function(){var er,ir,ur,ar,lr,gr=[];if(8&_t&&(gr[0]=ct(),gr[1]=ct(),gr[2]=ct(),gr[3]=ct(),gr[0]===80&&gr[1]===75&&gr[2]===7&&gr[3]===8?(er=ct(),er|=ct()<<8,er|=ct()<<16,er|=ct()<<24):er=gr[0]|gr[1]<<8|gr[2]<<16|gr[3]<<24,ir=ct(),ir|=ct()<<8,ir|=ct()<<16,ir|=ct()<<24,ur=ct(),ur|=ct()<<8,ur|=ct()<<16,ur|=ct()<<24),Bt&&vt(),gr[0]=ct(),gr[0]===8){if(_t=ct(),ct(),ct(),ct(),ct(),ct(),ct(),4&_t)for(gr[0]=ct(),gr[2]=ct(),Zt=gr[0]+256*gr[1],ar=0;ar<Zt;ar++)ct();if(8&_t)for(ar=0,sr=[],lr=ct();lr;)lr!=="7"&&lr!==":"||(ar=0),ar<lt-1&&(sr[ar++]=lr),lr=ct();if(16&_t)for(lr=ct();lr;)lr=ct();2&_t&&(ct(),ct()),xt(),er=ct(),er|=ct()<<8,er|=ct()<<16,er|=ct()<<24,ur=ct(),ur|=ct()<<8,ur|=ct()<<16,ur|=ct()<<24,Bt&&vt()}},tt.Util.Unzip.prototype.unzipFile=function(er){var ir;for(this.unzip(),ir=0;ir<Rt.length;ir++)if(Rt[ir][1]===er)return Rt[ir][0];return""},tt.Util.Unzip.prototype.unzip=function(){return vt(),Rt}},tt.Util}),define("utils/encoding",["jxg"],function(tt){var _e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return tt.Util=tt.Util||{},tt.Util.UTF8={encode:function(rt){var it,nt,st="",at=rt.length;if(rt=rt.replace(/\r\n/g,`
`),typeof unescape=="function"&&typeof encodeURIComponent=="function")return unescape(encodeURIComponent(rt));for(it=0;it<at;it++)nt=rt.charCodeAt(it),nt<128?st+=String.fromCharCode(nt):nt>127&&nt<2048?(st+=String.fromCharCode(nt>>6|192),st+=String.fromCharCode(63&nt|128)):(st+=String.fromCharCode(nt>>12|224),st+=String.fromCharCode(nt>>6&63|128),st+=String.fromCharCode(63&nt|128));return st},decode:function(rt){var it,nt,st,at=0,lt=0,ot=0,ct=[],ut=rt.length,ht=[];for(it=0;it<ut;it++)nt=rt.charCodeAt(it),st=_e[nt],lt=ot!==0?63&nt|lt<<6:255>>st&nt,(ot=_e[256+ot+st])===0&&(lt>65535?ct.push(55232+(lt>>10),56320+(1023&lt)):ct.push(lt),++at%1e4==0&&(ht.push(String.fromCharCode.apply(null,ct)),ct=[]));return ht.push(String.fromCharCode.apply(null,ct)),ht.join("")},asciiCharCodeAt:function(rt,it){var nt=rt.charCodeAt(it);if(nt>255)switch(nt){case 8364:nt=128;break;case 8218:nt=130;break;case 402:nt=131;break;case 8222:nt=132;break;case 8230:nt=133;break;case 8224:nt=134;break;case 8225:nt=135;break;case 710:nt=136;break;case 8240:nt=137;break;case 352:nt=138;break;case 8249:nt=139;break;case 338:nt=140;break;case 381:nt=142;break;case 8216:nt=145;break;case 8217:nt=146;break;case 8220:nt=147;break;case 8221:nt=148;break;case 8226:nt=149;break;case 8211:nt=150;break;case 8212:nt=151;break;case 732:nt=152;break;case 8482:nt=153;break;case 353:nt=154;break;case 8250:nt=155;break;case 339:nt=156;break;case 382:nt=158;break;case 376:nt=159}return nt}},tt.Util.UTF8}),define("utils/base64",["jxg","utils/encoding"],function(tt,_e){function rt(st,at){return 255&st.charCodeAt(at)}function it(st,at){return nt.indexOf(st.charAt(at))}var nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return tt.Util=tt.Util||{},tt.Util.Base64={encode:function(st){var at,lt,ot,ct,ut,ht=[];for(ut=_e.encode(st),ot=ut.length,ct=ot%3,at=0;at<ot-ct;at+=3)lt=rt(ut,at)<<16|rt(ut,at+1)<<8|rt(ut,at+2),ht.push(nt.charAt(lt>>18),nt.charAt(lt>>12&63),nt.charAt(lt>>6&63),nt.charAt(63&lt));switch(ct){case 1:lt=rt(ut,ot-1),ht.push(nt.charAt(lt>>2),nt.charAt(lt<<4&63),"=","=");break;case 2:lt=rt(ut,ot-2)<<8|rt(ut,ot-1),ht.push(nt.charAt(lt>>10),nt.charAt(lt>>4&63),nt.charAt(lt<<2&63),"=")}return ht.join("")},decode:function(st,at){var lt,ot,ct,ut,ht,dt,pt=[],ft=[];if(lt=st.replace(/[^A-Za-z0-9\+\/=]/g,""),(ct=lt.length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for(lt.charAt(ct-1)==="="&&(ut=1,lt.charAt(ct-2)==="="&&(ut=2),ct-=4),ot=0;ot<ct;ot+=4)ht=it(lt,ot)<<18|it(lt,ot+1)<<12|it(lt,ot+2)<<6|it(lt,ot+3),ft.push(ht>>16,ht>>8&255,255&ht),ot%1e4==0&&(pt.push(String.fromCharCode.apply(null,ft)),ft=[]);switch(ut){case 1:ht=it(lt,ct)<<12|it(lt,ct+1)<<6|it(lt,ct+2),ft.push(ht>>10,ht>>2&255);break;case 2:ht=it(lt,ot)<<6|it(lt,ot+1),ft.push(ht>>4)}return pt.push(String.fromCharCode.apply(null,ft)),dt=pt.join(""),at&&(dt=_e.decode(dt)),dt},decodeAsArray:function(st){var at,lt=this.decode(st),ot=[],ct=lt.length;for(at=0;at<ct;at++)ot[at]=lt.charCodeAt(at);return ot}},tt.Util.Base64}),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],function(tt,_e,rt,it){return tt.Server={modules:{},runningCalls:{},handleError:function(nt){tt.debug("error occured, server says: "+nt.message)},callServer:function(nt,st,at,lt){var ot,ct,ut,ht,dt,pt,ft;lt=lt||!1,ht="";for(ft in at)at.hasOwnProperty(ft)&&(ht+="&"+escape(ft)+"="+escape(at[ft]));pt=it.toJSON(at);do dt=nt+Math.floor(4096*Math.random());while(it.exists(this.runningCalls[dt]));return this.runningCalls[dt]={action:nt},it.exists(at.module)&&(this.runningCalls[dt].module=at.module),ot=tt.serverBase+"JXGServer.py",ct="action="+escape(nt)+"&id="+dt+"&dataJSON="+escape(rt.encode(pt)),this.cbp=function(gt){var mt,At,yt,bt,xt,vt,_t,Ct;if(mt=new _e.Unzip(rt.decodeAsArray(gt)).unzip(),it.isArray(mt)&&mt.length>0&&(mt=mt[0][0]),it.exists(mt)){if(At=window.JSON&&window.JSON.parse?window.JSON.parse(mt):new Function("return "+mt)(),At.type==="error")this.handleError(At);else if(At.type==="response"){for(vt=At.id,_t=0;_t<At.fields.length;_t++)yt=At.fields[_t],bt=yt.namespace+(typeof new Function("return "+yt.namespace)()=="object"?".":".prototype.")+yt.name+" = "+yt.value,new Function(bt)();for(_t=0;_t<At.handler.length;_t++){for(yt=At.handler[_t],xt=[],Ct=0;Ct<yt.parameters.length;Ct++)xt[Ct]='"'+yt.parameters[Ct]+'": '+yt.parameters[Ct];bt="if(typeof JXG.Server.modules."+this.runningCalls[vt].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[vt].module+" = {};",bt+="JXG.Server.modules."+this.runningCalls[vt].module+"."+yt.name+"_cb = "+yt.callback+";",bt+="JXG.Server.modules."+this.runningCalls[vt].module+"."+yt.name+" = function ("+yt.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[vt].module+"."+yt.name+"_cb;var __JXGSERVER_PAR__ = {"+xt.join(",")+', "module": "'+this.runningCalls[vt].module+'", "handler": "'+yt.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(bt)()}delete this.runningCalls[vt],st(At.data)}}},this.cb=tt.bind(this.cbp,this),window.XMLHttpRequest?(ut=new XMLHttpRequest,ut.overrideMimeType("text/plain; charset=iso-8859-1")):ut=new ActiveXObject("Microsoft.XMLHTTP"),!(!ut||(ut.open("POST",ot,!lt),ut.setRequestHeader("Content-type","application/x-www-form-urlencoded"),lt||(ut.onreadystatechange=function(gt){return function(){return ut.readyState===4&&ut.status===200&&(gt(ut.responseText),!0)}}(this.cb)),ut.send(ct),!lt))&&(this.cb(ut.responseText),!0)},loadModule_cb:function(nt){var st;for(st=0;st<nt.length;st++)tt.debug(nt[st].name+": "+nt[st].value)},loadModule:function(nt){return tt.Server.callServer("load",tt.Server.loadModule_cb,{module:nt},!0)}},tt.Server.load=tt.Server.loadModule,tt.Server}),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],function(tt,_e,rt,it,nt,st){return rt.Symbolic={generateSymbolicCoordinatesPartial:function(at,lt,ot,ct){var ut,ht,dt,pt=lt.ancestors,ft=0,gt=function(mt){return ct==="underscore"?ot+"_{"+mt+"}":ct==="brace"?ot+"["+mt+"]":ot+mt};at.listOfFreePoints=[],at.listOfDependantPoints=[];for(ht in pt)if(pt.hasOwnProperty(ht)&&(ut=0,st.isPoint(pt[ht]))){for(dt in pt[ht].ancestors)pt[ht].ancestors.hasOwnProperty(dt)&&ut++;ut===0?(pt[ht].symbolic.x=pt[ht].coords.usrCoords[1],pt[ht].symbolic.y=pt[ht].coords.usrCoords[2],at.listOfFreePoints.push(pt[ht])):(ft+=1,pt[ht].symbolic.x=gt(ft),ft+=1,pt[ht].symbolic.y=gt(ft),at.listOfDependantPoints.push(pt[ht]))}return st.isPoint(lt)&&(lt.symbolic.x="x",lt.symbolic.y="y"),ft},clearSymbolicCoordinates:function(at){var lt=function(ot){var ct,ut=ot&&ot.length||0;for(ct=0;ct<ut;ct++)st.isPoint(ot[ct])&&(ot[ct].symbolic.x="",ot[ct].symbolic.y="")};lt(at.listOfFreePoints),lt(at.listOfDependantPoints),delete at.listOfFreePoints,delete at.listOfDependantPoints},generatePolynomials:function(at,lt,ot){var ct,ut,ht,dt,pt=lt.ancestors,ft=[],gt=[];ot&&this.generateSymbolicCoordinatesPartial(at,lt,"u","brace"),pt[lt.id]=lt;for(ct in pt)if(pt.hasOwnProperty(ct)&&(dt=0,ft=[],st.isPoint(pt[ct]))){for(ut in pt[ct].ancestors)pt[ct].ancestors.hasOwnProperty(ut)&&dt++;if(dt>0)for(ft=pt[ct].generatePolynomial(),ht=0;ht<ft.length;ht++)gt.push(ft[ht])}return ot&&this.clearSymbolicCoordinates(at),gt},geometricLocusByGroebnerBase:function(at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt=at.options.locus,_t={},Ct=this.generateSymbolicCoordinatesPartial(at,lt,"u","brace"),St=new _e(tt.COORDS_BY_USR,[0,0],at),Et=new _e(tt.COORDS_BY_USR,[at.canvasWidth,at.canvasHeight],at),Tt=1,Mt=0,Rt=0,It=0;if(nt.modules.geoloci===void 0&&nt.loadModule("geoloci"),nt.modules.geoloci===void 0)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(ft=St.usrCoords[1],gt=Et.usrCoords[1],mt=Et.usrCoords[2],At=St.usrCoords[2],vt.translateToOrigin&&at.listOfFreePoints.length>0){for(ht=vt.toOrigin!==void 0&&vt.toOrigin!==null&&st.isInArray(at.listOfFreePoints,vt.toOrigin.id)?vt.toOrigin:at.listOfFreePoints[0],Mt=ht.symbolic.x,Rt=ht.symbolic.y,pt=0;pt<at.listOfFreePoints.length;pt++)at.listOfFreePoints[pt].symbolic.x-=Mt,at.listOfFreePoints[pt].symbolic.y-=Rt;if(ft-=Mt,gt-=Mt,mt-=Rt,At-=Rt,vt.translateTo10&&at.listOfFreePoints.length>1){for(dt=vt.to10!==void 0&&vt.to10!==null&&vt.to10.id!==vt.toOrigin.id&&st.isInArray(at.listOfFreePoints,vt.to10.id)?vt.to10:at.listOfFreePoints[0].id===ht.id?at.listOfFreePoints[1]:at.listOfFreePoints[0],It=it.rad([1,0],[0,0],[dt.symbolic.x,dt.symbolic.y]),yt=Math.cos(-It),bt=Math.sin(-It),pt=0;pt<at.listOfFreePoints.length;pt++)xt=at.listOfFreePoints[pt].symbolic.x,at.listOfFreePoints[pt].symbolic.x=yt*at.listOfFreePoints[pt].symbolic.x-bt*at.listOfFreePoints[pt].symbolic.y,at.listOfFreePoints[pt].symbolic.y=bt*xt+yt*at.listOfFreePoints[pt].symbolic.y;if(dt.symbolic.y=0,xt=ft,ft=yt*ft-bt*mt,mt=bt*xt+yt*mt,xt=gt,gt=yt*gt-bt*At,At=bt*xt+yt*At,vt.stretch&&Math.abs(dt.symbolic.x)>rt.eps){for(Tt=dt.symbolic.x,pt=0;pt<at.listOfFreePoints.length;pt++)at.listOfFreePoints[pt].symbolic.x/=Tt,at.listOfFreePoints[pt].symbolic.y/=Tt;for(pt=0;pt<at.objectsList.length;pt++)at.objectsList[pt].elementClass===tt.OBJECT_CLASS_CIRCLE&&at.objectsList[pt].method==="pointRadius"&&(_t[pt]=at.objectsList[pt].radius,at.objectsList[pt].radius/=Tt);ft/=Tt,gt/=Tt,mt/=Tt,At/=Tt,dt.symbolic.x=1}}for(pt=0;pt<at.listOfFreePoints.length;pt++)xt=at.listOfFreePoints[pt].symbolic.x,Math.abs(xt)<rt.eps&&(at.listOfFreePoints[pt].symbolic.x=0),Math.abs(xt-Math.round(xt))<rt.eps&&(at.listOfFreePoints[pt].symbolic.x=Math.round(xt)),xt=at.listOfFreePoints[pt].symbolic.y,Math.abs(xt)<rt.eps&&(at.listOfFreePoints[pt].symbolic.y=0),Math.abs(xt-Math.round(xt))<rt.eps&&(at.listOfFreePoints[pt].symbolic.y=Math.round(xt))}ot=this.generatePolynomials(at,lt),ct=ot.join(","),this.cbp=function(Ot){ut=Ot},this.cb=st.bind(this.cbp,this),nt.modules.geoloci.lociCoCoA(ft,gt,mt,At,Ct,ct,Tt,It,Mt,Rt,this.cb,!0),this.clearSymbolicCoordinates(at);for(pt in _t)_t.hasOwnProperty(pt)&&(at.objects[pt].radius=_t[pt]);return ut}},rt.Symbolic}),define("math/poly",["jxg","math/math","utils/type"],function(tt,_e,rt){return _e.Poly={},_e.Poly.Ring=function(it){this.vars=it},tt.extend(_e.Poly.Ring.prototype,{}),_e.Poly.Monomial=function(it,nt,st){var at;if(!rt.exists(it))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(rt.isArray(st)||(st=[]),st=st.slice(0,it.vars.length),at=st.length;at<it.vars.length;at++)st.push(0);this.ring=it,this.coefficient=nt||0,this.exponents=rt.deepCopy(st)},tt.extend(_e.Poly.Monomial.prototype,{copy:function(){return new _e.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var it,nt=[];for(it=0;it<this.ring.vars.length;it++)nt.push(this.ring.vars[it]+"^"+this.exponents[it]);return this.coefficient+"*"+nt.join("*")}}),_e.Poly.Polynomial=function(it,nt){var st;if(!rt.exists(it))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");st=rt.exists(nt)&&rt.isString(nt)?void 0:[],this.ring=it,this.monomials=st},tt.extend(_e.Poly.Polynomial.prototype,{findSignature:function(it){var nt;for(nt=0;nt<this.monomials.length;nt++)if(rt.cmpArrays(this.monomials[nt].exponents,it))return nt;return-1},addSubMonomial:function(it,nt){var st;st=this.findSignature(it.exponents),st>-1?this.monomials[st].coefficient+=nt*it.coefficient:(it.coefficient*=nt,this.monomials.push(it))},add:function(it){var nt;if(!rt.exists(it)||it.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(rt.isArray(it.exponents))this.addSubMonomial(it,1);else for(nt=0;nt<it.monomials.length;nt++)this.addSubMonomial(it.monomials[nt],1)},sub:function(it){var nt;if(!rt.exists(it)||it.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(rt.isArray(it.exponents))this.addSubMonomial(it,-1);else for(nt=0;nt<it.monomials.length;nt++)this.addSubMonomial(it.monomials[nt],-1)},copy:function(){var it,nt;for(nt=new _e.Poly.Polynomial(this.ring),it=0;it<this.monomials.length;it++)nt.monomials.push(this.monomials[it].copy());return nt},print:function(){var it,nt=[];for(it=0;it<this.monomials.length;it++)nt.push("("+this.monomials[it].print()+")");return nt.join("+")}}),_e.Poly}),define("math/complex",["jxg","utils/type"],function(tt,_e){return tt.Complex=function(rt,it){this.isComplex=!0,rt&&rt.isComplex&&(it=rt.imaginary,rt=rt.real),this.real=rt||0,this.imaginary=it||0,this.absval=0,this.angle=0},tt.extend(tt.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(rt){return _e.isNumber(rt)?this.real+=rt:(this.real+=rt.real,this.imaginary+=rt.imaginary),this},sub:function(rt){return _e.isNumber(rt)?this.real-=rt:(this.real-=rt.real,this.imaginary-=rt.imaginary),this},mult:function(rt){var it,nt;return _e.isNumber(rt)?(this.real*=rt,this.imaginary*=rt):(it=this.real,nt=this.imaginary,this.real=it*rt.real-nt*rt.imaginary,this.imaginary=it*rt.imaginary+nt*rt.real),this},div:function(rt){var it,nt,st;if(_e.isNumber(rt)){if(Math.abs(rt)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=rt,this.imaginary/=rt}else{if(Math.abs(rt.real)<Math.eps&&Math.abs(rt.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;it=rt.real*rt.real+rt.imaginary*rt.imaginary,st=this.real,nt=this.imaginary,this.real=(st*rt.real+nt*rt.imaginary)/it,this.imaginary=(nt*rt.real-st*rt.imaginary)/it}return this},conj:function(){return this.imaginary*=-1,this}}),tt.C={},tt.C.add=function(rt,it){var nt=new tt.Complex(rt);return nt.add(it),nt},tt.C.sub=function(rt,it){var nt=new tt.Complex(rt);return nt.sub(it),nt},tt.C.mult=function(rt,it){var nt=new tt.Complex(rt);return nt.mult(it),nt},tt.C.div=function(rt,it){var nt=new tt.Complex(rt);return nt.div(it),nt},tt.C.conj=function(rt){var it=new tt.Complex(rt);return it.conj(),it},tt.C.abs=function(rt){var it=new tt.Complex(rt);return it.conj(),it.mult(rt),Math.sqrt(it.real)},tt.Complex.C=tt.C,tt.Complex}),define("utils/color",["jxg","utils/type","math/math"],function(tt,_e,rt){var it={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},nt=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(st){return[parseInt(st[1],10),parseInt(st[2],10),parseInt(st[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(st){return[parseInt(st[1],10),parseInt(st[2],10),parseInt(st[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(st){return[parseInt(st[1],16),parseInt(st[2],16),parseInt(st[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(st){return[parseInt(st[1]+st[1],16),parseInt(st[2]+st[2],16),parseInt(st[3]+st[3],16)]}}];return tt.rgbParser=function(st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt=st;if(!_e.exists(st))return[];if(_e.exists(at)&&_e.exists(lt)&&(yt=[st,at,lt]),ot=yt,At=!1,_e.isArray(ot)){for(pt=0;pt<3;pt++)At=At||/\./.test(yt[pt].toString());for(pt=0;pt<3;pt++)At=At&&yt[pt]>=0&&yt[pt]<=1;return At?[Math.ceil(255*yt[0]),Math.ceil(255*yt[1]),Math.ceil(255*yt[2])]:yt}for(typeof yt=="string"&&(ot=yt),ot.charAt(0)==="#"&&(ot=ot.substr(1,6)),ot=ot.replace(/ /g,"").toLowerCase(),ot=it[ot]||ot,pt=0;pt<nt.length;pt++)ut=nt[pt].re,ht=nt[pt].process,(dt=ut.exec(ot))&&(ct=ht(dt),ft=ct[0],gt=ct[1],mt=ct[2]);return isNaN(ft)||isNaN(gt)||isNaN(mt)?[]:(ft=ft<0||isNaN(ft)?0:ft>255?255:ft,gt=gt<0||isNaN(gt)?0:gt>255?255:gt,mt=mt<0||isNaN(mt)?0:mt>255?255:mt,[ft,gt,mt])},tt.rgb2css=function(st,at,lt){var ot;return ot=tt.rgbParser(st,at,lt),"rgb("+ot[0]+", "+ot[1]+", "+ot[2]+")"},tt.rgb2hex=function(st,at,lt){var ot,ct,ut;return ot=tt.rgbParser(st,at,lt),ct=ot[1],ut=ot[2],ot=ot[0],ot=ot.toString(16),ct=ct.toString(16),ut=ut.toString(16),ot.length===1&&(ot="0"+ot),ct.length===1&&(ct="0"+ct),ut.length===1&&(ut="0"+ut),"#"+ot+ct+ut},tt.hex2rgb=function(st){return tt.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),tt.rgb2css(st)},tt.hsv2rgb=function(st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt;if(st=(st%360+360)%360,at===0){if(!(isNaN(st)||st<rt.eps))return"#ffffff";ot=lt,ct=lt,ut=lt}else switch(pt=st>=360?0:st,pt/=60,dt=Math.floor(pt),ht=pt-dt,ft=lt*(1-at),gt=lt*(1-at*ht),mt=lt*(1-at*(1-ht)),dt){case 0:ot=lt,ct=mt,ut=ft;break;case 1:ot=gt,ct=lt,ut=ft;break;case 2:ot=ft,ct=lt,ut=mt;break;case 3:ot=ft,ct=gt,ut=lt;break;case 4:ot=mt,ct=ft,ut=lt;break;case 5:ot=lt,ct=ft,ut=gt}return ot=Math.round(255*ot).toString(16),ot=ot.length===2?ot:ot.length===1?"0"+ot:"00",ct=Math.round(255*ct).toString(16),ct=ct.length===2?ct:ct.length===1?"0"+ct:"00",ut=Math.round(255*ut).toString(16),ut=ut.length===2?ut:ut.length===1?"0"+ut:"00",["#",ot,ct,ut].join("")},tt.rgb2hsv=function(st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt;return ot=tt.rgbParser(st,at,lt),ct=ot[1],ut=ot[2],ot=ot[0],ht=ot/255,dt=ct/255,pt=ut/255,bt=Math.max(ot,ct,ut),xt=Math.min(ot,ct,ut),ft=bt/255,gt=xt/255,yt=ft,At=0,yt>0&&(At=(yt-gt)/yt),mt=1/(ft-gt),At>0&&(bt===ot?mt*=dt-pt:mt=bt===ct?2+(pt-ht)*mt:4+(ht-dt)*mt),mt*=60,mt<0&&(mt+=360),bt===xt&&(mt=0),[mt,At,yt]},tt.rgb2LMS=function(st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return ot=tt.rgbParser(st,at,lt),ct=ot[1],ut=ot[2],ot=ot[0],ot=Math.pow(ot,.476190476),ct=Math.pow(ct,.476190476),ut=Math.pow(ut,.476190476),ht=ot*gt[0][0]+ct*gt[0][1]+ut*gt[0][2],dt=ot*gt[1][0]+ct*gt[1][1]+ut*gt[1][2],pt=ot*gt[2][0]+ct*gt[2][1]+ut*gt[2][2],ft=[ht,dt,pt],ft.l=ht,ft.m=dt,ft.s=pt,ft},tt.LMS2rgb=function(st,at,lt){var ot,ct,ut,ht,dt=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],pt=function(ft){for(var gt=127,mt=64;mt>0;){if(Math.pow(gt,.476190476)>ft)gt-=mt;else{if(Math.pow(gt+1,.476190476)>ft)return gt;gt+=mt}mt/=2}return gt===254&&13.994955247<ft?255:gt};return ot=st*dt[0][0]+at*dt[0][1]+lt*dt[0][2],ct=st*dt[1][0]+at*dt[1][1]+lt*dt[1][2],ut=st*dt[2][0]+at*dt[2][1]+lt*dt[2][2],ot=pt(ot),ct=pt(ct),ut=pt(ut),ht=[ot,ct,ut],ht.r=ot,ht.g=ct,ht.b=ut,ht},tt.rgba2rgbo=function(st){var at;return st.length===9&&st.charAt(0)==="#"?(at=parseInt(st.substr(7,2).toUpperCase(),16)/255,st=st.substr(0,7)):at=1,[st,at]},tt.rgbo2rgba=function(st,at){var lt;return st==="none"?st:(lt=Math.round(255*at).toString(16),lt.length===1&&(lt="0"+lt),st+lt)},tt.rgb2bw=function(st){var at,lt,ot,ct="0123456789ABCDEF";return st==="none"?st:(ot=tt.rgbParser(st),at=Math.floor(.3*ot[0]+.59*ot[1]+.11*ot[2]),lt=ct.charAt(at>>4&15)+ct.charAt(15&at),st="#"+lt+lt+lt)},tt.rgb2cb=function(st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt="0123456789ABCDEF";if(st==="none")return st;switch(ht=tt.rgb2LMS(st),ot=ht[0],ct=ht[1],ut=ht[2],at=at.toLowerCase()){case"protanopia":pt=-.06150039994295001,ft=.08277001656812001,gt=-.013200141220000003,mt=.05858939668799999,At=-.07934519995360001,yt=.013289415272000003,bt=.6903216543277437,dt=ut/ct,ot=dt<bt?-(ft*ct+gt*ut)/pt:-(At*ct+yt*ut)/mt;break;case"tritanopia":pt=-.00058973116217,ft=.007690316482,gt=-.01011703519052,mt=.025495080838999994,At=-.0422740347,yt=.017005316784,bt=.8349489908460004,dt=ct/ot,ut=dt<bt?-(pt*ot+ft*ct)/gt:-(mt*ot+At*ct)/yt;break;default:pt=-.06150039994295001,ft=.08277001656812001,gt=-.013200141220000003,mt=.05858939668799999,At=-.07934519995360001,yt=.013289415272000003,bt=.5763833686400911,dt=ut/ot,ct=dt<bt?-(pt*ot+gt*ut)/ft:-(mt*ot+yt*ut)/At}return lt=tt.LMS2rgb(ot,ct,ut),dt=xt.charAt(lt[0]>>4&15)+xt.charAt(15&lt[0]),st="#"+dt,dt=xt.charAt(lt[1]>>4&15)+xt.charAt(15&lt[1]),st+=dt,dt=xt.charAt(lt[2]>>4&15)+xt.charAt(15&lt[2]),st+=dt},tt.autoHighlight=function(st){var at=tt.rgba2rgbo(st),lt=at[0],ot=at[1];return st.charAt(0)==="#"?(ot*=ot<.3?1.8:.4,tt.rgbo2rgba(lt,ot)):st},tt}),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],function(tt,_e,rt,it,nt){return tt.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],zoomFactor:1,zoomX:1,zoomY:1,showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"⌘",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,registerEvents:!0,minimizeReflow:"svg",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1}},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888",visible:"inherit",includeBoundaries:!1},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",strokeWidth:2,strokeColor:"blue",ticksDistance:.2},precision:{touch:15,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"},arc:{visible:!1}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1,center:{},radiuspoint:{},anglepoint:{}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},button:{disabled:!1},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:13,doAdvancedPlotOld:!1,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"black",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},inequality:{fillColor:"red",fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"black",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"black",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1,visible:"inherit"},label:{offset:[0,0]}},prescribedangle:{anglepoint:{size:2,visible:!1,withLabel:!1}},regularpolygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiuspoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglepoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,fixed:!0,scalable:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,precision:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,fixed:!0,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"black",highlightStrokeColor:"black",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},tt.Validator=function(){var st,at=function(At){return/^[0-9]+px$/.test(At)},lt=function(At){return At==="html"||At==="internal"},ot=function(At){return nt.isString(At)},ct=function(At){return nt.exists(tt.normalizePointFace(At))},ut=function(At){return Math.abs(At-Math.round(At))<rt.eps},ht=function(At){return ut(At)&&At>0},dt=function(At){return At==="vml"||At==="svg"||At==="canvas"||At==="no"},pt=function(At){return At>0},ft=function(At){return At>=0},gt={},mt={attractorDistance:ft,color:ot,defaultDistance:nt.isNumber,display:lt,doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:ct,factor:nt.isNumber,fillColor:ot,fillOpacity:nt.isNumber,firstArrow:!1,fontSize:ut,dash:ut,gridX:nt.isNumber,gridY:nt.isNumber,hasGrid:!1,highlightFillColor:ot,highlightFillOpacity:nt.isNumber,highlightStrokeColor:ot,highlightStrokeOpacity:nt.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:ut,minorHeight:ut,minorTicks:ft,minTicksDistance:ht,numberPointsHigh:ht,numberPointsLow:ht,opacity:nt.isNumber,radius:nt.isNumber,RDPsmoothing:!1,renderer:dt,right:at,showCopyright:!1,showInfobox:!1,showNavigation:!1,size:ut,snapSizeX:pt,snapSizeY:pt,snapWidth:nt.isNumber,snapToGrid:!1,snatchDistance:ft,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:ot,strokeOpacity:nt.isNumber,strokeWidth:ut,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(st in mt)mt.hasOwnProperty(st)&&(gt[st.toLowerCase()]=mt[st]);return gt}(),tt.normalizePointFace=function(st){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[st]},tt.useStandardOptions=function(st){var at,lt,ot,ct,ut=tt.Options,ht=st.hasGrid;st.options.grid.hasGrid=ut.grid.hasGrid,st.options.grid.gridX=ut.grid.gridX,st.options.grid.gridY=ut.grid.gridY,st.options.grid.gridColor=ut.grid.gridColor,st.options.grid.gridOpacity=ut.grid.gridOpacity,st.options.grid.gridDash=ut.grid.gridDash,st.options.grid.snapToGrid=ut.grid.snapToGrid,st.options.grid.snapSizeX=ut.grid.SnapSizeX,st.options.grid.snapSizeY=ut.grid.SnapSizeY,st.takeSizeFromFile=ut.takeSizeFromFile,ct=function(dt,pt){dt.visProp.fillcolor=pt.fillColor,dt.visProp.highlightfillcolor=pt.highlightFillColor,dt.visProp.strokecolor=pt.strokeColor,dt.visProp.highlightstrokecolor=pt.highlightStrokeColor};for(at in st.objects)if(st.objects.hasOwnProperty(at))if(ot=st.objects[at],ot.elementClass===_e.OBJECT_CLASS_POINT)ct(ot,ut.point);else if(ot.elementClass===_e.OBJECT_CLASS_LINE)for(ct(ot,ut.line),lt=0;lt<ot.ticks.length;lt++)ot.ticks[lt].majorTicks=ut.line.ticks.majorTicks,ot.ticks[lt].minTicksDistance=ut.line.ticks.minTicksDistance,ot.ticks[lt].visProp.minorheight=ut.line.ticks.minorHeight,ot.ticks[lt].visProp.majorheight=ut.line.ticks.majorHeight;else ot.elementClass===_e.OBJECT_CLASS_CIRCLE?ct(ot,ut.circle):ot.type===_e.OBJECT_TYPE_ANGLE?ct(ot,ut.angle):ot.type===_e.OBJECT_TYPE_ARC?ct(ot,ut.arc):ot.type===_e.OBJECT_TYPE_POLYGON?ct(ot,ut.polygon):ot.type===_e.OBJECT_TYPE_CONIC?ct(ot,ut.conic):ot.type===_e.OBJECT_TYPE_CURVE?ct(ot,ut.curve):ot.type===_e.OBJECT_TYPE_SECTOR&&(ot.arc.visProp.fillcolor=ut.sector.fillColor,ot.arc.visProp.highlightfillcolor=ut.sector.highlightFillColor,ot.arc.visProp.fillopacity=ut.sector.fillOpacity,ot.arc.visProp.highlightfillopacity=ut.sector.highlightFillOpacity);st.fullUpdate(),ht&&!st.hasGrid?st.removeGrids(st):!ht&&st.hasGrid&&st.create("grid",[])},tt.useBlackWhiteOptions=function(st){var at=tt.Options;at.point.fillColor=it.rgb2bw(at.point.fillColor),at.point.highlightFillColor=it.rgb2bw(at.point.highlightFillColor),at.point.strokeColor=it.rgb2bw(at.point.strokeColor),at.point.highlightStrokeColor=it.rgb2bw(at.point.highlightStrokeColor),at.line.fillColor=it.rgb2bw(at.line.fillColor),at.line.highlightFillColor=it.rgb2bw(at.line.highlightFillColor),at.line.strokeColor=it.rgb2bw(at.line.strokeColor),at.line.highlightStrokeColor=it.rgb2bw(at.line.highlightStrokeColor),at.circle.fillColor=it.rgb2bw(at.circle.fillColor),at.circle.highlightFillColor=it.rgb2bw(at.circle.highlightFillColor),at.circle.strokeColor=it.rgb2bw(at.circle.strokeColor),at.circle.highlightStrokeColor=it.rgb2bw(at.circle.highlightStrokeColor),at.arc.fillColor=it.rgb2bw(at.arc.fillColor),at.arc.highlightFillColor=it.rgb2bw(at.arc.highlightFillColor),at.arc.strokeColor=it.rgb2bw(at.arc.strokeColor),at.arc.highlightStrokeColor=it.rgb2bw(at.arc.highlightStrokeColor),at.polygon.fillColor=it.rgb2bw(at.polygon.fillColor),at.polygon.highlightFillColor=it.rgb2bw(at.polygon.highlightFillColor),at.sector.fillColor=it.rgb2bw(at.sector.fillColor),at.sector.highlightFillColor=it.rgb2bw(at.sector.highlightFillColor),at.curve.strokeColor=it.rgb2bw(at.curve.strokeColor),at.grid.gridColor=it.rgb2bw(at.grid.gridColor),tt.useStandardOptions(st)},tt.Options.normalizePointFace=tt.normalizePointFace,tt.Options}),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],function(tt,_e,rt,it,nt,st,at,lt){return tt.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},tt.extend(tt.AbstractRenderer.prototype,{_updateVisual:function(ot,ct,ut){(ut||this.enhancedRendering)&&(ct=ct||{},this.setObjectTransition(ot),at.evaluate(ot.visProp.draft)?this.setDraft(ot):(ct.stroke||(ot.highlighted?(this.setObjectStrokeColor(ot,ot.visProp.highlightstrokecolor,ot.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(ot,ot.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(ot,ot.visProp.strokecolor,ot.visProp.strokeopacity),this.setObjectStrokeWidth(ot,ot.visProp.strokewidth))),ct.fill||(ot.highlighted?this.setObjectFillColor(ot,ot.visProp.highlightfillcolor,ot.visProp.highlightfillopacity):this.setObjectFillColor(ot,ot.visProp.fillcolor,ot.visProp.fillopacity)),ct.dash||this.setDashStyle(ot,ot.visProp),ct.shadow||this.setShadow(ot),ct.gradient||this.setShadow(ot)))},drawPoint:function(ot){var ct,ut=_e.normalizePointFace(at.evaluate(ot.visProp.face));ct=ut==="o"?"ellipse":ut==="[]"?"rect":"path",ot.rendNode=this.appendChildPrim(this.createPrim(ct,ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,ct),this._updateVisual(ot,{dash:!0,shadow:!0},!0),this.updatePoint(ot)},updatePoint:function(ot){var ct,ut=at.evaluate(ot.visProp.size),ht=_e.normalizePointFace(at.evaluate(ot.visProp.face)),dt=at.evaluate(ot.visProp.sizeunit),pt=at.evaluate(ot.visProp.zoom);isNaN(ot.coords.scrCoords[2]+ot.coords.scrCoords[1])||(dt==="user"&&(ut*=Math.sqrt(ot.board.unitX*ot.board.unitY)),ut*=ot.board&&pt?Math.sqrt(ot.board.zoomX*ot.board.zoomY):1,ct=ut===0?0:ut+1,ht==="o"?this.updateEllipsePrim(ot.rendNode,ot.coords.scrCoords[1],ot.coords.scrCoords[2],ct,ct):ht==="[]"?this.updateRectPrim(ot.rendNode,ot.coords.scrCoords[1]-ut,ot.coords.scrCoords[2]-ut,2*ut,2*ut):this.updatePathPrim(ot.rendNode,this.updatePathStringPoint(ot,ut,ht),ot.board),this._updateVisual(ot,{dash:!1,shadow:!1}),this.setShadow(ot))},changePointStyle:function(ot){var ct=this.getElementById(ot.id);at.exists(ct)&&this.remove(ct),this.drawPoint(ot),at.clearVisPropOld(ot),ot.visPropCalc.visible||this.hide(ot),at.evaluate(ot.visProp.draft)&&this.setDraft(ot)},drawLine:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("line",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"lines"),this.updateLine(ot)},updateLineEndings:function(ot,ct){var ut,ht=new rt(it.COORDS_BY_USER,ot.point1.coords.usrCoords,ot.board),dt=new rt(it.COORDS_BY_USER,ot.point2.coords.usrCoords,ot.board),pt=null;return pt=at.evaluate(ot.visProp.margin),st.calcStraight(ot,ht,dt,pt),ut=this.getPositionArrowHead(ot,ht,dt,ct),this.updateLinePrim(ot.rendNode,ut.c1.scrCoords[1]+ut.d1x,ut.c1.scrCoords[2]+ut.d1y,ut.c2.scrCoords[1]-ut.d2x,ut.c2.scrCoords[2]-ut.d2y,ot.board),ut},updateArrowSize:function(ot,ct){var ut,ht,dt;return ht=at.evaluate(ot.visProp.firstarrow),ht&&(ut=at.exists(ht.size)?at.evaluate(ht.size):3,this._setArrowWidth(ot.rendNodeTriangleStart,ct.sFirst,ot.rendNode,ut)),dt=at.evaluate(ot.visProp.lastarrow),dt&&(ut=at.exists(dt.size)?at.evaluate(dt.size):3,this._setArrowWidth(ot.rendNodeTriangleEnd,ct.sLast,ot.rendNode,ut)),this},updateLine:function(ot){var ct;ct=this.updateLineEndings(ot,at.evaluate(ot.visProp.strokewidth)),this.makeArrows(ot),this._updateVisual(ot),this.updateArrowSize(ot,ct),this.setLineCap(ot)},getPositionArrowHead:function(ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=nt.eps,St=0,Et=0,Tt=at.evaluate(ot.visProp.firstarrow),Mt=at.evaluate(ot.visProp.lastarrow);return mt=At=yt=bt=0,(Tt||Mt)&&(pt=at.evaluate(ot.point1.visProp.size)+at.evaluate(ot.point1.visProp.strokewidth),ft=at.evaluate(ot.point2.visProp.size)+at.evaluate(ot.point2.visProp.strokewidth),dt=pt+ft,Mt&&at.evaluate(ot.visProp.touchlastpoint)&&(gt=ct.distance(it.COORDS_BY_SCREEN,ut))>dt&&(yt=(ut.scrCoords[1]-ct.scrCoords[1])*ft/gt,bt=(ut.scrCoords[2]-ct.scrCoords[2])*ft/gt,ut=new rt(it.COORDS_BY_SCREEN,[ut.scrCoords[1]-yt,ut.scrCoords[2]-bt],ot.board)),Tt&&at.evaluate(ot.visProp.touchfirstpoint)&&(gt=ct.distance(it.COORDS_BY_SCREEN,ut))>dt&&(mt=(ut.scrCoords[1]-ct.scrCoords[1])*pt/gt,At=(ut.scrCoords[2]-ct.scrCoords[2])*pt/gt,ct=new rt(it.COORDS_BY_SCREEN,[ct.scrCoords[1]+mt,ct.scrCoords[2]+At],ot.board)),mt=At=yt=bt=0,gt=ct.distance(it.COORDS_BY_SCREEN,ut),at.exists(Tt.type)&&(xt=at.evaluate(Tt.type)),at.exists(Mt.type)&&(vt=at.evaluate(Mt.type)),Tt&&(_t=at.exists(Tt.size)?at.evaluate(Tt.size):3,St=ht*_t,xt===2?(St*=.5,Ct+=ht*_t):xt===3?(St=ht,Ct+=ht):Ct+=ht*_t),Mt&&(_t=at.exists(Mt.size)?at.evaluate(Mt.size):3,Et=ht*_t,vt===2?(Et*=.5,Ct+=ht*_t):vt===3?(Et=ht,Ct+=ht):Ct+=ht*_t),Tt&&ot.board.renderer.type!=="vml"&&(gt>=Ct?(mt=(ut.scrCoords[1]-ct.scrCoords[1])*St/gt,At=(ut.scrCoords[2]-ct.scrCoords[2])*St/gt):St=0),Mt&&ot.board.renderer.type!=="vml"&&(gt>=Ct?(yt=(ut.scrCoords[1]-ct.scrCoords[1])*Et/gt,bt=(ut.scrCoords[2]-ct.scrCoords[2])*Et/gt):Et=0)),{c1:ct,c2:ut,d1x:mt,d1y:At,d2x:yt,d2y:bt,sFirst:St,sLast:Et}},setLineCap:function(ot){},drawTicks:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("path",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"path")},updateTicks:function(ot){},drawCurve:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("path",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"path"),ot.numberPoints>1&&this.makeArrows(ot),this._updateVisual(ot,{shadow:!0},!0),this.updateCurve(ot)},updateCurve:function(ot){var ct,ut,ht,dt=at.evaluate(ot.visProp.strokewidth);at.evaluate(ot.visProp.handdrawing)?this.updatePathPrim(ot.rendNode,this.updatePathStringBezierPrim(ot),ot.board):this.updatePathPrim(ot.rendNode,this.updatePathStringPrim(ot),ot.board),ot.numberPoints>1&&(this.makeArrows(ot),ut=at.evaluate(ot.visProp.firstarrow),ut&&(ct=at.exists(ut.size)?at.evaluate(ut.size):3,this._setArrowWidth(ot.rendNodeTriangleStart,dt,ot.rendNode,ct)),(ht=at.evaluate(ot.visProp.lastarrow))&&(ct=at.exists(ht.size)?at.evaluate(ht.size):3,this._setArrowWidth(ot.rendNodeTriangleEnd,dt,ot.rendNode,ct))),this._updateVisual(ot)},drawEllipse:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("ellipse",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"ellipse"),this.updateEllipse(ot)},updateEllipse:function(ot){this._updateVisual(ot);var ct=ot.Radius();ct>0&&Math.abs(ot.center.coords.usrCoords[0])>nt.eps&&!isNaN(ct+ot.center.coords.scrCoords[1]+ot.center.coords.scrCoords[2])&&ct*ot.board.unitX<2e6&&this.updateEllipsePrim(ot.rendNode,ot.center.coords.scrCoords[1],ot.center.coords.scrCoords[2],ct*ot.board.unitX,ct*ot.board.unitY)},drawPolygon:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("polygon",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"polygon"),this.updatePolygon(ot)},updatePolygon:function(ot){this._updateVisual(ot,{stroke:!0,dash:!0}),this.updatePolygonPrim(ot.rendNode,ot)},displayCopyright:function(ot,ct){},drawInternalText:function(ot){},updateInternalText:function(ot){},drawText:function(ot){var ct,ut,ht;at.evaluate(ot.visProp.display)==="html"&&lt.isBrowser&&this.type!=="no"?(ct=this.container.ownerDocument.createElement("div"),ct.style.position="absolute",ct.className=at.evaluate(ot.visProp.cssclass),ht=at.evaluate(ot.visProp.layer),at.exists(ht)||(ht=0),ut=this.container.style.zIndex===""?0:parseInt(this.container.style.zIndex,10),ct.style.zIndex=ut+ht,this.container.appendChild(ct),ct.setAttribute("id",this.container.id+"_"+ot.id)):ct=this.drawInternalText(ot),ot.rendNode=ct,ot.htmlStr="",this.updateText(ot)},updateText:function(ot){var ct,ut,ht,dt,pt,ft=ot.plaintext;if(ot.visPropCalc.visible)if(this.updateTextStyle(ot,!1),at.evaluate(ot.visProp.display)==="html"&&this.type!=="no"){if(isNaN(ot.coords.scrCoords[1]+ot.coords.scrCoords[2])||(ut=ot.coords.scrCoords[1],ut=Math.abs(ut)<1e6?ut:1e6,dt=ot.getAnchorX(),ct=Math.floor(dt==="right"?ot.board.canvasWidth-ut:dt==="middle"?ut-.5*ot.size[0]:ut),ot.visPropOld.left!==dt+ct&&(dt==="right"?(ot.rendNode.style.right=ct+"px",ot.rendNode.style.left="auto"):(ot.rendNode.style.left=ct+"px",ot.rendNode.style.right="auto"),ot.visPropOld.left=dt+ct),ut=ot.coords.scrCoords[2]+this.vOffsetText,ut=Math.abs(ut)<1e6?ut:1e6,pt=ot.getAnchorY(),ct=Math.floor(pt==="bottom"?ot.board.canvasHeight-ut:pt==="middle"?ut-.5*ot.size[1]:ut),ot.visPropOld.top!==pt+ct&&(pt==="bottom"?(ot.rendNode.style.top="auto",ot.rendNode.style.bottom=ct+"px"):(ot.rendNode.style.bottom="auto",ot.rendNode.style.top=ct+"px"),ot.visPropOld.top=pt+ct)),ot.htmlStr!==ft){try{ot.rendNode.innerHTML=ft}catch{ht=ot.rendNode.parentNode,ot.rendNode.parentNode.removeChild(ot.rendNode),ot.rendNode.innerHTML=ft,ht.appendChild(ot.rendNode)}if(ot.htmlStr=ft,at.evaluate(ot.visProp.usemathjax))try{MathJax.Hub.Queue(["Typeset",MathJax.Hub,ot.rendNode])}catch{tt.debug("MathJax (not yet) loaded")}else if(at.evaluate(ot.visProp.useasciimathml))try{AMprocessNode(ot.rendNode,!1)}catch{tt.debug("AsciiMathML (not yet) loaded")}}this.transformImage(ot,ot.transformations)}else this.updateInternalText(ot)},_css2js:function(ot){var ct,ut,ht,dt,pt,ft=[],gt=at.trim(ot).replace(/;$/,"").split(";");for(ut=gt.length,ct=0;ct<ut;++ct)at.trim(gt[ct])!==""&&(pt=gt[ct].split(":"),ht=at.trim(pt[0].replace(/-([a-z])/gi,function(mt,At){return At.toUpperCase()})),dt=at.trim(pt[1]),ft.push({key:ht,val:dt}));return ft},updateTextStyle:function(ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt=ot.visProp,xt=lt.isBrowser?bt.display:"internal",vt=["rendNode","rendNodeTag","rendNodeLabel"],_t=vt.length,Ct=["cssdefaultstyle","cssstyle"],St=Ct.length;if(ct?(dt=bt.highlightstrokecolor,ht=bt.highlightstrokeopacity,pt=bt.highlightcssclass):(dt=bt.strokecolor,ht=bt.strokeopacity,pt=bt.cssclass),this.type!=="no"&&(xt==="html"||this.type!=="canvas")){for(At=0;At<St;At++)if((yt=at.evaluate(bt[(ct?"highlight":"")+Ct[At]]))!==""&&ot.visPropOld[Ct[At]]!==yt){for(gt=this._css2js(yt),ft=0;ft<_t;ft++)if(at.exists(ot[vt[ft]]))for(mt in gt)gt.hasOwnProperty(mt)&&(ot[vt[ft]].style[gt[mt].key]=gt[mt].val);ot.visPropOld[Ct[At]]=yt}if(ut=at.evaluate(bt.fontsize),ot.visPropOld.fontsize!==ut){ot.needsSizeUpdate=!0;try{for(ft=0;ft<_t;ft++)at.exists(ot[vt[ft]])&&(ot[vt[ft]].style.fontSize=ut+"px")}catch{for(ft=0;ft<_t;ft++)at.exists(ot[vt[ft]])&&(ot[vt[ft]].style.fontSize=ut)}ot.visPropOld.fontsize=ut}}return this.setObjectTransition(ot),xt==="html"&&this.type!=="no"?(ot.visPropOld.cssclass!==pt&&(ot.rendNode.className=pt,ot.visPropOld.cssclass=pt,ot.needsSizeUpdate=!0),this.setObjectStrokeColor(ot,dt,ht)):this.updateInternalTextStyle(ot,dt,ht),this},updateInternalTextStyle:function(ot,ct,ut){this.setObjectStrokeColor(ot,ct,ut)},drawImage:function(ot){},updateImage:function(ot){this.updateRectPrim(ot.rendNode,ot.coords.scrCoords[1],ot.coords.scrCoords[2]-ot.size[1],ot.size[0],ot.size[1]),this.updateImageURL(ot),this.transformImage(ot,ot.transformations),this._updateVisual(ot,{stroke:!0,dash:!0},!0)},joinTransforms:function(ot,ct){var ut,ht=ot.board.origin.scrCoords[1],dt=ot.board.origin.scrCoords[2],pt=ot.board.unitX,ft=ot.board.unitY,gt=ct.length,mt=[[1,0,0],[-ht/pt,1/pt,0],[dt/ft,0,-1/ft]];for(ut=0;ut<gt;ut++)mt=nt.matMatMult(ct[ut].matrix,mt);return mt=nt.matMatMult([[1,0,0],[ht,pt,0],[dt,0,-ft]],mt)},transformImage:function(ot,ct){},updateImageURL:function(ot){},updateImageStyle:function(ot,ct){ot.rendNode.className=at.evaluate(ct?ot.visProp.highlightcssclass:ot.visProp.cssclass)},appendChildPrim:function(ot,ct){},appendNodesToElement:function(ot,ct){},createPrim:function(ot,ct){return null},remove:function(ot){},makeArrows:function(ot){},_setArrowWidth:function(ot,ct,ut){},updateEllipsePrim:function(ot,ct,ut,ht,dt){},updateLinePrim:function(ot,ct,ut,ht,dt,pt){},updatePathPrim:function(ot,ct,ut){},updatePathStringPoint:function(ot,ct,ut){},updatePathStringPrim:function(ot){},updatePathStringBezierPrim:function(ot){},updatePolygonPrim:function(ot,ct){},updateRectPrim:function(ot,ct,ut,ht,dt){},setPropertyPrim:function(ot,ct,ut){},display:function(ot,ct){ot&&(ot.visPropOld.visible=ct)},show:function(ot){},hide:function(ot){},setBuffering:function(ot,ct){},setDashStyle:function(ot){},setDraft:function(ot){if(at.evaluate(ot.visProp.draft)){var ct=ot.board.options.elements.draft.color,ut=ot.board.options.elements.draft.opacity;this.setObjectTransition(ot),ot.type===it.OBJECT_TYPE_POLYGON?this.setObjectFillColor(ot,ct,ut):(ot.elementClass===it.OBJECT_CLASS_POINT?this.setObjectFillColor(ot,ct,ut):this.setObjectFillColor(ot,"none",0),this.setObjectStrokeColor(ot,ct,ut),this.setObjectStrokeWidth(ot,ot.board.options.elements.draft.strokeWidth))}},removeDraft:function(ot){this.setObjectTransition(ot),ot.type===it.OBJECT_TYPE_POLYGON?this.setObjectFillColor(ot,ot.visProp.fillcolor,ot.visProp.fillopacity):(ot.type===it.OBJECT_CLASS_POINT&&this.setObjectFillColor(ot,ot.visProp.fillcolor,ot.visProp.fillopacity),this.setObjectStrokeColor(ot,ot.visProp.strokecolor,ot.visProp.strokeopacity),this.setObjectStrokeWidth(ot,ot.visProp.strokewidth))},setGradient:function(ot){},updateGradient:function(ot){},setObjectTransition:function(ot,ct){},setObjectFillColor:function(ot,ct,ut){},setObjectStrokeColor:function(ot,ct,ut){},setObjectStrokeWidth:function(ot,ct){},setShadow:function(ot){},highlight:function(ot){var ct,ut,ht,dt=ot.visProp;if(this.setObjectTransition(ot),!dt.draft){if(ot.type===it.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(ot,dt.highlightfillcolor,dt.highlightfillopacity),ct=0;ct<ot.borders.length;ct++)this.setObjectStrokeColor(ot.borders[ct],ot.borders[ct].visProp.highlightstrokecolor,ot.borders[ct].visProp.highlightstrokeopacity);else ot.elementClass===it.OBJECT_CLASS_TEXT?this.updateTextStyle(ot,!0):ot.type===it.OBJECT_TYPE_IMAGE?(this.updateImageStyle(ot,!0),this.setObjectFillColor(ot,dt.highlightfillcolor,dt.highlightfillopacity)):(this.setObjectStrokeColor(ot,dt.highlightstrokecolor,dt.highlightstrokeopacity),this.setObjectFillColor(ot,dt.highlightfillcolor,dt.highlightfillopacity));dt.highlightstrokewidth&&(ut=Math.max(at.evaluate(dt.highlightstrokewidth),at.evaluate(dt.strokewidth)),this.setObjectStrokeWidth(ot,ut),ot.elementClass===it.OBJECT_CLASS_LINE&&(ht=this.updateLineEndings(ot,ut),this.makeArrows(ot),this.updateArrowSize(ot,ht)))}return this},noHighlight:function(ot){var ct,ut,ht,dt=ot.visProp;if(this.setObjectTransition(ot),!at.evaluate(ot.visProp.draft)){if(ot.type===it.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(ot,dt.fillcolor,dt.fillopacity),ct=0;ct<ot.borders.length;ct++)this.setObjectStrokeColor(ot.borders[ct],ot.borders[ct].visProp.strokecolor,ot.borders[ct].visProp.strokeopacity);else ot.elementClass===it.OBJECT_CLASS_TEXT?this.updateTextStyle(ot,!1):ot.type===it.OBJECT_TYPE_IMAGE?(this.updateImageStyle(ot,!1),this.setObjectFillColor(ot,dt.fillcolor,dt.fillopacity)):(this.setObjectStrokeColor(ot,dt.strokecolor,dt.strokeopacity),this.setObjectFillColor(ot,dt.fillcolor,dt.fillopacity));ht=at.evaluate(dt.strokewidth),this.setObjectStrokeWidth(ot,ht),ot.elementClass===it.OBJECT_CLASS_LINE&&(ut=this.updateLineEndings(ot,ht),this.makeArrows(ot),this.updateArrowSize(ot,ut))}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(ot,ct){var ut,ht,dt=function(ft){ft||(ft=window.event),ft.stopPropagation?ft.stopPropagation():ft.cancelBubble=!0},pt=function(ft,gt){var mt;mt=ut.createElement("span"),ht.appendChild(mt),mt.appendChild(ut.createTextNode(ft)),mt.style.paddingLeft="7px",mt.style.paddingRight="7px",lt.addEvent(mt,"mouseover",function(){this.style.backgroundColor=ct.highlightfillcolor},mt),lt.addEvent(mt,"mouseover",function(){this.style.backgroundColor=ct.highlightfillcolor},mt),lt.addEvent(mt,"mouseout",function(){this.style.backgroundColor=ct.fillcolor},mt),lt.addEvent(mt,"click",function(At){return at.bind(gt,ot)(),!1},ot),lt.addEvent(mt,"mouseup",dt,ot),lt.addEvent(mt,"mousedown",dt,ot),lt.addEvent(mt,"touchend",dt,ot),lt.addEvent(mt,"touchstart",dt,ot)};lt.isBrowser&&this.type!=="no"&&(ut=ot.containerObj.ownerDocument,ht=ut.createElement("div"),ht.setAttribute("id",ot.containerObj.id+"_navigationbar"),ht.style.color=ct.strokecolor,ht.style.backgroundColor=ct.fillcolor,ht.style.padding=ct.padding,ht.style.position=ct.position,ht.style.fontSize=ct.fontsize,ht.style.cursor=ct.cursor,ht.style.zIndex=ct.zindex,ot.containerObj.appendChild(ht),ht.style.right=ct.right,ht.style.bottom=ct.bottom,ot.attr.showscreenshot&&pt(ot.attr.screenshot.symbol,function(){setTimeout(function(){ot.renderer.screenshot(ot,"",!1)},330)}),ot.attr.showreload&&pt("↻",function(){ot.reload()}),ot.attr.showcleartraces&&pt("⊗",function(){ot.clearTraces()}),ot.attr.shownavigation&&(ot.attr.showzoom&&(pt("–",ot.zoomOut),pt("o",ot.zoom100),pt("+",ot.zoomIn)),pt("←",ot.clickLeftArrow),pt("↓",ot.clickUpArrow),pt("↑",ot.clickDownArrow),pt("→",ot.clickRightArrow)))},getElementById:function(ot){return at.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+ot):""},removeToInsertLater:function(ot){var ct=ot.parentNode,ut=ot.nextSibling;return ct.removeChild(ot),function(){ut?ct.insertBefore(ot,ut):ct.appendChild(ot)}},resize:function(ot,ct){},createTouchpoints:function(ot){},showTouchpoint:function(ot){},hideTouchpoint:function(ot){},updateTouchpoint:function(ot,ct){},dumpToCanvas:function(ot){},screenshot:function(ot){}}),tt.AbstractRenderer}),define("renderer/no",["jxg","renderer/abstract"],function(tt,_e){return tt.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},tt.extend(tt.NoRenderer.prototype,{drawPoint:function(rt){},updatePoint:function(rt){},changePointStyle:function(rt){},drawLine:function(rt){},updateLine:function(rt){},drawTicks:function(rt){},updateTicks:function(rt){},drawCurve:function(rt){},updateCurve:function(rt){},drawEllipse:function(rt){},updateEllipse:function(rt){},drawPolygon:function(rt){},updatePolygon:function(rt){},displayCopyright:function(rt,it){},drawInternalText:function(rt){},updateInternalText:function(rt){},drawText:function(rt){},updateText:function(rt){},updateTextStyle:function(rt,it){},updateInternalTextStyle:function(rt,it,nt){},drawImage:function(rt){},updateImage:function(rt){},transformImage:function(rt,it){},updateImageURL:function(rt){},appendChildPrim:function(rt,it){},appendNodesToElement:function(rt,it){},createPrim:function(rt,it){return null},remove:function(rt){},makeArrows:function(rt){},updateEllipsePrim:function(rt,it,nt,st,at){},updateLinePrim:function(rt,it,nt,st,at,lt){},updatePathPrim:function(rt,it,nt){},updatePathStringPoint:function(rt,it,nt){},updatePathStringPrim:function(rt){},updatePathStringBezierPrim:function(rt){},updatePolygonPrim:function(rt,it){},updateRectPrim:function(rt,it,nt,st,at){},setPropertyPrim:function(rt,it,nt){},display:function(rt,it){rt&&(rt.visPropOld.visible=it)},show:function(rt){},hide:function(rt){},setBuffering:function(rt,it){},setDashStyle:function(rt){},setDraft:function(rt){},removeDraft:function(rt){},setGradient:function(rt){},updateGradient:function(rt){},setObjectTransition:function(rt,it){},setObjectFillColor:function(rt,it,nt){},setObjectStrokeColor:function(rt,it,nt){},setObjectStrokeWidth:function(rt,it){},setShadow:function(rt){},highlight:function(rt){},noHighlight:function(rt){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(rt){},getElementById:function(rt){return null},resize:function(rt,it){},removeToInsertLater:function(){return function(){}}}),tt.NoRenderer.prototype=new _e,tt.NoRenderer}),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],function(tt,_e,rt,it,nt){return tt.FileReader={parseFileContent:function(st,at,lt,ot,ct){var ut=!1;rt.exists(ot)||(ot=!0);try{ut=new XMLHttpRequest,lt.toLowerCase()==="raw"?ut.overrideMimeType("text/plain; charset=iso-8859-1"):ut.overrideMimeType("text/xml; charset=iso-8859-1")}catch{try{ut=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{ut=new ActiveXObject("Microsoft.XMLHTTP")}catch{ut=!1}}}if(!ut)return void tt.debug("AJAX not activated!");ut.open("GET",st,ot),lt.toLowerCase()==="raw"?this.cbp=function(){var ht=ut;ht.readyState===4&&at(ht.responseText)}:this.cbp=function(){var ht=ut,dt="";ht.readyState===4&&(dt=!rt.exists(ht.responseStream)||ht.responseText.slice(0,2)!=="PK"&&it.asciiCharCodeAt(ht.responseText.slice(0,1),0)!==31?ht.responseText:nt.decode(jxgBinFileReader(ht)),this.parseString(dt,at,lt,ct))},this.cb=rt.bind(this.cbp,this),ut.onreadystatechange=this.cb;try{ut.send(null)}catch{throw new Error("JSXGraph: A problem occurred while trying to read '"+st+"'.")}},parseString:function(st,at,lt,ot){var ct,ut;if(lt=lt.toLowerCase(),ct=tt.readers[lt],!rt.exists(ct))throw new Error("JSXGraph: There is no reader available for '"+lt+"'.");ut=new ct(at,st),ut.read(),rt.isFunction(ot)&&ot(at)}},!_e.isMetroApp()&&_e.isBrowser&&typeof navigator=="object"&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write(`<script type="text/vbscript">
Function Base64Encode(inData)
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim cOut, sOut, I
  For I = 1 To LenB(inData) Step 3
    Dim nGroup, pOut, sGroup
    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _
      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))
    nGroup = Oct(nGroup)
    nGroup = String(8 - Len(nGroup), "0") & nGroup
    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)
    sOut = sOut + pOut
  Next
  Select Case LenB(inData) Mod 3
    Case 1: '8 bit final
      sOut = Left(sOut, Len(sOut) - 2) + "=="
    Case 2: '16 bit final
      sOut = Left(sOut, Len(sOut) - 1) + "="
  End Select
  Base64Encode = sOut
End Function

Function MyASC(OneChar)
  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)
End Function

Function jxgBinFileReader(xhr)
    Dim byteString
    Dim b64String
    Dim i
    byteString = xhr.responseBody
    ReDim byteArray(LenB(byteString))
    For i = 1 To LenB(byteString)
        byteArray(i-1) = AscB(MidB(byteString, i, 1))
    Next
    b64String = Base64Encode(byteString)
    jxgBinFileReader = b64String
End Function
<\/script>
`),tt.FileReader}),define("parser/geonext",["jxg","base/constants","utils/type"],function(tt,_e,rt){return tt.GeonextParser={replacePow:function(it){var nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt;for(it=it.replace(/(\s*)\^(\s*)/g,"^"),pt=it.indexOf("^"),lt=-1;pt>=0&&pt<it.length-1;){if(lt===pt)throw new Error("JSXGraph: Error while parsing expression '"+it+"'");if(lt=pt,dt=it.slice(0,pt),ft=it.slice(pt+1),dt.charAt(dt.length-1)===")"){for(nt=1,st=dt.length-2;st>=0&&nt>0;)at=dt.charAt(st),at===")"?nt++:at==="("&&(nt-=1),st-=1;if(nt!==0)throw new Error("JSXGraph: Missing '(' in expression");for(ot="",ut=dt.substring(0,st+1),ht=st;ht>=0&&ut.substr(ht,1).match(/([\w\.]+)/);)ot=RegExp.$1+ot,ht-=1;ot+=dt.substring(st+1,dt.length),ot=ot.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else ot="[\\w\\.]+";if(ft.match(/^([\w\.]*\()/)){for(nt=1,st=RegExp.$1.length;st<ft.length&&nt>0;)at=ft.charAt(st),at===")"?nt-=1:at==="("&&(nt+=1),st+=1;if(nt!==0)throw new Error("JSXGraph: Missing ')' in expression");ct=ft.substring(0,st),ct=ct.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else ct="[\\w\\.]+";gt=new RegExp("("+ot+")\\^("+ct+")"),it=it.replace(gt,"pow($1,$2)"),pt=it.indexOf("^")}return it},replaceIf:function(it){var nt,st,at,lt,ot,ct,ut,ht,dt,pt="",ft=null,gt=null,mt=null;if((at=it.indexOf("If("))<0)return it;for(it=it.replace(/""/g,"0");at>=0;){for(nt=it.slice(0,at),st=it.slice(at+3),ot=1,lt=0,ct=-1,ut=-1;lt<st.length&&ot>0;)ht=st.charAt(lt),ht===")"?ot-=1:ht==="("?ot+=1:ht===","&&ot===1&&(ct<0?ct=lt:ut=lt),lt+=1;if(dt=st.slice(0,lt-1),st=st.slice(lt),ct<0||ut<0)return"";ft=dt.slice(0,ct),gt=dt.slice(ct+1,ut),mt=dt.slice(ut+1),ft=this.replaceIf(ft),gt=this.replaceIf(gt),mt=this.replaceIf(mt),pt+=nt+"(("+ft+")?("+gt+"):("+mt+"))",it=st,ft=null,gt=null,at=it.indexOf("If(")}return pt+=st},replaceNameById:function(it,nt,st){var at,lt,ot,ct,ut=0,ht=["X","Y","L","V"],dt=function(pt){return st?"$('"+pt+"')":pt};for(ct=0;ct<ht.length;ct++)for(ut=it.indexOf(ht[ct]+"(");ut>=0;)ut>=0&&(at=it.indexOf(")",ut+2))>=0&&(lt=it.slice(ut+2,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+2)+(st?"$('":"")+dt(ot.id)+it.slice(at))),at=it.indexOf(")",ut+2),ut=it.indexOf(ht[ct]+"(",at);for(ut=it.indexOf("Dist(");ut>=0;)ut>=0&&(at=it.indexOf(",",ut+5))>=0&&(lt=it.slice(ut+5,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+5)+dt(ot.id)+it.slice(at))),at=it.indexOf(",",ut+5),ut=it.indexOf(",",at),at=it.indexOf(")",ut+1),at>=0&&(lt=it.slice(ut+1,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+1)+dt(ot.id)+it.slice(at))),at=it.indexOf(")",ut+1),ut=it.indexOf("Dist(",at);for(ht=["Deg","Rad"],ct=0;ct<ht.length;ct++)for(ut=it.indexOf(ht[ct]+"(");ut>=0;)ut>=0&&(at=it.indexOf(",",ut+4))>=0&&(lt=it.slice(ut+4,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+4)+dt(ot.id)+it.slice(at))),at=it.indexOf(",",ut+4),ut=it.indexOf(",",at),at=it.indexOf(",",ut+1),at>=0&&(lt=it.slice(ut+1,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+1)+dt(ot.id)+it.slice(at))),at=it.indexOf(",",ut+1),ut=it.indexOf(",",at),at=it.indexOf(")",ut+1),at>=0&&(lt=it.slice(ut+1,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+1)+dt(ot.id)+it.slice(at))),at=it.indexOf(")",ut+1),ut=it.indexOf(ht[ct]+"(",at);return it},replaceIdByObj:function(it){var nt=/(X|Y|L)\(([\w_]+)\)/g;return it=it.replace(nt,"$('$2').$1()"),nt=/(V)\(([\w_]+)\)/g,it=it.replace(nt,"$('$2').Value()"),nt=/(Dist)\(([\w_]+),([\w_]+)\)/g,it=it.replace(nt,"dist($('$2'), $('$3'))"),nt=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g,it=it.replace(nt,"deg($('$2'),$('$3'),$('$4'))"),nt=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,it=it.replace(nt,"rad($('$1'),$('$2'),$('$3'))"),nt=/N\((.+)\)/g,it=it.replace(nt,"($1)")},geonext2JS:function(it,nt){var st,at,lt,ot=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],ct=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(it=it.replace(/&lt;/g,"<"),it=it.replace(/&gt;/g,">"),it=it.replace(/&amp;/g,"&"),at=it,at=this.replaceNameById(at,nt),at=this.replaceIf(at),at=this.replacePow(at),at=this.replaceIdByObj(at),lt=0;lt<ot.length;lt++)st=new RegExp(["(\\W|^)(",ot[lt],")"].join(""),"ig"),at=at.replace(st,["$1",ct[lt]].join(""));return at=at.replace(/True/g,"true"),at=at.replace(/False/g,"false"),at=at.replace(/fasle/g,"false"),at=at.replace(/Pi/g,"PI"),at=at.replace(/"/g,"'")},findDependencies:function(it,nt,st){var at,lt,ot,ct;rt.exists(st)||(st=it.board),at=st.elementsByName;for(lt in at)at.hasOwnProperty(lt)&&lt!==it.name&&(at[lt].elementClass===_e.OBJECT_CLASS_TEXT?rt.evaluate(at[lt].visProp.islabel)||(ct=lt.replace(/\[/g,"\\["),ct=ct.replace(/\]/g,"\\]"),ot=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+ct+")(,[\\w\\[\\]'_ ]+)*\\)","g"),nt.search(ot)>=0&&at[lt].addChild(it)):(ct=lt.replace(/\[/g,"\\["),ct=ct.replace(/\]/g,"\\]"),ot=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+ct+")(,[\\w\\[\\]'_ ]+)*\\)","g"),nt.search(ot)>=0&&at[lt].addChild(it)))},gxt2jc:function(it,nt){var st;return it=it.replace(/&lt;/g,"<"),it=it.replace(/&gt;/g,">"),it=it.replace(/&amp;/g,"&"),st=it,st=this.replaceNameById(st,nt,!0),st=st.replace(/True/g,"true"),st=st.replace(/False/g,"false"),st=st.replace(/fasle/g,"false")}},tt.GeonextParser}),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","parser/geonext","utils/event","utils/color","utils/type"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){return tt.GeometryElement=function(ut,ht,dt,pt){var ft,gt,mt;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},lt.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){this.board=ut,this.type=dt,this._org_type=dt,this.elementClass=pt||_e.OBJECT_CLASS_OTHER,this.id=ht.id,ft=ht.name,ct.exists(ft)||(ft=this.board.generateName(this)),ft!==""&&(this.board.elementsByName[ft]=this),this.name=ft,this.needsRegularUpdate=ht.needsregularupdate,ct.clearVisPropOld(this),mt=this.resolveShortcuts(ht);for(gt in mt)mt.hasOwnProperty(gt)&&this._set(gt,mt[gt]);this.visProp.draft=mt.draft&&mt.draft.draft,this.visProp.gradientangle="270",this.visProp.gradientsecondopacity=ct.evaluate(this.visProp.fillopacity),this.visProp.gradientpositionx=.5,this.visProp.gradientpositiony=.5}},tt.extend(tt.GeometryElement.prototype,{addChild:function(ut){var ht,dt;this.childElements[ut.id]=ut,this.addDescendants(ut),ut.ancestors[this.id]=this;for(ht in this.descendants)if(this.descendants.hasOwnProperty(ht)){this.descendants[ht].ancestors[this.id]=this;for(dt in this.ancestors)this.ancestors.hasOwnProperty(dt)&&(this.descendants[ht].ancestors[this.ancestors[dt].id]=this.ancestors[dt])}for(ht in this.ancestors)if(this.ancestors.hasOwnProperty(ht))for(dt in this.descendants)this.descendants.hasOwnProperty(dt)&&(this.ancestors[ht].descendants[this.descendants[dt].id]=this.descendants[dt]);return this},addDescendants:function(ut){var ht;this.descendants[ut.id]=ut;for(ht in ut.childElements)ut.childElements.hasOwnProperty(ht)&&this.addDescendants(ut.childElements[ht]);return this},addParents:function(ut){var ht,dt,pt;for(pt=ct.isArray(ut)?ut:arguments,dt=pt.length,ht=0;ht<dt;++ht)ct.exists(pt[ht])&&(ct.isId(this.board,pt[ht])?this.parents.push(pt[ht]):ct.exists(pt[ht].id)&&this.parents.push(pt[ht].id));this.parents=ct.uniqueArray(this.parents)},setParents:function(ut){this.parents=[],this.addParents(ut)},removeChild:function(ut){return delete this.childElements[ut.id],this.removeDescendants(ut),delete ut.ancestors[this.id],this},removeDescendants:function(ut){var ht;delete this.descendants[ut.id];for(ht in ut.childElements)ut.childElements.hasOwnProperty(ht)&&this.removeDescendants(ut.childElements[ht]);return this},countChildren:function(){var ut,ht,dt=0;ht=this.childElements;for(ut in ht)ht.hasOwnProperty(ut)&&ut.indexOf("Label")<0&&dt++;return dt},getName:function(){return this.name},addTransform:function(ut){return this},draggable:function(){return this.isDraggable&&!ct.evaluate(this.visProp.fixed)&&this.type!==_e.OBJECT_TYPE_GLIDER},setPosition:function(ut,ht){var dt,pt,ft,gt,mt=[];if(!ct.exists(this.parents))return this;for(ft=this.parents.length,pt=0;pt<ft;++pt)if(dt=this.board.select(this.parents[pt]),ct.isPoint(dt)){if(!dt.draggable())return this;mt.push(dt)}for(ht.length===3&&(ht=ht.slice(1)),gt=this.board.create("transform",ht,{type:"translate"}),ft=mt.length,ft>0?gt.applyOnce(mt):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(gt):this.addTransform(gt),pt=0;pt<ft;++pt)mt[pt].type===_e.OBJECT_TYPE_GLIDER&&mt[pt].updateGlider();return this},setPositionDirectly:function(ut,ht,dt){var pt=new rt(ut,ht,this.board,!1),ft=new rt(ut,dt,this.board,!1),gt=nt.subtract(pt.usrCoords,ft.usrCoords);return this.setPosition(_e.COORDS_BY_USER,gt),this},generatePolynomial:function(){return[]},animate:function(ut,ht,dt){dt=dt||{};var pt,ft,gt,mt=this.board.attr.animationdelay,At=Math.ceil(ht/mt),yt=this,bt=function(xt,vt,_t,Ct){var St,Et;if(xt=parseFloat(xt),vt=parseFloat(vt),!isNaN(xt)&&!isNaN(vt))for(Et=(vt-xt)/At,yt.animationData[_t]=[],gt=0;gt<At;gt++)St=xt+(gt+1)*Et,yt.animationData[_t][At-gt-1]=Ct?Math.floor(St):St};this.animationData={};for(pt in ut)if(ut.hasOwnProperty(pt))switch(ft=pt.toLowerCase()){case"strokecolor":case"fillcolor":(function(xt,vt,_t){var Ct,St,Et,Tt,Mt;for(Ct=ot.rgb2hsv(xt),St=ot.rgb2hsv(vt),Et=(St[0]-Ct[0])/At,Tt=(St[1]-Ct[1])/At,Mt=(St[2]-Ct[2])/At,yt.animationData[_t]=[],gt=0;gt<At;gt++)yt.animationData[_t][At-gt-1]=ot.hsv2rgb(Ct[0]+(gt+1)*Et,Ct[1]+(gt+1)*Tt,Ct[2]+(gt+1)*Mt)})(this.visProp[ft],ut[pt],ft);break;case"size":if(!ct.isPoint(this))break;bt(this.visProp[ft],ut[pt],ft,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":bt(this.visProp[ft],ut[pt],ft,!1)}return this.animationCallback=dt.callback,this.board.addAnimation(this),this},update:function(){return ct.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(ut){return this.prepareUpdate().update().updateVisibility(ut).updateRenderer()},setDisplayRendNode:function(ut){var ht,dt,pt,ft,gt;if(ut===void 0&&(ut=this.visPropCalc.visible),ut===this.visPropOld.visible)return this;for(this.board.renderer.display(this,ut),dt=this.inherits.length,pt=0;pt<dt;pt++)if(gt=this.inherits[pt],ct.isArray(gt))for(ft=gt.length,ht=0;ht<ft;ht++)ct.exists(gt[ht])&&ct.exists(gt[ht].rendNode)&&ct.evaluate(gt[ht].visProp.visible)==="inherit"&&gt[ht].setDisplayRendNode(ut);else ct.exists(gt)&&ct.exists(gt.rendNode)&&ct.evaluate(gt.visProp.visible)==="inherit"&&gt.setDisplayRendNode(ut);return this.hasLabel&&ct.exists(this.label)&&ct.exists(this.label.rendNode)&&ct.evaluate(this.label.visProp.visible)==="inherit"&&this.label.setDisplayRendNode(ut),this},hideElement:function(){return tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!1,this.board.renderer.display(this,!1),ct.exists(this.label)&&this.hasLabel&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement()),this},showElement:function(){return tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!0,this.board.renderer.display(this,!0),ct.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},updateVisibility:function(ut){var ht,dt,pt,ft,gt,mt;if(this.needsUpdate){for(ut!==void 0?this.visPropCalc.visible=ut:(mt=ct.evaluate(this.visProp.visible),ct.exists(this.hiddenByParent)&&this.hiddenByParent&&(mt=!1),mt!=="inherit"&&(this.visPropCalc.visible=mt)),dt=this.inherits.length,pt=0;pt<dt;pt++)if(gt=this.inherits[pt],ct.isArray(gt))for(ft=gt.length,ht=0;ht<ft;ht++)ct.exists(gt[ht])&&ct.evaluate(gt[ht].visProp.visible)==="inherit"&&gt[ht].prepareUpdate().updateVisibility(this.visPropCalc.visible);else ct.exists(gt)&&ct.evaluate(gt.visProp.visible)==="inherit"&&gt.prepareUpdate().updateVisibility(this.visPropCalc.visible);ct.exists(this.label)&&ct.exists(this.label.visProp)&&ct.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(ut,ht){ut=ut.toLocaleLowerCase(),this.visProp.hasOwnProperty(ut)&&ut.indexOf("color")>=0&&ct.isString(ht)&&ht.length===9&&ht.charAt(0)==="#"?(ht=ot.rgba2rgbo(ht),this.visProp[ut]=ht[0],this.visProp[ut.replace("color","opacity")]=ht[1]):this.visProp[ut]=ht},resolveShortcuts:function(ut){var ht,dt;for(ht in st.shortcuts)if(st.shortcuts.hasOwnProperty(ht)&&ct.exists(ut[ht]))for(dt=0;dt<st.shortcuts[ht].length;dt++)ct.exists(ut[st.shortcuts[ht][dt]])||(ut[st.shortcuts[ht][dt]]=ut[ht]);return ut},setLabel:function(ut){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(ut)},setLabelText:function(ut){return ct.exists(this.label)&&(ut=ut.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(ut)),this},setName:function(ut){ut=ut.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.elType!=="slider"&&this.setLabelText(ut),this.setAttribute({name:ut})},setProperty:function(){tt.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt={};for(ht=0;ht<arguments.length;ht++)mt=arguments[ht],ct.isString(mt)?(yt=mt.split(":"),xt[ct.trim(yt[0])]=ct.trim(yt[1])):ct.isArray(mt)?xt[mt[0]]=mt[1]:tt.extend(xt,mt);xt=this.resolveShortcuts(xt);for(ht in xt)if(xt.hasOwnProperty(ht)){if(ft=ht.replace(/\s+/g,"").toLowerCase(),gt=xt[ht],bt=this.visProp[ft],ct.isObject(gt)&&ct.exists(this.visProp[ft])){if(this.visProp[ft]=ct.merge(this.visProp[ft],gt),this.type===_e.OBJECT_TYPE_TICKS&&ct.exists(this.labels))for(pt=this.labels.length,dt=0;dt<pt;dt++)this.labels[dt].setAttribute(gt);continue}switch(ft){case"name":bt=this.name,delete this.board.elementsByName[this.name],this.name=gt,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!(gt==="false"||gt===!1),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":gt=ot.rgba2rgbo(gt),At=gt[1],gt=gt[0],At===0&&ct.exists(this.label)&&this.hasLabel&&this.label.hideElement(),ct.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=gt,this.board.renderer.setObjectStrokeColor(this.label,gt,At)),this.elementClass===_e.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=gt,this.visProp.strokeopacity=At,this.board.renderer.setObjectStrokeColor(this,gt,At));break;case"infoboxtext":ct.isString(gt)?this.infoboxText=gt:this.infoboxText=!1;break;case"visible":this.visProp.visible=gt!=="false"&&(gt==="true"||gt),this.setDisplayRendNode(ct.evaluate(this.visProp.visible));break;case"face":ct.isPoint(this)&&(this.visProp.face=gt,this.board.renderer.changePointStyle(this));break;case"trace":gt==="false"||gt===!1?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=!0;break;case"gradient":this.visProp.gradient=gt,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":gt=ot.rgba2rgbo(gt),this.visProp.gradientsecondcolor=gt[0],this.visProp.gradientsecondopacity=gt[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=gt,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=gt,ct.evaluate(gt)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=gt;break;case"radius":this.type!==_e.OBJECT_TYPE_ANGLE&&this.type!==_e.OBJECT_TYPE_SECTOR||this.setRadius(gt);break;case"rotate":(this.elementClass===_e.OBJECT_CLASS_TEXT&&ct.evaluate(this.visProp.display)==="internal"||this.type===_e.OBJECT_TYPE_IMAGE)&&this.addRotation(gt);break;case"ticksdistance":this.type===_e.OBJECT_TYPE_TICKS&&ct.isNumber(gt)&&(this.ticksFunction=this.makeTicksFunction(gt));break;case"generatelabelvalue":this.type===_e.OBJECT_TYPE_TICKS&&ct.isFunction(gt)&&(this.generateLabelValue=gt);break;case"onpolygon":this.type===_e.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!gt);break;case"disabled":ct.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!gt);break;case"checked":ct.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!gt);break;case"maxlength":ct.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!gt);break;default:ct.exists(this.visProp[ft])&&(!tt.Validator[ft]||tt.Validator[ft]&&tt.Validator[ft](gt)||tt.Validator[ft]&&ct.isFunction(gt)&&tt.Validator[ft](gt()))&&(gt=(!gt.toLowerCase||gt.toLowerCase()!=="false")&&gt,this._set(ft,gt))}this.triggerEventHandlers(["attribute:"+ft],[bt,gt,this])}return this.triggerEventHandlers(["attribute"],[xt,this]),ct.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){tt.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(ut){var ht;switch(ut=ut.toLowerCase()){case"needsregularupdate":ht=this.needsRegularUpdate;break;case"labelcolor":ht=this.label.visProp.strokecolor;break;case"infoboxtext":ht=this.infoboxText;break;case"withlabel":ht=this.hasLabel;break;default:ht=this.visProp[ut]}return ht},setDash:function(ut){return this.setAttribute({dash:ut}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new rt(_e.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new rt(_e.COORDS_BY_USER,[0,0],this.board)},setArrow:function(ut,ht){return this.visProp.firstarrow=ut,this.visProp.lastarrow=ht,ht&&(this.type=_e.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var ut=ct.evaluate(this.visProp.gradient);ut!=="linear"&&ut!=="radial"||this.board.renderer.setGradient(this)},createLabel:function(){var ut,ht=this;return tt.elements.text?(ut=ct.deepCopy(this.visProp.label,null),ut.id=this.id+"Label",ut.isLabel=!0,ut.anchor=this,ut.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=tt.elements.text(this.board,[0,0,function(){return ct.isFunction(ht.name)?ht.name():ht.name}],ut),this.label.needsUpdate=!0,this.label.dump=!1,this.label.update(),this.hasLabel=!0)):tt.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(ut){return ut=ct.def(ut,!1),!ct.evaluate(this.visProp.highlight)||this.highlighted&&!ut||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var ut;for(ut in this.traces)this.traces.hasOwnProperty(ut)&&this.board.renderer.remove(this.traces[ut]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=it.normalize(this.stdform),this},toJSON:function(){var ut,ht,dt=['{"name":',this.name];dt.push(', "id":'+this.id),ut=[];for(ht in this.visProp)this.visProp.hasOwnProperty(ht)&&ct.exists(this.visProp[ht])&&ut.push('"'+ht+'":'+this.visProp[ht]);return dt.push(', "visProp":{'+ut.toString()+"}"),dt.push("}"),dt.join("")},addRotation:function(ut){var ht,dt,pt,ft,gt,mt=this;return(this.elementClass===_e.OBJECT_CLASS_TEXT&&ct.evaluate(this.visProp.display)==="internal"||this.type===_e.OBJECT_TYPE_IMAGE)&&ut!==0&&(ht=this.board.create("transform",[function(){return-mt.X()},function(){return-mt.Y()}],{type:"translate"}),dt=this.board.create("transform",[function(){return mt.X()},function(){return mt.Y()}],{type:"translate"}),pt=this.board.create("transform",[function(){return mt.board.unitX/mt.board.unitY},function(){return 1}],{type:"scale"}),ft=this.board.create("transform",[function(){return mt.board.unitY/mt.board.unitX},function(){return 1}],{type:"scale"}),gt=this.board.create("transform",[ut*Math.PI/180],{type:"rotate"}),ht.bindTo(this),pt.bindTo(this),gt.bindTo(this),ft.bindTo(this),dt.bindTo(this)),this},highlightStrokeColor:function(ut){return tt.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:ut}),this},strokeColor:function(ut){return tt.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:ut}),this},strokeWidth:function(ut){return tt.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:ut}),this},fillColor:function(ut){return tt.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:ut}),this},highlightFillColor:function(ut){return tt.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:ut}),this},labelColor:function(ut){return tt.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:ut}),this},dash:function(ut){return tt.deprecated("dash()","setAttribute()"),this.setAttribute({dash:ut}),this},visible:function(ut){return tt.deprecated("visible()","setAttribute()"),this.setAttribute({visible:ut}),this},shadow:function(ut){return tt.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:ut}),this},getType:function(){return this.elType},getParents:function(){return ct.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var ut,ht=ct.deepCopy(this.visProp),dt=[],pt=dt.length;for(ht.id=this.id,ht.name=this.name,ut=0;ut<pt;ut++)delete ht[dt[ut]];return ht},hasPoint:function(ut,ht){return!1},handleSnapToGrid:function(ut,ht){var dt,pt,ft,gt,mt=!1,At=ct.evaluate(this.visProp.snapsizex),yt=ct.evaluate(this.visProp.snapsizey);return ct.exists(this.coords)?(mt=ct.evaluate(this.visProp.snaptogrid)||ut===!0,mt&&(dt=this.coords.usrCoords[1],pt=this.coords.usrCoords[2],At<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(ft=this.board.defaultAxes.x.defaultTicks,At=ft.ticksDelta*(ct.evaluate(ft.visProp.minorticks)+1)),yt<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(ft=this.board.defaultAxes.y.defaultTicks,yt=ft.ticksDelta*(ct.evaluate(ft.visProp.minorticks)+1)),At>0&&yt>0&&(gt=this.board.getBoundingBox(),dt=Math.round(dt/At)*At,pt=Math.round(pt/yt)*yt,ht||(dt<gt[0]?dt+=At:dt>gt[2]&&(dt-=At),pt<gt[3]?pt+=yt:pt>gt[1]&&(pt-=yt)),this.coords.setCoordinates(_e.COORDS_BY_USER,[dt,pt]))),this):this},addEvent:tt.shortcut(tt.GeometryElement.prototype,"on"),removeEvent:tt.shortcut(tt.GeometryElement.prototype,"off"),__evt__over:function(ut){},__evt__mouseover:function(ut){},__evt__out:function(ut){},__evt__mouseout:function(ut){},__evt__move:function(ut){},__evt__mousemove:function(ut){},__evt__drag:function(ut){},__evt__mousedrag:function(ut){},__evt__touchdrag:function(ut){},__evt__down:function(ut){},__evt__mousedown:function(ut){},__evt__touchdown:function(ut){},__evt__up:function(ut){},__evt__mouseup:function(ut){},__evt__touchup:function(ut){},__evt__attribute:function(ut,ht){},__evt__attribute_:function(ut,ht,dt){},__evt:function(){}}),tt.GeometryElement}),define("base/transformation",["jxg","base/constants","math/math","utils/type"],function(tt,_e,rt,it){return tt.Transformation=function(nt,st,at){this.elementClass=_e.OBJECT_CLASS_OTHER,this.type=_e.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=nt,this.isNumericMatrix=!1,this.setMatrix(nt,st,at),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bind",melt:"melt"}},tt.Transformation.prototype={},tt.extend(tt.Transformation.prototype,{update:function(){return this},setMatrix:function(nt,st,at){var lt;for(this.isNumericMatrix=!0,lt=0;lt<at.length;lt++)if(typeof at[lt]!="number"){this.isNumericMatrix=!1;break}if(st==="translate"){if(at.length!==2)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=it.createEvalFunction(nt,at,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if(st==="scale"){if(at.length!==2)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=it.createEvalFunction(nt,at,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if(st==="reflect")at.length<4&&(at[0]=nt.select(at[0])),at.length===2&&(at[1]=nt.select(at[1])),at.length===4&&(this.evalParam=it.createEvalFunction(nt,at,4)),this.update=function(){var ot,ct,ut,ht,dt,pt,ft,gt;at.length===1?ft=at[0].stdform:at.length===2?ft=rt.crossProduct(at[1].coords.usrCoords,at[0].coords.usrCoords):at.length===4&&(ft=rt.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),ot=ft[1],ct=ft[2],ut=ft[0],gt=[-ut*ot,-ut*ct,ot*ot+ct*ct],pt=gt[2],ht=gt[0]/gt[2],dt=gt[1]/gt[2],ot=-ft[2],ct=ft[1],this.matrix[1][1]=(ot*ot-ct*ct)/pt,this.matrix[1][2]=2*ot*ct/pt,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=ht*(1-this.matrix[1][1])-dt*this.matrix[1][2],this.matrix[2][0]=dt*(1-this.matrix[2][2])-ht*this.matrix[2][1]};else if(st==="rotate")at.length===3?this.evalParam=it.createEvalFunction(nt,at,3):at.length>0&&at.length<=2&&(this.evalParam=it.createEvalFunction(nt,at,1),at.length!==2||it.isArray(at[1])||(at[1]=nt.select(at[1]))),this.update=function(){var ot,ct,ut=this.evalParam(0),ht=Math.cos(ut),dt=Math.sin(ut);this.matrix[1][1]=ht,this.matrix[1][2]=-dt,this.matrix[2][1]=dt,this.matrix[2][2]=ht,at.length>1&&(at.length===3?(ot=this.evalParam(1),ct=this.evalParam(2)):it.isArray(at[1])?(ot=at[1][0],ct=at[1][1]):(ot=at[1].X(),ct=at[1].Y()),this.matrix[1][0]=ot*(1-ht)+ct*dt,this.matrix[2][0]=ct*(1-ht)-ot*dt)};else if(st==="shear"){if(at.length!==2)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=it.createEvalFunction(nt,at,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if(st==="generic"){if(at.length!==9)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=it.createEvalFunction(nt,at,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(nt,st){return this.update(),it.exists(st)?rt.matVecMult(this.matrix,nt.initialCoords.usrCoords):rt.matVecMult(this.matrix,nt.coords.usrCoords)},applyOnce:function(nt){var st,at,lt;for(it.isArray(nt)||(nt=[nt]),at=nt.length,lt=0;lt<at;lt++)this.update(),st=rt.matVecMult(this.matrix,nt[lt].coords.usrCoords),nt[lt].coords.setCoordinates(_e.COORDS_BY_USER,st)},bindTo:function(nt){var st,at;if(it.isArray(nt))for(at=nt.length,st=0;st<at;st++)nt[st].transformations.push(this);else nt.transformations.push(this)},setProperty:function(nt){tt.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(nt){},melt:function(nt){var st,at,lt,ot,ct,ut,ht=[];for(at=nt.matrix.length,lt=this.matrix[0].length,st=0;st<at;st++)ht[st]=[];for(this.update(),nt.update(),st=0;st<at;st++)for(ut=0;ut<lt;ut++){for(ct=0,ot=0;ot<at;ot++)ct+=nt.matrix[st][ot]*this.matrix[ot][ut];ht[st][ut]=ct}return this.update=function(){var dt=this.matrix.length,pt=this.matrix[0].length;for(st=0;st<dt;st++)for(ut=0;ut<pt;ut++)this.matrix[st][ut]=ht[st][ut]},this},getParents:function(){var nt=[[].concat.apply([],this.matrix)];return this.parents.length!==0&&(nt=this.parents),nt}}),tt.createTransform=function(nt,st,at){return new tt.Transformation(nt,at.type,st)},tt.registerElement("transform",tt.createTransform),{Transformation:tt.Transformation,createTransform:tt.createTransform}}),define("base/coordselement",["jxg","options","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht){return tt.CoordsElement=function(dt,pt){var ft;for(ut.exists(dt)||(dt=[1,0,0]),ft=0;ft<dt.length;++ft)dt[ft]=parseFloat(dt[ft]);this.coords=new at(lt.COORDS_BY_USER,dt,this.board),this.initialCoords=new at(lt.COORDS_BY_USER,dt,this.board),this.position=null,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.updateConstraint=function(){return this},this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=ut.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),ut.exists(this.element)&&this.addAnchor(dt,pt),this.isDraggable=!0},tt.extend(tt.CoordsElement.prototype,{updateCoords:function(dt){return this.needsUpdate?(ut.exists(dt)||(dt=!1),this.type===lt.OBJECT_TYPE_GLIDER&&(dt?this.updateGliderFromParent():this.updateGlider()),ut.evaluate(this.visProp.frozen)||this.updateConstraint(),this.updateTransform(),this):this},updateGlider:function(){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot=2*Math.PI,Bt=!1,Nt=this.slideObject;if(this.needsUpdateFromParent=!1,Nt.elementClass===lt.OBJECT_CLASS_CIRCLE)ut.evaluate(this.visProp.isgeonext)&&(Ot=1),Mt=it.projectPointToCircle(this,Nt,this.board),Rt=it.rad([Nt.center.X()+1,Nt.center.Y()],Nt.center,this)/Ot;else if(Nt.elementClass===lt.OBJECT_CLASS_LINE){if(this.onPolygon){if(pt=Nt.point1.coords.usrCoords,ft=Nt.point2.coords.usrCoords,dt=1,gt=ft[dt]-pt[dt],Math.abs(gt)<rt.eps&&(dt=2,gt=ft[dt]-pt[dt]),yt=it.projectPointToLine(this,Nt,this.board),bt=(yt.usrCoords[dt]-pt[dt])/gt,At=Nt.parentPolygon,bt<0){for(dt=0;dt<At.borders.length;dt++)if(Nt===At.borders[dt]){Nt=At.borders[(dt-1+At.borders.length)%At.borders.length];break}}else if(bt>1){for(dt=0;dt<At.borders.length;dt++)if(Nt===At.borders[dt]){Nt=At.borders[(dt+1+At.borders.length)%At.borders.length];break}}Nt.id!==this.slideObject.id&&(this.slideObject=Nt)}pt=Nt.point1.coords,ft=Nt.point2.coords,gt=pt.distance(lt.COORDS_BY_USER,ft),gt<rt.eps?(Mt=pt,Bt=!0,Rt=0):(Mt=it.projectPointToLine(this,Nt,this.board),pt=pt.usrCoords.slice(0),ft=ft.usrCoords.slice(0),Math.abs(ft[0])<rt.eps?(dt=1,gt=ft[dt],Math.abs(gt)<rt.eps&&(dt=2,gt=ft[dt]),gt=(Mt.usrCoords[dt]-pt[dt])/gt,xt=gt>=0?1:-1,gt=Math.abs(gt),Rt=xt*gt/(gt+1)):Math.abs(pt[0])<rt.eps?(dt=1,gt=pt[dt],Math.abs(gt)<rt.eps&&(dt=2,gt=pt[dt]),gt=(Mt.usrCoords[dt]-ft[dt])/gt,Rt=gt<0?(1-2*gt)/(1-gt):1/(gt+1)):(dt=1,gt=ft[dt]-pt[dt],Math.abs(gt)<rt.eps&&(dt=2,gt=ft[dt]-pt[dt]),Rt=(Mt.usrCoords[dt]-pt[dt])/gt)),It=ut.evaluate(this.visProp.snapwidth),ut.evaluate(It)>0&&Math.abs(this._smax-this._smin)>=rt.eps&&(Rt=Math.max(Math.min(Rt,1),0),mt=Rt*(this._smax-this._smin)+this._smin,mt=Math.round(mt/It)*It,Rt=(mt-this._smin)/(this._smax-this._smin),this.update(!0)),pt=Nt.point1.coords,!ut.evaluate(Nt.visProp.straightfirst)&&Math.abs(pt.usrCoords[0])>rt.eps&&Rt<0&&(Mt=pt,Bt=!0,Rt=0),ft=Nt.point2.coords,!ut.evaluate(Nt.visProp.straightlast)&&Math.abs(ft.usrCoords[0])>rt.eps&&Rt>1&&(Mt=ft,Bt=!0,Rt=1)}else Nt.type===lt.OBJECT_TYPE_TURTLE?(this.updateConstraint(),Mt=it.projectPointToTurtle(this,Nt,this.board),Rt=this.position):Nt.elementClass===lt.OBJECT_CLASS_CURVE?Nt.type===lt.OBJECT_TYPE_ARC||Nt.type===lt.OBJECT_TYPE_SECTOR?(Mt=it.projectPointToCircle(this,Nt,this.board),Ct=it.rad(Nt.radiuspoint,Nt.center,this),vt=0,_t=it.rad(Nt.radiuspoint,Nt.center,Nt.anglepoint),Rt=Ct,It=ut.evaluate(Nt.visProp.selection),(It==="minor"&&_t>Math.PI||It==="major"&&_t<Math.PI)&&(vt=_t,_t=2*Math.PI),(Ct<vt||Ct>_t)&&(Rt=_t,(Ct<vt&&Ct>.5*vt||Ct>_t&&Ct>.5*_t+Math.PI)&&(Rt=vt),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),Ot=_t-vt,this.visProp.isgeonext&&(Ot=1),Math.abs(Ot)>rt.eps&&(Rt/=Ot)):(this.updateConstraint(),Nt.transformations.length>0?(Nt.updateTransformMatrix(),Tt=rt.inverse(Nt.transformMat),Et=rt.matVecMult(Tt,this.coords.usrCoords),St=new at(lt.COORDS_BY_USER,Et,this.board).usrCoords,Et=it.projectCoordsToCurve(St[1],St[2],this.position||0,Nt,this.board),Mt=Et[0],Rt=Et[1]):(Mt=it.projectPointToCurve(this,Nt,this.board),Rt=this.position)):ut.isPoint(Nt)&&(Mt=it.projectPointToPoint(this,Nt,this.board),Rt=this.position);this.coords.setCoordinates(lt.COORDS_BY_USER,Mt.usrCoords,Bt),this.position=Rt},updateGliderFromParent:function(){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt=this.slideObject,_t=2*Math.PI;if(!this.needsUpdateFromParent)return void(this.needsUpdateFromParent=!0);vt.elementClass===lt.OBJECT_CLASS_CIRCLE?(ft=vt.Radius(),ut.evaluate(this.visProp.isgeonext)&&(_t=1),mt=[vt.center.X()+ft*Math.cos(this.position*_t),vt.center.Y()+ft*Math.sin(this.position*_t)]):vt.elementClass===lt.OBJECT_CLASS_LINE?(dt=vt.point1.coords.usrCoords,pt=vt.point2.coords.usrCoords,dt[0]===0&&dt[1]===0&&dt[2]===0||pt[0]===0&&pt[1]===0&&pt[2]===0?mt=[0,0,0]:Math.abs(pt[0])<rt.eps?(gt=Math.min(Math.abs(this.position),1-rt.eps),gt/=1-gt,this.position<0&&(gt=-gt),mt=[dt[0]+gt*pt[0],dt[1]+gt*pt[1],dt[2]+gt*pt[2]]):Math.abs(dt[0])<rt.eps?(gt=Math.max(this.position,rt.eps),gt=Math.min(gt,2-rt.eps),gt=gt>1?(gt-1)/(gt-2):(1-gt)/gt,mt=[pt[0]+gt*dt[0],pt[1]+gt*dt[1],pt[2]+gt*dt[2]]):(gt=this.position,mt=[dt[0]+gt*(pt[0]-dt[0]),dt[1]+gt*(pt[1]-dt[1]),dt[2]+gt*(pt[2]-dt[2])])):vt.type===lt.OBJECT_TYPE_TURTLE?(this.coords.setCoordinates(lt.COORDS_BY_USER,[vt.Z(this.position),vt.X(this.position),vt.Y(this.position)]),this.updateConstraint(),mt=it.projectPointToTurtle(this,vt,this.board).usrCoords):vt.elementClass===lt.OBJECT_CLASS_CURVE?(this.coords.setCoordinates(lt.COORDS_BY_USER,[vt.Z(this.position),vt.X(this.position),vt.Y(this.position)]),vt.type===lt.OBJECT_TYPE_ARC||vt.type===lt.OBJECT_TYPE_SECTOR?(At=it.rad([vt.center.X()+1,vt.center.Y()],vt.center,vt.radiuspoint),yt=0,xt=it.rad(vt.radiuspoint,vt.center,vt.anglepoint),(vt.visProp.selection==="minor"&&xt>Math.PI||vt.visProp.selection==="major"&&xt<Math.PI)&&(yt=xt,xt=2*Math.PI),_t=xt-yt,ut.evaluate(this.visProp.isgeonext)&&(_t=1),bt=this.position*_t,(bt<yt||bt>xt)&&(bt=xt,(bt<yt&&bt>.5*yt||bt>xt&&bt>.5*xt+Math.PI)&&(bt=yt),this.position=bt,Math.abs(_t)>rt.eps&&(this.position/=_t)),ft=vt.Radius(),mt=[vt.center.X()+ft*Math.cos(this.position*_t+At),vt.center.Y()+ft*Math.sin(this.position*_t+At)]):(this.updateConstraint(),mt=it.projectPointToCurve(this,vt,this.board).usrCoords)):ut.isPoint(vt)&&(mt=it.projectPointToPoint(this,vt,this.board).usrCoords),this.coords.setCoordinates(lt.COORDS_BY_USER,mt,!1)},updateRendererGeneric:function(dt){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>rt.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[dt](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(dt){return this.isReal&&dt.isReal?this.coords.distance(lt.COORDS_BY_USER,dt.coords):NaN},snapToGrid:function(dt){return this.handleSnapToGrid(dt)},handleSnapToPoints:function(dt){var pt,ft,gt,mt,At,yt,bt,xt,vt=0,_t=1/0,Ct=null,St=ut.evaluate(this.visProp.ignoredsnaptopoints),Et=!1;if(mt=this.board.objectsList.length,St&&(bt=St.length),ut.evaluate(this.visProp.snaptopoints)||dt){for(At=ut.evaluate(this.visProp.attractorunit),yt=ut.evaluate(this.visProp.attractordistance),pt=0;pt<mt;pt++){if(ft=this.board.objectsList[pt],St){for(Et=!1,xt=0;xt<bt;xt++)if(ft==this.board.select(St[xt])){Et=!0;break}if(Et)continue}ut.isPoint(ft)&&ft!==this&&ft.visPropCalc.visible&&(gt=it.projectPointToPoint(this,ft,this.board),(vt=At==="screen"?gt.distance(lt.COORDS_BY_SCREEN,this.coords):gt.distance(lt.COORDS_BY_USER,this.coords))<yt&&vt<_t&&(_t=vt,Ct=gt))}Ct!==null&&this.coords.setCoordinates(lt.COORDS_BY_USER,Ct.usrCoords)}return this},snapToPoints:function(dt){return this.handleSnapToPoints(dt)},handleAttractors:function(){var dt,pt,ft,gt,mt=0,At=ut.evaluate(this.visProp.attractorunit),yt=ut.evaluate(this.visProp.attractordistance),bt=ut.evaluate(this.visProp.snatchdistance),xt=ut.evaluate(this.visProp.attractors),vt=xt.length;if(yt!==0){for(dt=0;dt<vt;dt++)if(pt=this.board.select(xt[dt]),ut.exists(pt)&&pt!==this){if(ut.isPoint(pt)?ft=it.projectPointToPoint(this,pt,this.board):pt.elementClass===lt.OBJECT_CLASS_LINE?(gt=it.projectCoordsToSegment(this.coords.usrCoords,pt.point1.coords.usrCoords,pt.point2.coords.usrCoords),ft=!ut.evaluate(pt.visProp.straightfirst)&&gt[1]<0?pt.point1.coords:!ut.evaluate(pt.visProp.straightlast)&&gt[1]>1?pt.point2.coords:new at(lt.COORDS_BY_USER,gt[0],this.board)):pt.elementClass===lt.OBJECT_CLASS_CIRCLE?ft=it.projectPointToCircle(this,pt,this.board):pt.elementClass===lt.OBJECT_CLASS_CURVE?ft=it.projectPointToCurve(this,pt,this.board):pt.type===lt.OBJECT_TYPE_TURTLE&&(ft=it.projectPointToTurtle(this,pt,this.board)),(mt=At==="screen"?ft.distance(lt.COORDS_BY_SCREEN,this.coords):ft.distance(lt.COORDS_BY_USER,this.coords))<yt){this.type===lt.OBJECT_TYPE_GLIDER&&this.slideObject===pt||this.makeGlider(pt);break}pt===this.slideObject&&mt>=bt&&this.popSlideObject()}return this}},setPositionDirectly:function(dt,pt){var ft,gt,mt,At,yt=this.coords;if(this.relativeCoords)return gt=new at(dt,pt,this.board),ut.evaluate(this.visProp.islabel)?(mt=st.subtract(gt.scrCoords,yt.scrCoords),this.relativeCoords.scrCoords[1]+=mt[1],this.relativeCoords.scrCoords[2]+=mt[2]):(mt=st.subtract(gt.usrCoords,yt.usrCoords),this.relativeCoords.usrCoords[1]+=mt[1],this.relativeCoords.usrCoords[2]+=mt[2]),this;for(this.coords.setCoordinates(dt,pt),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),ft=this.transformations.length-1;ft>=0;ft--)dt===lt.COORDS_BY_SCREEN?At=new at(dt,pt,this.board).usrCoords:(pt.length===2&&(pt=[1].concat(pt)),At=pt),this.initialCoords.setCoordinates(lt.COORDS_BY_USER,rt.matVecMult(rt.inverse(this.transformations[ft].matrix),At));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===lt.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(dt,pt){var ft;return pt=new at(dt,pt,this.board),ft=this.board.create("transform",pt.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(ft):this.addTransform(this,ft),this.prepareUpdate().update(),this},setPosition:function(dt,pt){return this.setPositionDirectly(dt,pt)},setGliderPosition:function(dt){return this.type===lt.OBJECT_TYPE_GLIDER&&(this.position=dt,this.board.update()),this},makeGlider:function(dt){var pt,ft,gt,mt=this.board.select(dt),At=!1;if(mt.type===lt.OBJECT_TYPE_POLYGON){for(pt=Number.MAX_VALUE,ft=0;ft<mt.borders.length;ft++)(gt=tt.Math.Geometry.distPointLine(this.coords.usrCoords,mt.borders[ft].stdform))<pt&&(pt=gt,dt=mt.borders[ft]);mt=this.board.select(dt),At=!0}if(!ut.exists(mt))throw new Error("JSXGraph: slide object undefined.");if(mt.type===lt.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(dt),this.slideObjects.push(this.slideObject),this.addParents(dt),this.type=lt.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=At,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),this.slideObjects.length===0?(this.type=this._org_type,this.type===lt.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===lt.OBJECT_CLASS_TEXT?this.elType="text":this.type===lt.OBJECT_TYPE_IMAGE&&(this.elType="image"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var dt,pt;if(this.type!==lt.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,this.isDraggable)return;this.isDraggable=!0,this.elementClass===lt.OBJECT_CLASS_POINT&&(this.type=lt.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(dt in this.board.objects)this.board.objects.hasOwnProperty(dt)&&(pt=this.board.objects[dt],pt.descendants&&(delete pt.descendants[this.id],delete pt.childElements[this.id],this.hasLabel&&(delete pt.descendants[this.label.id],delete pt.childElements[this.label.id])));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===lt.OBJECT_CLASS_POINT?(this.type=lt.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===lt.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===lt.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(dt){var pt,ft,gt=[],mt=["X","Y"];for(this.elementClass===lt.OBJECT_CLASS_POINT&&(this.type=lt.OBJECT_TYPE_CAS),this.isDraggable=!1,pt=0;pt<dt.length;pt++)ft=dt[pt],ut.isString(ft)?(gt[pt]=this.board.jc.snippet(ft,!0,null,!0),dt.length===2&&(this[mt[pt]+"jc"]=dt[pt])):ut.isFunction(ft)?gt[pt]=ft:ut.isNumber(ft)?gt[pt]=function(At){return function(){return At}}(ft):ut.isObject(ft)&&ut.isFunction(ft.Value)&&(gt[pt]=function(At){return function(){return At.Value()}}(ft)),gt[pt].origin=ft;return dt.length===1?this.updateConstraint=function(){var At=gt[0]();ut.isArray(At)?this.coords.setCoordinates(lt.COORDS_BY_USER,At):this.coords=At}:dt.length===2?(this.XEval=gt[0],this.YEval=gt[1],this.setParents([gt[0].origin,gt[1].origin]),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.XEval(),this.YEval()])}):(this.ZEval=gt[0],this.XEval=gt[1],this.YEval=gt[2],this.setParents([gt[0].origin,gt[1].origin,gt[2].origin]),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])}),this.prepareUpdate().update(),this.board.isSuspendedUpdate||this.updateVisibility().updateRenderer(),this},addAnchor:function(dt,pt){this.relativeCoords=pt?new at(lt.COORDS_BY_SCREEN,dt.slice(0,2),this.board):new at(lt.COORDS_BY_USER,dt,this.board),this.element.addChild(this),pt&&this.addParents(this.element),this.XEval=function(){var ft,gt,mt,At=ut.evaluate(this.visProp.offset);return ut.evaluate(this.visProp.islabel)?(ft=parseFloat(At[0]),mt=this.element.getLabelAnchor(),gt=new at(lt.COORDS_BY_SCREEN,[ft+this.relativeCoords.scrCoords[1]+mt.scrCoords[1],0],this.board),gt.usrCoords[1]):(mt=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+mt.usrCoords[1])},this.YEval=function(){var ft,gt,mt,At=ut.evaluate(this.visProp.offset);return ut.evaluate(this.visProp.islabel)?(ft=-parseFloat(At[1]),mt=this.element.getLabelAnchor(),gt=new at(lt.COORDS_BY_SCREEN,[0,ft+this.relativeCoords.scrCoords[2]+mt.scrCoords[2]],this.board),gt.usrCoords[2]):(mt=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+mt.usrCoords[2])},this.ZEval=ut.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.coords=new at(lt.COORDS_BY_SCREEN,[0,0],this.board)},updateTransform:function(){var dt;if(this.transformations.length===0)return this;for(dt=0;dt<this.transformations.length;dt++)this.transformations[dt].update();return this},addTransform:function(dt,pt){var ft,gt=ut.isArray(pt)?pt:[pt],mt=gt.length;for(this.transformations.length===0&&(this.baseElement=dt),ft=0;ft<mt;ft++)this.transformations.push(gt[ft]);return this},startAnimation:function(dt,pt){var ft=this;return this.type!==lt.OBJECT_TYPE_GLIDER||ut.exists(this.intervalCode)||(this.intervalCode=window.setInterval(function(){ft._anim(dt,pt)},250),ut.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return ut.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(dt,pt,ft){ft=ft||{};var gt,mt,At,yt,bt,xt=[],vt=[],_t=this.board.attr.animationdelay,Ct=pt/_t,St=function(Et,Tt){return function(){return dt[Et][Tt]}};if(ut.isArray(dt)){for(At=dt.length,gt=0;gt<At;gt++)ut.isPoint(dt[gt])?vt[gt]=dt[gt]:vt[gt]={elementClass:lt.OBJECT_CLASS_POINT,X:St(gt,0),Y:St(gt,1)};if((pt=pt||0)===0)return this.setPosition(lt.COORDS_BY_USER,[vt[vt.length-1].X(),vt[vt.length-1].Y()]),this.board.update(this);if(!ut.exists(ft.interpolate)||ft.interpolate)for(mt=nt.Neville(vt),gt=0;gt<Ct;gt++)xt[gt]=[],xt[gt][0]=mt[0]((Ct-gt)/Ct*mt[3]()),xt[gt][1]=mt[1]((Ct-gt)/Ct*mt[3]());else{for(At=dt.length-1,gt=0;gt<Ct;++gt)yt=Math.floor(gt/Ct*At),bt=gt/Ct*At-yt,xt[gt]=[],xt[gt][0]=(1-bt)*vt[yt].X()+bt*vt[yt+1].X(),xt[gt][1]=(1-bt)*vt[yt].Y()+bt*vt[yt+1].Y();xt.push([vt[At].X(),vt[At].Y()]),xt.reverse()}this.animationPath=xt}else ut.isFunction(dt)&&(this.animationPath=dt,this.animationStart=new Date().getTime());return this.animationCallback=ft.callback,this.board.addAnimation(this),this},moveTo:function(dt,pt,ft){ft=ft||{},dt=new at(lt.COORDS_BY_USER,dt,this.board);var gt,mt=this.board.attr.animationdelay,At=Math.ceil(pt/mt),yt=[],bt=this.coords.usrCoords[1],xt=this.coords.usrCoords[2],vt=dt.usrCoords[1]-bt,_t=dt.usrCoords[2]-xt,Ct=function(St){return ft.effect&&ft.effect==="<>"?Math.pow(Math.sin(St/At*Math.PI/2),2):St/At};if(!ut.exists(pt)||pt===0||Math.abs(dt.usrCoords[0]-this.coords.usrCoords[0])>rt.eps)return this.setPosition(lt.COORDS_BY_USER,dt.usrCoords),this.board.update(this);if(!ut.exists(ft.callback)&&Math.abs(vt)<rt.eps&&Math.abs(_t)<rt.eps)return this;for(gt=At;gt>=0;gt--)yt[At-gt]=[dt.usrCoords[0],bt+vt*Ct(gt),xt+_t*Ct(gt)];return this.animationPath=yt,this.animationCallback=ft.callback,this.board.addAnimation(this),this},visit:function(dt,pt,ft){dt=new at(lt.COORDS_BY_USER,dt,this.board);var gt,mt,At,yt=this.board.attr.animationdelay,bt=[],xt=this.coords.usrCoords[1],vt=this.coords.usrCoords[2],_t=dt.usrCoords[1]-xt,Ct=dt.usrCoords[2]-vt,St=function(Et){var Tt=Et<At/2?2*Et/At:2*(At-Et)/At;return ft.effect&&ft.effect==="<>"?Math.pow(Math.sin(Tt*Math.PI/2),2):Tt};for(ut.isNumber(ft)?ft={repeat:ft}:(ft=ft||{},ut.exists(ft.repeat)||(ft.repeat=1)),At=Math.ceil(pt/(yt*ft.repeat)),mt=0;mt<ft.repeat;mt++)for(gt=At;gt>=0;gt--)bt[mt*(At+1)+At-gt]=[dt.usrCoords[0],xt+_t*St(gt),vt+Ct*St(gt)];return this.animationPath=bt,this.animationCallback=ft.callback,this.board.addAnimation(this),this},_anim:function(dt,pt){var ft,gt,mt,At,yt,bt,xt,vt,_t=1;return this.intervalCount+=1,this.intervalCount>pt&&(this.intervalCount=0),this.slideObject.elementClass===lt.OBJECT_CLASS_LINE?(ft=this.slideObject.point1.coords.distance(lt.COORDS_BY_SCREEN,this.slideObject.point2.coords),gt=this.slideObject.getSlope(),gt!==1/0?(yt=Math.atan(gt),mt=Math.round(this.intervalCount/pt*ft*Math.cos(yt)),At=Math.round(this.intervalCount/pt*ft*Math.sin(yt))):(mt=0,At=Math.round(this.intervalCount/pt*ft)),dt<0?(bt=this.slideObject.point2,(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0||this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]==0&&this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0)&&(_t=-1)):(bt=this.slideObject.point1,(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0||this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]==0&&this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0)&&(_t=-1)),this.coords.setCoordinates(lt.COORDS_BY_SCREEN,[bt.coords.scrCoords[1]+_t*mt,bt.coords.scrCoords[2]+_t*At])):this.slideObject.elementClass===lt.OBJECT_CLASS_CURVE?(xt=dt>0?Math.round(this.intervalCount/pt*this.board.canvasWidth):Math.round((pt-this.intervalCount)/pt*this.board.canvasWidth),this.coords.setCoordinates(lt.COORDS_BY_SCREEN,[xt,0]),this.coords=it.projectPointToCurve(this,this.slideObject,this.board)):this.slideObject.elementClass===lt.OBJECT_CLASS_CIRCLE&&(yt=dt<0?this.intervalCount/pt*2*Math.PI:(pt-this.intervalCount)/pt*2*Math.PI,vt=this.slideObject.Radius(),this.coords.setCoordinates(lt.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+vt*Math.cos(yt),this.slideObject.center.coords.usrCoords[2]+vt*Math.sin(yt)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var dt=[this.Z(),this.X(),this.Y()];return this.parents.length!==0&&(dt=this.parents),this.type===lt.OBJECT_TYPE_GLIDER&&(dt=[this.X(),this.Y(),this.slideObject.id]),dt}}),tt.CoordsElement.create=function(dt,pt,ft,gt,mt,At){var yt,bt,xt=!1;for(bt=0;bt<ft.length;bt++)(ut.isFunction(ft[bt])||ut.isString(ft[bt]))&&(xt=!0);if(xt)yt=new dt(pt,[0,0],gt,mt,At),yt.addConstraint(ft);else if(ut.isNumber(ft[0])&&ut.isNumber(ft[1]))yt=new dt(pt,ft,gt,mt,At),ut.exists(gt.slideobject)?yt.makeGlider(gt.slideobject):yt.baseElement=yt,yt.isDraggable=!0;else{if(!ut.isObject(ft[0])||!ut.isTransformationOrArray(ft[1]))return!1;yt=new dt(pt,[0,0],gt,mt,At),yt.addTransform(ft[0],ft[1]),yt.isDraggable=!1}return yt.handleSnapToGrid(),yt.handleSnapToPoints(),yt.handleAttractors(),yt.addParents(ft),yt},tt.CoordsElement}),define("base/text",["jxg","base/constants","base/coords","base/element","parser/geonext","math/statistics","utils/env","utils/type","math/math","base/coordselement"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){var ut={HTMLSliderInputEventHandler:function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()}};return tt.Text=function(ht,dt,pt,ft){this.constructor(ht,pt,_e.OBJECT_TYPE_TEXT,_e.OBJECT_CLASS_TEXT),this.element=this.board.select(pt.anchor),this.coordsConstructor(dt,lt.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this._setUpdateText(ft),this.updateText(),this.board.renderer.drawText(this),this.board.finalizeAdding(this),lt.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=lt.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},tt.Text.prototype=new it,lt.copyPrototypeMethods(tt.Text,ct,"coordsConstructor"),tt.extend(tt.Text.prototype,{hasPoint:function(ht,dt){var pt,ft,gt,mt,At,yt,bt=this.board.options.precision.hasPoint;return this.transformations.length>0&&(pt=ot.matVecMult(ot.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,ht,dt]),ht=pt[1],dt=pt[2]),At=this.getAnchorX(),pt=At==="right"?this.coords.scrCoords[1]-this.size[0]:At==="middle"?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1],ft=pt+this.size[0],yt=this.getAnchorY(),mt=yt==="top"?this.coords.scrCoords[2]+this.size[1]:yt==="middle"?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2],gt=mt-this.size[1],lt.evaluate(this.visProp.dragarea)==="all"?ht>=pt-bt&&ht<ft+bt&&dt>=gt-bt&&dt<=mt+bt:dt>=gt-bt&&dt<=mt+bt&&(ht>=pt-bt&&ht<=pt+2*bt||ht>=ft-2*bt&&ht<=ft+bt)},_setUpdateText:function(ht){var dt,pt,ft=lt.evaluate(this.visProp.parse),gt=lt.evaluate(this.visProp.usemathjax);this.orgText=ht,lt.isFunction(ht)?this.updateText=function(){pt=ht().toString(),this.plaintext=ft&&!gt?this.replaceSub(this.replaceSup(this.convertGeonext2CSS(pt))):pt}:lt.isString(ht)&&!ft?this.updateText=function(){this.plaintext=ht}:(lt.isNumber(ht)?this.content=lt.toFixed(ht,lt.evaluate(this.visProp.digits)):lt.evaluate(this.visProp.useasciimathml)?this.content="'`"+ht+"`'":this.content=gt?"'"+ht+"'":this.generateTerm(ht,!0,!0),dt=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=dt()})},_setText:function(ht){return this._setUpdateText(ht),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(ht){var dt;return this.visProp.castext=ht,dt=lt.isFunction(ht)?function(){return lt.sanitizeHTML(ht())}:lt.isNumber(ht)?ht:lt.sanitizeHTML(ht),this._setText(dt)},setText:function(ht){return this._setText(ht)},updateSize:function(){var ht,dt,pt,ft,gt=lt.evaluate(this.visProp.display);if(!at.isBrowser||this.board.renderer.type==="no")return this;if(ft=this.rendNode,gt==="html"||this.board.renderer.type==="vml")lt.exists(ft.offsetWidth)?(dt=[ft.offsetWidth,ft.offsetHeight],dt[0]===0&&dt[1]===0?(pt=this,window.setTimeout(function(){pt.size=[ft.offsetWidth,ft.offsetHeight],pt.needsUpdate=!0,pt.updateRenderer()},0)):this.size=dt):this.size=this.crudeSizeEstimate();else if(gt==="internal")if(this.board.renderer.type==="svg")try{ht=ft.getBBox(),this.size=[ht.width,ht.height]}catch{}else this.board.renderer.type==="canvas"&&(this.size=this.crudeSizeEstimate());return this},crudeSizeEstimate:function(){var ht=parseFloat(lt.evaluate(this.visProp.fontsize));return[ht*this.plaintext.length*.45,.9*ht]},utf8_decode:function(ht){return ht.replace(/&#x(\w+);/g,function(dt,pt){return String.fromCharCode(parseInt(pt,16))})},replaceSub:function(ht){if(!ht.indexOf)return ht;for(var dt,pt=ht.indexOf("_{");pt>=0;)ht=ht.substr(0,pt)+ht.substr(pt).replace(/_\{/,"<sub>"),dt=ht.substr(pt).indexOf("}"),dt>=0&&(ht=ht.substr(0,dt)+ht.substr(dt).replace(/\}/,"</sub>")),pt=ht.indexOf("_{");for(pt=ht.indexOf("_");pt>=0;)ht=ht.substr(0,pt)+ht.substr(pt).replace(/_(.?)/,"<sub>$1</sub>"),pt=ht.indexOf("_");return ht},replaceSup:function(ht){if(!ht.indexOf)return ht;for(var dt,pt=ht.indexOf("^{");pt>=0;)ht=ht.substr(0,pt)+ht.substr(pt).replace(/\^\{/,"<sup>"),dt=ht.substr(pt).indexOf("}"),dt>=0&&(ht=ht.substr(0,dt)+ht.substr(dt).replace(/\}/,"</sup>")),pt=ht.indexOf("^{");for(pt=ht.indexOf("^");pt>=0;)ht=ht.substr(0,pt)+ht.substr(pt).replace(/\^(.?)/,"<sup>$1</sup>"),pt=ht.indexOf("^");return ht},getSize:function(){return this.size},setCoords:function(ht,dt){var pt,ft,gt;return lt.isArray(ht)&&ht.length>1&&(dt=ht[1],ht=ht[0]),lt.evaluate(this.visProp.islabel)&&lt.exists(this.element)?(pt=this.element.getLabelAnchor(),ft=(ht-pt.usrCoords[1])*this.board.unitX,gt=-(dt-pt.usrCoords[2])*this.board.unitY,this.relativeCoords.setCoordinates(_e.COORDS_BY_SCREEN,[ft,gt])):this.coords.setCoordinates(_e.COORDS_BY_USER,[ht,dt]),this.fullUpdate(),this},update:function(ht){return this.needsUpdate?(this.updateCoords(ht),this.updateText(),lt.evaluate(this.visProp.display)==="internal"&&lt.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return this.updateRendererGeneric("updateText")},expandShortMath:function(ht){var dt=/([\)0-9\.])\s*([\(a-zA-Z_])/g;return ht.replace(dt,"$1*$2")},generateTerm:function(ht,dt,pt){var ft,gt,mt,At,yt='""';if(ht=ht||"",ht=ht.replace(/\r/g,""),ht=ht.replace(/\n/g,""),ht=ht.replace(/"/g,"'"),ht=ht.replace(/'/g,"\\'"),ht=ht.replace(/&amp;arc;/g,"&ang;"),ht=ht.replace(/<arc\s*\/>/g,"&ang;"),ht=ht.replace(/&lt;arc\s*\/&gt;/g,"&ang;"),ht=ht.replace(/&lt;sqrt\s*\/&gt;/g,"&radic;"),ht=ht.replace(/&lt;value&gt;/g,"<value>"),ht=ht.replace(/&lt;\/value&gt;/g,"</value>"),mt=ht.indexOf("<value>"),At=ht.indexOf("</value>"),mt>=0)for(;mt>=0;)yt+=' + "'+this.replaceSub(this.replaceSup(ht.slice(0,mt)))+'"',gt=ht.slice(mt+7,At),gt=gt.replace(/\s+/g,""),dt===!0&&(gt=this.expandShortMath(gt)),ft=pt?gt:nt.geonext2JS(gt,this.board),ft=ft.replace(/\\"/g,"'"),ft=ft.replace(/\\'/g,"'"),ft.indexOf("toFixed")<0&&lt.isNumber(lt.bind(this.board.jc.snippet(ft,!0,"",!1),this)())?yt+="+("+ft+").toFixed("+lt.evaluate(this.visProp.digits)+")":yt+="+("+ft+")",ht=ht.slice(At+8),mt=ht.indexOf("<value>"),At=ht.indexOf("</value>");return yt+=' + "'+this.replaceSub(this.replaceSup(ht))+'"',yt=this.convertGeonext2CSS(yt),yt=yt.replace(/&amp;/g,"&"),yt=yt.replace(/"/g,"'")},convertGeonext2CSS:function(ht){return lt.isString(ht)&&(ht=ht.replace(/<overline>/g,"<span style=text-decoration:overline>"),ht=ht.replace(/&lt;overline&gt;/g,"<span style=text-decoration:overline>"),ht=ht.replace(/<\/overline>/g,"</span>"),ht=ht.replace(/&lt;\/overline&gt;/g,"</span>"),ht=ht.replace(/<arrow>/g,"<span style=text-decoration:overline>"),ht=ht.replace(/&lt;arrow&gt;/g,"<span style=text-decoration:overline>"),ht=ht.replace(/<\/arrow>/g,"</span>"),ht=ht.replace(/&lt;\/arrow&gt;/g,"</span>")),ht},notifyParents:function(ht){var dt,pt=null;ht=ht.replace(/&lt;value&gt;/g,"<value>"),ht=ht.replace(/&lt;\/value&gt;/g,"</value>");do dt=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/,(pt=dt.exec(ht))!==null&&(nt.findDependencies(this,pt[1],this.board),ht=ht.substr(pt.index),ht=ht.replace(dt,""));while(pt!==null);return this},getParents:function(){var ht;return ht=this.relativeCoords!==void 0?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],this.parents.length!==0&&(ht=this.parents),ht},bounds:function(){var ht=this.coords.usrCoords;return lt.evaluate(this.visProp.islabel)||this.board.unitY===0||this.board.unitX===0?[0,0,0,0]:[ht[1],ht[2]+this.size[1]/this.board.unitY,ht[1]+this.size[0]/this.board.unitX,ht[2]]},getAnchorX:function(){var ht=lt.evaluate(this.visProp.anchorx);if(ht=="auto")switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";case"lft":case"llft":case"ulft":default:return"right"}return ht},getAnchorY:function(){var ht=lt.evaluate(this.visProp.anchory);if(ht=="auto")switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";case"rt":case"lft":default:return"middle"}return ht}}),tt.createText=function(ht,dt,pt){var ft,gt=lt.copyAttributes(pt,ht.options,"text"),mt=dt.slice(0,-1),At=dt[dt.length-1];if(gt.anchor=gt.parent||gt.anchor,!(ft=ct.create(tt.Text,ht,mt,gt,At)))throw new Error("JSXGraph: Can't create text with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return lt.evaluate(gt.rotate)!==0&&gt.display==="internal"&&ft.addRotation(lt.evaluate(gt.rotate)),ft},tt.registerElement("text",tt.createText),tt.createHTMLSlider=function(ht,dt,pt){var ft,gt,mt=lt.copyAttributes(pt,ht.options,"htmlslider");if(dt.length!==2||dt[0].length!==2||dt[1].length!==3)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+`'.
Possible parents are: [[x,y], [min, start, max]]`);mt.anchor=mt.parent||mt.anchor,mt.fixed=mt.fixed||!0,gt=[dt[0][0],dt[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],ft=tt.createText(ht,gt,mt),ft.type=lt.OBJECT_TYPE_HTMLSLIDER,ft.rendNodeForm=ft.rendNode.childNodes[0],ft.rendNodeRange=ft.rendNodeForm.childNodes[0],ft.rendNodeRange.min=dt[1][0],ft.rendNodeRange.max=dt[1][2],ft.rendNodeRange.step=mt.step,ft.rendNodeRange.value=dt[1][1],ft.rendNodeLabel=ft.rendNodeForm.childNodes[1],ft.rendNodeLabel.id=ft.rendNode.id+"_label",mt.withlabel&&(ft.rendNodeLabel.innerHTML=ft.name+"="),ft.rendNodeOut=ft.rendNodeForm.childNodes[2],ft.rendNodeOut.value=dt[1][1];try{ft.rendNodeForm.id=ft.rendNode.id+"_form",ft.rendNodeRange.id=ft.rendNode.id+"_range",ft.rendNodeOut.id=ft.rendNode.id+"_out"}catch(At){tt.debug(At)}return ft.rendNodeRange.style.width=mt.widthrange+"px",ft.rendNodeRange.style.verticalAlign="middle",ft.rendNodeOut.style.width=mt.widthout+"px",ft._val=dt[1][1],tt.supportsVML()?at.addEvent(ft.rendNodeForm,"change",ut.HTMLSliderInputEventHandler,ft):at.addEvent(ft.rendNodeForm,"input",ut.HTMLSliderInputEventHandler,ft),ft.Value=function(){return this._val},ft},tt.registerElement("htmlslider",tt.createHTMLSlider),{Text:tt.Text,createText:tt.createText,createHTMLSlider:tt.createHTMLSlider}}),define("utils/uuid",["jxg"],function(tt){var _e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",rt=_e.split("");return tt.Util=tt.Util||{},tt.Util.genUUID=function(){var it,nt,st=[],at=0;for(nt=0;nt<36;nt++)nt===8||nt===13||nt===18||nt===23?st[nt]="-":nt===14?st[nt]="4":(at<=2&&(at=33554432+16777216*Math.random()|0),it=15&at,at>>=4,st[nt]=rt[nt===19?3&it|8:it]);return st.join("")},tt.Util}),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],function(JXG,Const,Text,Mat,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(tt,_e){function rt(){}if(typeof tt!="object"&&typeof tt!="function")throw new TypeError("Object prototype may only be an Object: "+tt);if(tt===null)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(_e!==void 0)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");return rt.prototype=tt,new rt});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}};JXG.JessieCode=function(tt,_e){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="",typeof tt=="string"&&this.parse(tt,_e)},JXG.extend(JXG.JessieCode.prototype,{node:function(tt,_e,rt){return{type:tt,value:_e,children:rt}},createNode:function(tt,_e,rt){var it,nt=this.node(tt,_e,[]);for(it=2;it<arguments.length;it++)nt.children.push(arguments[it]);return nt.type=="node_const"&&Type.isNumber(nt.value)&&(nt.isMath=!0),nt.line=this.parCurLine,nt.col=this.parCurColumn,nt},pushScope:function(tt){var _e={args:tt,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=_e,_e.id=this.scopes.push(_e)-1,_e},popScope:function(){var tt=this.scope.previous;return this.scope=tt!==null?tt:this.scope,this.scope},getElementById:function(tt){return this.board.objects[tt]},log:function(){this.$log.push(arguments),typeof console=="object"&&console.log&&console.log.apply(console,arguments)},creator:function(){var tt,_e={};return tt=function(rt){var it;return typeof _e[this.board.id+rt]=="function"?it=_e[this.board.id+rt]:(it=function(nt){return function(st,at){var lt;return lt=Type.exists(at)?at:{name:nt.lhs[nt.scope]!==0?nt.lhs[nt.scope]:""},nt.board.create(rt,st,lt)}}(this),it.creator=!0,_e[this.board.id+rt]=it),it},tt.clearCache=function(){_e={}},tt}(),letvar:function(tt,_e){this.builtIn[tt]&&this._warn('"'+tt+'" is a predefined value.'),this.scope.locals[tt]=_e},isLocalVariable:function(tt){for(var _e=this.scope;_e!==null;){if(Type.exists(_e.locals[tt]))return _e;_e=_e.previous}return null},isParameter:function(tt){for(var _e=this.scope;_e!==null;){if(Type.indexOf(_e.args,tt)>-1)return _e;_e=_e.previous}return null},isCreator:function(tt){return!!JXG.elements[tt]},isMathMethod:function(tt){return tt!=="E"&&!!Math[tt]},isBuiltIn:function(tt){return!!this.builtIn[tt]},getvar:function(tt,_e){var rt;return _e=Type.def(_e,!1),rt=this.isLocalVariable(tt),rt!==null?rt.locals[tt]:this.isCreator(tt)?this.creator(tt):this.isBuiltIn(tt)?this.builtIn[tt]:this.isMathMethod(tt)?Math[tt]:_e||(rt=this.board.select(tt))===tt?void 0:rt},resolve:function(tt){for(var _e=this.scope;_e!==null;){if(Type.exists(_e.locals[tt]))return _e.locals[tt];_e=_e.previous}},getvarJS:function(tt,_e,rt){var it="";return _e=Type.def(_e,!1),rt=Type.def(rt,!1),this.isParameter(tt)!==null?tt:this.isLocalVariable(tt)===null||rt?this.isCreator(tt)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(rt?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+tt+"'].concat([a, props])); })":(rt&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(tt)?this.builtIn[tt].src||this.builtIn[tt]:this.isMathMethod(tt)?"Math."+tt:_e?"":(Type.isId(this.board,tt)?it="$jc$.board.objects['"+tt+"']":Type.isName(this.board,tt)?it="$jc$.board.elementsByName['"+tt+"']":Type.isGroup(this.board,tt)&&(it="$jc$.board.groups['"+tt+"']"),it)):"$jc$.resolve('"+tt+"')"},makeMap:function(tt){return tt.isMap=!0,tt},functionCodeJS:function(tt){var _e=tt.children[0].join(", "),rt="",it="";return tt.value==="op_map"&&(rt="{ return  ",it=" }"),"function ("+_e+`) {
var $oldscope$ = $jc$.scope;
$jc$.scope = $jc$.scopes[`+this.scope.id+`];
var r = (function () `+rt+this.compile(tt.children[1],!0)+it+`)();
$jc$.scope = $oldscope$;
return r;
}`},defineFunction:function(node){var fun,i,list=node.children[0],scope=this.pushScope(list);if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{return fun=eval(str)}catch(tt){return $jc$._warn(`error compiling function

`+str+`

`+tt.toString()),function(){}}}(this),this.popScope()}else fun=function(tt,_e,rt){return function(){var it,nt;for(nt=_e.scope,_e.scope=_e.scopes[rt],it=0;it<tt.length;it++)_e.scope.locals[tt[it]]=arguments[it];return it=_e.execute(node.children[1]),_e.scope=nt,it}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=function(tt){return function(){return tt.compile(tt.replaceIDs(Type.deepCopy(node)))}}(this),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(tt){var _e,rt={};for(_e=0;_e<arguments.length;_e++)rt=Type.deepCopy(rt,arguments[_e],!0);return rt},setProp:function(tt,_e,rt){var it,nt,st={};tt.elementClass!==Const.OBJECT_CLASS_POINT||_e!=="X"&&_e!=="Y"?tt.elementClass!==Const.OBJECT_CLASS_TEXT||_e!=="X"&&_e!=="Y"?tt.type&&tt.elementClass&&tt.visProp?Type.exists(tt[tt.methodMap[_e]])&&typeof tt[tt.methodMap[_e]]!="function"?tt[tt.methodMap[_e]]=rt:(st[_e]=rt,tt.setAttribute(st)):tt[_e]=rt:(typeof rt=="number"?tt[_e]=function(){return rt}:typeof rt=="function"?(tt.isDraggable=!1,tt[_e]=rt):typeof rt=="string"&&(tt.isDraggable=!1,tt[_e]=Type.createFunction(rt,this.board,null,!0),tt[_e+"jc"]=rt),tt[_e].origin=rt,this.board.update()):(_e=_e.toLowerCase(),tt.isDraggable&&typeof rt=="number"?(it=_e==="x"?rt:tt.X(),nt=_e==="y"?rt:tt.Y(),tt.setPosition(Const.COORDS_BY_USER,[it,nt])):!tt.isDraggable||typeof rt!="function"&&typeof rt!="string"?tt.isDraggable||(it=_e==="x"?rt:tt.XEval.origin,nt=_e==="y"?rt:tt.YEval.origin,tt.addConstraint([it,nt])):(it=_e==="x"?rt:tt.coords.usrCoords[1],nt=_e==="y"?rt:tt.coords.usrCoords[2],tt.addConstraint([it,nt])),this.board.update())},_genericParse:function(tt,_e,rt,it){var nt,st,at,lt,ot=tt.replace(/\r\n/g,`
`).split(`
`),ct=[];it||(this.code+=tt+`
`),Text&&(st=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(rt)||(rt=!1),nt=0;nt<ot.length;nt++)rt&&(ot[nt]=JXG.GeonextParser.geonext2JS(ot[nt],this.board)),ct.push(ot[nt]);switch(tt=ct.join(`
`),at=parser.parse(tt),this.CA&&(at=this.CA.expandDerivatives(at,null,at),at=this.CA.removeTrivialNodes(at)),_e){case"parse":lt=this.execute(at);break;case"manipulate":lt=this.compile(at);break;case"getAst":lt=at;break;default:lt=!1}}catch(ut){console.log(ut)}finally{Text&&(Text.Text.prototype.setText=st)}return lt},parse:function(tt,_e,rt){return this._genericParse(tt,"parse",_e,rt)},manipulate:function(tt,_e,rt){return this._genericParse(tt,"manipulate",_e,rt)},getAST:function(tt,_e,rt){return this._genericParse(tt,"getAst",_e,rt)},snippet:function(tt,_e,rt,it){var nt;return _e=Type.def(_e,!0),rt=Type.def(rt,""),it=Type.def(it,!1),nt=(_e?" function ("+rt+") { return ":"")+tt+(_e?"; }":"")+";",this.parse(nt,it,!0)},replaceIDs:function(tt){var _e,rt;if(tt.replaced&&(rt=this.board.objects[tt.children[1][0].value],Type.exists(rt)&&rt.name!==""&&(tt.type="node_var",tt.value=rt.name,tt.children.length=0,delete tt.replaced)),tt.children)for(_e=tt.children.length;_e>0;_e--)Type.exists(tt.children[_e-1])&&(tt.children[_e-1]=this.replaceIDs(tt.children[_e-1]));return tt},replaceNames:function(tt){var _e,rt;if(rt=tt.value,tt.type==="node_op"&&rt==="op_lhs"&&tt.children.length===1?this.isLHS=!0:tt.type==="node_var"&&(this.isLHS?this.letvar(rt,!0):!Type.exists(this.getvar(rt,!0))&&Type.exists(this.board.elementsByName[rt])&&(tt=this.createReplacementNode(tt))),tt.children)for(_e=tt.children.length;_e>0;_e--)Type.exists(tt.children[_e-1])&&(tt.children[_e-1]=this.replaceNames(tt.children[_e-1]));return tt.type==="node_op"&&tt.value==="op_lhs"&&tt.children.length===1&&(this.isLHS=!1),tt},createReplacementNode:function(tt){var _e=tt.value,rt=this.board.elementsByName[_e];return tt=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",rt.id)]),tt.replaced=!0,tt},collectDependencies:function(tt,_e){var rt,it,nt,st;if(Type.isArray(tt))for(st=tt.length,rt=0;rt<st;rt++)this.collectDependencies(tt[rt],_e);else if(it=tt.value,tt.type==="node_var"&&(nt=this.getvar(it))&&nt.visProp&&nt.type&&nt.elementClass&&nt.id&&(_e[nt.id]=nt),tt.type==="node_op"&&tt.value==="op_execfun"&&tt.children.length>1&&tt.children[0].value==="$"&&tt.children[1].length>0&&(nt=tt.children[1][0].value,_e[nt]=this.board.objects[nt]),tt.children)for(rt=tt.children.length;rt>0;rt--)Type.exists(tt.children[rt-1])&&this.collectDependencies(tt.children[rt-1],_e)},resolveProperty:function(tt,_e,rt){return rt=Type.def(rt,!1),tt&&tt.methodMap&&(Type.exists(tt.subs)&&Type.exists(tt.subs[_e])?tt=tt.subs:Type.exists(tt.methodMap[_e])?_e=tt.methodMap[_e]:(tt=tt.visProp,_e=_e.toLowerCase())),Type.isFunction(tt)&&this._error("Accessing function properties is not allowed."),Type.exists(tt)||this._error(tt+" is not an object"),Type.exists(tt[_e])||this._error("unknown property "+_e),rt&&typeof tt[_e]=="function"?function(){return tt[_e].apply(tt,arguments)}:tt[_e]},getLHS:function(tt){var _e;if(tt.type==="node_var")_e={o:this.scope.locals,what:tt.value};else if(tt.type==="node_op"&&tt.value==="op_property")_e={o:this.execute(tt.children[0]),what:tt.children[1]};else{if(tt.type!=="node_op"||tt.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");_e={o:this.execute(tt.children[0]),what:this.execute(tt.children[1])}}return _e},getLHSCompiler:function(tt,_e){var rt;if(tt.type==="node_var")rt=tt.value;else if(tt.type==="node_op"&&tt.value==="op_property")rt=[this.compile(tt.children[0],_e),"'"+tt.children[1]+"'"];else{if(tt.type!=="node_op"||tt.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");rt=[this.compile(tt.children[0],_e),tt.children[1].type==="node_const"?tt.children[1].value:this.compile(tt.children[1],_e)]}return rt},execute:function(tt){var _e,rt,it,nt,st,at,lt,ot,ct,ut,ht=[];if(_e=0,!tt)return _e;switch(this.line=tt.line,this.col=tt.col,tt.type){case"node_op":switch(tt.value){case"op_none":tt.children[0]&&this.execute(tt.children[0]),tt.children[1]&&(_e=this.execute(tt.children[1]));break;case"op_assign":rt=this.getLHS(tt.children[0]),this.lhs[this.scope.id]=rt[1],rt.o.type&&rt.o.elementClass&&rt.o.methodMap&&rt.what==="label"&&this._error("Left-hand side of assignment is read-only."),_e=this.execute(tt.children[1]),rt.o!==this.scope.locals||Type.isArray(rt.o)&&typeof rt.what=="number"?this.setProp(rt.o,rt.what,_e):this.letvar(rt.what,_e),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(tt.children[0])&&(_e=this.execute(tt.children[1]));break;case"op_conditional":case"op_if_else":_e=this.execute(tt.children[0])?this.execute(tt.children[1]):this.execute(tt.children[2]);break;case"op_while":for(;this.execute(tt.children[0]);)this.execute(tt.children[1]);break;case"op_do":do this.execute(tt.children[0]);while(this.execute(tt.children[1]));break;case"op_for":for(this.execute(tt.children[0]);this.execute(tt.children[1]);this.execute(tt.children[2]))this.execute(tt.children[3]);break;case"op_proplst":tt.children[0]&&this.execute(tt.children[0]),tt.children[1]&&this.execute(tt.children[1]);break;case"op_emptyobject":_e={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(tt.children[0]),_e=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][tt.children[0]]=this.execute(tt.children[1]);break;case"op_array":for(_e=[],st=tt.children[0].length,it=0;it<st;it++)_e.push(this.execute(tt.children[0][it]));break;case"op_extvalue":_e=this.execute(tt.children[0]),it=this.execute(tt.children[1]),_e=typeof it=="number"&&Math.abs(Math.round(it)-it)<Mat.eps?_e[it]:void 0;break;case"op_return":if(this.scope!==0)return this.execute(tt.children[0]);this._error("Unexpected return.");break;case"op_map":tt.children[1].isMath||tt.children[1].type==="node_var"||this._error("execute: In a map only function calls and mathematical expressions are allowed."),ot=this.defineFunction(tt),ot.isMap=!0,_e=ot;break;case"op_function":ot=this.defineFunction(tt),ot.isMap=!1,_e=ot;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,at=tt.children[1],Type.exists(tt.children[2]))if(tt.children[3])for(lt=tt.children[2],ct={},it=0;it<lt.length;it++)ct=Type.deepCopy(ct,this.execute(lt[it]),!0);else ct=this.execute(tt.children[2]);for(ot=this.execute(tt.children[0]),ut=ot&&ot.sc?ot.sc:this,!ot.creator&&Type.exists(tt.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),it=0;it<at.length;it++)ht[it]=this.execute(at[it]),this.dpstack[this.pscope].push({line:tt.children[1][it].line,col:tt.children[1][it].ecol});if(typeof ot!="function"||ot.creator)if(typeof ot=="function"&&ot.creator){nt=this.line;try{for(_e=ot(ht,ct),_e.jcLineStart=nt,_e.jcLineEnd=tt.eline,it=nt;it<=tt.line;it++)this.lineToElement[it]=_e;_e.debugParents=this.dpstack[this.pscope]}catch(dt){this._error(dt.toString())}}else this._error("Function '"+ot+"' is undefined.");else _e=ot.apply(ut,ht);this.dpstack.pop(),this.pscope--;break;case"op_property":nt=this.execute(tt.children[0]),rt=tt.children[1],_e=this.resolveProperty(nt,rt,!1),Type.exists(_e)&&(_e.sc=nt);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(tt.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),rt=this.getvar(tt.children[0]),_e=this.del(rt);break;case"op_equ":_e=this.execute(tt.children[0])==this.execute(tt.children[1]);break;case"op_neq":_e=this.execute(tt.children[0])!=this.execute(tt.children[1]);break;case"op_approx":_e=Math.abs(this.execute(tt.children[0])-this.execute(tt.children[1]))<Mat.eps;break;case"op_grt":_e=this.execute(tt.children[0])>this.execute(tt.children[1]);break;case"op_lot":_e=this.execute(tt.children[0])<this.execute(tt.children[1]);break;case"op_gre":_e=this.execute(tt.children[0])>=this.execute(tt.children[1]);break;case"op_loe":_e=this.execute(tt.children[0])<=this.execute(tt.children[1]);break;case"op_or":_e=this.execute(tt.children[0])||this.execute(tt.children[1]);break;case"op_and":_e=this.execute(tt.children[0])&&this.execute(tt.children[1]);break;case"op_not":_e=!this.execute(tt.children[0]);break;case"op_add":_e=this.add(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_sub":_e=this.sub(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_div":_e=this.div(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_mod":_e=this.mod(this.execute(tt.children[0]),this.execute(tt.children[1]),!0);break;case"op_mul":_e=this.mul(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_exp":_e=this.pow(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_neg":_e=this.neg(this.execute(tt.children[0]))}break;case"node_var":_e=this.getvar(tt.value);break;case"node_const":_e=Number(tt.value);break;case"node_const_bool":_e=tt.value;break;case"node_str":_e=tt.value.replace(/\\(.)/,"$1")}return _e},compile:function(tt,_e){var rt,it,nt,st="";if(Type.exists(_e)||(_e=!1),!tt)return st;switch(tt.type){case"node_op":switch(tt.value){case"op_none":tt.children[0]&&(st=this.compile(tt.children[0],_e)),tt.children[1]&&(st+=this.compile(tt.children[1],_e));break;case"op_assign":_e?(rt=this.getLHSCompiler(tt.children[0],_e),Type.isArray(rt)?st="$jc$.setProp("+rt[0]+", "+rt[1]+", "+this.compile(tt.children[1],_e)+`);
`:(this.isLocalVariable(rt)!==this.scope&&(this.scope.locals[rt]=!0),st="$jc$.scopes["+this.scope.id+"].locals['"+rt+"'] = "+this.compile(tt.children[1],_e)+`;
`)):(rt=this.compile(tt.children[0]),st=rt+" = "+this.compile(tt.children[1],_e)+`;
`);break;case"op_if":st=" if ("+this.compile(tt.children[0],_e)+") "+this.compile(tt.children[1],_e);break;case"op_if_else":st=" if ("+this.compile(tt.children[0],_e)+")"+this.compile(tt.children[1],_e),st+=" else "+this.compile(tt.children[2],_e);break;case"op_conditional":st="(("+this.compile(tt.children[0],_e)+")?("+this.compile(tt.children[1],_e),st+="):("+this.compile(tt.children[2],_e)+"))";break;case"op_while":st=" while ("+this.compile(tt.children[0],_e)+`) {
`+this.compile(tt.children[1],_e)+`}
`;break;case"op_do":st=` do {
`+this.compile(tt.children[0],_e)+"} while ("+this.compile(tt.children[1],_e)+`);
`;break;case"op_for":st=" for ("+this.compile(tt.children[0],_e)+"; "+this.compile(tt.children[1],_e)+"; "+this.compile(tt.children[2],_e)+`) {
`+this.compile(tt.children[3],_e)+`
}
`;break;case"op_proplst":tt.children[0]&&(st=this.compile(tt.children[0],_e)+", "),st+=this.compile(tt.children[1],_e);break;case"op_prop":st=tt.children[0]+": "+this.compile(tt.children[1],_e);break;case"op_emptyobject":st=_e?"{}":"<< >>";break;case"op_proplst_val":st=this.compile(tt.children[0],_e);break;case"op_array":for(nt=[],it=0;it<tt.children[0].length;it++)nt.push(this.compile(tt.children[0][it],_e));st="["+nt.join(", ")+"]";break;case"op_extvalue":st=this.compile(tt.children[0],_e)+"["+this.compile(tt.children[1],_e)+"]";break;case"op_return":st=" return "+this.compile(tt.children[0],_e)+`;
`;break;case"op_map":tt.children[1].isMath||tt.children[1].type==="node_var"||this._error("compile: In a map only function calls and mathematical expressions are allowed."),nt=tt.children[0],st=_e?" $jc$.makeMap(function ("+nt.join(", ")+") { return "+this.compile(tt.children[1],_e)+"; })":"map ("+nt.join(", ")+") -> "+this.compile(tt.children[1],_e);break;case"op_function":nt=tt.children[0],this.pushScope(nt),st=_e?this.functionCodeJS(tt):" function ("+nt.join(", ")+") "+this.compile(tt.children[1],_e),this.popScope();break;case"op_execfunmath":console.log("TODO"),st="-1";break;case"op_execfun":if(tt.children[2]){for(nt=[],it=0;it<tt.children[2].length;it++)nt.push(this.compile(tt.children[2][it],_e));_e&&(rt="$jc$.mergeAttributes("+nt.join(", ")+")")}for(tt.children[0].withProps=!!tt.children[2],nt=[],it=0;it<tt.children[1].length;it++)nt.push(this.compile(tt.children[1][it],_e));st=this.compile(tt.children[0],_e)+"("+nt.join(", ")+(tt.children[2]&&_e?", "+rt:"")+")"+(tt.children[2]&&!_e?rt:""),_e&&tt.children[0].value==="$"&&(st="$jc$.board.objects["+this.compile(tt.children[1][0],_e)+"]");break;case"op_property":st=_e&&tt.children[1]!=="X"&&tt.children[1]!=="Y"?"$jc$.resolveProperty("+this.compile(tt.children[0],_e)+", '"+tt.children[1]+"', true)":this.compile(tt.children[0],_e)+"."+tt.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),st=_e?"$jc$.use('":"use('",st+=tt.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),st=_e?"$jc$.del(":"remove(",st+=this.compile(tt.children[0],_e)+")";break;case"op_equ":st="("+this.compile(tt.children[0],_e)+" == "+this.compile(tt.children[1],_e)+")";break;case"op_neq":st="("+this.compile(tt.children[0],_e)+" != "+this.compile(tt.children[1],_e)+")";break;case"op_approx":st="("+this.compile(tt.children[0],_e)+" ~= "+this.compile(tt.children[1],_e)+")";break;case"op_grt":st="("+this.compile(tt.children[0],_e)+" > "+this.compile(tt.children[1],_e)+")";break;case"op_lot":st="("+this.compile(tt.children[0],_e)+" < "+this.compile(tt.children[1],_e)+")";break;case"op_gre":st="("+this.compile(tt.children[0],_e)+" >= "+this.compile(tt.children[1],_e)+")";break;case"op_loe":st="("+this.compile(tt.children[0],_e)+" <= "+this.compile(tt.children[1],_e)+")";break;case"op_or":st="("+this.compile(tt.children[0],_e)+" || "+this.compile(tt.children[1],_e)+")";break;case"op_and":st="("+this.compile(tt.children[0],_e)+" && "+this.compile(tt.children[1],_e)+")";break;case"op_not":st="!("+this.compile(tt.children[0],_e)+")";break;case"op_add":st=_e?"$jc$.add("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" + "+this.compile(tt.children[1],_e)+")";break;case"op_sub":st=_e?"$jc$.sub("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" - "+this.compile(tt.children[1],_e)+")";break;case"op_div":st=_e?"$jc$.div("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" / "+this.compile(tt.children[1],_e)+")";break;case"op_mod":st=_e?"$jc$.mod("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+", true)":"("+this.compile(tt.children[0],_e)+" % "+this.compile(tt.children[1],_e)+")";break;case"op_mul":st=_e?"$jc$.mul("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" * "+this.compile(tt.children[1],_e)+")";break;case"op_exp":st=_e?"$jc$.pow("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+"^"+this.compile(tt.children[1],_e)+")";break;case"op_neg":st=_e?"$jc$.neg("+this.compile(tt.children[0],_e)+")":"(-"+this.compile(tt.children[0],_e)+")"}break;case"node_var":st=_e?this.getvarJS(tt.value,!1,tt.withProps):tt.value;break;case"node_const":case"node_const_bool":st=tt.value;break;case"node_str":st="'"+tt.value+"'"}return tt.needsBrackets&&(st=`{
`+st+`}
`),st},X:function(tt){return tt.X()},Y:function(tt){return tt.Y()},V:function(tt){return tt.Value()},L:function(tt){return tt.L()},dist:function(tt,_e){return Type.exists(tt)&&Type.exists(tt.Dist)||this._error("Error: Can't calculate distance."),tt.Dist(_e)},add:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isArray(_e))for(it=Math.min(tt.length,_e.length),nt=[],rt=0;rt<it;rt++)nt[rt]=tt[rt]+_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?nt=tt+_e:Type.isString(tt)||Type.isString(_e)?nt=tt.toString()+_e.toString():this._error("Operation + not defined on operands "+typeof tt+" and "+typeof _e);return nt},sub:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isArray(_e))for(it=Math.min(tt.length,_e.length),nt=[],rt=0;rt<it;rt++)nt[rt]=tt[rt]-_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?nt=tt-_e:this._error("Operation - not defined on operands "+typeof tt+" and "+typeof _e);return nt},neg:function(tt){var _e,rt,it;if(tt=Type.evalSlider(tt),Type.isArray(tt))for(rt=tt.length,it=[],_e=0;_e<rt;_e++)it[_e]=-tt[_e];else Type.isNumber(tt)?it=-tt:this._error("Unary operation - not defined on operand "+typeof tt);return it},mul:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e)&&(rt=tt,tt=_e,_e=tt),Type.isArray(tt)&&Type.isArray(_e))it=Math.min(tt.length,_e.length),nt=Mat.innerProduct(tt,_e,it);else if(Type.isNumber(tt)&&Type.isArray(_e))for(it=_e.length,nt=[],rt=0;rt<it;rt++)nt[rt]=tt*_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?nt=tt*_e:this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return nt},div:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e))for(it=tt.length,nt=[],rt=0;rt<it;rt++)nt[rt]=tt[rt]/_e;else Type.isNumber(tt)&&Type.isNumber(_e)?nt=tt/_e:this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return nt},mod:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e))for(it=tt.length,nt=[],rt=0;rt<it;rt++)nt[rt]=Mat.mod(tt[rt],_e,!0);else Type.isNumber(tt)&&Type.isNumber(_e)?nt=Mat.mod(tt,_e,!0):this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return nt},pow:function(tt,_e){return tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Math.pow(tt,_e)},DDD:function(tt){console.log("Dummy derivative function. This should never appear!")},ifthen:function(tt,_e,rt){return tt?_e:rt},del:function(tt){typeof tt=="object"&&JXG.exists(tt.type)&&JXG.exists(tt.elementClass)&&this.board.removeObject(tt)},use:function(tt){var _e,rt,it=!1;if(typeof tt=="string"){for(_e in JXG.boards)if(JXG.boards.hasOwnProperty(_e)&&JXG.boards[_e].container===tt){rt=JXG.boards[_e],it=!0;break}}else rt=tt,it=!0;it?(this.board=rt,this.builtIn.$board=rt,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+tt+"' not found!")},findSymbol:function(tt,_e){var rt,it;for(_e=Type.def(_e,-1),it=_e===-1?this.scope:this.scopes[_e];it!==null;){for(rt in it.locals)if(it.locals.hasOwnProperty(rt)&&it.locals[rt]===tt)return[rt,it];it=it.previous}return[]},importModule:function(tt){return priv.modules[tt.toLowerCase()]},defineBuiltIn:function(){var tt=this,_e={PI:Math.PI,EULER:Math.E,X:tt.X,Y:tt.Y,V:tt.V,L:tt.L,dist:tt.dist,rad:Geometry.rad,deg:Geometry.trueAngle,factorial:Mat.factorial,trunc:Type.trunc,log:Mat.log,ln:Math.log,log10:Mat.log10,lg:Mat.log10,log2:Mat.log2,lb:Mat.log2,ld:Mat.log2,cosh:Mat.cosh,sinh:Mat.sinh,IfThen:tt.ifthen,import:tt.importModule,use:tt.use,remove:tt.del,$:tt.getElementById,$board:tt.board,$log:tt.log,D:tt.DDD};return _e.rad.sc=Geometry,_e.deg.sc=Geometry,_e.factorial.sc=Mat,_e.X.src="$jc$.X",_e.Y.src="$jc$.Y",_e.V.src="$jc$.V",_e.L.src="$jc$.L",_e.dist.src="$jc$.dist",_e.rad.src="JXG.Math.Geometry.rad",_e.deg.src="JXG.Math.Geometry.trueAngle",_e.factorial.src="JXG.Math.factorial",_e.trunc.src="JXG.trunc",_e.ln.src="Math.log",_e.log10.src="JXG.Math.log10",_e.lg.src="JXG.Math.log10",_e.log2.src="JXG.Math.log2",_e.lb.src="JXG.Math.log2",_e.ld.src="JXG.Math.log2",_e.cosh.src="JXG.Math.cosh",_e.sinh.src="JXG.Math.sinh",_e.import.src="$jc$.importModule",_e.use.src="$jc$.use",_e.remove.src="$jc$.del",_e.IfThen.src="$jc$.ifthen",_e.$.src="(function (n) { return $jc$.board.select(n); })",_e.$board&&(_e.$board.src="$jc$.board"),_e.$log.src="$jc$.log",_e},_debug:function(tt){typeof console=="object"?console.log(tt):Env.isBrowser&&document&&document.getElementById("debug")!==null&&(document.getElementById("debug").innerHTML+=tt+"<br />")},_error:function(tt){var _e=new Error("Error("+this.line+"): "+tt);throw _e.line=this.line,_e},_warn:function(tt){typeof console=="object"?console.log("Warning("+this.line+"): "+tt):Env.isBrowser&&document&&document.getElementById(this.warnLog)!==null&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+tt+"<br />")},_log:function(tt){typeof window!="object"&&typeof self=="object"&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+tt.toString()}):console.log("Log: ",arguments)}});var parser=function(){function tt(){this.yy={}}var _e=function(hr,Cr,tr,Ar){for(tr=tr||{},Ar=hr.length;Ar--;tr[hr[Ar]]=Cr);return tr},rt=[2,14],it=[1,13],nt=[1,37],st=[1,14],at=[1,15],lt=[1,21],ot=[1,16],ct=[1,17],ut=[1,33],ht=[1,18],dt=[1,19],pt=[1,12],ft=[1,59],gt=[1,60],mt=[1,58],At=[1,46],yt=[1,48],bt=[1,49],xt=[1,50],vt=[1,51],_t=[1,52],Ct=[1,53],St=[1,54],Et=[1,45],Tt=[1,38],Mt=[1,39],Rt=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],It=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],Ot=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Bt=[2,48],Nt=[1,72],zt=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],Dt=[1,78],Ft=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Ut=[1,82],$t=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Vt=[1,83],Zt=[1,84],qt=[1,85],sr=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],er=[1,89],ir=[1,90],ur=[1,91],ar=[1,92],lr=[1,97],gr=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],Yt=[1,103],nr=[1,104],mr=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],Sr=[1,105],Er=[1,106],Nr=[1,107],wr=[1,126],kr=[1,139],Ur=[83,86],Or=[1,149],Xr=[10,66,86],Qt=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],Xt=[1,166],xr=[10,86],Lr={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,6],[92,1],[92,3]],performAction:function(hr,Cr,tr,Ar,yr,Jt,_r){var Kt=Jt.length-1;switch(yr){case 1:return Jt[Kt-1];case 2:this.$=fr.createNode(pr(_r[Kt-4]),"node_op","op_if",Jt[Kt-2],Jt[Kt]);break;case 3:this.$=fr.createNode(pr(_r[Kt-6]),"node_op","op_if_else",Jt[Kt-4],Jt[Kt-2],Jt[Kt]);break;case 4:this.$=fr.createNode(pr(_r[Kt-4]),"node_op","op_while",Jt[Kt-2],Jt[Kt]);break;case 5:this.$=fr.createNode(pr(_r[Kt-8]),"node_op","op_for",Jt[Kt-6],Jt[Kt-4],Jt[Kt-2],Jt[Kt]);break;case 6:this.$=fr.createNode(pr(_r[Kt-6]),"node_op","op_do",Jt[Kt-5],Jt[Kt-2]);break;case 7:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_use",Jt[Kt]);break;case 8:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_delete",Jt[Kt]);break;case 9:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_return",void 0);break;case 10:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_return",Jt[Kt-1]);break;case 11:case 14:this.$=fr.createNode(pr(_r[Kt]),"node_op","op_none");break;case 12:this.$=Jt[Kt-1],this.$.needsBrackets=!0;break;case 13:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_none",Jt[Kt-1],Jt[Kt]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=Jt[Kt];break;case 22:case 65:case 93:this.$=Jt[Kt-1];break;case 25:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_assign",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 27:this.$=fr.createNode(pr(_r[Kt-4]),"node_op","op_conditional",Jt[Kt-4],Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 29:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_or",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 31:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_and",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 33:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_equ",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 34:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_neq",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 35:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_approx",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 37:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_lot",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 38:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_grt",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 39:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_loe",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 40:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_gre",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 42:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_add",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 43:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_sub",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 45:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_mul",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 46:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_div",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 47:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_mod",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 49:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_exp",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 51:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_not",Jt[Kt]),this.$.isMath=!1;break;case 53:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_neg",Jt[Kt]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=Jt[Kt],this.$.isMath=!1;break;case 59:case 91:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_property",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 60:case 90:this.$=fr.createNode(pr(_r[Kt-3]),"node_op","op_extvalue",Jt[Kt-3],Jt[Kt-1]),this.$.isMath=!0;break;case 61:this.$=fr.createNode(pr(_r[Kt]),"node_var",Jt[Kt]);break;case 69:this.$=Jt[Kt],this.$.isMath=!0;break;case 70:this.$=fr.createNode(pr(_r[Kt]),"node_const",null);break;case 71:this.$=fr.createNode(pr(_r[Kt]),"node_const_bool",!0);break;case 72:this.$=fr.createNode(pr(_r[Kt]),"node_const_bool",!1);break;case 73:this.$=fr.createNode(pr(_r[Kt]),"node_str",Jt[Kt].substring(1,Jt[Kt].length-1));break;case 74:this.$=fr.createNode(pr(_r[Kt]),"node_const",parseFloat(Jt[Kt]));break;case 75:this.$=fr.createNode(pr(_r[Kt]),"node_const",NaN);break;case 76:this.$=fr.createNode(pr(_r[Kt]),"node_const",1/0);break;case 77:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_array",[]);break;case 78:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_array",Jt[Kt-1]);break;case 79:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_emptyobject",{});break;case 80:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_proplst_val",Jt[Kt-1]);break;case 82:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_proplst",Jt[Kt-2],Jt[Kt]);break;case 83:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_prop",Jt[Kt-2],Jt[Kt]);break;case 87:case 89:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_execfun",Jt[Kt-1],Jt[Kt]),this.$.isMath=!0;break;case 88:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_execfun",Jt[Kt-2],Jt[Kt-1],Jt[Kt],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 103:this.$=[Jt[Kt]];break;case 95:case 99:case 104:this.$=Jt[Kt-2].concat(Jt[Kt]);break;case 96:this.$=fr.createNode(pr(_r[Kt]),"node_var",Jt[Kt]),this.$.isMath=!0;break;case 100:this.$=fr.createNode(pr(_r[Kt-3]),"node_op","op_function",[],Jt[Kt]),this.$.isMath=!1;break;case 101:this.$=fr.createNode(pr(_r[Kt-4]),"node_op","op_function",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 102:this.$=fr.createNode(pr(_r[Kt-5]),"node_op","op_map",Jt[Kt-3],Jt[Kt])}},table:[_e([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],rt,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:it,8:nt,9:20,11:4,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{1:[2,1]},_e(Rt,[2,13]),_e(It,[2,15]),_e(It,[2,16]),_e(It,[2,17]),_e(It,[2,18]),_e(It,[2,19]),_e(It,[2,20]),_e(It,[2,21]),_e([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],rt,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:it,8:nt,9:20,11:65,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{20:[1,66]},{20:[1,67]},{8:nt,9:69,16:[1,68],20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{16:[1,70]},_e(It,[2,11]),_e(Ot,[2,23]),_e(Ot,[2,24]),_e([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],Bt,{32:[1,71],57:Nt}),_e([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),_e(zt,[2,54],{88:77,8:Dt,64:[1,75],65:[1,76]}),_e(zt,[2,55],{88:79,8:Dt,64:[1,81],65:[1,80]}),_e(Ft,[2,28],{39:Ut}),_e(Ot,[2,56]),_e(Ot,[2,57]),_e(Ot,[2,58]),_e($t,[2,30],{41:Vt,42:Zt,43:qt}),_e(Ot,[2,61]),_e(Ot,[2,62]),_e(Ot,[2,63]),_e(Ot,[2,64]),{8:nt,9:86,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:[1,87]},{8:[1,88]},_e(sr,[2,32],{45:er,46:ir,47:ur,48:ar}),_e(Ot,[2,66]),_e(Ot,[2,67]),_e(Ot,[2,68]),_e(Ot,[2,69]),{20:lr,72:98,73:99,77:vt,78:_t,79:Ct,80:St,83:[1,93],84:94,85:95,87:96},{8:nt,20:ut,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,81:101,82:Et,91:Tt,93:Mt},_e(gr,[2,36],{50:Yt,51:nr}),_e(Ot,[2,70]),_e(Ot,[2,71]),_e(Ot,[2,72]),_e(Ot,[2,73]),_e(Ot,[2,74]),_e(Ot,[2,75]),_e(Ot,[2,76]),_e(mr,[2,41],{53:Sr,54:Er,55:Nr}),_e(Ot,[2,44]),_e(Ot,[2,50]),{8:nt,20:ut,31:109,50:ft,51:gt,52:108,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:110,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:111,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{6:6,7:it,8:nt,9:20,11:4,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:113,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:114,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:115,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{14:[1,116]},_e(It,[2,7]),_e(It,[2,8]),_e(It,[2,9]),{16:[1,117]},_e(It,[2,22]),{8:nt,20:ut,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:119,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,36:121,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{20:[1,122]},{8:nt,9:123,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,87],{89:124,90:125,68:127,20:wr,82:Et}),{8:nt,10:[1,128],20:ut,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,81:129,82:Et,91:Tt,93:Mt},_e(Ot,[2,89]),{8:nt,9:130,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{20:[1,131]},{8:nt,20:ut,31:109,38:132,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,40:133,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,40:134,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,40:135,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{10:[1,136]},{10:[1,137],20:kr,92:138},{20:kr,92:140},{8:nt,20:ut,31:109,44:141,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,44:142,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,44:143,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,44:144,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,79]),{83:[1,145],86:[1,146]},_e(Ur,[2,81]),{35:[1,147]},{35:[2,84]},{35:[2,85]},{35:[2,86]},_e(Ot,[2,77]),{66:[1,148],86:Or},_e(Xr,[2,98]),{8:nt,20:ut,31:109,49:150,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,49:151,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:152,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:153,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:154,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,51]),_e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],Bt,{57:Nt}),_e(Ot,[2,52]),_e(Ot,[2,53]),_e([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,155]},{10:[1,156]},{16:[1,157]},{8:[1,158]},_e(It,[2,10]),_e(Ot,[2,25]),_e(Ot,[2,49]),{35:[1,159]},_e(Ft,[2,29],{39:Ut}),_e(Ot,[2,59]),{66:[1,160]},_e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,161]}),_e(Ot,[2,94]),_e(Ot,[2,96]),_e(Ot,[2,97]),_e(Qt,[2,92]),{10:[1,162],86:Or},{66:[1,163]},_e(Ot,[2,91]),_e($t,[2,31],{41:Vt,42:Zt,43:qt}),_e(sr,[2,33],{45:er,46:ir,47:ur,48:ar}),_e(sr,[2,34],{45:er,46:ir,47:ur,48:ar}),_e(sr,[2,35],{45:er,46:ir,47:ur,48:ar}),_e(Ot,[2,65]),{25:164,26:pt},{10:[1,165],86:Xt},_e(xr,[2,103]),{10:[1,167],86:Xt},_e(gr,[2,37],{50:Yt,51:nr}),_e(gr,[2,38],{50:Yt,51:nr}),_e(gr,[2,39],{50:Yt,51:nr}),_e(gr,[2,40],{50:Yt,51:nr}),_e(Ot,[2,80]),{20:lr,72:98,73:99,77:vt,78:_t,79:Ct,80:St,85:168,87:96},{8:nt,20:ut,29:169,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,78]),{8:nt,20:ut,29:170,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(mr,[2,42],{53:Sr,54:Er,55:Nr}),_e(mr,[2,43],{53:Sr,54:Er,55:Nr}),_e(Ot,[2,45]),_e(Ot,[2,46]),_e(Ot,[2,47]),{6:6,7:it,8:nt,9:20,11:171,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{6:6,7:it,8:nt,9:20,11:172,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:173,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:174,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,29:175,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,60]),{20:wr,68:127,82:Et,90:176},_e(Qt,[2,93]),_e(Ot,[2,90]),_e(Ot,[2,100]),{25:177,26:pt},{20:[1,178]},{94:[1,179]},_e(Ur,[2,82]),_e(Ur,[2,83]),_e(Xr,[2,99]),_e(Rt,[2,2],{12:[1,180]}),_e(It,[2,4]),{16:[1,181]},{10:[1,182]},_e(Ot,[2,27]),_e(Ot,[2,95]),_e(Ot,[2,101]),_e(xr,[2,104]),{8:nt,9:183,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{6:6,7:it,8:nt,9:20,11:184,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:185,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{16:[1,186]},_e(Ot,[2,102]),_e(It,[2,3]),{10:[1,187]},_e(It,[2,6]),{6:6,7:it,8:nt,9:20,11:188,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(It,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(hr,Cr){if(!Cr.recoverable){var tr=new Error(hr);throw tr.hash=Cr,tr}this.trace(hr)},parse:function(hr){var Cr=this,tr=[0],Ar=[null],yr=[],Jt=this.table,_r="",Kt=0,Qr=0,br=0,Rr=yr.slice.call(arguments,1),Tr=Object.create(this.lexer),Vr={yy:{}};for(var Wr in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Wr)&&(Vr.yy[Wr]=this.yy[Wr]);Tr.setInput(hr,Vr.yy),Vr.yy.lexer=Tr,Vr.yy.parser=this,Tr.yylloc===void 0&&(Tr.yylloc={});var pn=Tr.yylloc;yr.push(pn);var En=Tr.options&&Tr.options.ranges;typeof Vr.yy.parseError=="function"?this.parseError=Vr.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var rn,Cn,vn,an,yn,Gn,Pn,Sn,In,jn=function(){var Nn;return Nn=Tr.lex()||1,typeof Nn!="number"&&(Nn=Cr.symbols_[Nn]||Nn),Nn},_n={};;){if(vn=tr[tr.length-1],this.defaultActions[vn]?an=this.defaultActions[vn]:(rn!=null||(rn=jn()),an=Jt[vn]&&Jt[vn][rn]),an===void 0||!an.length||!an[0]){var nn="";In=[];for(Gn in Jt[vn])this.terminals_[Gn]&&Gn>2&&In.push("'"+this.terminals_[Gn]+"'");nn=Tr.showPosition?"Parse error on line "+(Kt+1)+`:
`+Tr.showPosition()+`
Expecting `+In.join(", ")+", got '"+(this.terminals_[rn]||rn)+"'":"Parse error on line "+(Kt+1)+": Unexpected "+(rn==1?"end of input":"'"+(this.terminals_[rn]||rn)+"'"),this.parseError(nn,{text:Tr.match,token:this.terminals_[rn]||rn,line:Tr.yylineno,loc:pn,expected:In})}if(an[0]instanceof Array&&an.length>1)throw new Error("Parse Error: multiple actions possible at state: "+vn+", token: "+rn);switch(an[0]){case 1:tr.push(rn),Ar.push(Tr.yytext),yr.push(Tr.yylloc),tr.push(an[1]),rn=null,Cn?(rn=Cn,Cn=null):(Qr=Tr.yyleng,_r=Tr.yytext,Kt=Tr.yylineno,pn=Tr.yylloc,br>0);break;case 2:if(Pn=this.productions_[an[1]][1],_n.$=Ar[Ar.length-Pn],_n._$={first_line:yr[yr.length-(Pn||1)].first_line,last_line:yr[yr.length-1].last_line,first_column:yr[yr.length-(Pn||1)].first_column,last_column:yr[yr.length-1].last_column},En&&(_n._$.range=[yr[yr.length-(Pn||1)].range[0],yr[yr.length-1].range[1]]),(yn=this.performAction.apply(_n,[_r,Qr,Kt,Vr.yy,an[1],Ar,yr].concat(Rr)))!==void 0)return yn;Pn&&(tr=tr.slice(0,-1*Pn*2),Ar=Ar.slice(0,-1*Pn),yr=yr.slice(0,-1*Pn)),tr.push(this.productions_[an[1]][0]),Ar.push(_n.$),yr.push(_n._$),Sn=Jt[tr[tr.length-2]][tr[tr.length-1]],tr.push(Sn);break;case 3:return!0}}return!0}},fr={node:function(hr,Cr,tr){return{type:hr,value:Cr,children:tr}},createNode:function(hr,Cr,tr,Ar){var yr,Jt=this.node(Cr,tr,[]);for(yr=3;yr<arguments.length;yr++)Jt.children.push(arguments[yr]);return Jt.line=hr[0],Jt.col=hr[1],Jt.eline=hr[2],Jt.ecol=hr[3],Jt}},pr=function(hr){return[hr.first_line,hr.first_column,hr.last_line,hr.last_column]},Hr=function(){return{EOF:1,parseError:function(hr,Cr){if(!this.yy.parser)throw new Error(hr);this.yy.parser.parseError(hr,Cr)},setInput:function(hr,Cr){return this.yy=Cr||this.yy||{},this._input=hr,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var hr=this._input[0];return this.yytext+=hr,this.yyleng++,this.offset++,this.match+=hr,this.matched+=hr,hr.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),hr},unput:function(hr){var Cr=hr.length,tr=hr.split(/(?:\r\n?|\n)/g);this._input=hr+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Cr),this.offset-=Cr;var Ar=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),tr.length-1&&(this.yylineno-=tr.length-1);var yr=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:tr?(tr.length===Ar.length?this.yylloc.first_column:0)+Ar[Ar.length-tr.length].length-tr[0].length:this.yylloc.first_column-Cr},this.options.ranges&&(this.yylloc.range=[yr[0],yr[0]+this.yyleng-Cr]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(hr){this.unput(this.match.slice(hr))},pastInput:function(){var hr=this.matched.substr(0,this.matched.length-this.match.length);return(hr.length>20?"...":"")+hr.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var hr=this.match;return hr.length<20&&(hr+=this._input.substr(0,20-hr.length)),(hr.substr(0,20)+(hr.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var hr=this.pastInput(),Cr=new Array(hr.length+1).join("-");return hr+this.upcomingInput()+`
`+Cr+"^"},test_match:function(hr,Cr){var tr,Ar,yr;if(this.options.backtrack_lexer&&(yr={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(yr.yylloc.range=this.yylloc.range.slice(0))),Ar=hr[0].match(/(?:\r\n?|\n).*/g),Ar&&(this.yylineno+=Ar.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Ar?Ar[Ar.length-1].length-Ar[Ar.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+hr[0].length},this.yytext+=hr[0],this.match+=hr[0],this.matches=hr,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(hr[0].length),this.matched+=hr[0],tr=this.performAction.call(this,this.yy,this,Cr,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),tr)return tr;if(this._backtrack){for(var Jt in yr)this[Jt]=yr[Jt];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var hr,Cr,tr,Ar;this._more||(this.yytext="",this.match="");for(var yr=this._currentRules(),Jt=0;Jt<yr.length;Jt++)if((tr=this._input.match(this.rules[yr[Jt]]))&&(!Cr||tr[0].length>Cr[0].length)){if(Cr=tr,Ar=Jt,this.options.backtrack_lexer){if((hr=this.test_match(tr,yr[Jt]))!==!1)return hr;if(this._backtrack){Cr=!1;continue}return!1}if(!this.options.flex)break}return Cr?(hr=this.test_match(Cr,yr[Ar]))!==!1&&hr:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var hr=this.next();return hr||this.lex()},begin:function(hr){this.conditionStack.push(hr)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(hr){return hr=this.conditionStack.length-1-Math.abs(hr||0),hr>=0?this.conditionStack[hr]:"INITIAL"},pushState:function(hr){this.begin(hr)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(hr,Cr,tr,Ar){switch(tr){case 0:break;case 1:case 2:return 78;case 3:case 4:return 77;case 5:case 6:break;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:return 94;case 22:return 82;case 23:return 83;case 24:return 26;case 25:return 27;case 26:return 16;case 27:return"#";case 28:return 34;case 29:return 35;case 30:return 79;case 31:return 64;case 32:return 65;case 33:return 66;case 34:return 8;case 35:return 10;case 36:return 58;case 37:return 57;case 38:return 53;case 39:return 54;case 40:return 55;case 41:return 50;case 42:return 51;case 43:return 47;case 44:return 45;case 45:return 48;case 46:return 46;case 47:return 41;case 48:return 43;case 49:return 42;case 50:return 39;case 51:return 37;case 52:return 32;case 53:return 86;case 54:return 5;case 55:return 20;case 56:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],inclusive:!0}}}}();return Lr.lexer=Hr,tt.prototype=Lr,Lr.Parser=tt,new tt}();return require!==void 0&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(tt){tt[1]||(console.log("Usage: "+tt[0]+" FILE"),process.exit(1));var _e=require("fs").readFileSync(require("path").normalize(tt[1]),"utf8");return exports.parser.parse(_e)},require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode}),define("base/point",["jxg","options","math/math","math/geometry","math/numerics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation","base/coordselement"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht){return tt.Point=function(dt,pt,ft){this.constructor(dt,ft,at.OBJECT_TYPE_POINT,at.OBJECT_CLASS_POINT),this.element=this.board.select(ft.anchor),this.coordsConstructor(pt),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createLabel()},tt.Point.prototype=new lt,ct.copyPrototypeMethods(tt.Point,ht,"coordsConstructor"),tt.extend(tt.Point.prototype,{hasPoint:function(dt,pt){var ft,gt=this.coords.scrCoords,mt=ct.evaluate(this.visProp.sizeunit);return ft=parseFloat(ct.evaluate(this.visProp.size)),mt==="user"&&(ft*=Math.sqrt(this.board.unitX*this.board.unitY)),ft+=.5*parseFloat(ct.evaluate(this.visProp.strokewidth)),ft<this.board.options.precision.hasPoint&&(ft=this.board.options.precision.hasPoint),Math.abs(gt[1]-dt)<ft+2&&Math.abs(gt[2]-pt)<ft+2},update:function(dt){return this.needsUpdate?(this.updateCoords(dt),ct.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(){var dt,pt;if(this.transformations.length===0||this.baseElement===null)return this;for(dt=this===this.baseElement?this.transformations[0].apply(this.baseElement,"self"):this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(at.COORDS_BY_USER,dt),pt=1;pt<this.transformations.length;pt++)this.coords.setCoordinates(at.COORDS_BY_USER,this.transformations[pt].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(dt,pt,ft,gt){var mt;dt=this.board.select(dt),pt=this.board.select(pt),mt=it.intersectionFunction(this.board,dt,pt,ft,gt,ct.evaluate(this.visProp.alwaysintersect)),this.addConstraint([mt]);try{dt.addChild(this),pt.addChild(this)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof dt+"' and '"+typeof pt+"'.")}this.type=at.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[dt.id,pt.id,ft,gt],this.generatePolynomial=function(){var At=dt.generatePolynomial(this),yt=pt.generatePolynomial(this);return At.length===0||yt.length===0?[]:[At[0],yt[0]]},this.prepareUpdate().update()},setStyle:function(dt){var pt=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"],ft=[2,3,4,1,2,3,4,2,3,4,2,3,4];return this.visProp.face=pt[dt],this.visProp.size=ft[dt],this.board.renderer.changePointStyle(this),this},normalizeFace:function(dt){return tt.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),_e.normalizePointFace(dt)},face:function(dt){tt.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:dt})},size:function(dt){tt.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:dt})},cloneToBackground:function(){var dt={};return dt.id=this.id+"T"+this.numTraces,this.numTraces+=1,dt.coords=this.coords,dt.visProp=ct.deepCopy(this.visProp,this.visProp.traceattributes,!0),dt.visProp.layer=this.board.options.layer.trace,dt.elementClass=at.OBJECT_CLASS_POINT,dt.board=this.board,ct.clearVisPropOld(dt),dt.visPropCalc={visible:ct.evaluate(dt.visProp.visible)},this.board.renderer.drawPoint(dt),this.traces[dt.id]=dt.rendNode,this}}),tt.createPoint=function(dt,pt,ft){var gt,mt;if(mt=ct.copyAttributes(ft,dt.options,"point"),!(gt=ht.create(tt.Point,dt,pt,mt)))throw new Error("JSXGraph: Can't create point with parent types '"+typeof pt[0]+"' and '"+typeof pt[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return gt},tt.createGlider=function(dt,pt,ft){var gt,mt,At=ct.copyAttributes(ft,dt.options,"glider");return mt=pt.length===1?[0,0]:pt.slice(0,2),gt=dt.create("point",mt,At),gt.makeGlider(pt[pt.length-1]),gt},tt.createIntersectionPoint=function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt=ct.copyAttributes(ft,dt.options,"intersection");pt.push(0,0),mt=dt.select(pt[0]),At=dt.select(pt[1]),bt=pt[2]||0,xt=pt[3]||0,gt=dt.create("point",[0,0,0],vt),yt=it.intersectionFunction(dt,mt,At,bt,xt,gt.visProp.alwaysintersect),gt.addConstraint([yt]);try{mt.addChild(gt),At.addChild(gt)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof pt[0]+"' and '"+typeof pt[1]+"'.")}return gt.type=at.OBJECT_TYPE_INTERSECTION,gt.elType="intersection",gt.setParents([mt.id,At.id]),gt.intersectionNumbers=[bt,xt],gt.getParents=function(){return this.parents.concat(this.intersectionNumbers)},gt.generatePolynomial=function(){var _t=mt.generatePolynomial(gt),Ct=At.generatePolynomial(gt);return _t.length===0||Ct.length===0?[]:[_t[0],Ct[0]]},gt},tt.createOtherIntersectionPoint=function(dt,pt,ft){var gt,mt,At,yt;if(pt.length!==3||!ct.isPoint(pt[2])||pt[0].elementClass!==at.OBJECT_CLASS_LINE&&pt[0].elementClass!==at.OBJECT_CLASS_CIRCLE||pt[1].elementClass!==at.OBJECT_CLASS_LINE&&pt[1].elementClass!==at.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof pt[0]+"',  '"+typeof pt[1]+"'and  '"+typeof pt[2]+`'.
Possible parent types: [circle|line,circle|line,point]`);return mt=dt.select(pt[0]),At=dt.select(pt[1]),yt=dt.select(pt[2]),gt=dt.create("point",[function(){var bt=it.meet(mt.stdform,At.stdform,0,mt.board);return Math.abs(yt.X()-bt.usrCoords[1])>rt.eps||Math.abs(yt.Y()-bt.usrCoords[2])>rt.eps||Math.abs(yt.Z()-bt.usrCoords[0])>rt.eps?bt:it.meet(mt.stdform,At.stdform,1,mt.board)}],ft),gt.type=at.OBJECT_TYPE_INTERSECTION,gt.elType="otherintersection",gt.setParents([mt.id,At.id,yt]),mt.addChild(gt),At.addChild(gt),gt.generatePolynomial=function(){var bt=mt.generatePolynomial(gt),xt=At.generatePolynomial(gt);return bt.length===0||xt.length===0?[]:[bt[0],xt[0]]},gt},tt.createPolePoint=function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt;if(pt.length>1&&(yt=pt[0].type===at.OBJECT_TYPE_CONIC||pt[0].elementClass===at.OBJECT_CLASS_CIRCLE,bt=pt[1].type===at.OBJECT_TYPE_CONIC||pt[1].elementClass===at.OBJECT_CLASS_CIRCLE,xt=pt[0].elementClass===at.OBJECT_CLASS_LINE,vt=pt[1].elementClass===at.OBJECT_CLASS_LINE),pt.length!==2||!(yt&&vt||xt&&bt))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof pt[0]+"' and '"+typeof pt[1]+`'.
Possible parent type: [conic|circle,line], [line,conic|circle]`);return vt?(mt=dt.select(pt[0]),At=dt.select(pt[1])):(mt=dt.select(pt[1]),At=dt.select(pt[0])),gt=dt.create("point",[function(){var _t=mt.quadraticform,Ct=At.stdform.slice(0,3);return[tt.Math.Numerics.det([Ct,_t[1],_t[2]]),tt.Math.Numerics.det([_t[0],Ct,_t[2]]),tt.Math.Numerics.det([_t[0],_t[1],Ct])]}],ft),gt.elType="polepoint",gt.setParents([mt.id,At.id]),mt.addChild(gt),At.addChild(gt),gt},tt.registerElement("point",tt.createPoint),tt.registerElement("glider",tt.createGlider),tt.registerElement("intersection",tt.createIntersectionPoint),tt.registerElement("otherintersection",tt.createOtherIntersectionPoint),tt.registerElement("polepoint",tt.createPolePoint),{Point:tt.Point,createPoint:tt.createPoint,createGlider:tt.createGlider,createIntersection:tt.createIntersectionPoint,createOtherIntersection:tt.createOtherIntersectionPoint,createPolePoint:tt.createPolePoint}}),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){return tt.Line=function(ut,ht,dt,pt){this.constructor(ut,pt,st.OBJECT_TYPE_LINE,st.OBJECT_CLASS_LINE),this.point1=this.board.select(ht),this.point2=this.board.select(dt),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1.addChild(this),this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=tt.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"})},tt.Line.prototype=new lt,tt.extend(tt.Line.prototype,{hasPoint:function(ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt=[],vt=[1,ut,ht],_t=ot.evaluate(this.visProp.strokewidth);return bt=this.board.options.precision.hasPoint+.5*_t,xt[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,xt[1]=this.stdform[1]/this.board.unitX,xt[2]=this.stdform[2]/-this.board.unitY,dt=rt.distPointLine(vt,xt),!(isNaN(dt)||dt>bt)&&(!(!ot.evaluate(this.visProp.straightfirst)||!ot.evaluate(this.visProp.straightlast))||(ft=this.point1.coords,gt=this.point2.coords,pt=[0,xt[1],xt[2]],pt=_e.crossProduct(pt,vt),pt=_e.crossProduct(pt,xt),pt[1]/=pt[0],pt[2]/=pt[0],pt[0]=1,pt=new at(st.COORDS_BY_SCREEN,pt.slice(1),this.board).usrCoords,mt=ft.distance(st.COORDS_BY_USER,gt),ft=ft.usrCoords.slice(0),gt=gt.usrCoords.slice(0),mt<_e.eps?At=0:(mt===Number.POSITIVE_INFINITY&&(mt=1/_e.eps,Math.abs(gt[0])<_e.eps?(mt/=rt.distance([0,0,0],gt),gt=[1,ft[1]+gt[1]*mt,ft[2]+gt[2]*mt]):(mt/=rt.distance([0,0,0],ft),ft=[1,gt[1]+ft[1]*mt,gt[2]+ft[2]*mt])),yt=1,mt=gt[yt]-ft[yt],Math.abs(mt)<_e.eps&&(yt=2,mt=gt[yt]-ft[yt]),At=(pt[yt]-ft[yt])/mt),!(!ot.evaluate(this.visProp.straightfirst)&&At<0)&&!(!ot.evaluate(this.visProp.straightlast)&&At>1)))},update:function(){var ut;return this.needsUpdate?(this.constrained&&(ot.isFunction(this.funps)?(ut=this.funps())&&ut.length&&ut.length===2&&(this.point1=ut[0],this.point2=ut[1]):(ot.isFunction(this.funp1)&&(ut=this.funp1(),ot.isPoint(ut)?this.point1=ut:ut&&ut.length&&ut.length===2&&this.point1.setPositionDirectly(st.COORDS_BY_USER,ut)),ot.isFunction(this.funp2)&&(ut=this.funp2(),ot.isPoint(ut)?this.point2=ut:ut&&ut.length&&ut.length===2&&this.point2.setPositionDirectly(st.COORDS_BY_USER,ut)))),this.updateSegmentFixedLength(),this.updateStdform(),ot.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var ut,ht,dt,pt,ft,gt,mt,At;return this.hasFixedLength?(ut=this.point1.Dist(this.point2),ht=this.fixedLength(),dt=this.fixedLengthOldCoords[0].distance(st.COORDS_BY_USER,this.point1.coords),pt=this.fixedLengthOldCoords[1].distance(st.COORDS_BY_USER,this.point2.coords),(dt>_e.eps||pt>_e.eps||ut!==ht)&&(ft=this.point1.isDraggable&&this.point1.type!==st.OBJECT_TYPE_GLIDER&&!ot.evaluate(this.point1.visProp.fixed),gt=this.point2.isDraggable&&this.point2.type!==st.OBJECT_TYPE_GLIDER&&!ot.evaluate(this.point2.visProp.fixed),ut>_e.eps?dt>pt&&gt||dt<=pt&&gt&&!ft?(this.point2.setPositionDirectly(st.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*ht/ut,this.point1.Y()+(this.point2.Y()-this.point1.Y())*ht/ut]),this.point2.fullUpdate()):(dt<=pt&&ft||dt>pt&&ft&&!gt)&&(this.point1.setPositionDirectly(st.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*ht/ut,this.point2.Y()+(this.point1.Y()-this.point2.Y())*ht/ut]),this.point1.fullUpdate()):(mt=Math.random()-.5,At=Math.random()-.5,ut=Math.sqrt(mt*mt+At*At),gt?(this.point2.setPositionDirectly(st.COORDS_BY_USER,[this.point1.X()+mt*ht/ut,this.point1.Y()+At*ht/ut]),this.point2.fullUpdate()):ft&&(this.point1.setPositionDirectly(st.COORDS_BY_USER,[this.point2.X()+mt*ht/ut,this.point2.Y()+At*ht/ut]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(st.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(st.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var ut=_e.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=ut[0],this.stdform[1]=ut[1],this.stdform[2]=ut[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&_e.innerProduct(this.stdform,this.stdform,3)>=_e.eps*_e.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(ut){var ht=this.point1.symbolic.x,dt=this.point1.symbolic.y,pt=this.point2.symbolic.x,ft=this.point2.symbolic.y,gt=ut.symbolic.x,mt=ut.symbolic.y;return[["(",dt,")*(",gt,")-(",dt,")*(",pt,")+(",mt,")*(",pt,")-(",ht,")*(",mt,")+(",ht,")*(",ft,")-(",gt,")*(",ft,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=_e.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=_e.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(ut,ht){return this.visProp.straightfirst=ut,this.visProp.straightlast=ht,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new at(st.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(ut){ot.exists(this.label)&&(this.label.relativeCoords=new at(st.COORDS_BY_SCREEN,[ut[0],-ut[1]],this.board))},getLabelAnchor:function(){var ut,ht,dt=0,pt=new at(st.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),ft=new at(st.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),gt=ot.evaluate(this.visProp.straightfirst),mt=ot.evaluate(this.visProp.straightlast);if((gt||mt)&&rt.calcStraight(this,pt,ft,0),pt=pt.scrCoords,ft=ft.scrCoords,!ot.exists(this.label))return new at(st.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(ot.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":pt[1]<=ft[1]?(ut=pt[1],ht=pt[2]):(ut=ft[1],ht=ft[2]);break;case"rt":case"lrt":case"urt":pt[1]>ft[1]?(ut=pt[1],ht=pt[2]):(ut=ft[1],ht=ft[2]);break;default:ut=.5*(pt[1]+ft[1]),ht=.5*(pt[2]+ft[2])}return(gt||mt)&&(ot.exists(this.label)&&(dt=ot.evaluate(this.label.visProp.fontsize)),Math.abs(ut)<_e.eps?ut=dt+0:this.board.canvasWidth+_e.eps>ut&&ut>this.board.canvasWidth-dt-_e.eps&&(ut=this.board.canvasWidth-dt),_e.eps+dt>ht&&ht>-_e.eps?ht=dt:this.board.canvasHeight+_e.eps>ht&&ht>this.board.canvasHeight-dt-_e.eps&&(ht=this.board.canvasHeight-dt)),new at(st.COORDS_BY_SCREEN,[ut,ht],this.board)},cloneToBackground:function(){var ut,ht,dt,pt={};return pt.id=this.id+"T"+this.numTraces,pt.elementClass=st.OBJECT_CLASS_LINE,this.numTraces++,pt.point1=this.point1,pt.point2=this.point2,pt.stdform=this.stdform,pt.board=this.board,pt.visProp=ot.deepCopy(this.visProp,this.visProp.traceattributes,!0),pt.visProp.layer=this.board.options.layer.trace,ot.clearVisPropOld(pt),pt.visPropCalc={visible:ot.evaluate(pt.visProp.visible)},ht=this.getSlope(),ut=this.getRise(),pt.getSlope=function(){return ht},pt.getRise=function(){return ut},dt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(pt),this.board.renderer.enhancedRendering=dt,this.traces[pt.id]=pt.rendNode,this},addTransform:function(ut){var ht,dt=ot.isArray(ut)?ut:[ut],pt=dt.length;for(ht=0;ht<pt;ht++)this.point1.transformations.push(dt[ht]),this.point2.transformations.push(dt[ht]);return this},snapToGrid:function(ut){var ht,dt,pt,ft,gt,mt,At,yt,bt;return ot.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):ot.exists(ut)&&(yt=ot.evaluate(this.visProp.snapsizex),bt=ot.evaluate(this.visProp.snapsizey),ht=new at(st.COORDS_BY_SCREEN,[ut.Xprev,ut.Yprev],this.board),mt=ht.usrCoords[1],At=ht.usrCoords[2],yt<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(gt=this.board.defaultAxes.x.defaultTicks,yt=gt.ticksDelta*(ot.evaluate(gt.visProp.minorticks)+1)),bt<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(gt=this.board.defaultAxes.y.defaultTicks,bt=gt.ticksDelta*(ot.evaluate(gt.visProp.minorticks)+1)),yt>0&&bt>0&&(dt=rt.projectPointToLine({coords:ht},this,this.board),pt=nt.subtract([1,Math.round(mt/yt)*yt,Math.round(At/bt)*bt],dt.usrCoords),ft=this.board.create("transform",pt.slice(1),{type:"translate"}),ft.applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var ut=ot.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(ut),this.point2.handleSnapToPoints(ut)),this},X:function(ut){var ht,dt=this.stdform[2];return ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],ut=2*(ut-.5),(1-Math.abs(ut))*ht-ut*dt},Y:function(ut){var ht,dt=this.stdform[1];return ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],ut=2*(ut-.5),(1-Math.abs(ut))*ht+ut*dt},Z:function(ut){var ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return ut=2*(ut-.5),(1-Math.abs(ut))*ht},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var ut=this.point1.coords.usrCoords,ht=this.point2.coords.usrCoords;return[Math.min(ut[1],ht[1]),Math.max(ut[2],ht[2]),Math.max(ut[1],ht[1]),Math.min(ut[2],ht[2])]},addTicks:function(ut){return ut.id!==""&&ot.exists(ut.id)||(ut.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(ut),this.ticks.push(ut),ut.id},remove:function(){this.removeAllTicks(),lt.prototype.remove.call(this)},removeAllTicks:function(){var ut;for(ut=this.ticks.length;ut>0;ut--)this.removeTicks(this.ticks[ut-1]);this.ticks=[],this.board.update()},removeTicks:function(ut){var ht,dt;for(ot.exists(this.defaultTicks)&&this.defaultTicks===ut&&(this.defaultTicks=null),ht=this.ticks.length;ht>0;ht--)if(this.ticks[ht-1]===ut){if(this.board.removeObject(this.ticks[ht-1]),this.ticks[ht-1].ticks)for(dt=0;dt<this.ticks[ht-1].ticks.length;dt++)ot.exists(this.ticks[ht-1].labels[dt])&&this.board.removeObject(this.ticks[ht-1].labels[dt]);delete this.ticks[ht-1];break}}}),tt.createLine=function(ut,ht,dt){var pt,ft,gt,mt,At,yt,bt,xt=[],vt=!1,_t=!1;if(ht.length===2){if(ot.isArray(ht[0])&&ht[0].length>1)yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=ut.create("point",ht[0],yt);else if(ot.isString(ht[0])||ot.isPoint(ht[0]))gt=ut.select(ht[0]);else if(ot.isFunction(ht[0])&&ot.isPoint(ht[0]()))gt=ht[0](),_t=!0;else if(ot.isFunction(ht[0])&&ht[0]().length&&ht[0]().length>=2)yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=ct.createPoint(ut,ht[0](),yt),_t=!0;else{if(!ot.isObject(ht[0])||!ot.isTransformationOrArray(ht[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);vt=!0,yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=ut.create("point",[ht[0].point1,ht[1]],yt)}if(vt)yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=ut.create("point",[ht[0].point2,ht[1]],yt);else if(ot.isArray(ht[1])&&ht[1].length>1)yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=ut.create("point",ht[1],yt);else if(ot.isString(ht[1])||ot.isPoint(ht[1]))mt=ut.select(ht[1]);else if(ot.isFunction(ht[1])&&ot.isPoint(ht[1]()))mt=ht[1](),_t=!0;else{if(!(ot.isFunction(ht[1])&&ht[1]().length&&ht[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=ct.createPoint(ut,ht[1](),yt),_t=!0}yt=ot.copyAttributes(dt,ut.options,"line"),ft=new tt.Line(ut,gt,mt,yt),_t?(ft.constrained=!0,ft.funp1=ht[0],ft.funp2=ht[1]):vt||(ft.isDraggable=!0),ft.setParents([gt.id,mt.id])}else if(ht.length===3){for(bt=!0,At=0;At<3;At++)if(ot.isNumber(ht[At]))xt[At]=ot.createFunction(ht[At]);else{if(!ot.isFunction(ht[At]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+"' and '"+typeof ht[2]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);xt[At]=ht[At],bt=!1}yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=bt?ut.create("point",[xt[2]()*xt[2]()+xt[1]()*xt[1](),xt[2]()-xt[1]()*xt[0]()+xt[2](),-xt[1]()-xt[2]()*xt[0]()-xt[1]()],yt):ut.create("point",[function(){return .5*(xt[2]()*xt[2]()+xt[1]()*xt[1]())},function(){return .5*(xt[2]()-xt[1]()*xt[0]()+xt[2]())},function(){return .5*(-xt[1]()-xt[2]()*xt[0]()-xt[1]())}],yt),yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=bt?ut.create("point",[xt[2]()*xt[2]()+xt[1]()*xt[1](),-xt[1]()*xt[0]()+xt[2](),-xt[2]()*xt[0]()-xt[1]()],yt):ut.create("point",[function(){return xt[2]()*xt[2]()+xt[1]()*xt[1]()},function(){return-xt[1]()*xt[0]()+xt[2]()},function(){return-xt[2]()*xt[0]()-xt[1]()}],yt),gt.prepareUpdate().update(),mt.prepareUpdate().update(),yt=ot.copyAttributes(dt,ut.options,"line"),ft=new tt.Line(ut,gt,mt,yt),ft.isDraggable=bt,ft.setParents([gt,mt])}else if(ht.length===1&&ot.isFunction(ht[0])&&ht[0]().length===2&&ot.isPoint(ht[0]()[0])&&ot.isPoint(ht[0]()[1]))pt=ht[0](),yt=ot.copyAttributes(dt,ut.options,"line"),ft=new tt.Line(ut,pt[0],pt[1],yt),ft.constrained=!0,ft.funps=ht[0],ft.setParents(pt);else{if(!(ht.length===1&&ot.isFunction(ht[0])&&ht[0]().length===3&&ot.isNumber(ht[0]()[0])&&ot.isNumber(ht[0]()[1])&&ot.isNumber(ht[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);pt=ht[0],yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=ut.create("point",[function(){var Ct=pt();return[.5*(Ct[2]*Ct[2]+Ct[1]*Ct[1]),.5*(Ct[2]-Ct[1]*Ct[0]+Ct[2]),.5*(-Ct[1]-Ct[2]*Ct[0]-Ct[1])]}],yt),yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=ut.create("point",[function(){var Ct=pt();return[Ct[2]*Ct[2]+Ct[1]*Ct[1],-Ct[1]*Ct[0]+Ct[2],-Ct[2]*Ct[0]-Ct[1]]}],yt),yt=ot.copyAttributes(dt,ut.options,"line"),ft=new tt.Line(ut,gt,mt,yt),ft.constrained=!0,ft.funps=ht[0],ft.setParents([gt,mt])}return ft},tt.registerElement("line",tt.createLine),tt.createSegment=function(ut,ht,dt){var pt,ft;if(dt.straightFirst=!1,dt.straightLast=!1,ft=ot.copyAttributes(dt,ut.options,"segment"),pt=ut.create("line",ht.slice(0,2),ft),ht.length===3){if(pt.hasFixedLength=!0,ot.isNumber(ht[2]))pt.fixedLength=function(){return ht[2]};else{if(!ot.isFunction(ht[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof ht[2]+`'.
Possible third parent types: number or function`);pt.fixedLength=ht[2]}pt.getParents=function(){return this.parents.concat(this.fixedLength())},pt.fixedLengthOldCoords=[],pt.fixedLengthOldCoords[0]=new at(st.COORDS_BY_USER,pt.point1.coords.usrCoords.slice(1,3),ut),pt.fixedLengthOldCoords[1]=new at(st.COORDS_BY_USER,pt.point2.coords.usrCoords.slice(1,3),ut)}return pt.elType="segment",pt},tt.registerElement("segment",tt.createSegment),tt.createArrow=function(ut,ht,dt){var pt;return dt.firstArrow=!1,dt.lastArrow=!0,pt=ut.create("line",ht,dt).setStraight(!1,!1),pt.type=st.OBJECT_TYPE_VECTOR,pt.elType="arrow",pt},tt.registerElement("arrow",tt.createArrow),tt.createAxis=function(ut,ht,dt){var pt,ft,gt,mt,At;if(!ot.isArray(ht[0])&&!ot.isPoint(ht[0])||!ot.isArray(ht[1])&&!ot.isPoint(ht[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);pt=ot.copyAttributes(dt,ut.options,"axis"),gt=ut.create("line",ht,pt),gt.type=st.OBJECT_TYPE_AXIS,gt.isDraggable=!1,gt.point1.isDraggable=!1,gt.point2.isDraggable=!1;for(mt in gt.ancestors)gt.ancestors.hasOwnProperty(mt)&&(gt.ancestors[mt].type=st.OBJECT_TYPE_AXISPOINT);return ft=ot.copyAttributes(dt,ut.options,"axis","ticks"),At=ot.exists(ft.ticksdistance)?ft.ticksdistance:ot.isArray(ft.ticks)?ft.ticks:1,gt.defaultTicks=ut.create("ticks",[gt,At],ft),gt.defaultTicks.dump=!1,gt.elType="axis",gt.subs={ticks:gt.defaultTicks},gt.inherits.push(gt.defaultTicks),gt},tt.registerElement("axis",tt.createAxis),tt.createTangent=function(ut,ht,dt){var pt,ft,gt,mt,At,yt,bt;if(ht.length===1)pt=ht[0],ft=pt.slideObject;else{if(ht.length!==2)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);if(ot.isPoint(ht[0]))pt=ht[0],ft=ht[1];else{if(!ot.isPoint(ht[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);ft=ht[0],pt=ht[1]}}if(ft.elementClass===st.OBJECT_CLASS_LINE?(bt=ut.create("line",[ft.point1,ft.point2],dt),bt.glider=pt):ft.elementClass===st.OBJECT_CLASS_CURVE&&ft.type!==st.OBJECT_TYPE_CONIC?ot.evaluate(ft.visProp.curvetype)!=="plot"?(gt=ft.X,mt=ft.Y,bt=ut.create("line",[function(){return-pt.X()*it.D(mt)(pt.position)+pt.Y()*it.D(gt)(pt.position)},function(){return it.D(mt)(pt.position)},function(){return-it.D(gt)(pt.position)}],dt),pt.addChild(bt),bt.glider=pt):(bt=ut.create("line",[function(){var xt,vt,_t=Math.floor(pt.position);return _t===ft.numberPoints-1&&_t--,_t<0?1:(xt=ft.points[_t].usrCoords,vt=ft.points[_t+1].usrCoords,xt[2]*vt[1]-xt[1]*vt[2])},function(){var xt,vt,_t=Math.floor(pt.position);return _t===ft.numberPoints-1&&_t--,_t<0?0:(xt=ft.points[_t].usrCoords,vt=ft.points[_t+1].usrCoords,vt[2]-xt[2])},function(){var xt,vt,_t=Math.floor(pt.position);return _t===ft.numberPoints-1&&_t--,_t<0?0:(xt=ft.points[_t].usrCoords,vt=ft.points[_t+1].usrCoords,xt[1]-vt[1])}],dt),pt.addChild(bt),bt.glider=pt):ft.type===st.OBJECT_TYPE_TURTLE?(bt=ut.create("line",[function(){var xt=Math.floor(pt.position);for(At=0;At<ft.objects.length;At++)if(yt=ft.objects[At],yt.type===st.OBJECT_TYPE_CURVE){if(xt<yt.numberPoints)break;xt-=yt.numberPoints}return xt===yt.numberPoints-1&&xt--,xt<0?1:yt.Y(xt)*yt.X(xt+1)-yt.X(xt)*yt.Y(xt+1)},function(){var xt=Math.floor(pt.position);for(At=0;At<ft.objects.length;At++)if(yt=ft.objects[At],yt.type===st.OBJECT_TYPE_CURVE){if(xt<yt.numberPoints)break;xt-=yt.numberPoints}return xt===yt.numberPoints-1&&xt--,xt<0?0:yt.Y(xt+1)-yt.Y(xt)},function(){var xt=Math.floor(pt.position);for(At=0;At<ft.objects.length;At++)if(yt=ft.objects[At],yt.type===st.OBJECT_TYPE_CURVE){if(xt<yt.numberPoints)break;xt-=yt.numberPoints}return xt===yt.numberPoints-1&&xt--,xt<0?0:yt.X(xt)-yt.X(xt+1)}],dt),pt.addChild(bt),bt.glider=pt):ft.elementClass!==st.OBJECT_CLASS_CIRCLE&&ft.type!==st.OBJECT_TYPE_CONIC||(bt=ut.create("line",[function(){return _e.matVecMult(ft.quadraticform,pt.coords.usrCoords)[0]},function(){return _e.matVecMult(ft.quadraticform,pt.coords.usrCoords)[1]},function(){return _e.matVecMult(ft.quadraticform,pt.coords.usrCoords)[2]}],dt),pt.addChild(bt),bt.glider=pt),!ot.exists(bt))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return bt.elType="tangent",bt.type=st.OBJECT_TYPE_TANGENT,bt.setParents(ht),bt},tt.createRadicalAxis=function(ut,ht,dt){var pt,ft,gt;if(ht.length!==2||ht[0].elementClass!==st.OBJECT_CLASS_CIRCLE||ht[1].elementClass!==st.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent type: [circle,circle]`);return ft=ut.select(ht[0]),gt=ut.select(ht[1]),pt=ut.create("line",[function(){var mt=ft.stdform,At=gt.stdform;return _e.matVecMult(_e.transpose([mt.slice(0,3),At.slice(0,3)]),[At[3],-mt[3]])}],dt),pt.elType="radicalaxis",pt.setParents([ft.id,gt.id]),ft.addChild(pt),gt.addChild(pt),pt},tt.createPolarLine=function(ut,ht,dt){var pt,ft,gt,mt,At,yt,bt;if(ht.length>1&&(mt=ht[0].type===st.OBJECT_TYPE_CONIC||ht[0].elementClass===st.OBJECT_CLASS_CIRCLE,At=ht[1].type===st.OBJECT_TYPE_CONIC||ht[1].elementClass===st.OBJECT_CLASS_CIRCLE,yt=ot.isPoint(ht[0]),bt=ot.isPoint(ht[1])),ht.length!==2||!(mt&&bt||yt&&At))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent type: [conic|circle,point], [point,conic|circle]`);return bt?(ft=ut.select(ht[0]),gt=ut.select(ht[1])):(ft=ut.select(ht[1]),gt=ut.select(ht[0])),pt=ut.create("tangent",[ft,gt],dt),pt.elType="polarline",pt},tt.registerElement("tangent",tt.createTangent),tt.registerElement("polar",tt.createTangent),tt.registerElement("radicalaxis",tt.createRadicalAxis),tt.registerElement("polarline",tt.createPolarLine),{Line:tt.Line,createLine:tt.createLine,createTangent:tt.createTangent,createPolar:tt.createTangent,createSegment:tt.createSegment,createAxis:tt.createAxis,createArrow:tt.createArrow,createRadicalAxis:tt.createRadicalAxis,createPolarLine:tt.createPolarLine}}),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","math/numerics","math/geometry","parser/geonext","utils/type","base/transformation","math/qdt"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht){return tt.Curve=function(dt,pt,ft){this.constructor(dt,ft,_e.OBJECT_TYPE_CURVE,_e.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=ct.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.qdt=null,ct.exists(pt[0])?this.varname=pt[0]:this.varname="x",this.xterm=pt[1],this.yterm=pt[2],this.generateTerm(this.varname,this.xterm,this.yterm,pt[3],pt[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),ct.isString(this.xterm)&&this.notifyParents(this.xterm),ct.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=ct.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},tt.Curve.prototype=new it,tt.extend(tt.Curve.prototype,{minX:function(){var dt;return ct.evaluate(this.visProp.curvetype)==="polar"?0:(dt=new rt(_e.COORDS_BY_SCREEN,[0,0],this.board,!1),dt.usrCoords[1])},maxX:function(){var dt;return ct.evaluate(this.visProp.curvetype)==="polar"?2*Math.PI:(dt=new rt(_e.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board,!1),dt.usrCoords[1])},X:function(dt){return NaN},Y:function(dt){return NaN},Z:function(dt){return 1},hasPoint:function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt=[],It=ct.evaluate(this.visProp.numberpointslow),Ot=(this.maxX()-this.minX())/It,Bt=this.board.options.precision.hasPoint,Nt=1/0;if(mt=new rt(_e.COORDS_BY_SCREEN,[dt,pt],this.board,!1),dt=mt.usrCoords[1],pt=mt.usrCoords[2],Bt+=.5*ct.evaluate(this.visProp.strokewidth),Bt*=Bt,Et=this.board.unitX*this.board.unitX,Tt=this.board.unitY*this.board.unitY,(Mt=ct.evaluate(this.visProp.curvetype))==="parameter"||Mt==="polar")for(this.transformations.length>0&&(this.updateTransformMatrix(),yt=nt.inverse(this.transformMat),bt=nt.matVecMult(yt,[1,dt,pt]),dt=bt[1],pt=bt[2]),xt=0,gt=this.minX();xt<It;xt++){if(vt=this.X(gt,!0),_t=this.Y(gt,!0),(Nt=(dt-vt)*(dt-vt)*Et+(pt-_t)*(pt-_t)*Tt)<=Bt)return!0;gt+=Ot}else if(Mt==="plot"||Mt==="functiongraph"){for((!ct.exists(ft)||ft<0)&&(ft=0),ct.exists(this.qdt)&&ct.evaluate(this.visProp.useqdt)&&this.bezierDegree!==3?(St=this.qdt.query(new rt(_e.COORDS_BY_USER,[dt,pt],this.board)),Ct=St.points,At=Ct.length):(Ct=this.points,At=this.numberPoints-1),xt=ft;xt<At;xt++)if(this.bezierDegree===3?Rt.push(lt.projectCoordsToBeziersegment([1,dt,pt],this,xt)):St?(Ct[xt].prev&&(Rt=lt.projectCoordsToSegment([1,dt,pt],Ct[xt].prev.usrCoords,Ct[xt].usrCoords)),Ct[xt].next&&Ct[xt+1]!==Ct[xt].next&&(Rt=lt.projectCoordsToSegment([1,dt,pt],Ct[xt].usrCoords,Ct[xt].next.usrCoords))):Rt=lt.projectCoordsToSegment([1,dt,pt],Ct[xt].usrCoords,Ct[xt+1].usrCoords),Rt[1]>=0&&Rt[1]<=1&&(dt-Rt[0][1])*(dt-Rt[0][1])*Et+(pt-Rt[0][2])*(pt-Rt[0][2])*Tt<=Bt)return!0;return!1}return Nt<Bt},allocatePoints:function(){var dt,pt;if(pt=this.numberPoints,this.points.length<this.numberPoints)for(dt=this.points.length;dt<pt;dt++)this.points[dt]=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(ct.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.checkReal(),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var dt,pt,ft,gt,mt,At,yt=!1;if(this.updateTransformMatrix(),this.updateDataArray(),pt=this.minX(),ft=this.maxX(),ct.exists(this.dataX))for(this.numberPoints=this.dataX.length,dt=this.numberPoints,this.allocatePoints(),At=0;At<dt;At++)gt=At,ct.exists(this.dataY)?(mt=At,this.points[At].setCoordinates(_e.COORDS_BY_USER,[this.dataX[At],this.dataY[At]],!1)):(mt=this.X(gt),this.points[At].setCoordinates(_e.COORDS_BY_USER,[this.dataX[At],this.Y(mt,yt)],!1)),this.points[At]._t=At,this.updateTransform(this.points[At]),yt=!0;else{if(ct.evaluate(this.visProp.doadvancedplot)?this.updateParametricCurve(pt,ft):ct.evaluate(this.visProp.doadvancedplotold)?this.updateParametricCurveOld(pt,ft):(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.numberPoints=ct.evaluate(this.visProp.numberpointshigh):this.numberPoints=ct.evaluate(this.visProp.numberpointslow),this.allocatePoints(),this.updateParametricCurveNaive(pt,ft,this.numberPoints)),dt=this.numberPoints,ct.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new ht(this.board.getBoundingBox()),At=0;At<this.points.length;At++)this.qdt.insert(this.points[At]),At>0&&(this.points[At].prev=this.points[At-1]),At<dt-1&&(this.points[At].next=this.points[At+1]);for(At=0;At<dt;At++)this.updateTransform(this.points[At])}return ct.evaluate(this.visProp.curvetype)!=="plot"&&ct.evaluate(this.visProp.rdpsmoothing)&&(this.points=at.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),this},updateTransformMatrix:function(){var dt,pt,ft=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],pt=0;pt<ft;pt++)dt=this.transformations[pt],dt.update(),this.transformMat=nt.matMatMult(dt.matrix,this.transformMat);return this},checkReal:function(){var dt,pt,ft=!1,gt=this.numberPoints;for(dt=0;dt<gt;dt++)if(pt=this.points[dt].usrCoords,!isNaN(pt[1])&&!isNaN(pt[2])&&Math.abs(pt[0])>nt.eps){ft=!0;break}this.isReal=ft},updateParametricCurveNaive:function(dt,pt,ft){var gt,mt,At=!1,yt=(pt-dt)/ft;for(gt=0;gt<ft;gt++)mt=dt+gt*yt,this.points[gt].setCoordinates(_e.COORDS_BY_USER,[this.X(mt,At),this.Y(mt,At)],!1),this.points[gt]._t=mt,At=!0;return this},updateParametricCurveOld:function(dt,pt){var ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et=!1,Tt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),Mt=[],Rt=[],It=[],Ot=[],Bt=!1,Nt=0;for(tt.deprecated("Curve.updateParametricCurveOld()"),this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(_t=15,Ct=10,St=10):(_t=21,Ct=.7,St=.7),Ot[0]=pt-dt,ft=1;ft<_t;ft++)Ot[ft]=.5*Ot[ft-1];ft=1,Mt[0]=1,Rt[0]=0,gt=dt,Tt.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,Et),this.Y(gt,Et)],!1),Et=!0,yt=Tt.scrCoords[1],bt=Tt.scrCoords[2],t0=gt,gt=pt,Tt.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,Et),this.Y(gt,Et)],!1),mt=Tt.scrCoords[1],At=Tt.scrCoords[2],It[0]=[mt,At],xt=1,vt=0,this.points=[],this.points[Nt++]=new rt(_e.COORDS_BY_SCREEN,[yt,bt],this.board,!1);do{for(Bt=this.isDistOK(mt-yt,At-bt,Ct,St)||this.isSegmentOutside(yt,bt,mt,At);vt<_t&&(!Bt||vt<6)&&(vt<=7||this.isSegmentDefined(yt,bt,mt,At));)Mt[xt]=ft,Rt[xt]=vt,It[xt]=[mt,At],xt+=1,ft=2*ft-1,vt++,gt=dt+ft*Ot[vt],Tt.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,Et),this.Y(gt,Et)],!1,!0),mt=Tt.scrCoords[1],At=Tt.scrCoords[2],Bt=this.isDistOK(mt-yt,At-bt,Ct,St)||this.isSegmentOutside(yt,bt,mt,At);Nt>1&&function(zt,Dt,Ft){var Ut,$t,Vt=Ft[1]-zt[1],Zt=Ft[2]-zt[2],qt=Dt[0]-zt[1],sr=Dt[1]-zt[2],er=qt*qt+sr*sr;return er>=nt.eps&&(Ut=(Vt*qt+Zt*sr)/er)>0&&(Ut<=1?(Vt-=Ut*qt,Zt-=Ut*sr):(Vt-=qt,Zt-=sr)),$t=Vt*Vt+Zt*Zt,Math.sqrt($t)}(this.points[Nt-2].scrCoords,[mt,At],this.points[Nt-1].scrCoords)<.015&&(Nt-=1),this.points[Nt]=new rt(_e.COORDS_BY_SCREEN,[mt,At],this.board,!1),this.points[Nt]._t=gt,Nt+=1,yt=mt,bt=At,t0=gt,xt-=1,mt=It[xt][0],At=It[xt][1],vt=Rt[xt]+1,ft=2*Mt[xt]}while(xt>0&&Nt<5e5);return this.numberPoints=this.points.length,this},isSegmentOutside:function(dt,pt,ft,gt){return pt<0&&gt<0||pt>this.board.canvasHeight&&gt>this.board.canvasHeight||dt<0&&ft<0||dt>this.board.canvasWidth&&ft>this.board.canvasWidth},isDistOK:function(dt,pt,ft,gt){return Math.abs(dt)<ft&&Math.abs(pt)<gt&&!isNaN(dt+pt)},isSegmentDefined:function(dt,pt,ft,gt){return!(isNaN(dt+pt)&&isNaN(ft+gt))},_insertPoint:function(dt,pt){var ft=!isNaN(this._lastCrds[1]+this._lastCrds[2]),gt=!isNaN(dt.scrCoords[1]+dt.scrCoords[2]),mt=this.board.canvasWidth,At=this.board.canvasHeight;(!(gt=gt&&dt.scrCoords[1]>-500&&dt.scrCoords[2]>-500&&dt.scrCoords[1]<mt+500&&dt.scrCoords[2]<At+500)&&ft||gt&&(!ft||Math.abs(dt.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(dt.scrCoords[2]-this._lastCrds[2])>.7))&&(dt._t=pt,this.points.push(dt),this._lastCrds=dt.copy("scrCoords"))},_intersectWithBorder:function(dt,pt,ft){var gt,mt,At,yt;return ft<=0?(gt=[-pt[0],1,0],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):yt=1/0,yt<pt[3]?(gt=[-pt[3],0,1],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):At=1/0):yt>pt[1]&&(gt=[-pt[1],0,1],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):At=1/0)):(gt=[-pt[2],1,0],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):yt=1/0,yt<pt[3]?(gt=[-pt[3],0,1],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):At=1/0):yt>pt[1]&&(gt=[-pt[1],0,1],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):At=1/0)),[1,At,yt]},_borderCase:function(dt,pt,ft,gt,mt,At,yt){var bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt=null,Ft=!1;if(yt<=1){xt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),_t=0;do{if(isNaN(dt[1]+dt[2])&&!isNaN(ft[1]+ft[2]))Ct=gt,St=At,Et=mt;else if(isNaN(pt[1]+pt[2])&&!isNaN(ft[1]+ft[2]))Ct=mt,St=At,Et=gt;else if(isNaN(ft[1]+ft[2])&&!isNaN(pt[1]+pt[2]))Ct=At,St=mt,Et=mt+(mt-At);else{if(!isNaN(ft[1]+ft[2])||isNaN(dt[1]+dt[2]))return!1;Ct=At,St=gt,Et=gt-(At-gt)}bt=.5*(Ct+St),xt.setCoordinates(_e.COORDS_BY_USER,[this.X(bt,!0),this.Y(bt,!0)],!1),vt=xt.usrCoords,Ft=isNaN(vt[1]+vt[2]),Ft?Ct=bt:(Et=St,St=bt),++_t}while(Ft&&_t<30);if(_t<30&&(Dt=vt.slice(),ft=vt.slice(),St=bt),Mt=this.X(St,!0),It=this.X(Et,!0),Bt=(Mt-It)/(St-Et),Rt=this.Y(St,!0),Ot=this.Y(Et,!0),Nt=(Rt-Ot)/(St-Et),Tt=this.board.getBoundingBox(),Math.sqrt(Bt*Bt+Nt*Nt)>500&&(zt=[Bt*Rt-Nt*Mt,Nt,-Bt],Dt=this._intersectWithBorder(zt,Tt,Mt-It)),Dt!==null)return this._insertPoint(new rt(_e.COORDS_BY_USER,Dt,this.board,!1)),!0}return!1},_triangleDists:function(dt,pt,ft){var gt,mt,At,yt,bt;return gt=[dt[0]*pt[0],.5*(dt[1]+pt[1]),.5*(dt[2]+pt[2])],mt=lt.distance(dt,pt,3),At=lt.distance(dt,ft,3),yt=lt.distance(ft,pt,3),bt=lt.distance(ft,gt,3),[mt,At,yt,bt]},_isUndefined:function(dt,pt,ft,gt){var mt,At,yt;if(!isNaN(dt[1]+dt[2])||!isNaN(ft[1]+ft[2]))return!1;for(yt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),At=0;At<20;++At)if(mt=pt+Math.random()*(gt-pt),yt.setCoordinates(_e.COORDS_BY_USER,[this.X(mt,!0),this.Y(mt,!0)],!1),!isNaN(yt.scrCoords[0]+yt.scrCoords[1]+yt.scrCoords[2]))return!1;return!0},_isOutside:function(dt,pt,ft,gt){var mt=this.board.canvasWidth,At=this.board.canvasHeight;return dt[1]<-500&&ft[1]<-500||dt[2]<-500&&ft[2]<-500||dt[1]>mt+500&&ft[1]>mt+500||dt[2]>At+500&&ft[2]>At+500},_plotRecursive:function(dt,pt,ft,gt,mt,At){var yt,bt,xt,vt,_t,Ct,St=0,Et=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1);if(!(this.numberPoints>65536))return mt<this.nanLevel&&this._isUndefined(dt,pt,ft,gt)?this:mt<this.nanLevel&&this._isOutside(dt,pt,ft,gt)?this:(yt=.5*(pt+gt),Et.setCoordinates(_e.COORDS_BY_USER,[this.X(yt,!0),this.Y(yt,!0)],!1),bt=Et.scrCoords,this._borderCase(dt,ft,bt,pt,gt,yt,mt)?this:(xt=this._triangleDists(dt,ft,bt),vt=mt<this.smoothLevel&&xt[3]<At,_t=mt<this.jumpLevel&&(xt[2]>.99*xt[0]||xt[1]>.99*xt[0]||xt[0]===1/0||xt[1]===1/0||xt[2]===1/0),Ct=mt<this.smoothLevel+2&&xt[0]<.5*(xt[1]+xt[2]),Ct&&(St=0,vt=!1),--mt,_t?this._insertPoint(new rt(_e.COORDS_BY_SCREEN,[NaN,NaN],this.board,!1),yt):mt<=St||vt?this._insertPoint(Et,yt):(this._plotRecursive(dt,pt,bt,yt,mt,At),this._insertPoint(Et,yt),this._plotRecursive(bt,yt,ft,gt,mt,At)),this))},updateParametricCurve:function(dt,pt){var ft,gt,mt,At,yt,bt,xt=!1,vt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),_t=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1);return this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(yt=ct.evaluate(this.visProp.recursiondepthlow)||13,bt=2,this.smoothLevel=5,this.jumpLevel=5):(yt=ct.evaluate(this.visProp.recursiondepthhigh)||17,bt=2,this.smoothLevel=3,this.jumpLevel=3),this.nanLevel=yt-4,this.points=[],ft=dt,vt.setCoordinates(_e.COORDS_BY_USER,[this.X(ft,xt),this.Y(ft,xt)],!1),mt=vt.copy("scrCoords"),xt=!0,gt=pt,_t.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,xt),this.Y(gt,xt)],!1),At=_t.copy("scrCoords"),vt._t=ft,this.points.push(vt),this._lastCrds=vt.copy("scrCoords"),this._plotRecursive(mt,ft,At,gt,yt,bt),_t._t=gt,this.points.push(_t),this.numberPoints=this.points.length,this},updateTransform:function(dt){var pt;return this.transformations.length>0&&(pt=nt.matVecMult(this.transformMat,dt.usrCoords),dt.setCoordinates(_e.COORDS_BY_USER,[pt[1],pt[2]],!1,!0)),dt},addTransform:function(dt){var pt,ft=ct.isArray(dt)?dt:[dt],gt=ft.length;for(pt=0;pt<gt;pt++)this.transformations.push(ft[pt]);return this},interpolationFunctionFromArray:function(dt){var pt="data"+dt;return function(ft,gt){var mt,At,yt,bt,xt=this[pt],vt=xt.length,_t=[];if(isNaN(ft))return NaN;if(ft<0)return ct.isFunction(xt[0])?xt[0]():xt[0];if(this.bezierDegree===3){if(vt/=3,ft>=vt)return ct.isFunction(xt[xt.length-1])?xt[xt.length-1]():xt[xt.length-1];for(mt=3*Math.floor(ft),yt=ft%1,bt=1-yt,At=0;At<4;At++)ct.isFunction(xt[mt+At])?_t[At]=xt[mt+At]():_t[At]=xt[mt+At];return bt*bt*(bt*_t[0]+3*yt*_t[1])+(3*bt*_t[2]+yt*_t[3])*yt*yt}if((mt=ft>vt-2?vt-2:parseInt(Math.floor(ft),10))===ft)return ct.isFunction(xt[mt])?xt[mt]():xt[mt];for(At=0;At<2;At++)ct.isFunction(xt[mt+At])?_t[At]=xt[mt+At]():_t[At]=xt[mt+At];return _t[0]+(_t[1]-_t[0])*(ft-mt)}},generateTerm:function(dt,pt,ft,gt,mt){var At,yt;ct.isArray(pt)?(this.dataX=pt,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray("X"),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=ct.createFunction(pt,this.board,dt),ct.isString(pt)?this.visProp.curvetype="functiongraph":(ct.isFunction(pt)||ct.isNumber(pt))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),ct.isArray(ft)?(this.dataY=ft,this.Y=this.interpolationFunctionFromArray("Y")):this.Y=ct.createFunction(ft,this.board,dt),ct.isFunction(pt)&&ct.isArray(ft)&&(At=ct.createFunction(ft[0],this.board,""),yt=ct.createFunction(ft[1],this.board,""),this.X=function(bt){return pt(bt)*Math.cos(bt)+At()},this.Y=function(bt){return pt(bt)*Math.sin(bt)+yt()},this.visProp.curvetype="polar"),ct.exists(gt)&&(this.minX=ct.createFunction(gt,this.board,"")),ct.exists(mt)&&(this.maxX=ct.createFunction(mt,this.board,""))},notifyParents:function(dt){var pt,ft,gt,mt=!1;gt={xterm:1,yterm:1};for(pt in gt)if(gt.hasOwnProperty(pt)&&this.hasOwnProperty(pt)&&this[pt].origin){mt=!0;for(ft in this[pt].origin.deps)this[pt].origin.deps.hasOwnProperty(ft)&&this[pt].origin.deps[ft].addChild(this)}mt||ot.findDependencies(this,dt,this.board)},getLabelAnchor:function(){var dt,pt,ft,gt=.05*this.board.canvasWidth,mt=.05*this.board.canvasHeight,At=.95*this.board.canvasWidth,yt=.95*this.board.canvasHeight;switch(ct.evaluate(this.visProp.label.position)){case"ulft":pt=gt,ft=mt;break;case"llft":pt=gt,ft=yt;break;case"rt":pt=At,ft=.5*yt;break;case"lrt":pt=At,ft=yt;break;case"urt":pt=At,ft=mt;break;case"top":pt=.5*At,ft=mt;break;case"bot":pt=.5*At,ft=yt;break;default:pt=gt,ft=.5*yt}return dt=new rt(_e.COORDS_BY_SCREEN,[pt,ft],this.board,!1),lt.projectCoordsToCurve(dt.usrCoords[1],dt.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var dt,pt={id:this.id+"T"+this.numTraces,elementClass:_e.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:ct.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return pt.visProp.layer=this.board.options.layer.trace,pt.visProp.curvetype=this.visProp.curvetype,this.numTraces++,ct.clearVisPropOld(pt),pt.visPropCalc={visible:ct.evaluate(pt.visProp.visible)},dt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(pt),this.board.renderer.enhancedRendering=dt,this.traces[pt.id]=pt.rendNode,this},bounds:function(){var dt,pt,ft,gt=1/0,mt=-1/0,At=1/0,yt=-1/0,bt=this.points.length;if(this.bezierDegree===3){for(dt=0;dt<bt;dt++)this.points[dt].X=ct.bind(function(){return this.usrCoords[1]},this.points[dt]),this.points[dt].Y=ct.bind(function(){return this.usrCoords[2]},this.points[dt]);return pt=at.bezier(this.points),ft=pt[3](),gt=at.fminbr(function(xt){return pt[0](xt)},[0,ft]),mt=at.fminbr(function(xt){return-pt[0](xt)},[0,ft]),At=at.fminbr(function(xt){return pt[1](xt)},[0,ft]),yt=at.fminbr(function(xt){return-pt[1](xt)},[0,ft]),gt=pt[0](gt),mt=pt[0](mt),At=pt[1](At),yt=pt[1](yt),[gt,yt,mt,At]}for(dt=0;dt<bt;dt++)gt>this.points[dt].usrCoords[1]&&(gt=this.points[dt].usrCoords[1]),mt<this.points[dt].usrCoords[1]&&(mt=this.points[dt].usrCoords[1]),At>this.points[dt].usrCoords[2]&&(At=this.points[dt].usrCoords[2]),yt<this.points[dt].usrCoords[2]&&(yt=this.points[dt].usrCoords[2]);return[gt,yt,mt,At]},getParents:function(){var dt=[this.xterm,this.yterm,this.minX(),this.maxX()];return this.parents.length!==0&&(dt=this.parents),dt},moveTo:function(dt){var pt,ft=[];return this.points.length>0&&!ct.evaluate(this.visProp.fixed)&&(pt=this.points[0],ft=dt.length===3?[dt[0]-pt.usrCoords[0],dt[1]-pt.usrCoords[1],dt[2]-pt.usrCoords[2]]:[dt[0]-pt.usrCoords[1],dt[1]-pt.usrCoords[2]],this.setPosition(_e.COORDS_BY_USER,ft)),this}}),tt.createCurve=function(dt,pt,ft){var gt,mt,At=ct.copyAttributes(ft,dt.options,"curve");return gt=dt.select(pt[0]),ct.isObject(gt)&&(gt.type===_e.OBJECT_TYPE_CURVE||gt.type===_e.OBJECT_TYPE_ANGLE||gt.type===_e.OBJECT_TYPE_ARC||gt.type===_e.OBJECT_TYPE_CONIC||gt.type===_e.OBJECT_TYPE_SECTOR)&&ct.isTransformationOrArray(pt[1])?(gt.type===_e.OBJECT_TYPE_SECTOR?At=ct.copyAttributes(ft,dt.options,"sector"):gt.type===_e.OBJECT_TYPE_ARC?At=ct.copyAttributes(ft,dt.options,"arc"):gt.type===_e.OBJECT_TYPE_ANGLE?(ct.exists(ft.withLabel)||(ft.withLabel=!1),At=ct.copyAttributes(ft,dt.options,"angle")):At=ct.copyAttributes(ft,dt.options,"curve"),At=ct.copyAttributes(At,dt.options,"curve"),mt=new tt.Curve(dt,["x",[],[]],At),mt.updateDataArray=function(){var yt,bt=gt.numberPoints;for(this.bezierDegree=gt.bezierDegree,this.dataX=[],this.dataY=[],yt=0;yt<bt;yt++)this.dataX.push(gt.points[yt].usrCoords[1]),this.dataY.push(gt.points[yt].usrCoords[2]);return this},mt.addTransform(pt[1]),mt):(At=ct.copyAttributes(ft,dt.options,"curve"),new tt.Curve(dt,["x"].concat(pt),At))},tt.registerElement("curve",tt.createCurve),tt.createFunctiongraph=function(dt,pt,ft){var gt,mt=["x","x"].concat(pt);return gt=ct.copyAttributes(ft,dt.options,"curve"),gt.curvetype="functiongraph",new tt.Curve(dt,mt,gt)},tt.registerElement("functiongraph",tt.createFunctiongraph),tt.registerElement("plot",tt.createFunctiongraph),tt.createSpline=function(dt,pt,ft){var gt,mt;return mt=function(){var At,yt=[],bt=[];return function(xt,vt){var _t,Ct,St;if(!vt){if(yt=[],bt=[],pt.length===2&&ct.isArray(pt[0])&&ct.isArray(pt[1])&&pt[0].length===pt[1].length)for(_t=0;_t<pt[0].length;_t++)ct.isFunction(pt[0][_t])?yt.push(pt[0][_t]()):yt.push(pt[0][_t]),ct.isFunction(pt[1][_t])?bt.push(pt[1][_t]()):bt.push(pt[1][_t]);else for(_t=0;_t<pt.length;_t++)if(ct.isPoint(pt[_t]))yt.push(pt[_t].X()),bt.push(pt[_t].Y());else if(ct.isArray(pt[_t])&&pt[_t].length===2)for(Ct=0;Ct<pt.length;Ct++)ct.isFunction(pt[Ct][0])?yt.push(pt[Ct][0]()):yt.push(pt[Ct][0]),ct.isFunction(pt[Ct][1])?bt.push(pt[Ct][1]()):bt.push(pt[Ct][1]);else ct.isFunction(pt[_t])&&pt[_t]().length===2&&(St=pt[_t](),yt.push(St[0]),bt.push(St[1]));At=at.splineDef(yt,bt)}return at.splineEval(xt,yt,bt,At)}},ft=ct.copyAttributes(ft,dt.options,"curve"),ft.curvetype="functiongraph",gt=new tt.Curve(dt,["x","x",mt()],ft),gt.setParents(pt),gt.elType="spline",gt},tt.registerElement("spline",tt.createSpline),tt.createCardinalSpline=function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt,_t,Ct=`
Possible parent types: [points:array, tau:number|function, type:string]`;if(!ct.exists(pt[0])||!ct.isArray(pt[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+Ct);if(!ct.exists(pt[1])||!ct.isNumber(pt[1])&&!ct.isFunction(pt[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+Ct);if(!ct.exists(pt[2])||!ct.isString(pt[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+Ct);if(ft=ct.copyAttributes(ft,dt.options,"curve"),ft=ct.copyAttributes(ft,dt.options,"cardinalspline"),ft.curvetype="parameter",yt=pt[0],bt=[],!ft.isarrayofcoordinates&&yt.length===2&&ct.isArray(yt[0])&&ct.isArray(yt[1])&&yt[0].length===yt[1].length)for(xt=0;xt<yt[0].length;xt++)bt[xt]=[],ct.isFunction(yt[0][xt])?bt[xt].push(yt[0][xt]()):bt[xt].push(yt[0][xt]),ct.isFunction(yt[1][xt])?bt[xt].push(yt[1][xt]()):bt[xt].push(yt[1][xt]);else for(xt=0;xt<yt.length;xt++)ct.isString(yt[xt])?bt.push(dt.select(yt[xt])):ct.isPoint(yt[xt])?bt.push(yt[xt]):ct.isArray(yt[xt])&&yt[xt].length===2?(bt[xt]=[],ct.isFunction(yt[xt][0])?bt[xt].push(yt[xt][0]()):bt[xt].push(yt[xt][0]),ct.isFunction(yt[xt][1])?bt[xt].push(yt[xt][1]()):bt[xt].push(yt[xt][1])):ct.isFunction(yt[xt])&&yt[xt]().length===2&&bt.push(pt[xt]());if(ft.createpoints===!0)mt=ct.providePoints(dt,bt,ft,"cardinalspline",["points"]);else for(mt=[],xt=0;xt<bt.length;xt++)ct.isPoint(bt[xt])?mt.push(bt[xt]):mt.push(function(St){return{X:function(){return bt[St][0]},Y:function(){return bt[St][1]}}}(xt));for(At=pt[1],pt[2],_t=["x"].concat(at.CardinalSpline(mt,At)),gt=new tt.Curve(dt,_t,ft),vt=mt.length,gt.setParents(mt),xt=0;xt<vt;xt++)ct.isPoint(mt[xt])&&mt[xt].addChild(gt);return gt.elType="cardinalspline",gt},tt.registerElement("cardinalspline",tt.createCardinalSpline),tt.createRiemannsum=function(dt,pt,ft){var gt,mt,At,yt,bt,xt;if(xt=ct.copyAttributes(ft,dt.options,"riemannsum"),xt.curvetype="plot",At=pt[0],gt=ct.createFunction(pt[1],dt,""),!ct.exists(gt))throw new Error(`JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);if(mt=ct.createFunction(pt[2],dt,"",!1),!ct.exists(mt))throw new Error(`JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);return yt=[[0],[0]].concat(pt.slice(3)),bt=dt.create("curve",yt,xt),bt.sum=0,bt.Value=function(){return this.sum},bt.updateDataArray=function(){var vt=at.riemann(At,gt(),mt(),this.minX(),this.maxX());this.dataX=vt[0],this.dataY=vt[1],this.sum=vt[2]},bt},tt.registerElement("riemannsum",tt.createRiemannsum),tt.createTracecurve=function(dt,pt,ft){var gt,mt,At,yt;if(pt.length!==2)throw new Error(`JSXGraph: Can't create trace curve with given parent'
Possible parent types: [glider, point]`);if(mt=dt.select(pt[0]),At=dt.select(pt[1]),mt.type!==_e.OBJECT_TYPE_GLIDER||!ct.isPoint(At))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof pt[0]+"' and '"+typeof pt[1]+`'.
Possible parent types: [glider, point]`);return yt=ct.copyAttributes(ft,dt.options,"tracecurve"),yt.curvetype="plot",gt=dt.create("curve",[[0],[0]],yt),gt.updateDataArray=function(){var bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt=yt.numberpoints,It=mt.position,Ot=mt.slideObject,Bt=Ot.minX(),Nt=Ot.maxX();for(xt=(Nt-Bt)/Rt,this.dataX=[],this.dataY=[],Ot.elementClass!==_e.OBJECT_CLASS_CURVE&&Rt++,bt=0;bt<Rt;bt++){vt=Bt+bt*xt,St=Ot.X(vt)/Ot.Z(vt),Et=Ot.Y(vt)/Ot.Z(vt),mt.setPositionDirectly(_e.COORDS_BY_USER,[St,Et]),Tt=!1;for(_t in this.board.objects)if(this.board.objects.hasOwnProperty(_t)&&(Ct=this.board.objects[_t],Ct===mt&&(Tt=!0),Tt&&Ct.needsRegularUpdate&&(Mt=Ct.visProp.trace,Ct.visProp.trace=!1,Ct.needsUpdate=!0,Ct.update(!0),Ct.visProp.trace=Mt,Ct===At)))break;this.dataX[bt]=At.X(),this.dataY[bt]=At.Y()}mt.position=It,Tt=!1;for(_t in this.board.objects)if(this.board.objects.hasOwnProperty(_t)&&(Ct=this.board.objects[_t],Ct===mt&&(Tt=!0),Tt&&Ct.needsRegularUpdate&&(Mt=Ct.visProp.trace,Ct.visProp.trace=!1,Ct.needsUpdate=!0,Ct.update(!0),Ct.visProp.trace=Mt,Ct===At)))break},gt},tt.registerElement("tracecurve",tt.createTracecurve),tt.createStepfunction=function(dt,pt,ft){var gt,mt;if(pt.length!==2)throw new Error(`JSXGraph: Can't create step function with given parent'
Possible parent types: [array, array|function]`);return mt=ct.copyAttributes(ft,dt.options,"stepfunction"),gt=dt.create("curve",pt,mt),gt.updateDataArray=function(){var At,yt=0,bt=this.xterm.length;if(this.dataX=[],this.dataY=[],bt!==0)for(this.dataX[yt]=this.xterm[0],this.dataY[yt]=this.yterm[0],++yt,At=1;At<bt;++At)this.dataX[yt]=this.xterm[At],this.dataY[yt]=this.dataY[yt-1],++yt,this.dataX[yt]=this.xterm[At],this.dataY[yt]=this.yterm[At],++yt},gt},tt.registerElement("stepfunction",tt.createStepfunction),tt.createDerivative=function(dt,pt,ft){var gt,mt,At,yt,bt;if(pt.length!==1&&pt[0].class!==_e.OBJECT_CLASS_CURVE)throw new Error(`JSXGraph: Can't create derivative curve with given parent'
Possible parent types: [curve]`);return bt=ct.copyAttributes(ft,dt.options,"curve"),mt=pt[0],At=at.D(mt.X),yt=at.D(mt.Y),gt=dt.create("curve",[function(xt){return mt.X(xt)},function(xt){return yt(xt)/At(xt)},mt.minX(),mt.maxX()],bt),gt.setParents(mt),gt},tt.registerElement("derivative",tt.createDerivative),{Curve:tt.Curve,createCurve:tt.createCurve,createFunctiongraph:tt.createFunctiongraph,createPlot:tt.createPlot,createSpline:tt.createSpline,createRiemannsum:tt.createRiemannsum,createTracecurve:tt.createTracecurve,createStepfunction:tt.createStepfunction}}),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type","base/point","base/curve"],function(tt,_e,rt,it,nt,st,at,lt,ot){return tt.createEllipse=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt=[],xt=at.copyAttributes(ht,ct.options,"conic","foci"),vt=at.copyAttributes(ht,ct.options,"conic","center"),_t=at.copyAttributes(ht,ct.options,"conic");for(At=0;At<2;At++)if(ut[At].length>1)bt[At]=ct.create("point",ut[At],xt);else if(at.isPoint(ut[At]))bt[At]=ct.select(ut[At]);else if(at.isFunction(ut[At])&&at.isPoint(ut[At]()))bt[At]=ut[At]();else{if(!at.isString(ut[At]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);bt[At]=ct.select(ut[At])}if(at.isNumber(ut[2]))mt=at.createFunction(ut[2],ct);else if(at.isFunction(ut[2])&&at.isNumber(ut[2]()))mt=ut[2];else{if(at.isPoint(ut[2]))gt=ct.select(ut[2]);else if(ut[2].length>1)gt=ct.create("point",ut[2],xt);else if(at.isFunction(ut[2])&&at.isPoint(ut[2]()))gt=ut[2]();else{if(!at.isString(ut[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);gt=ct.select(ut[2])}mt=function(){return gt.Dist(bt[0])+gt.Dist(bt[1])}}for(at.exists(ut[4])||(ut[4]=2*Math.PI),at.exists(ut[3])||(ut[3]=0),ft=ct.create("point",[function(){return .5*(bt[0].X()+bt[1].X())},function(){return .5*(bt[0].Y()+bt[1].Y())}],vt),pt=ct.create("curve",[function(Ct){return 0},function(Ct){return 0},ut[3],ut[4]],_t),pt.majorAxis=mt,yt=pt.hasPoint,dt=function(Ct,St){var Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt;St||(Et=mt(),Tt=Et*Et,Mt=bt[0].X(),Rt=bt[0].Y(),It=bt[1].X(),Ot=bt[1].Y(),Bt=Mt-It,Nt=Rt-Ot,zt=(Tt-Mt*Mt-Rt*Rt+It*It+Ot*Ot)/(2*Et),pt.quadraticform=[[zt*zt-It*It-Ot*Ot,zt*Bt/Et+It,zt*Nt/Et+Ot],[zt*Bt/Et+It,Bt*Bt/Tt-1,Bt*Nt/Tt],[zt*Nt/Et+Ot,Bt*Nt/Tt,Nt*Nt/Tt-1]])},pt.X=function(Ct,St){var Et=mt(),Tt=bt[1].Dist(bt[0]),Mt=.5*(Tt*Tt-Et*Et)/(Tt*Math.cos(Ct)-Et),Rt=Math.atan2(bt[1].Y()-bt[0].Y(),bt[1].X()-bt[0].X());return St||dt(Ct,St),bt[0].X()+Math.cos(Rt+Ct)*Mt},pt.Y=function(Ct,St){var Et=mt(),Tt=bt[1].Dist(bt[0]),Mt=.5*(Tt*Tt-Et*Et)/(Tt*Math.cos(Ct)-Et),Rt=Math.atan2(bt[1].Y()-bt[0].Y(),bt[1].X()-bt[0].X());return bt[0].Y()+Math.sin(Rt+Ct)*Mt},pt.midpoint=pt.center=ft,pt.type=_e.OBJECT_TYPE_CONIC,pt.subs={center:pt.center},pt.inherits.push(pt.center,bt[0],bt[1]),at.isPoint(gt)&&pt.inherits.push(gt),pt.hasPoint=function(Ct,St){var Et,Tt,Mt,Rt;return at.evaluate(this.visProp.hasinnerpoints)?(Et=bt[0].coords,Tt=bt[1].coords,Mt=this.majorAxis(),Rt=new rt(_e.COORDS_BY_SCREEN,[Ct,St],this.board),Rt.distance(_e.COORDS_BY_USER,Et)+Rt.distance(_e.COORDS_BY_USER,Tt)<=Mt):yt.apply(this,arguments)},ft.addChild(pt),At=0;At<2;At++)at.isPoint(bt[At])&&bt[At].addChild(pt);return at.isPoint(gt)&&gt.addChild(pt),pt.setParents(ut),pt},tt.createHyperbola=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt=[],bt=at.copyAttributes(ht,ct.options,"conic","foci"),xt=at.copyAttributes(ht,ct.options,"conic","center"),vt=at.copyAttributes(ht,ct.options,"conic");for(At=0;At<2;At++)if(ut[At].length>1)yt[At]=ct.create("point",ut[At],bt);else if(at.isPoint(ut[At]))yt[At]=ct.select(ut[At]);else if(at.isFunction(ut[At])&&at.isPoint(ut[At]()))yt[At]=ut[At]();else{if(!at.isString(ut[At]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);yt[At]=ct.select(ut[At])}if(at.isNumber(ut[2]))mt=at.createFunction(ut[2],ct);else if(at.isFunction(ut[2])&&at.isNumber(ut[2]()))mt=ut[2];else{if(at.isPoint(ut[2]))gt=ct.select(ut[2]);else if(ut[2].length>1)gt=ct.create("point",ut[2],bt);else if(at.isFunction(ut[2])&&at.isPoint(ut[2]()))gt=ut[2]();else{if(!at.isString(ut[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);gt=ct.select(ut[2])}mt=function(){return gt.Dist(yt[0])-gt.Dist(yt[1])}}for(at.exists(ut[4])||(ut[4]=1.0001*Math.PI),at.exists(ut[3])||(ut[3]=-1.0001*Math.PI),ft=ct.create("point",[function(){return .5*(yt[0].X()+yt[1].X())},function(){return .5*(yt[0].Y()+yt[1].Y())}],xt),pt=ct.create("curve",[function(_t){return 0},function(_t){return 0},ut[3],ut[4]],vt),pt.majorAxis=mt,dt=function(_t,Ct){var St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt;Ct||(St=mt(),Et=St*St,Tt=yt[0].X(),Mt=yt[0].Y(),Rt=yt[1].X(),It=yt[1].Y(),Ot=Tt-Rt,Bt=Mt-It,Nt=(Et-Tt*Tt-Mt*Mt+Rt*Rt+It*It)/(2*St),pt.quadraticform=[[Nt*Nt-Rt*Rt-It*It,Nt*Ot/St+Rt,Nt*Bt/St+It],[Nt*Ot/St+Rt,Ot*Ot/Et-1,Ot*Bt/Et],[Nt*Bt/St+It,Ot*Bt/Et,Bt*Bt/Et-1]])},pt.X=function(_t,Ct){var St=mt(),Et=yt[1].Dist(yt[0]),Tt=.5*(Et*Et-St*St)/(Et*Math.cos(_t)+St),Mt=Math.atan2(yt[1].Y()-yt[0].Y(),yt[1].X()-yt[0].X());return Ct||dt(_t,Ct),yt[0].X()+Math.cos(Mt+_t)*Tt},pt.Y=function(_t,Ct){var St=mt(),Et=yt[1].Dist(yt[0]),Tt=.5*(Et*Et-St*St)/(Et*Math.cos(_t)+St),Mt=Math.atan2(yt[1].Y()-yt[0].Y(),yt[1].X()-yt[0].X());return yt[0].Y()+Math.sin(Mt+_t)*Tt},pt.midpoint=pt.center=ft,pt.subs={center:pt.center},pt.inherits.push(pt.center,yt[0],yt[1]),at.isPoint(gt)&&pt.inherits.push(gt),pt.type=_e.OBJECT_TYPE_CONIC,ft.addChild(pt),At=0;At<2;At++)at.isPoint(yt[At])&&yt[At].addChild(pt);return at.isPoint(gt)&&gt.addChild(pt),pt.setParents(ut),pt},tt.createParabola=function(ct,ut,ht){var dt,pt,ft,gt=ut[0],mt=ut[1],At=at.copyAttributes(ht,ct.options,"conic","foci"),yt=at.copyAttributes(ht,ct.options,"conic","center"),bt=at.copyAttributes(ht,ct.options,"conic");if(ut[0].length>1)gt=ct.create("point",ut[0],At);else if(at.isPoint(ut[0]))gt=ct.select(ut[0]);else if(at.isFunction(ut[0])&&at.isPoint(ut[0]()))gt=ut[0]();else{if(!at.isString(ut[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,line]`);gt=ct.select(ut[0])}return at.exists(ut[3])||(ut[3]=10),at.exists(ut[2])||(ut[2]=-10),ft=ct.create("point",[function(){return st.projectPointToLine(gt,mt,ct).usrCoords}],yt),pt=ct.create("curve",[function(xt){return 0},function(xt){return 0},ut[2],ut[3]],bt),pt.midpoint=pt.center=ft,pt.subs={center:pt.center},pt.inherits.push(pt.center),dt=function(xt,vt){var _t,Ct,St,Et,Tt,Mt;vt||(_t=mt.stdform[1],Ct=mt.stdform[2],St=mt.stdform[0],Et=_t*_t+Ct*Ct,Tt=gt.X(),Mt=gt.Y(),pt.quadraticform=[[St*St-Et*(Tt*Tt+Mt*Mt),St*_t+Et*Tt,St*Ct+Et*Mt],[St*_t+Et*Tt,-Ct*Ct,_t*Ct],[St*Ct+Et*Mt,_t*Ct,-_t*_t]])},pt.X=function(xt,vt){var _t,Ct,St=mt.getAngle(),Et=st.distPointLine(gt.coords.usrCoords,mt.stdform),Tt=mt.point1.coords.usrCoords,Mt=mt.point2.coords.usrCoords,Rt=gt.coords.usrCoords;return Tt[0]===0?Tt=[1,Mt[1]+mt.stdform[2],Mt[2]-mt.stdform[1]]:Mt[0]===0&&(Mt=[1,Tt[1]+mt.stdform[2],Tt[2]-mt.stdform[1]]),Ct=(Mt[1]-Tt[1])*(Rt[2]-Tt[2])-(Mt[2]-Tt[2])*(Rt[1]-Tt[1])>=0?1:-1,_t=Ct*Et/(1-Math.sin(xt)),vt||dt(xt,vt),gt.X()+Math.cos(xt+St)*_t},pt.Y=function(xt,vt){var _t,Ct,St=mt.getAngle(),Et=st.distPointLine(gt.coords.usrCoords,mt.stdform),Tt=mt.point1.coords.usrCoords,Mt=mt.point2.coords.usrCoords,Rt=gt.coords.usrCoords;return Tt[0]===0?Tt=[1,Mt[1]+mt.stdform[2],Mt[2]-mt.stdform[1]]:Mt[0]===0&&(Mt=[1,Tt[1]+mt.stdform[2],Tt[2]-mt.stdform[1]]),Ct=(Mt[1]-Tt[1])*(Rt[2]-Tt[2])-(Mt[2]-Tt[2])*(Rt[1]-Tt[1])>=0?1:-1,_t=Ct*Et/(1-Math.sin(xt)),gt.Y()+Math.sin(xt+St)*_t},pt.type=_e.OBJECT_TYPE_CONIC,ft.addChild(pt),at.isPoint(gt)&&(gt.addChild(pt),pt.inherits.push(gt)),mt.addChild(pt),pt.setParents(ut),pt},tt.createConic=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt=[[1,0,0],[0,1,0],[0,0,1]],Mt=[[1,0,0],[0,1,0],[0,0,1]],Rt=[],It=[],Ot=at.copyAttributes(ht,ct.options,"conic","point"),Bt=at.copyAttributes(ht,ct.options,"conic","center"),Nt=at.copyAttributes(ht,ct.options,"conic");if(ut.length===5)Et=!0;else{if(ut.length!==6)throw new Error("JSXGraph: Can't create generic Conic with "+ut.length+" parameters.");Et=!1}if(Et)for(Ct=0;Ct<5;Ct++)if(ut[Ct].length>1)Rt[Ct]=ct.create("point",ut[Ct],Ot);else if(at.isPoint(ut[Ct]))Rt[Ct]=ct.select(ut[Ct]);else if(at.isFunction(ut[Ct])&&at.isPoint(ut[Ct]()))Rt[Ct]=ut[Ct]();else{if(!at.isString(ut[Ct]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof ut[Ct]+`'.
Possible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]`);Rt[Ct]=ct.select(ut[Ct])}else St=[[0,0,0],[0,0,0],[0,0,0]],St[0][0]=at.isFunction(ut[2])?function(){return ut[2]()}:function(){return ut[2]},St[0][1]=at.isFunction(ut[4])?function(){return ut[4]()}:function(){return ut[4]},St[0][2]=at.isFunction(ut[5])?function(){return ut[5]()}:function(){return ut[5]},St[1][1]=at.isFunction(ut[0])?function(){return ut[0]()}:function(){return ut[0]},St[1][2]=at.isFunction(ut[3])?function(){return ut[3]()}:function(){return ut[3]},St[2][2]=at.isFunction(ut[1])?function(){return ut[1]()}:function(){return ut[1]};if(mt=function(zt){var Dt,Ft;for(Dt=0;Dt<3;Dt++)for(Ft=Dt;Ft<3;Ft++)zt[Dt][Ft]+=zt[Ft][Dt];for(Dt=0;Dt<3;Dt++)for(Ft=0;Ft<Dt;Ft++)zt[Dt][Ft]=zt[Ft][Dt];return zt},gt=function(zt,Dt){var Ft,Ut,$t=[[0,0,0],[0,0,0],[0,0,0]];for(Ft=0;Ft<3;Ft++)for(Ut=0;Ut<3;Ut++)$t[Ft][Ut]=zt[Ft]*Dt[Ut];return mt($t)},ft=function(zt,Dt,Ft){var Ut,$t,Vt,Zt,qt,sr=[[0,0,0],[0,0,0],[0,0,0]];for(qt=it.matVecMult(Dt,Ft),Vt=it.innerProduct(Ft,qt),qt=it.matVecMult(zt,Ft),Zt=it.innerProduct(Ft,qt),Ut=0;Ut<3;Ut++)for($t=0;$t<3;$t++)sr[Ut][$t]=Vt*zt[Ut][$t]-Zt*Dt[Ut][$t];return sr},pt=ct.create("curve",[function(zt){return 0},function(zt){return 0},0,2*Math.PI],Nt),dt=function(zt,Dt){var Ft,Ut,$t,Vt;if(!Dt){if(Et){for(Ft=0;Ft<5;Ft++)It[Ft]=Rt[Ft].coords.usrCoords;vt=gt(it.crossProduct(It[0],It[1]),it.crossProduct(It[2],It[3])),_t=gt(it.crossProduct(It[0],It[2]),it.crossProduct(It[1],It[3])),Mt=ft(vt,_t,It[4])}else for(Ft=0;Ft<3;Ft++)for(Ut=Ft;Ut<3;Ut++)Mt[Ft][Ut]=St[Ft][Ut](),Ut>Ft&&(Mt[Ut][Ft]=Mt[Ft][Ut]);for(pt.quadraticform=Mt,At=nt.Jacobi(Mt),At[0][0][0]<0&&(At[0][0][0]*=-1,At[0][1][1]*=-1,At[0][2][2]*=-1),Ft=0;Ft<3;Ft++){for($t=0,Ut=0;Ut<3;Ut++)$t+=At[1][Ut][Ft]*At[1][Ut][Ft];$t=Math.sqrt($t)}Tt=At[1],xt=Math.sqrt(Math.abs(At[0][0][0])),yt=Math.sqrt(Math.abs(At[0][1][1])),bt=Math.sqrt(Math.abs(At[0][2][2]))}return At[0][1][1]<=0&&At[0][2][2]<=0?Vt=it.matVecMult(Tt,[1/xt,Math.cos(zt)/yt,Math.sin(zt)/bt]):At[0][1][1]<=0&&At[0][2][2]>0?Vt=it.matVecMult(Tt,[Math.cos(zt)/xt,1/yt,Math.sin(zt)/bt]):At[0][2][2]<0&&(Vt=it.matVecMult(Tt,[Math.sin(zt)/xt,Math.cos(zt)/yt,1/bt])),at.exists(Vt)?(Vt[1]/=Vt[0],Vt[2]/=Vt[0],Vt[0]=1):Vt=[1,NaN,NaN],Vt},pt.X=function(zt,Dt){return dt(zt,Dt)[1]},pt.Y=function(zt,Dt){return dt(zt,Dt)[2]},pt.midpoint=ct.create("point",[function(){var zt=pt.quadraticform;return[zt[1][1]*zt[2][2]-zt[1][2]*zt[1][2],zt[1][2]*zt[0][2]-zt[2][2]*zt[0][1],zt[0][1]*zt[1][2]-zt[1][1]*zt[0][2]]}],Bt),pt.type=_e.OBJECT_TYPE_CONIC,pt.center=pt.midpoint,pt.subs={center:pt.center},pt.inherits.push(pt.center),pt.inherits=pt.inherits.concat(Rt),Et){for(Ct=0;Ct<5;Ct++)at.isPoint(Rt[Ct])&&Rt[Ct].addChild(pt);pt.setParents(ut)}return pt.addChild(pt.center),pt},tt.registerElement("ellipse",tt.createEllipse),tt.registerElement("hyperbola",tt.createHyperbola),tt.registerElement("parabola",tt.createParabola),tt.registerElement("conic",tt.createConic),{createEllipse:tt.createEllipse,createHyperbola:tt.createHyperbola,createParabola:tt.createParabola,createConic:tt.createConic}}),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],function(tt,_e,rt,it,nt,st,at){return tt.Circle=function(lt,ot,ct,ut,ht){this.constructor(lt,ht,it.OBJECT_TYPE_CIRCLE,it.OBJECT_CLASS_CIRCLE),this.method=ot,this.midpoint=this.board.select(ct),this.center=this.board.select(ct),this.point2=null,this.radius=0,this.line=null,this.circle=null,ot==="twoPoints"?(this.point2=lt.select(ut),this.radius=this.Radius()):ot==="pointRadius"?(this.gxtterm=ut,this.updateRadius=at.createFunction(ut,this.board,null,!0),this.updateRadius()):ot==="pointLine"?(this.line=lt.select(ut),this.radius=this.line.point1.coords.distance(it.COORDS_BY_USER,this.line.point2.coords)):ot==="pointCircle"&&(this.circle=lt.select(ut),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),this.center.addChild(this),ot==="pointRadius"?this.notifyParents(ut):ot==="pointLine"?this.line.addChild(this):ot==="pointCircle"?this.circle.addChild(this):ot==="twoPoints"&&this.point2.addChild(this),this.methodMap=at.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},tt.Circle.prototype=new _e,tt.extend(tt.Circle.prototype,{hasPoint:function(lt,ot){var ct,ut,ht,dt=this.board.options.precision.hasPoint,pt=this.center.coords.usrCoords,ft=new rt(it.COORDS_BY_SCREEN,[lt,ot],this.board),gt=this.Radius();return ct=pt[1]-ft.usrCoords[1],ut=pt[2]-ft.usrCoords[2],ht=Math.sqrt(ct*ct+ut*ut),dt+=.5*at.evaluate(this.visProp.strokewidth),dt/=Math.sqrt(this.board.unitX*this.board.unitY),at.evaluate(this.visProp.hasinnerpoints)?ht<gt+dt:Math.abs(ht-gt)<dt},generatePolynomial:function(lt){var ot=this.center.symbolic.x,ct=this.center.symbolic.y,ut=lt.symbolic.x,ht=lt.symbolic.y,dt=this.generateRadiusSquared();return dt===""?[]:["(("+ut+")-("+ot+"))^2 + (("+ht+")-("+ct+"))^2 - ("+dt+")"]},generateRadiusSquared:function(){var lt,ot,ct,ut,ht,dt,pt="";return this.method==="twoPoints"?(lt=this.center.symbolic.x,ot=this.center.symbolic.y,ct=this.point2.symbolic.x,ut=this.point2.symbolic.y,pt="(("+ct+")-("+lt+"))^2 + (("+ut+")-("+ot+"))^2"):this.method==="pointRadius"?at.isNumber(this.radius)&&(pt=(this.radius*this.radius).toString()):this.method==="pointLine"?(ct=this.line.point1.symbolic.x,ut=this.line.point1.symbolic.y,ht=this.line.point2.symbolic.x,dt=this.line.point2.symbolic.y,pt="(("+ct+")-("+ht+"))^2 + (("+ut+")-("+dt+"))^2"):this.method==="pointCircle"&&(pt=this.circle.Radius()),pt},update:function(){return this.needsUpdate&&(at.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.method==="pointLine"?this.radius=this.line.point1.coords.distance(it.COORDS_BY_USER,this.line.point2.coords):this.method==="pointCircle"?this.radius=this.circle.Radius():this.method==="pointRadius"&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform()),this},updateQuadraticform:function(){var lt=this.center,ot=lt.X(),ct=lt.Y(),ut=this.Radius();this.quadraticform=[[ot*ot+ct*ct-ut*ut,-ot,-ct],[-ot,1,0],[-ct,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=at.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(lt){at.isString(lt)&&st.findDependencies(this,lt,this.board)},setRadius:function(lt){return this.updateRadius=at.createFunction(lt,this.board,null,!0),this.board.update(),this},Radius:function(lt){return at.exists(lt)?(this.setRadius(lt),this.Radius()):this.method==="twoPoints"?at.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||at.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):this.method==="pointLine"||this.method==="pointCircle"?this.radius:this.method==="pointRadius"?this.updateRadius():NaN},getRadius:function(){return tt.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var lt,ot,ct=this.Radius(),ut=this.center.coords.usrCoords;switch(at.evaluate(this.visProp.label.position)){case"lft":lt=ut[1]-ct,ot=ut[2];break;case"llft":lt=ut[1]-Math.sqrt(.5)*ct,ot=ut[2]-Math.sqrt(.5)*ct;break;case"rt":lt=ut[1]+ct,ot=ut[2];break;case"lrt":lt=ut[1]+Math.sqrt(.5)*ct,ot=ut[2]-Math.sqrt(.5)*ct;break;case"urt":lt=ut[1]+Math.sqrt(.5)*ct,ot=ut[2]+Math.sqrt(.5)*ct;break;case"top":lt=ut[1],ot=ut[2]+ct;break;case"bot":lt=ut[1],ot=ut[2]-ct;break;default:lt=ut[1]-Math.sqrt(.5)*ct,ot=ut[2]+Math.sqrt(.5)*ct}return new rt(it.COORDS_BY_USER,[lt,ot],this.board)},cloneToBackground:function(){var lt,ot=this.Radius(),ct={id:this.id+"T"+this.numTraces,elementClass:it.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return ot},getRadius:function(){return ot},board:this.board,visProp:at.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return ct.visProp.layer=this.board.options.layer.trace,this.numTraces++,at.clearVisPropOld(ct),ct.visPropCalc={visible:at.evaluate(ct.visProp.visible)},lt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(ct),this.board.renderer.enhancedRendering=lt,this.traces[ct.id]=ct.rendNode,this},addTransform:function(lt){var ot,ct=at.isArray(lt)?lt:[lt],ut=ct.length;for(ot=0;ot<ut;ot++)this.center.transformations.push(ct[ot]),this.method==="twoPoints"&&this.point2.transformations.push(ct[ot]);return this},snapToGrid:function(){var lt=at.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(lt,!0),this.method==="twoPoints"&&this.point2.handleSnapToGrid(lt,!0),this},snapToPoints:function(){var lt=at.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(lt),this.method==="twoPoints"&&this.point2.handleSnapToPoints(lt),this},X:function(lt){return this.Radius()*Math.cos(2*lt*Math.PI)+this.center.coords.usrCoords[1]},Y:function(lt){return this.Radius()*Math.sin(2*lt*Math.PI)+this.center.coords.usrCoords[2]},Z:function(lt){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var lt=this.Radius();return lt*lt*Math.PI},bounds:function(){var lt=this.center.coords.usrCoords,ot=this.Radius();return[lt[1]-ot,lt[2]+ot,lt[1]+ot,lt[2]-ot]},getParents:function(){return this.parents.length===1?this.parents.concat(this.radius):this.parents}}),tt.createCircle=function(lt,ot,ct){var ut,ht,dt,pt,ft;if(ht=[],ft=lt.select(ot[0]),at.isObject(ft)&&ft.elementClass===it.OBJECT_CLASS_CIRCLE&&at.isTransformationOrArray(ot[1]))return pt=at.copyAttributes(ct,lt.options,"circle"),ut=nt.createEllipse(lt,[ft.center,ft.center,function(){return 2*ft.Radius()}],pt),ut.addTransform(ot[1]),ut;for(dt=0;dt<ot.length;dt++)if(at.isPointType(lt,ot[dt])){if(ht=ht.concat(at.providePoints(lt,[ot[dt]],ct,"circle",["center"])),ht[ht.length-1]===!1)throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else ht.push(ot[dt]);if(pt=at.copyAttributes(ct,lt.options,"circle"),ht.length===2&&at.isPoint(ht[0])&&at.isPoint(ht[1]))ut=new tt.Circle(lt,"twoPoints",ht[0],ht[1],pt);else if((at.isNumber(ht[0])||at.isFunction(ht[0])||at.isString(ht[0]))&&at.isPoint(ht[1]))ut=new tt.Circle(lt,"pointRadius",ht[1],ht[0],pt);else if((at.isNumber(ht[1])||at.isFunction(ht[1])||at.isString(ht[1]))&&at.isPoint(ht[0]))ut=new tt.Circle(lt,"pointRadius",ht[0],ht[1],pt);else if(ht[0].elementClass===it.OBJECT_CLASS_CIRCLE&&at.isPoint(ht[1]))ut=new tt.Circle(lt,"pointCircle",ht[1],ht[0],pt);else if(ht[1].elementClass===it.OBJECT_CLASS_CIRCLE&&at.isPoint(ht[0]))ut=new tt.Circle(lt,"pointCircle",ht[0],ht[1],pt);else if(ht[0].elementClass===it.OBJECT_CLASS_LINE&&at.isPoint(ht[1]))ut=new tt.Circle(lt,"pointLine",ht[1],ht[0],pt);else if(ht[1].elementClass===it.OBJECT_CLASS_LINE&&at.isPoint(ht[0]))ut=new tt.Circle(lt,"pointLine",ht[0],ht[1],pt);else{if(!(ot.length===3&&at.isPoint(ht[0])&&at.isPoint(ht[1])&&at.isPoint(ht[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof ot[0]+"' and '"+typeof ot[1]+`'.
Possible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]`);if(!tt.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");ut=tt.elements.circumcircle(lt,ht,pt)}for(ut.isDraggable=!0,ut.setParents(ht),ut.elType="circle",dt=0;dt<ht.length;dt++)at.isPoint(ht[dt])&&ut.inherits.push(ht[dt]);return ut},tt.registerElement("circle",tt.createCircle),{Circle:tt.Circle,createCircle:tt.createCircle}}),define("base/composition",["jxg","utils/type"],function(tt,_e){return tt.Composition=function(rt){var it,nt=this,st=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"];for(it=0;it<st.length;it++)this[st[it]]=function(at){return function(){var lt;for(lt in nt.elements)nt.elements.hasOwnProperty(lt)&&_e.exists(nt.elements[lt][at])&&nt.elements[lt][at].apply(nt.elements[lt],arguments);return nt}}(st[it]);this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"};for(it in rt)rt.hasOwnProperty(it)&&this.add(it,rt[it]);this.dump=!0,this.subs={}},tt.extend(tt.Composition.prototype,{add:function(rt,it){return!(_e.exists(this[rt])||!_e.exists(it))&&(_e.exists(it.id)?this.elements[it.id]=it:this.elements[rt]=it,_e.exists(it.name)&&(this.elementsByName[it.name]=it),it.on("attribute:name",this.nameListener,this),this.objectsList.push(it),this[rt]=it,this.methodMap[rt]=it,!0)},remove:function(rt){var it,nt=!1;for(it in this.elements)if(this.elements.hasOwnProperty(it)&&this.elements[it].id===this[rt].id){nt=!0;break}return nt&&(delete this.elements[this[rt].id],delete this[rt]),nt},nameListener:function(rt,it,nt){delete this.elementsByName[rt],this.elementsByName[it]=nt},select:function(rt){return _e.exists(tt.Board)?tt.Board.prototype.select.call(this,rt):new tt.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var rt;for(rt in this.subs)this.subs.hasOwnProperty(rt)&&this.subs[rt].visProp;return this.attr}}),tt.Composition}),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element","base/line","base/transformation"],function(tt,_e,rt,it,nt,st,at,lt,ot){return tt.Polygon=function(ct,ut,ht){this.constructor(ct,ht,_e.OBJECT_TYPE_POLYGON,_e.OBJECT_CLASS_AREA);var dt,pt,ft,gt,mt=st.copyAttributes(ht,ct.options,"polygon","borders");for(this.withLines=ht.withlines,this.attr_line=mt,this.vertices=[],dt=0;dt<ut.length;dt++)this.vertices[dt]=this.board.select(ut[dt]);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(ft=this.vertices.length-1,gt=0;gt<ft;gt++)dt=(gt+1)%ft,mt.id=mt.ids&&mt.ids[dt],mt.name=mt.names&&mt.names[dt],mt.strokecolor=st.isArray(mt.colors)&&mt.colors[dt%mt.colors.length]||mt.strokecolor,mt.visible=st.exists(ht.borders.visible)?ht.borders.visible:ht.visible,mt.strokecolor===!1&&(mt.strokecolor="none"),pt=ct.create("segment",[this.vertices[dt],this.vertices[dt+1]],mt),pt.dump=!1,this.borders[dt]=pt,pt.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),dt=0;dt<this.vertices.length-1;dt++)this.board.select(this.vertices[dt]).addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=tt.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},tt.Polygon.prototype=new at,tt.extend(tt.Polygon.prototype,{hasPoint:function(ct,ut){var ht,dt,pt,ft=!1;if(st.evaluate(this.visProp.hasinnerpoints)){for(pt=this.vertices.length,ht=0,dt=pt-2;ht<pt-1;dt=ht++)this.vertices[ht].coords.scrCoords[2]>ut!=this.vertices[dt].coords.scrCoords[2]>ut&&ct<(this.vertices[dt].coords.scrCoords[1]-this.vertices[ht].coords.scrCoords[1])*(ut-this.vertices[ht].coords.scrCoords[2])/(this.vertices[dt].coords.scrCoords[2]-this.vertices[ht].coords.scrCoords[2])+this.vertices[ht].coords.scrCoords[1]&&(ft=!ft);if(ft)return!0}for(pt=this.borders.length,ht=0;ht<pt;ht++)if(this.borders[ht].hasPoint(ct,ut)){ft=!0;break}return ft},updateRenderer:function(){var ct,ut;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(ut=this.vertices.length,this.isReal=!0,ct=0;ct<ut;++ct)if(!this.vertices[ct].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var ct,ut,ht,dt,pt;if(this.vertices.length===0)return new rt(_e.COORDS_BY_USER,[1,0,0],this.board);for(ct=this.vertices[0].X(),ut=this.vertices[0].Y(),ht=ct,dt=ut,pt=0;pt<this.vertices.length;pt++)this.vertices[pt].X()<ct&&(ct=this.vertices[pt].X()),this.vertices[pt].X()>ht&&(ht=this.vertices[pt].X()),this.vertices[pt].Y()>ut&&(ut=this.vertices[pt].Y()),this.vertices[pt].Y()<dt&&(dt=this.vertices[pt].Y());return new rt(_e.COORDS_BY_USER,[.5*(ct+ht),.5*(ut+dt)],this.board)},getLabelAnchor:tt.shortcut(tt.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var ct,ut={};return ut.id=this.id+"T"+this.numTraces,this.numTraces++,ut.vertices=this.vertices,ut.visProp=st.deepCopy(this.visProp,this.visProp.traceattributes,!0),ut.visProp.layer=this.board.options.layer.trace,ut.board=this.board,st.clearVisPropOld(ut),ut.visPropCalc={visible:st.evaluate(ut.visProp.visible)},ct=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(ut),this.board.renderer.enhancedRendering=ct,this.traces[ut.id]=ut.rendNode,this},hideElement:function(ct){var ut;if(tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!ct)for(ut=0;ut<this.borders.length;ut++)this.borders[ut].hideElement();this.hasLabel&&st.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(ct){var ut;if(tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!ct)for(ut=0;ut<this.borders.length;ut++)this.borders[ut].showElement().updateRenderer();return st.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(nt.signedPolygon(this.vertices,!0))},Perimeter:function(){var ct,ut=this.vertices.length,ht=0;for(ct=1;ct<ut;++ct)ht+=this.vertices[ct].Dist(this.vertices[ct-1]);return ht},boundingBox:function(){var ct,ut,ht=[0,0,0,0],dt=this.vertices.length-1;if(dt===0)return ht;for(ht[0]=this.vertices[0].X(),ht[2]=ht[0],ht[1]=this.vertices[0].Y(),ht[3]=ht[1],ct=1;ct<dt;++ct)ut=this.vertices[ct].X(),ut<ht[0]?ht[0]=ut:ut>ht[2]&&(ht[2]=ut),ut=this.vertices[ct].Y(),ut>ht[1]?ht[1]=ut:ut<ht[3]&&(ht[3]=ut);return ht},bounds:function(){return this.boundingBox()},remove:function(){var ct;for(ct=0;ct<this.borders.length;ct++)this.board.removeObject(this.borders[ct]);at.prototype.remove.call(this)},findPoint:function(ct){var ut;if(!st.isPoint(ct))return-1;for(ut=0;ut<this.vertices.length;ut++)if(this.vertices[ut].id===ct.id)return ut;return-1},addPoints:function(ct){var ut=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(ut))},insertPoints:function(ct,ut){var ht,dt,pt=[];if(arguments.length===0)return this;if(ct<0||ct>this.vertices.length-2)return this;for(ht=1;ht<arguments.length;ht++)st.isPoint(arguments[ht])&&pt.push(arguments[ht]);if(dt=this.vertices.slice(0,ct+1).concat(pt),this.vertices=dt.concat(this.vertices.slice(ct+1)),this.withLines){for(dt=this.borders.slice(0,ct),this.board.removeObject(this.borders[ct]),ht=0;ht<pt.length;ht++)dt.push(this.board.create("segment",[this.vertices[ct+ht],this.vertices[ct+ht+1]],this.attr_line));dt.push(this.board.create("segment",[this.vertices[ct+pt.length],this.vertices[ct+pt.length+1]],this.attr_line)),this.borders=dt.concat(this.borders.slice(ct+1))}return this.board.update(),this},removePoints:function(ct){var ut,ht,dt,pt=[],ft=[],gt=[],mt=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),ut=0;ut<arguments.length;ut++)dt=arguments[ut],st.isPoint(dt)&&(dt=this.findPoint(dt)),st.isNumber(dt)&&dt>-1&&dt<this.vertices.length&&st.indexOf(gt,dt)===-1&&gt.push(dt);for(ut=0;ut<gt.length;ut++)this.vertices[gt[ut]].removeChild(this);for(gt=gt.sort(),pt=this.vertices.slice(),ft=this.borders.slice(),this.withLines&&mt.push([gt[gt.length-1]]),ut=gt.length-1;ut>-1;ut--)pt[gt[ut]]=-1,this.withLines&&gt[ut]-1>gt[ut-1]&&(mt[mt.length-1][1]=gt[ut],mt.push([gt[ut-1]]));for(this.withLines&&(mt[mt.length-1][1]=gt[0]),this.vertices=[],ut=0;ut<pt.length;ut++)st.isPoint(pt[ut])&&this.vertices.push(pt[ut]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(ut=0;ut<mt.length;ut++){for(ht=mt[ut][1]-1;ht<mt[ut][0]+1;ht++)ht<0?(ht=0,this.board.removeObject(this.borders[ft.length-1]),ft[ft.length-1]=-1):ht>ft.length-1&&(ht=ft.length-1),this.board.removeObject(this.borders[ht]),ft[ht]=-1;mt[ut][1]!==0&&mt[ut][0]!==pt.length-1&&(ft[mt[ut][0]-1]=this.board.create("segment",[pt[Math.max(mt[ut][1]-1,0)],pt[Math.min(mt[ut][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],ut=0;ut<ft.length;ut++)ft[ut]!==-1&&this.borders.push(ft[ut]);mt[0][1]!==this.vertices.length-1&&mt[mt.length-1][1]!==0||this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var ct,ut=at.prototype.getAttributes.call(this);if(this.withLines)for(ut.lines=ut.lines||{},ut.lines.ids=[],ut.lines.colors=[],ct=0;ct<this.borders.length;ct++)ut.lines.ids.push(this.borders[ct].id),ut.lines.colors.push(this.borders[ct].visProp.strokecolor);return ut},snapToGrid:function(){var ct,ut;for(ut=!!st.evaluate(this.visProp.snaptogrid),ct=0;ct<this.vertices.length;ct++)this.vertices[ct].handleSnapToGrid(ut,!0)},setPositionDirectly:function(ct,ut,ht){var dt,pt,ft,gt,mt=new rt(ct,ut,this.board),At=new rt(ct,ht,this.board);for(gt=this.vertices.length-1,ft=0;ft<gt;ft++)if(!this.vertices[ft].draggable())return this;return dt=it.subtract(mt.usrCoords,At.usrCoords),pt=this.board.create("transform",dt.slice(1),{type:"translate"}),pt.applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(ct){var ut,ht,dt,pt,ft,gt,mt,At=tt.Math.Geometry.sortVertices(this.vertices),yt=tt.Math.Geometry.sortVertices(ct.vertices),bt=At.length-1,xt=yt.length-1,vt=[],_t=function(Ct,St,Et){return(St[1]-Ct[1])*(Et[2]-Ct[2])-(St[2]-Ct[2])*(Et[1]-Ct[1])>=0};for(dt=0;dt<xt;dt++)vt.push(yt[dt]);for(dt=0;dt<bt;dt++)for(ht=vt.slice(0),ut=ht.length,vt=[],ft=ht[ut-1],pt=0;pt<ut;pt++)gt=ht[pt],_t(At[dt],At[dt+1],gt)?(_t(At[dt],At[dt+1],ft)||(mt=tt.Math.Geometry.meetSegmentSegment(ft,gt,At[dt],At[dt+1]),mt[0][1]/=mt[0][0],mt[0][2]/=mt[0][0],mt[0][0]=1,vt.push(mt[0])),vt.push(gt)):_t(At[dt],At[dt+1],ft)&&(mt=tt.Math.Geometry.meetSegmentSegment(ft,gt,At[dt],At[dt+1]),mt[0][1]/=mt[0][0],mt[0][2]/=mt[0][0],mt[0][0]=1,vt.push(mt[0])),ft=gt;return vt},intersect:function(ct){return this.sutherlandHodgman(ct)}}),tt.createPolygon=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt=[],bt=!1;if(mt=st.copyAttributes(ht,ct.options,"polygon"),gt=ct.select(ut[0]),st.isObject(gt)&&gt.type===_e.OBJECT_TYPE_POLYGON&&st.isTransformationOrArray(ut[1]))for(bt=!0,ft=gt.vertices.length-1,At=st.copyAttributes(ht,ct.options,"polygon","vertices"),pt=0;pt<ft;pt++)At.withlabel&&(At.name=gt.vertices[pt].name===""?"":gt.vertices[pt].name+"'"),yt.push(ct.create("point",[gt.vertices[pt],ut[1]],At));else if((yt=st.providePoints(ct,ut,ht,"polygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(mt=st.copyAttributes(ht,ct.options,"polygon"),dt=new tt.Polygon(ct,yt,mt),dt.isDraggable=!0,bt)for(ft=gt.vertices.length-1,pt=0;pt<ft;pt++)yt[pt].prepareUpdate().update().updateVisibility(st.evaluate(dt.visProp.visible)).updateRenderer();return dt},tt.createRegularPolygon=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt=[];if(mt=ut.length,ft=ut[mt-1],st.isNumber(ft)&&(ut.length!==3||ft<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(st.isNumber(ct.select(ft))?(mt--,At=!1):(ft=mt,At=!0),(bt=st.providePoints(ct,ut.slice(0,mt),ht,"regularpolygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(yt=st.copyAttributes(ht,ct.options,"regularpolygon","vertices"),pt=2;pt<ft;pt++)gt=ct.create("transform",[Math.PI*(2-(ft-2)/ft),bt[pt-1]],{type:"rotate"}),At?(bt[pt].addTransform(bt[pt-2],gt),bt[pt].fullUpdate()):(st.isArray(yt.ids)&&yt.ids.length>=ft-2&&(yt.id=yt.ids[pt-2]),bt[pt]=ct.create("point",[bt[pt-2],gt],yt),bt[pt].type=_e.OBJECT_TYPE_CAS,bt[pt].isDraggable=!0,bt[pt].visProp.fixed=!1);return yt=st.copyAttributes(ht,ct.options,"regularpolygon"),dt=ct.create("polygon",bt,yt),dt.elType="regularpolygon",dt},tt.registerElement("polygon",tt.createPolygon),tt.registerElement("regularpolygon",tt.createRegularPolygon),{Polygon:tt.Polygon,createPolygon:tt.createPolygon,createRegularPolygon:tt.createRegularPolygon}}),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants","base/curve","element/composition"],function(tt,_e,rt,it,nt,st,at,lt,ot){return tt.createArc=function(ct,ut,ht){var dt,pt,ft;if((ft=st.providePoints(ct,ut,ht,"arc",["center","radiuspoint","anglepoint"]))===!1||ft.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [arc, transformation]`);return pt=st.copyAttributes(ht,ct.options,"arc"),dt=ct.create("curve",[[0],[0]],pt),dt.elType="arc",dt.setParents(ft),dt.type=at.OBJECT_TYPE_ARC,dt.center=ft[0],dt.radiuspoint=ft[1],dt.point2=dt.radiuspoint,dt.anglepoint=ft[2],dt.point3=dt.anglepoint,dt.center.addChild(dt),dt.radiuspoint.addChild(dt),dt.anglepoint.addChild(dt),dt.useDirection=pt.usedirection,dt.updateDataArray=function(){var gt,mt,At,yt,bt,xt,vt=1,_t=this.radiuspoint,Ct=this.center,St=this.anglepoint,Et=st.evaluate(this.visProp.selection);mt=_e.rad(_t,Ct,St),(Et==="minor"&&mt>Math.PI||Et==="major"&&mt<Math.PI)&&(vt=-1),this.useDirection&&(yt=ft[1].coords.usrCoords,bt=ft[3].coords.usrCoords,xt=ft[2].coords.usrCoords,At=(yt[1]-xt[1])*(yt[2]-bt[2])-(yt[2]-xt[2])*(yt[1]-bt[1]),At<0?(this.radiuspoint=ft[1],this.anglepoint=ft[2]):(this.radiuspoint=ft[2],this.anglepoint=ft[1])),_t=_t.coords.usrCoords,Ct=Ct.coords.usrCoords,St=St.coords.usrCoords,gt=_e.bezierArc(_t,Ct,St,!1,vt),this.dataX=gt[0],this.dataY=gt[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},dt.Radius=function(){return this.radiuspoint.Dist(this.center)},dt.getRadius=function(){return tt.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},dt.Value=function(){return this.Radius()*_e.rad(this.radiuspoint,this.center,this.anglepoint)},dt.hasPoint=function(gt,mt){var At,yt,bt,xt,vt,_t,Ct,St,Et,Tt=this.Radius(),Mt=st.evaluate(this.visProp.selection);return st.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(gt,mt):(Et=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),yt=new it(at.COORDS_BY_SCREEN,[gt,mt],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),Ct=rt.inverse(this.transformMat),St=rt.matVecMult(Ct,yt.usrCoords),yt=new it(at.COORDS_BY_USER,St,this.board)),At=this.center.coords.distance(at.COORDS_BY_USER,yt),bt=Math.abs(At-Tt)<Et,bt&&(xt=_e.rad(this.radiuspoint,this.center,yt.usrCoords.slice(1)),vt=0,_t=_e.rad(this.radiuspoint,this.center,this.anglepoint),(Mt==="minor"&&_t>Math.PI||Mt==="major"&&_t<Math.PI)&&(vt=_t,_t=2*Math.PI),(xt<vt||xt>_t)&&(bt=!1)),bt)},dt.hasPointSector=function(gt,mt){var At,yt,bt,xt=new it(at.COORDS_BY_SCREEN,[gt,mt],this.board),vt=this.Radius(),_t=this.center.coords.distance(at.COORDS_BY_USER,xt),Ct=_t<vt,St=st.evaluate(this.visProp.selection);return Ct&&(At=_e.rad(this.radiuspoint,this.center,xt.usrCoords.slice(1)),yt=0,bt=_e.rad(this.radiuspoint,this.center,this.anglepoint),(St==="minor"&&bt>Math.PI||St==="major"&&bt<Math.PI)&&(yt=bt,bt=2*Math.PI),(At<yt||At>bt)&&(Ct=!1)),Ct},dt.getTextAnchor=function(){return this.center.coords},dt.getLabelAnchor=function(){var gt,mt,At,yt,bt,xt=_e.rad(this.radiuspoint,this.center,this.anglepoint),vt=10/this.board.unitX,_t=10/this.board.unitY,Ct=this.point2.coords.usrCoords,St=this.center.coords.usrCoords,Et=Ct[1]-St[1],Tt=Ct[2]-St[2],Mt=st.evaluate(this.visProp.selection),Rt=this.label?this.label.visProp:this.visProp.label;return(Mt==="minor"&&xt>Math.PI||Mt==="major"&&xt<Math.PI)&&(xt=-(2*Math.PI-xt)),gt=new it(at.COORDS_BY_USER,[St[1]+Math.cos(.5*xt)*Et-Math.sin(.5*xt)*Tt,St[2]+Math.sin(.5*xt)*Et+Math.cos(.5*xt)*Tt],this.board),At=gt.usrCoords[1]-St[1],yt=gt.usrCoords[2]-St[2],bt=Math.sqrt(At*At+yt*yt),At=At*(bt+vt)/bt,yt=yt*(bt+_t)/bt,mt=[St[1]+At,St[2]+yt],Rt.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],mt)),new it(at.COORDS_BY_USER,mt,this.board)},dt.updateQuadraticform=nt.Circle.prototype.updateQuadraticform,dt.updateStdform=nt.Circle.prototype.updateStdform,dt.methodMap=tt.deepCopy(dt.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),dt.prepareUpdate().update(),dt},tt.registerElement("arc",tt.createArc),tt.createSemicircle=function(ct,ut,ht){var dt,pt,ft,gt;if((gt=st.providePoints(ct,ut,ht,"point"))===!1||gt.length!==2)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point]`);return ft=st.copyAttributes(ht,ct.options,"semicircle","center"),pt=ct.create("midpoint",gt,ft),pt.dump=!1,ft=st.copyAttributes(ht,ct.options,"semicircle"),dt=ct.create("arc",[pt,gt[1],gt[0]],ft),dt.elType="semicircle",dt.setParents([gt[0].id,gt[1].id]),dt.subs={midpoint:pt},dt.inherits.push(pt),dt.midpoint=dt.center=pt,dt},tt.registerElement("semicircle",tt.createSemicircle),tt.createCircumcircleArc=function(ct,ut,ht){var dt,pt,ft,gt;if((gt=st.providePoints(ct,ut,ht,"point"))===!1||gt.length!==3)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point]`);return ft=st.copyAttributes(ht,ct.options,"circumcirclearc","center"),pt=ct.create("circumcenter",gt,ft),pt.dump=!1,ft=st.copyAttributes(ht,ct.options,"circumcirclearc"),ft.usedirection=!0,dt=ct.create("arc",[pt,gt[0],gt[2],gt[1]],ft),dt.elType="circumcirclearc",dt.setParents([gt[0].id,gt[1].id,gt[2].id]),dt.subs={center:pt},dt.inherits.push(pt),dt.center=pt,dt},tt.registerElement("circumcirclearc",tt.createCircumcircleArc),tt.createMinorArc=function(ct,ut,ht){return ht.selection="minor",tt.createArc(ct,ut,ht)},tt.registerElement("minorarc",tt.createMinorArc),tt.createMajorArc=function(ct,ut,ht){return ht.selection="major",tt.createArc(ct,ut,ht)},tt.registerElement("majorarc",tt.createMajorArc),{createArc:tt.createArc,createSemicircle:tt.createSemicircle,createCircumcircleArc:tt.createCircumcircleArc,createMinorArc:tt.createMinorArc,createMajorArc:tt.createMajorArc}}),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type","base/point","base/curve","base/transformation","element/composition"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut){return tt.createSector=function(ht,dt,pt){var ft,gt,mt,At,yt,bt="invalid",xt=["center","radiuspoint","anglepoint"];if(dt[0].elementClass===st.OBJECT_CLASS_LINE&&dt[1].elementClass===st.OBJECT_CLASS_LINE&&(at.isArray(dt[2])||at.isNumber(dt[2]))&&(at.isArray(dt[3])||at.isNumber(dt[3]))&&(at.isNumber(dt[4])||at.isFunction(dt[4])))bt="2lines";else{if((yt=at.providePoints(ht,dt,pt,"sector",xt))===!1)throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");bt="3points"}return gt=at.copyAttributes(pt,ht.options,"sector"),ft=ht.create("curve",[[0],[0]],gt),ft.type=st.OBJECT_TYPE_SECTOR,ft.elType="sector",bt==="2lines"?(ft.Radius=function(){return at.evaluate(dt[4])},ft.line1=ht.select(dt[0]),ft.line2=ht.select(dt[1]),ft.line1.addChild(ft),ft.line2.addChild(ft),ft.setParents(dt),ft.point1={visProp:{}},ft.point2={visProp:{}},ft.point3={visProp:{}},mt=_e.meetLineLine(ft.line1.stdform,ft.line2.stdform,0,ht),at.isArray(dt[2])?(dt[2].length===2&&(dt[2]=[1].concat(dt[2])),At=_e.projectPointToLine({coords:{usrCoords:dt[2]}},ft.line1,ht),At=it.subtract(At.usrCoords,mt.usrCoords),ft.direction1=rt.innerProduct(At,[0,ft.line1.stdform[2],-ft.line1.stdform[1]],3)>=0?1:-1):ft.direction1=dt[2]>=0?1:-1,at.isArray(dt[3])?(dt[3].length===2&&(dt[3]=[1].concat(dt[3])),At=_e.projectPointToLine({coords:{usrCoords:dt[3]}},ft.line2,ht),At=it.subtract(At.usrCoords,mt.usrCoords),ft.direction2=rt.innerProduct(At,[0,ft.line2.stdform[2],-ft.line2.stdform[1]],3)>=0?1:-1):ft.direction2=dt[3]>=0?1:-1,ft.updateDataArray=function(){var vt,_t,Ct,St,Et=[0,0,0],Tt=[0,0,0],Mt=[0,0,0];if(_t=this.line1,Ct=this.line2,Tt=rt.crossProduct(_t.stdform,Ct.stdform),Math.abs(Tt[0])>rt.eps*rt.eps&&(Tt[1]/=Tt[0],Tt[2]/=Tt[0],Tt[0]/=Tt[0]),vt=this.direction1*this.Radius(),Et=it.add(Tt,[0,vt*_t.stdform[2],-vt*_t.stdform[1]]),vt=this.direction2*this.Radius(),Mt=it.add(Tt,[0,vt*Ct.stdform[2],-vt*Ct.stdform[1]]),this.point2.coords=new nt(st.COORDS_BY_USER,Et,ft.board),this.point1.coords=new nt(st.COORDS_BY_USER,Tt,ft.board),this.point3.coords=new nt(st.COORDS_BY_USER,Mt,ft.board),Math.abs(Et[0])<rt.eps||Math.abs(Tt[0])<rt.eps||Math.abs(Mt[0])<rt.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);St=_e.bezierArc(Et,Tt,Mt,!0,1),this.dataX=St[0],this.dataY=St[1],this.bezierDegree=3},ft.methodMap=tt.deepCopy(ft.methodMap,{radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),ft.prepareUpdate().update()):bt==="3points"&&(ft.point1=yt[0],ft.point2=yt[1],ft.point3=yt[2],ft.point1.addChild(ft),ft.point2.addChild(ft),ft.point3.addChild(ft),ft.useDirection=pt.usedirection,ft.setParents(yt),at.exists(yt[3])&&(ft.point4=yt[3],ft.point4.addChild(ft)),ft.methodMap=tt.deepCopy(ft.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),ft.updateDataArray=function(){var vt,_t,Ct,St,Et,Tt=this.point2,Mt=this.point1,Rt=this.point3,It=1,Ot=at.evaluate(this.visProp.selection);if(!Tt.isReal||!Mt.isReal||!Rt.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);Et=_e.rad(Tt,Mt,Rt),(Ot==="minor"&&Et>Math.PI||Ot==="major"&&Et<Math.PI)&&(It=-1),this.useDirection&&at.exists(this.point4)&&(_t=this.point2.coords.usrCoords,Ct=this.point4.coords.usrCoords,St=this.point3.coords.usrCoords,(_t[1]-St[1])*(_t[2]-Ct[2])-(_t[2]-St[2])*(_t[1]-Ct[1])>=0&&(Rt=this.point2,Tt=this.point3)),Tt=Tt.coords.usrCoords,Mt=Mt.coords.usrCoords,Rt=Rt.coords.usrCoords,vt=_e.bezierArc(Tt,Mt,Rt,!0,It),this.dataX=vt[0],this.dataY=vt[1],this.bezierDegree=3},ft.Radius=function(){return this.point2.Dist(this.point1)},gt=at.copyAttributes(pt,ht.options,"sector","arc"),gt.withLabel=!1,gt.name+="_arc",ft.arc=ht.create("arc",[ft.point1,ft.point2,ft.point3],gt),ft.addChild(ft.arc)),ft.center=ft.point1,ft.radiuspoint=ft.point2,ft.anglepoint=ft.point3,ft.hasPointCurve=function(vt,_t){var Ct,St,Et,Tt,Mt,Rt=new nt(st.COORDS_BY_SCREEN,[vt,_t],this.board),It=this.Radius(),Ot=this.center.coords.distance(st.COORDS_BY_USER,Rt),Bt=at.evaluate(this.visProp.selection);return Tt=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),Mt=Math.abs(Ot-It)<Tt,Mt&&(Ct=_e.rad(this.point2,this.center,Rt.usrCoords.slice(1)),St=0,Et=_e.rad(this.point2,this.center,this.point3),(Bt==="minor"&&Et>Math.PI||Bt==="major"&&Et<Math.PI)&&(St=Et,Et=2*Math.PI),(Ct<St||Ct>Et)&&(Mt=!1)),Mt},ft.hasPointSector=function(vt,_t){var Ct,St,Et,Tt=new nt(st.COORDS_BY_SCREEN,[vt,_t],this.board),Mt=this.Radius(),Rt=this.point1.coords.distance(st.COORDS_BY_USER,Tt),It=Rt<Mt,Ot=at.evaluate(this.visProp.selection);return It&&(Ct=_e.rad(this.radiuspoint,this.center,Tt.usrCoords.slice(1)),St=0,Et=_e.rad(this.radiuspoint,this.center,this.anglepoint),(Ot==="minor"&&Et>Math.PI||Ot==="major"&&Et<Math.PI)&&(St=Et,Et=2*Math.PI),(Ct<St||Ct>Et)&&(It=!1)),It},ft.hasPoint=function(vt,_t){return at.evaluate(this.visProp.highlightonsector)||at.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(vt,_t):this.hasPointCurve(vt,_t)},ft.getTextAnchor=function(){return this.point1.coords},ft.getLabelAnchor=function(){var vt,_t,Ct,St,Et,Tt=_e.rad(this.point2,this.point1,this.point3),Mt=13/this.board.unitX,Rt=13/this.board.unitY,It=this.point2.coords.usrCoords,Ot=this.point1.coords.usrCoords,Bt=It[1]-Ot[1],Nt=It[2]-Ot[2],zt=at.evaluate(this.visProp.selection),Dt=this.label?this.label.visProp:this.visProp.label;return(zt==="minor"&&Tt>Math.PI||zt==="major"&&Tt<Math.PI)&&(Tt=-(2*Math.PI-Tt)),vt=new nt(st.COORDS_BY_USER,[Ot[1]+Math.cos(.5*Tt)*Bt-Math.sin(.5*Tt)*Nt,Ot[2]+Math.sin(.5*Tt)*Bt+Math.cos(.5*Tt)*Nt],this.board),Ct=vt.usrCoords[1]-Ot[1],St=vt.usrCoords[2]-Ot[2],Et=Math.sqrt(Ct*Ct+St*St),Ct=Ct*(Et+Mt)/Et,St=St*(Et+Rt)/Et,_t=[Ot[1]+Ct,Ot[2]+St],Dt.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],_t)),new nt(st.COORDS_BY_USER,_t,this.board)},ft.setRadius=function(vt){ft.Radius=function(){return at.evaluate(vt)}},ft.getRadius=function(){return tt.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},bt==="3points"&&(ft.setPositionDirectly=function(vt,_t,Ct){var St,Et,Tt=new nt(vt,_t,this.board),Mt=new nt(vt,Ct,this.board);return ft.point1.draggable()&&ft.point2.draggable()&&ft.point3.draggable()?(St=it.subtract(Tt.usrCoords,Mt.usrCoords),Et=this.board.create("transform",St.slice(1),{type:"translate"}),Et.applyOnce([ft.point1,ft.point2,ft.point3]),this):this}),ft.prepareUpdate().update(),ft},tt.registerElement("sector",tt.createSector),tt.createCircumcircleSector=function(ht,dt,pt){var ft,gt,mt,At;if((At=at.providePoints(ht,dt,pt,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");return gt=ht.create("circumcenter",At.slice(0,3),mt),gt.dump=!1,mt=at.copyAttributes(pt,ht.options,"circumcirclesector"),ft=ht.create("sector",[gt,At[0],At[2],At[1]],mt),ft.elType="circumcirclesector",ft.setParents(At),ft.center=gt,ft.subs={center:gt},ft},tt.registerElement("circumcirclesector",tt.createCircumcircleSector),tt.createMinorSector=function(ht,dt,pt){return pt.selection="minor",tt.createSector(ht,dt,pt)},tt.registerElement("minorsector",tt.createMinorSector),tt.createMajorSector=function(ht,dt,pt){return pt.selection="major",tt.createSector(ht,dt,pt)},tt.registerElement("majorsector",tt.createMajorSector),tt.createAngle=function(ht,dt,pt){var ft,gt,mt,At,yt,bt,xt="invalid";if(dt[0].elementClass===st.OBJECT_CLASS_LINE&&dt[1].elementClass===st.OBJECT_CLASS_LINE&&(at.isArray(dt[2])||at.isNumber(dt[2]))&&(at.isArray(dt[3])||at.isNumber(dt[3])))xt="2lines";else{if((bt=at.providePoints(ht,dt,pt,"point"))===!1)throw new Error("JSXGraph: Can't create angle with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");xt="3points"}if(mt=at.copyAttributes(pt,ht.options,"angle"),at.exists(mt.name)&&mt.name!==""||(mt.name=ht.generateName({type:st.OBJECT_TYPE_ANGLE})),gt=at.exists(mt.radius)?mt.radius:0,xt==="2lines"?(dt.push(gt),ft=ht.create("sector",dt,mt),ft.updateDataArraySector=ft.updateDataArray,ft.setAngle=function(vt){},ft.free=function(vt){}):(ft=ht.create("sector",[bt[1],bt[0],bt[2]],mt),ft.arc.visProp.priv=!0,ft.point=ft.point2=ft.radiuspoint=bt[0],ft.pointsquare=ft.point3=ft.anglepoint=bt[2],ft.Radius=function(){return at.evaluate(gt)},ft.updateDataArraySector=function(){var vt,_t,Ct=this.point2,St=this.point1,Et=this.point3,Tt=this.Radius(),Mt=St.Dist(Ct),Rt=1,It=at.evaluate(this.visProp.selection);_t=_e.rad(Ct,St,Et),(It==="minor"&&_t>Math.PI||It==="major"&&_t<Math.PI)&&(Rt=-1),Ct=Ct.coords.usrCoords,St=St.coords.usrCoords,Et=Et.coords.usrCoords,Ct=[1,St[1]+(Ct[1]-St[1])*Tt/Mt,St[2]+(Ct[2]-St[2])*Tt/Mt],Et=[1,St[1]+(Et[1]-St[1])*Tt/Mt,St[2]+(Et[2]-St[2])*Tt/Mt],vt=_e.bezierArc(Ct,St,Et,!0,Rt),this.dataX=vt[0],this.dataY=vt[1],this.bezierDegree=3},ft.setAngle=function(vt){var _t,Ct=this.anglepoint,St=this.radiuspoint;return Ct.draggable()&&(_t=this.board.create("transform",[vt,this.center],{type:"rotate"}),Ct.addTransform(St,_t),Ct.isDraggable=!1,Ct.setParents(St)),this},ft.free=function(){var vt=this.anglepoint;return vt.transformations.length>0&&(vt.transformations.pop(),vt.isDraggable=!0,vt.parents=[]),this},ft.setParents(bt)),at.exists(ft.visProp.text)&&ft.label.setText(at.evaluate(ft.visProp.text)),ft.elType="angle",ft.type=st.OBJECT_TYPE_ANGLE,ft.subs={},ft.updateDataArraySquare=function(){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It=this.Radius();xt==="2lines"&&this.updateDataArraySector(),vt=this.point2,_t=this.point1,Ct=this.point3,vt=vt.coords.usrCoords,_t=_t.coords.usrCoords,Ct=Ct.coords.usrCoords,St=_e.distance(vt,_t,3),Et=_e.distance(Ct,_t,3),vt=[1,_t[1]+(vt[1]-_t[1])*It/St,_t[2]+(vt[2]-_t[2])*It/St],Ct=[1,_t[1]+(Ct[1]-_t[1])*It/Et,_t[2]+(Ct[2]-_t[2])*It/Et],Tt=rt.crossProduct(Ct,_t),Mt=[-vt[1]*Tt[1]-vt[2]*Tt[2],vt[0]*Tt[1],vt[0]*Tt[2]],Tt=rt.crossProduct(vt,_t),Rt=[-Ct[1]*Tt[1]-Ct[2]*Tt[2],Ct[0]*Tt[1],Ct[0]*Tt[2]],Tt=rt.crossProduct(Mt,Rt),Tt[1]/=Tt[0],Tt[2]/=Tt[0],this.dataX=[_t[1],vt[1],Tt[1],Ct[1],_t[1]],this.dataY=[_t[2],vt[2],Tt[2],Ct[2],_t[2]],this.bezierDegree=1},ft.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},ft.updateDataArray=function(){var vt=at.evaluate(this.visProp.type),_t=_e.trueAngle(this.point2,this.point1,this.point3),Ct=at.evaluate(this.visProp.selection);(Ct==="minor"&&_t>180||Ct==="major"&&_t<180)&&(_t=360-_t),Math.abs(_t-90)<at.evaluate(this.visProp.orthosensitivity)+rt.eps&&(vt=at.evaluate(this.visProp.orthotype)),vt==="none"?this.updateDataArrayNone():vt==="square"?this.updateDataArraySquare():vt==="sector"?this.updateDataArraySector():vt==="sectordot"&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||vt!=="sectordot"&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},At=at.copyAttributes(pt,ht.options,"angle","dot"),ft.dot=ht.create("point",[function(){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It;return at.exists(ft.dot)&&!ft.dot.visProp.visible?[0,0]:(vt=ft.point2.coords.usrCoords,_t=ft.point1.coords.usrCoords,Ct=ft.Radius(),St=_e.distance(vt,_t,3),Et=_e.rad(ft.point2,ft.point1,ft.point3),It=at.evaluate(ft.visProp.selection),(It==="minor"&&Et>Math.PI||It==="major"&&Et<Math.PI)&&(Et=-(2*Math.PI-Et)),Et*=.5,Tt=Math.cos(Et),Mt=Math.sin(Et),vt=[1,_t[1]+(vt[1]-_t[1])*Ct/St,_t[2]+(vt[2]-_t[2])*Ct/St],Rt=[[1,0,0],[_t[1]-.5*_t[1]*Tt+.5*_t[2]*Mt,.5*Tt,.5*-Mt],[_t[2]-.5*_t[1]*Mt-.5*_t[2]*Tt,.5*Mt,.5*Tt]],rt.matVecMult(Rt,vt))}],At),ft.dot.dump=!1,ft.subs.dot=ft.dot,xt==="2lines")for(yt=0;yt<2;yt++)ht.select(dt[yt]).addChild(ft.dot);else for(yt=0;yt<3;yt++)ht.select(bt[yt]).addChild(ft.dot);return ft.getLabelAnchor=function(){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot=12,Bt=at.evaluate(ft.visProp.selection),Nt=this.label?this.label.visProp:this.visProp.label;return at.exists(this.label.visProp.fontSize)&&(Ot=dy=at.evaluate(this.label.visProp.fontSize)),Ot/=this.board.unitX,_t=ft.point2.coords.usrCoords,Ct=ft.point1.coords.usrCoords,St=ft.Radius(),Et=_e.distance(_t,Ct,3),Tt=_e.rad(ft.point2,ft.point1,ft.point3),(Bt==="minor"&&Tt>Math.PI||Bt==="major"&&Tt<Math.PI)&&(Tt=-(2*Math.PI-Tt)),Tt*=.5,Mt=Math.cos(Tt),Rt=Math.sin(Tt),_t=[1,Ct[1]+(_t[1]-Ct[1])*St/Et,Ct[2]+(_t[2]-Ct[2])*St/Et],It=[[1,0,0],[Ct[1]-.5*Ct[1]*Mt+.5*Ct[2]*Rt,.5*Mt,.5*-Rt],[Ct[2]-.5*Ct[1]*Rt-.5*Ct[2]*Mt,.5*Rt,.5*Mt]],vt=rt.matVecMult(It,_t),vt[1]/=vt[0],vt[2]/=vt[0],vt[0]/=vt[0],Et=_e.distance(vt,Ct,3),vt=[vt[0],Ct[1]+(vt[1]-Ct[1])*(St+Ot)/Et,Ct[2]+(vt[2]-Ct[2])*(St+Ot)/Et],Nt.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],vt)),new nt(st.COORDS_BY_USER,vt,this.board)},ft.Value=function(){return _e.rad(this.point2,this.point1,this.point3)},ft.methodMap=at.deepCopy(ft.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),ft},tt.registerElement("angle",tt.createAngle),tt.createNonreflexAngle=function(ht,dt,pt){var ft;return pt.selection="minor",ft=tt.createAngle(ht,dt,pt),ft.Value=function(){var gt=_e.rad(this.point2,this.point1,this.point3);return gt<Math.PI?gt:2*Math.PI-gt},ft},tt.registerElement("nonreflexangle",tt.createNonreflexAngle),tt.createReflexAngle=function(ht,dt,pt){var ft;return pt.selection="major",ft=tt.createAngle(ht,dt,pt),ft.Value=function(){var gt=_e.rad(this.point2,this.point1,this.point3);return gt>=Math.PI?gt:2*Math.PI-gt},ft},tt.registerElement("reflexangle",tt.createReflexAngle),{createSector:tt.createSector,createCircumcircleSector:tt.createCircumcircleSector,createMinorSector:tt.createMinorSector,createMajorSector:tt.createMajorSector,createAngle:tt.createAngle,createReflexAngle:tt.createReflexAngle,createNonreflexAngle:tt.createNonreflexAngle}}),define("element/composition",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/text","base/polygon","element/arc","element/sector"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At){return tt.createOrthogonalProjection=function(yt,bt,xt){var vt,_t,Ct,St;if(bt[0]=yt.select(bt[0]),bt[1]=yt.select(bt[1]),at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)_t=at.providePoints(yt,[bt[0]],xt,"point")[0],vt=bt[1];else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line]`);_t=at.providePoints(yt,[bt[1]],xt,"point")[0],vt=bt[0]}return St=at.copyAttributes(xt,yt.options,"orthogonalprojection"),Ct=yt.create("point",[function(){return rt.projectPointToLine(_t,vt,yt)}],St),_t.addChild(Ct),vt.addChild(Ct),Ct.elType="orthogonalprojection",Ct.setParents([_t.id,Ct.id]),Ct.update(),Ct.generatePolynomial=function(){var Et=vt.point1.symbolic.x,Tt=vt.point1.symbolic.y,Mt=vt.point2.symbolic.x,Rt=vt.point2.symbolic.y,It=_t.symbolic.x,Ot=_t.symbolic.y,Bt=Ct.symbolic.x,Nt=Ct.symbolic.y;return["("+Tt+")*("+Bt+")-("+Tt+")*("+Mt+")+("+Nt+")*("+Mt+")-("+Et+")*("+Nt+")+("+Et+")*("+Rt+")-("+Bt+")*("+Rt+")","("+Ot+")*("+Tt+")-("+Ot+")*("+Rt+")-("+Nt+")*("+Tt+")+("+Nt+")*("+Rt+")+("+It+")*("+Et+")-("+It+")*("+Mt+")-("+Bt+")*("+Et+")+("+Bt+")*("+Mt+")"]},Ct},tt.createPerpendicular=function(yt,bt,xt){var vt,_t,Ct,St;if(bt[0]=yt.select(bt[0]),bt[1]=yt.select(bt[1]),at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)_t=bt[1],vt=at.providePoints(yt,[bt[0]],xt,"point")[0];else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [line,point]`);_t=bt[0],vt=at.providePoints(yt,[bt[1]],xt,"point")[0]}return St=at.copyAttributes(xt,yt.options,"perpendicular"),Ct=ct.createLine(yt,[function(){return _t.stdform[2]*vt.X()-_t.stdform[1]*vt.Y()},function(){return-_t.stdform[2]*vt.Z()},function(){return _t.stdform[1]*vt.Z()}],St),Ct.elType="perpendicular",Ct.setParents([_t.id,vt.id]),Ct},tt.createPerpendicularPoint=function(yt,bt,xt){var vt,_t,Ct;if(bt[0]=yt.select(bt[0]),bt[1]=yt.select(bt[1]),at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)_t=at.providePoints(yt,[bt[0]],xt,"point")[0],vt=bt[1];else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line]`);_t=at.providePoints(yt,[bt[1]],xt,"point")[0],vt=bt[0]}return Ct=yt.create("point",[function(){return rt.perpendicular(vt,_t,yt)[0]}],xt),_t.addChild(Ct),vt.addChild(Ct),Ct.elType="perpendicularpoint",Ct.setParents([_t.id,vt.id]),Ct.update(),Ct.generatePolynomial=function(){var St=vt.point1.symbolic.x,Et=vt.point1.symbolic.y,Tt=vt.point2.symbolic.x,Mt=vt.point2.symbolic.y,Rt=_t.symbolic.x,It=_t.symbolic.y,Ot=Ct.symbolic.x,Bt=Ct.symbolic.y;return["("+Et+")*("+Ot+")-("+Et+")*("+Tt+")+("+Bt+")*("+Tt+")-("+St+")*("+Bt+")+("+St+")*("+Mt+")-("+Ot+")*("+Mt+")","("+It+")*("+Et+")-("+It+")*("+Mt+")-("+Bt+")*("+Et+")+("+Bt+")*("+Mt+")+("+Rt+")*("+St+")-("+Rt+")*("+Tt+")-("+Ot+")*("+St+")+("+Ot+")*("+Tt+")"]},Ct},tt.createPerpendicularSegment=function(yt,bt,xt){var vt,_t,Ct,St,Et;if(bt[0]=yt.select(bt[0]),bt[1]=yt.select(bt[1]),at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)_t=bt[1],vt=at.providePoints(yt,[bt[0]],xt,"point")[0];else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [line,point]`);_t=bt[0],vt=at.providePoints(yt,[bt[1]],xt,"point")[0]}return Et=at.copyAttributes(xt,yt.options,"perpendicularsegment","point"),St=tt.createPerpendicularPoint(yt,[_t,vt],Et),St.dump=!1,at.exists(xt.layer)||(xt.layer=yt.options.layer.line),Et=at.copyAttributes(xt,yt.options,"perpendicularsegment"),Ct=ct.createLine(yt,[function(){return rt.perpendicular(_t,vt,yt)[1]?[St,vt]:[vt,St]}],Et),Ct.point=St,Ct.elType="perpendicularsegment",Ct.setParents([vt.id,_t.id]),Ct.subs={point:St},Ct.inherits.push(St),Ct},tt.createMidpoint=function(yt,bt,xt){var vt,_t,Ct,St,Et;for(St=0;St<bt.length;++St)bt[St]=yt.select(bt[St]);if(bt.length===2&&at.isPointType(yt,bt[0])&&at.isPointType(yt,bt[1]))bt=at.providePoints(yt,bt,xt,"point"),vt=bt[0],_t=bt[1];else{if(bt.length!==1||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error(`JSXGraph: Can't create midpoint.
Possible parent types: [point,point], [line]`);vt=bt[0].point1,_t=bt[0].point2}return Et=at.copyAttributes(xt,yt.options,"midpoint"),Ct=yt.create("point",[function(){var Tt=vt.coords.usrCoords[1]+_t.coords.usrCoords[1];return isNaN(Tt)||Math.abs(vt.coords.usrCoords[0])<_e.eps||Math.abs(_t.coords.usrCoords[0])<_e.eps?NaN:.5*Tt},function(){var Tt=vt.coords.usrCoords[2]+_t.coords.usrCoords[2];return isNaN(Tt)||Math.abs(vt.coords.usrCoords[0])<_e.eps||Math.abs(_t.coords.usrCoords[0])<_e.eps?NaN:.5*Tt}],Et),vt.addChild(Ct),_t.addChild(Ct),Ct.elType="midpoint",Ct.setParents([vt.id,_t.id]),Ct.prepareUpdate().update(),Ct.generatePolynomial=function(){var Tt=vt.symbolic.x,Mt=vt.symbolic.y,Rt=_t.symbolic.x,It=_t.symbolic.y,Ot=Ct.symbolic.x,Bt=Ct.symbolic.y;return["("+Mt+")*("+Ot+")-("+Mt+")*("+Rt+")+("+Bt+")*("+Rt+")-("+Tt+")*("+Bt+")+("+Tt+")*("+It+")-("+Ot+")*("+It+")","("+Tt+")^2 - 2*("+Tt+")*("+Ot+")+("+Mt+")^2-2*("+Mt+")*("+Bt+")-("+Rt+")^2+2*("+Rt+")*("+Ot+")-("+It+")^2+2*("+It+")*("+Bt+")"]},Ct},tt.createParallelPoint=function(yt,bt,xt){var vt,_t,Ct,St,Et;for(Et=0;Et<bt.length;++Et)bt[Et]=yt.select(bt[Et]);if(bt.length===3&&at.isPointType(yt,bt[0])&&at.isPointType(yt,bt[1])&&at.isPointType(yt,bt[2]))bt=at.providePoints(yt,bt,xt,"point"),vt=bt[0],_t=bt[1],Ct=bt[2];else if(at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)Ct=at.providePoints(yt,[bt[0]],xt,"point")[0],vt=bt[1].point1,_t=bt[1].point2;else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [line,point], [point,point,point]`);Ct=at.providePoints(yt,[bt[1]],xt,"point")[0],vt=bt[0].point1,_t=bt[0].point2}return St=yt.create("point",[function(){return Ct.coords.usrCoords[1]+_t.coords.usrCoords[1]-vt.coords.usrCoords[1]},function(){return Ct.coords.usrCoords[2]+_t.coords.usrCoords[2]-vt.coords.usrCoords[2]}],xt),vt.addChild(St),_t.addChild(St),Ct.addChild(St),St.elType="parallelpoint",St.setParents([vt.id,_t.id,Ct.id]),St.prepareUpdate().update(),St.generatePolynomial=function(){var Tt=vt.symbolic.x,Mt=vt.symbolic.y,Rt=_t.symbolic.x,It=_t.symbolic.y,Ot=Ct.symbolic.x,Bt=Ct.symbolic.y,Nt=St.symbolic.x,zt=St.symbolic.y;return["("+It+")*("+Nt+")-("+It+")*("+Ot+")-("+Mt+")*("+Nt+")+("+Mt+")*("+Ot+")-("+zt+")*("+Rt+")+("+zt+")*("+Tt+")+("+Bt+")*("+Rt+")-("+Bt+")*("+Tt+")","("+zt+")*("+Tt+")-("+zt+")*("+Ot+")-("+It+")*("+Tt+")+("+It+")*("+Ot+")-("+Nt+")*("+Mt+")+("+Nt+")*("+Bt+")+("+Rt+")*("+Mt+")-("+Rt+")*("+Bt+")"]},St},tt.createParallel=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt;for(Et=0;Et<bt.length;++Et)bt[Et]=yt.select(bt[Et]);return vt=null,bt.length===3?(bt=at.providePoints(yt,bt,xt,"point"),vt=bt[2],St=function(){return _e.crossProduct(bt[0].coords.usrCoords,bt[1].coords.usrCoords)}):at.isPointType(yt,bt[0])?(vt=at.providePoints(yt,[bt[0]],xt,"point")[0],St=function(){return bt[1].stdform}):at.isPointType(yt,bt[1])&&(vt=at.providePoints(yt,[bt[1]],xt,"point")[0],St=function(){return bt[0].stdform}),at.exists(xt.layer)||(xt.layer=yt.options.layer.line),Tt=at.copyAttributes(xt,yt.options,"parallel","point"),_t=yt.create("point",[function(){return _e.crossProduct([1,0,0],St())}],Tt),_t.isDraggable=!0,Tt=at.copyAttributes(xt,yt.options,"parallel"),Ct=yt.create("line",[vt,_t],Tt),Ct.elType="parallel",Ct.subs={point:_t},Ct.inherits.push(_t),Ct.setParents([bt[0].id,bt[1].id]),bt.length===3&&Ct.addParents(bt[2].id),Ct.point=_t,Ct},tt.createArrowParallel=function(yt,bt,xt){var vt;try{return xt.firstArrow=!1,xt.lastArrow=!0,vt=tt.createParallel(yt,bt,xt).setAttribute({straightFirst:!1,straightLast:!1}),vt.elType="arrowparallel",vt}catch{throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [line,point], [point,point,point]`)}},tt.createNormal=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It;for(St=0;St<bt.length;++St)bt[St]=yt.select(bt[St]);if(bt.length===1)vt=bt[0],_t=vt.slideObject;else{if(bt.length!==2)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);if(at.isPointType(yt,bt[0]))vt=at.providePoints(yt,[bt[0]],xt,"point")[0],_t=bt[1];else{if(!at.isPointType(yt,bt[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);_t=bt[0],vt=at.providePoints(yt,[bt[1]],xt,"point")[0]}}if(Mt=at.copyAttributes(xt,yt.options,"normal"),_t.elementClass===lt.OBJECT_CLASS_LINE)It=at.copyAttributes(xt,yt.options,"normal","point"),Rt=yt.create("point",[function(){var Ot=_e.crossProduct([1,0,0],_t.stdform);return[Ot[0],-Ot[2],Ot[1]]}],It),Rt.isDraggable=!0,Ct=yt.create("line",[vt,Rt],Mt),Ct.point=Rt,Ct.subs={point:Rt},Ct.inherits.push(Rt);else if(_t.elementClass===lt.OBJECT_CLASS_CIRCLE)Ct=yt.create("line",[_t.midpoint,vt],Mt);else if(_t.elementClass===lt.OBJECT_CLASS_CURVE)at.evaluate(_t.visProp.curvetype)!=="plot"?(Et=_t.X,Tt=_t.Y,Ct=yt.create("line",[function(){return-vt.X()*it.D(Et)(vt.position)-vt.Y()*it.D(Tt)(vt.position)},function(){return it.D(Et)(vt.position)},function(){return it.D(Tt)(vt.position)}],Mt)):Ct=yt.create("line",[function(){var Ot=Math.floor(vt.position),Bt=vt.position-Ot;return Ot===_t.numberPoints-1&&(Ot-=1,Bt=1),Ot<0?1:(_t.Y(Ot)+Bt*(_t.Y(Ot+1)-_t.Y(Ot)))*(_t.Y(Ot)-_t.Y(Ot+1))-(_t.X(Ot)+Bt*(_t.X(Ot+1)-_t.X(Ot)))*(_t.X(Ot+1)-_t.X(Ot))},function(){var Ot=Math.floor(vt.position);return Ot===_t.numberPoints-1&&(Ot-=1),Ot<0?0:_t.X(Ot+1)-_t.X(Ot)},function(){var Ot=Math.floor(vt.position);return Ot===_t.numberPoints-1&&(Ot-=1),Ot<0?0:_t.Y(Ot+1)-_t.Y(Ot)}],Mt);else{if(_t.type!==lt.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);Ct=yt.create("line",[function(){var Ot,Bt,Nt=Math.floor(vt.position),zt=vt.position-Nt;for(Bt=0;Bt<_t.objects.length;Bt++)if(Ot=_t.objects[Bt],Ot.type===lt.OBJECT_TYPE_CURVE){if(Nt<Ot.numberPoints)break;Nt-=Ot.numberPoints}return Nt===Ot.numberPoints-1&&(Nt-=1,zt=1),Nt<0?1:(Ot.Y(Nt)+zt*(Ot.Y(Nt+1)-Ot.Y(Nt)))*(Ot.Y(Nt)-Ot.Y(Nt+1))-(Ot.X(Nt)+zt*(Ot.X(Nt+1)-Ot.X(Nt)))*(Ot.X(Nt+1)-Ot.X(Nt))},function(){var Ot,Bt,Nt=Math.floor(vt.position);for(Bt=0;Bt<_t.objects.length;Bt++)if(Ot=_t.objects[Bt],Ot.type===lt.OBJECT_TYPE_CURVE){if(Nt<Ot.numberPoints)break;Nt-=Ot.numberPoints}return Nt===Ot.numberPoints-1&&(Nt-=1),Nt<0?0:Ot.X(Nt+1)-Ot.X(Nt)},function(){var Ot,Bt,Nt=Math.floor(vt.position);for(Bt=0;Bt<_t.objects.length;Bt++)if(Ot=_t.objects[Bt],Ot.type===lt.OBJECT_TYPE_CURVE){if(Nt<Ot.numberPoints)break;Nt-=Ot.numberPoints}return Nt===Ot.numberPoints-1&&(Nt-=1),Nt<0?0:Ot.Y(Nt+1)-Ot.Y(Nt)}],Mt)}return Ct.elType="normal",Ct.setParents(bt),Ct},tt.createBisector=function(yt,bt,xt){var vt,_t,Ct,St;if(bt=at.providePoints(yt,bt,xt,"point"),at.isPoint(bt[0])&&at.isPoint(bt[1])&&at.isPoint(bt[2])){for(St=at.copyAttributes(xt,yt.options,"bisector","point"),St.snapToGrid=!1,vt=yt.create("point",[function(){return rt.angleBisector(bt[0],bt[1],bt[2],yt)}],St),vt.dump=!1,Ct=0;Ct<3;Ct++)bt[Ct].addChild(vt);return at.exists(xt.layer)||(xt.layer=yt.options.layer.line),St=at.copyAttributes(xt,yt.options,"bisector"),_t=ct.createLine(yt,[bt[1],vt],St),_t.point=vt,_t.elType="bisector",_t.setParents(bt),_t.subs={point:vt},_t.inherits.push(vt),_t}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,point,point]`)},tt.createAngularBisectorsOfTwoLines=function(yt,bt,xt){var vt,_t,Ct,St,Et=yt.select(bt[0]),Tt=yt.select(bt[1]);if(Et.elementClass!==lt.OBJECT_CLASS_LINE||Tt.elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [line,line]`);return at.exists(xt.layer)||(xt.layer=yt.options.layer.line),Ct=at.copyAttributes(xt,yt.options,"bisectorlines","line1"),vt=yt.create("line",[function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[0]/Mt-Tt.stdform[0]/Rt},function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[1]/Mt-Tt.stdform[1]/Rt},function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[2]/Mt-Tt.stdform[2]/Rt}],Ct),at.exists(xt.layer)||(xt.layer=yt.options.layer.line),Ct=at.copyAttributes(xt,yt.options,"bisectorlines","line2"),_t=yt.create("line",[function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[0]/Mt+Tt.stdform[0]/Rt},function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[1]/Mt+Tt.stdform[1]/Rt},function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[2]/Mt+Tt.stdform[2]/Rt}],Ct),St=new dt({line1:vt,line2:_t}),vt.dump=!1,_t.dump=!1,St.elType="bisectorlines",St.setParents([Et.id,Tt.id]),St.subs={line1:vt,line2:_t},St},tt.createCircumcenter=function(yt,bt,xt){var vt,_t,Ct,St,Et;if(bt=at.providePoints(yt,bt,xt,"point"),at.isPoint(bt[0])&&at.isPoint(bt[1])&&at.isPoint(bt[2])){for(Ct=bt[0],St=bt[1],Et=bt[2],vt=ot.createPoint(yt,[function(){return rt.circumcenter(Ct,St,Et,yt)}],xt),_t=0;_t<3;_t++)bt[_t].addChild(vt);return vt.elType="circumcenter",vt.setParents(bt),vt.generatePolynomial=function(){var Tt=Ct.symbolic.x,Mt=Ct.symbolic.y,Rt=St.symbolic.x,It=St.symbolic.y,Ot=Et.symbolic.x,Bt=Et.symbolic.y,Nt=vt.symbolic.x,zt=vt.symbolic.y;return[["((",Nt,")-(",Tt,"))^2+((",zt,")-(",Mt,"))^2-((",Nt,")-(",Rt,"))^2-((",zt,")-(",It,"))^2"].join(""),["((",Nt,")-(",Tt,"))^2+((",zt,")-(",Mt,"))^2-((",Nt,")-(",Ot,"))^2-((",zt,")-(",Bt,"))^2"].join("")]},vt}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`)},tt.createIncenter=function(yt,bt,xt){var vt,_t,Ct,St;if(bt=at.providePoints(yt,bt,xt,"point"),!(bt.length>=3&&at.isPoint(bt[0])&&at.isPoint(bt[1])&&at.isPoint(bt[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`);return _t=bt[0],Ct=bt[1],St=bt[2],vt=yt.create("point",[function(){var Et,Tt,Mt;return Et=Math.sqrt((Ct.X()-St.X())*(Ct.X()-St.X())+(Ct.Y()-St.Y())*(Ct.Y()-St.Y())),Tt=Math.sqrt((_t.X()-St.X())*(_t.X()-St.X())+(_t.Y()-St.Y())*(_t.Y()-St.Y())),Mt=Math.sqrt((Ct.X()-_t.X())*(Ct.X()-_t.X())+(Ct.Y()-_t.Y())*(Ct.Y()-_t.Y())),new st(lt.COORDS_BY_USER,[(Et*_t.X()+Tt*Ct.X()+Mt*St.X())/(Et+Tt+Mt),(Et*_t.Y()+Tt*Ct.Y()+Mt*St.Y())/(Et+Tt+Mt)],yt)}],xt),vt.elType="incenter",vt.setParents(bt),vt},tt.createCircumcircle=function(yt,bt,xt){var vt,_t,Ct;if((bt=at.providePoints(yt,bt,xt,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`);try{Ct=at.copyAttributes(xt,yt.options,"circumcircle","center"),vt=tt.createCircumcenter(yt,bt,Ct),vt.dump=!1,at.exists(xt.layer)||(xt.layer=yt.options.layer.circle),Ct=at.copyAttributes(xt,yt.options,"circumcircle"),_t=ut.createCircle(yt,[vt,bt[0]],Ct),_t.elType="circumcircle",_t.setParents(bt),_t.subs={center:vt},_t.inherits.push(_t)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`)}return _t},tt.createIncircle=function(yt,bt,xt){var vt,_t,Ct;if((bt=at.providePoints(yt,bt,xt,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`);try{Ct=at.copyAttributes(xt,yt.options,"incircle","center"),vt=tt.createIncenter(yt,bt,Ct),vt.dump=!1,at.exists(xt.layer)||(xt.layer=yt.options.layer.circle),Ct=at.copyAttributes(xt,yt.options,"incircle"),_t=ut.createCircle(yt,[vt,function(){var St=Math.sqrt((bt[1].X()-bt[2].X())*(bt[1].X()-bt[2].X())+(bt[1].Y()-bt[2].Y())*(bt[1].Y()-bt[2].Y())),Et=Math.sqrt((bt[0].X()-bt[2].X())*(bt[0].X()-bt[2].X())+(bt[0].Y()-bt[2].Y())*(bt[0].Y()-bt[2].Y())),Tt=Math.sqrt((bt[1].X()-bt[0].X())*(bt[1].X()-bt[0].X())+(bt[1].Y()-bt[0].Y())*(bt[1].Y()-bt[0].Y())),Mt=(St+Et+Tt)/2;return Math.sqrt((Mt-St)*(Mt-Et)*(Mt-Tt)/Mt)}],Ct),_t.elType="incircle",_t.setParents(bt),_t.center=vt,_t.subs={center:_t.center},_t.inherits.push(vt)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`)}return _t},tt.createReflection=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, line]`;for(Et=0;Et<bt.length;++Et)bt[Et]=yt.select(bt[Et]);if(at.isPoint(bt[0]))_t=at.providePoints(yt,[bt[0]],xt,"point")[0];else{if(bt[0].elementClass!==lt.OBJECT_CLASS_CURVE&&bt[0].elementClass!==lt.OBJECT_CLASS_LINE&&bt[0].type!==lt.OBJECT_TYPE_POLYGON&&bt[0].elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Tt);_t=bt[0]}if(bt[1].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Tt);if(vt=bt[1],St=ht.createTransform(yt,[vt],{type:"reflect"}),at.isPoint(_t))Ct=ot.createPoint(yt,[_t,St],xt);else if(_t.elementClass===lt.OBJECT_CLASS_CURVE)Ct=pt.createCurve(yt,[_t,St],xt);else if(_t.elementClass===lt.OBJECT_CLASS_LINE)Ct=ct.createLine(yt,[_t,St],xt);else if(_t.type===lt.OBJECT_TYPE_POLYGON)Ct=gt.createPolygon(yt,[_t,St],xt);else{if(_t.elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Tt);Ct=ut.createCircle(yt,[_t,St],xt)}return _t.addChild(Ct),vt.addChild(Ct),Ct.elType="reflection",Ct.setParents([_t,vt]),Ct.prepareUpdate().update(),at.isPoint(Ct)&&(Ct.generatePolynomial=function(){var Mt=vt.point1.symbolic.x,Rt=vt.point1.symbolic.y,It=vt.point2.symbolic.x,Ot=vt.point2.symbolic.y,Bt=_t.symbolic.x,Nt=_t.symbolic.y,zt=Ct.symbolic.x,Dt=Ct.symbolic.y;return[["((",Dt,")-(",Nt,"))*((",Rt,")-(",Ot,"))+((",Mt,")-(",It,"))*((",zt,")-(",Bt,"))"].join(""),["((",zt,")-(",Mt,"))^2+((",Dt,")-(",Rt,"))^2-((",Bt,")-(",Mt,"))^2-((",Nt,")-(",Rt,"))^2"].join("")]}),Ct},tt.createMirrorElement=function(yt,bt,xt){var vt,_t,Ct,St,Et=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, point]`;if(at.isPoint(bt[0]))vt=at.providePoints(yt,[bt[0]],xt,"point")[0];else{if(bt[0].elementClass!==lt.OBJECT_CLASS_CURVE&&bt[0].elementClass!==lt.OBJECT_CLASS_LINE&&bt[0].type!==lt.OBJECT_TYPE_POLYGON&&bt[0].elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Et);vt=bt[0]}if(!at.isPoint(bt[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Et);if(_t=at.providePoints(yt,[bt[1]],xt,"point")[0],St=ht.createTransform(yt,[Math.PI,_t],{type:"rotate"}),at.isPoint(vt))Ct=ot.createPoint(yt,[vt,St],xt);else if(vt.elementClass===lt.OBJECT_CLASS_CURVE)Ct=pt.createCurve(yt,[vt,St],xt);else if(vt.elementClass===lt.OBJECT_CLASS_LINE)Ct=ct.createLine(yt,[vt,St],xt);else if(vt.type===lt.OBJECT_TYPE_POLYGON)Ct=gt.createPolygon(yt,[vt,St],xt);else{if(vt.elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Et);Ct=ut.createCircle(yt,[vt,St],xt)}return vt.addChild(Ct),_t.addChild(Ct),Ct.elType="mirrorpoint",Ct.setParents([vt,_t]),Ct.prepareUpdate().update(),Ct},tt.createMirrorPoint=function(yt,bt,xt){return tt.createMirrorElement(yt,bt,xt)},tt.createIntegral=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft=null;if(at.isArray(bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_CURVE)vt=bt[0],_t=bt[1];else{if(!at.isArray(bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [[number|function,number|function],curve]`);vt=bt[1],_t=bt[0]}return Ct=at.copyAttributes(xt,yt.options,"integral"),Ct.withLabel=!1,Dt=yt.create("curve",[[0],[0]],Ct),St=vt[0],Et=vt[1],at.isFunction(St)?(Tt=St,Mt=function(){return _t.Y(Tt())},St=Tt()):(Tt=St,Mt=_t.Y(St)),at.isFunction(Et)?(Rt=Et,It=function(){return _t.Y(Rt())},Et=Rt()):(Rt=Et,It=_t.Y(Et)),Ct=at.copyAttributes(xt,yt.options,"integral","curveLeft"),Ot=yt.create("glider",[Tt,Mt,_t],Ct),at.isFunction(Tt)&&Ot.hideElement(),Ct=at.copyAttributes(xt,yt.options,"integral","baseLeft"),Bt=yt.create("point",[function(){return at.evaluate(Dt.visProp.axis)==="y"?0:Ot.X()},function(){return at.evaluate(Dt.visProp.axis)==="y"?Ot.Y():0}],Ct),Ct=at.copyAttributes(xt,yt.options,"integral","curveRight"),Nt=yt.create("glider",[Rt,It,_t],Ct),at.isFunction(Rt)&&Nt.hideElement(),Ct=at.copyAttributes(xt,yt.options,"integral","baseRight"),zt=yt.create("point",[function(){return at.evaluate(Dt.visProp.axis)==="y"?0:Nt.X()},function(){return at.evaluate(Dt.visProp.axis)==="y"?Nt.Y():0}],Ct),Ct=at.copyAttributes(xt,yt.options,"integral"),Ct.withlabel!==!1&&Ct.axis!=="y"&&(Ct=at.copyAttributes(xt,yt.options,"integral","label"),Ct=at.copyAttributes(Ct,yt.options,"label"),Ft=yt.create("text",[function(){var Ut=new st(lt.COORDS_BY_SCREEN,[at.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),$t=this.board.getBoundingBox(),Vt=.1*($t[2]-$t[0]),Zt=Nt.X();return Zt<$t[0]?Zt=$t[0]+Vt:Zt>$t[2]&&(Zt=$t[2]-Vt),Zt+Ut.usrCoords[1]},function(){var Ut=new st(lt.COORDS_BY_SCREEN,[0,at.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),$t=this.board.getBoundingBox(),Vt=.1*($t[1]-$t[3]),Zt=Nt.Y();return Zt>$t[1]?Zt=$t[1]-Vt:Zt<$t[3]&&(Zt=$t[3]+Vt),Zt+Ut.usrCoords[2]},function(){var Ut=it.NewtonCotes([Bt.X(),zt.X()],_t.Y);return"&int; = "+at.toFixed(Ut,4)}],Ct),Ft.dump=!1,Ot.addChild(Ft),Nt.addChild(Ft)),Ot.dump=!1,Bt.dump=!1,Nt.dump=!1,zt.dump=!1,Dt.elType="integral",Dt.setParents([_t.id,vt]),Dt.subs={curveLeft:Ot,baseLeft:Bt,curveRight:Nt,baseRight:zt},Dt.inherits.push(Ot,Bt,Nt,zt),Ct.withLabel&&(Dt.subs.label=Ft,Dt.inherits.push(Ft)),Dt.Value=function(){return it.I([Bt.X(),zt.X()],_t.Y)},Dt.updateDataArray=function(){var Ut,$t,Vt,Zt,qt,sr,er,ir,ur;if(at.evaluate(this.visProp.axis)==="y"){for(Ot.Y()<Nt.Y()?(sr=Ot.X(),ir=Ot.Y(),er=Nt.X(),ur=Nt.Y()):(sr=Nt.X(),ir=Nt.Y(),er=Ot.X(),ur=Ot.Y()),Zt=Math.min(sr,er),qt=Math.max(sr,er),Ut=[0,sr],$t=[ir,ir],Vt=0;Vt<_t.numberPoints;Vt++)ir<=_t.points[Vt].usrCoords[2]&&Zt<=_t.points[Vt].usrCoords[1]&&_t.points[Vt].usrCoords[2]<=ur&&_t.points[Vt].usrCoords[1]<=qt&&(Ut.push(_t.points[Vt].usrCoords[1]),$t.push(_t.points[Vt].usrCoords[2]));Ut.push(er),$t.push(ur),Ut.push(0),$t.push(ur),Ut.push(0),$t.push(ir)}else{for(Bt.X()<zt.X()?(Zt=Bt.X(),qt=zt.X()):(Zt=zt.X(),qt=Bt.X()),Ut=[Zt,Zt],$t=[0,_t.Y(Zt)],Vt=0;Vt<_t.numberPoints;Vt++)Zt<=_t.points[Vt].usrCoords[1]&&_t.points[Vt].usrCoords[1]<=qt&&(Ut.push(_t.points[Vt].usrCoords[1]),$t.push(_t.points[Vt].usrCoords[2]));Ut.push(qt),$t.push(_t.Y(qt)),Ut.push(qt),$t.push(0),Ut.push(Zt),$t.push(0)}this.dataX=Ut,this.dataY=$t},Ot.addChild(Dt),Nt.addChild(Dt),Bt.addChild(Dt),zt.addChild(Dt),Dt.baseLeft=Bt,Dt.baseRight=zt,Dt.curveLeft=Ot,Dt.curveRight=Nt,Dt.methodMap=tt.deepCopy(Dt.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),Dt.label=Ft,Dt},tt.createGrid=function(yt,bt,xt){var vt,_t;return _t=at.copyAttributes(xt,yt.options,"grid"),vt=yt.create("curve",[[null],[null]],_t),vt.elType="grid",vt.type=lt.OBJECT_TYPE_GRID,vt.updateDataArray=function(){var Ct,St,Et,Tt,Mt,Rt=at.evaluate(this.visProp.gridx),It=at.evaluate(this.visProp.gridy);for(Tt=at.isArray(this.visProp.topleft)?new st(at.evaluate(this.visProp.tltype)||lt.COORDS_BY_USER,this.visProp.topleft,yt):new st(lt.COORDS_BY_SCREEN,[0,0],yt),Mt=at.isArray(this.visProp.bottomright)?new st(at.evaluate(this.visProp.brtype)||lt.COORDS_BY_USER,this.visProp.bottomright,yt):new st(lt.COORDS_BY_SCREEN,[yt.canvasWidth,yt.canvasHeight],yt),yt.options.grid.hasGrid=!0,vt.dataX=[],vt.dataY=[],Ct=Math.floor(Tt.usrCoords[2]/It)*It,St=Math.ceil(Mt.usrCoords[2]/It)*It,Tt.usrCoords[2]<Mt.usrCoords[2]&&(Ct=Math.ceil(Mt.usrCoords[2]/It)*It,St=Math.floor(Tt.usrCoords[2]/It)*It),Et=Ct;Et>St-It;Et-=It)vt.dataX.push(Tt.usrCoords[1],Mt.usrCoords[1],NaN),vt.dataY.push(Et,Et,NaN);for(Ct=Math.ceil(Tt.usrCoords[1]/Rt)*Rt,St=Math.floor(Mt.usrCoords[1]/Rt)*Rt,Tt.usrCoords[1]>Mt.usrCoords[1]&&(Ct=Math.floor(Mt.usrCoords[1]/Rt)*Rt,St=Math.ceil(Tt.usrCoords[1]/Rt)*Rt),Et=Ct;Et<St+Rt;Et+=Rt)vt.dataX.push(Et,Et,NaN),vt.dataY.push(Tt.usrCoords[2],Mt.usrCoords[2],NaN)},vt.hasPoint=function(){return!1},yt.grids.push(vt),vt},tt.createInequality=function(yt,bt,xt){var vt,_t,Ct;if(Ct=at.copyAttributes(xt,yt.options,"inequality"),bt[0].elementClass===lt.OBJECT_CLASS_LINE)_t=yt.create("curve",[[],[]],Ct),_t.hasPoint=function(){return!1},_t.updateDataArray=function(){var St,Et,Tt,Mt=yt.getBoundingBox(),Rt=Ct.inverse?-1:1,It=1.5*Math.max(Mt[2]-Mt[0],Mt[1]-Mt[3]),Ot={coords:{usrCoords:[1,(Mt[0]+Mt[2])/2,Ct.inverse?Mt[1]:Mt[3]]}},Bt=bt[0].stdform.slice(1),Nt=Bt;Tt=1.5*Math.max(rt.perpendicular(bt[0],Ot,yt)[0].distance(lt.COORDS_BY_USER,Ot.coords),It),Tt*=Rt,Ot={coords:{usrCoords:[1,(Mt[0]+Mt[2])/2,(Mt[1]+Mt[3])/2]}},Ot=Math.abs(_e.innerProduct(Ot.coords.usrCoords,bt[0].stdform,3))>=_e.eps?rt.perpendicular(bt[0],Ot,yt)[0].usrCoords:Ot.coords.usrCoords,St=[1,Ot[1]+Bt[1]*It,Ot[2]-Bt[0]*It],Et=[1,Ot[1]-Nt[1]*It,Ot[2]+Nt[0]*It],this.dataX=[St[1],St[1]+Bt[0]*Tt,Et[1]+Nt[0]*Tt,Et[1],St[1]],this.dataY=[St[2],St[2]+Bt[1]*Tt,Et[2]+Nt[1]*Tt,Et[2],St[2]]};else if(bt[0].elementClass===lt.OBJECT_CLASS_CURVE&&bt[0].visProp.curvetype==="functiongraph")_t=yt.create("curve",[[],[]],Ct),_t.hasPoint=function(){return!1},_t.updateDataArray=function(){var St,Et,Tt=this.board.getBoundingBox(),Mt=1.5*(Ct.inverse?Tt[1]:Tt[3]);if(this.dataX=[],this.dataY=[],!((Et=bt[0].points.length)<=0)){for(this.dataX.push(bt[0].points[0].usrCoords[1]),this.dataY.push(Mt),St=0;St<Et;St++)this.dataX.push(bt[0].points[St].usrCoords[1]),this.dataY.push(bt[0].points[St].usrCoords[2]);this.dataX.push(bt[0].points[Et-1].usrCoords[1]),this.dataY.push(Mt)}};else if(vt=at.createFunction(bt[0]),!at.exists(vt))throw new Error(`JSXGraph: Can't create area with the given parents.
Possible parent types: [line], [function]`);return _t.addParents(bt[0]),_t},tt.registerElement("arrowparallel",tt.createArrowParallel),tt.registerElement("bisector",tt.createBisector),tt.registerElement("bisectorlines",tt.createAngularBisectorsOfTwoLines),tt.registerElement("msector",tt.createMsector),tt.registerElement("circumcircle",tt.createCircumcircle),tt.registerElement("circumcirclemidpoint",tt.createCircumcenter),tt.registerElement("circumcenter",tt.createCircumcenter),tt.registerElement("incenter",tt.createIncenter),tt.registerElement("incircle",tt.createIncircle),tt.registerElement("integral",tt.createIntegral),tt.registerElement("midpoint",tt.createMidpoint),tt.registerElement("mirrorelement",tt.createMirrorElement),tt.registerElement("mirrorpoint",tt.createMirrorPoint),tt.registerElement("normal",tt.createNormal),tt.registerElement("orthogonalprojection",tt.createOrthogonalProjection),tt.registerElement("parallel",tt.createParallel),tt.registerElement("parallelpoint",tt.createParallelPoint),tt.registerElement("perpendicular",tt.createPerpendicular),tt.registerElement("perpendicularpoint",tt.createPerpendicularPoint),tt.registerElement("perpendicularsegment",tt.createPerpendicularSegment),tt.registerElement("reflection",tt.createReflection),tt.registerElement("grid",tt.createGrid),tt.registerElement("inequality",tt.createInequality),{createArrowParallel:tt.createArrowParallel,createBisector:tt.createBisector,createAngularBisectorOfTwoLines:tt.createAngularBisectorsOfTwoLines,createCircumcircle:tt.createCircumcircle,createCircumcenter:tt.createCircumcenter,createIncenter:tt.createIncenter,createIncircle:tt.createIncircle,createIntegral:tt.createIntegral,createMidpoint:tt.createMidpoint,createMirrorElement:tt.createMirrorElement,createMirrorPoint:tt.createMirrorPoint,createNormal:tt.createNormal,createOrthogonalProjection:tt.createOrthogonalProjection,createParallel:tt.createParallel,createParallelPoint:tt.createParallelPoint,createPerpendicular:tt.createPerpendicular,createPerpendicularPoint:tt.createPerpendicularPoint,createPerpendicularSegmen:tt.createPerpendicularSegment,createReflection:tt.createReflection,createGrid:tt.createGrid,createInequality:tt.createInequality}}),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","parser/geonext","utils/color","utils/type","utils/event","utils/env","base/transformation","base/point","base/line","base/text","element/composition","base/composition"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt){return tt.Board=function(vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,this.BOARD_MODE_ZOOM=17,dt.exists(Bt.document)&&Bt.document!==!1?this.document=Bt.document:document!==void 0&&dt.isObject(document)&&(this.document=document),this.container=vt,this.containerObj=ft.isBrowser?this.document.getElementById(this.container):null,ft.isBrowser&&_t.type!=="no"&&this.containerObj===null)throw new Error(`
JSXGraph: HTML container element '`+vt+"' not found.");this.renderer=_t,this.grids=[],this.options=dt.deepCopy(it),this.attr=Bt,this.dimension=2,this.jc=new ct,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,St[0],St[1]],this.zoomX=Et,this.zoomY=Tt,this.unitX=Mt*this.zoomX,this.unitY=Rt*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=It,this.canvasHeight=Ot,dt.exists(Ct)&&Ct!==""&&ft.isBrowser&&!dt.exists(this.document.getElementById(Ct))?this.id=Ct:this.id=this.generateId(),pt.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(_e.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this.selectingBox=[[0,0],[0,0]],this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},tt.extend(tt.Board.prototype,{generateName:function(vt){var _t,Ct,St=this.attr.maxnamelength,Et="",Tt="",Mt=[],Rt="";if(vt.type===_e.OBJECT_TYPE_TICKS)return"";for(_t=dt.isPoint(vt)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:vt.type===_e.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],dt.isPoint(vt)||vt.elementClass===_e.OBJECT_CLASS_LINE||vt.type===_e.OBJECT_TYPE_ANGLE||(Et=vt.type===_e.OBJECT_TYPE_POLYGON?"P_{":vt.elementClass===_e.OBJECT_CLASS_CIRCLE?"k_{":vt.elementClass===_e.OBJECT_CLASS_TEXT?"t_{":"s_{",Tt="}"),Ct=0;Ct<St;Ct++)Mt[Ct]=0;for(;Mt[St-1]<_t.length;){for(Mt[0]=1;Mt[0]<_t.length;Mt[0]++){for(Rt=Et,Ct=St;Ct>0;Ct--)Rt+=_t[Mt[Ct-1]];if(!dt.exists(this.elementsByName[Rt+Tt]))return Rt+Tt}for(Mt[0]=_t.length,Ct=1;Ct<St;Ct++)Mt[Ct-1]===_t.length&&(Mt[Ct-1]=1,Mt[Ct]+=1)}return""},generateId:function(){for(var vt=1;dt.exists(tt.boards["jxgBoard"+vt]);)vt=Math.round(65535*Math.random());return"jxgBoard"+vt},setId:function(vt,_t){var Ct,St=this.numObjects,Et=vt.id;if(this.numObjects+=1,Et===""||!dt.exists(Et))for(Et=this.id+_t+St;dt.exists(this.objects[Et]);)Ct=Math.round(65535*Math.random()),Et=this.id+_t+St+"-"+Ct;return vt.id=Et,this.objects[Et]=vt,vt._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=vt,Et},finalizeAdding:function(vt){dt.evaluate(vt.visProp.visible)===!1&&this.renderer.display(vt,!1)},finalizeLabel:function(vt){vt.hasLabel&&!dt.evaluate(vt.label.visProp.islabel)&&dt.evaluate(vt.label.visProp.visible)===!1&&this.renderer.display(vt.label,!1)},getCoordsTopLeftCorner:function(){var vt,_t,Ct,St,Et,Tt=this.document.documentElement||this.document.body.parentNode,Mt=this.document.body,Rt=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||new Date().getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=new Date().getTime(),Rt.getBoundingClientRect){for(Ct=Rt.getBoundingClientRect(),St=1,Et=Rt;Et&&dt.exists(Et.parentNode);)dt.exists(Et.style)&&dt.exists(Et.style.zoom)&&Et.style.zoom!==""&&(St*=parseFloat(Et.style.zoom)),Et=Et.parentNode;return vt=[Ct.left*St,Ct.top*St],vt[0]+=ft.getProp(Rt,"border-left-width"),vt[1]+=ft.getProp(Rt,"border-top-width"),this.renderer.type!=="vml"&&(vt[0]+=ft.getProp(Rt,"padding-left"),vt[1]+=ft.getProp(Rt,"padding-top")),this.cPos=vt.slice(),this.cPos}return vt=ft.getOffset(Rt),_t=this.document.documentElement.ownerDocument,!this.containerObj.currentStyle&&_t.defaultView&&(vt[0]+=ft.getProp(Tt,"margin-left"),vt[1]+=ft.getProp(Tt,"margin-top"),vt[0]+=ft.getProp(Tt,"border-left-width"),vt[1]+=ft.getProp(Tt,"border-top-width"),vt[0]+=ft.getProp(Tt,"padding-left"),vt[1]+=ft.getProp(Tt,"padding-top")),Mt&&(vt[0]+=ft.getProp(Mt,"left"),vt[1]+=ft.getProp(Mt,"top")),typeof google=="object"&&google.translate&&(vt[0]+=10,vt[1]+=25),vt[0]+=ft.getProp(Rt,"border-left-width"),vt[1]+=ft.getProp(Rt,"border-top-width"),this.renderer.type!=="vml"&&(vt[0]+=ft.getProp(Rt,"padding-left"),vt[1]+=ft.getProp(Rt,"padding-top")),vt[0]+=this.attr.offsetx,vt[1]+=this.attr.offsety,this.cPos=vt.slice(),this.cPos},getMousePosition:function(vt,_t){var Ct,St,Et=this.getCoordsTopLeftCorner();return Ct=ft.getPosition(vt,_t,this.document),dt.exists(this.cssTransMat)||this.updateCSSTransforms(),St=[1,Ct[0]-Et[0],Ct[1]-Et[1]],St=st.matVecMult(this.cssTransMat,St),St[1]/=St[0],St[2]/=St[0],[St[1],St[2]]},initMoveOrigin:function(vt,_t){this.drag_dx=vt-this.origin.scrCoords[1],this.drag_dy=_t-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(vt,_t,Ct,St){var Et,Tt,Mt,Rt=[],It=[],Ot=this.objectsList.length,Bt={visProp:{layer:-1e4}};for(Tt=0;Tt<Ot;Tt++)Et=this.objectsList[Tt],Mt=Et.hasPoint&&Et.hasPoint(vt,_t),Et.visPropCalc.visible&&Mt&&(Et.triggerEventHandlers([St+"down","down"],[Ct]),this.downObjects.push(Et)),(this.geonextCompatibilityMode&&(dt.isPoint(Et)||Et.elementClass===_e.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&Et.isDraggable&&Et.visPropCalc.visible&&!dt.evaluate(Et.visProp.fixed)&&Mt&&(Et.visProp.layer>Bt.visProp.layer||Et.visProp.layer===Bt.visProp.layer&&Et.lastDragTime.getTime()>=Bt.lastDragTime.getTime())&&(this.attr.ignorelabels&&dt.exists(Bt.label)&&Et===Bt.label||(Bt=Et,Rt.push(Bt),dt.exists(Bt.coords)?It.push(ot.subtract(Bt.coords.scrCoords.slice(1),[vt,_t])):It.push([0,0])));return Rt.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(Rt.length=1,this._drag_offset=It[0]):(Rt=Rt.slice(-1),this._drag_offset=It[It.length-1]),this._drag_offset||(this._drag_offset=[0,0]),this.renderer.type==="svg"&&dt.exists(Rt[0])&&dt.evaluate(Rt[0].visProp.dragtotopoflayer)&&Rt.length===1&&dt.exists(Rt[0].rendNode)&&Rt[0].rendNode.parentNode.appendChild(Rt[0].rendNode),Rt},moveObject:function(vt,_t,Ct,St,Et){var Tt,Mt,Rt,It=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(vt,_t),this);Ct&&Ct.obj&&(Tt=Ct.obj,Tt.coords&&(Mt=Tt.coords.scrCoords.slice()),this.drag_position=[It.scrCoords[1],It.scrCoords[2]],this.drag_position=ot.add(this.drag_position,this._drag_offset),dt.exists(Tt.coords)?Tt.setPositionDirectly(_e.COORDS_BY_SCREEN,this.drag_position):(this.showInfobox(!1),isNaN(Ct.targets[0].Xprev+Ct.targets[0].Yprev)||Tt.setPositionDirectly(_e.COORDS_BY_SCREEN,[It.scrCoords[1],It.scrCoords[2]],[Ct.targets[0].Xprev,Ct.targets[0].Yprev]),Ct.targets[0].Xprev=It.scrCoords[1],Ct.targets[0].Yprev=It.scrCoords[2]),Tt.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(Tt),Tt.prepareUpdate().update(!0).updateRenderer(),Tt.coords&&(Rt=Tt.coords.scrCoords),Tt.coords&&Mt[1]===Rt[1]&&Mt[2]===Rt[2]||(Tt.triggerEventHandlers([Et+"drag","drag"],[St]),this.update()),Tt.highlight(!0),Tt.lastDragTime=new Date)},twoFingerMove:function(vt,_t,Ct,St){var Et,Tt,Mt;dt.exists(Ct)&&dt.exists(Ct.obj)&&(Mt=Ct.obj,Et=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(vt[0],vt[1]),this),Tt=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(_t[0],_t[1]),this),Mt.elementClass===_e.OBJECT_CLASS_LINE||Mt.type===_e.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(Et,Tt,Ct,Mt):Mt.elementClass===_e.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(Et,Tt,Ct,Mt),Mt.triggerEventHandlers(["touchdrag","drag"],[St]),Ct.targets[0].Xprev=Et.scrCoords[1],Ct.targets[0].Yprev=Et.scrCoords[2],Ct.targets[1].Xprev=Tt.scrCoords[1],Ct.targets[1].Yprev=Tt.scrCoords[2])},twoFingerTouchObject:function(vt,_t,Ct,St){var Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft,Ut,$t,Vt,Zt,qt,sr,er,ir;if(dt.exists(Ct.targets[0])&&dt.exists(Ct.targets[1])&&!isNaN(Ct.targets[0].Xprev+Ct.targets[0].Yprev+Ct.targets[1].Xprev+Ct.targets[1].Yprev)){if(Et=vt.usrCoords,Tt=_t.usrCoords,Mt=new rt(_e.COORDS_BY_SCREEN,[Ct.targets[0].Xprev,Ct.targets[0].Yprev],this).usrCoords,Rt=new rt(_e.COORDS_BY_SCREEN,[Ct.targets[1].Xprev,Ct.targets[1].Yprev],this).usrCoords,Ot=[1,.5*(Mt[1]+Rt[1]),.5*(Mt[2]+Rt[2])],It=[1,.5*(Et[1]+Tt[1]),.5*(Et[2]+Tt[2])],Nt=st.crossProduct(Mt,Rt),Bt=st.crossProduct(Et,Tt),Dt=st.crossProduct(Nt,Bt),Math.abs(Dt[0])<st.eps)return;if(Dt[1]/=Dt[0],Dt[2]/=Dt[0],Ft=at.rad(Ot.slice(1),Dt.slice(1),It.slice(1)),Ut=this.create("transform",[Ft,Dt[1],Dt[2]],{type:"rotate"}),Ut.update(),Ot=st.matVecMult(Ut.matrix,Ot),Ot[1]/=Ot[0],Ot[2]/=Ot[0],$t=this.create("transform",[It[1]-Ot[1],It[2]-Ot[2]],{type:"translate"}),$t.update(),Ut.melt($t),dt.evaluate(St.visProp.scalable)&&(zt=at.distance(Et,Tt)/at.distance(Mt,Rt),Vt=this.create("transform",[-It[1],-It[2]],{type:"translate"}),Zt=this.create("transform",[zt,zt],{type:"scale"}),qt=this.create("transform",[It[1],It[2]],{type:"translate"}),Ut.melt(Vt).melt(Zt).melt(qt)),St.elementClass===_e.OBJECT_CLASS_LINE)sr=[],St.point1.draggable()&&sr.push(St.point1),St.point2.draggable()&&sr.push(St.point2),Ut.applyOnce(sr);else if(St.type===_e.OBJECT_TYPE_POLYGON){for(sr=[],ir=St.vertices.length-1,er=0;er<ir;++er)St.vertices[er].draggable()&&sr.push(St.vertices[er]);Ut.applyOnce(sr)}this.update(),St.highlight(!0)}},twoFingerTouchCircle:function(vt,_t,Ct,St){var Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft;St.method!=="pointCircle"&&St.method!=="pointLine"&&dt.exists(Ct.targets[0])&&dt.exists(Ct.targets[1])&&!isNaN(Ct.targets[0].Xprev+Ct.targets[0].Yprev+Ct.targets[1].Xprev+Ct.targets[1].Yprev)&&(Et=vt.usrCoords,Tt=_t.usrCoords,Mt=new rt(_e.COORDS_BY_SCREEN,[Ct.targets[0].Xprev,Ct.targets[0].Yprev],this).usrCoords,Rt=new rt(_e.COORDS_BY_SCREEN,[Ct.targets[1].Xprev,Ct.targets[1].Yprev],this).usrCoords,Bt=this.create("transform",[Et[1]-Mt[1],Et[2]-Mt[2]],{type:"translate"}),Ot=at.rad(Rt.slice(1),Et.slice(1),Tt.slice(1)),Nt=this.create("transform",[-Et[1],-Et[2]],{type:"translate"}),zt=this.create("transform",[Ot],{type:"rotate"}),Bt.melt(Nt).melt(zt),dt.evaluate(St.visProp.scalable)&&(It=at.distance(Et,Tt)/at.distance(Mt,Rt),Dt=this.create("transform",[It,It],{type:"scale"}),Bt.melt(Dt)),Ft=this.create("transform",[Et[1],Et[2]],{type:"translate"}),Bt.melt(Ft),St.center.draggable()&&Bt.applyOnce([St.center]),St.method==="twoPoints"?St.point2.draggable()&&Bt.applyOnce([St.point2]):St.method==="pointRadius"&&dt.isNumber(St.updateRadius.origin)&&St.setRadius(St.radius*It),this.update(St.center),St.highlight(!0))},highlightElements:function(vt,_t,Ct,St){var Et,Tt,Mt,Rt={},It=this.objectsList.length;for(Et=0;Et<It;Et++)Tt=this.objectsList[Et],Mt=Tt.id,dt.exists(Tt.hasPoint)&&Tt.visPropCalc.visible&&Tt.hasPoint(vt,_t)&&(this.updateInfobox(Tt),dt.exists(this.highlightedObjects[Mt])||(Rt[Mt]=Tt,Tt.highlight(),Tt.triggerEventHandlers(["mousehit","hit"],[Ct,Tt,St])),Tt.mouseover?Tt.triggerEventHandlers(["mousemove","move"],[Ct]):(Tt.triggerEventHandlers(["mouseover","over"],[Ct]),Tt.mouseover=!0));for(Et=0;Et<It;Et++)Tt=this.objectsList[Et],Mt=Tt.id,Tt.mouseover&&(Rt[Mt]||(Tt.triggerEventHandlers(["mouseout","out"],[Ct]),Tt.mouseover=!1))},saveStartPos:function(vt,_t){var Ct,St,Et=[];if(vt.type===_e.OBJECT_TYPE_TICKS)Et.push([1,NaN,NaN]);else if(vt.elementClass===_e.OBJECT_CLASS_LINE)Et.push(vt.point1.coords.usrCoords),Et.push(vt.point2.coords.usrCoords);else if(vt.elementClass===_e.OBJECT_CLASS_CIRCLE)Et.push(vt.center.coords.usrCoords),vt.method==="twoPoints"&&Et.push(vt.point2.coords.usrCoords);else if(vt.type===_e.OBJECT_TYPE_POLYGON)for(St=vt.vertices.length-1,Ct=0;Ct<St;Ct++)Et.push(vt.vertices[Ct].coords.usrCoords);else if(vt.type===_e.OBJECT_TYPE_SECTOR)Et.push(vt.point1.coords.usrCoords),Et.push(vt.point2.coords.usrCoords),Et.push(vt.point3.coords.usrCoords);else if(dt.isPoint(vt)||vt.type===_e.OBJECT_TYPE_GLIDER)Et.push(vt.coords.usrCoords);else if(vt.elementClass===_e.OBJECT_CLASS_CURVE)vt.points.length>0&&Et.push(vt.points[0].usrCoords);else try{Et.push(vt.coords.usrCoords)}catch(Tt){tt.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+Tt)}for(St=Et.length,Ct=0;Ct<St;Ct++)_t.Zstart.push(Et[Ct][0]),_t.Xstart.push(Et[Ct][1]),_t.Ystart.push(Et[Ct][2])},mouseOriginMoveStart:function(vt){var _t,Ct;return _t=this._isRequiredKeyPressed(vt,"pan"),_t&&(Ct=this.getMousePosition(vt),this.initMoveOrigin(Ct[0],Ct[1])),_t},mouseOriginMove:function(vt){var _t,Ct=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return Ct&&(_t=this.getMousePosition(vt),this.moveOrigin(_t[0],_t[1],!0)),Ct},touchOriginMoveStart:function(vt){var _t,Ct,St=vt[tt.touchProperty];return _t=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&St.length==1,_t&&(Ct=this.getMousePosition(vt,0),this.initMoveOrigin(Ct[0],Ct[1])),_t},touchOriginMove:function(vt){var _t,Ct=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return Ct&&(_t=this.getMousePosition(vt,0),this.moveOrigin(_t[0],_t[1],!0)),Ct},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){ft.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),this.containerObj!==null&&(this.containerObj.oncontextmenu=function(vt){return dt.exists(vt)&&vt.preventDefault(),!1})},addPointerEventHandlers:function(){!this.hasPointerHandlers&&ft.isBrowser&&(window.navigator.msPointerEnabled?(ft.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),ft.addEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(ft.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),ft.addEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),ft.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),ft.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.containerObj!==null&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0)},addMouseEventHandlers:function(){!this.hasMouseHandlers&&ft.isBrowser&&(ft.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),ft.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),ft.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),ft.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0)},addTouchEventHandlers:function(vt){!this.hasTouchHandlers&&ft.isBrowser&&(ft.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),ft.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0)},removePointerEventHandlers:function(){this.hasPointerHandlers&&ft.isBrowser&&(window.navigator.msPointerEnabled?(ft.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),ft.removeEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(ft.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),ft.removeEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),ft.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),ft.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?ft.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):ft.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.hasPointerHandlers=!1)},removeMouseEventHandlers:function(){this.hasMouseHandlers&&ft.isBrowser&&(ft.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),ft.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(ft.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),ft.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),ft.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1)},removeTouchEventHandlers:function(){this.hasTouchHandlers&&ft.isBrowser&&(ft.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),ft.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(ft.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1)},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers()},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(vt){var _t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt=this.attr.zoom.factorx,Nt=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(vt.preventDefault(),_t=new rt(_e.COORDS_BY_SCREEN,this.getMousePosition(vt,0),this),St=at.distance([vt.touches[0].clientX,vt.touches[0].clientY],[vt.touches[1].clientX,vt.touches[1].clientY],2),vt.scale===void 0&&(vt.scale=St/this.prevDist),Ct=vt.scale/this.prevScale,this.prevScale=vt.scale,this.attr.pan.enabled&&this.attr.pan.needtwofingers&&Math.abs(vt.scale-1)<.4&&this._num_pan>=.8*this._num_zoom?(this._num_pan++,this.moveOrigin(_t.scrCoords[1],_t.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(Ct-1)<.5&&(this._num_zoom++,(this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(Et=Math.abs(vt.touches[0].clientX-vt.touches[1].clientX),Tt=Math.abs(vt.touches[0].clientY-vt.touches[1].clientY),Mt=Math.abs(Math.atan2(Tt,Et)),Ot=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&Mt<Ot?(this.attr.zoom.factorx=Ct,this.attr.zoom.factory=1,Rt=0,It=0):this.attr.zoom.pinchvertical&&Math.abs(Mt-.5*Math.PI)<Ot?(this.attr.zoom.factorx=1,this.attr.zoom.factory=Ct,Rt=0,It=0):(this.attr.zoom.factorx=Ct,this.attr.zoom.factory=Ct,Rt=_t.usrCoords[1],It=_t.usrCoords[2]),this.zoomIn(Rt,It),this.attr.zoom.factorx=Bt,this.attr.zoom.factory=Nt),!1)},gestureStartListener:function(vt){var _t;return vt.preventDefault(),this.prevScale=1,this.prevDist=at.distance([vt.touches[0].clientX,vt.touches[0].clientY],[vt.touches[1].clientX,vt.touches[1].clientY],2),_t=this.getMousePosition(vt,0),this.initMoveOrigin(_t[0],_t[1]),this._num_zoom=this._num_pan=0,this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(vt,_t){var Ct=this.attr[_t];return!!Ct.enabled&&!(!(Ct.needshift&&vt.shiftKey||!Ct.needshift&&!vt.shiftKey)||!(Ct.needctrl&&vt.ctrlKey||!Ct.needctrl&&!vt.ctrlKey))},_pointerAddBoardTouches:function(vt){var _t,Ct;for(_t=0,Ct=!1;_t<this._board_touches.length;_t++)if(this._board_touches[_t].pointerId===vt.pointerId){this._board_touches[_t].clientX=vt.clientX,this._board_touches[_t].clientY=vt.clientY,Ct=!0;break}return Ct||this._board_touches.push({pointerId:vt.pointerId,clientX:vt.clientX,clientY:vt.clientY}),this},_pointerRemoveBoardTouches:function(vt){var _t;for(_t=0;_t<this._board_touches.length;_t++)if(this._board_touches[_t].pointerId===vt.pointerId){this._board_touches.splice(_t,1);break}return this},pointerDownListener:function(vt,_t){var Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt=this.options.precision.touch;if(this.hasPointerUp||(window.navigator.msPointerEnabled?ft.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):ft.addEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&dt.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(Rt=window.getSelection(),Rt.removeAllRanges))try{Rt.removeAllRanges()}catch{}if(ft.isBrowser&&(vt.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=Bt),Tt=this.getMousePosition(vt),this._testForSelection(vt),this.selectingMode)return this._startSelecting(Tt),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[vt]);if(_t?(Mt=[_t],this.mode=this.BOARD_MODE_DRAG):Mt=this.initMoveObject(Tt[0],Tt[1],vt,"mouse"),Mt.length>0){for(Ot=Mt[Mt.length-1],It=!1,Ct=0;Ct<this.touches.length;Ct++)if(this.touches[Ct].obj===Ot){St=Ct,Et=this.touches[Ct].targets.push({num:vt.pointerId,X:Tt[0],Y:Tt[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]})-1,It=!0;break}It||(Et=0,St=this.touches.push({obj:Ot,targets:[{num:vt.pointerId,X:Tt[0],Y:Tt[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}]})-1),this.dehighlightAll(),Ot.highlight(!0),this.saveStartPos(Ot,this.touches[St].targets[Et]),vt&&vt.preventDefault?vt.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(vt.preventDefault(),vt.stopPropagation()),this.options.precision.hasPoint=this.options.precision.mouse,ft.isBrowser&&vt.pointerType!=="touch"?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(vt):(this._pointerAddBoardTouches(vt),vt.touches=this._board_touches,this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(vt)||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||vt.touches.length!=2||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(vt))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[vt]),!1},pointerMoveListener:function(vt){var _t,Ct,St;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(vt.preventDefault(),vt.stopPropagation()),ft.isBrowser&&(vt.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=this.options.precision.touch),this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode)St=this.getMousePosition(vt),this._moveSelecting(St),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[vt,this.mode]);else if(!this.mouseOriginMove(vt))if(this.mode===this.BOARD_MODE_DRAG){for(_t=0;_t<this.touches.length;_t++)for(Ct=0;Ct<this.touches[_t].targets.length;Ct++)if(this.touches[_t].targets[Ct].num===vt.pointerId){this.touches[_t].targets.length===1?(this.touches[_t].targets[Ct].X=vt.pageX,this.touches[_t].targets[Ct].Y=vt.pageY,St=this.getMousePosition(vt),this.moveObject(St[0],St[1],this.touches[_t],vt,"touch")):this.touches[_t].targets.length===2&&this.touches[_t].targets[0].num>-1&&this.touches[_t].targets[1].num>-1&&(this.touches[_t].targets[Ct].X=vt.pageX,this.touches[_t].targets[Ct].Y=vt.pageY,this.twoFingerMove(this.getMousePosition({clientX:this.touches[_t].targets[0].X,clientY:this.touches[_t].targets[0].Y}),this.getMousePosition({clientX:this.touches[_t].targets[1].X,clientY:this.touches[_t].targets[1].Y}),this.touches[_t],vt));break}}else vt.pointerType=="touch"?(this._pointerAddBoardTouches(vt),this._board_touches.length==2&&(vt.touches=this._board_touches,this.gestureChangeListener(vt))):(St=this.getMousePosition(vt),this.highlightElements(St[0],St[1],vt,-1));return this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[vt,this.mode]),this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(vt){var _t,Ct,St;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[vt]),this.showInfobox(!1),vt){for(_t=0;_t<this.touches.length;_t++)for(Ct=0;Ct<this.touches[_t].targets.length;Ct++)if(this.touches[_t].targets[Ct].num===vt.pointerId){this.touches[_t].targets.splice(Ct,1),this.touches[_t].targets.length===0&&this.touches.splice(_t,1);break}}if(this.selectingMode)this._stopSelecting(vt),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[vt]);else for(_t=this.downObjects.length-1;_t>-1;_t--){for(St=!1,Ct=0;Ct<this.touches.length;Ct++)this.touches[Ct].obj.id===this.downObjects[_t].id&&(St=!0);St||(this.downObjects[_t].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[vt]),this.downObjects[_t].snapToGrid(),this.downObjects[_t].snapToPoints(),this.downObjects.splice(_t,1))}return this._pointerRemoveBoardTouches(vt),this._board_touches.length===0&&(this.hasPointerUp&&(window.navigator.msPointerEnabled?ft.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):ft.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this.originMoveEnd(),this.update()),!0},touchStartListener:function(vt){var _t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt=this.options.precision.touch,Nt=vt[tt.touchProperty];for(this.hasTouchEnd||(ft.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&dt.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.options.precision.hasPoint=this.options.precision.touch,_t=0;_t<Nt.length;_t++)Nt[_t].jxg_isused=!1;for(_t=0;_t<this.touches.length;_t++)for(Et=0;Et<this.touches[_t].targets.length;Et++){this.touches[_t].targets[Et].num=-1,Bt=this.options.precision.touch;do{for(Tt=0;Tt<Nt.length;Tt++)if(Math.abs(Math.pow(Nt[Tt].screenX-this.touches[_t].targets[Et].X,2)+Math.pow(Nt[Tt].screenY-this.touches[_t].targets[Et].Y,2))<Bt*Bt){this.touches[_t].targets[Et].num=Tt,this.touches[_t].targets[Et].X=Nt[Tt].screenX,this.touches[_t].targets[Et].Y=Nt[Tt].screenY,Nt[Tt].jxg_isused=!0;break}Bt*=2}while(this.touches[_t].targets[Et].num===-1&&Bt<this.options.precision.touchMax);this.touches[_t].targets[Et].num===-1&&(tt.debug("i couldn't find a targettouches for target no "+Et+" on "+this.touches[_t].obj.name+" ("+this.touches[_t].obj.id+"). Removed the target."),tt.debug("eps = "+Bt+", touchMax = "+it.precision.touchMax),this.touches[_t].targets.splice(_t,1))}for(_t=0;_t<Nt.length;_t++)if(!Nt[_t].jxg_isused){if(Ct=this.getMousePosition(vt,_t),this.selectingMode)return this._startSelecting(Ct),this.triggerEventHandlers(["touchstartselecting","startselecting"],[vt]),vt.preventDefault(),vt.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if(St=this.initMoveObject(Ct[0],Ct[1],vt,"touch"),St.length!==0){if(Mt=St[St.length-1],dt.isPoint(Mt)||Mt.elementClass===_e.OBJECT_CLASS_TEXT||Mt.type===_e.OBJECT_TYPE_TICKS||Mt.type===_e.OBJECT_TYPE_IMAGE)It=[{num:_t,X:Nt[_t].screenX,Y:Nt[_t].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(Mt,It[0]),this.touches.push({obj:Mt,targets:It}),Mt.highlight(!0);else if(Mt.elementClass===_e.OBJECT_CLASS_LINE||Mt.elementClass===_e.OBJECT_CLASS_CIRCLE||Mt.elementClass===_e.OBJECT_CLASS_CURVE||Mt.type===_e.OBJECT_TYPE_POLYGON){for(Rt=!1,Et=0;Et<this.touches.length;Et++)Mt.id===this.touches[Et].obj.id&&(Rt=!0,this.touches[Et].targets.length===1&&(Ot={num:_t,X:Nt[_t].screenX,Y:Nt[_t].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},this.saveStartPos(Mt,Ot),this.touches[Et].targets.push(Ot)),Nt[_t].jxg_isused=!0);Rt||(It=[{num:_t,X:Nt[_t].screenX,Y:Nt[_t].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(Mt,It[0]),this.touches.push({obj:Mt,targets:It}),Mt.highlight(!0))}}Nt[_t].jxg_isused=!0}return this.touches.length>0&&(vt.preventDefault(),vt.stopPropagation()),this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(vt)||Nt.length!=2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(vt)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[vt]),!1},touchMoveListener:function(vt){var _t,Ct,St,Et=vt[tt.touchProperty];if(this.mode!==this.BOARD_MODE_NONE&&(vt.preventDefault(),vt.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(_t=0;_t<Et.length;_t++)if(!Et[_t].jxg_isused){Ct=this.getMousePosition(vt,_t),this._moveSelecting(Ct),this.triggerEventHandlers(["touchmoves","moveselecting"],[vt,this.mode]);break}}else if(!this.touchOriginMove(vt))if(this.mode===this.BOARD_MODE_DRAG){for(_t=0;_t<this.touches.length;_t++)if(this.touches[_t].targets.length===1){if(Et[this.touches[_t].targets[0].num]){if(Ct=this.getMousePosition(vt,this.touches[_t].targets[0].num),Ct[0]<0||Ct[0]>this.canvasWidth||Ct[1]<0||Ct[1]>this.canvasHeight)return;this.touches[_t].targets[0].X=Et[this.touches[_t].targets[0].num].screenX,this.touches[_t].targets[0].Y=Et[this.touches[_t].targets[0].num].screenY,this.moveObject(Ct[0],Ct[1],this.touches[_t],vt,"touch")}}else if(this.touches[_t].targets.length===2&&this.touches[_t].targets[0].num>-1&&this.touches[_t].targets[1].num>-1&&Et[this.touches[_t].targets[0].num]&&Et[this.touches[_t].targets[1].num]){if(Ct=this.getMousePosition(vt,this.touches[_t].targets[0].num),St=this.getMousePosition(vt,this.touches[_t].targets[1].num),Ct[0]<0||Ct[0]>this.canvasWidth||Ct[1]<0||Ct[1]>this.canvasHeight||St[0]<0||St[0]>this.canvasWidth||St[1]<0||St[1]>this.canvasHeight)return;this.touches[_t].targets[0].X=Et[this.touches[_t].targets[0].num].screenX,this.touches[_t].targets[0].Y=Et[this.touches[_t].targets[0].num].screenY,this.touches[_t].targets[1].X=Et[this.touches[_t].targets[1].num].screenX,this.touches[_t].targets[1].Y=Et[this.touches[_t].targets[1].num].screenY,this.twoFingerMove(Ct,St,this.touches[_t],vt)}}else Et.length==2&&this.gestureChangeListener(vt);return this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move"],[vt,this.mode]),this.mode===this.BOARD_MODE_NONE},touchEndListener:function(vt){var _t,Ct,St,Et,Tt,Mt=this.options.precision.touch,Rt=[],It=vt&&vt[tt.touchProperty];if(this.triggerEventHandlers(["touchend","up"],[vt]),this.showInfobox(!1),this.selectingMode)this._stopSelecting(vt),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[vt]);else if(It&&It.length>0){for(_t=0;_t<this.touches.length;_t++)Rt[_t]=this.touches[_t];for(this.touches.length=0,_t=0;_t<It.length;_t++)It[_t].jxg_isused=!1;for(_t=0;_t<Rt.length;_t++){for(Et=!1,Tt=0,Ct=0;Ct<Rt[_t].targets.length;Ct++)for(Rt[_t].targets[Ct].found=!1,St=0;St<It.length;St++)if(Math.abs(Math.pow(It[St].screenX-Rt[_t].targets[Ct].X,2)+Math.pow(It[St].screenY-Rt[_t].targets[Ct].Y,2))<Mt*Mt){Rt[_t].targets[Ct].found=!0,Rt[_t].targets[Ct].num=St,Rt[_t].targets[Ct].X=It[St].screenX,Rt[_t].targets[Ct].Y=It[St].screenY,Tt+=1;break}if(dt.isPoint(Rt[_t].obj)?Et=Rt[_t].targets[0]&&Rt[_t].targets[0].found:Rt[_t].obj.elementClass===_e.OBJECT_CLASS_LINE?Et=Rt[_t].targets[0]&&Rt[_t].targets[0].found||Rt[_t].targets[1]&&Rt[_t].targets[1].found:Rt[_t].obj.elementClass===_e.OBJECT_CLASS_CIRCLE&&(Et=Tt===1||Tt===3),Et)for(this.touches.push({obj:Rt[_t].obj,targets:[]}),Ct=0;Ct<Rt[_t].targets.length;Ct++)Rt[_t].targets[Ct].found&&this.touches[this.touches.length-1].targets.push({num:Rt[_t].targets[Ct].num,X:Rt[_t].targets[Ct].screenX,Y:Rt[_t].targets[Ct].screenY,Xprev:NaN,Yprev:NaN,Xstart:Rt[_t].targets[Ct].Xstart,Ystart:Rt[_t].targets[Ct].Ystart,Zstart:Rt[_t].targets[Ct].Zstart});else Rt[_t].obj.noHighlight()}}else this.touches.length=0;for(_t=this.downObjects.length-1;_t>-1;_t--){for(Et=!1,Ct=0;Ct<this.touches.length;Ct++)this.touches[Ct].obj.id===this.downObjects[_t].id&&(Et=!0);Et||(this.downObjects[_t].triggerEventHandlers(["touchup","up"],[vt]),this.downObjects[_t].snapToGrid(),this.downObjects[_t].snapToPoints(),this.downObjects.splice(_t,1))}return It&&It.length!==0||(this.hasTouchEnd&&(ft.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(vt){var _t,Ct,St;if(this.document.selection&&dt.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return ft.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,_t=this.getMousePosition(vt),this._testForSelection(vt),this.selectingMode?(this._startSelecting(_t),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[vt])):(Ct=this.initMoveObject(_t[0],_t[1],vt,"mouse"),Ct.length===0?(this.mode=this.BOARD_MODE_NONE,St=!0):(this.mouse={obj:null,targets:[{X:_t[0],Y:_t[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=Ct[Ct.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),vt&&vt.preventDefault?vt.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(St=this.mouseOriginMoveStart(vt)),this.triggerEventHandlers(["mousedown","down"],[vt]),St)},mouseMoveListener:function(vt){var _t;_t=this.getMousePosition(vt),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.selectingMode?(this._moveSelecting(_t),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[vt,this.mode])):this.mouseOriginMove(vt)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(_t[0],_t[1],this.mouse,vt,"mouse"):this.highlightElements(_t[0],_t[1],vt,-1),this.triggerEventHandlers(["mousemove","move"],[vt,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(vt){var _t;if(this.selectingMode===!1&&this.triggerEventHandlers(["mouseup","up"],[vt]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&(this.mouse.obj.snapToGrid(this.mouse.targets[0]),this.mouse.obj.snapToPoints()),this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(vt),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[vt]);else for(_t=0;_t<this.downObjects.length;_t++)this.downObjects[_t].triggerEventHandlers(["mouseup","up"],[vt]);this.downObjects.length=0,this.hasMouseUp&&(ft.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(vt){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(vt,"zoom"))return!0;vt=vt||window.event;var _t=vt.detail?-vt.detail:vt.wheelDelta/40,Ct=new rt(_e.COORDS_BY_SCREEN,this.getMousePosition(vt),this);return _t>0?this.zoomIn(Ct.usrCoords[1],Ct.usrCoords[2]):this.zoomOut(Ct.usrCoords[1],Ct.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[vt]),vt.preventDefault(),!1},initInfobox:function(){var vt=dt.copyAttributes({},this.options,"infobox");return vt.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],vt),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.showInfobox(!1),this},updateInfobox:function(vt){var _t,Ct,St,Et,Tt;return dt.evaluate(vt.visProp.showinfobox)?(dt.isPoint(vt)&&(St=vt.coords.usrCoords[1],Et=vt.coords.usrCoords[2],Tt=dt.evaluate(vt.visProp.infoboxdigits),this.infobox.setCoords(St+this.infobox.distanceX/this.unitX,Et+this.infobox.distanceY/this.unitY),typeof vt.infoboxText!="string"?(Tt==="auto"?(_t=dt.autoDigits(St),Ct=dt.autoDigits(Et)):dt.isNumber(Tt)?(_t=dt.toFixed(St,Tt),Ct=dt.toFixed(Et,Tt)):(_t=St,Ct=Et),this.highlightInfobox(_t,Ct,vt)):this.highlightCustomInfobox(vt.infoboxText,vt),this.showInfobox(!0)),this):this},showInfobox:function(vt){return this.infobox.hiddenByParent==vt&&(this.infobox.hiddenByParent=!vt,this.infobox.prepareUpdate().updateVisibility(vt).updateRenderer()),this},highlightInfobox:function(vt,_t,Ct){return this.highlightCustomInfobox("("+vt+", "+_t+")",Ct),this},highlightCustomInfobox:function(vt,_t){return this.infobox.setText(vt),this},dehighlightAll:function(){var vt,_t,Ct=!1;for(vt in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(vt)&&(_t=this.highlightedObjects[vt],(this.hasMouseHandlers||this.hasPointerHandlers)&&_t.noHighlight(),Ct=!0);return this.highlightedObjects={},this.renderer.type==="canvas"&&Ct&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(vt,_t){return[vt,_t]},getUsrCoordsOfMouse:function(vt){var _t=this.getCoordsTopLeftCorner(),Ct=ft.getPosition(vt,null,this.document),St=Ct[0]-_t[0],Et=Ct[1]-_t[1];return new rt(_e.COORDS_BY_SCREEN,[St,Et],this).usrCoords.slice(1)},getAllUnderMouse:function(vt){var _t=this.getAllObjectsUnderMouse(vt);return _t.push(this.getUsrCoordsOfMouse(vt)),_t},getAllObjectsUnderMouse:function(vt){var _t,Ct,St=this.getCoordsTopLeftCorner(),Et=ft.getPosition(vt,null,this.document),Tt=Et[0]-St[0],Mt=Et[1]-St[1],Rt=[],It=this.objectsList.length;for(_t=0;_t<It;_t++)Ct=this.objectsList[_t],Ct.visPropCalc.visible&&Ct.hasPoint&&Ct.hasPoint(Tt,Mt)&&(Rt[Rt.length]=Ct);return Rt},updateCoords:function(){var vt,_t,Ct=this.objectsList.length;for(_t=0;_t<Ct;_t++)vt=this.objectsList[_t],dt.exists(vt.coords)&&(dt.evaluate(vt.visProp.frozen)?vt.coords.screen2usr():vt.coords.usr2screen());return this},moveOrigin:function(vt,_t,Ct){return dt.exists(vt)&&dt.exists(_t)&&(this.origin.scrCoords[1]=vt,this.origin.scrCoords[2]=_t,Ct&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(vt){var _t,Ct,St,Et,Tt,Mt,Rt,It=[],Ot=`var el, x, y, c, rgbo;
`,Bt=vt.indexOf("<data>"),Nt=vt.indexOf("</data>"),zt=function(Ft,Ut,$t,Vt){return function(){var Zt,qt;Zt=Ft.select(Ut.id),qt=Zt.coords.usrCoords[Vt],Vt===2?Zt.setPositionDirectly(_e.COORDS_BY_USER,[$t(),qt]):Zt.setPositionDirectly(_e.COORDS_BY_USER,[qt,$t()]),Zt.prepareUpdate().update()}},Dt=function(Ft,Ut,$t,Vt){return function(){var Zt,qt;Zt=Ft.select(Ut.id),qt=$t(),Vt==="strokewidth"?Zt.visProp.strokewidth=qt:(qt=ht.rgba2rgbo(qt),Zt.visProp[Vt+"color"]=qt[0],Zt.visProp[Vt+"opacity"]=qt[1])}};if(!(Bt<0)){for(;Bt>=0;){if(_t=vt.slice(Bt+6,Nt),Ct=_t.indexOf("="),St=_t.slice(0,Ct),Et=_t.slice(Ct+1),Ct=St.indexOf("."),Tt=St.slice(0,Ct),Mt=this.elementsByName[dt.unescapeHTML(Tt)],Rt=St.slice(Ct+1).replace(/\s+/g,"").toLowerCase(),Et=dt.createFunction(Et,this,"",!0),dt.exists(this.elementsByName[Tt]))switch(Ot+='el = this.objects["'+Mt.id+`"];
`,Rt){case"x":It.push(zt(this,Mt,Et,2));break;case"y":It.push(zt(this,Mt,Et,1));break;case"visible":It.push(function(Ft,Ut,$t){return function(){var Vt,Zt;Vt=Ft.select(Ut.id),Zt=$t(),Vt.setAttribute({visible:Zt})}}(this,Mt,Et));break;case"position":It.push(function(Ft,Ut,$t){return function(){Ft.select(Ut.id).position=$t()}}(this,Mt,Et));break;case"stroke":It.push(Dt(this,Mt,Et,"stroke"));break;case"style":It.push(function(Ft,Ut,$t){return function(){Ft.select(Ut.id).setStyle($t())}}(this,Mt,Et));break;case"strokewidth":It.push(Dt(this,Mt,Et,"strokewidth"));break;case"fill":It.push(Dt(this,Mt,Et,"fill"));break;case"label":break;default:tt.debug("property '"+Rt+"' in conditions not yet implemented:"+Et)}else tt.debug("debug conditions: |"+Tt+"| undefined");vt=vt.slice(Nt+7),Bt=vt.indexOf("<data>"),Nt=vt.indexOf("</data>")}this.updateConditions=function(){var Ft;for(Ft=0;Ft<It.length;Ft++)It[Ft]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var vt=new rt(_e.COORDS_BY_USER,[0,0],this),_t=new rt(_e.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),Ct=vt.scrCoords[1]-_t.scrCoords[1],St=vt.scrCoords[2]-_t.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(Ct)>25;)this.options.grid.snapSizeX*=2,Ct/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(St)>25;)this.options.grid.snapSizeY*=2,St/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(vt,_t){var Ct=this.getBoundingBox(),St=this.attr.zoom.factorx,Et=this.attr.zoom.factory,Tt=(Ct[2]-Ct[0])*(1-1/St),Mt=(Ct[1]-Ct[3])*(1-1/Et),Rt=.5,It=.5,Ot=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&St>1||this.zoomY>this.attr.zoom.max&&Et>1||this.zoomX<Ot&&St<1||this.zoomY<Ot&&Et<1?this:(dt.isNumber(vt)&&dt.isNumber(_t)&&(Rt=(vt-Ct[0])/(Ct[2]-Ct[0]),It=(Ct[1]-_t)/(Ct[1]-Ct[3])),this.setBoundingBox([Ct[0]+Tt*Rt,Ct[1]-Mt*It,Ct[2]-Tt*(1-Rt),Ct[3]+Mt*(1-It)],!1),this.zoomX*=St,this.zoomY*=Et,this.applyZoom())},zoomOut:function(vt,_t){var Ct=this.getBoundingBox(),St=this.attr.zoom.factorx,Et=this.attr.zoom.factory,Tt=(Ct[2]-Ct[0])*(1-St),Mt=(Ct[1]-Ct[3])*(1-Et),Rt=.5,It=.5,Ot=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<Ot||this.zoomY<Ot?this:(dt.isNumber(vt)&&dt.isNumber(_t)&&(Rt=(vt-Ct[0])/(Ct[2]-Ct[0]),It=(Ct[1]-_t)/(Ct[1]-Ct[3])),this.setBoundingBox([Ct[0]+Tt*Rt,Ct[1]-Mt*It,Ct[2]-Tt*(1-Rt),Ct[3]+Mt*(1-It)],!1),this.zoomX/=St,this.zoomY/=Et,this.applyZoom())},zoom100:function(){var vt=this.getBoundingBox(),_t=(vt[2]-vt[0])*(1-this.zoomX)*.5,Ct=(vt[1]-vt[3])*(1-this.zoomY)*.5;return this.setBoundingBox([vt[0]+_t,vt[1]-Ct,vt[2]-_t,vt[3]+Ct],!1),this.zoomX=1,this.zoomY=1,this.applyZoom()},zoomAllPoints:function(){var vt,_t,Ct,St,Et,Tt=0,Mt=0,Rt=0,It=0,Ot=this.objectsList.length;for(vt=0;vt<Ot;vt++)Et=this.objectsList[vt],dt.isPoint(Et)&&Et.visPropCalc.visible&&(Et.coords.usrCoords[1]<Tt?Tt=Et.coords.usrCoords[1]:Et.coords.usrCoords[1]>Mt&&(Mt=Et.coords.usrCoords[1]),Et.coords.usrCoords[2]>It?It=Et.coords.usrCoords[2]:Et.coords.usrCoords[2]<Rt&&(Rt=Et.coords.usrCoords[2]));return _t=50,Ct=_t/this.unitX,St=_t/this.unitY,this.zoomX=1,this.zoomY=1,this.setBoundingBox([Tt-Ct,It+St,Mt+Ct,Rt-St],!0),this.applyZoom()},zoomElements:function(vt){var _t,Ct,St,Et,Tt=[0,0,0,0],Mt=[1,-1,-1,1];if(!dt.isArray(vt)||vt.length===0)return this;for(_t=0;_t<vt.length;_t++)if(St=this.select(vt[_t]),Et=St.bounds(),dt.isArray(Et))if(dt.isArray(Tt))for(Ct=0;Ct<4;Ct++)Mt[Ct]*Et[Ct]<Mt[Ct]*Tt[Ct]&&(Tt[Ct]=Et[Ct]);else Tt=Et;if(dt.isArray(Tt)){for(Ct=0;Ct<4;Ct++)Tt[Ct]-=Mt[Ct];this.zoomX=1,this.zoomY=1,this.setBoundingBox(Tt,!0)}return this},setZoom:function(vt,_t){var Ct=this.attr.zoom.factorx,St=this.attr.zoom.factory;return this.attr.zoom.factorx=vt/this.zoomX,this.attr.zoom.factory=_t/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=Ct,this.attr.zoom.factory=St,this},removeObject:function(vt){var _t,Ct;if(dt.isArray(vt)){for(Ct=0;Ct<vt.length;Ct++)this.removeObject(vt[Ct]);return this}if(vt=this.select(vt),!dt.exists(vt)||dt.isString(vt))return this;try{for(_t in vt.childElements)vt.childElements.hasOwnProperty(_t)&&vt.childElements[_t].board.removeObject(vt.childElements[_t]);for(_t in vt.objects)vt.objects.hasOwnProperty(_t)&&vt.objects[_t].board.removeObject(vt.objects[_t]);for(_t in this.objects)this.objects.hasOwnProperty(_t)&&dt.exists(this.objects[_t].childElements)&&(delete this.objects[_t].childElements[vt.id],delete this.objects[_t].descendants[vt.id]);if(vt._pos>-1)for(this.objectsList.splice(vt._pos,1),_t=vt._pos;_t<this.objectsList.length;_t++)this.objectsList[_t]._pos--;else vt.type!==_e.OBJECT_TYPE_TURTLE&&tt.debug("Board.removeObject: object "+vt.id+" not found in list.");delete this.objects[vt.id],delete this.elementsByName[vt.name],vt.visProp&&dt.evaluate(vt.visProp.trace)&&vt.clearTrace(),dt.exists(vt.remove)&&vt.remove()}catch(St){tt.debug(vt.id+": Could not be removed: "+St)}return this.update(),this},removeAncestors:function(vt){var _t;for(_t in vt.ancestors)vt.ancestors.hasOwnProperty(_t)&&this.removeAncestors(vt.ancestors[_t]);return this.removeObject(vt),this},initGeonextBoard:function(){var vt,_t,Ct;return vt=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),_t=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),Ct=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[vt,_t],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[vt,Ct],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(vt,_t,Ct,St){var Et;return St||(Et=this.getBoundingBox()),this.canvasWidth=parseInt(vt,10),this.canvasHeight=parseInt(_t,10),Ct||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),St||this.setBoundingBox(Et,this.keepaspectratio),this},showDependencies:function(){var vt,_t,Ct,St,Et;_t=`<p>
`;for(vt in this.objects)if(this.objects.hasOwnProperty(vt)){Et=0;for(Ct in this.objects[vt].childElements)this.objects[vt].childElements.hasOwnProperty(Ct)&&(Et+=1);Et>=0&&(_t+="<strong>"+this.objects[vt].id+":</strong> ");for(Ct in this.objects[vt].childElements)this.objects[vt].childElements.hasOwnProperty(Ct)&&(_t+=this.objects[vt].childElements[Ct].id+"("+this.objects[vt].childElements[Ct].name+"), ");_t+=`<p>
`}return _t+=`</p>
`,St=window.open(),St.document.open(),St.document.write(_t),St.document.close(),this},showXML:function(){var vt=window.open("");return vt.document.open(),vt.document.write("<pre>"+dt.escapeHTML(this.xmlString)+"</pre>"),vt.document.close(),this},prepareUpdate:function(){var vt,_t,Ct=this.objectsList.length;for(vt=0;vt<Ct;vt++)_t=this.objectsList[vt],_t.needsUpdate=_t.needsRegularUpdate||this.needsFullUpdate;for(vt in this.groups)this.groups.hasOwnProperty(vt)&&(_t=this.groups[vt],_t.needsUpdate=_t.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(vt){var _t,Ct;for(vt=this.select(vt),_t=0;_t<this.objectsList.length;_t++)Ct=this.objectsList[_t],Ct.update(!dt.exists(vt)||Ct.id!==vt.id).updateVisibility();for(_t in this.groups)this.groups.hasOwnProperty(_t)&&this.groups[_t].update(vt);return this},updateRenderer:function(){var vt,_t=this.objectsList.length;if(this.renderer.type==="canvas")this.updateRendererCanvas();else for(vt=0;vt<_t;vt++)this.objectsList[vt].updateRenderer();return this},updateRendererCanvas:function(){var vt,_t,Ct,St,Et,Tt=this.objectsList.length,Mt=this.options.layer,Rt=this.options.layer.numlayers,It=Number.NEGATIVE_INFINITY;for(Ct=0;Ct<Rt;Ct++){St=Number.POSITIVE_INFINITY;for(Et in Mt)Mt.hasOwnProperty(Et)&&Mt[Et]>It&&Mt[Et]<St&&(St=Mt[Et]);for(It=St,vt=0;vt<Tt;vt++)_t=this.objectsList[vt],_t.visProp.layer===St&&_t.prepareUpdate().updateRenderer()}return this},addHook:function(vt,_t,Ct){return tt.deprecated("Board.addHook()","Board.on()"),_t=dt.def(_t,"update"),Ct=dt.def(Ct,this),this.hooks.push([_t,vt]),this.on(_t,vt,Ct),this.hooks.length-1},addEvent:tt.shortcut(tt.Board.prototype,"on"),removeHook:function(vt){return tt.deprecated("Board.removeHook()","Board.off()"),this.hooks[vt]&&(this.off(this.hooks[vt][0],this.hooks[vt][1]),this.hooks[vt]=null),this},removeEvent:tt.shortcut(tt.Board.prototype,"off"),updateHooks:function(vt){var _t=Array.prototype.slice.call(arguments,0);return tt.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),_t[0]=dt.def(_t[0],"update"),this.triggerEventHandlers([_t[0]],arguments),this},addChild:function(vt){return dt.exists(vt)&&dt.exists(vt.containerObj)&&(this.dependentBoards.push(vt),this.update()),this},removeChild:function(vt){var _t;for(_t=this.dependentBoards.length-1;_t>=0;_t--)this.dependentBoards[_t]===vt&&this.dependentBoards.splice(_t,1);return this},update:function(vt){var _t,Ct,St,Et;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,this.attr.minimizereflow==="all"&&this.containerObj&&this.renderer.type!=="vml"&&(Et=this.renderer.removeToInsertLater(this.containerObj)),this.attr.minimizereflow==="svg"&&this.renderer.type==="svg"&&(Et=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(vt).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),Et&&Et(),Ct=this.dependentBoards.length,_t=0;_t<Ct;_t++)St=this.dependentBoards[_t],dt.exists(St)&&St!==this&&(St.updateQuality=this.updateQuality,St.prepareUpdate().updateElements().updateConditions(),St.renderer.suspendRedraw(),St.updateRenderer(),St.renderer.unsuspendRedraw(),St.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var vt;for(vt=0;vt<this.grids.length;vt++)this.removeObject(this.grids[vt]);return this.grids.length=0,this.update(),this},create:function(vt,_t,Ct){var St,Et;for(vt=vt.toLowerCase(),dt.exists(_t)||(_t=[]),dt.exists(Ct)||(Ct={}),Et=0;Et<_t.length;Et++)dt.isString(_t[Et])&&(vt!=="text"||Et!==2)&&(vt!=="input"&&vt!=="checkbox"&&vt!=="button"||Et!==2&&Et!==3)&&(_t[Et]=this.select(_t[Et]));if(!dt.isFunction(tt.elements[vt]))throw new Error("JSXGraph: create: Unknown element type given: "+vt);return St=tt.elements[vt](this,_t,Ct),dt.exists(St)?(St.prepareUpdate&&St.update&&St.updateRenderer&&St.fullUpdate(),St):(tt.debug("JSXGraph: create: failure creating "+vt),St)},createElement:function(){return tt.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var vt;for(vt=0;vt<this.objectsList.length;vt++)this.objectsList[vt].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(vt,_t){var Ct,St,Et=ft.getDimensions(this.container,this.document);return dt.isArray(vt)?(this.plainBB=vt,this.canvasWidth=parseInt(Et.width,10),this.canvasHeight=parseInt(Et.height,10),St=this.canvasWidth,Ct=this.canvasHeight,_t?(this.unitX=St/(vt[2]-vt[0]),this.unitY=Ct/(vt[1]-vt[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY):this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),this.keepaspectratio=!0):(this.unitX=St/(vt[2]-vt[0]),this.unitY=Ct/(vt[1]-vt[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*vt[0],this.unitY*vt[1]),this):this},getBoundingBox:function(){var vt=new rt(_e.COORDS_BY_SCREEN,[0,0],this),_t=new rt(_e.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[vt.usrCoords[1],vt.usrCoords[2],_t.usrCoords[1],_t.usrCoords[2]]},addAnimation:function(vt){var _t=this;return this.animationObjects[vt.id]=vt,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval(function(){_t.animate()},vt.board.attr.animationdelay)),this},stopAllAnimation:function(){var vt;for(vt in this.animationObjects)this.animationObjects.hasOwnProperty(vt)&&dt.exists(this.animationObjects[vt])&&(this.animationObjects[vt]=null,delete this.animationObjects[vt]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It=0,Ot=null;for(_t in this.animationObjects)if(this.animationObjects.hasOwnProperty(_t)&&dt.exists(this.animationObjects[_t])){if(It+=1,Ct=this.animationObjects[_t],Ct.animationPath&&(St=dt.isFunction(Ct.animationPath)?Ct.animationPath(new Date().getTime()-Ct.animationStart):Ct.animationPath.pop(),!dt.exists(St)||!dt.isArray(St)&&isNaN(St)?delete Ct.animationPath:(Ct.setPositionDirectly(_e.COORDS_BY_USER,St),Ct.fullUpdate(),Ot=Ct)),Ct.animationData){Mt=0;for(Et in Ct.animationData)Ct.animationData.hasOwnProperty(Et)&&(Tt=Ct.animationData[Et].pop(),dt.exists(Tt)?(Mt+=1,vt={},vt[Et]=Tt,Ct.setAttribute(vt)):delete Ct.animationData[Tt]);Mt===0&&delete Ct.animationData}dt.exists(Ct.animationData)||dt.exists(Ct.animationPath)||(this.animationObjects[_t]=null,delete this.animationObjects[_t],dt.exists(Ct.animationCallback)&&(Rt=Ct.animationCallback,Ct.animationCallback=null,Rt()))}return It===0?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(Ot),this},migratePoint:function(vt,_t,Ct){var St,Et,Tt,Mt,Rt,It,Ot=!1;vt=this.select(vt),_t=this.select(_t),dt.exists(vt.label)&&(It=vt.label.id,Ot=!0,this.removeObject(vt.label));for(Et in vt.childElements)if(vt.childElements.hasOwnProperty(Et)){St=vt.childElements[Et],Mt=!1;for(Tt in St)St.hasOwnProperty(Tt)&&St[Tt]===vt&&(St[Tt]=_t,Mt=!0);for(Mt&&delete vt.childElements[Et],Rt=0;Rt<St.parents.length;Rt++)St.parents[Rt]===vt.id&&(St.parents[Rt]=_t.id);_t.addChild(St)}return Ct&&(Ot&&(delete _t.childElements[It],delete _t.descendants[It]),_t.label&&this.removeObject(_t.label),delete this.elementsByName[_t.name],_t.name=vt.name,Ot&&_t.createLabel()),this.removeObject(vt),dt.exists(_t.name)&&_t.name!==""&&(this.elementsByName[_t.name]=_t),this.fullUpdate(),this},emulateColorblindness:function(vt){var _t,Ct;if(dt.exists(vt)||(vt="none"),this.currentCBDef===vt)return this;for(_t in this.objects)this.objects.hasOwnProperty(_t)&&(Ct=this.objects[_t],vt!=="none"?(this.currentCBDef==="none"&&(Ct.visPropOriginal={strokecolor:Ct.visProp.strokecolor,fillcolor:Ct.visProp.fillcolor,highlightstrokecolor:Ct.visProp.highlightstrokecolor,highlightfillcolor:Ct.visProp.highlightfillcolor}),Ct.setAttribute({strokecolor:ht.rgb2cb(dt.evaluate(Ct.visPropOriginal.strokecolor),vt),fillcolor:ht.rgb2cb(dt.evaluate(Ct.visPropOriginal.fillcolor),vt),highlightstrokecolor:ht.rgb2cb(dt.evaluate(Ct.visPropOriginal.highlightstrokecolor),vt),highlightfillcolor:ht.rgb2cb(dt.evaluate(Ct.visPropOriginal.highlightfillcolor),vt)})):dt.exists(Ct.visPropOriginal)&&tt.extend(Ct.visProp,Ct.visPropOriginal));return this.currentCBDef=vt,this.update(),this},select:function(vt){var _t,Ct,St,Et,Tt=vt;if(Tt===null)return Tt;if(dt.isString(Tt)&&Tt!=="")dt.exists(this.objects[Tt])?Tt=this.objects[Tt]:dt.exists(this.elementsByName[Tt])?Tt=this.elementsByName[Tt]:dt.exists(this.groups[Tt])&&(Tt=this.groups[Tt]);else if(dt.isFunction(Tt)||dt.isObject(Tt)&&!dt.isFunction(Tt.setAttribute)){for(_t=dt.filterElements(this.objectsList,Tt),Ct={},Et=_t.length,St=0;St<Et;St++)Ct[_t[St].id]=_t[St];Tt=new xt(Ct)}else dt.isObject(Tt)&&dt.exists(Tt.id)&&!dt.exists(this.objects[Tt.id])&&(Tt=null);return Tt},hasPoint:function(vt,_t){var Ct=vt,St=_t,Et=this.getBoundingBox();return dt.exists(vt)&&dt.isArray(vt.usrCoords)&&(Ct=vt.usrCoords[1],St=vt.usrCoords[2]),!!(dt.isNumber(Ct)&&dt.isNumber(St)&&Et[0]<Ct&&Ct<Et[2]&&Et[1]>St&&St>Et[3])},updateCSSTransforms:function(){var vt=this.containerObj,_t=vt,Ct=vt;for(this.cssTransMat=ft.getCSSTransformMatrix(_t),_t=_t.offsetParent;_t;){for(this.cssTransMat=st.matMatMult(ft.getCSSTransformMatrix(_t),this.cssTransMat),Ct=Ct.parentNode;Ct!==_t;)this.cssTransMat=st.matMatMult(ft.getCSSTransformMatrix(_t),this.cssTransMat),Ct=Ct.parentNode;_t=_t.offsetParent}return this.cssTransMat=st.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(vt){this.isSelecting=!0,this.selectingBox=[[vt[0],vt[1]],[vt[0],vt[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(vt){this.isSelecting&&(this.selectingBox[1]=[vt[0],vt[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(vt){var _t=this.getMousePosition(vt);this.isSelecting=!1,this.selectingBox[1]=[_t[0],_t[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var vt=this.selectingBox[0],_t=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(tt.COORDS_BY_SCREEN,[vt[0],vt[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(tt.COORDS_BY_SCREEN,[vt[0],_t[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(tt.COORDS_BY_SCREEN,[_t[0],_t[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(tt.COORDS_BY_SCREEN,[_t[0],vt[1]])},_testForSelection:function(vt){this._isRequiredKeyPressed(vt,"selection")&&(dt.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(vt){var _t;return dt.exists(this.selectionPolygon)||(_t=dt.copyAttributes(vt,it,"board","selection"),_t.enabled===!0&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],_t))),this},__evt__down:function(vt){},__evt__mousedown:function(vt){},__evt__pointerdown:function(vt){},__evt__touchstart:function(vt){},__evt__up:function(vt){},__evt__mouseup:function(vt){},__evt__pointerup:function(vt){},__evt__touchend:function(vt){},__evt__move:function(vt,_t){},__evt__mousemove:function(vt,_t){},__evt__pointermove:function(vt,_t){},__evt__touchmove:function(vt,_t){},__evt__hit:function(vt,_t,Ct){},__evt__mousehit:function(vt,_t,Ct){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},createRoulette:function(vt,_t,Ct,St,Et,Tt,Mt){var Rt=this;return new function(){var It,Ot=0,Bt=0,Nt=0,zt=Ct,Dt=nt.root(function(ar){var lr=vt.X(zt),gr=vt.Y(zt),Yt=_t.X(ar),nr=_t.Y(ar);return(lr-Yt)*(lr-Yt)+(gr-nr)*(gr-nr)},[0,2*Math.PI]),Ft=0,Ut=0,$t=Rt.create("transform",[function(){return Ot}],{type:"rotate"}),Vt=Rt.create("transform",[function(){return Ot},function(){return vt.X(zt)},function(){return vt.Y(zt)}],{type:"rotate"}),Zt=Rt.create("transform",[function(){return Bt},function(){return Nt}],{type:"translate"}),qt=function(ar,lr,gr){var Yt=nt.D(ar.X)(lr),nr=nt.D(ar.Y)(lr),mr=nt.D(ar.X)(gr),Sr=nt.D(ar.Y)(gr),Er=nt.D(ar.X)(.5*(lr+gr)),Nr=nt.D(ar.Y)(.5*(lr+gr)),wr=Math.sqrt(Yt*Yt+nr*nr),kr=Math.sqrt(mr*mr+Sr*Sr);return(wr+4*Math.sqrt(Er*Er+Nr*Nr)+kr)*(gr-lr)/6},sr=function(ar){return It-qt(_t,Dt,ar)},er=Math.PI/18,ir=9*er,ur=null;return this.rolling=function(){var ar,lr,gr,Yt,nr;Ft=zt+Et*St,It=qt(vt,zt,Ft),Ut=nt.root(sr,Dt),ar=new lt(vt.X(Ft),vt.Y(Ft)),lr=new lt(_t.X(Ut),_t.Y(Ut)),gr=new lt(nt.D(vt.X)(Ft),nt.D(vt.Y)(Ft)),Yt=new lt(nt.D(_t.X)(Ut),nt.D(_t.Y)(Ut)),nr=lt.C.div(gr,Yt),Ot=Math.atan2(nr.imaginary,nr.real),nr.div(lt.C.abs(nr)),nr.mult(lr),Bt=ar.real-nr.real,Nt=ar.imaginary-nr.imaginary,Ot<-er&&Ot>-ir?(Ot=-er,Vt.applyOnce(Mt)):Ot>er&&Ot<ir?(Ot=er,Vt.applyOnce(Mt)):($t.applyOnce(Mt),Zt.applyOnce(Mt),zt=Ft,Dt=Ut),Rt.update()},this.start=function(){return Tt>0&&(ur=window.setInterval(this.rolling,Tt)),this},this.stop=function(){return window.clearInterval(ur),this},this}}}),tt.Board}),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/env","utils/color","utils/base64","math/numerics"],function(tt,_e,rt,it,nt,st,at,lt,ot){return tt.SVGRenderer=function(ct,ut){var ht;for(this.type="svg",this.isIE=navigator.appVersion.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=ct,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.resize(ut.width,ut.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],ht=0;ht<_e.layer.numlayers;ht++)this.layer[ht]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[ht]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},tt.SVGRenderer.prototype=new rt,tt.extend(tt.SVGRenderer.prototype,{_createArrowHead:function(ct,ut){var ht,dt,pt=ct.id+"Triangle",ft=null,gt=nt.evaluate(ct.visProp.firstarrow),mt=nt.evaluate(ct.visProp.lastarrow);return nt.exists(ut)&&(pt+=ut),ht=this.createPrim("marker",pt),ht.setAttributeNS(null,"stroke",nt.evaluate(ct.visProp.strokecolor)),ht.setAttributeNS(null,"stroke-opacity",nt.evaluate(ct.visProp.strokeopacity)),ht.setAttributeNS(null,"fill",nt.evaluate(ct.visProp.strokecolor)),ht.setAttributeNS(null,"fill-opacity",nt.evaluate(ct.visProp.strokeopacity)),ht.setAttributeNS(null,"stroke-width",0),ht.setAttributeNS(null,"orient","auto"),ht.setAttributeNS(null,"markerUnits","strokeWidth"),dt=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),ut==="End"?(tt.exists(gt.type)&&(ft=nt.evaluate(gt.type)),ht.setAttributeNS(null,"refY",5),ft===2?(ht.setAttributeNS(null,"refX",4.9),dt.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z")):ft===3?(ht.setAttributeNS(null,"refX",3.33),dt.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(ht.setAttributeNS(null,"refX",9.9),dt.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"))):(tt.exists(mt.type)&&(ft=nt.evaluate(mt.type)),ht.setAttributeNS(null,"refY",5),ft===2?(ht.setAttributeNS(null,"refX",5.1),dt.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z")):ft===3?(ht.setAttributeNS(null,"refX",.1),dt.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(ht.setAttributeNS(null,"refX",.1),dt.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"))),ht.appendChild(dt),ht},_setArrowColor:function(ct,ut,ht,dt){ct&&(nt.isString(ut)&&this._setAttribute(function(){ct.setAttributeNS(null,"stroke",ut),ct.setAttributeNS(null,"fill",ut),ct.setAttributeNS(null,"stroke-opacity",ht),ct.setAttributeNS(null,"fill-opacity",ht)},dt.visPropOld.fillcolor),this.isIE&&dt.rendNode.parentNode.insertBefore(dt.rendNode,dt.rendNode))},_setArrowWidth:function(ct,ut,ht,dt){var pt,ft;ct&&(ut===0?ct.setAttributeNS(null,"display","none"):(pt=ut,ft=pt*dt,ct.setAttributeNS(null,"viewBox","0 0 "+10*pt+" "+10*pt),ct.setAttributeNS(null,"markerHeight",ft),ct.setAttributeNS(null,"markerWidth",ft),ct.setAttributeNS(null,"display","inherit")),this.isIE&&ht.parentNode.insertBefore(ht,ht))},updateTicks:function(ct){var ut,ht,dt,pt,ft,gt="",mt=ct.ticks.length;for(ut=0;ut<mt;ut++)ht=ct.ticks[ut],pt=ht[0],ft=ht[1],nt.isNumber(pt[0])&&nt.isNumber(pt[1])&&(gt+="M "+pt[0]+" "+ft[0]+" L "+pt[1]+" "+ft[1]+" ");dt=ct.rendNode,nt.exists(dt)||(dt=this.createPrim("path",ct.id),this.appendChildPrim(dt,nt.evaluate(ct.visProp.layer)),ct.rendNode=dt),dt.setAttributeNS(null,"stroke",nt.evaluate(ct.visProp.strokecolor)),dt.setAttributeNS(null,"stroke-opacity",nt.evaluate(ct.visProp.strokeopacity)),dt.setAttributeNS(null,"stroke-width",nt.evaluate(ct.visProp.strokewidth)),this.updatePathPrim(dt,gt,ct.board)},displayCopyright:function(ct,ut){var ht,dt=this.createPrim("text","licenseText");dt.setAttributeNS(null,"x","20px"),dt.setAttributeNS(null,"y",2+ut+"px"),dt.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+ut+"px; fill:#356AA0;  opacity:0.3;"),ht=this.container.ownerDocument.createTextNode(ct),dt.appendChild(ht),this.appendChildPrim(dt,0)},drawInternalText:function(ct){var ut=this.createPrim("text",ct.id);return ut.style.whiteSpace="nowrap",ct.rendNodeText=this.container.ownerDocument.createTextNode(""),ut.appendChild(ct.rendNodeText),this.appendChildPrim(ut,nt.evaluate(ct.visProp.layer)),ut},updateInternalText:function(ct){var ut,ht=ct.plaintext,dt=ct.getAnchorX(),pt=ct.getAnchorY();ct.rendNode.getAttributeNS(null,"class")!==ct.visProp.cssclass&&(ct.rendNode.setAttributeNS(null,"class",nt.evaluate(ct.visProp.cssclass)),ct.needsSizeUpdate=!0),isNaN(ct.coords.scrCoords[1]+ct.coords.scrCoords[2])||(ut=ct.coords.scrCoords[1],ct.visPropOld.left!==dt+ut&&(ct.rendNode.setAttributeNS(null,"x",ut+"px"),dt==="left"?ct.rendNode.setAttributeNS(null,"text-anchor","start"):dt==="right"?ct.rendNode.setAttributeNS(null,"text-anchor","end"):dt==="middle"&&ct.rendNode.setAttributeNS(null,"text-anchor","middle"),ct.visPropOld.left=dt+ut),ut=ct.coords.scrCoords[2],ct.visPropOld.top!==pt+ut&&(ct.rendNode.setAttributeNS(null,"y",ut+.5*this.vOffsetText+"px"),pt==="bottom"?ct.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):pt==="top"?ct.rendNode.setAttributeNS(null,"dy","1.6ex"):pt==="middle"&&ct.rendNode.setAttributeNS(null,"dy","0.6ex"),ct.visPropOld.top=pt+ut)),ct.htmlStr!==ht&&(ct.rendNodeText.data=ht,ct.htmlStr=ht),this.transformImage(ct,ct.transformations)},updateInternalTextStyle:function(ct,ut,ht,dt){this.setObjectFillColor(ct,ut,ht)},drawImage:function(ct){var ut=this.createPrim("image",ct.id);ut.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(ut,nt.evaluate(ct.visProp.layer)),ct.rendNode=ut,this.updateImage(ct)},transformImage:function(ct,ut){var ht,dt,pt=ct.rendNode,ft="";ut.length>0&&(dt=this.joinTransforms(ct,ut),ht=[dt[1][1],dt[2][1],dt[1][2],dt[2][2],dt[1][0],dt[2][0]].join(","),ft+=" matrix("+ht+") ",pt.setAttributeNS(null,"transform",ft))},updateImageURL:function(ct){var ut=nt.evaluate(ct.url);ct.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",ut)},updateImageStyle:function(ct,ut){var ht=nt.evaluate(ut?ct.visProp.highlightcssclass:ct.visProp.cssclass);ct.rendNode.setAttributeNS(null,"class",ht)},appendChildPrim:function(ct,ut){return nt.exists(ut)?ut>=_e.layer.numlayers&&(ut=_e.layer.numlayers-1):ut=0,this.layer[ut].appendChild(ct),ct},createPrim:function(ct,ut){var ht=this.container.ownerDocument.createElementNS(this.svgNamespace,ct);return ht.setAttributeNS(null,"id",this.container.id+"_"+ut),ht.style.position="absolute",ct==="path"&&(ht.setAttributeNS(null,"stroke-linecap","round"),ht.setAttributeNS(null,"stroke-linejoin","round")),ht},remove:function(ct){nt.exists(ct)&&nt.exists(ct.parentNode)&&ct.parentNode.removeChild(ct)},makeArrows:function(ct){var ut,ht=nt.evaluate(ct.visProp.firstarrow),dt=nt.evaluate(ct.visProp.lastarrow);if(ct.visPropOld.firstarrow===ht&&ct.visPropOld.lastarrow===dt)return void(this.isIE&&ct.visPropCalc.visible&&(ht||dt)&&ct.rendNode.parentNode.insertBefore(ct.rendNode,ct.rendNode));ht?(ut=ct.rendNodeTriangleStart,nt.exists(ut)?this.defs.appendChild(ut):(ut=this._createArrowHead(ct,"End"),this.defs.appendChild(ut),ct.rendNodeTriangleStart=ut,ct.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+ct.id+"TriangleEnd)"))):(ut=ct.rendNodeTriangleStart,nt.exists(ut)&&this.remove(ut)),dt?(ut=ct.rendNodeTriangleEnd,nt.exists(ut)?this.defs.appendChild(ut):(ut=this._createArrowHead(ct,"Start"),this.defs.appendChild(ut),ct.rendNodeTriangleEnd=ut,ct.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+ct.id+"TriangleStart)"))):(ut=ct.rendNodeTriangleEnd,nt.exists(ut)&&this.remove(ut)),ct.visPropOld.firstarrow=ht,ct.visPropOld.lastarrow=dt},updateEllipsePrim:function(ct,ut,ht,dt,pt){var ft=1e6;ft=2e5,ut=Math.abs(ut)<ft?ut:ft*ut/Math.abs(ut),ht=Math.abs(ht)<ft?ht:ft*ht/Math.abs(ht),dt=Math.abs(dt)<ft?dt:ft*dt/Math.abs(dt),pt=Math.abs(pt)<ft?pt:ft*pt/Math.abs(pt),ct.setAttributeNS(null,"cx",ut),ct.setAttributeNS(null,"cy",ht),ct.setAttributeNS(null,"rx",Math.abs(dt)),ct.setAttributeNS(null,"ry",Math.abs(pt))},updateLinePrim:function(ct,ut,ht,dt,pt){var ft=1e6;ft=2e5,isNaN(ut+ht+dt+pt)||(ut=Math.abs(ut)<ft?ut:ft*ut/Math.abs(ut),ht=Math.abs(ht)<ft?ht:ft*ht/Math.abs(ht),dt=Math.abs(dt)<ft?dt:ft*dt/Math.abs(dt),pt=Math.abs(pt)<ft?pt:ft*pt/Math.abs(pt),ct.setAttributeNS(null,"x1",ut),ct.setAttributeNS(null,"y1",ht),ct.setAttributeNS(null,"x2",dt),ct.setAttributeNS(null,"y2",pt))},updatePathPrim:function(ct,ut){ut===""&&(ut="M 0 0"),ct.setAttributeNS(null,"d",ut)},updatePathStringPoint:function(ct,ut,ht){var dt="",pt=ct.coords.scrCoords,ft=ut*Math.sqrt(3)*.5,gt=.5*ut;return ht==="x"?dt=" M "+(pt[1]-ut)+" "+(pt[2]-ut)+" L "+(pt[1]+ut)+" "+(pt[2]+ut)+" M "+(pt[1]+ut)+" "+(pt[2]-ut)+" L "+(pt[1]-ut)+" "+(pt[2]+ut):ht==="+"?dt=" M "+(pt[1]-ut)+" "+pt[2]+" L "+(pt[1]+ut)+" "+pt[2]+" M "+pt[1]+" "+(pt[2]-ut)+" L "+pt[1]+" "+(pt[2]+ut):ht==="<>"?dt=" M "+(pt[1]-ut)+" "+pt[2]+" L "+pt[1]+" "+(pt[2]+ut)+" L "+(pt[1]+ut)+" "+pt[2]+" L "+pt[1]+" "+(pt[2]-ut)+" Z ":ht==="^"?dt=" M "+pt[1]+" "+(pt[2]-ut)+" L "+(pt[1]-ft)+" "+(pt[2]+gt)+" L "+(pt[1]+ft)+" "+(pt[2]+gt)+" Z ":ht==="v"?dt=" M "+pt[1]+" "+(pt[2]+ut)+" L "+(pt[1]-ft)+" "+(pt[2]-gt)+" L "+(pt[1]+ft)+" "+(pt[2]-gt)+" Z ":ht===">"?dt=" M "+(pt[1]+ut)+" "+pt[2]+" L "+(pt[1]-gt)+" "+(pt[2]-ft)+" L "+(pt[1]-gt)+" "+(pt[2]+ft)+" Z ":ht==="<"&&(dt=" M "+(pt[1]-ut)+" "+pt[2]+" L "+(pt[1]+gt)+" "+(pt[2]-ft)+" L "+(pt[1]+gt)+" "+(pt[2]+ft)+" Z "),dt},updatePathStringPrim:function(ct){var ut,ht,dt,pt=" M ",ft="";if(ct.numberPoints<=0)return"";if(dt=Math.min(ct.points.length,ct.numberPoints),ct.bezierDegree===1)for(ut=0;ut<dt;ut++)ht=ct.points[ut].scrCoords,isNaN(ht[1])||isNaN(ht[2])?pt=" M ":(ht[1]=Math.max(Math.min(ht[1],5e3),-5e3),ht[2]=Math.max(Math.min(ht[2],5e3),-5e3),ft+=pt+ht[1]+" "+ht[2],pt=" L ");else if(ct.bezierDegree===3)for(ut=0;ut<dt;)ht=ct.points[ut].scrCoords,isNaN(ht[1])||isNaN(ht[2])?pt=" M ":(ft+=pt+ht[1]+" "+ht[2],pt===" C "&&(ut+=1,ht=ct.points[ut].scrCoords,ft+=" "+ht[1]+" "+ht[2],ut+=1,ht=ct.points[ut].scrCoords,ft+=" "+ht[1]+" "+ht[2]),pt=" C "),ut+=1;return ft},updatePathStringBezierPrim:function(ct){var ut,ht,dt,pt,ft,gt,mt,At=" M ",yt="",bt=nt.evaluate(ct.visProp.strokewidth),xt=nt.evaluate(ct.visProp.curvetype)!=="plot";if(ct.numberPoints<=0)return"";for(xt&&ct.board.options.curve.RDPsmoothing&&(ct.points=ot.RamerDouglasPeucker(ct.points,.5)),mt=Math.min(ct.points.length,ct.numberPoints),ht=1;ht<3;ht++)for(At=" M ",ut=0;ut<mt;ut++)pt=ct.points[ut].scrCoords,isNaN(pt[1])||isNaN(pt[2])?At=" M ":(pt[1]=Math.max(Math.min(pt[1],5e3),-5e3),pt[2]=Math.max(Math.min(pt[2],5e3),-5e3),At===" M "?yt+=At+pt[1]+" "+pt[2]:(dt=2*ht,yt+=[At,ft+.333*(pt[1]-ft)+bt*(dt*Math.random()-ht)," ",gt+.333*(pt[2]-gt)+bt*(dt*Math.random()-ht)," ",ft+.666*(pt[1]-ft)+bt*(dt*Math.random()-ht)," ",gt+.666*(pt[2]-gt)+bt*(dt*Math.random()-ht)," ",pt[1]," ",pt[2]].join("")),At=" C ",ft=pt[1],gt=pt[2]);return yt},updatePolygonPrim:function(ct,ut){var ht,dt,pt="",ft=ut.vertices.length;for(ct.setAttributeNS(null,"stroke","none"),ht=0;ht<ft-1;ht++){if(!ut.vertices[ht].isReal)return void ct.setAttributeNS(null,"points","");dt=ut.vertices[ht].coords.scrCoords,pt=pt+dt[1]+","+dt[2],ht<ft-2&&(pt+=" ")}pt.indexOf("NaN")===-1&&ct.setAttributeNS(null,"points",pt)},updateRectPrim:function(ct,ut,ht,dt,pt){ct.setAttributeNS(null,"x",ut),ct.setAttributeNS(null,"y",ht),ct.setAttributeNS(null,"width",dt),ct.setAttributeNS(null,"height",pt)},setPropertyPrim:function(ct,ut,ht){ut!=="stroked"&&ct.setAttributeNS(null,ut,ht)},display:function(ct,ut){var ht;ct&&ct.rendNode&&(ct.visPropOld.visible=ut,ht=ct.rendNode,ut?(ht.setAttributeNS(null,"display","inline"),ht.style.visibility="inherit"):(ht.setAttributeNS(null,"display","none"),ht.style.visibility="hidden"))},show:function(ct){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(ct,!0)},hide:function(ct){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(ct,!1)},setBuffering:function(ct,ut){ct.rendNode.setAttribute("buffered-rendering",ut)},setDashStyle:function(ct){var ut=nt.evaluate(ct.visProp.dash),ht=ct.rendNode;ut>0?ht.setAttributeNS(null,"stroke-dasharray",this.dashArray[ut-1]):ht.hasAttributeNS(null,"stroke-dasharray")&&ht.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt=ct.rendNode,xt=nt.evaluate(ct.visProp.gradient);ht=nt.evaluate(ct.visProp.fillopacity),ht=ht>0?ht:0,ut=nt.evaluate(ct.visProp.fillcolor),xt==="linear"?(dt=this.createPrim("linearGradient",ct.id+"_gradient"),gt="0%",mt="100%",At="0%",yt="0%",dt.setAttributeNS(null,"x1",gt),dt.setAttributeNS(null,"x2",mt),dt.setAttributeNS(null,"y1",At),dt.setAttributeNS(null,"y2",yt),pt=this.createPrim("stop",ct.id+"_gradient1"),pt.setAttributeNS(null,"offset","0%"),pt.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),ft=this.createPrim("stop",ct.id+"_gradient2"),ft.setAttributeNS(null,"offset","100%"),ft.setAttributeNS(null,"style","stop-color:"+nt.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+nt.evaluate(ct.visProp.gradientsecondopacity)),dt.appendChild(pt),dt.appendChild(ft),this.defs.appendChild(dt),bt.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+ct.id+"_gradient)"),ct.gradNode1=pt,ct.gradNode2=ft):xt==="radial"?(dt=this.createPrim("radialGradient",ct.id+"_gradient"),dt.setAttributeNS(null,"cx","50%"),dt.setAttributeNS(null,"cy","50%"),dt.setAttributeNS(null,"r","50%"),dt.setAttributeNS(null,"fx",100*nt.evaluate(ct.visProp.gradientpositionx)+"%"),dt.setAttributeNS(null,"fy",100*nt.evaluate(ct.visProp.gradientpositiony)+"%"),pt=this.createPrim("stop",ct.id+"_gradient1"),pt.setAttributeNS(null,"offset","0%"),pt.setAttributeNS(null,"style","stop-color:"+nt.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+nt.evaluate(ct.visProp.gradientsecondopacity)),ft=this.createPrim("stop",ct.id+"_gradient2"),ft.setAttributeNS(null,"offset","100%"),ft.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),dt.appendChild(pt),dt.appendChild(ft),this.defs.appendChild(dt),bt.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+ct.id+"_gradient)"),ct.gradNode1=pt,ct.gradNode2=ft):bt.removeAttributeNS(null,"style")},updateGradient:function(ct){var ut,ht,dt=ct.gradNode1,pt=ct.gradNode2,ft=nt.evaluate(ct.visProp.gradient);nt.exists(dt)&&nt.exists(pt)&&(ht=nt.evaluate(ct.visProp.fillopacity),ht=ht>0?ht:0,ut=nt.evaluate(ct.visProp.fillcolor),ft==="linear"?(dt.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),pt.setAttributeNS(null,"style","stop-color:"+nt.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+nt.evaluate(ct.visProp.gradientsecondopacity))):ft==="radial"&&(dt.setAttributeNS(null,"style","stop-color:"+nt.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+nt.evaluate(ct.visProp.gradientsecondopacity)),pt.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht)))},setObjectTransition:function(ct,ut){var ht,dt,pt,ft,gt=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(ut===void 0&&(ut=nt.evaluate(ct.visProp.transitionduration)),ut!==ct.visPropOld.transitionduration){for(dt=ct.elementClass===it.OBJECT_CLASS_TEXT&&nt.evaluate(ct.visProp.display)==="html"?" color "+ut+"ms, opacity "+ut+"ms":" fill "+ut+"ms, fill-opacity "+ut+"ms, stroke "+ut+"ms, stroke-opacity "+ut+"ms",ft=gt.length,pt=0;pt<ft;++pt)ct[gt[pt]]&&(ht=ct[gt[pt]],ht.style.transition=dt);ct.visPropOld.transitionduration=ut}},_setAttribute:function(ct,ut){ut===""?ct():setTimeout(ct,1)},setObjectFillColor:function(ct,ut,ht,dt){var pt,ft,gt,mt,At=nt.evaluate(ut),yt=nt.evaluate(ht);yt=yt>0?yt:0,ct.visPropOld.fillcolor===At&&ct.visPropOld.fillopacity===yt||(nt.exists(At)&&At!==!1&&(At.length!==9?(ft=At,mt=yt):(gt=at.rgba2rgbo(At),ft=gt[0],mt=yt*gt[1]),pt=dt===void 0?ct.rendNode:dt,ft!=="none"&&this._setAttribute(function(){pt.setAttributeNS(null,"fill",ft)},ct.visPropOld.fillcolor),ct.type===tt.OBJECT_TYPE_IMAGE?this._setAttribute(function(){pt.setAttributeNS(null,"opacity",mt)},ct.visPropOld.fillopacity):(ft==="none"&&(mt=0),this._setAttribute(function(){pt.setAttributeNS(null,"fill-opacity",mt)},ct.visPropOld.fillopacity)),nt.exists(ct.visProp.gradient)&&this.updateGradient(ct)),ct.visPropOld.fillcolor=At,ct.visPropOld.fillopacity=yt)},setObjectStrokeColor:function(ct,ut,ht){var dt,pt,ft,gt,mt=nt.evaluate(ut),At=nt.evaluate(ht);At=At>0?At:0,ct.visPropOld.strokecolor===mt&&ct.visPropOld.strokeopacity===At||(nt.exists(mt)&&mt!==!1&&(mt.length!==9?(dt=mt,ft=At):(pt=at.rgba2rgbo(mt),dt=pt[0],ft=At*pt[1]),gt=ct.rendNode,ct.elementClass===it.OBJECT_CLASS_TEXT?nt.evaluate(ct.visProp.display)==="html"?this._setAttribute(function(){gt.style.color=dt,gt.style.opacity=ft},ct.visPropOld.strokecolor):this._setAttribute(function(){gt.setAttributeNS(null,"style","fill:"+dt),gt.setAttributeNS(null,"style","fill-opacity:"+ft)},ct.visPropOld.strokecolor):this._setAttribute(function(){gt.setAttributeNS(null,"stroke",dt),gt.setAttributeNS(null,"stroke-opacity",ft)},ct.visPropOld.strokecolor),ct.elementClass!==it.OBJECT_CLASS_CURVE&&ct.elementClass!==it.OBJECT_CLASS_LINE||(nt.evaluate(ct.visProp.firstarrow)&&this._setArrowColor(ct.rendNodeTriangleStart,dt,ft,ct),nt.evaluate(ct.visProp.lastarrow)&&this._setArrowColor(ct.rendNodeTriangleEnd,dt,ft,ct))),ct.visPropOld.strokecolor=mt,ct.visPropOld.strokeopacity=At)},setObjectStrokeWidth:function(ct,ut){var ht,dt=nt.evaluate(ut);isNaN(dt)||ct.visPropOld.strokewidth===dt||(ht=ct.rendNode,this.setPropertyPrim(ht,"stroked","true"),nt.exists(dt)&&this.setPropertyPrim(ht,"stroke-width",dt+"px"),ct.visPropOld.strokewidth=dt)},setLineCap:function(ct){var ut=nt.evaluate(ct.visProp.linecap);ut!==void 0&&ut!==""&&ct.visPropOld.linecap!==ut&&nt.exists(ct.rendNode)&&(this.setPropertyPrim(ct.rendNode,"stroke-linecap",ut),ct.visPropOld.linecap=ut)},setShadow:function(ct){var ut=nt.evaluate(ct.visProp.shadow);ct.visPropOld.shadow!==ut&&(nt.exists(ct.rendNode)&&(ut?ct.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):ct.rendNode.removeAttributeNS(null,"filter")),ct.visPropOld.shadow=ut)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(ct,ut){this.svgRoot.style.width=parseFloat(ct)+"px",this.svgRoot.style.height=parseFloat(ut)+"px",this.svgRoot.setAttribute("width",parseFloat(ct)),this.svgRoot.setAttribute("height",parseFloat(ut))},createTouchpoints:function(ct){var ut,ht,dt,pt;for(this.touchpoints=[],ut=0;ut<ct;ut++)ht="touchpoint1_"+ut,pt=this.createPrim("path",ht),this.appendChildPrim(pt,19),pt.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(pt),this.setPropertyPrim(pt,"stroked","true"),this.setPropertyPrim(pt,"stroke-width","1px"),pt.setAttributeNS(null,"stroke","#000000"),pt.setAttributeNS(null,"stroke-opacity",1),pt.setAttributeNS(null,"display","none"),dt="touchpoint2_"+ut,pt=this.createPrim("ellipse",dt),this.appendChildPrim(pt,19),this.updateEllipsePrim(pt,0,0,0,0),this.touchpoints.push(pt),this.setPropertyPrim(pt,"stroked","true"),this.setPropertyPrim(pt,"stroke-width","1px"),pt.setAttributeNS(null,"stroke","#000000"),pt.setAttributeNS(null,"stroke-opacity",1),pt.setAttributeNS(null,"fill","#ffffff"),pt.setAttributeNS(null,"fill-opacity",0),pt.setAttributeNS(null,"display","none")},showTouchpoint:function(ct){this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(this.touchpoints[2*ct].setAttributeNS(null,"display","inline"),this.touchpoints[2*ct+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(ct){this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(this.touchpoints[2*ct].setAttributeNS(null,"display","none"),this.touchpoints[2*ct+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(ct,ut){var ht,dt;this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(ht=ut[0],dt=ut[1],this.touchpoints[2*ct].setAttributeNS(null,"d","M "+(ht-37)+" "+dt+" L "+(ht+37)+" "+dt+" M "+ht+" "+(dt-37)+" L "+ht+" "+(dt+37)),this.updateEllipsePrim(this.touchpoints[2*ct+1],ut[0],ut[1],25,25))},dumpToCanvas:function(ct,ut,ht,dt){var pt,ft,gt,mt,At,yt,bt,xt,vt=this.svgRoot,_t=window.btoa||lt.encode;if(this.container.hasChildNodes()&&nt.exists(this.foreignObjLayer)){for(;vt.nextSibling;)this.foreignObjLayer.appendChild(vt.nextSibling);dt===!0&&(xt=this.container.ownerDocument,bt=xt.createElement("div"),bt.appendChild(this.foreignObjLayer))}if(vt.setAttribute("xmlns","http://www.w3.org/2000/svg"),At=vt.getAttribute("width"),yt=vt.getAttribute("height"),pt=new XMLSerializer().serializeToString(vt),(pt.match(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g)||[]).length>1&&(pt=pt.replace(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g,"")),pt=pt.replace(/&nbsp;/g," "),gt=document.getElementById(ct),gt.width=gt.width,mt=gt.getContext("2d"),ut!==void 0&&ht!==void 0&&(gt.style.width=parseFloat(ut)+"px",gt.style.height=parseFloat(ht)+"px",gt.setAttribute("width",2*parseFloat(At)),gt.setAttribute("height",2*parseFloat(yt)),mt.scale(2*At/ut,2*yt/ht)),ft=new Image,ft.src="data:image/svg+xml;base64,"+_t(unescape(encodeURIComponent(pt))),ft.onload=function(){setTimeout(function(){mt.drawImage(ft,0,0,ut,ht)},200)},nt.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes())for(dt===!0&&vt.appendChild(this.foreignObjLayer);this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);return this},screenshot:function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=this.container.ownerDocument,St=this.container.parentNode,Et=ct.attr.screenshot,Tt=!1;return this.type==="no"?this:(bt=Et.scale*parseFloat(this.container.style.width),xt=Et.scale*parseFloat(this.container.style.height),ut===void 0||ut===""?(Tt=!0,mt=new Image,mt.style.width=bt+"px",mt.style.height=xt+"px"):(Tt=!1,mt=Ct.getElementById(ut)),Tt&&(dt=Ct.createElement("div"),dt.style.cssText=Et.css,dt.style.width=bt+"px",dt.style.height=xt+"px",dt.style.zIndex=this.container.style.zIndex+120,pt=ct.getCoordsTopLeftCorner(),dt.style.position="absolute",dt.style.left=pt[0]+"px",dt.style.top=pt[1]+"px"),ft=Ct.createElement("canvas"),gt=Math.random().toString(36).substr(2,5),ft.setAttribute("id",gt),ft.setAttribute("width",bt),ft.setAttribute("height",xt),ft.style.width=bt+"px",ft.style.height=bt+"px",ft.style.display="none",St.append(ft),Tt&&(At=Ct.createElement("span"),yt=Ct.createTextNode("✖"),At.style.cssText=Et.cssButton,At.appendChild(yt),At.onclick=function(){dt.parentNode.removeChild(dt)},dt.appendChild(mt),dt.appendChild(At),St.appendChild(dt)),vt=document.getElementById(this.container.id+"_navigationbar"),nt.exists(vt)&&(_t=vt.style.display,vt.style.display="none"),this.dumpToCanvas(gt,bt,xt,ht),setTimeout(function(){mt.src=ft.toDataURL("image/png"),St.removeChild(ft)},400),nt.exists(vt)&&(vt.style.display=_t),this)}}),tt.SVGRenderer}),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],function(tt,_e,rt,it,nt,st,at){return tt.VMLRenderer=function(lt){this.type="vml",this.container=lt,this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,it.exists(tt.vmlStylesheet)||(lt.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),tt.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),tt.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{lt.ownerDocument.namespaces.jxgvml||lt.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(ot){return lt.ownerDocument.createElement("<jxgvml:"+ot+' class="jxgvml">')}}catch{this.createNode=function(ct){return lt.ownerDocument.createElement("<"+ct+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},tt.VMLRenderer.prototype=new _e,tt.extend(tt.VMLRenderer.prototype,{_setAttr:function(lt,ot,ct,ut){try{this.container.ownerDocument.documentMode===8?lt[ot]=ct:lt.setAttribute(ot,ct,ut)}catch{tt.debug("_setAttr: "+ot+" "+ct+`<br>
`)}},updateTicks:function(lt){var ot,ct,ut,ht,dt,pt=this.resolution,ft=[];for(ct=lt.ticks.length,ot=0;ot<ct;ot++)ut=lt.ticks[ot],ht=ut[0],dt=ut[1],it.isNumber(ht[0])&&it.isNumber(ht[1])&&ft.push(" m "+Math.round(pt*ht[0])+", "+Math.round(pt*dt[0])+" l "+Math.round(pt*ht[1])+", "+Math.round(pt*dt[1])+" ");it.exists(lt.rendNode)||(lt.rendNode=this.createPrim("path",lt.id),this.appendChildPrim(lt.rendNode,it.evaluate(lt.visProp.layer))),this._setAttr(lt.rendNode,"stroked","true"),this._setAttr(lt.rendNode,"strokecolor",it.evaluate(lt.visProp.strokecolor),1),this._setAttr(lt.rendNode,"strokeweight",it.evaluate(lt.visProp.strokewidth)),this._setAttr(lt.rendNodeStroke,"opacity",100*it.evaluate(lt.visProp.strokeopacity)+"%"),this.updatePathPrim(lt.rendNode,ft,lt.board)},displayCopyright:function(lt,ot){var ct,ut;ct=this.createNode("textbox"),ct.style.position="absolute",this._setAttr(ct,"id",this.container.id+"_licenseText"),ct.style.left=20,ct.style.top=2,ct.style.fontSize=ot,ct.style.color="#356AA0",ct.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(ct,"opacity","30%"),ct.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",ut=this.container.ownerDocument.createTextNode(lt),ct.appendChild(ut),this.appendChildPrim(ct,0)},drawInternalText:function(lt){var ot;return ot=this.createNode("textbox"),ot.style.position="absolute",lt.rendNodeText=this.container.ownerDocument.createTextNode(""),ot.appendChild(lt.rendNodeText),this.appendChildPrim(ot,9),ot.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",ot},updateInternalText:function(lt){var ot,ct,ut,ht,dt,pt,ft=lt.plaintext,gt=this.joinTransforms(lt,lt.transformations),mt=[0,0],At=lt.rendNode,yt=[],bt=lt.getAnchorX(),xt=lt.getAnchorY();if(!isNaN(lt.coords.scrCoords[1]+lt.coords.scrCoords[2])){for(bt==="right"?mt[0]=1:bt==="middle"&&(mt[0]=.5),xt==="bottom"?mt[1]=1:xt==="middle"&&(mt[1]=.5),yt[0]=st.matVecMult(gt,[1,lt.coords.scrCoords[1]-mt[0]*lt.size[0],lt.coords.scrCoords[2]+(1-mt[1])*lt.size[1]+this.vOffsetText]),yt[0][1]/=yt[0][0],yt[0][2]/=yt[0][0],yt[1]=st.matVecMult(gt,[1,lt.coords.scrCoords[1]+(1-mt[0])*lt.size[0],lt.coords.scrCoords[2]+(1-mt[1])*lt.size[1]+this.vOffsetText]),yt[1][1]/=yt[1][0],yt[1][2]/=yt[1][0],yt[2]=st.matVecMult(gt,[1,lt.coords.scrCoords[1]+(1-mt[0])*lt.size[0],lt.coords.scrCoords[2]-mt[1]*lt.size[1]+this.vOffsetText]),yt[2][1]/=yt[2][0],yt[2][2]/=yt[2][0],yt[3]=st.matVecMult(gt,[1,lt.coords.scrCoords[1]-mt[0]*lt.size[0],lt.coords.scrCoords[2]-mt[1]*lt.size[1]+this.vOffsetText]),yt[3][1]/=yt[3][0],yt[3][2]/=yt[3][0],ct=yt[0][1],ht=yt[0][1],ut=yt[0][2],dt=yt[0][2],pt=1;pt<4;pt++)ct=Math.max(ct,yt[pt][1]),ht=Math.min(ht,yt[pt][1]),ut=Math.max(ut,yt[pt][2]),dt=Math.min(dt,yt[pt][2]);ot=mt[0]===1?Math.floor(lt.board.canvasWidth-ct):Math.floor(ht),lt.visPropOld.left!==bt+ot&&(mt[0]===1?(lt.rendNode.style.right=ot+"px",lt.rendNode.style.left="auto"):(lt.rendNode.style.left=ot+"px",lt.rendNode.style.right="auto"),lt.visPropOld.left=bt+ot),ot=mt[1]===1?Math.floor(lt.board.canvasHeight-ut):Math.floor(dt),lt.visPropOld.top!==xt+ot&&(mt[1]===1?(lt.rendNode.style.bottom=ot+"px",lt.rendNode.style.top="auto"):(lt.rendNode.style.top=ot+"px",lt.rendNode.style.bottom="auto"),lt.visPropOld.top=xt+ot)}lt.htmlStr!==ft&&(lt.rendNodeText.data=ft,lt.htmlStr=ft),At.filters.item(0).M11=gt[1][1],At.filters.item(0).M12=gt[1][2],At.filters.item(0).M21=gt[2][1],At.filters.item(0).M22=gt[2][2],At.filters.item(0).enabled=!0},drawImage:function(lt){var ot;ot=this.container.ownerDocument.createElement("img"),ot.style.position="absolute",this._setAttr(ot,"id",this.container.id+"_"+lt.id),this.container.appendChild(ot),this.appendChildPrim(ot,it.evaluate(lt.visProp.layer)),ot.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",lt.rendNode=ot,this.updateImage(lt)},transformImage:function(lt,ot){var ct,ut,ht,dt,pt,ft,gt=lt.rendNode,mt=[];if(ot.length>0){for(ct=this.joinTransforms(lt,ot),mt[0]=st.matVecMult(ct,lt.coords.scrCoords),mt[0][1]/=mt[0][0],mt[0][2]/=mt[0][0],mt[1]=st.matVecMult(ct,[1,lt.coords.scrCoords[1]+lt.size[0],lt.coords.scrCoords[2]]),mt[1][1]/=mt[1][0],mt[1][2]/=mt[1][0],mt[2]=st.matVecMult(ct,[1,lt.coords.scrCoords[1]+lt.size[0],lt.coords.scrCoords[2]-lt.size[1]]),mt[2][1]/=mt[2][0],mt[2][2]/=mt[2][0],mt[3]=st.matVecMult(ct,[1,lt.coords.scrCoords[1],lt.coords.scrCoords[2]-lt.size[1]]),mt[3][1]/=mt[3][0],mt[3][2]/=mt[3][0],ut=mt[0][1],dt=mt[0][1],ht=mt[0][2],pt=mt[0][2],ft=1;ft<4;ft++)ut=Math.max(ut,mt[ft][1]),dt=Math.min(dt,mt[ft][1]),ht=Math.max(ht,mt[ft][2]),pt=Math.min(pt,mt[ft][2]);gt.style.left=Math.floor(dt)+"px",gt.style.top=Math.floor(pt)+"px",gt.filters.item(0).M11=ct[1][1],gt.filters.item(0).M12=ct[1][2],gt.filters.item(0).M21=ct[2][1],gt.filters.item(0).M22=ct[2][2],gt.filters.item(0).enabled=!0}},updateImageURL:function(lt){var ot=it.evaluate(lt.url);this._setAttr(lt.rendNode,"src",ot)},appendChildPrim:function(lt,ot){return it.exists(ot)||(ot=0),lt.style.zIndex=ot,this.container.appendChild(lt),lt},appendNodesToElement:function(lt,ot){ot!=="shape"&&ot!=="path"&&ot!=="polygon"||(lt.rendNodePath=this.getElementById(lt.id+"_path")),lt.rendNodeFill=this.getElementById(lt.id+"_fill"),lt.rendNodeStroke=this.getElementById(lt.id+"_stroke"),lt.rendNodeShadow=this.getElementById(lt.id+"_shadow"),lt.rendNode=this.getElementById(lt.id)},createPrim:function(lt,ot){var ct,ut,ht=this.createNode("fill"),dt=this.createNode("stroke"),pt=this.createNode("shadow");return this._setAttr(ht,"id",this.container.id+"_"+ot+"_fill"),this._setAttr(dt,"id",this.container.id+"_"+ot+"_stroke"),this._setAttr(pt,"id",this.container.id+"_"+ot+"_shadow"),lt==="circle"||lt==="ellipse"?(ct=this.createNode("oval"),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(pt)):lt==="polygon"||lt==="path"||lt==="shape"||lt==="line"?(ct=this.createNode("shape"),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(pt),ut=this.createNode("path"),this._setAttr(ut,"id",this.container.id+"_"+ot+"_path"),ct.appendChild(ut)):(ct=this.createNode(lt),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(pt)),ct.style.position="absolute",ct.style.left="0px",ct.style.top="0px",this._setAttr(ct,"id",this.container.id+"_"+ot),ct},remove:function(lt){it.exists(lt)&&lt.removeNode(!0)},makeArrows:function(lt){var ot,ct=it.evaluate(lt.visProp.firstarrow),ut=it.evaluate(lt.visProp.lastarrow);lt.visPropOld.firstarrow===ct&&lt.visPropOld.lastarrow===ut||(ct?(ot=lt.rendNodeStroke,this._setAttr(ot,"startarrow","block"),this._setAttr(ot,"startarrowlength","long")):(ot=lt.rendNodeStroke,it.exists(ot)&&this._setAttr(ot,"startarrow","none")),ut?(ot=lt.rendNodeStroke,this._setAttr(ot,"id",this.container.id+"_"+lt.id+"stroke"),this._setAttr(ot,"endarrow","block"),this._setAttr(ot,"endarrowlength","long")):(ot=lt.rendNodeStroke,it.exists(ot)&&this._setAttr(ot,"endarrow","none")),lt.visPropOld.firstarrow=ct,lt.visPropOld.lastarrow=ut)},updateEllipsePrim:function(lt,ot,ct,ut,ht){lt.style.left=Math.floor(ot-ut)+"px",lt.style.top=Math.floor(ct-ht)+"px",lt.style.width=Math.floor(2*Math.abs(ut))+"px",lt.style.height=Math.floor(2*Math.abs(ht))+"px"},updateLinePrim:function(lt,ot,ct,ut,ht,dt){var pt,ft=this.resolution;isNaN(ot+ct+ut+ht)||(pt=["m ",Math.floor(ft*ot),", ",Math.floor(ft*ct)," l ",Math.floor(ft*ut),", ",Math.floor(ft*ht)],this.updatePathPrim(lt,pt,dt))},updatePathPrim:function(lt,ot,ct){var ut=ct.canvasWidth,ht=ct.canvasHeight;ot.length<=0&&(ot=["m 0,0"]),lt.style.width=ut,lt.style.height=ht,this._setAttr(lt,"coordsize",[Math.floor(this.resolution*ut),Math.floor(this.resolution*ht)].join(",")),this._setAttr(lt,"path",ot.join(""))},updatePathStringPoint:function(lt,ot,ct){var ut=[],ht=Math.round,dt=lt.coords.scrCoords,pt=ot*Math.sqrt(3)*.5,ft=.5*ot,gt=this.resolution;return ct==="x"?ut.push([" m ",ht(gt*(dt[1]-ot)),", ",ht(gt*(dt[2]-ot))," l ",ht(gt*(dt[1]+ot)),", ",ht(gt*(dt[2]+ot))," m ",ht(gt*(dt[1]+ot)),", ",ht(gt*(dt[2]-ot))," l ",ht(gt*(dt[1]-ot)),", ",ht(gt*(dt[2]+ot))].join("")):ct==="+"?ut.push([" m ",ht(gt*(dt[1]-ot)),", ",ht(gt*dt[2])," l ",ht(gt*(dt[1]+ot)),", ",ht(gt*dt[2])," m ",ht(gt*dt[1]),", ",ht(gt*(dt[2]-ot))," l ",ht(gt*dt[1]),", ",ht(gt*(dt[2]+ot))].join("")):ct==="<>"?ut.push([" m ",ht(gt*(dt[1]-ot)),", ",ht(gt*dt[2])," l ",ht(gt*dt[1]),", ",ht(gt*(dt[2]+ot))," l ",ht(gt*(dt[1]+ot)),", ",ht(gt*dt[2])," l ",ht(gt*dt[1]),", ",ht(gt*(dt[2]-ot))," x e "].join("")):ct==="^"?ut.push([" m ",ht(gt*dt[1]),", ",ht(gt*(dt[2]-ot))," l ",ht(gt*(dt[1]-pt)),", ",ht(gt*(dt[2]+ft))," l ",ht(gt*(dt[1]+pt)),", ",ht(gt*(dt[2]+ft))," x e "].join("")):ct==="v"?ut.push([" m ",ht(gt*dt[1]),", ",ht(gt*(dt[2]+ot))," l ",ht(gt*(dt[1]-pt)),", ",ht(gt*(dt[2]-ft))," l ",ht(gt*(dt[1]+pt)),", ",ht(gt*(dt[2]-ft))," x e "].join("")):ct===">"?ut.push([" m ",ht(gt*(dt[1]+ot)),", ",ht(gt*dt[2])," l ",ht(gt*(dt[1]-ft)),", ",ht(gt*(dt[2]-pt))," l ",ht(gt*(dt[1]-ft)),", ",ht(gt*(dt[2]+pt))," l ",ht(gt*(dt[1]+ot)),", ",ht(gt*dt[2])].join("")):ct==="<"&&ut.push([" m ",ht(gt*(dt[1]-ot)),", ",ht(gt*dt[2])," l ",ht(gt*(dt[1]+ft)),", ",ht(gt*(dt[2]-pt))," l ",ht(gt*(dt[1]+ft)),", ",ht(gt*(dt[2]+pt))," x e "].join("")),ut},updatePathStringPrim:function(lt){var ot,ct,ut=[],ht=this.resolution,dt=Math.round,pt=" m ",ft=Math.min(lt.numberPoints,8192);if(lt.numberPoints<=0)return"";if(ft=Math.min(ft,lt.points.length),lt.bezierDegree===1)for(ot=0;ot<ft;ot++)ct=lt.points[ot].scrCoords,isNaN(ct[1])||isNaN(ct[2])?pt=" m ":(ct[1]>2e4?ct[1]=2e4:ct[1]<-2e4&&(ct[1]=-2e4),ct[2]>2e4?ct[2]=2e4:ct[2]<-2e4&&(ct[2]=-2e4),ut.push([pt,dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),pt=" l ");else if(lt.bezierDegree===3)for(ot=0;ot<ft;)ct=lt.points[ot].scrCoords,isNaN(ct[1])||isNaN(ct[2])?pt=" m ":(ut.push([pt,dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),pt===" c "&&(ot+=1,ct=lt.points[ot].scrCoords,ut.push([" ",dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),ot+=1,ct=lt.points[ot].scrCoords,ut.push([" ",dt(ht*ct[1]),", ",dt(ht*ct[2])].join(""))),pt=" c "),ot+=1;return ut.push(" e"),ut},updatePathStringBezierPrim:function(lt){var ot,ct,ut,ht,dt,pt,ft=[],gt=it.evaluate(lt.visProp.strokewidth),mt=this.resolution,At=Math.round,yt=" m ",bt=it.evaluate(lt.visProp.curvetype)!=="plot",xt=Math.min(lt.numberPoints,8192);if(lt.numberPoints<=0)return"";for(bt&&lt.board.options.curve.RDPsmoothing&&(lt.points=at.RamerDouglasPeucker(lt.points,1)),xt=Math.min(xt,lt.points.length),ct=1;ct<3;ct++)for(yt=" m ",ot=0;ot<xt;ot++)ht=lt.points[ot].scrCoords,isNaN(ht[1])||isNaN(ht[2])?yt=" m ":(ht[1]>2e4?ht[1]=2e4:ht[1]<-2e4&&(ht[1]=-2e4),ht[2]>2e4?ht[2]=2e4:ht[2]<-2e4&&(ht[2]=-2e4),yt===" m "?ft.push([yt,At(mt*ht[1])," ",At(mt*ht[2])].join("")):(ut=2*ct,ft.push([yt,At(mt*(dt+.333*(ht[1]-dt)+gt*(ut*Math.random()-ct)))," ",At(mt*(pt+.333*(ht[2]-pt)+gt*(ut*Math.random()-ct)))," ",At(mt*(dt+.666*(ht[1]-dt)+gt*(ut*Math.random()-ct)))," ",At(mt*(pt+.666*(ht[2]-pt)+gt*(ut*Math.random()-ct)))," ",At(mt*ht[1])," ",At(mt*ht[2])].join(""))),yt=" c ",dt=ht[1],pt=ht[2]);return ft.push(" e"),ft},updatePolygonPrim:function(lt,ot){var ct,ut,ht=ot.vertices.length,dt=this.resolution,pt=[];if(this._setAttr(lt,"stroked","false"),ut=ot.vertices[0].coords.scrCoords,!isNaN(ut[1]+ut[2])){for(pt.push(["m ",Math.floor(dt*ut[1]),",",Math.floor(dt*ut[2])," l "].join("")),ct=1;ct<ht-1;ct++){if(!ot.vertices[ct].isReal)return void this.updatePathPrim(lt,"",ot.board);if(ut=ot.vertices[ct].coords.scrCoords,isNaN(ut[1]+ut[2]))return;pt.push(Math.floor(dt*ut[1])+","+Math.floor(dt*ut[2])),ct<ht-2&&pt.push(", ")}pt.push(" x e"),this.updatePathPrim(lt,pt,ot.board)}},updateRectPrim:function(lt,ot,ct,ut,ht){lt.style.left=Math.floor(ot)+"px",lt.style.top=Math.floor(ct)+"px",ut>=0&&(lt.style.width=ut+"px"),ht>=0&&(lt.style.height=ht+"px")},setPropertyPrim:function(lt,ot,ct){var ut,ht="";switch(ot){case"stroke":ht="strokecolor";break;case"stroke-width":ht="strokeweight";break;case"stroke-dasharray":ht="dashstyle"}ht!==""&&(ut=it.evaluate(ct),this._setAttr(lt,ht,ut))},display:function(lt,ot){lt&&lt.rendNode&&(lt.visPropOld.visible=ot,lt.rendNode.style.visibility=ot?"inherit":"hidden")},show:function(lt){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),lt&&lt.rendNode&&(lt.rendNode.style.visibility="inherit")},hide:function(lt){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),lt&&lt.rendNode&&(lt.rendNode.style.visibility="hidden")},setDashStyle:function(lt,ot){var ct;ot.dash>=0&&(ct=lt.rendNodeStroke,this._setAttr(ct,"dashstyle",this.dashArray[ot.dash]))},setGradient:function(lt){var ot=lt.rendNodeFill,ct=it.evaluate(lt.visProp.gradient);ct==="linear"?(this._setAttr(ot,"type","gradient"),this._setAttr(ot,"color2",it.evaluate(lt.visProp.gradientsecondcolor)),this._setAttr(ot,"opacity2",it.evaluate(lt.visProp.gradientsecondopacity)),this._setAttr(ot,"angle",it.evaluate(lt.visProp.gradientangle))):ct==="radial"?(this._setAttr(ot,"type","gradientradial"),this._setAttr(ot,"color2",it.evaluate(lt.visProp.gradientsecondcolor)),this._setAttr(ot,"opacity2",it.evaluate(lt.visProp.gradientsecondopacity)),this._setAttr(ot,"focusposition",100*it.evaluate(lt.visProp.gradientpositionx)+"%,"+100*it.evaluate(lt.visProp.gradientpositiony)+"%"),this._setAttr(ot,"focussize","0,0")):this._setAttr(ot,"type","solid")},setObjectFillColor:function(lt,ot,ct){var ut,ht,dt,pt=it.evaluate(ot),ft=it.evaluate(ct),gt=lt.rendNode;ft=ft>0?ft:0,lt.visPropOld.fillcolor===pt&&lt.visPropOld.fillopacity===ft||(it.exists(pt)&&pt!==!1&&(pt.length!==9?(ut=pt,dt=ft):(ht=nt.rgba2rgbo(pt),ut=ht[0],dt=ft*ht[1]),ut==="none"||ut===!1?this._setAttr(lt.rendNode,"filled","false"):(this._setAttr(lt.rendNode,"filled","true"),this._setAttr(lt.rendNode,"fillcolor",ut),it.exists(dt)&&lt.rendNodeFill&&this._setAttr(lt.rendNodeFill,"opacity",100*dt+"%")),lt.type===rt.OBJECT_TYPE_IMAGE&&gt.filters.length>1&&(gt.filters.item(1).opacity=Math.round(100*dt),gt.filters.item(1).enabled=!0)),lt.visPropOld.fillcolor=pt,lt.visPropOld.fillopacity=ft)},setObjectStrokeColor:function(lt,ot,ct){var ut,ht,dt,pt,ft=it.evaluate(ot),gt=it.evaluate(ct),mt=lt.rendNode;gt=gt>0?gt:0,lt.visPropOld.strokecolor===ft&&lt.visPropOld.strokeopacity===gt||(it.exists(ft)&&ft!==!1&&(ft.length!==9?(ut=ft,dt=gt):(ht=ot.rgba2rgbo(ft),ut=ht[0],dt=gt*ht[1]),lt.elementClass===rt.OBJECT_CLASS_TEXT?(mt.filters.length>1&&(mt.filters.item(1).opacity=Math.round(100*dt),mt.filters.item(1).enabled=!0),mt.style.color=ut):(ut!==!1&&(this._setAttr(mt,"stroked","true"),this._setAttr(mt,"strokecolor",ut)),pt=lt.rendNodeStroke,it.exists(dt)&&lt.type!==rt.OBJECT_TYPE_IMAGE&&this._setAttr(pt,"opacity",100*dt+"%"))),lt.visPropOld.strokecolor=ft,lt.visPropOld.strokeopacity=gt)},setObjectStrokeWidth:function(lt,ot){var ct,ut=it.evaluate(ot);isNaN(ut)||lt.visPropOld.strokewidth===ut||(ct=lt.rendNode,this.setPropertyPrim(ct,"stroked","true"),it.exists(ut)&&(this.setPropertyPrim(ct,"stroke-width",ut),ut===0&&it.exists(lt.rendNodeStroke)&&this._setAttr(ct,"stroked","false")),lt.visPropOld.strokewidth=ut)},setShadow:function(lt){var ot=lt.rendNodeShadow,ct=it.evaluate(lt.visProp.shadow);ot&&lt.visPropOld.shadow!==ct&&(ct?(this._setAttr(ot,"On","True"),this._setAttr(ot,"Offset","3pt,3pt"),this._setAttr(ot,"Opacity","60%"),this._setAttr(ot,"Color","#aaaaaa")):this._setAttr(ot,"On","False"),lt.visPropOld.shadow=ct)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),tt.VMLRenderer}),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut){return tt.CanvasRenderer=function(ht,dt){this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=st.genUUID(),this.canvasNamespace=null,it.isBrowser?(this.container=ht,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',dt.width,'px" height="',dt.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.context=this.canvasRoot.getContext("2d")):it.isNode()&&(this.canvasId=module.require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")),this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},tt.CanvasRenderer.prototype=new _e,tt.extend(tt.CanvasRenderer.prototype,{_drawFilledPolygon:function(ht){var dt,pt=ht.length,ft=this.context;if(pt>0){for(ft.beginPath(),ft.moveTo(ht[0][0],ht[0][1]),dt=0;dt<pt;dt++)dt>0&&ft.lineTo(ht[dt][0],ht[dt][1]);ft.lineTo(ht[0][0],ht[0][1]),ft.fill()}},_fill:function(ht){var dt=this.context;dt.save(),this._setColor(ht,"fill")&&dt.fill(),dt.restore()},_rotatePoint:function(ht,dt,pt){return[dt*Math.cos(ht)-pt*Math.sin(ht),dt*Math.sin(ht)+pt*Math.cos(ht)]},_rotateShape:function(ht,dt){var pt,ft=[],gt=ht.length;if(gt<=0)return ht;for(pt=0;pt<gt;pt++)ft.push(this._rotatePoint(dt,ht[pt][0],ht[pt][1]));return ft},_setColor:function(ht,dt,pt){var ft,gt,mt,At,yt,bt,xt,vt=!0,_t=!1,Ct=ht.visProp;return dt=dt||"stroke",pt=pt||dt,nt.exists(ht.board)&&nt.exists(ht.board.highlightedObjects)||(_t=!0),ft=!_t&&nt.exists(ht.board.highlightedObjects[ht.id])?"highlight":"",mt=nt.evaluate(Ct[ft+dt+"color"]),mt!=="none"&&mt!==!1?(bt=nt.evaluate(Ct[ft+dt+"opacity"]),bt=bt>0?bt:0,mt.length!==9?(yt=mt,xt=bt):(At=at.rgba2rgbo(mt),yt=At[0],xt=bt*At[1]),this.context.globalAlpha=xt,this.context[pt+"Style"]=yt):vt=!1,gt=parseFloat(nt.evaluate(Ct.strokewidth)),dt!=="stroke"||isNaN(gt)||(gt===0?this.context.globalAlpha=0:this.context.lineWidth=gt),dt==="stroke"&&Ct.linecap!==void 0&&Ct.linecap!==""&&(this.context.lineCap=Ct.linecap),vt},_stroke:function(ht){var dt=this.context,pt=nt.evaluate(ht.visProp.dash);dt.save(),pt>0?dt.setLineDash&&dt.setLineDash(this.dashArray[pt]):this.context.lineDashArray=[],this._setColor(ht,"stroke")&&dt.stroke(),dt.restore()},_translateShape:function(ht,dt,pt){var ft,gt=[],mt=ht.length;if(mt<=0)return ht;for(ft=0;ft<mt;ft++)gt.push([ht[ft][0]+dt,ht[ft][1]+pt]);return gt},drawPoint:function(ht){var dt=nt.evaluate(ht.visProp.face),pt=nt.evaluate(ht.visProp.size),ft=ht.coords.scrCoords,gt=pt*Math.sqrt(3)*.5,mt=.5*pt,At=parseFloat(nt.evaluate(ht.visProp.strokewidth))/2,yt=this.context;if(ht.visPropCalc.visible)switch(dt){case"cross":case"x":yt.beginPath(),yt.moveTo(ft[1]-pt,ft[2]-pt),yt.lineTo(ft[1]+pt,ft[2]+pt),yt.moveTo(ft[1]+pt,ft[2]-pt),yt.lineTo(ft[1]-pt,ft[2]+pt),yt.lineCap="round",yt.lineJoin="round",yt.closePath(),this._stroke(ht);break;case"circle":case"o":yt.beginPath(),yt.arc(ft[1],ft[2],pt+1+At,0,2*Math.PI,!1),yt.closePath(),this._fill(ht),this._stroke(ht);break;case"square":case"[]":if(pt<=0)break;yt.save(),this._setColor(ht,"stroke","fill")&&yt.fillRect(ft[1]-pt-At,ft[2]-pt-At,2*pt+3*At,2*pt+3*At),yt.restore(),yt.save(),this._setColor(ht,"fill"),yt.fillRect(ft[1]-pt+At,ft[2]-pt+At,2*pt-At,2*pt-At),yt.restore();break;case"plus":case"+":yt.beginPath(),yt.moveTo(ft[1]-pt,ft[2]),yt.lineTo(ft[1]+pt,ft[2]),yt.moveTo(ft[1],ft[2]-pt),yt.lineTo(ft[1],ft[2]+pt),yt.lineCap="round",yt.lineJoin="round",yt.closePath(),this._stroke(ht);break;case"diamond":case"<>":yt.beginPath(),yt.moveTo(ft[1]-pt,ft[2]),yt.lineTo(ft[1],ft[2]+pt),yt.lineTo(ft[1]+pt,ft[2]),yt.lineTo(ft[1],ft[2]-pt),yt.closePath(),this._fill(ht),this._stroke(ht);break;case"triangleup":case"a":case"^":yt.beginPath(),yt.moveTo(ft[1],ft[2]-pt),yt.lineTo(ft[1]-gt,ft[2]+mt),yt.lineTo(ft[1]+gt,ft[2]+mt),yt.closePath(),this._fill(ht),this._stroke(ht);break;case"triangledown":case"v":yt.beginPath(),yt.moveTo(ft[1],ft[2]+pt),yt.lineTo(ft[1]-gt,ft[2]-mt),yt.lineTo(ft[1]+gt,ft[2]-mt),yt.closePath(),this._fill(ht),this._stroke(ht);break;case"triangleleft":case"<":yt.beginPath(),yt.moveTo(ft[1]-pt,ft[2]),yt.lineTo(ft[1]+mt,ft[2]-gt),yt.lineTo(ft[1]+mt,ft[2]+gt),yt.closePath(),this.fill(ht),this._stroke(ht);break;case"triangleright":case">":yt.beginPath(),yt.moveTo(ft[1]+pt,ft[2]),yt.lineTo(ft[1]-mt,ft[2]-gt),yt.lineTo(ft[1]-mt,ft[2]+gt),yt.closePath(),this._fill(ht),this._stroke(ht)}},updatePoint:function(ht){this.drawPoint(ht)},drawLine:function(ht){var dt,pt=new lt(rt.COORDS_BY_USER,ht.point1.coords.usrCoords,ht.board),ft=new lt(rt.COORDS_BY_USER,ht.point2.coords.usrCoords,ht.board),gt=null,mt=nt.evaluate(ht.visProp.firstarrow),At=nt.evaluate(ht.visProp.lastarrow);ht.visPropCalc.visible&&((mt||At)&&(gt=-4),ct.calcStraight(ht,pt,ft,gt),dt=this.getPositionArrowHead(ht,pt,ft),this.context.beginPath(),this.context.moveTo(dt.c1.scrCoords[1]+dt.d1x,dt.c1.scrCoords[2]+dt.d1y),this.context.lineTo(dt.c2.scrCoords[1]-dt.d2x,dt.c2.scrCoords[2]-dt.d2y),this._stroke(ht),(mt&&dt.sFirst>0||At&&dt.sLast>0)&&this.makeArrows(ht,dt.c1,dt.c2))},updateLine:function(ht){this.drawLine(ht)},drawTicks:function(){},updateTicks:function(ht){var dt,pt,ft,gt,mt=ht.ticks.length,At=this.context;for(At.beginPath(),dt=0;dt<mt;dt++)pt=ht.ticks[dt],ft=pt[0],gt=pt[1],At.moveTo(ft[0],gt[0]),At.lineTo(ft[1],gt[1]);for(dt=0;dt<mt;dt++)pt=ht.ticks[dt].scrCoords,ht.ticks[dt].major&&(ht.board.needsFullUpdate||ht.needsRegularUpdate)&&ht.labels[dt]&&ht.labels[dt].visPropCalc.visible&&this.updateText(ht.labels[dt]);At.lineCap="round",this._stroke(ht)},drawCurve:function(ht){nt.evaluate(ht.visProp.handdrawing)?this.updatePathStringBezierPrim(ht):this.updatePathStringPrim(ht),ht.numberPoints>1&&this.makeArrows(ht)},updateCurve:function(ht){this.drawCurve(ht)},drawEllipse:function(ht){var dt=ht.center.coords.scrCoords[1],pt=ht.center.coords.scrCoords[2],ft=ht.board.unitX,gt=ht.board.unitY,mt=2*ht.Radius(),At=2*ht.Radius(),yt=mt*ft,bt=At*gt,xt=dt-yt/2,vt=pt-bt/2,_t=yt/2*.5522848,Ct=bt/2*.5522848,St=xt+yt,Et=vt+bt,Tt=xt+yt/2,Mt=vt+bt/2,Rt=this.context;mt>0&&At>0&&!isNaN(dt+pt)&&(Rt.beginPath(),Rt.moveTo(xt,Mt),Rt.bezierCurveTo(xt,Mt-Ct,Tt-_t,vt,Tt,vt),Rt.bezierCurveTo(Tt+_t,vt,St,Mt-Ct,St,Mt),Rt.bezierCurveTo(St,Mt+Ct,Tt+_t,Et,Tt,Et),Rt.bezierCurveTo(Tt-_t,Et,xt,Mt+Ct,xt,Mt),Rt.closePath(),this._fill(ht),this._stroke(ht))},updateEllipse:function(ht){return this.drawEllipse(ht)},displayCopyright:function(ht,dt){var pt=this.context;pt.save(),pt.font=dt+"px Arial",pt.fillStyle="#aaa",pt.lineWidth=.5,pt.fillText(ht,10,2+dt),pt.restore()},drawInternalText:function(ht){var dt=nt.evaluate(ht.visProp.fontsize),pt=ht.getAnchorX(),ft=ht.getAnchorY(),gt=this.context;return gt.save(),this._setColor(ht,"stroke","fill")&&!isNaN(ht.coords.scrCoords[1]+ht.coords.scrCoords[2])&&(gt.font=(dt>0?dt:0)+"px Arial",this.transformImage(ht,ht.transformations),pt==="left"?gt.textAlign="left":pt==="right"?gt.textAlign="right":pt==="middle"&&(gt.textAlign="center"),ft==="bottom"?gt.textBaseline="bottom":ft==="top"?gt.textBaseline="top":ft==="middle"&&(gt.textBaseline="middle"),gt.fillText(ht.plaintext,ht.coords.scrCoords[1],ht.coords.scrCoords[2])),gt.restore(),null},updateInternalText:function(ht){this.drawInternalText(ht)},setObjectStrokeColor:function(ht,dt,pt){var ft,gt,mt,At,yt=nt.evaluate(dt),bt=nt.evaluate(pt);bt=bt>0?bt:0,ht.visPropOld.strokecolor===yt&&ht.visPropOld.strokeopacity===bt||(nt.exists(yt)&&yt!==!1&&(yt.length!==9?(ft=yt,mt=bt):(gt=at.rgba2rgbo(yt),ft=gt[0],mt=bt*gt[1]),At=ht.rendNode,ht.elementClass===rt.OBJECT_CLASS_TEXT&&nt.evaluate(ht.visProp.display)==="html"&&(At.style.color=ft,At.style.opacity=mt)),ht.visPropOld.strokecolor=yt,ht.visPropOld.strokeopacity=bt)},drawImage:function(ht){ht.rendNode=new Image,ht._src="",this.updateImage(ht)},updateImage:function(ht){var dt=this.context,pt=nt.evaluate(ht.visProp.fillopacity),ft=nt.bind(function(){ht.imgIsLoaded=!0,ht.size[0]<=0||ht.size[1]<=0||(dt.save(),dt.globalAlpha=pt,this.transformImage(ht,ht.transformations),dt.drawImage(ht.rendNode,ht.coords.scrCoords[1],ht.coords.scrCoords[2]-ht.size[1],ht.size[0],ht.size[1]),dt.restore())},this);this.updateImageURL(ht)?ht.rendNode.onload=ft:ht.imgIsLoaded&&ft()},transformImage:function(ht,dt){var pt,ft=dt.length,gt=this.context;ft>0&&(pt=this.joinTransforms(ht,dt),Math.abs(ut.det(pt))>=ot.eps&&gt.transform(pt[1][1],pt[2][1],pt[1][2],pt[2][2],pt[1][0],pt[2][0]))},updateImageURL:function(ht){var dt;return dt=nt.evaluate(ht.url),ht._src!==dt&&(ht.imgIsLoaded=!1,ht.rendNode.src=dt,ht._src=dt,!0)},remove:function(ht){nt.exists(ht)&&nt.exists(ht.parentNode)&&ht.parentNode.removeChild(ht)},makeArrows:function(ht,dt,pt){var ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=nt.evaluate(ht.visProp.strokewidth),St=this.context,Et=nt.evaluate(ht.visProp.firstarrow),Tt=nt.evaluate(ht.visProp.lastarrow);if(nt.evaluate(ht.visProp.strokecolor)!=="none"&&(Et||Tt)){if(ht.elementClass!==rt.OBJECT_CLASS_LINE)return ft=ht.points[0].scrCoords[1],gt=ht.points[0].scrCoords[2],mt=ht.points[ht.points.length-1].scrCoords[1],void(At=ht.points[ht.points.length-1].scrCoords[2]);ft=dt.scrCoords[1],gt=dt.scrCoords[2],mt=pt.scrCoords[1],At=pt.scrCoords[2],Et&&nt.exists(Et.type)&&(bt=nt.exists(Et.size)?nt.evaluate(Et.size):3,Ct*=bt,_t=nt.evaluate(Et.type),vt=_t===2?[[Ct,.5*-Ct],[0,0],[Ct,.5*Ct],[.5*Ct,0]]:_t===3?[[Ct/3,.5*-Ct],[0,.5*-Ct],[0,.5*Ct],[Ct/3,.5*Ct]]:[[Ct,.5*-Ct],[0,0],[Ct,.5*Ct]]),Tt&&nt.exists(Tt.type)&&(bt=nt.exists(Tt.size)?nt.evaluate(Tt.size):3,Ct*=bt,_t=nt.evaluate(Tt.type),xt=_t===2?[[-Ct,.5*-Ct],[0,0],[-Ct,.5*Ct],[.5*-Ct,0]]:_t===3?[[-Ct/3,.5*-Ct],[0,.5*-Ct],[0,.5*Ct],[-Ct/3,.5*Ct]]:[[-Ct,.5*-Ct],[0,0],[-Ct,.5*Ct]]),St.save(),this._setColor(ht,"stroke","fill")&&(yt=Math.atan2(At-gt,mt-ft),Tt&&this._drawFilledPolygon(this._translateShape(this._rotateShape(xt,yt),mt,At)),Et&&this._drawFilledPolygon(this._translateShape(this._rotateShape(vt,yt),ft,gt))),St.restore()}},updatePathStringPrim:function(ht){var dt,pt,ft,gt,mt,At="M",yt=this.context;if(!(ht.numberPoints<=0)){if(mt=Math.min(ht.points.length,ht.numberPoints),yt.beginPath(),ht.bezierDegree===1)for(dt=0;dt<mt;dt++)pt=ht.points[dt].scrCoords,isNaN(pt[1])||isNaN(pt[2])?At="M":(pt[1]>5e3?pt[1]=5e3:pt[1]<-5e3&&(pt[1]=-5e3),pt[2]>5e3?pt[2]=5e3:pt[2]<-5e3&&(pt[2]=-5e3),At==="M"?yt.moveTo(pt[1],pt[2]):yt.lineTo(pt[1],pt[2]),At="L");else if(ht.bezierDegree===3)for(dt=0;dt<mt;)pt=ht.points[dt].scrCoords,isNaN(pt[1])||isNaN(pt[2])?At="M":(At==="M"?yt.moveTo(pt[1],pt[2]):(dt+=1,ft=ht.points[dt].scrCoords,dt+=1,gt=ht.points[dt].scrCoords,yt.bezierCurveTo(pt[1],pt[2],ft[1],ft[2],gt[1],gt[2])),At="C"),dt+=1;yt.lineCap="round",this._fill(ht),this._stroke(ht)}},updatePathStringBezierPrim:function(ht){var dt,pt,ft,gt,mt,At,yt,bt="M",xt=nt.evaluate(ht.visProp.strokewidth),vt=nt.evaluate(ht.visProp.curvetype)!=="plot",_t=this.context;if(!(ht.numberPoints<=0)){for(vt&&ht.board.options.curve.RDPsmoothing&&(ht.points=ut.RamerDouglasPeucker(ht.points,.5)),yt=Math.min(ht.points.length,ht.numberPoints),_t.beginPath(),pt=1;pt<3;pt++)for(bt="M",dt=0;dt<yt;dt++)gt=ht.points[dt].scrCoords,isNaN(gt[1])||isNaN(gt[2])?bt="M":(gt[1]>5e3?gt[1]=5e3:gt[1]<-5e3&&(gt[1]=-5e3),gt[2]>5e3?gt[2]=5e3:gt[2]<-5e3&&(gt[2]=-5e3),bt==="M"?_t.moveTo(gt[1],gt[2]):(ft=2*pt,_t.bezierCurveTo(mt+.333*(gt[1]-mt)+xt*(ft*Math.random()-pt),At+.333*(gt[2]-At)+xt*(ft*Math.random()-pt),mt+.666*(gt[1]-mt)+xt*(ft*Math.random()-pt),At+.666*(gt[2]-At)+xt*(ft*Math.random()-pt),gt[1],gt[2])),bt="C",mt=gt[1],At=gt[2]);_t.lineCap="round",this._fill(ht),this._stroke(ht)}},updatePolygonPrim:function(ht,dt){var pt,ft,gt,mt=dt.vertices.length,At=this.context,yt=!0;if(!(mt<=0)&&dt.visPropCalc.visible){for(At.beginPath(),ft=0;!dt.vertices[ft].isReal&&ft<mt-1;)ft++,yt=!1;for(pt=dt.vertices[ft].coords.scrCoords,At.moveTo(pt[1],pt[2]),gt=ft;gt<mt-1;gt++)dt.vertices[gt].isReal||(yt=!1),pt=dt.vertices[gt].coords.scrCoords,At.lineTo(pt[1],pt[2]);At.closePath(),yt&&this._fill(dt)}},display:function(ht,dt){ht&&ht.rendNode&&(ht.visPropOld.visible=dt,ht.rendNode.style.visibility=dt?"inherit":"hidden")},show:function(ht){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),nt.exists(ht.rendNode)&&(ht.rendNode.style.visibility="inherit")},hide:function(ht){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),nt.exists(ht.rendNode)&&(ht.rendNode.style.visibility="hidden")},setGradient:function(ht){nt.evaluate(ht.visProp.fillopacity),nt.evaluate(ht.visProp.fillcolor)},setShadow:function(ht){ht.visPropOld.shadow!==ht.visProp.shadow&&(ht.visPropOld.shadow=ht.visProp.shadow)},highlight:function(ht){return ht.elementClass===rt.OBJECT_CLASS_TEXT&&nt.evaluate(ht.visProp.display)==="html"?this.updateTextStyle(ht,!0):(ht.board.prepareUpdate(),ht.board.renderer.suspendRedraw(ht.board),ht.board.updateRenderer(),ht.board.renderer.unsuspendRedraw()),this},noHighlight:function(ht){return ht.elementClass===rt.OBJECT_CLASS_TEXT&&nt.evaluate(ht.visProp.display)==="html"?this.updateTextStyle(ht,!1):(ht.board.prepareUpdate(),ht.board.renderer.suspendRedraw(ht.board),ht.board.updateRenderer(),ht.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(ht){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),ht&&ht.attr.showcopyright&&this.displayCopyright(tt.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(ht,dt){this.container?(this.canvasRoot.style.width=parseFloat(ht)+"px",this.canvasRoot.style.height=parseFloat(dt)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(ht)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(dt)+"px")):(this.canvasRoot.width=2*parseFloat(ht),this.canvasRoot.height=2*parseFloat(dt)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),tt.CanvasRenderer}),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){return tt.JSXGraph={rendererType:function(){return st.board.renderer="no",_e.supportsVML()&&(st.board.renderer="vml",document.onmousemove=function(){var ut;return document.body&&(ut=document.body.scrollLeft,ut+=document.body.scrollTop),ut}),_e.supportsCanvas()&&(st.board.renderer="canvas"),_e.supportsSVG()&&(st.board.renderer="svg"),_e.isNode()&&_e.supportsCanvas()&&(st.board.renderer="canvas"),(_e.isNode()||st.renderer==="no")&&(st.text.display="internal",st.infobox.display="internal"),st.board.renderer}(),initRenderer:function(ut,ht,dt,pt){var ft;if(rt.exists(dt)&&dt!==!1||typeof document!="object"||(dt=document),typeof dt=="object"&&ut!==null)for(ft=dt.getElementById(ut);ft.firstChild;)ft.removeChild(ft.firstChild);else ft=ut;return pt!==void 0&&pt!=="auto"||(pt=this.rendererType),pt==="svg"?new at(ft,ht):pt==="vml"?new lt(ft):pt==="canvas"?new ot(ft,ht):new ct},initBoard:function(ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et;return ht=ht||{},vt=rt.copyAttributes(ht,st,"board"),vt.zoom=rt.copyAttributes(vt,st,"board","zoom"),vt.pan=rt.copyAttributes(vt,st,"board","pan"),vt.selection=rt.copyAttributes(vt,st,"board","selection"),vt.navbar=rt.copyAttributes(vt.navbar,st,"navbar"),bt=_e.getDimensions(ut,vt.document),vt.unitx||vt.unity?(dt=rt.def(vt.originx,150),pt=rt.def(vt.originy,150),ft=rt.def(vt.unitx,50),gt=rt.def(vt.unity,50)):(xt=vt.boundingbox,At=parseInt(bt.width,10),yt=parseInt(bt.height,10),rt.exists(xt)&&vt.keepaspectratio?(ft=At/(xt[2]-xt[0]),gt=yt/(xt[1]-xt[3]),Math.abs(ft)<Math.abs(gt)?gt=Math.abs(ft)*gt/Math.abs(gt):ft=Math.abs(gt)*ft/Math.abs(ft)):(ft=At/(xt[2]-xt[0]),gt=yt/(xt[1]-xt[3])),dt=-ft*xt[0],pt=gt*xt[1]),mt=this.initRenderer(ut,bt,vt.document,vt.renderer),Et=new it(ut,mt,vt.id,[dt,pt],vt.zoomfactor*vt.zoomx,vt.zoomfactor*vt.zoomy,ft,gt,bt.width,bt.height,vt),tt.boards[Et.id]=Et,Et.keepaspectratio=vt.keepaspectratio,Et.resizeContainer(bt.width,bt.height,!0,!0),Et.suspendUpdate(),Et.initInfobox(),vt.axis&&(_t=typeof vt.axis=="object"?vt.axis:{},Ct=rt.deepCopy(st.board.defaultAxes.x,_t),St=rt.deepCopy(st.board.defaultAxes.y,_t),vt.defaultaxes.x&&(Ct=rt.deepCopy(Ct,vt.defaultaxes.x)),vt.defaultaxes.y&&(St=rt.deepCopy(St,vt.defaultaxes.y)),Et.defaultAxes={},Et.defaultAxes.x=Et.create("axis",[[0,0],[1,0]],Ct),Et.defaultAxes.y=Et.create("axis",[[0,0],[0,1]],St)),vt.grid&&Et.create("grid",[],typeof vt.grid=="object"?vt.grid:{}),Et._createSelectionPolygon(vt),Et.renderer.drawZoomBar(Et,vt.navbar),Et.unsuspendUpdate(),Et},loadBoardFromFile:function(ut,ht,dt,pt,ft){var gt,mt,At,yt,bt;return pt=pt||{},gt=rt.copyAttributes(pt,st,"board"),gt.zoom=rt.copyAttributes(pt,st,"board","zoom"),gt.pan=rt.copyAttributes(pt,st,"board","pan"),gt.selection=rt.copyAttributes(gt,st,"board","selection"),gt.navbar=rt.copyAttributes(gt.navbar,st,"navbar"),yt=_e.getDimensions(ut,gt.document),mt=this.initRenderer(ut,yt,gt.document,gt.renderer),At=new it(ut,mt,"",[150,150],1,1,50,50,yt.width,yt.height,gt),At.initInfobox(),At.resizeContainer(yt.width,yt.height,!0,!0),nt.parseFileContent(ht,At,dt,!0,ft),bt=rt.copyAttributes(gt,st,"board","selection"),At.selectionPolygon=At.create("polygon",[[0,0],[0,0],[0,0],[0,0]],bt),At.renderer.drawZoomBar(At,gt.navbar),tt.boards[At.id]=At,At},loadBoardFromString:function(ut,ht,dt,pt,ft){var gt,mt,At,yt,bt;return pt=pt||{},gt=rt.copyAttributes(pt,st,"board"),gt.zoom=rt.copyAttributes(pt,st,"board","zoom"),gt.pan=rt.copyAttributes(pt,st,"board","pan"),gt.selection=rt.copyAttributes(gt,st,"board","selection"),gt.navbar=rt.copyAttributes(gt.navbar,st,"navbar"),At=_e.getDimensions(ut,gt.document),mt=this.initRenderer(ut,At,gt.document),yt=new it(ut,mt,"",[150,150],1,1,50,50,At.width,At.height,gt),yt.initInfobox(),yt.resizeContainer(At.width,At.height,!0,!0),nt.parseString(ht,yt,dt,!0,ft),bt=rt.copyAttributes(gt,st,"board","selection"),yt.selectionPolygon=yt.create("polygon",[[0,0],[0,0],[0,0],[0,0]],bt),yt.renderer.drawZoomBar(yt,gt.navbar),tt.boards[yt.id]=yt,yt},freeBoard:function(ut){var ht;typeof ut=="string"&&(ut=tt.boards[ut]),ut.removeEventHandlers(),ut.suspendUpdate();for(ht in ut.objects)ut.objects.hasOwnProperty(ht)&&ut.objects[ht].remove();for(;ut.containerObj.firstChild;)ut.containerObj.removeChild(ut.containerObj.firstChild);for(ht in ut.objects)ut.objects.hasOwnProperty(ht)&&delete ut.objects[ht];delete ut.renderer,ut.jc.creator.clearCache(),delete ut.jc,delete tt.boards[ut.id]},registerElement:function(ut,ht){tt.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),tt.registerElement(ut,ht)}},_e.isBrowser&&typeof window=="object"&&typeof document=="object"&&_e.addEvent(window,"load",function(){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t=document.getElementsByTagName("script"),Ct=function(Et,Tt,Mt){var Rt=tt.JSXGraph.initBoard(ft,{boundingbox:Mt,keepaspectratio:!0,grid:xt,axis:bt,showReload:!0});if(Tt.toLowerCase().indexOf("script")>-1)Rt.construct(Et);else try{Rt.jc.parse(Et)}catch(It){tt.debug(It)}return Rt},St=function(Et,Tt,Mt,Rt){return function(){var It;tt.JSXGraph.freeBoard(Et),It=Ct(Tt,Mt,Rt),It.reload=St(It,Tt,Mt,Rt)}};for(ht=0;ht<_t.length;ht++)if(ut=_t[ht].getAttribute("type",!1),rt.exists(ut)&&(ut.toLowerCase()==="text/jessiescript"||ut.toLowerCase()==="jessiescript"||ut.toLowerCase()==="text/jessiecode"||ut.toLowerCase()==="jessiecode")){if(mt=_t[ht].getAttribute("width",!1)||"500px",At=_t[ht].getAttribute("height",!1)||"500px",yt=_t[ht].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",ft=_t[ht].getAttribute("container",!1),yt=yt.split(","),yt.length!==4)yt=[-5,5,5,-5];else for(dt=0;dt<yt.length;dt++)yt[dt]=parseFloat(yt[dt]);if(bt=rt.str2Bool(_t[ht].getAttribute("axis",!1)||"false"),xt=rt.str2Bool(_t[ht].getAttribute("grid",!1)||"false"),rt.exists(ft))pt=document.getElementById(ft);else{ft="jessiescript_autgen_jxg_"+ht,pt=document.createElement("div"),pt.setAttribute("id",ft),pt.setAttribute("style","width:"+mt+"; height:"+At+"; float:left"),pt.setAttribute("class","jxgbox");try{document.body.insertBefore(pt,_t[ht])}catch{typeof jQuery=="object"&&jQuery(pt).insertBefore(_t[ht])}}document.getElementById(ft)?(vt=_t[ht].innerHTML,vt=vt.replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),_t[ht].innerHTML=vt,gt=Ct(vt,ut,yt),gt.reload=St(gt,vt,ut,yt)):tt.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),tt.JSXGraph}),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],function(tt,_e,rt,it,nt){return tt.Group=function(st,at,lt,ot,ct){var ut,ht,dt,pt;for(this.board=st,this.objects={},ut=this.board.numObjects,this.board.numObjects+=1,at!==""&&nt.exists(at)?this.id=at:this.id=this.board.id+"Group"+ut,this.board.groups[this.id]=this,this.type=_e.OBJECT_TYPE_POINT,this.elementClass=_e.OBJECT_CLASS_POINT,lt!==""&&nt.exists(lt)?this.name=lt:this.name="group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=ct.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],ht=nt.isArray(ot)?ot:Array.prototype.slice.call(arguments,3),dt=0;dt<ht.length;dt++)pt=this.board.select(ht[dt]),!nt.evaluate(pt.visProp.fixed)&&nt.exists(pt.coords)&&this.addPoint(pt);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},tt.extend(tt.Group.prototype,{ungroup:function(){var st,at,lt;for(st in this.objects)this.objects.hasOwnProperty(st)&&(at=this.objects[st].point,nt.isArray(at.groups)&&(lt=nt.indexOf(at.groups,this.id))>=0&&delete at.groups[lt]);return this.objects={},this},addParents:function(st){var at,lt,ot;for(ot=nt.isArray(st)?st:arguments,lt=ot.length,at=0;at<lt;++at)nt.isId(this.board,ot[at])?this.parents.push(ot[at]):nt.exists(ot[at].id)&&this.parents.push(ot[at].id);this.parents=nt.uniqueArray(this.parents)},setParents:function(st){this.parents=[],this.addParents(st)},getParents:function(){return nt.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(st){var at;st!==""&&nt.exists(this.objects[st])&&(at=this.objects[st].point,this.coords[at.id]={usrCoords:at.coords.usrCoords.slice(0)})},update:function(st){var at,lt,ot,ct,ut,ht,dt,pt,ft,gt=null;if(!this.needsUpdate)return this;if(st=this._update_find_drag_type(),st.action==="nothing")return this._updateCoordsCache(st.id),this;if(gt=this.objects[st.id].point,st.action==="translation")pt=[gt.coords.usrCoords[1]-this.coords[st.id].usrCoords[1],gt.coords.usrCoords[2]-this.coords[st.id].usrCoords[2]];else if(st.action==="rotation"||st.action==="scaling"){if(lt=st.action==="rotation"?"rotationCenter":"scaleCenter",nt.isPoint(this[lt]))ft=this[lt].coords.usrCoords.slice(1);else if(this[lt]==="centroid")ft=this._update_centroid_center();else if(nt.isArray(this[lt]))ft=this[lt];else{if(!nt.isFunction(this[lt]))return this;ft=this[lt]()}if(st.action==="rotation")dt=it.rad(this.coords[st.id].usrCoords.slice(1),ft,this.objects[st.id].point),pt=this.board.create("transform",[dt,ft[0],ft[1]],{type:"rotate"}),pt.update();else{if(st.action!=="scaling")return this;if(ct=it.distance(this.coords[st.id].usrCoords.slice(1),ft),Math.abs(ct)<rt.eps)return this;ct=it.distance(gt.coords.usrCoords.slice(1),ft)/ct,ut=this.scaleDirections[st.id].indexOf("x")>=0?ct:1,ht=this.scaleDirections[st.id].indexOf("y")>=0?ct:1,pt=this.board.create("transform",[1,0,0,ft[0]*(1-ut),ut,0,ft[1]*(1-ht),0,ht],{type:"generic"}),pt.update()}}this._update_apply_transformation(st,pt),this.needsUpdate=!1;for(at in this.objects)if(this.objects.hasOwnProperty(at))for(ot in this.objects[at].descendants)this.objects[at].descendants.hasOwnProperty(ot)&&(this.objects[at].descendants.needsUpdate=this.objects[at].descendants.needsRegularUpdate||this.board.needsFullUpdate);this.board.updateElements(st);for(at in this.objects)this.objects.hasOwnProperty(at)&&this._updateCoordsCache(at);return this},_update_find_drag_type:function(){var st,at,lt,ot="nothing",ct=[];for(st in this.objects)this.objects.hasOwnProperty(st)&&(at=this.objects[st].point,at.coords.distance(_e.COORDS_BY_USER,this.coords[st])>rt.eps&&ct.push(at.id));return ct.length===0?{action:ot,id:"",changed:ct}:(lt=ct[0],at=this.objects[lt].point,ct.length>1?ot="translation":nt.isInArray(this.rotationPoints,at)&&nt.exists(this.rotationCenter)?ot="rotation":nt.isInArray(this.scalePoints,at)&&nt.exists(this.scaleCenter)?ot="scaling":nt.isInArray(this.translationPoints,at)&&(ot="translation"),{action:ot,id:lt,changed:ct})},_update_centroid_center:function(){var st,at,lt;st=[0,0],at=0;for(lt in this.coords)this.coords.hasOwnProperty(lt)&&(st[0]+=this.coords[lt].usrCoords[1],st[1]+=this.coords[lt].usrCoords[2],++at);return at>0&&(st[0]/=at,st[1]/=at),st},_update_apply_transformation:function(st,at){var lt,ot;for(lt in this.objects)this.objects.hasOwnProperty(lt)&&(nt.exists(this.board.objects[lt])?(ot=this.objects[lt].point,ot.id!==st.id?st.action==="translation"?nt.isInArray(st.changed,ot.id)||ot.coords.setCoordinates(_e.COORDS_BY_USER,[this.coords[lt].usrCoords[1]+at[0],this.coords[lt].usrCoords[2]+at[1]]):st.action!=="rotation"&&st.action!=="scaling"||at.applyOnce([ot]):st.action!=="rotation"&&st.action!=="scaling"||ot.coords.setCoordinates(_e.COORDS_BY_USER,rt.matVecMult(at.matrix,this.coords[ot.id].usrCoords))):delete this.objects[lt])},addPoint:function(st){return this.objects[st.id]={point:this.board.select(st)},this._updateCoordsCache(st.id),this.translationPoints.push(st),st.groups.push(this.id),st.groups=nt.uniqueArray(st.groups),this},addPoints:function(st){var at;for(at=0;at<st.length;at++)this.addPoint(st[at]);return this},addGroup:function(st){var at;for(at in st.objects)st.objects.hasOwnProperty(at)&&this.addPoint(st.objects[at].point);return this},removePoint:function(st){return delete this.objects[st.id],this},setRotationCenter:function(st){return this.rotationCenter=st,this},setRotationPoints:function(st){return this._setActionPoints("rotation",st)},addRotationPoint:function(st){return this._addActionPoint("rotation",st)},removeRotationPoint:function(st){return this._removeActionPoint("rotation",st)},setTranslationPoints:function(st){return this._setActionPoints("translation",st)},addTranslationPoint:function(st){return this._addActionPoint("translation",st)},removeTranslationPoint:function(st){return this._removeActionPoint("translation",st)},setScaleCenter:function(st){return this.scaleCenter=st,this},setScalePoints:function(st,at){var lt,ot,ct;for(lt=nt.isArray(st)?st:arguments,ct=lt.length,ot=0;ot<ct;++ot)this.scaleDirections[this.board.select(lt[ot]).id]=at||"xy";return this._setActionPoints("scale",st)},addScalePoint:function(st,at){return this._addActionPoint("scale",st),this.scaleDirections[this.board.select(st).id]=at||"xy",this},removeScalePoint:function(st){return this._removeActionPoint("scale",st)},_setActionPoints:function(st,at){var lt,ot,ct;for(lt=nt.isArray(at)?at:arguments,ct=lt.length,this[st+"Points"]=[],ot=0;ot<ct;++ot)this._addActionPoint(st,lt[ot]);return this},_addActionPoint:function(st,at){return this[st+"Points"].push(this.board.select(at)),this},_removeActionPoint:function(st,at){var lt=this[st+"Points"].indexOf(this.board.select(at));return lt>-1&&this[st+"Points"].splice(lt,1),this},setProperty:function(){tt.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var st;for(st in this.objects)this.objects.hasOwnProperty(st)&&this.objects[st].point.setAttribute.apply(this.objects[st].point,arguments);return this}}),tt.createGroup=function(st,at,lt){var ot=nt.copyAttributes(lt,st.options,"group"),ct=new tt.Group(st,ot.id,ot.name,at,ot);return ct.elType="group",ct.setParents(at),ct},tt.registerElement("group",tt.createGroup),{Group:tt.Group,createGroup:tt.createGroup}}),define("element/locus",["jxg","math/symbolic","utils/type","base/constants","base/curve"],function(tt,_e,rt,it,nt){return tt.createLocus=function(st,at,lt){var ot,ct;if(!rt.isArray(at)||at.length!==1||!rt.isPoint(at[0]))throw new Error(`JSXGraph: Can't create locus with parent of type other than point.
Possible parent types: [point]`);return ct=at[0],ot=st.create("curve",[[null],[null]],lt),ot.dontCallServer=!1,ot.elType="locus",ot.setParents([ct.id]),ot.updateDataArray=function(){var ut,ht,dt;ot.board.mode>0||(ut=_e.generatePolynomials(st,ct,!0).join("|"))!==ot.spe&&(ot.spe=ut,ht=function(pt,ft,gt,mt){ot.dataX=pt,ot.dataY=ft,ot.eq=gt,ot.ctime=mt,ot.generatePolynomial=function(At){return function(yt){var bt,xt="("+yt.symbolic.x+")",vt="("+yt.symbolic.y+")",_t=[];for(bt=0;bt<At.length;bt++)_t[bt]=At[bt].replace(/\*\*/g,"^").replace(/x/g,xt).replace(/y/g,vt);return _t}}(gt)},dt=_e.geometricLocusByGroebnerBase(st,ct,ht),ht(dt.datax,dt.datay,dt.polynomial,dt.exectime))},ot},tt.registerElement("locus",tt.createLocus),{createLocus:tt.createLocus}}),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","utils/type","base/coordselement"],function(tt,_e,rt,it,nt,st,at,lt){return tt.Image=function(ot,ct,ut,ht,dt){this.constructor(ot,ut,_e.OBJECT_TYPE_IMAGE,_e.OBJECT_CLASS_OTHER),this.element=this.board.select(ut.anchor),this.coordsConstructor(ct),this.W=at.createFunction(dt[0],this.board,""),this.H=at.createFunction(dt[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*ot.unitX),Math.abs(this.usrSize[1]*ot.unitY)],this.url=ht,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=tt.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},tt.Image.prototype=new it,at.copyPrototypeMethods(tt.Image,lt,"coordsConstructor"),tt.extend(tt.Image.prototype,{hasPoint:function(ot,ct){var ut,ht,dt,pt,ft,gt,mt;return this.transformations.length===0?(ut=ot-this.coords.scrCoords[1],ht=this.coords.scrCoords[2]-ct,dt=this.board.options.precision.hasPoint,ut>=-dt&&ut-this.size[0]<=dt&&ht>=-dt&&ht-this.size[1]<=dt):(pt=new rt(_e.COORDS_BY_SCREEN,[ot,ct],this.board),pt=pt.usrCoords,ft=[pt[0]-this.span[0][0],pt[1]-this.span[0][1],pt[2]-this.span[0][2]],mt=nt.innerProduct,0<=(gt=mt(ft,this.span[1]))&&gt<=mt(this.span[1],this.span[1])&&0<=(gt=mt(ft,this.span[2]))&&gt<=mt(this.span[2],this.span[2]))},update:function(ot){return this.needsUpdate?(this.updateCoords(ot),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var ot,ct,ut=this.transformations.length,ht=[];if(ut===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(ht[0]=[this.Z(),this.X(),this.Y()],ht[1]=[this.Z(),this.X()+this.W(),this.Y()],ht[2]=[this.Z(),this.X(),this.Y()+this.H()],ot=0;ot<ut;ot++)for(ct=0;ct<3;ct++)ht[ct]=nt.matVecMult(this.transformations[ot].matrix,ht[ct]);for(ct=0;ct<3;ct++)ht[ct][1]/=ht[ct][0],ht[ct][2]/=ht[ct][0],ht[ct][0]/=ht[ct][0];for(ct=1;ct<3;ct++)ht[ct][0]-=ht[0][0],ht[ct][1]-=ht[0][1],ht[ct][2]-=ht[0][2];this.span=ht}return this},addTransform:function(ot){var ct;if(at.isArray(ot))for(ct=0;ct<ot.length;ct++)this.transformations.push(ot[ct]);else this.transformations.push(ot);return this},getParents:function(){var ot=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(ot=this.parents),ot},setSize:function(ot,ct){return this.W=at.createFunction(ot,this.board,""),this.H=at.createFunction(ct,this.board,""),this},W:function(){},H:function(){}}),tt.createImage=function(ot,ct,ut){var ht,dt,pt=ct[0],ft=ct[1],gt=ct[2];if(ht=at.copyAttributes(ut,ot.options,"image"),!(dt=lt.create(tt.Image,ot,ft,ht,pt,gt)))throw new Error("JSXGraph: Can't create image with parent types '"+typeof ct[0]+"' and '"+typeof ct[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return at.evaluate(ht.rotate)!==0&&dt.addRotation(at.evaluate(ht.rotate)),dt},tt.registerElement("image",tt.createImage),{Image:tt.Image,createImage:tt.createImage}}),define("base/ticks",["jxg","math/math","math/geometry","base/constants","base/element","base/coords","utils/type","base/text"],function(tt,_e,rt,it,nt,st,at,lt){return tt.Ticks=function(ot,ct,ut){if(this.constructor(ot.board,ut,it.OBJECT_TYPE_TICKS,it.OBJECT_CLASS_OTHER),this.line=ot,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],at.isFunction(ct))throw this.ticksFunction=ct,new Error("Function arguments are no longer supported.");at.isArray(ct)?this.fixedTicks=ct:((Math.abs(ct)<_e.eps||ct<0)&&(ct=ut.defaultdistance),this.ticksFunction=this.makeTicksFunction(ct),this.equidistant=!0),this.minTicksDistance=ut.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},tt.Ticks.prototype=new nt,tt.extend(tt.Ticks.prototype,{makeTicksFunction:function(ot){return function(){var ct,ut,ht;return at.evaluate(this.visProp.insertticks)?(ut=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),ht=ut.upper-ut.lower,ct=Math.pow(10,Math.floor(Math.log(.6*ht)/Math.LN10)),ht<=6*ct&&(ct*=.5),ct):ot}},hasPoint:function(ot,ct){var ut,ht,dt=this.ticks&&this.ticks.length||0,pt=this.board.options.precision.hasPoint+.5*at.evaluate(this.visProp.strokewidth);if(!at.evaluate(this.line.visProp.scalable)||this.line.stdform[1]!==0&&this.line.stdform[2]!==0&&this.line.type!==it.OBJECT_TYPE_AXIS)return!1;for(ut=0;ut<dt;ut++)if(ht=this.ticks[ut],ht[2]&&!(this.line.stdform[1]===0&&Math.abs(ht[0][0]-this.line.point1.coords.scrCoords[1])<_e.eps||this.line.stdform[2]===0&&Math.abs(ht[1][0]-this.line.point1.coords.scrCoords[2])<_e.eps)&&(Math.abs(ht[0][0]-ht[0][1])>=1||Math.abs(ht[1][0]-ht[1][1])>=1)){if(this.line.stdform[1]===0){if(Math.abs(ct-.5*(ht[1][0]+ht[1][1]))<2*pt&&ht[0][0]-pt<ot&&ot<ht[0][1]+pt)return!0}else if(this.line.stdform[2]===0&&Math.abs(ot-.5*(ht[0][0]+ht[0][1]))<2*pt&&ht[1][0]-pt<ct&&ct<ht[1][1]+pt)return!0}return!1},setPositionDirectly:function(ot,ct,ut){var ht,dt,pt=new st(ot,ct,this.board),ft=new st(ot,ut,this.board),gt=this.board.getBoundingBox();return at.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<_e.eps&&Math.abs(pt.usrCoords[1]*ft.usrCoords[1])>_e.eps?(ht=ft.usrCoords[1]/pt.usrCoords[1],gt[0]*=ht,gt[2]*=ht,this.board.setBoundingBox(gt,!1)):Math.abs(this.line.stdform[2])<_e.eps&&Math.abs(pt.usrCoords[2]*ft.usrCoords[2])>_e.eps&&(dt=ft.usrCoords[2]/pt.usrCoords[2],gt[3]*=dt,gt[1]*=dt,this.board.setBoundingBox(gt,!1)),this):this},calculateTicksCoordinates:function(){var ot,ct;if(this.setTicksSizeVariables(),!(Math.abs(this.dx)<_e.eps&&Math.abs(this.dy)<_e.eps))return ot=this.getZeroCoordinates(),ct=this.getLowerAndUpperBounds(ot),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(ot,ct):this.generateFixedTicks(ot,ct),this},setTicksSizeVariables:function(){var ot,ct=.5*at.evaluate(this.visProp.majorheight),ut=.5*at.evaluate(this.visProp.minorheight);this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2],this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,ot=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=ct/ot*this.board.unitX,this.dyMaj*=ct/ot*this.board.unitY,this.dxMin*=ut/ot*this.board.unitX,this.dyMin*=ut/ot*this.board.unitY,this.minStyle=at.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=at.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var ot,ct,ut,ht,dt,pt,ft=at.evaluate(this.visProp.anchor);return this.line.type===it.OBJECT_TYPE_AXIS?rt.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(ut=this.line.point1.coords.usrCoords[0],ot=this.line.point1.coords.usrCoords[1],ct=this.line.point1.coords.usrCoords[2],pt=this.line.point2.coords.usrCoords[0],ht=this.line.point2.coords.usrCoords[1],dt=this.line.point2.coords.usrCoords[2],ft==="right"?this.line.point2.coords:ft==="middle"?new st(it.COORDS_BY_USER,[.5*(ut+pt),.5*(ot+ht),.5*(ct+dt)],this.board):at.isNumber(ft)?new st(it.COORDS_BY_USER,[ut+(pt-ut)*ft,ot+(ht-ot)*ft,ct+(dt-ct)*ft],this.board):this.line.point1.coords)},getLowerAndUpperBounds:function(ot,ct){var ut,ht,dt,pt,ft,gt=new st(it.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),mt=new st(it.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),At=Math.abs(gt.usrCoords[0])>=_e.eps&&gt.scrCoords[1]>=0&&gt.scrCoords[1]<=this.board.canvasWidth&&gt.scrCoords[2]>=0&&gt.scrCoords[2]<=this.board.canvasHeight,yt=Math.abs(mt.usrCoords[0])>=_e.eps&&mt.scrCoords[1]>=0&&mt.scrCoords[1]<=this.board.canvasWidth&&mt.scrCoords[2]>=0&&mt.scrCoords[2]<=this.board.canvasHeight,bt=at.evaluate(this.line.visProp.straightfirst),xt=at.evaluate(this.line.visProp.straightlast),vt=at.evaluate(this.visProp.includeboundaries);return at.exists(ct)||ct==="tickdistance"?rt.calcStraight(this.line,gt,mt,at.evaluate(this.line.visProp.margin)):rt.calcLineDelimitingPoints(this.line,gt,mt),ft=this.board.renderer.getPositionArrowHead(this.line,gt,mt,at.evaluate(this.line.visProp.strokewidth)),gt.setCoordinates(it.COORDS_BY_SCREEN,[gt.scrCoords[1]-ft.d1x,gt.scrCoords[2]-ft.d1y]),mt.setCoordinates(it.COORDS_BY_SCREEN,[mt.scrCoords[1]-ft.d2x,mt.scrCoords[2]-ft.d2y]),dt=this.getDistanceFromZero(ot,gt),pt=this.getDistanceFromZero(ot,mt),dt<pt?(ut=dt,bt||!At||vt||(ut+=_e.eps),ht=pt,xt||!yt||vt||(ht-=_e.eps)):pt<dt?(ut=pt,xt||!yt||vt||(ut+=_e.eps),ht=dt,bt||!At||vt||(ht-=_e.eps)):(ut=0,ht=0),{lower:ut,upper:ht}},getDistanceFromZero:function(ot,ct){var ut=_e.eps,ht=ot.distance(it.COORDS_BY_USER,ct);return this.line.type===it.OBJECT_TYPE_AXIS?(_e.relDif(ot.usrCoords[1],ct.usrCoords[1])>ut&&ot.usrCoords[1]-ct.usrCoords[1]>ut||_e.relDif(ot.usrCoords[2],ct.usrCoords[2])>ut&&ot.usrCoords[2]-ct.usrCoords[2]>ut)&&(ht*=-1):at.evaluate(this.visProp.anchor)==="right"?rt.isSameDirection(ot,this.line.point1.coords,ct)&&(ht*=-1):rt.isSameDirection(ot,this.line.point2.coords,ct)||(ht*=-1),ht},generateEquidistantTicks:function(ot,ct){var ut,ht=this.getXandYdeltas(),dt=this.equidistant?this.ticksFunction(1):this.ticksDelta,pt=at.evaluate(this.visProp.insertticks),ft=at.evaluate(this.visProp.minorticks);if(dt*=at.evaluate(this.visProp.scale),pt&&this.minTicksDistance>_e.eps?(dt=this.adjustTickDistance(dt,ot,ht),dt/=ft+1):pt||(dt/=ft+1),this.ticksDelta=dt,!(dt<_e.eps)){for(ut=0,at.evaluate(this.visProp.drawzero)||(ut=dt);ut<=ct.upper;)ut>=ct.lower&&this.processTickPosition(ot,ut,dt,ht),ut+=dt;for(ut=-dt;ut>=ct.lower;)ut<=ct.upper&&this.processTickPosition(ot,ut,dt,ht),ut-=dt}},adjustTickDistance:function(ot,ct,ut){var ht,dt,pt,ft=1,gt=at.evaluate(this.visProp.minorticks);for(this.getLowerAndUpperBounds(ct,"ticksdistance"),ht=ct.usrCoords[1]+ut.x*ot,dt=ct.usrCoords[2]+ut.y*ot,pt=ct.distance(it.COORDS_BY_SCREEN,new st(it.COORDS_BY_USER,[ht,dt],this.board));pt/(gt+1)<this.minTicksDistance;)ot*=ft===1?2:5,ft*=-1,ht=ct.usrCoords[1]+ut.x*ot,dt=ct.usrCoords[2]+ut.y*ot,pt=ct.distance(it.COORDS_BY_SCREEN,new st(it.COORDS_BY_USER,[ht,dt],this.board));return ot},processTickPosition:function(ot,ct,ut,ht){var dt,pt,ft,gt;dt=ot.usrCoords[1]+ct*ht.x,pt=ot.usrCoords[2]+ct*ht.y,ft=new st(it.COORDS_BY_USER,[dt,pt],this.board),ft.major=Math.round(ct/ut)%(at.evaluate(this.visProp.minorticks)+1)==0,gt=this.tickEndings(ft,ft.major),gt.length===3&&(this.ticks.push(gt),ft.major&&at.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(ft,ot),ft,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(ot,ct){var ut,ht,dt,pt,ft,gt,mt=at.isArray(this.visProp.labels),At=this.getXandYdeltas(),yt=at.evaluate(this.visProp.drawlabels);for(dt=0;dt<this.fixedTicks.length;dt++)ft=ot.usrCoords[1]+this.fixedTicks[dt]*At.x,gt=ot.usrCoords[2]+this.fixedTicks[dt]*At.y,ut=new st(it.COORDS_BY_USER,[ft,gt],this.board),pt=this.tickEndings(ut,!0),pt.length===3&&this.fixedTicks[dt]>=ct.lower&&this.fixedTicks[dt]<=ct.upper&&(this.ticks.push(pt),yt&&(mt||at.exists(this.visProp.labels[dt]))?(ht=mt?at.evaluate(this.visProp.labels[dt]):this.fixedTicks[dt],this.labelsData.push(this.generateLabelData(this.generateLabelText(ut,ot,ht),ut,dt))):this.labelsData.push(null))},getXandYdeltas:function(){var ot,ct,ut=this.line.point1.Dist(this.line.point2);return this.line.type===it.OBJECT_TYPE_AXIS?(ot=this.line.point1.coords.usrCoords,ct=this.line.point2.coords.usrCoords,(ot[1]>ct[1]||Math.abs(ot[1]-ct[1])<_e.eps&&ot[2]>ct[2])&&(ot=this.line.point2.coords.usrCoords,ct=this.line.point1.coords.usrCoords)):(ot=this.line.point1.coords.usrCoords,ct=this.line.point2.coords.usrCoords),{x:(ct[1]-ot[1])/ut,y:(ct[2]-ot[2])/ut}},_isInsideCanvas:function(ot,ct,ut){var ht=this.board.canvasWidth,dt=this.board.canvasHeight;return ut===void 0&&(ut=0),ot[0]>=ut&&ot[0]<=ht-ut&&ct[0]>=ut&&ct[0]<=dt-ut||ot[1]>=ut&&ot[1]<=ht-ut&&ct[1]>=ut&&ct[1]<=dt-ut},tickEndings:function(ot,ct){var ut,ht,dt,pt,ft,gt,mt=[-2e6,-2e6],At=[-2e6,-2e6];return ut=ot.scrCoords,ct?(pt=this.dxMaj,ft=this.dyMaj,gt=this.majStyle):(pt=this.dxMin,ft=this.dyMin,gt=this.minStyle),ht=[-ft*ut[1]-pt*ut[2],ft,pt],gt==="infinite"?(dt=rt.meetLineBoard(ht,this.board),mt[0]=dt[0].scrCoords[1],mt[1]=dt[1].scrCoords[1],At[0]=dt[0].scrCoords[2],At[1]=dt[1].scrCoords[2]):(mt[0]=ut[1]+pt*at.evaluate(this.visProp.tickendings[0]),At[0]=ut[2]-ft*at.evaluate(this.visProp.tickendings[0]),mt[1]=ut[1]-pt*at.evaluate(this.visProp.tickendings[1]),At[1]=ut[2]+ft*at.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(mt,At)?[mt,At,ct]:[]},formatLabelText:function(ot){var ct=ot.toString(),ut=at.evaluate(this.visProp.scalesymbol);return at.isNumber(ot)&&((ct.length>at.evaluate(this.visProp.maxlabellength)||ct.indexOf("e")!==-1)&&(ct=ot.toPrecision(at.evaluate(this.visProp.precision)).toString()),ct.indexOf(".")>-1&&ct.indexOf("e")===-1&&(ct=ct.replace(/0+$/,""),ct=ct.replace(/\.$/,""))),ut.length>0&&(ct==="1"?ct=ut:ct==="-1"?ct="-"+ut:ct!=="0"&&(ct+=ut)),at.evaluate(this.visProp.useunicodeminus)&&(ct=ct.replace(/-/g,"−")),ct},generateLabelText:function(ot,ct,ut){var ht,dt=this.getDistanceFromZero(ct,ot);return Math.abs(dt)<_e.eps?ht="0":(at.exists(ut)||(ut=dt/at.evaluate(this.visProp.scale)),ht=this.formatLabelText(ut)),ht},generateLabelData:function(ot,ct,ut){var ht,dt,pt,ft;return ft=at.evaluate(this.visProp.label.fontsize),ht=[ct.scrCoords[1],ct.scrCoords[1]],dt=[ct.scrCoords[2],ct.scrCoords[2]],pt=ft===void 0?12:ft,pt*=1.5,this._isInsideCanvas(ht,dt,pt)?(ht=at.evaluate(this.visProp.label.offset[0]),dt=at.evaluate(this.visProp.label.offset[1]),{x:ct.usrCoords[1]+ht/this.board.unitX,y:ct.usrCoords[2]+dt/this.board.unitY,t:ot,i:ut}):null},update:function(){return this.needsUpdate&&this.board.canvasWidth!==0&&this.board.canvasHeight!==0&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var ot,ct,ut,ht,dt,pt,ft,gt;for(ut=this.labelsData.length,ht=this.labels.length,ot=0,ct=0;ot<ut;ot++)this.labelsData[ot]!==null&&(ft=this.labelsData[ot],ct<ht?(pt=this.labels[ct],pt.setText(ft.t),pt.setCoords(ft.x,ft.y),ct++):(this.labelCounter+=1,dt={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},dt=at.deepCopy(dt,this.visProp.label),dt.id=this.id+ft.i+"Label"+this.labelCounter,pt=lt.createText(this.board,[ft.x,ft.y,ft.t],dt),pt.isDraggable=!1,pt.dump=!1,this.labels.push(pt)),gt=at.evaluate(this.visProp.label.visible),gt==="inherit"&&(gt=this.visPropCalc.visible),pt.prepareUpdate().updateVisibility(gt).updateRenderer(),pt.distanceX=at.evaluate(this.visProp.label.offset[0]),pt.distanceY=at.evaluate(this.visProp.label.offset[1]));for(ut=ct,ct=ut;ct<ht;ct++)this.board.renderer.display(this.labels[ct],!1),this.labels[ct].visProp.visible=!1;return this},hideElement:function(){var ot;for(tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),ot=0;ot<this.labels.length;ot++)at.exists(this.labels[ot])&&this.labels[ot].hideElement();return this},showElement:function(){var ot;for(tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),ot=0;ot<this.labels.length;ot++)at.exists(this.labels[ot])&&this.labels[ot].showElement();return this}}),tt.createTicks=function(ot,ct,ut){var ht,dt,pt=at.copyAttributes(ut,ot.options,"ticks");if(dt=ct.length<2?pt.ticksdistance:ct[1],ct[0].elementClass!==it.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof ct[0]+"'.");return ht=new tt.Ticks(ct[0],dt,pt),at.isFunction(pt.generatelabelvalue)&&(ht.generateLabelText=pt.generatelabelvalue),at.isFunction(pt.generatelabeltext)&&(ht.generateLabelText=pt.generatelabeltext),ht.setParents(ct[0]),ht.isDraggable=!0,ht.fullUpdate(ct[0].visPropCalc.visible),ht},tt.createHatchmark=function(ot,ct,ut){var ht,dt,pt,ft,gt,mt,At=[],yt=at.copyAttributes(ut,ot.options,"hatch");if(ct[0].elementClass!==it.OBJECT_CLASS_LINE||typeof ct[1]!="number")throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof ct[0]+"' and '"+typeof ct[1]+" and ''"+typeof ct[2]+"'.");for(ht=ct[1],ft=yt.ticksdistance,gt=(ht-1)*ft,pt=.5*-gt,dt=0;dt<ht;dt++)At[dt]=pt+dt*ft;return mt=ot.create("ticks",[ct[0],At],yt),mt.elType="hatch",mt},tt.registerElement("ticks",tt.createTicks),tt.registerElement("hash",tt.createHatchmark),tt.registerElement("hatch",tt.createHatchmark),{Ticks:tt.Ticks,createTicks:tt.createTicks,createHashmark:tt.createHatchmark,createHatchmark:tt.createHatchmark}}),define("element/slider",["jxg","math/math","base/constants","utils/type","base/point","base/group","base/element","base/line","base/ticks","base/text"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){return tt.createSlider=function(ut,ht,dt){var pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt;return Nt=it.copyAttributes(dt,ut.options,"slider"),Ot=Nt.withticks,It=Nt.withlabel,Bt=Nt.snapwidth,zt=Nt.precision,Nt=it.copyAttributes(dt,ut.options,"slider","point1"),bt=ut.create("point",ht[0],Nt),Nt=it.copyAttributes(dt,ut.options,"slider","point2"),xt=ut.create("point",ht[1],Nt),Nt=it.copyAttributes(dt,ut.options,"slider","baseline"),vt=ut.create("segment",[bt,xt],Nt),vt.updateStdform(),pt=bt.coords.usrCoords.slice(1),ft=xt.coords.usrCoords.slice(1),gt=ht[2][0],mt=ht[2][1],At=ht[2][2],yt=At-gt,St=pt[0]+(ft[0]-pt[0])*(mt-gt)/(At-gt),Et=pt[1]+(ft[1]-pt[1])*(mt-gt)/(At-gt),Nt=it.copyAttributes(dt,ut.options,"slider"),Nt.withLabel=!1,Tt=ut.create("glider",[St,Et,vt],Nt),Tt.setAttribute({snapwidth:Bt}),Nt=it.copyAttributes(dt,ut.options,"slider","highline"),Mt=ut.create("segment",[bt,Tt],Nt),Tt.Value=function(){var Dt=this._smax-this._smin,Ft=it.evaluate(this.visProp.snapwidth);return Ft===-1?this.position*Dt+this._smin:Math.round((this.position*Dt+this._smin)/Ft)*Ft},Tt.methodMap=it.deepCopy(Tt.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),Tt._smax=At,Tt._smin=gt,Tt.setMax=function(Dt){return this._smax=Dt,this},Tt.setValue=function(Dt){var Ft=this._smax-this._smin;return Math.abs(Ft)>_e.eps?this.position=(Dt-this._smin)/Ft:this.position=0,this.position=Math.max(0,Math.min(1,this.position)),this},Tt.setMin=function(Dt){return this._smin=Dt,this},It&&(Nt=it.copyAttributes(dt,ut.options,"slider","label"),Rt=ut.create("text",[function(){return .05*(xt.X()-bt.X())+xt.X()},function(){return .05*(xt.Y()-bt.Y())+xt.Y()},function(){var Dt,Ft=it.evaluate(Tt.visProp.suffixlabel),Ut=it.evaluate(Tt.visProp.unitlabel),$t=it.evaluate(Tt.visProp.postlabel);return Dt=Ft!==null?Ft:Tt.name&&Tt.name!==""?Tt.name+" = ":"",Dt+=it.toFixed(Tt.Value(),zt),Ut!==null&&(Dt+=Ut),$t!==null&&(Dt+=$t),Dt}],Nt),Tt.label=Rt,Tt.visProp.withlabel=!0,Tt.hasLabel=!0),Tt.point1=bt,Tt.point2=xt,Tt.baseline=vt,Tt.highline=Mt,Ot&&(Nt=it.copyAttributes(dt,ut.options,"slider","ticks"),it.exists(Nt.generatelabeltext)||(Nt.generateLabelText=function(Dt,Ft,Ut){var $t=Tt.point1.Dist(Tt.point2),Vt=Tt._smin,Zt=Tt._smax,qt=this.getDistanceFromZero(Ft,Dt)*(Zt-Vt)/$t+Vt;return $t<_e.eps||Math.abs(qt)<_e.eps?"0":this.formatLabelText(qt)}),_t=2,Ct=ut.create("ticks",[Tt.baseline,Tt.point1.Dist(bt)/_t,function(Dt){var Ft=Tt.point1.Dist(Tt.point2),Ut=Tt.point1.coords.distance(rt.COORDS_BY_USER,Dt);return Ft<_e.eps?0:Ut/Ft*yt+gt}],Nt),Tt.ticks=Ct),Tt.remove=function(){It&&ut.removeObject(Rt),ut.removeObject(Mt),ut.removeObject(vt),ut.removeObject(xt),ut.removeObject(bt),nt.Point.prototype.remove.call(Tt)},bt.dump=!1,xt.dump=!1,vt.dump=!1,Mt.dump=!1,Tt.elType="slider",Tt.parents=ht,Tt.subs={point1:bt,point2:xt,baseLine:vt,highLine:Mt},Tt.inherits.push(bt,xt,vt,Mt),Ot&&(Ct.dump=!1,Tt.subs.ticks=Ct,Tt.inherits.push(Ct)),Tt},tt.registerElement("slider",tt.createSlider),{createSlider:tt.createSlider}}),define("element/measure",["jxg","utils/type","base/element","base/point","base/line","base/ticks"],function(tt,_e,rt,it,nt,st){return tt.createTapemeasure=function(at,lt,ot){var ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt;return ct=lt[0],ut=lt[1],ht=_e.copyAttributes(ot,at.options,"tapemeasure","point1"),mt=at.create("point",ct,ht),ht=_e.copyAttributes(ot,at.options,"tapemeasure","point2"),At=at.create("point",ut,ht),mt.setAttribute({ignoredSnapToPoints:[At]}),At.setAttribute({ignoredSnapToPoints:[mt]}),ht=_e.copyAttributes(ot,at.options,"tapemeasure"),dt=ht.withticks,pt=ht.withlabel,ft=ht.precision,pt&&(ht.withlabel=!0),gt=at.create("segment",[mt,At],ht),pt&&(yt=ot.name&&ot.name!==""?ot.name+" = ":"",gt.label.setText(function(){return yt+_e.toFixed(mt.Dist(At),ft)})),dt&&(ht=_e.copyAttributes(ot,at.options,"tapemeasure","ticks"),bt=at.create("ticks",[gt,.1],ht),gt.inherits.push(bt)),gt.remove=function(){dt&&gt.removeTicks(bt),at.removeObject(At),at.removeObject(mt),rt.prototype.remove.call(this)},gt.Value=function(){return mt.Dist(At)},mt.dump=!1,At.dump=!1,gt.elType="tapemeasure",gt.getParents=function(){return[[mt.X(),mt.Y()],[At.X(),At.Y()]]},gt.subs={point1:mt,point2:At},dt&&(bt.dump=!1),gt.methodMap=tt.deepCopy(gt.methodMap,{Value:"Value"}),gt.prepareUpdate().update(),at.isSuspendedUpdate||(gt.updateVisibility().updateRenderer(),gt.point1.updateVisibility().updateRenderer(),gt.point2.updateVisibility().updateRenderer()),gt},tt.registerElement("tapemeasure",tt.createTapemeasure),{createTapemeasure:tt.createTapemeasure}}),define("parser/datasource",["jxg","utils/type"],function(tt,_e){return tt.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},tt.extend(tt.DataSource.prototype,{loadFromArray:function(rt,it,nt){var st,at,lt;if(_e.isArray(it)&&(this.columnHeaders=it,it=!1),_e.isArray(nt)&&(this.rowHeaders=nt,nt=!1),this.data=[],it&&(this.columnHeaders=[]),nt&&(this.rowHeaders=[]),_e.exists(rt)){for(this.data=[],st=0;st<rt.length;st++)for(this.data[st]=[],at=0;at<rt[st].length;at++)lt=rt[st][at],parseFloat(lt).toString()===lt?this.data[st][at]=parseFloat(lt):this.data[st][at]=lt!=="-"?lt:NaN;if(it&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),nt)for(this.rowHeaders=[],st=0;st<this.data.length;st++)this.rowHeaders.push(this.data[st][0]),this.data[st]=this.data[st].slice(1)}return this},loadFromTable:function(rt,it,nt){var st,at,lt,ot,ct;if(_e.isArray(it)&&(this.columnHeaders=it,it=!1),_e.isArray(nt)&&(this.rowHeaders=nt,nt=!1),this.data=[],it&&(this.columnHeaders=[]),nt&&(this.rowHeaders=[]),rt=document.getElementById(rt),_e.exists(rt)){for(st=rt.getElementsByTagName("tr"),this.data=[],at=0;at<st.length;at++)for(ot=st[at].getElementsByTagName("td"),this.data[at]=[],lt=0;lt<ot.length;lt++)ct=ot[lt].innerHTML,parseFloat(ct).toString()===ct?this.data[at][lt]=parseFloat(ct):this.data[at][lt]=ct!=="-"?ct:NaN;if(it&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),nt)for(this.rowHeaders=[],at=0;at<this.data.length;at++)this.rowHeaders.push(this.data[at][0]),this.data[at]=this.data[at].slice(1)}return this},addColumn:function(rt,it,nt){throw new Error("not implemented")},addRow:function(rt,it,nt){throw new Error("not implemented")},getColumn:function(rt){var it,nt=[];if(_e.isString(rt)){for(it=0;it<this.columnHeaders.length;it++)if(rt===this.columnHeaders[it]){rt=it;break}}for(it=0;it<this.data.length;it++)this.data[it].length>rt&&(nt[it]=parseFloat(this.data[it][rt]));return nt},getRow:function(rt){var it,nt;if(_e.isString(rt)){for(nt=0;nt<this.rowHeaders.length;nt++)if(rt===this.rowHeaders[nt]){rt=nt;break}}for(it=[],nt=0;nt<this.data[rt].length;nt++)it[nt]=this.data[rt][nt];return it}}),tt.DataSource}),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At){return tt.Chart=function(yt,bt,xt){this.constructor(yt,xt);var vt,_t,Ct,St,Et,Tt;if(!ot.isArray(bt)||bt.length===0)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],ot.isNumber(bt[0]))for(_t=bt,vt=[],Ct=0;Ct<_t.length;Ct++)vt[Ct]=Ct+1;else if(bt.length===1&&ot.isArray(bt[0]))for(_t=bt[0],vt=[],Tt=ot.evaluate(_t).length,Ct=0;Ct<Tt;Ct++)vt[Ct]=Ct+1;else bt.length===2&&(Tt=Math.min(bt[0].length,bt[1].length),vt=bt[0].slice(0,Tt),_t=bt[1].slice(0,Tt));if(ot.isArray(_t)&&_t.length===0)throw new Error("JSXGraph: Can't create charts without data.");for(Et=xt.chartstyle.replace(/ /g,"").split(","),Ct=0;Ct<Et.length;Ct++){switch(Et[Ct]){case"bar":St=this.drawBar(yt,vt,_t,xt);break;case"line":St=this.drawLine(yt,vt,_t,xt);break;case"fit":St=this.drawFit(yt,vt,_t,xt);break;case"spline":St=this.drawSpline(yt,vt,_t,xt);break;case"pie":St=this.drawPie(yt,_t,xt);break;case"point":St=this.drawPoints(yt,vt,_t,xt);break;case"radar":St=this.drawRadar(yt,bt,xt)}this.elements.push(St)}return this.id=this.board.setId(this,"Chart"),this.elements},tt.Chart.prototype=new st,tt.extend(tt.Chart.prototype,{drawLine:function(yt,bt,xt,vt){return vt.fillcolor="none",vt.highlightfillcolor="none",yt.create("curve",[bt,xt],vt)},drawSpline:function(yt,bt,xt,vt){return vt.fillColor="none",vt.highlightfillcolor="none",yt.create("spline",[bt,xt],vt)},drawFit:function(yt,bt,xt,vt){var _t=vt.degree;return _t=Math.max(parseInt(_t,10),1)||1,vt.fillcolor="none",vt.highlightfillcolor="none",yt.create("functiongraph",[_e.regressionPolynomial(_t,bt,xt)],vt)},drawBar:function(yt,bt,xt,vt){var _t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt=[],zt=[],Dt=function(Ut,$t){return function(){return bt[Ut]()-$t*St}},Ft={fixed:!0,withLabel:!1,visible:!1,name:""};if((Ot=ot.copyAttributes(vt,yt.options,"chart"))&&Ot.width)St=Ot.width;else{if(bt.length<=1)St=1;else for(St=bt[1]-bt[0],_t=1;_t<bt.length-1;_t++)St=bt[_t+1]-bt[_t]<St?bt[_t+1]-bt[_t]:St;St*=.8}for(Bt=ot.copyAttributes(vt,yt.options,"chart","label"),_t=0;_t<bt.length;_t++)ot.isFunction(bt[_t])?(Et=Dt(_t,-.5),Tt=Dt(_t,0),Mt=Dt(_t,.5)):(Et=bt[_t]-.5*St,Tt=bt[_t],Mt=bt[_t]+.5*St),Rt=ot.isFunction(xt[_t])?xt[_t]():xt[_t],Rt=xt[_t],Ot.dir==="horizontal"?(zt[0]=yt.create("point",[0,Et],Ft),zt[1]=yt.create("point",[Rt,Et],Ft),zt[2]=yt.create("point",[Rt,Mt],Ft),zt[3]=yt.create("point",[0,Mt],Ft),ot.exists(Ot.labels)&&ot.exists(Ot.labels[_t])&&(Bt.anchorY="middle",Ct=yt.create("text",[Rt,Tt,Ot.labels[_t]],Bt),Ct.visProp.anchorx=function(Ut){return function(){return Ut.X()>=0?"left":"right"}}(Ct))):(zt[0]=yt.create("point",[Et,0],Ft),zt[1]=yt.create("point",[Et,Rt],Ft),zt[2]=yt.create("point",[Mt,Rt],Ft),zt[3]=yt.create("point",[Mt,0],Ft),ot.exists(Ot.labels)&&ot.exists(Ot.labels[_t])&&(Bt.anchorX="middle",Ct=yt.create("text",[Tt,Rt,Ot.labels[_t]],Bt),Ct.visProp.anchory=function(Ut){return function(){return Ut.Y()>=0?"bottom":"top"}}(Ct))),ot.isArray(Ot.colors)&&(It=Ot.colors,Ot.fillcolor=It[_t%It.length]),Nt[_t]=yt.create("polygon",zt,Ot),ot.exists(Ot.labels)&&ot.exists(Ot.labels[_t])&&(Nt[_t].text=Ct);return Nt},drawPoints:function(yt,bt,xt,vt){var _t,Ct=[],St=vt.infoboxarray;for(vt.fixed=!0,vt.name="",_t=0;_t<bt.length;_t++)vt.infoboxtext=!!St&&St[_t%St.length],Ct[_t]=yt.create("point",[bt[_t],xt[_t]],vt);return Ct},drawPie:function(yt,bt,xt){var vt,_t,Ct=[],St=[],Et=(rt.sum(bt),xt.colors),Tt=xt.highlightcolors,Mt=xt.labels,Rt=xt.radius||4,It=Rt,Ot=xt.center||[0,0],Bt=Ot[0],Nt=Ot[1],zt=function(Vt,Zt,qt){return function(){var sr,er,ir,ur=0;for(er=0;er<=Vt;er++)ur+=parseFloat(ot.evaluate(bt[er]));for(sr=ur,er=Vt+1;er<bt.length;er++)sr+=parseFloat(ot.evaluate(bt[er]));return ir=sr!==0?2*Math.PI*ur/sr:0,It()*Math[Zt](ir)+qt}},Dt=function(Vt,Zt){var qt=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],sr=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];ot.exists(this.label)&&(this.label.rendNode.style.fontSize=Zt*ot.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new nt(it.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+qt*Vt,this.point1.coords.usrCoords[2]+sr*Vt],this.board),this.fullUpdate()},Ft=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),Dt.call(this,1.1,2))},Ut=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),Dt.call(this,.9090909,1))},$t={fixed:!0,withLabel:!1,visible:!1,name:""};if(!ot.isArray(Mt))for(Mt=[],vt=0;vt<bt.length;vt++)Mt[vt]="";for(ot.isFunction(Rt)||(It=function(){return Rt}),xt.highlightonsector=xt.highlightonsector||!1,xt.straightfirst=!1,xt.straightlast=!1,_t=yt.create("point",[Bt,Nt],$t),Ct[0]=yt.create("point",[function(){return It()+Bt},function(){return Nt}],$t),vt=0;vt<bt.length;vt++)Ct[vt+1]=yt.create("point",[zt(vt,"cos",Bt),zt(vt,"sin",Nt)],$t),xt.name=Mt[vt],xt.withlabel=xt.name!=="",xt.fillcolor=Et&&Et[vt%Et.length],xt.labelcolor=Et&&Et[vt%Et.length],xt.highlightfillcolor=Tt&&Tt[vt%Tt.length],St[vt]=yt.create("sector",[_t,Ct[vt],Ct[vt+1]],xt),xt.highlightonsector&&(St[vt].hasPoint=St[vt].hasPointSector),xt.highlightbysize&&(St[vt].highlight=Ft,St[vt].noHighlight=Ut);return{sectors:St,points:Ct,midpoint:_t}},drawRadar:function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft,Ut,$t,Vt,Zt,qt,sr,er,ir,ur,ar,lr,gr,Yt,nr,mr,Sr,Er,Nr,wr,kr,Ur,Or,Xr,Qt,Xt,xr,Lr,fr,pr=bt.length,Hr=function(){var Cr,tr,Ar,yr,Jt=ot.evaluate(this.visProp.label.offset).slice(0);return Cr=this.point1.X(),tr=this.point2.X(),Ar=this.point1.Y(),yr=this.point2.Y(),tr<Cr&&(Jt[0]=-Jt[0]),yr<Ar&&(Jt[1]=-Jt[1]),this.setLabelRelativeCoords(Jt),new nt(it.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},hr=function(Cr,tr){var Ar,yr,Jt;return Ar=yt.create("transform",[-(Ft[tr]-zt[tr]),0],{type:"translate"}),yr=yt.create("transform",[Zt/(Ut[tr]+Dt[tr]-(Ft[tr]-zt[tr])),1],{type:"scale"}),Ar.melt(yr),Jt=yt.create("transform",[Cr],{type:"rotate"}),Ar.melt(Jt),Ar};if(pr<=0)return void tt.debug("No data");if(Ct=xt.paramarray,!ot.exists(Ct))return void tt.debug("Need paramArray attribute");if((St=Ct.length)<=1)return void tt.debug("Need more than 1 param");for(vt=0;vt<pr;vt++)if(St!==bt[vt].length)return void tt.debug("Use data length equal to number of params ("+bt[vt].length+" != "+St+")");for(Et=[],Tt=[],_t=0;_t<St;_t++)Et[_t]=bt[0][_t],Tt[_t]=Et[_t];for(vt=1;vt<pr;vt++)for(_t=0;_t<St;_t++)bt[vt][_t]>Et[_t]&&(Et[_t]=bt[vt][_t]),bt[vt][_t]<Tt[_t]&&(Tt[_t]=bt[vt][_t]);for(Mt=[],Rt=[],vt=0;vt<pr;vt++)Mt[vt]="",Rt[vt]=[];for(It=[],Ot=[],Bt=xt.startshiftratio||0,Nt=xt.endshiftratio||0,vt=0;vt<St;vt++)It[vt]=(Et[vt]-Tt[vt])*Bt,Ot[vt]=(Et[vt]-Tt[vt])*Nt;if(zt=xt.startshiftarray||It,Dt=xt.endshiftarray||Ot,Ft=xt.startarray||Tt,ot.exists(xt.start))for(vt=0;vt<St;vt++)Ft[vt]=xt.start;if(Ut=xt.endarray||Et,ot.exists(xt.end))for(vt=0;vt<St;vt++)Ut[vt]=xt.end;if(zt.length!==St)return void tt.debug("Start shifts length is not equal to number of parameters");if(Dt.length!==St)return void tt.debug("End shifts length is not equal to number of parameters");if(Ft.length!==St)return void tt.debug("Starts length is not equal to number of parameters");if(Ut.length!==St)return void tt.debug("Ends length is not equal to number of parameters");for($t=xt.labelarray||Mt,Vt=xt.colors,xt.highlightcolors,Zt=xt.radius||10,Lr=xt.strokewidth||1,ot.exists(xt.highlightonsector)||(xt.highlightonsector=!1),qt={name:xt.name,id:xt.id,strokewidth:Lr,polystrokewidth:xt.polystrokewidth||Lr,strokecolor:xt.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:xt.fillColor||"#FFFF88",fillopacity:xt.fillOpacity||.4,highlightfillcolor:xt.highlightFillColor||"#FF7400",highlightstrokecolor:xt.highlightStrokeColor||"black",gradient:xt.gradient||"none"},sr=xt.center||[0,0],er=sr[0],ir=sr[1],ur=yt.create("point",[er,ir],{name:"",fixed:!0,withlabel:!1,visible:!1}),ar=Math.PI/2-Math.PI/St,ar=xt.startangle||0,lr=ar,gr=[],Yt=[],vt=0;vt<St;vt++)for(lr+=2*Math.PI/St,mr=Zt*Math.cos(lr)+er,Sr=Zt*Math.sin(lr)+ir,gr[vt]=yt.create("point",[mr,Sr],{name:"",fixed:!0,withlabel:!1,visible:!1}),Yt[vt]=yt.create("line",[ur,gr[vt]],{name:Ct[vt],strokeColor:qt.strokecolor,strokeWidth:qt.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:qt.highlightstrokecolor}),Yt[vt].getLabelAnchor=Hr,nr=hr(lr,vt),_t=0;_t<bt.length;_t++)fr=bt[_t][vt],Rt[_t][vt]=yt.create("point",[fr,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),Rt[_t][vt].addTransform(Rt[_t][vt],nr);for(Er=[],vt=0;vt<pr;vt++)for(qt.labelcolor=Vt&&Vt[vt%Vt.length],qt.strokecolor=Vt&&Vt[vt%Vt.length],qt.fillcolor=Vt&&Vt[vt%Vt.length],Er[vt]=yt.create("polygon",Rt[vt],{withLines:!0,withLabel:!1,fillColor:qt.fillcolor,fillOpacity:qt.fillopacity,highlightFillColor:qt.highlightfillcolor}),_t=0;_t<St;_t++)Er[vt].borders[_t].setAttribute("strokecolor:"+Vt[vt%Vt.length]),Er[vt].borders[_t].setAttribute("strokewidth:"+qt.polystrokewidth);switch(xt.legendposition||"none"){case"right":wr=xt.legendleftoffset||2,kr=xt.legendtopoffset||1,this.legend=yt.create("legend",[er+Zt+wr,ir+Zt-kr],{labels:$t,colors:Vt});break;case"none":break;default:tt.debug("Unknown legend position")}if(Nr=[],xt.showcircles){for(Ur=[],vt=0;vt<6;vt++)Ur[vt]=20*vt;if(Ur[0]="0",Or=xt.circlelabelarray||Ur,(Xr=Or.length)<2)return void tt.debug("Too less circles");for(Qt=[],Xt=ar+Math.PI/St,nr=hr(Xt,0),qt.fillcolor="none",qt.highlightfillcolor="none",qt.strokecolor=xt.strokecolor||"black",qt.strokewidth=xt.circlestrokewidth||.5,qt.layer=0,xr=(Ut[0]-Ft[0])/(Xr-1),vt=0;vt<Xr;vt++)Qt[vt]=yt.create("point",[Ft[0]+vt*xr,0],{name:Or[vt],size:0,fixed:!0,withLabel:!0,visible:!0}),Qt[vt].addTransform(Qt[vt],nr),Nr[vt]=yt.create("circle",[ur,Qt[vt]],qt)}return this.rendNode=Er[0].rendNode,{circles:Nr,lines:Yt,points:Rt,midpoint:ur,polygons:Er}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){}}),tt.createChart=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft,Ut,$t=[],Vt=ct.isBrowser?yt.document.getElementById(bt[0]):null;if(bt.length===1&&ot.isString(bt[0])){if(ot.exists(Vt)){if(It=ot.copyAttributes(xt,yt.options,"chart"),Vt=new at().loadFromTable(bt[0],It.withheaders,It.withheaders),vt=Vt.data,Et=Vt.columnHeaders,_t=Vt.rowHeaders,Ot=It.width,Bt=It.name,Nt=It.strokecolor,zt=It.fillcolor,Dt=It.highlightstrokecolor,Ft=It.highlightfillcolor,yt.suspendUpdate(),Ut=vt.length,Rt=[],It.rows&&ot.isArray(It.rows)){for(Ct=0;Ct<Ut;Ct++)for(St=0;St<It.rows.length;St++)if(It.rows[St]===Ct||It.withheaders&&It.rows[St]===_t[Ct]){Rt.push(vt[Ct]);break}}else Rt=vt;for(Ut=Rt.length,Ct=0;Ct<Ut;Ct++){if(Mt=[],It.chartstyle&&It.chartstyle.indexOf("bar")!==-1){for(Tt=Ot||.8,Mt.push(1-Tt/2+(Ct+.5)*Tt/Ut),St=1;St<Rt[Ct].length;St++)Mt.push(Mt[St-1]+1);It.width=Tt/Ut}Bt&&Bt.length===Ut?It.name=Bt[Ct]:It.withheaders&&(It.name=Et[Ct]),Nt&&Nt.length===Ut?It.strokecolor=Nt[Ct]:It.strokecolor=lt.hsv2rgb((Ct+1)/Ut*360,.9,.6),zt&&zt.length===Ut?It.fillcolor=zt[Ct]:It.fillcolor=lt.hsv2rgb((Ct+1)/Ut*360,.9,1),Dt&&Dt.length===Ut?It.highlightstrokecolor=Dt[Ct]:It.highlightstrokecolor=lt.hsv2rgb((Ct+1)/Ut*360,.9,1),Ft&&Ft.length===Ut?It.highlightfillcolor=Ft[Ct]:It.highlightfillcolor=lt.hsv2rgb((Ct+1)/Ut*360,.9,.6),It.chartstyle&&It.chartstyle.indexOf("bar")!==-1?$t.push(new tt.Chart(yt,[Mt,Rt[Ct]],It)):$t.push(new tt.Chart(yt,[Rt[Ct]],It))}yt.unsuspendUpdate()}return $t}return It=ot.copyAttributes(xt,yt.options,"chart"),new tt.Chart(yt,bt,It)},tt.registerElement("chart",tt.createChart),tt.Legend=function(yt,bt,xt){var vt;if(this.constructor(),vt=ot.copyAttributes(xt,yt.options,"legend"),this.board=yt,this.coords=new nt(it.COORDS_BY_USER,bt,this.board),this.myAtts={},this.label_array=vt.labelarray||vt.labels,this.color_array=vt.colorarray||vt.colors,this.lines=[],this.myAtts.strokewidth=vt.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=vt.legendstyle||vt.style,this.style!=="vertical")throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(yt,vt)},tt.Legend.prototype=new st,tt.Legend.prototype.drawVerticalLegend=function(yt,bt){var xt,vt=bt.linelength||1,_t=(bt.rowheight||20)/this.board.unitY,Ct=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new nt(it.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(xt=0;xt<this.label_array.length;xt++)this.myAtts.strokecolor=this.color_array[xt],this.myAtts.highlightstrokecolor=this.color_array[xt],this.myAtts.name=this.label_array[xt],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[xt],strokeWidth:this.myAtts.strokewidth},this.lines[xt]=yt.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-xt*_t],[this.coords.usrCoords[1]+vt,this.coords.usrCoords[2]-xt*_t]],this.myAtts),this.lines[xt].getLabelAnchor=Ct},tt.createLegend=function(yt,bt,xt){var vt=[0,0];return ot.exists(bt)&&bt.length===2&&(vt=bt),new tt.Legend(yt,vt,xt)},tt.registerElement("legend",tt.createLegend),{Chart:tt.Chart,Legend:tt.Legend,createChart:tt.createChart,createLegend:tt.createLegend}}),define("base/turtle",["jxg","base/constants","base/element","utils/type","base/curve","base/point","base/line","base/transformation"],function(tt,_e,rt,it,nt,st,at,lt){return tt.Turtle=function(ot,ct,ut){var ht,dt,pt;return this.constructor(ot,ut,_e.OBJECT_TYPE_TURTLE,_e.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=ot,this.visProp.curveType="plot",this._attributes=it.copyAttributes(this.visProp,ot.options,"turtle"),delete this._attributes.id,ht=0,dt=0,pt=90,ct.length!==0&&(ct.length===3?(ht=ct[0],dt=ct[1],pt=ct[2]):ct.length===2?it.isArray(ct[0])?(ht=ct[0][0],dt=ct[0][1],pt=ct[1]):(ht=ct[0],dt=ct[1]):(ht=ct[0][0],dt=ct[0][1])),this.init(ht,dt,pt),this.methodMap=it.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},tt.Turtle.prototype=new rt,tt.extend(tt.Turtle.prototype,{init:function(ot,ct,ut){var ht={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[ot,ct],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,ht),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],ht),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-ut),this.board.update()},forward:function(ot){if(ot===0)return this;var ct,ut=ot*Math.cos(this.dir*Math.PI/180),ht=ot*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||(ct=this.board.create("transform",[ut,ht],{type:"translate"}),ct.applyOnce(this.turtle),ct.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=ut,this.pos[1]+=ht,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(ot){return this.forward(-ot)},right:function(ot){return this.dir-=ot,this.dir%=360,!this.turtleIsHidden&&this.board.create("transform",[-ot*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2),this.board.update(),this},left:function(ot){return this.right(-ot)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var ot,ct;for(ot=0;ot<this.objects.length;ot++)ct=this.objects[ot],ct.type===_e.OBJECT_TYPE_CURVE&&(this.board.removeObject(ct),this.objects.splice(ot,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var ot,ct,ut=this.objects.length;for(ot=0;ot<ut;ot++)ct=this.objects[ot],this.board.removeObject(ct);return this.init(0,0,90),this},setPos:function(ot,ct){var ut;return it.isArray(ot)?this.pos=ot:this.pos=[ot,ct],this.turtleIsHidden||(this.turtle.setPositionDirectly(_e.COORDS_BY_USER,[ot,ct]),this.turtle2.setPositionDirectly(_e.COORDS_BY_USER,[ot,ct+this.arrowLen]),ut=this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}),ut.applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(ot){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",ot)),this.objects.push(this.curve),this},setPenColor:function(ot){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",ot)),this.objects.push(this.curve),this},setHighlightPenColor:function(ot){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",ot)),this.objects.push(this.curve),this},setAttribute:function(ot){var ct,ut,ht,dt=this.objects.length;for(ct=0;ct<dt;ct++)ut=this.objects[ct],ut.type===_e.OBJECT_TYPE_CURVE&&ut.setAttribute(ot);return ht=this.visProp.id,this.visProp=it.deepCopy(this.curve.visProp),this.visProp.id=ht,this._attributes=it.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(ot,ct){return this._attributes[ot.toLowerCase()]=ct,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var ot=this.stack.pop();return this.pos[0]=ot[0],this.pos[1]=ot[1],this.dir=ot[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(ot){var ct,ut,ht,dt,pt;return it.isArray(ot)?(ct=this.pos[0],ut=this.pos[1],ht=ot[0],dt=ot[1],pt=Math.atan2(dt-ut,ht-ct),this.right(this.dir-180*pt/Math.PI)):it.isNumber(ot)&&this.right(this.dir-ot),this},moveTo:function(ot){var ct,ut,ht;return it.isArray(ot)&&(ct=ot[0]-this.pos[0],ut=ot[1]-this.pos[1],this.turtleIsHidden||(ht=this.board.create("transform",[ct,ut],{type:"translate"}),ht.applyOnce(this.turtle),ht.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=ot[0],this.pos[1]=ot[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(ot){return this.forward(ot)},bk:function(ot){return this.back(ot)},lt:function(ot){return this.left(ot)},rt:function(ot){return this.right(ot)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(ot,ct){var ut,ht,dt,pt,ft=this.objects.length;for(ut=0,ht=0;ut<ft;ut++)if(dt=this.objects[ut],dt.elementClass===_e.OBJECT_CLASS_CURVE){if(ht<=ot&&ot<ht+dt.numberPoints)return pt=ot-ht,dt[ct](pt);ht+=dt.numberPoints}return this[ct]()},X:function(ot){return it.exists(ot)?this.evalAt(ot,"X"):this.pos[0]},Y:function(ot){return it.exists(ot)?this.evalAt(ot,"Y"):this.pos[1]},Z:function(ot){return 1},minX:function(){return 0},maxX:function(){var ot,ct,ut=this.objects.length,ht=0;for(ot=0;ot<ut;ot++)ct=this.objects[ot],ct.elementClass===_e.OBJECT_CLASS_CURVE&&(ht+=this.objects[ot].numberPoints);return ht},hasPoint:function(ot,ct){var ut,ht;for(ut=0;ut<this.objects.length;ut++)if(ht=this.objects[ut],ht.type===_e.OBJECT_TYPE_CURVE&&ht.hasPoint(ot,ct))return!0;return!1}}),tt.createTurtle=function(ot,ct,ut){var ht;return ct=ct||[],ht=it.copyAttributes(ut,ot.options,"turtle"),new tt.Turtle(ot,ct,ht)},tt.registerElement("turtle",tt.createTurtle),{Turtle:tt.Turtle,createTurtle:tt.createTurtle}}),define("parser/ca",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/env"],function(tt,_e,rt,it,nt,st,at,lt){return tt.CA=function(ot,ct,ut){this.node=ot,this.createNode=ct,this.parser=ut},tt.extend(tt.CA.prototype,{findMapNode:function(ot,ct){var ut,ht,dt;if(ct.value==="op_assign"&&ct.children[0].value===ot)return ct.children[1];if(ct.children){for(ht=ct.children.length,ut=0;ut<ht;++ut)if((dt=this.findMapNode(ot,ct.children[ut]))!==null)return dt}return null},setMath:function(ot){var ct,ut;if((ot.type!="node_op"||ot.value!="op_add"&&ot.value!="op_sub"&&ot.value!="op_mul"&&ot.value!="op_div"&&ot.value!="op_neg"&&ot.value!="op_execfun"&&ot.value!="op_exp")&&ot.type!="node_var"&&ot.type!="node_const"||(ot.isMath=!0),ot.children)for(ut=ot.children.length,ct=0;ct<ut;++ct)this.setMath(ot.children[ct])},deriveElementary:function(ot,ct){var ut,ht=ot.children[0].value,dt=ot.children[1];switch(ht){case"abs":ut=this.createNode("node_op","op_div",dt[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0]))]));break;case"sqrt":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(ot.type,ot.value,at.deepCopy(ot.children[0]),at.deepCopy(ot.children[1]))));break;case"sin":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),at.deepCopy(dt));break;case"cos":ut=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),at.deepCopy(dt)));break;case"tan":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),at.deepCopy(dt)),this.createNode("node_const",2)));break;case"exp":ut=this.createNode(ot.type,ot.value,at.deepCopy(ot.children[0]),at.deepCopy(ot.children[1]));break;case"pow":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",at.deepCopy(ot.children[0]),at.deepCopy(ot.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(ot.children[1][0],ct),this.createNode("node_op","op_div",at.deepCopy(ot.children[1][1]),at.deepCopy(ot.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(ot.children[1][1],ct),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[at.deepCopy(ot.children[1][0])]))));break;case"log":case"ln":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),at.deepCopy(dt[0]));break;case"log2":case"lb":case"ld":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),at.deepCopy(dt[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),at.deepCopy(dt[0])),this.createNode("node_const",.43429448190325176));break;case"asin":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0])))]));break;case"acos":ut=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0])))])));break;case"atan":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0]))));break;case"sinh":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[at.deepCopy(dt[0])]);break;case"cosh":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[at.deepCopy(dt[0])]);break;case"tanh":ut=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[at.deepCopy(dt[0])]),this.createNode("node_const",2)));break;case"asinh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0])),this.createNode("node_const",1))]));break;case"acosh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0])),this.createNode("node_const",1))]));break;case"atanh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0]))));break;default:ut=this.createNode("node_const",0),this._error('Derivative of "'+ht+'" not yet implemented')}return ut},derivative:function(ot,ct){var ut;switch(ot.type){case"node_op":switch(ot.value){case"op_execfun":ut=ot.children[0].value=="pow"?this.deriveElementary(ot,ct):this.createNode("node_op","op_mul",this.deriveElementary(ot,ct),this.derivative(ot.children[1][0],ct));break;case"op_div":ut=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(ot.children[0],ct),at.deepCopy(ot.children[1])),this.createNode("node_op","op_mul",at.deepCopy(ot.children[0]),this.derivative(ot.children[1],ct))),this.createNode("node_op","op_mul",at.deepCopy(ot.children[1]),at.deepCopy(ot.children[1])));break;case"op_mul":ut=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",at.deepCopy(ot.children[0]),this.derivative(ot.children[1],ct)),this.createNode("node_op","op_mul",this.derivative(ot.children[0],ct),at.deepCopy(ot.children[1])));break;case"op_neg":ut=this.createNode("node_op","op_neg",this.derivative(ot.children[0],ct));break;case"op_add":case"op_sub":ut=this.createNode("node_op",ot.value,this.derivative(ot.children[0],ct),this.derivative(ot.children[1],ct));break;case"op_exp":ut=this.createNode("node_op","op_mul",at.deepCopy(ot),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(ot.children[0],ct),this.createNode("node_op","op_div",at.deepCopy(ot.children[1]),at.deepCopy(ot.children[0]))),this.createNode("node_op","op_mul",this.derivative(ot.children[1],ct),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[at.deepCopy(ot.children[0])]))))}break;case"node_var":ut=ot.value===ct?this.createNode("node_const",1):this.createNode("node_const",0);break;case"node_const":ut=this.createNode("node_const",0)}return ut},expandDerivatives:function(ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t;if(mt=0,!ot)return mt;for(this.line=ot.line,this.col=ot.col,ht=ot.children.length,dt=0;dt<ht;++dt)if(ot.children[dt]&&ot.children[dt].type)ot.children[dt]=this.expandDerivatives(ot.children[dt],ot,ut);else if(at.isArray(ot.children[dt]))for(pt=0;pt<ot.children[dt].length;++pt)ot.children[dt][pt]&&ot.children[dt][pt].type&&(ot.children[dt][pt]=this.expandDerivatives(ot.children[dt][pt],ot,ut));switch(ot.type){case"node_op":switch(ot.value){case"op_execfun":if(ot.children[0]&&ot.children[0].value==="D"){if(ot.children[1][0].type=="node_var"?(bt=ot.children[1][0].value,ft=this.findMapNode(bt,ut),vt=ft.children[0],xt=ot.children[1].length>=2?ot.children[1][1].value:ft.children[0][0],gt=ft.children[1]):(gt=ot.children[1][0],vt=["x"],xt=ot.children[1].length>=2?ot.children[1][1].value:"x"),_t=ot.children[1].length>=3?ot.children[1][2].value:1,yt=gt,_t>=1)for(;_t>=1;)yt=this.derivative(yt,xt),yt=this.removeTrivialNodes(yt),_t--;At=ct.type=="node_op"&&ct.value=="op_assign"?this.createNode("node_op","op_map",vt,yt):yt,this.setMath(At),ot.type=At.type,ot.value=At.value,ot.children[0]=At.children[0],ot.children[1]=At.children[1]}}}return ot},removeTrivialNodes:function(ot){var ct,ut,ht,dt,pt;if(at.isArray(ot))for(ut=ot.length,ct=0;ct<ut;++ct)ot[ct]=this.removeTrivialNodes(ot[ct]);if(ot.type!="node_op"||!ot.children)return ot;for(ut=ot.children.length,ct=0;ct<ut;++ct){this.mayNotBeSimplified=!1;do ot.children[ct]=this.removeTrivialNodes(ot.children[ct]);while(this.mayNotBeSimplified)}switch(ot.value){case"op_map":if(ht=ot.children[0],dt=ot.children[1],dt.type=="node_var"){for(ct=0;ct<ht.length;++ct)if(ht[ct]==dt.value){dt.isMath=!0;break}}break;case"op_add":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&ht.value===0)return dt;if(dt.type=="node_const"&&dt.value===0)return ht;if(ht.type=="node_const"&&dt.type=="node_const")return ht.value+=dt.value,ht;break;case"op_mul":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&ht.value==1)return dt;if(dt.type=="node_const"&&dt.value==1||ht.type=="node_const"&&ht.value===0)return ht;if(dt.type=="node_const"&&dt.value===0||dt.type=="node_const"&&dt.value===0)return dt;if(ht.type=="node_op"&&ht.value=="op_neg"&&dt.type=="node_op"&&dt.value=="op_neg")return ot.children=[ht.children[0],dt.children[0]],this.mayNotBeSimplified=!0,ot;if(ht.value=="op_neg"&&dt.value!="op_neg")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_op","op_mul",ht.children[0],dt)],this.mayNotBeSimplified=!0,ot;if(ht.value!="op_neg"&&dt.value=="op_neg")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_op","op_mul",ht,dt.children[0])],this.mayNotBeSimplified=!0,ot;if(ht.value=="op_div"&&ht.children[0].type=="node_const"&&ht.children[0].value==1)return ot.type="node_op",ot.value="op_div",ot.children=[dt,ht.children[1]],this.mayNotBeSimplified=!0,ot;if(dt.value=="op_div"&&dt.children[0].type=="node_const"&&dt.children[0].value==1)return ot.type="node_op",ot.value="op_div",ot.children=[ht,dt.children[1]],this.mayNotBeSimplified=!0,ot;if(ht.type!="node_const"&&dt.type=="node_const")return ot.children=[dt,ht],this.mayNotBeSimplified=!0,ot;if(ht.type!="node_const"&&dt.type=="node_op"&&dt.value=="op_neg"&&dt.children[0].type=="node_const")return ot.children=[dt,ht],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value!="op_execfun"&&(dt.type=="node_var"||dt.type=="node_op"&&dt.value=="op_execfun"))return ot.children=[dt,ht],this.mayNotBeSimplified=!0,ot;if(ht.type!="node_op"&&dt.type=="node_op"&&dt.value=="op_neg"&&dt.children[0].type=="node_var")return ot.children=[dt,ht],this.mayNotBeSimplified=!0,ot;if(ht.type!="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return pt=dt.children[0],dt.children[0]=ht,ot.children=[pt,dt],this.mayNotBeSimplified=!0,ot;if(dt.type!="node_const"&&ht.type=="node_op"&&ht.value=="op_mul"&&ht.children[0].type=="node_const")return ot.children=[ht.children[0],this.createNode("node_op","op_mul",ht.children[1],dt)],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_const"&&dt.type=="node_const")return ht.value*=dt.value,ht;if(ht.type=="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return dt.children[0].value*=ht.value,dt;if(ht.hash=this.parser.compile(ht),dt.hash=this.parser.compile(dt),ht.hash===dt.hash)return ot.value="op_exp",ot.children[1]=this.createNode("node_const",2),ot;if(ht.type=="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return dt.children[0].value*=ht.value,dt;if(dt.type=="node_op"&&dt.value=="op_exp"&&(ht.hash||(ht.hash=this.parser.compile(ht)),dt.children[0].hash||(dt.children[0].hash=this.parser.compile(dt.children[0])),ht.hash===dt.children[0].hash))return dt.children[1]=this.createNode("node_op","op_add",dt.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,dt;if(ht.type=="node_op"&&ht.value=="op_exp"&&dt.type=="node_op"&&dt.value=="op_exp"&&(ht.children[0].hash=this.parser.compile(ht.children[0]),dt.children[0].hash=this.parser.compile(dt.children[0]),ht.children[0].hash===dt.children[0].hash))return ht.children[1]=this.createNode("node_op","op_add",ht.children[1],dt.children[1]),this.mayNotBeSimplified=!0,ht;break;case"op_sub":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&ht.value===0)return ot.value="op_neg",ot.children[0]=dt,ot;if(dt.type=="node_const"&&dt.value===0)return ht;if(ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value)return this.createNode("node_const",0);if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return this.createNode("node_const",0);if(ht.type=="node_const"&&dt.type=="node_const")return ht.value-=dt.value,ht;if(ht.type=="node_op"&&ht.value=="op_mul"&&dt.type=="node_op"&&dt.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.children[1].hash=this.parser.compile(dt.children[1]),ht.children[1].hash===dt.children[1].hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_sub",ht.children[0],dt.children[0]),ht.children[1]],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.hash=this.parser.compile(dt),ht.children[1].hash===dt.hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_sub",ht.children[0],this.createNode("node_const",1)),dt],this.mayNotBeSimplified=!0,ot;if(dt.type=="node_op"&&dt.value=="op_mul"&&(dt.children[1].hash=this.parser.compile(dt.children[1]),ht.hash=this.parser.compile(ht),dt.children[1].hash===ht.hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),dt.children[0]),ht],this.mayNotBeSimplified=!0,ot;break;case"op_neg":if(ht=ot.children[0],ht.type=="node_const"&&ht.value===0)return ht;if(ht.type=="node_op"&&ht.value=="op_neg")return ht.children[0];break;case"op_div":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value&&ht.value!==0)return ht.value=1,ht;if(ht.type=="node_const"&&ht.value===0&&dt.type=="node_const"&&dt.value!==0)return ht.value=0,ht;if(ht.type=="node_const"&&ht.value===0&&(dt.type=="node_op"||dt.type=="node_var"))return ot.type="node_const",ot.value=0,ot;if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return this.createNode("node_const",1);if(ht.type=="node_const"&&ht.value!==0&&dt.type=="node_const"&&dt.value===0)return ht.value>0?ht.value=1/0:ht.value=-1/0,ht;if(ht.type=="node_op"&&ht.value=="op_neg"&&dt.type=="node_op"&&dt.value=="op_neg")return ot.children=[ht.children[0],dt.children[0]],this.mayNotBeSimplified=!0,ot;if(ht.value=="op_neg"&&dt.value!="op_neg")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_op","op_div",ht.children[0],dt)],this.mayNotBeSimplified=!0,ot;if(ht.value!="op_neg"&&dt.value=="op_neg")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_op","op_div",ht,dt.children[0])],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_exp"&&(dt.hash||(dt.hash=this.parser.compile(dt)),ht.children[0].hash||(ht.children[0].hash=this.parser.compile(ht.children[0])),dt.hash===ht.children[0].hash))return ht.children[1]=this.createNode("node_op","op_sub",ht.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,ht;if(dt.type!="node_const"&&ht.type=="node_op"&&ht.value=="op_mul"&&ht.children[0].type=="node_const")return ot.value="op_mul",ot.children=[ht.children[0],this.createNode("node_op","op_div",ht.children[1],dt)],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_exp"&&dt.type=="node_op"&&dt.value=="op_exp"&&(ht.children[0].hash=this.parser.compile(ht.children[0]),dt.children[0].hash=this.parser.compile(dt.children[0]),ht.children[0].hash===dt.children[0].hash))return ht.children[1]=this.createNode("node_op","op_sub",ht.children[1],dt.children[1]),this.mayNotBeSimplified=!0,ht;break;case"op_exp":if(ht=ot.children[0],dt=ot.children[1],dt.type=="node_const"&&dt.value===0)return dt.value=1,dt;if(dt.type=="node_const"&&dt.value==1||ht.type=="node_const"&&ht.value==1||ht.type=="node_const"&&ht.value===0&&dt.type=="node_const"&&dt.value!==0)return ht;if(ht.type=="node_op"&&ht.value=="op_exp")return ot.children=[ht.children[0],this.createNode("node_op","op_mul",ht.children[1],dt)],ot}switch(ot.value){case"op_add":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value)return ht.value+=dt.value,ht;if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return ot.children[0]=this.createNode("node_const",2),ot.value="op_mul",ot;if(ht.type=="node_op"&&ht.value=="op_neg")return ot.value="op_sub",ot.children[0]=dt,ot.children[1]=ht.children[0],this.mayNotBeSimplified=!0,ot;if(dt.type=="node_op"&&dt.value=="op_neg")return ot.value="op_sub",ot.children[1]=dt.children[0],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_mul"&&dt.type=="node_op"&&dt.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.children[1].hash=this.parser.compile(dt.children[1]),ht.children[1].hash===dt.children[1].hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_add",ht.children[0],dt.children[0]),ht.children[1]],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.hash=this.parser.compile(dt),ht.children[1].hash===dt.hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_add",ht.children[0],this.createNode("node_const",1)),dt],this.mayNotBeSimplified=!0,ot;if(dt.type=="node_op"&&dt.value=="op_mul"&&(dt.children[1].hash=this.parser.compile(dt.children[1]),ht.hash=this.parser.compile(ht),dt.children[1].hash===ht.hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),dt.children[0]),ht],this.mayNotBeSimplified=!0,ot;break;case"op_sub":if(ht=ot.children[0],dt=ot.children[1],dt.type=="node_op"&&dt.value=="op_neg")return ot.value="op_add",ot.children[1]=dt.children[0],this.mayNotBeSimplified=!0,ot;break;case"op_execfun":return this.simplifyElementary(ot)}return ot},simplifyElementary:function(ot){var ct=ot.children[0].value,ut=ot.children[1];if(ut.length==0)return ot;switch(ct){case"sin":case"tan":if(ut[0].type=="node_const"&&ut[0].value===0||ut[0].type=="node_var"&&ut[0].value=="PI"||ut[0].type=="node_op"&&ut[0].value=="op_mul"&&ut[0].children[0].type=="node_const"&&ut[0].children[0].value%1==0&&ut[0].children[1].type=="node_var"&&ut[0].children[1].value=="PI")return ot.type="node_const",ot.value=0,ot;break;case"cos":if(ut[0].type=="node_const"&&ut[0].value===0)return ot.type="node_const",ot.value=1,ot;if(ut[0].type=="node_var"&&ut[0].value=="PI")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_const",1)],ot;break;case"exp":if(ut[0].type=="node_const"&&ut[0].value===0)return ot.type="node_const",ot.value=1,ot;break;case"pow":if(ut[1].type=="node_const"&&ut[1].value===0)return ot.type="node_const",ot.value=1,ot}return ot}}),tt.CA}),define("utils/dump",["jxg","utils/type"],function(tt,_e){return tt.Dump={addMarkers:function(rt,it,nt){var st,at,lt;_e.isArray(it)||(it=[it]),_e.isArray(nt)||(nt=[nt]),at=Math.min(it.length,nt.length),it.length=at,nt.length=at;for(st in rt.objects)if(rt.objects.hasOwnProperty(st))for(lt=0;lt<at;lt++)rt.objects[st][it[lt]]=nt[lt]},deleteMarkers:function(rt,it){var nt,st,at;_e.isArray(it)||(it=[it]),st=it.length,it.length=st;for(nt in rt.objects)if(rt.objects.hasOwnProperty(nt))for(at=0;at<st;at++)delete rt.objects[nt][it[at]]},str:function(rt){return typeof rt=="string"&&rt.substr(0,7)!=="function"&&(rt='"'+rt+'"'),rt},minimizeObject:function(rt,it){var nt,st,at,lt={},ot=_e.deepCopy(rt),ct=[];for(at=1;at<arguments.length;at++)ct.push(arguments[at]);for(lt=_e.deepCopy(lt,tt.Options.elements,!0),at=ct.length;at>0;at--)lt=_e.deepCopy(lt,ct[at-1],!0);for(nt in lt)lt.hasOwnProperty(nt)&&(st=nt.toLowerCase(),typeof lt[nt]!="object"&&lt[nt]===ot[st]&&(console.log("delete",nt),delete ot[st]));return ot},prepareAttributes:function(rt,it){var nt,st;nt=this.minimizeObject(it.getAttributes(),tt.Options[it.elType]);for(st in it.subs)it.subs.hasOwnProperty(st)&&(nt[st]=this.minimizeObject(it.subs[st].getAttributes(),tt.Options[it.elType][st],tt.Options[it.subs[st].elType]),nt[st].id=it.subs[st].id,nt[st].name=it.subs[st].name);return nt.id=it.id,nt.name=it.name,nt},setBoundingBox:function(rt,it,nt){return rt.push({obj:nt,method:"setBoundingBox",params:[it.getBoundingBox(),!0]}),rt},dump:function(rt){var it,nt,st,at,lt=[],ot=[],ct=[],ut=rt.objectsList.length;for(this.addMarkers(rt,"dumped",!1),it=0;it<ut;it++)if(nt=rt.objectsList[it],st={},!nt.dumped&&nt.dump){for(st.type=nt.getType(),st.parents=nt.getParents().slice(),st.type==="point"&&st.parents[0]===1&&(st.parents=st.parents.slice(1)),at=0;at<st.parents.length;at++)_e.isString(st.parents[at])&&st.parents[at][0]!=="'"&&st.parents[at][0]!=='"'?st.parents[at]='"'+st.parents[at]+'"':_e.isArray(st.parents[at])&&(st.parents[at]="["+st.parents[at].toString()+"]");st.attributes=this.prepareAttributes(rt,nt),st.type==="glider"&&nt.onPolygon&&lt.push({obj:nt.id,prop:"onPolygon",val:!0}),ct.push(st)}return this.deleteMarkers(rt,"dumped"),{elements:ct,props:lt,methods:ot}},arrayToParamStr:function(rt,it){var nt,st=[];for(nt=0;nt<rt.length;nt++)st.push(it.call(this,rt[nt]));return st.join(", ")},toJCAN:function(rt){var it,nt,st;switch(typeof rt){case"object":if(rt){if(nt=[],_e.isArray(rt)){for(it=0;it<rt.length;it++)nt.push(this.toJCAN(rt[it]));return"["+nt.join(",")+"]"}for(st in rt)rt.hasOwnProperty(st)&&nt.push(st+": "+this.toJCAN(rt[st]));return"<<"+nt.join(", ")+">> "}return"null";case"string":return"'"+rt.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return rt.toString();case"null":return"null"}},toJessie:function(rt){var it,nt,st=this.dump(rt),at=[];for(st.methods=this.setBoundingBox(st.methods,rt,"$board"),nt=st.elements,it=0;it<nt.length;it++)nt[it].attributes.name.length>0&&at.push("// "+nt[it].attributes.name),at.push("s"+it+" = "+nt[it].type+"("+nt[it].parents.join(", ")+") "+this.toJCAN(nt[it].attributes).replace(/\n/,"\\n")+";"),at.push("");for(it=0;it<st.methods.length;it++)at.push(st.methods[it].obj+"."+st.methods[it].method+"("+this.arrayToParamStr(st.methods[it].params,this.toJCAN)+");"),at.push("");for(it=0;it<st.props.length;it++)at.push(st.props[it].obj+"."+st.props[it].prop+" = "+this.toJCAN(st.props[it].val)+";"),at.push("");return at.join(`
`)},toJavaScript:function(rt){var it,nt,st=this.dump(rt),at=[];for(st.methods=this.setBoundingBox(st.methods,rt,"board"),nt=st.elements,it=0;it<nt.length;it++)at.push('board.create("'+nt[it].type+'", ['+nt[it].parents.join(", ")+"], "+_e.toJSON(nt[it].attributes)+");");for(it=0;it<st.methods.length;it++)at.push(st.methods[it].obj+"."+st.methods[it].method+"("+this.arrayToParamStr(st.methods[it].params,_e.toJSON)+");"),at.push("");for(it=0;it<st.props.length;it++)at.push(st.props[it].obj+"."+st.props[it].prop+" = "+_e.toJSON(st.props[it].val)+";"),at.push("");return at.join(`
`)}},tt.Dump}),define("element/comb",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point"],function(tt,_e,rt,it,nt,st,at){return tt.createComb=function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt;if(ot.length!==2)throw ft=ot.map(function(bt){return"'"+typeof bt+"'"}),new Error("JSXGraph: Can't create comb with parent types "+ft.join(", ")+`.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);if(rt.isArray(ot[0])&&ot[0].length>1)pt=rt.copyAttributes(ct,lt.options,"comb","point1"),ut=lt.create("point",ot[0],pt);else if(rt.isString(ot[0])||rt.isPoint(ot[0]))ut=lt.select(ot[0]);else if(rt.isFunction(ot[0])&&rt.isPoint(ot[0]()))ut=ot[0]();else{if(!(rt.isFunction(ot[0])&&ot[0]().length&&ot[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof ot[0]+"' and '"+typeof ot[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);pt=rt.copyAttributes(ct,lt.options,"comb","point1"),ut=at.createPoint(lt,ot[0](),pt)}if(rt.isArray(ot[1])&&ot[1].length>1)pt=rt.copyAttributes(ct,lt.options,"comb","point2"),ht=lt.create("point",ot[1],pt);else if(rt.isString(ot[1])||rt.isPoint(ot[1]))ht=lt.select(ot[1]);else if(rt.isFunction(ot[1])&&rt.isPoint(ot[1]()))ht=ot[1]();else{if(!(rt.isFunction(ot[1])&&ot[1]().length&&ot[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof ot[0]+"' and '"+typeof ot[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);pt=rt.copyAttributes(ct,lt.options,"comb","point2"),ht=at.createPoint(lt,ot[1](),pt)}return pt=rt.copyAttributes(ct,lt.options,"comb","curve"),dt=lt.create("curve",[[0],[0]],pt),pt=rt.copyAttributes(ct,lt.options,"comb"),gt=pt.frequency,mt=-pt.angle,At=pt.width,pt.reverse&&(yt=ut,ut=ht,ht=yt,mt=-mt),dt.updateDataArray=function(){var bt,xt,vt,_t=0,Ct=ut.Dist(ht),St=Math.cos(mt),Et=Math.sin(mt),Tt=(ht.X()-ut.X())/Ct,Mt=(ht.Y()-ut.Y())/Ct;for(St*=At/Math.abs(Et),Et*=At/Math.abs(Et),this.dataX=[],this.dataY=[];_t<Ct;)bt=ut.X()+Tt*_t,xt=ut.Y()+Mt*_t,vt=Math.min(St,Ct-_t)/Math.abs(St),Et*=vt,St*=vt,this.dataX.push(bt),this.dataY.push(xt),this.dataX.push(bt+Tt*St+Mt*Et),this.dataY.push(xt-Tt*Et+Mt*St),this.dataX.push(NaN),this.dataY.push(NaN),_t+=gt},dt},tt.registerElement("comb",tt.createComb),{createComb:tt.createComb}}),define("element/slopetriangle",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point","base/element"],function(tt,_e,rt,it,nt,st,at,lt){var ot={removeSlopeTriangle:function(){st.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},Value:function(){return this.tangent.getSlope()}};return tt.createSlopeTriangle=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt=!1;if(ut.length===1&&ut[0].type===it.OBJECT_TYPE_TANGENT)pt=ut[0],ft=pt.glider;else if(ut.length===1&&ut[0].type===it.OBJECT_TYPE_GLIDER)ft=ut[0],xt=rt.copyAttributes(ht,ct.options,"slopetriangle","tangent"),pt=ct.create("tangent",[ft],xt),vt=!0;else{if(ut.length!==2||ut[0].elementClass!==it.OBJECT_CLASS_LINE||!rt.isPoint(ut[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof ut[0]+"'.");pt=ut[0],ft=ut[1]}return xt=rt.copyAttributes(ht,ct.options,"slopetriangle","basepoint"),yt=ct.create("point",[function(){return[ft.X()+1,ft.Y()]}],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","baseline"),At=ct.create("line",[ft,yt],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","glider"),gt=ct.create("glider",[ft.X()+1,ft.Y(),At],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","toppoint"),mt=ct.create("point",[function(){return[gt.X(),gt.Y()+(gt.X()-ft.X())*pt.getSlope()]}],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle"),xt.borders=rt.copyAttributes(xt.borders,ct.options,"slopetriangle","borders"),dt=ct.create("polygon",[ft,gt,mt],xt),dt.Value=ot.Value,dt.tangent=pt,dt._isPrivateTangent=vt,dt.borders[2].setArrow(!1,!1),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","label"),bt=ct.create("text",[function(){return gt.X()+.1},function(){return .5*(gt.Y()+mt.Y())},function(){return""}],xt),bt._setText(function(){return rt.toFixed(dt.Value(),rt.evaluate(bt.visProp.digits))}),bt.fullUpdate(),dt.glider=gt,dt.basepoint=yt,dt.baseline=At,dt.toppoint=mt,dt.label=bt,dt.subs={glider:gt,basePoint:yt,baseLine:At,topPoint:mt,label:bt},dt.inherits.push(gt,yt,At,mt,bt),dt.methodMap=tt.deepCopy(dt.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),dt.remove=ot.removeSlopeTriangle,dt},tt.registerElement("slopetriangle",tt.createSlopeTriangle),{createSlopeTriangle:tt.createSlopeTriangle}}),define("element/checkbox",["jxg","utils/env","utils/type"],function(tt,_e,rt){var it={CheckboxChangeEventHandler:function(){this._value=this.rendNodeCheckbox.checked,this.board.update()}};return tt.createCheckbox=function(nt,st,at){var lt,ot,ct=rt.copyAttributes(at,nt.options,"checkbox");return ot=[st[0],st[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],lt=nt.create("text",ot,ct),lt.type=rt.OBJECT_TYPE_CHECKBOX,lt.rendNodeCheckbox=lt.rendNode.childNodes[0].childNodes[0],lt.rendNodeLabel=lt.rendNode.childNodes[0].childNodes[1],lt.rendNodeTag=lt.rendNodeCheckbox,lt.rendNodeTag.disabled=!!ct.disabled,lt.rendNodeLabel.innerHTML=st[2],lt.rendNodeCheckbox.id=lt.rendNode.id+"_checkbox",lt.rendNodeLabel.id=lt.rendNode.id+"_label",lt.rendNodeLabel.setAttribute("for",lt.rendNodeCheckbox.id),lt.visPropOld.fontsize="0px",nt.renderer.updateTextStyle(lt,!1),lt.rendNodeCheckbox.checked=ct.checked,lt._value=ct.checked,lt.Value=function(){return this._value},lt.update=function(){return this.needsUpdate&&(tt.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},_e.addEvent(lt.rendNodeCheckbox,"change",it.CheckboxChangeEventHandler,lt),lt},tt.registerElement("checkbox",tt.createCheckbox),{createCheckbox:tt.createCheckbox}}),define("element/input",["jxg","utils/env","utils/type"],function(tt,_e,rt){var it={InputInputEventHandler:function(nt){this._value=this.rendNodeInput.value,this.board.update()}};return tt.createInput=function(nt,st,at){var lt,ot,ct=rt.copyAttributes(at,nt.options,"input");return ot=[st[0],st[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+ct.maxlength+'" style="width:100%"/></span>'],lt=nt.create("text",ot,ct),lt.type=rt.OBJECT_TYPE_INPUT,lt.rendNodeLabel=lt.rendNode.childNodes[0].childNodes[0],lt.rendNodeInput=lt.rendNode.childNodes[0].childNodes[1],lt.rendNodeLabel.innerHTML=st[3],lt.rendNodeInput.value=st[2],lt.rendNodeTag=lt.rendNodeInput,lt.rendNodeTag.disabled=!!ct.disabled,lt.rendNodeLabel.id=lt.rendNode.id+"_label",lt.rendNodeInput.id=lt.rendNode.id+"_input",lt._value=st[2],lt.update=function(){return this.needsUpdate&&(tt.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},lt.Value=function(){return this._value},_e.addEvent(lt.rendNodeInput,"input",it.InputInputEventHandler,lt),_e.addEvent(lt.rendNodeInput,"mousedown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeInput,"touchstart",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeInput,"pointerdown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),lt.visPropOld.fontsize="0px",nt.renderer.updateTextStyle(lt,!1),lt},tt.registerElement("input",tt.createInput),{createInput:tt.createInput}}),define("element/button",["jxg","utils/env","utils/type"],function(tt,_e,rt){var it={ButtonClickEventHandler:function(){this._handler&&this._handler(),this.board.update()}};return tt.createButton=function(nt,st,at){var lt,ot,ct=rt.copyAttributes(at,nt.options,"button");return ot=[st[0],st[1],'<button type="button" style="width:100%;"></button>'],lt=nt.create("text",ot,ct),lt.type=rt.OBJECT_TYPE_BUTTON,lt.rendNodeButton=lt.rendNode.childNodes[0],lt.rendNodeButton.id=lt.rendNode.id+"_button",lt.rendNodeButton.innerHTML=st[2],lt.rendNodeTag=lt.rendNodeButton,lt.rendNodeTag.disabled=!!ct.disabled,lt.visPropOld.fontsize="0px",nt.renderer.updateTextStyle(lt,!1),st[3]&&(rt.isString(st[3])?(lt._jc=new tt.JessieCode,lt._jc.use(nt),lt._handler=function(){lt._jc.parse(st[3])}):lt._handler=st[3]),_e.addEvent(lt.rendNodeButton,"click",it.ButtonClickEventHandler,lt),_e.addEvent(lt.rendNodeButton,"mousedown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeButton,"touchstart",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeButton,"pointerdown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),lt},tt.registerElement("button",tt.createButton),{createButton:tt.createButton}}),define("../build/core.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/qdt","math/numerics","math/statistics","math/symbolic","math/geometry","math/poly","math/complex","renderer/abstract","renderer/no","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","parser/datasource","parser/jessiecode","parser/ca","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button"],function(tt,_e){return _e.isBrowser?window.JXG=tt:_e.isNode()?module.exports=tt:_e.isWebWorker()&&(self.JXG=tt),tt}),require("../build/core.deps.js")})});jsxgraphcore$1.parser;jsxgraphcore$1.Parser;jsxgraphcore$1.parse;jsxgraphcore$1.main;var classCallCheck=function(tt,_e){if(!(tt instanceof _e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function tt(_e,rt){for(var it=0;it<rt.length;it++){var nt=rt[it];nt.enumerable=nt.enumerable||!1,nt.configurable=!0,"value"in nt&&(nt.writable=!0),Object.defineProperty(_e,nt.key,nt)}}return function(_e,rt,it){return rt&&tt(_e.prototype,rt),it&&tt(_e,it),_e}}(),inherits=function(tt,_e){if(typeof _e!="function"&&_e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _e);tt.prototype=Object.create(_e&&_e.prototype,{constructor:{value:tt,enumerable:!1,writable:!0,configurable:!0}}),_e&&(Object.setPrototypeOf?Object.setPrototypeOf(tt,_e):tt.__proto__=_e)},possibleConstructorReturn=function(tt,_e){if(!tt)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _e&&(typeof _e=="object"||typeof _e=="function")?_e:tt},JXGBoard=function(tt){inherits(_e,tt);function _e(rt){classCallCheck(this,_e);var it=possibleConstructorReturn(this,(_e.__proto__||Object.getPrototypeOf(_e)).call(this,rt));return it.id="board_"+Math.random().toString(36).substr(2,9),it.state={board:null},it.defaultStyle={width:500,height:500},it.defauflboardAttributes={},it}return createClass(_e,[{key:"getChildContext",value:function(){return{board:this.state.board}}},{key:"componentDidMount",value:function(){var it={};Object.assign(it,this.defauflboardAttributes,this.props.boardAttributes||{});var nt=jsxgraphcore$1.JSXGraph.initBoard(this.id,it);this.props.jessieCode?nt.jc.parse(this.props.logic):this.props.logic(nt),this.setState({board:nt})}},{key:"render",value:function(){var it=assign_1(this.defaultStyle,this.props.style||{});return React.createElement("div",{id:this.id,className:"jxgbox "+this.props.className,style:it})}}]),_e}(reactExports.Component);JXGBoard.propTypes={style:PropTypes.object,className:PropTypes.string,logic:PropTypes.oneOfType([PropTypes.func,PropTypes.string]).isRequired,boardAttributes:PropTypes.object,jessieCode:PropTypes.bool};var logicJS$w=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[3,8],[7,8],[1,9,9]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[-7,-5],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),it=tt.create("point",[7,-5],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),nt=tt.create("point",[-2,5],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),st=tt.create("polygon",[rt,it,nt],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:4,size:4,fillColor:"#B66C46",highlightFillColor:"#B66C46"}),at=tt.create("segment",[rt,it],{name:"",withLabel:!0,visible:!0,strokeColor:"#B66C46",highlightStrokeColor:"#B66C46",strokeWidth:2,size:3,fillColor:"#B66C46",highlightFillColor:"#B66C46"}),lt=tt.create("segment",[rt,nt],{name:"",withLabel:!0,visible:!0,strokeColor:"#B66C46",highlightStrokeColor:"#B66C46",strokeWidth:2,size:3,fillColor:"#B66C46",highlightFillColor:"#B66C46"}),ot=tt.create("segment",[it,nt],{name:"",withLabel:!0,visible:!0,strokeColor:"#B66C46",highlightStrokeColor:"#B66C46",strokeWidth:2,size:3,fillColor:"#B66C46",highlightFillColor:"#B66C46"}),ct=tt.create("midpoint",[rt,it],{name:"D",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),ut=tt.create("midpoint",[rt,nt],{name:"E",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),ht=tt.create("line",[it,ut],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),dt=tt.create("line",[nt,ct],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),pt=tt.create("intersection",[ht,dt,0],{name:"F",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"});_e.on("drag",function(){var ft=_e.Value();rt.setAttribute({visible:!1}),it.setAttribute({visible:!1}),nt.setAttribute({visible:!1}),at.setAttribute({visible:!1}),lt.setAttribute({visible:!1}),ot.setAttribute({visible:!1}),st.setAttribute({visible:!1}),ct.setAttribute({visible:!1}),ut.setAttribute({visible:!1}),ht.setAttribute({visible:!1}),dt.setAttribute({visible:!1}),pt.setAttribute({visible:!1}),ft>=1&&rt.setAttribute({visible:!0}),ft>=2&&it.setAttribute({visible:!0}),ft>=3&&nt.setAttribute({visible:!0}),ft>=4&&(st.setAttribute({visible:!0}),lt.setAttribute({visible:!0}),at.setAttribute({visible:!0}),ot.setAttribute({visible:!0})),ft>=5&&ct.setAttribute({visible:!0}),ft>=6&&ut.setAttribute({visible:!0}),ft>=7&&ht.setAttribute({visible:!0}),ft>=8&&dt.setAttribute({visible:!0}),ft>=9&&pt.setAttribute({visible:!0})}),tt.unsuspendUpdate()};let JSXGraphComponent$w=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("script",{src:"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"무게중심 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$w,boardAttributes:{boundingBox:[-10,10,10,-10],axis:!1,grid:!1,snapToGrid:!1},style:{border:"1px solid black"}})]})}};var logicJS$v=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[3,8],[7,8],[1,8,8]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[-7,-3],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),it=tt.create("point",[7,-5],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),nt=tt.create("point",[-2,7],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),st=tt.create("polygon",[nt,it,rt],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:4,size:4,fillColor:"#B66C46",highlightFillColor:"#B66C46"}),at=tt.create("segment",[nt,it],{name:"",withLabel:!0,visible:!0,strokeColor:"#B66C46",highlightStrokeColor:"#B66C46",strokeWidth:2,size:3,fillColor:"#B66C46",highlightFillColor:"#B66C46"}),lt=tt.create("segment",[nt,rt],{name:"",withLabel:!0,visible:!0,strokeColor:"#B66C46",highlightStrokeColor:"#B66C46",strokeWidth:2,size:3,fillColor:"#B66C46",highlightFillColor:"#B66C46"}),ot=tt.create("segment",[it,rt],{name:"",withLabel:!0,visible:!0,strokeColor:"#B66C46",highlightStrokeColor:"#B66C46",strokeWidth:2,size:3,fillColor:"#B66C46",highlightFillColor:"#B66C46"}),ct=tt.create("midpoint",[nt,it],{name:"D",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),ut=tt.create("midpoint",[it,rt],{name:"E",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),ht=tt.create("perpendicular",[at,ct],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),dt=tt.create("perpendicular",[ot,ut],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),pt=tt.create("intersection",[ht,dt,0],{name:"F",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3,fillColor:"black",highlightFillColor:"black"}),ft=tt.create("circle",[pt,nt],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:3});_e.on("drag",function(){var gt=_e.Value();nt.setAttribute({visible:!1}),it.setAttribute({visible:!1}),rt.setAttribute({visible:!1}),at.setAttribute({visible:!1}),lt.setAttribute({visible:!1}),ot.setAttribute({visible:!1}),st.setAttribute({visible:!1}),ct.setAttribute({visible:!1}),ut.setAttribute({visible:!1}),ht.setAttribute({visible:!1}),dt.setAttribute({visible:!1}),pt.setAttribute({visible:!1}),ft.setAttribute({visible:!1}),gt>=1&&nt.setAttribute({visible:!0}),gt>=2&&it.setAttribute({visible:!0}),gt>=3&&rt.setAttribute({visible:!0}),gt>=4?(st.setAttribute({visible:!0}),lt.setAttribute({visible:!0}),at.setAttribute({visible:!0}),ot.setAttribute({visible:!0})):(at.setAttribute({visible:!1}),lt.setAttribute({visible:!1}),ot.setAttribute({visible:!1})),gt>=5&&ht.setAttribute({visible:!0}),gt>=6&&dt.setAttribute({visible:!0}),gt>=7&&pt.setAttribute({visible:!0}),gt>=8&&ft.setAttribute({visible:!0})}),tt.unsuspendUpdate()};let JSXGraphComponent$v=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("script",{src:"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"외심 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$v,boardAttributes:{boundingBox:[-10,10,10,-10],axis:!1,grid:!1,snapToGrid:!0},style:{border:"1px solid black"}})]})}},logicJS$u=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[3,8],[7,8],[0,6,6]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[0,0],{withLabel:!1,size:7,fillColor:"white",strokeColor:"black",strokeWidth:1}),it=tt.create("point",[4,0],{withLabel:!1,size:7,fillColor:"white",strokeColor:"black",strokeWidth:1}),nt=tt.create("segment",[rt,it],{withLabel:!1,strokeColor:"#6600CC",strokeWidth:3,name:"c",visible:!0}),st=tt.create("circle",[rt,it],{withLabel:!1,visible:!0}),at=tt.create("circle",[it,rt],{withLabel:!1,strokeColor:"blue",visible:!0}),lt=tt.create("intersection",[st,at,1],{withLabel:!1,visible:!0,size:5,fillColor:"white",strokeColor:"black",strokeWidth:1}),ot=tt.create("segment",[rt,lt],{strokeColor:"#6600CC",strokeWidth:3,name:"a",visible:!0}),ct=tt.create("segment",[it,lt],{strokeColor:"#6600CC",strokeWidth:3,name:"b",visible:!0}),ut=tt.create("polygon",[rt,it,lt],{fillColor:"#D0F0C0",fillOpacity:.3,strokeColor:"#6600CC",strokeWidth:3,visible:!0});_e.on("drag",function(){var ht=_e.Value();nt.setAttribute({visible:!1}),st.setAttribute({visible:!1}),at.setAttribute({visible:!1}),lt.setAttribute({visible:!1}),ot.setAttribute({visible:!1}),ct.setAttribute({visible:!1}),ht>=1?nt.setAttribute({visible:!0}):nt.setAttribute({visible:!1}),ht>=2?st.setAttribute({visible:!0}):st.setAttribute({visible:!1}),ht>=3?at.setAttribute({visible:!0}):at.setAttribute({visible:!1}),ht>=4?lt.setAttribute({visible:!0}):lt.setAttribute({visible:!1}),ht>=5?ot.setAttribute({visible:!0}):ot.setAttribute({visible:!1}),ht>=6?(ct.setAttribute({visible:!0}),ut.setAttribute({visible:!0})):(ct.setAttribute({visible:!1}),ut.setAttribute({visible:!1}))}),tt.unsuspendUpdate()},JSXGraphComponent$u=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"정삼각형 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$u,boardAttributes:{axis:!0,boundingbox:[-10,10,10,-10]},style:{border:"3px solid red"}})]})}},logicJS$t=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-7,8],[-3,8],[0,10,10]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[-9,-5],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),it=tt.create("point",[2,5],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),Tt=tt.create("point",[8,-5],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),nt=tt.create("segment",[rt,it],{strokeColor:"black",strokeWidth:3}),st=tt.create("segment",[it,Tt],{strokeColor:"black",strokeWidth:3}),at=tt.create("segment",[Tt,rt],{strokeColor:"black",strokeWidth:3}),lt=tt.create("bisector",[rt,it,Tt],{name:"bABC",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1}),ot=tt.create("bisector",[Tt,rt,it],{name:"bCAB",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1}),ct=tt.create("intersection",[lt,ot,0],{name:"F",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),ut=tt.create("angle",[rt,it,ct],{name:"&beta;",radius:2,fillColor:"blue",strokeColor:"blue",strokeWidth:2}),ht=tt.create("angle",[ct,it,Tt],{name:"&beta;",radius:2,fillColor:"blue",strokeColor:"blue",strokeWidth:2}),dt=tt.create("angle",[ct,rt,it],{name:"&alpha;",radius:2,fillColor:"red",strokeColor:"red",strokeWidth:2}),pt=tt.create("angle",[Tt,rt,ct],{name:"&alpha;",radius:2,fillColor:"red",strokeColor:"red",strokeWidth:2}),ft=tt.create("perpendicularsegment",[nt,ct]),gt=tt.create("hatch",[ft,2]),mt=tt.create("perpendicularsegment",[st,ct]),At=tt.create("hatch",[mt,2]),yt=tt.create("perpendicularsegment",[at,ct]),bt=tt.create("hatch",[yt,2]),xt=tt.create("intersection",[ft,nt,0],{name:"G",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),vt=tt.create("intersection",[mt,st,0],{name:"H",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),_t=tt.create("intersection",[yt,at,0],{name:"I",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),Ct=tt.create("angle",[ct,xt,it],{radius:1,name:" "}),St=tt.create("angle",[it,vt,ct],{radius:1,name:" "}),Et=tt.create("angle",[Tt,_t,ct],{radius:1,name:" "}),Tt=tt.create("circle",[ct,ft],{strokeColor:"#0099FF",strokeWidth:3});_e.on("drag",function(){var Mt=_e.Value();lt.setAttribute({visible:!1}),ot.setAttribute({visible:!1}),ut.setAttribute({visible:!1}),ht.setAttribute({visible:!1}),dt.setAttribute({visible:!1}),pt.setAttribute({visible:!1}),ct.setAttribute({visible:!1}),ft.setAttribute({visible:!1}),xt.setAttribute({visible:!1}),Ct.setAttribute({visible:!1}),Tt.setAttribute({visible:!1}),mt.setAttribute({visible:!1}),vt.setAttribute({visible:!1}),St.setAttribute({visible:!1}),yt.setAttribute({visible:!1}),_t.setAttribute({visible:!1}),Et.setAttribute({visible:!1}),gt.setAttribute({visible:!1}),At.setAttribute({visible:!1}),bt.setAttribute({visible:!1}),Mt>=1&&lt.setAttribute({visible:!0}),Mt>=2&&(ut.setAttribute({visible:!0}),ht.setAttribute({visible:!0})),Mt>=3&&ot.setAttribute({visible:!0}),Mt>=4&&(dt.setAttribute({visible:!0}),pt.setAttribute({visible:!0})),Mt>=5&&ct.setAttribute({visible:!0}),Mt>=6&&ft.setAttribute({visible:!0}),Mt>=7&&xt.setAttribute({visible:!0}),Mt>=8&&Ct.setAttribute({visible:!0}),Mt>=9&&Tt.setAttribute({visible:!0}),Mt>=10&&(mt.setAttribute({visible:!0}),vt.setAttribute({visible:!0}),St.setAttribute({visible:!0}),yt.setAttribute({visible:!0}),_t.setAttribute({visible:!0}),Et.setAttribute({visible:!0}),gt.setAttribute({visible:!0}),At.setAttribute({visible:!0}),bt.setAttribute({visible:!0}))}),tt.unsuspendUpdate()},JSXGraphComponent$t=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("script",{src:"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각형의 내심과 내접원의 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$t,boardAttributes:{boundingBox:[-10,10,10,-10],axis:!1,grid:!1,snapToGrid:!0},style:{border:"1px solid black"}})]})}};function degrees_to_radians$3(tt){var _e=Math.PI;return tt*(_e/180)}let logicJS$s=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-6,5],[-2.5,5],[0,325,360]],{name:"&theta;",snapWidth:1,fillColor:"white",strokeColor:"green",postLabel:"°",precision:0,label:{fontSize:18,strokeColor:"red",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"green",strokeWidth:1},highline:{strokeColor:"green",strokeWidth:3}});tt.create("functiongraph",[function(pt){return 2*Math.sin(pt)},-10,10],{strokeColor:"green",strokeWidth:2});var rt=tt.create("point",[-5,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:0,fixed:!0}),it=tt.create("point",[-3,0],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2,fixed:!0}),nt=tt.create("point",[-1,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),st=tt.create("line",[rt,it],{strokeColor:"black",strokeWidth:0});tt.create("segment",[it,nt],{strokeColor:"black",strokeWidth:2}),tt.create("point",[0,0],{name:"O",withLabel:!0,visible:!0,color:"gray",strokeColor:"black",strokeWidth:1,size:2,fixed:!0});var at=tt.create("point",[-1,0],{name:"",withLabel:!0,visible:!1,color:"gray",strokeColor:"black",strokeWidth:1,size:2,fixed:!0}),lt=tt.create("angle",[at,it,nt],{radius:.5,strokeWidth:1,color:"green",name:function(){return _e.Value()+"°"}});lt.setAngle(function(){return degrees_to_radians$3(_e.Value())}),tt.update(),tt.create("circle",[it,2],{strokeColor:"#0099FF",strokeWidth:3});var ot=tt.create("point",[function(){return degrees_to_radians$3(_e.Value())},function(){return 2*Math.sin(degrees_to_radians$3(_e.Value()))}],{name:"P",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3}),ct=tt.create("perpendicular",[st,nt],{strokeColor:"red",strokeWidth:0}),ut=tt.create("intersection",[ct,st,0],{name:"B",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:0});tt.create("segment",[nt,ut],{strokeColor:"red",strokeWidth:2});var ht=tt.create("perpendicular",[st,ot],{strokeColor:"red",strokeWidth:0}),dt=tt.create("intersection",[ht,st,0],{name:"C",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:0});tt.create("segment",[ot,dt],{strokeColor:"red",strokeWidth:2}),tt.create("segment",[ot,nt],{strokeColor:"blue",dash:2,strokeWidth:1}),tt.unsuspendUpdate()},JSXGraphComponent$s=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각함수 사인함수"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$s,boardAttributes:{boundingBox:[-7,7,7,-7],axis:!0},style:{border:"3px solid blue"}})]})}};function degrees_to_radians$2(tt){var _e=Math.PI;return tt*(_e/180)}let logicJS$r=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-6,5],[-2.5,5],[0,325,360]],{name:"&theta;",snapWidth:1,fillColor:"white",strokeColor:"green",postLabel:"°",precision:0,label:{fontSize:18,strokeColor:"red",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"green",strokeWidth:1},highline:{strokeColor:"green",strokeWidth:3}});tt.create("functiongraph",[function(pt){return 2*Math.cos(pt)},-10,10],{strokeColor:"green",strokeWidth:2});var rt=tt.create("point",[-5,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:0,fixed:!0}),it=tt.create("point",[-3,0],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2,fixed:!0}),nt=tt.create("point",[-1,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),st=tt.create("line",[rt,it],{strokeColor:"black",strokeWidth:0});tt.create("segment",[it,nt],{strokeColor:"black",strokeWidth:2}),tt.create("point",[0,0],{name:"O",withLabel:!0,visible:!0,color:"gray",strokeColor:"black",strokeWidth:1,size:2,fixed:!0});var at=tt.create("point",[-1,0],{name:"",withLabel:!0,visible:!1,color:"gray",strokeColor:"black",strokeWidth:1,size:2,fixed:!0}),lt=tt.create("angle",[at,it,nt],{radius:.5,strokeWidth:1,color:"green",name:function(){return _e.Value()+"°"}});lt.setAngle(function(){return degrees_to_radians$2(_e.Value())}),tt.update(),tt.create("circle",[it,2],{strokeColor:"#0099FF",strokeWidth:3});var ot=tt.create("point",[function(){return degrees_to_radians$2(_e.Value())},function(){return 2*Math.cos(degrees_to_radians$2(_e.Value()))}],{name:function(){return Number(2*Math.cos(degrees_to_radians$2(_e.Value()))).toFixed(2)},withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:3}),ct=tt.create("perpendicular",[st,nt],{strokeColor:"red",strokeWidth:0}),ut=tt.create("intersection",[ct,st,0],{name:function(){return Number(2*Math.cos(degrees_to_radians$2(_e.Value()))).toFixed(2)},withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:0});tt.create("segment",[it,ut],{strokeColor:"red",strokeWidth:2});var ht=tt.create("perpendicular",[st,ot],{strokeColor:"red",strokeWidth:0}),dt=tt.create("intersection",[ht,st,0],{name:"C",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:0});tt.create("segment",[ot,dt],{strokeColor:"red",strokeWidth:2}),tt.unsuspendUpdate()},JSXGraphComponent$r=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각함수 코사인함수"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$r,boardAttributes:{boundingBox:[-7,7,7,-7],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$q=tt=>{tt.suspendUpdate();var _e=tt.unitX,rt=tt.unitY,it={headWidth:2,headLength:3,strokeWidth:5,indent:.1},nt=[],st=(gt,mt)=>{var At=[gt.X(),gt.Y()],yt=[mt.X(),mt.Y()],bt=[yt[0]-At[0],yt[1]-At[1]],xt=Math.sqrt(bt[0]*bt[0]*_e*_e+bt[1]*bt[1]*rt*rt),vt=it.headWidth*it.strokeWidth/xt,_t=it.headLength*it.strokeWidth/xt,Ct=[yt[0]-_t*bt[0],yt[1]-_t*bt[1]],St=[vt/2*_e*bt[0],vt/2*rt*bt[1]],Et=[Ct[0]+St[1]/_e,Ct[1]-St[0]/rt],Tt=[Ct[0]-St[1]/_e,Ct[1]+St[0]/rt],Mt=it.indent,Rt=[(1-Mt)*Ct[0]+Mt*yt[0],(1-Mt)*Ct[1]+Mt*yt[1]],It=[NaN,At[0],yt[0],Et[0],Rt[0],Tt[0],yt[0],NaN],Ot=[NaN,At[1],yt[1],Et[1],Rt[1],Tt[1],yt[1],NaN],Bt=tt.create("curve",[It,Ot],{strokeColor:"black",fillColor:"black",highlightStrokeColor:"black",highlightFillColor:"black",highlightStrokeWidth:1});nt.push(Bt)},at=tt.create("point",[-3,19],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:2}),lt=tt.create("point",[-22,-7],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:2}),ot=tt.create("point",[30,1],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:2});tt.create("polygon",[at,lt,ot],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:2,fillColor:"#B66C46",highlightFillColor:"#B66C46",borders:{strokeColor:"#B66C46",strokeWidth:2,highlightStrokeColor:"#B66C46",highlightStrokeWidth:2}});var ct=tt.create("midpoint",[lt,ot],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:0}),ut=tt.create("midpoint",[at,ot],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:0}),ht=tt.create("segment",[at,ct],{name:"",withLabel:!0,visible:!1,strokeColor:"black",strokeWidth:0,size:0}),dt=tt.create("segment",[lt,ut],{name:"",withLabel:!0,visible:!1,strokeColor:"black",strokeWidth:0,size:0}),pt=tt.create("intersection",[ht,dt,0],{name:"G",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:2}),ft=tt.create("point",[0,0],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:2,size:0,fixed:!0});st(ft,pt),st(ft,lt),st(ft,ot),st(ft,at),at.on("drag",function(){for(var gt=0;gt<nt.length;gt++)tt.removeObject(nt[gt]);st(ft,pt),st(ft,lt),st(ft,ot),st(ft,at)}),lt.on("drag",function(){for(var gt=0;gt<nt.length;gt++)tt.removeObject(nt[gt]);st(ft,pt),st(ft,lt),st(ft,ot),st(ft,at)}),ot.on("drag",function(){for(var gt=0;gt<nt.length;gt++)tt.removeObject(nt[gt]);st(ft,pt),st(ft,lt),st(ft,ot),st(ft,at)}),tt.unsuspendUpdate()},JSXGraphComponent$q=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"무게중심 (벡터)"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$q,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$p=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-30,30],[-10,30],[-10,2,10]],{name:"ratio",fillColor:"white",strokeColor:"green",postLabel:"",precision:0,label:{fontSize:18,strokeColor:"red",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"green",strokeWidth:1},highline:{strokeColor:"green",strokeWidth:3}}),rt=tt.create("point",[2,8],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),it=tt.create("point",[9,9],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),nt=tt.create("point",[11,3],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),st=tt.create("polygon",[rt,it,nt],{name:"",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:2}),at=tt.create("point",[0,0],{name:"O",withLabel:!0,visible:!0,strokeColor:"yellow",strokeWidth:1,size:3,fixed:!0});tt.create("segment",[rt,at],{strokeColor:"black",strokeWidth:1,dash:1}),tt.create("segment",[it,at],{strokeColor:"black",strokeWidth:1,dash:1}),tt.create("segment",[nt,at],{strokeColor:"black",strokeWidth:1,dash:1});var lt=tt.create("transform",[function(){return _e.Value()},function(){return _e.Value()}],{type:"scale"}),ot=tt.create("polygon",[st,lt],{vertices:{withLabel:!0,strokeColor:"blue",strokeWidth:1,size:2}});tt.create("segment",[ot.vertices[0],at],{strokeColor:"black",strokeWidth:1,dash:1}),tt.create("segment",[ot.vertices[1],at],{strokeColor:"black",strokeWidth:1,dash:1}),tt.create("segment",[ot.vertices[2],at],{strokeColor:"black",strokeWidth:1,dash:1}),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$p=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"Dilation"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$p,boardAttributes:{boundingBox:[-40,40,40,-40],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$o=tt=>{tt.suspendUpdate();var _e=[],rt=tt.unitX,it=tt.unitY,nt={headWidth:2,headLength:3,strokeWidth:5,indent:.1},st=(ht,dt,pt)=>{var ft=[ht.X(),ht.Y()],gt=[dt.X(),dt.Y()],mt=[gt[0]-ft[0],gt[1]-ft[1]],At=Math.sqrt(mt[0]*mt[0]*rt*rt+mt[1]*mt[1]*it*it),yt=nt.headWidth*nt.strokeWidth/At,bt=nt.headLength*nt.strokeWidth/At,xt=[gt[0]-bt*mt[0],gt[1]-bt*mt[1]],vt=[yt/2*rt*mt[0],yt/2*it*mt[1]],_t=[xt[0]+vt[1]/rt,xt[1]-vt[0]/it],Ct=[xt[0]-vt[1]/rt,xt[1]+vt[0]/it],St=nt.indent,Et=[(1-St)*xt[0]+St*gt[0],(1-St)*xt[1]+St*gt[1]],Tt=[NaN,ft[0],gt[0],_t[0],Et[0],Ct[0],gt[0],NaN],Mt=[NaN,ft[1],gt[1],_t[1],Et[1],Ct[1],gt[1],NaN],Rt=tt.create("curve",[Tt,Mt],{strokeWidth:2,strokeColor:pt,fillColor:pt,highlightStrokeColor:pt,highlightFillColor:pt,highlightStrokeWidth:2});_e.push(Rt)},at=tt.create("point",[0,0],{name:"A",withLabel:!0,visible:!0,fillColor:"gray",strokeColor:"#313132",strokeWidth:1,size:3,fixed:!0}),lt=tt.create("point",[6,12],{name:"B",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"#313132",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),ot=tt.create("point",[13,-3],{name:"C",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"#313132",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),ct=tt.create("point",[function(){return lt.X()+ot.X()},function(){return lt.Y()+ot.Y()}],{name:"D",withLabel:!0,fillColor:"blue",visible:!0,strokeColor:"#313132",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3});st(at,lt,"black"),st(at,ot,"black"),st(lt,ot,"blue"),st(at,ct,"red");var ut=()=>{for(var ht=0;ht<_e.length;ht++)tt.removeObject(_e[ht]);_e=[],st(at,lt,"black"),st(at,ot,"black"),st(lt,ot,"blue"),st(at,ct,"red")};at.on("drag",function(){ut()}),lt.on("drag",function(){ut()}),ot.on("drag",function(){ut()}),ct.on("drag",function(){ut()}),tt.unsuspendUpdate()},JSXGraphComponent$o=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"벡터의 덧셈과 뻴셈"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$o,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$n=tt=>{tt.suspendUpdate();var _e=tt.create("point",[-20,0],{name:"A",withLabel:!0,visible:!0,fillColor:"yellow",strokeColor:"black",strokeWidth:1,size:3,label:{color:"yellow"}}),rt=tt.create("point",[6,0],{name:"B",withLabel:!0,visible:!0,fillColor:"yellow",strokeColor:"black",highlightStrokeColor:"blue",label:{color:"yellow"},highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),it=tt.create("point",[13,-3],{name:"C",withLabel:!0,visible:!1,fillColor:"blue",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:0}),nt=tt.create("ellipse",[_e,rt,it],{name:"e",visible:!1,strokeColor:"#484848",strokeWidth:3,dash:2}),st=tt.create("glider",[9,10,nt],{name:"C",withLabel:!0,visible:!0,fillColor:"#00FFFF",strokeColor:"#00FFFF",highlightStrokeColor:"#00FFFF",highlightFillColor:"#00FFFF",highlightStrokeWidth:4,strokeWidth:1,trace:!0,label:{color:"yellow"},size:1,traceAttributes:{color:"blue",face:"o"}});tt.create("segment",[st,_e],{strokeColor:"yellow",strokeWidth:1}),tt.create("segment",[st,rt],{strokeColor:"yellow",strokeWidth:1}),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$n=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"타원 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$n,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"2px solid blue",backgroundColor:"#002201"}})]})}},logicJS$m=tt=>{tt.suspendUpdate();var _e=tt.create("point",[0,0],{name:"",withLabel:!0,visible:!0,size:0,fixed:!0}),rt=tt.create("point",[100,0],{name:"",visible:!0,fillColor:"blue",size:1,fixed:!0}),it=tt.create("segment",[_e,rt],{name:"",strokeColor:"black",strokeWidth:0,fixed:!0}),nt=tt.create("glider",[10,10,it],{name:"P",withLabel:!0,visible:!0,fillColor:"#00FFFF",strokeColor:"black",highlightStrokeColor:"#00FFFF",highlightFillColor:"#00FFFF",highlightStrokeWidth:4,strokeWidth:1,size:5}),st=tt.create("point",[0,0],{name:"",size:0,fixed:!0}),at=tt.create("point",[0,0],{name:"",size:0,fixed:!0}),lt=tt.create("parallelpoint",[nt,st,at],{name:"-P",withLabel:!0,visible:!0,fillColor:"#00FFFF",strokeColor:"black",highlightStrokeColor:"#00FFFF",highlightFillColor:"#00FFFF",highlightStrokeWidth:4,strokeWidth:1,size:5,fixed:!0}),ot=tt.create("perpendicular",[it,lt],{name:"",strokeColor:"black",strokeWidth:1}),ct=tt.create("glider",[-10,10,ot],{name:"A",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),ut=tt.create("parabola",[nt,ot],{name:"",strokeColor:"pink",strokeWidth:2}),ht=tt.create("perpendicular",[ot,ct],{name:"",strokeColor:"black",strokeWidth:0}),dt=tt.create("intersection",[ut,ht,0],{name:"C",withLabel:!0,visible:!0,fillColor:"red",strokeColor:"black",highlightStrokeColor:"red",highlightFillColor:"red",highlightStrokeWidth:4,strokeWidth:1,size:3}),pt=tt.create("segment",[nt,dt],{name:"",strokeColor:"green",strokeWidth:1});tt.create("hatch",[pt,2],{name:"",strokeColor:"green",strokeWidth:.5,ticksDistance:1});var ft=tt.create("segment",[ct,dt],{name:"",strokeColor:"green",strokeWidth:1});tt.create("hatch",[ft,2],{name:"",strokeColor:"green",strokeWidth:.5,ticksDistance:1}),tt.unsuspendUpdate()},JSXGraphComponent$m=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"실을 이용한 포물선 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$m,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$l=tt=>{tt.suspendUpdate();var _e=tt.create("point",[-25,5],{name:"A0",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),rt=tt.create("point",[15,-5],{name:"A1",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3});tt.create("arrow",[_e,rt],{strokeWidth:3,strokeOpacity:.7,strokeColor:"black",withLabel:!0,label:{offset:[120,-15]},name:'<span class="vecteur">a</span>'});var it=tt.create("point",[-30,-30],{name:"B0",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0}),nt=tt.create("point",["X(B0) + 5","Y(B0) + 15"],{name:"",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0});tt.create("arrow",[it,nt],{strokeWidth:3,strokeOpacity:.7,strokeColor:"black",withLabel:!0,label:{offset:[40,30]},name:'<span class="vecteur">b</span>'});var st=tt.create("button",[-35,15,"next",function(){var ot=tt.create("point",[_e.X(),_e.Y()],{face:"o",size:5,visible:!1,strokeColor:"red",fillOpacity:.3,strokeOpacity:.3});tt.create("arrow",[_e,ot],{strokeWidth:3,strokeOpacity:.7,strokeColor:"red",withLabel:!0,label:{offset:[120,40],strokeColor:"red"},name:'<span class="vecteur">a</span> <span class="plus"> + </span> <span class="vecteur">b</span>'}),setInterval(function(){ot.moveTo([nt.X(),nt.Y()],100)},50),st.setAttribute({disabled:!0})}],{disabled:!0}),at=tt.create("button",[-35,25,"start",function(){st.setAttribute({disabled:!1}),lt.setAttribute({disabled:!1}),setInterval(function(){it.moveTo([rt.X(),rt.Y()],100)},50),at.setAttribute({disabled:!0})}]),lt=tt.create("button",[-35,5,"reset",function(){lt.setAttribute({disabled:!0}),at.setAttribute({disabled:!1}),st.setAttribute({disabled:!0}),location.reload()}],{disabled:!0});tt.unsuspendUpdate()},JSXGraphComponent$l=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"벡터의 덧셈"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$l,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$k=tt=>{tt.suspendUpdate();var _e=tt.create("point",[-10,-25],{name:"A0",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3}),rt=tt.create("point",[30,-15],{name:"A1",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3});tt.create("arrow",[_e,rt],{strokeWidth:3,strokeOpacity:.7,strokeColor:"black",withLabel:!0,label:{offset:[120,-15]},name:'<span class="vecteur">a</span>'});var it=tt.create("point",[-20,-30],{name:"B0",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0}),nt=tt.create("point",["X(B0) - 10","Y(B0) + 20"],{name:"",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0}),st=tt.create("arrow",[it,nt],{strokeWidth:3,strokeOpacity:.7,strokeColor:"black",withLabel:!0,label:{offset:[50,-60]},name:'<span class="vecteur">b</span>'}),at=tt.create("point",[nt.X(),nt.Y()],{name:"",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0}),lt=tt.create("point",[it.X(),it.Y()],{name:"",withLabel:!0,visible:!1,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0}),ot=tt.create("arrow",[lt,at],{visible:!0,strokeWidth:3,strokeOpacity:.7,strokeColor:"black",withLabel:!0,label:{offset:[50,-60]},name:'<span class="vecteur">b</span>'}),ct=tt.create("button",[-35,15,"next",function(){var dt=tt.create("point",[nt.X(),nt.Y()],{face:"o",size:5,visible:!1,strokeColor:"red",fillOpacity:.3,strokeOpacity:.3});tt.create("arrow",[nt,dt],{strokeWidth:3,strokeOpacity:.7,strokeColor:"red",withLabel:!0,label:{offset:[120,0],strokeColor:"red"},name:'<span class="vecteur">a</span> <span class="plus"> - </span> <span class="vecteur">b</span>'}),setInterval(function(){dt.moveTo([rt.X(),rt.Y()],100)},50),ct.setAttribute({disabled:!0})}],{disabled:!0}),ut=tt.create("button",[-35,25,"start",function(){ct.setAttribute({disabled:!1}),ht.setAttribute({disabled:!1}),ot.setAttribute({visible:!0}),tt.removeObject(st),st=tt.create("arrow",[nt,it],{strokeWidth:3,strokeOpacity:.7,strokeColor:"blue",withLabel:!0,label:{offset:[50,-60],color:"blue"},name:'<span class="vecteur">b</span>'}),setInterval(function(){it.moveTo([_e.X(),_e.Y()],100),st.setAttribute({name:'<span class="vecteur">-b</span>'}),st.setAttribute({strokeColor:"blue"})},50),ut.setAttribute({disabled:!0})}]),ht=tt.create("button",[-35,5,"reset",function(){ht.setAttribute({disabled:!0}),ut.setAttribute({disabled:!1}),ct.setAttribute({disabled:!0}),location.reload()}],{disabled:!0});tt.unsuspendUpdate()},JSXGraphComponent$k=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"벡터의 뺄셈"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$k,boardAttributes:{boundingBox:[-38,38,38,-38],axis:!0},style:{border:"3px solid blue"}})]})}},logicJS$j=tt=>{tt.suspendUpdate();var _e=tt.create("point",[0,0],{name:"",withLabel:!0,visible:!0,fillColor:"gray",strokeColor:"black",highlightStrokeColor:"blue",highlightFillColor:"blue",highlightStrokeWidth:4,strokeWidth:1,size:3,fixed:!0}),rt=tt.create("point",[0,0],{name:"",withLabel:!0,visible:!0,fillColor:"yellow",strokeColor:"black",highlightStrokeColor:"black",highlightFillColor:"yellow",highlightStrokeWidth:2,strokeWidth:1,size:4,snapToGrid:!0});tt.create("arrow",[_e,rt],{strokeColor:"black",strokeWidth:5,lastArrow:!0,fixed:!0});var it=tt.create("point",[5,-3],{name:"",withLabel:!0,visible:!1}),nt=tt.create("text",[-8,8,'<span class="vecteur">a</span> <span class="plus">= ('+it.X()+", "+it.Y()+")</span>"],{fontSize:15,parse:!1});tt.create("button",[-8,6,"new",function(){var st=Math.floor(-5+Math.random()*11),at=Math.floor(-5+Math.random()*(5- -5+1));it.setPositionDirectly(JXG.COORDS_BY_USER,[st,at]),nt.setText('<span class="vecteur">a</span> <span class="plus">= ('+st+", "+at+")</span>")}],{cssStyle:"width: 80px; border: 2px solid #000000; color: #000000; border-radius: 10px; margin-top: 0px;"}),tt.create("button",[-8,4,"check",function(){rt.X()==it.X()&&rt.Y()==it.Y()?alert("정답입니다!!!"):alert("틀렸습니다. 다시 생각해 보세요.")}],{cssStyle:"width: 80px; border: 2px solid #000000; color: #000000; border-radius: 10px; margin-top: 0px;"}),tt.unsuspendUpdate()},JSXGraphComponent$j=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("script",{src:"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"성분이 주어진 벡터 나타내기_퀴즈"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$j,boardAttributes:{boundingBox:[-10,10,10,-10],axis:!0,grid:!0,snapToGrid:!0},style:{border:"3px solid blue"}})]})}},logicJS$i=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[3,8],[7,8],[0,14,14]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[-5,-5],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),it=tt.create("point",[9,-5],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:5}),nt=tt.create("segment",[rt,it],{strokeColor:"black",strokeWidth:2}),st=tt.create("point",[-2,-2],{name:"E",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:1,size:5}),at=tt.create("line",[rt,st],{strokeColor:"black",strokeWidth:1}),lt=tt.create("segment",[rt,st],{strokeColor:"green",strokeWidth:2}),ot=tt.create("circle",[rt,st],{strokeColor:"green",strokeWidth:2}),ct=tt.create("circle",[st,rt],{strokeColor:"green",strokeWidth:2}),ut=tt.create("intersection",[at,ct,0],{name:"F",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),ht=tt.create("circle",[ut,st],{strokeColor:"green",strokeWidth:2}),dt=tt.create("intersection",[at,ht,0],{name:"G",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),pt=tt.create("line",[dt,it],{strokeColor:"blue",strokeWidth:2}),ft=tt.create("parallel",[pt,ut],{strokeColor:"blue",strokeWidth:2}),gt=tt.create("intersection",[ft,nt,0],{name:"H",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),mt=tt.create("parallel",[pt,st],{strokeColor:"blue",strokeWidth:2}),At=tt.create("intersection",[mt,nt,0],{name:"I",withLabel:!0,visible:!0,strokeColor:"blue",strokeWidth:2,size:5}),yt=tt.create("segment",[rt,At],{strokeColor:"#149AF3",strokeWidth:2}),bt=tt.create("hatch",[yt,1],{strokeColor:"#149AF2",strokeWidth:2}),xt=tt.create("segment",[At,gt],{strokeColor:"#149AF2",strokeWidth:2}),vt=tt.create("hatch",[xt,1],{strokeColor:"#149AF2",strokeWidth:2}),_t=tt.create("segment",[gt,it],{strokeColor:"#149AF2",strokeWidth:2}),Ct=tt.create("hatch",[_t,1],{strokeColor:"#149AF2",strokeWidth:2});_e.on("drag",function(){var St=_e.Value();st.setAttribute({visible:!1}),at.setAttribute({visible:!1}),lt.setAttribute({visible:!1}),ot.setAttribute({visible:!1}),ct.setAttribute({visible:!1}),ut.setAttribute({visible:!1}),ht.setAttribute({visible:!1}),dt.setAttribute({visible:!1}),pt.setAttribute({visible:!1}),ft.setAttribute({visible:!1}),gt.setAttribute({visible:!1}),mt.setAttribute({visible:!1}),At.setAttribute({visible:!1}),yt.setAttribute({visible:!1}),bt.setAttribute({visible:!1}),xt.setAttribute({visible:!1}),vt.setAttribute({visible:!1}),_t.setAttribute({visible:!1}),Ct.setAttribute({visible:!1}),St>=1?at.setAttribute({visible:!0}):at.setAttribute({visible:!1}),St>=2?lt.setAttribute({visible:!0}):lt.setAttribute({visible:!1}),St>=3?ot.setAttribute({visible:!0}):ot.setAttribute({visible:!1}),St>=4?st.setAttribute({visible:!0}):st.setAttribute({visible:!1}),St>=5?ct.setAttribute({visible:!0}):ct.setAttribute({visible:!1}),St>=6?ut.setAttribute({visible:!0}):ut.setAttribute({visible:!1}),St>=7?ht.setAttribute({visible:!0}):ht.setAttribute({visible:!1}),St>=8?dt.setAttribute({visible:!0}):dt.setAttribute({visible:!1}),St>=9?pt.setAttribute({visible:!0}):pt.setAttribute({visible:!1}),St>=10?ft.setAttribute({visible:!0}):ft.setAttribute({visible:!1}),St>=11?gt.setAttribute({visible:!0}):gt.setAttribute({visible:!1}),St>=12?mt.setAttribute({visible:!0}):mt.setAttribute({visible:!1}),St>=13?At.setAttribute({visible:!0}):At.setAttribute({visible:!1}),St>=14?(yt.setAttribute({visible:!0}),bt.setAttribute({visible:!0}),xt.setAttribute({visible:!0}),vt.setAttribute({visible:!0}),_t.setAttribute({visible:!0}),Ct.setAttribute({visible:!0})):(yt.setAttribute({visible:!1}),bt.setAttribute({visible:!1}),xt.setAttribute({visible:!1}),vt.setAttribute({visible:!1}),_t.setAttribute({visible:!1}),Ct.setAttribute({visible:!1}))}),tt.unsuspendUpdate()},JSXGraphComponent$i=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("script",{src:"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"선분의 삼등분 점 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$i,boardAttributes:{boundingBox:[-10,10,10,-10],axis:!0,grid:!0,snapToGrid:!0},style:{border:"1px solid black"}})]})}};var jsxgraphcore={exports:{}},browser={},parseFont,hasRequiredParseFont;function requireParseFont(){if(hasRequiredParseFont)return parseFont;hasRequiredParseFont=1;const tt="bold|bolder|lighter|[1-9]00",_e="italic|oblique",rt="small-caps",it="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",nt="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",st=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,at=new RegExp(`(${tt}) +`,"i"),lt=new RegExp(`(${_e}) +`,"i"),ot=new RegExp(`(${rt}) +`,"i"),ct=new RegExp(`(${it}) +`,"i"),ut=new RegExp(`([\\d\\.]+)(${nt}) *((?:${st})( *, *(?:${st}))*)`),ht={},dt=16;return parseFont=pt=>{if(ht[pt])return ht[pt];const ft=ut.exec(pt);if(!ft)return;const gt={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(ft[1]),unit:ft[2],family:ft[3].replace(/["']/g,"").replace(/ *, */g,",")};let mt,At,yt,bt;const xt=pt.substring(0,ft.index);switch((mt=at.exec(xt))&&(gt.weight=mt[1]),(At=lt.exec(xt))&&(gt.style=At[1]),(yt=ot.exec(xt))&&(gt.variant=yt[1]),(bt=ct.exec(xt))&&(gt.stretch=bt[1]),gt.unit){case"pt":gt.size/=.75;break;case"pc":gt.size*=16;break;case"in":gt.size*=96;break;case"cm":gt.size*=96/2.54;break;case"mm":gt.size*=96/25.4;break;case"%":break;case"em":case"rem":gt.size*=dt/.75;break;case"q":gt.size*=96/25.4/4;break}return ht[pt]=gt},parseFont}var hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser;hasRequiredBrowser=1;const tt=requireParseFont();return browser.parseFont=tt,browser.createCanvas=function(_e,rt){return Object.assign(document.createElement("canvas"),{width:_e,height:rt})},browser.createImageData=function(_e,rt,it){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(_e);case 2:return new ImageData(_e,rt);default:return new ImageData(_e,rt,it)}},browser.loadImage=function(_e,rt){return new Promise(function(it,nt){const st=Object.assign(document.createElement("img"),rt);function at(){st.onload=null,st.onerror=null}st.onload=function(){at(),it(st)},st.onerror=function(){at(),nt(new Error('Failed to load the image "'+_e+'"'))},st.src=_e})},browser}jsxgraphcore.exports;(function(module,exports){(function(tt,_e){module.exports?module.exports=_e():tt.returnExports=_e()})(commonjsGlobal$1,function(){var requirejs,require,define;return function(tt){function _e(vt,_t){return yt.call(vt,_t)}function rt(vt,_t){var Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft=_t&&_t.split("/"),Ut=mt.map,$t=Ut&&Ut["*"]||{};if(vt){for(vt=vt.split("/"),Mt=vt.length-1,mt.nodeIdCompat&&xt.test(vt[Mt])&&(vt[Mt]=vt[Mt].replace(xt,"")),vt[0].charAt(0)==="."&&Ft&&(Dt=Ft.slice(0,Ft.length-1),vt=Dt.concat(vt)),Bt=0;Bt<vt.length;Bt++)if((zt=vt[Bt])===".")vt.splice(Bt,1),Bt-=1;else if(zt===".."){if(Bt===0||Bt===1&&vt[2]===".."||vt[Bt-1]==="..")continue;Bt>0&&(vt.splice(Bt-1,2),Bt-=2)}vt=vt.join("/")}if((Ft||$t)&&Ut){for(Ct=vt.split("/"),Bt=Ct.length;Bt>0;Bt-=1){if(St=Ct.slice(0,Bt).join("/"),Ft){for(Nt=Ft.length;Nt>0;Nt-=1)if((Et=Ut[Ft.slice(0,Nt).join("/")])&&(Et=Et[St])){Tt=Et,Rt=Bt;break}}if(Tt)break;!It&&$t&&$t[St]&&(It=$t[St],Ot=Bt)}!Tt&&It&&(Tt=It,Rt=Ot),Tt&&(Ct.splice(0,Rt,Tt),vt=Ct.join("/"))}return vt}function it(vt,_t){return function(){var Ct=bt.call(arguments,0);return typeof Ct[0]!="string"&&Ct.length===1&&Ct.push(null),ht.apply(tt,Ct.concat([vt,_t]))}}function nt(vt){return function(_t){return rt(_t,vt)}}function st(vt){return function(_t){ft[vt]=_t}}function at(vt){if(_e(gt,vt)){var _t=gt[vt];delete gt[vt],At[vt]=!0,ut.apply(tt,_t)}if(!_e(ft,vt)&&!_e(At,vt))throw new Error("No "+vt);return ft[vt]}function lt(vt){var _t,Ct=vt?vt.indexOf("!"):-1;return Ct>-1&&(_t=vt.substring(0,Ct),vt=vt.substring(Ct+1,vt.length)),[_t,vt]}function ot(vt){return vt?lt(vt):[]}function ct(vt){return function(){return mt&&mt.config&&mt.config[vt]||{}}}var ut,ht,dt,pt,ft={},gt={},mt={},At={},yt=Object.prototype.hasOwnProperty,bt=[].slice,xt=/\.js$/;dt=function(vt,_t){var Ct,St=lt(vt),Et=St[0],Tt=_t[1];return vt=St[1],Et&&(Et=rt(Et,Tt),Ct=at(Et)),Et?vt=Ct&&Ct.normalize?Ct.normalize(vt,nt(Tt)):rt(vt,Tt):(vt=rt(vt,Tt),St=lt(vt),Et=St[0],vt=St[1],Et&&(Ct=at(Et))),{f:Et?Et+"!"+vt:vt,n:vt,pr:Et,p:Ct}},pt={require:function(vt){return it(vt)},exports:function(vt){var _t=ft[vt];return _t!==void 0?_t:ft[vt]={}},module:function(vt){return{id:vt,uri:"",exports:ft[vt],config:ct(vt)}}},ut=function(vt,_t,Ct,St){var Et,Tt,Mt,Rt,It,Ot,Bt,Nt=[],zt=typeof Ct;if(St=St||vt,Ot=ot(St),zt==="undefined"||zt==="function"){for(_t=!_t.length&&Ct.length?["require","exports","module"]:_t,It=0;It<_t.length;It+=1)if(Rt=dt(_t[It],Ot),(Tt=Rt.f)==="require")Nt[It]=pt.require(vt);else if(Tt==="exports")Nt[It]=pt.exports(vt),Bt=!0;else if(Tt==="module")Et=Nt[It]=pt.module(vt);else if(_e(ft,Tt)||_e(gt,Tt)||_e(At,Tt))Nt[It]=at(Tt);else{if(!Rt.p)throw new Error(vt+" missing "+Tt);Rt.p.load(Rt.n,it(St,!0),st(Tt),{}),Nt[It]=ft[Tt]}Mt=Ct?Ct.apply(ft[vt],Nt):void 0,vt&&(Et&&Et.exports!==tt&&Et.exports!==ft[vt]?ft[vt]=Et.exports:Mt===tt&&Bt||(ft[vt]=Mt))}else vt&&(ft[vt]=Ct)},requirejs=require=ht=function(vt,_t,Ct,St,Et){if(typeof vt=="string")return pt[vt]?pt[vt](_t):at(dt(vt,ot(_t)).f);if(!vt.splice){if(mt=vt,mt.deps&&ht(mt.deps,mt.callback),!_t)return;_t.splice?(vt=_t,_t=Ct,Ct=null):vt=tt}return _t=_t||function(){},typeof Ct=="function"&&(Ct=St,St=Et),St?ut(tt,vt,_t,Ct):setTimeout(function(){ut(tt,vt,_t,Ct)},4),ht},ht.config=function(vt){return ht(vt)},requirejs._defined=ft,define=function(vt,_t,Ct){if(typeof vt!="string")throw new Error("See almond README: incorrect module build, no module name");_t.splice||(Ct=_t,_t=[]),_e(ft,vt)||_e(gt,vt)||(gt[vt]=[vt,_t,Ct])},define.amd={jQuery:!0}}(),define("../node_modules/almond/almond",function(){}),define("jxg",[],function(){var tt={};return typeof JXG!="object"||JXG.extend||(tt=JXG),tt.extend=function(_e,rt,it,nt){var st,at;it=it||!1,nt=nt||!1;for(st in rt)(!it||it&&rt.hasOwnProperty(st))&&(at=nt?st.toLowerCase():st,_e[at]=rt[st])},tt.extend(tt,{boards:{},readers:{},elements:{},registerElement:function(_e,rt){_e=_e.toLowerCase(),this.elements[_e]=rt},registerReader:function(_e,rt){var it,nt;for(it=0;it<rt.length;it++)nt=rt[it].toLowerCase(),typeof this.readers[nt]!="function"&&(this.readers[nt]=_e)},shortcut:function(_e,rt){return function(){return _e[rt].apply(this,arguments)}},getRef:function(_e,rt){return tt.deprecated("JXG.getRef()","Board.select()"),_e.select(rt)},getReference:function(_e,rt){return tt.deprecated("JXG.getReference()","Board.select()"),_e.select(rt)},getBoardByContainerId:function(_e){var rt;for(rt in JXG.boards)if(JXG.boards.hasOwnProperty(rt)&&JXG.boards[rt].container===_e)return JXG.boards[rt];return null},deprecated:function(_e,rt){var it=_e+" is deprecated.";rt&&(it+=" Please use "+rt+" instead."),tt.warn(it)},warn:function(_e){typeof window=="object"&&window.console&&console.warn?console.warn("WARNING:",_e):typeof document=="object"&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+_e+"<br />")},debugInt:function(_e){var rt,it;for(rt=0;rt<arguments.length;rt++)it=arguments[rt],typeof window=="object"&&window.console&&console.log?console.log(it):typeof document=="object"&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=it+"<br/>")},debugWST:function(_e){var rt=new Error;tt.debugInt.apply(this,arguments),rt&&rt.stack&&(tt.debugInt("stacktrace"),tt.debugInt(rt.stack.split(`
`).slice(1).join(`
`)))},debugLine:function(_e){var rt=new Error;tt.debugInt.apply(this,arguments),rt&&rt.stack&&tt.debugInt("Called from",rt.stack.split(`
`).slice(2,3).join(`
`))},debug:function(_e){tt.debugInt.apply(this,arguments)}}),tt}),define("base/constants",["jxg"],function(tt){var _e;return _e={version:"0.99.7",licenseText:"JSXGraph v0.99.7 Copyright (C) see http://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82},tt.extend(tt,_e),_e}),define("utils/type",["jxg","base/constants"],function(tt,_e){return tt.extend(tt,{isId:function(rt,it){return typeof it=="string"&&!!rt.objects[it]},isName:function(rt,it){return typeof it=="string"&&!!rt.elementsByName[it]},isGroup:function(rt,it){return typeof it=="string"&&!!rt.groups[it]},isString:function(rt){return typeof rt=="string"},isNumber:function(rt){return typeof rt=="number"||Object.prototype.toString.call(rt)==="[Object Number]"},isFunction:function(rt){return typeof rt=="function"},isArray:function(rt){return Array.isArray?Array.isArray(rt):rt!==null&&typeof rt=="object"&&typeof rt.splice=="function"&&typeof rt.join=="function"},isObject:function(rt){return typeof rt=="object"&&!this.isArray(rt)},isPoint:function(rt){return rt!==null&&typeof rt=="object"&&rt.elementClass===_e.OBJECT_CLASS_POINT},isPointType:function(rt,it){var nt,st;return!!this.isArray(it)||!!(this.isFunction(it)&&(nt=it(),this.isArray(nt)&&nt.length>1))||(st=rt.select(it),this.isPoint(st))},isTransformationOrArray:function(rt){if(rt!==null){if(this.isArray(rt)&&rt.length>0)return this.isTransformationOrArray(rt[0]);if(typeof rt=="object")return rt.type===_e.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(rt){return function(it){return it!=null}}(),def:function(rt,it){return this.exists(rt)?rt:it},str2Bool:function(rt){return!this.exists(rt)||(typeof rt=="boolean"?rt:!!this.isString(rt)&&rt.toLowerCase()==="true")},createEvalFunction:function(rt,it,nt){var st,at=[];for(st=0;st<nt;st++)at[st]=tt.createFunction(it[st],rt,"",!0);return function(lt){return at[lt]()}},createFunction:function(rt,it,nt,st){var at=null;return this.exists(st)&&!st||!this.isString(rt)?this.isFunction(rt)?at=rt:this.isNumber(rt)?at=function(){return rt}:this.isString(rt)&&(at=function(){return rt}):at=it.jc.snippet(rt,!0,nt,!0),at!==null&&(at.origin=rt),at},providePoints:function(rt,it,nt,st,at){var lt,ot,ct,ut,ht,dt=0,pt=[];for(this.isArray(it)||(it=[it]),ct=it.length,this.exists(at)&&(dt=at.length),dt===0&&(ut=this.copyAttributes(nt,rt.options,st)),lt=0;lt<ct;++lt)if(dt>0&&(ot=Math.min(lt,dt-1),ut=this.copyAttributes(nt,rt.options,st,at[ot])),this.isArray(it[lt])&&it[lt].length>1?pt.push(rt.create("point",it[lt],ut)):this.isFunction(it[lt])?(ht=it[lt](),this.isArray(ht)&&ht.length>1&&pt.push(rt.create("point",[it[lt]],ut))):pt.push(rt.select(it[lt])),!this.isPoint(pt[lt]))return!1;return pt},bind:function(rt,it){return function(){return rt.apply(it,arguments)}},evaluate:function(rt){return this.isFunction(rt)?rt():rt},indexOf:function(rt,it,nt){var st,at=this.exists(nt);if(Array.indexOf&&!at)return rt.indexOf(it);for(st=0;st<rt.length;st++)if(at&&rt[st][nt]===it||!at&&rt[st]===it)return st;return-1},eliminateDuplicates:function(rt){var it,nt=rt.length,st=[],at={};for(it=0;it<nt;it++)at[rt[it]]=0;for(it in at)at.hasOwnProperty(it)&&st.push(it);return st},swap:function(rt,it,nt){var st;return st=rt[it],rt[it]=rt[nt],rt[nt]=st,rt},uniqueArray:function(rt){var it,nt,st,at=[];if(rt.length===0)return[];for(it=0;it<rt.length;it++)if(st=this.isArray(rt[it]),this.exists(rt[it]))for(nt=it+1;nt<rt.length;nt++)st&&tt.cmpArrays(rt[it],rt[nt])?rt[it]=[]:st||rt[it]!==rt[nt]||(rt[it]="");else rt[it]="";for(nt=0,it=0;it<rt.length;it++)st=this.isArray(rt[it]),st||rt[it]===""?st&&rt[it].length!==0&&(at[nt]=rt[it].slice(0),nt++):(at[nt]=rt[it],nt++);return rt=at,at},isInArray:function(rt,it){return tt.indexOf(rt,it)>-1},coordsArrayToMatrix:function(rt,it){var nt,st=[],at=[];for(nt=0;nt<rt.length;nt++)it?(st.push(rt[nt].usrCoords[1]),at.push(rt[nt].usrCoords[2])):at.push([rt[nt].usrCoords[1],rt[nt].usrCoords[2]]);return it&&(at=[st,at]),at},cmpArrays:function(rt,it){var nt;if(rt===it)return!0;if(rt.length!==it.length)return!1;for(nt=0;nt<rt.length;nt++)if(this.isArray(rt[nt])&&this.isArray(it[nt])){if(!this.cmpArrays(rt[nt],it[nt]))return!1}else if(rt[nt]!==it[nt])return!1;return!0},removeElementFromArray:function(rt,it){var nt;for(nt=0;nt<rt.length;nt++)if(rt[nt]===it)return rt.splice(nt,1),rt;return rt},trunc:function(rt,it){return it=tt.def(it,0),this.toFixed(rt,it)},_decimalAdjust:function(rt,it,nt){return nt===void 0||+nt==0?Math[rt](it):(it=+it,nt=+nt,isNaN(it)||typeof nt!="number"||nt%1!=0?NaN:(it=it.toString().split("e"),it=Math[rt](+(it[0]+"e"+(it[1]?+it[1]-nt:-nt))),it=it.toString().split("e"),+(it[0]+"e"+(it[1]?+it[1]+nt:nt))))},_round10:function(rt,it){return this._decimalAdjust("round",rt,it)},_floor10:function(rt,it){return this._decimalAdjust("floor",rt,it)},_ceil10:function(rt,it){return this._decimalAdjust("ceil",rt,it)},toFixed:function(rt,it){return this._round10(rt,-it).toFixed(it)},autoDigits:function(rt){var it=Math.abs(rt);return it>.1?this.toFixed(rt,2):it>=.01?this.toFixed(rt,4):it>=1e-4?this.toFixed(rt,6):rt},keys:function(rt,it){var nt,st=[];for(nt in rt)it?rt.hasOwnProperty(nt)&&st.push(nt):st.push(nt);return st},clone:function(rt){var it={};return it.prototype=rt,it},cloneAndCopy:function(rt,it){var nt,st=function(){};st.prototype=rt;for(nt in it)st[nt]=it[nt];return st},merge:function(rt,it){var nt,st;for(nt in it)if(it.hasOwnProperty(nt))if(this.isArray(it[nt]))for(rt[nt]||(rt[nt]=[]),st=0;st<it[nt].length;st++)typeof it[nt][st]=="object"?rt[nt][st]=this.merge(rt[nt][st],it[nt][st]):rt[nt][st]=it[nt][st];else typeof it[nt]=="object"?(rt[nt]||(rt[nt]={}),rt[nt]=this.merge(rt[nt],it[nt])):rt[nt]=it[nt];return rt},deepCopy:function(rt,it,nt){var st,at,lt,ot;if(nt=nt||!1,typeof rt!="object"||rt===null)return rt;if(this.isArray(rt))for(st=[],at=0;at<rt.length;at++)lt=rt[at],typeof lt=="object"?this.exists(lt.board)?st[at]=lt.id:st[at]=this.deepCopy(lt):st[at]=lt;else{st={};for(at in rt)rt.hasOwnProperty(at)&&(ot=nt?at.toLowerCase():at,lt=rt[at],lt!==null&&typeof lt=="object"?this.exists(lt.board)?st[ot]=lt.id:st[ot]=this.deepCopy(lt):st[ot]=lt);for(at in it)it.hasOwnProperty(at)&&(ot=nt?at.toLowerCase():at,lt=it[at],typeof lt=="object"?this.isArray(lt)||!this.exists(st[ot])?st[ot]=this.deepCopy(lt):st[ot]=this.deepCopy(st[ot],lt,nt):st[ot]=lt)}return st},copyAttributes:function(rt,it,nt){var st,at,lt,ot,ct,ut={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(lt=arguments.length,st=lt<3||ut[nt]?tt.deepCopy(it.elements,null,!0):{},lt<4&&this.exists(nt)&&this.exists(it.layer[nt])&&(st.layer=it.layer[nt]),ot=it,ct=!0,at=2;at<lt;at++){if(!this.exists(ot[arguments[at]])){ct=!1;break}ot=ot[arguments[at]]}for(ct&&(st=tt.deepCopy(st,ot,!0)),ot=rt,ct=!0,at=3;at<lt;at++){if(!this.exists(ot[arguments[at]])){ct=!1;break}ot=ot[arguments[at]]}for(ct&&this.extend(st,ot,null,!0),ot=it,ct=!0,at=2;at<lt;at++){if(!this.exists(ot[arguments[at]])){ct=!1;break}ot=ot[arguments[at]]}return ct&&this.exists(ot.label)&&(st.label=tt.deepCopy(ot.label,st.label)),st.label=tt.deepCopy(it.label,st.label),st},copyPrototypeMethods:function(rt,it,nt){var st;rt.prototype[nt]=it.prototype.constructor;for(st in it.prototype)it.prototype.hasOwnProperty(st)&&(rt.prototype[st]=it.prototype[st])},toJSON:function(rt,it){var nt,st,at,lt;if(it=tt.def(it,!1),JSON.stringify&&!it)try{return JSON.stringify(rt)}catch{}switch(typeof rt){case"object":if(rt){if(nt=[],this.isArray(rt)){for(at=0;at<rt.length;at++)nt.push(tt.toJSON(rt[at],it));return"["+nt.join(",")+"]"}for(st in rt)if(rt.hasOwnProperty(st)){try{lt=tt.toJSON(rt[st],it)}catch{lt=""}it?nt.push(st+":"+lt):nt.push('"'+st+'":'+lt)}return"{"+nt.join(",")+"} "}return"null";case"string":return"'"+rt.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return rt.toString()}return"0"},clearVisPropOld:function(rt){return rt.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",transitionduration:0,top:-1e5,visible:null},rt},isInObject:function(rt,it){var nt;for(nt in rt)if(rt.hasOwnProperty(nt)&&rt[nt]===it)return!0;return!1},escapeHTML:function(rt){return rt.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(rt){return rt.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(rt){return rt.charAt(0).toUpperCase()+rt.substring(1).toLowerCase()},trimNumber:function(rt){return rt=rt.replace(/^0+/,""),rt=rt.replace(/0+$/,""),rt[rt.length-1]!=="."&&rt[rt.length-1]!==","||(rt=rt.slice(0,-1)),rt[0]!=="."&&rt[0]!==","||(rt="0"+rt),rt},filterElements:function(rt,it){var nt,st,at,lt,ot,ct,ut,ht=rt.length,dt=[];if(typeof it!="function"&&typeof it!="object")return dt;for(nt=0;nt<ht;nt++){if(ut=!0,at=rt[nt],typeof it=="object"){for(st in it)if(it.hasOwnProperty(st)&&(lt=st.toLowerCase(),ot=typeof at[st]=="function"?at[st]():at[st],ct=at.visProp&&typeof at.visProp[lt]=="function"?at.visProp[lt]():at.visProp&&at.visProp[lt],!(ut=typeof it[st]=="function"?it[st](ot)||it[st](ct):ot===it[st]||ct===it[st])))break}else typeof it=="function"&&(ut=it(at));ut&&dt.push(at)}return dt},trim:function(rt){return rt.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(rt,it){return typeof html_sanitize=="function"&&it?html_sanitize(rt,function(){},function(nt){return nt}):(rt&&(rt=rt.replace(/</g,"&lt;").replace(/>/g,"&gt;")),rt)},evalSlider:function(rt){return rt&&rt.type===_e.OBJECT_TYPE_GLIDER&&typeof rt.Value=="function"?rt.Value():rt}}),tt}),define("utils/env",["jxg","utils/type"],function(tt,_e){return tt.extend(tt,{touchProperty:"touches",isBrowser:typeof window=="object"&&typeof document=="object",supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var rt,it=!1;if(this.isNode())try{rt=requireBrowser(),it=!!rt}catch{}return it||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&(!!module.exports||typeof commonjsGlobal$1=="object"&&commonjsGlobal$1.requirejsVars&&!commonjsGlobal$1.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&typeof self=="object"&&typeof self.postMessage=="function"},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&window.ontouchstart!==void 0},isAndroid:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return _e.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z\.]*Safari/)>-1},isMetroApp:function(){return typeof window=="object"&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1},isFirefoxOS:function(){return _e.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")===-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var rt,it,nt=3;if(typeof document!="object")return 0;rt=document.createElement("div"),it=rt.getElementsByTagName("i");do rt.innerHTML="<!--[if gt IE "+ ++nt+"]><i></i><![endif]-->";while(it[0]);return nt>4?nt:void 0}(),getDimensions:function(rt,it){var nt,st,at,lt,ot,ct,ut,ht,dt,pt=/\d+(\.\d*)?px/;if(!this.isBrowser||rt===null)return{width:500,height:500};if(it=it||document,nt=it.getElementById(rt),!_e.exists(nt))throw new Error(`
JSXGraph: HTML container element '`+rt+"' not found.");return(st=nt.style.display)!=="none"&&st!==null?nt.clientWidth>0&&nt.clientHeight>0?{width:nt.clientWidth,height:nt.clientHeight}:(dt=window.getComputedStyle?window.getComputedStyle(nt):nt.style,{width:pt.test(dt.width)?parseFloat(dt.width):0,height:pt.test(dt.height)?parseFloat(dt.height):0}):(at=nt.style,lt=at.visibility,ot=at.position,ct=at.display,at.visibility="hidden",at.position="absolute",at.display="block",ut=nt.clientWidth,ht=nt.clientHeight,at.display=ct,at.position=ot,at.visibility=lt,{width:ut,height:ht})},addEvent:function(rt,it,nt,st){var at=function(){return nt.apply(st,arguments)};at.origin=nt,st["x_internal"+it]=st["x_internal"+it]||[],st["x_internal"+it].push(at),_e.exists(rt)&&_e.exists(rt.addEventListener)&&rt.addEventListener(it,at,!1),_e.exists(rt)&&_e.exists(rt.attachEvent)&&rt.attachEvent("on"+it,at)},removeEvent:function(rt,it,nt,st){var at;if(!_e.exists(st))return void tt.debug("no such owner");if(!_e.exists(st["x_internal"+it]))return void tt.debug("no such type: "+it);if(!_e.isArray(st["x_internal"+it]))return void tt.debug("owner[x_internal + "+it+"] is not an array");if((at=_e.indexOf(st["x_internal"+it],nt,"origin"))===-1)return void tt.debug("no such event function in internal list: "+nt);try{_e.exists(rt)&&_e.exists(rt.removeEventListener)&&rt.removeEventListener(it,st["x_internal"+it][at],!1),_e.exists(rt)&&_e.exists(rt.detachEvent)&&rt.detachEvent("on"+it,st["x_internal"+it][at])}catch{tt.debug("event not registered in browser: ("+it+" -- "+nt+")")}st["x_internal"+it].splice(at,1)},removeAllEvents:function(rt,it,nt){var st,at;if(nt["x_internal"+it]){for(at=nt["x_internal"+it].length,st=at-1;st>=0;st--)tt.removeEvent(rt,it,nt["x_internal"+it][st].origin,nt);nt["x_internal"+it].length>0&&tt.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(rt,it,nt){var st,at,lt,ot=0,ct=0;if(rt||(rt=window.event),lt=rt[tt.touchProperty],_e.exists(lt)&&lt.length===0&&(lt=rt.changedTouches),_e.exists(it)&&_e.exists(lt))if(it===-1){for(at=lt.length,st=0;st<at;st++)if(lt[st]){rt=lt[st];break}}else rt=lt[it];return rt.clientX&&(ot=rt.clientX,ct=rt.clientY),[ot,ct]},getOffset:function(rt){var it,nt=rt,st=rt,at=nt.offsetLeft-nt.scrollLeft,lt=nt.offsetTop-nt.scrollTop;for(it=this.getCSSTransform([at,lt],nt),at=it[0],lt=it[1],nt=nt.offsetParent;nt;){for(at+=nt.offsetLeft,lt+=nt.offsetTop,nt.offsetParent&&(at+=nt.clientLeft-nt.scrollLeft,lt+=nt.clientTop-nt.scrollTop),it=this.getCSSTransform([at,lt],nt),at=it[0],lt=it[1],st=st.parentNode;st!==nt;)at+=st.clientLeft-st.scrollLeft,lt+=st.clientTop-st.scrollTop,it=this.getCSSTransform([at,lt],st),at=it[0],lt=it[1],st=st.parentNode;nt=nt.offsetParent}return[at,lt]},getStyle:function(rt,it){var nt,st=rt.ownerDocument;return st.defaultView&&st.defaultView.getComputedStyle?nt=st.defaultView.getComputedStyle(rt,null).getPropertyValue(it):rt.currentStyle&&tt.ieVersion>=9?nt=rt.currentStyle[it]:rt.style&&(it=it.replace(/-([a-z]|[0-9])/gi,function(at,lt){return lt.toUpperCase()}),nt=rt.style[it]),nt},getProp:function(rt,it){var nt=parseInt(this.getStyle(rt,it),10);return isNaN(nt)?0:nt},getCSSTransform:function(rt,it){var nt,st,at,lt,ot,ct,ut,ht,dt=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(ct=dt.length,nt=0,at="";nt<ct;nt++)if(_e.exists(it.style[dt[nt]])){at=it.style[dt[nt]];break}if(at!==""&&(ot=at.indexOf("("))>0){for(ct=at.length,lt=at.substring(ot+1,ct-1),ht=lt.split(","),st=0,ut=ht.length;st<ut;st++)ht[st]=parseFloat(ht[st]);at.indexOf("matrix")===0?(rt[0]+=ht[4],rt[1]+=ht[5]):at.indexOf("translateX")===0?rt[0]+=ht[0]:at.indexOf("translateY")===0?rt[1]+=ht[0]:at.indexOf("translate")===0&&(rt[0]+=ht[0],rt[1]+=ht[1])}return _e.exists(it.style.zoom)&&(at=it.style.zoom)!==""&&(rt[0]*=parseFloat(at),rt[1]*=parseFloat(at)),rt},getCSSTransformMatrix:function(rt){var it,nt,st,at,lt,ot,ct,ut,ht,dt=rt.ownerDocument,pt=["transform","webkitTransform","MozTransform","msTransform","oTransform"],ft=[[1,0,0],[0,1,0],[0,0,1]];if(dt.defaultView&&dt.defaultView.getComputedStyle)ht=dt.defaultView.getComputedStyle(rt,null),st=ht.getPropertyValue("-webkit-transform")||ht.getPropertyValue("-moz-transform")||ht.getPropertyValue("-ms-transform")||ht.getPropertyValue("-o-transform")||ht.getPropertyValue("transform");else for(ot=pt.length,it=0,st="";it<ot;it++)if(_e.exists(rt.style[pt[it]])){st=rt.style[pt[it]];break}if(st!==""&&(lt=st.indexOf("("))>0){for(ot=st.length,at=st.substring(lt+1,ot-1),ut=at.split(","),nt=0,ct=ut.length;nt<ct;nt++)ut[nt]=parseFloat(ut[nt]);st.indexOf("matrix")===0?ft=[[1,0,0],[0,ut[0],ut[1]],[0,ut[2],ut[3]]]:st.indexOf("scaleX")===0?ft[1][1]=ut[0]:st.indexOf("scaleY")===0?ft[2][2]=ut[0]:st.indexOf("scale")===0&&(ft[1][1]=ut[0],ft[2][2]=ut[1])}return _e.exists(rt.style.zoom)&&(st=rt.style.zoom)!==""&&(ft[1][1]*=parseFloat(st),ft[2][2]*=parseFloat(st)),ft},timedChunk:function(rt,it,nt,st){var at=rt.concat(),lt=function(){var ot=+new Date;do it.call(nt,at.shift());while(at.length>0&&+new Date-ot<300);at.length>0?window.setTimeout(lt,1):st(rt)};window.setTimeout(lt,1)}}),tt}),define("utils/xml",["jxg","utils/type"],function(tt,_e){return tt.XML={cleanWhitespace:function(rt){for(var it=rt.firstChild;_e.exists(it);)it.nodeType!==3||/\S/.test(it.nodeValue)?it.nodeType===1&&this.cleanWhitespace(it):rt.removeChild(it),it=it.nextSibling},parse:function(rt){var it,nt,st;return st=typeof DOMParser=="function"||typeof DOMParser=="object"?DOMParser:function(){this.parseFromString=function(at){var lt;return typeof ActiveXObject=="function"&&(lt=new ActiveXObject("MSXML.DomDocument"),lt.loadXML(at)),lt}},it=new st,nt=it.parseFromString(rt,"text/xml"),this.cleanWhitespace(nt),nt}},tt.XML}),define("utils/event",["jxg","utils/type"],function(tt,_e){return tt.EventEmitter={eventHandlers:{},suspended:{},trigger:function(rt,it){var nt,st,at,lt,ot,ct;for(ot=rt.length,st=0;st<ot;st++)if(lt=this.eventHandlers[rt[st]],!this.suspended[rt[st]]){if(this.suspended[rt[st]]=!0,lt)for(ct=lt.length,nt=0;nt<ct;nt++)at=lt[nt],at.handler.apply(at.context,it);this.suspended[rt[st]]=!1}return this},on:function(rt,it,nt){return _e.isArray(this.eventHandlers[rt])||(this.eventHandlers[rt]=[]),nt=_e.def(nt,this),this.eventHandlers[rt].push({handler:it,context:nt}),this},off:function(rt,it){var nt;return rt&&_e.isArray(this.eventHandlers[rt])?(it?(nt=_e.indexOf(this.eventHandlers[rt],it,"handler"),nt>-1&&this.eventHandlers[rt].splice(nt,1),this.eventHandlers[rt].length===0&&delete this.eventHandlers[rt]):delete this.eventHandlers[rt],this):this},eventify:function(rt){rt.eventHandlers={},rt.on=this.on,rt.off=this.off,rt.triggerEventHandlers=this.trigger,rt.trigger=this.trigger,rt.suspended={}}},tt.EventEmitter}),define("math/math",["jxg","utils/type"],function(tt,_e){var rt=function(it){var nt,st;return it.memo||(nt={},st=Array.prototype.join,it.memo=function(){var at=st.call(arguments);return nt[at]!==void 0?nt[at]:nt[at]=it.apply(this,arguments)}),it.memo};return tt.Math={eps:1e-6,relDif:function(it,nt){var st=Math.abs(it),at=Math.abs(nt);return at=Math.max(st,at),at===0?0:Math.abs(it-nt)/at},mod:function(it,nt){return it-Math.floor(it/nt)*nt},vector:function(it,nt){var st,at;for(nt=nt||0,st=[],at=0;at<it;at++)st[at]=nt;return st},matrix:function(it,nt,st){var at,lt,ot;for(st=st||0,nt=nt||it,at=[],lt=0;lt<it;lt++)for(at[lt]=[],ot=0;ot<nt;ot++)at[lt][ot]=st;return at},identity:function(it,nt){var st,at;for(nt===void 0&&typeof nt!="number"&&(nt=it),st=this.matrix(it,nt),at=0;at<Math.min(it,nt);at++)st[at][at]=1;return st},frustum:function(it,nt,st,at,lt,ot){var ct=this.matrix(4,4);return ct[0][0]=2*lt/(nt-it),ct[0][1]=0,ct[0][2]=(nt+it)/(nt-it),ct[0][3]=0,ct[1][0]=0,ct[1][1]=2*lt/(at-st),ct[1][2]=(at+st)/(at-st),ct[1][3]=0,ct[2][0]=0,ct[2][1]=0,ct[2][2]=-(ot+lt)/(ot-lt),ct[2][3]=-ot*lt*2/(ot-lt),ct[3][0]=0,ct[3][1]=0,ct[3][2]=-1,ct[3][3]=0,ct},projection:function(it,nt,st,at){var lt=st*Math.tan(it/2),ot=lt*nt;return this.frustum(-ot,ot,-lt,lt,st,at)},matVecMult:function(it,nt){var st,at,lt,ot=it.length,ct=nt.length,ut=[];if(ct===3)for(st=0;st<ot;st++)ut[st]=it[st][0]*nt[0]+it[st][1]*nt[1]+it[st][2]*nt[2];else for(st=0;st<ot;st++){for(at=0,lt=0;lt<ct;lt++)at+=it[st][lt]*nt[lt];ut[st]=at}return ut},matMatMult:function(it,nt){var st,at,lt,ot,ct=it.length,ut=ct>0?nt[0].length:0,ht=nt.length,dt=this.matrix(ct,ut);for(st=0;st<ct;st++)for(at=0;at<ut;at++){for(lt=0,ot=0;ot<ht;ot++)lt+=it[st][ot]*nt[ot][at];dt[st][at]=lt}return dt},transpose:function(it){var nt,st,at,lt,ot;for(lt=it.length,ot=it.length>0?it[0].length:0,nt=this.matrix(ot,lt),st=0;st<ot;st++)for(at=0;at<lt;at++)nt[st][at]=it[at][st];return nt},inverse:function(it){var nt,st,at,lt,ot,ct,ut,ht=it.length,dt=[],pt=[],ft=[];for(nt=0;nt<ht;nt++){for(dt[nt]=[],st=0;st<ht;st++)dt[nt][st]=it[nt][st];pt[nt]=nt}for(st=0;st<ht;st++){for(ot=Math.abs(dt[st][st]),ct=st,nt=st+1;nt<ht;nt++)Math.abs(dt[nt][st])>ot&&(ot=Math.abs(dt[nt][st]),ct=nt);if(ot<=this.eps)return[];if(ct>st){for(at=0;at<ht;at++)ut=dt[st][at],dt[st][at]=dt[ct][at],dt[ct][at]=ut;ut=pt[st],pt[st]=pt[ct],pt[ct]=ut}for(lt=1/dt[st][st],nt=0;nt<ht;nt++)dt[nt][st]*=lt;for(dt[st][st]=lt,at=0;at<ht;at++)if(at!==st){for(nt=0;nt<ht;nt++)nt!==st&&(dt[nt][at]-=dt[nt][st]*dt[st][at]);dt[st][at]=-lt*dt[st][at]}}for(nt=0;nt<ht;nt++){for(at=0;at<ht;at++)ft[pt[at]]=dt[nt][at];for(at=0;at<ht;at++)dt[nt][at]=ft[at]}return dt},innerProduct:function(it,nt,st){var at,lt=0;for(st!==void 0&&_e.isNumber(st)||(st=it.length),at=0;at<st;at++)lt+=it[at]*nt[at];return lt},crossProduct:function(it,nt){return[it[1]*nt[2]-it[2]*nt[1],it[2]*nt[0]-it[0]*nt[2],it[0]*nt[1]-it[1]*nt[0]]},factorial:rt(function(it){return it<0?NaN:(it=Math.floor(it),it===0||it===1?1:it*this.factorial(it-1))}),binomial:rt(function(it,nt){var st,at;if(nt>it||nt<0)return NaN;if(nt=Math.round(nt),it=Math.round(it),nt===0||nt===it)return 1;for(st=1,at=0;at<nt;at++)st*=it-at,st/=at+1;return st}),cosh:function(it){return .5*(Math.exp(it)+Math.exp(-it))},sinh:function(it){return .5*(Math.exp(it)-Math.exp(-it))},pow:function(it,nt){return it===0?nt===0?1:0:Math.floor(nt)===nt?Math.pow(it,nt):it>0?Math.exp(nt*Math.log(Math.abs(it))):NaN},log10:function(it){return Math.log(it)/Math.log(10)},log2:function(it){return Math.log(it)/Math.log(2)},log:function(it,nt){return nt!==void 0&&_e.isNumber(nt)?Math.log(it)/Math.log(nt):Math.log(it)},sign:Math.sign||function(it){return it=+it,it===0||isNaN(it)?it:it>0?1:-1},squampow:function(it,nt){var st;if(Math.floor(nt)===nt){for(st=1,nt<0&&(it=1/it,nt*=-1);nt!==0;)1&nt&&(st*=it),nt>>=1,it*=it;return st}return this.pow(it,nt)},gcd:function(it,nt){if(it=Math.abs(it),nt=Math.abs(nt),!_e.isNumber(it)||!_e.isNumber(nt))return NaN;if(nt>it){var st=it;it=nt,nt=st}for(;;){if((it%=nt)===0)return nt;if((nt%=it)===0)return it}},lcm:function(it,nt){var st;return _e.isNumber(it)&&_e.isNumber(nt)?(st=it*nt,st!==0?st/this.gcd(it,nt):0):NaN},normalize:function(it){var nt,st,at=2*it[3],lt=it[4]/at;return it[5]=lt,it[6]=-it[1]/at,it[7]=-it[2]/at,isFinite(lt)?Math.abs(lt)>=1?(it[0]=(it[6]*it[6]+it[7]*it[7]-lt*lt)/(2*lt),it[1]=-it[6]/lt,it[2]=-it[7]/lt,it[3]=1/(2*lt),it[4]=1):(st=lt<=0?-1:1,it[0]=st*(it[6]*it[6]+it[7]*it[7]-lt*lt)*.5,it[1]=-st*it[6],it[2]=-st*it[7],it[3]=st/2,it[4]=st*lt):(nt=Math.sqrt(it[1]*it[1]+it[2]*it[2]),it[0]/=nt,it[1]/=nt,it[2]/=nt,it[3]=0,it[4]=1),it},toGL:function(it){var nt,st,at;if(nt=typeof Float32Array=="function"?new Float32Array(16):new Array(16),it.length!==4&&it[0].length!==4)return nt;for(st=0;st<4;st++)for(at=0;at<4;at++)nt[st+4*at]=it[st][at];return nt}},tt.Math}),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],function(tt,_e,rt,it,nt){return tt.Coords=function(st,at,lt,ot){this.board=lt,this.usrCoords=[],this.scrCoords=[],this.emitter=!it.exists(ot)||ot,this.emitter&&rt.eventify(this),this.setCoordinates(st,at,!0,!0)},tt.extend(tt.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>nt.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(st){var at=Math.round,lt=this.board,ot=this.usrCoords,ct=lt.origin.scrCoords;st===!0?(this.scrCoords[0]=at(ot[0]),this.scrCoords[1]=at(ot[0]*ct[1]+ot[1]*lt.unitX),this.scrCoords[2]=at(ot[0]*ct[2]-ot[2]*lt.unitY)):(this.scrCoords[0]=ot[0],this.scrCoords[1]=ot[0]*ct[1]+ot[1]*lt.unitX,this.scrCoords[2]=ot[0]*ct[2]-ot[2]*lt.unitY)},screen2usr:function(){var st=this.board.origin.scrCoords,at=this.scrCoords,lt=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(at[1]-st[1])/lt.unitX,this.usrCoords[2]=(st[2]-at[2])/lt.unitY},distance:function(st,at){var lt,ot,ct=0,ut=this.usrCoords,ht=this.scrCoords;if(st===_e.COORDS_BY_USER){if(lt=at.usrCoords,ot=ut[0]-lt[0],(ct=ot*ot)>nt.eps*nt.eps)return Number.POSITIVE_INFINITY;ot=ut[1]-lt[1],ct+=ot*ot,ot=ut[2]-lt[2],ct+=ot*ot}else lt=at.scrCoords,ot=ht[1]-lt[1],ct+=ot*ot,ot=ht[2]-lt[2],ct+=ot*ot;return Math.sqrt(ct)},setCoordinates:function(st,at,lt,ot){var ct=this.usrCoords,ut=this.scrCoords,ht=[ct[0],ct[1],ct[2]],dt=[ut[0],ut[1],ut[2]];return st===_e.COORDS_BY_USER?(at.length===2?(ct[0]=1,ct[1]=at[0],ct[2]=at[1]):(ct[0]=at[0],ct[1]=at[1],ct[2]=at[2],this.normalizeUsrCoords()),this.usr2screen(lt)):(at.length===2?(ut[1]=at[0],ut[2]=at[1]):(ut[1]=at[1],ut[2]=at[2]),this.screen2usr()),!this.emitter||ot||dt[1]===ut[1]&&dt[2]===ut[2]||this.triggerEventHandlers(["update"],[ht,dt]),this},copy:function(st,at){return at===void 0&&(at=0),this[st].slice(at)},__evt__update:function(st,at){},__evt:function(){}}),tt.Coords}),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],function(tt,_e,rt,it){var nt={each:function(st,at,lt){var ot,ct,ut=[];if(_e.exists(st.length))for(ct=st.length,ot=0;ot<ct;ot++)ut.push(at.call(this,st[ot],lt));return ut},coords:function(st,at){var lt=st;return st&&st.elementClass===rt.OBJECT_CLASS_POINT?lt=st.coords:st.usrCoords&&st.scrCoords&&st.usr2screen&&(lt=st),at&&(lt=new it(rt.COORDS_BY_USER,lt.usrCoords,lt.board)),lt},coordsArray:function(st,at){var lt;return lt=_e.isArray(st)?st:this.coords(st).usrCoords,lt.length<3&&lt.unshift(1),at&&(lt=[lt[0],lt[1],lt[2]]),lt}};return tt.Expect=nt,nt}),define("math/qdt",["math/math","utils/type"],function(tt,_e){var rt=function(it){this.capacity=10,this.points=[],this.xlb=it[0],this.xub=it[2],this.ylb=it[3],this.yub=it[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null};return _e.extend(rt.prototype,{contains:function(it,nt){return this.xlb<it&&it<=this.xub&&this.ylb<nt&&nt<=this.yub},insert:function(it){return!!this.contains(it.usrCoords[1],it.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(it),!0):(this.northWest===null&&this.subdivide(),!!this.northWest.insert(it)||!!this.northEast.insert(it)||!!this.southEast.insert(it)||!!this.southWest.insert(it)))},subdivide:function(){var it,nt=this.points.length,st=this.xlb+(this.xub-this.xlb)/2,at=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new rt([this.xlb,this.yub,st,at]),this.northEast=new rt([st,this.yub,this.xub,at]),this.southEast=new rt([this.xlb,at,st,this.ylb]),this.southWest=new rt([st,at,this.xub,this.ylb]),it=0;it<nt;it+=1)this.northWest.insert(this.points[it]),this.northEast.insert(this.points[it]),this.southEast.insert(this.points[it]),this.southWest.insert(this.points[it])},_query:function(it,nt){var st;if(this.contains(it,nt)){if(this.northWest===null)return this;if((st=this.northWest._query(it,nt))||(st=this.northEast._query(it,nt))||(st=this.southEast._query(it,nt))||(st=this.southWest._query(it,nt)))return st}return!1},query:function(it,nt){var st,at;return _e.exists(nt)?(st=it,at=nt):(st=it.usrCoords[1],at=it.usrCoords[2]),this._query(st,at)}}),tt.Quadtree=rt,rt}),define("math/numerics",["jxg","utils/type","math/math"],function(tt,_e,rt){var it={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[.16666666666666666,.3333333333333333,.3333333333333333,.16666666666666666],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return rt.Numerics={Gauss:function(nt,st){var at,lt,ot,ct,ut,ht=rt.eps,dt=nt.length>0?nt[0].length:0;if(dt!==st.length||dt!==nt.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(ct=[],ut=st.slice(0,dt),at=0;at<dt;at++)ct[at]=nt[at].slice(0,dt);for(lt=0;lt<dt;lt++){for(at=dt-1;at>lt;at--)if(Math.abs(ct[at][lt])>ht)if(Math.abs(ct[lt][lt])<ht)_e.swap(ct,at,lt),_e.swap(ut,at,lt);else for(ct[at][lt]/=ct[lt][lt],ut[at]-=ct[at][lt]*ut[lt],ot=lt+1;ot<dt;ot++)ct[at][ot]-=ct[at][lt]*ct[lt][ot];if(Math.abs(ct[lt][lt])<ht)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(ct,ut,!0),ut},backwardSolve:function(nt,st,at){var lt,ot,ct,ut,ht;for(lt=at?st:st.slice(0,st.length),ot=nt.length,ct=nt.length>0?nt[0].length:0,ut=ot-1;ut>=0;ut--){for(ht=ct-1;ht>ut;ht--)lt[ut]-=nt[ut][ht]*lt[ht];lt[ut]/=nt[ut][ut]}return lt},gaussBareiss:function(nt){var st,at,lt,ot,ct,ut,ht,dt,pt,ft=rt.eps;if((ht=nt.length)<=0)return 0;for(nt[0].length<ht&&(ht=nt[0].length),dt=[],ot=0;ot<ht;ot++)dt[ot]=nt[ot].slice(0,ht);for(at=1,lt=1,st=0;st<ht-1;st++){if(ut=dt[st][st],Math.abs(ut)<ft){for(ot=st+1;ot<ht&&!(Math.abs(dt[ot][st])>=ft);ot++);if(ot===ht)return 0;for(ct=st;ct<ht;ct++)pt=dt[ot][ct],dt[ot][ct]=dt[st][ct],dt[st][ct]=pt;lt=-lt,ut=dt[st][st]}for(ot=st+1;ot<ht;ot++)for(ct=st+1;ct<ht;ct++)pt=ut*dt[ot][ct]-dt[ot][st]*dt[st][ct],dt[ot][ct]=pt/at;at=ut}return lt*dt[ht-1][ht-1]},det:function(nt){return nt.length===2&&nt[0].length===2?nt[0][0]*nt[1][1]-nt[1][0]*nt[0][1]:this.gaussBareiss(nt)},Jacobi:function(nt){var st,at,lt,ot,ct,ut,ht,dt,pt=rt.eps,ft=0,gt=nt.length,mt=[[0,0,0],[0,0,0],[0,0,0]],At=[[0,0,0],[0,0,0],[0,0,0]],yt=0;for(st=0;st<gt;st++){for(at=0;at<gt;at++)mt[st][at]=0,At[st][at]=nt[st][at],ft+=Math.abs(At[st][at]);mt[st][st]=1}if(gt===1)return[At,mt];if(ft<=0)return[At,mt];ft/=gt*gt;do{for(dt=0,at=1;at<gt;at++)for(st=0;st<at;st++)if(ot=Math.abs(At[st][at]),dt+=ot,ot>=pt){for(ot=.5*Math.atan2(2*At[st][at],At[st][st]-At[at][at]),ct=Math.sin(ot),ut=Math.cos(ot),lt=0;lt<gt;lt++)ht=At[lt][st],At[lt][st]=ut*ht+ct*At[lt][at],At[lt][at]=-ct*ht+ut*At[lt][at],ht=mt[lt][st],mt[lt][st]=ut*ht+ct*mt[lt][at],mt[lt][at]=-ct*ht+ut*mt[lt][at];for(At[st][st]=ut*At[st][st]+ct*At[at][st],At[at][at]=-ct*At[st][at]+ut*At[at][at],At[st][at]=0,lt=0;lt<gt;lt++)At[st][lt]=At[lt][st],At[at][lt]=At[lt][at]}yt+=1}while(Math.abs(dt)/ft>pt&&yt<2e3);return[At,mt]},NewtonCotes:function(nt,st,at){var lt,ot,ct,ut=0,ht=at&&_e.isNumber(at.number_of_nodes)?at.number_of_nodes:28,dt={trapez:!0,simpson:!0,milne:!0},pt=at&&at.integration_type&&dt.hasOwnProperty(at.integration_type)&&dt[at.integration_type]?at.integration_type:"milne",ft=(nt[1]-nt[0])/ht;switch(pt){case"trapez":for(ut=.5*(st(nt[0])+st(nt[1])),lt=nt[0],ot=0;ot<ht-1;ot++)lt+=ft,ut+=st(lt);ut*=ft;break;case"simpson":if(ht%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(ct=ht/2,ut=st(nt[0])+st(nt[1]),lt=nt[0],ot=0;ot<ct-1;ot++)lt+=2*ft,ut+=2*st(lt);for(lt=nt[0]-ft,ot=0;ot<ct;ot++)lt+=2*ft,ut+=4*st(lt);ut*=ft/3;break;default:if(ht%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(ct=.25*ht,ut=7*(st(nt[0])+st(nt[1])),lt=nt[0],ot=0;ot<ct-1;ot++)lt+=4*ft,ut+=14*st(lt);for(lt=nt[0]-3*ft,ot=0;ot<ct;ot++)lt+=4*ft,ut+=32*(st(lt)+st(lt+2*ft));for(lt=nt[0]-2*ft,ot=0;ot<ct;ot++)lt+=4*ft,ut+=12*st(lt);ut*=2*ft/45}return ut},Romberg:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt=[],mt=0,At=1/0,yt=at&&_e.isNumber(at.max_iterations)?at.max_iterations:20,bt=at&&_e.isNumber(at.eps)?at.eps:at.eps||1e-7;for(lt=nt[0],ot=nt[1],ct=ot-lt,ht=1,gt[0]=.5*ct*(st(lt)+st(ot)),dt=0;dt<yt;++dt){for(ut=0,ct*=.5,ht*=2,ft=1,pt=1;pt<ht;pt+=2)ut+=st(lt+pt*ct);for(gt[dt+1]=.5*gt[dt]+ut*ct,mt=gt[dt+1],pt=dt-1;pt>=0;--pt)ft*=4,gt[pt]=gt[pt+1]+(gt[pt+1]-gt[pt])/(ft-1),mt=gt[pt];if(Math.abs(mt-At)<bt*Math.abs(mt))break;At=mt}return mt},GaussLegendre:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt=0,mt=[],At=[],yt=at&&_e.isNumber(at.n)?at.n:12;if(yt>18&&(yt=18),mt[2]=[.5773502691896257],At[2]=[1],mt[4]=[.33998104358485626,.8611363115940526],At[4]=[.6521451548625461,.34785484513745385],mt[6]=[.2386191860831969,.6612093864662645,.932469514203152],At[6]=[.46791393457269104,.3607615730481386,.17132449237917036],mt[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],At[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],mt[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],At[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],mt[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],At[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],mt[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],At[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],mt[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],At[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],mt[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],At[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],mt[3]=[0,.7745966692414834],At[3]=[.8888888888888888,.5555555555555556],mt[5]=[0,.5384693101056831,.906179845938664],At[5]=[.5688888888888889,.47862867049936647,.23692688505618908],mt[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],At[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],mt[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],At[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],mt[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],At[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],mt[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],At[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],mt[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],At[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],mt[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],At[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],lt=nt[0],ot=nt[1],ut=yt+1>>1,pt=mt[yt],ft=At[yt],dt=.5*(ot-lt),ht=.5*(ot+lt),!0&yt)for(gt=ft[0]*st(ht),ct=1;ct<ut;++ct)gt+=ft[ct]*(st(ht+dt*pt[ct])+st(ht-dt*pt[ct]));else for(gt=0,ct=0;ct<ut;++ct)gt+=ft[ct]*(st(ht+dt*pt[ct])+st(ht-dt*pt[ct]));return dt*gt},_rescale_error:function(nt,st,at){var lt,ot;return nt=Math.abs(nt),at!==0&&nt!==0&&(lt=Math.pow(200*nt/at,1.5),nt=lt<1?at*lt:at),st>20041683600089728e-310&&(ot=11102230246251565e-30*st)>nt&&(nt=ot),nt},_gaussKronrod:function(nt,st,at,lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt=nt[0],vt=nt[1],_t=.5*(xt+vt),Ct=.5*(vt-xt),St=Math.abs(Ct),Et=st(_t),Tt=0,Mt=Et*ct[at-1],Rt=Math.abs(Mt),It=0,Ot=0,Bt=0,Nt=[],zt=[];for(at%2==0&&(Tt=Et*ot[at/2-1]),ht=Math.floor((at-1)/2),pt=0;pt<ht;pt++)ft=2*pt+1,gt=Ct*lt[ft],mt=st(_t-gt),At=st(_t+gt),yt=mt+At,Nt[ft]=mt,zt[ft]=At,Tt+=ot[pt]*yt,Mt+=ct[ft]*yt,Rt+=ct[ft]*(Math.abs(mt)+Math.abs(At));for(ht=Math.floor(at/2),pt=0;pt<ht;pt++)bt=2*pt,gt=Ct*lt[bt],mt=st(_t-gt),At=st(_t+gt),Nt[bt]=mt,zt[bt]=At,Mt+=ct[bt]*(mt+At),Rt+=ct[bt]*(Math.abs(mt)+Math.abs(At));for(Ot=.5*Mt,It=ct[at-1]*Math.abs(Et-Ot),pt=0;pt<at-1;pt++)It+=ct[pt]*(Math.abs(Nt[pt]-Ot)+Math.abs(zt[pt]-Ot));return Bt=(Mt-Tt)*Ct,Mt*=Ct,Rt*=St,It*=St,dt=Mt,ut.abserr=this._rescale_error(Bt,Rt,It),ut.resabs=Rt,ut.resasc=It,dt},GaussKronrod15:function(nt,st,at){var lt=[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],ot=[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],ct=[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782];return this._gaussKronrod(nt,st,8,lt,ot,ct,at)},GaussKronrod21:function(nt,st,at){var lt=[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],ot=[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],ct=[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169];return this._gaussKronrod(nt,st,11,lt,ot,ct,at)},GaussKronrod31:function(nt,st,at){var lt=[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],ot=[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],ct=[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154];return this._gaussKronrod(nt,st,16,lt,ot,ct,at)},_workspace:function(nt,st){return{limit:st,size:0,nrmax:0,i:0,alist:[nt[0]],blist:[nt[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var at,lt,ot,ct,ut,ht=this.size-1,dt=this.limit,pt=this.nrmax,ft=this.order[pt];if(ht<2)return this.order[0]=0,this.order[1]=1,void(this.i=ft);for(at=this.elist[ft];pt>0&&at>this.elist[this.order[pt-1]];)this.order[pt]=this.order[pt-1],pt--;for(ut=ht<dt/2+2?ht:dt-ht+1,ot=pt+1;ot<ut&&at<this.elist[this.order[ot]];)this.order[ot-1]=this.order[ot],ot++;for(this.order[ot-1]=ft,lt=this.elist[ht],ct=ut-1;ct>ot-2&&lt>=this.elist[this.order[ct]];)this.order[ct+1]=this.order[ct],ct--;this.order[ct+1]=ht,ft=this.order[pt],this.i=ft,this.nrmax=pt},set_initial_result:function(at,lt){this.size=1,this.rlist[0]=at,this.elist[0]=lt},update:function(at,lt,ot,ct,ut,ht,dt,pt){var ft=this.i,gt=this.size,mt=this.level[this.i]+1;pt>ct?(this.alist[ft]=ut,this.rlist[ft]=dt,this.elist[ft]=pt,this.level[ft]=mt,this.alist[gt]=at,this.blist[gt]=lt,this.rlist[gt]=ot,this.elist[gt]=ct,this.level[gt]=mt):(this.blist[ft]=lt,this.rlist[ft]=ot,this.elist[ft]=ct,this.level[ft]=mt,this.alist[gt]=ut,this.blist[gt]=ht,this.rlist[gt]=dt,this.elist[gt]=pt,this.level[gt]=mt),this.size++,mt>this.maximum_level&&(this.maximum_level=mt),this.qpsrt()},retrieve:function(){var at=this.i;return{a:this.alist[at],b:this.blist[at],r:this.rlist[at],e:this.elist[at]}},sum_results:function(){var at,lt=this.size,ot=0;for(at=0;at<lt;at++)ot+=this.rlist[at];return ot},subinterval_too_small:function(at,lt,ot){var ct=1.0000000000000222*(Math.abs(lt)+22250738585072014e-321);return Math.abs(at)<=ct&&Math.abs(ot)<=ct}}},Qag:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt=this._workspace(nt,1e3),It=at&&_e.isNumber(at.limit)?at.limit:15,Ot=at&&_e.isNumber(at.epsrel)?at.epsrel:1e-7,Bt=at&&_e.isNumber(at.epsabs)?at.epsabs:1e-7,Nt=at&&_e.isFunction(at.q)?at.q:this.GaussKronrod15,zt={},Dt=0,Ft=0,Ut=0,$t=0,Vt=0,Zt=0,qt=0,sr=0,er=0,ir=0;if(It>Rt.limit&&tt.warn("iteration limit exceeds available workspace"),Bt<=0&&(Ot<50*rt.eps||Ot<5e-29)&&tt.warn("tolerance cannot be acheived with given epsabs and epsrel"),ct=Nt.apply(this,[nt,st,zt]),ut=zt.abserr,ht=zt.resabs,dt=zt.resasc,Rt.set_initial_result(ct,ut),ft=Math.max(Bt,Ot*Math.abs(ct)),gt=11102230246251565e-30*ht,ut<=gt&&ut>ft)return pt=ct,tt.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(ut<=ft&&ut!==dt||ut===0)return pt=ct,pt;if(It===1)return pt=ct,tt.warn("a maximum of one iteration was insufficient"),-1/0;lt=ct,ot=ut,Dt=1;do Vt=0,Zt=0,qt=0,sr=0,er=0,ir=0,Tt=Rt.retrieve(),xt=Tt.a,vt=Tt.b,_t=Tt.r,Ct=Tt.e,mt=xt,At=.5*(xt+vt),yt=At,bt=vt,Vt=Nt.apply(this,[[mt,At],st,zt]),sr=zt.abserr,zt.resabs,St=zt.resasc,Zt=Nt.apply(this,[[yt,bt],st,zt]),er=zt.abserr,zt.resabs,Et=zt.resasc,qt=Vt+Zt,ir=sr+er,ot+=ir-Ct,lt+=qt-_t,St!==sr&&Et!==er&&(Mt=_t-qt,Math.abs(Mt)<=1e-5*Math.abs(qt)&&ir>=.99*Ct&&Ft++,Dt>=10&&ir>Ct&&Ut++),ft=Math.max(Bt,Ot*Math.abs(lt)),ot>ft&&((Ft>=6||Ut>=20)&&($t=2),Rt.subinterval_too_small(mt,yt,bt)&&($t=3)),Rt.update(mt,At,Vt,sr,yt,bt,Zt,er),Tt=Rt.retrieve(),xt=Tt.a_i,vt=Tt.b_i,_t=Tt.r_i,Ct=Tt.e_i,Dt++;while(Dt<It&&!$t&&ot>ft);return pt=Rt.sum_results(),pt},I:function(nt,st){return this.Qag(nt,st,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(nt,st,at){var lt,ot=0,ct=rt.eps,ut=nt.apply(at,[st]);for(_e.isArray(st)&&(st=st[0]);ot<50&&Math.abs(ut)>ct;)lt=this.D(nt,at)(st),Math.abs(lt)>ct?st-=ut/lt:st+=.2*Math.random()-1,ut=nt.apply(at,[st]),ot+=1;return st},root:function(nt,st,at){return this.fzero(nt,st,at)},generalizedNewton:function(nt,st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t=0;for(this.generalizedNewton.t1memo?(ot=this.generalizedNewton.t1memo,ct=this.generalizedNewton.t2memo):(ot=at,ct=lt),gt=nt.X(ot)-st.X(ct),mt=nt.Y(ot)-st.Y(ct),At=gt*gt+mt*mt,yt=this.D(nt.X,nt),bt=this.D(st.X,st),xt=this.D(nt.Y,nt),vt=this.D(st.Y,st);At>rt.eps&&_t<10;)ut=yt(ot),ht=-bt(ct),dt=xt(ot),pt=-vt(ct),ft=ut*pt-ht*dt,ot-=(pt*gt-ht*mt)/ft,ct-=(ut*mt-dt*gt)/ft,gt=nt.X(ot)-st.X(ct),mt=nt.Y(ot)-st.Y(ct),At=gt*gt+mt*mt,_t+=1;return this.generalizedNewton.t1memo=ot,this.generalizedNewton.t2memo=ct,Math.abs(ot)<Math.abs(ct)?[nt.X(ot),nt.Y(ot)]:[st.X(ct),st.Y(ct)]},Neville:function(nt){var st=[],at=function(lt){return function(ot,ct){var ut,ht,dt,pt=rt.binomial,ft=nt.length,gt=ft-1,mt=0,At=0;if(!ct)for(dt=1,ut=0;ut<ft;ut++)st[ut]=pt(gt,ut)*dt,dt*=-1;for(ht=ot,ut=0;ut<ft;ut++){if(ht===0)return nt[ut][lt]();dt=st[ut]/ht,ht-=1,mt+=nt[ut][lt]()*dt,At+=dt}return mt/At}};return[at("X"),at("Y"),0,function(){return nt.length-1}]},splineDef:function(nt,st){var at,lt,ot,ct=Math.min(nt.length,st.length),ut=[],ht=[],dt=[],pt=[],ft=[],gt=[];if(ct===2)return[0,0];for(lt=0;lt<ct;lt++)at={X:nt[lt],Y:st[lt]},dt.push(at);for(dt.sort(function(mt,At){return mt.X-At.X}),lt=0;lt<ct;lt++)nt[lt]=dt[lt].X,st[lt]=dt[lt].Y;for(lt=0;lt<ct-1;lt++)pt.push(nt[lt+1]-nt[lt]);for(lt=0;lt<ct-2;lt++)ft.push(6*(st[lt+2]-st[lt+1])/pt[lt+1]-6*(st[lt+1]-st[lt])/pt[lt]);for(ut.push(2*(pt[0]+pt[1])),ht.push(ft[0]),lt=0;lt<ct-3;lt++)ot=pt[lt+1]/ut[lt],ut.push(2*(pt[lt+1]+pt[lt+2])-ot*pt[lt+1]),ht.push(ft[lt+1]-ot*ht[lt]);for(gt[ct-3]=ht[ct-3]/ut[ct-3],lt=ct-4;lt>=0;lt--)gt[lt]=(ht[lt]-pt[lt+1]*gt[lt+1])/ut[lt];for(lt=ct-3;lt>=0;lt--)gt[lt+1]=gt[lt];return gt[0]=0,gt[ct-1]=0,gt},splineEval:function(nt,st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt=Math.min(st.length,at.length),mt=1,At=!1,yt=[];for(_e.isArray(nt)?(mt=nt.length,At=!0):nt=[nt],ot=0;ot<mt;ot++){if(nt[ot]<st[0]||st[ot]>st[gt-1])return NaN;for(ct=1;ct<gt&&!(nt[ot]<=st[ct]);ct++);ct-=1,ut=at[ct],ht=(at[ct+1]-at[ct])/(st[ct+1]-st[ct])-(st[ct+1]-st[ct])/6*(lt[ct+1]+2*lt[ct]),dt=lt[ct]/2,pt=(lt[ct+1]-lt[ct])/(6*(st[ct+1]-st[ct])),ft=nt[ot]-st[ct],yt.push(ut+(ht+(dt+pt*ft)*ft)*ft)}return At?yt:yt[0]},generatePolynomialTerm:function(nt,st,at,lt){var ot,ct=[];for(ot=st;ot>=0;ot--)ct=ct.concat(["(",nt[ot].toPrecision(lt),")"]),ot>1?ct=ct.concat(["*",at,"<sup>",ot,"<","/sup> + "]):ot===1&&(ct=ct.concat(["*",at," + "]));return ct.join("")},lagrangePolynomial:function(nt){var st=[],at=function(lt,ot){var ct,ut,ht,dt,pt=nt.length,ft=0,gt=0;if(!ot)for(ct=0;ct<pt;ct++){for(st[ct]=1,ht=nt[ct].X(),ut=0;ut<pt;ut++)ut!==ct&&(st[ct]*=ht-nt[ut].X());st[ct]=1/st[ct]}for(ct=0;ct<pt;ct++){if(ht=nt[ct].X(),lt===ht)return nt[ct].Y();dt=st[ct]/(lt-ht),gt+=dt,ft+=dt*nt[ct].Y()}return ft/gt};return at.getTerm=function(){return""},at},_initCubicPoly:function(nt,st,at,lt){return[nt,at,-3*nt+3*st-2*at-lt,2*nt-2*st+at+lt]},CardinalSpline:function(nt,st,at){var lt,ot,ct,ut,ht=[],dt=this;return ut=_e.isFunction(st)?st:function(){return st},at===void 0&&(at="uniform"),ot=function(pt){return function(ft,gt){var mt,At,yt,bt,xt,vt,_t,Ct,St,Et;if(nt.length<2)return NaN;if(!gt)for(ct=ut(),yt={X:function(){return 2*nt[0].X()-nt[1].X()},Y:function(){return 2*nt[0].Y()-nt[1].Y()},Dist:function(Tt){var Mt=this.X()-Tt.X(),Rt=this.Y()-Tt.Y();return Math.sqrt(Mt*Mt+Rt*Rt)}},bt={X:function(){return 2*nt[nt.length-1].X()-nt[nt.length-2].X()},Y:function(){return 2*nt[nt.length-1].Y()-nt[nt.length-2].Y()},Dist:function(Tt){var Mt=this.X()-Tt.X(),Rt=this.Y()-Tt.Y();return Math.sqrt(Mt*Mt+Rt*Rt)}},lt=[yt].concat(nt,[bt]),Et=lt.length,ht[pt]=[],mt=0;mt<Et-3;mt++)at==="centripetal"?(_t=lt[mt].Dist(lt[mt+1]),Ct=lt[mt+2].Dist(lt[mt+1]),St=lt[mt+3].Dist(lt[mt+2]),_t=Math.sqrt(_t),Ct=Math.sqrt(Ct),St=Math.sqrt(St),Ct<rt.eps&&(Ct=1),_t<rt.eps&&(_t=Ct),St<rt.eps&&(St=Ct),xt=(lt[mt+1][pt]()-lt[mt][pt]())/_t-(lt[mt+2][pt]()-lt[mt][pt]())/(Ct+_t)+(lt[mt+2][pt]()-lt[mt+1][pt]())/Ct,vt=(lt[mt+2][pt]()-lt[mt+1][pt]())/Ct-(lt[mt+3][pt]()-lt[mt+1][pt]())/(St+Ct)+(lt[mt+3][pt]()-lt[mt+2][pt]())/St,xt*=Ct,vt*=Ct,ht[pt][mt]=dt._initCubicPoly(lt[mt+1][pt](),lt[mt+2][pt](),ct*xt,ct*vt)):ht[pt][mt]=dt._initCubicPoly(lt[mt+1][pt](),lt[mt+2][pt](),ct*(lt[mt+2][pt]()-lt[mt][pt]()),ct*(lt[mt+3][pt]()-lt[mt+1][pt]()));return isNaN(ft)?NaN:(Et=nt.length,ft<=0?nt[0][pt]():ft>=Et?nt[Et-1][pt]():(mt=Math.floor(ft))===ft?nt[mt][pt]():(ft-=mt,At=ht[pt][mt],At===void 0?NaN:((At[3]*ft+At[2])*ft+At[1])*ft+At[0]))}},[ot("X"),ot("Y"),0,function(){return nt.length-1}]},CatmullRomSpline:function(nt,st){return this.CardinalSpline(nt,.5,st)},regressionPolynomial:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt="";if(_e.isPoint(nt)&&_e.isFunction(nt.Value))ot=function(){return nt.Value()};else if(_e.isFunction(nt))ot=nt;else{if(!_e.isNumber(nt))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof nt+"'.");ot=function(){return nt}}if(arguments.length===3&&_e.isArray(st)&&_e.isArray(at))ht=0;else if(arguments.length===2&&_e.isArray(st)&&st.length>0&&_e.isPoint(st[0]))ht=1;else{if(!(arguments.length===2&&_e.isArray(st)&&st.length>0&&st[0].usrCoords&&st[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");ht=2}return dt=function(ft,gt){var mt,At,yt,bt,xt,vt,_t,Ct,St,Et=st.length;if(St=Math.floor(ot()),!gt){if(ht===1)for(ct=[],ut=[],mt=0;mt<Et;mt++)ct[mt]=st[mt].X(),ut[mt]=st[mt].Y();if(ht===2)for(ct=[],ut=[],mt=0;mt<Et;mt++)ct[mt]=st[mt].usrCoords[1],ut[mt]=st[mt].usrCoords[2];if(ht===0)for(ct=[],ut=[],mt=0;mt<Et;mt++)_e.isFunction(st[mt])?ct.push(st[mt]()):ct.push(st[mt]),_e.isFunction(at[mt])?ut.push(at[mt]()):ut.push(at[mt]);for(yt=[],At=0;At<Et;At++)yt.push([1]);for(mt=1;mt<=St;mt++)for(At=0;At<Et;At++)yt[At][mt]=yt[At][mt-1]*ct[At];xt=ut,bt=rt.transpose(yt),vt=rt.matMatMult(bt,yt),_t=rt.matVecMult(bt,xt),lt=rt.Numerics.Gauss(vt,_t),pt=rt.Numerics.generatePolynomialTerm(lt,St,"x",3)}for(Ct=lt[St],mt=St-1;mt>=0;mt--)Ct=Ct*ft+lt[mt];return Ct},dt.getTerm=function(){return pt},dt},bezier:function(nt){var st,at,lt=function(ot){return function(ct,ut){var ht=3*Math.floor(ct),dt=ct%1,pt=1-dt;return ut||(at=3*Math.floor((nt.length-1)/3),st=Math.floor(at/3)),ct<0?nt[0][ot]():ct>=st?nt[at][ot]():isNaN(ct)?NaN:pt*pt*(pt*nt[ht][ot]()+3*dt*nt[ht+1][ot]())+(3*pt*nt[ht+2][ot]()+dt*nt[ht+3][ot]())*dt*dt}};return[lt("X"),lt("Y"),0,function(){return Math.floor(nt.length/3)}]},bspline:function(nt,st){var at,lt=[],ot=function(ht,dt){var pt,ft=[];for(pt=0;pt<ht+dt+1;pt++)ft[pt]=pt<dt?0:pt<=ht?pt-dt+1:ht-dt+2;return ft},ct=function(ht,dt,pt,ft,gt){var mt,At,yt,bt,xt,vt=[];for(dt[gt]<=ht&&ht<dt[gt+1]?vt[gt]=1:vt[gt]=0,mt=2;mt<=ft;mt++)for(At=gt-mt+1;At<=gt;At++)yt=At<=gt-mt+1||At<0?0:vt[At],bt=At>=gt?0:vt[At+1],xt=dt[At+mt-1]-dt[At],vt[At]=xt===0?0:(ht-dt[At])/xt*yt,(xt=dt[At+mt]-dt[At+1])!==0&&(vt[At]+=(dt[At+mt]-ht)/xt*bt);return vt},ut=function(ht){return function(dt,pt){var ft,gt,mt,At=nt.length,yt=At-1,bt=st;if(yt<=0)return NaN;if(yt+2<=bt&&(bt=yt+1),dt<=0)return nt[0][ht]();if(dt>=yt-bt+2)return nt[yt][ht]();for(mt=Math.floor(dt)+bt-1,at=ot(yt,bt),lt=ct(dt,at,0,bt,mt),ft=0,gt=mt-bt+1;gt<=mt;gt++)gt<At&&gt>=0&&(ft+=nt[gt][ht]()*lt[gt]);return ft}};return[ut("X"),ut("Y"),0,function(){return nt.length-1}]},D:function(nt,st){return _e.exists(st)?function(at,lt){var ot=1e-5;return(nt.apply(st,[at+ot,lt])-nt.apply(st,[at-ot,lt]))/2e-5}:function(at,lt){var ot=1e-5;return(nt(at+ot,lt)-nt(at-ot,lt))/2e-5}},_riemannValue:function(nt,st,at,lt){var ot,ct,ut,ht;if(lt<0&&(at!=="trapezoidal"&&(nt+=lt),lt*=-1,at==="lower"?at="upper":at==="upper"&&(at="lower")),ht=.01*lt,at==="right")ot=st(nt+lt);else if(at==="middle")ot=st(nt+.5*lt);else if(at==="left"||at==="trapezoidal")ot=st(nt);else if(at==="lower"){for(ot=st(nt),ut=nt+ht;ut<=nt+lt;ut+=ht)(ct=st(ut))<ot&&(ot=ct);ct=st(nt+lt),ct<ot&&(ot=ct)}else if(at==="upper"){for(ot=st(nt),ut=nt+ht;ut<=nt+lt;ut+=ht)(ct=st(ut))>ot&&(ot=ct);ct=st(nt+lt),ct>ot&&(ot=ct)}else ot=at==="random"?st(nt+lt*Math.random()):at==="simpson"?(st(nt)+4*st(nt+.5*lt)+st(nt+lt))/6:st(nt);return ot},riemann:function(nt,st,at,lt,ot){var ct,ut,ht,dt,pt,ft,gt,mt=[],At=[],yt=0,bt=lt,xt=0;if(_e.isArray(nt)?(pt=nt[0],dt=nt[1]):dt=nt,(st=Math.floor(st))<=0)return[mt,At,xt];for(ut=(ot-lt)/st,ct=0;ct<st;ct++)ht=this._riemannValue(bt,dt,at,ut),mt[yt]=bt,At[yt]=ht,yt+=1,bt+=ut,at==="trapezoidal"&&(ht=dt(bt)),mt[yt]=bt,At[yt]=ht,yt+=1;for(ct=0;ct<st;ct++)ht=pt?this._riemannValue(bt,pt,at,-ut):0,mt[yt]=bt,At[yt]=ht,yt+=1,bt-=ut,at==="trapezoidal"&&pt&&(ht=pt(bt)),mt[yt]=bt,At[yt]=ht,at!=="trapezoidal"?(ft=ht,gt=At[2*(st-1)-2*ct]):(gt=.5*(dt(bt+ut)+dt(bt)),ft=pt?.5*(pt(bt+ut)+pt(bt)):0),xt+=(gt-ft)*ut,yt+=1,mt[yt]=bt,At[yt]=At[2*(st-1)-2*ct],yt+=1;return[mt,At,xt]},riemannsum:function(nt,st,at,lt,ot){return tt.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(nt,st,at,lt,ot)[2]},rungeKutta:function(nt,st,at,lt,ot){var ct,ut,ht,dt,pt,ft,gt=[],mt=[],At=(at[1]-at[0])/lt,yt=at[0],bt=st.length,xt=[],vt=0;for(_e.isString(nt)&&(nt=it[nt]||it.euler),ft=nt.s,ct=0;ct<bt;ct++)gt[ct]=st[ct];for(ut=0;ut<lt;ut++){for(xt[vt]=[],ct=0;ct<bt;ct++)xt[vt][ct]=gt[ct];for(vt+=1,dt=[],ht=0;ht<ft;ht++){for(ct=0;ct<bt;ct++)mt[ct]=0;for(pt=0;pt<ht;pt++)for(ct=0;ct<bt;ct++)mt[ct]+=nt.A[ht][pt]*At*dt[pt][ct];for(ct=0;ct<bt;ct++)mt[ct]+=gt[ct];dt.push(ot(yt+nt.c[ht]*At,mt))}for(ct=0;ct<bt;ct++)mt[ct]=0;for(pt=0;pt<ft;pt++)for(ct=0;ct<bt;ct++)mt[ct]+=nt.b[pt]*dt[pt][ct];for(ct=0;ct<bt;ct++)gt[ct]=gt[ct]+At*mt[ct];yt+=At}return xt},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt=rt.eps,Rt=this.maxIterationsRoot,It=0;if(_e.isArray(st)){if(st.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");lt=st[0],ut=nt.call(at,lt),ot=st[1],ht=nt.call(at,ot)}else{for(lt=st,ut=nt.call(at,lt),pt=lt===0?1:lt,ft=[.9*pt,1.1*pt,pt-1,pt+1,.5*pt,1.5*pt,-pt,2*pt,-10*pt,10*pt],mt=ft.length,gt=0;gt<mt&&(ot=ft[gt],ht=nt.call(at,ot),!(ut*ht<=0));gt++);ot<lt&&(At=lt,lt=ot,ot=At,yt=ut,ut=ht,ht=yt)}if(ut*ht>0)return _e.isArray(st)?this.fminbr(nt,[lt,ot],at):this.Newton(nt,lt,at);for(ct=lt,dt=ut;It<Rt;){if(bt=ot-lt,Math.abs(dt)<Math.abs(ht)&&(lt=ot,ot=ct,ct=lt,ut=ht,ht=dt,dt=ut),Ct=2*Mt*Math.abs(ot)+.5*Mt,Tt=.5*(ct-ot),Math.abs(Tt)<=Ct&&Math.abs(ht)<=Mt)return ot;Math.abs(bt)>=Ct&&Math.abs(ut)>Math.abs(ht)&&(vt=ct-ot,lt===ct?(xt=ht/ut,St=vt*xt,Et=1-xt):(Et=ut/dt,xt=ht/dt,_t=ht/ut,St=_t*(vt*Et*(Et-xt)-(ot-lt)*(xt-1)),Et=(Et-1)*(xt-1)*(_t-1)),St>0?Et=-Et:St=-St,St<.75*vt*Et-.5*Math.abs(Ct*Et)&&St<Math.abs(bt*Et*.5)&&(Tt=St/Et)),Math.abs(Tt)<Ct&&(Tt=Tt>0?Ct:-Ct),lt=ot,ut=ht,ot+=Tt,ht=nt.call(at,ot),(ht>0&&dt>0||ht<0&&dt<0)&&(ct=lt,dt=ut),It++}return ot},fminbr:function(nt,st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=.5*(3-Math.sqrt(5)),St=rt.eps,Et=rt.eps,Tt=this.maxIterationsMinimize,Mt=0;if(!_e.isArray(st)||st.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(lt=st[0],ot=st[1],ut=lt+Ct*(ot-lt),pt=nt.call(at,ut),ct=ut,ht=ut,dt=pt,ft=pt;Mt<Tt;){if(gt=ot-lt,mt=.5*(lt+ot),At=Et*Math.abs(ct)+St/3,Math.abs(ct-mt)+.5*gt<=2*At)return ct;yt=Ct*(ct<mt?ot-ct:lt-ct),Math.abs(ct-ht)>=At&&(vt=(ct-ht)*(dt-pt),xt=(ct-ut)*(dt-ft),bt=(ct-ut)*xt-(ct-ht)*vt,xt=2*(xt-vt),xt>0?bt=-bt:xt=-xt,Math.abs(bt)<Math.abs(yt*xt)&&bt>xt*(lt-ct+2*At)&&bt<xt*(ot-ct-2*At)&&(yt=bt/xt)),Math.abs(yt)<At&&(yt=yt>0?At:-At),vt=ct+yt,_t=nt.call(at,vt),_t<=dt?(vt<ct?ot=ct:lt=ct,ut=ht,ht=ct,ct=vt,pt=ft,ft=dt,dt=_t):(vt<ct?lt=vt:ot=vt,_t<=ft||ht===ct?(ut=ht,ht=vt,pt=ft,ft=_t):(_t<=pt||ut===ct||ut===ht)&&(ut=vt,pt=_t)),Mt+=1}return ct},RamerDouglasPeucker:function(nt,st){var at,lt,ot,ct=[],ut=function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt=0,Mt=pt;if(ft-pt<2)return[-1,0];if(At=dt[pt].scrCoords,yt=dt[ft].scrCoords,isNaN(At[1]+At[2]))return[NaN,pt];if(isNaN(yt[1]+yt[2]))return[NaN,ft];for(mt=pt+1;mt<ft;mt++){if(bt=dt[mt].scrCoords,isNaN(bt[1]+bt[2]))return[NaN,mt];xt=bt[1]-At[1],vt=bt[2]-At[2],_t=yt[1]-At[1],Ct=yt[2]-At[2],St=_t*_t+Ct*Ct,St>=rt.eps?(Et=(xt*_t+vt*Ct)/St,Et<0?Et=0:Et>1&&(Et=1),xt-=Et*_t,vt-=Et*Ct,gt=xt*xt+vt*vt):(Et=0,gt=xt*xt+vt*vt),gt>Tt&&(Tt=gt,Mt=mt)}return[Math.sqrt(Tt),Mt]},ht=function(dt,pt,ft,gt,mt){var At=ut(dt,pt,ft),yt=At[1];if(isNaN(At[0])){ht(dt,pt,yt-1,gt,mt),mt.push(dt[yt]);do++yt;while(yt<=ft&&isNaN(dt[yt].scrCoords[1]+dt[yt].scrCoords[2]));yt<=ft&&mt.push(dt[yt]),ht(dt,yt+1,ft,gt,mt)}else At[0]>gt?(ht(dt,pt,yt,gt,mt),ht(dt,yt,ft,gt,mt)):mt.push(dt[ft])};for(ot=nt.length,at=0;at<ot&&isNaN(nt[at].scrCoords[1]+nt[at].scrCoords[2]);)at+=1;for(lt=ot-1;lt>at&&isNaN(nt[lt].scrCoords[1]+nt[lt].scrCoords[2]);)lt-=1;return at>lt||at===ot||(ct[0]=nt[at],ht(nt,at,lt,st,ct)),ct},RamerDouglasPeuker:function(nt,st){return tt.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(nt,st)},Visvalingam:function(nt,st){var at,lt,ot,ct,ut,ht,dt,pt,ft,gt=[],mt=[],At=[];if((lt=nt.length)<=2)return nt;for(gt[0]={used:!0,lft:null,node:null},ut=0,at=1;at<lt-1;at++)ot=Math.abs(tt.Math.Numerics.det([nt[at-1].usrCoords,nt[at].usrCoords,nt[at+1].usrCoords])),isNaN(ot)||(ft={v:ot,idx:at},mt.push(ft),gt[at]={used:!0,lft:ut,node:ft},gt[ut].rt=at,ut=at);for(gt[lt-1]={used:!0,rt:null,lft:ut,node:null},gt[ut].rt=lt-1,ct=-1/0;mt.length>st;)mt.sort(function(yt,bt){return bt.v-yt.v}),at=mt.pop().idx,gt[at].used=!1,ct=gt[at].node.v,ut=gt[at].lft,ht=gt[at].rt,gt[ut].rt=ht,gt[ht].lft=ut,dt=gt[ut].lft,dt!==null&&(ot=Math.abs(tt.Math.Numerics.det([nt[dt].usrCoords,nt[ut].usrCoords,nt[ht].usrCoords])),gt[ut].node.v=ot>=ct?ot:ct),(pt=gt[ht].rt)!==null&&(ot=Math.abs(tt.Math.Numerics.det([nt[ut].usrCoords,nt[ht].usrCoords,nt[pt].usrCoords])),gt[ht].node.v=ot>=ct?ot:ct);at=0,At=[nt[at]];do at=gt[at].rt,At.push(nt[at]);while(gt[at].rt!==null);return At}},rt.Numerics}),define("math/statistics",["jxg","math/math","utils/type"],function(tt,_e,rt){return _e.Statistics={sum:function(it){var nt,st=it.length,at=0;for(nt=0;nt<st;nt++)at+=it[nt];return at},prod:function(it){var nt,st=it.length,at=1;for(nt=0;nt<st;nt++)at*=it[nt];return at},mean:function(it){return it.length>0?this.sum(it)/it.length:0},median:function(it){var nt,st;return it.length>0?(nt=it.slice(0),nt.sort(function(at,lt){return at-lt}),st=nt.length,st%2==1?nt[parseInt(.5*st,10)]:.5*(nt[.5*st-1]+nt[.5*st])):0},variance:function(it){var nt,st,at,lt=it.length;if(lt>1){for(nt=this.mean(it),st=0,at=0;at<lt;at++)st+=(it[at]-nt)*(it[at]-nt);return st/(it.length-1)}return 0},sd:function(it){return Math.sqrt(this.variance(it))},weightedMean:function(it,nt){if(it.length!==nt.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return it.length>0?this.mean(this.multiply(it,nt)):0},max:function(it){return Math.max.apply(this,it)},min:function(it){return Math.min.apply(this,it)},range:function(it){return[this.min(it),this.max(it)]},abs:function(it){var nt,st,at;if(rt.isArray(it))for(st=it.length,at=[],nt=0;nt<st;nt++)at[nt]=Math.abs(it[nt]);else at=Math.abs(it);return at},add:function(it,nt){var st,at,lt=[];if(it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(at=it.length,st=0;st<at;st++)lt[st]=it[st]+nt;else if(rt.isNumber(it)&&rt.isArray(nt))for(at=nt.length,st=0;st<at;st++)lt[st]=it+nt[st];else if(rt.isArray(it)&&rt.isArray(nt))for(at=Math.min(it.length,nt.length),st=0;st<at;st++)lt[st]=it[st]+nt[st];else lt=it+nt;return lt},div:function(it,nt){var st,at,lt=[];if(it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(at=it.length,st=0;st<at;st++)lt[st]=it[st]/nt;else if(rt.isNumber(it)&&rt.isArray(nt))for(at=nt.length,st=0;st<at;st++)lt[st]=it/nt[st];else if(rt.isArray(it)&&rt.isArray(nt))for(at=Math.min(it.length,nt.length),st=0;st<at;st++)lt[st]=it[st]/nt[st];else lt=it/nt;return lt},divide:function(){tt.deprecated("Statistics.divide()","Statistics.div()"),_e.Statistics.div.apply(_e.Statistics,arguments)},mod:function(it,nt,st){var at,lt,ot=[],ct=function(ut,ht){return ut%ht};if(st=rt.def(st,!1),st&&(ct=_e.mod),it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(lt=it.length,at=0;at<lt;at++)ot[at]=ct(it[at],nt);else if(rt.isNumber(it)&&rt.isArray(nt))for(lt=nt.length,at=0;at<lt;at++)ot[at]=ct(it,nt[at]);else if(rt.isArray(it)&&rt.isArray(nt))for(lt=Math.min(it.length,nt.length),at=0;at<lt;at++)ot[at]=ct(it[at],nt[at]);else ot=ct(it,nt);return ot},multiply:function(it,nt){var st,at,lt=[];if(it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(at=it.length,st=0;st<at;st++)lt[st]=it[st]*nt;else if(rt.isNumber(it)&&rt.isArray(nt))for(at=nt.length,st=0;st<at;st++)lt[st]=it*nt[st];else if(rt.isArray(it)&&rt.isArray(nt))for(at=Math.min(it.length,nt.length),st=0;st<at;st++)lt[st]=it[st]*nt[st];else lt=it*nt;return lt},subtract:function(it,nt){var st,at,lt=[];if(it=rt.evalSlider(it),nt=rt.evalSlider(nt),rt.isArray(it)&&rt.isNumber(nt))for(at=it.length,st=0;st<at;st++)lt[st]=it[st]-nt;else if(rt.isNumber(it)&&rt.isArray(nt))for(at=nt.length,st=0;st<at;st++)lt[st]=it-nt[st];else if(rt.isArray(it)&&rt.isArray(nt))for(at=Math.min(it.length,nt.length),st=0;st<at;st++)lt[st]=it[st]-nt[st];else lt=it-nt;return lt},TheilSenRegression:function(it){var nt,st,at=[],lt=[],ot=[];for(nt=0;nt<it.length;nt++){for(lt.length=0,st=0;st<it.length;st++)Math.abs(it[st].usrCoords[1]-it[nt].usrCoords[1])>_e.eps&&(lt[st]=(it[st].usrCoords[2]-it[nt].usrCoords[2])/(it[st].usrCoords[1]-it[nt].usrCoords[1]));at[nt]=this.median(lt),ot.push(it[nt].usrCoords[2]-at[nt]*it[nt].usrCoords[1])}return[this.median(ot),this.median(at),-1]}},_e.Statistics}),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],function(tt,_e,rt,it,nt,st,at){return it.Geometry={},tt.extend(it.Geometry,{angle:function(lt,ot,ct){var ut,ht,dt,pt,ft=[],gt=[],mt=[];return tt.deprecated("Geometry.angle()","Geometry.rad()"),lt.coords?(ft[0]=lt.coords.usrCoords[1],ft[1]=lt.coords.usrCoords[2]):(ft[0]=lt[0],ft[1]=lt[1]),ot.coords?(gt[0]=ot.coords.usrCoords[1],gt[1]=ot.coords.usrCoords[2]):(gt[0]=ot[0],gt[1]=ot[1]),ct.coords?(mt[0]=ct.coords.usrCoords[1],mt[1]=ct.coords.usrCoords[2]):(mt[0]=ct[0],mt[1]=ct[1]),ut=ft[0]-gt[0],ht=ft[1]-gt[1],dt=mt[0]-gt[0],pt=mt[1]-gt[1],Math.atan2(ut*pt-ht*dt,ut*dt+ht*pt)},trueAngle:function(lt,ot,ct){return 57.29577951308232*this.rad(lt,ot,ct)},rad:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt;return lt.coords?(ut=lt.coords.usrCoords[1],ht=lt.coords.usrCoords[2]):(ut=lt[0],ht=lt[1]),ot.coords?(dt=ot.coords.usrCoords[1],pt=ot.coords.usrCoords[2]):(dt=ot[0],pt=ot[1]),ct.coords?(ft=ct.coords.usrCoords[1],gt=ct.coords.usrCoords[2]):(ft=ct[0],gt=ct[1]),mt=Math.atan2(gt-pt,ft-dt)-Math.atan2(ht-pt,ut-dt),mt<0&&(mt+=6.283185307179586),mt},angleBisector:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt=lt.coords.usrCoords,At=ot.coords.usrCoords,yt=ct.coords.usrCoords;return st.exists(ut)||(ut=lt.board),At[0]===0?new rt(_e.COORDS_BY_USER,[1,.5*(mt[1]+yt[1]),.5*(mt[2]+yt[2])],ut):(ft=mt[1]-At[1],gt=mt[2]-At[2],ht=Math.atan2(gt,ft),ft=yt[1]-At[1],gt=yt[2]-At[2],dt=Math.atan2(gt,ft),pt=.5*(ht+dt),ht>dt&&(pt+=Math.PI),ft=Math.cos(pt)+At[1],gt=Math.sin(pt)+At[2],new rt(_e.COORDS_BY_USER,[1,ft,gt],ut))},reflection:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At=ot.coords.usrCoords,yt=lt.point1.coords.usrCoords,bt=lt.point2.coords.usrCoords;return st.exists(ct)||(ct=ot.board),ft=bt[1]-yt[1],gt=bt[2]-yt[2],ut=At[1]-yt[1],ht=At[2]-yt[2],mt=(ft*ht-gt*ut)/(ft*ft+gt*gt),dt=At[1]+2*mt*gt,pt=At[2]-2*mt*ft,new rt(_e.COORDS_BY_USER,[dt,pt],ct)},rotation:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At=ot.coords.usrCoords,yt=lt.coords.usrCoords;return st.exists(ut)||(ut=ot.board),ht=At[1]-yt[1],dt=At[2]-yt[2],pt=Math.cos(ct),ft=Math.sin(ct),gt=ht*pt-dt*ft+yt[1],mt=ht*ft+dt*pt+yt[2],new rt(_e.COORDS_BY_USER,[gt,mt],ut)},perpendicular:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt=lt.point1.coords.usrCoords,mt=lt.point2.coords.usrCoords,At=ot.coords.usrCoords;return st.exists(ct)||(ct=ot.board),ot===lt.point1?(ut=gt[1]+mt[2]-gt[2],ht=gt[2]-mt[1]+gt[1],ft=gt[0]*mt[0],Math.abs(ft)<it.eps&&(ut=mt[2],ht=-mt[1]),pt=[ft,ut,ht],dt=!0):ot===lt.point2?(ut=mt[1]+gt[2]-mt[2],ht=mt[2]-gt[1]+mt[1],ft=gt[0]*mt[0],Math.abs(ft)<it.eps&&(ut=gt[2],ht=-gt[1]),pt=[ft,ut,ht],dt=!1):Math.abs(it.innerProduct(At,lt.stdform,3))<it.eps?(ut=At[1]+mt[2]-At[2],ht=At[2]-mt[1]+At[1],ft=mt[0],Math.abs(ft)<it.eps&&(ut=mt[2],ht=-mt[1]),dt=!0,Math.abs(ft)>it.eps&&Math.abs(ut-At[1])<it.eps&&Math.abs(ht-At[2])<it.eps&&(ut=At[1]+gt[2]-At[2],ht=At[2]-gt[1]+At[1],dt=!1),pt=[ft,ut,ht]):(pt=[0,lt.stdform[1],lt.stdform[2]],pt=it.crossProduct(pt,At),pt=it.crossProduct(pt,lt.stdform),dt=!0),[new rt(_e.COORDS_BY_USER,pt,ct),dt]},circumcenterMidpoint:function(){tt.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt=lt.coords.usrCoords,mt=ot.coords.usrCoords,At=ct.coords.usrCoords;return st.exists(ut)||(ut=lt.board),ht=[mt[0]-gt[0],-mt[2]+gt[2],mt[1]-gt[1]],dt=[.5*(gt[0]+mt[0]),.5*(gt[1]+mt[1]),.5*(gt[2]+mt[2])],pt=it.crossProduct(ht,dt),ht=[At[0]-mt[0],-At[2]+mt[2],At[1]-mt[1]],dt=[.5*(mt[0]+At[0]),.5*(mt[1]+At[1]),.5*(mt[2]+At[2])],ft=it.crossProduct(ht,dt),new rt(_e.COORDS_BY_USER,it.crossProduct(pt,ft),ut)},distance:function(lt,ot,ct){var ut,ht=0;for(ct||(ct=Math.min(lt.length,ot.length)),ut=0;ut<ct;ut++)ht+=(lt[ut]-ot[ut])*(lt[ut]-ot[ut]);return Math.sqrt(ht)},affineDistance:function(lt,ot,ct){var ut;return ut=this.distance(lt,ot,ct),ut>it.eps&&(Math.abs(lt[0])<it.eps||Math.abs(ot[0])<it.eps)?1/0:ut},sortVertices:function(lt){var ot,ct,ut=at.each(lt,at.coordsArray),ht=ut.length;for(ot=1;ot<ht;ot++)(ut[ot][2]<ut[0][2]||Math.abs(ut[ot][2]-ut[0][2])<it.eps&&ut[ot][1]<ut[0][1])&&(ut=st.swap(ut,ot,0));return ct=ut.shift(),ut.sort(function(dt,pt){return Math.atan2(dt[2]-ct[2],dt[1]-ct[1])-Math.atan2(pt[2]-ct[2],pt[1]-ct[1])}),ut.unshift(ct),ut.unshift(ut[ut.length-1]),ut},signedTriangle:function(lt,ot,ct){var ut=at.coordsArray(lt),ht=at.coordsArray(ot),dt=at.coordsArray(ct);return .5*((ht[1]-ut[1])*(dt[2]-ut[2])-(ht[2]-ut[2])*(dt[1]-ut[1]))},signedPolygon:function(lt,ot){var ct,ut,ht=0,dt=at.each(lt,at.coordsArray);for(ot===void 0&&(ot=!0),ot?dt.unshift(dt[dt.length-1]):dt=this.sortVertices(dt),ut=dt.length,ct=1;ct<ut;ct++)ht+=dt[ct-1][1]*dt[ct][2]-dt[ct][1]*dt[ct-1][2];return .5*ht},GrahamScan:function(lt){var ot,ct=1,ut=at.each(lt,at.coordsArray),ht=ut.length;for(ut=this.sortVertices(ut),ht=ut.length,ot=2;ot<ht;ot++){for(;this.signedTriangle(ut[ct-1],ut[ct],ut[ot])<=0;)if(ct>1)ct-=1;else{if(ot===ht-1)break;ot+=1}ct+=1,ut=st.swap(ut,ct,ot)}return ut.slice(0,ct)},calcStraight:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt;if(st.exists(ut)||(ut=10),mt=st.evaluate(lt.visProp.straightfirst),At=st.evaluate(lt.visProp.straightlast),Math.abs(ot.scrCoords[0])<it.eps&&(mt=!0),Math.abs(ct.scrCoords[0])<it.eps&&(At=!0),(mt||At)&&(yt=[],yt[0]=lt.stdform[0]-lt.stdform[1]*lt.board.origin.scrCoords[1]/lt.board.unitX+lt.stdform[2]*lt.board.origin.scrCoords[2]/lt.board.unitY,yt[1]=lt.stdform[1]/lt.board.unitX,yt[2]=-lt.stdform[2]/lt.board.unitY,!isNaN(yt[0]+yt[1]+yt[2]))){if(ht=!1,dt=!1,ht=!mt&&Math.abs(ot.usrCoords[0])>=it.eps&&ot.scrCoords[1]>=0&&ot.scrCoords[1]<=lt.board.canvasWidth&&ot.scrCoords[2]>=0&&ot.scrCoords[2]<=lt.board.canvasHeight,dt=!At&&Math.abs(ct.usrCoords[0])>=it.eps&&ct.scrCoords[1]>=0&&ct.scrCoords[1]<=lt.board.canvasWidth&&ct.scrCoords[2]>=0&&ct.scrCoords[2]<=lt.board.canvasHeight,pt=this.meetLineBoard(yt,lt.board,ut),ft=pt[0],gt=pt[1],!ht&&!dt&&(!mt&&At&&!this.isSameDirection(ot,ct,ft)&&!this.isSameDirection(ot,ct,gt)||mt&&!At&&!this.isSameDirection(ct,ot,ft)&&!this.isSameDirection(ct,ot,gt)))return;ht?dt||(xt=this.isSameDir(ot,ct,ft,gt)?gt:ft):dt?bt=this.isSameDir(ot,ct,ft,gt)?ft:gt:this.isSameDir(ot,ct,ft,gt)?(bt=ft,xt=gt):(xt=ft,bt=gt),bt&&ot.setCoordinates(_e.COORDS_BY_USER,bt.usrCoords),xt&&ct.setCoordinates(_e.COORDS_BY_USER,xt.usrCoords)}},calcLineDelimitingPoints:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt=!1,vt=!1;if(gt=st.evaluate(lt.visProp.straightfirst),mt=st.evaluate(lt.visProp.straightlast),Math.abs(ot.scrCoords[0])<it.eps&&(gt=!0),Math.abs(ct.scrCoords[0])<it.eps&&(mt=!0),At=[],At[0]=lt.stdform[0]-lt.stdform[1]*lt.board.origin.scrCoords[1]/lt.board.unitX+lt.stdform[2]*lt.board.origin.scrCoords[2]/lt.board.unitY,At[1]=lt.stdform[1]/lt.board.unitX,At[2]=-lt.stdform[2]/lt.board.unitY,!isNaN(At[0]+At[1]+At[2])){if(xt=!gt,vt=!mt,ht=lt.board.getBoundingBox(),dt=lt.getSlope(),dt>=0?(pt=this.projectPointToLine({coords:{usrCoords:[1,ht[2],ht[1]]}},lt,lt.board),ft=this.projectPointToLine({coords:{usrCoords:[1,ht[0],ht[3]]}},lt,lt.board)):(pt=this.projectPointToLine({coords:{usrCoords:[1,ht[0],ht[1]]}},lt,lt.board),ft=this.projectPointToLine({coords:{usrCoords:[1,ht[2],ht[3]]}},lt,lt.board)),!xt&&!vt&&(!gt&&!mt&&(ut=ot.distance(_e.COORDS_BY_USER,ct),Math.abs(ot.distance(_e.COORDS_BY_USER,pt)+pt.distance(_e.COORDS_BY_USER,ct)-ut)>it.eps||Math.abs(ot.distance(_e.COORDS_BY_USER,ft)+ft.distance(_e.COORDS_BY_USER,ct)-ut)>it.eps)||!gt&&mt&&!this.isSameDirection(ot,ct,pt)&&!this.isSameDirection(ot,ct,ft)||gt&&!mt&&!this.isSameDirection(ct,ot,pt)&&!this.isSameDirection(ct,ot,ft)))return;xt?vt||(bt=this.isSameDir(ot,ct,pt,ft)?ft:pt):vt?yt=this.isSameDir(ot,ct,pt,ft)?pt:ft:this.isSameDir(ot,ct,pt,ft)?(yt=pt,bt=ft):(bt=pt,yt=ft),yt&&ot.setCoordinates(_e.COORDS_BY_USER,yt.usrCoords),bt&&ct.setCoordinates(_e.COORDS_BY_USER,bt.usrCoords)}},calcLabelQuadrant:function(lt){var ot;return lt<0&&(lt+=2*Math.PI),ot=Math.floor((lt+Math.PI/8)/(Math.PI/4))%8,["rt","urt","top","ulft","lft","llft","lrt"][ot]},isSameDir:function(lt,ot,ct,ut){var ht=ot.usrCoords[1]-lt.usrCoords[1],dt=ot.usrCoords[2]-lt.usrCoords[2],pt=ut.usrCoords[1]-ct.usrCoords[1],ft=ut.usrCoords[2]-ct.usrCoords[2];return Math.abs(ot.usrCoords[0])<it.eps&&(ht=ot.usrCoords[1],dt=ot.usrCoords[2]),Math.abs(lt.usrCoords[0])<it.eps&&(ht=-lt.usrCoords[1],dt=-lt.usrCoords[2]),ht*pt+dt*ft>=0},isSameDirection:function(lt,ot,ct){var ut,ht,dt,pt,ft=!1;return ut=ot.usrCoords[1]-lt.usrCoords[1],ht=ot.usrCoords[2]-lt.usrCoords[2],dt=ct.usrCoords[1]-lt.usrCoords[1],pt=ct.usrCoords[2]-lt.usrCoords[2],Math.abs(ut)<it.eps&&(ut=0),Math.abs(ht)<it.eps&&(ht=0),Math.abs(dt)<it.eps&&(dt=0),Math.abs(pt)<it.eps&&(pt=0),(ut>=0&&dt>=0||ut<=0&&dt<=0)&&(ft=ht>=0&&pt>=0||ht<=0&&pt<=0),ft},intersectionFunction:function(lt,ot,ct,ut,ht,dt){var pt=this;return ot.elementClass===_e.OBJECT_CLASS_CURVE&&ct.elementClass===_e.OBJECT_CLASS_CURVE?function(){return pt.meetCurveCurve(ot,ct,ut,ht,ot.board)}:ot.elementClass===_e.OBJECT_CLASS_CURVE&&ct.elementClass===_e.OBJECT_CLASS_LINE||ct.elementClass===_e.OBJECT_CLASS_CURVE&&ot.elementClass===_e.OBJECT_CLASS_LINE?function(){return pt.meetCurveLine(ot,ct,ut,ot.board,dt)}:ot.elementClass===_e.OBJECT_CLASS_LINE&&ct.elementClass===_e.OBJECT_CLASS_LINE?function(){var ft,gt,mt,At,yt,bt;return mt=At=st.evaluate(ot.visProp.straightfirst),yt=bt=st.evaluate(ot.visProp.straightlast),st.evaluate(dt)||mt&&yt&&At&&bt?pt.meet(ot.stdform,ct.stdform,ut,ot.board):(ft=pt.meetSegmentSegment(ot.point1.coords.usrCoords,ot.point2.coords.usrCoords,ct.point1.coords.usrCoords,ct.point2.coords.usrCoords,ot.board),gt=!mt&&ft[1]<0||!yt&&ft[1]>1||!At&&ft[2]<0||!bt&&ft[2]>1?[0,NaN,NaN]:ft[0],new rt(_e.COORDS_BY_USER,gt,ot.board))}:function(){return pt.meet(ot.stdform,ct.stdform,ut,ot.board)}},meet:function(lt,ot,ct,ut){var ht=it.eps;return Math.abs(lt[3])<ht&&Math.abs(ot[3])<ht?this.meetLineLine(lt,ot,ct,ut):Math.abs(lt[3])>=ht&&Math.abs(ot[3])<ht?this.meetLineCircle(ot,lt,ct,ut):Math.abs(lt[3])<ht&&Math.abs(ot[3])>=ht?this.meetLineCircle(lt,ot,ct,ut):this.meetCircleCircle(lt,ot,ct,ut)},meetLineBoard:function(lt,ot,ct){var ut,ht,dt,pt,ft=[];for(st.exists(ct)||(ct=0),ft[0]=it.crossProduct(lt,[ct,0,1]),ft[1]=it.crossProduct(lt,[ct,1,0]),ft[2]=it.crossProduct(lt,[-ct-ot.canvasHeight,0,1]),ft[3]=it.crossProduct(lt,[-ct-ot.canvasWidth,1,0]),dt=0;dt<4;dt++)if(Math.abs(ft[dt][0])>it.eps){for(pt=2;pt>0;pt--)ft[dt][pt]/=ft[dt][0];ft[dt][0]=1}return Math.abs(ft[1][0])<it.eps?(ut=ft[0],ht=ft[2]):Math.abs(ft[0][0])<it.eps?(ut=ft[1],ht=ft[3]):ft[1][2]<0?(ut=ft[0],ht=ft[3][2]>ot.canvasHeight?ft[2]:ft[3]):ft[1][2]>ot.canvasHeight?(ut=ft[2],ht=ft[3][2]<0?ft[0]:ft[3]):(ut=ft[1],ht=ft[3][2]<0?ft[0]:ft[3][2]>ot.canvasHeight?ft[2]:ft[3]),ut=new rt(_e.COORDS_BY_SCREEN,ut.slice(1),ot),ht=new rt(_e.COORDS_BY_SCREEN,ht.slice(1),ot),[ut,ht]},meetLineLine:function(lt,ot,ct,ut){var ht=isNaN(lt[5]+ot[5])?[0,0,0]:it.crossProduct(lt,ot);return new rt(_e.COORDS_BY_USER,ht,ut)},meetLineCircle:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt;return ot[4]<it.eps?Math.abs(it.innerProduct([1,ot[6],ot[7]],lt,3))<it.eps?new rt(_e.COORDS_BY_USER,ot.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[NaN,NaN],ut):(pt=ot[0],dt=ot.slice(1,3),ht=ot[3],ft=lt[0],gt=lt.slice(1,3),mt=ht,At=dt[0]*gt[1]-dt[1]*gt[0],yt=ht*ft*ft-(dt[0]*gt[0]+dt[1]*gt[1])*ft+pt,bt=At*At-4*mt*yt,bt>-it.eps*it.eps?(bt=Math.sqrt(Math.abs(bt)),xt=[(-At+bt)/(2*mt),(-At-bt)/(2*mt)],ct===0?new rt(_e.COORDS_BY_USER,[-xt[0]*-gt[1]-ft*gt[0],-xt[0]*gt[0]-ft*gt[1]],ut):new rt(_e.COORDS_BY_USER,[-xt[1]*-gt[1]-ft*gt[0],-xt[1]*gt[0]-ft*gt[1]],ut)):new rt(_e.COORDS_BY_USER,[0,0,0],ut))},meetCircleCircle:function(lt,ot,ct,ut){var ht;return lt[4]<it.eps?Math.abs(this.distance(lt.slice(6,2),ot.slice(6,8))-ot[4])<it.eps?new rt(_e.COORDS_BY_USER,lt.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[0,0,0],ut):ot[4]<it.eps?Math.abs(this.distance(ot.slice(6,2),lt.slice(6,8))-lt[4])<it.eps?new rt(_e.COORDS_BY_USER,ot.slice(6,8),ut):new rt(_e.COORDS_BY_USER,[0,0,0],ut):(ht=[ot[3]*lt[0]-lt[3]*ot[0],ot[3]*lt[1]-lt[3]*ot[1],ot[3]*lt[2]-lt[3]*ot[2],0,1,1/0,1/0,1/0],ht=it.normalize(ht),this.meetLineCircle(ht,lt,ct,ut))},meetCurveCurve:function(lt,ot,ct,ut,ht,dt){var pt;return pt=st.exists(dt)&&dt==="newton"?nt.generalizedNewton(lt,ot,ct,ut):lt.bezierDegree===3&&ot.bezierDegree===3?this.meetBezierCurveRedBlueSegments(lt,ot,ct):this.meetCurveRedBlueSegments(lt,ot,ct),new rt(_e.COORDS_BY_USER,pt,ht)},meetCurveLine:function(lt,ot,ct,ut,ht){var dt,pt;return st.exists(ut)||(ut=lt.board),lt.elementClass===_e.OBJECT_CLASS_CURVE?(dt=lt,pt=ot):(dt=ot,pt=lt),this.meetCurveLineDiscrete(dt,pt,ct,ut,!ht)},meetCurveLineContinuous:function(lt,ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt=it.eps,Mt=it.eps;for(gt=this.meetCurveLineDiscrete(lt,ot,ct,ut,ht),mt=gt.usrCoords[1],At=gt.usrCoords[2],pt=function(Rt){var It,Ot;return Rt>lt.maxX()||Rt<lt.minX()?1/0:(It=mt-lt.X(Rt),Ot=At-lt.Y(Rt),It*It+Ot*Ot)},ft=function(Rt){var It=ot.stdform[0]+ot.stdform[1]*lt.X(Rt)+ot.stdform[2]*lt.Y(Rt);return It*It},bt=50,xt=(lt.maxX()-lt.minX())/bt,vt=lt.minX(),St=1e-4,Ct=NaN,_t=0;_t<bt&&(dt=nt.root(pt,[Math.max(vt,lt.minX()),Math.min(vt+xt,lt.maxX())]),!((Et=Math.abs(pt(dt)))<=St&&(St=Et,Ct=dt,St<Tt)));_t++)vt+=xt;return dt=Ct,dt=nt.root(ft,[Math.max(dt-xt,lt.minX()),Math.min(dt+xt,lt.maxX())]),Et=ft(dt),yt=isNaN(Et)||Math.abs(Et)>Mt?0:1,new rt(_e.COORDS_BY_USER,[yt,lt.X(dt),lt.Y(dt)],ut)},meetCurveLineContinuousOld:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=10*it.eps;if(tt.deprecated("Geometry.meetCurveLineContinuousOld()","Geometry.meetCurveLineContinuous()"),ft=function(St){var Et=ot.stdform[0]+ot.stdform[1]*lt.X(St)+ot.stdform[2]*lt.Y(St);return Et*Et},this.meetCurveLineContinuous.t1memo?(bt=this.meetCurveLineContinuous.t1memo,ht=nt.root(ft,bt)):(bt=lt.minX(),xt=lt.maxX(),ht=nt.root(ft,[bt,xt])),this.meetCurveLineContinuous.t1memo=ht,vt=lt.X(ht),_t=lt.Y(ht),ct===1){if(this.meetCurveLineContinuous.t2memo&&(bt=this.meetCurveLineContinuous.t2memo),dt=nt.root(ft,bt),!(Math.abs(dt-ht)>.1&&Math.abs(vt-lt.X(dt))>.1&&Math.abs(_t-lt.Y(dt))>.1))for(At=20,yt=(lt.maxX()-lt.minX())/At,mt=lt.minX(),pt=0;pt<At&&(dt=nt.root(ft,[mt,mt+yt]),!(Math.abs(ft(dt))<=Ct&&Math.abs(dt-ht)>.1&&Math.abs(vt-lt.X(dt))>.1&&Math.abs(_t-lt.Y(dt))>.1));pt++)mt+=yt;ht=dt,this.meetCurveLineContinuous.t2memo=ht}return gt=Math.abs(ft(ht))>Ct?NaN:1,new rt(_e.COORDS_BY_USER,[gt,lt.X(ht),lt.Y(ht)],ut)},meetCurveLineDiscrete:function(lt,ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt=ot.point1.coords.usrCoords,xt=ot.point2.coords.usrCoords,vt=0,_t=lt.numberPoints,Ct=st.evaluate(ot.visProp.straightfirst),St=st.evaluate(ot.visProp.straightlast);for(At=new rt(_e.COORDS_BY_USER,[0,NaN,NaN],ut),bt[0]===0?bt=[1,xt[1]+ot.stdform[2],xt[2]-ot.stdform[1]]:xt[0]===0&&(xt=[1,bt[1]+ot.stdform[2],bt[2]-ot.stdform[1]]),gt=lt.points[0].usrCoords,dt=1;dt<_t;dt++)if(ft=gt.slice(0),gt=lt.points[dt].usrCoords,this.distance(ft,gt)>it.eps){for(lt.bezierDegree===3?(yt=this.meetBeziersegmentBeziersegment([lt.points[dt-1].usrCoords.slice(1),lt.points[dt].usrCoords.slice(1),lt.points[dt+1].usrCoords.slice(1),lt.points[dt+2].usrCoords.slice(1)],[bt.slice(1),xt.slice(1)],ht),dt+=2):yt=[this.meetSegmentSegment(ft,gt,bt,xt)],pt=0;pt<yt.length;pt++)if(mt=yt[pt],0<=mt[1]&&mt[1]<=1){if(vt===ct)return ht&&(!Ct&&mt[2]<0||!St&&mt[2]>1)?At:At=new rt(_e.COORDS_BY_USER,mt[0],ut);vt+=1}}return At},meetCurveRedBlueSegments:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt=0,xt=ot.numberPoints,vt=lt.numberPoints;if(xt<=1||vt<=1)return[0,NaN,NaN];for(ut=1;ut<vt;ut++)for(dt=lt.points[ut-1].usrCoords,pt=lt.points[ut].usrCoords,At=Math.min(dt[1],pt[1]),yt=Math.max(dt[1],pt[1]),gt=ot.points[0].usrCoords,ht=1;ht<xt;ht++)if(ft=gt,gt=ot.points[ht].usrCoords,Math.min(ft[1],gt[1])<yt&&Math.max(ft[1],gt[1])>At&&(mt=this.meetSegmentSegment(dt,pt,ft,gt),mt[1]>=0&&mt[2]>=0&&(mt[1]<1&&mt[2]<1||ut===vt-1&&mt[1]===1||ht===xt-1&&mt[2]===1))){if(bt===ct)return mt[0];bt++}return[0,NaN,NaN]},meetSegmentSegment:function(lt,ot,ct,ut){var ht,dt,pt,ft=it.crossProduct(lt,ot),gt=it.crossProduct(ct,ut),mt=it.crossProduct(ft,gt),At=mt[0];return Math.abs(At)<it.eps?[mt,1/0,1/0]:(pt=[ct[1]-lt[1],ct[2]-lt[2]],ht=(pt[0]*(ut[2]-ct[2])-pt[1]*(ut[1]-ct[1]))/At,dt=(pt[0]*(ot[2]-lt[2])-pt[1]*(ot[1]-lt[1]))/At,[mt,ht,dt])},_bezierSplit:function(lt){var ot,ct,ut,ht,dt,pt;return ot=[.5*(lt[0][0]+lt[1][0]),.5*(lt[0][1]+lt[1][1])],ct=[.5*(lt[1][0]+lt[2][0]),.5*(lt[1][1]+lt[2][1])],ut=[.5*(lt[2][0]+lt[3][0]),.5*(lt[2][1]+lt[3][1])],ht=[.5*(ot[0]+ct[0]),.5*(ot[1]+ct[1])],dt=[.5*(ct[0]+ut[0]),.5*(ct[1]+ut[1])],pt=[.5*(ht[0]+dt[0]),.5*(ht[1]+dt[1])],[[lt[0],ot,ht,pt],[pt,dt,ut,lt[3]]]},_bezierBbox:function(lt){var ot=[];return lt.length===4?(ot[0]=Math.min(lt[0][0],lt[1][0],lt[2][0],lt[3][0]),ot[1]=Math.max(lt[0][1],lt[1][1],lt[2][1],lt[3][1]),ot[2]=Math.max(lt[0][0],lt[1][0],lt[2][0],lt[3][0]),ot[3]=Math.min(lt[0][1],lt[1][1],lt[2][1],lt[3][1])):(ot[0]=Math.min(lt[0][0],lt[1][0]),ot[1]=Math.max(lt[0][1],lt[1][1]),ot[2]=Math.max(lt[0][0],lt[1][0]),ot[3]=Math.min(lt[0][1],lt[1][1])),ot},_bezierOverlap:function(lt,ot){return lt[2]>=ot[0]&&lt[0]<=ot[2]&&lt[1]>=ot[3]&&lt[3]<=ot[1]},_bezierListConcat:function(lt,ot,ct,ut){var ht,dt=st.exists(ut),pt=0,ft=ot.length,gt=lt.length;for(gt>0&&ft>0&&(lt[gt-1][1]===1&&ot[0][1]===0||dt&&lt[gt-1][2]===1&&ot[0][2]===0)&&(pt=1),ht=pt;ht<ft;ht++)dt&&(ot[ht][2]*=.5,ot[ht][2]+=ut),ot[ht][1]*=.5,ot[ht][1]+=ct,lt.push(ot[ht])},_bezierMeetSubdivision:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t=[];return ht=this._bezierBbox(ot),ut=this._bezierBbox(lt),this._bezierOverlap(ht,ut)?ct<5?(dt=this._bezierSplit(lt),gt=dt[0],mt=dt[1],dt=this._bezierSplit(ot),pt=dt[0],ft=dt[1],this._bezierListConcat(_t,this._bezierMeetSubdivision(gt,pt,ct+1),0,0),this._bezierListConcat(_t,this._bezierMeetSubdivision(gt,ft,ct+1),0,.5),this._bezierListConcat(_t,this._bezierMeetSubdivision(mt,pt,ct+1),.5,0),this._bezierListConcat(_t,this._bezierMeetSubdivision(mt,ft,ct+1),.5,.5),_t):(xt=[1].concat(lt[0]),vt=[1].concat(lt[3]),yt=[1].concat(ot[0]),bt=[1].concat(ot[3]),At=this.meetSegmentSegment(xt,vt,yt,bt),At[1]>=0&&At[2]>=0&&At[1]<=1&&At[2]<=1?[At]:[]):[]},_bezierLineMeetSubdivision:function(lt,ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt=[];return ht=this._bezierBbox(ot),dt=this._bezierBbox(lt),ut&&!this._bezierOverlap(dt,ht)?[]:ct<5?(pt=this._bezierSplit(lt),ft=pt[0],gt=pt[1],this._bezierListConcat(vt,this._bezierLineMeetSubdivision(ft,ot,ct+1),0),this._bezierListConcat(vt,this._bezierLineMeetSubdivision(gt,ot,ct+1),.5),vt):(bt=[1].concat(lt[0]),xt=[1].concat(lt[3]),At=[1].concat(ot[0]),yt=[1].concat(ot[1]),mt=this.meetSegmentSegment(bt,xt,At,yt),mt[1]>=0&&mt[1]<=1&&(!ut||mt[2]>=0&&mt[2]<=1)?[mt]:[])},meetBeziersegmentBeziersegment:function(lt,ot,ct){var ut,ht,dt;for(ut=lt.length===4&&ot.length===4?this._bezierMeetSubdivision(lt,ot,0):this._bezierLineMeetSubdivision(lt,ot,0,ct),ut.sort(function(pt,ft){return 1e7*(pt[1]-ft[1])+(pt[2]-ft[2])}),ht=[],dt=0;dt<ut.length;dt++)dt!==0&&ut[dt][1]===ut[dt-1][1]&&ut[dt][2]===ut[dt-1][2]||ht.push(ut[dt]);return ht},meetBezierCurveRedBlueSegments:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At=ot.numberPoints,yt=lt.numberPoints,bt=[];if(At<4||yt<4)return[0,NaN,NaN];for(ht=0;ht<yt-3;ht+=3)for(ut=lt.points,pt=[[ut[ht].usrCoords[1],ut[ht].usrCoords[2]],[ut[ht+1].usrCoords[1],ut[ht+1].usrCoords[2]],[ut[ht+2].usrCoords[1],ut[ht+2].usrCoords[2]],[ut[ht+3].usrCoords[1],ut[ht+3].usrCoords[2]]],gt=this._bezierBbox(pt),dt=0;dt<At-3;dt+=3)if(ut=ot.points,ft=[[ut[dt].usrCoords[1],ut[dt].usrCoords[2]],[ut[dt+1].usrCoords[1],ut[dt+1].usrCoords[2]],[ut[dt+2].usrCoords[1],ut[dt+2].usrCoords[2]],[ut[dt+3].usrCoords[1],ut[dt+3].usrCoords[2]]],mt=this._bezierBbox(ft),this._bezierOverlap(gt,mt)&&(bt=bt.concat(this.meetBeziersegmentBeziersegment(pt,ft)),bt.length>ct))return bt[ct][0];return bt.length>ct?bt[ct][0]:[0,NaN,NaN]},bezierSegmentEval:function(lt,ot){var ct,ut,ht,dt=1-lt;return ut=0,ht=0,ct=dt*dt*dt,ut+=ct*ot[0][0],ht+=ct*ot[0][1],ct=3*lt*dt*dt,ut+=ct*ot[1][0],ht+=ct*ot[1][1],ct=3*lt*lt*dt,ut+=ct*ot[2][0],ht+=ct*ot[2][1],ct=lt*lt*lt,ut+=ct*ot[3][0],ht+=ct*ot[3][1],[1,ut,ht]},bezierArc:function(lt,ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It=.5*Math.PI,Ot=ot[1],Bt=ot[2],Nt=ot[0],zt=[],Dt=[];for(mt=this.distance(ot,lt),Ot/=Nt,Bt/=Nt,At=this.rad(lt.slice(1),ot.slice(1),ct.slice(1)),ht===-1&&(At=2*Math.PI-At),dt=lt,dt[1]/=dt[0],dt[2]/=dt[0],dt[0]/=dt[0],gt=dt.slice(0),ut?(zt=[Ot,Ot+.333*(dt[1]-Ot),Ot+.666*(dt[1]-Ot),dt[1]],Dt=[Bt,Bt+.333*(dt[2]-Bt),Bt+.666*(dt[2]-Bt),dt[2]]):(zt=[dt[1]],Dt=[dt[2]]);At>it.eps;)At>It?(yt=It,At-=It):(yt=At,At=0),bt=Math.cos(ht*yt),xt=Math.sin(ht*yt),Rt=[[1,0,0],[Ot*(1-bt)+Bt*xt,bt,-xt],[Bt*(1-bt)-Ot*xt,xt,bt]],Tt=it.matVecMult(Rt,dt),gt=[Tt[0]/Tt[0],Tt[1]/Tt[0],Tt[2]/Tt[0]],vt=dt[1]-Ot,_t=dt[2]-Bt,Ct=gt[1]-Ot,St=gt[2]-Bt,Mt=Math.sqrt((vt+Ct)*(vt+Ct)+(_t+St)*(_t+St)),Et=Math.abs(St-_t)>it.eps?(vt+Ct)*(mt/Mt-.5)/(St-_t)*8/3:(_t+St)*(mt/Mt-.5)/(vt-Ct)*8/3,pt=[1,dt[1]-Et*_t,dt[2]+Et*vt],ft=[1,gt[1]+Et*St,gt[2]-Et*Ct],zt=zt.concat([pt[1],ft[1],gt[1]]),Dt=Dt.concat([pt[2],ft[2],gt[2]]),dt=gt.slice(0);return ut&&(zt=zt.concat([gt[1]+.333*(Ot-gt[1]),gt[1]+.666*(Ot-gt[1]),Ot]),Dt=Dt.concat([gt[2]+.333*(Bt-gt[2]),gt[2]+.666*(Bt-gt[2]),Bt])),[zt,Dt]},projectPointToCircle:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt=ot.center.coords.usrCoords;return st.exists(ct)||(ct=lt.board),st.isPoint(lt)?(ut=lt.coords.distance(_e.COORDS_BY_USER,ot.center.coords),ht=lt.coords.usrCoords):(ut=lt.distance(_e.COORDS_BY_USER,ot.center.coords),ht=lt.usrCoords),Math.abs(ut)<it.eps&&(ut=it.eps),ft=ot.Radius()/ut,dt=gt[1]+ft*(ht[1]-gt[1]),pt=gt[2]+ft*(ht[2]-gt[2]),new rt(_e.COORDS_BY_USER,[dt,pt],ct)},projectPointToLine:function(lt,ot,ct){var ut=[0,ot.stdform[1],ot.stdform[2]];return st.exists(ct)||(ct=lt.board),ut=it.crossProduct(ut,lt.coords.usrCoords),new rt(_e.COORDS_BY_USER,it.crossProduct(ut,ot.stdform),ct)},projectCoordsToSegment:function(lt,ot,ct){var ut,ht,dt=[ct[1]-ot[1],ct[2]-ot[2]],pt=[lt[1]-ot[1],lt[2]-ot[2]];return Math.abs(dt[0])<it.eps&&Math.abs(dt[1])<it.eps?[ot,0]:(ut=it.innerProduct(pt,dt),ht=it.innerProduct(dt,dt),ut/=ht,[[1,ut*dt[0]+ot[1],ut*dt[1]+ot[2]],ut])},projectCoordsToBeziersegment:function(lt,ot,ct){var ut,ht=function(dt){var pt=[1,ot.X(ct+dt),ot.Y(ct+dt)];return pt[1]-=lt[1],pt[2]-=lt[2],pt[1]*pt[1]+pt[2]*pt[2]};return ut=tt.Math.Numerics.fminbr(ht,[0,1]),[[1,ot.X(ut+ct),ot.Y(ut+ct)],ut]},projectPointToCurve:function(lt,ot,ct){st.exists(ct)||(ct=lt.board);var ut=lt.X(),ht=lt.Y(),dt=lt.position||0,pt=this.projectCoordsToCurve(ut,ht,dt,ot,ct);return lt.position=pt[1],pt[0]},projectCoordsToCurve:function(lt,ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt=Number.POSITIVE_INFINITY;if(st.exists(ht)||(ht=ut.board),st.evaluate(ut.visProp.curvetype)==="plot"){if(ct=0,mt=zt,dt=ut.numberPoints===0?[0,1,1]:[ut.Z(0),ut.X(0),ut.Y(0)],ut.numberPoints>1)for(bt=[1,lt,ot],ut.bezierDegree===3?gt=0:_t=[ut.Z(0),ut.X(0),ut.Y(0)],ft=0;ft<ut.numberPoints-1;ft++)ut.bezierDegree===3?St=this.projectCoordsToBeziersegment(bt,ut,gt):(Ct=[ut.Z(ft+1),ut.X(ft+1),ut.Y(ft+1)],St=this.projectCoordsToSegment(bt,_t,Ct)),yt=St[1],xt=St[0],0<=yt&&yt<=1?(At=this.distance(xt,bt),vt=ft+yt):yt<0?(xt=_t,At=this.distance(_t,bt),vt=ft):yt>1&&ft===ut.numberPoints-2&&(xt=Ct,At=this.distance(xt,bt),vt=ut.numberPoints-1),At<mt&&(mt=At,ct=vt,dt=xt),ut.bezierDegree===3?(gt++,ft+=2):_t=Ct;pt=new rt(_e.COORDS_BY_USER,dt,ht)}else{for(Et=function(Dt){var Ft,Ut;return Dt<ut.minX()||Dt>ut.maxX()?NaN:(Ft=lt-ut.X(Dt),Ut=ot-ut.Y(Dt),Ft*Ft+Ut*Ut)},Rt=Et(ct),Ot=50,It=(ut.maxX()-ut.minX())/Ot,Tt=ut.minX(),ft=0;ft<Ot;ft++)Mt=Et(Tt),(Mt<Rt||isNaN(Rt))&&(ct=Tt,Rt=Mt),Tt+=It;ct=nt.fminbr(Et,[ct-It,ct+It]),Bt=ut.minX(),Nt=ut.maxX(),ct=ct<Bt?Bt:ct,ct=ct>Nt?Nt:ct,pt=new rt(_e.COORDS_BY_USER,[ut.X(ct),ut.Y(ct)],ht)}return[ut.updateTransform(pt),ct]},projectCoordsToPolygon:function(lt,ot){var ct,ut,ht,dt,pt=ot.vertices.length,ft=1/0;for(ct=0;ct<pt;ct++)ht=tt.Math.Geometry.projectCoordsToSegment(lt,ot.vertices[ct].coords.usrCoords,ot.vertices[(ct+1)%pt].coords.usrCoords),ut=tt.Math.Geometry.distance(ht[0],lt,3),0<=ht[1]&&ht[1]<=1&&ut<ft&&(dt=ht[0].slice(0),ft=ut);return dt},projectPointToTurtle:function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt=0,bt=0,xt=Number.POSITIVE_INFINITY,vt=ot.objects.length;for(st.exists(ct)||(ct=lt.board),ft=0;ft<vt;ft++)mt=ot.objects[ft],mt.elementClass===_e.OBJECT_CLASS_CURVE&&(ut=this.projectPointToCurve(lt,mt),gt=this.distance(ut.usrCoords,lt.coords.usrCoords),gt<xt&&(dt=ut.usrCoords[1],pt=ut.usrCoords[2],ht=lt.position,xt=gt,At=mt,bt=yt),yt+=mt.numberPoints);return ut=new rt(_e.COORDS_BY_USER,[dt,pt],ct),lt.position=ht+bt,At.updateTransform(ut)},projectPointToPoint:function(lt,ot){return ot.coords},projectPointToBoard:function(lt,ot){var ct,ut,ht,dt=ot||lt.board,pt=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],ft=lt.coords||lt,gt=dt.getBoundingBox();for(ct=0;ct<4;ct++)ht=pt[ct],ht[0]*ft.usrCoords[ht[1]]<ht[0]*gt[ht[2]]&&(ut=it.crossProduct([1,gt[ht[3]],gt[ht[4]]],[1,gt[ht[5]],gt[ht[6]]]),ut[3]=0,ut=it.normalize(ut),ft=this.projectPointToLine({coords:ft},{stdform:ut},dt));return ft},distPointLine:function(lt,ot){var ct,ut=ot[1],ht=ot[2],dt=ot[0];return Math.abs(ut)+Math.abs(ht)<it.eps?Number.POSITIVE_INFINITY:(ct=ut*lt[1]+ht*lt[2]+dt,ut*=ut,ht*=ht,Math.abs(ct)/Math.sqrt(ut+ht))},reuleauxPolygon:function(lt,ot){var ct,ut=2*Math.PI,ht=ut/ot,dt=(ot-1)/2,pt=0,ft=function(gt,mt){return function(At,yt){var bt=(At%ut+ut)%ut,xt=Math.floor(bt/ht)%ot;return yt||(pt=lt[0].Dist(lt[dt]),ct=it.Geometry.rad([lt[0].X()+1,lt[0].Y()],lt[0],lt[dt%ot])),isNaN(xt)?xt:(bt=.5*bt+xt*ht*.5+ct,lt[xt][gt]()+pt*Math[mt](bt))}};return[ft("X","cos"),ft("Y","sin"),0,ut]}}),it.Geometry}),define("utils/zip",["jxg"],function(tt){var _e=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],rt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],it=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],nt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],st=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],at=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],lt=256;return tt.Util=tt.Util||{},tt.Util.Unzip=function(ot){function ct(){return $t+=8,Ft<Dt?ot[Ft++]:-1}function ut(){Ut=1}function ht(){var ar;try{return $t++,ar=1&Ut,Ut>>=1,Ut===0&&(Ut=ct(),ar=1&Ut,Ut=Ut>>1|128),ar}catch(lr){throw lr}}function dt(ar){var lr=0,gr=ar;try{for(;gr--;)lr=lr<<1|ht();ar&&(lr=_e[lr]>>8-ar)}catch(Yt){throw Yt}return lr}function pt(){Nt=0}function ft(ar){Ct++,Bt[Nt++]=ar,Rt.push(String.fromCharCode(ar)),Nt===32768&&(Nt=0)}function gt(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function mt(){for(;;){if(ir[er]>=Tt)return-1;if(Et[ir[er]]===er)return ir[er]++;ir[er]++}}function At(){var ar,lr=sr[qt];if(er===17)return-1;if(qt++,er++,(ar=mt())>=0)lr.b0=ar;else if(lr.b0=32768,At())return-1;if((ar=mt())>=0)lr.b1=ar,lr.jump=null;else if(lr.b1=32768,lr.jump=sr[qt],lr.jumppos=qt,At())return-1;return er--,0}function yt(ar,lr,gr,Yt){var nr;for(sr=ar,qt=0,Et=gr,Tt=lr,nr=0;nr<17;nr++)ir[nr]=0;return er=0,At()?-1:0}function bt(ar){for(var lr,gr,Yt=0,nr=ar[Yt];;)if(ht()){if(!(32768&nr.b1))return nr.b1;for(nr=nr.jump,lr=ar.length,gr=0;gr<lr;gr++)if(ar[gr]===nr){Yt=gr;break}}else{if(!(32768&nr.b0))return nr.b0;Yt++,nr=ar[Yt]}}function xt(){var ar,lr,gr,Yt,nr,mr,Sr,Er,Nr,wr,kr,Ur,Or,Xr,Qt,Xt;do if(ar=ht(),(gr=dt(2))===0)for(ut(),wr=ct(),wr|=ct()<<8,Ur=ct(),Ur|=ct()<<8,65535&(wr^~Ur)&&tt.debug(`BlockLen checksum mismatch
`);wr--;)lr=ct(),ft(lr);else if(gr===1)for(;;)if(nr=_e[dt(7)]>>1,nr>23?(nr=nr<<1|ht(),nr>199?(nr-=128,nr=nr<<1|ht()):(nr-=48)>143&&(nr+=136)):nr+=256,nr<256)ft(nr);else{if(nr===256)break;for(nr-=257,Nr=dt(it[nr])+rt[nr],nr=_e[dt(5)]>>3,st[nr]>8?(kr=dt(8),kr|=dt(st[nr]-8)<<8):kr=dt(st[nr]),kr+=nt[nr],nr=0;nr<Nr;nr++)lr=Bt[Nt-kr&32767],ft(lr)}else if(gr===2){for(Sr=new Array(320),Xr=257+dt(5),Qt=1+dt(5),Xt=4+dt(4),nr=0;nr<19;nr++)Sr[nr]=0;for(nr=0;nr<Xt;nr++)Sr[at[nr]]=dt(3);for(Nr=Zt.length,Yt=0;Yt<Nr;Yt++)Zt[Yt]=new gt;if(yt(Zt,19,Sr))return pt(),1;for(Or=Xr+Qt,Yt=0,-1;Yt<Or;)if((nr=bt(Zt))<16)Sr[Yt++]=nr;else if(nr===16){if(nr=3+dt(2),Yt+nr>Or)return pt(),1;for(mr=Yt?Sr[Yt-1]:0;nr--;)Sr[Yt++]=mr}else{if(nr=nr===17?3+dt(3):11+dt(7),Yt+nr>Or)return pt(),1;for(;nr--;)Sr[Yt++]=0}for(Nr=Vt.length,Yt=0;Yt<Nr;Yt++)Vt[Yt]=new gt;if(yt(Vt,Xr,Sr))return pt(),1;for(Nr=Vt.length,Yt=0;Yt<Nr;Yt++)Zt[Yt]=new gt;for(Er=[],Yt=Xr;Yt<Sr.length;Yt++)Er[Yt-Xr]=Sr[Yt];if(yt(Zt,Qt,Er))return pt(),1;for(;;)if((nr=bt(Vt))>=256){if((nr-=256)===0)break;for(nr-=1,Nr=dt(it[nr])+rt[nr],nr=bt(Zt),st[nr]>8?(kr=dt(8),kr|=dt(st[nr]-8)<<8):kr=dt(st[nr]),kr+=nt[nr];Nr--;)lr=Bt[Nt-kr&32767],ft(lr)}else ft(nr)}while(!ar);return pt(),ut(),0}function vt(){var ar,lr,gr,Yt,nr,mr,Sr,Er,Nr=[];try{if(Rt=[],zt=!1,Nr[0]=ct(),Nr[1]=ct(),Nr[0]===120&&Nr[1]===218&&(xt(),Ot[It]=[Rt.join(""),"geonext.gxt"],It++),Nr[0]===31&&Nr[1]===139&&(Mt(),Ot[It]=[Rt.join(""),"file"],It++),Nr[0]===80&&Nr[1]===75&&(zt=!0,Nr[2]=ct(),Nr[3]=ct(),Nr[2]===3&&Nr[3]===4)){for(Nr[0]=ct(),Nr[1]=ct(),_t=ct(),_t|=ct()<<8,Er=ct(),Er|=ct()<<8,ct(),ct(),ct(),ct(),Sr=ct(),Sr|=ct()<<8,Sr|=ct()<<16,Sr|=ct()<<24,mr=ct(),mr|=ct()<<8,mr|=ct()<<16,mr|=ct()<<24,nr=ct(),nr|=ct()<<8,nr|=ct()<<16,nr|=ct()<<24,Yt=ct(),Yt|=ct()<<8,gr=ct(),gr|=ct()<<8,ar=0,ur=[];Yt--;)lr=ct(),lr==="/"|lr===":"?ar=0:ar<lt-1&&(ur[ar++]=String.fromCharCode(lr));for(St||(St=ur),ar=0;ar<gr;)lr=ct(),ar++;Ct=0,Er===8&&(xt(),Ot[It]=new Array(2),Ot[It][0]=Rt.join(""),Ot[It][1]=ur.join(""),It++),Mt()}}catch(wr){throw wr}}var _t,Ct,St,Et,Tt,Mt,Rt=[],It=0,Ot=[],Bt=new Array(32768),Nt=0,zt=!1,Dt=ot.length,Ft=0,Ut=1,$t=0,Vt=new Array(288),Zt=new Array(32),qt=0,sr=null,er=(new Array(64),new Array(64),0),ir=new Array(17),ur=[];ir[0]=0,Mt=function(){var ar,lr,gr,Yt,nr,mr=[];if(8&_t&&(mr[0]=ct(),mr[1]=ct(),mr[2]=ct(),mr[3]=ct(),mr[0]===80&&mr[1]===75&&mr[2]===7&&mr[3]===8?(ar=ct(),ar|=ct()<<8,ar|=ct()<<16,ar|=ct()<<24):ar=mr[0]|mr[1]<<8|mr[2]<<16|mr[3]<<24,lr=ct(),lr|=ct()<<8,lr|=ct()<<16,lr|=ct()<<24,gr=ct(),gr|=ct()<<8,gr|=ct()<<16,gr|=ct()<<24),zt&&vt(),mr[0]=ct(),mr[0]===8){if(_t=ct(),ct(),ct(),ct(),ct(),ct(),ct(),4&_t)for(mr[0]=ct(),mr[2]=ct(),er=mr[0]+256*mr[1],Yt=0;Yt<er;Yt++)ct();if(8&_t)for(Yt=0,ur=[],nr=ct();nr;)nr!=="7"&&nr!==":"||(Yt=0),Yt<lt-1&&(ur[Yt++]=nr),nr=ct();if(16&_t)for(nr=ct();nr;)nr=ct();2&_t&&(ct(),ct()),xt(),ar=ct(),ar|=ct()<<8,ar|=ct()<<16,ar|=ct()<<24,gr=ct(),gr|=ct()<<8,gr|=ct()<<16,gr|=ct()<<24,zt&&vt()}},tt.Util.Unzip.prototype.unzipFile=function(ar){var lr;for(this.unzip(),lr=0;lr<Ot.length;lr++)if(Ot[lr][1]===ar)return Ot[lr][0];return""},tt.Util.Unzip.prototype.unzip=function(){return vt(),Ot}},tt.Util}),define("utils/encoding",["jxg"],function(tt){var _e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return tt.Util=tt.Util||{},tt.Util.UTF8={encode:function(rt){var it,nt,st="",at=rt.length;if(rt=rt.replace(/\r\n/g,`
`),typeof unescape=="function"&&typeof encodeURIComponent=="function")return unescape(encodeURIComponent(rt));for(it=0;it<at;it++)nt=rt.charCodeAt(it),nt<128?st+=String.fromCharCode(nt):nt>127&&nt<2048?(st+=String.fromCharCode(nt>>6|192),st+=String.fromCharCode(63&nt|128)):(st+=String.fromCharCode(nt>>12|224),st+=String.fromCharCode(nt>>6&63|128),st+=String.fromCharCode(63&nt|128));return st},decode:function(rt){var it,nt,st,at=0,lt=0,ot=0,ct=[],ut=rt.length,ht=[];for(it=0;it<ut;it++)nt=rt.charCodeAt(it),st=_e[nt],lt=ot!==0?63&nt|lt<<6:255>>st&nt,(ot=_e[256+ot+st])===0&&(lt>65535?ct.push(55232+(lt>>10),56320+(1023&lt)):ct.push(lt),++at%1e4==0&&(ht.push(String.fromCharCode.apply(null,ct)),ct=[]));return ht.push(String.fromCharCode.apply(null,ct)),ht.join("")},asciiCharCodeAt:function(rt,it){var nt=rt.charCodeAt(it);if(nt>255)switch(nt){case 8364:nt=128;break;case 8218:nt=130;break;case 402:nt=131;break;case 8222:nt=132;break;case 8230:nt=133;break;case 8224:nt=134;break;case 8225:nt=135;break;case 710:nt=136;break;case 8240:nt=137;break;case 352:nt=138;break;case 8249:nt=139;break;case 338:nt=140;break;case 381:nt=142;break;case 8216:nt=145;break;case 8217:nt=146;break;case 8220:nt=147;break;case 8221:nt=148;break;case 8226:nt=149;break;case 8211:nt=150;break;case 8212:nt=151;break;case 732:nt=152;break;case 8482:nt=153;break;case 353:nt=154;break;case 8250:nt=155;break;case 339:nt=156;break;case 382:nt=158;break;case 376:nt=159}return nt}},tt.Util.UTF8}),define("utils/base64",["jxg","utils/encoding"],function(tt,_e){function rt(st,at){return 255&st.charCodeAt(at)}function it(st,at){return nt.indexOf(st.charAt(at))}var nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return tt.Util=tt.Util||{},tt.Util.Base64={encode:function(st){var at,lt,ot,ct,ut,ht=[];for(ut=_e.encode(st),ot=ut.length,ct=ot%3,at=0;at<ot-ct;at+=3)lt=rt(ut,at)<<16|rt(ut,at+1)<<8|rt(ut,at+2),ht.push(nt.charAt(lt>>18),nt.charAt(lt>>12&63),nt.charAt(lt>>6&63),nt.charAt(63&lt));switch(ct){case 1:lt=rt(ut,ot-1),ht.push(nt.charAt(lt>>2),nt.charAt(lt<<4&63),"=","=");break;case 2:lt=rt(ut,ot-2)<<8|rt(ut,ot-1),ht.push(nt.charAt(lt>>10),nt.charAt(lt>>4&63),nt.charAt(lt<<2&63),"=")}return ht.join("")},decode:function(st,at){var lt,ot,ct,ut,ht,dt,pt=[],ft=[];if(lt=st.replace(/[^A-Za-z0-9\+\/=]/g,""),(ct=lt.length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for(lt.charAt(ct-1)==="="&&(ut=1,lt.charAt(ct-2)==="="&&(ut=2),ct-=4),ot=0;ot<ct;ot+=4)ht=it(lt,ot)<<18|it(lt,ot+1)<<12|it(lt,ot+2)<<6|it(lt,ot+3),ft.push(ht>>16,ht>>8&255,255&ht),ot%1e4==0&&(pt.push(String.fromCharCode.apply(null,ft)),ft=[]);switch(ut){case 1:ht=it(lt,ct)<<12|it(lt,ct+1)<<6|it(lt,ct+2),ft.push(ht>>10,ht>>2&255);break;case 2:ht=it(lt,ot)<<6|it(lt,ot+1),ft.push(ht>>4)}return pt.push(String.fromCharCode.apply(null,ft)),dt=pt.join(""),at&&(dt=_e.decode(dt)),dt},decodeAsArray:function(st){var at,lt=this.decode(st),ot=[],ct=lt.length;for(at=0;at<ct;at++)ot[at]=lt.charCodeAt(at);return ot}},tt.Util.Base64}),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],function(tt,_e,rt,it){return tt.Server={modules:{},runningCalls:{},handleError:function(nt){tt.debug("error occured, server says: "+nt.message)},callServer:function(nt,st,at,lt){var ot,ct,ut,ht,dt,pt,ft;lt=lt||!1,ht="";for(ft in at)at.hasOwnProperty(ft)&&(ht+="&"+escape(ft)+"="+escape(at[ft]));pt=it.toJSON(at);do dt=nt+Math.floor(4096*Math.random());while(it.exists(this.runningCalls[dt]));return this.runningCalls[dt]={action:nt},it.exists(at.module)&&(this.runningCalls[dt].module=at.module),ot=tt.serverBase+"JXGServer.py",ct="action="+escape(nt)+"&id="+dt+"&dataJSON="+escape(rt.encode(pt)),this.cbp=function(gt){var mt,At,yt,bt,xt,vt,_t,Ct;if(mt=new _e.Unzip(rt.decodeAsArray(gt)).unzip(),it.isArray(mt)&&mt.length>0&&(mt=mt[0][0]),it.exists(mt)){if(At=window.JSON&&window.JSON.parse?window.JSON.parse(mt):new Function("return "+mt)(),At.type==="error")this.handleError(At);else if(At.type==="response"){for(vt=At.id,_t=0;_t<At.fields.length;_t++)yt=At.fields[_t],bt=yt.namespace+(typeof new Function("return "+yt.namespace)()=="object"?".":".prototype.")+yt.name+" = "+yt.value,new Function(bt)();for(_t=0;_t<At.handler.length;_t++){for(yt=At.handler[_t],xt=[],Ct=0;Ct<yt.parameters.length;Ct++)xt[Ct]='"'+yt.parameters[Ct]+'": '+yt.parameters[Ct];bt="if(typeof JXG.Server.modules."+this.runningCalls[vt].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[vt].module+" = {};",bt+="JXG.Server.modules."+this.runningCalls[vt].module+"."+yt.name+"_cb = "+yt.callback+";",bt+="JXG.Server.modules."+this.runningCalls[vt].module+"."+yt.name+" = function ("+yt.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[vt].module+"."+yt.name+"_cb;var __JXGSERVER_PAR__ = {"+xt.join(",")+', "module": "'+this.runningCalls[vt].module+'", "handler": "'+yt.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(bt)()}delete this.runningCalls[vt],st(At.data)}}},this.cb=tt.bind(this.cbp,this),window.XMLHttpRequest?(ut=new XMLHttpRequest,ut.overrideMimeType("text/plain; charset=iso-8859-1")):ut=new ActiveXObject("Microsoft.XMLHTTP"),!(!ut||(ut.open("POST",ot,!lt),ut.setRequestHeader("Content-type","application/x-www-form-urlencoded"),lt||(ut.onreadystatechange=function(gt){return function(){return ut.readyState===4&&ut.status===200&&(gt(ut.responseText),!0)}}(this.cb)),ut.send(ct),!lt))&&(this.cb(ut.responseText),!0)},loadModule_cb:function(nt){var st;for(st=0;st<nt.length;st++)tt.debug(nt[st].name+": "+nt[st].value)},loadModule:function(nt){return tt.Server.callServer("load",tt.Server.loadModule_cb,{module:nt},!0)}},tt.Server.load=tt.Server.loadModule,tt.Server}),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],function(tt,_e,rt,it,nt,st){return rt.Symbolic={generateSymbolicCoordinatesPartial:function(at,lt,ot,ct){var ut,ht,dt,pt=lt.ancestors,ft=0,gt=function(mt){return ct==="underscore"?ot+"_{"+mt+"}":ct==="brace"?ot+"["+mt+"]":ot+mt};at.listOfFreePoints=[],at.listOfDependantPoints=[];for(ht in pt)if(pt.hasOwnProperty(ht)&&(ut=0,st.isPoint(pt[ht]))){for(dt in pt[ht].ancestors)pt[ht].ancestors.hasOwnProperty(dt)&&ut++;ut===0?(pt[ht].symbolic.x=pt[ht].coords.usrCoords[1],pt[ht].symbolic.y=pt[ht].coords.usrCoords[2],at.listOfFreePoints.push(pt[ht])):(ft+=1,pt[ht].symbolic.x=gt(ft),ft+=1,pt[ht].symbolic.y=gt(ft),at.listOfDependantPoints.push(pt[ht]))}return st.isPoint(lt)&&(lt.symbolic.x="x",lt.symbolic.y="y"),ft},clearSymbolicCoordinates:function(at){var lt=function(ot){var ct,ut=ot&&ot.length||0;for(ct=0;ct<ut;ct++)st.isPoint(ot[ct])&&(ot[ct].symbolic.x="",ot[ct].symbolic.y="")};lt(at.listOfFreePoints),lt(at.listOfDependantPoints),delete at.listOfFreePoints,delete at.listOfDependantPoints},generatePolynomials:function(at,lt,ot){var ct,ut,ht,dt,pt=lt.ancestors,ft=[],gt=[];ot&&this.generateSymbolicCoordinatesPartial(at,lt,"u","brace"),pt[lt.id]=lt;for(ct in pt)if(pt.hasOwnProperty(ct)&&(dt=0,ft=[],st.isPoint(pt[ct]))){for(ut in pt[ct].ancestors)pt[ct].ancestors.hasOwnProperty(ut)&&dt++;if(dt>0)for(ft=pt[ct].generatePolynomial(),ht=0;ht<ft.length;ht++)gt.push(ft[ht])}return ot&&this.clearSymbolicCoordinates(at),gt},geometricLocusByGroebnerBase:function(at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt=at.options.locus,_t={},Ct=this.generateSymbolicCoordinatesPartial(at,lt,"u","brace"),St=new _e(tt.COORDS_BY_USR,[0,0],at),Et=new _e(tt.COORDS_BY_USR,[at.canvasWidth,at.canvasHeight],at),Tt=1,Mt=0,Rt=0,It=0;if(nt.modules.geoloci===void 0&&nt.loadModule("geoloci"),nt.modules.geoloci===void 0)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(ft=St.usrCoords[1],gt=Et.usrCoords[1],mt=Et.usrCoords[2],At=St.usrCoords[2],vt.translateToOrigin&&at.listOfFreePoints.length>0){for(ht=vt.toOrigin!==void 0&&vt.toOrigin!==null&&st.isInArray(at.listOfFreePoints,vt.toOrigin.id)?vt.toOrigin:at.listOfFreePoints[0],Mt=ht.symbolic.x,Rt=ht.symbolic.y,pt=0;pt<at.listOfFreePoints.length;pt++)at.listOfFreePoints[pt].symbolic.x-=Mt,at.listOfFreePoints[pt].symbolic.y-=Rt;if(ft-=Mt,gt-=Mt,mt-=Rt,At-=Rt,vt.translateTo10&&at.listOfFreePoints.length>1){for(dt=vt.to10!==void 0&&vt.to10!==null&&vt.to10.id!==vt.toOrigin.id&&st.isInArray(at.listOfFreePoints,vt.to10.id)?vt.to10:at.listOfFreePoints[0].id===ht.id?at.listOfFreePoints[1]:at.listOfFreePoints[0],It=it.rad([1,0],[0,0],[dt.symbolic.x,dt.symbolic.y]),yt=Math.cos(-It),bt=Math.sin(-It),pt=0;pt<at.listOfFreePoints.length;pt++)xt=at.listOfFreePoints[pt].symbolic.x,at.listOfFreePoints[pt].symbolic.x=yt*at.listOfFreePoints[pt].symbolic.x-bt*at.listOfFreePoints[pt].symbolic.y,at.listOfFreePoints[pt].symbolic.y=bt*xt+yt*at.listOfFreePoints[pt].symbolic.y;if(dt.symbolic.y=0,xt=ft,ft=yt*ft-bt*mt,mt=bt*xt+yt*mt,xt=gt,gt=yt*gt-bt*At,At=bt*xt+yt*At,vt.stretch&&Math.abs(dt.symbolic.x)>rt.eps){for(Tt=dt.symbolic.x,pt=0;pt<at.listOfFreePoints.length;pt++)at.listOfFreePoints[pt].symbolic.x/=Tt,at.listOfFreePoints[pt].symbolic.y/=Tt;for(pt=0;pt<at.objectsList.length;pt++)at.objectsList[pt].elementClass===tt.OBJECT_CLASS_CIRCLE&&at.objectsList[pt].method==="pointRadius"&&(_t[pt]=at.objectsList[pt].radius,at.objectsList[pt].radius/=Tt);ft/=Tt,gt/=Tt,mt/=Tt,At/=Tt,dt.symbolic.x=1}}for(pt=0;pt<at.listOfFreePoints.length;pt++)xt=at.listOfFreePoints[pt].symbolic.x,Math.abs(xt)<rt.eps&&(at.listOfFreePoints[pt].symbolic.x=0),Math.abs(xt-Math.round(xt))<rt.eps&&(at.listOfFreePoints[pt].symbolic.x=Math.round(xt)),xt=at.listOfFreePoints[pt].symbolic.y,Math.abs(xt)<rt.eps&&(at.listOfFreePoints[pt].symbolic.y=0),Math.abs(xt-Math.round(xt))<rt.eps&&(at.listOfFreePoints[pt].symbolic.y=Math.round(xt))}ot=this.generatePolynomials(at,lt),ct=ot.join(","),this.cbp=function(Ot){ut=Ot},this.cb=st.bind(this.cbp,this),nt.modules.geoloci.lociCoCoA(ft,gt,mt,At,Ct,ct,Tt,It,Mt,Rt,this.cb,!0),this.clearSymbolicCoordinates(at);for(pt in _t)_t.hasOwnProperty(pt)&&(at.objects[pt].radius=_t[pt]);return ut}},rt.Symbolic}),define("math/poly",["jxg","math/math","utils/type"],function(tt,_e,rt){return _e.Poly={},_e.Poly.Ring=function(it){this.vars=it},tt.extend(_e.Poly.Ring.prototype,{}),_e.Poly.Monomial=function(it,nt,st){var at;if(!rt.exists(it))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(rt.isArray(st)||(st=[]),st=st.slice(0,it.vars.length),at=st.length;at<it.vars.length;at++)st.push(0);this.ring=it,this.coefficient=nt||0,this.exponents=rt.deepCopy(st)},tt.extend(_e.Poly.Monomial.prototype,{copy:function(){return new _e.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var it,nt=[];for(it=0;it<this.ring.vars.length;it++)nt.push(this.ring.vars[it]+"^"+this.exponents[it]);return this.coefficient+"*"+nt.join("*")}}),_e.Poly.Polynomial=function(it,nt){var st;if(!rt.exists(it))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");st=rt.exists(nt)&&rt.isString(nt)?void 0:[],this.ring=it,this.monomials=st},tt.extend(_e.Poly.Polynomial.prototype,{findSignature:function(it){var nt;for(nt=0;nt<this.monomials.length;nt++)if(rt.cmpArrays(this.monomials[nt].exponents,it))return nt;return-1},addSubMonomial:function(it,nt){var st;st=this.findSignature(it.exponents),st>-1?this.monomials[st].coefficient+=nt*it.coefficient:(it.coefficient*=nt,this.monomials.push(it))},add:function(it){var nt;if(!rt.exists(it)||it.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(rt.isArray(it.exponents))this.addSubMonomial(it,1);else for(nt=0;nt<it.monomials.length;nt++)this.addSubMonomial(it.monomials[nt],1)},sub:function(it){var nt;if(!rt.exists(it)||it.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(rt.isArray(it.exponents))this.addSubMonomial(it,-1);else for(nt=0;nt<it.monomials.length;nt++)this.addSubMonomial(it.monomials[nt],-1)},copy:function(){var it,nt;for(nt=new _e.Poly.Polynomial(this.ring),it=0;it<this.monomials.length;it++)nt.monomials.push(this.monomials[it].copy());return nt},print:function(){var it,nt=[];for(it=0;it<this.monomials.length;it++)nt.push("("+this.monomials[it].print()+")");return nt.join("+")}}),_e.Poly}),define("math/complex",["jxg","utils/type"],function(tt,_e){return tt.Complex=function(rt,it){this.isComplex=!0,rt&&rt.isComplex&&(it=rt.imaginary,rt=rt.real),this.real=rt||0,this.imaginary=it||0,this.absval=0,this.angle=0},tt.extend(tt.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(rt){return _e.isNumber(rt)?this.real+=rt:(this.real+=rt.real,this.imaginary+=rt.imaginary),this},sub:function(rt){return _e.isNumber(rt)?this.real-=rt:(this.real-=rt.real,this.imaginary-=rt.imaginary),this},mult:function(rt){var it,nt;return _e.isNumber(rt)?(this.real*=rt,this.imaginary*=rt):(it=this.real,nt=this.imaginary,this.real=it*rt.real-nt*rt.imaginary,this.imaginary=it*rt.imaginary+nt*rt.real),this},div:function(rt){var it,nt,st;if(_e.isNumber(rt)){if(Math.abs(rt)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=rt,this.imaginary/=rt}else{if(Math.abs(rt.real)<Math.eps&&Math.abs(rt.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;it=rt.real*rt.real+rt.imaginary*rt.imaginary,st=this.real,nt=this.imaginary,this.real=(st*rt.real+nt*rt.imaginary)/it,this.imaginary=(nt*rt.real-st*rt.imaginary)/it}return this},conj:function(){return this.imaginary*=-1,this}}),tt.C={},tt.C.add=function(rt,it){var nt=new tt.Complex(rt);return nt.add(it),nt},tt.C.sub=function(rt,it){var nt=new tt.Complex(rt);return nt.sub(it),nt},tt.C.mult=function(rt,it){var nt=new tt.Complex(rt);return nt.mult(it),nt},tt.C.div=function(rt,it){var nt=new tt.Complex(rt);return nt.div(it),nt},tt.C.conj=function(rt){var it=new tt.Complex(rt);return it.conj(),it},tt.C.abs=function(rt){var it=new tt.Complex(rt);return it.conj(),it.mult(rt),Math.sqrt(it.real)},tt.Complex.C=tt.C,tt.Complex}),define("utils/color",["jxg","utils/type","math/math"],function(tt,_e,rt){var it={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},nt=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(st){return[parseInt(st[1],10),parseInt(st[2],10),parseInt(st[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(st){return[parseInt(st[1],10),parseInt(st[2],10),parseInt(st[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(st){return[parseInt(st[1],16),parseInt(st[2],16),parseInt(st[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(st){return[parseInt(st[1]+st[1],16),parseInt(st[2]+st[2],16),parseInt(st[3]+st[3],16)]}}];return tt.rgbParser=function(st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt=st;if(!_e.exists(st))return[];if(_e.exists(at)&&_e.exists(lt)&&(yt=[st,at,lt]),ot=yt,At=!1,_e.isArray(ot)){for(pt=0;pt<3;pt++)At=At||/\./.test(yt[pt].toString());for(pt=0;pt<3;pt++)At=At&&yt[pt]>=0&&yt[pt]<=1;return At?[Math.ceil(255*yt[0]),Math.ceil(255*yt[1]),Math.ceil(255*yt[2])]:yt}for(typeof yt=="string"&&(ot=yt),ot.charAt(0)==="#"&&(ot=ot.substr(1,6)),ot=ot.replace(/ /g,"").toLowerCase(),ot=it[ot]||ot,pt=0;pt<nt.length;pt++)ut=nt[pt].re,ht=nt[pt].process,(dt=ut.exec(ot))&&(ct=ht(dt),ft=ct[0],gt=ct[1],mt=ct[2]);return isNaN(ft)||isNaN(gt)||isNaN(mt)?[]:(ft=ft<0||isNaN(ft)?0:ft>255?255:ft,gt=gt<0||isNaN(gt)?0:gt>255?255:gt,mt=mt<0||isNaN(mt)?0:mt>255?255:mt,[ft,gt,mt])},tt.rgb2css=function(st,at,lt){var ot;return ot=tt.rgbParser(st,at,lt),"rgb("+ot[0]+", "+ot[1]+", "+ot[2]+")"},tt.rgb2hex=function(st,at,lt){var ot,ct,ut;return ot=tt.rgbParser(st,at,lt),ct=ot[1],ut=ot[2],ot=ot[0],ot=ot.toString(16),ct=ct.toString(16),ut=ut.toString(16),ot.length===1&&(ot="0"+ot),ct.length===1&&(ct="0"+ct),ut.length===1&&(ut="0"+ut),"#"+ot+ct+ut},tt.hex2rgb=function(st){return tt.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),tt.rgb2css(st)},tt.hsv2rgb=function(st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt;if(st=(st%360+360)%360,at===0){if(!(isNaN(st)||st<rt.eps))return"#ffffff";ot=lt,ct=lt,ut=lt}else switch(pt=st>=360?0:st,pt/=60,dt=Math.floor(pt),ht=pt-dt,ft=lt*(1-at),gt=lt*(1-at*ht),mt=lt*(1-at*(1-ht)),dt){case 0:ot=lt,ct=mt,ut=ft;break;case 1:ot=gt,ct=lt,ut=ft;break;case 2:ot=ft,ct=lt,ut=mt;break;case 3:ot=ft,ct=gt,ut=lt;break;case 4:ot=mt,ct=ft,ut=lt;break;case 5:ot=lt,ct=ft,ut=gt}return ot=Math.round(255*ot).toString(16),ot=ot.length===2?ot:ot.length===1?"0"+ot:"00",ct=Math.round(255*ct).toString(16),ct=ct.length===2?ct:ct.length===1?"0"+ct:"00",ut=Math.round(255*ut).toString(16),ut=ut.length===2?ut:ut.length===1?"0"+ut:"00",["#",ot,ct,ut].join("")},tt.rgb2hsv=function(st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt;return ot=tt.rgbParser(st,at,lt),ct=ot[1],ut=ot[2],ot=ot[0],ht=ot/255,dt=ct/255,pt=ut/255,bt=Math.max(ot,ct,ut),xt=Math.min(ot,ct,ut),ft=bt/255,gt=xt/255,yt=ft,At=0,yt>0&&(At=(yt-gt)/yt),mt=1/(ft-gt),At>0&&(bt===ot?mt*=dt-pt:mt=bt===ct?2+(pt-ht)*mt:4+(ht-dt)*mt),mt*=60,mt<0&&(mt+=360),bt===xt&&(mt=0),[mt,At,yt]},tt.rgb2LMS=function(st,at,lt){var ot,ct,ut,ht,dt,pt,ft,gt=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return ot=tt.rgbParser(st,at,lt),ct=ot[1],ut=ot[2],ot=ot[0],ot=Math.pow(ot,.476190476),ct=Math.pow(ct,.476190476),ut=Math.pow(ut,.476190476),ht=ot*gt[0][0]+ct*gt[0][1]+ut*gt[0][2],dt=ot*gt[1][0]+ct*gt[1][1]+ut*gt[1][2],pt=ot*gt[2][0]+ct*gt[2][1]+ut*gt[2][2],ft=[ht,dt,pt],ft.l=ht,ft.m=dt,ft.s=pt,ft},tt.LMS2rgb=function(st,at,lt){var ot,ct,ut,ht,dt=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],pt=function(ft){for(var gt=127,mt=64;mt>0;){if(Math.pow(gt,.476190476)>ft)gt-=mt;else{if(Math.pow(gt+1,.476190476)>ft)return gt;gt+=mt}mt/=2}return gt===254&&13.994955247<ft?255:gt};return ot=st*dt[0][0]+at*dt[0][1]+lt*dt[0][2],ct=st*dt[1][0]+at*dt[1][1]+lt*dt[1][2],ut=st*dt[2][0]+at*dt[2][1]+lt*dt[2][2],ot=pt(ot),ct=pt(ct),ut=pt(ut),ht=[ot,ct,ut],ht.r=ot,ht.g=ct,ht.b=ut,ht},tt.rgba2rgbo=function(st){var at;return st.length===9&&st.charAt(0)==="#"?(at=parseInt(st.substr(7,2).toUpperCase(),16)/255,st=st.substr(0,7)):at=1,[st,at]},tt.rgbo2rgba=function(st,at){var lt;return st==="none"?st:(lt=Math.round(255*at).toString(16),lt.length===1&&(lt="0"+lt),st+lt)},tt.rgb2bw=function(st){var at,lt,ot,ct="0123456789ABCDEF";return st==="none"?st:(ot=tt.rgbParser(st),at=Math.floor(.3*ot[0]+.59*ot[1]+.11*ot[2]),lt=ct.charAt(at>>4&15)+ct.charAt(15&at),st="#"+lt+lt+lt)},tt.rgb2cb=function(st,at){var lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt="0123456789ABCDEF";if(st==="none")return st;switch(ht=tt.rgb2LMS(st),ot=ht[0],ct=ht[1],ut=ht[2],at=at.toLowerCase()){case"protanopia":pt=-.06150039994295001,ft=.08277001656812001,gt=-.013200141220000003,mt=.05858939668799999,At=-.07934519995360001,yt=.013289415272000003,bt=.6903216543277437,dt=ut/ct,ot=dt<bt?-(ft*ct+gt*ut)/pt:-(At*ct+yt*ut)/mt;break;case"tritanopia":pt=-.00058973116217,ft=.007690316482,gt=-.01011703519052,mt=.025495080838999994,At=-.0422740347,yt=.017005316784,bt=.8349489908460004,dt=ct/ot,ut=dt<bt?-(pt*ot+ft*ct)/gt:-(mt*ot+At*ct)/yt;break;default:pt=-.06150039994295001,ft=.08277001656812001,gt=-.013200141220000003,mt=.05858939668799999,At=-.07934519995360001,yt=.013289415272000003,bt=.5763833686400911,dt=ut/ot,ct=dt<bt?-(pt*ot+gt*ut)/ft:-(mt*ot+yt*ut)/At}return lt=tt.LMS2rgb(ot,ct,ut),dt=xt.charAt(lt[0]>>4&15)+xt.charAt(15&lt[0]),st="#"+dt,dt=xt.charAt(lt[1]>>4&15)+xt.charAt(15&lt[1]),st+=dt,dt=xt.charAt(lt[2]>>4&15)+xt.charAt(15&lt[2]),st+=dt},tt.autoHighlight=function(st){var at=tt.rgba2rgbo(st),lt=at[0],ot=at[1];return st.charAt(0)==="#"?(ot*=ot<.3?1.8:.4,tt.rgbo2rgba(lt,ot)):st},tt}),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],function(tt,_e,rt,it,nt){return tt.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],zoomFactor:1,zoomX:1,zoomY:1,showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"⌘",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,registerEvents:!0,minimizeReflow:"svg",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1}},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888",visible:"inherit",includeBoundaries:!1},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",strokeWidth:2,strokeColor:"blue",ticksDistance:.2},precision:{touch:15,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"},arc:{visible:!1}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1,center:{},radiuspoint:{},anglepoint:{}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},button:{disabled:!1},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:13,doAdvancedPlotOld:!1,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"black",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},inequality:{fillColor:"red",fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"black",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"black",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1,visible:"inherit"},label:{offset:[0,0]}},prescribedangle:{anglepoint:{size:2,visible:!1,withLabel:!1}},regularpolygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiuspoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglepoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,fixed:!0,scalable:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,precision:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,fixed:!0,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"black",highlightStrokeColor:"black",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},tt.Validator=function(){var st,at=function(At){return/^[0-9]+px$/.test(At)},lt=function(At){return At==="html"||At==="internal"},ot=function(At){return nt.isString(At)},ct=function(At){return nt.exists(tt.normalizePointFace(At))},ut=function(At){return Math.abs(At-Math.round(At))<rt.eps},ht=function(At){return ut(At)&&At>0},dt=function(At){return At==="vml"||At==="svg"||At==="canvas"||At==="no"},pt=function(At){return At>0},ft=function(At){return At>=0},gt={},mt={attractorDistance:ft,color:ot,defaultDistance:nt.isNumber,display:lt,doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:ct,factor:nt.isNumber,fillColor:ot,fillOpacity:nt.isNumber,firstArrow:!1,fontSize:ut,dash:ut,gridX:nt.isNumber,gridY:nt.isNumber,hasGrid:!1,highlightFillColor:ot,highlightFillOpacity:nt.isNumber,highlightStrokeColor:ot,highlightStrokeOpacity:nt.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:ut,minorHeight:ut,minorTicks:ft,minTicksDistance:ht,numberPointsHigh:ht,numberPointsLow:ht,opacity:nt.isNumber,radius:nt.isNumber,RDPsmoothing:!1,renderer:dt,right:at,showCopyright:!1,showInfobox:!1,showNavigation:!1,size:ut,snapSizeX:pt,snapSizeY:pt,snapWidth:nt.isNumber,snapToGrid:!1,snatchDistance:ft,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:ot,strokeOpacity:nt.isNumber,strokeWidth:ut,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(st in mt)mt.hasOwnProperty(st)&&(gt[st.toLowerCase()]=mt[st]);return gt}(),tt.normalizePointFace=function(st){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[st]},tt.useStandardOptions=function(st){var at,lt,ot,ct,ut=tt.Options,ht=st.hasGrid;st.options.grid.hasGrid=ut.grid.hasGrid,st.options.grid.gridX=ut.grid.gridX,st.options.grid.gridY=ut.grid.gridY,st.options.grid.gridColor=ut.grid.gridColor,st.options.grid.gridOpacity=ut.grid.gridOpacity,st.options.grid.gridDash=ut.grid.gridDash,st.options.grid.snapToGrid=ut.grid.snapToGrid,st.options.grid.snapSizeX=ut.grid.SnapSizeX,st.options.grid.snapSizeY=ut.grid.SnapSizeY,st.takeSizeFromFile=ut.takeSizeFromFile,ct=function(dt,pt){dt.visProp.fillcolor=pt.fillColor,dt.visProp.highlightfillcolor=pt.highlightFillColor,dt.visProp.strokecolor=pt.strokeColor,dt.visProp.highlightstrokecolor=pt.highlightStrokeColor};for(at in st.objects)if(st.objects.hasOwnProperty(at))if(ot=st.objects[at],ot.elementClass===_e.OBJECT_CLASS_POINT)ct(ot,ut.point);else if(ot.elementClass===_e.OBJECT_CLASS_LINE)for(ct(ot,ut.line),lt=0;lt<ot.ticks.length;lt++)ot.ticks[lt].majorTicks=ut.line.ticks.majorTicks,ot.ticks[lt].minTicksDistance=ut.line.ticks.minTicksDistance,ot.ticks[lt].visProp.minorheight=ut.line.ticks.minorHeight,ot.ticks[lt].visProp.majorheight=ut.line.ticks.majorHeight;else ot.elementClass===_e.OBJECT_CLASS_CIRCLE?ct(ot,ut.circle):ot.type===_e.OBJECT_TYPE_ANGLE?ct(ot,ut.angle):ot.type===_e.OBJECT_TYPE_ARC?ct(ot,ut.arc):ot.type===_e.OBJECT_TYPE_POLYGON?ct(ot,ut.polygon):ot.type===_e.OBJECT_TYPE_CONIC?ct(ot,ut.conic):ot.type===_e.OBJECT_TYPE_CURVE?ct(ot,ut.curve):ot.type===_e.OBJECT_TYPE_SECTOR&&(ot.arc.visProp.fillcolor=ut.sector.fillColor,ot.arc.visProp.highlightfillcolor=ut.sector.highlightFillColor,ot.arc.visProp.fillopacity=ut.sector.fillOpacity,ot.arc.visProp.highlightfillopacity=ut.sector.highlightFillOpacity);st.fullUpdate(),ht&&!st.hasGrid?st.removeGrids(st):!ht&&st.hasGrid&&st.create("grid",[])},tt.useBlackWhiteOptions=function(st){var at=tt.Options;at.point.fillColor=it.rgb2bw(at.point.fillColor),at.point.highlightFillColor=it.rgb2bw(at.point.highlightFillColor),at.point.strokeColor=it.rgb2bw(at.point.strokeColor),at.point.highlightStrokeColor=it.rgb2bw(at.point.highlightStrokeColor),at.line.fillColor=it.rgb2bw(at.line.fillColor),at.line.highlightFillColor=it.rgb2bw(at.line.highlightFillColor),at.line.strokeColor=it.rgb2bw(at.line.strokeColor),at.line.highlightStrokeColor=it.rgb2bw(at.line.highlightStrokeColor),at.circle.fillColor=it.rgb2bw(at.circle.fillColor),at.circle.highlightFillColor=it.rgb2bw(at.circle.highlightFillColor),at.circle.strokeColor=it.rgb2bw(at.circle.strokeColor),at.circle.highlightStrokeColor=it.rgb2bw(at.circle.highlightStrokeColor),at.arc.fillColor=it.rgb2bw(at.arc.fillColor),at.arc.highlightFillColor=it.rgb2bw(at.arc.highlightFillColor),at.arc.strokeColor=it.rgb2bw(at.arc.strokeColor),at.arc.highlightStrokeColor=it.rgb2bw(at.arc.highlightStrokeColor),at.polygon.fillColor=it.rgb2bw(at.polygon.fillColor),at.polygon.highlightFillColor=it.rgb2bw(at.polygon.highlightFillColor),at.sector.fillColor=it.rgb2bw(at.sector.fillColor),at.sector.highlightFillColor=it.rgb2bw(at.sector.highlightFillColor),at.curve.strokeColor=it.rgb2bw(at.curve.strokeColor),at.grid.gridColor=it.rgb2bw(at.grid.gridColor),tt.useStandardOptions(st)},tt.Options.normalizePointFace=tt.normalizePointFace,tt.Options}),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],function(tt,_e,rt,it,nt,st,at,lt){return tt.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},tt.extend(tt.AbstractRenderer.prototype,{_updateVisual:function(ot,ct,ut){(ut||this.enhancedRendering)&&(ct=ct||{},this.setObjectTransition(ot),at.evaluate(ot.visProp.draft)?this.setDraft(ot):(ct.stroke||(ot.highlighted?(this.setObjectStrokeColor(ot,ot.visProp.highlightstrokecolor,ot.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(ot,ot.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(ot,ot.visProp.strokecolor,ot.visProp.strokeopacity),this.setObjectStrokeWidth(ot,ot.visProp.strokewidth))),ct.fill||(ot.highlighted?this.setObjectFillColor(ot,ot.visProp.highlightfillcolor,ot.visProp.highlightfillopacity):this.setObjectFillColor(ot,ot.visProp.fillcolor,ot.visProp.fillopacity)),ct.dash||this.setDashStyle(ot,ot.visProp),ct.shadow||this.setShadow(ot),ct.gradient||this.setShadow(ot)))},drawPoint:function(ot){var ct,ut=_e.normalizePointFace(at.evaluate(ot.visProp.face));ct=ut==="o"?"ellipse":ut==="[]"?"rect":"path",ot.rendNode=this.appendChildPrim(this.createPrim(ct,ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,ct),this._updateVisual(ot,{dash:!0,shadow:!0},!0),this.updatePoint(ot)},updatePoint:function(ot){var ct,ut=at.evaluate(ot.visProp.size),ht=_e.normalizePointFace(at.evaluate(ot.visProp.face)),dt=at.evaluate(ot.visProp.sizeunit),pt=at.evaluate(ot.visProp.zoom);isNaN(ot.coords.scrCoords[2]+ot.coords.scrCoords[1])||(dt==="user"&&(ut*=Math.sqrt(ot.board.unitX*ot.board.unitY)),ut*=ot.board&&pt?Math.sqrt(ot.board.zoomX*ot.board.zoomY):1,ct=ut===0?0:ut+1,ht==="o"?this.updateEllipsePrim(ot.rendNode,ot.coords.scrCoords[1],ot.coords.scrCoords[2],ct,ct):ht==="[]"?this.updateRectPrim(ot.rendNode,ot.coords.scrCoords[1]-ut,ot.coords.scrCoords[2]-ut,2*ut,2*ut):this.updatePathPrim(ot.rendNode,this.updatePathStringPoint(ot,ut,ht),ot.board),this._updateVisual(ot,{dash:!1,shadow:!1}),this.setShadow(ot))},changePointStyle:function(ot){var ct=this.getElementById(ot.id);at.exists(ct)&&this.remove(ct),this.drawPoint(ot),at.clearVisPropOld(ot),ot.visPropCalc.visible||this.hide(ot),at.evaluate(ot.visProp.draft)&&this.setDraft(ot)},drawLine:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("line",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"lines"),this.updateLine(ot)},updateLineEndings:function(ot,ct){var ut,ht=new rt(it.COORDS_BY_USER,ot.point1.coords.usrCoords,ot.board),dt=new rt(it.COORDS_BY_USER,ot.point2.coords.usrCoords,ot.board),pt=null;return pt=at.evaluate(ot.visProp.margin),st.calcStraight(ot,ht,dt,pt),ut=this.getPositionArrowHead(ot,ht,dt,ct),this.updateLinePrim(ot.rendNode,ut.c1.scrCoords[1]+ut.d1x,ut.c1.scrCoords[2]+ut.d1y,ut.c2.scrCoords[1]-ut.d2x,ut.c2.scrCoords[2]-ut.d2y,ot.board),ut},updateArrowSize:function(ot,ct){var ut,ht,dt;return ht=at.evaluate(ot.visProp.firstarrow),ht&&(ut=at.exists(ht.size)?at.evaluate(ht.size):3,this._setArrowWidth(ot.rendNodeTriangleStart,ct.sFirst,ot.rendNode,ut)),dt=at.evaluate(ot.visProp.lastarrow),dt&&(ut=at.exists(dt.size)?at.evaluate(dt.size):3,this._setArrowWidth(ot.rendNodeTriangleEnd,ct.sLast,ot.rendNode,ut)),this},updateLine:function(ot){var ct;ct=this.updateLineEndings(ot,at.evaluate(ot.visProp.strokewidth)),this.makeArrows(ot),this._updateVisual(ot),this.updateArrowSize(ot,ct),this.setLineCap(ot)},getPositionArrowHead:function(ot,ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=nt.eps,St=0,Et=0,Tt=at.evaluate(ot.visProp.firstarrow),Mt=at.evaluate(ot.visProp.lastarrow);return mt=At=yt=bt=0,(Tt||Mt)&&(pt=at.evaluate(ot.point1.visProp.size)+at.evaluate(ot.point1.visProp.strokewidth),ft=at.evaluate(ot.point2.visProp.size)+at.evaluate(ot.point2.visProp.strokewidth),dt=pt+ft,Mt&&at.evaluate(ot.visProp.touchlastpoint)&&(gt=ct.distance(it.COORDS_BY_SCREEN,ut))>dt&&(yt=(ut.scrCoords[1]-ct.scrCoords[1])*ft/gt,bt=(ut.scrCoords[2]-ct.scrCoords[2])*ft/gt,ut=new rt(it.COORDS_BY_SCREEN,[ut.scrCoords[1]-yt,ut.scrCoords[2]-bt],ot.board)),Tt&&at.evaluate(ot.visProp.touchfirstpoint)&&(gt=ct.distance(it.COORDS_BY_SCREEN,ut))>dt&&(mt=(ut.scrCoords[1]-ct.scrCoords[1])*pt/gt,At=(ut.scrCoords[2]-ct.scrCoords[2])*pt/gt,ct=new rt(it.COORDS_BY_SCREEN,[ct.scrCoords[1]+mt,ct.scrCoords[2]+At],ot.board)),mt=At=yt=bt=0,gt=ct.distance(it.COORDS_BY_SCREEN,ut),at.exists(Tt.type)&&(xt=at.evaluate(Tt.type)),at.exists(Mt.type)&&(vt=at.evaluate(Mt.type)),Tt&&(_t=at.exists(Tt.size)?at.evaluate(Tt.size):3,St=ht*_t,xt===2?(St*=.5,Ct+=ht*_t):xt===3?(St=ht,Ct+=ht):Ct+=ht*_t),Mt&&(_t=at.exists(Mt.size)?at.evaluate(Mt.size):3,Et=ht*_t,vt===2?(Et*=.5,Ct+=ht*_t):vt===3?(Et=ht,Ct+=ht):Ct+=ht*_t),Tt&&ot.board.renderer.type!=="vml"&&(gt>=Ct?(mt=(ut.scrCoords[1]-ct.scrCoords[1])*St/gt,At=(ut.scrCoords[2]-ct.scrCoords[2])*St/gt):St=0),Mt&&ot.board.renderer.type!=="vml"&&(gt>=Ct?(yt=(ut.scrCoords[1]-ct.scrCoords[1])*Et/gt,bt=(ut.scrCoords[2]-ct.scrCoords[2])*Et/gt):Et=0)),{c1:ct,c2:ut,d1x:mt,d1y:At,d2x:yt,d2y:bt,sFirst:St,sLast:Et}},setLineCap:function(ot){},drawTicks:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("path",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"path")},updateTicks:function(ot){},drawCurve:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("path",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"path"),ot.numberPoints>1&&this.makeArrows(ot),this._updateVisual(ot,{shadow:!0},!0),this.updateCurve(ot)},updateCurve:function(ot){var ct,ut,ht,dt=at.evaluate(ot.visProp.strokewidth);at.evaluate(ot.visProp.handdrawing)?this.updatePathPrim(ot.rendNode,this.updatePathStringBezierPrim(ot),ot.board):this.updatePathPrim(ot.rendNode,this.updatePathStringPrim(ot),ot.board),ot.numberPoints>1&&(this.makeArrows(ot),ut=at.evaluate(ot.visProp.firstarrow),ut&&(ct=at.exists(ut.size)?at.evaluate(ut.size):3,this._setArrowWidth(ot.rendNodeTriangleStart,dt,ot.rendNode,ct)),(ht=at.evaluate(ot.visProp.lastarrow))&&(ct=at.exists(ht.size)?at.evaluate(ht.size):3,this._setArrowWidth(ot.rendNodeTriangleEnd,dt,ot.rendNode,ct))),this._updateVisual(ot)},drawEllipse:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("ellipse",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"ellipse"),this.updateEllipse(ot)},updateEllipse:function(ot){this._updateVisual(ot);var ct=ot.Radius();ct>0&&Math.abs(ot.center.coords.usrCoords[0])>nt.eps&&!isNaN(ct+ot.center.coords.scrCoords[1]+ot.center.coords.scrCoords[2])&&ct*ot.board.unitX<2e6&&this.updateEllipsePrim(ot.rendNode,ot.center.coords.scrCoords[1],ot.center.coords.scrCoords[2],ct*ot.board.unitX,ct*ot.board.unitY)},drawPolygon:function(ot){ot.rendNode=this.appendChildPrim(this.createPrim("polygon",ot.id),at.evaluate(ot.visProp.layer)),this.appendNodesToElement(ot,"polygon"),this.updatePolygon(ot)},updatePolygon:function(ot){this._updateVisual(ot,{stroke:!0,dash:!0}),this.updatePolygonPrim(ot.rendNode,ot)},displayCopyright:function(ot,ct){},drawInternalText:function(ot){},updateInternalText:function(ot){},drawText:function(ot){var ct,ut,ht;at.evaluate(ot.visProp.display)==="html"&&lt.isBrowser&&this.type!=="no"?(ct=this.container.ownerDocument.createElement("div"),ct.style.position="absolute",ct.className=at.evaluate(ot.visProp.cssclass),ht=at.evaluate(ot.visProp.layer),at.exists(ht)||(ht=0),ut=this.container.style.zIndex===""?0:parseInt(this.container.style.zIndex,10),ct.style.zIndex=ut+ht,this.container.appendChild(ct),ct.setAttribute("id",this.container.id+"_"+ot.id)):ct=this.drawInternalText(ot),ot.rendNode=ct,ot.htmlStr="",this.updateText(ot)},updateText:function(ot){var ct,ut,ht,dt,pt,ft=ot.plaintext;if(ot.visPropCalc.visible)if(this.updateTextStyle(ot,!1),at.evaluate(ot.visProp.display)==="html"&&this.type!=="no"){if(isNaN(ot.coords.scrCoords[1]+ot.coords.scrCoords[2])||(ut=ot.coords.scrCoords[1],ut=Math.abs(ut)<1e6?ut:1e6,dt=ot.getAnchorX(),ct=Math.floor(dt==="right"?ot.board.canvasWidth-ut:dt==="middle"?ut-.5*ot.size[0]:ut),ot.visPropOld.left!==dt+ct&&(dt==="right"?(ot.rendNode.style.right=ct+"px",ot.rendNode.style.left="auto"):(ot.rendNode.style.left=ct+"px",ot.rendNode.style.right="auto"),ot.visPropOld.left=dt+ct),ut=ot.coords.scrCoords[2]+this.vOffsetText,ut=Math.abs(ut)<1e6?ut:1e6,pt=ot.getAnchorY(),ct=Math.floor(pt==="bottom"?ot.board.canvasHeight-ut:pt==="middle"?ut-.5*ot.size[1]:ut),ot.visPropOld.top!==pt+ct&&(pt==="bottom"?(ot.rendNode.style.top="auto",ot.rendNode.style.bottom=ct+"px"):(ot.rendNode.style.bottom="auto",ot.rendNode.style.top=ct+"px"),ot.visPropOld.top=pt+ct)),ot.htmlStr!==ft){try{ot.rendNode.innerHTML=ft}catch{ht=ot.rendNode.parentNode,ot.rendNode.parentNode.removeChild(ot.rendNode),ot.rendNode.innerHTML=ft,ht.appendChild(ot.rendNode)}if(ot.htmlStr=ft,at.evaluate(ot.visProp.usemathjax))try{MathJax.Hub.Queue(["Typeset",MathJax.Hub,ot.rendNode])}catch{tt.debug("MathJax (not yet) loaded")}else if(at.evaluate(ot.visProp.useasciimathml))try{AMprocessNode(ot.rendNode,!1)}catch{tt.debug("AsciiMathML (not yet) loaded")}}this.transformImage(ot,ot.transformations)}else this.updateInternalText(ot)},_css2js:function(ot){var ct,ut,ht,dt,pt,ft=[],gt=at.trim(ot).replace(/;$/,"").split(";");for(ut=gt.length,ct=0;ct<ut;++ct)at.trim(gt[ct])!==""&&(pt=gt[ct].split(":"),ht=at.trim(pt[0].replace(/-([a-z])/gi,function(mt,At){return At.toUpperCase()})),dt=at.trim(pt[1]),ft.push({key:ht,val:dt}));return ft},updateTextStyle:function(ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt=ot.visProp,xt=lt.isBrowser?bt.display:"internal",vt=["rendNode","rendNodeTag","rendNodeLabel"],_t=vt.length,Ct=["cssdefaultstyle","cssstyle"],St=Ct.length;if(ct?(dt=bt.highlightstrokecolor,ht=bt.highlightstrokeopacity,pt=bt.highlightcssclass):(dt=bt.strokecolor,ht=bt.strokeopacity,pt=bt.cssclass),this.type!=="no"&&(xt==="html"||this.type!=="canvas")){for(At=0;At<St;At++)if((yt=at.evaluate(bt[(ct?"highlight":"")+Ct[At]]))!==""&&ot.visPropOld[Ct[At]]!==yt){for(gt=this._css2js(yt),ft=0;ft<_t;ft++)if(at.exists(ot[vt[ft]]))for(mt in gt)gt.hasOwnProperty(mt)&&(ot[vt[ft]].style[gt[mt].key]=gt[mt].val);ot.visPropOld[Ct[At]]=yt}if(ut=at.evaluate(bt.fontsize),ot.visPropOld.fontsize!==ut){ot.needsSizeUpdate=!0;try{for(ft=0;ft<_t;ft++)at.exists(ot[vt[ft]])&&(ot[vt[ft]].style.fontSize=ut+"px")}catch{for(ft=0;ft<_t;ft++)at.exists(ot[vt[ft]])&&(ot[vt[ft]].style.fontSize=ut)}ot.visPropOld.fontsize=ut}}return this.setObjectTransition(ot),xt==="html"&&this.type!=="no"?(ot.visPropOld.cssclass!==pt&&(ot.rendNode.className=pt,ot.visPropOld.cssclass=pt,ot.needsSizeUpdate=!0),this.setObjectStrokeColor(ot,dt,ht)):this.updateInternalTextStyle(ot,dt,ht),this},updateInternalTextStyle:function(ot,ct,ut){this.setObjectStrokeColor(ot,ct,ut)},drawImage:function(ot){},updateImage:function(ot){this.updateRectPrim(ot.rendNode,ot.coords.scrCoords[1],ot.coords.scrCoords[2]-ot.size[1],ot.size[0],ot.size[1]),this.updateImageURL(ot),this.transformImage(ot,ot.transformations),this._updateVisual(ot,{stroke:!0,dash:!0},!0)},joinTransforms:function(ot,ct){var ut,ht=ot.board.origin.scrCoords[1],dt=ot.board.origin.scrCoords[2],pt=ot.board.unitX,ft=ot.board.unitY,gt=ct.length,mt=[[1,0,0],[-ht/pt,1/pt,0],[dt/ft,0,-1/ft]];for(ut=0;ut<gt;ut++)mt=nt.matMatMult(ct[ut].matrix,mt);return mt=nt.matMatMult([[1,0,0],[ht,pt,0],[dt,0,-ft]],mt)},transformImage:function(ot,ct){},updateImageURL:function(ot){},updateImageStyle:function(ot,ct){ot.rendNode.className=at.evaluate(ct?ot.visProp.highlightcssclass:ot.visProp.cssclass)},appendChildPrim:function(ot,ct){},appendNodesToElement:function(ot,ct){},createPrim:function(ot,ct){return null},remove:function(ot){},makeArrows:function(ot){},_setArrowWidth:function(ot,ct,ut){},updateEllipsePrim:function(ot,ct,ut,ht,dt){},updateLinePrim:function(ot,ct,ut,ht,dt,pt){},updatePathPrim:function(ot,ct,ut){},updatePathStringPoint:function(ot,ct,ut){},updatePathStringPrim:function(ot){},updatePathStringBezierPrim:function(ot){},updatePolygonPrim:function(ot,ct){},updateRectPrim:function(ot,ct,ut,ht,dt){},setPropertyPrim:function(ot,ct,ut){},display:function(ot,ct){ot&&(ot.visPropOld.visible=ct)},show:function(ot){},hide:function(ot){},setBuffering:function(ot,ct){},setDashStyle:function(ot){},setDraft:function(ot){if(at.evaluate(ot.visProp.draft)){var ct=ot.board.options.elements.draft.color,ut=ot.board.options.elements.draft.opacity;this.setObjectTransition(ot),ot.type===it.OBJECT_TYPE_POLYGON?this.setObjectFillColor(ot,ct,ut):(ot.elementClass===it.OBJECT_CLASS_POINT?this.setObjectFillColor(ot,ct,ut):this.setObjectFillColor(ot,"none",0),this.setObjectStrokeColor(ot,ct,ut),this.setObjectStrokeWidth(ot,ot.board.options.elements.draft.strokeWidth))}},removeDraft:function(ot){this.setObjectTransition(ot),ot.type===it.OBJECT_TYPE_POLYGON?this.setObjectFillColor(ot,ot.visProp.fillcolor,ot.visProp.fillopacity):(ot.type===it.OBJECT_CLASS_POINT&&this.setObjectFillColor(ot,ot.visProp.fillcolor,ot.visProp.fillopacity),this.setObjectStrokeColor(ot,ot.visProp.strokecolor,ot.visProp.strokeopacity),this.setObjectStrokeWidth(ot,ot.visProp.strokewidth))},setGradient:function(ot){},updateGradient:function(ot){},setObjectTransition:function(ot,ct){},setObjectFillColor:function(ot,ct,ut){},setObjectStrokeColor:function(ot,ct,ut){},setObjectStrokeWidth:function(ot,ct){},setShadow:function(ot){},highlight:function(ot){var ct,ut,ht,dt=ot.visProp;if(this.setObjectTransition(ot),!dt.draft){if(ot.type===it.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(ot,dt.highlightfillcolor,dt.highlightfillopacity),ct=0;ct<ot.borders.length;ct++)this.setObjectStrokeColor(ot.borders[ct],ot.borders[ct].visProp.highlightstrokecolor,ot.borders[ct].visProp.highlightstrokeopacity);else ot.elementClass===it.OBJECT_CLASS_TEXT?this.updateTextStyle(ot,!0):ot.type===it.OBJECT_TYPE_IMAGE?(this.updateImageStyle(ot,!0),this.setObjectFillColor(ot,dt.highlightfillcolor,dt.highlightfillopacity)):(this.setObjectStrokeColor(ot,dt.highlightstrokecolor,dt.highlightstrokeopacity),this.setObjectFillColor(ot,dt.highlightfillcolor,dt.highlightfillopacity));dt.highlightstrokewidth&&(ut=Math.max(at.evaluate(dt.highlightstrokewidth),at.evaluate(dt.strokewidth)),this.setObjectStrokeWidth(ot,ut),ot.elementClass===it.OBJECT_CLASS_LINE&&(ht=this.updateLineEndings(ot,ut),this.makeArrows(ot),this.updateArrowSize(ot,ht)))}return this},noHighlight:function(ot){var ct,ut,ht,dt=ot.visProp;if(this.setObjectTransition(ot),!at.evaluate(ot.visProp.draft)){if(ot.type===it.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(ot,dt.fillcolor,dt.fillopacity),ct=0;ct<ot.borders.length;ct++)this.setObjectStrokeColor(ot.borders[ct],ot.borders[ct].visProp.strokecolor,ot.borders[ct].visProp.strokeopacity);else ot.elementClass===it.OBJECT_CLASS_TEXT?this.updateTextStyle(ot,!1):ot.type===it.OBJECT_TYPE_IMAGE?(this.updateImageStyle(ot,!1),this.setObjectFillColor(ot,dt.fillcolor,dt.fillopacity)):(this.setObjectStrokeColor(ot,dt.strokecolor,dt.strokeopacity),this.setObjectFillColor(ot,dt.fillcolor,dt.fillopacity));ht=at.evaluate(dt.strokewidth),this.setObjectStrokeWidth(ot,ht),ot.elementClass===it.OBJECT_CLASS_LINE&&(ut=this.updateLineEndings(ot,ht),this.makeArrows(ot),this.updateArrowSize(ot,ut))}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(ot,ct){var ut,ht,dt=function(ft){ft||(ft=window.event),ft.stopPropagation?ft.stopPropagation():ft.cancelBubble=!0},pt=function(ft,gt){var mt;mt=ut.createElement("span"),ht.appendChild(mt),mt.appendChild(ut.createTextNode(ft)),mt.style.paddingLeft="7px",mt.style.paddingRight="7px",lt.addEvent(mt,"mouseover",function(){this.style.backgroundColor=ct.highlightfillcolor},mt),lt.addEvent(mt,"mouseover",function(){this.style.backgroundColor=ct.highlightfillcolor},mt),lt.addEvent(mt,"mouseout",function(){this.style.backgroundColor=ct.fillcolor},mt),lt.addEvent(mt,"click",function(At){return at.bind(gt,ot)(),!1},ot),lt.addEvent(mt,"mouseup",dt,ot),lt.addEvent(mt,"mousedown",dt,ot),lt.addEvent(mt,"touchend",dt,ot),lt.addEvent(mt,"touchstart",dt,ot)};lt.isBrowser&&this.type!=="no"&&(ut=ot.containerObj.ownerDocument,ht=ut.createElement("div"),ht.setAttribute("id",ot.containerObj.id+"_navigationbar"),ht.style.color=ct.strokecolor,ht.style.backgroundColor=ct.fillcolor,ht.style.padding=ct.padding,ht.style.position=ct.position,ht.style.fontSize=ct.fontsize,ht.style.cursor=ct.cursor,ht.style.zIndex=ct.zindex,ot.containerObj.appendChild(ht),ht.style.right=ct.right,ht.style.bottom=ct.bottom,ot.attr.showscreenshot&&pt(ot.attr.screenshot.symbol,function(){setTimeout(function(){ot.renderer.screenshot(ot,"",!1)},330)}),ot.attr.showreload&&pt("↻",function(){ot.reload()}),ot.attr.showcleartraces&&pt("⊗",function(){ot.clearTraces()}),ot.attr.shownavigation&&(ot.attr.showzoom&&(pt("–",ot.zoomOut),pt("o",ot.zoom100),pt("+",ot.zoomIn)),pt("←",ot.clickLeftArrow),pt("↓",ot.clickUpArrow),pt("↑",ot.clickDownArrow),pt("→",ot.clickRightArrow)))},getElementById:function(ot){return at.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+ot):""},removeToInsertLater:function(ot){var ct=ot.parentNode,ut=ot.nextSibling;return ct.removeChild(ot),function(){ut?ct.insertBefore(ot,ut):ct.appendChild(ot)}},resize:function(ot,ct){},createTouchpoints:function(ot){},showTouchpoint:function(ot){},hideTouchpoint:function(ot){},updateTouchpoint:function(ot,ct){},dumpToCanvas:function(ot){},screenshot:function(ot){}}),tt.AbstractRenderer}),define("renderer/no",["jxg","renderer/abstract"],function(tt,_e){return tt.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},tt.extend(tt.NoRenderer.prototype,{drawPoint:function(rt){},updatePoint:function(rt){},changePointStyle:function(rt){},drawLine:function(rt){},updateLine:function(rt){},drawTicks:function(rt){},updateTicks:function(rt){},drawCurve:function(rt){},updateCurve:function(rt){},drawEllipse:function(rt){},updateEllipse:function(rt){},drawPolygon:function(rt){},updatePolygon:function(rt){},displayCopyright:function(rt,it){},drawInternalText:function(rt){},updateInternalText:function(rt){},drawText:function(rt){},updateText:function(rt){},updateTextStyle:function(rt,it){},updateInternalTextStyle:function(rt,it,nt){},drawImage:function(rt){},updateImage:function(rt){},transformImage:function(rt,it){},updateImageURL:function(rt){},appendChildPrim:function(rt,it){},appendNodesToElement:function(rt,it){},createPrim:function(rt,it){return null},remove:function(rt){},makeArrows:function(rt){},updateEllipsePrim:function(rt,it,nt,st,at){},updateLinePrim:function(rt,it,nt,st,at,lt){},updatePathPrim:function(rt,it,nt){},updatePathStringPoint:function(rt,it,nt){},updatePathStringPrim:function(rt){},updatePathStringBezierPrim:function(rt){},updatePolygonPrim:function(rt,it){},updateRectPrim:function(rt,it,nt,st,at){},setPropertyPrim:function(rt,it,nt){},display:function(rt,it){rt&&(rt.visPropOld.visible=it)},show:function(rt){},hide:function(rt){},setBuffering:function(rt,it){},setDashStyle:function(rt){},setDraft:function(rt){},removeDraft:function(rt){},setGradient:function(rt){},updateGradient:function(rt){},setObjectTransition:function(rt,it){},setObjectFillColor:function(rt,it,nt){},setObjectStrokeColor:function(rt,it,nt){},setObjectStrokeWidth:function(rt,it){},setShadow:function(rt){},highlight:function(rt){},noHighlight:function(rt){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(rt){},getElementById:function(rt){return null},resize:function(rt,it){},removeToInsertLater:function(){return function(){}}}),tt.NoRenderer.prototype=new _e,tt.NoRenderer}),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],function(tt,_e,rt,it,nt){return tt.FileReader={parseFileContent:function(st,at,lt,ot,ct){var ut=!1;rt.exists(ot)||(ot=!0);try{ut=new XMLHttpRequest,lt.toLowerCase()==="raw"?ut.overrideMimeType("text/plain; charset=iso-8859-1"):ut.overrideMimeType("text/xml; charset=iso-8859-1")}catch{try{ut=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{ut=new ActiveXObject("Microsoft.XMLHTTP")}catch{ut=!1}}}if(!ut)return void tt.debug("AJAX not activated!");ut.open("GET",st,ot),lt.toLowerCase()==="raw"?this.cbp=function(){var ht=ut;ht.readyState===4&&at(ht.responseText)}:this.cbp=function(){var ht=ut,dt="";ht.readyState===4&&(dt=!rt.exists(ht.responseStream)||ht.responseText.slice(0,2)!=="PK"&&it.asciiCharCodeAt(ht.responseText.slice(0,1),0)!==31?ht.responseText:nt.decode(jxgBinFileReader(ht)),this.parseString(dt,at,lt,ct))},this.cb=rt.bind(this.cbp,this),ut.onreadystatechange=this.cb;try{ut.send(null)}catch{throw new Error("JSXGraph: A problem occurred while trying to read '"+st+"'.")}},parseString:function(st,at,lt,ot){var ct,ut;if(lt=lt.toLowerCase(),ct=tt.readers[lt],!rt.exists(ct))throw new Error("JSXGraph: There is no reader available for '"+lt+"'.");ut=new ct(at,st),ut.read(),rt.isFunction(ot)&&ot(at)}},!_e.isMetroApp()&&_e.isBrowser&&typeof navigator=="object"&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write(`<script type="text/vbscript">
Function Base64Encode(inData)
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim cOut, sOut, I
  For I = 1 To LenB(inData) Step 3
    Dim nGroup, pOut, sGroup
    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _
      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))
    nGroup = Oct(nGroup)
    nGroup = String(8 - Len(nGroup), "0") & nGroup
    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)
    sOut = sOut + pOut
  Next
  Select Case LenB(inData) Mod 3
    Case 1: '8 bit final
      sOut = Left(sOut, Len(sOut) - 2) + "=="
    Case 2: '16 bit final
      sOut = Left(sOut, Len(sOut) - 1) + "="
  End Select
  Base64Encode = sOut
End Function

Function MyASC(OneChar)
  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)
End Function

Function jxgBinFileReader(xhr)
    Dim byteString
    Dim b64String
    Dim i
    byteString = xhr.responseBody
    ReDim byteArray(LenB(byteString))
    For i = 1 To LenB(byteString)
        byteArray(i-1) = AscB(MidB(byteString, i, 1))
    Next
    b64String = Base64Encode(byteString)
    jxgBinFileReader = b64String
End Function
<\/script>
`),tt.FileReader}),define("parser/geonext",["jxg","base/constants","utils/type"],function(tt,_e,rt){return tt.GeonextParser={replacePow:function(it){var nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt;for(it=it.replace(/(\s*)\^(\s*)/g,"^"),pt=it.indexOf("^"),lt=-1;pt>=0&&pt<it.length-1;){if(lt===pt)throw new Error("JSXGraph: Error while parsing expression '"+it+"'");if(lt=pt,dt=it.slice(0,pt),ft=it.slice(pt+1),dt.charAt(dt.length-1)===")"){for(nt=1,st=dt.length-2;st>=0&&nt>0;)at=dt.charAt(st),at===")"?nt++:at==="("&&(nt-=1),st-=1;if(nt!==0)throw new Error("JSXGraph: Missing '(' in expression");for(ot="",ut=dt.substring(0,st+1),ht=st;ht>=0&&ut.substr(ht,1).match(/([\w\.]+)/);)ot=RegExp.$1+ot,ht-=1;ot+=dt.substring(st+1,dt.length),ot=ot.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else ot="[\\w\\.]+";if(ft.match(/^([\w\.]*\()/)){for(nt=1,st=RegExp.$1.length;st<ft.length&&nt>0;)at=ft.charAt(st),at===")"?nt-=1:at==="("&&(nt+=1),st+=1;if(nt!==0)throw new Error("JSXGraph: Missing ')' in expression");ct=ft.substring(0,st),ct=ct.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else ct="[\\w\\.]+";gt=new RegExp("("+ot+")\\^("+ct+")"),it=it.replace(gt,"pow($1,$2)"),pt=it.indexOf("^")}return it},replaceIf:function(it){var nt,st,at,lt,ot,ct,ut,ht,dt,pt="",ft=null,gt=null,mt=null;if((at=it.indexOf("If("))<0)return it;for(it=it.replace(/""/g,"0");at>=0;){for(nt=it.slice(0,at),st=it.slice(at+3),ot=1,lt=0,ct=-1,ut=-1;lt<st.length&&ot>0;)ht=st.charAt(lt),ht===")"?ot-=1:ht==="("?ot+=1:ht===","&&ot===1&&(ct<0?ct=lt:ut=lt),lt+=1;if(dt=st.slice(0,lt-1),st=st.slice(lt),ct<0||ut<0)return"";ft=dt.slice(0,ct),gt=dt.slice(ct+1,ut),mt=dt.slice(ut+1),ft=this.replaceIf(ft),gt=this.replaceIf(gt),mt=this.replaceIf(mt),pt+=nt+"(("+ft+")?("+gt+"):("+mt+"))",it=st,ft=null,gt=null,at=it.indexOf("If(")}return pt+=st},replaceNameById:function(it,nt,st){var at,lt,ot,ct,ut=0,ht=["X","Y","L","V"],dt=function(pt){return st?"$('"+pt+"')":pt};for(ct=0;ct<ht.length;ct++)for(ut=it.indexOf(ht[ct]+"(");ut>=0;)ut>=0&&(at=it.indexOf(")",ut+2))>=0&&(lt=it.slice(ut+2,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+2)+(st?"$('":"")+dt(ot.id)+it.slice(at))),at=it.indexOf(")",ut+2),ut=it.indexOf(ht[ct]+"(",at);for(ut=it.indexOf("Dist(");ut>=0;)ut>=0&&(at=it.indexOf(",",ut+5))>=0&&(lt=it.slice(ut+5,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+5)+dt(ot.id)+it.slice(at))),at=it.indexOf(",",ut+5),ut=it.indexOf(",",at),at=it.indexOf(")",ut+1),at>=0&&(lt=it.slice(ut+1,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+1)+dt(ot.id)+it.slice(at))),at=it.indexOf(")",ut+1),ut=it.indexOf("Dist(",at);for(ht=["Deg","Rad"],ct=0;ct<ht.length;ct++)for(ut=it.indexOf(ht[ct]+"(");ut>=0;)ut>=0&&(at=it.indexOf(",",ut+4))>=0&&(lt=it.slice(ut+4,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+4)+dt(ot.id)+it.slice(at))),at=it.indexOf(",",ut+4),ut=it.indexOf(",",at),at=it.indexOf(",",ut+1),at>=0&&(lt=it.slice(ut+1,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+1)+dt(ot.id)+it.slice(at))),at=it.indexOf(",",ut+1),ut=it.indexOf(",",at),at=it.indexOf(")",ut+1),at>=0&&(lt=it.slice(ut+1,at),lt=lt.replace(/\\(['"])?/g,"$1"),(ot=nt.elementsByName[lt])&&(it=it.slice(0,ut+1)+dt(ot.id)+it.slice(at))),at=it.indexOf(")",ut+1),ut=it.indexOf(ht[ct]+"(",at);return it},replaceIdByObj:function(it){var nt=/(X|Y|L)\(([\w_]+)\)/g;return it=it.replace(nt,"$('$2').$1()"),nt=/(V)\(([\w_]+)\)/g,it=it.replace(nt,"$('$2').Value()"),nt=/(Dist)\(([\w_]+),([\w_]+)\)/g,it=it.replace(nt,"dist($('$2'), $('$3'))"),nt=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g,it=it.replace(nt,"deg($('$2'),$('$3'),$('$4'))"),nt=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,it=it.replace(nt,"rad($('$1'),$('$2'),$('$3'))"),nt=/N\((.+)\)/g,it=it.replace(nt,"($1)")},geonext2JS:function(it,nt){var st,at,lt,ot=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],ct=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(it=it.replace(/&lt;/g,"<"),it=it.replace(/&gt;/g,">"),it=it.replace(/&amp;/g,"&"),at=it,at=this.replaceNameById(at,nt),at=this.replaceIf(at),at=this.replacePow(at),at=this.replaceIdByObj(at),lt=0;lt<ot.length;lt++)st=new RegExp(["(\\W|^)(",ot[lt],")"].join(""),"ig"),at=at.replace(st,["$1",ct[lt]].join(""));return at=at.replace(/True/g,"true"),at=at.replace(/False/g,"false"),at=at.replace(/fasle/g,"false"),at=at.replace(/Pi/g,"PI"),at=at.replace(/"/g,"'")},findDependencies:function(it,nt,st){var at,lt,ot,ct;rt.exists(st)||(st=it.board),at=st.elementsByName;for(lt in at)at.hasOwnProperty(lt)&&lt!==it.name&&(at[lt].elementClass===_e.OBJECT_CLASS_TEXT?rt.evaluate(at[lt].visProp.islabel)||(ct=lt.replace(/\[/g,"\\["),ct=ct.replace(/\]/g,"\\]"),ot=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+ct+")(,[\\w\\[\\]'_ ]+)*\\)","g"),nt.search(ot)>=0&&at[lt].addChild(it)):(ct=lt.replace(/\[/g,"\\["),ct=ct.replace(/\]/g,"\\]"),ot=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+ct+")(,[\\w\\[\\]'_ ]+)*\\)","g"),nt.search(ot)>=0&&at[lt].addChild(it)))},gxt2jc:function(it,nt){var st;return it=it.replace(/&lt;/g,"<"),it=it.replace(/&gt;/g,">"),it=it.replace(/&amp;/g,"&"),st=it,st=this.replaceNameById(st,nt,!0),st=st.replace(/True/g,"true"),st=st.replace(/False/g,"false"),st=st.replace(/fasle/g,"false")}},tt.GeonextParser}),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","parser/geonext","utils/event","utils/color","utils/type"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){return tt.GeometryElement=function(ut,ht,dt,pt){var ft,gt,mt;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},lt.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){this.board=ut,this.type=dt,this._org_type=dt,this.elementClass=pt||_e.OBJECT_CLASS_OTHER,this.id=ht.id,ft=ht.name,ct.exists(ft)||(ft=this.board.generateName(this)),ft!==""&&(this.board.elementsByName[ft]=this),this.name=ft,this.needsRegularUpdate=ht.needsregularupdate,ct.clearVisPropOld(this),mt=this.resolveShortcuts(ht);for(gt in mt)mt.hasOwnProperty(gt)&&this._set(gt,mt[gt]);this.visProp.draft=mt.draft&&mt.draft.draft,this.visProp.gradientangle="270",this.visProp.gradientsecondopacity=ct.evaluate(this.visProp.fillopacity),this.visProp.gradientpositionx=.5,this.visProp.gradientpositiony=.5}},tt.extend(tt.GeometryElement.prototype,{addChild:function(ut){var ht,dt;this.childElements[ut.id]=ut,this.addDescendants(ut),ut.ancestors[this.id]=this;for(ht in this.descendants)if(this.descendants.hasOwnProperty(ht)){this.descendants[ht].ancestors[this.id]=this;for(dt in this.ancestors)this.ancestors.hasOwnProperty(dt)&&(this.descendants[ht].ancestors[this.ancestors[dt].id]=this.ancestors[dt])}for(ht in this.ancestors)if(this.ancestors.hasOwnProperty(ht))for(dt in this.descendants)this.descendants.hasOwnProperty(dt)&&(this.ancestors[ht].descendants[this.descendants[dt].id]=this.descendants[dt]);return this},addDescendants:function(ut){var ht;this.descendants[ut.id]=ut;for(ht in ut.childElements)ut.childElements.hasOwnProperty(ht)&&this.addDescendants(ut.childElements[ht]);return this},addParents:function(ut){var ht,dt,pt;for(pt=ct.isArray(ut)?ut:arguments,dt=pt.length,ht=0;ht<dt;++ht)ct.exists(pt[ht])&&(ct.isId(this.board,pt[ht])?this.parents.push(pt[ht]):ct.exists(pt[ht].id)&&this.parents.push(pt[ht].id));this.parents=ct.uniqueArray(this.parents)},setParents:function(ut){this.parents=[],this.addParents(ut)},removeChild:function(ut){return delete this.childElements[ut.id],this.removeDescendants(ut),delete ut.ancestors[this.id],this},removeDescendants:function(ut){var ht;delete this.descendants[ut.id];for(ht in ut.childElements)ut.childElements.hasOwnProperty(ht)&&this.removeDescendants(ut.childElements[ht]);return this},countChildren:function(){var ut,ht,dt=0;ht=this.childElements;for(ut in ht)ht.hasOwnProperty(ut)&&ut.indexOf("Label")<0&&dt++;return dt},getName:function(){return this.name},addTransform:function(ut){return this},draggable:function(){return this.isDraggable&&!ct.evaluate(this.visProp.fixed)&&this.type!==_e.OBJECT_TYPE_GLIDER},setPosition:function(ut,ht){var dt,pt,ft,gt,mt=[];if(!ct.exists(this.parents))return this;for(ft=this.parents.length,pt=0;pt<ft;++pt)if(dt=this.board.select(this.parents[pt]),ct.isPoint(dt)){if(!dt.draggable())return this;mt.push(dt)}for(ht.length===3&&(ht=ht.slice(1)),gt=this.board.create("transform",ht,{type:"translate"}),ft=mt.length,ft>0?gt.applyOnce(mt):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(gt):this.addTransform(gt),pt=0;pt<ft;++pt)mt[pt].type===_e.OBJECT_TYPE_GLIDER&&mt[pt].updateGlider();return this},setPositionDirectly:function(ut,ht,dt){var pt=new rt(ut,ht,this.board,!1),ft=new rt(ut,dt,this.board,!1),gt=nt.subtract(pt.usrCoords,ft.usrCoords);return this.setPosition(_e.COORDS_BY_USER,gt),this},generatePolynomial:function(){return[]},animate:function(ut,ht,dt){dt=dt||{};var pt,ft,gt,mt=this.board.attr.animationdelay,At=Math.ceil(ht/mt),yt=this,bt=function(xt,vt,_t,Ct){var St,Et;if(xt=parseFloat(xt),vt=parseFloat(vt),!isNaN(xt)&&!isNaN(vt))for(Et=(vt-xt)/At,yt.animationData[_t]=[],gt=0;gt<At;gt++)St=xt+(gt+1)*Et,yt.animationData[_t][At-gt-1]=Ct?Math.floor(St):St};this.animationData={};for(pt in ut)if(ut.hasOwnProperty(pt))switch(ft=pt.toLowerCase()){case"strokecolor":case"fillcolor":(function(xt,vt,_t){var Ct,St,Et,Tt,Mt;for(Ct=ot.rgb2hsv(xt),St=ot.rgb2hsv(vt),Et=(St[0]-Ct[0])/At,Tt=(St[1]-Ct[1])/At,Mt=(St[2]-Ct[2])/At,yt.animationData[_t]=[],gt=0;gt<At;gt++)yt.animationData[_t][At-gt-1]=ot.hsv2rgb(Ct[0]+(gt+1)*Et,Ct[1]+(gt+1)*Tt,Ct[2]+(gt+1)*Mt)})(this.visProp[ft],ut[pt],ft);break;case"size":if(!ct.isPoint(this))break;bt(this.visProp[ft],ut[pt],ft,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":bt(this.visProp[ft],ut[pt],ft,!1)}return this.animationCallback=dt.callback,this.board.addAnimation(this),this},update:function(){return ct.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(ut){return this.prepareUpdate().update().updateVisibility(ut).updateRenderer()},setDisplayRendNode:function(ut){var ht,dt,pt,ft,gt;if(ut===void 0&&(ut=this.visPropCalc.visible),ut===this.visPropOld.visible)return this;for(this.board.renderer.display(this,ut),dt=this.inherits.length,pt=0;pt<dt;pt++)if(gt=this.inherits[pt],ct.isArray(gt))for(ft=gt.length,ht=0;ht<ft;ht++)ct.exists(gt[ht])&&ct.exists(gt[ht].rendNode)&&ct.evaluate(gt[ht].visProp.visible)==="inherit"&&gt[ht].setDisplayRendNode(ut);else ct.exists(gt)&&ct.exists(gt.rendNode)&&ct.evaluate(gt.visProp.visible)==="inherit"&&gt.setDisplayRendNode(ut);return this.hasLabel&&ct.exists(this.label)&&ct.exists(this.label.rendNode)&&ct.evaluate(this.label.visProp.visible)==="inherit"&&this.label.setDisplayRendNode(ut),this},hideElement:function(){return tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!1,this.board.renderer.display(this,!1),ct.exists(this.label)&&this.hasLabel&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement()),this},showElement:function(){return tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!0,this.board.renderer.display(this,!0),ct.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},updateVisibility:function(ut){var ht,dt,pt,ft,gt,mt;if(this.needsUpdate){for(ut!==void 0?this.visPropCalc.visible=ut:(mt=ct.evaluate(this.visProp.visible),ct.exists(this.hiddenByParent)&&this.hiddenByParent&&(mt=!1),mt!=="inherit"&&(this.visPropCalc.visible=mt)),dt=this.inherits.length,pt=0;pt<dt;pt++)if(gt=this.inherits[pt],ct.isArray(gt))for(ft=gt.length,ht=0;ht<ft;ht++)ct.exists(gt[ht])&&ct.evaluate(gt[ht].visProp.visible)==="inherit"&&gt[ht].prepareUpdate().updateVisibility(this.visPropCalc.visible);else ct.exists(gt)&&ct.evaluate(gt.visProp.visible)==="inherit"&&gt.prepareUpdate().updateVisibility(this.visPropCalc.visible);ct.exists(this.label)&&ct.exists(this.label.visProp)&&ct.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(ut,ht){ut=ut.toLocaleLowerCase(),this.visProp.hasOwnProperty(ut)&&ut.indexOf("color")>=0&&ct.isString(ht)&&ht.length===9&&ht.charAt(0)==="#"?(ht=ot.rgba2rgbo(ht),this.visProp[ut]=ht[0],this.visProp[ut.replace("color","opacity")]=ht[1]):this.visProp[ut]=ht},resolveShortcuts:function(ut){var ht,dt;for(ht in st.shortcuts)if(st.shortcuts.hasOwnProperty(ht)&&ct.exists(ut[ht]))for(dt=0;dt<st.shortcuts[ht].length;dt++)ct.exists(ut[st.shortcuts[ht][dt]])||(ut[st.shortcuts[ht][dt]]=ut[ht]);return ut},setLabel:function(ut){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(ut)},setLabelText:function(ut){return ct.exists(this.label)&&(ut=ut.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(ut)),this},setName:function(ut){ut=ut.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.elType!=="slider"&&this.setLabelText(ut),this.setAttribute({name:ut})},setProperty:function(){tt.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt={};for(ht=0;ht<arguments.length;ht++)mt=arguments[ht],ct.isString(mt)?(yt=mt.split(":"),xt[ct.trim(yt[0])]=ct.trim(yt[1])):ct.isArray(mt)?xt[mt[0]]=mt[1]:tt.extend(xt,mt);xt=this.resolveShortcuts(xt);for(ht in xt)if(xt.hasOwnProperty(ht)){if(ft=ht.replace(/\s+/g,"").toLowerCase(),gt=xt[ht],bt=this.visProp[ft],ct.isObject(gt)&&ct.exists(this.visProp[ft])){if(this.visProp[ft]=ct.merge(this.visProp[ft],gt),this.type===_e.OBJECT_TYPE_TICKS&&ct.exists(this.labels))for(pt=this.labels.length,dt=0;dt<pt;dt++)this.labels[dt].setAttribute(gt);continue}switch(ft){case"name":bt=this.name,delete this.board.elementsByName[this.name],this.name=gt,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!(gt==="false"||gt===!1),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":gt=ot.rgba2rgbo(gt),At=gt[1],gt=gt[0],At===0&&ct.exists(this.label)&&this.hasLabel&&this.label.hideElement(),ct.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=gt,this.board.renderer.setObjectStrokeColor(this.label,gt,At)),this.elementClass===_e.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=gt,this.visProp.strokeopacity=At,this.board.renderer.setObjectStrokeColor(this,gt,At));break;case"infoboxtext":ct.isString(gt)?this.infoboxText=gt:this.infoboxText=!1;break;case"visible":this.visProp.visible=gt!=="false"&&(gt==="true"||gt),this.setDisplayRendNode(ct.evaluate(this.visProp.visible));break;case"face":ct.isPoint(this)&&(this.visProp.face=gt,this.board.renderer.changePointStyle(this));break;case"trace":gt==="false"||gt===!1?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=!0;break;case"gradient":this.visProp.gradient=gt,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":gt=ot.rgba2rgbo(gt),this.visProp.gradientsecondcolor=gt[0],this.visProp.gradientsecondopacity=gt[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=gt,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=gt,ct.evaluate(gt)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=gt;break;case"radius":this.type!==_e.OBJECT_TYPE_ANGLE&&this.type!==_e.OBJECT_TYPE_SECTOR||this.setRadius(gt);break;case"rotate":(this.elementClass===_e.OBJECT_CLASS_TEXT&&ct.evaluate(this.visProp.display)==="internal"||this.type===_e.OBJECT_TYPE_IMAGE)&&this.addRotation(gt);break;case"ticksdistance":this.type===_e.OBJECT_TYPE_TICKS&&ct.isNumber(gt)&&(this.ticksFunction=this.makeTicksFunction(gt));break;case"generatelabelvalue":this.type===_e.OBJECT_TYPE_TICKS&&ct.isFunction(gt)&&(this.generateLabelValue=gt);break;case"onpolygon":this.type===_e.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!gt);break;case"disabled":ct.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!gt);break;case"checked":ct.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!gt);break;case"maxlength":ct.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!gt);break;default:ct.exists(this.visProp[ft])&&(!tt.Validator[ft]||tt.Validator[ft]&&tt.Validator[ft](gt)||tt.Validator[ft]&&ct.isFunction(gt)&&tt.Validator[ft](gt()))&&(gt=(!gt.toLowerCase||gt.toLowerCase()!=="false")&&gt,this._set(ft,gt))}this.triggerEventHandlers(["attribute:"+ft],[bt,gt,this])}return this.triggerEventHandlers(["attribute"],[xt,this]),ct.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){tt.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(ut){var ht;switch(ut=ut.toLowerCase()){case"needsregularupdate":ht=this.needsRegularUpdate;break;case"labelcolor":ht=this.label.visProp.strokecolor;break;case"infoboxtext":ht=this.infoboxText;break;case"withlabel":ht=this.hasLabel;break;default:ht=this.visProp[ut]}return ht},setDash:function(ut){return this.setAttribute({dash:ut}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new rt(_e.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new rt(_e.COORDS_BY_USER,[0,0],this.board)},setArrow:function(ut,ht){return this.visProp.firstarrow=ut,this.visProp.lastarrow=ht,ht&&(this.type=_e.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var ut=ct.evaluate(this.visProp.gradient);ut!=="linear"&&ut!=="radial"||this.board.renderer.setGradient(this)},createLabel:function(){var ut,ht=this;return tt.elements.text?(ut=ct.deepCopy(this.visProp.label,null),ut.id=this.id+"Label",ut.isLabel=!0,ut.anchor=this,ut.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=tt.elements.text(this.board,[0,0,function(){return ct.isFunction(ht.name)?ht.name():ht.name}],ut),this.label.needsUpdate=!0,this.label.dump=!1,this.label.update(),this.hasLabel=!0)):tt.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(ut){return ut=ct.def(ut,!1),!ct.evaluate(this.visProp.highlight)||this.highlighted&&!ut||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var ut;for(ut in this.traces)this.traces.hasOwnProperty(ut)&&this.board.renderer.remove(this.traces[ut]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=it.normalize(this.stdform),this},toJSON:function(){var ut,ht,dt=['{"name":',this.name];dt.push(', "id":'+this.id),ut=[];for(ht in this.visProp)this.visProp.hasOwnProperty(ht)&&ct.exists(this.visProp[ht])&&ut.push('"'+ht+'":'+this.visProp[ht]);return dt.push(', "visProp":{'+ut.toString()+"}"),dt.push("}"),dt.join("")},addRotation:function(ut){var ht,dt,pt,ft,gt,mt=this;return(this.elementClass===_e.OBJECT_CLASS_TEXT&&ct.evaluate(this.visProp.display)==="internal"||this.type===_e.OBJECT_TYPE_IMAGE)&&ut!==0&&(ht=this.board.create("transform",[function(){return-mt.X()},function(){return-mt.Y()}],{type:"translate"}),dt=this.board.create("transform",[function(){return mt.X()},function(){return mt.Y()}],{type:"translate"}),pt=this.board.create("transform",[function(){return mt.board.unitX/mt.board.unitY},function(){return 1}],{type:"scale"}),ft=this.board.create("transform",[function(){return mt.board.unitY/mt.board.unitX},function(){return 1}],{type:"scale"}),gt=this.board.create("transform",[ut*Math.PI/180],{type:"rotate"}),ht.bindTo(this),pt.bindTo(this),gt.bindTo(this),ft.bindTo(this),dt.bindTo(this)),this},highlightStrokeColor:function(ut){return tt.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:ut}),this},strokeColor:function(ut){return tt.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:ut}),this},strokeWidth:function(ut){return tt.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:ut}),this},fillColor:function(ut){return tt.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:ut}),this},highlightFillColor:function(ut){return tt.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:ut}),this},labelColor:function(ut){return tt.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:ut}),this},dash:function(ut){return tt.deprecated("dash()","setAttribute()"),this.setAttribute({dash:ut}),this},visible:function(ut){return tt.deprecated("visible()","setAttribute()"),this.setAttribute({visible:ut}),this},shadow:function(ut){return tt.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:ut}),this},getType:function(){return this.elType},getParents:function(){return ct.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var ut,ht=ct.deepCopy(this.visProp),dt=[],pt=dt.length;for(ht.id=this.id,ht.name=this.name,ut=0;ut<pt;ut++)delete ht[dt[ut]];return ht},hasPoint:function(ut,ht){return!1},handleSnapToGrid:function(ut,ht){var dt,pt,ft,gt,mt=!1,At=ct.evaluate(this.visProp.snapsizex),yt=ct.evaluate(this.visProp.snapsizey);return ct.exists(this.coords)?(mt=ct.evaluate(this.visProp.snaptogrid)||ut===!0,mt&&(dt=this.coords.usrCoords[1],pt=this.coords.usrCoords[2],At<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(ft=this.board.defaultAxes.x.defaultTicks,At=ft.ticksDelta*(ct.evaluate(ft.visProp.minorticks)+1)),yt<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(ft=this.board.defaultAxes.y.defaultTicks,yt=ft.ticksDelta*(ct.evaluate(ft.visProp.minorticks)+1)),At>0&&yt>0&&(gt=this.board.getBoundingBox(),dt=Math.round(dt/At)*At,pt=Math.round(pt/yt)*yt,ht||(dt<gt[0]?dt+=At:dt>gt[2]&&(dt-=At),pt<gt[3]?pt+=yt:pt>gt[1]&&(pt-=yt)),this.coords.setCoordinates(_e.COORDS_BY_USER,[dt,pt]))),this):this},addEvent:tt.shortcut(tt.GeometryElement.prototype,"on"),removeEvent:tt.shortcut(tt.GeometryElement.prototype,"off"),__evt__over:function(ut){},__evt__mouseover:function(ut){},__evt__out:function(ut){},__evt__mouseout:function(ut){},__evt__move:function(ut){},__evt__mousemove:function(ut){},__evt__drag:function(ut){},__evt__mousedrag:function(ut){},__evt__touchdrag:function(ut){},__evt__down:function(ut){},__evt__mousedown:function(ut){},__evt__touchdown:function(ut){},__evt__up:function(ut){},__evt__mouseup:function(ut){},__evt__touchup:function(ut){},__evt__attribute:function(ut,ht){},__evt__attribute_:function(ut,ht,dt){},__evt:function(){}}),tt.GeometryElement}),define("base/transformation",["jxg","base/constants","math/math","utils/type"],function(tt,_e,rt,it){return tt.Transformation=function(nt,st,at){this.elementClass=_e.OBJECT_CLASS_OTHER,this.type=_e.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=nt,this.isNumericMatrix=!1,this.setMatrix(nt,st,at),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bind",melt:"melt"}},tt.Transformation.prototype={},tt.extend(tt.Transformation.prototype,{update:function(){return this},setMatrix:function(nt,st,at){var lt;for(this.isNumericMatrix=!0,lt=0;lt<at.length;lt++)if(typeof at[lt]!="number"){this.isNumericMatrix=!1;break}if(st==="translate"){if(at.length!==2)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=it.createEvalFunction(nt,at,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if(st==="scale"){if(at.length!==2)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=it.createEvalFunction(nt,at,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if(st==="reflect")at.length<4&&(at[0]=nt.select(at[0])),at.length===2&&(at[1]=nt.select(at[1])),at.length===4&&(this.evalParam=it.createEvalFunction(nt,at,4)),this.update=function(){var ot,ct,ut,ht,dt,pt,ft,gt;at.length===1?ft=at[0].stdform:at.length===2?ft=rt.crossProduct(at[1].coords.usrCoords,at[0].coords.usrCoords):at.length===4&&(ft=rt.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),ot=ft[1],ct=ft[2],ut=ft[0],gt=[-ut*ot,-ut*ct,ot*ot+ct*ct],pt=gt[2],ht=gt[0]/gt[2],dt=gt[1]/gt[2],ot=-ft[2],ct=ft[1],this.matrix[1][1]=(ot*ot-ct*ct)/pt,this.matrix[1][2]=2*ot*ct/pt,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=ht*(1-this.matrix[1][1])-dt*this.matrix[1][2],this.matrix[2][0]=dt*(1-this.matrix[2][2])-ht*this.matrix[2][1]};else if(st==="rotate")at.length===3?this.evalParam=it.createEvalFunction(nt,at,3):at.length>0&&at.length<=2&&(this.evalParam=it.createEvalFunction(nt,at,1),at.length!==2||it.isArray(at[1])||(at[1]=nt.select(at[1]))),this.update=function(){var ot,ct,ut=this.evalParam(0),ht=Math.cos(ut),dt=Math.sin(ut);this.matrix[1][1]=ht,this.matrix[1][2]=-dt,this.matrix[2][1]=dt,this.matrix[2][2]=ht,at.length>1&&(at.length===3?(ot=this.evalParam(1),ct=this.evalParam(2)):it.isArray(at[1])?(ot=at[1][0],ct=at[1][1]):(ot=at[1].X(),ct=at[1].Y()),this.matrix[1][0]=ot*(1-ht)+ct*dt,this.matrix[2][0]=ct*(1-ht)-ot*dt)};else if(st==="shear"){if(at.length!==2)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=it.createEvalFunction(nt,at,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if(st==="generic"){if(at.length!==9)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=it.createEvalFunction(nt,at,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(nt,st){return this.update(),it.exists(st)?rt.matVecMult(this.matrix,nt.initialCoords.usrCoords):rt.matVecMult(this.matrix,nt.coords.usrCoords)},applyOnce:function(nt){var st,at,lt;for(it.isArray(nt)||(nt=[nt]),at=nt.length,lt=0;lt<at;lt++)this.update(),st=rt.matVecMult(this.matrix,nt[lt].coords.usrCoords),nt[lt].coords.setCoordinates(_e.COORDS_BY_USER,st)},bindTo:function(nt){var st,at;if(it.isArray(nt))for(at=nt.length,st=0;st<at;st++)nt[st].transformations.push(this);else nt.transformations.push(this)},setProperty:function(nt){tt.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(nt){},melt:function(nt){var st,at,lt,ot,ct,ut,ht=[];for(at=nt.matrix.length,lt=this.matrix[0].length,st=0;st<at;st++)ht[st]=[];for(this.update(),nt.update(),st=0;st<at;st++)for(ut=0;ut<lt;ut++){for(ct=0,ot=0;ot<at;ot++)ct+=nt.matrix[st][ot]*this.matrix[ot][ut];ht[st][ut]=ct}return this.update=function(){var dt=this.matrix.length,pt=this.matrix[0].length;for(st=0;st<dt;st++)for(ut=0;ut<pt;ut++)this.matrix[st][ut]=ht[st][ut]},this},getParents:function(){var nt=[[].concat.apply([],this.matrix)];return this.parents.length!==0&&(nt=this.parents),nt}}),tt.createTransform=function(nt,st,at){return new tt.Transformation(nt,at.type,st)},tt.registerElement("transform",tt.createTransform),{Transformation:tt.Transformation,createTransform:tt.createTransform}}),define("base/coordselement",["jxg","options","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht){return tt.CoordsElement=function(dt,pt){var ft;for(ut.exists(dt)||(dt=[1,0,0]),ft=0;ft<dt.length;++ft)dt[ft]=parseFloat(dt[ft]);this.coords=new at(lt.COORDS_BY_USER,dt,this.board),this.initialCoords=new at(lt.COORDS_BY_USER,dt,this.board),this.position=null,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.updateConstraint=function(){return this},this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=ut.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),ut.exists(this.element)&&this.addAnchor(dt,pt),this.isDraggable=!0},tt.extend(tt.CoordsElement.prototype,{updateCoords:function(dt){return this.needsUpdate?(ut.exists(dt)||(dt=!1),this.type===lt.OBJECT_TYPE_GLIDER&&(dt?this.updateGliderFromParent():this.updateGlider()),ut.evaluate(this.visProp.frozen)||this.updateConstraint(),this.updateTransform(),this):this},updateGlider:function(){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot=2*Math.PI,Bt=!1,Nt=this.slideObject;if(this.needsUpdateFromParent=!1,Nt.elementClass===lt.OBJECT_CLASS_CIRCLE)ut.evaluate(this.visProp.isgeonext)&&(Ot=1),Mt=it.projectPointToCircle(this,Nt,this.board),Rt=it.rad([Nt.center.X()+1,Nt.center.Y()],Nt.center,this)/Ot;else if(Nt.elementClass===lt.OBJECT_CLASS_LINE){if(this.onPolygon){if(pt=Nt.point1.coords.usrCoords,ft=Nt.point2.coords.usrCoords,dt=1,gt=ft[dt]-pt[dt],Math.abs(gt)<rt.eps&&(dt=2,gt=ft[dt]-pt[dt]),yt=it.projectPointToLine(this,Nt,this.board),bt=(yt.usrCoords[dt]-pt[dt])/gt,At=Nt.parentPolygon,bt<0){for(dt=0;dt<At.borders.length;dt++)if(Nt===At.borders[dt]){Nt=At.borders[(dt-1+At.borders.length)%At.borders.length];break}}else if(bt>1){for(dt=0;dt<At.borders.length;dt++)if(Nt===At.borders[dt]){Nt=At.borders[(dt+1+At.borders.length)%At.borders.length];break}}Nt.id!==this.slideObject.id&&(this.slideObject=Nt)}pt=Nt.point1.coords,ft=Nt.point2.coords,gt=pt.distance(lt.COORDS_BY_USER,ft),gt<rt.eps?(Mt=pt,Bt=!0,Rt=0):(Mt=it.projectPointToLine(this,Nt,this.board),pt=pt.usrCoords.slice(0),ft=ft.usrCoords.slice(0),Math.abs(ft[0])<rt.eps?(dt=1,gt=ft[dt],Math.abs(gt)<rt.eps&&(dt=2,gt=ft[dt]),gt=(Mt.usrCoords[dt]-pt[dt])/gt,xt=gt>=0?1:-1,gt=Math.abs(gt),Rt=xt*gt/(gt+1)):Math.abs(pt[0])<rt.eps?(dt=1,gt=pt[dt],Math.abs(gt)<rt.eps&&(dt=2,gt=pt[dt]),gt=(Mt.usrCoords[dt]-ft[dt])/gt,Rt=gt<0?(1-2*gt)/(1-gt):1/(gt+1)):(dt=1,gt=ft[dt]-pt[dt],Math.abs(gt)<rt.eps&&(dt=2,gt=ft[dt]-pt[dt]),Rt=(Mt.usrCoords[dt]-pt[dt])/gt)),It=ut.evaluate(this.visProp.snapwidth),ut.evaluate(It)>0&&Math.abs(this._smax-this._smin)>=rt.eps&&(Rt=Math.max(Math.min(Rt,1),0),mt=Rt*(this._smax-this._smin)+this._smin,mt=Math.round(mt/It)*It,Rt=(mt-this._smin)/(this._smax-this._smin),this.update(!0)),pt=Nt.point1.coords,!ut.evaluate(Nt.visProp.straightfirst)&&Math.abs(pt.usrCoords[0])>rt.eps&&Rt<0&&(Mt=pt,Bt=!0,Rt=0),ft=Nt.point2.coords,!ut.evaluate(Nt.visProp.straightlast)&&Math.abs(ft.usrCoords[0])>rt.eps&&Rt>1&&(Mt=ft,Bt=!0,Rt=1)}else Nt.type===lt.OBJECT_TYPE_TURTLE?(this.updateConstraint(),Mt=it.projectPointToTurtle(this,Nt,this.board),Rt=this.position):Nt.elementClass===lt.OBJECT_CLASS_CURVE?Nt.type===lt.OBJECT_TYPE_ARC||Nt.type===lt.OBJECT_TYPE_SECTOR?(Mt=it.projectPointToCircle(this,Nt,this.board),Ct=it.rad(Nt.radiuspoint,Nt.center,this),vt=0,_t=it.rad(Nt.radiuspoint,Nt.center,Nt.anglepoint),Rt=Ct,It=ut.evaluate(Nt.visProp.selection),(It==="minor"&&_t>Math.PI||It==="major"&&_t<Math.PI)&&(vt=_t,_t=2*Math.PI),(Ct<vt||Ct>_t)&&(Rt=_t,(Ct<vt&&Ct>.5*vt||Ct>_t&&Ct>.5*_t+Math.PI)&&(Rt=vt),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),Ot=_t-vt,this.visProp.isgeonext&&(Ot=1),Math.abs(Ot)>rt.eps&&(Rt/=Ot)):(this.updateConstraint(),Nt.transformations.length>0?(Nt.updateTransformMatrix(),Tt=rt.inverse(Nt.transformMat),Et=rt.matVecMult(Tt,this.coords.usrCoords),St=new at(lt.COORDS_BY_USER,Et,this.board).usrCoords,Et=it.projectCoordsToCurve(St[1],St[2],this.position||0,Nt,this.board),Mt=Et[0],Rt=Et[1]):(Mt=it.projectPointToCurve(this,Nt,this.board),Rt=this.position)):ut.isPoint(Nt)&&(Mt=it.projectPointToPoint(this,Nt,this.board),Rt=this.position);this.coords.setCoordinates(lt.COORDS_BY_USER,Mt.usrCoords,Bt),this.position=Rt},updateGliderFromParent:function(){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt=this.slideObject,_t=2*Math.PI;if(!this.needsUpdateFromParent)return void(this.needsUpdateFromParent=!0);vt.elementClass===lt.OBJECT_CLASS_CIRCLE?(ft=vt.Radius(),ut.evaluate(this.visProp.isgeonext)&&(_t=1),mt=[vt.center.X()+ft*Math.cos(this.position*_t),vt.center.Y()+ft*Math.sin(this.position*_t)]):vt.elementClass===lt.OBJECT_CLASS_LINE?(dt=vt.point1.coords.usrCoords,pt=vt.point2.coords.usrCoords,dt[0]===0&&dt[1]===0&&dt[2]===0||pt[0]===0&&pt[1]===0&&pt[2]===0?mt=[0,0,0]:Math.abs(pt[0])<rt.eps?(gt=Math.min(Math.abs(this.position),1-rt.eps),gt/=1-gt,this.position<0&&(gt=-gt),mt=[dt[0]+gt*pt[0],dt[1]+gt*pt[1],dt[2]+gt*pt[2]]):Math.abs(dt[0])<rt.eps?(gt=Math.max(this.position,rt.eps),gt=Math.min(gt,2-rt.eps),gt=gt>1?(gt-1)/(gt-2):(1-gt)/gt,mt=[pt[0]+gt*dt[0],pt[1]+gt*dt[1],pt[2]+gt*dt[2]]):(gt=this.position,mt=[dt[0]+gt*(pt[0]-dt[0]),dt[1]+gt*(pt[1]-dt[1]),dt[2]+gt*(pt[2]-dt[2])])):vt.type===lt.OBJECT_TYPE_TURTLE?(this.coords.setCoordinates(lt.COORDS_BY_USER,[vt.Z(this.position),vt.X(this.position),vt.Y(this.position)]),this.updateConstraint(),mt=it.projectPointToTurtle(this,vt,this.board).usrCoords):vt.elementClass===lt.OBJECT_CLASS_CURVE?(this.coords.setCoordinates(lt.COORDS_BY_USER,[vt.Z(this.position),vt.X(this.position),vt.Y(this.position)]),vt.type===lt.OBJECT_TYPE_ARC||vt.type===lt.OBJECT_TYPE_SECTOR?(At=it.rad([vt.center.X()+1,vt.center.Y()],vt.center,vt.radiuspoint),yt=0,xt=it.rad(vt.radiuspoint,vt.center,vt.anglepoint),(vt.visProp.selection==="minor"&&xt>Math.PI||vt.visProp.selection==="major"&&xt<Math.PI)&&(yt=xt,xt=2*Math.PI),_t=xt-yt,ut.evaluate(this.visProp.isgeonext)&&(_t=1),bt=this.position*_t,(bt<yt||bt>xt)&&(bt=xt,(bt<yt&&bt>.5*yt||bt>xt&&bt>.5*xt+Math.PI)&&(bt=yt),this.position=bt,Math.abs(_t)>rt.eps&&(this.position/=_t)),ft=vt.Radius(),mt=[vt.center.X()+ft*Math.cos(this.position*_t+At),vt.center.Y()+ft*Math.sin(this.position*_t+At)]):(this.updateConstraint(),mt=it.projectPointToCurve(this,vt,this.board).usrCoords)):ut.isPoint(vt)&&(mt=it.projectPointToPoint(this,vt,this.board).usrCoords),this.coords.setCoordinates(lt.COORDS_BY_USER,mt,!1)},updateRendererGeneric:function(dt){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>rt.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[dt](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(dt){return this.isReal&&dt.isReal?this.coords.distance(lt.COORDS_BY_USER,dt.coords):NaN},snapToGrid:function(dt){return this.handleSnapToGrid(dt)},handleSnapToPoints:function(dt){var pt,ft,gt,mt,At,yt,bt,xt,vt=0,_t=1/0,Ct=null,St=ut.evaluate(this.visProp.ignoredsnaptopoints),Et=!1;if(mt=this.board.objectsList.length,St&&(bt=St.length),ut.evaluate(this.visProp.snaptopoints)||dt){for(At=ut.evaluate(this.visProp.attractorunit),yt=ut.evaluate(this.visProp.attractordistance),pt=0;pt<mt;pt++){if(ft=this.board.objectsList[pt],St){for(Et=!1,xt=0;xt<bt;xt++)if(ft==this.board.select(St[xt])){Et=!0;break}if(Et)continue}ut.isPoint(ft)&&ft!==this&&ft.visPropCalc.visible&&(gt=it.projectPointToPoint(this,ft,this.board),(vt=At==="screen"?gt.distance(lt.COORDS_BY_SCREEN,this.coords):gt.distance(lt.COORDS_BY_USER,this.coords))<yt&&vt<_t&&(_t=vt,Ct=gt))}Ct!==null&&this.coords.setCoordinates(lt.COORDS_BY_USER,Ct.usrCoords)}return this},snapToPoints:function(dt){return this.handleSnapToPoints(dt)},handleAttractors:function(){var dt,pt,ft,gt,mt=0,At=ut.evaluate(this.visProp.attractorunit),yt=ut.evaluate(this.visProp.attractordistance),bt=ut.evaluate(this.visProp.snatchdistance),xt=ut.evaluate(this.visProp.attractors),vt=xt.length;if(yt!==0){for(dt=0;dt<vt;dt++)if(pt=this.board.select(xt[dt]),ut.exists(pt)&&pt!==this){if(ut.isPoint(pt)?ft=it.projectPointToPoint(this,pt,this.board):pt.elementClass===lt.OBJECT_CLASS_LINE?(gt=it.projectCoordsToSegment(this.coords.usrCoords,pt.point1.coords.usrCoords,pt.point2.coords.usrCoords),ft=!ut.evaluate(pt.visProp.straightfirst)&&gt[1]<0?pt.point1.coords:!ut.evaluate(pt.visProp.straightlast)&&gt[1]>1?pt.point2.coords:new at(lt.COORDS_BY_USER,gt[0],this.board)):pt.elementClass===lt.OBJECT_CLASS_CIRCLE?ft=it.projectPointToCircle(this,pt,this.board):pt.elementClass===lt.OBJECT_CLASS_CURVE?ft=it.projectPointToCurve(this,pt,this.board):pt.type===lt.OBJECT_TYPE_TURTLE&&(ft=it.projectPointToTurtle(this,pt,this.board)),(mt=At==="screen"?ft.distance(lt.COORDS_BY_SCREEN,this.coords):ft.distance(lt.COORDS_BY_USER,this.coords))<yt){this.type===lt.OBJECT_TYPE_GLIDER&&this.slideObject===pt||this.makeGlider(pt);break}pt===this.slideObject&&mt>=bt&&this.popSlideObject()}return this}},setPositionDirectly:function(dt,pt){var ft,gt,mt,At,yt=this.coords;if(this.relativeCoords)return gt=new at(dt,pt,this.board),ut.evaluate(this.visProp.islabel)?(mt=st.subtract(gt.scrCoords,yt.scrCoords),this.relativeCoords.scrCoords[1]+=mt[1],this.relativeCoords.scrCoords[2]+=mt[2]):(mt=st.subtract(gt.usrCoords,yt.usrCoords),this.relativeCoords.usrCoords[1]+=mt[1],this.relativeCoords.usrCoords[2]+=mt[2]),this;for(this.coords.setCoordinates(dt,pt),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),ft=this.transformations.length-1;ft>=0;ft--)dt===lt.COORDS_BY_SCREEN?At=new at(dt,pt,this.board).usrCoords:(pt.length===2&&(pt=[1].concat(pt)),At=pt),this.initialCoords.setCoordinates(lt.COORDS_BY_USER,rt.matVecMult(rt.inverse(this.transformations[ft].matrix),At));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===lt.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(dt,pt){var ft;return pt=new at(dt,pt,this.board),ft=this.board.create("transform",pt.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(ft):this.addTransform(this,ft),this.prepareUpdate().update(),this},setPosition:function(dt,pt){return this.setPositionDirectly(dt,pt)},setGliderPosition:function(dt){return this.type===lt.OBJECT_TYPE_GLIDER&&(this.position=dt,this.board.update()),this},makeGlider:function(dt){var pt,ft,gt,mt=this.board.select(dt),At=!1;if(mt.type===lt.OBJECT_TYPE_POLYGON){for(pt=Number.MAX_VALUE,ft=0;ft<mt.borders.length;ft++)(gt=tt.Math.Geometry.distPointLine(this.coords.usrCoords,mt.borders[ft].stdform))<pt&&(pt=gt,dt=mt.borders[ft]);mt=this.board.select(dt),At=!0}if(!ut.exists(mt))throw new Error("JSXGraph: slide object undefined.");if(mt.type===lt.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(dt),this.slideObjects.push(this.slideObject),this.addParents(dt),this.type=lt.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=At,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),this.slideObjects.length===0?(this.type=this._org_type,this.type===lt.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===lt.OBJECT_CLASS_TEXT?this.elType="text":this.type===lt.OBJECT_TYPE_IMAGE&&(this.elType="image"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var dt,pt;if(this.type!==lt.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,this.isDraggable)return;this.isDraggable=!0,this.elementClass===lt.OBJECT_CLASS_POINT&&(this.type=lt.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(dt in this.board.objects)this.board.objects.hasOwnProperty(dt)&&(pt=this.board.objects[dt],pt.descendants&&(delete pt.descendants[this.id],delete pt.childElements[this.id],this.hasLabel&&(delete pt.descendants[this.label.id],delete pt.childElements[this.label.id])));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===lt.OBJECT_CLASS_POINT?(this.type=lt.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===lt.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===lt.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(dt){var pt,ft,gt=[],mt=["X","Y"];for(this.elementClass===lt.OBJECT_CLASS_POINT&&(this.type=lt.OBJECT_TYPE_CAS),this.isDraggable=!1,pt=0;pt<dt.length;pt++)ft=dt[pt],ut.isString(ft)?(gt[pt]=this.board.jc.snippet(ft,!0,null,!0),dt.length===2&&(this[mt[pt]+"jc"]=dt[pt])):ut.isFunction(ft)?gt[pt]=ft:ut.isNumber(ft)?gt[pt]=function(At){return function(){return At}}(ft):ut.isObject(ft)&&ut.isFunction(ft.Value)&&(gt[pt]=function(At){return function(){return At.Value()}}(ft)),gt[pt].origin=ft;return dt.length===1?this.updateConstraint=function(){var At=gt[0]();ut.isArray(At)?this.coords.setCoordinates(lt.COORDS_BY_USER,At):this.coords=At}:dt.length===2?(this.XEval=gt[0],this.YEval=gt[1],this.setParents([gt[0].origin,gt[1].origin]),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.XEval(),this.YEval()])}):(this.ZEval=gt[0],this.XEval=gt[1],this.YEval=gt[2],this.setParents([gt[0].origin,gt[1].origin,gt[2].origin]),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])}),this.prepareUpdate().update(),this.board.isSuspendedUpdate||this.updateVisibility().updateRenderer(),this},addAnchor:function(dt,pt){this.relativeCoords=pt?new at(lt.COORDS_BY_SCREEN,dt.slice(0,2),this.board):new at(lt.COORDS_BY_USER,dt,this.board),this.element.addChild(this),pt&&this.addParents(this.element),this.XEval=function(){var ft,gt,mt,At=ut.evaluate(this.visProp.offset);return ut.evaluate(this.visProp.islabel)?(ft=parseFloat(At[0]),mt=this.element.getLabelAnchor(),gt=new at(lt.COORDS_BY_SCREEN,[ft+this.relativeCoords.scrCoords[1]+mt.scrCoords[1],0],this.board),gt.usrCoords[1]):(mt=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+mt.usrCoords[1])},this.YEval=function(){var ft,gt,mt,At=ut.evaluate(this.visProp.offset);return ut.evaluate(this.visProp.islabel)?(ft=-parseFloat(At[1]),mt=this.element.getLabelAnchor(),gt=new at(lt.COORDS_BY_SCREEN,[0,ft+this.relativeCoords.scrCoords[2]+mt.scrCoords[2]],this.board),gt.usrCoords[2]):(mt=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+mt.usrCoords[2])},this.ZEval=ut.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(lt.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.coords=new at(lt.COORDS_BY_SCREEN,[0,0],this.board)},updateTransform:function(){var dt;if(this.transformations.length===0)return this;for(dt=0;dt<this.transformations.length;dt++)this.transformations[dt].update();return this},addTransform:function(dt,pt){var ft,gt=ut.isArray(pt)?pt:[pt],mt=gt.length;for(this.transformations.length===0&&(this.baseElement=dt),ft=0;ft<mt;ft++)this.transformations.push(gt[ft]);return this},startAnimation:function(dt,pt){var ft=this;return this.type!==lt.OBJECT_TYPE_GLIDER||ut.exists(this.intervalCode)||(this.intervalCode=window.setInterval(function(){ft._anim(dt,pt)},250),ut.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return ut.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(dt,pt,ft){ft=ft||{};var gt,mt,At,yt,bt,xt=[],vt=[],_t=this.board.attr.animationdelay,Ct=pt/_t,St=function(Et,Tt){return function(){return dt[Et][Tt]}};if(ut.isArray(dt)){for(At=dt.length,gt=0;gt<At;gt++)ut.isPoint(dt[gt])?vt[gt]=dt[gt]:vt[gt]={elementClass:lt.OBJECT_CLASS_POINT,X:St(gt,0),Y:St(gt,1)};if((pt=pt||0)===0)return this.setPosition(lt.COORDS_BY_USER,[vt[vt.length-1].X(),vt[vt.length-1].Y()]),this.board.update(this);if(!ut.exists(ft.interpolate)||ft.interpolate)for(mt=nt.Neville(vt),gt=0;gt<Ct;gt++)xt[gt]=[],xt[gt][0]=mt[0]((Ct-gt)/Ct*mt[3]()),xt[gt][1]=mt[1]((Ct-gt)/Ct*mt[3]());else{for(At=dt.length-1,gt=0;gt<Ct;++gt)yt=Math.floor(gt/Ct*At),bt=gt/Ct*At-yt,xt[gt]=[],xt[gt][0]=(1-bt)*vt[yt].X()+bt*vt[yt+1].X(),xt[gt][1]=(1-bt)*vt[yt].Y()+bt*vt[yt+1].Y();xt.push([vt[At].X(),vt[At].Y()]),xt.reverse()}this.animationPath=xt}else ut.isFunction(dt)&&(this.animationPath=dt,this.animationStart=new Date().getTime());return this.animationCallback=ft.callback,this.board.addAnimation(this),this},moveTo:function(dt,pt,ft){ft=ft||{},dt=new at(lt.COORDS_BY_USER,dt,this.board);var gt,mt=this.board.attr.animationdelay,At=Math.ceil(pt/mt),yt=[],bt=this.coords.usrCoords[1],xt=this.coords.usrCoords[2],vt=dt.usrCoords[1]-bt,_t=dt.usrCoords[2]-xt,Ct=function(St){return ft.effect&&ft.effect==="<>"?Math.pow(Math.sin(St/At*Math.PI/2),2):St/At};if(!ut.exists(pt)||pt===0||Math.abs(dt.usrCoords[0]-this.coords.usrCoords[0])>rt.eps)return this.setPosition(lt.COORDS_BY_USER,dt.usrCoords),this.board.update(this);if(!ut.exists(ft.callback)&&Math.abs(vt)<rt.eps&&Math.abs(_t)<rt.eps)return this;for(gt=At;gt>=0;gt--)yt[At-gt]=[dt.usrCoords[0],bt+vt*Ct(gt),xt+_t*Ct(gt)];return this.animationPath=yt,this.animationCallback=ft.callback,this.board.addAnimation(this),this},visit:function(dt,pt,ft){dt=new at(lt.COORDS_BY_USER,dt,this.board);var gt,mt,At,yt=this.board.attr.animationdelay,bt=[],xt=this.coords.usrCoords[1],vt=this.coords.usrCoords[2],_t=dt.usrCoords[1]-xt,Ct=dt.usrCoords[2]-vt,St=function(Et){var Tt=Et<At/2?2*Et/At:2*(At-Et)/At;return ft.effect&&ft.effect==="<>"?Math.pow(Math.sin(Tt*Math.PI/2),2):Tt};for(ut.isNumber(ft)?ft={repeat:ft}:(ft=ft||{},ut.exists(ft.repeat)||(ft.repeat=1)),At=Math.ceil(pt/(yt*ft.repeat)),mt=0;mt<ft.repeat;mt++)for(gt=At;gt>=0;gt--)bt[mt*(At+1)+At-gt]=[dt.usrCoords[0],xt+_t*St(gt),vt+Ct*St(gt)];return this.animationPath=bt,this.animationCallback=ft.callback,this.board.addAnimation(this),this},_anim:function(dt,pt){var ft,gt,mt,At,yt,bt,xt,vt,_t=1;return this.intervalCount+=1,this.intervalCount>pt&&(this.intervalCount=0),this.slideObject.elementClass===lt.OBJECT_CLASS_LINE?(ft=this.slideObject.point1.coords.distance(lt.COORDS_BY_SCREEN,this.slideObject.point2.coords),gt=this.slideObject.getSlope(),gt!==1/0?(yt=Math.atan(gt),mt=Math.round(this.intervalCount/pt*ft*Math.cos(yt)),At=Math.round(this.intervalCount/pt*ft*Math.sin(yt))):(mt=0,At=Math.round(this.intervalCount/pt*ft)),dt<0?(bt=this.slideObject.point2,(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0||this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]==0&&this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0)&&(_t=-1)):(bt=this.slideObject.point1,(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0||this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]==0&&this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0)&&(_t=-1)),this.coords.setCoordinates(lt.COORDS_BY_SCREEN,[bt.coords.scrCoords[1]+_t*mt,bt.coords.scrCoords[2]+_t*At])):this.slideObject.elementClass===lt.OBJECT_CLASS_CURVE?(xt=dt>0?Math.round(this.intervalCount/pt*this.board.canvasWidth):Math.round((pt-this.intervalCount)/pt*this.board.canvasWidth),this.coords.setCoordinates(lt.COORDS_BY_SCREEN,[xt,0]),this.coords=it.projectPointToCurve(this,this.slideObject,this.board)):this.slideObject.elementClass===lt.OBJECT_CLASS_CIRCLE&&(yt=dt<0?this.intervalCount/pt*2*Math.PI:(pt-this.intervalCount)/pt*2*Math.PI,vt=this.slideObject.Radius(),this.coords.setCoordinates(lt.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+vt*Math.cos(yt),this.slideObject.center.coords.usrCoords[2]+vt*Math.sin(yt)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var dt=[this.Z(),this.X(),this.Y()];return this.parents.length!==0&&(dt=this.parents),this.type===lt.OBJECT_TYPE_GLIDER&&(dt=[this.X(),this.Y(),this.slideObject.id]),dt}}),tt.CoordsElement.create=function(dt,pt,ft,gt,mt,At){var yt,bt,xt=!1;for(bt=0;bt<ft.length;bt++)(ut.isFunction(ft[bt])||ut.isString(ft[bt]))&&(xt=!0);if(xt)yt=new dt(pt,[0,0],gt,mt,At),yt.addConstraint(ft);else if(ut.isNumber(ft[0])&&ut.isNumber(ft[1]))yt=new dt(pt,ft,gt,mt,At),ut.exists(gt.slideobject)?yt.makeGlider(gt.slideobject):yt.baseElement=yt,yt.isDraggable=!0;else{if(!ut.isObject(ft[0])||!ut.isTransformationOrArray(ft[1]))return!1;yt=new dt(pt,[0,0],gt,mt,At),yt.addTransform(ft[0],ft[1]),yt.isDraggable=!1}return yt.handleSnapToGrid(),yt.handleSnapToPoints(),yt.handleAttractors(),yt.addParents(ft),yt},tt.CoordsElement}),define("base/text",["jxg","base/constants","base/coords","base/element","parser/geonext","math/statistics","utils/env","utils/type","math/math","base/coordselement"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){var ut={HTMLSliderInputEventHandler:function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()}};return tt.Text=function(ht,dt,pt,ft){this.constructor(ht,pt,_e.OBJECT_TYPE_TEXT,_e.OBJECT_CLASS_TEXT),this.element=this.board.select(pt.anchor),this.coordsConstructor(dt,lt.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this._setUpdateText(ft),this.updateText(),this.board.renderer.drawText(this),this.board.finalizeAdding(this),lt.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=lt.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},tt.Text.prototype=new it,lt.copyPrototypeMethods(tt.Text,ct,"coordsConstructor"),tt.extend(tt.Text.prototype,{hasPoint:function(ht,dt){var pt,ft,gt,mt,At,yt,bt=this.board.options.precision.hasPoint;return this.transformations.length>0&&(pt=ot.matVecMult(ot.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,ht,dt]),ht=pt[1],dt=pt[2]),At=this.getAnchorX(),pt=At==="right"?this.coords.scrCoords[1]-this.size[0]:At==="middle"?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1],ft=pt+this.size[0],yt=this.getAnchorY(),mt=yt==="top"?this.coords.scrCoords[2]+this.size[1]:yt==="middle"?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2],gt=mt-this.size[1],lt.evaluate(this.visProp.dragarea)==="all"?ht>=pt-bt&&ht<ft+bt&&dt>=gt-bt&&dt<=mt+bt:dt>=gt-bt&&dt<=mt+bt&&(ht>=pt-bt&&ht<=pt+2*bt||ht>=ft-2*bt&&ht<=ft+bt)},_setUpdateText:function(ht){var dt,pt,ft=lt.evaluate(this.visProp.parse),gt=lt.evaluate(this.visProp.usemathjax);this.orgText=ht,lt.isFunction(ht)?this.updateText=function(){pt=ht().toString(),this.plaintext=ft&&!gt?this.replaceSub(this.replaceSup(this.convertGeonext2CSS(pt))):pt}:lt.isString(ht)&&!ft?this.updateText=function(){this.plaintext=ht}:(lt.isNumber(ht)?this.content=lt.toFixed(ht,lt.evaluate(this.visProp.digits)):lt.evaluate(this.visProp.useasciimathml)?this.content="'`"+ht+"`'":this.content=gt?"'"+ht+"'":this.generateTerm(ht,!0,!0),dt=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=dt()})},_setText:function(ht){return this._setUpdateText(ht),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(ht){var dt;return this.visProp.castext=ht,dt=lt.isFunction(ht)?function(){return lt.sanitizeHTML(ht())}:lt.isNumber(ht)?ht:lt.sanitizeHTML(ht),this._setText(dt)},setText:function(ht){return this._setText(ht)},updateSize:function(){var ht,dt,pt,ft,gt=lt.evaluate(this.visProp.display);if(!at.isBrowser||this.board.renderer.type==="no")return this;if(ft=this.rendNode,gt==="html"||this.board.renderer.type==="vml")lt.exists(ft.offsetWidth)?(dt=[ft.offsetWidth,ft.offsetHeight],dt[0]===0&&dt[1]===0?(pt=this,window.setTimeout(function(){pt.size=[ft.offsetWidth,ft.offsetHeight],pt.needsUpdate=!0,pt.updateRenderer()},0)):this.size=dt):this.size=this.crudeSizeEstimate();else if(gt==="internal")if(this.board.renderer.type==="svg")try{ht=ft.getBBox(),this.size=[ht.width,ht.height]}catch{}else this.board.renderer.type==="canvas"&&(this.size=this.crudeSizeEstimate());return this},crudeSizeEstimate:function(){var ht=parseFloat(lt.evaluate(this.visProp.fontsize));return[ht*this.plaintext.length*.45,.9*ht]},utf8_decode:function(ht){return ht.replace(/&#x(\w+);/g,function(dt,pt){return String.fromCharCode(parseInt(pt,16))})},replaceSub:function(ht){if(!ht.indexOf)return ht;for(var dt,pt=ht.indexOf("_{");pt>=0;)ht=ht.substr(0,pt)+ht.substr(pt).replace(/_\{/,"<sub>"),dt=ht.substr(pt).indexOf("}"),dt>=0&&(ht=ht.substr(0,dt)+ht.substr(dt).replace(/\}/,"</sub>")),pt=ht.indexOf("_{");for(pt=ht.indexOf("_");pt>=0;)ht=ht.substr(0,pt)+ht.substr(pt).replace(/_(.?)/,"<sub>$1</sub>"),pt=ht.indexOf("_");return ht},replaceSup:function(ht){if(!ht.indexOf)return ht;for(var dt,pt=ht.indexOf("^{");pt>=0;)ht=ht.substr(0,pt)+ht.substr(pt).replace(/\^\{/,"<sup>"),dt=ht.substr(pt).indexOf("}"),dt>=0&&(ht=ht.substr(0,dt)+ht.substr(dt).replace(/\}/,"</sup>")),pt=ht.indexOf("^{");for(pt=ht.indexOf("^");pt>=0;)ht=ht.substr(0,pt)+ht.substr(pt).replace(/\^(.?)/,"<sup>$1</sup>"),pt=ht.indexOf("^");return ht},getSize:function(){return this.size},setCoords:function(ht,dt){var pt,ft,gt;return lt.isArray(ht)&&ht.length>1&&(dt=ht[1],ht=ht[0]),lt.evaluate(this.visProp.islabel)&&lt.exists(this.element)?(pt=this.element.getLabelAnchor(),ft=(ht-pt.usrCoords[1])*this.board.unitX,gt=-(dt-pt.usrCoords[2])*this.board.unitY,this.relativeCoords.setCoordinates(_e.COORDS_BY_SCREEN,[ft,gt])):this.coords.setCoordinates(_e.COORDS_BY_USER,[ht,dt]),this.fullUpdate(),this},update:function(ht){return this.needsUpdate?(this.updateCoords(ht),this.updateText(),lt.evaluate(this.visProp.display)==="internal"&&lt.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return this.updateRendererGeneric("updateText")},expandShortMath:function(ht){var dt=/([\)0-9\.])\s*([\(a-zA-Z_])/g;return ht.replace(dt,"$1*$2")},generateTerm:function(ht,dt,pt){var ft,gt,mt,At,yt='""';if(ht=ht||"",ht=ht.replace(/\r/g,""),ht=ht.replace(/\n/g,""),ht=ht.replace(/"/g,"'"),ht=ht.replace(/'/g,"\\'"),ht=ht.replace(/&amp;arc;/g,"&ang;"),ht=ht.replace(/<arc\s*\/>/g,"&ang;"),ht=ht.replace(/&lt;arc\s*\/&gt;/g,"&ang;"),ht=ht.replace(/&lt;sqrt\s*\/&gt;/g,"&radic;"),ht=ht.replace(/&lt;value&gt;/g,"<value>"),ht=ht.replace(/&lt;\/value&gt;/g,"</value>"),mt=ht.indexOf("<value>"),At=ht.indexOf("</value>"),mt>=0)for(;mt>=0;)yt+=' + "'+this.replaceSub(this.replaceSup(ht.slice(0,mt)))+'"',gt=ht.slice(mt+7,At),gt=gt.replace(/\s+/g,""),dt===!0&&(gt=this.expandShortMath(gt)),ft=pt?gt:nt.geonext2JS(gt,this.board),ft=ft.replace(/\\"/g,"'"),ft=ft.replace(/\\'/g,"'"),ft.indexOf("toFixed")<0&&lt.isNumber(lt.bind(this.board.jc.snippet(ft,!0,"",!1),this)())?yt+="+("+ft+").toFixed("+lt.evaluate(this.visProp.digits)+")":yt+="+("+ft+")",ht=ht.slice(At+8),mt=ht.indexOf("<value>"),At=ht.indexOf("</value>");return yt+=' + "'+this.replaceSub(this.replaceSup(ht))+'"',yt=this.convertGeonext2CSS(yt),yt=yt.replace(/&amp;/g,"&"),yt=yt.replace(/"/g,"'")},convertGeonext2CSS:function(ht){return lt.isString(ht)&&(ht=ht.replace(/<overline>/g,"<span style=text-decoration:overline>"),ht=ht.replace(/&lt;overline&gt;/g,"<span style=text-decoration:overline>"),ht=ht.replace(/<\/overline>/g,"</span>"),ht=ht.replace(/&lt;\/overline&gt;/g,"</span>"),ht=ht.replace(/<arrow>/g,"<span style=text-decoration:overline>"),ht=ht.replace(/&lt;arrow&gt;/g,"<span style=text-decoration:overline>"),ht=ht.replace(/<\/arrow>/g,"</span>"),ht=ht.replace(/&lt;\/arrow&gt;/g,"</span>")),ht},notifyParents:function(ht){var dt,pt=null;ht=ht.replace(/&lt;value&gt;/g,"<value>"),ht=ht.replace(/&lt;\/value&gt;/g,"</value>");do dt=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/,(pt=dt.exec(ht))!==null&&(nt.findDependencies(this,pt[1],this.board),ht=ht.substr(pt.index),ht=ht.replace(dt,""));while(pt!==null);return this},getParents:function(){var ht;return ht=this.relativeCoords!==void 0?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],this.parents.length!==0&&(ht=this.parents),ht},bounds:function(){var ht=this.coords.usrCoords;return lt.evaluate(this.visProp.islabel)||this.board.unitY===0||this.board.unitX===0?[0,0,0,0]:[ht[1],ht[2]+this.size[1]/this.board.unitY,ht[1]+this.size[0]/this.board.unitX,ht[2]]},getAnchorX:function(){var ht=lt.evaluate(this.visProp.anchorx);if(ht=="auto")switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";case"lft":case"llft":case"ulft":default:return"right"}return ht},getAnchorY:function(){var ht=lt.evaluate(this.visProp.anchory);if(ht=="auto")switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";case"rt":case"lft":default:return"middle"}return ht}}),tt.createText=function(ht,dt,pt){var ft,gt=lt.copyAttributes(pt,ht.options,"text"),mt=dt.slice(0,-1),At=dt[dt.length-1];if(gt.anchor=gt.parent||gt.anchor,!(ft=ct.create(tt.Text,ht,mt,gt,At)))throw new Error("JSXGraph: Can't create text with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return lt.evaluate(gt.rotate)!==0&&gt.display==="internal"&&ft.addRotation(lt.evaluate(gt.rotate)),ft},tt.registerElement("text",tt.createText),tt.createHTMLSlider=function(ht,dt,pt){var ft,gt,mt=lt.copyAttributes(pt,ht.options,"htmlslider");if(dt.length!==2||dt[0].length!==2||dt[1].length!==3)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+`'.
Possible parents are: [[x,y], [min, start, max]]`);mt.anchor=mt.parent||mt.anchor,mt.fixed=mt.fixed||!0,gt=[dt[0][0],dt[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],ft=tt.createText(ht,gt,mt),ft.type=lt.OBJECT_TYPE_HTMLSLIDER,ft.rendNodeForm=ft.rendNode.childNodes[0],ft.rendNodeRange=ft.rendNodeForm.childNodes[0],ft.rendNodeRange.min=dt[1][0],ft.rendNodeRange.max=dt[1][2],ft.rendNodeRange.step=mt.step,ft.rendNodeRange.value=dt[1][1],ft.rendNodeLabel=ft.rendNodeForm.childNodes[1],ft.rendNodeLabel.id=ft.rendNode.id+"_label",mt.withlabel&&(ft.rendNodeLabel.innerHTML=ft.name+"="),ft.rendNodeOut=ft.rendNodeForm.childNodes[2],ft.rendNodeOut.value=dt[1][1];try{ft.rendNodeForm.id=ft.rendNode.id+"_form",ft.rendNodeRange.id=ft.rendNode.id+"_range",ft.rendNodeOut.id=ft.rendNode.id+"_out"}catch(At){tt.debug(At)}return ft.rendNodeRange.style.width=mt.widthrange+"px",ft.rendNodeRange.style.verticalAlign="middle",ft.rendNodeOut.style.width=mt.widthout+"px",ft._val=dt[1][1],tt.supportsVML()?at.addEvent(ft.rendNodeForm,"change",ut.HTMLSliderInputEventHandler,ft):at.addEvent(ft.rendNodeForm,"input",ut.HTMLSliderInputEventHandler,ft),ft.Value=function(){return this._val},ft},tt.registerElement("htmlslider",tt.createHTMLSlider),{Text:tt.Text,createText:tt.createText,createHTMLSlider:tt.createHTMLSlider}}),define("utils/uuid",["jxg"],function(tt){var _e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",rt=_e.split("");return tt.Util=tt.Util||{},tt.Util.genUUID=function(){var it,nt,st=[],at=0;for(nt=0;nt<36;nt++)nt===8||nt===13||nt===18||nt===23?st[nt]="-":nt===14?st[nt]="4":(at<=2&&(at=33554432+16777216*Math.random()|0),it=15&at,at>>=4,st[nt]=rt[nt===19?3&it|8:it]);return st.join("")},tt.Util}),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],function(JXG,Const,Text,Mat,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(tt,_e){function rt(){}if(typeof tt!="object"&&typeof tt!="function")throw new TypeError("Object prototype may only be an Object: "+tt);if(tt===null)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(_e!==void 0)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");return rt.prototype=tt,new rt});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}};JXG.JessieCode=function(tt,_e){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="",typeof tt=="string"&&this.parse(tt,_e)},JXG.extend(JXG.JessieCode.prototype,{node:function(tt,_e,rt){return{type:tt,value:_e,children:rt}},createNode:function(tt,_e,rt){var it,nt=this.node(tt,_e,[]);for(it=2;it<arguments.length;it++)nt.children.push(arguments[it]);return nt.type=="node_const"&&Type.isNumber(nt.value)&&(nt.isMath=!0),nt.line=this.parCurLine,nt.col=this.parCurColumn,nt},pushScope:function(tt){var _e={args:tt,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=_e,_e.id=this.scopes.push(_e)-1,_e},popScope:function(){var tt=this.scope.previous;return this.scope=tt!==null?tt:this.scope,this.scope},getElementById:function(tt){return this.board.objects[tt]},log:function(){this.$log.push(arguments),typeof console=="object"&&console.log&&console.log.apply(console,arguments)},creator:function(){var tt,_e={};return tt=function(rt){var it;return typeof _e[this.board.id+rt]=="function"?it=_e[this.board.id+rt]:(it=function(nt){return function(st,at){var lt;return lt=Type.exists(at)?at:{name:nt.lhs[nt.scope]!==0?nt.lhs[nt.scope]:""},nt.board.create(rt,st,lt)}}(this),it.creator=!0,_e[this.board.id+rt]=it),it},tt.clearCache=function(){_e={}},tt}(),letvar:function(tt,_e){this.builtIn[tt]&&this._warn('"'+tt+'" is a predefined value.'),this.scope.locals[tt]=_e},isLocalVariable:function(tt){for(var _e=this.scope;_e!==null;){if(Type.exists(_e.locals[tt]))return _e;_e=_e.previous}return null},isParameter:function(tt){for(var _e=this.scope;_e!==null;){if(Type.indexOf(_e.args,tt)>-1)return _e;_e=_e.previous}return null},isCreator:function(tt){return!!JXG.elements[tt]},isMathMethod:function(tt){return tt!=="E"&&!!Math[tt]},isBuiltIn:function(tt){return!!this.builtIn[tt]},getvar:function(tt,_e){var rt;return _e=Type.def(_e,!1),rt=this.isLocalVariable(tt),rt!==null?rt.locals[tt]:this.isCreator(tt)?this.creator(tt):this.isBuiltIn(tt)?this.builtIn[tt]:this.isMathMethod(tt)?Math[tt]:_e||(rt=this.board.select(tt))===tt?void 0:rt},resolve:function(tt){for(var _e=this.scope;_e!==null;){if(Type.exists(_e.locals[tt]))return _e.locals[tt];_e=_e.previous}},getvarJS:function(tt,_e,rt){var it="";return _e=Type.def(_e,!1),rt=Type.def(rt,!1),this.isParameter(tt)!==null?tt:this.isLocalVariable(tt)===null||rt?this.isCreator(tt)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(rt?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+tt+"'].concat([a, props])); })":(rt&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(tt)?this.builtIn[tt].src||this.builtIn[tt]:this.isMathMethod(tt)?"Math."+tt:_e?"":(Type.isId(this.board,tt)?it="$jc$.board.objects['"+tt+"']":Type.isName(this.board,tt)?it="$jc$.board.elementsByName['"+tt+"']":Type.isGroup(this.board,tt)&&(it="$jc$.board.groups['"+tt+"']"),it)):"$jc$.resolve('"+tt+"')"},makeMap:function(tt){return tt.isMap=!0,tt},functionCodeJS:function(tt){var _e=tt.children[0].join(", "),rt="",it="";return tt.value==="op_map"&&(rt="{ return  ",it=" }"),"function ("+_e+`) {
var $oldscope$ = $jc$.scope;
$jc$.scope = $jc$.scopes[`+this.scope.id+`];
var r = (function () `+rt+this.compile(tt.children[1],!0)+it+`)();
$jc$.scope = $oldscope$;
return r;
}`},defineFunction:function(node){var fun,i,list=node.children[0],scope=this.pushScope(list);if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{return fun=eval(str)}catch(tt){return $jc$._warn(`error compiling function

`+str+`

`+tt.toString()),function(){}}}(this),this.popScope()}else fun=function(tt,_e,rt){return function(){var it,nt;for(nt=_e.scope,_e.scope=_e.scopes[rt],it=0;it<tt.length;it++)_e.scope.locals[tt[it]]=arguments[it];return it=_e.execute(node.children[1]),_e.scope=nt,it}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=function(tt){return function(){return tt.compile(tt.replaceIDs(Type.deepCopy(node)))}}(this),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(tt){var _e,rt={};for(_e=0;_e<arguments.length;_e++)rt=Type.deepCopy(rt,arguments[_e],!0);return rt},setProp:function(tt,_e,rt){var it,nt,st={};tt.elementClass!==Const.OBJECT_CLASS_POINT||_e!=="X"&&_e!=="Y"?tt.elementClass!==Const.OBJECT_CLASS_TEXT||_e!=="X"&&_e!=="Y"?tt.type&&tt.elementClass&&tt.visProp?Type.exists(tt[tt.methodMap[_e]])&&typeof tt[tt.methodMap[_e]]!="function"?tt[tt.methodMap[_e]]=rt:(st[_e]=rt,tt.setAttribute(st)):tt[_e]=rt:(typeof rt=="number"?tt[_e]=function(){return rt}:typeof rt=="function"?(tt.isDraggable=!1,tt[_e]=rt):typeof rt=="string"&&(tt.isDraggable=!1,tt[_e]=Type.createFunction(rt,this.board,null,!0),tt[_e+"jc"]=rt),tt[_e].origin=rt,this.board.update()):(_e=_e.toLowerCase(),tt.isDraggable&&typeof rt=="number"?(it=_e==="x"?rt:tt.X(),nt=_e==="y"?rt:tt.Y(),tt.setPosition(Const.COORDS_BY_USER,[it,nt])):!tt.isDraggable||typeof rt!="function"&&typeof rt!="string"?tt.isDraggable||(it=_e==="x"?rt:tt.XEval.origin,nt=_e==="y"?rt:tt.YEval.origin,tt.addConstraint([it,nt])):(it=_e==="x"?rt:tt.coords.usrCoords[1],nt=_e==="y"?rt:tt.coords.usrCoords[2],tt.addConstraint([it,nt])),this.board.update())},_genericParse:function(tt,_e,rt,it){var nt,st,at,lt,ot=tt.replace(/\r\n/g,`
`).split(`
`),ct=[];it||(this.code+=tt+`
`),Text&&(st=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(rt)||(rt=!1),nt=0;nt<ot.length;nt++)rt&&(ot[nt]=JXG.GeonextParser.geonext2JS(ot[nt],this.board)),ct.push(ot[nt]);switch(tt=ct.join(`
`),at=parser.parse(tt),this.CA&&(at=this.CA.expandDerivatives(at,null,at),at=this.CA.removeTrivialNodes(at)),_e){case"parse":lt=this.execute(at);break;case"manipulate":lt=this.compile(at);break;case"getAst":lt=at;break;default:lt=!1}}catch(ut){console.log(ut)}finally{Text&&(Text.Text.prototype.setText=st)}return lt},parse:function(tt,_e,rt){return this._genericParse(tt,"parse",_e,rt)},manipulate:function(tt,_e,rt){return this._genericParse(tt,"manipulate",_e,rt)},getAST:function(tt,_e,rt){return this._genericParse(tt,"getAst",_e,rt)},snippet:function(tt,_e,rt,it){var nt;return _e=Type.def(_e,!0),rt=Type.def(rt,""),it=Type.def(it,!1),nt=(_e?" function ("+rt+") { return ":"")+tt+(_e?"; }":"")+";",this.parse(nt,it,!0)},replaceIDs:function(tt){var _e,rt;if(tt.replaced&&(rt=this.board.objects[tt.children[1][0].value],Type.exists(rt)&&rt.name!==""&&(tt.type="node_var",tt.value=rt.name,tt.children.length=0,delete tt.replaced)),tt.children)for(_e=tt.children.length;_e>0;_e--)Type.exists(tt.children[_e-1])&&(tt.children[_e-1]=this.replaceIDs(tt.children[_e-1]));return tt},replaceNames:function(tt){var _e,rt;if(rt=tt.value,tt.type==="node_op"&&rt==="op_lhs"&&tt.children.length===1?this.isLHS=!0:tt.type==="node_var"&&(this.isLHS?this.letvar(rt,!0):!Type.exists(this.getvar(rt,!0))&&Type.exists(this.board.elementsByName[rt])&&(tt=this.createReplacementNode(tt))),tt.children)for(_e=tt.children.length;_e>0;_e--)Type.exists(tt.children[_e-1])&&(tt.children[_e-1]=this.replaceNames(tt.children[_e-1]));return tt.type==="node_op"&&tt.value==="op_lhs"&&tt.children.length===1&&(this.isLHS=!1),tt},createReplacementNode:function(tt){var _e=tt.value,rt=this.board.elementsByName[_e];return tt=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",rt.id)]),tt.replaced=!0,tt},collectDependencies:function(tt,_e){var rt,it,nt,st;if(Type.isArray(tt))for(st=tt.length,rt=0;rt<st;rt++)this.collectDependencies(tt[rt],_e);else if(it=tt.value,tt.type==="node_var"&&(nt=this.getvar(it))&&nt.visProp&&nt.type&&nt.elementClass&&nt.id&&(_e[nt.id]=nt),tt.type==="node_op"&&tt.value==="op_execfun"&&tt.children.length>1&&tt.children[0].value==="$"&&tt.children[1].length>0&&(nt=tt.children[1][0].value,_e[nt]=this.board.objects[nt]),tt.children)for(rt=tt.children.length;rt>0;rt--)Type.exists(tt.children[rt-1])&&this.collectDependencies(tt.children[rt-1],_e)},resolveProperty:function(tt,_e,rt){return rt=Type.def(rt,!1),tt&&tt.methodMap&&(Type.exists(tt.subs)&&Type.exists(tt.subs[_e])?tt=tt.subs:Type.exists(tt.methodMap[_e])?_e=tt.methodMap[_e]:(tt=tt.visProp,_e=_e.toLowerCase())),Type.isFunction(tt)&&this._error("Accessing function properties is not allowed."),Type.exists(tt)||this._error(tt+" is not an object"),Type.exists(tt[_e])||this._error("unknown property "+_e),rt&&typeof tt[_e]=="function"?function(){return tt[_e].apply(tt,arguments)}:tt[_e]},getLHS:function(tt){var _e;if(tt.type==="node_var")_e={o:this.scope.locals,what:tt.value};else if(tt.type==="node_op"&&tt.value==="op_property")_e={o:this.execute(tt.children[0]),what:tt.children[1]};else{if(tt.type!=="node_op"||tt.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");_e={o:this.execute(tt.children[0]),what:this.execute(tt.children[1])}}return _e},getLHSCompiler:function(tt,_e){var rt;if(tt.type==="node_var")rt=tt.value;else if(tt.type==="node_op"&&tt.value==="op_property")rt=[this.compile(tt.children[0],_e),"'"+tt.children[1]+"'"];else{if(tt.type!=="node_op"||tt.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");rt=[this.compile(tt.children[0],_e),tt.children[1].type==="node_const"?tt.children[1].value:this.compile(tt.children[1],_e)]}return rt},execute:function(tt){var _e,rt,it,nt,st,at,lt,ot,ct,ut,ht=[];if(_e=0,!tt)return _e;switch(this.line=tt.line,this.col=tt.col,tt.type){case"node_op":switch(tt.value){case"op_none":tt.children[0]&&this.execute(tt.children[0]),tt.children[1]&&(_e=this.execute(tt.children[1]));break;case"op_assign":rt=this.getLHS(tt.children[0]),this.lhs[this.scope.id]=rt[1],rt.o.type&&rt.o.elementClass&&rt.o.methodMap&&rt.what==="label"&&this._error("Left-hand side of assignment is read-only."),_e=this.execute(tt.children[1]),rt.o!==this.scope.locals||Type.isArray(rt.o)&&typeof rt.what=="number"?this.setProp(rt.o,rt.what,_e):this.letvar(rt.what,_e),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(tt.children[0])&&(_e=this.execute(tt.children[1]));break;case"op_conditional":case"op_if_else":_e=this.execute(tt.children[0])?this.execute(tt.children[1]):this.execute(tt.children[2]);break;case"op_while":for(;this.execute(tt.children[0]);)this.execute(tt.children[1]);break;case"op_do":do this.execute(tt.children[0]);while(this.execute(tt.children[1]));break;case"op_for":for(this.execute(tt.children[0]);this.execute(tt.children[1]);this.execute(tt.children[2]))this.execute(tt.children[3]);break;case"op_proplst":tt.children[0]&&this.execute(tt.children[0]),tt.children[1]&&this.execute(tt.children[1]);break;case"op_emptyobject":_e={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(tt.children[0]),_e=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][tt.children[0]]=this.execute(tt.children[1]);break;case"op_array":for(_e=[],st=tt.children[0].length,it=0;it<st;it++)_e.push(this.execute(tt.children[0][it]));break;case"op_extvalue":_e=this.execute(tt.children[0]),it=this.execute(tt.children[1]),_e=typeof it=="number"&&Math.abs(Math.round(it)-it)<Mat.eps?_e[it]:void 0;break;case"op_return":if(this.scope!==0)return this.execute(tt.children[0]);this._error("Unexpected return.");break;case"op_map":tt.children[1].isMath||tt.children[1].type==="node_var"||this._error("execute: In a map only function calls and mathematical expressions are allowed."),ot=this.defineFunction(tt),ot.isMap=!0,_e=ot;break;case"op_function":ot=this.defineFunction(tt),ot.isMap=!1,_e=ot;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,at=tt.children[1],Type.exists(tt.children[2]))if(tt.children[3])for(lt=tt.children[2],ct={},it=0;it<lt.length;it++)ct=Type.deepCopy(ct,this.execute(lt[it]),!0);else ct=this.execute(tt.children[2]);for(ot=this.execute(tt.children[0]),ut=ot&&ot.sc?ot.sc:this,!ot.creator&&Type.exists(tt.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),it=0;it<at.length;it++)ht[it]=this.execute(at[it]),this.dpstack[this.pscope].push({line:tt.children[1][it].line,col:tt.children[1][it].ecol});if(typeof ot!="function"||ot.creator)if(typeof ot=="function"&&ot.creator){nt=this.line;try{for(_e=ot(ht,ct),_e.jcLineStart=nt,_e.jcLineEnd=tt.eline,it=nt;it<=tt.line;it++)this.lineToElement[it]=_e;_e.debugParents=this.dpstack[this.pscope]}catch(dt){this._error(dt.toString())}}else this._error("Function '"+ot+"' is undefined.");else _e=ot.apply(ut,ht);this.dpstack.pop(),this.pscope--;break;case"op_property":nt=this.execute(tt.children[0]),rt=tt.children[1],_e=this.resolveProperty(nt,rt,!1),Type.exists(_e)&&(_e.sc=nt);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(tt.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),rt=this.getvar(tt.children[0]),_e=this.del(rt);break;case"op_equ":_e=this.execute(tt.children[0])==this.execute(tt.children[1]);break;case"op_neq":_e=this.execute(tt.children[0])!=this.execute(tt.children[1]);break;case"op_approx":_e=Math.abs(this.execute(tt.children[0])-this.execute(tt.children[1]))<Mat.eps;break;case"op_grt":_e=this.execute(tt.children[0])>this.execute(tt.children[1]);break;case"op_lot":_e=this.execute(tt.children[0])<this.execute(tt.children[1]);break;case"op_gre":_e=this.execute(tt.children[0])>=this.execute(tt.children[1]);break;case"op_loe":_e=this.execute(tt.children[0])<=this.execute(tt.children[1]);break;case"op_or":_e=this.execute(tt.children[0])||this.execute(tt.children[1]);break;case"op_and":_e=this.execute(tt.children[0])&&this.execute(tt.children[1]);break;case"op_not":_e=!this.execute(tt.children[0]);break;case"op_add":_e=this.add(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_sub":_e=this.sub(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_div":_e=this.div(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_mod":_e=this.mod(this.execute(tt.children[0]),this.execute(tt.children[1]),!0);break;case"op_mul":_e=this.mul(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_exp":_e=this.pow(this.execute(tt.children[0]),this.execute(tt.children[1]));break;case"op_neg":_e=this.neg(this.execute(tt.children[0]))}break;case"node_var":_e=this.getvar(tt.value);break;case"node_const":_e=Number(tt.value);break;case"node_const_bool":_e=tt.value;break;case"node_str":_e=tt.value.replace(/\\(.)/,"$1")}return _e},compile:function(tt,_e){var rt,it,nt,st="";if(Type.exists(_e)||(_e=!1),!tt)return st;switch(tt.type){case"node_op":switch(tt.value){case"op_none":tt.children[0]&&(st=this.compile(tt.children[0],_e)),tt.children[1]&&(st+=this.compile(tt.children[1],_e));break;case"op_assign":_e?(rt=this.getLHSCompiler(tt.children[0],_e),Type.isArray(rt)?st="$jc$.setProp("+rt[0]+", "+rt[1]+", "+this.compile(tt.children[1],_e)+`);
`:(this.isLocalVariable(rt)!==this.scope&&(this.scope.locals[rt]=!0),st="$jc$.scopes["+this.scope.id+"].locals['"+rt+"'] = "+this.compile(tt.children[1],_e)+`;
`)):(rt=this.compile(tt.children[0]),st=rt+" = "+this.compile(tt.children[1],_e)+`;
`);break;case"op_if":st=" if ("+this.compile(tt.children[0],_e)+") "+this.compile(tt.children[1],_e);break;case"op_if_else":st=" if ("+this.compile(tt.children[0],_e)+")"+this.compile(tt.children[1],_e),st+=" else "+this.compile(tt.children[2],_e);break;case"op_conditional":st="(("+this.compile(tt.children[0],_e)+")?("+this.compile(tt.children[1],_e),st+="):("+this.compile(tt.children[2],_e)+"))";break;case"op_while":st=" while ("+this.compile(tt.children[0],_e)+`) {
`+this.compile(tt.children[1],_e)+`}
`;break;case"op_do":st=` do {
`+this.compile(tt.children[0],_e)+"} while ("+this.compile(tt.children[1],_e)+`);
`;break;case"op_for":st=" for ("+this.compile(tt.children[0],_e)+"; "+this.compile(tt.children[1],_e)+"; "+this.compile(tt.children[2],_e)+`) {
`+this.compile(tt.children[3],_e)+`
}
`;break;case"op_proplst":tt.children[0]&&(st=this.compile(tt.children[0],_e)+", "),st+=this.compile(tt.children[1],_e);break;case"op_prop":st=tt.children[0]+": "+this.compile(tt.children[1],_e);break;case"op_emptyobject":st=_e?"{}":"<< >>";break;case"op_proplst_val":st=this.compile(tt.children[0],_e);break;case"op_array":for(nt=[],it=0;it<tt.children[0].length;it++)nt.push(this.compile(tt.children[0][it],_e));st="["+nt.join(", ")+"]";break;case"op_extvalue":st=this.compile(tt.children[0],_e)+"["+this.compile(tt.children[1],_e)+"]";break;case"op_return":st=" return "+this.compile(tt.children[0],_e)+`;
`;break;case"op_map":tt.children[1].isMath||tt.children[1].type==="node_var"||this._error("compile: In a map only function calls and mathematical expressions are allowed."),nt=tt.children[0],st=_e?" $jc$.makeMap(function ("+nt.join(", ")+") { return "+this.compile(tt.children[1],_e)+"; })":"map ("+nt.join(", ")+") -> "+this.compile(tt.children[1],_e);break;case"op_function":nt=tt.children[0],this.pushScope(nt),st=_e?this.functionCodeJS(tt):" function ("+nt.join(", ")+") "+this.compile(tt.children[1],_e),this.popScope();break;case"op_execfunmath":console.log("TODO"),st="-1";break;case"op_execfun":if(tt.children[2]){for(nt=[],it=0;it<tt.children[2].length;it++)nt.push(this.compile(tt.children[2][it],_e));_e&&(rt="$jc$.mergeAttributes("+nt.join(", ")+")")}for(tt.children[0].withProps=!!tt.children[2],nt=[],it=0;it<tt.children[1].length;it++)nt.push(this.compile(tt.children[1][it],_e));st=this.compile(tt.children[0],_e)+"("+nt.join(", ")+(tt.children[2]&&_e?", "+rt:"")+")"+(tt.children[2]&&!_e?rt:""),_e&&tt.children[0].value==="$"&&(st="$jc$.board.objects["+this.compile(tt.children[1][0],_e)+"]");break;case"op_property":st=_e&&tt.children[1]!=="X"&&tt.children[1]!=="Y"?"$jc$.resolveProperty("+this.compile(tt.children[0],_e)+", '"+tt.children[1]+"', true)":this.compile(tt.children[0],_e)+"."+tt.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),st=_e?"$jc$.use('":"use('",st+=tt.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),st=_e?"$jc$.del(":"remove(",st+=this.compile(tt.children[0],_e)+")";break;case"op_equ":st="("+this.compile(tt.children[0],_e)+" == "+this.compile(tt.children[1],_e)+")";break;case"op_neq":st="("+this.compile(tt.children[0],_e)+" != "+this.compile(tt.children[1],_e)+")";break;case"op_approx":st="("+this.compile(tt.children[0],_e)+" ~= "+this.compile(tt.children[1],_e)+")";break;case"op_grt":st="("+this.compile(tt.children[0],_e)+" > "+this.compile(tt.children[1],_e)+")";break;case"op_lot":st="("+this.compile(tt.children[0],_e)+" < "+this.compile(tt.children[1],_e)+")";break;case"op_gre":st="("+this.compile(tt.children[0],_e)+" >= "+this.compile(tt.children[1],_e)+")";break;case"op_loe":st="("+this.compile(tt.children[0],_e)+" <= "+this.compile(tt.children[1],_e)+")";break;case"op_or":st="("+this.compile(tt.children[0],_e)+" || "+this.compile(tt.children[1],_e)+")";break;case"op_and":st="("+this.compile(tt.children[0],_e)+" && "+this.compile(tt.children[1],_e)+")";break;case"op_not":st="!("+this.compile(tt.children[0],_e)+")";break;case"op_add":st=_e?"$jc$.add("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" + "+this.compile(tt.children[1],_e)+")";break;case"op_sub":st=_e?"$jc$.sub("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" - "+this.compile(tt.children[1],_e)+")";break;case"op_div":st=_e?"$jc$.div("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" / "+this.compile(tt.children[1],_e)+")";break;case"op_mod":st=_e?"$jc$.mod("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+", true)":"("+this.compile(tt.children[0],_e)+" % "+this.compile(tt.children[1],_e)+")";break;case"op_mul":st=_e?"$jc$.mul("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+" * "+this.compile(tt.children[1],_e)+")";break;case"op_exp":st=_e?"$jc$.pow("+this.compile(tt.children[0],_e)+", "+this.compile(tt.children[1],_e)+")":"("+this.compile(tt.children[0],_e)+"^"+this.compile(tt.children[1],_e)+")";break;case"op_neg":st=_e?"$jc$.neg("+this.compile(tt.children[0],_e)+")":"(-"+this.compile(tt.children[0],_e)+")"}break;case"node_var":st=_e?this.getvarJS(tt.value,!1,tt.withProps):tt.value;break;case"node_const":case"node_const_bool":st=tt.value;break;case"node_str":st="'"+tt.value+"'"}return tt.needsBrackets&&(st=`{
`+st+`}
`),st},X:function(tt){return tt.X()},Y:function(tt){return tt.Y()},V:function(tt){return tt.Value()},L:function(tt){return tt.L()},dist:function(tt,_e){return Type.exists(tt)&&Type.exists(tt.Dist)||this._error("Error: Can't calculate distance."),tt.Dist(_e)},add:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isArray(_e))for(it=Math.min(tt.length,_e.length),nt=[],rt=0;rt<it;rt++)nt[rt]=tt[rt]+_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?nt=tt+_e:Type.isString(tt)||Type.isString(_e)?nt=tt.toString()+_e.toString():this._error("Operation + not defined on operands "+typeof tt+" and "+typeof _e);return nt},sub:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isArray(_e))for(it=Math.min(tt.length,_e.length),nt=[],rt=0;rt<it;rt++)nt[rt]=tt[rt]-_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?nt=tt-_e:this._error("Operation - not defined on operands "+typeof tt+" and "+typeof _e);return nt},neg:function(tt){var _e,rt,it;if(tt=Type.evalSlider(tt),Type.isArray(tt))for(rt=tt.length,it=[],_e=0;_e<rt;_e++)it[_e]=-tt[_e];else Type.isNumber(tt)?it=-tt:this._error("Unary operation - not defined on operand "+typeof tt);return it},mul:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e)&&(rt=tt,tt=_e,_e=tt),Type.isArray(tt)&&Type.isArray(_e))it=Math.min(tt.length,_e.length),nt=Mat.innerProduct(tt,_e,it);else if(Type.isNumber(tt)&&Type.isArray(_e))for(it=_e.length,nt=[],rt=0;rt<it;rt++)nt[rt]=tt*_e[rt];else Type.isNumber(tt)&&Type.isNumber(_e)?nt=tt*_e:this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return nt},div:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e))for(it=tt.length,nt=[],rt=0;rt<it;rt++)nt[rt]=tt[rt]/_e;else Type.isNumber(tt)&&Type.isNumber(_e)?nt=tt/_e:this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return nt},mod:function(tt,_e){var rt,it,nt;if(tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Type.isArray(tt)&&Type.isNumber(_e))for(it=tt.length,nt=[],rt=0;rt<it;rt++)nt[rt]=Mat.mod(tt[rt],_e,!0);else Type.isNumber(tt)&&Type.isNumber(_e)?nt=Mat.mod(tt,_e,!0):this._error("Operation * not defined on operands "+typeof tt+" and "+typeof _e);return nt},pow:function(tt,_e){return tt=Type.evalSlider(tt),_e=Type.evalSlider(_e),Math.pow(tt,_e)},DDD:function(tt){console.log("Dummy derivative function. This should never appear!")},ifthen:function(tt,_e,rt){return tt?_e:rt},del:function(tt){typeof tt=="object"&&JXG.exists(tt.type)&&JXG.exists(tt.elementClass)&&this.board.removeObject(tt)},use:function(tt){var _e,rt,it=!1;if(typeof tt=="string"){for(_e in JXG.boards)if(JXG.boards.hasOwnProperty(_e)&&JXG.boards[_e].container===tt){rt=JXG.boards[_e],it=!0;break}}else rt=tt,it=!0;it?(this.board=rt,this.builtIn.$board=rt,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+tt+"' not found!")},findSymbol:function(tt,_e){var rt,it;for(_e=Type.def(_e,-1),it=_e===-1?this.scope:this.scopes[_e];it!==null;){for(rt in it.locals)if(it.locals.hasOwnProperty(rt)&&it.locals[rt]===tt)return[rt,it];it=it.previous}return[]},importModule:function(tt){return priv.modules[tt.toLowerCase()]},defineBuiltIn:function(){var tt=this,_e={PI:Math.PI,EULER:Math.E,X:tt.X,Y:tt.Y,V:tt.V,L:tt.L,dist:tt.dist,rad:Geometry.rad,deg:Geometry.trueAngle,factorial:Mat.factorial,trunc:Type.trunc,log:Mat.log,ln:Math.log,log10:Mat.log10,lg:Mat.log10,log2:Mat.log2,lb:Mat.log2,ld:Mat.log2,cosh:Mat.cosh,sinh:Mat.sinh,IfThen:tt.ifthen,import:tt.importModule,use:tt.use,remove:tt.del,$:tt.getElementById,$board:tt.board,$log:tt.log,D:tt.DDD};return _e.rad.sc=Geometry,_e.deg.sc=Geometry,_e.factorial.sc=Mat,_e.X.src="$jc$.X",_e.Y.src="$jc$.Y",_e.V.src="$jc$.V",_e.L.src="$jc$.L",_e.dist.src="$jc$.dist",_e.rad.src="JXG.Math.Geometry.rad",_e.deg.src="JXG.Math.Geometry.trueAngle",_e.factorial.src="JXG.Math.factorial",_e.trunc.src="JXG.trunc",_e.ln.src="Math.log",_e.log10.src="JXG.Math.log10",_e.lg.src="JXG.Math.log10",_e.log2.src="JXG.Math.log2",_e.lb.src="JXG.Math.log2",_e.ld.src="JXG.Math.log2",_e.cosh.src="JXG.Math.cosh",_e.sinh.src="JXG.Math.sinh",_e.import.src="$jc$.importModule",_e.use.src="$jc$.use",_e.remove.src="$jc$.del",_e.IfThen.src="$jc$.ifthen",_e.$.src="(function (n) { return $jc$.board.select(n); })",_e.$board&&(_e.$board.src="$jc$.board"),_e.$log.src="$jc$.log",_e},_debug:function(tt){typeof console=="object"?console.log(tt):Env.isBrowser&&document&&document.getElementById("debug")!==null&&(document.getElementById("debug").innerHTML+=tt+"<br />")},_error:function(tt){var _e=new Error("Error("+this.line+"): "+tt);throw _e.line=this.line,_e},_warn:function(tt){typeof console=="object"?console.log("Warning("+this.line+"): "+tt):Env.isBrowser&&document&&document.getElementById(this.warnLog)!==null&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+tt+"<br />")},_log:function(tt){typeof window!="object"&&typeof self=="object"&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+tt.toString()}):console.log("Log: ",arguments)}});var parser=function(){function tt(){this.yy={}}var _e=function(hr,Cr,tr,Ar){for(tr=tr||{},Ar=hr.length;Ar--;tr[hr[Ar]]=Cr);return tr},rt=[2,14],it=[1,13],nt=[1,37],st=[1,14],at=[1,15],lt=[1,21],ot=[1,16],ct=[1,17],ut=[1,33],ht=[1,18],dt=[1,19],pt=[1,12],ft=[1,59],gt=[1,60],mt=[1,58],At=[1,46],yt=[1,48],bt=[1,49],xt=[1,50],vt=[1,51],_t=[1,52],Ct=[1,53],St=[1,54],Et=[1,45],Tt=[1,38],Mt=[1,39],Rt=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],It=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],Ot=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Bt=[2,48],Nt=[1,72],zt=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],Dt=[1,78],Ft=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Ut=[1,82],$t=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Vt=[1,83],Zt=[1,84],qt=[1,85],sr=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],er=[1,89],ir=[1,90],ur=[1,91],ar=[1,92],lr=[1,97],gr=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],Yt=[1,103],nr=[1,104],mr=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],Sr=[1,105],Er=[1,106],Nr=[1,107],wr=[1,126],kr=[1,139],Ur=[83,86],Or=[1,149],Xr=[10,66,86],Qt=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],Xt=[1,166],xr=[10,86],Lr={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,6],[92,1],[92,3]],performAction:function(hr,Cr,tr,Ar,yr,Jt,_r){var Kt=Jt.length-1;switch(yr){case 1:return Jt[Kt-1];case 2:this.$=fr.createNode(pr(_r[Kt-4]),"node_op","op_if",Jt[Kt-2],Jt[Kt]);break;case 3:this.$=fr.createNode(pr(_r[Kt-6]),"node_op","op_if_else",Jt[Kt-4],Jt[Kt-2],Jt[Kt]);break;case 4:this.$=fr.createNode(pr(_r[Kt-4]),"node_op","op_while",Jt[Kt-2],Jt[Kt]);break;case 5:this.$=fr.createNode(pr(_r[Kt-8]),"node_op","op_for",Jt[Kt-6],Jt[Kt-4],Jt[Kt-2],Jt[Kt]);break;case 6:this.$=fr.createNode(pr(_r[Kt-6]),"node_op","op_do",Jt[Kt-5],Jt[Kt-2]);break;case 7:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_use",Jt[Kt]);break;case 8:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_delete",Jt[Kt]);break;case 9:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_return",void 0);break;case 10:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_return",Jt[Kt-1]);break;case 11:case 14:this.$=fr.createNode(pr(_r[Kt]),"node_op","op_none");break;case 12:this.$=Jt[Kt-1],this.$.needsBrackets=!0;break;case 13:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_none",Jt[Kt-1],Jt[Kt]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=Jt[Kt];break;case 22:case 65:case 93:this.$=Jt[Kt-1];break;case 25:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_assign",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 27:this.$=fr.createNode(pr(_r[Kt-4]),"node_op","op_conditional",Jt[Kt-4],Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 29:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_or",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 31:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_and",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 33:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_equ",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 34:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_neq",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 35:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_approx",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 37:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_lot",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 38:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_grt",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 39:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_loe",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 40:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_gre",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 42:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_add",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 43:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_sub",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 45:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_mul",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 46:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_div",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 47:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_mod",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 49:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_exp",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 51:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_not",Jt[Kt]),this.$.isMath=!1;break;case 53:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_neg",Jt[Kt]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=Jt[Kt],this.$.isMath=!1;break;case 59:case 91:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_property",Jt[Kt-2],Jt[Kt]),this.$.isMath=!0;break;case 60:case 90:this.$=fr.createNode(pr(_r[Kt-3]),"node_op","op_extvalue",Jt[Kt-3],Jt[Kt-1]),this.$.isMath=!0;break;case 61:this.$=fr.createNode(pr(_r[Kt]),"node_var",Jt[Kt]);break;case 69:this.$=Jt[Kt],this.$.isMath=!0;break;case 70:this.$=fr.createNode(pr(_r[Kt]),"node_const",null);break;case 71:this.$=fr.createNode(pr(_r[Kt]),"node_const_bool",!0);break;case 72:this.$=fr.createNode(pr(_r[Kt]),"node_const_bool",!1);break;case 73:this.$=fr.createNode(pr(_r[Kt]),"node_str",Jt[Kt].substring(1,Jt[Kt].length-1));break;case 74:this.$=fr.createNode(pr(_r[Kt]),"node_const",parseFloat(Jt[Kt]));break;case 75:this.$=fr.createNode(pr(_r[Kt]),"node_const",NaN);break;case 76:this.$=fr.createNode(pr(_r[Kt]),"node_const",1/0);break;case 77:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_array",[]);break;case 78:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_array",Jt[Kt-1]);break;case 79:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_emptyobject",{});break;case 80:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_proplst_val",Jt[Kt-1]);break;case 82:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_proplst",Jt[Kt-2],Jt[Kt]);break;case 83:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_prop",Jt[Kt-2],Jt[Kt]);break;case 87:case 89:this.$=fr.createNode(pr(_r[Kt-1]),"node_op","op_execfun",Jt[Kt-1],Jt[Kt]),this.$.isMath=!0;break;case 88:this.$=fr.createNode(pr(_r[Kt-2]),"node_op","op_execfun",Jt[Kt-2],Jt[Kt-1],Jt[Kt],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 103:this.$=[Jt[Kt]];break;case 95:case 99:case 104:this.$=Jt[Kt-2].concat(Jt[Kt]);break;case 96:this.$=fr.createNode(pr(_r[Kt]),"node_var",Jt[Kt]),this.$.isMath=!0;break;case 100:this.$=fr.createNode(pr(_r[Kt-3]),"node_op","op_function",[],Jt[Kt]),this.$.isMath=!1;break;case 101:this.$=fr.createNode(pr(_r[Kt-4]),"node_op","op_function",Jt[Kt-2],Jt[Kt]),this.$.isMath=!1;break;case 102:this.$=fr.createNode(pr(_r[Kt-5]),"node_op","op_map",Jt[Kt-3],Jt[Kt])}},table:[_e([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],rt,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:it,8:nt,9:20,11:4,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{1:[2,1]},_e(Rt,[2,13]),_e(It,[2,15]),_e(It,[2,16]),_e(It,[2,17]),_e(It,[2,18]),_e(It,[2,19]),_e(It,[2,20]),_e(It,[2,21]),_e([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],rt,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:it,8:nt,9:20,11:65,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{20:[1,66]},{20:[1,67]},{8:nt,9:69,16:[1,68],20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{16:[1,70]},_e(It,[2,11]),_e(Ot,[2,23]),_e(Ot,[2,24]),_e([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],Bt,{32:[1,71],57:Nt}),_e([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),_e(zt,[2,54],{88:77,8:Dt,64:[1,75],65:[1,76]}),_e(zt,[2,55],{88:79,8:Dt,64:[1,81],65:[1,80]}),_e(Ft,[2,28],{39:Ut}),_e(Ot,[2,56]),_e(Ot,[2,57]),_e(Ot,[2,58]),_e($t,[2,30],{41:Vt,42:Zt,43:qt}),_e(Ot,[2,61]),_e(Ot,[2,62]),_e(Ot,[2,63]),_e(Ot,[2,64]),{8:nt,9:86,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:[1,87]},{8:[1,88]},_e(sr,[2,32],{45:er,46:ir,47:ur,48:ar}),_e(Ot,[2,66]),_e(Ot,[2,67]),_e(Ot,[2,68]),_e(Ot,[2,69]),{20:lr,72:98,73:99,77:vt,78:_t,79:Ct,80:St,83:[1,93],84:94,85:95,87:96},{8:nt,20:ut,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,81:101,82:Et,91:Tt,93:Mt},_e(gr,[2,36],{50:Yt,51:nr}),_e(Ot,[2,70]),_e(Ot,[2,71]),_e(Ot,[2,72]),_e(Ot,[2,73]),_e(Ot,[2,74]),_e(Ot,[2,75]),_e(Ot,[2,76]),_e(mr,[2,41],{53:Sr,54:Er,55:Nr}),_e(Ot,[2,44]),_e(Ot,[2,50]),{8:nt,20:ut,31:109,50:ft,51:gt,52:108,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:110,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:111,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{6:6,7:it,8:nt,9:20,11:4,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:113,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:114,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:115,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{14:[1,116]},_e(It,[2,7]),_e(It,[2,8]),_e(It,[2,9]),{16:[1,117]},_e(It,[2,22]),{8:nt,20:ut,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:119,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,36:121,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{20:[1,122]},{8:nt,9:123,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,87],{89:124,90:125,68:127,20:wr,82:Et}),{8:nt,10:[1,128],20:ut,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,81:129,82:Et,91:Tt,93:Mt},_e(Ot,[2,89]),{8:nt,9:130,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{20:[1,131]},{8:nt,20:ut,31:109,38:132,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,40:133,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,40:134,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,40:135,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{10:[1,136]},{10:[1,137],20:kr,92:138},{20:kr,92:140},{8:nt,20:ut,31:109,44:141,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,44:142,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,44:143,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,44:144,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,79]),{83:[1,145],86:[1,146]},_e(Ur,[2,81]),{35:[1,147]},{35:[2,84]},{35:[2,85]},{35:[2,86]},_e(Ot,[2,77]),{66:[1,148],86:Or},_e(Xr,[2,98]),{8:nt,20:ut,31:109,49:150,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,49:151,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:152,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:153,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,31:109,50:ft,51:gt,52:154,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,51]),_e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],Bt,{57:Nt}),_e(Ot,[2,52]),_e(Ot,[2,53]),_e([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,155]},{10:[1,156]},{16:[1,157]},{8:[1,158]},_e(It,[2,10]),_e(Ot,[2,25]),_e(Ot,[2,49]),{35:[1,159]},_e(Ft,[2,29],{39:Ut}),_e(Ot,[2,59]),{66:[1,160]},_e([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,161]}),_e(Ot,[2,94]),_e(Ot,[2,96]),_e(Ot,[2,97]),_e(Qt,[2,92]),{10:[1,162],86:Or},{66:[1,163]},_e(Ot,[2,91]),_e($t,[2,31],{41:Vt,42:Zt,43:qt}),_e(sr,[2,33],{45:er,46:ir,47:ur,48:ar}),_e(sr,[2,34],{45:er,46:ir,47:ur,48:ar}),_e(sr,[2,35],{45:er,46:ir,47:ur,48:ar}),_e(Ot,[2,65]),{25:164,26:pt},{10:[1,165],86:Xt},_e(xr,[2,103]),{10:[1,167],86:Xt},_e(gr,[2,37],{50:Yt,51:nr}),_e(gr,[2,38],{50:Yt,51:nr}),_e(gr,[2,39],{50:Yt,51:nr}),_e(gr,[2,40],{50:Yt,51:nr}),_e(Ot,[2,80]),{20:lr,72:98,73:99,77:vt,78:_t,79:Ct,80:St,85:168,87:96},{8:nt,20:ut,29:169,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,78]),{8:nt,20:ut,29:170,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(mr,[2,42],{53:Sr,54:Er,55:Nr}),_e(mr,[2,43],{53:Sr,54:Er,55:Nr}),_e(Ot,[2,45]),_e(Ot,[2,46]),_e(Ot,[2,47]),{6:6,7:it,8:nt,9:20,11:171,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{6:6,7:it,8:nt,9:20,11:172,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:173,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:174,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,20:ut,29:175,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(Ot,[2,60]),{20:wr,68:127,82:Et,90:176},_e(Qt,[2,93]),_e(Ot,[2,90]),_e(Ot,[2,100]),{25:177,26:pt},{20:[1,178]},{94:[1,179]},_e(Ur,[2,82]),_e(Ur,[2,83]),_e(Xr,[2,99]),_e(Rt,[2,2],{12:[1,180]}),_e(It,[2,4]),{16:[1,181]},{10:[1,182]},_e(Ot,[2,27]),_e(Ot,[2,95]),_e(Ot,[2,101]),_e(xr,[2,104]),{8:nt,9:183,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{6:6,7:it,8:nt,9:20,11:184,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{8:nt,9:185,20:ut,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},{16:[1,186]},_e(Ot,[2,102]),_e(It,[2,3]),{10:[1,187]},_e(It,[2,6]),{6:6,7:it,8:nt,9:20,11:188,13:7,14:st,15:at,16:lt,17:ot,18:8,19:ct,20:ut,21:ht,22:9,23:dt,24:11,25:5,26:pt,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:ft,51:gt,52:56,56:57,58:mt,59:26,60:27,61:29,62:30,63:31,65:At,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:yt,75:bt,76:xt,77:vt,78:_t,79:Ct,80:St,82:Et,91:Tt,93:Mt},_e(It,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(hr,Cr){if(!Cr.recoverable){var tr=new Error(hr);throw tr.hash=Cr,tr}this.trace(hr)},parse:function(hr){var Cr=this,tr=[0],Ar=[null],yr=[],Jt=this.table,_r="",Kt=0,Qr=0,br=0,Rr=yr.slice.call(arguments,1),Tr=Object.create(this.lexer),Vr={yy:{}};for(var Wr in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Wr)&&(Vr.yy[Wr]=this.yy[Wr]);Tr.setInput(hr,Vr.yy),Vr.yy.lexer=Tr,Vr.yy.parser=this,Tr.yylloc===void 0&&(Tr.yylloc={});var pn=Tr.yylloc;yr.push(pn);var En=Tr.options&&Tr.options.ranges;typeof Vr.yy.parseError=="function"?this.parseError=Vr.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var rn,Cn,vn,an,yn,Gn,Pn,Sn,In,jn=function(){var Nn;return Nn=Tr.lex()||1,typeof Nn!="number"&&(Nn=Cr.symbols_[Nn]||Nn),Nn},_n={};;){if(vn=tr[tr.length-1],this.defaultActions[vn]?an=this.defaultActions[vn]:(rn!=null||(rn=jn()),an=Jt[vn]&&Jt[vn][rn]),an===void 0||!an.length||!an[0]){var nn="";In=[];for(Gn in Jt[vn])this.terminals_[Gn]&&Gn>2&&In.push("'"+this.terminals_[Gn]+"'");nn=Tr.showPosition?"Parse error on line "+(Kt+1)+`:
`+Tr.showPosition()+`
Expecting `+In.join(", ")+", got '"+(this.terminals_[rn]||rn)+"'":"Parse error on line "+(Kt+1)+": Unexpected "+(rn==1?"end of input":"'"+(this.terminals_[rn]||rn)+"'"),this.parseError(nn,{text:Tr.match,token:this.terminals_[rn]||rn,line:Tr.yylineno,loc:pn,expected:In})}if(an[0]instanceof Array&&an.length>1)throw new Error("Parse Error: multiple actions possible at state: "+vn+", token: "+rn);switch(an[0]){case 1:tr.push(rn),Ar.push(Tr.yytext),yr.push(Tr.yylloc),tr.push(an[1]),rn=null,Cn?(rn=Cn,Cn=null):(Qr=Tr.yyleng,_r=Tr.yytext,Kt=Tr.yylineno,pn=Tr.yylloc,br>0);break;case 2:if(Pn=this.productions_[an[1]][1],_n.$=Ar[Ar.length-Pn],_n._$={first_line:yr[yr.length-(Pn||1)].first_line,last_line:yr[yr.length-1].last_line,first_column:yr[yr.length-(Pn||1)].first_column,last_column:yr[yr.length-1].last_column},En&&(_n._$.range=[yr[yr.length-(Pn||1)].range[0],yr[yr.length-1].range[1]]),(yn=this.performAction.apply(_n,[_r,Qr,Kt,Vr.yy,an[1],Ar,yr].concat(Rr)))!==void 0)return yn;Pn&&(tr=tr.slice(0,-1*Pn*2),Ar=Ar.slice(0,-1*Pn),yr=yr.slice(0,-1*Pn)),tr.push(this.productions_[an[1]][0]),Ar.push(_n.$),yr.push(_n._$),Sn=Jt[tr[tr.length-2]][tr[tr.length-1]],tr.push(Sn);break;case 3:return!0}}return!0}},fr={node:function(hr,Cr,tr){return{type:hr,value:Cr,children:tr}},createNode:function(hr,Cr,tr,Ar){var yr,Jt=this.node(Cr,tr,[]);for(yr=3;yr<arguments.length;yr++)Jt.children.push(arguments[yr]);return Jt.line=hr[0],Jt.col=hr[1],Jt.eline=hr[2],Jt.ecol=hr[3],Jt}},pr=function(hr){return[hr.first_line,hr.first_column,hr.last_line,hr.last_column]},Hr=function(){return{EOF:1,parseError:function(hr,Cr){if(!this.yy.parser)throw new Error(hr);this.yy.parser.parseError(hr,Cr)},setInput:function(hr,Cr){return this.yy=Cr||this.yy||{},this._input=hr,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var hr=this._input[0];return this.yytext+=hr,this.yyleng++,this.offset++,this.match+=hr,this.matched+=hr,hr.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),hr},unput:function(hr){var Cr=hr.length,tr=hr.split(/(?:\r\n?|\n)/g);this._input=hr+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Cr),this.offset-=Cr;var Ar=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),tr.length-1&&(this.yylineno-=tr.length-1);var yr=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:tr?(tr.length===Ar.length?this.yylloc.first_column:0)+Ar[Ar.length-tr.length].length-tr[0].length:this.yylloc.first_column-Cr},this.options.ranges&&(this.yylloc.range=[yr[0],yr[0]+this.yyleng-Cr]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(hr){this.unput(this.match.slice(hr))},pastInput:function(){var hr=this.matched.substr(0,this.matched.length-this.match.length);return(hr.length>20?"...":"")+hr.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var hr=this.match;return hr.length<20&&(hr+=this._input.substr(0,20-hr.length)),(hr.substr(0,20)+(hr.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var hr=this.pastInput(),Cr=new Array(hr.length+1).join("-");return hr+this.upcomingInput()+`
`+Cr+"^"},test_match:function(hr,Cr){var tr,Ar,yr;if(this.options.backtrack_lexer&&(yr={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(yr.yylloc.range=this.yylloc.range.slice(0))),Ar=hr[0].match(/(?:\r\n?|\n).*/g),Ar&&(this.yylineno+=Ar.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Ar?Ar[Ar.length-1].length-Ar[Ar.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+hr[0].length},this.yytext+=hr[0],this.match+=hr[0],this.matches=hr,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(hr[0].length),this.matched+=hr[0],tr=this.performAction.call(this,this.yy,this,Cr,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),tr)return tr;if(this._backtrack){for(var Jt in yr)this[Jt]=yr[Jt];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var hr,Cr,tr,Ar;this._more||(this.yytext="",this.match="");for(var yr=this._currentRules(),Jt=0;Jt<yr.length;Jt++)if((tr=this._input.match(this.rules[yr[Jt]]))&&(!Cr||tr[0].length>Cr[0].length)){if(Cr=tr,Ar=Jt,this.options.backtrack_lexer){if((hr=this.test_match(tr,yr[Jt]))!==!1)return hr;if(this._backtrack){Cr=!1;continue}return!1}if(!this.options.flex)break}return Cr?(hr=this.test_match(Cr,yr[Ar]))!==!1&&hr:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var hr=this.next();return hr||this.lex()},begin:function(hr){this.conditionStack.push(hr)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(hr){return hr=this.conditionStack.length-1-Math.abs(hr||0),hr>=0?this.conditionStack[hr]:"INITIAL"},pushState:function(hr){this.begin(hr)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(hr,Cr,tr,Ar){switch(tr){case 0:break;case 1:case 2:return 78;case 3:case 4:return 77;case 5:case 6:break;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:return 94;case 22:return 82;case 23:return 83;case 24:return 26;case 25:return 27;case 26:return 16;case 27:return"#";case 28:return 34;case 29:return 35;case 30:return 79;case 31:return 64;case 32:return 65;case 33:return 66;case 34:return 8;case 35:return 10;case 36:return 58;case 37:return 57;case 38:return 53;case 39:return 54;case 40:return 55;case 41:return 50;case 42:return 51;case 43:return 47;case 44:return 45;case 45:return 48;case 46:return 46;case 47:return 41;case 48:return 43;case 49:return 42;case 50:return 39;case 51:return 37;case 52:return 32;case 53:return 86;case 54:return 5;case 55:return 20;case 56:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],inclusive:!0}}}}();return Lr.lexer=Hr,tt.prototype=Lr,Lr.Parser=tt,new tt}();return require!==void 0&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(tt){tt[1]||(console.log("Usage: "+tt[0]+" FILE"),process.exit(1));var _e=require("fs").readFileSync(require("path").normalize(tt[1]),"utf8");return exports.parser.parse(_e)},require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode}),define("base/point",["jxg","options","math/math","math/geometry","math/numerics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation","base/coordselement"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht){return tt.Point=function(dt,pt,ft){this.constructor(dt,ft,at.OBJECT_TYPE_POINT,at.OBJECT_CLASS_POINT),this.element=this.board.select(ft.anchor),this.coordsConstructor(pt),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createLabel()},tt.Point.prototype=new lt,ct.copyPrototypeMethods(tt.Point,ht,"coordsConstructor"),tt.extend(tt.Point.prototype,{hasPoint:function(dt,pt){var ft,gt=this.coords.scrCoords,mt=ct.evaluate(this.visProp.sizeunit);return ft=parseFloat(ct.evaluate(this.visProp.size)),mt==="user"&&(ft*=Math.sqrt(this.board.unitX*this.board.unitY)),ft+=.5*parseFloat(ct.evaluate(this.visProp.strokewidth)),ft<this.board.options.precision.hasPoint&&(ft=this.board.options.precision.hasPoint),Math.abs(gt[1]-dt)<ft+2&&Math.abs(gt[2]-pt)<ft+2},update:function(dt){return this.needsUpdate?(this.updateCoords(dt),ct.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(){var dt,pt;if(this.transformations.length===0||this.baseElement===null)return this;for(dt=this===this.baseElement?this.transformations[0].apply(this.baseElement,"self"):this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(at.COORDS_BY_USER,dt),pt=1;pt<this.transformations.length;pt++)this.coords.setCoordinates(at.COORDS_BY_USER,this.transformations[pt].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(dt,pt,ft,gt){var mt;dt=this.board.select(dt),pt=this.board.select(pt),mt=it.intersectionFunction(this.board,dt,pt,ft,gt,ct.evaluate(this.visProp.alwaysintersect)),this.addConstraint([mt]);try{dt.addChild(this),pt.addChild(this)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof dt+"' and '"+typeof pt+"'.")}this.type=at.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[dt.id,pt.id,ft,gt],this.generatePolynomial=function(){var At=dt.generatePolynomial(this),yt=pt.generatePolynomial(this);return At.length===0||yt.length===0?[]:[At[0],yt[0]]},this.prepareUpdate().update()},setStyle:function(dt){var pt=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"],ft=[2,3,4,1,2,3,4,2,3,4,2,3,4];return this.visProp.face=pt[dt],this.visProp.size=ft[dt],this.board.renderer.changePointStyle(this),this},normalizeFace:function(dt){return tt.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),_e.normalizePointFace(dt)},face:function(dt){tt.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:dt})},size:function(dt){tt.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:dt})},cloneToBackground:function(){var dt={};return dt.id=this.id+"T"+this.numTraces,this.numTraces+=1,dt.coords=this.coords,dt.visProp=ct.deepCopy(this.visProp,this.visProp.traceattributes,!0),dt.visProp.layer=this.board.options.layer.trace,dt.elementClass=at.OBJECT_CLASS_POINT,dt.board=this.board,ct.clearVisPropOld(dt),dt.visPropCalc={visible:ct.evaluate(dt.visProp.visible)},this.board.renderer.drawPoint(dt),this.traces[dt.id]=dt.rendNode,this}}),tt.createPoint=function(dt,pt,ft){var gt,mt;if(mt=ct.copyAttributes(ft,dt.options,"point"),!(gt=ht.create(tt.Point,dt,pt,mt)))throw new Error("JSXGraph: Can't create point with parent types '"+typeof pt[0]+"' and '"+typeof pt[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return gt},tt.createGlider=function(dt,pt,ft){var gt,mt,At=ct.copyAttributes(ft,dt.options,"glider");return mt=pt.length===1?[0,0]:pt.slice(0,2),gt=dt.create("point",mt,At),gt.makeGlider(pt[pt.length-1]),gt},tt.createIntersectionPoint=function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt=ct.copyAttributes(ft,dt.options,"intersection");pt.push(0,0),mt=dt.select(pt[0]),At=dt.select(pt[1]),bt=pt[2]||0,xt=pt[3]||0,gt=dt.create("point",[0,0,0],vt),yt=it.intersectionFunction(dt,mt,At,bt,xt,gt.visProp.alwaysintersect),gt.addConstraint([yt]);try{mt.addChild(gt),At.addChild(gt)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof pt[0]+"' and '"+typeof pt[1]+"'.")}return gt.type=at.OBJECT_TYPE_INTERSECTION,gt.elType="intersection",gt.setParents([mt.id,At.id]),gt.intersectionNumbers=[bt,xt],gt.getParents=function(){return this.parents.concat(this.intersectionNumbers)},gt.generatePolynomial=function(){var _t=mt.generatePolynomial(gt),Ct=At.generatePolynomial(gt);return _t.length===0||Ct.length===0?[]:[_t[0],Ct[0]]},gt},tt.createOtherIntersectionPoint=function(dt,pt,ft){var gt,mt,At,yt;if(pt.length!==3||!ct.isPoint(pt[2])||pt[0].elementClass!==at.OBJECT_CLASS_LINE&&pt[0].elementClass!==at.OBJECT_CLASS_CIRCLE||pt[1].elementClass!==at.OBJECT_CLASS_LINE&&pt[1].elementClass!==at.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof pt[0]+"',  '"+typeof pt[1]+"'and  '"+typeof pt[2]+`'.
Possible parent types: [circle|line,circle|line,point]`);return mt=dt.select(pt[0]),At=dt.select(pt[1]),yt=dt.select(pt[2]),gt=dt.create("point",[function(){var bt=it.meet(mt.stdform,At.stdform,0,mt.board);return Math.abs(yt.X()-bt.usrCoords[1])>rt.eps||Math.abs(yt.Y()-bt.usrCoords[2])>rt.eps||Math.abs(yt.Z()-bt.usrCoords[0])>rt.eps?bt:it.meet(mt.stdform,At.stdform,1,mt.board)}],ft),gt.type=at.OBJECT_TYPE_INTERSECTION,gt.elType="otherintersection",gt.setParents([mt.id,At.id,yt]),mt.addChild(gt),At.addChild(gt),gt.generatePolynomial=function(){var bt=mt.generatePolynomial(gt),xt=At.generatePolynomial(gt);return bt.length===0||xt.length===0?[]:[bt[0],xt[0]]},gt},tt.createPolePoint=function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt;if(pt.length>1&&(yt=pt[0].type===at.OBJECT_TYPE_CONIC||pt[0].elementClass===at.OBJECT_CLASS_CIRCLE,bt=pt[1].type===at.OBJECT_TYPE_CONIC||pt[1].elementClass===at.OBJECT_CLASS_CIRCLE,xt=pt[0].elementClass===at.OBJECT_CLASS_LINE,vt=pt[1].elementClass===at.OBJECT_CLASS_LINE),pt.length!==2||!(yt&&vt||xt&&bt))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof pt[0]+"' and '"+typeof pt[1]+`'.
Possible parent type: [conic|circle,line], [line,conic|circle]`);return vt?(mt=dt.select(pt[0]),At=dt.select(pt[1])):(mt=dt.select(pt[1]),At=dt.select(pt[0])),gt=dt.create("point",[function(){var _t=mt.quadraticform,Ct=At.stdform.slice(0,3);return[tt.Math.Numerics.det([Ct,_t[1],_t[2]]),tt.Math.Numerics.det([_t[0],Ct,_t[2]]),tt.Math.Numerics.det([_t[0],_t[1],Ct])]}],ft),gt.elType="polepoint",gt.setParents([mt.id,At.id]),mt.addChild(gt),At.addChild(gt),gt},tt.registerElement("point",tt.createPoint),tt.registerElement("glider",tt.createGlider),tt.registerElement("intersection",tt.createIntersectionPoint),tt.registerElement("otherintersection",tt.createOtherIntersectionPoint),tt.registerElement("polepoint",tt.createPolePoint),{Point:tt.Point,createPoint:tt.createPoint,createGlider:tt.createGlider,createIntersection:tt.createIntersectionPoint,createOtherIntersection:tt.createOtherIntersectionPoint,createPolePoint:tt.createPolePoint}}),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){return tt.Line=function(ut,ht,dt,pt){this.constructor(ut,pt,st.OBJECT_TYPE_LINE,st.OBJECT_CLASS_LINE),this.point1=this.board.select(ht),this.point2=this.board.select(dt),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1.addChild(this),this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=tt.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"})},tt.Line.prototype=new lt,tt.extend(tt.Line.prototype,{hasPoint:function(ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt=[],vt=[1,ut,ht],_t=ot.evaluate(this.visProp.strokewidth);return bt=this.board.options.precision.hasPoint+.5*_t,xt[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,xt[1]=this.stdform[1]/this.board.unitX,xt[2]=this.stdform[2]/-this.board.unitY,dt=rt.distPointLine(vt,xt),!(isNaN(dt)||dt>bt)&&(!(!ot.evaluate(this.visProp.straightfirst)||!ot.evaluate(this.visProp.straightlast))||(ft=this.point1.coords,gt=this.point2.coords,pt=[0,xt[1],xt[2]],pt=_e.crossProduct(pt,vt),pt=_e.crossProduct(pt,xt),pt[1]/=pt[0],pt[2]/=pt[0],pt[0]=1,pt=new at(st.COORDS_BY_SCREEN,pt.slice(1),this.board).usrCoords,mt=ft.distance(st.COORDS_BY_USER,gt),ft=ft.usrCoords.slice(0),gt=gt.usrCoords.slice(0),mt<_e.eps?At=0:(mt===Number.POSITIVE_INFINITY&&(mt=1/_e.eps,Math.abs(gt[0])<_e.eps?(mt/=rt.distance([0,0,0],gt),gt=[1,ft[1]+gt[1]*mt,ft[2]+gt[2]*mt]):(mt/=rt.distance([0,0,0],ft),ft=[1,gt[1]+ft[1]*mt,gt[2]+ft[2]*mt])),yt=1,mt=gt[yt]-ft[yt],Math.abs(mt)<_e.eps&&(yt=2,mt=gt[yt]-ft[yt]),At=(pt[yt]-ft[yt])/mt),!(!ot.evaluate(this.visProp.straightfirst)&&At<0)&&!(!ot.evaluate(this.visProp.straightlast)&&At>1)))},update:function(){var ut;return this.needsUpdate?(this.constrained&&(ot.isFunction(this.funps)?(ut=this.funps())&&ut.length&&ut.length===2&&(this.point1=ut[0],this.point2=ut[1]):(ot.isFunction(this.funp1)&&(ut=this.funp1(),ot.isPoint(ut)?this.point1=ut:ut&&ut.length&&ut.length===2&&this.point1.setPositionDirectly(st.COORDS_BY_USER,ut)),ot.isFunction(this.funp2)&&(ut=this.funp2(),ot.isPoint(ut)?this.point2=ut:ut&&ut.length&&ut.length===2&&this.point2.setPositionDirectly(st.COORDS_BY_USER,ut)))),this.updateSegmentFixedLength(),this.updateStdform(),ot.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var ut,ht,dt,pt,ft,gt,mt,At;return this.hasFixedLength?(ut=this.point1.Dist(this.point2),ht=this.fixedLength(),dt=this.fixedLengthOldCoords[0].distance(st.COORDS_BY_USER,this.point1.coords),pt=this.fixedLengthOldCoords[1].distance(st.COORDS_BY_USER,this.point2.coords),(dt>_e.eps||pt>_e.eps||ut!==ht)&&(ft=this.point1.isDraggable&&this.point1.type!==st.OBJECT_TYPE_GLIDER&&!ot.evaluate(this.point1.visProp.fixed),gt=this.point2.isDraggable&&this.point2.type!==st.OBJECT_TYPE_GLIDER&&!ot.evaluate(this.point2.visProp.fixed),ut>_e.eps?dt>pt&&gt||dt<=pt&&gt&&!ft?(this.point2.setPositionDirectly(st.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*ht/ut,this.point1.Y()+(this.point2.Y()-this.point1.Y())*ht/ut]),this.point2.fullUpdate()):(dt<=pt&&ft||dt>pt&&ft&&!gt)&&(this.point1.setPositionDirectly(st.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*ht/ut,this.point2.Y()+(this.point1.Y()-this.point2.Y())*ht/ut]),this.point1.fullUpdate()):(mt=Math.random()-.5,At=Math.random()-.5,ut=Math.sqrt(mt*mt+At*At),gt?(this.point2.setPositionDirectly(st.COORDS_BY_USER,[this.point1.X()+mt*ht/ut,this.point1.Y()+At*ht/ut]),this.point2.fullUpdate()):ft&&(this.point1.setPositionDirectly(st.COORDS_BY_USER,[this.point2.X()+mt*ht/ut,this.point2.Y()+At*ht/ut]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(st.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(st.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var ut=_e.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=ut[0],this.stdform[1]=ut[1],this.stdform[2]=ut[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&_e.innerProduct(this.stdform,this.stdform,3)>=_e.eps*_e.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(ut){var ht=this.point1.symbolic.x,dt=this.point1.symbolic.y,pt=this.point2.symbolic.x,ft=this.point2.symbolic.y,gt=ut.symbolic.x,mt=ut.symbolic.y;return[["(",dt,")*(",gt,")-(",dt,")*(",pt,")+(",mt,")*(",pt,")-(",ht,")*(",mt,")+(",ht,")*(",ft,")-(",gt,")*(",ft,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=_e.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=_e.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(ut,ht){return this.visProp.straightfirst=ut,this.visProp.straightlast=ht,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new at(st.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(ut){ot.exists(this.label)&&(this.label.relativeCoords=new at(st.COORDS_BY_SCREEN,[ut[0],-ut[1]],this.board))},getLabelAnchor:function(){var ut,ht,dt=0,pt=new at(st.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),ft=new at(st.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),gt=ot.evaluate(this.visProp.straightfirst),mt=ot.evaluate(this.visProp.straightlast);if((gt||mt)&&rt.calcStraight(this,pt,ft,0),pt=pt.scrCoords,ft=ft.scrCoords,!ot.exists(this.label))return new at(st.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(ot.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":pt[1]<=ft[1]?(ut=pt[1],ht=pt[2]):(ut=ft[1],ht=ft[2]);break;case"rt":case"lrt":case"urt":pt[1]>ft[1]?(ut=pt[1],ht=pt[2]):(ut=ft[1],ht=ft[2]);break;default:ut=.5*(pt[1]+ft[1]),ht=.5*(pt[2]+ft[2])}return(gt||mt)&&(ot.exists(this.label)&&(dt=ot.evaluate(this.label.visProp.fontsize)),Math.abs(ut)<_e.eps?ut=dt+0:this.board.canvasWidth+_e.eps>ut&&ut>this.board.canvasWidth-dt-_e.eps&&(ut=this.board.canvasWidth-dt),_e.eps+dt>ht&&ht>-_e.eps?ht=dt:this.board.canvasHeight+_e.eps>ht&&ht>this.board.canvasHeight-dt-_e.eps&&(ht=this.board.canvasHeight-dt)),new at(st.COORDS_BY_SCREEN,[ut,ht],this.board)},cloneToBackground:function(){var ut,ht,dt,pt={};return pt.id=this.id+"T"+this.numTraces,pt.elementClass=st.OBJECT_CLASS_LINE,this.numTraces++,pt.point1=this.point1,pt.point2=this.point2,pt.stdform=this.stdform,pt.board=this.board,pt.visProp=ot.deepCopy(this.visProp,this.visProp.traceattributes,!0),pt.visProp.layer=this.board.options.layer.trace,ot.clearVisPropOld(pt),pt.visPropCalc={visible:ot.evaluate(pt.visProp.visible)},ht=this.getSlope(),ut=this.getRise(),pt.getSlope=function(){return ht},pt.getRise=function(){return ut},dt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(pt),this.board.renderer.enhancedRendering=dt,this.traces[pt.id]=pt.rendNode,this},addTransform:function(ut){var ht,dt=ot.isArray(ut)?ut:[ut],pt=dt.length;for(ht=0;ht<pt;ht++)this.point1.transformations.push(dt[ht]),this.point2.transformations.push(dt[ht]);return this},snapToGrid:function(ut){var ht,dt,pt,ft,gt,mt,At,yt,bt;return ot.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):ot.exists(ut)&&(yt=ot.evaluate(this.visProp.snapsizex),bt=ot.evaluate(this.visProp.snapsizey),ht=new at(st.COORDS_BY_SCREEN,[ut.Xprev,ut.Yprev],this.board),mt=ht.usrCoords[1],At=ht.usrCoords[2],yt<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(gt=this.board.defaultAxes.x.defaultTicks,yt=gt.ticksDelta*(ot.evaluate(gt.visProp.minorticks)+1)),bt<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(gt=this.board.defaultAxes.y.defaultTicks,bt=gt.ticksDelta*(ot.evaluate(gt.visProp.minorticks)+1)),yt>0&&bt>0&&(dt=rt.projectPointToLine({coords:ht},this,this.board),pt=nt.subtract([1,Math.round(mt/yt)*yt,Math.round(At/bt)*bt],dt.usrCoords),ft=this.board.create("transform",pt.slice(1),{type:"translate"}),ft.applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var ut=ot.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(ut),this.point2.handleSnapToPoints(ut)),this},X:function(ut){var ht,dt=this.stdform[2];return ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],ut=2*(ut-.5),(1-Math.abs(ut))*ht-ut*dt},Y:function(ut){var ht,dt=this.stdform[1];return ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],ut=2*(ut-.5),(1-Math.abs(ut))*ht+ut*dt},Z:function(ut){var ht=Math.abs(this.point1.coords.usrCoords[0])>_e.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return ut=2*(ut-.5),(1-Math.abs(ut))*ht},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var ut=this.point1.coords.usrCoords,ht=this.point2.coords.usrCoords;return[Math.min(ut[1],ht[1]),Math.max(ut[2],ht[2]),Math.max(ut[1],ht[1]),Math.min(ut[2],ht[2])]},addTicks:function(ut){return ut.id!==""&&ot.exists(ut.id)||(ut.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(ut),this.ticks.push(ut),ut.id},remove:function(){this.removeAllTicks(),lt.prototype.remove.call(this)},removeAllTicks:function(){var ut;for(ut=this.ticks.length;ut>0;ut--)this.removeTicks(this.ticks[ut-1]);this.ticks=[],this.board.update()},removeTicks:function(ut){var ht,dt;for(ot.exists(this.defaultTicks)&&this.defaultTicks===ut&&(this.defaultTicks=null),ht=this.ticks.length;ht>0;ht--)if(this.ticks[ht-1]===ut){if(this.board.removeObject(this.ticks[ht-1]),this.ticks[ht-1].ticks)for(dt=0;dt<this.ticks[ht-1].ticks.length;dt++)ot.exists(this.ticks[ht-1].labels[dt])&&this.board.removeObject(this.ticks[ht-1].labels[dt]);delete this.ticks[ht-1];break}}}),tt.createLine=function(ut,ht,dt){var pt,ft,gt,mt,At,yt,bt,xt=[],vt=!1,_t=!1;if(ht.length===2){if(ot.isArray(ht[0])&&ht[0].length>1)yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=ut.create("point",ht[0],yt);else if(ot.isString(ht[0])||ot.isPoint(ht[0]))gt=ut.select(ht[0]);else if(ot.isFunction(ht[0])&&ot.isPoint(ht[0]()))gt=ht[0](),_t=!0;else if(ot.isFunction(ht[0])&&ht[0]().length&&ht[0]().length>=2)yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=ct.createPoint(ut,ht[0](),yt),_t=!0;else{if(!ot.isObject(ht[0])||!ot.isTransformationOrArray(ht[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);vt=!0,yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=ut.create("point",[ht[0].point1,ht[1]],yt)}if(vt)yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=ut.create("point",[ht[0].point2,ht[1]],yt);else if(ot.isArray(ht[1])&&ht[1].length>1)yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=ut.create("point",ht[1],yt);else if(ot.isString(ht[1])||ot.isPoint(ht[1]))mt=ut.select(ht[1]);else if(ot.isFunction(ht[1])&&ot.isPoint(ht[1]()))mt=ht[1](),_t=!0;else{if(!(ot.isFunction(ht[1])&&ht[1]().length&&ht[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=ct.createPoint(ut,ht[1](),yt),_t=!0}yt=ot.copyAttributes(dt,ut.options,"line"),ft=new tt.Line(ut,gt,mt,yt),_t?(ft.constrained=!0,ft.funp1=ht[0],ft.funp2=ht[1]):vt||(ft.isDraggable=!0),ft.setParents([gt.id,mt.id])}else if(ht.length===3){for(bt=!0,At=0;At<3;At++)if(ot.isNumber(ht[At]))xt[At]=ot.createFunction(ht[At]);else{if(!ot.isFunction(ht[At]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+"' and '"+typeof ht[2]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);xt[At]=ht[At],bt=!1}yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=bt?ut.create("point",[xt[2]()*xt[2]()+xt[1]()*xt[1](),xt[2]()-xt[1]()*xt[0]()+xt[2](),-xt[1]()-xt[2]()*xt[0]()-xt[1]()],yt):ut.create("point",[function(){return .5*(xt[2]()*xt[2]()+xt[1]()*xt[1]())},function(){return .5*(xt[2]()-xt[1]()*xt[0]()+xt[2]())},function(){return .5*(-xt[1]()-xt[2]()*xt[0]()-xt[1]())}],yt),yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=bt?ut.create("point",[xt[2]()*xt[2]()+xt[1]()*xt[1](),-xt[1]()*xt[0]()+xt[2](),-xt[2]()*xt[0]()-xt[1]()],yt):ut.create("point",[function(){return xt[2]()*xt[2]()+xt[1]()*xt[1]()},function(){return-xt[1]()*xt[0]()+xt[2]()},function(){return-xt[2]()*xt[0]()-xt[1]()}],yt),gt.prepareUpdate().update(),mt.prepareUpdate().update(),yt=ot.copyAttributes(dt,ut.options,"line"),ft=new tt.Line(ut,gt,mt,yt),ft.isDraggable=bt,ft.setParents([gt,mt])}else if(ht.length===1&&ot.isFunction(ht[0])&&ht[0]().length===2&&ot.isPoint(ht[0]()[0])&&ot.isPoint(ht[0]()[1]))pt=ht[0](),yt=ot.copyAttributes(dt,ut.options,"line"),ft=new tt.Line(ut,pt[0],pt[1],yt),ft.constrained=!0,ft.funps=ht[0],ft.setParents(pt);else{if(!(ht.length===1&&ot.isFunction(ht[0])&&ht[0]().length===3&&ot.isNumber(ht[0]()[0])&&ot.isNumber(ht[0]()[1])&&ot.isNumber(ht[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);pt=ht[0],yt=ot.copyAttributes(dt,ut.options,"line","point1"),gt=ut.create("point",[function(){var Ct=pt();return[.5*(Ct[2]*Ct[2]+Ct[1]*Ct[1]),.5*(Ct[2]-Ct[1]*Ct[0]+Ct[2]),.5*(-Ct[1]-Ct[2]*Ct[0]-Ct[1])]}],yt),yt=ot.copyAttributes(dt,ut.options,"line","point2"),mt=ut.create("point",[function(){var Ct=pt();return[Ct[2]*Ct[2]+Ct[1]*Ct[1],-Ct[1]*Ct[0]+Ct[2],-Ct[2]*Ct[0]-Ct[1]]}],yt),yt=ot.copyAttributes(dt,ut.options,"line"),ft=new tt.Line(ut,gt,mt,yt),ft.constrained=!0,ft.funps=ht[0],ft.setParents([gt,mt])}return ft},tt.registerElement("line",tt.createLine),tt.createSegment=function(ut,ht,dt){var pt,ft;if(dt.straightFirst=!1,dt.straightLast=!1,ft=ot.copyAttributes(dt,ut.options,"segment"),pt=ut.create("line",ht.slice(0,2),ft),ht.length===3){if(pt.hasFixedLength=!0,ot.isNumber(ht[2]))pt.fixedLength=function(){return ht[2]};else{if(!ot.isFunction(ht[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof ht[2]+`'.
Possible third parent types: number or function`);pt.fixedLength=ht[2]}pt.getParents=function(){return this.parents.concat(this.fixedLength())},pt.fixedLengthOldCoords=[],pt.fixedLengthOldCoords[0]=new at(st.COORDS_BY_USER,pt.point1.coords.usrCoords.slice(1,3),ut),pt.fixedLengthOldCoords[1]=new at(st.COORDS_BY_USER,pt.point2.coords.usrCoords.slice(1,3),ut)}return pt.elType="segment",pt},tt.registerElement("segment",tt.createSegment),tt.createArrow=function(ut,ht,dt){var pt;return dt.firstArrow=!1,dt.lastArrow=!0,pt=ut.create("line",ht,dt).setStraight(!1,!1),pt.type=st.OBJECT_TYPE_VECTOR,pt.elType="arrow",pt},tt.registerElement("arrow",tt.createArrow),tt.createAxis=function(ut,ht,dt){var pt,ft,gt,mt,At;if(!ot.isArray(ht[0])&&!ot.isPoint(ht[0])||!ot.isArray(ht[1])&&!ot.isPoint(ht[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);pt=ot.copyAttributes(dt,ut.options,"axis"),gt=ut.create("line",ht,pt),gt.type=st.OBJECT_TYPE_AXIS,gt.isDraggable=!1,gt.point1.isDraggable=!1,gt.point2.isDraggable=!1;for(mt in gt.ancestors)gt.ancestors.hasOwnProperty(mt)&&(gt.ancestors[mt].type=st.OBJECT_TYPE_AXISPOINT);return ft=ot.copyAttributes(dt,ut.options,"axis","ticks"),At=ot.exists(ft.ticksdistance)?ft.ticksdistance:ot.isArray(ft.ticks)?ft.ticks:1,gt.defaultTicks=ut.create("ticks",[gt,At],ft),gt.defaultTicks.dump=!1,gt.elType="axis",gt.subs={ticks:gt.defaultTicks},gt.inherits.push(gt.defaultTicks),gt},tt.registerElement("axis",tt.createAxis),tt.createTangent=function(ut,ht,dt){var pt,ft,gt,mt,At,yt,bt;if(ht.length===1)pt=ht[0],ft=pt.slideObject;else{if(ht.length!==2)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);if(ot.isPoint(ht[0]))pt=ht[0],ft=ht[1];else{if(!ot.isPoint(ht[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);ft=ht[0],pt=ht[1]}}if(ft.elementClass===st.OBJECT_CLASS_LINE?(bt=ut.create("line",[ft.point1,ft.point2],dt),bt.glider=pt):ft.elementClass===st.OBJECT_CLASS_CURVE&&ft.type!==st.OBJECT_TYPE_CONIC?ot.evaluate(ft.visProp.curvetype)!=="plot"?(gt=ft.X,mt=ft.Y,bt=ut.create("line",[function(){return-pt.X()*it.D(mt)(pt.position)+pt.Y()*it.D(gt)(pt.position)},function(){return it.D(mt)(pt.position)},function(){return-it.D(gt)(pt.position)}],dt),pt.addChild(bt),bt.glider=pt):(bt=ut.create("line",[function(){var xt,vt,_t=Math.floor(pt.position);return _t===ft.numberPoints-1&&_t--,_t<0?1:(xt=ft.points[_t].usrCoords,vt=ft.points[_t+1].usrCoords,xt[2]*vt[1]-xt[1]*vt[2])},function(){var xt,vt,_t=Math.floor(pt.position);return _t===ft.numberPoints-1&&_t--,_t<0?0:(xt=ft.points[_t].usrCoords,vt=ft.points[_t+1].usrCoords,vt[2]-xt[2])},function(){var xt,vt,_t=Math.floor(pt.position);return _t===ft.numberPoints-1&&_t--,_t<0?0:(xt=ft.points[_t].usrCoords,vt=ft.points[_t+1].usrCoords,xt[1]-vt[1])}],dt),pt.addChild(bt),bt.glider=pt):ft.type===st.OBJECT_TYPE_TURTLE?(bt=ut.create("line",[function(){var xt=Math.floor(pt.position);for(At=0;At<ft.objects.length;At++)if(yt=ft.objects[At],yt.type===st.OBJECT_TYPE_CURVE){if(xt<yt.numberPoints)break;xt-=yt.numberPoints}return xt===yt.numberPoints-1&&xt--,xt<0?1:yt.Y(xt)*yt.X(xt+1)-yt.X(xt)*yt.Y(xt+1)},function(){var xt=Math.floor(pt.position);for(At=0;At<ft.objects.length;At++)if(yt=ft.objects[At],yt.type===st.OBJECT_TYPE_CURVE){if(xt<yt.numberPoints)break;xt-=yt.numberPoints}return xt===yt.numberPoints-1&&xt--,xt<0?0:yt.Y(xt+1)-yt.Y(xt)},function(){var xt=Math.floor(pt.position);for(At=0;At<ft.objects.length;At++)if(yt=ft.objects[At],yt.type===st.OBJECT_TYPE_CURVE){if(xt<yt.numberPoints)break;xt-=yt.numberPoints}return xt===yt.numberPoints-1&&xt--,xt<0?0:yt.X(xt)-yt.X(xt+1)}],dt),pt.addChild(bt),bt.glider=pt):ft.elementClass!==st.OBJECT_CLASS_CIRCLE&&ft.type!==st.OBJECT_TYPE_CONIC||(bt=ut.create("line",[function(){return _e.matVecMult(ft.quadraticform,pt.coords.usrCoords)[0]},function(){return _e.matVecMult(ft.quadraticform,pt.coords.usrCoords)[1]},function(){return _e.matVecMult(ft.quadraticform,pt.coords.usrCoords)[2]}],dt),pt.addChild(bt),bt.glider=pt),!ot.exists(bt))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return bt.elType="tangent",bt.type=st.OBJECT_TYPE_TANGENT,bt.setParents(ht),bt},tt.createRadicalAxis=function(ut,ht,dt){var pt,ft,gt;if(ht.length!==2||ht[0].elementClass!==st.OBJECT_CLASS_CIRCLE||ht[1].elementClass!==st.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent type: [circle,circle]`);return ft=ut.select(ht[0]),gt=ut.select(ht[1]),pt=ut.create("line",[function(){var mt=ft.stdform,At=gt.stdform;return _e.matVecMult(_e.transpose([mt.slice(0,3),At.slice(0,3)]),[At[3],-mt[3]])}],dt),pt.elType="radicalaxis",pt.setParents([ft.id,gt.id]),ft.addChild(pt),gt.addChild(pt),pt},tt.createPolarLine=function(ut,ht,dt){var pt,ft,gt,mt,At,yt,bt;if(ht.length>1&&(mt=ht[0].type===st.OBJECT_TYPE_CONIC||ht[0].elementClass===st.OBJECT_CLASS_CIRCLE,At=ht[1].type===st.OBJECT_TYPE_CONIC||ht[1].elementClass===st.OBJECT_CLASS_CIRCLE,yt=ot.isPoint(ht[0]),bt=ot.isPoint(ht[1])),ht.length!==2||!(mt&&bt||yt&&At))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof ht[0]+"' and '"+typeof ht[1]+`'.
Possible parent type: [conic|circle,point], [point,conic|circle]`);return bt?(ft=ut.select(ht[0]),gt=ut.select(ht[1])):(ft=ut.select(ht[1]),gt=ut.select(ht[0])),pt=ut.create("tangent",[ft,gt],dt),pt.elType="polarline",pt},tt.registerElement("tangent",tt.createTangent),tt.registerElement("polar",tt.createTangent),tt.registerElement("radicalaxis",tt.createRadicalAxis),tt.registerElement("polarline",tt.createPolarLine),{Line:tt.Line,createLine:tt.createLine,createTangent:tt.createTangent,createPolar:tt.createTangent,createSegment:tt.createSegment,createAxis:tt.createAxis,createArrow:tt.createArrow,createRadicalAxis:tt.createRadicalAxis,createPolarLine:tt.createPolarLine}}),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","math/numerics","math/geometry","parser/geonext","utils/type","base/transformation","math/qdt"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht){return tt.Curve=function(dt,pt,ft){this.constructor(dt,ft,_e.OBJECT_TYPE_CURVE,_e.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=ct.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.qdt=null,ct.exists(pt[0])?this.varname=pt[0]:this.varname="x",this.xterm=pt[1],this.yterm=pt[2],this.generateTerm(this.varname,this.xterm,this.yterm,pt[3],pt[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),ct.isString(this.xterm)&&this.notifyParents(this.xterm),ct.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=ct.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},tt.Curve.prototype=new it,tt.extend(tt.Curve.prototype,{minX:function(){var dt;return ct.evaluate(this.visProp.curvetype)==="polar"?0:(dt=new rt(_e.COORDS_BY_SCREEN,[0,0],this.board,!1),dt.usrCoords[1])},maxX:function(){var dt;return ct.evaluate(this.visProp.curvetype)==="polar"?2*Math.PI:(dt=new rt(_e.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board,!1),dt.usrCoords[1])},X:function(dt){return NaN},Y:function(dt){return NaN},Z:function(dt){return 1},hasPoint:function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt=[],It=ct.evaluate(this.visProp.numberpointslow),Ot=(this.maxX()-this.minX())/It,Bt=this.board.options.precision.hasPoint,Nt=1/0;if(mt=new rt(_e.COORDS_BY_SCREEN,[dt,pt],this.board,!1),dt=mt.usrCoords[1],pt=mt.usrCoords[2],Bt+=.5*ct.evaluate(this.visProp.strokewidth),Bt*=Bt,Et=this.board.unitX*this.board.unitX,Tt=this.board.unitY*this.board.unitY,(Mt=ct.evaluate(this.visProp.curvetype))==="parameter"||Mt==="polar")for(this.transformations.length>0&&(this.updateTransformMatrix(),yt=nt.inverse(this.transformMat),bt=nt.matVecMult(yt,[1,dt,pt]),dt=bt[1],pt=bt[2]),xt=0,gt=this.minX();xt<It;xt++){if(vt=this.X(gt,!0),_t=this.Y(gt,!0),(Nt=(dt-vt)*(dt-vt)*Et+(pt-_t)*(pt-_t)*Tt)<=Bt)return!0;gt+=Ot}else if(Mt==="plot"||Mt==="functiongraph"){for((!ct.exists(ft)||ft<0)&&(ft=0),ct.exists(this.qdt)&&ct.evaluate(this.visProp.useqdt)&&this.bezierDegree!==3?(St=this.qdt.query(new rt(_e.COORDS_BY_USER,[dt,pt],this.board)),Ct=St.points,At=Ct.length):(Ct=this.points,At=this.numberPoints-1),xt=ft;xt<At;xt++)if(this.bezierDegree===3?Rt.push(lt.projectCoordsToBeziersegment([1,dt,pt],this,xt)):St?(Ct[xt].prev&&(Rt=lt.projectCoordsToSegment([1,dt,pt],Ct[xt].prev.usrCoords,Ct[xt].usrCoords)),Ct[xt].next&&Ct[xt+1]!==Ct[xt].next&&(Rt=lt.projectCoordsToSegment([1,dt,pt],Ct[xt].usrCoords,Ct[xt].next.usrCoords))):Rt=lt.projectCoordsToSegment([1,dt,pt],Ct[xt].usrCoords,Ct[xt+1].usrCoords),Rt[1]>=0&&Rt[1]<=1&&(dt-Rt[0][1])*(dt-Rt[0][1])*Et+(pt-Rt[0][2])*(pt-Rt[0][2])*Tt<=Bt)return!0;return!1}return Nt<Bt},allocatePoints:function(){var dt,pt;if(pt=this.numberPoints,this.points.length<this.numberPoints)for(dt=this.points.length;dt<pt;dt++)this.points[dt]=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(ct.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.checkReal(),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var dt,pt,ft,gt,mt,At,yt=!1;if(this.updateTransformMatrix(),this.updateDataArray(),pt=this.minX(),ft=this.maxX(),ct.exists(this.dataX))for(this.numberPoints=this.dataX.length,dt=this.numberPoints,this.allocatePoints(),At=0;At<dt;At++)gt=At,ct.exists(this.dataY)?(mt=At,this.points[At].setCoordinates(_e.COORDS_BY_USER,[this.dataX[At],this.dataY[At]],!1)):(mt=this.X(gt),this.points[At].setCoordinates(_e.COORDS_BY_USER,[this.dataX[At],this.Y(mt,yt)],!1)),this.points[At]._t=At,this.updateTransform(this.points[At]),yt=!0;else{if(ct.evaluate(this.visProp.doadvancedplot)?this.updateParametricCurve(pt,ft):ct.evaluate(this.visProp.doadvancedplotold)?this.updateParametricCurveOld(pt,ft):(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.numberPoints=ct.evaluate(this.visProp.numberpointshigh):this.numberPoints=ct.evaluate(this.visProp.numberpointslow),this.allocatePoints(),this.updateParametricCurveNaive(pt,ft,this.numberPoints)),dt=this.numberPoints,ct.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new ht(this.board.getBoundingBox()),At=0;At<this.points.length;At++)this.qdt.insert(this.points[At]),At>0&&(this.points[At].prev=this.points[At-1]),At<dt-1&&(this.points[At].next=this.points[At+1]);for(At=0;At<dt;At++)this.updateTransform(this.points[At])}return ct.evaluate(this.visProp.curvetype)!=="plot"&&ct.evaluate(this.visProp.rdpsmoothing)&&(this.points=at.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),this},updateTransformMatrix:function(){var dt,pt,ft=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],pt=0;pt<ft;pt++)dt=this.transformations[pt],dt.update(),this.transformMat=nt.matMatMult(dt.matrix,this.transformMat);return this},checkReal:function(){var dt,pt,ft=!1,gt=this.numberPoints;for(dt=0;dt<gt;dt++)if(pt=this.points[dt].usrCoords,!isNaN(pt[1])&&!isNaN(pt[2])&&Math.abs(pt[0])>nt.eps){ft=!0;break}this.isReal=ft},updateParametricCurveNaive:function(dt,pt,ft){var gt,mt,At=!1,yt=(pt-dt)/ft;for(gt=0;gt<ft;gt++)mt=dt+gt*yt,this.points[gt].setCoordinates(_e.COORDS_BY_USER,[this.X(mt,At),this.Y(mt,At)],!1),this.points[gt]._t=mt,At=!0;return this},updateParametricCurveOld:function(dt,pt){var ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et=!1,Tt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),Mt=[],Rt=[],It=[],Ot=[],Bt=!1,Nt=0;for(tt.deprecated("Curve.updateParametricCurveOld()"),this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(_t=15,Ct=10,St=10):(_t=21,Ct=.7,St=.7),Ot[0]=pt-dt,ft=1;ft<_t;ft++)Ot[ft]=.5*Ot[ft-1];ft=1,Mt[0]=1,Rt[0]=0,gt=dt,Tt.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,Et),this.Y(gt,Et)],!1),Et=!0,yt=Tt.scrCoords[1],bt=Tt.scrCoords[2],t0=gt,gt=pt,Tt.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,Et),this.Y(gt,Et)],!1),mt=Tt.scrCoords[1],At=Tt.scrCoords[2],It[0]=[mt,At],xt=1,vt=0,this.points=[],this.points[Nt++]=new rt(_e.COORDS_BY_SCREEN,[yt,bt],this.board,!1);do{for(Bt=this.isDistOK(mt-yt,At-bt,Ct,St)||this.isSegmentOutside(yt,bt,mt,At);vt<_t&&(!Bt||vt<6)&&(vt<=7||this.isSegmentDefined(yt,bt,mt,At));)Mt[xt]=ft,Rt[xt]=vt,It[xt]=[mt,At],xt+=1,ft=2*ft-1,vt++,gt=dt+ft*Ot[vt],Tt.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,Et),this.Y(gt,Et)],!1,!0),mt=Tt.scrCoords[1],At=Tt.scrCoords[2],Bt=this.isDistOK(mt-yt,At-bt,Ct,St)||this.isSegmentOutside(yt,bt,mt,At);Nt>1&&function(zt,Dt,Ft){var Ut,$t,Vt=Ft[1]-zt[1],Zt=Ft[2]-zt[2],qt=Dt[0]-zt[1],sr=Dt[1]-zt[2],er=qt*qt+sr*sr;return er>=nt.eps&&(Ut=(Vt*qt+Zt*sr)/er)>0&&(Ut<=1?(Vt-=Ut*qt,Zt-=Ut*sr):(Vt-=qt,Zt-=sr)),$t=Vt*Vt+Zt*Zt,Math.sqrt($t)}(this.points[Nt-2].scrCoords,[mt,At],this.points[Nt-1].scrCoords)<.015&&(Nt-=1),this.points[Nt]=new rt(_e.COORDS_BY_SCREEN,[mt,At],this.board,!1),this.points[Nt]._t=gt,Nt+=1,yt=mt,bt=At,t0=gt,xt-=1,mt=It[xt][0],At=It[xt][1],vt=Rt[xt]+1,ft=2*Mt[xt]}while(xt>0&&Nt<5e5);return this.numberPoints=this.points.length,this},isSegmentOutside:function(dt,pt,ft,gt){return pt<0&&gt<0||pt>this.board.canvasHeight&&gt>this.board.canvasHeight||dt<0&&ft<0||dt>this.board.canvasWidth&&ft>this.board.canvasWidth},isDistOK:function(dt,pt,ft,gt){return Math.abs(dt)<ft&&Math.abs(pt)<gt&&!isNaN(dt+pt)},isSegmentDefined:function(dt,pt,ft,gt){return!(isNaN(dt+pt)&&isNaN(ft+gt))},_insertPoint:function(dt,pt){var ft=!isNaN(this._lastCrds[1]+this._lastCrds[2]),gt=!isNaN(dt.scrCoords[1]+dt.scrCoords[2]),mt=this.board.canvasWidth,At=this.board.canvasHeight;(!(gt=gt&&dt.scrCoords[1]>-500&&dt.scrCoords[2]>-500&&dt.scrCoords[1]<mt+500&&dt.scrCoords[2]<At+500)&&ft||gt&&(!ft||Math.abs(dt.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(dt.scrCoords[2]-this._lastCrds[2])>.7))&&(dt._t=pt,this.points.push(dt),this._lastCrds=dt.copy("scrCoords"))},_intersectWithBorder:function(dt,pt,ft){var gt,mt,At,yt;return ft<=0?(gt=[-pt[0],1,0],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):yt=1/0,yt<pt[3]?(gt=[-pt[3],0,1],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):At=1/0):yt>pt[1]&&(gt=[-pt[1],0,1],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):At=1/0)):(gt=[-pt[2],1,0],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):yt=1/0,yt<pt[3]?(gt=[-pt[3],0,1],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):At=1/0):yt>pt[1]&&(gt=[-pt[1],0,1],mt=nt.crossProduct(gt,dt),mt[0]!==0?(At=mt[1]/mt[0],yt=mt[2]/mt[0]):At=1/0)),[1,At,yt]},_borderCase:function(dt,pt,ft,gt,mt,At,yt){var bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt=null,Ft=!1;if(yt<=1){xt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),_t=0;do{if(isNaN(dt[1]+dt[2])&&!isNaN(ft[1]+ft[2]))Ct=gt,St=At,Et=mt;else if(isNaN(pt[1]+pt[2])&&!isNaN(ft[1]+ft[2]))Ct=mt,St=At,Et=gt;else if(isNaN(ft[1]+ft[2])&&!isNaN(pt[1]+pt[2]))Ct=At,St=mt,Et=mt+(mt-At);else{if(!isNaN(ft[1]+ft[2])||isNaN(dt[1]+dt[2]))return!1;Ct=At,St=gt,Et=gt-(At-gt)}bt=.5*(Ct+St),xt.setCoordinates(_e.COORDS_BY_USER,[this.X(bt,!0),this.Y(bt,!0)],!1),vt=xt.usrCoords,Ft=isNaN(vt[1]+vt[2]),Ft?Ct=bt:(Et=St,St=bt),++_t}while(Ft&&_t<30);if(_t<30&&(Dt=vt.slice(),ft=vt.slice(),St=bt),Mt=this.X(St,!0),It=this.X(Et,!0),Bt=(Mt-It)/(St-Et),Rt=this.Y(St,!0),Ot=this.Y(Et,!0),Nt=(Rt-Ot)/(St-Et),Tt=this.board.getBoundingBox(),Math.sqrt(Bt*Bt+Nt*Nt)>500&&(zt=[Bt*Rt-Nt*Mt,Nt,-Bt],Dt=this._intersectWithBorder(zt,Tt,Mt-It)),Dt!==null)return this._insertPoint(new rt(_e.COORDS_BY_USER,Dt,this.board,!1)),!0}return!1},_triangleDists:function(dt,pt,ft){var gt,mt,At,yt,bt;return gt=[dt[0]*pt[0],.5*(dt[1]+pt[1]),.5*(dt[2]+pt[2])],mt=lt.distance(dt,pt,3),At=lt.distance(dt,ft,3),yt=lt.distance(ft,pt,3),bt=lt.distance(ft,gt,3),[mt,At,yt,bt]},_isUndefined:function(dt,pt,ft,gt){var mt,At,yt;if(!isNaN(dt[1]+dt[2])||!isNaN(ft[1]+ft[2]))return!1;for(yt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),At=0;At<20;++At)if(mt=pt+Math.random()*(gt-pt),yt.setCoordinates(_e.COORDS_BY_USER,[this.X(mt,!0),this.Y(mt,!0)],!1),!isNaN(yt.scrCoords[0]+yt.scrCoords[1]+yt.scrCoords[2]))return!1;return!0},_isOutside:function(dt,pt,ft,gt){var mt=this.board.canvasWidth,At=this.board.canvasHeight;return dt[1]<-500&&ft[1]<-500||dt[2]<-500&&ft[2]<-500||dt[1]>mt+500&&ft[1]>mt+500||dt[2]>At+500&&ft[2]>At+500},_plotRecursive:function(dt,pt,ft,gt,mt,At){var yt,bt,xt,vt,_t,Ct,St=0,Et=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1);if(!(this.numberPoints>65536))return mt<this.nanLevel&&this._isUndefined(dt,pt,ft,gt)?this:mt<this.nanLevel&&this._isOutside(dt,pt,ft,gt)?this:(yt=.5*(pt+gt),Et.setCoordinates(_e.COORDS_BY_USER,[this.X(yt,!0),this.Y(yt,!0)],!1),bt=Et.scrCoords,this._borderCase(dt,ft,bt,pt,gt,yt,mt)?this:(xt=this._triangleDists(dt,ft,bt),vt=mt<this.smoothLevel&&xt[3]<At,_t=mt<this.jumpLevel&&(xt[2]>.99*xt[0]||xt[1]>.99*xt[0]||xt[0]===1/0||xt[1]===1/0||xt[2]===1/0),Ct=mt<this.smoothLevel+2&&xt[0]<.5*(xt[1]+xt[2]),Ct&&(St=0,vt=!1),--mt,_t?this._insertPoint(new rt(_e.COORDS_BY_SCREEN,[NaN,NaN],this.board,!1),yt):mt<=St||vt?this._insertPoint(Et,yt):(this._plotRecursive(dt,pt,bt,yt,mt,At),this._insertPoint(Et,yt),this._plotRecursive(bt,yt,ft,gt,mt,At)),this))},updateParametricCurve:function(dt,pt){var ft,gt,mt,At,yt,bt,xt=!1,vt=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1),_t=new rt(_e.COORDS_BY_USER,[0,0],this.board,!1);return this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(yt=ct.evaluate(this.visProp.recursiondepthlow)||13,bt=2,this.smoothLevel=5,this.jumpLevel=5):(yt=ct.evaluate(this.visProp.recursiondepthhigh)||17,bt=2,this.smoothLevel=3,this.jumpLevel=3),this.nanLevel=yt-4,this.points=[],ft=dt,vt.setCoordinates(_e.COORDS_BY_USER,[this.X(ft,xt),this.Y(ft,xt)],!1),mt=vt.copy("scrCoords"),xt=!0,gt=pt,_t.setCoordinates(_e.COORDS_BY_USER,[this.X(gt,xt),this.Y(gt,xt)],!1),At=_t.copy("scrCoords"),vt._t=ft,this.points.push(vt),this._lastCrds=vt.copy("scrCoords"),this._plotRecursive(mt,ft,At,gt,yt,bt),_t._t=gt,this.points.push(_t),this.numberPoints=this.points.length,this},updateTransform:function(dt){var pt;return this.transformations.length>0&&(pt=nt.matVecMult(this.transformMat,dt.usrCoords),dt.setCoordinates(_e.COORDS_BY_USER,[pt[1],pt[2]],!1,!0)),dt},addTransform:function(dt){var pt,ft=ct.isArray(dt)?dt:[dt],gt=ft.length;for(pt=0;pt<gt;pt++)this.transformations.push(ft[pt]);return this},interpolationFunctionFromArray:function(dt){var pt="data"+dt;return function(ft,gt){var mt,At,yt,bt,xt=this[pt],vt=xt.length,_t=[];if(isNaN(ft))return NaN;if(ft<0)return ct.isFunction(xt[0])?xt[0]():xt[0];if(this.bezierDegree===3){if(vt/=3,ft>=vt)return ct.isFunction(xt[xt.length-1])?xt[xt.length-1]():xt[xt.length-1];for(mt=3*Math.floor(ft),yt=ft%1,bt=1-yt,At=0;At<4;At++)ct.isFunction(xt[mt+At])?_t[At]=xt[mt+At]():_t[At]=xt[mt+At];return bt*bt*(bt*_t[0]+3*yt*_t[1])+(3*bt*_t[2]+yt*_t[3])*yt*yt}if((mt=ft>vt-2?vt-2:parseInt(Math.floor(ft),10))===ft)return ct.isFunction(xt[mt])?xt[mt]():xt[mt];for(At=0;At<2;At++)ct.isFunction(xt[mt+At])?_t[At]=xt[mt+At]():_t[At]=xt[mt+At];return _t[0]+(_t[1]-_t[0])*(ft-mt)}},generateTerm:function(dt,pt,ft,gt,mt){var At,yt;ct.isArray(pt)?(this.dataX=pt,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray("X"),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=ct.createFunction(pt,this.board,dt),ct.isString(pt)?this.visProp.curvetype="functiongraph":(ct.isFunction(pt)||ct.isNumber(pt))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),ct.isArray(ft)?(this.dataY=ft,this.Y=this.interpolationFunctionFromArray("Y")):this.Y=ct.createFunction(ft,this.board,dt),ct.isFunction(pt)&&ct.isArray(ft)&&(At=ct.createFunction(ft[0],this.board,""),yt=ct.createFunction(ft[1],this.board,""),this.X=function(bt){return pt(bt)*Math.cos(bt)+At()},this.Y=function(bt){return pt(bt)*Math.sin(bt)+yt()},this.visProp.curvetype="polar"),ct.exists(gt)&&(this.minX=ct.createFunction(gt,this.board,"")),ct.exists(mt)&&(this.maxX=ct.createFunction(mt,this.board,""))},notifyParents:function(dt){var pt,ft,gt,mt=!1;gt={xterm:1,yterm:1};for(pt in gt)if(gt.hasOwnProperty(pt)&&this.hasOwnProperty(pt)&&this[pt].origin){mt=!0;for(ft in this[pt].origin.deps)this[pt].origin.deps.hasOwnProperty(ft)&&this[pt].origin.deps[ft].addChild(this)}mt||ot.findDependencies(this,dt,this.board)},getLabelAnchor:function(){var dt,pt,ft,gt=.05*this.board.canvasWidth,mt=.05*this.board.canvasHeight,At=.95*this.board.canvasWidth,yt=.95*this.board.canvasHeight;switch(ct.evaluate(this.visProp.label.position)){case"ulft":pt=gt,ft=mt;break;case"llft":pt=gt,ft=yt;break;case"rt":pt=At,ft=.5*yt;break;case"lrt":pt=At,ft=yt;break;case"urt":pt=At,ft=mt;break;case"top":pt=.5*At,ft=mt;break;case"bot":pt=.5*At,ft=yt;break;default:pt=gt,ft=.5*yt}return dt=new rt(_e.COORDS_BY_SCREEN,[pt,ft],this.board,!1),lt.projectCoordsToCurve(dt.usrCoords[1],dt.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var dt,pt={id:this.id+"T"+this.numTraces,elementClass:_e.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:ct.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return pt.visProp.layer=this.board.options.layer.trace,pt.visProp.curvetype=this.visProp.curvetype,this.numTraces++,ct.clearVisPropOld(pt),pt.visPropCalc={visible:ct.evaluate(pt.visProp.visible)},dt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(pt),this.board.renderer.enhancedRendering=dt,this.traces[pt.id]=pt.rendNode,this},bounds:function(){var dt,pt,ft,gt=1/0,mt=-1/0,At=1/0,yt=-1/0,bt=this.points.length;if(this.bezierDegree===3){for(dt=0;dt<bt;dt++)this.points[dt].X=ct.bind(function(){return this.usrCoords[1]},this.points[dt]),this.points[dt].Y=ct.bind(function(){return this.usrCoords[2]},this.points[dt]);return pt=at.bezier(this.points),ft=pt[3](),gt=at.fminbr(function(xt){return pt[0](xt)},[0,ft]),mt=at.fminbr(function(xt){return-pt[0](xt)},[0,ft]),At=at.fminbr(function(xt){return pt[1](xt)},[0,ft]),yt=at.fminbr(function(xt){return-pt[1](xt)},[0,ft]),gt=pt[0](gt),mt=pt[0](mt),At=pt[1](At),yt=pt[1](yt),[gt,yt,mt,At]}for(dt=0;dt<bt;dt++)gt>this.points[dt].usrCoords[1]&&(gt=this.points[dt].usrCoords[1]),mt<this.points[dt].usrCoords[1]&&(mt=this.points[dt].usrCoords[1]),At>this.points[dt].usrCoords[2]&&(At=this.points[dt].usrCoords[2]),yt<this.points[dt].usrCoords[2]&&(yt=this.points[dt].usrCoords[2]);return[gt,yt,mt,At]},getParents:function(){var dt=[this.xterm,this.yterm,this.minX(),this.maxX()];return this.parents.length!==0&&(dt=this.parents),dt},moveTo:function(dt){var pt,ft=[];return this.points.length>0&&!ct.evaluate(this.visProp.fixed)&&(pt=this.points[0],ft=dt.length===3?[dt[0]-pt.usrCoords[0],dt[1]-pt.usrCoords[1],dt[2]-pt.usrCoords[2]]:[dt[0]-pt.usrCoords[1],dt[1]-pt.usrCoords[2]],this.setPosition(_e.COORDS_BY_USER,ft)),this}}),tt.createCurve=function(dt,pt,ft){var gt,mt,At=ct.copyAttributes(ft,dt.options,"curve");return gt=dt.select(pt[0]),ct.isObject(gt)&&(gt.type===_e.OBJECT_TYPE_CURVE||gt.type===_e.OBJECT_TYPE_ANGLE||gt.type===_e.OBJECT_TYPE_ARC||gt.type===_e.OBJECT_TYPE_CONIC||gt.type===_e.OBJECT_TYPE_SECTOR)&&ct.isTransformationOrArray(pt[1])?(gt.type===_e.OBJECT_TYPE_SECTOR?At=ct.copyAttributes(ft,dt.options,"sector"):gt.type===_e.OBJECT_TYPE_ARC?At=ct.copyAttributes(ft,dt.options,"arc"):gt.type===_e.OBJECT_TYPE_ANGLE?(ct.exists(ft.withLabel)||(ft.withLabel=!1),At=ct.copyAttributes(ft,dt.options,"angle")):At=ct.copyAttributes(ft,dt.options,"curve"),At=ct.copyAttributes(At,dt.options,"curve"),mt=new tt.Curve(dt,["x",[],[]],At),mt.updateDataArray=function(){var yt,bt=gt.numberPoints;for(this.bezierDegree=gt.bezierDegree,this.dataX=[],this.dataY=[],yt=0;yt<bt;yt++)this.dataX.push(gt.points[yt].usrCoords[1]),this.dataY.push(gt.points[yt].usrCoords[2]);return this},mt.addTransform(pt[1]),mt):(At=ct.copyAttributes(ft,dt.options,"curve"),new tt.Curve(dt,["x"].concat(pt),At))},tt.registerElement("curve",tt.createCurve),tt.createFunctiongraph=function(dt,pt,ft){var gt,mt=["x","x"].concat(pt);return gt=ct.copyAttributes(ft,dt.options,"curve"),gt.curvetype="functiongraph",new tt.Curve(dt,mt,gt)},tt.registerElement("functiongraph",tt.createFunctiongraph),tt.registerElement("plot",tt.createFunctiongraph),tt.createSpline=function(dt,pt,ft){var gt,mt;return mt=function(){var At,yt=[],bt=[];return function(xt,vt){var _t,Ct,St;if(!vt){if(yt=[],bt=[],pt.length===2&&ct.isArray(pt[0])&&ct.isArray(pt[1])&&pt[0].length===pt[1].length)for(_t=0;_t<pt[0].length;_t++)ct.isFunction(pt[0][_t])?yt.push(pt[0][_t]()):yt.push(pt[0][_t]),ct.isFunction(pt[1][_t])?bt.push(pt[1][_t]()):bt.push(pt[1][_t]);else for(_t=0;_t<pt.length;_t++)if(ct.isPoint(pt[_t]))yt.push(pt[_t].X()),bt.push(pt[_t].Y());else if(ct.isArray(pt[_t])&&pt[_t].length===2)for(Ct=0;Ct<pt.length;Ct++)ct.isFunction(pt[Ct][0])?yt.push(pt[Ct][0]()):yt.push(pt[Ct][0]),ct.isFunction(pt[Ct][1])?bt.push(pt[Ct][1]()):bt.push(pt[Ct][1]);else ct.isFunction(pt[_t])&&pt[_t]().length===2&&(St=pt[_t](),yt.push(St[0]),bt.push(St[1]));At=at.splineDef(yt,bt)}return at.splineEval(xt,yt,bt,At)}},ft=ct.copyAttributes(ft,dt.options,"curve"),ft.curvetype="functiongraph",gt=new tt.Curve(dt,["x","x",mt()],ft),gt.setParents(pt),gt.elType="spline",gt},tt.registerElement("spline",tt.createSpline),tt.createCardinalSpline=function(dt,pt,ft){var gt,mt,At,yt,bt,xt,vt,_t,Ct=`
Possible parent types: [points:array, tau:number|function, type:string]`;if(!ct.exists(pt[0])||!ct.isArray(pt[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+Ct);if(!ct.exists(pt[1])||!ct.isNumber(pt[1])&&!ct.isFunction(pt[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+Ct);if(!ct.exists(pt[2])||!ct.isString(pt[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+Ct);if(ft=ct.copyAttributes(ft,dt.options,"curve"),ft=ct.copyAttributes(ft,dt.options,"cardinalspline"),ft.curvetype="parameter",yt=pt[0],bt=[],!ft.isarrayofcoordinates&&yt.length===2&&ct.isArray(yt[0])&&ct.isArray(yt[1])&&yt[0].length===yt[1].length)for(xt=0;xt<yt[0].length;xt++)bt[xt]=[],ct.isFunction(yt[0][xt])?bt[xt].push(yt[0][xt]()):bt[xt].push(yt[0][xt]),ct.isFunction(yt[1][xt])?bt[xt].push(yt[1][xt]()):bt[xt].push(yt[1][xt]);else for(xt=0;xt<yt.length;xt++)ct.isString(yt[xt])?bt.push(dt.select(yt[xt])):ct.isPoint(yt[xt])?bt.push(yt[xt]):ct.isArray(yt[xt])&&yt[xt].length===2?(bt[xt]=[],ct.isFunction(yt[xt][0])?bt[xt].push(yt[xt][0]()):bt[xt].push(yt[xt][0]),ct.isFunction(yt[xt][1])?bt[xt].push(yt[xt][1]()):bt[xt].push(yt[xt][1])):ct.isFunction(yt[xt])&&yt[xt]().length===2&&bt.push(pt[xt]());if(ft.createpoints===!0)mt=ct.providePoints(dt,bt,ft,"cardinalspline",["points"]);else for(mt=[],xt=0;xt<bt.length;xt++)ct.isPoint(bt[xt])?mt.push(bt[xt]):mt.push(function(St){return{X:function(){return bt[St][0]},Y:function(){return bt[St][1]}}}(xt));for(At=pt[1],pt[2],_t=["x"].concat(at.CardinalSpline(mt,At)),gt=new tt.Curve(dt,_t,ft),vt=mt.length,gt.setParents(mt),xt=0;xt<vt;xt++)ct.isPoint(mt[xt])&&mt[xt].addChild(gt);return gt.elType="cardinalspline",gt},tt.registerElement("cardinalspline",tt.createCardinalSpline),tt.createRiemannsum=function(dt,pt,ft){var gt,mt,At,yt,bt,xt;if(xt=ct.copyAttributes(ft,dt.options,"riemannsum"),xt.curvetype="plot",At=pt[0],gt=ct.createFunction(pt[1],dt,""),!ct.exists(gt))throw new Error(`JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);if(mt=ct.createFunction(pt[2],dt,"",!1),!ct.exists(mt))throw new Error(`JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);return yt=[[0],[0]].concat(pt.slice(3)),bt=dt.create("curve",yt,xt),bt.sum=0,bt.Value=function(){return this.sum},bt.updateDataArray=function(){var vt=at.riemann(At,gt(),mt(),this.minX(),this.maxX());this.dataX=vt[0],this.dataY=vt[1],this.sum=vt[2]},bt},tt.registerElement("riemannsum",tt.createRiemannsum),tt.createTracecurve=function(dt,pt,ft){var gt,mt,At,yt;if(pt.length!==2)throw new Error(`JSXGraph: Can't create trace curve with given parent'
Possible parent types: [glider, point]`);if(mt=dt.select(pt[0]),At=dt.select(pt[1]),mt.type!==_e.OBJECT_TYPE_GLIDER||!ct.isPoint(At))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof pt[0]+"' and '"+typeof pt[1]+`'.
Possible parent types: [glider, point]`);return yt=ct.copyAttributes(ft,dt.options,"tracecurve"),yt.curvetype="plot",gt=dt.create("curve",[[0],[0]],yt),gt.updateDataArray=function(){var bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt=yt.numberpoints,It=mt.position,Ot=mt.slideObject,Bt=Ot.minX(),Nt=Ot.maxX();for(xt=(Nt-Bt)/Rt,this.dataX=[],this.dataY=[],Ot.elementClass!==_e.OBJECT_CLASS_CURVE&&Rt++,bt=0;bt<Rt;bt++){vt=Bt+bt*xt,St=Ot.X(vt)/Ot.Z(vt),Et=Ot.Y(vt)/Ot.Z(vt),mt.setPositionDirectly(_e.COORDS_BY_USER,[St,Et]),Tt=!1;for(_t in this.board.objects)if(this.board.objects.hasOwnProperty(_t)&&(Ct=this.board.objects[_t],Ct===mt&&(Tt=!0),Tt&&Ct.needsRegularUpdate&&(Mt=Ct.visProp.trace,Ct.visProp.trace=!1,Ct.needsUpdate=!0,Ct.update(!0),Ct.visProp.trace=Mt,Ct===At)))break;this.dataX[bt]=At.X(),this.dataY[bt]=At.Y()}mt.position=It,Tt=!1;for(_t in this.board.objects)if(this.board.objects.hasOwnProperty(_t)&&(Ct=this.board.objects[_t],Ct===mt&&(Tt=!0),Tt&&Ct.needsRegularUpdate&&(Mt=Ct.visProp.trace,Ct.visProp.trace=!1,Ct.needsUpdate=!0,Ct.update(!0),Ct.visProp.trace=Mt,Ct===At)))break},gt},tt.registerElement("tracecurve",tt.createTracecurve),tt.createStepfunction=function(dt,pt,ft){var gt,mt;if(pt.length!==2)throw new Error(`JSXGraph: Can't create step function with given parent'
Possible parent types: [array, array|function]`);return mt=ct.copyAttributes(ft,dt.options,"stepfunction"),gt=dt.create("curve",pt,mt),gt.updateDataArray=function(){var At,yt=0,bt=this.xterm.length;if(this.dataX=[],this.dataY=[],bt!==0)for(this.dataX[yt]=this.xterm[0],this.dataY[yt]=this.yterm[0],++yt,At=1;At<bt;++At)this.dataX[yt]=this.xterm[At],this.dataY[yt]=this.dataY[yt-1],++yt,this.dataX[yt]=this.xterm[At],this.dataY[yt]=this.yterm[At],++yt},gt},tt.registerElement("stepfunction",tt.createStepfunction),tt.createDerivative=function(dt,pt,ft){var gt,mt,At,yt,bt;if(pt.length!==1&&pt[0].class!==_e.OBJECT_CLASS_CURVE)throw new Error(`JSXGraph: Can't create derivative curve with given parent'
Possible parent types: [curve]`);return bt=ct.copyAttributes(ft,dt.options,"curve"),mt=pt[0],At=at.D(mt.X),yt=at.D(mt.Y),gt=dt.create("curve",[function(xt){return mt.X(xt)},function(xt){return yt(xt)/At(xt)},mt.minX(),mt.maxX()],bt),gt.setParents(mt),gt},tt.registerElement("derivative",tt.createDerivative),{Curve:tt.Curve,createCurve:tt.createCurve,createFunctiongraph:tt.createFunctiongraph,createPlot:tt.createPlot,createSpline:tt.createSpline,createRiemannsum:tt.createRiemannsum,createTracecurve:tt.createTracecurve,createStepfunction:tt.createStepfunction}}),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type","base/point","base/curve"],function(tt,_e,rt,it,nt,st,at,lt,ot){return tt.createEllipse=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt=[],xt=at.copyAttributes(ht,ct.options,"conic","foci"),vt=at.copyAttributes(ht,ct.options,"conic","center"),_t=at.copyAttributes(ht,ct.options,"conic");for(At=0;At<2;At++)if(ut[At].length>1)bt[At]=ct.create("point",ut[At],xt);else if(at.isPoint(ut[At]))bt[At]=ct.select(ut[At]);else if(at.isFunction(ut[At])&&at.isPoint(ut[At]()))bt[At]=ut[At]();else{if(!at.isString(ut[At]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);bt[At]=ct.select(ut[At])}if(at.isNumber(ut[2]))mt=at.createFunction(ut[2],ct);else if(at.isFunction(ut[2])&&at.isNumber(ut[2]()))mt=ut[2];else{if(at.isPoint(ut[2]))gt=ct.select(ut[2]);else if(ut[2].length>1)gt=ct.create("point",ut[2],xt);else if(at.isFunction(ut[2])&&at.isPoint(ut[2]()))gt=ut[2]();else{if(!at.isString(ut[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);gt=ct.select(ut[2])}mt=function(){return gt.Dist(bt[0])+gt.Dist(bt[1])}}for(at.exists(ut[4])||(ut[4]=2*Math.PI),at.exists(ut[3])||(ut[3]=0),ft=ct.create("point",[function(){return .5*(bt[0].X()+bt[1].X())},function(){return .5*(bt[0].Y()+bt[1].Y())}],vt),pt=ct.create("curve",[function(Ct){return 0},function(Ct){return 0},ut[3],ut[4]],_t),pt.majorAxis=mt,yt=pt.hasPoint,dt=function(Ct,St){var Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt;St||(Et=mt(),Tt=Et*Et,Mt=bt[0].X(),Rt=bt[0].Y(),It=bt[1].X(),Ot=bt[1].Y(),Bt=Mt-It,Nt=Rt-Ot,zt=(Tt-Mt*Mt-Rt*Rt+It*It+Ot*Ot)/(2*Et),pt.quadraticform=[[zt*zt-It*It-Ot*Ot,zt*Bt/Et+It,zt*Nt/Et+Ot],[zt*Bt/Et+It,Bt*Bt/Tt-1,Bt*Nt/Tt],[zt*Nt/Et+Ot,Bt*Nt/Tt,Nt*Nt/Tt-1]])},pt.X=function(Ct,St){var Et=mt(),Tt=bt[1].Dist(bt[0]),Mt=.5*(Tt*Tt-Et*Et)/(Tt*Math.cos(Ct)-Et),Rt=Math.atan2(bt[1].Y()-bt[0].Y(),bt[1].X()-bt[0].X());return St||dt(Ct,St),bt[0].X()+Math.cos(Rt+Ct)*Mt},pt.Y=function(Ct,St){var Et=mt(),Tt=bt[1].Dist(bt[0]),Mt=.5*(Tt*Tt-Et*Et)/(Tt*Math.cos(Ct)-Et),Rt=Math.atan2(bt[1].Y()-bt[0].Y(),bt[1].X()-bt[0].X());return bt[0].Y()+Math.sin(Rt+Ct)*Mt},pt.midpoint=pt.center=ft,pt.type=_e.OBJECT_TYPE_CONIC,pt.subs={center:pt.center},pt.inherits.push(pt.center,bt[0],bt[1]),at.isPoint(gt)&&pt.inherits.push(gt),pt.hasPoint=function(Ct,St){var Et,Tt,Mt,Rt;return at.evaluate(this.visProp.hasinnerpoints)?(Et=bt[0].coords,Tt=bt[1].coords,Mt=this.majorAxis(),Rt=new rt(_e.COORDS_BY_SCREEN,[Ct,St],this.board),Rt.distance(_e.COORDS_BY_USER,Et)+Rt.distance(_e.COORDS_BY_USER,Tt)<=Mt):yt.apply(this,arguments)},ft.addChild(pt),At=0;At<2;At++)at.isPoint(bt[At])&&bt[At].addChild(pt);return at.isPoint(gt)&&gt.addChild(pt),pt.setParents(ut),pt},tt.createHyperbola=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt=[],bt=at.copyAttributes(ht,ct.options,"conic","foci"),xt=at.copyAttributes(ht,ct.options,"conic","center"),vt=at.copyAttributes(ht,ct.options,"conic");for(At=0;At<2;At++)if(ut[At].length>1)yt[At]=ct.create("point",ut[At],bt);else if(at.isPoint(ut[At]))yt[At]=ct.select(ut[At]);else if(at.isFunction(ut[At])&&at.isPoint(ut[At]()))yt[At]=ut[At]();else{if(!at.isString(ut[At]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);yt[At]=ct.select(ut[At])}if(at.isNumber(ut[2]))mt=at.createFunction(ut[2],ct);else if(at.isFunction(ut[2])&&at.isNumber(ut[2]()))mt=ut[2];else{if(at.isPoint(ut[2]))gt=ct.select(ut[2]);else if(ut[2].length>1)gt=ct.create("point",ut[2],bt);else if(at.isFunction(ut[2])&&at.isPoint(ut[2]()))gt=ut[2]();else{if(!at.isString(ut[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);gt=ct.select(ut[2])}mt=function(){return gt.Dist(yt[0])-gt.Dist(yt[1])}}for(at.exists(ut[4])||(ut[4]=1.0001*Math.PI),at.exists(ut[3])||(ut[3]=-1.0001*Math.PI),ft=ct.create("point",[function(){return .5*(yt[0].X()+yt[1].X())},function(){return .5*(yt[0].Y()+yt[1].Y())}],xt),pt=ct.create("curve",[function(_t){return 0},function(_t){return 0},ut[3],ut[4]],vt),pt.majorAxis=mt,dt=function(_t,Ct){var St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt;Ct||(St=mt(),Et=St*St,Tt=yt[0].X(),Mt=yt[0].Y(),Rt=yt[1].X(),It=yt[1].Y(),Ot=Tt-Rt,Bt=Mt-It,Nt=(Et-Tt*Tt-Mt*Mt+Rt*Rt+It*It)/(2*St),pt.quadraticform=[[Nt*Nt-Rt*Rt-It*It,Nt*Ot/St+Rt,Nt*Bt/St+It],[Nt*Ot/St+Rt,Ot*Ot/Et-1,Ot*Bt/Et],[Nt*Bt/St+It,Ot*Bt/Et,Bt*Bt/Et-1]])},pt.X=function(_t,Ct){var St=mt(),Et=yt[1].Dist(yt[0]),Tt=.5*(Et*Et-St*St)/(Et*Math.cos(_t)+St),Mt=Math.atan2(yt[1].Y()-yt[0].Y(),yt[1].X()-yt[0].X());return Ct||dt(_t,Ct),yt[0].X()+Math.cos(Mt+_t)*Tt},pt.Y=function(_t,Ct){var St=mt(),Et=yt[1].Dist(yt[0]),Tt=.5*(Et*Et-St*St)/(Et*Math.cos(_t)+St),Mt=Math.atan2(yt[1].Y()-yt[0].Y(),yt[1].X()-yt[0].X());return yt[0].Y()+Math.sin(Mt+_t)*Tt},pt.midpoint=pt.center=ft,pt.subs={center:pt.center},pt.inherits.push(pt.center,yt[0],yt[1]),at.isPoint(gt)&&pt.inherits.push(gt),pt.type=_e.OBJECT_TYPE_CONIC,ft.addChild(pt),At=0;At<2;At++)at.isPoint(yt[At])&&yt[At].addChild(pt);return at.isPoint(gt)&&gt.addChild(pt),pt.setParents(ut),pt},tt.createParabola=function(ct,ut,ht){var dt,pt,ft,gt=ut[0],mt=ut[1],At=at.copyAttributes(ht,ct.options,"conic","foci"),yt=at.copyAttributes(ht,ct.options,"conic","center"),bt=at.copyAttributes(ht,ct.options,"conic");if(ut[0].length>1)gt=ct.create("point",ut[0],At);else if(at.isPoint(ut[0]))gt=ct.select(ut[0]);else if(at.isFunction(ut[0])&&at.isPoint(ut[0]()))gt=ut[0]();else{if(!at.isString(ut[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,line]`);gt=ct.select(ut[0])}return at.exists(ut[3])||(ut[3]=10),at.exists(ut[2])||(ut[2]=-10),ft=ct.create("point",[function(){return st.projectPointToLine(gt,mt,ct).usrCoords}],yt),pt=ct.create("curve",[function(xt){return 0},function(xt){return 0},ut[2],ut[3]],bt),pt.midpoint=pt.center=ft,pt.subs={center:pt.center},pt.inherits.push(pt.center),dt=function(xt,vt){var _t,Ct,St,Et,Tt,Mt;vt||(_t=mt.stdform[1],Ct=mt.stdform[2],St=mt.stdform[0],Et=_t*_t+Ct*Ct,Tt=gt.X(),Mt=gt.Y(),pt.quadraticform=[[St*St-Et*(Tt*Tt+Mt*Mt),St*_t+Et*Tt,St*Ct+Et*Mt],[St*_t+Et*Tt,-Ct*Ct,_t*Ct],[St*Ct+Et*Mt,_t*Ct,-_t*_t]])},pt.X=function(xt,vt){var _t,Ct,St=mt.getAngle(),Et=st.distPointLine(gt.coords.usrCoords,mt.stdform),Tt=mt.point1.coords.usrCoords,Mt=mt.point2.coords.usrCoords,Rt=gt.coords.usrCoords;return Tt[0]===0?Tt=[1,Mt[1]+mt.stdform[2],Mt[2]-mt.stdform[1]]:Mt[0]===0&&(Mt=[1,Tt[1]+mt.stdform[2],Tt[2]-mt.stdform[1]]),Ct=(Mt[1]-Tt[1])*(Rt[2]-Tt[2])-(Mt[2]-Tt[2])*(Rt[1]-Tt[1])>=0?1:-1,_t=Ct*Et/(1-Math.sin(xt)),vt||dt(xt,vt),gt.X()+Math.cos(xt+St)*_t},pt.Y=function(xt,vt){var _t,Ct,St=mt.getAngle(),Et=st.distPointLine(gt.coords.usrCoords,mt.stdform),Tt=mt.point1.coords.usrCoords,Mt=mt.point2.coords.usrCoords,Rt=gt.coords.usrCoords;return Tt[0]===0?Tt=[1,Mt[1]+mt.stdform[2],Mt[2]-mt.stdform[1]]:Mt[0]===0&&(Mt=[1,Tt[1]+mt.stdform[2],Tt[2]-mt.stdform[1]]),Ct=(Mt[1]-Tt[1])*(Rt[2]-Tt[2])-(Mt[2]-Tt[2])*(Rt[1]-Tt[1])>=0?1:-1,_t=Ct*Et/(1-Math.sin(xt)),gt.Y()+Math.sin(xt+St)*_t},pt.type=_e.OBJECT_TYPE_CONIC,ft.addChild(pt),at.isPoint(gt)&&(gt.addChild(pt),pt.inherits.push(gt)),mt.addChild(pt),pt.setParents(ut),pt},tt.createConic=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt=[[1,0,0],[0,1,0],[0,0,1]],Mt=[[1,0,0],[0,1,0],[0,0,1]],Rt=[],It=[],Ot=at.copyAttributes(ht,ct.options,"conic","point"),Bt=at.copyAttributes(ht,ct.options,"conic","center"),Nt=at.copyAttributes(ht,ct.options,"conic");if(ut.length===5)Et=!0;else{if(ut.length!==6)throw new Error("JSXGraph: Can't create generic Conic with "+ut.length+" parameters.");Et=!1}if(Et)for(Ct=0;Ct<5;Ct++)if(ut[Ct].length>1)Rt[Ct]=ct.create("point",ut[Ct],Ot);else if(at.isPoint(ut[Ct]))Rt[Ct]=ct.select(ut[Ct]);else if(at.isFunction(ut[Ct])&&at.isPoint(ut[Ct]()))Rt[Ct]=ut[Ct]();else{if(!at.isString(ut[Ct]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof ut[Ct]+`'.
Possible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]`);Rt[Ct]=ct.select(ut[Ct])}else St=[[0,0,0],[0,0,0],[0,0,0]],St[0][0]=at.isFunction(ut[2])?function(){return ut[2]()}:function(){return ut[2]},St[0][1]=at.isFunction(ut[4])?function(){return ut[4]()}:function(){return ut[4]},St[0][2]=at.isFunction(ut[5])?function(){return ut[5]()}:function(){return ut[5]},St[1][1]=at.isFunction(ut[0])?function(){return ut[0]()}:function(){return ut[0]},St[1][2]=at.isFunction(ut[3])?function(){return ut[3]()}:function(){return ut[3]},St[2][2]=at.isFunction(ut[1])?function(){return ut[1]()}:function(){return ut[1]};if(mt=function(zt){var Dt,Ft;for(Dt=0;Dt<3;Dt++)for(Ft=Dt;Ft<3;Ft++)zt[Dt][Ft]+=zt[Ft][Dt];for(Dt=0;Dt<3;Dt++)for(Ft=0;Ft<Dt;Ft++)zt[Dt][Ft]=zt[Ft][Dt];return zt},gt=function(zt,Dt){var Ft,Ut,$t=[[0,0,0],[0,0,0],[0,0,0]];for(Ft=0;Ft<3;Ft++)for(Ut=0;Ut<3;Ut++)$t[Ft][Ut]=zt[Ft]*Dt[Ut];return mt($t)},ft=function(zt,Dt,Ft){var Ut,$t,Vt,Zt,qt,sr=[[0,0,0],[0,0,0],[0,0,0]];for(qt=it.matVecMult(Dt,Ft),Vt=it.innerProduct(Ft,qt),qt=it.matVecMult(zt,Ft),Zt=it.innerProduct(Ft,qt),Ut=0;Ut<3;Ut++)for($t=0;$t<3;$t++)sr[Ut][$t]=Vt*zt[Ut][$t]-Zt*Dt[Ut][$t];return sr},pt=ct.create("curve",[function(zt){return 0},function(zt){return 0},0,2*Math.PI],Nt),dt=function(zt,Dt){var Ft,Ut,$t,Vt;if(!Dt){if(Et){for(Ft=0;Ft<5;Ft++)It[Ft]=Rt[Ft].coords.usrCoords;vt=gt(it.crossProduct(It[0],It[1]),it.crossProduct(It[2],It[3])),_t=gt(it.crossProduct(It[0],It[2]),it.crossProduct(It[1],It[3])),Mt=ft(vt,_t,It[4])}else for(Ft=0;Ft<3;Ft++)for(Ut=Ft;Ut<3;Ut++)Mt[Ft][Ut]=St[Ft][Ut](),Ut>Ft&&(Mt[Ut][Ft]=Mt[Ft][Ut]);for(pt.quadraticform=Mt,At=nt.Jacobi(Mt),At[0][0][0]<0&&(At[0][0][0]*=-1,At[0][1][1]*=-1,At[0][2][2]*=-1),Ft=0;Ft<3;Ft++){for($t=0,Ut=0;Ut<3;Ut++)$t+=At[1][Ut][Ft]*At[1][Ut][Ft];$t=Math.sqrt($t)}Tt=At[1],xt=Math.sqrt(Math.abs(At[0][0][0])),yt=Math.sqrt(Math.abs(At[0][1][1])),bt=Math.sqrt(Math.abs(At[0][2][2]))}return At[0][1][1]<=0&&At[0][2][2]<=0?Vt=it.matVecMult(Tt,[1/xt,Math.cos(zt)/yt,Math.sin(zt)/bt]):At[0][1][1]<=0&&At[0][2][2]>0?Vt=it.matVecMult(Tt,[Math.cos(zt)/xt,1/yt,Math.sin(zt)/bt]):At[0][2][2]<0&&(Vt=it.matVecMult(Tt,[Math.sin(zt)/xt,Math.cos(zt)/yt,1/bt])),at.exists(Vt)?(Vt[1]/=Vt[0],Vt[2]/=Vt[0],Vt[0]=1):Vt=[1,NaN,NaN],Vt},pt.X=function(zt,Dt){return dt(zt,Dt)[1]},pt.Y=function(zt,Dt){return dt(zt,Dt)[2]},pt.midpoint=ct.create("point",[function(){var zt=pt.quadraticform;return[zt[1][1]*zt[2][2]-zt[1][2]*zt[1][2],zt[1][2]*zt[0][2]-zt[2][2]*zt[0][1],zt[0][1]*zt[1][2]-zt[1][1]*zt[0][2]]}],Bt),pt.type=_e.OBJECT_TYPE_CONIC,pt.center=pt.midpoint,pt.subs={center:pt.center},pt.inherits.push(pt.center),pt.inherits=pt.inherits.concat(Rt),Et){for(Ct=0;Ct<5;Ct++)at.isPoint(Rt[Ct])&&Rt[Ct].addChild(pt);pt.setParents(ut)}return pt.addChild(pt.center),pt},tt.registerElement("ellipse",tt.createEllipse),tt.registerElement("hyperbola",tt.createHyperbola),tt.registerElement("parabola",tt.createParabola),tt.registerElement("conic",tt.createConic),{createEllipse:tt.createEllipse,createHyperbola:tt.createHyperbola,createParabola:tt.createParabola,createConic:tt.createConic}}),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],function(tt,_e,rt,it,nt,st,at){return tt.Circle=function(lt,ot,ct,ut,ht){this.constructor(lt,ht,it.OBJECT_TYPE_CIRCLE,it.OBJECT_CLASS_CIRCLE),this.method=ot,this.midpoint=this.board.select(ct),this.center=this.board.select(ct),this.point2=null,this.radius=0,this.line=null,this.circle=null,ot==="twoPoints"?(this.point2=lt.select(ut),this.radius=this.Radius()):ot==="pointRadius"?(this.gxtterm=ut,this.updateRadius=at.createFunction(ut,this.board,null,!0),this.updateRadius()):ot==="pointLine"?(this.line=lt.select(ut),this.radius=this.line.point1.coords.distance(it.COORDS_BY_USER,this.line.point2.coords)):ot==="pointCircle"&&(this.circle=lt.select(ut),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),this.center.addChild(this),ot==="pointRadius"?this.notifyParents(ut):ot==="pointLine"?this.line.addChild(this):ot==="pointCircle"?this.circle.addChild(this):ot==="twoPoints"&&this.point2.addChild(this),this.methodMap=at.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},tt.Circle.prototype=new _e,tt.extend(tt.Circle.prototype,{hasPoint:function(lt,ot){var ct,ut,ht,dt=this.board.options.precision.hasPoint,pt=this.center.coords.usrCoords,ft=new rt(it.COORDS_BY_SCREEN,[lt,ot],this.board),gt=this.Radius();return ct=pt[1]-ft.usrCoords[1],ut=pt[2]-ft.usrCoords[2],ht=Math.sqrt(ct*ct+ut*ut),dt+=.5*at.evaluate(this.visProp.strokewidth),dt/=Math.sqrt(this.board.unitX*this.board.unitY),at.evaluate(this.visProp.hasinnerpoints)?ht<gt+dt:Math.abs(ht-gt)<dt},generatePolynomial:function(lt){var ot=this.center.symbolic.x,ct=this.center.symbolic.y,ut=lt.symbolic.x,ht=lt.symbolic.y,dt=this.generateRadiusSquared();return dt===""?[]:["(("+ut+")-("+ot+"))^2 + (("+ht+")-("+ct+"))^2 - ("+dt+")"]},generateRadiusSquared:function(){var lt,ot,ct,ut,ht,dt,pt="";return this.method==="twoPoints"?(lt=this.center.symbolic.x,ot=this.center.symbolic.y,ct=this.point2.symbolic.x,ut=this.point2.symbolic.y,pt="(("+ct+")-("+lt+"))^2 + (("+ut+")-("+ot+"))^2"):this.method==="pointRadius"?at.isNumber(this.radius)&&(pt=(this.radius*this.radius).toString()):this.method==="pointLine"?(ct=this.line.point1.symbolic.x,ut=this.line.point1.symbolic.y,ht=this.line.point2.symbolic.x,dt=this.line.point2.symbolic.y,pt="(("+ct+")-("+ht+"))^2 + (("+ut+")-("+dt+"))^2"):this.method==="pointCircle"&&(pt=this.circle.Radius()),pt},update:function(){return this.needsUpdate&&(at.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.method==="pointLine"?this.radius=this.line.point1.coords.distance(it.COORDS_BY_USER,this.line.point2.coords):this.method==="pointCircle"?this.radius=this.circle.Radius():this.method==="pointRadius"&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform()),this},updateQuadraticform:function(){var lt=this.center,ot=lt.X(),ct=lt.Y(),ut=this.Radius();this.quadraticform=[[ot*ot+ct*ct-ut*ut,-ot,-ct],[-ot,1,0],[-ct,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=at.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(lt){at.isString(lt)&&st.findDependencies(this,lt,this.board)},setRadius:function(lt){return this.updateRadius=at.createFunction(lt,this.board,null,!0),this.board.update(),this},Radius:function(lt){return at.exists(lt)?(this.setRadius(lt),this.Radius()):this.method==="twoPoints"?at.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||at.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):this.method==="pointLine"||this.method==="pointCircle"?this.radius:this.method==="pointRadius"?this.updateRadius():NaN},getRadius:function(){return tt.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var lt,ot,ct=this.Radius(),ut=this.center.coords.usrCoords;switch(at.evaluate(this.visProp.label.position)){case"lft":lt=ut[1]-ct,ot=ut[2];break;case"llft":lt=ut[1]-Math.sqrt(.5)*ct,ot=ut[2]-Math.sqrt(.5)*ct;break;case"rt":lt=ut[1]+ct,ot=ut[2];break;case"lrt":lt=ut[1]+Math.sqrt(.5)*ct,ot=ut[2]-Math.sqrt(.5)*ct;break;case"urt":lt=ut[1]+Math.sqrt(.5)*ct,ot=ut[2]+Math.sqrt(.5)*ct;break;case"top":lt=ut[1],ot=ut[2]+ct;break;case"bot":lt=ut[1],ot=ut[2]-ct;break;default:lt=ut[1]-Math.sqrt(.5)*ct,ot=ut[2]+Math.sqrt(.5)*ct}return new rt(it.COORDS_BY_USER,[lt,ot],this.board)},cloneToBackground:function(){var lt,ot=this.Radius(),ct={id:this.id+"T"+this.numTraces,elementClass:it.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return ot},getRadius:function(){return ot},board:this.board,visProp:at.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return ct.visProp.layer=this.board.options.layer.trace,this.numTraces++,at.clearVisPropOld(ct),ct.visPropCalc={visible:at.evaluate(ct.visProp.visible)},lt=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(ct),this.board.renderer.enhancedRendering=lt,this.traces[ct.id]=ct.rendNode,this},addTransform:function(lt){var ot,ct=at.isArray(lt)?lt:[lt],ut=ct.length;for(ot=0;ot<ut;ot++)this.center.transformations.push(ct[ot]),this.method==="twoPoints"&&this.point2.transformations.push(ct[ot]);return this},snapToGrid:function(){var lt=at.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(lt,!0),this.method==="twoPoints"&&this.point2.handleSnapToGrid(lt,!0),this},snapToPoints:function(){var lt=at.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(lt),this.method==="twoPoints"&&this.point2.handleSnapToPoints(lt),this},X:function(lt){return this.Radius()*Math.cos(2*lt*Math.PI)+this.center.coords.usrCoords[1]},Y:function(lt){return this.Radius()*Math.sin(2*lt*Math.PI)+this.center.coords.usrCoords[2]},Z:function(lt){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var lt=this.Radius();return lt*lt*Math.PI},bounds:function(){var lt=this.center.coords.usrCoords,ot=this.Radius();return[lt[1]-ot,lt[2]+ot,lt[1]+ot,lt[2]-ot]},getParents:function(){return this.parents.length===1?this.parents.concat(this.radius):this.parents}}),tt.createCircle=function(lt,ot,ct){var ut,ht,dt,pt,ft;if(ht=[],ft=lt.select(ot[0]),at.isObject(ft)&&ft.elementClass===it.OBJECT_CLASS_CIRCLE&&at.isTransformationOrArray(ot[1]))return pt=at.copyAttributes(ct,lt.options,"circle"),ut=nt.createEllipse(lt,[ft.center,ft.center,function(){return 2*ft.Radius()}],pt),ut.addTransform(ot[1]),ut;for(dt=0;dt<ot.length;dt++)if(at.isPointType(lt,ot[dt])){if(ht=ht.concat(at.providePoints(lt,[ot[dt]],ct,"circle",["center"])),ht[ht.length-1]===!1)throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else ht.push(ot[dt]);if(pt=at.copyAttributes(ct,lt.options,"circle"),ht.length===2&&at.isPoint(ht[0])&&at.isPoint(ht[1]))ut=new tt.Circle(lt,"twoPoints",ht[0],ht[1],pt);else if((at.isNumber(ht[0])||at.isFunction(ht[0])||at.isString(ht[0]))&&at.isPoint(ht[1]))ut=new tt.Circle(lt,"pointRadius",ht[1],ht[0],pt);else if((at.isNumber(ht[1])||at.isFunction(ht[1])||at.isString(ht[1]))&&at.isPoint(ht[0]))ut=new tt.Circle(lt,"pointRadius",ht[0],ht[1],pt);else if(ht[0].elementClass===it.OBJECT_CLASS_CIRCLE&&at.isPoint(ht[1]))ut=new tt.Circle(lt,"pointCircle",ht[1],ht[0],pt);else if(ht[1].elementClass===it.OBJECT_CLASS_CIRCLE&&at.isPoint(ht[0]))ut=new tt.Circle(lt,"pointCircle",ht[0],ht[1],pt);else if(ht[0].elementClass===it.OBJECT_CLASS_LINE&&at.isPoint(ht[1]))ut=new tt.Circle(lt,"pointLine",ht[1],ht[0],pt);else if(ht[1].elementClass===it.OBJECT_CLASS_LINE&&at.isPoint(ht[0]))ut=new tt.Circle(lt,"pointLine",ht[0],ht[1],pt);else{if(!(ot.length===3&&at.isPoint(ht[0])&&at.isPoint(ht[1])&&at.isPoint(ht[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof ot[0]+"' and '"+typeof ot[1]+`'.
Possible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]`);if(!tt.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");ut=tt.elements.circumcircle(lt,ht,pt)}for(ut.isDraggable=!0,ut.setParents(ht),ut.elType="circle",dt=0;dt<ht.length;dt++)at.isPoint(ht[dt])&&ut.inherits.push(ht[dt]);return ut},tt.registerElement("circle",tt.createCircle),{Circle:tt.Circle,createCircle:tt.createCircle}}),define("base/composition",["jxg","utils/type"],function(tt,_e){return tt.Composition=function(rt){var it,nt=this,st=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"];for(it=0;it<st.length;it++)this[st[it]]=function(at){return function(){var lt;for(lt in nt.elements)nt.elements.hasOwnProperty(lt)&&_e.exists(nt.elements[lt][at])&&nt.elements[lt][at].apply(nt.elements[lt],arguments);return nt}}(st[it]);this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"};for(it in rt)rt.hasOwnProperty(it)&&this.add(it,rt[it]);this.dump=!0,this.subs={}},tt.extend(tt.Composition.prototype,{add:function(rt,it){return!(_e.exists(this[rt])||!_e.exists(it))&&(_e.exists(it.id)?this.elements[it.id]=it:this.elements[rt]=it,_e.exists(it.name)&&(this.elementsByName[it.name]=it),it.on("attribute:name",this.nameListener,this),this.objectsList.push(it),this[rt]=it,this.methodMap[rt]=it,!0)},remove:function(rt){var it,nt=!1;for(it in this.elements)if(this.elements.hasOwnProperty(it)&&this.elements[it].id===this[rt].id){nt=!0;break}return nt&&(delete this.elements[this[rt].id],delete this[rt]),nt},nameListener:function(rt,it,nt){delete this.elementsByName[rt],this.elementsByName[it]=nt},select:function(rt){return _e.exists(tt.Board)?tt.Board.prototype.select.call(this,rt):new tt.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var rt;for(rt in this.subs)this.subs.hasOwnProperty(rt)&&this.subs[rt].visProp;return this.attr}}),tt.Composition}),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element","base/line","base/transformation"],function(tt,_e,rt,it,nt,st,at,lt,ot){return tt.Polygon=function(ct,ut,ht){this.constructor(ct,ht,_e.OBJECT_TYPE_POLYGON,_e.OBJECT_CLASS_AREA);var dt,pt,ft,gt,mt=st.copyAttributes(ht,ct.options,"polygon","borders");for(this.withLines=ht.withlines,this.attr_line=mt,this.vertices=[],dt=0;dt<ut.length;dt++)this.vertices[dt]=this.board.select(ut[dt]);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(ft=this.vertices.length-1,gt=0;gt<ft;gt++)dt=(gt+1)%ft,mt.id=mt.ids&&mt.ids[dt],mt.name=mt.names&&mt.names[dt],mt.strokecolor=st.isArray(mt.colors)&&mt.colors[dt%mt.colors.length]||mt.strokecolor,mt.visible=st.exists(ht.borders.visible)?ht.borders.visible:ht.visible,mt.strokecolor===!1&&(mt.strokecolor="none"),pt=ct.create("segment",[this.vertices[dt],this.vertices[dt+1]],mt),pt.dump=!1,this.borders[dt]=pt,pt.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),dt=0;dt<this.vertices.length-1;dt++)this.board.select(this.vertices[dt]).addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=tt.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},tt.Polygon.prototype=new at,tt.extend(tt.Polygon.prototype,{hasPoint:function(ct,ut){var ht,dt,pt,ft=!1;if(st.evaluate(this.visProp.hasinnerpoints)){for(pt=this.vertices.length,ht=0,dt=pt-2;ht<pt-1;dt=ht++)this.vertices[ht].coords.scrCoords[2]>ut!=this.vertices[dt].coords.scrCoords[2]>ut&&ct<(this.vertices[dt].coords.scrCoords[1]-this.vertices[ht].coords.scrCoords[1])*(ut-this.vertices[ht].coords.scrCoords[2])/(this.vertices[dt].coords.scrCoords[2]-this.vertices[ht].coords.scrCoords[2])+this.vertices[ht].coords.scrCoords[1]&&(ft=!ft);if(ft)return!0}for(pt=this.borders.length,ht=0;ht<pt;ht++)if(this.borders[ht].hasPoint(ct,ut)){ft=!0;break}return ft},updateRenderer:function(){var ct,ut;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(ut=this.vertices.length,this.isReal=!0,ct=0;ct<ut;++ct)if(!this.vertices[ct].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var ct,ut,ht,dt,pt;if(this.vertices.length===0)return new rt(_e.COORDS_BY_USER,[1,0,0],this.board);for(ct=this.vertices[0].X(),ut=this.vertices[0].Y(),ht=ct,dt=ut,pt=0;pt<this.vertices.length;pt++)this.vertices[pt].X()<ct&&(ct=this.vertices[pt].X()),this.vertices[pt].X()>ht&&(ht=this.vertices[pt].X()),this.vertices[pt].Y()>ut&&(ut=this.vertices[pt].Y()),this.vertices[pt].Y()<dt&&(dt=this.vertices[pt].Y());return new rt(_e.COORDS_BY_USER,[.5*(ct+ht),.5*(ut+dt)],this.board)},getLabelAnchor:tt.shortcut(tt.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var ct,ut={};return ut.id=this.id+"T"+this.numTraces,this.numTraces++,ut.vertices=this.vertices,ut.visProp=st.deepCopy(this.visProp,this.visProp.traceattributes,!0),ut.visProp.layer=this.board.options.layer.trace,ut.board=this.board,st.clearVisPropOld(ut),ut.visPropCalc={visible:st.evaluate(ut.visProp.visible)},ct=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(ut),this.board.renderer.enhancedRendering=ct,this.traces[ut.id]=ut.rendNode,this},hideElement:function(ct){var ut;if(tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!ct)for(ut=0;ut<this.borders.length;ut++)this.borders[ut].hideElement();this.hasLabel&&st.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(ct){var ut;if(tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!ct)for(ut=0;ut<this.borders.length;ut++)this.borders[ut].showElement().updateRenderer();return st.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(nt.signedPolygon(this.vertices,!0))},Perimeter:function(){var ct,ut=this.vertices.length,ht=0;for(ct=1;ct<ut;++ct)ht+=this.vertices[ct].Dist(this.vertices[ct-1]);return ht},boundingBox:function(){var ct,ut,ht=[0,0,0,0],dt=this.vertices.length-1;if(dt===0)return ht;for(ht[0]=this.vertices[0].X(),ht[2]=ht[0],ht[1]=this.vertices[0].Y(),ht[3]=ht[1],ct=1;ct<dt;++ct)ut=this.vertices[ct].X(),ut<ht[0]?ht[0]=ut:ut>ht[2]&&(ht[2]=ut),ut=this.vertices[ct].Y(),ut>ht[1]?ht[1]=ut:ut<ht[3]&&(ht[3]=ut);return ht},bounds:function(){return this.boundingBox()},remove:function(){var ct;for(ct=0;ct<this.borders.length;ct++)this.board.removeObject(this.borders[ct]);at.prototype.remove.call(this)},findPoint:function(ct){var ut;if(!st.isPoint(ct))return-1;for(ut=0;ut<this.vertices.length;ut++)if(this.vertices[ut].id===ct.id)return ut;return-1},addPoints:function(ct){var ut=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(ut))},insertPoints:function(ct,ut){var ht,dt,pt=[];if(arguments.length===0)return this;if(ct<0||ct>this.vertices.length-2)return this;for(ht=1;ht<arguments.length;ht++)st.isPoint(arguments[ht])&&pt.push(arguments[ht]);if(dt=this.vertices.slice(0,ct+1).concat(pt),this.vertices=dt.concat(this.vertices.slice(ct+1)),this.withLines){for(dt=this.borders.slice(0,ct),this.board.removeObject(this.borders[ct]),ht=0;ht<pt.length;ht++)dt.push(this.board.create("segment",[this.vertices[ct+ht],this.vertices[ct+ht+1]],this.attr_line));dt.push(this.board.create("segment",[this.vertices[ct+pt.length],this.vertices[ct+pt.length+1]],this.attr_line)),this.borders=dt.concat(this.borders.slice(ct+1))}return this.board.update(),this},removePoints:function(ct){var ut,ht,dt,pt=[],ft=[],gt=[],mt=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),ut=0;ut<arguments.length;ut++)dt=arguments[ut],st.isPoint(dt)&&(dt=this.findPoint(dt)),st.isNumber(dt)&&dt>-1&&dt<this.vertices.length&&st.indexOf(gt,dt)===-1&&gt.push(dt);for(ut=0;ut<gt.length;ut++)this.vertices[gt[ut]].removeChild(this);for(gt=gt.sort(),pt=this.vertices.slice(),ft=this.borders.slice(),this.withLines&&mt.push([gt[gt.length-1]]),ut=gt.length-1;ut>-1;ut--)pt[gt[ut]]=-1,this.withLines&&gt[ut]-1>gt[ut-1]&&(mt[mt.length-1][1]=gt[ut],mt.push([gt[ut-1]]));for(this.withLines&&(mt[mt.length-1][1]=gt[0]),this.vertices=[],ut=0;ut<pt.length;ut++)st.isPoint(pt[ut])&&this.vertices.push(pt[ut]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(ut=0;ut<mt.length;ut++){for(ht=mt[ut][1]-1;ht<mt[ut][0]+1;ht++)ht<0?(ht=0,this.board.removeObject(this.borders[ft.length-1]),ft[ft.length-1]=-1):ht>ft.length-1&&(ht=ft.length-1),this.board.removeObject(this.borders[ht]),ft[ht]=-1;mt[ut][1]!==0&&mt[ut][0]!==pt.length-1&&(ft[mt[ut][0]-1]=this.board.create("segment",[pt[Math.max(mt[ut][1]-1,0)],pt[Math.min(mt[ut][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],ut=0;ut<ft.length;ut++)ft[ut]!==-1&&this.borders.push(ft[ut]);mt[0][1]!==this.vertices.length-1&&mt[mt.length-1][1]!==0||this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var ct,ut=at.prototype.getAttributes.call(this);if(this.withLines)for(ut.lines=ut.lines||{},ut.lines.ids=[],ut.lines.colors=[],ct=0;ct<this.borders.length;ct++)ut.lines.ids.push(this.borders[ct].id),ut.lines.colors.push(this.borders[ct].visProp.strokecolor);return ut},snapToGrid:function(){var ct,ut;for(ut=!!st.evaluate(this.visProp.snaptogrid),ct=0;ct<this.vertices.length;ct++)this.vertices[ct].handleSnapToGrid(ut,!0)},setPositionDirectly:function(ct,ut,ht){var dt,pt,ft,gt,mt=new rt(ct,ut,this.board),At=new rt(ct,ht,this.board);for(gt=this.vertices.length-1,ft=0;ft<gt;ft++)if(!this.vertices[ft].draggable())return this;return dt=it.subtract(mt.usrCoords,At.usrCoords),pt=this.board.create("transform",dt.slice(1),{type:"translate"}),pt.applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(ct){var ut,ht,dt,pt,ft,gt,mt,At=tt.Math.Geometry.sortVertices(this.vertices),yt=tt.Math.Geometry.sortVertices(ct.vertices),bt=At.length-1,xt=yt.length-1,vt=[],_t=function(Ct,St,Et){return(St[1]-Ct[1])*(Et[2]-Ct[2])-(St[2]-Ct[2])*(Et[1]-Ct[1])>=0};for(dt=0;dt<xt;dt++)vt.push(yt[dt]);for(dt=0;dt<bt;dt++)for(ht=vt.slice(0),ut=ht.length,vt=[],ft=ht[ut-1],pt=0;pt<ut;pt++)gt=ht[pt],_t(At[dt],At[dt+1],gt)?(_t(At[dt],At[dt+1],ft)||(mt=tt.Math.Geometry.meetSegmentSegment(ft,gt,At[dt],At[dt+1]),mt[0][1]/=mt[0][0],mt[0][2]/=mt[0][0],mt[0][0]=1,vt.push(mt[0])),vt.push(gt)):_t(At[dt],At[dt+1],ft)&&(mt=tt.Math.Geometry.meetSegmentSegment(ft,gt,At[dt],At[dt+1]),mt[0][1]/=mt[0][0],mt[0][2]/=mt[0][0],mt[0][0]=1,vt.push(mt[0])),ft=gt;return vt},intersect:function(ct){return this.sutherlandHodgman(ct)}}),tt.createPolygon=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt=[],bt=!1;if(mt=st.copyAttributes(ht,ct.options,"polygon"),gt=ct.select(ut[0]),st.isObject(gt)&&gt.type===_e.OBJECT_TYPE_POLYGON&&st.isTransformationOrArray(ut[1]))for(bt=!0,ft=gt.vertices.length-1,At=st.copyAttributes(ht,ct.options,"polygon","vertices"),pt=0;pt<ft;pt++)At.withlabel&&(At.name=gt.vertices[pt].name===""?"":gt.vertices[pt].name+"'"),yt.push(ct.create("point",[gt.vertices[pt],ut[1]],At));else if((yt=st.providePoints(ct,ut,ht,"polygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(mt=st.copyAttributes(ht,ct.options,"polygon"),dt=new tt.Polygon(ct,yt,mt),dt.isDraggable=!0,bt)for(ft=gt.vertices.length-1,pt=0;pt<ft;pt++)yt[pt].prepareUpdate().update().updateVisibility(st.evaluate(dt.visProp.visible)).updateRenderer();return dt},tt.createRegularPolygon=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt=[];if(mt=ut.length,ft=ut[mt-1],st.isNumber(ft)&&(ut.length!==3||ft<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(st.isNumber(ct.select(ft))?(mt--,At=!1):(ft=mt,At=!0),(bt=st.providePoints(ct,ut.slice(0,mt),ht,"regularpolygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(yt=st.copyAttributes(ht,ct.options,"regularpolygon","vertices"),pt=2;pt<ft;pt++)gt=ct.create("transform",[Math.PI*(2-(ft-2)/ft),bt[pt-1]],{type:"rotate"}),At?(bt[pt].addTransform(bt[pt-2],gt),bt[pt].fullUpdate()):(st.isArray(yt.ids)&&yt.ids.length>=ft-2&&(yt.id=yt.ids[pt-2]),bt[pt]=ct.create("point",[bt[pt-2],gt],yt),bt[pt].type=_e.OBJECT_TYPE_CAS,bt[pt].isDraggable=!0,bt[pt].visProp.fixed=!1);return yt=st.copyAttributes(ht,ct.options,"regularpolygon"),dt=ct.create("polygon",bt,yt),dt.elType="regularpolygon",dt},tt.registerElement("polygon",tt.createPolygon),tt.registerElement("regularpolygon",tt.createRegularPolygon),{Polygon:tt.Polygon,createPolygon:tt.createPolygon,createRegularPolygon:tt.createRegularPolygon}}),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants","base/curve","element/composition"],function(tt,_e,rt,it,nt,st,at,lt,ot){return tt.createArc=function(ct,ut,ht){var dt,pt,ft;if((ft=st.providePoints(ct,ut,ht,"arc",["center","radiuspoint","anglepoint"]))===!1||ft.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point], [arc, transformation]`);return pt=st.copyAttributes(ht,ct.options,"arc"),dt=ct.create("curve",[[0],[0]],pt),dt.elType="arc",dt.setParents(ft),dt.type=at.OBJECT_TYPE_ARC,dt.center=ft[0],dt.radiuspoint=ft[1],dt.point2=dt.radiuspoint,dt.anglepoint=ft[2],dt.point3=dt.anglepoint,dt.center.addChild(dt),dt.radiuspoint.addChild(dt),dt.anglepoint.addChild(dt),dt.useDirection=pt.usedirection,dt.updateDataArray=function(){var gt,mt,At,yt,bt,xt,vt=1,_t=this.radiuspoint,Ct=this.center,St=this.anglepoint,Et=st.evaluate(this.visProp.selection);mt=_e.rad(_t,Ct,St),(Et==="minor"&&mt>Math.PI||Et==="major"&&mt<Math.PI)&&(vt=-1),this.useDirection&&(yt=ft[1].coords.usrCoords,bt=ft[3].coords.usrCoords,xt=ft[2].coords.usrCoords,At=(yt[1]-xt[1])*(yt[2]-bt[2])-(yt[2]-xt[2])*(yt[1]-bt[1]),At<0?(this.radiuspoint=ft[1],this.anglepoint=ft[2]):(this.radiuspoint=ft[2],this.anglepoint=ft[1])),_t=_t.coords.usrCoords,Ct=Ct.coords.usrCoords,St=St.coords.usrCoords,gt=_e.bezierArc(_t,Ct,St,!1,vt),this.dataX=gt[0],this.dataY=gt[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},dt.Radius=function(){return this.radiuspoint.Dist(this.center)},dt.getRadius=function(){return tt.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},dt.Value=function(){return this.Radius()*_e.rad(this.radiuspoint,this.center,this.anglepoint)},dt.hasPoint=function(gt,mt){var At,yt,bt,xt,vt,_t,Ct,St,Et,Tt=this.Radius(),Mt=st.evaluate(this.visProp.selection);return st.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(gt,mt):(Et=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),yt=new it(at.COORDS_BY_SCREEN,[gt,mt],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),Ct=rt.inverse(this.transformMat),St=rt.matVecMult(Ct,yt.usrCoords),yt=new it(at.COORDS_BY_USER,St,this.board)),At=this.center.coords.distance(at.COORDS_BY_USER,yt),bt=Math.abs(At-Tt)<Et,bt&&(xt=_e.rad(this.radiuspoint,this.center,yt.usrCoords.slice(1)),vt=0,_t=_e.rad(this.radiuspoint,this.center,this.anglepoint),(Mt==="minor"&&_t>Math.PI||Mt==="major"&&_t<Math.PI)&&(vt=_t,_t=2*Math.PI),(xt<vt||xt>_t)&&(bt=!1)),bt)},dt.hasPointSector=function(gt,mt){var At,yt,bt,xt=new it(at.COORDS_BY_SCREEN,[gt,mt],this.board),vt=this.Radius(),_t=this.center.coords.distance(at.COORDS_BY_USER,xt),Ct=_t<vt,St=st.evaluate(this.visProp.selection);return Ct&&(At=_e.rad(this.radiuspoint,this.center,xt.usrCoords.slice(1)),yt=0,bt=_e.rad(this.radiuspoint,this.center,this.anglepoint),(St==="minor"&&bt>Math.PI||St==="major"&&bt<Math.PI)&&(yt=bt,bt=2*Math.PI),(At<yt||At>bt)&&(Ct=!1)),Ct},dt.getTextAnchor=function(){return this.center.coords},dt.getLabelAnchor=function(){var gt,mt,At,yt,bt,xt=_e.rad(this.radiuspoint,this.center,this.anglepoint),vt=10/this.board.unitX,_t=10/this.board.unitY,Ct=this.point2.coords.usrCoords,St=this.center.coords.usrCoords,Et=Ct[1]-St[1],Tt=Ct[2]-St[2],Mt=st.evaluate(this.visProp.selection),Rt=this.label?this.label.visProp:this.visProp.label;return(Mt==="minor"&&xt>Math.PI||Mt==="major"&&xt<Math.PI)&&(xt=-(2*Math.PI-xt)),gt=new it(at.COORDS_BY_USER,[St[1]+Math.cos(.5*xt)*Et-Math.sin(.5*xt)*Tt,St[2]+Math.sin(.5*xt)*Et+Math.cos(.5*xt)*Tt],this.board),At=gt.usrCoords[1]-St[1],yt=gt.usrCoords[2]-St[2],bt=Math.sqrt(At*At+yt*yt),At=At*(bt+vt)/bt,yt=yt*(bt+_t)/bt,mt=[St[1]+At,St[2]+yt],Rt.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],mt)),new it(at.COORDS_BY_USER,mt,this.board)},dt.updateQuadraticform=nt.Circle.prototype.updateQuadraticform,dt.updateStdform=nt.Circle.prototype.updateStdform,dt.methodMap=tt.deepCopy(dt.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),dt.prepareUpdate().update(),dt},tt.registerElement("arc",tt.createArc),tt.createSemicircle=function(ct,ut,ht){var dt,pt,ft,gt;if((gt=st.providePoints(ct,ut,ht,"point"))===!1||gt.length!==2)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+`'.
Possible parent types: [point,point]`);return ft=st.copyAttributes(ht,ct.options,"semicircle","center"),pt=ct.create("midpoint",gt,ft),pt.dump=!1,ft=st.copyAttributes(ht,ct.options,"semicircle"),dt=ct.create("arc",[pt,gt[1],gt[0]],ft),dt.elType="semicircle",dt.setParents([gt[0].id,gt[1].id]),dt.subs={midpoint:pt},dt.inherits.push(pt),dt.midpoint=dt.center=pt,dt},tt.registerElement("semicircle",tt.createSemicircle),tt.createCircumcircleArc=function(ct,ut,ht){var dt,pt,ft,gt;if((gt=st.providePoints(ct,ut,ht,"point"))===!1||gt.length!==3)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof ut[0]+"' and '"+typeof ut[1]+"' and '"+typeof ut[2]+`'.
Possible parent types: [point,point,point]`);return ft=st.copyAttributes(ht,ct.options,"circumcirclearc","center"),pt=ct.create("circumcenter",gt,ft),pt.dump=!1,ft=st.copyAttributes(ht,ct.options,"circumcirclearc"),ft.usedirection=!0,dt=ct.create("arc",[pt,gt[0],gt[2],gt[1]],ft),dt.elType="circumcirclearc",dt.setParents([gt[0].id,gt[1].id,gt[2].id]),dt.subs={center:pt},dt.inherits.push(pt),dt.center=pt,dt},tt.registerElement("circumcirclearc",tt.createCircumcircleArc),tt.createMinorArc=function(ct,ut,ht){return ht.selection="minor",tt.createArc(ct,ut,ht)},tt.registerElement("minorarc",tt.createMinorArc),tt.createMajorArc=function(ct,ut,ht){return ht.selection="major",tt.createArc(ct,ut,ht)},tt.registerElement("majorarc",tt.createMajorArc),{createArc:tt.createArc,createSemicircle:tt.createSemicircle,createCircumcircleArc:tt.createCircumcircleArc,createMinorArc:tt.createMinorArc,createMajorArc:tt.createMajorArc}}),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type","base/point","base/curve","base/transformation","element/composition"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut){return tt.createSector=function(ht,dt,pt){var ft,gt,mt,At,yt,bt="invalid",xt=["center","radiuspoint","anglepoint"];if(dt[0].elementClass===st.OBJECT_CLASS_LINE&&dt[1].elementClass===st.OBJECT_CLASS_LINE&&(at.isArray(dt[2])||at.isNumber(dt[2]))&&(at.isArray(dt[3])||at.isNumber(dt[3]))&&(at.isNumber(dt[4])||at.isFunction(dt[4])))bt="2lines";else{if((yt=at.providePoints(ht,dt,pt,"sector",xt))===!1)throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");bt="3points"}return gt=at.copyAttributes(pt,ht.options,"sector"),ft=ht.create("curve",[[0],[0]],gt),ft.type=st.OBJECT_TYPE_SECTOR,ft.elType="sector",bt==="2lines"?(ft.Radius=function(){return at.evaluate(dt[4])},ft.line1=ht.select(dt[0]),ft.line2=ht.select(dt[1]),ft.line1.addChild(ft),ft.line2.addChild(ft),ft.setParents(dt),ft.point1={visProp:{}},ft.point2={visProp:{}},ft.point3={visProp:{}},mt=_e.meetLineLine(ft.line1.stdform,ft.line2.stdform,0,ht),at.isArray(dt[2])?(dt[2].length===2&&(dt[2]=[1].concat(dt[2])),At=_e.projectPointToLine({coords:{usrCoords:dt[2]}},ft.line1,ht),At=it.subtract(At.usrCoords,mt.usrCoords),ft.direction1=rt.innerProduct(At,[0,ft.line1.stdform[2],-ft.line1.stdform[1]],3)>=0?1:-1):ft.direction1=dt[2]>=0?1:-1,at.isArray(dt[3])?(dt[3].length===2&&(dt[3]=[1].concat(dt[3])),At=_e.projectPointToLine({coords:{usrCoords:dt[3]}},ft.line2,ht),At=it.subtract(At.usrCoords,mt.usrCoords),ft.direction2=rt.innerProduct(At,[0,ft.line2.stdform[2],-ft.line2.stdform[1]],3)>=0?1:-1):ft.direction2=dt[3]>=0?1:-1,ft.updateDataArray=function(){var vt,_t,Ct,St,Et=[0,0,0],Tt=[0,0,0],Mt=[0,0,0];if(_t=this.line1,Ct=this.line2,Tt=rt.crossProduct(_t.stdform,Ct.stdform),Math.abs(Tt[0])>rt.eps*rt.eps&&(Tt[1]/=Tt[0],Tt[2]/=Tt[0],Tt[0]/=Tt[0]),vt=this.direction1*this.Radius(),Et=it.add(Tt,[0,vt*_t.stdform[2],-vt*_t.stdform[1]]),vt=this.direction2*this.Radius(),Mt=it.add(Tt,[0,vt*Ct.stdform[2],-vt*Ct.stdform[1]]),this.point2.coords=new nt(st.COORDS_BY_USER,Et,ft.board),this.point1.coords=new nt(st.COORDS_BY_USER,Tt,ft.board),this.point3.coords=new nt(st.COORDS_BY_USER,Mt,ft.board),Math.abs(Et[0])<rt.eps||Math.abs(Tt[0])<rt.eps||Math.abs(Mt[0])<rt.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);St=_e.bezierArc(Et,Tt,Mt,!0,1),this.dataX=St[0],this.dataY=St[1],this.bezierDegree=3},ft.methodMap=tt.deepCopy(ft.methodMap,{radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),ft.prepareUpdate().update()):bt==="3points"&&(ft.point1=yt[0],ft.point2=yt[1],ft.point3=yt[2],ft.point1.addChild(ft),ft.point2.addChild(ft),ft.point3.addChild(ft),ft.useDirection=pt.usedirection,ft.setParents(yt),at.exists(yt[3])&&(ft.point4=yt[3],ft.point4.addChild(ft)),ft.methodMap=tt.deepCopy(ft.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),ft.updateDataArray=function(){var vt,_t,Ct,St,Et,Tt=this.point2,Mt=this.point1,Rt=this.point3,It=1,Ot=at.evaluate(this.visProp.selection);if(!Tt.isReal||!Mt.isReal||!Rt.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);Et=_e.rad(Tt,Mt,Rt),(Ot==="minor"&&Et>Math.PI||Ot==="major"&&Et<Math.PI)&&(It=-1),this.useDirection&&at.exists(this.point4)&&(_t=this.point2.coords.usrCoords,Ct=this.point4.coords.usrCoords,St=this.point3.coords.usrCoords,(_t[1]-St[1])*(_t[2]-Ct[2])-(_t[2]-St[2])*(_t[1]-Ct[1])>=0&&(Rt=this.point2,Tt=this.point3)),Tt=Tt.coords.usrCoords,Mt=Mt.coords.usrCoords,Rt=Rt.coords.usrCoords,vt=_e.bezierArc(Tt,Mt,Rt,!0,It),this.dataX=vt[0],this.dataY=vt[1],this.bezierDegree=3},ft.Radius=function(){return this.point2.Dist(this.point1)},gt=at.copyAttributes(pt,ht.options,"sector","arc"),gt.withLabel=!1,gt.name+="_arc",ft.arc=ht.create("arc",[ft.point1,ft.point2,ft.point3],gt),ft.addChild(ft.arc)),ft.center=ft.point1,ft.radiuspoint=ft.point2,ft.anglepoint=ft.point3,ft.hasPointCurve=function(vt,_t){var Ct,St,Et,Tt,Mt,Rt=new nt(st.COORDS_BY_SCREEN,[vt,_t],this.board),It=this.Radius(),Ot=this.center.coords.distance(st.COORDS_BY_USER,Rt),Bt=at.evaluate(this.visProp.selection);return Tt=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),Mt=Math.abs(Ot-It)<Tt,Mt&&(Ct=_e.rad(this.point2,this.center,Rt.usrCoords.slice(1)),St=0,Et=_e.rad(this.point2,this.center,this.point3),(Bt==="minor"&&Et>Math.PI||Bt==="major"&&Et<Math.PI)&&(St=Et,Et=2*Math.PI),(Ct<St||Ct>Et)&&(Mt=!1)),Mt},ft.hasPointSector=function(vt,_t){var Ct,St,Et,Tt=new nt(st.COORDS_BY_SCREEN,[vt,_t],this.board),Mt=this.Radius(),Rt=this.point1.coords.distance(st.COORDS_BY_USER,Tt),It=Rt<Mt,Ot=at.evaluate(this.visProp.selection);return It&&(Ct=_e.rad(this.radiuspoint,this.center,Tt.usrCoords.slice(1)),St=0,Et=_e.rad(this.radiuspoint,this.center,this.anglepoint),(Ot==="minor"&&Et>Math.PI||Ot==="major"&&Et<Math.PI)&&(St=Et,Et=2*Math.PI),(Ct<St||Ct>Et)&&(It=!1)),It},ft.hasPoint=function(vt,_t){return at.evaluate(this.visProp.highlightonsector)||at.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(vt,_t):this.hasPointCurve(vt,_t)},ft.getTextAnchor=function(){return this.point1.coords},ft.getLabelAnchor=function(){var vt,_t,Ct,St,Et,Tt=_e.rad(this.point2,this.point1,this.point3),Mt=13/this.board.unitX,Rt=13/this.board.unitY,It=this.point2.coords.usrCoords,Ot=this.point1.coords.usrCoords,Bt=It[1]-Ot[1],Nt=It[2]-Ot[2],zt=at.evaluate(this.visProp.selection),Dt=this.label?this.label.visProp:this.visProp.label;return(zt==="minor"&&Tt>Math.PI||zt==="major"&&Tt<Math.PI)&&(Tt=-(2*Math.PI-Tt)),vt=new nt(st.COORDS_BY_USER,[Ot[1]+Math.cos(.5*Tt)*Bt-Math.sin(.5*Tt)*Nt,Ot[2]+Math.sin(.5*Tt)*Bt+Math.cos(.5*Tt)*Nt],this.board),Ct=vt.usrCoords[1]-Ot[1],St=vt.usrCoords[2]-Ot[2],Et=Math.sqrt(Ct*Ct+St*St),Ct=Ct*(Et+Mt)/Et,St=St*(Et+Rt)/Et,_t=[Ot[1]+Ct,Ot[2]+St],Dt.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],_t)),new nt(st.COORDS_BY_USER,_t,this.board)},ft.setRadius=function(vt){ft.Radius=function(){return at.evaluate(vt)}},ft.getRadius=function(){return tt.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},bt==="3points"&&(ft.setPositionDirectly=function(vt,_t,Ct){var St,Et,Tt=new nt(vt,_t,this.board),Mt=new nt(vt,Ct,this.board);return ft.point1.draggable()&&ft.point2.draggable()&&ft.point3.draggable()?(St=it.subtract(Tt.usrCoords,Mt.usrCoords),Et=this.board.create("transform",St.slice(1),{type:"translate"}),Et.applyOnce([ft.point1,ft.point2,ft.point3]),this):this}),ft.prepareUpdate().update(),ft},tt.registerElement("sector",tt.createSector),tt.createCircumcircleSector=function(ht,dt,pt){var ft,gt,mt,At;if((At=at.providePoints(ht,dt,pt,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");return gt=ht.create("circumcenter",At.slice(0,3),mt),gt.dump=!1,mt=at.copyAttributes(pt,ht.options,"circumcirclesector"),ft=ht.create("sector",[gt,At[0],At[2],At[1]],mt),ft.elType="circumcirclesector",ft.setParents(At),ft.center=gt,ft.subs={center:gt},ft},tt.registerElement("circumcirclesector",tt.createCircumcircleSector),tt.createMinorSector=function(ht,dt,pt){return pt.selection="minor",tt.createSector(ht,dt,pt)},tt.registerElement("minorsector",tt.createMinorSector),tt.createMajorSector=function(ht,dt,pt){return pt.selection="major",tt.createSector(ht,dt,pt)},tt.registerElement("majorsector",tt.createMajorSector),tt.createAngle=function(ht,dt,pt){var ft,gt,mt,At,yt,bt,xt="invalid";if(dt[0].elementClass===st.OBJECT_CLASS_LINE&&dt[1].elementClass===st.OBJECT_CLASS_LINE&&(at.isArray(dt[2])||at.isNumber(dt[2]))&&(at.isArray(dt[3])||at.isNumber(dt[3])))xt="2lines";else{if((bt=at.providePoints(ht,dt,pt,"point"))===!1)throw new Error("JSXGraph: Can't create angle with parent types '"+typeof dt[0]+"' and '"+typeof dt[1]+"' and '"+typeof dt[2]+"'.");xt="3points"}if(mt=at.copyAttributes(pt,ht.options,"angle"),at.exists(mt.name)&&mt.name!==""||(mt.name=ht.generateName({type:st.OBJECT_TYPE_ANGLE})),gt=at.exists(mt.radius)?mt.radius:0,xt==="2lines"?(dt.push(gt),ft=ht.create("sector",dt,mt),ft.updateDataArraySector=ft.updateDataArray,ft.setAngle=function(vt){},ft.free=function(vt){}):(ft=ht.create("sector",[bt[1],bt[0],bt[2]],mt),ft.arc.visProp.priv=!0,ft.point=ft.point2=ft.radiuspoint=bt[0],ft.pointsquare=ft.point3=ft.anglepoint=bt[2],ft.Radius=function(){return at.evaluate(gt)},ft.updateDataArraySector=function(){var vt,_t,Ct=this.point2,St=this.point1,Et=this.point3,Tt=this.Radius(),Mt=St.Dist(Ct),Rt=1,It=at.evaluate(this.visProp.selection);_t=_e.rad(Ct,St,Et),(It==="minor"&&_t>Math.PI||It==="major"&&_t<Math.PI)&&(Rt=-1),Ct=Ct.coords.usrCoords,St=St.coords.usrCoords,Et=Et.coords.usrCoords,Ct=[1,St[1]+(Ct[1]-St[1])*Tt/Mt,St[2]+(Ct[2]-St[2])*Tt/Mt],Et=[1,St[1]+(Et[1]-St[1])*Tt/Mt,St[2]+(Et[2]-St[2])*Tt/Mt],vt=_e.bezierArc(Ct,St,Et,!0,Rt),this.dataX=vt[0],this.dataY=vt[1],this.bezierDegree=3},ft.setAngle=function(vt){var _t,Ct=this.anglepoint,St=this.radiuspoint;return Ct.draggable()&&(_t=this.board.create("transform",[vt,this.center],{type:"rotate"}),Ct.addTransform(St,_t),Ct.isDraggable=!1,Ct.setParents(St)),this},ft.free=function(){var vt=this.anglepoint;return vt.transformations.length>0&&(vt.transformations.pop(),vt.isDraggable=!0,vt.parents=[]),this},ft.setParents(bt)),at.exists(ft.visProp.text)&&ft.label.setText(at.evaluate(ft.visProp.text)),ft.elType="angle",ft.type=st.OBJECT_TYPE_ANGLE,ft.subs={},ft.updateDataArraySquare=function(){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It=this.Radius();xt==="2lines"&&this.updateDataArraySector(),vt=this.point2,_t=this.point1,Ct=this.point3,vt=vt.coords.usrCoords,_t=_t.coords.usrCoords,Ct=Ct.coords.usrCoords,St=_e.distance(vt,_t,3),Et=_e.distance(Ct,_t,3),vt=[1,_t[1]+(vt[1]-_t[1])*It/St,_t[2]+(vt[2]-_t[2])*It/St],Ct=[1,_t[1]+(Ct[1]-_t[1])*It/Et,_t[2]+(Ct[2]-_t[2])*It/Et],Tt=rt.crossProduct(Ct,_t),Mt=[-vt[1]*Tt[1]-vt[2]*Tt[2],vt[0]*Tt[1],vt[0]*Tt[2]],Tt=rt.crossProduct(vt,_t),Rt=[-Ct[1]*Tt[1]-Ct[2]*Tt[2],Ct[0]*Tt[1],Ct[0]*Tt[2]],Tt=rt.crossProduct(Mt,Rt),Tt[1]/=Tt[0],Tt[2]/=Tt[0],this.dataX=[_t[1],vt[1],Tt[1],Ct[1],_t[1]],this.dataY=[_t[2],vt[2],Tt[2],Ct[2],_t[2]],this.bezierDegree=1},ft.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},ft.updateDataArray=function(){var vt=at.evaluate(this.visProp.type),_t=_e.trueAngle(this.point2,this.point1,this.point3),Ct=at.evaluate(this.visProp.selection);(Ct==="minor"&&_t>180||Ct==="major"&&_t<180)&&(_t=360-_t),Math.abs(_t-90)<at.evaluate(this.visProp.orthosensitivity)+rt.eps&&(vt=at.evaluate(this.visProp.orthotype)),vt==="none"?this.updateDataArrayNone():vt==="square"?this.updateDataArraySquare():vt==="sector"?this.updateDataArraySector():vt==="sectordot"&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||vt!=="sectordot"&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},At=at.copyAttributes(pt,ht.options,"angle","dot"),ft.dot=ht.create("point",[function(){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It;return at.exists(ft.dot)&&!ft.dot.visProp.visible?[0,0]:(vt=ft.point2.coords.usrCoords,_t=ft.point1.coords.usrCoords,Ct=ft.Radius(),St=_e.distance(vt,_t,3),Et=_e.rad(ft.point2,ft.point1,ft.point3),It=at.evaluate(ft.visProp.selection),(It==="minor"&&Et>Math.PI||It==="major"&&Et<Math.PI)&&(Et=-(2*Math.PI-Et)),Et*=.5,Tt=Math.cos(Et),Mt=Math.sin(Et),vt=[1,_t[1]+(vt[1]-_t[1])*Ct/St,_t[2]+(vt[2]-_t[2])*Ct/St],Rt=[[1,0,0],[_t[1]-.5*_t[1]*Tt+.5*_t[2]*Mt,.5*Tt,.5*-Mt],[_t[2]-.5*_t[1]*Mt-.5*_t[2]*Tt,.5*Mt,.5*Tt]],rt.matVecMult(Rt,vt))}],At),ft.dot.dump=!1,ft.subs.dot=ft.dot,xt==="2lines")for(yt=0;yt<2;yt++)ht.select(dt[yt]).addChild(ft.dot);else for(yt=0;yt<3;yt++)ht.select(bt[yt]).addChild(ft.dot);return ft.getLabelAnchor=function(){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot=12,Bt=at.evaluate(ft.visProp.selection),Nt=this.label?this.label.visProp:this.visProp.label;return at.exists(this.label.visProp.fontSize)&&(Ot=dy=at.evaluate(this.label.visProp.fontSize)),Ot/=this.board.unitX,_t=ft.point2.coords.usrCoords,Ct=ft.point1.coords.usrCoords,St=ft.Radius(),Et=_e.distance(_t,Ct,3),Tt=_e.rad(ft.point2,ft.point1,ft.point3),(Bt==="minor"&&Tt>Math.PI||Bt==="major"&&Tt<Math.PI)&&(Tt=-(2*Math.PI-Tt)),Tt*=.5,Mt=Math.cos(Tt),Rt=Math.sin(Tt),_t=[1,Ct[1]+(_t[1]-Ct[1])*St/Et,Ct[2]+(_t[2]-Ct[2])*St/Et],It=[[1,0,0],[Ct[1]-.5*Ct[1]*Mt+.5*Ct[2]*Rt,.5*Mt,.5*-Rt],[Ct[2]-.5*Ct[1]*Rt-.5*Ct[2]*Mt,.5*Rt,.5*Mt]],vt=rt.matVecMult(It,_t),vt[1]/=vt[0],vt[2]/=vt[0],vt[0]/=vt[0],Et=_e.distance(vt,Ct,3),vt=[vt[0],Ct[1]+(vt[1]-Ct[1])*(St+Ot)/Et,Ct[2]+(vt[2]-Ct[2])*(St+Ot)/Et],Nt.position=_e.calcLabelQuadrant(_e.rad([1,0],[0,0],vt)),new nt(st.COORDS_BY_USER,vt,this.board)},ft.Value=function(){return _e.rad(this.point2,this.point1,this.point3)},ft.methodMap=at.deepCopy(ft.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),ft},tt.registerElement("angle",tt.createAngle),tt.createNonreflexAngle=function(ht,dt,pt){var ft;return pt.selection="minor",ft=tt.createAngle(ht,dt,pt),ft.Value=function(){var gt=_e.rad(this.point2,this.point1,this.point3);return gt<Math.PI?gt:2*Math.PI-gt},ft},tt.registerElement("nonreflexangle",tt.createNonreflexAngle),tt.createReflexAngle=function(ht,dt,pt){var ft;return pt.selection="major",ft=tt.createAngle(ht,dt,pt),ft.Value=function(){var gt=_e.rad(this.point2,this.point1,this.point3);return gt>=Math.PI?gt:2*Math.PI-gt},ft},tt.registerElement("reflexangle",tt.createReflexAngle),{createSector:tt.createSector,createCircumcircleSector:tt.createCircumcircleSector,createMinorSector:tt.createMinorSector,createMajorSector:tt.createMajorSector,createAngle:tt.createAngle,createReflexAngle:tt.createReflexAngle,createNonreflexAngle:tt.createNonreflexAngle}}),define("element/composition",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/text","base/polygon","element/arc","element/sector"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At){return tt.createOrthogonalProjection=function(yt,bt,xt){var vt,_t,Ct,St;if(bt[0]=yt.select(bt[0]),bt[1]=yt.select(bt[1]),at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)_t=at.providePoints(yt,[bt[0]],xt,"point")[0],vt=bt[1];else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line]`);_t=at.providePoints(yt,[bt[1]],xt,"point")[0],vt=bt[0]}return St=at.copyAttributes(xt,yt.options,"orthogonalprojection"),Ct=yt.create("point",[function(){return rt.projectPointToLine(_t,vt,yt)}],St),_t.addChild(Ct),vt.addChild(Ct),Ct.elType="orthogonalprojection",Ct.setParents([_t.id,Ct.id]),Ct.update(),Ct.generatePolynomial=function(){var Et=vt.point1.symbolic.x,Tt=vt.point1.symbolic.y,Mt=vt.point2.symbolic.x,Rt=vt.point2.symbolic.y,It=_t.symbolic.x,Ot=_t.symbolic.y,Bt=Ct.symbolic.x,Nt=Ct.symbolic.y;return["("+Tt+")*("+Bt+")-("+Tt+")*("+Mt+")+("+Nt+")*("+Mt+")-("+Et+")*("+Nt+")+("+Et+")*("+Rt+")-("+Bt+")*("+Rt+")","("+Ot+")*("+Tt+")-("+Ot+")*("+Rt+")-("+Nt+")*("+Tt+")+("+Nt+")*("+Rt+")+("+It+")*("+Et+")-("+It+")*("+Mt+")-("+Bt+")*("+Et+")+("+Bt+")*("+Mt+")"]},Ct},tt.createPerpendicular=function(yt,bt,xt){var vt,_t,Ct,St;if(bt[0]=yt.select(bt[0]),bt[1]=yt.select(bt[1]),at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)_t=bt[1],vt=at.providePoints(yt,[bt[0]],xt,"point")[0];else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [line,point]`);_t=bt[0],vt=at.providePoints(yt,[bt[1]],xt,"point")[0]}return St=at.copyAttributes(xt,yt.options,"perpendicular"),Ct=ct.createLine(yt,[function(){return _t.stdform[2]*vt.X()-_t.stdform[1]*vt.Y()},function(){return-_t.stdform[2]*vt.Z()},function(){return _t.stdform[1]*vt.Z()}],St),Ct.elType="perpendicular",Ct.setParents([_t.id,vt.id]),Ct},tt.createPerpendicularPoint=function(yt,bt,xt){var vt,_t,Ct;if(bt[0]=yt.select(bt[0]),bt[1]=yt.select(bt[1]),at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)_t=at.providePoints(yt,[bt[0]],xt,"point")[0],vt=bt[1];else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line]`);_t=at.providePoints(yt,[bt[1]],xt,"point")[0],vt=bt[0]}return Ct=yt.create("point",[function(){return rt.perpendicular(vt,_t,yt)[0]}],xt),_t.addChild(Ct),vt.addChild(Ct),Ct.elType="perpendicularpoint",Ct.setParents([_t.id,vt.id]),Ct.update(),Ct.generatePolynomial=function(){var St=vt.point1.symbolic.x,Et=vt.point1.symbolic.y,Tt=vt.point2.symbolic.x,Mt=vt.point2.symbolic.y,Rt=_t.symbolic.x,It=_t.symbolic.y,Ot=Ct.symbolic.x,Bt=Ct.symbolic.y;return["("+Et+")*("+Ot+")-("+Et+")*("+Tt+")+("+Bt+")*("+Tt+")-("+St+")*("+Bt+")+("+St+")*("+Mt+")-("+Ot+")*("+Mt+")","("+It+")*("+Et+")-("+It+")*("+Mt+")-("+Bt+")*("+Et+")+("+Bt+")*("+Mt+")+("+Rt+")*("+St+")-("+Rt+")*("+Tt+")-("+Ot+")*("+St+")+("+Ot+")*("+Tt+")"]},Ct},tt.createPerpendicularSegment=function(yt,bt,xt){var vt,_t,Ct,St,Et;if(bt[0]=yt.select(bt[0]),bt[1]=yt.select(bt[1]),at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)_t=bt[1],vt=at.providePoints(yt,[bt[0]],xt,"point")[0];else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [line,point]`);_t=bt[0],vt=at.providePoints(yt,[bt[1]],xt,"point")[0]}return Et=at.copyAttributes(xt,yt.options,"perpendicularsegment","point"),St=tt.createPerpendicularPoint(yt,[_t,vt],Et),St.dump=!1,at.exists(xt.layer)||(xt.layer=yt.options.layer.line),Et=at.copyAttributes(xt,yt.options,"perpendicularsegment"),Ct=ct.createLine(yt,[function(){return rt.perpendicular(_t,vt,yt)[1]?[St,vt]:[vt,St]}],Et),Ct.point=St,Ct.elType="perpendicularsegment",Ct.setParents([vt.id,_t.id]),Ct.subs={point:St},Ct.inherits.push(St),Ct},tt.createMidpoint=function(yt,bt,xt){var vt,_t,Ct,St,Et;for(St=0;St<bt.length;++St)bt[St]=yt.select(bt[St]);if(bt.length===2&&at.isPointType(yt,bt[0])&&at.isPointType(yt,bt[1]))bt=at.providePoints(yt,bt,xt,"point"),vt=bt[0],_t=bt[1];else{if(bt.length!==1||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error(`JSXGraph: Can't create midpoint.
Possible parent types: [point,point], [line]`);vt=bt[0].point1,_t=bt[0].point2}return Et=at.copyAttributes(xt,yt.options,"midpoint"),Ct=yt.create("point",[function(){var Tt=vt.coords.usrCoords[1]+_t.coords.usrCoords[1];return isNaN(Tt)||Math.abs(vt.coords.usrCoords[0])<_e.eps||Math.abs(_t.coords.usrCoords[0])<_e.eps?NaN:.5*Tt},function(){var Tt=vt.coords.usrCoords[2]+_t.coords.usrCoords[2];return isNaN(Tt)||Math.abs(vt.coords.usrCoords[0])<_e.eps||Math.abs(_t.coords.usrCoords[0])<_e.eps?NaN:.5*Tt}],Et),vt.addChild(Ct),_t.addChild(Ct),Ct.elType="midpoint",Ct.setParents([vt.id,_t.id]),Ct.prepareUpdate().update(),Ct.generatePolynomial=function(){var Tt=vt.symbolic.x,Mt=vt.symbolic.y,Rt=_t.symbolic.x,It=_t.symbolic.y,Ot=Ct.symbolic.x,Bt=Ct.symbolic.y;return["("+Mt+")*("+Ot+")-("+Mt+")*("+Rt+")+("+Bt+")*("+Rt+")-("+Tt+")*("+Bt+")+("+Tt+")*("+It+")-("+Ot+")*("+It+")","("+Tt+")^2 - 2*("+Tt+")*("+Ot+")+("+Mt+")^2-2*("+Mt+")*("+Bt+")-("+Rt+")^2+2*("+Rt+")*("+Ot+")-("+It+")^2+2*("+It+")*("+Bt+")"]},Ct},tt.createParallelPoint=function(yt,bt,xt){var vt,_t,Ct,St,Et;for(Et=0;Et<bt.length;++Et)bt[Et]=yt.select(bt[Et]);if(bt.length===3&&at.isPointType(yt,bt[0])&&at.isPointType(yt,bt[1])&&at.isPointType(yt,bt[2]))bt=at.providePoints(yt,bt,xt,"point"),vt=bt[0],_t=bt[1],Ct=bt[2];else if(at.isPointType(yt,bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_LINE)Ct=at.providePoints(yt,[bt[0]],xt,"point")[0],vt=bt[1].point1,_t=bt[1].point2;else{if(!at.isPointType(yt,bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [line,point], [point,point,point]`);Ct=at.providePoints(yt,[bt[1]],xt,"point")[0],vt=bt[0].point1,_t=bt[0].point2}return St=yt.create("point",[function(){return Ct.coords.usrCoords[1]+_t.coords.usrCoords[1]-vt.coords.usrCoords[1]},function(){return Ct.coords.usrCoords[2]+_t.coords.usrCoords[2]-vt.coords.usrCoords[2]}],xt),vt.addChild(St),_t.addChild(St),Ct.addChild(St),St.elType="parallelpoint",St.setParents([vt.id,_t.id,Ct.id]),St.prepareUpdate().update(),St.generatePolynomial=function(){var Tt=vt.symbolic.x,Mt=vt.symbolic.y,Rt=_t.symbolic.x,It=_t.symbolic.y,Ot=Ct.symbolic.x,Bt=Ct.symbolic.y,Nt=St.symbolic.x,zt=St.symbolic.y;return["("+It+")*("+Nt+")-("+It+")*("+Ot+")-("+Mt+")*("+Nt+")+("+Mt+")*("+Ot+")-("+zt+")*("+Rt+")+("+zt+")*("+Tt+")+("+Bt+")*("+Rt+")-("+Bt+")*("+Tt+")","("+zt+")*("+Tt+")-("+zt+")*("+Ot+")-("+It+")*("+Tt+")+("+It+")*("+Ot+")-("+Nt+")*("+Mt+")+("+Nt+")*("+Bt+")+("+Rt+")*("+Mt+")-("+Rt+")*("+Bt+")"]},St},tt.createParallel=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt;for(Et=0;Et<bt.length;++Et)bt[Et]=yt.select(bt[Et]);return vt=null,bt.length===3?(bt=at.providePoints(yt,bt,xt,"point"),vt=bt[2],St=function(){return _e.crossProduct(bt[0].coords.usrCoords,bt[1].coords.usrCoords)}):at.isPointType(yt,bt[0])?(vt=at.providePoints(yt,[bt[0]],xt,"point")[0],St=function(){return bt[1].stdform}):at.isPointType(yt,bt[1])&&(vt=at.providePoints(yt,[bt[1]],xt,"point")[0],St=function(){return bt[0].stdform}),at.exists(xt.layer)||(xt.layer=yt.options.layer.line),Tt=at.copyAttributes(xt,yt.options,"parallel","point"),_t=yt.create("point",[function(){return _e.crossProduct([1,0,0],St())}],Tt),_t.isDraggable=!0,Tt=at.copyAttributes(xt,yt.options,"parallel"),Ct=yt.create("line",[vt,_t],Tt),Ct.elType="parallel",Ct.subs={point:_t},Ct.inherits.push(_t),Ct.setParents([bt[0].id,bt[1].id]),bt.length===3&&Ct.addParents(bt[2].id),Ct.point=_t,Ct},tt.createArrowParallel=function(yt,bt,xt){var vt;try{return xt.firstArrow=!1,xt.lastArrow=!0,vt=tt.createParallel(yt,bt,xt).setAttribute({straightFirst:!1,straightLast:!1}),vt.elType="arrowparallel",vt}catch{throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [line,point], [point,point,point]`)}},tt.createNormal=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It;for(St=0;St<bt.length;++St)bt[St]=yt.select(bt[St]);if(bt.length===1)vt=bt[0],_t=vt.slideObject;else{if(bt.length!==2)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);if(at.isPointType(yt,bt[0]))vt=at.providePoints(yt,[bt[0]],xt,"point")[0],_t=bt[1];else{if(!at.isPointType(yt,bt[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);_t=bt[0],vt=at.providePoints(yt,[bt[1]],xt,"point")[0]}}if(Mt=at.copyAttributes(xt,yt.options,"normal"),_t.elementClass===lt.OBJECT_CLASS_LINE)It=at.copyAttributes(xt,yt.options,"normal","point"),Rt=yt.create("point",[function(){var Ot=_e.crossProduct([1,0,0],_t.stdform);return[Ot[0],-Ot[2],Ot[1]]}],It),Rt.isDraggable=!0,Ct=yt.create("line",[vt,Rt],Mt),Ct.point=Rt,Ct.subs={point:Rt},Ct.inherits.push(Rt);else if(_t.elementClass===lt.OBJECT_CLASS_CIRCLE)Ct=yt.create("line",[_t.midpoint,vt],Mt);else if(_t.elementClass===lt.OBJECT_CLASS_CURVE)at.evaluate(_t.visProp.curvetype)!=="plot"?(Et=_t.X,Tt=_t.Y,Ct=yt.create("line",[function(){return-vt.X()*it.D(Et)(vt.position)-vt.Y()*it.D(Tt)(vt.position)},function(){return it.D(Et)(vt.position)},function(){return it.D(Tt)(vt.position)}],Mt)):Ct=yt.create("line",[function(){var Ot=Math.floor(vt.position),Bt=vt.position-Ot;return Ot===_t.numberPoints-1&&(Ot-=1,Bt=1),Ot<0?1:(_t.Y(Ot)+Bt*(_t.Y(Ot+1)-_t.Y(Ot)))*(_t.Y(Ot)-_t.Y(Ot+1))-(_t.X(Ot)+Bt*(_t.X(Ot+1)-_t.X(Ot)))*(_t.X(Ot+1)-_t.X(Ot))},function(){var Ot=Math.floor(vt.position);return Ot===_t.numberPoints-1&&(Ot-=1),Ot<0?0:_t.X(Ot+1)-_t.X(Ot)},function(){var Ot=Math.floor(vt.position);return Ot===_t.numberPoints-1&&(Ot-=1),Ot<0?0:_t.Y(Ot+1)-_t.Y(Ot)}],Mt);else{if(_t.type!==lt.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);Ct=yt.create("line",[function(){var Ot,Bt,Nt=Math.floor(vt.position),zt=vt.position-Nt;for(Bt=0;Bt<_t.objects.length;Bt++)if(Ot=_t.objects[Bt],Ot.type===lt.OBJECT_TYPE_CURVE){if(Nt<Ot.numberPoints)break;Nt-=Ot.numberPoints}return Nt===Ot.numberPoints-1&&(Nt-=1,zt=1),Nt<0?1:(Ot.Y(Nt)+zt*(Ot.Y(Nt+1)-Ot.Y(Nt)))*(Ot.Y(Nt)-Ot.Y(Nt+1))-(Ot.X(Nt)+zt*(Ot.X(Nt+1)-Ot.X(Nt)))*(Ot.X(Nt+1)-Ot.X(Nt))},function(){var Ot,Bt,Nt=Math.floor(vt.position);for(Bt=0;Bt<_t.objects.length;Bt++)if(Ot=_t.objects[Bt],Ot.type===lt.OBJECT_TYPE_CURVE){if(Nt<Ot.numberPoints)break;Nt-=Ot.numberPoints}return Nt===Ot.numberPoints-1&&(Nt-=1),Nt<0?0:Ot.X(Nt+1)-Ot.X(Nt)},function(){var Ot,Bt,Nt=Math.floor(vt.position);for(Bt=0;Bt<_t.objects.length;Bt++)if(Ot=_t.objects[Bt],Ot.type===lt.OBJECT_TYPE_CURVE){if(Nt<Ot.numberPoints)break;Nt-=Ot.numberPoints}return Nt===Ot.numberPoints-1&&(Nt-=1),Nt<0?0:Ot.Y(Nt+1)-Ot.Y(Nt)}],Mt)}return Ct.elType="normal",Ct.setParents(bt),Ct},tt.createBisector=function(yt,bt,xt){var vt,_t,Ct,St;if(bt=at.providePoints(yt,bt,xt,"point"),at.isPoint(bt[0])&&at.isPoint(bt[1])&&at.isPoint(bt[2])){for(St=at.copyAttributes(xt,yt.options,"bisector","point"),St.snapToGrid=!1,vt=yt.create("point",[function(){return rt.angleBisector(bt[0],bt[1],bt[2],yt)}],St),vt.dump=!1,Ct=0;Ct<3;Ct++)bt[Ct].addChild(vt);return at.exists(xt.layer)||(xt.layer=yt.options.layer.line),St=at.copyAttributes(xt,yt.options,"bisector"),_t=ct.createLine(yt,[bt[1],vt],St),_t.point=vt,_t.elType="bisector",_t.setParents(bt),_t.subs={point:vt},_t.inherits.push(vt),_t}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [point,point,point]`)},tt.createAngularBisectorsOfTwoLines=function(yt,bt,xt){var vt,_t,Ct,St,Et=yt.select(bt[0]),Tt=yt.select(bt[1]);if(Et.elementClass!==lt.OBJECT_CLASS_LINE||Tt.elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [line,line]`);return at.exists(xt.layer)||(xt.layer=yt.options.layer.line),Ct=at.copyAttributes(xt,yt.options,"bisectorlines","line1"),vt=yt.create("line",[function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[0]/Mt-Tt.stdform[0]/Rt},function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[1]/Mt-Tt.stdform[1]/Rt},function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[2]/Mt-Tt.stdform[2]/Rt}],Ct),at.exists(xt.layer)||(xt.layer=yt.options.layer.line),Ct=at.copyAttributes(xt,yt.options,"bisectorlines","line2"),_t=yt.create("line",[function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[0]/Mt+Tt.stdform[0]/Rt},function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[1]/Mt+Tt.stdform[1]/Rt},function(){var Mt=Math.sqrt(Et.stdform[1]*Et.stdform[1]+Et.stdform[2]*Et.stdform[2]),Rt=Math.sqrt(Tt.stdform[1]*Tt.stdform[1]+Tt.stdform[2]*Tt.stdform[2]);return Et.stdform[2]/Mt+Tt.stdform[2]/Rt}],Ct),St=new dt({line1:vt,line2:_t}),vt.dump=!1,_t.dump=!1,St.elType="bisectorlines",St.setParents([Et.id,Tt.id]),St.subs={line1:vt,line2:_t},St},tt.createCircumcenter=function(yt,bt,xt){var vt,_t,Ct,St,Et;if(bt=at.providePoints(yt,bt,xt,"point"),at.isPoint(bt[0])&&at.isPoint(bt[1])&&at.isPoint(bt[2])){for(Ct=bt[0],St=bt[1],Et=bt[2],vt=ot.createPoint(yt,[function(){return rt.circumcenter(Ct,St,Et,yt)}],xt),_t=0;_t<3;_t++)bt[_t].addChild(vt);return vt.elType="circumcenter",vt.setParents(bt),vt.generatePolynomial=function(){var Tt=Ct.symbolic.x,Mt=Ct.symbolic.y,Rt=St.symbolic.x,It=St.symbolic.y,Ot=Et.symbolic.x,Bt=Et.symbolic.y,Nt=vt.symbolic.x,zt=vt.symbolic.y;return[["((",Nt,")-(",Tt,"))^2+((",zt,")-(",Mt,"))^2-((",Nt,")-(",Rt,"))^2-((",zt,")-(",It,"))^2"].join(""),["((",Nt,")-(",Tt,"))^2+((",zt,")-(",Mt,"))^2-((",Nt,")-(",Ot,"))^2-((",zt,")-(",Bt,"))^2"].join("")]},vt}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`)},tt.createIncenter=function(yt,bt,xt){var vt,_t,Ct,St;if(bt=at.providePoints(yt,bt,xt,"point"),!(bt.length>=3&&at.isPoint(bt[0])&&at.isPoint(bt[1])&&at.isPoint(bt[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`);return _t=bt[0],Ct=bt[1],St=bt[2],vt=yt.create("point",[function(){var Et,Tt,Mt;return Et=Math.sqrt((Ct.X()-St.X())*(Ct.X()-St.X())+(Ct.Y()-St.Y())*(Ct.Y()-St.Y())),Tt=Math.sqrt((_t.X()-St.X())*(_t.X()-St.X())+(_t.Y()-St.Y())*(_t.Y()-St.Y())),Mt=Math.sqrt((Ct.X()-_t.X())*(Ct.X()-_t.X())+(Ct.Y()-_t.Y())*(Ct.Y()-_t.Y())),new st(lt.COORDS_BY_USER,[(Et*_t.X()+Tt*Ct.X()+Mt*St.X())/(Et+Tt+Mt),(Et*_t.Y()+Tt*Ct.Y()+Mt*St.Y())/(Et+Tt+Mt)],yt)}],xt),vt.elType="incenter",vt.setParents(bt),vt},tt.createCircumcircle=function(yt,bt,xt){var vt,_t,Ct;if((bt=at.providePoints(yt,bt,xt,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`);try{Ct=at.copyAttributes(xt,yt.options,"circumcircle","center"),vt=tt.createCircumcenter(yt,bt,Ct),vt.dump=!1,at.exists(xt.layer)||(xt.layer=yt.options.layer.circle),Ct=at.copyAttributes(xt,yt.options,"circumcircle"),_t=ut.createCircle(yt,[vt,bt[0]],Ct),_t.elType="circumcircle",_t.setParents(bt),_t.subs={center:vt},_t.inherits.push(_t)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`)}return _t},tt.createIncircle=function(yt,bt,xt){var vt,_t,Ct;if((bt=at.providePoints(yt,bt,xt,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`);try{Ct=at.copyAttributes(xt,yt.options,"incircle","center"),vt=tt.createIncenter(yt,bt,Ct),vt.dump=!1,at.exists(xt.layer)||(xt.layer=yt.options.layer.circle),Ct=at.copyAttributes(xt,yt.options,"incircle"),_t=ut.createCircle(yt,[vt,function(){var St=Math.sqrt((bt[1].X()-bt[2].X())*(bt[1].X()-bt[2].X())+(bt[1].Y()-bt[2].Y())*(bt[1].Y()-bt[2].Y())),Et=Math.sqrt((bt[0].X()-bt[2].X())*(bt[0].X()-bt[2].X())+(bt[0].Y()-bt[2].Y())*(bt[0].Y()-bt[2].Y())),Tt=Math.sqrt((bt[1].X()-bt[0].X())*(bt[1].X()-bt[0].X())+(bt[1].Y()-bt[0].Y())*(bt[1].Y()-bt[0].Y())),Mt=(St+Et+Tt)/2;return Math.sqrt((Mt-St)*(Mt-Et)*(Mt-Tt)/Mt)}],Ct),_t.elType="incircle",_t.setParents(bt),_t.center=vt,_t.subs={center:_t.center},_t.inherits.push(vt)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof bt[0]+"', '"+typeof bt[1]+"' and '"+typeof bt[2]+`'.
Possible parent types: [point,point,point]`)}return _t},tt.createReflection=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, line]`;for(Et=0;Et<bt.length;++Et)bt[Et]=yt.select(bt[Et]);if(at.isPoint(bt[0]))_t=at.providePoints(yt,[bt[0]],xt,"point")[0];else{if(bt[0].elementClass!==lt.OBJECT_CLASS_CURVE&&bt[0].elementClass!==lt.OBJECT_CLASS_LINE&&bt[0].type!==lt.OBJECT_TYPE_POLYGON&&bt[0].elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Tt);_t=bt[0]}if(bt[1].elementClass!==lt.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Tt);if(vt=bt[1],St=ht.createTransform(yt,[vt],{type:"reflect"}),at.isPoint(_t))Ct=ot.createPoint(yt,[_t,St],xt);else if(_t.elementClass===lt.OBJECT_CLASS_CURVE)Ct=pt.createCurve(yt,[_t,St],xt);else if(_t.elementClass===lt.OBJECT_CLASS_LINE)Ct=ct.createLine(yt,[_t,St],xt);else if(_t.type===lt.OBJECT_TYPE_POLYGON)Ct=gt.createPolygon(yt,[_t,St],xt);else{if(_t.elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Tt);Ct=ut.createCircle(yt,[_t,St],xt)}return _t.addChild(Ct),vt.addChild(Ct),Ct.elType="reflection",Ct.setParents([_t,vt]),Ct.prepareUpdate().update(),at.isPoint(Ct)&&(Ct.generatePolynomial=function(){var Mt=vt.point1.symbolic.x,Rt=vt.point1.symbolic.y,It=vt.point2.symbolic.x,Ot=vt.point2.symbolic.y,Bt=_t.symbolic.x,Nt=_t.symbolic.y,zt=Ct.symbolic.x,Dt=Ct.symbolic.y;return[["((",Dt,")-(",Nt,"))*((",Rt,")-(",Ot,"))+((",Mt,")-(",It,"))*((",zt,")-(",Bt,"))"].join(""),["((",zt,")-(",Mt,"))^2+((",Dt,")-(",Rt,"))^2-((",Bt,")-(",Mt,"))^2-((",Nt,")-(",Rt,"))^2"].join("")]}),Ct},tt.createMirrorElement=function(yt,bt,xt){var vt,_t,Ct,St,Et=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, point]`;if(at.isPoint(bt[0]))vt=at.providePoints(yt,[bt[0]],xt,"point")[0];else{if(bt[0].elementClass!==lt.OBJECT_CLASS_CURVE&&bt[0].elementClass!==lt.OBJECT_CLASS_LINE&&bt[0].type!==lt.OBJECT_TYPE_POLYGON&&bt[0].elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Et);vt=bt[0]}if(!at.isPoint(bt[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Et);if(_t=at.providePoints(yt,[bt[1]],xt,"point")[0],St=ht.createTransform(yt,[Math.PI,_t],{type:"rotate"}),at.isPoint(vt))Ct=ot.createPoint(yt,[vt,St],xt);else if(vt.elementClass===lt.OBJECT_CLASS_CURVE)Ct=pt.createCurve(yt,[vt,St],xt);else if(vt.elementClass===lt.OBJECT_CLASS_LINE)Ct=ct.createLine(yt,[vt,St],xt);else if(vt.type===lt.OBJECT_TYPE_POLYGON)Ct=gt.createPolygon(yt,[vt,St],xt);else{if(vt.elementClass!==lt.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+"'."+Et);Ct=ut.createCircle(yt,[vt,St],xt)}return vt.addChild(Ct),_t.addChild(Ct),Ct.elType="mirrorpoint",Ct.setParents([vt,_t]),Ct.prepareUpdate().update(),Ct},tt.createMirrorPoint=function(yt,bt,xt){return tt.createMirrorElement(yt,bt,xt)},tt.createIntegral=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft=null;if(at.isArray(bt[0])&&bt[1].elementClass===lt.OBJECT_CLASS_CURVE)vt=bt[0],_t=bt[1];else{if(!at.isArray(bt[1])||bt[0].elementClass!==lt.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof bt[0]+"' and '"+typeof bt[1]+`'.
Possible parent types: [[number|function,number|function],curve]`);vt=bt[1],_t=bt[0]}return Ct=at.copyAttributes(xt,yt.options,"integral"),Ct.withLabel=!1,Dt=yt.create("curve",[[0],[0]],Ct),St=vt[0],Et=vt[1],at.isFunction(St)?(Tt=St,Mt=function(){return _t.Y(Tt())},St=Tt()):(Tt=St,Mt=_t.Y(St)),at.isFunction(Et)?(Rt=Et,It=function(){return _t.Y(Rt())},Et=Rt()):(Rt=Et,It=_t.Y(Et)),Ct=at.copyAttributes(xt,yt.options,"integral","curveLeft"),Ot=yt.create("glider",[Tt,Mt,_t],Ct),at.isFunction(Tt)&&Ot.hideElement(),Ct=at.copyAttributes(xt,yt.options,"integral","baseLeft"),Bt=yt.create("point",[function(){return at.evaluate(Dt.visProp.axis)==="y"?0:Ot.X()},function(){return at.evaluate(Dt.visProp.axis)==="y"?Ot.Y():0}],Ct),Ct=at.copyAttributes(xt,yt.options,"integral","curveRight"),Nt=yt.create("glider",[Rt,It,_t],Ct),at.isFunction(Rt)&&Nt.hideElement(),Ct=at.copyAttributes(xt,yt.options,"integral","baseRight"),zt=yt.create("point",[function(){return at.evaluate(Dt.visProp.axis)==="y"?0:Nt.X()},function(){return at.evaluate(Dt.visProp.axis)==="y"?Nt.Y():0}],Ct),Ct=at.copyAttributes(xt,yt.options,"integral"),Ct.withlabel!==!1&&Ct.axis!=="y"&&(Ct=at.copyAttributes(xt,yt.options,"integral","label"),Ct=at.copyAttributes(Ct,yt.options,"label"),Ft=yt.create("text",[function(){var Ut=new st(lt.COORDS_BY_SCREEN,[at.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),$t=this.board.getBoundingBox(),Vt=.1*($t[2]-$t[0]),Zt=Nt.X();return Zt<$t[0]?Zt=$t[0]+Vt:Zt>$t[2]&&(Zt=$t[2]-Vt),Zt+Ut.usrCoords[1]},function(){var Ut=new st(lt.COORDS_BY_SCREEN,[0,at.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),$t=this.board.getBoundingBox(),Vt=.1*($t[1]-$t[3]),Zt=Nt.Y();return Zt>$t[1]?Zt=$t[1]-Vt:Zt<$t[3]&&(Zt=$t[3]+Vt),Zt+Ut.usrCoords[2]},function(){var Ut=it.NewtonCotes([Bt.X(),zt.X()],_t.Y);return"&int; = "+at.toFixed(Ut,4)}],Ct),Ft.dump=!1,Ot.addChild(Ft),Nt.addChild(Ft)),Ot.dump=!1,Bt.dump=!1,Nt.dump=!1,zt.dump=!1,Dt.elType="integral",Dt.setParents([_t.id,vt]),Dt.subs={curveLeft:Ot,baseLeft:Bt,curveRight:Nt,baseRight:zt},Dt.inherits.push(Ot,Bt,Nt,zt),Ct.withLabel&&(Dt.subs.label=Ft,Dt.inherits.push(Ft)),Dt.Value=function(){return it.I([Bt.X(),zt.X()],_t.Y)},Dt.updateDataArray=function(){var Ut,$t,Vt,Zt,qt,sr,er,ir,ur;if(at.evaluate(this.visProp.axis)==="y"){for(Ot.Y()<Nt.Y()?(sr=Ot.X(),ir=Ot.Y(),er=Nt.X(),ur=Nt.Y()):(sr=Nt.X(),ir=Nt.Y(),er=Ot.X(),ur=Ot.Y()),Zt=Math.min(sr,er),qt=Math.max(sr,er),Ut=[0,sr],$t=[ir,ir],Vt=0;Vt<_t.numberPoints;Vt++)ir<=_t.points[Vt].usrCoords[2]&&Zt<=_t.points[Vt].usrCoords[1]&&_t.points[Vt].usrCoords[2]<=ur&&_t.points[Vt].usrCoords[1]<=qt&&(Ut.push(_t.points[Vt].usrCoords[1]),$t.push(_t.points[Vt].usrCoords[2]));Ut.push(er),$t.push(ur),Ut.push(0),$t.push(ur),Ut.push(0),$t.push(ir)}else{for(Bt.X()<zt.X()?(Zt=Bt.X(),qt=zt.X()):(Zt=zt.X(),qt=Bt.X()),Ut=[Zt,Zt],$t=[0,_t.Y(Zt)],Vt=0;Vt<_t.numberPoints;Vt++)Zt<=_t.points[Vt].usrCoords[1]&&_t.points[Vt].usrCoords[1]<=qt&&(Ut.push(_t.points[Vt].usrCoords[1]),$t.push(_t.points[Vt].usrCoords[2]));Ut.push(qt),$t.push(_t.Y(qt)),Ut.push(qt),$t.push(0),Ut.push(Zt),$t.push(0)}this.dataX=Ut,this.dataY=$t},Ot.addChild(Dt),Nt.addChild(Dt),Bt.addChild(Dt),zt.addChild(Dt),Dt.baseLeft=Bt,Dt.baseRight=zt,Dt.curveLeft=Ot,Dt.curveRight=Nt,Dt.methodMap=tt.deepCopy(Dt.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),Dt.label=Ft,Dt},tt.createGrid=function(yt,bt,xt){var vt,_t;return _t=at.copyAttributes(xt,yt.options,"grid"),vt=yt.create("curve",[[null],[null]],_t),vt.elType="grid",vt.type=lt.OBJECT_TYPE_GRID,vt.updateDataArray=function(){var Ct,St,Et,Tt,Mt,Rt=at.evaluate(this.visProp.gridx),It=at.evaluate(this.visProp.gridy);for(Tt=at.isArray(this.visProp.topleft)?new st(at.evaluate(this.visProp.tltype)||lt.COORDS_BY_USER,this.visProp.topleft,yt):new st(lt.COORDS_BY_SCREEN,[0,0],yt),Mt=at.isArray(this.visProp.bottomright)?new st(at.evaluate(this.visProp.brtype)||lt.COORDS_BY_USER,this.visProp.bottomright,yt):new st(lt.COORDS_BY_SCREEN,[yt.canvasWidth,yt.canvasHeight],yt),yt.options.grid.hasGrid=!0,vt.dataX=[],vt.dataY=[],Ct=Math.floor(Tt.usrCoords[2]/It)*It,St=Math.ceil(Mt.usrCoords[2]/It)*It,Tt.usrCoords[2]<Mt.usrCoords[2]&&(Ct=Math.ceil(Mt.usrCoords[2]/It)*It,St=Math.floor(Tt.usrCoords[2]/It)*It),Et=Ct;Et>St-It;Et-=It)vt.dataX.push(Tt.usrCoords[1],Mt.usrCoords[1],NaN),vt.dataY.push(Et,Et,NaN);for(Ct=Math.ceil(Tt.usrCoords[1]/Rt)*Rt,St=Math.floor(Mt.usrCoords[1]/Rt)*Rt,Tt.usrCoords[1]>Mt.usrCoords[1]&&(Ct=Math.floor(Mt.usrCoords[1]/Rt)*Rt,St=Math.ceil(Tt.usrCoords[1]/Rt)*Rt),Et=Ct;Et<St+Rt;Et+=Rt)vt.dataX.push(Et,Et,NaN),vt.dataY.push(Tt.usrCoords[2],Mt.usrCoords[2],NaN)},vt.hasPoint=function(){return!1},yt.grids.push(vt),vt},tt.createInequality=function(yt,bt,xt){var vt,_t,Ct;if(Ct=at.copyAttributes(xt,yt.options,"inequality"),bt[0].elementClass===lt.OBJECT_CLASS_LINE)_t=yt.create("curve",[[],[]],Ct),_t.hasPoint=function(){return!1},_t.updateDataArray=function(){var St,Et,Tt,Mt=yt.getBoundingBox(),Rt=Ct.inverse?-1:1,It=1.5*Math.max(Mt[2]-Mt[0],Mt[1]-Mt[3]),Ot={coords:{usrCoords:[1,(Mt[0]+Mt[2])/2,Ct.inverse?Mt[1]:Mt[3]]}},Bt=bt[0].stdform.slice(1),Nt=Bt;Tt=1.5*Math.max(rt.perpendicular(bt[0],Ot,yt)[0].distance(lt.COORDS_BY_USER,Ot.coords),It),Tt*=Rt,Ot={coords:{usrCoords:[1,(Mt[0]+Mt[2])/2,(Mt[1]+Mt[3])/2]}},Ot=Math.abs(_e.innerProduct(Ot.coords.usrCoords,bt[0].stdform,3))>=_e.eps?rt.perpendicular(bt[0],Ot,yt)[0].usrCoords:Ot.coords.usrCoords,St=[1,Ot[1]+Bt[1]*It,Ot[2]-Bt[0]*It],Et=[1,Ot[1]-Nt[1]*It,Ot[2]+Nt[0]*It],this.dataX=[St[1],St[1]+Bt[0]*Tt,Et[1]+Nt[0]*Tt,Et[1],St[1]],this.dataY=[St[2],St[2]+Bt[1]*Tt,Et[2]+Nt[1]*Tt,Et[2],St[2]]};else if(bt[0].elementClass===lt.OBJECT_CLASS_CURVE&&bt[0].visProp.curvetype==="functiongraph")_t=yt.create("curve",[[],[]],Ct),_t.hasPoint=function(){return!1},_t.updateDataArray=function(){var St,Et,Tt=this.board.getBoundingBox(),Mt=1.5*(Ct.inverse?Tt[1]:Tt[3]);if(this.dataX=[],this.dataY=[],!((Et=bt[0].points.length)<=0)){for(this.dataX.push(bt[0].points[0].usrCoords[1]),this.dataY.push(Mt),St=0;St<Et;St++)this.dataX.push(bt[0].points[St].usrCoords[1]),this.dataY.push(bt[0].points[St].usrCoords[2]);this.dataX.push(bt[0].points[Et-1].usrCoords[1]),this.dataY.push(Mt)}};else if(vt=at.createFunction(bt[0]),!at.exists(vt))throw new Error(`JSXGraph: Can't create area with the given parents.
Possible parent types: [line], [function]`);return _t.addParents(bt[0]),_t},tt.registerElement("arrowparallel",tt.createArrowParallel),tt.registerElement("bisector",tt.createBisector),tt.registerElement("bisectorlines",tt.createAngularBisectorsOfTwoLines),tt.registerElement("msector",tt.createMsector),tt.registerElement("circumcircle",tt.createCircumcircle),tt.registerElement("circumcirclemidpoint",tt.createCircumcenter),tt.registerElement("circumcenter",tt.createCircumcenter),tt.registerElement("incenter",tt.createIncenter),tt.registerElement("incircle",tt.createIncircle),tt.registerElement("integral",tt.createIntegral),tt.registerElement("midpoint",tt.createMidpoint),tt.registerElement("mirrorelement",tt.createMirrorElement),tt.registerElement("mirrorpoint",tt.createMirrorPoint),tt.registerElement("normal",tt.createNormal),tt.registerElement("orthogonalprojection",tt.createOrthogonalProjection),tt.registerElement("parallel",tt.createParallel),tt.registerElement("parallelpoint",tt.createParallelPoint),tt.registerElement("perpendicular",tt.createPerpendicular),tt.registerElement("perpendicularpoint",tt.createPerpendicularPoint),tt.registerElement("perpendicularsegment",tt.createPerpendicularSegment),tt.registerElement("reflection",tt.createReflection),tt.registerElement("grid",tt.createGrid),tt.registerElement("inequality",tt.createInequality),{createArrowParallel:tt.createArrowParallel,createBisector:tt.createBisector,createAngularBisectorOfTwoLines:tt.createAngularBisectorsOfTwoLines,createCircumcircle:tt.createCircumcircle,createCircumcenter:tt.createCircumcenter,createIncenter:tt.createIncenter,createIncircle:tt.createIncircle,createIntegral:tt.createIntegral,createMidpoint:tt.createMidpoint,createMirrorElement:tt.createMirrorElement,createMirrorPoint:tt.createMirrorPoint,createNormal:tt.createNormal,createOrthogonalProjection:tt.createOrthogonalProjection,createParallel:tt.createParallel,createParallelPoint:tt.createParallelPoint,createPerpendicular:tt.createPerpendicular,createPerpendicularPoint:tt.createPerpendicularPoint,createPerpendicularSegmen:tt.createPerpendicularSegment,createReflection:tt.createReflection,createGrid:tt.createGrid,createInequality:tt.createInequality}}),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","parser/geonext","utils/color","utils/type","utils/event","utils/env","base/transformation","base/point","base/line","base/text","element/composition","base/composition"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt){return tt.Board=function(vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,this.BOARD_MODE_ZOOM=17,dt.exists(Bt.document)&&Bt.document!==!1?this.document=Bt.document:document!==void 0&&dt.isObject(document)&&(this.document=document),this.container=vt,this.containerObj=ft.isBrowser?this.document.getElementById(this.container):null,ft.isBrowser&&_t.type!=="no"&&this.containerObj===null)throw new Error(`
JSXGraph: HTML container element '`+vt+"' not found.");this.renderer=_t,this.grids=[],this.options=dt.deepCopy(it),this.attr=Bt,this.dimension=2,this.jc=new ct,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,St[0],St[1]],this.zoomX=Et,this.zoomY=Tt,this.unitX=Mt*this.zoomX,this.unitY=Rt*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=It,this.canvasHeight=Ot,dt.exists(Ct)&&Ct!==""&&ft.isBrowser&&!dt.exists(this.document.getElementById(Ct))?this.id=Ct:this.id=this.generateId(),pt.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(_e.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this.selectingBox=[[0,0],[0,0]],this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},tt.extend(tt.Board.prototype,{generateName:function(vt){var _t,Ct,St=this.attr.maxnamelength,Et="",Tt="",Mt=[],Rt="";if(vt.type===_e.OBJECT_TYPE_TICKS)return"";for(_t=dt.isPoint(vt)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:vt.type===_e.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],dt.isPoint(vt)||vt.elementClass===_e.OBJECT_CLASS_LINE||vt.type===_e.OBJECT_TYPE_ANGLE||(Et=vt.type===_e.OBJECT_TYPE_POLYGON?"P_{":vt.elementClass===_e.OBJECT_CLASS_CIRCLE?"k_{":vt.elementClass===_e.OBJECT_CLASS_TEXT?"t_{":"s_{",Tt="}"),Ct=0;Ct<St;Ct++)Mt[Ct]=0;for(;Mt[St-1]<_t.length;){for(Mt[0]=1;Mt[0]<_t.length;Mt[0]++){for(Rt=Et,Ct=St;Ct>0;Ct--)Rt+=_t[Mt[Ct-1]];if(!dt.exists(this.elementsByName[Rt+Tt]))return Rt+Tt}for(Mt[0]=_t.length,Ct=1;Ct<St;Ct++)Mt[Ct-1]===_t.length&&(Mt[Ct-1]=1,Mt[Ct]+=1)}return""},generateId:function(){for(var vt=1;dt.exists(tt.boards["jxgBoard"+vt]);)vt=Math.round(65535*Math.random());return"jxgBoard"+vt},setId:function(vt,_t){var Ct,St=this.numObjects,Et=vt.id;if(this.numObjects+=1,Et===""||!dt.exists(Et))for(Et=this.id+_t+St;dt.exists(this.objects[Et]);)Ct=Math.round(65535*Math.random()),Et=this.id+_t+St+"-"+Ct;return vt.id=Et,this.objects[Et]=vt,vt._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=vt,Et},finalizeAdding:function(vt){dt.evaluate(vt.visProp.visible)===!1&&this.renderer.display(vt,!1)},finalizeLabel:function(vt){vt.hasLabel&&!dt.evaluate(vt.label.visProp.islabel)&&dt.evaluate(vt.label.visProp.visible)===!1&&this.renderer.display(vt.label,!1)},getCoordsTopLeftCorner:function(){var vt,_t,Ct,St,Et,Tt=this.document.documentElement||this.document.body.parentNode,Mt=this.document.body,Rt=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||new Date().getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=new Date().getTime(),Rt.getBoundingClientRect){for(Ct=Rt.getBoundingClientRect(),St=1,Et=Rt;Et&&dt.exists(Et.parentNode);)dt.exists(Et.style)&&dt.exists(Et.style.zoom)&&Et.style.zoom!==""&&(St*=parseFloat(Et.style.zoom)),Et=Et.parentNode;return vt=[Ct.left*St,Ct.top*St],vt[0]+=ft.getProp(Rt,"border-left-width"),vt[1]+=ft.getProp(Rt,"border-top-width"),this.renderer.type!=="vml"&&(vt[0]+=ft.getProp(Rt,"padding-left"),vt[1]+=ft.getProp(Rt,"padding-top")),this.cPos=vt.slice(),this.cPos}return vt=ft.getOffset(Rt),_t=this.document.documentElement.ownerDocument,!this.containerObj.currentStyle&&_t.defaultView&&(vt[0]+=ft.getProp(Tt,"margin-left"),vt[1]+=ft.getProp(Tt,"margin-top"),vt[0]+=ft.getProp(Tt,"border-left-width"),vt[1]+=ft.getProp(Tt,"border-top-width"),vt[0]+=ft.getProp(Tt,"padding-left"),vt[1]+=ft.getProp(Tt,"padding-top")),Mt&&(vt[0]+=ft.getProp(Mt,"left"),vt[1]+=ft.getProp(Mt,"top")),typeof google=="object"&&google.translate&&(vt[0]+=10,vt[1]+=25),vt[0]+=ft.getProp(Rt,"border-left-width"),vt[1]+=ft.getProp(Rt,"border-top-width"),this.renderer.type!=="vml"&&(vt[0]+=ft.getProp(Rt,"padding-left"),vt[1]+=ft.getProp(Rt,"padding-top")),vt[0]+=this.attr.offsetx,vt[1]+=this.attr.offsety,this.cPos=vt.slice(),this.cPos},getMousePosition:function(vt,_t){var Ct,St,Et=this.getCoordsTopLeftCorner();return Ct=ft.getPosition(vt,_t,this.document),dt.exists(this.cssTransMat)||this.updateCSSTransforms(),St=[1,Ct[0]-Et[0],Ct[1]-Et[1]],St=st.matVecMult(this.cssTransMat,St),St[1]/=St[0],St[2]/=St[0],[St[1],St[2]]},initMoveOrigin:function(vt,_t){this.drag_dx=vt-this.origin.scrCoords[1],this.drag_dy=_t-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(vt,_t,Ct,St){var Et,Tt,Mt,Rt=[],It=[],Ot=this.objectsList.length,Bt={visProp:{layer:-1e4}};for(Tt=0;Tt<Ot;Tt++)Et=this.objectsList[Tt],Mt=Et.hasPoint&&Et.hasPoint(vt,_t),Et.visPropCalc.visible&&Mt&&(Et.triggerEventHandlers([St+"down","down"],[Ct]),this.downObjects.push(Et)),(this.geonextCompatibilityMode&&(dt.isPoint(Et)||Et.elementClass===_e.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&Et.isDraggable&&Et.visPropCalc.visible&&!dt.evaluate(Et.visProp.fixed)&&Mt&&(Et.visProp.layer>Bt.visProp.layer||Et.visProp.layer===Bt.visProp.layer&&Et.lastDragTime.getTime()>=Bt.lastDragTime.getTime())&&(this.attr.ignorelabels&&dt.exists(Bt.label)&&Et===Bt.label||(Bt=Et,Rt.push(Bt),dt.exists(Bt.coords)?It.push(ot.subtract(Bt.coords.scrCoords.slice(1),[vt,_t])):It.push([0,0])));return Rt.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(Rt.length=1,this._drag_offset=It[0]):(Rt=Rt.slice(-1),this._drag_offset=It[It.length-1]),this._drag_offset||(this._drag_offset=[0,0]),this.renderer.type==="svg"&&dt.exists(Rt[0])&&dt.evaluate(Rt[0].visProp.dragtotopoflayer)&&Rt.length===1&&dt.exists(Rt[0].rendNode)&&Rt[0].rendNode.parentNode.appendChild(Rt[0].rendNode),Rt},moveObject:function(vt,_t,Ct,St,Et){var Tt,Mt,Rt,It=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(vt,_t),this);Ct&&Ct.obj&&(Tt=Ct.obj,Tt.coords&&(Mt=Tt.coords.scrCoords.slice()),this.drag_position=[It.scrCoords[1],It.scrCoords[2]],this.drag_position=ot.add(this.drag_position,this._drag_offset),dt.exists(Tt.coords)?Tt.setPositionDirectly(_e.COORDS_BY_SCREEN,this.drag_position):(this.showInfobox(!1),isNaN(Ct.targets[0].Xprev+Ct.targets[0].Yprev)||Tt.setPositionDirectly(_e.COORDS_BY_SCREEN,[It.scrCoords[1],It.scrCoords[2]],[Ct.targets[0].Xprev,Ct.targets[0].Yprev]),Ct.targets[0].Xprev=It.scrCoords[1],Ct.targets[0].Yprev=It.scrCoords[2]),Tt.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(Tt),Tt.prepareUpdate().update(!0).updateRenderer(),Tt.coords&&(Rt=Tt.coords.scrCoords),Tt.coords&&Mt[1]===Rt[1]&&Mt[2]===Rt[2]||(Tt.triggerEventHandlers([Et+"drag","drag"],[St]),this.update()),Tt.highlight(!0),Tt.lastDragTime=new Date)},twoFingerMove:function(vt,_t,Ct,St){var Et,Tt,Mt;dt.exists(Ct)&&dt.exists(Ct.obj)&&(Mt=Ct.obj,Et=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(vt[0],vt[1]),this),Tt=new rt(_e.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(_t[0],_t[1]),this),Mt.elementClass===_e.OBJECT_CLASS_LINE||Mt.type===_e.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(Et,Tt,Ct,Mt):Mt.elementClass===_e.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(Et,Tt,Ct,Mt),Mt.triggerEventHandlers(["touchdrag","drag"],[St]),Ct.targets[0].Xprev=Et.scrCoords[1],Ct.targets[0].Yprev=Et.scrCoords[2],Ct.targets[1].Xprev=Tt.scrCoords[1],Ct.targets[1].Yprev=Tt.scrCoords[2])},twoFingerTouchObject:function(vt,_t,Ct,St){var Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft,Ut,$t,Vt,Zt,qt,sr,er,ir;if(dt.exists(Ct.targets[0])&&dt.exists(Ct.targets[1])&&!isNaN(Ct.targets[0].Xprev+Ct.targets[0].Yprev+Ct.targets[1].Xprev+Ct.targets[1].Yprev)){if(Et=vt.usrCoords,Tt=_t.usrCoords,Mt=new rt(_e.COORDS_BY_SCREEN,[Ct.targets[0].Xprev,Ct.targets[0].Yprev],this).usrCoords,Rt=new rt(_e.COORDS_BY_SCREEN,[Ct.targets[1].Xprev,Ct.targets[1].Yprev],this).usrCoords,Ot=[1,.5*(Mt[1]+Rt[1]),.5*(Mt[2]+Rt[2])],It=[1,.5*(Et[1]+Tt[1]),.5*(Et[2]+Tt[2])],Nt=st.crossProduct(Mt,Rt),Bt=st.crossProduct(Et,Tt),Dt=st.crossProduct(Nt,Bt),Math.abs(Dt[0])<st.eps)return;if(Dt[1]/=Dt[0],Dt[2]/=Dt[0],Ft=at.rad(Ot.slice(1),Dt.slice(1),It.slice(1)),Ut=this.create("transform",[Ft,Dt[1],Dt[2]],{type:"rotate"}),Ut.update(),Ot=st.matVecMult(Ut.matrix,Ot),Ot[1]/=Ot[0],Ot[2]/=Ot[0],$t=this.create("transform",[It[1]-Ot[1],It[2]-Ot[2]],{type:"translate"}),$t.update(),Ut.melt($t),dt.evaluate(St.visProp.scalable)&&(zt=at.distance(Et,Tt)/at.distance(Mt,Rt),Vt=this.create("transform",[-It[1],-It[2]],{type:"translate"}),Zt=this.create("transform",[zt,zt],{type:"scale"}),qt=this.create("transform",[It[1],It[2]],{type:"translate"}),Ut.melt(Vt).melt(Zt).melt(qt)),St.elementClass===_e.OBJECT_CLASS_LINE)sr=[],St.point1.draggable()&&sr.push(St.point1),St.point2.draggable()&&sr.push(St.point2),Ut.applyOnce(sr);else if(St.type===_e.OBJECT_TYPE_POLYGON){for(sr=[],ir=St.vertices.length-1,er=0;er<ir;++er)St.vertices[er].draggable()&&sr.push(St.vertices[er]);Ut.applyOnce(sr)}this.update(),St.highlight(!0)}},twoFingerTouchCircle:function(vt,_t,Ct,St){var Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft;St.method!=="pointCircle"&&St.method!=="pointLine"&&dt.exists(Ct.targets[0])&&dt.exists(Ct.targets[1])&&!isNaN(Ct.targets[0].Xprev+Ct.targets[0].Yprev+Ct.targets[1].Xprev+Ct.targets[1].Yprev)&&(Et=vt.usrCoords,Tt=_t.usrCoords,Mt=new rt(_e.COORDS_BY_SCREEN,[Ct.targets[0].Xprev,Ct.targets[0].Yprev],this).usrCoords,Rt=new rt(_e.COORDS_BY_SCREEN,[Ct.targets[1].Xprev,Ct.targets[1].Yprev],this).usrCoords,Bt=this.create("transform",[Et[1]-Mt[1],Et[2]-Mt[2]],{type:"translate"}),Ot=at.rad(Rt.slice(1),Et.slice(1),Tt.slice(1)),Nt=this.create("transform",[-Et[1],-Et[2]],{type:"translate"}),zt=this.create("transform",[Ot],{type:"rotate"}),Bt.melt(Nt).melt(zt),dt.evaluate(St.visProp.scalable)&&(It=at.distance(Et,Tt)/at.distance(Mt,Rt),Dt=this.create("transform",[It,It],{type:"scale"}),Bt.melt(Dt)),Ft=this.create("transform",[Et[1],Et[2]],{type:"translate"}),Bt.melt(Ft),St.center.draggable()&&Bt.applyOnce([St.center]),St.method==="twoPoints"?St.point2.draggable()&&Bt.applyOnce([St.point2]):St.method==="pointRadius"&&dt.isNumber(St.updateRadius.origin)&&St.setRadius(St.radius*It),this.update(St.center),St.highlight(!0))},highlightElements:function(vt,_t,Ct,St){var Et,Tt,Mt,Rt={},It=this.objectsList.length;for(Et=0;Et<It;Et++)Tt=this.objectsList[Et],Mt=Tt.id,dt.exists(Tt.hasPoint)&&Tt.visPropCalc.visible&&Tt.hasPoint(vt,_t)&&(this.updateInfobox(Tt),dt.exists(this.highlightedObjects[Mt])||(Rt[Mt]=Tt,Tt.highlight(),Tt.triggerEventHandlers(["mousehit","hit"],[Ct,Tt,St])),Tt.mouseover?Tt.triggerEventHandlers(["mousemove","move"],[Ct]):(Tt.triggerEventHandlers(["mouseover","over"],[Ct]),Tt.mouseover=!0));for(Et=0;Et<It;Et++)Tt=this.objectsList[Et],Mt=Tt.id,Tt.mouseover&&(Rt[Mt]||(Tt.triggerEventHandlers(["mouseout","out"],[Ct]),Tt.mouseover=!1))},saveStartPos:function(vt,_t){var Ct,St,Et=[];if(vt.type===_e.OBJECT_TYPE_TICKS)Et.push([1,NaN,NaN]);else if(vt.elementClass===_e.OBJECT_CLASS_LINE)Et.push(vt.point1.coords.usrCoords),Et.push(vt.point2.coords.usrCoords);else if(vt.elementClass===_e.OBJECT_CLASS_CIRCLE)Et.push(vt.center.coords.usrCoords),vt.method==="twoPoints"&&Et.push(vt.point2.coords.usrCoords);else if(vt.type===_e.OBJECT_TYPE_POLYGON)for(St=vt.vertices.length-1,Ct=0;Ct<St;Ct++)Et.push(vt.vertices[Ct].coords.usrCoords);else if(vt.type===_e.OBJECT_TYPE_SECTOR)Et.push(vt.point1.coords.usrCoords),Et.push(vt.point2.coords.usrCoords),Et.push(vt.point3.coords.usrCoords);else if(dt.isPoint(vt)||vt.type===_e.OBJECT_TYPE_GLIDER)Et.push(vt.coords.usrCoords);else if(vt.elementClass===_e.OBJECT_CLASS_CURVE)vt.points.length>0&&Et.push(vt.points[0].usrCoords);else try{Et.push(vt.coords.usrCoords)}catch(Tt){tt.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+Tt)}for(St=Et.length,Ct=0;Ct<St;Ct++)_t.Zstart.push(Et[Ct][0]),_t.Xstart.push(Et[Ct][1]),_t.Ystart.push(Et[Ct][2])},mouseOriginMoveStart:function(vt){var _t,Ct;return _t=this._isRequiredKeyPressed(vt,"pan"),_t&&(Ct=this.getMousePosition(vt),this.initMoveOrigin(Ct[0],Ct[1])),_t},mouseOriginMove:function(vt){var _t,Ct=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return Ct&&(_t=this.getMousePosition(vt),this.moveOrigin(_t[0],_t[1],!0)),Ct},touchOriginMoveStart:function(vt){var _t,Ct,St=vt[tt.touchProperty];return _t=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&St.length==1,_t&&(Ct=this.getMousePosition(vt,0),this.initMoveOrigin(Ct[0],Ct[1])),_t},touchOriginMove:function(vt){var _t,Ct=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return Ct&&(_t=this.getMousePosition(vt,0),this.moveOrigin(_t[0],_t[1],!0)),Ct},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){ft.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),this.containerObj!==null&&(this.containerObj.oncontextmenu=function(vt){return dt.exists(vt)&&vt.preventDefault(),!1})},addPointerEventHandlers:function(){!this.hasPointerHandlers&&ft.isBrowser&&(window.navigator.msPointerEnabled?(ft.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),ft.addEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(ft.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),ft.addEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),ft.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),ft.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.containerObj!==null&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0)},addMouseEventHandlers:function(){!this.hasMouseHandlers&&ft.isBrowser&&(ft.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),ft.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),ft.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),ft.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0)},addTouchEventHandlers:function(vt){!this.hasTouchHandlers&&ft.isBrowser&&(ft.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),ft.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0)},removePointerEventHandlers:function(){this.hasPointerHandlers&&ft.isBrowser&&(window.navigator.msPointerEnabled?(ft.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),ft.removeEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(ft.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),ft.removeEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),ft.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),ft.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?ft.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):ft.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.hasPointerHandlers=!1)},removeMouseEventHandlers:function(){this.hasMouseHandlers&&ft.isBrowser&&(ft.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),ft.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(ft.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),ft.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),ft.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1)},removeTouchEventHandlers:function(){this.hasTouchHandlers&&ft.isBrowser&&(ft.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),ft.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(ft.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1)},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers()},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(vt){var _t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt=this.attr.zoom.factorx,Nt=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(vt.preventDefault(),_t=new rt(_e.COORDS_BY_SCREEN,this.getMousePosition(vt,0),this),St=at.distance([vt.touches[0].clientX,vt.touches[0].clientY],[vt.touches[1].clientX,vt.touches[1].clientY],2),vt.scale===void 0&&(vt.scale=St/this.prevDist),Ct=vt.scale/this.prevScale,this.prevScale=vt.scale,this.attr.pan.enabled&&this.attr.pan.needtwofingers&&Math.abs(vt.scale-1)<.4&&this._num_pan>=.8*this._num_zoom?(this._num_pan++,this.moveOrigin(_t.scrCoords[1],_t.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(Ct-1)<.5&&(this._num_zoom++,(this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(Et=Math.abs(vt.touches[0].clientX-vt.touches[1].clientX),Tt=Math.abs(vt.touches[0].clientY-vt.touches[1].clientY),Mt=Math.abs(Math.atan2(Tt,Et)),Ot=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&Mt<Ot?(this.attr.zoom.factorx=Ct,this.attr.zoom.factory=1,Rt=0,It=0):this.attr.zoom.pinchvertical&&Math.abs(Mt-.5*Math.PI)<Ot?(this.attr.zoom.factorx=1,this.attr.zoom.factory=Ct,Rt=0,It=0):(this.attr.zoom.factorx=Ct,this.attr.zoom.factory=Ct,Rt=_t.usrCoords[1],It=_t.usrCoords[2]),this.zoomIn(Rt,It),this.attr.zoom.factorx=Bt,this.attr.zoom.factory=Nt),!1)},gestureStartListener:function(vt){var _t;return vt.preventDefault(),this.prevScale=1,this.prevDist=at.distance([vt.touches[0].clientX,vt.touches[0].clientY],[vt.touches[1].clientX,vt.touches[1].clientY],2),_t=this.getMousePosition(vt,0),this.initMoveOrigin(_t[0],_t[1]),this._num_zoom=this._num_pan=0,this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(vt,_t){var Ct=this.attr[_t];return!!Ct.enabled&&!(!(Ct.needshift&&vt.shiftKey||!Ct.needshift&&!vt.shiftKey)||!(Ct.needctrl&&vt.ctrlKey||!Ct.needctrl&&!vt.ctrlKey))},_pointerAddBoardTouches:function(vt){var _t,Ct;for(_t=0,Ct=!1;_t<this._board_touches.length;_t++)if(this._board_touches[_t].pointerId===vt.pointerId){this._board_touches[_t].clientX=vt.clientX,this._board_touches[_t].clientY=vt.clientY,Ct=!0;break}return Ct||this._board_touches.push({pointerId:vt.pointerId,clientX:vt.clientX,clientY:vt.clientY}),this},_pointerRemoveBoardTouches:function(vt){var _t;for(_t=0;_t<this._board_touches.length;_t++)if(this._board_touches[_t].pointerId===vt.pointerId){this._board_touches.splice(_t,1);break}return this},pointerDownListener:function(vt,_t){var Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt=this.options.precision.touch;if(this.hasPointerUp||(window.navigator.msPointerEnabled?ft.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):ft.addEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&dt.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(Rt=window.getSelection(),Rt.removeAllRanges))try{Rt.removeAllRanges()}catch{}if(ft.isBrowser&&(vt.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=Bt),Tt=this.getMousePosition(vt),this._testForSelection(vt),this.selectingMode)return this._startSelecting(Tt),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[vt]);if(_t?(Mt=[_t],this.mode=this.BOARD_MODE_DRAG):Mt=this.initMoveObject(Tt[0],Tt[1],vt,"mouse"),Mt.length>0){for(Ot=Mt[Mt.length-1],It=!1,Ct=0;Ct<this.touches.length;Ct++)if(this.touches[Ct].obj===Ot){St=Ct,Et=this.touches[Ct].targets.push({num:vt.pointerId,X:Tt[0],Y:Tt[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]})-1,It=!0;break}It||(Et=0,St=this.touches.push({obj:Ot,targets:[{num:vt.pointerId,X:Tt[0],Y:Tt[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}]})-1),this.dehighlightAll(),Ot.highlight(!0),this.saveStartPos(Ot,this.touches[St].targets[Et]),vt&&vt.preventDefault?vt.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(vt.preventDefault(),vt.stopPropagation()),this.options.precision.hasPoint=this.options.precision.mouse,ft.isBrowser&&vt.pointerType!=="touch"?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(vt):(this._pointerAddBoardTouches(vt),vt.touches=this._board_touches,this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(vt)||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||vt.touches.length!=2||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(vt))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[vt]),!1},pointerMoveListener:function(vt){var _t,Ct,St;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(vt.preventDefault(),vt.stopPropagation()),ft.isBrowser&&(vt.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=this.options.precision.touch),this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode)St=this.getMousePosition(vt),this._moveSelecting(St),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[vt,this.mode]);else if(!this.mouseOriginMove(vt))if(this.mode===this.BOARD_MODE_DRAG){for(_t=0;_t<this.touches.length;_t++)for(Ct=0;Ct<this.touches[_t].targets.length;Ct++)if(this.touches[_t].targets[Ct].num===vt.pointerId){this.touches[_t].targets.length===1?(this.touches[_t].targets[Ct].X=vt.pageX,this.touches[_t].targets[Ct].Y=vt.pageY,St=this.getMousePosition(vt),this.moveObject(St[0],St[1],this.touches[_t],vt,"touch")):this.touches[_t].targets.length===2&&this.touches[_t].targets[0].num>-1&&this.touches[_t].targets[1].num>-1&&(this.touches[_t].targets[Ct].X=vt.pageX,this.touches[_t].targets[Ct].Y=vt.pageY,this.twoFingerMove(this.getMousePosition({clientX:this.touches[_t].targets[0].X,clientY:this.touches[_t].targets[0].Y}),this.getMousePosition({clientX:this.touches[_t].targets[1].X,clientY:this.touches[_t].targets[1].Y}),this.touches[_t],vt));break}}else vt.pointerType=="touch"?(this._pointerAddBoardTouches(vt),this._board_touches.length==2&&(vt.touches=this._board_touches,this.gestureChangeListener(vt))):(St=this.getMousePosition(vt),this.highlightElements(St[0],St[1],vt,-1));return this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[vt,this.mode]),this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(vt){var _t,Ct,St;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[vt]),this.showInfobox(!1),vt){for(_t=0;_t<this.touches.length;_t++)for(Ct=0;Ct<this.touches[_t].targets.length;Ct++)if(this.touches[_t].targets[Ct].num===vt.pointerId){this.touches[_t].targets.splice(Ct,1),this.touches[_t].targets.length===0&&this.touches.splice(_t,1);break}}if(this.selectingMode)this._stopSelecting(vt),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[vt]);else for(_t=this.downObjects.length-1;_t>-1;_t--){for(St=!1,Ct=0;Ct<this.touches.length;Ct++)this.touches[Ct].obj.id===this.downObjects[_t].id&&(St=!0);St||(this.downObjects[_t].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[vt]),this.downObjects[_t].snapToGrid(),this.downObjects[_t].snapToPoints(),this.downObjects.splice(_t,1))}return this._pointerRemoveBoardTouches(vt),this._board_touches.length===0&&(this.hasPointerUp&&(window.navigator.msPointerEnabled?ft.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):ft.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this.originMoveEnd(),this.update()),!0},touchStartListener:function(vt){var _t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt=this.options.precision.touch,Nt=vt[tt.touchProperty];for(this.hasTouchEnd||(ft.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&dt.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.options.precision.hasPoint=this.options.precision.touch,_t=0;_t<Nt.length;_t++)Nt[_t].jxg_isused=!1;for(_t=0;_t<this.touches.length;_t++)for(Et=0;Et<this.touches[_t].targets.length;Et++){this.touches[_t].targets[Et].num=-1,Bt=this.options.precision.touch;do{for(Tt=0;Tt<Nt.length;Tt++)if(Math.abs(Math.pow(Nt[Tt].screenX-this.touches[_t].targets[Et].X,2)+Math.pow(Nt[Tt].screenY-this.touches[_t].targets[Et].Y,2))<Bt*Bt){this.touches[_t].targets[Et].num=Tt,this.touches[_t].targets[Et].X=Nt[Tt].screenX,this.touches[_t].targets[Et].Y=Nt[Tt].screenY,Nt[Tt].jxg_isused=!0;break}Bt*=2}while(this.touches[_t].targets[Et].num===-1&&Bt<this.options.precision.touchMax);this.touches[_t].targets[Et].num===-1&&(tt.debug("i couldn't find a targettouches for target no "+Et+" on "+this.touches[_t].obj.name+" ("+this.touches[_t].obj.id+"). Removed the target."),tt.debug("eps = "+Bt+", touchMax = "+it.precision.touchMax),this.touches[_t].targets.splice(_t,1))}for(_t=0;_t<Nt.length;_t++)if(!Nt[_t].jxg_isused){if(Ct=this.getMousePosition(vt,_t),this.selectingMode)return this._startSelecting(Ct),this.triggerEventHandlers(["touchstartselecting","startselecting"],[vt]),vt.preventDefault(),vt.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if(St=this.initMoveObject(Ct[0],Ct[1],vt,"touch"),St.length!==0){if(Mt=St[St.length-1],dt.isPoint(Mt)||Mt.elementClass===_e.OBJECT_CLASS_TEXT||Mt.type===_e.OBJECT_TYPE_TICKS||Mt.type===_e.OBJECT_TYPE_IMAGE)It=[{num:_t,X:Nt[_t].screenX,Y:Nt[_t].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(Mt,It[0]),this.touches.push({obj:Mt,targets:It}),Mt.highlight(!0);else if(Mt.elementClass===_e.OBJECT_CLASS_LINE||Mt.elementClass===_e.OBJECT_CLASS_CIRCLE||Mt.elementClass===_e.OBJECT_CLASS_CURVE||Mt.type===_e.OBJECT_TYPE_POLYGON){for(Rt=!1,Et=0;Et<this.touches.length;Et++)Mt.id===this.touches[Et].obj.id&&(Rt=!0,this.touches[Et].targets.length===1&&(Ot={num:_t,X:Nt[_t].screenX,Y:Nt[_t].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},this.saveStartPos(Mt,Ot),this.touches[Et].targets.push(Ot)),Nt[_t].jxg_isused=!0);Rt||(It=[{num:_t,X:Nt[_t].screenX,Y:Nt[_t].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(Mt,It[0]),this.touches.push({obj:Mt,targets:It}),Mt.highlight(!0))}}Nt[_t].jxg_isused=!0}return this.touches.length>0&&(vt.preventDefault(),vt.stopPropagation()),this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(vt)||Nt.length!=2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(vt)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[vt]),!1},touchMoveListener:function(vt){var _t,Ct,St,Et=vt[tt.touchProperty];if(this.mode!==this.BOARD_MODE_NONE&&(vt.preventDefault(),vt.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(_t=0;_t<Et.length;_t++)if(!Et[_t].jxg_isused){Ct=this.getMousePosition(vt,_t),this._moveSelecting(Ct),this.triggerEventHandlers(["touchmoves","moveselecting"],[vt,this.mode]);break}}else if(!this.touchOriginMove(vt))if(this.mode===this.BOARD_MODE_DRAG){for(_t=0;_t<this.touches.length;_t++)if(this.touches[_t].targets.length===1){if(Et[this.touches[_t].targets[0].num]){if(Ct=this.getMousePosition(vt,this.touches[_t].targets[0].num),Ct[0]<0||Ct[0]>this.canvasWidth||Ct[1]<0||Ct[1]>this.canvasHeight)return;this.touches[_t].targets[0].X=Et[this.touches[_t].targets[0].num].screenX,this.touches[_t].targets[0].Y=Et[this.touches[_t].targets[0].num].screenY,this.moveObject(Ct[0],Ct[1],this.touches[_t],vt,"touch")}}else if(this.touches[_t].targets.length===2&&this.touches[_t].targets[0].num>-1&&this.touches[_t].targets[1].num>-1&&Et[this.touches[_t].targets[0].num]&&Et[this.touches[_t].targets[1].num]){if(Ct=this.getMousePosition(vt,this.touches[_t].targets[0].num),St=this.getMousePosition(vt,this.touches[_t].targets[1].num),Ct[0]<0||Ct[0]>this.canvasWidth||Ct[1]<0||Ct[1]>this.canvasHeight||St[0]<0||St[0]>this.canvasWidth||St[1]<0||St[1]>this.canvasHeight)return;this.touches[_t].targets[0].X=Et[this.touches[_t].targets[0].num].screenX,this.touches[_t].targets[0].Y=Et[this.touches[_t].targets[0].num].screenY,this.touches[_t].targets[1].X=Et[this.touches[_t].targets[1].num].screenX,this.touches[_t].targets[1].Y=Et[this.touches[_t].targets[1].num].screenY,this.twoFingerMove(Ct,St,this.touches[_t],vt)}}else Et.length==2&&this.gestureChangeListener(vt);return this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move"],[vt,this.mode]),this.mode===this.BOARD_MODE_NONE},touchEndListener:function(vt){var _t,Ct,St,Et,Tt,Mt=this.options.precision.touch,Rt=[],It=vt&&vt[tt.touchProperty];if(this.triggerEventHandlers(["touchend","up"],[vt]),this.showInfobox(!1),this.selectingMode)this._stopSelecting(vt),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[vt]);else if(It&&It.length>0){for(_t=0;_t<this.touches.length;_t++)Rt[_t]=this.touches[_t];for(this.touches.length=0,_t=0;_t<It.length;_t++)It[_t].jxg_isused=!1;for(_t=0;_t<Rt.length;_t++){for(Et=!1,Tt=0,Ct=0;Ct<Rt[_t].targets.length;Ct++)for(Rt[_t].targets[Ct].found=!1,St=0;St<It.length;St++)if(Math.abs(Math.pow(It[St].screenX-Rt[_t].targets[Ct].X,2)+Math.pow(It[St].screenY-Rt[_t].targets[Ct].Y,2))<Mt*Mt){Rt[_t].targets[Ct].found=!0,Rt[_t].targets[Ct].num=St,Rt[_t].targets[Ct].X=It[St].screenX,Rt[_t].targets[Ct].Y=It[St].screenY,Tt+=1;break}if(dt.isPoint(Rt[_t].obj)?Et=Rt[_t].targets[0]&&Rt[_t].targets[0].found:Rt[_t].obj.elementClass===_e.OBJECT_CLASS_LINE?Et=Rt[_t].targets[0]&&Rt[_t].targets[0].found||Rt[_t].targets[1]&&Rt[_t].targets[1].found:Rt[_t].obj.elementClass===_e.OBJECT_CLASS_CIRCLE&&(Et=Tt===1||Tt===3),Et)for(this.touches.push({obj:Rt[_t].obj,targets:[]}),Ct=0;Ct<Rt[_t].targets.length;Ct++)Rt[_t].targets[Ct].found&&this.touches[this.touches.length-1].targets.push({num:Rt[_t].targets[Ct].num,X:Rt[_t].targets[Ct].screenX,Y:Rt[_t].targets[Ct].screenY,Xprev:NaN,Yprev:NaN,Xstart:Rt[_t].targets[Ct].Xstart,Ystart:Rt[_t].targets[Ct].Ystart,Zstart:Rt[_t].targets[Ct].Zstart});else Rt[_t].obj.noHighlight()}}else this.touches.length=0;for(_t=this.downObjects.length-1;_t>-1;_t--){for(Et=!1,Ct=0;Ct<this.touches.length;Ct++)this.touches[Ct].obj.id===this.downObjects[_t].id&&(Et=!0);Et||(this.downObjects[_t].triggerEventHandlers(["touchup","up"],[vt]),this.downObjects[_t].snapToGrid(),this.downObjects[_t].snapToPoints(),this.downObjects.splice(_t,1))}return It&&It.length!==0||(this.hasTouchEnd&&(ft.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(vt){var _t,Ct,St;if(this.document.selection&&dt.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return ft.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,_t=this.getMousePosition(vt),this._testForSelection(vt),this.selectingMode?(this._startSelecting(_t),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[vt])):(Ct=this.initMoveObject(_t[0],_t[1],vt,"mouse"),Ct.length===0?(this.mode=this.BOARD_MODE_NONE,St=!0):(this.mouse={obj:null,targets:[{X:_t[0],Y:_t[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=Ct[Ct.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),vt&&vt.preventDefault?vt.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(St=this.mouseOriginMoveStart(vt)),this.triggerEventHandlers(["mousedown","down"],[vt]),St)},mouseMoveListener:function(vt){var _t;_t=this.getMousePosition(vt),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.selectingMode?(this._moveSelecting(_t),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[vt,this.mode])):this.mouseOriginMove(vt)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(_t[0],_t[1],this.mouse,vt,"mouse"):this.highlightElements(_t[0],_t[1],vt,-1),this.triggerEventHandlers(["mousemove","move"],[vt,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(vt){var _t;if(this.selectingMode===!1&&this.triggerEventHandlers(["mouseup","up"],[vt]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&(this.mouse.obj.snapToGrid(this.mouse.targets[0]),this.mouse.obj.snapToPoints()),this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(vt),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[vt]);else for(_t=0;_t<this.downObjects.length;_t++)this.downObjects[_t].triggerEventHandlers(["mouseup","up"],[vt]);this.downObjects.length=0,this.hasMouseUp&&(ft.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(vt){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(vt,"zoom"))return!0;vt=vt||window.event;var _t=vt.detail?-vt.detail:vt.wheelDelta/40,Ct=new rt(_e.COORDS_BY_SCREEN,this.getMousePosition(vt),this);return _t>0?this.zoomIn(Ct.usrCoords[1],Ct.usrCoords[2]):this.zoomOut(Ct.usrCoords[1],Ct.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[vt]),vt.preventDefault(),!1},initInfobox:function(){var vt=dt.copyAttributes({},this.options,"infobox");return vt.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],vt),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.showInfobox(!1),this},updateInfobox:function(vt){var _t,Ct,St,Et,Tt;return dt.evaluate(vt.visProp.showinfobox)?(dt.isPoint(vt)&&(St=vt.coords.usrCoords[1],Et=vt.coords.usrCoords[2],Tt=dt.evaluate(vt.visProp.infoboxdigits),this.infobox.setCoords(St+this.infobox.distanceX/this.unitX,Et+this.infobox.distanceY/this.unitY),typeof vt.infoboxText!="string"?(Tt==="auto"?(_t=dt.autoDigits(St),Ct=dt.autoDigits(Et)):dt.isNumber(Tt)?(_t=dt.toFixed(St,Tt),Ct=dt.toFixed(Et,Tt)):(_t=St,Ct=Et),this.highlightInfobox(_t,Ct,vt)):this.highlightCustomInfobox(vt.infoboxText,vt),this.showInfobox(!0)),this):this},showInfobox:function(vt){return this.infobox.hiddenByParent==vt&&(this.infobox.hiddenByParent=!vt,this.infobox.prepareUpdate().updateVisibility(vt).updateRenderer()),this},highlightInfobox:function(vt,_t,Ct){return this.highlightCustomInfobox("("+vt+", "+_t+")",Ct),this},highlightCustomInfobox:function(vt,_t){return this.infobox.setText(vt),this},dehighlightAll:function(){var vt,_t,Ct=!1;for(vt in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(vt)&&(_t=this.highlightedObjects[vt],(this.hasMouseHandlers||this.hasPointerHandlers)&&_t.noHighlight(),Ct=!0);return this.highlightedObjects={},this.renderer.type==="canvas"&&Ct&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(vt,_t){return[vt,_t]},getUsrCoordsOfMouse:function(vt){var _t=this.getCoordsTopLeftCorner(),Ct=ft.getPosition(vt,null,this.document),St=Ct[0]-_t[0],Et=Ct[1]-_t[1];return new rt(_e.COORDS_BY_SCREEN,[St,Et],this).usrCoords.slice(1)},getAllUnderMouse:function(vt){var _t=this.getAllObjectsUnderMouse(vt);return _t.push(this.getUsrCoordsOfMouse(vt)),_t},getAllObjectsUnderMouse:function(vt){var _t,Ct,St=this.getCoordsTopLeftCorner(),Et=ft.getPosition(vt,null,this.document),Tt=Et[0]-St[0],Mt=Et[1]-St[1],Rt=[],It=this.objectsList.length;for(_t=0;_t<It;_t++)Ct=this.objectsList[_t],Ct.visPropCalc.visible&&Ct.hasPoint&&Ct.hasPoint(Tt,Mt)&&(Rt[Rt.length]=Ct);return Rt},updateCoords:function(){var vt,_t,Ct=this.objectsList.length;for(_t=0;_t<Ct;_t++)vt=this.objectsList[_t],dt.exists(vt.coords)&&(dt.evaluate(vt.visProp.frozen)?vt.coords.screen2usr():vt.coords.usr2screen());return this},moveOrigin:function(vt,_t,Ct){return dt.exists(vt)&&dt.exists(_t)&&(this.origin.scrCoords[1]=vt,this.origin.scrCoords[2]=_t,Ct&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(vt){var _t,Ct,St,Et,Tt,Mt,Rt,It=[],Ot=`var el, x, y, c, rgbo;
`,Bt=vt.indexOf("<data>"),Nt=vt.indexOf("</data>"),zt=function(Ft,Ut,$t,Vt){return function(){var Zt,qt;Zt=Ft.select(Ut.id),qt=Zt.coords.usrCoords[Vt],Vt===2?Zt.setPositionDirectly(_e.COORDS_BY_USER,[$t(),qt]):Zt.setPositionDirectly(_e.COORDS_BY_USER,[qt,$t()]),Zt.prepareUpdate().update()}},Dt=function(Ft,Ut,$t,Vt){return function(){var Zt,qt;Zt=Ft.select(Ut.id),qt=$t(),Vt==="strokewidth"?Zt.visProp.strokewidth=qt:(qt=ht.rgba2rgbo(qt),Zt.visProp[Vt+"color"]=qt[0],Zt.visProp[Vt+"opacity"]=qt[1])}};if(!(Bt<0)){for(;Bt>=0;){if(_t=vt.slice(Bt+6,Nt),Ct=_t.indexOf("="),St=_t.slice(0,Ct),Et=_t.slice(Ct+1),Ct=St.indexOf("."),Tt=St.slice(0,Ct),Mt=this.elementsByName[dt.unescapeHTML(Tt)],Rt=St.slice(Ct+1).replace(/\s+/g,"").toLowerCase(),Et=dt.createFunction(Et,this,"",!0),dt.exists(this.elementsByName[Tt]))switch(Ot+='el = this.objects["'+Mt.id+`"];
`,Rt){case"x":It.push(zt(this,Mt,Et,2));break;case"y":It.push(zt(this,Mt,Et,1));break;case"visible":It.push(function(Ft,Ut,$t){return function(){var Vt,Zt;Vt=Ft.select(Ut.id),Zt=$t(),Vt.setAttribute({visible:Zt})}}(this,Mt,Et));break;case"position":It.push(function(Ft,Ut,$t){return function(){Ft.select(Ut.id).position=$t()}}(this,Mt,Et));break;case"stroke":It.push(Dt(this,Mt,Et,"stroke"));break;case"style":It.push(function(Ft,Ut,$t){return function(){Ft.select(Ut.id).setStyle($t())}}(this,Mt,Et));break;case"strokewidth":It.push(Dt(this,Mt,Et,"strokewidth"));break;case"fill":It.push(Dt(this,Mt,Et,"fill"));break;case"label":break;default:tt.debug("property '"+Rt+"' in conditions not yet implemented:"+Et)}else tt.debug("debug conditions: |"+Tt+"| undefined");vt=vt.slice(Nt+7),Bt=vt.indexOf("<data>"),Nt=vt.indexOf("</data>")}this.updateConditions=function(){var Ft;for(Ft=0;Ft<It.length;Ft++)It[Ft]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var vt=new rt(_e.COORDS_BY_USER,[0,0],this),_t=new rt(_e.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),Ct=vt.scrCoords[1]-_t.scrCoords[1],St=vt.scrCoords[2]-_t.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(Ct)>25;)this.options.grid.snapSizeX*=2,Ct/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(St)>25;)this.options.grid.snapSizeY*=2,St/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(vt,_t){var Ct=this.getBoundingBox(),St=this.attr.zoom.factorx,Et=this.attr.zoom.factory,Tt=(Ct[2]-Ct[0])*(1-1/St),Mt=(Ct[1]-Ct[3])*(1-1/Et),Rt=.5,It=.5,Ot=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&St>1||this.zoomY>this.attr.zoom.max&&Et>1||this.zoomX<Ot&&St<1||this.zoomY<Ot&&Et<1?this:(dt.isNumber(vt)&&dt.isNumber(_t)&&(Rt=(vt-Ct[0])/(Ct[2]-Ct[0]),It=(Ct[1]-_t)/(Ct[1]-Ct[3])),this.setBoundingBox([Ct[0]+Tt*Rt,Ct[1]-Mt*It,Ct[2]-Tt*(1-Rt),Ct[3]+Mt*(1-It)],!1),this.zoomX*=St,this.zoomY*=Et,this.applyZoom())},zoomOut:function(vt,_t){var Ct=this.getBoundingBox(),St=this.attr.zoom.factorx,Et=this.attr.zoom.factory,Tt=(Ct[2]-Ct[0])*(1-St),Mt=(Ct[1]-Ct[3])*(1-Et),Rt=.5,It=.5,Ot=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<Ot||this.zoomY<Ot?this:(dt.isNumber(vt)&&dt.isNumber(_t)&&(Rt=(vt-Ct[0])/(Ct[2]-Ct[0]),It=(Ct[1]-_t)/(Ct[1]-Ct[3])),this.setBoundingBox([Ct[0]+Tt*Rt,Ct[1]-Mt*It,Ct[2]-Tt*(1-Rt),Ct[3]+Mt*(1-It)],!1),this.zoomX/=St,this.zoomY/=Et,this.applyZoom())},zoom100:function(){var vt=this.getBoundingBox(),_t=(vt[2]-vt[0])*(1-this.zoomX)*.5,Ct=(vt[1]-vt[3])*(1-this.zoomY)*.5;return this.setBoundingBox([vt[0]+_t,vt[1]-Ct,vt[2]-_t,vt[3]+Ct],!1),this.zoomX=1,this.zoomY=1,this.applyZoom()},zoomAllPoints:function(){var vt,_t,Ct,St,Et,Tt=0,Mt=0,Rt=0,It=0,Ot=this.objectsList.length;for(vt=0;vt<Ot;vt++)Et=this.objectsList[vt],dt.isPoint(Et)&&Et.visPropCalc.visible&&(Et.coords.usrCoords[1]<Tt?Tt=Et.coords.usrCoords[1]:Et.coords.usrCoords[1]>Mt&&(Mt=Et.coords.usrCoords[1]),Et.coords.usrCoords[2]>It?It=Et.coords.usrCoords[2]:Et.coords.usrCoords[2]<Rt&&(Rt=Et.coords.usrCoords[2]));return _t=50,Ct=_t/this.unitX,St=_t/this.unitY,this.zoomX=1,this.zoomY=1,this.setBoundingBox([Tt-Ct,It+St,Mt+Ct,Rt-St],!0),this.applyZoom()},zoomElements:function(vt){var _t,Ct,St,Et,Tt=[0,0,0,0],Mt=[1,-1,-1,1];if(!dt.isArray(vt)||vt.length===0)return this;for(_t=0;_t<vt.length;_t++)if(St=this.select(vt[_t]),Et=St.bounds(),dt.isArray(Et))if(dt.isArray(Tt))for(Ct=0;Ct<4;Ct++)Mt[Ct]*Et[Ct]<Mt[Ct]*Tt[Ct]&&(Tt[Ct]=Et[Ct]);else Tt=Et;if(dt.isArray(Tt)){for(Ct=0;Ct<4;Ct++)Tt[Ct]-=Mt[Ct];this.zoomX=1,this.zoomY=1,this.setBoundingBox(Tt,!0)}return this},setZoom:function(vt,_t){var Ct=this.attr.zoom.factorx,St=this.attr.zoom.factory;return this.attr.zoom.factorx=vt/this.zoomX,this.attr.zoom.factory=_t/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=Ct,this.attr.zoom.factory=St,this},removeObject:function(vt){var _t,Ct;if(dt.isArray(vt)){for(Ct=0;Ct<vt.length;Ct++)this.removeObject(vt[Ct]);return this}if(vt=this.select(vt),!dt.exists(vt)||dt.isString(vt))return this;try{for(_t in vt.childElements)vt.childElements.hasOwnProperty(_t)&&vt.childElements[_t].board.removeObject(vt.childElements[_t]);for(_t in vt.objects)vt.objects.hasOwnProperty(_t)&&vt.objects[_t].board.removeObject(vt.objects[_t]);for(_t in this.objects)this.objects.hasOwnProperty(_t)&&dt.exists(this.objects[_t].childElements)&&(delete this.objects[_t].childElements[vt.id],delete this.objects[_t].descendants[vt.id]);if(vt._pos>-1)for(this.objectsList.splice(vt._pos,1),_t=vt._pos;_t<this.objectsList.length;_t++)this.objectsList[_t]._pos--;else vt.type!==_e.OBJECT_TYPE_TURTLE&&tt.debug("Board.removeObject: object "+vt.id+" not found in list.");delete this.objects[vt.id],delete this.elementsByName[vt.name],vt.visProp&&dt.evaluate(vt.visProp.trace)&&vt.clearTrace(),dt.exists(vt.remove)&&vt.remove()}catch(St){tt.debug(vt.id+": Could not be removed: "+St)}return this.update(),this},removeAncestors:function(vt){var _t;for(_t in vt.ancestors)vt.ancestors.hasOwnProperty(_t)&&this.removeAncestors(vt.ancestors[_t]);return this.removeObject(vt),this},initGeonextBoard:function(){var vt,_t,Ct;return vt=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),_t=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),Ct=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[vt,_t],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[vt,Ct],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(vt,_t,Ct,St){var Et;return St||(Et=this.getBoundingBox()),this.canvasWidth=parseInt(vt,10),this.canvasHeight=parseInt(_t,10),Ct||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),St||this.setBoundingBox(Et,this.keepaspectratio),this},showDependencies:function(){var vt,_t,Ct,St,Et;_t=`<p>
`;for(vt in this.objects)if(this.objects.hasOwnProperty(vt)){Et=0;for(Ct in this.objects[vt].childElements)this.objects[vt].childElements.hasOwnProperty(Ct)&&(Et+=1);Et>=0&&(_t+="<strong>"+this.objects[vt].id+":</strong> ");for(Ct in this.objects[vt].childElements)this.objects[vt].childElements.hasOwnProperty(Ct)&&(_t+=this.objects[vt].childElements[Ct].id+"("+this.objects[vt].childElements[Ct].name+"), ");_t+=`<p>
`}return _t+=`</p>
`,St=window.open(),St.document.open(),St.document.write(_t),St.document.close(),this},showXML:function(){var vt=window.open("");return vt.document.open(),vt.document.write("<pre>"+dt.escapeHTML(this.xmlString)+"</pre>"),vt.document.close(),this},prepareUpdate:function(){var vt,_t,Ct=this.objectsList.length;for(vt=0;vt<Ct;vt++)_t=this.objectsList[vt],_t.needsUpdate=_t.needsRegularUpdate||this.needsFullUpdate;for(vt in this.groups)this.groups.hasOwnProperty(vt)&&(_t=this.groups[vt],_t.needsUpdate=_t.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(vt){var _t,Ct;for(vt=this.select(vt),_t=0;_t<this.objectsList.length;_t++)Ct=this.objectsList[_t],Ct.update(!dt.exists(vt)||Ct.id!==vt.id).updateVisibility();for(_t in this.groups)this.groups.hasOwnProperty(_t)&&this.groups[_t].update(vt);return this},updateRenderer:function(){var vt,_t=this.objectsList.length;if(this.renderer.type==="canvas")this.updateRendererCanvas();else for(vt=0;vt<_t;vt++)this.objectsList[vt].updateRenderer();return this},updateRendererCanvas:function(){var vt,_t,Ct,St,Et,Tt=this.objectsList.length,Mt=this.options.layer,Rt=this.options.layer.numlayers,It=Number.NEGATIVE_INFINITY;for(Ct=0;Ct<Rt;Ct++){St=Number.POSITIVE_INFINITY;for(Et in Mt)Mt.hasOwnProperty(Et)&&Mt[Et]>It&&Mt[Et]<St&&(St=Mt[Et]);for(It=St,vt=0;vt<Tt;vt++)_t=this.objectsList[vt],_t.visProp.layer===St&&_t.prepareUpdate().updateRenderer()}return this},addHook:function(vt,_t,Ct){return tt.deprecated("Board.addHook()","Board.on()"),_t=dt.def(_t,"update"),Ct=dt.def(Ct,this),this.hooks.push([_t,vt]),this.on(_t,vt,Ct),this.hooks.length-1},addEvent:tt.shortcut(tt.Board.prototype,"on"),removeHook:function(vt){return tt.deprecated("Board.removeHook()","Board.off()"),this.hooks[vt]&&(this.off(this.hooks[vt][0],this.hooks[vt][1]),this.hooks[vt]=null),this},removeEvent:tt.shortcut(tt.Board.prototype,"off"),updateHooks:function(vt){var _t=Array.prototype.slice.call(arguments,0);return tt.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),_t[0]=dt.def(_t[0],"update"),this.triggerEventHandlers([_t[0]],arguments),this},addChild:function(vt){return dt.exists(vt)&&dt.exists(vt.containerObj)&&(this.dependentBoards.push(vt),this.update()),this},removeChild:function(vt){var _t;for(_t=this.dependentBoards.length-1;_t>=0;_t--)this.dependentBoards[_t]===vt&&this.dependentBoards.splice(_t,1);return this},update:function(vt){var _t,Ct,St,Et;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,this.attr.minimizereflow==="all"&&this.containerObj&&this.renderer.type!=="vml"&&(Et=this.renderer.removeToInsertLater(this.containerObj)),this.attr.minimizereflow==="svg"&&this.renderer.type==="svg"&&(Et=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(vt).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),Et&&Et(),Ct=this.dependentBoards.length,_t=0;_t<Ct;_t++)St=this.dependentBoards[_t],dt.exists(St)&&St!==this&&(St.updateQuality=this.updateQuality,St.prepareUpdate().updateElements().updateConditions(),St.renderer.suspendRedraw(),St.updateRenderer(),St.renderer.unsuspendRedraw(),St.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var vt;for(vt=0;vt<this.grids.length;vt++)this.removeObject(this.grids[vt]);return this.grids.length=0,this.update(),this},create:function(vt,_t,Ct){var St,Et;for(vt=vt.toLowerCase(),dt.exists(_t)||(_t=[]),dt.exists(Ct)||(Ct={}),Et=0;Et<_t.length;Et++)dt.isString(_t[Et])&&(vt!=="text"||Et!==2)&&(vt!=="input"&&vt!=="checkbox"&&vt!=="button"||Et!==2&&Et!==3)&&(_t[Et]=this.select(_t[Et]));if(!dt.isFunction(tt.elements[vt]))throw new Error("JSXGraph: create: Unknown element type given: "+vt);return St=tt.elements[vt](this,_t,Ct),dt.exists(St)?(St.prepareUpdate&&St.update&&St.updateRenderer&&St.fullUpdate(),St):(tt.debug("JSXGraph: create: failure creating "+vt),St)},createElement:function(){return tt.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var vt;for(vt=0;vt<this.objectsList.length;vt++)this.objectsList[vt].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(vt,_t){var Ct,St,Et=ft.getDimensions(this.container,this.document);return dt.isArray(vt)?(this.plainBB=vt,this.canvasWidth=parseInt(Et.width,10),this.canvasHeight=parseInt(Et.height,10),St=this.canvasWidth,Ct=this.canvasHeight,_t?(this.unitX=St/(vt[2]-vt[0]),this.unitY=Ct/(vt[1]-vt[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY):this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),this.keepaspectratio=!0):(this.unitX=St/(vt[2]-vt[0]),this.unitY=Ct/(vt[1]-vt[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*vt[0],this.unitY*vt[1]),this):this},getBoundingBox:function(){var vt=new rt(_e.COORDS_BY_SCREEN,[0,0],this),_t=new rt(_e.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[vt.usrCoords[1],vt.usrCoords[2],_t.usrCoords[1],_t.usrCoords[2]]},addAnimation:function(vt){var _t=this;return this.animationObjects[vt.id]=vt,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval(function(){_t.animate()},vt.board.attr.animationdelay)),this},stopAllAnimation:function(){var vt;for(vt in this.animationObjects)this.animationObjects.hasOwnProperty(vt)&&dt.exists(this.animationObjects[vt])&&(this.animationObjects[vt]=null,delete this.animationObjects[vt]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It=0,Ot=null;for(_t in this.animationObjects)if(this.animationObjects.hasOwnProperty(_t)&&dt.exists(this.animationObjects[_t])){if(It+=1,Ct=this.animationObjects[_t],Ct.animationPath&&(St=dt.isFunction(Ct.animationPath)?Ct.animationPath(new Date().getTime()-Ct.animationStart):Ct.animationPath.pop(),!dt.exists(St)||!dt.isArray(St)&&isNaN(St)?delete Ct.animationPath:(Ct.setPositionDirectly(_e.COORDS_BY_USER,St),Ct.fullUpdate(),Ot=Ct)),Ct.animationData){Mt=0;for(Et in Ct.animationData)Ct.animationData.hasOwnProperty(Et)&&(Tt=Ct.animationData[Et].pop(),dt.exists(Tt)?(Mt+=1,vt={},vt[Et]=Tt,Ct.setAttribute(vt)):delete Ct.animationData[Tt]);Mt===0&&delete Ct.animationData}dt.exists(Ct.animationData)||dt.exists(Ct.animationPath)||(this.animationObjects[_t]=null,delete this.animationObjects[_t],dt.exists(Ct.animationCallback)&&(Rt=Ct.animationCallback,Ct.animationCallback=null,Rt()))}return It===0?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(Ot),this},migratePoint:function(vt,_t,Ct){var St,Et,Tt,Mt,Rt,It,Ot=!1;vt=this.select(vt),_t=this.select(_t),dt.exists(vt.label)&&(It=vt.label.id,Ot=!0,this.removeObject(vt.label));for(Et in vt.childElements)if(vt.childElements.hasOwnProperty(Et)){St=vt.childElements[Et],Mt=!1;for(Tt in St)St.hasOwnProperty(Tt)&&St[Tt]===vt&&(St[Tt]=_t,Mt=!0);for(Mt&&delete vt.childElements[Et],Rt=0;Rt<St.parents.length;Rt++)St.parents[Rt]===vt.id&&(St.parents[Rt]=_t.id);_t.addChild(St)}return Ct&&(Ot&&(delete _t.childElements[It],delete _t.descendants[It]),_t.label&&this.removeObject(_t.label),delete this.elementsByName[_t.name],_t.name=vt.name,Ot&&_t.createLabel()),this.removeObject(vt),dt.exists(_t.name)&&_t.name!==""&&(this.elementsByName[_t.name]=_t),this.fullUpdate(),this},emulateColorblindness:function(vt){var _t,Ct;if(dt.exists(vt)||(vt="none"),this.currentCBDef===vt)return this;for(_t in this.objects)this.objects.hasOwnProperty(_t)&&(Ct=this.objects[_t],vt!=="none"?(this.currentCBDef==="none"&&(Ct.visPropOriginal={strokecolor:Ct.visProp.strokecolor,fillcolor:Ct.visProp.fillcolor,highlightstrokecolor:Ct.visProp.highlightstrokecolor,highlightfillcolor:Ct.visProp.highlightfillcolor}),Ct.setAttribute({strokecolor:ht.rgb2cb(dt.evaluate(Ct.visPropOriginal.strokecolor),vt),fillcolor:ht.rgb2cb(dt.evaluate(Ct.visPropOriginal.fillcolor),vt),highlightstrokecolor:ht.rgb2cb(dt.evaluate(Ct.visPropOriginal.highlightstrokecolor),vt),highlightfillcolor:ht.rgb2cb(dt.evaluate(Ct.visPropOriginal.highlightfillcolor),vt)})):dt.exists(Ct.visPropOriginal)&&tt.extend(Ct.visProp,Ct.visPropOriginal));return this.currentCBDef=vt,this.update(),this},select:function(vt){var _t,Ct,St,Et,Tt=vt;if(Tt===null)return Tt;if(dt.isString(Tt)&&Tt!=="")dt.exists(this.objects[Tt])?Tt=this.objects[Tt]:dt.exists(this.elementsByName[Tt])?Tt=this.elementsByName[Tt]:dt.exists(this.groups[Tt])&&(Tt=this.groups[Tt]);else if(dt.isFunction(Tt)||dt.isObject(Tt)&&!dt.isFunction(Tt.setAttribute)){for(_t=dt.filterElements(this.objectsList,Tt),Ct={},Et=_t.length,St=0;St<Et;St++)Ct[_t[St].id]=_t[St];Tt=new xt(Ct)}else dt.isObject(Tt)&&dt.exists(Tt.id)&&!dt.exists(this.objects[Tt.id])&&(Tt=null);return Tt},hasPoint:function(vt,_t){var Ct=vt,St=_t,Et=this.getBoundingBox();return dt.exists(vt)&&dt.isArray(vt.usrCoords)&&(Ct=vt.usrCoords[1],St=vt.usrCoords[2]),!!(dt.isNumber(Ct)&&dt.isNumber(St)&&Et[0]<Ct&&Ct<Et[2]&&Et[1]>St&&St>Et[3])},updateCSSTransforms:function(){var vt=this.containerObj,_t=vt,Ct=vt;for(this.cssTransMat=ft.getCSSTransformMatrix(_t),_t=_t.offsetParent;_t;){for(this.cssTransMat=st.matMatMult(ft.getCSSTransformMatrix(_t),this.cssTransMat),Ct=Ct.parentNode;Ct!==_t;)this.cssTransMat=st.matMatMult(ft.getCSSTransformMatrix(_t),this.cssTransMat),Ct=Ct.parentNode;_t=_t.offsetParent}return this.cssTransMat=st.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(vt){this.isSelecting=!0,this.selectingBox=[[vt[0],vt[1]],[vt[0],vt[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(vt){this.isSelecting&&(this.selectingBox[1]=[vt[0],vt[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(vt){var _t=this.getMousePosition(vt);this.isSelecting=!1,this.selectingBox[1]=[_t[0],_t[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var vt=this.selectingBox[0],_t=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(tt.COORDS_BY_SCREEN,[vt[0],vt[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(tt.COORDS_BY_SCREEN,[vt[0],_t[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(tt.COORDS_BY_SCREEN,[_t[0],_t[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(tt.COORDS_BY_SCREEN,[_t[0],vt[1]])},_testForSelection:function(vt){this._isRequiredKeyPressed(vt,"selection")&&(dt.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(vt){var _t;return dt.exists(this.selectionPolygon)||(_t=dt.copyAttributes(vt,it,"board","selection"),_t.enabled===!0&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],_t))),this},__evt__down:function(vt){},__evt__mousedown:function(vt){},__evt__pointerdown:function(vt){},__evt__touchstart:function(vt){},__evt__up:function(vt){},__evt__mouseup:function(vt){},__evt__pointerup:function(vt){},__evt__touchend:function(vt){},__evt__move:function(vt,_t){},__evt__mousemove:function(vt,_t){},__evt__pointermove:function(vt,_t){},__evt__touchmove:function(vt,_t){},__evt__hit:function(vt,_t,Ct){},__evt__mousehit:function(vt,_t,Ct){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},createRoulette:function(vt,_t,Ct,St,Et,Tt,Mt){var Rt=this;return new function(){var It,Ot=0,Bt=0,Nt=0,zt=Ct,Dt=nt.root(function(ar){var lr=vt.X(zt),gr=vt.Y(zt),Yt=_t.X(ar),nr=_t.Y(ar);return(lr-Yt)*(lr-Yt)+(gr-nr)*(gr-nr)},[0,2*Math.PI]),Ft=0,Ut=0,$t=Rt.create("transform",[function(){return Ot}],{type:"rotate"}),Vt=Rt.create("transform",[function(){return Ot},function(){return vt.X(zt)},function(){return vt.Y(zt)}],{type:"rotate"}),Zt=Rt.create("transform",[function(){return Bt},function(){return Nt}],{type:"translate"}),qt=function(ar,lr,gr){var Yt=nt.D(ar.X)(lr),nr=nt.D(ar.Y)(lr),mr=nt.D(ar.X)(gr),Sr=nt.D(ar.Y)(gr),Er=nt.D(ar.X)(.5*(lr+gr)),Nr=nt.D(ar.Y)(.5*(lr+gr)),wr=Math.sqrt(Yt*Yt+nr*nr),kr=Math.sqrt(mr*mr+Sr*Sr);return(wr+4*Math.sqrt(Er*Er+Nr*Nr)+kr)*(gr-lr)/6},sr=function(ar){return It-qt(_t,Dt,ar)},er=Math.PI/18,ir=9*er,ur=null;return this.rolling=function(){var ar,lr,gr,Yt,nr;Ft=zt+Et*St,It=qt(vt,zt,Ft),Ut=nt.root(sr,Dt),ar=new lt(vt.X(Ft),vt.Y(Ft)),lr=new lt(_t.X(Ut),_t.Y(Ut)),gr=new lt(nt.D(vt.X)(Ft),nt.D(vt.Y)(Ft)),Yt=new lt(nt.D(_t.X)(Ut),nt.D(_t.Y)(Ut)),nr=lt.C.div(gr,Yt),Ot=Math.atan2(nr.imaginary,nr.real),nr.div(lt.C.abs(nr)),nr.mult(lr),Bt=ar.real-nr.real,Nt=ar.imaginary-nr.imaginary,Ot<-er&&Ot>-ir?(Ot=-er,Vt.applyOnce(Mt)):Ot>er&&Ot<ir?(Ot=er,Vt.applyOnce(Mt)):($t.applyOnce(Mt),Zt.applyOnce(Mt),zt=Ft,Dt=Ut),Rt.update()},this.start=function(){return Tt>0&&(ur=window.setInterval(this.rolling,Tt)),this},this.stop=function(){return window.clearInterval(ur),this},this}}}),tt.Board}),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/env","utils/color","utils/base64","math/numerics"],function(tt,_e,rt,it,nt,st,at,lt,ot){return tt.SVGRenderer=function(ct,ut){var ht;for(this.type="svg",this.isIE=navigator.appVersion.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=ct,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.resize(ut.width,ut.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],ht=0;ht<_e.layer.numlayers;ht++)this.layer[ht]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[ht]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},tt.SVGRenderer.prototype=new rt,tt.extend(tt.SVGRenderer.prototype,{_createArrowHead:function(ct,ut){var ht,dt,pt=ct.id+"Triangle",ft=null,gt=nt.evaluate(ct.visProp.firstarrow),mt=nt.evaluate(ct.visProp.lastarrow);return nt.exists(ut)&&(pt+=ut),ht=this.createPrim("marker",pt),ht.setAttributeNS(null,"stroke",nt.evaluate(ct.visProp.strokecolor)),ht.setAttributeNS(null,"stroke-opacity",nt.evaluate(ct.visProp.strokeopacity)),ht.setAttributeNS(null,"fill",nt.evaluate(ct.visProp.strokecolor)),ht.setAttributeNS(null,"fill-opacity",nt.evaluate(ct.visProp.strokeopacity)),ht.setAttributeNS(null,"stroke-width",0),ht.setAttributeNS(null,"orient","auto"),ht.setAttributeNS(null,"markerUnits","strokeWidth"),dt=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),ut==="End"?(tt.exists(gt.type)&&(ft=nt.evaluate(gt.type)),ht.setAttributeNS(null,"refY",5),ft===2?(ht.setAttributeNS(null,"refX",4.9),dt.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z")):ft===3?(ht.setAttributeNS(null,"refX",3.33),dt.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(ht.setAttributeNS(null,"refX",9.9),dt.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"))):(tt.exists(mt.type)&&(ft=nt.evaluate(mt.type)),ht.setAttributeNS(null,"refY",5),ft===2?(ht.setAttributeNS(null,"refX",5.1),dt.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z")):ft===3?(ht.setAttributeNS(null,"refX",.1),dt.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(ht.setAttributeNS(null,"refX",.1),dt.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"))),ht.appendChild(dt),ht},_setArrowColor:function(ct,ut,ht,dt){ct&&(nt.isString(ut)&&this._setAttribute(function(){ct.setAttributeNS(null,"stroke",ut),ct.setAttributeNS(null,"fill",ut),ct.setAttributeNS(null,"stroke-opacity",ht),ct.setAttributeNS(null,"fill-opacity",ht)},dt.visPropOld.fillcolor),this.isIE&&dt.rendNode.parentNode.insertBefore(dt.rendNode,dt.rendNode))},_setArrowWidth:function(ct,ut,ht,dt){var pt,ft;ct&&(ut===0?ct.setAttributeNS(null,"display","none"):(pt=ut,ft=pt*dt,ct.setAttributeNS(null,"viewBox","0 0 "+10*pt+" "+10*pt),ct.setAttributeNS(null,"markerHeight",ft),ct.setAttributeNS(null,"markerWidth",ft),ct.setAttributeNS(null,"display","inherit")),this.isIE&&ht.parentNode.insertBefore(ht,ht))},updateTicks:function(ct){var ut,ht,dt,pt,ft,gt="",mt=ct.ticks.length;for(ut=0;ut<mt;ut++)ht=ct.ticks[ut],pt=ht[0],ft=ht[1],nt.isNumber(pt[0])&&nt.isNumber(pt[1])&&(gt+="M "+pt[0]+" "+ft[0]+" L "+pt[1]+" "+ft[1]+" ");dt=ct.rendNode,nt.exists(dt)||(dt=this.createPrim("path",ct.id),this.appendChildPrim(dt,nt.evaluate(ct.visProp.layer)),ct.rendNode=dt),dt.setAttributeNS(null,"stroke",nt.evaluate(ct.visProp.strokecolor)),dt.setAttributeNS(null,"stroke-opacity",nt.evaluate(ct.visProp.strokeopacity)),dt.setAttributeNS(null,"stroke-width",nt.evaluate(ct.visProp.strokewidth)),this.updatePathPrim(dt,gt,ct.board)},displayCopyright:function(ct,ut){var ht,dt=this.createPrim("text","licenseText");dt.setAttributeNS(null,"x","20px"),dt.setAttributeNS(null,"y",2+ut+"px"),dt.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+ut+"px; fill:#356AA0;  opacity:0.3;"),ht=this.container.ownerDocument.createTextNode(ct),dt.appendChild(ht),this.appendChildPrim(dt,0)},drawInternalText:function(ct){var ut=this.createPrim("text",ct.id);return ut.style.whiteSpace="nowrap",ct.rendNodeText=this.container.ownerDocument.createTextNode(""),ut.appendChild(ct.rendNodeText),this.appendChildPrim(ut,nt.evaluate(ct.visProp.layer)),ut},updateInternalText:function(ct){var ut,ht=ct.plaintext,dt=ct.getAnchorX(),pt=ct.getAnchorY();ct.rendNode.getAttributeNS(null,"class")!==ct.visProp.cssclass&&(ct.rendNode.setAttributeNS(null,"class",nt.evaluate(ct.visProp.cssclass)),ct.needsSizeUpdate=!0),isNaN(ct.coords.scrCoords[1]+ct.coords.scrCoords[2])||(ut=ct.coords.scrCoords[1],ct.visPropOld.left!==dt+ut&&(ct.rendNode.setAttributeNS(null,"x",ut+"px"),dt==="left"?ct.rendNode.setAttributeNS(null,"text-anchor","start"):dt==="right"?ct.rendNode.setAttributeNS(null,"text-anchor","end"):dt==="middle"&&ct.rendNode.setAttributeNS(null,"text-anchor","middle"),ct.visPropOld.left=dt+ut),ut=ct.coords.scrCoords[2],ct.visPropOld.top!==pt+ut&&(ct.rendNode.setAttributeNS(null,"y",ut+.5*this.vOffsetText+"px"),pt==="bottom"?ct.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):pt==="top"?ct.rendNode.setAttributeNS(null,"dy","1.6ex"):pt==="middle"&&ct.rendNode.setAttributeNS(null,"dy","0.6ex"),ct.visPropOld.top=pt+ut)),ct.htmlStr!==ht&&(ct.rendNodeText.data=ht,ct.htmlStr=ht),this.transformImage(ct,ct.transformations)},updateInternalTextStyle:function(ct,ut,ht,dt){this.setObjectFillColor(ct,ut,ht)},drawImage:function(ct){var ut=this.createPrim("image",ct.id);ut.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(ut,nt.evaluate(ct.visProp.layer)),ct.rendNode=ut,this.updateImage(ct)},transformImage:function(ct,ut){var ht,dt,pt=ct.rendNode,ft="";ut.length>0&&(dt=this.joinTransforms(ct,ut),ht=[dt[1][1],dt[2][1],dt[1][2],dt[2][2],dt[1][0],dt[2][0]].join(","),ft+=" matrix("+ht+") ",pt.setAttributeNS(null,"transform",ft))},updateImageURL:function(ct){var ut=nt.evaluate(ct.url);ct.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",ut)},updateImageStyle:function(ct,ut){var ht=nt.evaluate(ut?ct.visProp.highlightcssclass:ct.visProp.cssclass);ct.rendNode.setAttributeNS(null,"class",ht)},appendChildPrim:function(ct,ut){return nt.exists(ut)?ut>=_e.layer.numlayers&&(ut=_e.layer.numlayers-1):ut=0,this.layer[ut].appendChild(ct),ct},createPrim:function(ct,ut){var ht=this.container.ownerDocument.createElementNS(this.svgNamespace,ct);return ht.setAttributeNS(null,"id",this.container.id+"_"+ut),ht.style.position="absolute",ct==="path"&&(ht.setAttributeNS(null,"stroke-linecap","round"),ht.setAttributeNS(null,"stroke-linejoin","round")),ht},remove:function(ct){nt.exists(ct)&&nt.exists(ct.parentNode)&&ct.parentNode.removeChild(ct)},makeArrows:function(ct){var ut,ht=nt.evaluate(ct.visProp.firstarrow),dt=nt.evaluate(ct.visProp.lastarrow);if(ct.visPropOld.firstarrow===ht&&ct.visPropOld.lastarrow===dt)return void(this.isIE&&ct.visPropCalc.visible&&(ht||dt)&&ct.rendNode.parentNode.insertBefore(ct.rendNode,ct.rendNode));ht?(ut=ct.rendNodeTriangleStart,nt.exists(ut)?this.defs.appendChild(ut):(ut=this._createArrowHead(ct,"End"),this.defs.appendChild(ut),ct.rendNodeTriangleStart=ut,ct.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+ct.id+"TriangleEnd)"))):(ut=ct.rendNodeTriangleStart,nt.exists(ut)&&this.remove(ut)),dt?(ut=ct.rendNodeTriangleEnd,nt.exists(ut)?this.defs.appendChild(ut):(ut=this._createArrowHead(ct,"Start"),this.defs.appendChild(ut),ct.rendNodeTriangleEnd=ut,ct.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+ct.id+"TriangleStart)"))):(ut=ct.rendNodeTriangleEnd,nt.exists(ut)&&this.remove(ut)),ct.visPropOld.firstarrow=ht,ct.visPropOld.lastarrow=dt},updateEllipsePrim:function(ct,ut,ht,dt,pt){var ft=1e6;ft=2e5,ut=Math.abs(ut)<ft?ut:ft*ut/Math.abs(ut),ht=Math.abs(ht)<ft?ht:ft*ht/Math.abs(ht),dt=Math.abs(dt)<ft?dt:ft*dt/Math.abs(dt),pt=Math.abs(pt)<ft?pt:ft*pt/Math.abs(pt),ct.setAttributeNS(null,"cx",ut),ct.setAttributeNS(null,"cy",ht),ct.setAttributeNS(null,"rx",Math.abs(dt)),ct.setAttributeNS(null,"ry",Math.abs(pt))},updateLinePrim:function(ct,ut,ht,dt,pt){var ft=1e6;ft=2e5,isNaN(ut+ht+dt+pt)||(ut=Math.abs(ut)<ft?ut:ft*ut/Math.abs(ut),ht=Math.abs(ht)<ft?ht:ft*ht/Math.abs(ht),dt=Math.abs(dt)<ft?dt:ft*dt/Math.abs(dt),pt=Math.abs(pt)<ft?pt:ft*pt/Math.abs(pt),ct.setAttributeNS(null,"x1",ut),ct.setAttributeNS(null,"y1",ht),ct.setAttributeNS(null,"x2",dt),ct.setAttributeNS(null,"y2",pt))},updatePathPrim:function(ct,ut){ut===""&&(ut="M 0 0"),ct.setAttributeNS(null,"d",ut)},updatePathStringPoint:function(ct,ut,ht){var dt="",pt=ct.coords.scrCoords,ft=ut*Math.sqrt(3)*.5,gt=.5*ut;return ht==="x"?dt=" M "+(pt[1]-ut)+" "+(pt[2]-ut)+" L "+(pt[1]+ut)+" "+(pt[2]+ut)+" M "+(pt[1]+ut)+" "+(pt[2]-ut)+" L "+(pt[1]-ut)+" "+(pt[2]+ut):ht==="+"?dt=" M "+(pt[1]-ut)+" "+pt[2]+" L "+(pt[1]+ut)+" "+pt[2]+" M "+pt[1]+" "+(pt[2]-ut)+" L "+pt[1]+" "+(pt[2]+ut):ht==="<>"?dt=" M "+(pt[1]-ut)+" "+pt[2]+" L "+pt[1]+" "+(pt[2]+ut)+" L "+(pt[1]+ut)+" "+pt[2]+" L "+pt[1]+" "+(pt[2]-ut)+" Z ":ht==="^"?dt=" M "+pt[1]+" "+(pt[2]-ut)+" L "+(pt[1]-ft)+" "+(pt[2]+gt)+" L "+(pt[1]+ft)+" "+(pt[2]+gt)+" Z ":ht==="v"?dt=" M "+pt[1]+" "+(pt[2]+ut)+" L "+(pt[1]-ft)+" "+(pt[2]-gt)+" L "+(pt[1]+ft)+" "+(pt[2]-gt)+" Z ":ht===">"?dt=" M "+(pt[1]+ut)+" "+pt[2]+" L "+(pt[1]-gt)+" "+(pt[2]-ft)+" L "+(pt[1]-gt)+" "+(pt[2]+ft)+" Z ":ht==="<"&&(dt=" M "+(pt[1]-ut)+" "+pt[2]+" L "+(pt[1]+gt)+" "+(pt[2]-ft)+" L "+(pt[1]+gt)+" "+(pt[2]+ft)+" Z "),dt},updatePathStringPrim:function(ct){var ut,ht,dt,pt=" M ",ft="";if(ct.numberPoints<=0)return"";if(dt=Math.min(ct.points.length,ct.numberPoints),ct.bezierDegree===1)for(ut=0;ut<dt;ut++)ht=ct.points[ut].scrCoords,isNaN(ht[1])||isNaN(ht[2])?pt=" M ":(ht[1]=Math.max(Math.min(ht[1],5e3),-5e3),ht[2]=Math.max(Math.min(ht[2],5e3),-5e3),ft+=pt+ht[1]+" "+ht[2],pt=" L ");else if(ct.bezierDegree===3)for(ut=0;ut<dt;)ht=ct.points[ut].scrCoords,isNaN(ht[1])||isNaN(ht[2])?pt=" M ":(ft+=pt+ht[1]+" "+ht[2],pt===" C "&&(ut+=1,ht=ct.points[ut].scrCoords,ft+=" "+ht[1]+" "+ht[2],ut+=1,ht=ct.points[ut].scrCoords,ft+=" "+ht[1]+" "+ht[2]),pt=" C "),ut+=1;return ft},updatePathStringBezierPrim:function(ct){var ut,ht,dt,pt,ft,gt,mt,At=" M ",yt="",bt=nt.evaluate(ct.visProp.strokewidth),xt=nt.evaluate(ct.visProp.curvetype)!=="plot";if(ct.numberPoints<=0)return"";for(xt&&ct.board.options.curve.RDPsmoothing&&(ct.points=ot.RamerDouglasPeucker(ct.points,.5)),mt=Math.min(ct.points.length,ct.numberPoints),ht=1;ht<3;ht++)for(At=" M ",ut=0;ut<mt;ut++)pt=ct.points[ut].scrCoords,isNaN(pt[1])||isNaN(pt[2])?At=" M ":(pt[1]=Math.max(Math.min(pt[1],5e3),-5e3),pt[2]=Math.max(Math.min(pt[2],5e3),-5e3),At===" M "?yt+=At+pt[1]+" "+pt[2]:(dt=2*ht,yt+=[At,ft+.333*(pt[1]-ft)+bt*(dt*Math.random()-ht)," ",gt+.333*(pt[2]-gt)+bt*(dt*Math.random()-ht)," ",ft+.666*(pt[1]-ft)+bt*(dt*Math.random()-ht)," ",gt+.666*(pt[2]-gt)+bt*(dt*Math.random()-ht)," ",pt[1]," ",pt[2]].join("")),At=" C ",ft=pt[1],gt=pt[2]);return yt},updatePolygonPrim:function(ct,ut){var ht,dt,pt="",ft=ut.vertices.length;for(ct.setAttributeNS(null,"stroke","none"),ht=0;ht<ft-1;ht++){if(!ut.vertices[ht].isReal)return void ct.setAttributeNS(null,"points","");dt=ut.vertices[ht].coords.scrCoords,pt=pt+dt[1]+","+dt[2],ht<ft-2&&(pt+=" ")}pt.indexOf("NaN")===-1&&ct.setAttributeNS(null,"points",pt)},updateRectPrim:function(ct,ut,ht,dt,pt){ct.setAttributeNS(null,"x",ut),ct.setAttributeNS(null,"y",ht),ct.setAttributeNS(null,"width",dt),ct.setAttributeNS(null,"height",pt)},setPropertyPrim:function(ct,ut,ht){ut!=="stroked"&&ct.setAttributeNS(null,ut,ht)},display:function(ct,ut){var ht;ct&&ct.rendNode&&(ct.visPropOld.visible=ut,ht=ct.rendNode,ut?(ht.setAttributeNS(null,"display","inline"),ht.style.visibility="inherit"):(ht.setAttributeNS(null,"display","none"),ht.style.visibility="hidden"))},show:function(ct){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(ct,!0)},hide:function(ct){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(ct,!1)},setBuffering:function(ct,ut){ct.rendNode.setAttribute("buffered-rendering",ut)},setDashStyle:function(ct){var ut=nt.evaluate(ct.visProp.dash),ht=ct.rendNode;ut>0?ht.setAttributeNS(null,"stroke-dasharray",this.dashArray[ut-1]):ht.hasAttributeNS(null,"stroke-dasharray")&&ht.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(ct){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt=ct.rendNode,xt=nt.evaluate(ct.visProp.gradient);ht=nt.evaluate(ct.visProp.fillopacity),ht=ht>0?ht:0,ut=nt.evaluate(ct.visProp.fillcolor),xt==="linear"?(dt=this.createPrim("linearGradient",ct.id+"_gradient"),gt="0%",mt="100%",At="0%",yt="0%",dt.setAttributeNS(null,"x1",gt),dt.setAttributeNS(null,"x2",mt),dt.setAttributeNS(null,"y1",At),dt.setAttributeNS(null,"y2",yt),pt=this.createPrim("stop",ct.id+"_gradient1"),pt.setAttributeNS(null,"offset","0%"),pt.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),ft=this.createPrim("stop",ct.id+"_gradient2"),ft.setAttributeNS(null,"offset","100%"),ft.setAttributeNS(null,"style","stop-color:"+nt.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+nt.evaluate(ct.visProp.gradientsecondopacity)),dt.appendChild(pt),dt.appendChild(ft),this.defs.appendChild(dt),bt.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+ct.id+"_gradient)"),ct.gradNode1=pt,ct.gradNode2=ft):xt==="radial"?(dt=this.createPrim("radialGradient",ct.id+"_gradient"),dt.setAttributeNS(null,"cx","50%"),dt.setAttributeNS(null,"cy","50%"),dt.setAttributeNS(null,"r","50%"),dt.setAttributeNS(null,"fx",100*nt.evaluate(ct.visProp.gradientpositionx)+"%"),dt.setAttributeNS(null,"fy",100*nt.evaluate(ct.visProp.gradientpositiony)+"%"),pt=this.createPrim("stop",ct.id+"_gradient1"),pt.setAttributeNS(null,"offset","0%"),pt.setAttributeNS(null,"style","stop-color:"+nt.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+nt.evaluate(ct.visProp.gradientsecondopacity)),ft=this.createPrim("stop",ct.id+"_gradient2"),ft.setAttributeNS(null,"offset","100%"),ft.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),dt.appendChild(pt),dt.appendChild(ft),this.defs.appendChild(dt),bt.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+ct.id+"_gradient)"),ct.gradNode1=pt,ct.gradNode2=ft):bt.removeAttributeNS(null,"style")},updateGradient:function(ct){var ut,ht,dt=ct.gradNode1,pt=ct.gradNode2,ft=nt.evaluate(ct.visProp.gradient);nt.exists(dt)&&nt.exists(pt)&&(ht=nt.evaluate(ct.visProp.fillopacity),ht=ht>0?ht:0,ut=nt.evaluate(ct.visProp.fillcolor),ft==="linear"?(dt.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht),pt.setAttributeNS(null,"style","stop-color:"+nt.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+nt.evaluate(ct.visProp.gradientsecondopacity))):ft==="radial"&&(dt.setAttributeNS(null,"style","stop-color:"+nt.evaluate(ct.visProp.gradientsecondcolor)+";stop-opacity:"+nt.evaluate(ct.visProp.gradientsecondopacity)),pt.setAttributeNS(null,"style","stop-color:"+ut+";stop-opacity:"+ht)))},setObjectTransition:function(ct,ut){var ht,dt,pt,ft,gt=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(ut===void 0&&(ut=nt.evaluate(ct.visProp.transitionduration)),ut!==ct.visPropOld.transitionduration){for(dt=ct.elementClass===it.OBJECT_CLASS_TEXT&&nt.evaluate(ct.visProp.display)==="html"?" color "+ut+"ms, opacity "+ut+"ms":" fill "+ut+"ms, fill-opacity "+ut+"ms, stroke "+ut+"ms, stroke-opacity "+ut+"ms",ft=gt.length,pt=0;pt<ft;++pt)ct[gt[pt]]&&(ht=ct[gt[pt]],ht.style.transition=dt);ct.visPropOld.transitionduration=ut}},_setAttribute:function(ct,ut){ut===""?ct():setTimeout(ct,1)},setObjectFillColor:function(ct,ut,ht,dt){var pt,ft,gt,mt,At=nt.evaluate(ut),yt=nt.evaluate(ht);yt=yt>0?yt:0,ct.visPropOld.fillcolor===At&&ct.visPropOld.fillopacity===yt||(nt.exists(At)&&At!==!1&&(At.length!==9?(ft=At,mt=yt):(gt=at.rgba2rgbo(At),ft=gt[0],mt=yt*gt[1]),pt=dt===void 0?ct.rendNode:dt,ft!=="none"&&this._setAttribute(function(){pt.setAttributeNS(null,"fill",ft)},ct.visPropOld.fillcolor),ct.type===tt.OBJECT_TYPE_IMAGE?this._setAttribute(function(){pt.setAttributeNS(null,"opacity",mt)},ct.visPropOld.fillopacity):(ft==="none"&&(mt=0),this._setAttribute(function(){pt.setAttributeNS(null,"fill-opacity",mt)},ct.visPropOld.fillopacity)),nt.exists(ct.visProp.gradient)&&this.updateGradient(ct)),ct.visPropOld.fillcolor=At,ct.visPropOld.fillopacity=yt)},setObjectStrokeColor:function(ct,ut,ht){var dt,pt,ft,gt,mt=nt.evaluate(ut),At=nt.evaluate(ht);At=At>0?At:0,ct.visPropOld.strokecolor===mt&&ct.visPropOld.strokeopacity===At||(nt.exists(mt)&&mt!==!1&&(mt.length!==9?(dt=mt,ft=At):(pt=at.rgba2rgbo(mt),dt=pt[0],ft=At*pt[1]),gt=ct.rendNode,ct.elementClass===it.OBJECT_CLASS_TEXT?nt.evaluate(ct.visProp.display)==="html"?this._setAttribute(function(){gt.style.color=dt,gt.style.opacity=ft},ct.visPropOld.strokecolor):this._setAttribute(function(){gt.setAttributeNS(null,"style","fill:"+dt),gt.setAttributeNS(null,"style","fill-opacity:"+ft)},ct.visPropOld.strokecolor):this._setAttribute(function(){gt.setAttributeNS(null,"stroke",dt),gt.setAttributeNS(null,"stroke-opacity",ft)},ct.visPropOld.strokecolor),ct.elementClass!==it.OBJECT_CLASS_CURVE&&ct.elementClass!==it.OBJECT_CLASS_LINE||(nt.evaluate(ct.visProp.firstarrow)&&this._setArrowColor(ct.rendNodeTriangleStart,dt,ft,ct),nt.evaluate(ct.visProp.lastarrow)&&this._setArrowColor(ct.rendNodeTriangleEnd,dt,ft,ct))),ct.visPropOld.strokecolor=mt,ct.visPropOld.strokeopacity=At)},setObjectStrokeWidth:function(ct,ut){var ht,dt=nt.evaluate(ut);isNaN(dt)||ct.visPropOld.strokewidth===dt||(ht=ct.rendNode,this.setPropertyPrim(ht,"stroked","true"),nt.exists(dt)&&this.setPropertyPrim(ht,"stroke-width",dt+"px"),ct.visPropOld.strokewidth=dt)},setLineCap:function(ct){var ut=nt.evaluate(ct.visProp.linecap);ut!==void 0&&ut!==""&&ct.visPropOld.linecap!==ut&&nt.exists(ct.rendNode)&&(this.setPropertyPrim(ct.rendNode,"stroke-linecap",ut),ct.visPropOld.linecap=ut)},setShadow:function(ct){var ut=nt.evaluate(ct.visProp.shadow);ct.visPropOld.shadow!==ut&&(nt.exists(ct.rendNode)&&(ut?ct.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):ct.rendNode.removeAttributeNS(null,"filter")),ct.visPropOld.shadow=ut)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(ct,ut){this.svgRoot.style.width=parseFloat(ct)+"px",this.svgRoot.style.height=parseFloat(ut)+"px",this.svgRoot.setAttribute("width",parseFloat(ct)),this.svgRoot.setAttribute("height",parseFloat(ut))},createTouchpoints:function(ct){var ut,ht,dt,pt;for(this.touchpoints=[],ut=0;ut<ct;ut++)ht="touchpoint1_"+ut,pt=this.createPrim("path",ht),this.appendChildPrim(pt,19),pt.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(pt),this.setPropertyPrim(pt,"stroked","true"),this.setPropertyPrim(pt,"stroke-width","1px"),pt.setAttributeNS(null,"stroke","#000000"),pt.setAttributeNS(null,"stroke-opacity",1),pt.setAttributeNS(null,"display","none"),dt="touchpoint2_"+ut,pt=this.createPrim("ellipse",dt),this.appendChildPrim(pt,19),this.updateEllipsePrim(pt,0,0,0,0),this.touchpoints.push(pt),this.setPropertyPrim(pt,"stroked","true"),this.setPropertyPrim(pt,"stroke-width","1px"),pt.setAttributeNS(null,"stroke","#000000"),pt.setAttributeNS(null,"stroke-opacity",1),pt.setAttributeNS(null,"fill","#ffffff"),pt.setAttributeNS(null,"fill-opacity",0),pt.setAttributeNS(null,"display","none")},showTouchpoint:function(ct){this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(this.touchpoints[2*ct].setAttributeNS(null,"display","inline"),this.touchpoints[2*ct+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(ct){this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(this.touchpoints[2*ct].setAttributeNS(null,"display","none"),this.touchpoints[2*ct+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(ct,ut){var ht,dt;this.touchpoints&&ct>=0&&2*ct<this.touchpoints.length&&(ht=ut[0],dt=ut[1],this.touchpoints[2*ct].setAttributeNS(null,"d","M "+(ht-37)+" "+dt+" L "+(ht+37)+" "+dt+" M "+ht+" "+(dt-37)+" L "+ht+" "+(dt+37)),this.updateEllipsePrim(this.touchpoints[2*ct+1],ut[0],ut[1],25,25))},dumpToCanvas:function(ct,ut,ht,dt){var pt,ft,gt,mt,At,yt,bt,xt,vt=this.svgRoot,_t=window.btoa||lt.encode;if(this.container.hasChildNodes()&&nt.exists(this.foreignObjLayer)){for(;vt.nextSibling;)this.foreignObjLayer.appendChild(vt.nextSibling);dt===!0&&(xt=this.container.ownerDocument,bt=xt.createElement("div"),bt.appendChild(this.foreignObjLayer))}if(vt.setAttribute("xmlns","http://www.w3.org/2000/svg"),At=vt.getAttribute("width"),yt=vt.getAttribute("height"),pt=new XMLSerializer().serializeToString(vt),(pt.match(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g)||[]).length>1&&(pt=pt.replace(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g,"")),pt=pt.replace(/&nbsp;/g," "),gt=document.getElementById(ct),gt.width=gt.width,mt=gt.getContext("2d"),ut!==void 0&&ht!==void 0&&(gt.style.width=parseFloat(ut)+"px",gt.style.height=parseFloat(ht)+"px",gt.setAttribute("width",2*parseFloat(At)),gt.setAttribute("height",2*parseFloat(yt)),mt.scale(2*At/ut,2*yt/ht)),ft=new Image,ft.src="data:image/svg+xml;base64,"+_t(unescape(encodeURIComponent(pt))),ft.onload=function(){setTimeout(function(){mt.drawImage(ft,0,0,ut,ht)},200)},nt.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes())for(dt===!0&&vt.appendChild(this.foreignObjLayer);this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);return this},screenshot:function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=this.container.ownerDocument,St=this.container.parentNode,Et=ct.attr.screenshot,Tt=!1;return this.type==="no"?this:(bt=Et.scale*parseFloat(this.container.style.width),xt=Et.scale*parseFloat(this.container.style.height),ut===void 0||ut===""?(Tt=!0,mt=new Image,mt.style.width=bt+"px",mt.style.height=xt+"px"):(Tt=!1,mt=Ct.getElementById(ut)),Tt&&(dt=Ct.createElement("div"),dt.style.cssText=Et.css,dt.style.width=bt+"px",dt.style.height=xt+"px",dt.style.zIndex=this.container.style.zIndex+120,pt=ct.getCoordsTopLeftCorner(),dt.style.position="absolute",dt.style.left=pt[0]+"px",dt.style.top=pt[1]+"px"),ft=Ct.createElement("canvas"),gt=Math.random().toString(36).substr(2,5),ft.setAttribute("id",gt),ft.setAttribute("width",bt),ft.setAttribute("height",xt),ft.style.width=bt+"px",ft.style.height=bt+"px",ft.style.display="none",St.append(ft),Tt&&(At=Ct.createElement("span"),yt=Ct.createTextNode("✖"),At.style.cssText=Et.cssButton,At.appendChild(yt),At.onclick=function(){dt.parentNode.removeChild(dt)},dt.appendChild(mt),dt.appendChild(At),St.appendChild(dt)),vt=document.getElementById(this.container.id+"_navigationbar"),nt.exists(vt)&&(_t=vt.style.display,vt.style.display="none"),this.dumpToCanvas(gt,bt,xt,ht),setTimeout(function(){mt.src=ft.toDataURL("image/png"),St.removeChild(ft)},400),nt.exists(vt)&&(vt.style.display=_t),this)}}),tt.SVGRenderer}),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],function(tt,_e,rt,it,nt,st,at){return tt.VMLRenderer=function(lt){this.type="vml",this.container=lt,this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,it.exists(tt.vmlStylesheet)||(lt.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),tt.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),tt.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{lt.ownerDocument.namespaces.jxgvml||lt.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(ot){return lt.ownerDocument.createElement("<jxgvml:"+ot+' class="jxgvml">')}}catch{this.createNode=function(ct){return lt.ownerDocument.createElement("<"+ct+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},tt.VMLRenderer.prototype=new _e,tt.extend(tt.VMLRenderer.prototype,{_setAttr:function(lt,ot,ct,ut){try{this.container.ownerDocument.documentMode===8?lt[ot]=ct:lt.setAttribute(ot,ct,ut)}catch{tt.debug("_setAttr: "+ot+" "+ct+`<br>
`)}},updateTicks:function(lt){var ot,ct,ut,ht,dt,pt=this.resolution,ft=[];for(ct=lt.ticks.length,ot=0;ot<ct;ot++)ut=lt.ticks[ot],ht=ut[0],dt=ut[1],it.isNumber(ht[0])&&it.isNumber(ht[1])&&ft.push(" m "+Math.round(pt*ht[0])+", "+Math.round(pt*dt[0])+" l "+Math.round(pt*ht[1])+", "+Math.round(pt*dt[1])+" ");it.exists(lt.rendNode)||(lt.rendNode=this.createPrim("path",lt.id),this.appendChildPrim(lt.rendNode,it.evaluate(lt.visProp.layer))),this._setAttr(lt.rendNode,"stroked","true"),this._setAttr(lt.rendNode,"strokecolor",it.evaluate(lt.visProp.strokecolor),1),this._setAttr(lt.rendNode,"strokeweight",it.evaluate(lt.visProp.strokewidth)),this._setAttr(lt.rendNodeStroke,"opacity",100*it.evaluate(lt.visProp.strokeopacity)+"%"),this.updatePathPrim(lt.rendNode,ft,lt.board)},displayCopyright:function(lt,ot){var ct,ut;ct=this.createNode("textbox"),ct.style.position="absolute",this._setAttr(ct,"id",this.container.id+"_licenseText"),ct.style.left=20,ct.style.top=2,ct.style.fontSize=ot,ct.style.color="#356AA0",ct.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(ct,"opacity","30%"),ct.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",ut=this.container.ownerDocument.createTextNode(lt),ct.appendChild(ut),this.appendChildPrim(ct,0)},drawInternalText:function(lt){var ot;return ot=this.createNode("textbox"),ot.style.position="absolute",lt.rendNodeText=this.container.ownerDocument.createTextNode(""),ot.appendChild(lt.rendNodeText),this.appendChildPrim(ot,9),ot.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",ot},updateInternalText:function(lt){var ot,ct,ut,ht,dt,pt,ft=lt.plaintext,gt=this.joinTransforms(lt,lt.transformations),mt=[0,0],At=lt.rendNode,yt=[],bt=lt.getAnchorX(),xt=lt.getAnchorY();if(!isNaN(lt.coords.scrCoords[1]+lt.coords.scrCoords[2])){for(bt==="right"?mt[0]=1:bt==="middle"&&(mt[0]=.5),xt==="bottom"?mt[1]=1:xt==="middle"&&(mt[1]=.5),yt[0]=st.matVecMult(gt,[1,lt.coords.scrCoords[1]-mt[0]*lt.size[0],lt.coords.scrCoords[2]+(1-mt[1])*lt.size[1]+this.vOffsetText]),yt[0][1]/=yt[0][0],yt[0][2]/=yt[0][0],yt[1]=st.matVecMult(gt,[1,lt.coords.scrCoords[1]+(1-mt[0])*lt.size[0],lt.coords.scrCoords[2]+(1-mt[1])*lt.size[1]+this.vOffsetText]),yt[1][1]/=yt[1][0],yt[1][2]/=yt[1][0],yt[2]=st.matVecMult(gt,[1,lt.coords.scrCoords[1]+(1-mt[0])*lt.size[0],lt.coords.scrCoords[2]-mt[1]*lt.size[1]+this.vOffsetText]),yt[2][1]/=yt[2][0],yt[2][2]/=yt[2][0],yt[3]=st.matVecMult(gt,[1,lt.coords.scrCoords[1]-mt[0]*lt.size[0],lt.coords.scrCoords[2]-mt[1]*lt.size[1]+this.vOffsetText]),yt[3][1]/=yt[3][0],yt[3][2]/=yt[3][0],ct=yt[0][1],ht=yt[0][1],ut=yt[0][2],dt=yt[0][2],pt=1;pt<4;pt++)ct=Math.max(ct,yt[pt][1]),ht=Math.min(ht,yt[pt][1]),ut=Math.max(ut,yt[pt][2]),dt=Math.min(dt,yt[pt][2]);ot=mt[0]===1?Math.floor(lt.board.canvasWidth-ct):Math.floor(ht),lt.visPropOld.left!==bt+ot&&(mt[0]===1?(lt.rendNode.style.right=ot+"px",lt.rendNode.style.left="auto"):(lt.rendNode.style.left=ot+"px",lt.rendNode.style.right="auto"),lt.visPropOld.left=bt+ot),ot=mt[1]===1?Math.floor(lt.board.canvasHeight-ut):Math.floor(dt),lt.visPropOld.top!==xt+ot&&(mt[1]===1?(lt.rendNode.style.bottom=ot+"px",lt.rendNode.style.top="auto"):(lt.rendNode.style.top=ot+"px",lt.rendNode.style.bottom="auto"),lt.visPropOld.top=xt+ot)}lt.htmlStr!==ft&&(lt.rendNodeText.data=ft,lt.htmlStr=ft),At.filters.item(0).M11=gt[1][1],At.filters.item(0).M12=gt[1][2],At.filters.item(0).M21=gt[2][1],At.filters.item(0).M22=gt[2][2],At.filters.item(0).enabled=!0},drawImage:function(lt){var ot;ot=this.container.ownerDocument.createElement("img"),ot.style.position="absolute",this._setAttr(ot,"id",this.container.id+"_"+lt.id),this.container.appendChild(ot),this.appendChildPrim(ot,it.evaluate(lt.visProp.layer)),ot.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",lt.rendNode=ot,this.updateImage(lt)},transformImage:function(lt,ot){var ct,ut,ht,dt,pt,ft,gt=lt.rendNode,mt=[];if(ot.length>0){for(ct=this.joinTransforms(lt,ot),mt[0]=st.matVecMult(ct,lt.coords.scrCoords),mt[0][1]/=mt[0][0],mt[0][2]/=mt[0][0],mt[1]=st.matVecMult(ct,[1,lt.coords.scrCoords[1]+lt.size[0],lt.coords.scrCoords[2]]),mt[1][1]/=mt[1][0],mt[1][2]/=mt[1][0],mt[2]=st.matVecMult(ct,[1,lt.coords.scrCoords[1]+lt.size[0],lt.coords.scrCoords[2]-lt.size[1]]),mt[2][1]/=mt[2][0],mt[2][2]/=mt[2][0],mt[3]=st.matVecMult(ct,[1,lt.coords.scrCoords[1],lt.coords.scrCoords[2]-lt.size[1]]),mt[3][1]/=mt[3][0],mt[3][2]/=mt[3][0],ut=mt[0][1],dt=mt[0][1],ht=mt[0][2],pt=mt[0][2],ft=1;ft<4;ft++)ut=Math.max(ut,mt[ft][1]),dt=Math.min(dt,mt[ft][1]),ht=Math.max(ht,mt[ft][2]),pt=Math.min(pt,mt[ft][2]);gt.style.left=Math.floor(dt)+"px",gt.style.top=Math.floor(pt)+"px",gt.filters.item(0).M11=ct[1][1],gt.filters.item(0).M12=ct[1][2],gt.filters.item(0).M21=ct[2][1],gt.filters.item(0).M22=ct[2][2],gt.filters.item(0).enabled=!0}},updateImageURL:function(lt){var ot=it.evaluate(lt.url);this._setAttr(lt.rendNode,"src",ot)},appendChildPrim:function(lt,ot){return it.exists(ot)||(ot=0),lt.style.zIndex=ot,this.container.appendChild(lt),lt},appendNodesToElement:function(lt,ot){ot!=="shape"&&ot!=="path"&&ot!=="polygon"||(lt.rendNodePath=this.getElementById(lt.id+"_path")),lt.rendNodeFill=this.getElementById(lt.id+"_fill"),lt.rendNodeStroke=this.getElementById(lt.id+"_stroke"),lt.rendNodeShadow=this.getElementById(lt.id+"_shadow"),lt.rendNode=this.getElementById(lt.id)},createPrim:function(lt,ot){var ct,ut,ht=this.createNode("fill"),dt=this.createNode("stroke"),pt=this.createNode("shadow");return this._setAttr(ht,"id",this.container.id+"_"+ot+"_fill"),this._setAttr(dt,"id",this.container.id+"_"+ot+"_stroke"),this._setAttr(pt,"id",this.container.id+"_"+ot+"_shadow"),lt==="circle"||lt==="ellipse"?(ct=this.createNode("oval"),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(pt)):lt==="polygon"||lt==="path"||lt==="shape"||lt==="line"?(ct=this.createNode("shape"),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(pt),ut=this.createNode("path"),this._setAttr(ut,"id",this.container.id+"_"+ot+"_path"),ct.appendChild(ut)):(ct=this.createNode(lt),ct.appendChild(ht),ct.appendChild(dt),ct.appendChild(pt)),ct.style.position="absolute",ct.style.left="0px",ct.style.top="0px",this._setAttr(ct,"id",this.container.id+"_"+ot),ct},remove:function(lt){it.exists(lt)&&lt.removeNode(!0)},makeArrows:function(lt){var ot,ct=it.evaluate(lt.visProp.firstarrow),ut=it.evaluate(lt.visProp.lastarrow);lt.visPropOld.firstarrow===ct&&lt.visPropOld.lastarrow===ut||(ct?(ot=lt.rendNodeStroke,this._setAttr(ot,"startarrow","block"),this._setAttr(ot,"startarrowlength","long")):(ot=lt.rendNodeStroke,it.exists(ot)&&this._setAttr(ot,"startarrow","none")),ut?(ot=lt.rendNodeStroke,this._setAttr(ot,"id",this.container.id+"_"+lt.id+"stroke"),this._setAttr(ot,"endarrow","block"),this._setAttr(ot,"endarrowlength","long")):(ot=lt.rendNodeStroke,it.exists(ot)&&this._setAttr(ot,"endarrow","none")),lt.visPropOld.firstarrow=ct,lt.visPropOld.lastarrow=ut)},updateEllipsePrim:function(lt,ot,ct,ut,ht){lt.style.left=Math.floor(ot-ut)+"px",lt.style.top=Math.floor(ct-ht)+"px",lt.style.width=Math.floor(2*Math.abs(ut))+"px",lt.style.height=Math.floor(2*Math.abs(ht))+"px"},updateLinePrim:function(lt,ot,ct,ut,ht,dt){var pt,ft=this.resolution;isNaN(ot+ct+ut+ht)||(pt=["m ",Math.floor(ft*ot),", ",Math.floor(ft*ct)," l ",Math.floor(ft*ut),", ",Math.floor(ft*ht)],this.updatePathPrim(lt,pt,dt))},updatePathPrim:function(lt,ot,ct){var ut=ct.canvasWidth,ht=ct.canvasHeight;ot.length<=0&&(ot=["m 0,0"]),lt.style.width=ut,lt.style.height=ht,this._setAttr(lt,"coordsize",[Math.floor(this.resolution*ut),Math.floor(this.resolution*ht)].join(",")),this._setAttr(lt,"path",ot.join(""))},updatePathStringPoint:function(lt,ot,ct){var ut=[],ht=Math.round,dt=lt.coords.scrCoords,pt=ot*Math.sqrt(3)*.5,ft=.5*ot,gt=this.resolution;return ct==="x"?ut.push([" m ",ht(gt*(dt[1]-ot)),", ",ht(gt*(dt[2]-ot))," l ",ht(gt*(dt[1]+ot)),", ",ht(gt*(dt[2]+ot))," m ",ht(gt*(dt[1]+ot)),", ",ht(gt*(dt[2]-ot))," l ",ht(gt*(dt[1]-ot)),", ",ht(gt*(dt[2]+ot))].join("")):ct==="+"?ut.push([" m ",ht(gt*(dt[1]-ot)),", ",ht(gt*dt[2])," l ",ht(gt*(dt[1]+ot)),", ",ht(gt*dt[2])," m ",ht(gt*dt[1]),", ",ht(gt*(dt[2]-ot))," l ",ht(gt*dt[1]),", ",ht(gt*(dt[2]+ot))].join("")):ct==="<>"?ut.push([" m ",ht(gt*(dt[1]-ot)),", ",ht(gt*dt[2])," l ",ht(gt*dt[1]),", ",ht(gt*(dt[2]+ot))," l ",ht(gt*(dt[1]+ot)),", ",ht(gt*dt[2])," l ",ht(gt*dt[1]),", ",ht(gt*(dt[2]-ot))," x e "].join("")):ct==="^"?ut.push([" m ",ht(gt*dt[1]),", ",ht(gt*(dt[2]-ot))," l ",ht(gt*(dt[1]-pt)),", ",ht(gt*(dt[2]+ft))," l ",ht(gt*(dt[1]+pt)),", ",ht(gt*(dt[2]+ft))," x e "].join("")):ct==="v"?ut.push([" m ",ht(gt*dt[1]),", ",ht(gt*(dt[2]+ot))," l ",ht(gt*(dt[1]-pt)),", ",ht(gt*(dt[2]-ft))," l ",ht(gt*(dt[1]+pt)),", ",ht(gt*(dt[2]-ft))," x e "].join("")):ct===">"?ut.push([" m ",ht(gt*(dt[1]+ot)),", ",ht(gt*dt[2])," l ",ht(gt*(dt[1]-ft)),", ",ht(gt*(dt[2]-pt))," l ",ht(gt*(dt[1]-ft)),", ",ht(gt*(dt[2]+pt))," l ",ht(gt*(dt[1]+ot)),", ",ht(gt*dt[2])].join("")):ct==="<"&&ut.push([" m ",ht(gt*(dt[1]-ot)),", ",ht(gt*dt[2])," l ",ht(gt*(dt[1]+ft)),", ",ht(gt*(dt[2]-pt))," l ",ht(gt*(dt[1]+ft)),", ",ht(gt*(dt[2]+pt))," x e "].join("")),ut},updatePathStringPrim:function(lt){var ot,ct,ut=[],ht=this.resolution,dt=Math.round,pt=" m ",ft=Math.min(lt.numberPoints,8192);if(lt.numberPoints<=0)return"";if(ft=Math.min(ft,lt.points.length),lt.bezierDegree===1)for(ot=0;ot<ft;ot++)ct=lt.points[ot].scrCoords,isNaN(ct[1])||isNaN(ct[2])?pt=" m ":(ct[1]>2e4?ct[1]=2e4:ct[1]<-2e4&&(ct[1]=-2e4),ct[2]>2e4?ct[2]=2e4:ct[2]<-2e4&&(ct[2]=-2e4),ut.push([pt,dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),pt=" l ");else if(lt.bezierDegree===3)for(ot=0;ot<ft;)ct=lt.points[ot].scrCoords,isNaN(ct[1])||isNaN(ct[2])?pt=" m ":(ut.push([pt,dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),pt===" c "&&(ot+=1,ct=lt.points[ot].scrCoords,ut.push([" ",dt(ht*ct[1]),", ",dt(ht*ct[2])].join("")),ot+=1,ct=lt.points[ot].scrCoords,ut.push([" ",dt(ht*ct[1]),", ",dt(ht*ct[2])].join(""))),pt=" c "),ot+=1;return ut.push(" e"),ut},updatePathStringBezierPrim:function(lt){var ot,ct,ut,ht,dt,pt,ft=[],gt=it.evaluate(lt.visProp.strokewidth),mt=this.resolution,At=Math.round,yt=" m ",bt=it.evaluate(lt.visProp.curvetype)!=="plot",xt=Math.min(lt.numberPoints,8192);if(lt.numberPoints<=0)return"";for(bt&&lt.board.options.curve.RDPsmoothing&&(lt.points=at.RamerDouglasPeucker(lt.points,1)),xt=Math.min(xt,lt.points.length),ct=1;ct<3;ct++)for(yt=" m ",ot=0;ot<xt;ot++)ht=lt.points[ot].scrCoords,isNaN(ht[1])||isNaN(ht[2])?yt=" m ":(ht[1]>2e4?ht[1]=2e4:ht[1]<-2e4&&(ht[1]=-2e4),ht[2]>2e4?ht[2]=2e4:ht[2]<-2e4&&(ht[2]=-2e4),yt===" m "?ft.push([yt,At(mt*ht[1])," ",At(mt*ht[2])].join("")):(ut=2*ct,ft.push([yt,At(mt*(dt+.333*(ht[1]-dt)+gt*(ut*Math.random()-ct)))," ",At(mt*(pt+.333*(ht[2]-pt)+gt*(ut*Math.random()-ct)))," ",At(mt*(dt+.666*(ht[1]-dt)+gt*(ut*Math.random()-ct)))," ",At(mt*(pt+.666*(ht[2]-pt)+gt*(ut*Math.random()-ct)))," ",At(mt*ht[1])," ",At(mt*ht[2])].join(""))),yt=" c ",dt=ht[1],pt=ht[2]);return ft.push(" e"),ft},updatePolygonPrim:function(lt,ot){var ct,ut,ht=ot.vertices.length,dt=this.resolution,pt=[];if(this._setAttr(lt,"stroked","false"),ut=ot.vertices[0].coords.scrCoords,!isNaN(ut[1]+ut[2])){for(pt.push(["m ",Math.floor(dt*ut[1]),",",Math.floor(dt*ut[2])," l "].join("")),ct=1;ct<ht-1;ct++){if(!ot.vertices[ct].isReal)return void this.updatePathPrim(lt,"",ot.board);if(ut=ot.vertices[ct].coords.scrCoords,isNaN(ut[1]+ut[2]))return;pt.push(Math.floor(dt*ut[1])+","+Math.floor(dt*ut[2])),ct<ht-2&&pt.push(", ")}pt.push(" x e"),this.updatePathPrim(lt,pt,ot.board)}},updateRectPrim:function(lt,ot,ct,ut,ht){lt.style.left=Math.floor(ot)+"px",lt.style.top=Math.floor(ct)+"px",ut>=0&&(lt.style.width=ut+"px"),ht>=0&&(lt.style.height=ht+"px")},setPropertyPrim:function(lt,ot,ct){var ut,ht="";switch(ot){case"stroke":ht="strokecolor";break;case"stroke-width":ht="strokeweight";break;case"stroke-dasharray":ht="dashstyle"}ht!==""&&(ut=it.evaluate(ct),this._setAttr(lt,ht,ut))},display:function(lt,ot){lt&&lt.rendNode&&(lt.visPropOld.visible=ot,lt.rendNode.style.visibility=ot?"inherit":"hidden")},show:function(lt){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),lt&&lt.rendNode&&(lt.rendNode.style.visibility="inherit")},hide:function(lt){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),lt&&lt.rendNode&&(lt.rendNode.style.visibility="hidden")},setDashStyle:function(lt,ot){var ct;ot.dash>=0&&(ct=lt.rendNodeStroke,this._setAttr(ct,"dashstyle",this.dashArray[ot.dash]))},setGradient:function(lt){var ot=lt.rendNodeFill,ct=it.evaluate(lt.visProp.gradient);ct==="linear"?(this._setAttr(ot,"type","gradient"),this._setAttr(ot,"color2",it.evaluate(lt.visProp.gradientsecondcolor)),this._setAttr(ot,"opacity2",it.evaluate(lt.visProp.gradientsecondopacity)),this._setAttr(ot,"angle",it.evaluate(lt.visProp.gradientangle))):ct==="radial"?(this._setAttr(ot,"type","gradientradial"),this._setAttr(ot,"color2",it.evaluate(lt.visProp.gradientsecondcolor)),this._setAttr(ot,"opacity2",it.evaluate(lt.visProp.gradientsecondopacity)),this._setAttr(ot,"focusposition",100*it.evaluate(lt.visProp.gradientpositionx)+"%,"+100*it.evaluate(lt.visProp.gradientpositiony)+"%"),this._setAttr(ot,"focussize","0,0")):this._setAttr(ot,"type","solid")},setObjectFillColor:function(lt,ot,ct){var ut,ht,dt,pt=it.evaluate(ot),ft=it.evaluate(ct),gt=lt.rendNode;ft=ft>0?ft:0,lt.visPropOld.fillcolor===pt&&lt.visPropOld.fillopacity===ft||(it.exists(pt)&&pt!==!1&&(pt.length!==9?(ut=pt,dt=ft):(ht=nt.rgba2rgbo(pt),ut=ht[0],dt=ft*ht[1]),ut==="none"||ut===!1?this._setAttr(lt.rendNode,"filled","false"):(this._setAttr(lt.rendNode,"filled","true"),this._setAttr(lt.rendNode,"fillcolor",ut),it.exists(dt)&&lt.rendNodeFill&&this._setAttr(lt.rendNodeFill,"opacity",100*dt+"%")),lt.type===rt.OBJECT_TYPE_IMAGE&&gt.filters.length>1&&(gt.filters.item(1).opacity=Math.round(100*dt),gt.filters.item(1).enabled=!0)),lt.visPropOld.fillcolor=pt,lt.visPropOld.fillopacity=ft)},setObjectStrokeColor:function(lt,ot,ct){var ut,ht,dt,pt,ft=it.evaluate(ot),gt=it.evaluate(ct),mt=lt.rendNode;gt=gt>0?gt:0,lt.visPropOld.strokecolor===ft&&lt.visPropOld.strokeopacity===gt||(it.exists(ft)&&ft!==!1&&(ft.length!==9?(ut=ft,dt=gt):(ht=ot.rgba2rgbo(ft),ut=ht[0],dt=gt*ht[1]),lt.elementClass===rt.OBJECT_CLASS_TEXT?(mt.filters.length>1&&(mt.filters.item(1).opacity=Math.round(100*dt),mt.filters.item(1).enabled=!0),mt.style.color=ut):(ut!==!1&&(this._setAttr(mt,"stroked","true"),this._setAttr(mt,"strokecolor",ut)),pt=lt.rendNodeStroke,it.exists(dt)&&lt.type!==rt.OBJECT_TYPE_IMAGE&&this._setAttr(pt,"opacity",100*dt+"%"))),lt.visPropOld.strokecolor=ft,lt.visPropOld.strokeopacity=gt)},setObjectStrokeWidth:function(lt,ot){var ct,ut=it.evaluate(ot);isNaN(ut)||lt.visPropOld.strokewidth===ut||(ct=lt.rendNode,this.setPropertyPrim(ct,"stroked","true"),it.exists(ut)&&(this.setPropertyPrim(ct,"stroke-width",ut),ut===0&&it.exists(lt.rendNodeStroke)&&this._setAttr(ct,"stroked","false")),lt.visPropOld.strokewidth=ut)},setShadow:function(lt){var ot=lt.rendNodeShadow,ct=it.evaluate(lt.visProp.shadow);ot&&lt.visPropOld.shadow!==ct&&(ct?(this._setAttr(ot,"On","True"),this._setAttr(ot,"Offset","3pt,3pt"),this._setAttr(ot,"Opacity","60%"),this._setAttr(ot,"Color","#aaaaaa")):this._setAttr(ot,"On","False"),lt.visPropOld.shadow=ct)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),tt.VMLRenderer}),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut){return tt.CanvasRenderer=function(ht,dt){this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=st.genUUID(),this.canvasNamespace=null,it.isBrowser?(this.container=ht,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',dt.width,'px" height="',dt.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.context=this.canvasRoot.getContext("2d")):it.isNode()&&(this.canvasId=requireBrowser(),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")),this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},tt.CanvasRenderer.prototype=new _e,tt.extend(tt.CanvasRenderer.prototype,{_drawFilledPolygon:function(ht){var dt,pt=ht.length,ft=this.context;if(pt>0){for(ft.beginPath(),ft.moveTo(ht[0][0],ht[0][1]),dt=0;dt<pt;dt++)dt>0&&ft.lineTo(ht[dt][0],ht[dt][1]);ft.lineTo(ht[0][0],ht[0][1]),ft.fill()}},_fill:function(ht){var dt=this.context;dt.save(),this._setColor(ht,"fill")&&dt.fill(),dt.restore()},_rotatePoint:function(ht,dt,pt){return[dt*Math.cos(ht)-pt*Math.sin(ht),dt*Math.sin(ht)+pt*Math.cos(ht)]},_rotateShape:function(ht,dt){var pt,ft=[],gt=ht.length;if(gt<=0)return ht;for(pt=0;pt<gt;pt++)ft.push(this._rotatePoint(dt,ht[pt][0],ht[pt][1]));return ft},_setColor:function(ht,dt,pt){var ft,gt,mt,At,yt,bt,xt,vt=!0,_t=!1,Ct=ht.visProp;return dt=dt||"stroke",pt=pt||dt,nt.exists(ht.board)&&nt.exists(ht.board.highlightedObjects)||(_t=!0),ft=!_t&&nt.exists(ht.board.highlightedObjects[ht.id])?"highlight":"",mt=nt.evaluate(Ct[ft+dt+"color"]),mt!=="none"&&mt!==!1?(bt=nt.evaluate(Ct[ft+dt+"opacity"]),bt=bt>0?bt:0,mt.length!==9?(yt=mt,xt=bt):(At=at.rgba2rgbo(mt),yt=At[0],xt=bt*At[1]),this.context.globalAlpha=xt,this.context[pt+"Style"]=yt):vt=!1,gt=parseFloat(nt.evaluate(Ct.strokewidth)),dt!=="stroke"||isNaN(gt)||(gt===0?this.context.globalAlpha=0:this.context.lineWidth=gt),dt==="stroke"&&Ct.linecap!==void 0&&Ct.linecap!==""&&(this.context.lineCap=Ct.linecap),vt},_stroke:function(ht){var dt=this.context,pt=nt.evaluate(ht.visProp.dash);dt.save(),pt>0?dt.setLineDash&&dt.setLineDash(this.dashArray[pt]):this.context.lineDashArray=[],this._setColor(ht,"stroke")&&dt.stroke(),dt.restore()},_translateShape:function(ht,dt,pt){var ft,gt=[],mt=ht.length;if(mt<=0)return ht;for(ft=0;ft<mt;ft++)gt.push([ht[ft][0]+dt,ht[ft][1]+pt]);return gt},drawPoint:function(ht){var dt=nt.evaluate(ht.visProp.face),pt=nt.evaluate(ht.visProp.size),ft=ht.coords.scrCoords,gt=pt*Math.sqrt(3)*.5,mt=.5*pt,At=parseFloat(nt.evaluate(ht.visProp.strokewidth))/2,yt=this.context;if(ht.visPropCalc.visible)switch(dt){case"cross":case"x":yt.beginPath(),yt.moveTo(ft[1]-pt,ft[2]-pt),yt.lineTo(ft[1]+pt,ft[2]+pt),yt.moveTo(ft[1]+pt,ft[2]-pt),yt.lineTo(ft[1]-pt,ft[2]+pt),yt.lineCap="round",yt.lineJoin="round",yt.closePath(),this._stroke(ht);break;case"circle":case"o":yt.beginPath(),yt.arc(ft[1],ft[2],pt+1+At,0,2*Math.PI,!1),yt.closePath(),this._fill(ht),this._stroke(ht);break;case"square":case"[]":if(pt<=0)break;yt.save(),this._setColor(ht,"stroke","fill")&&yt.fillRect(ft[1]-pt-At,ft[2]-pt-At,2*pt+3*At,2*pt+3*At),yt.restore(),yt.save(),this._setColor(ht,"fill"),yt.fillRect(ft[1]-pt+At,ft[2]-pt+At,2*pt-At,2*pt-At),yt.restore();break;case"plus":case"+":yt.beginPath(),yt.moveTo(ft[1]-pt,ft[2]),yt.lineTo(ft[1]+pt,ft[2]),yt.moveTo(ft[1],ft[2]-pt),yt.lineTo(ft[1],ft[2]+pt),yt.lineCap="round",yt.lineJoin="round",yt.closePath(),this._stroke(ht);break;case"diamond":case"<>":yt.beginPath(),yt.moveTo(ft[1]-pt,ft[2]),yt.lineTo(ft[1],ft[2]+pt),yt.lineTo(ft[1]+pt,ft[2]),yt.lineTo(ft[1],ft[2]-pt),yt.closePath(),this._fill(ht),this._stroke(ht);break;case"triangleup":case"a":case"^":yt.beginPath(),yt.moveTo(ft[1],ft[2]-pt),yt.lineTo(ft[1]-gt,ft[2]+mt),yt.lineTo(ft[1]+gt,ft[2]+mt),yt.closePath(),this._fill(ht),this._stroke(ht);break;case"triangledown":case"v":yt.beginPath(),yt.moveTo(ft[1],ft[2]+pt),yt.lineTo(ft[1]-gt,ft[2]-mt),yt.lineTo(ft[1]+gt,ft[2]-mt),yt.closePath(),this._fill(ht),this._stroke(ht);break;case"triangleleft":case"<":yt.beginPath(),yt.moveTo(ft[1]-pt,ft[2]),yt.lineTo(ft[1]+mt,ft[2]-gt),yt.lineTo(ft[1]+mt,ft[2]+gt),yt.closePath(),this.fill(ht),this._stroke(ht);break;case"triangleright":case">":yt.beginPath(),yt.moveTo(ft[1]+pt,ft[2]),yt.lineTo(ft[1]-mt,ft[2]-gt),yt.lineTo(ft[1]-mt,ft[2]+gt),yt.closePath(),this._fill(ht),this._stroke(ht)}},updatePoint:function(ht){this.drawPoint(ht)},drawLine:function(ht){var dt,pt=new lt(rt.COORDS_BY_USER,ht.point1.coords.usrCoords,ht.board),ft=new lt(rt.COORDS_BY_USER,ht.point2.coords.usrCoords,ht.board),gt=null,mt=nt.evaluate(ht.visProp.firstarrow),At=nt.evaluate(ht.visProp.lastarrow);ht.visPropCalc.visible&&((mt||At)&&(gt=-4),ct.calcStraight(ht,pt,ft,gt),dt=this.getPositionArrowHead(ht,pt,ft),this.context.beginPath(),this.context.moveTo(dt.c1.scrCoords[1]+dt.d1x,dt.c1.scrCoords[2]+dt.d1y),this.context.lineTo(dt.c2.scrCoords[1]-dt.d2x,dt.c2.scrCoords[2]-dt.d2y),this._stroke(ht),(mt&&dt.sFirst>0||At&&dt.sLast>0)&&this.makeArrows(ht,dt.c1,dt.c2))},updateLine:function(ht){this.drawLine(ht)},drawTicks:function(){},updateTicks:function(ht){var dt,pt,ft,gt,mt=ht.ticks.length,At=this.context;for(At.beginPath(),dt=0;dt<mt;dt++)pt=ht.ticks[dt],ft=pt[0],gt=pt[1],At.moveTo(ft[0],gt[0]),At.lineTo(ft[1],gt[1]);for(dt=0;dt<mt;dt++)pt=ht.ticks[dt].scrCoords,ht.ticks[dt].major&&(ht.board.needsFullUpdate||ht.needsRegularUpdate)&&ht.labels[dt]&&ht.labels[dt].visPropCalc.visible&&this.updateText(ht.labels[dt]);At.lineCap="round",this._stroke(ht)},drawCurve:function(ht){nt.evaluate(ht.visProp.handdrawing)?this.updatePathStringBezierPrim(ht):this.updatePathStringPrim(ht),ht.numberPoints>1&&this.makeArrows(ht)},updateCurve:function(ht){this.drawCurve(ht)},drawEllipse:function(ht){var dt=ht.center.coords.scrCoords[1],pt=ht.center.coords.scrCoords[2],ft=ht.board.unitX,gt=ht.board.unitY,mt=2*ht.Radius(),At=2*ht.Radius(),yt=mt*ft,bt=At*gt,xt=dt-yt/2,vt=pt-bt/2,_t=yt/2*.5522848,Ct=bt/2*.5522848,St=xt+yt,Et=vt+bt,Tt=xt+yt/2,Mt=vt+bt/2,Rt=this.context;mt>0&&At>0&&!isNaN(dt+pt)&&(Rt.beginPath(),Rt.moveTo(xt,Mt),Rt.bezierCurveTo(xt,Mt-Ct,Tt-_t,vt,Tt,vt),Rt.bezierCurveTo(Tt+_t,vt,St,Mt-Ct,St,Mt),Rt.bezierCurveTo(St,Mt+Ct,Tt+_t,Et,Tt,Et),Rt.bezierCurveTo(Tt-_t,Et,xt,Mt+Ct,xt,Mt),Rt.closePath(),this._fill(ht),this._stroke(ht))},updateEllipse:function(ht){return this.drawEllipse(ht)},displayCopyright:function(ht,dt){var pt=this.context;pt.save(),pt.font=dt+"px Arial",pt.fillStyle="#aaa",pt.lineWidth=.5,pt.fillText(ht,10,2+dt),pt.restore()},drawInternalText:function(ht){var dt=nt.evaluate(ht.visProp.fontsize),pt=ht.getAnchorX(),ft=ht.getAnchorY(),gt=this.context;return gt.save(),this._setColor(ht,"stroke","fill")&&!isNaN(ht.coords.scrCoords[1]+ht.coords.scrCoords[2])&&(gt.font=(dt>0?dt:0)+"px Arial",this.transformImage(ht,ht.transformations),pt==="left"?gt.textAlign="left":pt==="right"?gt.textAlign="right":pt==="middle"&&(gt.textAlign="center"),ft==="bottom"?gt.textBaseline="bottom":ft==="top"?gt.textBaseline="top":ft==="middle"&&(gt.textBaseline="middle"),gt.fillText(ht.plaintext,ht.coords.scrCoords[1],ht.coords.scrCoords[2])),gt.restore(),null},updateInternalText:function(ht){this.drawInternalText(ht)},setObjectStrokeColor:function(ht,dt,pt){var ft,gt,mt,At,yt=nt.evaluate(dt),bt=nt.evaluate(pt);bt=bt>0?bt:0,ht.visPropOld.strokecolor===yt&&ht.visPropOld.strokeopacity===bt||(nt.exists(yt)&&yt!==!1&&(yt.length!==9?(ft=yt,mt=bt):(gt=at.rgba2rgbo(yt),ft=gt[0],mt=bt*gt[1]),At=ht.rendNode,ht.elementClass===rt.OBJECT_CLASS_TEXT&&nt.evaluate(ht.visProp.display)==="html"&&(At.style.color=ft,At.style.opacity=mt)),ht.visPropOld.strokecolor=yt,ht.visPropOld.strokeopacity=bt)},drawImage:function(ht){ht.rendNode=new Image,ht._src="",this.updateImage(ht)},updateImage:function(ht){var dt=this.context,pt=nt.evaluate(ht.visProp.fillopacity),ft=nt.bind(function(){ht.imgIsLoaded=!0,ht.size[0]<=0||ht.size[1]<=0||(dt.save(),dt.globalAlpha=pt,this.transformImage(ht,ht.transformations),dt.drawImage(ht.rendNode,ht.coords.scrCoords[1],ht.coords.scrCoords[2]-ht.size[1],ht.size[0],ht.size[1]),dt.restore())},this);this.updateImageURL(ht)?ht.rendNode.onload=ft:ht.imgIsLoaded&&ft()},transformImage:function(ht,dt){var pt,ft=dt.length,gt=this.context;ft>0&&(pt=this.joinTransforms(ht,dt),Math.abs(ut.det(pt))>=ot.eps&&gt.transform(pt[1][1],pt[2][1],pt[1][2],pt[2][2],pt[1][0],pt[2][0]))},updateImageURL:function(ht){var dt;return dt=nt.evaluate(ht.url),ht._src!==dt&&(ht.imgIsLoaded=!1,ht.rendNode.src=dt,ht._src=dt,!0)},remove:function(ht){nt.exists(ht)&&nt.exists(ht.parentNode)&&ht.parentNode.removeChild(ht)},makeArrows:function(ht,dt,pt){var ft,gt,mt,At,yt,bt,xt,vt,_t,Ct=nt.evaluate(ht.visProp.strokewidth),St=this.context,Et=nt.evaluate(ht.visProp.firstarrow),Tt=nt.evaluate(ht.visProp.lastarrow);if(nt.evaluate(ht.visProp.strokecolor)!=="none"&&(Et||Tt)){if(ht.elementClass!==rt.OBJECT_CLASS_LINE)return ft=ht.points[0].scrCoords[1],gt=ht.points[0].scrCoords[2],mt=ht.points[ht.points.length-1].scrCoords[1],void(At=ht.points[ht.points.length-1].scrCoords[2]);ft=dt.scrCoords[1],gt=dt.scrCoords[2],mt=pt.scrCoords[1],At=pt.scrCoords[2],Et&&nt.exists(Et.type)&&(bt=nt.exists(Et.size)?nt.evaluate(Et.size):3,Ct*=bt,_t=nt.evaluate(Et.type),vt=_t===2?[[Ct,.5*-Ct],[0,0],[Ct,.5*Ct],[.5*Ct,0]]:_t===3?[[Ct/3,.5*-Ct],[0,.5*-Ct],[0,.5*Ct],[Ct/3,.5*Ct]]:[[Ct,.5*-Ct],[0,0],[Ct,.5*Ct]]),Tt&&nt.exists(Tt.type)&&(bt=nt.exists(Tt.size)?nt.evaluate(Tt.size):3,Ct*=bt,_t=nt.evaluate(Tt.type),xt=_t===2?[[-Ct,.5*-Ct],[0,0],[-Ct,.5*Ct],[.5*-Ct,0]]:_t===3?[[-Ct/3,.5*-Ct],[0,.5*-Ct],[0,.5*Ct],[-Ct/3,.5*Ct]]:[[-Ct,.5*-Ct],[0,0],[-Ct,.5*Ct]]),St.save(),this._setColor(ht,"stroke","fill")&&(yt=Math.atan2(At-gt,mt-ft),Tt&&this._drawFilledPolygon(this._translateShape(this._rotateShape(xt,yt),mt,At)),Et&&this._drawFilledPolygon(this._translateShape(this._rotateShape(vt,yt),ft,gt))),St.restore()}},updatePathStringPrim:function(ht){var dt,pt,ft,gt,mt,At="M",yt=this.context;if(!(ht.numberPoints<=0)){if(mt=Math.min(ht.points.length,ht.numberPoints),yt.beginPath(),ht.bezierDegree===1)for(dt=0;dt<mt;dt++)pt=ht.points[dt].scrCoords,isNaN(pt[1])||isNaN(pt[2])?At="M":(pt[1]>5e3?pt[1]=5e3:pt[1]<-5e3&&(pt[1]=-5e3),pt[2]>5e3?pt[2]=5e3:pt[2]<-5e3&&(pt[2]=-5e3),At==="M"?yt.moveTo(pt[1],pt[2]):yt.lineTo(pt[1],pt[2]),At="L");else if(ht.bezierDegree===3)for(dt=0;dt<mt;)pt=ht.points[dt].scrCoords,isNaN(pt[1])||isNaN(pt[2])?At="M":(At==="M"?yt.moveTo(pt[1],pt[2]):(dt+=1,ft=ht.points[dt].scrCoords,dt+=1,gt=ht.points[dt].scrCoords,yt.bezierCurveTo(pt[1],pt[2],ft[1],ft[2],gt[1],gt[2])),At="C"),dt+=1;yt.lineCap="round",this._fill(ht),this._stroke(ht)}},updatePathStringBezierPrim:function(ht){var dt,pt,ft,gt,mt,At,yt,bt="M",xt=nt.evaluate(ht.visProp.strokewidth),vt=nt.evaluate(ht.visProp.curvetype)!=="plot",_t=this.context;if(!(ht.numberPoints<=0)){for(vt&&ht.board.options.curve.RDPsmoothing&&(ht.points=ut.RamerDouglasPeucker(ht.points,.5)),yt=Math.min(ht.points.length,ht.numberPoints),_t.beginPath(),pt=1;pt<3;pt++)for(bt="M",dt=0;dt<yt;dt++)gt=ht.points[dt].scrCoords,isNaN(gt[1])||isNaN(gt[2])?bt="M":(gt[1]>5e3?gt[1]=5e3:gt[1]<-5e3&&(gt[1]=-5e3),gt[2]>5e3?gt[2]=5e3:gt[2]<-5e3&&(gt[2]=-5e3),bt==="M"?_t.moveTo(gt[1],gt[2]):(ft=2*pt,_t.bezierCurveTo(mt+.333*(gt[1]-mt)+xt*(ft*Math.random()-pt),At+.333*(gt[2]-At)+xt*(ft*Math.random()-pt),mt+.666*(gt[1]-mt)+xt*(ft*Math.random()-pt),At+.666*(gt[2]-At)+xt*(ft*Math.random()-pt),gt[1],gt[2])),bt="C",mt=gt[1],At=gt[2]);_t.lineCap="round",this._fill(ht),this._stroke(ht)}},updatePolygonPrim:function(ht,dt){var pt,ft,gt,mt=dt.vertices.length,At=this.context,yt=!0;if(!(mt<=0)&&dt.visPropCalc.visible){for(At.beginPath(),ft=0;!dt.vertices[ft].isReal&&ft<mt-1;)ft++,yt=!1;for(pt=dt.vertices[ft].coords.scrCoords,At.moveTo(pt[1],pt[2]),gt=ft;gt<mt-1;gt++)dt.vertices[gt].isReal||(yt=!1),pt=dt.vertices[gt].coords.scrCoords,At.lineTo(pt[1],pt[2]);At.closePath(),yt&&this._fill(dt)}},display:function(ht,dt){ht&&ht.rendNode&&(ht.visPropOld.visible=dt,ht.rendNode.style.visibility=dt?"inherit":"hidden")},show:function(ht){tt.deprecated("Board.renderer.show()","Board.renderer.display()"),nt.exists(ht.rendNode)&&(ht.rendNode.style.visibility="inherit")},hide:function(ht){tt.deprecated("Board.renderer.hide()","Board.renderer.display()"),nt.exists(ht.rendNode)&&(ht.rendNode.style.visibility="hidden")},setGradient:function(ht){nt.evaluate(ht.visProp.fillopacity),nt.evaluate(ht.visProp.fillcolor)},setShadow:function(ht){ht.visPropOld.shadow!==ht.visProp.shadow&&(ht.visPropOld.shadow=ht.visProp.shadow)},highlight:function(ht){return ht.elementClass===rt.OBJECT_CLASS_TEXT&&nt.evaluate(ht.visProp.display)==="html"?this.updateTextStyle(ht,!0):(ht.board.prepareUpdate(),ht.board.renderer.suspendRedraw(ht.board),ht.board.updateRenderer(),ht.board.renderer.unsuspendRedraw()),this},noHighlight:function(ht){return ht.elementClass===rt.OBJECT_CLASS_TEXT&&nt.evaluate(ht.visProp.display)==="html"?this.updateTextStyle(ht,!1):(ht.board.prepareUpdate(),ht.board.renderer.suspendRedraw(ht.board),ht.board.updateRenderer(),ht.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(ht){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),ht&&ht.attr.showcopyright&&this.displayCopyright(tt.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(ht,dt){this.container?(this.canvasRoot.style.width=parseFloat(ht)+"px",this.canvasRoot.style.height=parseFloat(dt)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(ht)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(dt)+"px")):(this.canvasRoot.width=2*parseFloat(ht),this.canvasRoot.height=2*parseFloat(dt)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),tt.CanvasRenderer}),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){return tt.JSXGraph={rendererType:function(){return st.board.renderer="no",_e.supportsVML()&&(st.board.renderer="vml",document.onmousemove=function(){var ut;return document.body&&(ut=document.body.scrollLeft,ut+=document.body.scrollTop),ut}),_e.supportsCanvas()&&(st.board.renderer="canvas"),_e.supportsSVG()&&(st.board.renderer="svg"),_e.isNode()&&_e.supportsCanvas()&&(st.board.renderer="canvas"),(_e.isNode()||st.renderer==="no")&&(st.text.display="internal",st.infobox.display="internal"),st.board.renderer}(),initRenderer:function(ut,ht,dt,pt){var ft;if(rt.exists(dt)&&dt!==!1||typeof document!="object"||(dt=document),typeof dt=="object"&&ut!==null)for(ft=dt.getElementById(ut);ft.firstChild;)ft.removeChild(ft.firstChild);else ft=ut;return pt!==void 0&&pt!=="auto"||(pt=this.rendererType),pt==="svg"?new at(ft,ht):pt==="vml"?new lt(ft):pt==="canvas"?new ot(ft,ht):new ct},initBoard:function(ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et;return ht=ht||{},vt=rt.copyAttributes(ht,st,"board"),vt.zoom=rt.copyAttributes(vt,st,"board","zoom"),vt.pan=rt.copyAttributes(vt,st,"board","pan"),vt.selection=rt.copyAttributes(vt,st,"board","selection"),vt.navbar=rt.copyAttributes(vt.navbar,st,"navbar"),bt=_e.getDimensions(ut,vt.document),vt.unitx||vt.unity?(dt=rt.def(vt.originx,150),pt=rt.def(vt.originy,150),ft=rt.def(vt.unitx,50),gt=rt.def(vt.unity,50)):(xt=vt.boundingbox,At=parseInt(bt.width,10),yt=parseInt(bt.height,10),rt.exists(xt)&&vt.keepaspectratio?(ft=At/(xt[2]-xt[0]),gt=yt/(xt[1]-xt[3]),Math.abs(ft)<Math.abs(gt)?gt=Math.abs(ft)*gt/Math.abs(gt):ft=Math.abs(gt)*ft/Math.abs(ft)):(ft=At/(xt[2]-xt[0]),gt=yt/(xt[1]-xt[3])),dt=-ft*xt[0],pt=gt*xt[1]),mt=this.initRenderer(ut,bt,vt.document,vt.renderer),Et=new it(ut,mt,vt.id,[dt,pt],vt.zoomfactor*vt.zoomx,vt.zoomfactor*vt.zoomy,ft,gt,bt.width,bt.height,vt),tt.boards[Et.id]=Et,Et.keepaspectratio=vt.keepaspectratio,Et.resizeContainer(bt.width,bt.height,!0,!0),Et.suspendUpdate(),Et.initInfobox(),vt.axis&&(_t=typeof vt.axis=="object"?vt.axis:{},Ct=rt.deepCopy(st.board.defaultAxes.x,_t),St=rt.deepCopy(st.board.defaultAxes.y,_t),vt.defaultaxes.x&&(Ct=rt.deepCopy(Ct,vt.defaultaxes.x)),vt.defaultaxes.y&&(St=rt.deepCopy(St,vt.defaultaxes.y)),Et.defaultAxes={},Et.defaultAxes.x=Et.create("axis",[[0,0],[1,0]],Ct),Et.defaultAxes.y=Et.create("axis",[[0,0],[0,1]],St)),vt.grid&&Et.create("grid",[],typeof vt.grid=="object"?vt.grid:{}),Et._createSelectionPolygon(vt),Et.renderer.drawZoomBar(Et,vt.navbar),Et.unsuspendUpdate(),Et},loadBoardFromFile:function(ut,ht,dt,pt,ft){var gt,mt,At,yt,bt;return pt=pt||{},gt=rt.copyAttributes(pt,st,"board"),gt.zoom=rt.copyAttributes(pt,st,"board","zoom"),gt.pan=rt.copyAttributes(pt,st,"board","pan"),gt.selection=rt.copyAttributes(gt,st,"board","selection"),gt.navbar=rt.copyAttributes(gt.navbar,st,"navbar"),yt=_e.getDimensions(ut,gt.document),mt=this.initRenderer(ut,yt,gt.document,gt.renderer),At=new it(ut,mt,"",[150,150],1,1,50,50,yt.width,yt.height,gt),At.initInfobox(),At.resizeContainer(yt.width,yt.height,!0,!0),nt.parseFileContent(ht,At,dt,!0,ft),bt=rt.copyAttributes(gt,st,"board","selection"),At.selectionPolygon=At.create("polygon",[[0,0],[0,0],[0,0],[0,0]],bt),At.renderer.drawZoomBar(At,gt.navbar),tt.boards[At.id]=At,At},loadBoardFromString:function(ut,ht,dt,pt,ft){var gt,mt,At,yt,bt;return pt=pt||{},gt=rt.copyAttributes(pt,st,"board"),gt.zoom=rt.copyAttributes(pt,st,"board","zoom"),gt.pan=rt.copyAttributes(pt,st,"board","pan"),gt.selection=rt.copyAttributes(gt,st,"board","selection"),gt.navbar=rt.copyAttributes(gt.navbar,st,"navbar"),At=_e.getDimensions(ut,gt.document),mt=this.initRenderer(ut,At,gt.document),yt=new it(ut,mt,"",[150,150],1,1,50,50,At.width,At.height,gt),yt.initInfobox(),yt.resizeContainer(At.width,At.height,!0,!0),nt.parseString(ht,yt,dt,!0,ft),bt=rt.copyAttributes(gt,st,"board","selection"),yt.selectionPolygon=yt.create("polygon",[[0,0],[0,0],[0,0],[0,0]],bt),yt.renderer.drawZoomBar(yt,gt.navbar),tt.boards[yt.id]=yt,yt},freeBoard:function(ut){var ht;typeof ut=="string"&&(ut=tt.boards[ut]),ut.removeEventHandlers(),ut.suspendUpdate();for(ht in ut.objects)ut.objects.hasOwnProperty(ht)&&ut.objects[ht].remove();for(;ut.containerObj.firstChild;)ut.containerObj.removeChild(ut.containerObj.firstChild);for(ht in ut.objects)ut.objects.hasOwnProperty(ht)&&delete ut.objects[ht];delete ut.renderer,ut.jc.creator.clearCache(),delete ut.jc,delete tt.boards[ut.id]},registerElement:function(ut,ht){tt.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),tt.registerElement(ut,ht)}},_e.isBrowser&&typeof window=="object"&&typeof document=="object"&&_e.addEvent(window,"load",function(){var ut,ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t=document.getElementsByTagName("script"),Ct=function(Et,Tt,Mt){var Rt=tt.JSXGraph.initBoard(ft,{boundingbox:Mt,keepaspectratio:!0,grid:xt,axis:bt,showReload:!0});if(Tt.toLowerCase().indexOf("script")>-1)Rt.construct(Et);else try{Rt.jc.parse(Et)}catch(It){tt.debug(It)}return Rt},St=function(Et,Tt,Mt,Rt){return function(){var It;tt.JSXGraph.freeBoard(Et),It=Ct(Tt,Mt,Rt),It.reload=St(It,Tt,Mt,Rt)}};for(ht=0;ht<_t.length;ht++)if(ut=_t[ht].getAttribute("type",!1),rt.exists(ut)&&(ut.toLowerCase()==="text/jessiescript"||ut.toLowerCase()==="jessiescript"||ut.toLowerCase()==="text/jessiecode"||ut.toLowerCase()==="jessiecode")){if(mt=_t[ht].getAttribute("width",!1)||"500px",At=_t[ht].getAttribute("height",!1)||"500px",yt=_t[ht].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",ft=_t[ht].getAttribute("container",!1),yt=yt.split(","),yt.length!==4)yt=[-5,5,5,-5];else for(dt=0;dt<yt.length;dt++)yt[dt]=parseFloat(yt[dt]);if(bt=rt.str2Bool(_t[ht].getAttribute("axis",!1)||"false"),xt=rt.str2Bool(_t[ht].getAttribute("grid",!1)||"false"),rt.exists(ft))pt=document.getElementById(ft);else{ft="jessiescript_autgen_jxg_"+ht,pt=document.createElement("div"),pt.setAttribute("id",ft),pt.setAttribute("style","width:"+mt+"; height:"+At+"; float:left"),pt.setAttribute("class","jxgbox");try{document.body.insertBefore(pt,_t[ht])}catch{typeof jQuery=="object"&&jQuery(pt).insertBefore(_t[ht])}}document.getElementById(ft)?(vt=_t[ht].innerHTML,vt=vt.replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),_t[ht].innerHTML=vt,gt=Ct(vt,ut,yt),gt.reload=St(gt,vt,ut,yt)):tt.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),tt.JSXGraph}),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],function(tt,_e,rt,it,nt){return tt.Group=function(st,at,lt,ot,ct){var ut,ht,dt,pt;for(this.board=st,this.objects={},ut=this.board.numObjects,this.board.numObjects+=1,at!==""&&nt.exists(at)?this.id=at:this.id=this.board.id+"Group"+ut,this.board.groups[this.id]=this,this.type=_e.OBJECT_TYPE_POINT,this.elementClass=_e.OBJECT_CLASS_POINT,lt!==""&&nt.exists(lt)?this.name=lt:this.name="group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=ct.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],ht=nt.isArray(ot)?ot:Array.prototype.slice.call(arguments,3),dt=0;dt<ht.length;dt++)pt=this.board.select(ht[dt]),!nt.evaluate(pt.visProp.fixed)&&nt.exists(pt.coords)&&this.addPoint(pt);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},tt.extend(tt.Group.prototype,{ungroup:function(){var st,at,lt;for(st in this.objects)this.objects.hasOwnProperty(st)&&(at=this.objects[st].point,nt.isArray(at.groups)&&(lt=nt.indexOf(at.groups,this.id))>=0&&delete at.groups[lt]);return this.objects={},this},addParents:function(st){var at,lt,ot;for(ot=nt.isArray(st)?st:arguments,lt=ot.length,at=0;at<lt;++at)nt.isId(this.board,ot[at])?this.parents.push(ot[at]):nt.exists(ot[at].id)&&this.parents.push(ot[at].id);this.parents=nt.uniqueArray(this.parents)},setParents:function(st){this.parents=[],this.addParents(st)},getParents:function(){return nt.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(st){var at;st!==""&&nt.exists(this.objects[st])&&(at=this.objects[st].point,this.coords[at.id]={usrCoords:at.coords.usrCoords.slice(0)})},update:function(st){var at,lt,ot,ct,ut,ht,dt,pt,ft,gt=null;if(!this.needsUpdate)return this;if(st=this._update_find_drag_type(),st.action==="nothing")return this._updateCoordsCache(st.id),this;if(gt=this.objects[st.id].point,st.action==="translation")pt=[gt.coords.usrCoords[1]-this.coords[st.id].usrCoords[1],gt.coords.usrCoords[2]-this.coords[st.id].usrCoords[2]];else if(st.action==="rotation"||st.action==="scaling"){if(lt=st.action==="rotation"?"rotationCenter":"scaleCenter",nt.isPoint(this[lt]))ft=this[lt].coords.usrCoords.slice(1);else if(this[lt]==="centroid")ft=this._update_centroid_center();else if(nt.isArray(this[lt]))ft=this[lt];else{if(!nt.isFunction(this[lt]))return this;ft=this[lt]()}if(st.action==="rotation")dt=it.rad(this.coords[st.id].usrCoords.slice(1),ft,this.objects[st.id].point),pt=this.board.create("transform",[dt,ft[0],ft[1]],{type:"rotate"}),pt.update();else{if(st.action!=="scaling")return this;if(ct=it.distance(this.coords[st.id].usrCoords.slice(1),ft),Math.abs(ct)<rt.eps)return this;ct=it.distance(gt.coords.usrCoords.slice(1),ft)/ct,ut=this.scaleDirections[st.id].indexOf("x")>=0?ct:1,ht=this.scaleDirections[st.id].indexOf("y")>=0?ct:1,pt=this.board.create("transform",[1,0,0,ft[0]*(1-ut),ut,0,ft[1]*(1-ht),0,ht],{type:"generic"}),pt.update()}}this._update_apply_transformation(st,pt),this.needsUpdate=!1;for(at in this.objects)if(this.objects.hasOwnProperty(at))for(ot in this.objects[at].descendants)this.objects[at].descendants.hasOwnProperty(ot)&&(this.objects[at].descendants.needsUpdate=this.objects[at].descendants.needsRegularUpdate||this.board.needsFullUpdate);this.board.updateElements(st);for(at in this.objects)this.objects.hasOwnProperty(at)&&this._updateCoordsCache(at);return this},_update_find_drag_type:function(){var st,at,lt,ot="nothing",ct=[];for(st in this.objects)this.objects.hasOwnProperty(st)&&(at=this.objects[st].point,at.coords.distance(_e.COORDS_BY_USER,this.coords[st])>rt.eps&&ct.push(at.id));return ct.length===0?{action:ot,id:"",changed:ct}:(lt=ct[0],at=this.objects[lt].point,ct.length>1?ot="translation":nt.isInArray(this.rotationPoints,at)&&nt.exists(this.rotationCenter)?ot="rotation":nt.isInArray(this.scalePoints,at)&&nt.exists(this.scaleCenter)?ot="scaling":nt.isInArray(this.translationPoints,at)&&(ot="translation"),{action:ot,id:lt,changed:ct})},_update_centroid_center:function(){var st,at,lt;st=[0,0],at=0;for(lt in this.coords)this.coords.hasOwnProperty(lt)&&(st[0]+=this.coords[lt].usrCoords[1],st[1]+=this.coords[lt].usrCoords[2],++at);return at>0&&(st[0]/=at,st[1]/=at),st},_update_apply_transformation:function(st,at){var lt,ot;for(lt in this.objects)this.objects.hasOwnProperty(lt)&&(nt.exists(this.board.objects[lt])?(ot=this.objects[lt].point,ot.id!==st.id?st.action==="translation"?nt.isInArray(st.changed,ot.id)||ot.coords.setCoordinates(_e.COORDS_BY_USER,[this.coords[lt].usrCoords[1]+at[0],this.coords[lt].usrCoords[2]+at[1]]):st.action!=="rotation"&&st.action!=="scaling"||at.applyOnce([ot]):st.action!=="rotation"&&st.action!=="scaling"||ot.coords.setCoordinates(_e.COORDS_BY_USER,rt.matVecMult(at.matrix,this.coords[ot.id].usrCoords))):delete this.objects[lt])},addPoint:function(st){return this.objects[st.id]={point:this.board.select(st)},this._updateCoordsCache(st.id),this.translationPoints.push(st),st.groups.push(this.id),st.groups=nt.uniqueArray(st.groups),this},addPoints:function(st){var at;for(at=0;at<st.length;at++)this.addPoint(st[at]);return this},addGroup:function(st){var at;for(at in st.objects)st.objects.hasOwnProperty(at)&&this.addPoint(st.objects[at].point);return this},removePoint:function(st){return delete this.objects[st.id],this},setRotationCenter:function(st){return this.rotationCenter=st,this},setRotationPoints:function(st){return this._setActionPoints("rotation",st)},addRotationPoint:function(st){return this._addActionPoint("rotation",st)},removeRotationPoint:function(st){return this._removeActionPoint("rotation",st)},setTranslationPoints:function(st){return this._setActionPoints("translation",st)},addTranslationPoint:function(st){return this._addActionPoint("translation",st)},removeTranslationPoint:function(st){return this._removeActionPoint("translation",st)},setScaleCenter:function(st){return this.scaleCenter=st,this},setScalePoints:function(st,at){var lt,ot,ct;for(lt=nt.isArray(st)?st:arguments,ct=lt.length,ot=0;ot<ct;++ot)this.scaleDirections[this.board.select(lt[ot]).id]=at||"xy";return this._setActionPoints("scale",st)},addScalePoint:function(st,at){return this._addActionPoint("scale",st),this.scaleDirections[this.board.select(st).id]=at||"xy",this},removeScalePoint:function(st){return this._removeActionPoint("scale",st)},_setActionPoints:function(st,at){var lt,ot,ct;for(lt=nt.isArray(at)?at:arguments,ct=lt.length,this[st+"Points"]=[],ot=0;ot<ct;++ot)this._addActionPoint(st,lt[ot]);return this},_addActionPoint:function(st,at){return this[st+"Points"].push(this.board.select(at)),this},_removeActionPoint:function(st,at){var lt=this[st+"Points"].indexOf(this.board.select(at));return lt>-1&&this[st+"Points"].splice(lt,1),this},setProperty:function(){tt.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var st;for(st in this.objects)this.objects.hasOwnProperty(st)&&this.objects[st].point.setAttribute.apply(this.objects[st].point,arguments);return this}}),tt.createGroup=function(st,at,lt){var ot=nt.copyAttributes(lt,st.options,"group"),ct=new tt.Group(st,ot.id,ot.name,at,ot);return ct.elType="group",ct.setParents(at),ct},tt.registerElement("group",tt.createGroup),{Group:tt.Group,createGroup:tt.createGroup}}),define("element/locus",["jxg","math/symbolic","utils/type","base/constants","base/curve"],function(tt,_e,rt,it,nt){return tt.createLocus=function(st,at,lt){var ot,ct;if(!rt.isArray(at)||at.length!==1||!rt.isPoint(at[0]))throw new Error(`JSXGraph: Can't create locus with parent of type other than point.
Possible parent types: [point]`);return ct=at[0],ot=st.create("curve",[[null],[null]],lt),ot.dontCallServer=!1,ot.elType="locus",ot.setParents([ct.id]),ot.updateDataArray=function(){var ut,ht,dt;ot.board.mode>0||(ut=_e.generatePolynomials(st,ct,!0).join("|"))!==ot.spe&&(ot.spe=ut,ht=function(pt,ft,gt,mt){ot.dataX=pt,ot.dataY=ft,ot.eq=gt,ot.ctime=mt,ot.generatePolynomial=function(At){return function(yt){var bt,xt="("+yt.symbolic.x+")",vt="("+yt.symbolic.y+")",_t=[];for(bt=0;bt<At.length;bt++)_t[bt]=At[bt].replace(/\*\*/g,"^").replace(/x/g,xt).replace(/y/g,vt);return _t}}(gt)},dt=_e.geometricLocusByGroebnerBase(st,ct,ht),ht(dt.datax,dt.datay,dt.polynomial,dt.exectime))},ot},tt.registerElement("locus",tt.createLocus),{createLocus:tt.createLocus}}),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","utils/type","base/coordselement"],function(tt,_e,rt,it,nt,st,at,lt){return tt.Image=function(ot,ct,ut,ht,dt){this.constructor(ot,ut,_e.OBJECT_TYPE_IMAGE,_e.OBJECT_CLASS_OTHER),this.element=this.board.select(ut.anchor),this.coordsConstructor(ct),this.W=at.createFunction(dt[0],this.board,""),this.H=at.createFunction(dt[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*ot.unitX),Math.abs(this.usrSize[1]*ot.unitY)],this.url=ht,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=tt.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},tt.Image.prototype=new it,at.copyPrototypeMethods(tt.Image,lt,"coordsConstructor"),tt.extend(tt.Image.prototype,{hasPoint:function(ot,ct){var ut,ht,dt,pt,ft,gt,mt;return this.transformations.length===0?(ut=ot-this.coords.scrCoords[1],ht=this.coords.scrCoords[2]-ct,dt=this.board.options.precision.hasPoint,ut>=-dt&&ut-this.size[0]<=dt&&ht>=-dt&&ht-this.size[1]<=dt):(pt=new rt(_e.COORDS_BY_SCREEN,[ot,ct],this.board),pt=pt.usrCoords,ft=[pt[0]-this.span[0][0],pt[1]-this.span[0][1],pt[2]-this.span[0][2]],mt=nt.innerProduct,0<=(gt=mt(ft,this.span[1]))&&gt<=mt(this.span[1],this.span[1])&&0<=(gt=mt(ft,this.span[2]))&&gt<=mt(this.span[2],this.span[2]))},update:function(ot){return this.needsUpdate?(this.updateCoords(ot),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var ot,ct,ut=this.transformations.length,ht=[];if(ut===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(ht[0]=[this.Z(),this.X(),this.Y()],ht[1]=[this.Z(),this.X()+this.W(),this.Y()],ht[2]=[this.Z(),this.X(),this.Y()+this.H()],ot=0;ot<ut;ot++)for(ct=0;ct<3;ct++)ht[ct]=nt.matVecMult(this.transformations[ot].matrix,ht[ct]);for(ct=0;ct<3;ct++)ht[ct][1]/=ht[ct][0],ht[ct][2]/=ht[ct][0],ht[ct][0]/=ht[ct][0];for(ct=1;ct<3;ct++)ht[ct][0]-=ht[0][0],ht[ct][1]-=ht[0][1],ht[ct][2]-=ht[0][2];this.span=ht}return this},addTransform:function(ot){var ct;if(at.isArray(ot))for(ct=0;ct<ot.length;ct++)this.transformations.push(ot[ct]);else this.transformations.push(ot);return this},getParents:function(){var ot=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(ot=this.parents),ot},setSize:function(ot,ct){return this.W=at.createFunction(ot,this.board,""),this.H=at.createFunction(ct,this.board,""),this},W:function(){},H:function(){}}),tt.createImage=function(ot,ct,ut){var ht,dt,pt=ct[0],ft=ct[1],gt=ct[2];if(ht=at.copyAttributes(ut,ot.options,"image"),!(dt=lt.create(tt.Image,ot,ft,ht,pt,gt)))throw new Error("JSXGraph: Can't create image with parent types '"+typeof ct[0]+"' and '"+typeof ct[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return at.evaluate(ht.rotate)!==0&&dt.addRotation(at.evaluate(ht.rotate)),dt},tt.registerElement("image",tt.createImage),{Image:tt.Image,createImage:tt.createImage}}),define("base/ticks",["jxg","math/math","math/geometry","base/constants","base/element","base/coords","utils/type","base/text"],function(tt,_e,rt,it,nt,st,at,lt){return tt.Ticks=function(ot,ct,ut){if(this.constructor(ot.board,ut,it.OBJECT_TYPE_TICKS,it.OBJECT_CLASS_OTHER),this.line=ot,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],at.isFunction(ct))throw this.ticksFunction=ct,new Error("Function arguments are no longer supported.");at.isArray(ct)?this.fixedTicks=ct:((Math.abs(ct)<_e.eps||ct<0)&&(ct=ut.defaultdistance),this.ticksFunction=this.makeTicksFunction(ct),this.equidistant=!0),this.minTicksDistance=ut.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},tt.Ticks.prototype=new nt,tt.extend(tt.Ticks.prototype,{makeTicksFunction:function(ot){return function(){var ct,ut,ht;return at.evaluate(this.visProp.insertticks)?(ut=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),ht=ut.upper-ut.lower,ct=Math.pow(10,Math.floor(Math.log(.6*ht)/Math.LN10)),ht<=6*ct&&(ct*=.5),ct):ot}},hasPoint:function(ot,ct){var ut,ht,dt=this.ticks&&this.ticks.length||0,pt=this.board.options.precision.hasPoint+.5*at.evaluate(this.visProp.strokewidth);if(!at.evaluate(this.line.visProp.scalable)||this.line.stdform[1]!==0&&this.line.stdform[2]!==0&&this.line.type!==it.OBJECT_TYPE_AXIS)return!1;for(ut=0;ut<dt;ut++)if(ht=this.ticks[ut],ht[2]&&!(this.line.stdform[1]===0&&Math.abs(ht[0][0]-this.line.point1.coords.scrCoords[1])<_e.eps||this.line.stdform[2]===0&&Math.abs(ht[1][0]-this.line.point1.coords.scrCoords[2])<_e.eps)&&(Math.abs(ht[0][0]-ht[0][1])>=1||Math.abs(ht[1][0]-ht[1][1])>=1)){if(this.line.stdform[1]===0){if(Math.abs(ct-.5*(ht[1][0]+ht[1][1]))<2*pt&&ht[0][0]-pt<ot&&ot<ht[0][1]+pt)return!0}else if(this.line.stdform[2]===0&&Math.abs(ot-.5*(ht[0][0]+ht[0][1]))<2*pt&&ht[1][0]-pt<ct&&ct<ht[1][1]+pt)return!0}return!1},setPositionDirectly:function(ot,ct,ut){var ht,dt,pt=new st(ot,ct,this.board),ft=new st(ot,ut,this.board),gt=this.board.getBoundingBox();return at.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<_e.eps&&Math.abs(pt.usrCoords[1]*ft.usrCoords[1])>_e.eps?(ht=ft.usrCoords[1]/pt.usrCoords[1],gt[0]*=ht,gt[2]*=ht,this.board.setBoundingBox(gt,!1)):Math.abs(this.line.stdform[2])<_e.eps&&Math.abs(pt.usrCoords[2]*ft.usrCoords[2])>_e.eps&&(dt=ft.usrCoords[2]/pt.usrCoords[2],gt[3]*=dt,gt[1]*=dt,this.board.setBoundingBox(gt,!1)),this):this},calculateTicksCoordinates:function(){var ot,ct;if(this.setTicksSizeVariables(),!(Math.abs(this.dx)<_e.eps&&Math.abs(this.dy)<_e.eps))return ot=this.getZeroCoordinates(),ct=this.getLowerAndUpperBounds(ot),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(ot,ct):this.generateFixedTicks(ot,ct),this},setTicksSizeVariables:function(){var ot,ct=.5*at.evaluate(this.visProp.majorheight),ut=.5*at.evaluate(this.visProp.minorheight);this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2],this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,ot=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=ct/ot*this.board.unitX,this.dyMaj*=ct/ot*this.board.unitY,this.dxMin*=ut/ot*this.board.unitX,this.dyMin*=ut/ot*this.board.unitY,this.minStyle=at.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=at.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var ot,ct,ut,ht,dt,pt,ft=at.evaluate(this.visProp.anchor);return this.line.type===it.OBJECT_TYPE_AXIS?rt.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(ut=this.line.point1.coords.usrCoords[0],ot=this.line.point1.coords.usrCoords[1],ct=this.line.point1.coords.usrCoords[2],pt=this.line.point2.coords.usrCoords[0],ht=this.line.point2.coords.usrCoords[1],dt=this.line.point2.coords.usrCoords[2],ft==="right"?this.line.point2.coords:ft==="middle"?new st(it.COORDS_BY_USER,[.5*(ut+pt),.5*(ot+ht),.5*(ct+dt)],this.board):at.isNumber(ft)?new st(it.COORDS_BY_USER,[ut+(pt-ut)*ft,ot+(ht-ot)*ft,ct+(dt-ct)*ft],this.board):this.line.point1.coords)},getLowerAndUpperBounds:function(ot,ct){var ut,ht,dt,pt,ft,gt=new st(it.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),mt=new st(it.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),At=Math.abs(gt.usrCoords[0])>=_e.eps&&gt.scrCoords[1]>=0&&gt.scrCoords[1]<=this.board.canvasWidth&&gt.scrCoords[2]>=0&&gt.scrCoords[2]<=this.board.canvasHeight,yt=Math.abs(mt.usrCoords[0])>=_e.eps&&mt.scrCoords[1]>=0&&mt.scrCoords[1]<=this.board.canvasWidth&&mt.scrCoords[2]>=0&&mt.scrCoords[2]<=this.board.canvasHeight,bt=at.evaluate(this.line.visProp.straightfirst),xt=at.evaluate(this.line.visProp.straightlast),vt=at.evaluate(this.visProp.includeboundaries);return at.exists(ct)||ct==="tickdistance"?rt.calcStraight(this.line,gt,mt,at.evaluate(this.line.visProp.margin)):rt.calcLineDelimitingPoints(this.line,gt,mt),ft=this.board.renderer.getPositionArrowHead(this.line,gt,mt,at.evaluate(this.line.visProp.strokewidth)),gt.setCoordinates(it.COORDS_BY_SCREEN,[gt.scrCoords[1]-ft.d1x,gt.scrCoords[2]-ft.d1y]),mt.setCoordinates(it.COORDS_BY_SCREEN,[mt.scrCoords[1]-ft.d2x,mt.scrCoords[2]-ft.d2y]),dt=this.getDistanceFromZero(ot,gt),pt=this.getDistanceFromZero(ot,mt),dt<pt?(ut=dt,bt||!At||vt||(ut+=_e.eps),ht=pt,xt||!yt||vt||(ht-=_e.eps)):pt<dt?(ut=pt,xt||!yt||vt||(ut+=_e.eps),ht=dt,bt||!At||vt||(ht-=_e.eps)):(ut=0,ht=0),{lower:ut,upper:ht}},getDistanceFromZero:function(ot,ct){var ut=_e.eps,ht=ot.distance(it.COORDS_BY_USER,ct);return this.line.type===it.OBJECT_TYPE_AXIS?(_e.relDif(ot.usrCoords[1],ct.usrCoords[1])>ut&&ot.usrCoords[1]-ct.usrCoords[1]>ut||_e.relDif(ot.usrCoords[2],ct.usrCoords[2])>ut&&ot.usrCoords[2]-ct.usrCoords[2]>ut)&&(ht*=-1):at.evaluate(this.visProp.anchor)==="right"?rt.isSameDirection(ot,this.line.point1.coords,ct)&&(ht*=-1):rt.isSameDirection(ot,this.line.point2.coords,ct)||(ht*=-1),ht},generateEquidistantTicks:function(ot,ct){var ut,ht=this.getXandYdeltas(),dt=this.equidistant?this.ticksFunction(1):this.ticksDelta,pt=at.evaluate(this.visProp.insertticks),ft=at.evaluate(this.visProp.minorticks);if(dt*=at.evaluate(this.visProp.scale),pt&&this.minTicksDistance>_e.eps?(dt=this.adjustTickDistance(dt,ot,ht),dt/=ft+1):pt||(dt/=ft+1),this.ticksDelta=dt,!(dt<_e.eps)){for(ut=0,at.evaluate(this.visProp.drawzero)||(ut=dt);ut<=ct.upper;)ut>=ct.lower&&this.processTickPosition(ot,ut,dt,ht),ut+=dt;for(ut=-dt;ut>=ct.lower;)ut<=ct.upper&&this.processTickPosition(ot,ut,dt,ht),ut-=dt}},adjustTickDistance:function(ot,ct,ut){var ht,dt,pt,ft=1,gt=at.evaluate(this.visProp.minorticks);for(this.getLowerAndUpperBounds(ct,"ticksdistance"),ht=ct.usrCoords[1]+ut.x*ot,dt=ct.usrCoords[2]+ut.y*ot,pt=ct.distance(it.COORDS_BY_SCREEN,new st(it.COORDS_BY_USER,[ht,dt],this.board));pt/(gt+1)<this.minTicksDistance;)ot*=ft===1?2:5,ft*=-1,ht=ct.usrCoords[1]+ut.x*ot,dt=ct.usrCoords[2]+ut.y*ot,pt=ct.distance(it.COORDS_BY_SCREEN,new st(it.COORDS_BY_USER,[ht,dt],this.board));return ot},processTickPosition:function(ot,ct,ut,ht){var dt,pt,ft,gt;dt=ot.usrCoords[1]+ct*ht.x,pt=ot.usrCoords[2]+ct*ht.y,ft=new st(it.COORDS_BY_USER,[dt,pt],this.board),ft.major=Math.round(ct/ut)%(at.evaluate(this.visProp.minorticks)+1)==0,gt=this.tickEndings(ft,ft.major),gt.length===3&&(this.ticks.push(gt),ft.major&&at.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(ft,ot),ft,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(ot,ct){var ut,ht,dt,pt,ft,gt,mt=at.isArray(this.visProp.labels),At=this.getXandYdeltas(),yt=at.evaluate(this.visProp.drawlabels);for(dt=0;dt<this.fixedTicks.length;dt++)ft=ot.usrCoords[1]+this.fixedTicks[dt]*At.x,gt=ot.usrCoords[2]+this.fixedTicks[dt]*At.y,ut=new st(it.COORDS_BY_USER,[ft,gt],this.board),pt=this.tickEndings(ut,!0),pt.length===3&&this.fixedTicks[dt]>=ct.lower&&this.fixedTicks[dt]<=ct.upper&&(this.ticks.push(pt),yt&&(mt||at.exists(this.visProp.labels[dt]))?(ht=mt?at.evaluate(this.visProp.labels[dt]):this.fixedTicks[dt],this.labelsData.push(this.generateLabelData(this.generateLabelText(ut,ot,ht),ut,dt))):this.labelsData.push(null))},getXandYdeltas:function(){var ot,ct,ut=this.line.point1.Dist(this.line.point2);return this.line.type===it.OBJECT_TYPE_AXIS?(ot=this.line.point1.coords.usrCoords,ct=this.line.point2.coords.usrCoords,(ot[1]>ct[1]||Math.abs(ot[1]-ct[1])<_e.eps&&ot[2]>ct[2])&&(ot=this.line.point2.coords.usrCoords,ct=this.line.point1.coords.usrCoords)):(ot=this.line.point1.coords.usrCoords,ct=this.line.point2.coords.usrCoords),{x:(ct[1]-ot[1])/ut,y:(ct[2]-ot[2])/ut}},_isInsideCanvas:function(ot,ct,ut){var ht=this.board.canvasWidth,dt=this.board.canvasHeight;return ut===void 0&&(ut=0),ot[0]>=ut&&ot[0]<=ht-ut&&ct[0]>=ut&&ct[0]<=dt-ut||ot[1]>=ut&&ot[1]<=ht-ut&&ct[1]>=ut&&ct[1]<=dt-ut},tickEndings:function(ot,ct){var ut,ht,dt,pt,ft,gt,mt=[-2e6,-2e6],At=[-2e6,-2e6];return ut=ot.scrCoords,ct?(pt=this.dxMaj,ft=this.dyMaj,gt=this.majStyle):(pt=this.dxMin,ft=this.dyMin,gt=this.minStyle),ht=[-ft*ut[1]-pt*ut[2],ft,pt],gt==="infinite"?(dt=rt.meetLineBoard(ht,this.board),mt[0]=dt[0].scrCoords[1],mt[1]=dt[1].scrCoords[1],At[0]=dt[0].scrCoords[2],At[1]=dt[1].scrCoords[2]):(mt[0]=ut[1]+pt*at.evaluate(this.visProp.tickendings[0]),At[0]=ut[2]-ft*at.evaluate(this.visProp.tickendings[0]),mt[1]=ut[1]-pt*at.evaluate(this.visProp.tickendings[1]),At[1]=ut[2]+ft*at.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(mt,At)?[mt,At,ct]:[]},formatLabelText:function(ot){var ct=ot.toString(),ut=at.evaluate(this.visProp.scalesymbol);return at.isNumber(ot)&&((ct.length>at.evaluate(this.visProp.maxlabellength)||ct.indexOf("e")!==-1)&&(ct=ot.toPrecision(at.evaluate(this.visProp.precision)).toString()),ct.indexOf(".")>-1&&ct.indexOf("e")===-1&&(ct=ct.replace(/0+$/,""),ct=ct.replace(/\.$/,""))),ut.length>0&&(ct==="1"?ct=ut:ct==="-1"?ct="-"+ut:ct!=="0"&&(ct+=ut)),at.evaluate(this.visProp.useunicodeminus)&&(ct=ct.replace(/-/g,"−")),ct},generateLabelText:function(ot,ct,ut){var ht,dt=this.getDistanceFromZero(ct,ot);return Math.abs(dt)<_e.eps?ht="0":(at.exists(ut)||(ut=dt/at.evaluate(this.visProp.scale)),ht=this.formatLabelText(ut)),ht},generateLabelData:function(ot,ct,ut){var ht,dt,pt,ft;return ft=at.evaluate(this.visProp.label.fontsize),ht=[ct.scrCoords[1],ct.scrCoords[1]],dt=[ct.scrCoords[2],ct.scrCoords[2]],pt=ft===void 0?12:ft,pt*=1.5,this._isInsideCanvas(ht,dt,pt)?(ht=at.evaluate(this.visProp.label.offset[0]),dt=at.evaluate(this.visProp.label.offset[1]),{x:ct.usrCoords[1]+ht/this.board.unitX,y:ct.usrCoords[2]+dt/this.board.unitY,t:ot,i:ut}):null},update:function(){return this.needsUpdate&&this.board.canvasWidth!==0&&this.board.canvasHeight!==0&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var ot,ct,ut,ht,dt,pt,ft,gt;for(ut=this.labelsData.length,ht=this.labels.length,ot=0,ct=0;ot<ut;ot++)this.labelsData[ot]!==null&&(ft=this.labelsData[ot],ct<ht?(pt=this.labels[ct],pt.setText(ft.t),pt.setCoords(ft.x,ft.y),ct++):(this.labelCounter+=1,dt={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},dt=at.deepCopy(dt,this.visProp.label),dt.id=this.id+ft.i+"Label"+this.labelCounter,pt=lt.createText(this.board,[ft.x,ft.y,ft.t],dt),pt.isDraggable=!1,pt.dump=!1,this.labels.push(pt)),gt=at.evaluate(this.visProp.label.visible),gt==="inherit"&&(gt=this.visPropCalc.visible),pt.prepareUpdate().updateVisibility(gt).updateRenderer(),pt.distanceX=at.evaluate(this.visProp.label.offset[0]),pt.distanceY=at.evaluate(this.visProp.label.offset[1]));for(ut=ct,ct=ut;ct<ht;ct++)this.board.renderer.display(this.labels[ct],!1),this.labels[ct].visProp.visible=!1;return this},hideElement:function(){var ot;for(tt.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),ot=0;ot<this.labels.length;ot++)at.exists(this.labels[ot])&&this.labels[ot].hideElement();return this},showElement:function(){var ot;for(tt.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),ot=0;ot<this.labels.length;ot++)at.exists(this.labels[ot])&&this.labels[ot].showElement();return this}}),tt.createTicks=function(ot,ct,ut){var ht,dt,pt=at.copyAttributes(ut,ot.options,"ticks");if(dt=ct.length<2?pt.ticksdistance:ct[1],ct[0].elementClass!==it.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof ct[0]+"'.");return ht=new tt.Ticks(ct[0],dt,pt),at.isFunction(pt.generatelabelvalue)&&(ht.generateLabelText=pt.generatelabelvalue),at.isFunction(pt.generatelabeltext)&&(ht.generateLabelText=pt.generatelabeltext),ht.setParents(ct[0]),ht.isDraggable=!0,ht.fullUpdate(ct[0].visPropCalc.visible),ht},tt.createHatchmark=function(ot,ct,ut){var ht,dt,pt,ft,gt,mt,At=[],yt=at.copyAttributes(ut,ot.options,"hatch");if(ct[0].elementClass!==it.OBJECT_CLASS_LINE||typeof ct[1]!="number")throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof ct[0]+"' and '"+typeof ct[1]+" and ''"+typeof ct[2]+"'.");for(ht=ct[1],ft=yt.ticksdistance,gt=(ht-1)*ft,pt=.5*-gt,dt=0;dt<ht;dt++)At[dt]=pt+dt*ft;return mt=ot.create("ticks",[ct[0],At],yt),mt.elType="hatch",mt},tt.registerElement("ticks",tt.createTicks),tt.registerElement("hash",tt.createHatchmark),tt.registerElement("hatch",tt.createHatchmark),{Ticks:tt.Ticks,createTicks:tt.createTicks,createHashmark:tt.createHatchmark,createHatchmark:tt.createHatchmark}}),define("element/slider",["jxg","math/math","base/constants","utils/type","base/point","base/group","base/element","base/line","base/ticks","base/text"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct){return tt.createSlider=function(ut,ht,dt){var pt,ft,gt,mt,At,yt,bt,xt,vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt;return Nt=it.copyAttributes(dt,ut.options,"slider"),Ot=Nt.withticks,It=Nt.withlabel,Bt=Nt.snapwidth,zt=Nt.precision,Nt=it.copyAttributes(dt,ut.options,"slider","point1"),bt=ut.create("point",ht[0],Nt),Nt=it.copyAttributes(dt,ut.options,"slider","point2"),xt=ut.create("point",ht[1],Nt),Nt=it.copyAttributes(dt,ut.options,"slider","baseline"),vt=ut.create("segment",[bt,xt],Nt),vt.updateStdform(),pt=bt.coords.usrCoords.slice(1),ft=xt.coords.usrCoords.slice(1),gt=ht[2][0],mt=ht[2][1],At=ht[2][2],yt=At-gt,St=pt[0]+(ft[0]-pt[0])*(mt-gt)/(At-gt),Et=pt[1]+(ft[1]-pt[1])*(mt-gt)/(At-gt),Nt=it.copyAttributes(dt,ut.options,"slider"),Nt.withLabel=!1,Tt=ut.create("glider",[St,Et,vt],Nt),Tt.setAttribute({snapwidth:Bt}),Nt=it.copyAttributes(dt,ut.options,"slider","highline"),Mt=ut.create("segment",[bt,Tt],Nt),Tt.Value=function(){var Dt=this._smax-this._smin,Ft=it.evaluate(this.visProp.snapwidth);return Ft===-1?this.position*Dt+this._smin:Math.round((this.position*Dt+this._smin)/Ft)*Ft},Tt.methodMap=it.deepCopy(Tt.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),Tt._smax=At,Tt._smin=gt,Tt.setMax=function(Dt){return this._smax=Dt,this},Tt.setValue=function(Dt){var Ft=this._smax-this._smin;return Math.abs(Ft)>_e.eps?this.position=(Dt-this._smin)/Ft:this.position=0,this.position=Math.max(0,Math.min(1,this.position)),this},Tt.setMin=function(Dt){return this._smin=Dt,this},It&&(Nt=it.copyAttributes(dt,ut.options,"slider","label"),Rt=ut.create("text",[function(){return .05*(xt.X()-bt.X())+xt.X()},function(){return .05*(xt.Y()-bt.Y())+xt.Y()},function(){var Dt,Ft=it.evaluate(Tt.visProp.suffixlabel),Ut=it.evaluate(Tt.visProp.unitlabel),$t=it.evaluate(Tt.visProp.postlabel);return Dt=Ft!==null?Ft:Tt.name&&Tt.name!==""?Tt.name+" = ":"",Dt+=it.toFixed(Tt.Value(),zt),Ut!==null&&(Dt+=Ut),$t!==null&&(Dt+=$t),Dt}],Nt),Tt.label=Rt,Tt.visProp.withlabel=!0,Tt.hasLabel=!0),Tt.point1=bt,Tt.point2=xt,Tt.baseline=vt,Tt.highline=Mt,Ot&&(Nt=it.copyAttributes(dt,ut.options,"slider","ticks"),it.exists(Nt.generatelabeltext)||(Nt.generateLabelText=function(Dt,Ft,Ut){var $t=Tt.point1.Dist(Tt.point2),Vt=Tt._smin,Zt=Tt._smax,qt=this.getDistanceFromZero(Ft,Dt)*(Zt-Vt)/$t+Vt;return $t<_e.eps||Math.abs(qt)<_e.eps?"0":this.formatLabelText(qt)}),_t=2,Ct=ut.create("ticks",[Tt.baseline,Tt.point1.Dist(bt)/_t,function(Dt){var Ft=Tt.point1.Dist(Tt.point2),Ut=Tt.point1.coords.distance(rt.COORDS_BY_USER,Dt);return Ft<_e.eps?0:Ut/Ft*yt+gt}],Nt),Tt.ticks=Ct),Tt.remove=function(){It&&ut.removeObject(Rt),ut.removeObject(Mt),ut.removeObject(vt),ut.removeObject(xt),ut.removeObject(bt),nt.Point.prototype.remove.call(Tt)},bt.dump=!1,xt.dump=!1,vt.dump=!1,Mt.dump=!1,Tt.elType="slider",Tt.parents=ht,Tt.subs={point1:bt,point2:xt,baseLine:vt,highLine:Mt},Tt.inherits.push(bt,xt,vt,Mt),Ot&&(Ct.dump=!1,Tt.subs.ticks=Ct,Tt.inherits.push(Ct)),Tt},tt.registerElement("slider",tt.createSlider),{createSlider:tt.createSlider}}),define("element/measure",["jxg","utils/type","base/element","base/point","base/line","base/ticks"],function(tt,_e,rt,it,nt,st){return tt.createTapemeasure=function(at,lt,ot){var ct,ut,ht,dt,pt,ft,gt,mt,At,yt,bt;return ct=lt[0],ut=lt[1],ht=_e.copyAttributes(ot,at.options,"tapemeasure","point1"),mt=at.create("point",ct,ht),ht=_e.copyAttributes(ot,at.options,"tapemeasure","point2"),At=at.create("point",ut,ht),mt.setAttribute({ignoredSnapToPoints:[At]}),At.setAttribute({ignoredSnapToPoints:[mt]}),ht=_e.copyAttributes(ot,at.options,"tapemeasure"),dt=ht.withticks,pt=ht.withlabel,ft=ht.precision,pt&&(ht.withlabel=!0),gt=at.create("segment",[mt,At],ht),pt&&(yt=ot.name&&ot.name!==""?ot.name+" = ":"",gt.label.setText(function(){return yt+_e.toFixed(mt.Dist(At),ft)})),dt&&(ht=_e.copyAttributes(ot,at.options,"tapemeasure","ticks"),bt=at.create("ticks",[gt,.1],ht),gt.inherits.push(bt)),gt.remove=function(){dt&&gt.removeTicks(bt),at.removeObject(At),at.removeObject(mt),rt.prototype.remove.call(this)},gt.Value=function(){return mt.Dist(At)},mt.dump=!1,At.dump=!1,gt.elType="tapemeasure",gt.getParents=function(){return[[mt.X(),mt.Y()],[At.X(),At.Y()]]},gt.subs={point1:mt,point2:At},dt&&(bt.dump=!1),gt.methodMap=tt.deepCopy(gt.methodMap,{Value:"Value"}),gt.prepareUpdate().update(),at.isSuspendedUpdate||(gt.updateVisibility().updateRenderer(),gt.point1.updateVisibility().updateRenderer(),gt.point2.updateVisibility().updateRenderer()),gt},tt.registerElement("tapemeasure",tt.createTapemeasure),{createTapemeasure:tt.createTapemeasure}}),define("parser/datasource",["jxg","utils/type"],function(tt,_e){return tt.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},tt.extend(tt.DataSource.prototype,{loadFromArray:function(rt,it,nt){var st,at,lt;if(_e.isArray(it)&&(this.columnHeaders=it,it=!1),_e.isArray(nt)&&(this.rowHeaders=nt,nt=!1),this.data=[],it&&(this.columnHeaders=[]),nt&&(this.rowHeaders=[]),_e.exists(rt)){for(this.data=[],st=0;st<rt.length;st++)for(this.data[st]=[],at=0;at<rt[st].length;at++)lt=rt[st][at],parseFloat(lt).toString()===lt?this.data[st][at]=parseFloat(lt):this.data[st][at]=lt!=="-"?lt:NaN;if(it&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),nt)for(this.rowHeaders=[],st=0;st<this.data.length;st++)this.rowHeaders.push(this.data[st][0]),this.data[st]=this.data[st].slice(1)}return this},loadFromTable:function(rt,it,nt){var st,at,lt,ot,ct;if(_e.isArray(it)&&(this.columnHeaders=it,it=!1),_e.isArray(nt)&&(this.rowHeaders=nt,nt=!1),this.data=[],it&&(this.columnHeaders=[]),nt&&(this.rowHeaders=[]),rt=document.getElementById(rt),_e.exists(rt)){for(st=rt.getElementsByTagName("tr"),this.data=[],at=0;at<st.length;at++)for(ot=st[at].getElementsByTagName("td"),this.data[at]=[],lt=0;lt<ot.length;lt++)ct=ot[lt].innerHTML,parseFloat(ct).toString()===ct?this.data[at][lt]=parseFloat(ct):this.data[at][lt]=ct!=="-"?ct:NaN;if(it&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),nt)for(this.rowHeaders=[],at=0;at<this.data.length;at++)this.rowHeaders.push(this.data[at][0]),this.data[at]=this.data[at].slice(1)}return this},addColumn:function(rt,it,nt){throw new Error("not implemented")},addRow:function(rt,it,nt){throw new Error("not implemented")},getColumn:function(rt){var it,nt=[];if(_e.isString(rt)){for(it=0;it<this.columnHeaders.length;it++)if(rt===this.columnHeaders[it]){rt=it;break}}for(it=0;it<this.data.length;it++)this.data[it].length>rt&&(nt[it]=parseFloat(this.data[it][rt]));return nt},getRow:function(rt){var it,nt;if(_e.isString(rt)){for(nt=0;nt<this.rowHeaders.length;nt++)if(rt===this.rowHeaders[nt]){rt=nt;break}}for(it=[],nt=0;nt<this.data[rt].length;nt++)it[nt]=this.data[rt][nt];return it}}),tt.DataSource}),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],function(tt,_e,rt,it,nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At){return tt.Chart=function(yt,bt,xt){this.constructor(yt,xt);var vt,_t,Ct,St,Et,Tt;if(!ot.isArray(bt)||bt.length===0)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],ot.isNumber(bt[0]))for(_t=bt,vt=[],Ct=0;Ct<_t.length;Ct++)vt[Ct]=Ct+1;else if(bt.length===1&&ot.isArray(bt[0]))for(_t=bt[0],vt=[],Tt=ot.evaluate(_t).length,Ct=0;Ct<Tt;Ct++)vt[Ct]=Ct+1;else bt.length===2&&(Tt=Math.min(bt[0].length,bt[1].length),vt=bt[0].slice(0,Tt),_t=bt[1].slice(0,Tt));if(ot.isArray(_t)&&_t.length===0)throw new Error("JSXGraph: Can't create charts without data.");for(Et=xt.chartstyle.replace(/ /g,"").split(","),Ct=0;Ct<Et.length;Ct++){switch(Et[Ct]){case"bar":St=this.drawBar(yt,vt,_t,xt);break;case"line":St=this.drawLine(yt,vt,_t,xt);break;case"fit":St=this.drawFit(yt,vt,_t,xt);break;case"spline":St=this.drawSpline(yt,vt,_t,xt);break;case"pie":St=this.drawPie(yt,_t,xt);break;case"point":St=this.drawPoints(yt,vt,_t,xt);break;case"radar":St=this.drawRadar(yt,bt,xt)}this.elements.push(St)}return this.id=this.board.setId(this,"Chart"),this.elements},tt.Chart.prototype=new st,tt.extend(tt.Chart.prototype,{drawLine:function(yt,bt,xt,vt){return vt.fillcolor="none",vt.highlightfillcolor="none",yt.create("curve",[bt,xt],vt)},drawSpline:function(yt,bt,xt,vt){return vt.fillColor="none",vt.highlightfillcolor="none",yt.create("spline",[bt,xt],vt)},drawFit:function(yt,bt,xt,vt){var _t=vt.degree;return _t=Math.max(parseInt(_t,10),1)||1,vt.fillcolor="none",vt.highlightfillcolor="none",yt.create("functiongraph",[_e.regressionPolynomial(_t,bt,xt)],vt)},drawBar:function(yt,bt,xt,vt){var _t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt=[],zt=[],Dt=function(Ut,$t){return function(){return bt[Ut]()-$t*St}},Ft={fixed:!0,withLabel:!1,visible:!1,name:""};if((Ot=ot.copyAttributes(vt,yt.options,"chart"))&&Ot.width)St=Ot.width;else{if(bt.length<=1)St=1;else for(St=bt[1]-bt[0],_t=1;_t<bt.length-1;_t++)St=bt[_t+1]-bt[_t]<St?bt[_t+1]-bt[_t]:St;St*=.8}for(Bt=ot.copyAttributes(vt,yt.options,"chart","label"),_t=0;_t<bt.length;_t++)ot.isFunction(bt[_t])?(Et=Dt(_t,-.5),Tt=Dt(_t,0),Mt=Dt(_t,.5)):(Et=bt[_t]-.5*St,Tt=bt[_t],Mt=bt[_t]+.5*St),Rt=ot.isFunction(xt[_t])?xt[_t]():xt[_t],Rt=xt[_t],Ot.dir==="horizontal"?(zt[0]=yt.create("point",[0,Et],Ft),zt[1]=yt.create("point",[Rt,Et],Ft),zt[2]=yt.create("point",[Rt,Mt],Ft),zt[3]=yt.create("point",[0,Mt],Ft),ot.exists(Ot.labels)&&ot.exists(Ot.labels[_t])&&(Bt.anchorY="middle",Ct=yt.create("text",[Rt,Tt,Ot.labels[_t]],Bt),Ct.visProp.anchorx=function(Ut){return function(){return Ut.X()>=0?"left":"right"}}(Ct))):(zt[0]=yt.create("point",[Et,0],Ft),zt[1]=yt.create("point",[Et,Rt],Ft),zt[2]=yt.create("point",[Mt,Rt],Ft),zt[3]=yt.create("point",[Mt,0],Ft),ot.exists(Ot.labels)&&ot.exists(Ot.labels[_t])&&(Bt.anchorX="middle",Ct=yt.create("text",[Tt,Rt,Ot.labels[_t]],Bt),Ct.visProp.anchory=function(Ut){return function(){return Ut.Y()>=0?"bottom":"top"}}(Ct))),ot.isArray(Ot.colors)&&(It=Ot.colors,Ot.fillcolor=It[_t%It.length]),Nt[_t]=yt.create("polygon",zt,Ot),ot.exists(Ot.labels)&&ot.exists(Ot.labels[_t])&&(Nt[_t].text=Ct);return Nt},drawPoints:function(yt,bt,xt,vt){var _t,Ct=[],St=vt.infoboxarray;for(vt.fixed=!0,vt.name="",_t=0;_t<bt.length;_t++)vt.infoboxtext=!!St&&St[_t%St.length],Ct[_t]=yt.create("point",[bt[_t],xt[_t]],vt);return Ct},drawPie:function(yt,bt,xt){var vt,_t,Ct=[],St=[],Et=(rt.sum(bt),xt.colors),Tt=xt.highlightcolors,Mt=xt.labels,Rt=xt.radius||4,It=Rt,Ot=xt.center||[0,0],Bt=Ot[0],Nt=Ot[1],zt=function(Vt,Zt,qt){return function(){var sr,er,ir,ur=0;for(er=0;er<=Vt;er++)ur+=parseFloat(ot.evaluate(bt[er]));for(sr=ur,er=Vt+1;er<bt.length;er++)sr+=parseFloat(ot.evaluate(bt[er]));return ir=sr!==0?2*Math.PI*ur/sr:0,It()*Math[Zt](ir)+qt}},Dt=function(Vt,Zt){var qt=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],sr=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];ot.exists(this.label)&&(this.label.rendNode.style.fontSize=Zt*ot.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new nt(it.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+qt*Vt,this.point1.coords.usrCoords[2]+sr*Vt],this.board),this.fullUpdate()},Ft=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),Dt.call(this,1.1,2))},Ut=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),Dt.call(this,.9090909,1))},$t={fixed:!0,withLabel:!1,visible:!1,name:""};if(!ot.isArray(Mt))for(Mt=[],vt=0;vt<bt.length;vt++)Mt[vt]="";for(ot.isFunction(Rt)||(It=function(){return Rt}),xt.highlightonsector=xt.highlightonsector||!1,xt.straightfirst=!1,xt.straightlast=!1,_t=yt.create("point",[Bt,Nt],$t),Ct[0]=yt.create("point",[function(){return It()+Bt},function(){return Nt}],$t),vt=0;vt<bt.length;vt++)Ct[vt+1]=yt.create("point",[zt(vt,"cos",Bt),zt(vt,"sin",Nt)],$t),xt.name=Mt[vt],xt.withlabel=xt.name!=="",xt.fillcolor=Et&&Et[vt%Et.length],xt.labelcolor=Et&&Et[vt%Et.length],xt.highlightfillcolor=Tt&&Tt[vt%Tt.length],St[vt]=yt.create("sector",[_t,Ct[vt],Ct[vt+1]],xt),xt.highlightonsector&&(St[vt].hasPoint=St[vt].hasPointSector),xt.highlightbysize&&(St[vt].highlight=Ft,St[vt].noHighlight=Ut);return{sectors:St,points:Ct,midpoint:_t}},drawRadar:function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft,Ut,$t,Vt,Zt,qt,sr,er,ir,ur,ar,lr,gr,Yt,nr,mr,Sr,Er,Nr,wr,kr,Ur,Or,Xr,Qt,Xt,xr,Lr,fr,pr=bt.length,Hr=function(){var Cr,tr,Ar,yr,Jt=ot.evaluate(this.visProp.label.offset).slice(0);return Cr=this.point1.X(),tr=this.point2.X(),Ar=this.point1.Y(),yr=this.point2.Y(),tr<Cr&&(Jt[0]=-Jt[0]),yr<Ar&&(Jt[1]=-Jt[1]),this.setLabelRelativeCoords(Jt),new nt(it.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},hr=function(Cr,tr){var Ar,yr,Jt;return Ar=yt.create("transform",[-(Ft[tr]-zt[tr]),0],{type:"translate"}),yr=yt.create("transform",[Zt/(Ut[tr]+Dt[tr]-(Ft[tr]-zt[tr])),1],{type:"scale"}),Ar.melt(yr),Jt=yt.create("transform",[Cr],{type:"rotate"}),Ar.melt(Jt),Ar};if(pr<=0)return void tt.debug("No data");if(Ct=xt.paramarray,!ot.exists(Ct))return void tt.debug("Need paramArray attribute");if((St=Ct.length)<=1)return void tt.debug("Need more than 1 param");for(vt=0;vt<pr;vt++)if(St!==bt[vt].length)return void tt.debug("Use data length equal to number of params ("+bt[vt].length+" != "+St+")");for(Et=[],Tt=[],_t=0;_t<St;_t++)Et[_t]=bt[0][_t],Tt[_t]=Et[_t];for(vt=1;vt<pr;vt++)for(_t=0;_t<St;_t++)bt[vt][_t]>Et[_t]&&(Et[_t]=bt[vt][_t]),bt[vt][_t]<Tt[_t]&&(Tt[_t]=bt[vt][_t]);for(Mt=[],Rt=[],vt=0;vt<pr;vt++)Mt[vt]="",Rt[vt]=[];for(It=[],Ot=[],Bt=xt.startshiftratio||0,Nt=xt.endshiftratio||0,vt=0;vt<St;vt++)It[vt]=(Et[vt]-Tt[vt])*Bt,Ot[vt]=(Et[vt]-Tt[vt])*Nt;if(zt=xt.startshiftarray||It,Dt=xt.endshiftarray||Ot,Ft=xt.startarray||Tt,ot.exists(xt.start))for(vt=0;vt<St;vt++)Ft[vt]=xt.start;if(Ut=xt.endarray||Et,ot.exists(xt.end))for(vt=0;vt<St;vt++)Ut[vt]=xt.end;if(zt.length!==St)return void tt.debug("Start shifts length is not equal to number of parameters");if(Dt.length!==St)return void tt.debug("End shifts length is not equal to number of parameters");if(Ft.length!==St)return void tt.debug("Starts length is not equal to number of parameters");if(Ut.length!==St)return void tt.debug("Ends length is not equal to number of parameters");for($t=xt.labelarray||Mt,Vt=xt.colors,xt.highlightcolors,Zt=xt.radius||10,Lr=xt.strokewidth||1,ot.exists(xt.highlightonsector)||(xt.highlightonsector=!1),qt={name:xt.name,id:xt.id,strokewidth:Lr,polystrokewidth:xt.polystrokewidth||Lr,strokecolor:xt.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:xt.fillColor||"#FFFF88",fillopacity:xt.fillOpacity||.4,highlightfillcolor:xt.highlightFillColor||"#FF7400",highlightstrokecolor:xt.highlightStrokeColor||"black",gradient:xt.gradient||"none"},sr=xt.center||[0,0],er=sr[0],ir=sr[1],ur=yt.create("point",[er,ir],{name:"",fixed:!0,withlabel:!1,visible:!1}),ar=Math.PI/2-Math.PI/St,ar=xt.startangle||0,lr=ar,gr=[],Yt=[],vt=0;vt<St;vt++)for(lr+=2*Math.PI/St,mr=Zt*Math.cos(lr)+er,Sr=Zt*Math.sin(lr)+ir,gr[vt]=yt.create("point",[mr,Sr],{name:"",fixed:!0,withlabel:!1,visible:!1}),Yt[vt]=yt.create("line",[ur,gr[vt]],{name:Ct[vt],strokeColor:qt.strokecolor,strokeWidth:qt.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:qt.highlightstrokecolor}),Yt[vt].getLabelAnchor=Hr,nr=hr(lr,vt),_t=0;_t<bt.length;_t++)fr=bt[_t][vt],Rt[_t][vt]=yt.create("point",[fr,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),Rt[_t][vt].addTransform(Rt[_t][vt],nr);for(Er=[],vt=0;vt<pr;vt++)for(qt.labelcolor=Vt&&Vt[vt%Vt.length],qt.strokecolor=Vt&&Vt[vt%Vt.length],qt.fillcolor=Vt&&Vt[vt%Vt.length],Er[vt]=yt.create("polygon",Rt[vt],{withLines:!0,withLabel:!1,fillColor:qt.fillcolor,fillOpacity:qt.fillopacity,highlightFillColor:qt.highlightfillcolor}),_t=0;_t<St;_t++)Er[vt].borders[_t].setAttribute("strokecolor:"+Vt[vt%Vt.length]),Er[vt].borders[_t].setAttribute("strokewidth:"+qt.polystrokewidth);switch(xt.legendposition||"none"){case"right":wr=xt.legendleftoffset||2,kr=xt.legendtopoffset||1,this.legend=yt.create("legend",[er+Zt+wr,ir+Zt-kr],{labels:$t,colors:Vt});break;case"none":break;default:tt.debug("Unknown legend position")}if(Nr=[],xt.showcircles){for(Ur=[],vt=0;vt<6;vt++)Ur[vt]=20*vt;if(Ur[0]="0",Or=xt.circlelabelarray||Ur,(Xr=Or.length)<2)return void tt.debug("Too less circles");for(Qt=[],Xt=ar+Math.PI/St,nr=hr(Xt,0),qt.fillcolor="none",qt.highlightfillcolor="none",qt.strokecolor=xt.strokecolor||"black",qt.strokewidth=xt.circlestrokewidth||.5,qt.layer=0,xr=(Ut[0]-Ft[0])/(Xr-1),vt=0;vt<Xr;vt++)Qt[vt]=yt.create("point",[Ft[0]+vt*xr,0],{name:Or[vt],size:0,fixed:!0,withLabel:!0,visible:!0}),Qt[vt].addTransform(Qt[vt],nr),Nr[vt]=yt.create("circle",[ur,Qt[vt]],qt)}return this.rendNode=Er[0].rendNode,{circles:Nr,lines:Yt,points:Rt,midpoint:ur,polygons:Er}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){}}),tt.createChart=function(yt,bt,xt){var vt,_t,Ct,St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft,Ut,$t=[],Vt=ct.isBrowser?yt.document.getElementById(bt[0]):null;if(bt.length===1&&ot.isString(bt[0])){if(ot.exists(Vt)){if(It=ot.copyAttributes(xt,yt.options,"chart"),Vt=new at().loadFromTable(bt[0],It.withheaders,It.withheaders),vt=Vt.data,Et=Vt.columnHeaders,_t=Vt.rowHeaders,Ot=It.width,Bt=It.name,Nt=It.strokecolor,zt=It.fillcolor,Dt=It.highlightstrokecolor,Ft=It.highlightfillcolor,yt.suspendUpdate(),Ut=vt.length,Rt=[],It.rows&&ot.isArray(It.rows)){for(Ct=0;Ct<Ut;Ct++)for(St=0;St<It.rows.length;St++)if(It.rows[St]===Ct||It.withheaders&&It.rows[St]===_t[Ct]){Rt.push(vt[Ct]);break}}else Rt=vt;for(Ut=Rt.length,Ct=0;Ct<Ut;Ct++){if(Mt=[],It.chartstyle&&It.chartstyle.indexOf("bar")!==-1){for(Tt=Ot||.8,Mt.push(1-Tt/2+(Ct+.5)*Tt/Ut),St=1;St<Rt[Ct].length;St++)Mt.push(Mt[St-1]+1);It.width=Tt/Ut}Bt&&Bt.length===Ut?It.name=Bt[Ct]:It.withheaders&&(It.name=Et[Ct]),Nt&&Nt.length===Ut?It.strokecolor=Nt[Ct]:It.strokecolor=lt.hsv2rgb((Ct+1)/Ut*360,.9,.6),zt&&zt.length===Ut?It.fillcolor=zt[Ct]:It.fillcolor=lt.hsv2rgb((Ct+1)/Ut*360,.9,1),Dt&&Dt.length===Ut?It.highlightstrokecolor=Dt[Ct]:It.highlightstrokecolor=lt.hsv2rgb((Ct+1)/Ut*360,.9,1),Ft&&Ft.length===Ut?It.highlightfillcolor=Ft[Ct]:It.highlightfillcolor=lt.hsv2rgb((Ct+1)/Ut*360,.9,.6),It.chartstyle&&It.chartstyle.indexOf("bar")!==-1?$t.push(new tt.Chart(yt,[Mt,Rt[Ct]],It)):$t.push(new tt.Chart(yt,[Rt[Ct]],It))}yt.unsuspendUpdate()}return $t}return It=ot.copyAttributes(xt,yt.options,"chart"),new tt.Chart(yt,bt,It)},tt.registerElement("chart",tt.createChart),tt.Legend=function(yt,bt,xt){var vt;if(this.constructor(),vt=ot.copyAttributes(xt,yt.options,"legend"),this.board=yt,this.coords=new nt(it.COORDS_BY_USER,bt,this.board),this.myAtts={},this.label_array=vt.labelarray||vt.labels,this.color_array=vt.colorarray||vt.colors,this.lines=[],this.myAtts.strokewidth=vt.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=vt.legendstyle||vt.style,this.style!=="vertical")throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(yt,vt)},tt.Legend.prototype=new st,tt.Legend.prototype.drawVerticalLegend=function(yt,bt){var xt,vt=bt.linelength||1,_t=(bt.rowheight||20)/this.board.unitY,Ct=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new nt(it.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(xt=0;xt<this.label_array.length;xt++)this.myAtts.strokecolor=this.color_array[xt],this.myAtts.highlightstrokecolor=this.color_array[xt],this.myAtts.name=this.label_array[xt],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[xt],strokeWidth:this.myAtts.strokewidth},this.lines[xt]=yt.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-xt*_t],[this.coords.usrCoords[1]+vt,this.coords.usrCoords[2]-xt*_t]],this.myAtts),this.lines[xt].getLabelAnchor=Ct},tt.createLegend=function(yt,bt,xt){var vt=[0,0];return ot.exists(bt)&&bt.length===2&&(vt=bt),new tt.Legend(yt,vt,xt)},tt.registerElement("legend",tt.createLegend),{Chart:tt.Chart,Legend:tt.Legend,createChart:tt.createChart,createLegend:tt.createLegend}}),define("base/turtle",["jxg","base/constants","base/element","utils/type","base/curve","base/point","base/line","base/transformation"],function(tt,_e,rt,it,nt,st,at,lt){return tt.Turtle=function(ot,ct,ut){var ht,dt,pt;return this.constructor(ot,ut,_e.OBJECT_TYPE_TURTLE,_e.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=ot,this.visProp.curveType="plot",this._attributes=it.copyAttributes(this.visProp,ot.options,"turtle"),delete this._attributes.id,ht=0,dt=0,pt=90,ct.length!==0&&(ct.length===3?(ht=ct[0],dt=ct[1],pt=ct[2]):ct.length===2?it.isArray(ct[0])?(ht=ct[0][0],dt=ct[0][1],pt=ct[1]):(ht=ct[0],dt=ct[1]):(ht=ct[0][0],dt=ct[0][1])),this.init(ht,dt,pt),this.methodMap=it.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},tt.Turtle.prototype=new rt,tt.extend(tt.Turtle.prototype,{init:function(ot,ct,ut){var ht={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[ot,ct],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,ht),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],ht),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-ut),this.board.update()},forward:function(ot){if(ot===0)return this;var ct,ut=ot*Math.cos(this.dir*Math.PI/180),ht=ot*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||(ct=this.board.create("transform",[ut,ht],{type:"translate"}),ct.applyOnce(this.turtle),ct.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=ut,this.pos[1]+=ht,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(ot){return this.forward(-ot)},right:function(ot){return this.dir-=ot,this.dir%=360,!this.turtleIsHidden&&this.board.create("transform",[-ot*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2),this.board.update(),this},left:function(ot){return this.right(-ot)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var ot,ct;for(ot=0;ot<this.objects.length;ot++)ct=this.objects[ot],ct.type===_e.OBJECT_TYPE_CURVE&&(this.board.removeObject(ct),this.objects.splice(ot,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var ot,ct,ut=this.objects.length;for(ot=0;ot<ut;ot++)ct=this.objects[ot],this.board.removeObject(ct);return this.init(0,0,90),this},setPos:function(ot,ct){var ut;return it.isArray(ot)?this.pos=ot:this.pos=[ot,ct],this.turtleIsHidden||(this.turtle.setPositionDirectly(_e.COORDS_BY_USER,[ot,ct]),this.turtle2.setPositionDirectly(_e.COORDS_BY_USER,[ot,ct+this.arrowLen]),ut=this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}),ut.applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(ot){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",ot)),this.objects.push(this.curve),this},setPenColor:function(ot){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",ot)),this.objects.push(this.curve),this},setHighlightPenColor:function(ot){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",ot)),this.objects.push(this.curve),this},setAttribute:function(ot){var ct,ut,ht,dt=this.objects.length;for(ct=0;ct<dt;ct++)ut=this.objects[ct],ut.type===_e.OBJECT_TYPE_CURVE&&ut.setAttribute(ot);return ht=this.visProp.id,this.visProp=it.deepCopy(this.curve.visProp),this.visProp.id=ht,this._attributes=it.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(ot,ct){return this._attributes[ot.toLowerCase()]=ct,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var ot=this.stack.pop();return this.pos[0]=ot[0],this.pos[1]=ot[1],this.dir=ot[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(ot){var ct,ut,ht,dt,pt;return it.isArray(ot)?(ct=this.pos[0],ut=this.pos[1],ht=ot[0],dt=ot[1],pt=Math.atan2(dt-ut,ht-ct),this.right(this.dir-180*pt/Math.PI)):it.isNumber(ot)&&this.right(this.dir-ot),this},moveTo:function(ot){var ct,ut,ht;return it.isArray(ot)&&(ct=ot[0]-this.pos[0],ut=ot[1]-this.pos[1],this.turtleIsHidden||(ht=this.board.create("transform",[ct,ut],{type:"translate"}),ht.applyOnce(this.turtle),ht.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=ot[0],this.pos[1]=ot[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(ot){return this.forward(ot)},bk:function(ot){return this.back(ot)},lt:function(ot){return this.left(ot)},rt:function(ot){return this.right(ot)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(ot,ct){var ut,ht,dt,pt,ft=this.objects.length;for(ut=0,ht=0;ut<ft;ut++)if(dt=this.objects[ut],dt.elementClass===_e.OBJECT_CLASS_CURVE){if(ht<=ot&&ot<ht+dt.numberPoints)return pt=ot-ht,dt[ct](pt);ht+=dt.numberPoints}return this[ct]()},X:function(ot){return it.exists(ot)?this.evalAt(ot,"X"):this.pos[0]},Y:function(ot){return it.exists(ot)?this.evalAt(ot,"Y"):this.pos[1]},Z:function(ot){return 1},minX:function(){return 0},maxX:function(){var ot,ct,ut=this.objects.length,ht=0;for(ot=0;ot<ut;ot++)ct=this.objects[ot],ct.elementClass===_e.OBJECT_CLASS_CURVE&&(ht+=this.objects[ot].numberPoints);return ht},hasPoint:function(ot,ct){var ut,ht;for(ut=0;ut<this.objects.length;ut++)if(ht=this.objects[ut],ht.type===_e.OBJECT_TYPE_CURVE&&ht.hasPoint(ot,ct))return!0;return!1}}),tt.createTurtle=function(ot,ct,ut){var ht;return ct=ct||[],ht=it.copyAttributes(ut,ot.options,"turtle"),new tt.Turtle(ot,ct,ht)},tt.registerElement("turtle",tt.createTurtle),{Turtle:tt.Turtle,createTurtle:tt.createTurtle}}),define("parser/ca",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/env"],function(tt,_e,rt,it,nt,st,at,lt){return tt.CA=function(ot,ct,ut){this.node=ot,this.createNode=ct,this.parser=ut},tt.extend(tt.CA.prototype,{findMapNode:function(ot,ct){var ut,ht,dt;if(ct.value==="op_assign"&&ct.children[0].value===ot)return ct.children[1];if(ct.children){for(ht=ct.children.length,ut=0;ut<ht;++ut)if((dt=this.findMapNode(ot,ct.children[ut]))!==null)return dt}return null},setMath:function(ot){var ct,ut;if((ot.type!="node_op"||ot.value!="op_add"&&ot.value!="op_sub"&&ot.value!="op_mul"&&ot.value!="op_div"&&ot.value!="op_neg"&&ot.value!="op_execfun"&&ot.value!="op_exp")&&ot.type!="node_var"&&ot.type!="node_const"||(ot.isMath=!0),ot.children)for(ut=ot.children.length,ct=0;ct<ut;++ct)this.setMath(ot.children[ct])},deriveElementary:function(ot,ct){var ut,ht=ot.children[0].value,dt=ot.children[1];switch(ht){case"abs":ut=this.createNode("node_op","op_div",dt[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0]))]));break;case"sqrt":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(ot.type,ot.value,at.deepCopy(ot.children[0]),at.deepCopy(ot.children[1]))));break;case"sin":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),at.deepCopy(dt));break;case"cos":ut=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),at.deepCopy(dt)));break;case"tan":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),at.deepCopy(dt)),this.createNode("node_const",2)));break;case"exp":ut=this.createNode(ot.type,ot.value,at.deepCopy(ot.children[0]),at.deepCopy(ot.children[1]));break;case"pow":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",at.deepCopy(ot.children[0]),at.deepCopy(ot.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(ot.children[1][0],ct),this.createNode("node_op","op_div",at.deepCopy(ot.children[1][1]),at.deepCopy(ot.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(ot.children[1][1],ct),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[at.deepCopy(ot.children[1][0])]))));break;case"log":case"ln":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),at.deepCopy(dt[0]));break;case"log2":case"lb":case"ld":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),at.deepCopy(dt[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":ut=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),at.deepCopy(dt[0])),this.createNode("node_const",.43429448190325176));break;case"asin":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0])))]));break;case"acos":ut=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0])))])));break;case"atan":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0]))));break;case"sinh":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[at.deepCopy(dt[0])]);break;case"cosh":ut=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[at.deepCopy(dt[0])]);break;case"tanh":ut=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[at.deepCopy(dt[0])]),this.createNode("node_const",2)));break;case"asinh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0])),this.createNode("node_const",1))]));break;case"acosh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0])),this.createNode("node_const",1))]));break;case"atanh":ut=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",at.deepCopy(dt[0]),at.deepCopy(dt[0]))));break;default:ut=this.createNode("node_const",0),this._error('Derivative of "'+ht+'" not yet implemented')}return ut},derivative:function(ot,ct){var ut;switch(ot.type){case"node_op":switch(ot.value){case"op_execfun":ut=ot.children[0].value=="pow"?this.deriveElementary(ot,ct):this.createNode("node_op","op_mul",this.deriveElementary(ot,ct),this.derivative(ot.children[1][0],ct));break;case"op_div":ut=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(ot.children[0],ct),at.deepCopy(ot.children[1])),this.createNode("node_op","op_mul",at.deepCopy(ot.children[0]),this.derivative(ot.children[1],ct))),this.createNode("node_op","op_mul",at.deepCopy(ot.children[1]),at.deepCopy(ot.children[1])));break;case"op_mul":ut=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",at.deepCopy(ot.children[0]),this.derivative(ot.children[1],ct)),this.createNode("node_op","op_mul",this.derivative(ot.children[0],ct),at.deepCopy(ot.children[1])));break;case"op_neg":ut=this.createNode("node_op","op_neg",this.derivative(ot.children[0],ct));break;case"op_add":case"op_sub":ut=this.createNode("node_op",ot.value,this.derivative(ot.children[0],ct),this.derivative(ot.children[1],ct));break;case"op_exp":ut=this.createNode("node_op","op_mul",at.deepCopy(ot),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(ot.children[0],ct),this.createNode("node_op","op_div",at.deepCopy(ot.children[1]),at.deepCopy(ot.children[0]))),this.createNode("node_op","op_mul",this.derivative(ot.children[1],ct),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[at.deepCopy(ot.children[0])]))))}break;case"node_var":ut=ot.value===ct?this.createNode("node_const",1):this.createNode("node_const",0);break;case"node_const":ut=this.createNode("node_const",0)}return ut},expandDerivatives:function(ot,ct,ut){var ht,dt,pt,ft,gt,mt,At,yt,bt,xt,vt,_t;if(mt=0,!ot)return mt;for(this.line=ot.line,this.col=ot.col,ht=ot.children.length,dt=0;dt<ht;++dt)if(ot.children[dt]&&ot.children[dt].type)ot.children[dt]=this.expandDerivatives(ot.children[dt],ot,ut);else if(at.isArray(ot.children[dt]))for(pt=0;pt<ot.children[dt].length;++pt)ot.children[dt][pt]&&ot.children[dt][pt].type&&(ot.children[dt][pt]=this.expandDerivatives(ot.children[dt][pt],ot,ut));switch(ot.type){case"node_op":switch(ot.value){case"op_execfun":if(ot.children[0]&&ot.children[0].value==="D"){if(ot.children[1][0].type=="node_var"?(bt=ot.children[1][0].value,ft=this.findMapNode(bt,ut),vt=ft.children[0],xt=ot.children[1].length>=2?ot.children[1][1].value:ft.children[0][0],gt=ft.children[1]):(gt=ot.children[1][0],vt=["x"],xt=ot.children[1].length>=2?ot.children[1][1].value:"x"),_t=ot.children[1].length>=3?ot.children[1][2].value:1,yt=gt,_t>=1)for(;_t>=1;)yt=this.derivative(yt,xt),yt=this.removeTrivialNodes(yt),_t--;At=ct.type=="node_op"&&ct.value=="op_assign"?this.createNode("node_op","op_map",vt,yt):yt,this.setMath(At),ot.type=At.type,ot.value=At.value,ot.children[0]=At.children[0],ot.children[1]=At.children[1]}}}return ot},removeTrivialNodes:function(ot){var ct,ut,ht,dt,pt;if(at.isArray(ot))for(ut=ot.length,ct=0;ct<ut;++ct)ot[ct]=this.removeTrivialNodes(ot[ct]);if(ot.type!="node_op"||!ot.children)return ot;for(ut=ot.children.length,ct=0;ct<ut;++ct){this.mayNotBeSimplified=!1;do ot.children[ct]=this.removeTrivialNodes(ot.children[ct]);while(this.mayNotBeSimplified)}switch(ot.value){case"op_map":if(ht=ot.children[0],dt=ot.children[1],dt.type=="node_var"){for(ct=0;ct<ht.length;++ct)if(ht[ct]==dt.value){dt.isMath=!0;break}}break;case"op_add":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&ht.value===0)return dt;if(dt.type=="node_const"&&dt.value===0)return ht;if(ht.type=="node_const"&&dt.type=="node_const")return ht.value+=dt.value,ht;break;case"op_mul":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&ht.value==1)return dt;if(dt.type=="node_const"&&dt.value==1||ht.type=="node_const"&&ht.value===0)return ht;if(dt.type=="node_const"&&dt.value===0||dt.type=="node_const"&&dt.value===0)return dt;if(ht.type=="node_op"&&ht.value=="op_neg"&&dt.type=="node_op"&&dt.value=="op_neg")return ot.children=[ht.children[0],dt.children[0]],this.mayNotBeSimplified=!0,ot;if(ht.value=="op_neg"&&dt.value!="op_neg")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_op","op_mul",ht.children[0],dt)],this.mayNotBeSimplified=!0,ot;if(ht.value!="op_neg"&&dt.value=="op_neg")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_op","op_mul",ht,dt.children[0])],this.mayNotBeSimplified=!0,ot;if(ht.value=="op_div"&&ht.children[0].type=="node_const"&&ht.children[0].value==1)return ot.type="node_op",ot.value="op_div",ot.children=[dt,ht.children[1]],this.mayNotBeSimplified=!0,ot;if(dt.value=="op_div"&&dt.children[0].type=="node_const"&&dt.children[0].value==1)return ot.type="node_op",ot.value="op_div",ot.children=[ht,dt.children[1]],this.mayNotBeSimplified=!0,ot;if(ht.type!="node_const"&&dt.type=="node_const")return ot.children=[dt,ht],this.mayNotBeSimplified=!0,ot;if(ht.type!="node_const"&&dt.type=="node_op"&&dt.value=="op_neg"&&dt.children[0].type=="node_const")return ot.children=[dt,ht],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value!="op_execfun"&&(dt.type=="node_var"||dt.type=="node_op"&&dt.value=="op_execfun"))return ot.children=[dt,ht],this.mayNotBeSimplified=!0,ot;if(ht.type!="node_op"&&dt.type=="node_op"&&dt.value=="op_neg"&&dt.children[0].type=="node_var")return ot.children=[dt,ht],this.mayNotBeSimplified=!0,ot;if(ht.type!="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return pt=dt.children[0],dt.children[0]=ht,ot.children=[pt,dt],this.mayNotBeSimplified=!0,ot;if(dt.type!="node_const"&&ht.type=="node_op"&&ht.value=="op_mul"&&ht.children[0].type=="node_const")return ot.children=[ht.children[0],this.createNode("node_op","op_mul",ht.children[1],dt)],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_const"&&dt.type=="node_const")return ht.value*=dt.value,ht;if(ht.type=="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return dt.children[0].value*=ht.value,dt;if(ht.hash=this.parser.compile(ht),dt.hash=this.parser.compile(dt),ht.hash===dt.hash)return ot.value="op_exp",ot.children[1]=this.createNode("node_const",2),ot;if(ht.type=="node_const"&&dt.type=="node_op"&&(dt.value=="op_mul"||dt.value=="op_div")&&dt.children[0].type=="node_const")return dt.children[0].value*=ht.value,dt;if(dt.type=="node_op"&&dt.value=="op_exp"&&(ht.hash||(ht.hash=this.parser.compile(ht)),dt.children[0].hash||(dt.children[0].hash=this.parser.compile(dt.children[0])),ht.hash===dt.children[0].hash))return dt.children[1]=this.createNode("node_op","op_add",dt.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,dt;if(ht.type=="node_op"&&ht.value=="op_exp"&&dt.type=="node_op"&&dt.value=="op_exp"&&(ht.children[0].hash=this.parser.compile(ht.children[0]),dt.children[0].hash=this.parser.compile(dt.children[0]),ht.children[0].hash===dt.children[0].hash))return ht.children[1]=this.createNode("node_op","op_add",ht.children[1],dt.children[1]),this.mayNotBeSimplified=!0,ht;break;case"op_sub":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&ht.value===0)return ot.value="op_neg",ot.children[0]=dt,ot;if(dt.type=="node_const"&&dt.value===0)return ht;if(ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value)return this.createNode("node_const",0);if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return this.createNode("node_const",0);if(ht.type=="node_const"&&dt.type=="node_const")return ht.value-=dt.value,ht;if(ht.type=="node_op"&&ht.value=="op_mul"&&dt.type=="node_op"&&dt.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.children[1].hash=this.parser.compile(dt.children[1]),ht.children[1].hash===dt.children[1].hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_sub",ht.children[0],dt.children[0]),ht.children[1]],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.hash=this.parser.compile(dt),ht.children[1].hash===dt.hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_sub",ht.children[0],this.createNode("node_const",1)),dt],this.mayNotBeSimplified=!0,ot;if(dt.type=="node_op"&&dt.value=="op_mul"&&(dt.children[1].hash=this.parser.compile(dt.children[1]),ht.hash=this.parser.compile(ht),dt.children[1].hash===ht.hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),dt.children[0]),ht],this.mayNotBeSimplified=!0,ot;break;case"op_neg":if(ht=ot.children[0],ht.type=="node_const"&&ht.value===0)return ht;if(ht.type=="node_op"&&ht.value=="op_neg")return ht.children[0];break;case"op_div":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value&&ht.value!==0)return ht.value=1,ht;if(ht.type=="node_const"&&ht.value===0&&dt.type=="node_const"&&dt.value!==0)return ht.value=0,ht;if(ht.type=="node_const"&&ht.value===0&&(dt.type=="node_op"||dt.type=="node_var"))return ot.type="node_const",ot.value=0,ot;if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return this.createNode("node_const",1);if(ht.type=="node_const"&&ht.value!==0&&dt.type=="node_const"&&dt.value===0)return ht.value>0?ht.value=1/0:ht.value=-1/0,ht;if(ht.type=="node_op"&&ht.value=="op_neg"&&dt.type=="node_op"&&dt.value=="op_neg")return ot.children=[ht.children[0],dt.children[0]],this.mayNotBeSimplified=!0,ot;if(ht.value=="op_neg"&&dt.value!="op_neg")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_op","op_div",ht.children[0],dt)],this.mayNotBeSimplified=!0,ot;if(ht.value!="op_neg"&&dt.value=="op_neg")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_op","op_div",ht,dt.children[0])],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_exp"&&(dt.hash||(dt.hash=this.parser.compile(dt)),ht.children[0].hash||(ht.children[0].hash=this.parser.compile(ht.children[0])),dt.hash===ht.children[0].hash))return ht.children[1]=this.createNode("node_op","op_sub",ht.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,ht;if(dt.type!="node_const"&&ht.type=="node_op"&&ht.value=="op_mul"&&ht.children[0].type=="node_const")return ot.value="op_mul",ot.children=[ht.children[0],this.createNode("node_op","op_div",ht.children[1],dt)],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_exp"&&dt.type=="node_op"&&dt.value=="op_exp"&&(ht.children[0].hash=this.parser.compile(ht.children[0]),dt.children[0].hash=this.parser.compile(dt.children[0]),ht.children[0].hash===dt.children[0].hash))return ht.children[1]=this.createNode("node_op","op_sub",ht.children[1],dt.children[1]),this.mayNotBeSimplified=!0,ht;break;case"op_exp":if(ht=ot.children[0],dt=ot.children[1],dt.type=="node_const"&&dt.value===0)return dt.value=1,dt;if(dt.type=="node_const"&&dt.value==1||ht.type=="node_const"&&ht.value==1||ht.type=="node_const"&&ht.value===0&&dt.type=="node_const"&&dt.value!==0)return ht;if(ht.type=="node_op"&&ht.value=="op_exp")return ot.children=[ht.children[0],this.createNode("node_op","op_mul",ht.children[1],dt)],ot}switch(ot.value){case"op_add":if(ht=ot.children[0],dt=ot.children[1],ht.type=="node_const"&&dt.type=="node_const"&&ht.value==dt.value)return ht.value+=dt.value,ht;if(ht.type=="node_var"&&dt.type=="node_var"&&ht.value==dt.value)return ot.children[0]=this.createNode("node_const",2),ot.value="op_mul",ot;if(ht.type=="node_op"&&ht.value=="op_neg")return ot.value="op_sub",ot.children[0]=dt,ot.children[1]=ht.children[0],this.mayNotBeSimplified=!0,ot;if(dt.type=="node_op"&&dt.value=="op_neg")return ot.value="op_sub",ot.children[1]=dt.children[0],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_mul"&&dt.type=="node_op"&&dt.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.children[1].hash=this.parser.compile(dt.children[1]),ht.children[1].hash===dt.children[1].hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_add",ht.children[0],dt.children[0]),ht.children[1]],this.mayNotBeSimplified=!0,ot;if(ht.type=="node_op"&&ht.value=="op_mul"&&(ht.children[1].hash=this.parser.compile(ht.children[1]),dt.hash=this.parser.compile(dt),ht.children[1].hash===dt.hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_add",ht.children[0],this.createNode("node_const",1)),dt],this.mayNotBeSimplified=!0,ot;if(dt.type=="node_op"&&dt.value=="op_mul"&&(dt.children[1].hash=this.parser.compile(dt.children[1]),ht.hash=this.parser.compile(ht),dt.children[1].hash===ht.hash))return ot.value="op_mul",ot.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),dt.children[0]),ht],this.mayNotBeSimplified=!0,ot;break;case"op_sub":if(ht=ot.children[0],dt=ot.children[1],dt.type=="node_op"&&dt.value=="op_neg")return ot.value="op_add",ot.children[1]=dt.children[0],this.mayNotBeSimplified=!0,ot;break;case"op_execfun":return this.simplifyElementary(ot)}return ot},simplifyElementary:function(ot){var ct=ot.children[0].value,ut=ot.children[1];if(ut.length==0)return ot;switch(ct){case"sin":case"tan":if(ut[0].type=="node_const"&&ut[0].value===0||ut[0].type=="node_var"&&ut[0].value=="PI"||ut[0].type=="node_op"&&ut[0].value=="op_mul"&&ut[0].children[0].type=="node_const"&&ut[0].children[0].value%1==0&&ut[0].children[1].type=="node_var"&&ut[0].children[1].value=="PI")return ot.type="node_const",ot.value=0,ot;break;case"cos":if(ut[0].type=="node_const"&&ut[0].value===0)return ot.type="node_const",ot.value=1,ot;if(ut[0].type=="node_var"&&ut[0].value=="PI")return ot.type="node_op",ot.value="op_neg",ot.children=[this.createNode("node_const",1)],ot;break;case"exp":if(ut[0].type=="node_const"&&ut[0].value===0)return ot.type="node_const",ot.value=1,ot;break;case"pow":if(ut[1].type=="node_const"&&ut[1].value===0)return ot.type="node_const",ot.value=1,ot}return ot}}),tt.CA}),define("utils/dump",["jxg","utils/type"],function(tt,_e){return tt.Dump={addMarkers:function(rt,it,nt){var st,at,lt;_e.isArray(it)||(it=[it]),_e.isArray(nt)||(nt=[nt]),at=Math.min(it.length,nt.length),it.length=at,nt.length=at;for(st in rt.objects)if(rt.objects.hasOwnProperty(st))for(lt=0;lt<at;lt++)rt.objects[st][it[lt]]=nt[lt]},deleteMarkers:function(rt,it){var nt,st,at;_e.isArray(it)||(it=[it]),st=it.length,it.length=st;for(nt in rt.objects)if(rt.objects.hasOwnProperty(nt))for(at=0;at<st;at++)delete rt.objects[nt][it[at]]},str:function(rt){return typeof rt=="string"&&rt.substr(0,7)!=="function"&&(rt='"'+rt+'"'),rt},minimizeObject:function(rt,it){var nt,st,at,lt={},ot=_e.deepCopy(rt),ct=[];for(at=1;at<arguments.length;at++)ct.push(arguments[at]);for(lt=_e.deepCopy(lt,tt.Options.elements,!0),at=ct.length;at>0;at--)lt=_e.deepCopy(lt,ct[at-1],!0);for(nt in lt)lt.hasOwnProperty(nt)&&(st=nt.toLowerCase(),typeof lt[nt]!="object"&&lt[nt]===ot[st]&&(console.log("delete",nt),delete ot[st]));return ot},prepareAttributes:function(rt,it){var nt,st;nt=this.minimizeObject(it.getAttributes(),tt.Options[it.elType]);for(st in it.subs)it.subs.hasOwnProperty(st)&&(nt[st]=this.minimizeObject(it.subs[st].getAttributes(),tt.Options[it.elType][st],tt.Options[it.subs[st].elType]),nt[st].id=it.subs[st].id,nt[st].name=it.subs[st].name);return nt.id=it.id,nt.name=it.name,nt},setBoundingBox:function(rt,it,nt){return rt.push({obj:nt,method:"setBoundingBox",params:[it.getBoundingBox(),!0]}),rt},dump:function(rt){var it,nt,st,at,lt=[],ot=[],ct=[],ut=rt.objectsList.length;for(this.addMarkers(rt,"dumped",!1),it=0;it<ut;it++)if(nt=rt.objectsList[it],st={},!nt.dumped&&nt.dump){for(st.type=nt.getType(),st.parents=nt.getParents().slice(),st.type==="point"&&st.parents[0]===1&&(st.parents=st.parents.slice(1)),at=0;at<st.parents.length;at++)_e.isString(st.parents[at])&&st.parents[at][0]!=="'"&&st.parents[at][0]!=='"'?st.parents[at]='"'+st.parents[at]+'"':_e.isArray(st.parents[at])&&(st.parents[at]="["+st.parents[at].toString()+"]");st.attributes=this.prepareAttributes(rt,nt),st.type==="glider"&&nt.onPolygon&&lt.push({obj:nt.id,prop:"onPolygon",val:!0}),ct.push(st)}return this.deleteMarkers(rt,"dumped"),{elements:ct,props:lt,methods:ot}},arrayToParamStr:function(rt,it){var nt,st=[];for(nt=0;nt<rt.length;nt++)st.push(it.call(this,rt[nt]));return st.join(", ")},toJCAN:function(rt){var it,nt,st;switch(typeof rt){case"object":if(rt){if(nt=[],_e.isArray(rt)){for(it=0;it<rt.length;it++)nt.push(this.toJCAN(rt[it]));return"["+nt.join(",")+"]"}for(st in rt)rt.hasOwnProperty(st)&&nt.push(st+": "+this.toJCAN(rt[st]));return"<<"+nt.join(", ")+">> "}return"null";case"string":return"'"+rt.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return rt.toString();case"null":return"null"}},toJessie:function(rt){var it,nt,st=this.dump(rt),at=[];for(st.methods=this.setBoundingBox(st.methods,rt,"$board"),nt=st.elements,it=0;it<nt.length;it++)nt[it].attributes.name.length>0&&at.push("// "+nt[it].attributes.name),at.push("s"+it+" = "+nt[it].type+"("+nt[it].parents.join(", ")+") "+this.toJCAN(nt[it].attributes).replace(/\n/,"\\n")+";"),at.push("");for(it=0;it<st.methods.length;it++)at.push(st.methods[it].obj+"."+st.methods[it].method+"("+this.arrayToParamStr(st.methods[it].params,this.toJCAN)+");"),at.push("");for(it=0;it<st.props.length;it++)at.push(st.props[it].obj+"."+st.props[it].prop+" = "+this.toJCAN(st.props[it].val)+";"),at.push("");return at.join(`
`)},toJavaScript:function(rt){var it,nt,st=this.dump(rt),at=[];for(st.methods=this.setBoundingBox(st.methods,rt,"board"),nt=st.elements,it=0;it<nt.length;it++)at.push('board.create("'+nt[it].type+'", ['+nt[it].parents.join(", ")+"], "+_e.toJSON(nt[it].attributes)+");");for(it=0;it<st.methods.length;it++)at.push(st.methods[it].obj+"."+st.methods[it].method+"("+this.arrayToParamStr(st.methods[it].params,_e.toJSON)+");"),at.push("");for(it=0;it<st.props.length;it++)at.push(st.props[it].obj+"."+st.props[it].prop+" = "+_e.toJSON(st.props[it].val)+";"),at.push("");return at.join(`
`)}},tt.Dump}),define("element/comb",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point"],function(tt,_e,rt,it,nt,st,at){return tt.createComb=function(lt,ot,ct){var ut,ht,dt,pt,ft,gt,mt,At,yt;if(ot.length!==2)throw ft=ot.map(function(bt){return"'"+typeof bt+"'"}),new Error("JSXGraph: Can't create comb with parent types "+ft.join(", ")+`.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);if(rt.isArray(ot[0])&&ot[0].length>1)pt=rt.copyAttributes(ct,lt.options,"comb","point1"),ut=lt.create("point",ot[0],pt);else if(rt.isString(ot[0])||rt.isPoint(ot[0]))ut=lt.select(ot[0]);else if(rt.isFunction(ot[0])&&rt.isPoint(ot[0]()))ut=ot[0]();else{if(!(rt.isFunction(ot[0])&&ot[0]().length&&ot[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof ot[0]+"' and '"+typeof ot[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);pt=rt.copyAttributes(ct,lt.options,"comb","point1"),ut=at.createPoint(lt,ot[0](),pt)}if(rt.isArray(ot[1])&&ot[1].length>1)pt=rt.copyAttributes(ct,lt.options,"comb","point2"),ht=lt.create("point",ot[1],pt);else if(rt.isString(ot[1])||rt.isPoint(ot[1]))ht=lt.select(ot[1]);else if(rt.isFunction(ot[1])&&rt.isPoint(ot[1]()))ht=ot[1]();else{if(!(rt.isFunction(ot[1])&&ot[1]().length&&ot[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof ot[0]+"' and '"+typeof ot[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);pt=rt.copyAttributes(ct,lt.options,"comb","point2"),ht=at.createPoint(lt,ot[1](),pt)}return pt=rt.copyAttributes(ct,lt.options,"comb","curve"),dt=lt.create("curve",[[0],[0]],pt),pt=rt.copyAttributes(ct,lt.options,"comb"),gt=pt.frequency,mt=-pt.angle,At=pt.width,pt.reverse&&(yt=ut,ut=ht,ht=yt,mt=-mt),dt.updateDataArray=function(){var bt,xt,vt,_t=0,Ct=ut.Dist(ht),St=Math.cos(mt),Et=Math.sin(mt),Tt=(ht.X()-ut.X())/Ct,Mt=(ht.Y()-ut.Y())/Ct;for(St*=At/Math.abs(Et),Et*=At/Math.abs(Et),this.dataX=[],this.dataY=[];_t<Ct;)bt=ut.X()+Tt*_t,xt=ut.Y()+Mt*_t,vt=Math.min(St,Ct-_t)/Math.abs(St),Et*=vt,St*=vt,this.dataX.push(bt),this.dataY.push(xt),this.dataX.push(bt+Tt*St+Mt*Et),this.dataY.push(xt-Tt*Et+Mt*St),this.dataX.push(NaN),this.dataY.push(NaN),_t+=gt},dt},tt.registerElement("comb",tt.createComb),{createComb:tt.createComb}}),define("element/slopetriangle",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point","base/element"],function(tt,_e,rt,it,nt,st,at,lt){var ot={removeSlopeTriangle:function(){st.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},Value:function(){return this.tangent.getSlope()}};return tt.createSlopeTriangle=function(ct,ut,ht){var dt,pt,ft,gt,mt,At,yt,bt,xt,vt=!1;if(ut.length===1&&ut[0].type===it.OBJECT_TYPE_TANGENT)pt=ut[0],ft=pt.glider;else if(ut.length===1&&ut[0].type===it.OBJECT_TYPE_GLIDER)ft=ut[0],xt=rt.copyAttributes(ht,ct.options,"slopetriangle","tangent"),pt=ct.create("tangent",[ft],xt),vt=!0;else{if(ut.length!==2||ut[0].elementClass!==it.OBJECT_CLASS_LINE||!rt.isPoint(ut[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof ut[0]+"'.");pt=ut[0],ft=ut[1]}return xt=rt.copyAttributes(ht,ct.options,"slopetriangle","basepoint"),yt=ct.create("point",[function(){return[ft.X()+1,ft.Y()]}],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","baseline"),At=ct.create("line",[ft,yt],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","glider"),gt=ct.create("glider",[ft.X()+1,ft.Y(),At],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","toppoint"),mt=ct.create("point",[function(){return[gt.X(),gt.Y()+(gt.X()-ft.X())*pt.getSlope()]}],xt),xt=rt.copyAttributes(ht,ct.options,"slopetriangle"),xt.borders=rt.copyAttributes(xt.borders,ct.options,"slopetriangle","borders"),dt=ct.create("polygon",[ft,gt,mt],xt),dt.Value=ot.Value,dt.tangent=pt,dt._isPrivateTangent=vt,dt.borders[2].setArrow(!1,!1),xt=rt.copyAttributes(ht,ct.options,"slopetriangle","label"),bt=ct.create("text",[function(){return gt.X()+.1},function(){return .5*(gt.Y()+mt.Y())},function(){return""}],xt),bt._setText(function(){return rt.toFixed(dt.Value(),rt.evaluate(bt.visProp.digits))}),bt.fullUpdate(),dt.glider=gt,dt.basepoint=yt,dt.baseline=At,dt.toppoint=mt,dt.label=bt,dt.subs={glider:gt,basePoint:yt,baseLine:At,topPoint:mt,label:bt},dt.inherits.push(gt,yt,At,mt,bt),dt.methodMap=tt.deepCopy(dt.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),dt.remove=ot.removeSlopeTriangle,dt},tt.registerElement("slopetriangle",tt.createSlopeTriangle),{createSlopeTriangle:tt.createSlopeTriangle}}),define("element/checkbox",["jxg","utils/env","utils/type"],function(tt,_e,rt){var it={CheckboxChangeEventHandler:function(){this._value=this.rendNodeCheckbox.checked,this.board.update()}};return tt.createCheckbox=function(nt,st,at){var lt,ot,ct=rt.copyAttributes(at,nt.options,"checkbox");return ot=[st[0],st[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],lt=nt.create("text",ot,ct),lt.type=rt.OBJECT_TYPE_CHECKBOX,lt.rendNodeCheckbox=lt.rendNode.childNodes[0].childNodes[0],lt.rendNodeLabel=lt.rendNode.childNodes[0].childNodes[1],lt.rendNodeTag=lt.rendNodeCheckbox,lt.rendNodeTag.disabled=!!ct.disabled,lt.rendNodeLabel.innerHTML=st[2],lt.rendNodeCheckbox.id=lt.rendNode.id+"_checkbox",lt.rendNodeLabel.id=lt.rendNode.id+"_label",lt.rendNodeLabel.setAttribute("for",lt.rendNodeCheckbox.id),lt.visPropOld.fontsize="0px",nt.renderer.updateTextStyle(lt,!1),lt.rendNodeCheckbox.checked=ct.checked,lt._value=ct.checked,lt.Value=function(){return this._value},lt.update=function(){return this.needsUpdate&&(tt.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},_e.addEvent(lt.rendNodeCheckbox,"change",it.CheckboxChangeEventHandler,lt),lt},tt.registerElement("checkbox",tt.createCheckbox),{createCheckbox:tt.createCheckbox}}),define("element/input",["jxg","utils/env","utils/type"],function(tt,_e,rt){var it={InputInputEventHandler:function(nt){this._value=this.rendNodeInput.value,this.board.update()}};return tt.createInput=function(nt,st,at){var lt,ot,ct=rt.copyAttributes(at,nt.options,"input");return ot=[st[0],st[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+ct.maxlength+'" style="width:100%"/></span>'],lt=nt.create("text",ot,ct),lt.type=rt.OBJECT_TYPE_INPUT,lt.rendNodeLabel=lt.rendNode.childNodes[0].childNodes[0],lt.rendNodeInput=lt.rendNode.childNodes[0].childNodes[1],lt.rendNodeLabel.innerHTML=st[3],lt.rendNodeInput.value=st[2],lt.rendNodeTag=lt.rendNodeInput,lt.rendNodeTag.disabled=!!ct.disabled,lt.rendNodeLabel.id=lt.rendNode.id+"_label",lt.rendNodeInput.id=lt.rendNode.id+"_input",lt._value=st[2],lt.update=function(){return this.needsUpdate&&(tt.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},lt.Value=function(){return this._value},_e.addEvent(lt.rendNodeInput,"input",it.InputInputEventHandler,lt),_e.addEvent(lt.rendNodeInput,"mousedown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeInput,"touchstart",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeInput,"pointerdown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),lt.visPropOld.fontsize="0px",nt.renderer.updateTextStyle(lt,!1),lt},tt.registerElement("input",tt.createInput),{createInput:tt.createInput}}),define("element/button",["jxg","utils/env","utils/type"],function(tt,_e,rt){var it={ButtonClickEventHandler:function(){this._handler&&this._handler(),this.board.update()}};return tt.createButton=function(nt,st,at){var lt,ot,ct=rt.copyAttributes(at,nt.options,"button");return ot=[st[0],st[1],'<button type="button" style="width:100%;"></button>'],lt=nt.create("text",ot,ct),lt.type=rt.OBJECT_TYPE_BUTTON,lt.rendNodeButton=lt.rendNode.childNodes[0],lt.rendNodeButton.id=lt.rendNode.id+"_button",lt.rendNodeButton.innerHTML=st[2],lt.rendNodeTag=lt.rendNodeButton,lt.rendNodeTag.disabled=!!ct.disabled,lt.visPropOld.fontsize="0px",nt.renderer.updateTextStyle(lt,!1),st[3]&&(rt.isString(st[3])?(lt._jc=new tt.JessieCode,lt._jc.use(nt),lt._handler=function(){lt._jc.parse(st[3])}):lt._handler=st[3]),_e.addEvent(lt.rendNodeButton,"click",it.ButtonClickEventHandler,lt),_e.addEvent(lt.rendNodeButton,"mousedown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeButton,"touchstart",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),_e.addEvent(lt.rendNodeButton,"pointerdown",function(ut){rt.exists(ut.stopPropagation)&&ut.stopPropagation()},lt),lt},tt.registerElement("button",tt.createButton),{createButton:tt.createButton}}),define("../build/core.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/qdt","math/numerics","math/statistics","math/symbolic","math/geometry","math/poly","math/complex","renderer/abstract","renderer/no","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","parser/datasource","parser/jessiecode","parser/ca","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button"],function(tt,_e){return _e.isBrowser?window.JXG=tt:_e.isNode()?module.exports=tt:_e.isWebWorker()&&(self.JXG=tt),tt}),require("../build/core.deps.js")})})(jsxgraphcore,jsxgraphcore.exports);jsxgraphcore.exports;let logicJS$h=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[1,5],[4,5],[-5,1,5]],{name:"d",fillColor:"white",strokeColor:"blue",postLabel:"",snapWidth:1,precision:0,label:{fontSize:18,strokeColor:"blue",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"blue",strokeWidth:1},highline:{strokeColor:"blue",strokeWidth:3}}),rt=tt.create("slider",[[1,4.5],[4,4.5],[3,5,12]],{name:"n",fillColor:"white",strokeColor:"green",snapWidth:1,postLabel:"",precision:0,label:{fontSize:18,strokeColor:"green",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"green",strokeWidth:1},highline:{strokeColor:"green",strokeWidth:3}}),it=tt.create("slider",[[1,4],[4,4],[1,5,10]],{name:"k",fillColor:"white",strokeColor:"gray",postLabel:"",precision:0,label:{fontSize:18,strokeColor:"gray",cssStyle:"margin-left: 12px; margin-bottom: 10px;"},baseline:{strokeColor:"gray",strokeWidth:1},highline:{strokeColor:"gray",strokeWidth:3}}),nt,st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt,At;rt.on("drag",function(){ut&&tt.removeObject(ut),ht&&tt.removeObject(ht),dt&&tt.removeObject(dt),pt&&tt.removeObject(pt),ft&&tt.removeObject(ft),gt&&tt.removeObject(gt),mt&&tt.removeObject(mt),nt&&tt.removeObject(nt),st&&tt.removeObject(st),at&&tt.removeObject(at),lt&&tt.removeObject(lt),ot&&tt.removeObject(ot),ct&&tt.removeObject(ct),At&&(At.vertices.forEach(Et=>{tt.removeObject(Et)}),tt.removeObject(At),tt.fullUpdate()),rt.Value();var vt=Math.PI/rt.Value(),_t=St=>_e.Value()-Math.cos(Math.PI/rt.Value())*Math.cosh(St/Math.cos(Math.PI/rt.Value()));nt=tt.create("functiongraph",[_t],{strokeColor:"#4181CA",strokeWidth:1,visible:!1}),Math.cos(Math.PI/rt.Value())*Math.acosh(_e.Value()/Math.cos(Math.PI/rt.Value()));var Ct=St=>_t(St-2*Math.cos(Math.PI/rt.Value())*Math.acosh(_e.Value()/Math.cos(Math.PI/rt.Value()))*Math.floor((St+Math.cos(Math.PI/rt.Value())*Math.acosh(_e.Value()/Math.cos(Math.PI/rt.Value())))/(2*Math.cos(Math.PI/rt.Value())*Math.acosh(_e.Value()/Math.cos(Math.PI/rt.Value())))));st=tt.create("functiongraph",[Ct],{strokeColor:"#4181CA",strokeWidth:2}),at=tt.create("line",[[0,function(){return _e.Value()}],[1,function(){return _e.Value()}]],{strokeColor:"#FF5CFF",strokeWidth:3}),lt=tt.create("point",[function(){return it.Value()},function(){return _e.Value()}],{name:"A",withLabel:!1,visible:!0,strokeColor:"gray",fillColor:"#1565C0",strokeWidth:1,size:3}),ot=tt.create("point",[function(){return lt.X()},function(){return Ct(lt.X())}],{name:"B",withLabel:!1,visible:!0,strokeColor:"gray",strokeWidth:1,size:3}),ct=tt.create("glider",[function(){return ot.X()},function(){return ot.Y()},st],{withLabel:!1}),ut=tt.create("tangent",[ct],{visible:!1}),ht=tt.create("perpendicular",[ut,lt],{visible:!1}),dt=tt.create("intersection",[ht,ut,0],{name:"C",withLabel:!1,visible:!1,strokeColor:"black",strokeWidth:1,size:5}),pt=tt.create("point",[function(){return lt.X()+(dt.X()-lt.X())*Math.cos(vt)-(dt.Y()-lt.Y())*Math.sin(vt)},function(){return lt.Y()+(dt.X()-lt.X())*Math.sin(vt)+(dt.Y()-lt.Y())*Math.cos(vt)}],{name:"C1",size:2,visible:!1}),ft=tt.create("line",[lt,pt],{strokeColor:"black",strokeWidth:1,visible:!1}),gt=tt.create("intersection",[ft,ut,0],{name:"D",withLabel:!1,fillColor:"gray",strokeColor:"gray",size:2}),mt=tt.create("reflection",[gt,ht],{name:"D1",withLabel:!1,size:2,fillColor:"gray",strokeColor:"gray"}),At=tt.create("regularpolygon",[mt,gt,rt.Value()],{vertices:{visible:!0,withLabel:!1,fillColor:"gray",strokeColor:"gray"}})}),rt.Value();var yt=Math.PI/rt.Value(),bt=vt=>_e.Value()-Math.cos(Math.PI/rt.Value())*Math.cosh(vt/Math.cos(Math.PI/rt.Value()));nt=tt.create("functiongraph",[bt],{strokeColor:"#4181CA",strokeWidth:1,visible:!1}),Math.cos(Math.PI/rt.Value())*Math.acosh(_e.Value()/Math.cos(Math.PI/rt.Value()));var xt=vt=>bt(vt-2*Math.cos(Math.PI/rt.Value())*Math.acosh(_e.Value()/Math.cos(Math.PI/rt.Value()))*Math.floor((vt+Math.cos(Math.PI/rt.Value())*Math.acosh(_e.Value()/Math.cos(Math.PI/rt.Value())))/(2*Math.cos(Math.PI/rt.Value())*Math.acosh(_e.Value()/Math.cos(Math.PI/rt.Value())))));st=tt.create("functiongraph",[xt],{strokeColor:"#4181CA",strokeWidth:2}),at=tt.create("line",[[0,function(){return _e.Value()}],[1,function(){return _e.Value()}]],{strokeColor:"#FF5CFF",strokeWidth:3}),lt=tt.create("point",[function(){return it.Value()},function(){return _e.Value()}],{name:"A",withLabel:!1,visible:!0,strokeColor:"gray",fillColor:"#1565C0",strokeWidth:1,size:3}),ot=tt.create("point",[function(){return lt.X()},function(){return xt(lt.X())}],{name:"B",withLabel:!1,visible:!0,strokeColor:"gray",strokeWidth:1,size:3}),ct=tt.create("glider",[function(){return ot.X()},function(){return ot.Y()},st]),ut=tt.create("tangent",[ct],{visible:!1}),ht=tt.create("perpendicular",[ut,lt],{visible:!1}),dt=tt.create("intersection",[ht,ut,0],{name:"C",withLabel:!1,visible:!1,strokeColor:"black",strokeWidth:1,size:5}),pt=tt.create("point",[function(){return lt.X()+(dt.X()-lt.X())*Math.cos(yt)-(dt.Y()-lt.Y())*Math.sin(yt)},function(){return lt.Y()+(dt.X()-lt.X())*Math.sin(yt)+(dt.Y()-lt.Y())*Math.cos(yt)}],{name:"C1",size:2,visible:!1}),ft=tt.create("line",[lt,pt],{strokeColor:"black",strokeWidth:1,visible:!1}),gt=tt.create("intersection",[ft,ut,0],{name:"D",withLabel:!1,fillColor:"gray",strokeColor:"gray",size:2}),mt=tt.create("reflection",[gt,ht],{name:"D1",withLabel:!1,size:2,fillColor:"gray",strokeColor:"gray"}),At=tt.create("regularpolygon",[mt,gt,rt.Value()],{vertices:{visible:!0,withLabel:!1,fillColor:"gray",strokeColor:"gray"}}),tt.clickRightArrow(),tt.clickRightArrow(),tt.clickRightArrow(),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$h=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("script",{src:"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"회전"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$h,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:2,zoomY:2},style:{border:"1px solid black"}})]})}},logicJS$g=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-12,20],[0,20],[0,7,7]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[0,0],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),it=tt.create("point",[100,0],{withLabel:!1,visible:!0,strokeColor:"black",strokeWidth:1,size:4,fixed:!0}),nt=tt.create("point",[100,100],{withLabel:!1,size:5,visible:!1,fixed:!0}),st=tt.create("point",[10,10],{withLabel:!1,size:5,visible:!1,fixed:!0}),at=tt.create("segment",[rt,it],{strokeColor:"black",strokeWidth:2,visible:!0}),lt=tt.create("segment",[rt,nt],{strokeColor:"black",strokeWidth:2,visible:!0}),ot=tt.create("circle",[rt,st],{strokeColor:"red",strokeWidth:2,visible:!0}),ct=tt.create("intersection",[lt,ot,0],{name:"G",visible:!0,withLabel:!0,strokeColor:"black",strokeWidth:1,size:4}),ut=tt.create("intersection",[at,ot,0],{name:"H",visible:!0,withLabel:!0,strokeColor:"black",strokeWidth:1,size:4}),ht=tt.create("circle",[ut,ct],{strokeColor:"#FF8F1F",visible:!0,strokeWidth:2}),dt=tt.create("circle",[ct,ut],{strokeColor:"#FF8F1F",visible:!0,strokeWidth:2}),pt=tt.create("intersection",[ht,dt,0],{name:"I",visible:!0,withLabel:!0,strokeColor:"black",strokeWidth:1,size:4}),ft=tt.create("line",[rt,pt],{strokeColor:"blue",visible:!0,strokeWidth:2}),gt=tt.create("angle",[pt,rt,ct],{name:"",visible:!0,radius:2,fillColor:"blue",strokeColor:"blue"}),mt=tt.create("angle",[ut,rt,pt],{name:"",visible:!0,radius:2,fillColor:"blue",strokeColor:"blue"});_e.on("drag",function(){ot.setAttribute({visible:!1}),ct.setAttribute({visible:!1}),ut.setAttribute({visible:!1}),ht.setAttribute({visible:!1}),dt.setAttribute({visible:!1}),pt.setAttribute({visible:!1}),ft.setAttribute({visible:!1}),gt.setAttribute({visible:!1}),mt.setAttribute({visible:!1});var At=_e.Value();At>=1?ot.setAttribute({visible:!0}):ot.setAttribute({visible:!1}),At>=2?(ct.setAttribute({visible:!0}),ut.setAttribute({visible:!0})):(ct.setAttribute({visible:!1}),ut.setAttribute({visible:!1})),At>=3?ht.setAttribute({visible:!0}):ht.setAttribute({visible:!1}),At>=4?dt.setAttribute({visible:!0}):dt.setAttribute({visible:!1}),At>=5?pt.setAttribute({visible:!0}):pt.setAttribute({visible:!1}),At>=6?ft.setAttribute({visible:!0}):ft.setAttribute({visible:!1}),At>=7?(gt.setAttribute({visible:!0}),mt.setAttribute({visible:!0})):(gt.setAttribute({visible:!1}),mt.setAttribute({visible:!1}))}),tt.clickRightArrow(),tt.unsuspendUpdate()},JSXGraphComponent$g=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"각의 이등분선 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$g,boardAttributes:{axis:!1,boundingBox:[-12,12,12,-12],zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS$f=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[5,20],[20,20],[0,11,11]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[-1,-1],{name:"",withLabel:!0,visible:!1,strokeColor:"black",strokeWidth:1,size:4}),it=15,nt=tt.create("circle",[rt,it],{strokeColor:"black",strokeWidth:2});const st=tt.create("point",[function(){return rt.X()+it*Math.cos(-.5)},function(){return rt.Y()+it*Math.sin(-.5)}],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4});var at=tt.create("circle",[st,8],{strokeColor:"blue",strokeWidth:2}),lt=tt.create("intersection",[nt,at,1],{name:"D",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),ot=tt.create("circle",[lt,st],{strokeColor:"blue",strokeWidth:2}),ct=tt.create("intersection",[nt,ot,1],{name:"E",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),ut=tt.create("circle",[ct,lt],{strokeColor:"blue",strokeWidth:2}),ht=tt.create("intersection",[at,ot,1],{name:"F",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),dt=tt.create("intersection",[at,ot,0],{name:"G",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),pt=tt.create("line",[ht,dt],{strokeColor:"#FF8105",strokeWidth:2}),ft=tt.create("intersection",[ot,ut,0],{name:"H",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),gt=tt.create("intersection",[ot,ut,1],{name:"I",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),mt=tt.create("line",[ft,gt],{strokeColor:"#FF8105",strokeWidth:2}),At=tt.create("intersection",[pt,mt,0],{name:"J",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4});_e.on("drag",function(){st.setAttribute({visible:!1}),at.setAttribute({visible:!1}),lt.setAttribute({visible:!1}),ot.setAttribute({visible:!1}),ct.setAttribute({visible:!1}),ut.setAttribute({visible:!1}),ht.setAttribute({visible:!1}),dt.setAttribute({visible:!1}),pt.setAttribute({visible:!1}),ft.setAttribute({visible:!1}),gt.setAttribute({visible:!1}),mt.setAttribute({visible:!1}),At.setAttribute({visible:!1});var yt=_e.Value();yt>=1?st.setAttribute({visible:!0}):st.setAttribute({visible:!1}),yt>=2?at.setAttribute({visible:!0}):at.setAttribute({visible:!1}),yt>=3?lt.setAttribute({visible:!0}):lt.setAttribute({visible:!1}),yt>=4?ot.setAttribute({visible:!0}):ot.setAttribute({visible:!1}),yt>=5?ct.setAttribute({visible:!0}):ct.setAttribute({visible:!1}),yt>=6?ut.setAttribute({visible:!0}):ut.setAttribute({visible:!1}),yt>=7?(ht.setAttribute({visible:!0}),dt.setAttribute({visible:!0})):(ht.setAttribute({visible:!1}),dt.setAttribute({visible:!1})),yt>=8?pt.setAttribute({visible:!0}):pt.setAttribute({visible:!1}),yt>=9?(ft.setAttribute({visible:!0}),gt.setAttribute({visible:!0})):(ft.setAttribute({visible:!1}),gt.setAttribute({visible:!1})),yt>=10?mt.setAttribute({visible:!0}):mt.setAttribute({visible:!1}),yt>=11?At.setAttribute({visible:!0}):At.setAttribute({visible:!1})}),tt.clickRightArrow(),tt.unsuspendUpdate()},JSXGraphComponent$f=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"원의 중심 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$f,boardAttributes:{axis:!1,boundingBox:[-12,12,12,-12],zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS$e=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[5,20],[20,20],[0,5,5]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[-5,-5],{name:"A",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),it=tt.create("point",[5,-5],{name:"B",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4});tt.create("segment",[rt,it],{strokeColor:"black",strokeWidth:2});var nt=tt.create("circle",[rt,it],{strokeColor:"black",strokeWidth:1}),st=tt.create("circle",[it,rt],{strokeColor:"black",strokeWidth:1}),at=tt.create("intersection",[nt,st,0],{name:"C",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),lt=tt.create("intersection",[nt,st,1],{name:"D",withLabel:!0,visible:!0,strokeColor:"black",strokeWidth:1,size:4}),ot=tt.create("line",[at,lt],{strokeColor:"black",strokeWidth:1});_e.on("drag",function(){nt.setAttribute({visible:!1}),st.setAttribute({visible:!1}),at.setAttribute({visible:!1}),lt.setAttribute({visible:!1}),ot.setAttribute({visible:!1});var ct=_e.Value();ct>=1?nt.setAttribute({visible:!0}):nt.setAttribute({visible:!1}),ct>=2?st.setAttribute({visible:!0}):st.setAttribute({visible:!1}),ct>=3?at.setAttribute({visible:!0}):at.setAttribute({visible:!1}),ct>=4?lt.setAttribute({visible:!0}):lt.setAttribute({visible:!1}),ct>=5?ot.setAttribute({visible:!0}):ot.setAttribute({visible:!1})}),tt.unsuspendUpdate()},JSXGraphComponent$e=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"원의 중심 작도"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$e,boardAttributes:{boundingBox:[-12,12,12,-12],zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS$d=tt=>{tt.suspendUpdate();var _e="../images/Flag_of_South_Korea_bars.png",rt="../images/Flag_of_South_Korea_center.png";const it=tt.create("slider",[[-9,20],[9,20],[0,0,360]],{name:"Rotation Flag",snapWidth:1,precision:0,fillColor:"white",strokeColor:"green",postLabel:"°",label:{fontSize:12,strokeColor:"red",cssStyle:"margin-left: 15px; margin-top: 10px;"},baseline:{strokeColor:"green",strokeWidth:3,opacity:.4},highline:{strokeColor:"green",strokeWidth:5}}),nt=tt.create("slider",[[-9,17],[9,17],[0,0,360]],{name:"Rotation Center",snapWidth:1,fillColor:"white",strokeColor:"green",postLabel:"°",precision:0,label:{fontSize:12,strokeColor:"red",cssStyle:"margin-left: 15px; margin-top: 10px;"},baseline:{strokeColor:"green",strokeWidth:3,opacity:.4},highline:{strokeColor:"green",strokeWidth:5}});var st,at,lt,ot,ct,ut,ht;it.on("drag",function(){st&&tt.removeObject(st),at&&tt.removeObject(at),at=tt.create("image",[_e,[-13,-10],[26,20]]),ct=tt.create("transform",[function(){return-at.X()-at.W()*.5},function(){return-at.Y()-at.H()*.5}],{type:"translate"}),ut=tt.create("transform",[function(){return at.X()+at.W()*.5},function(){return at.Y()+at.H()*.5}],{type:"translate"}),ht=tt.create("transform",[it.Value()*Math.PI/180],{type:"rotate"}),ct.bindTo(at),ht.bindTo(at),ut.bindTo(at)}),nt.on("drag",function(){lt&&tt.removeObject(lt),ot&&tt.removeObject(ot),ot=tt.create("image",[rt,[-6,-6],[12,12]]),ct=tt.create("transform",[function(){return-ot.X()-ot.W()*.5},function(){return-ot.Y()-ot.H()*.5}],{type:"translate"}),ut=tt.create("transform",[function(){return ot.X()+ot.W()*.5},function(){return ot.Y()+ot.H()*.5}],{type:"translate"}),ht=tt.create("transform",[nt.Value()*Math.PI/180],{type:"rotate"}),ct.bindTo(ot),ht.bindTo(ot),ut.bindTo(ot)}),st=tt.create("image",[_e,[-13,-10],[26,20]]),lt=tt.create("image",[rt,[-6,-6],[12,12]]),tt.unsuspendUpdate()},JSXGraphComponent$d=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"Rotation"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$d,boardAttributes:{boundingBox:[-12,12,12,-12],zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS$c=tt=>{tt.suspendUpdate();var _e="../images/tekville_logo.png";const rt=tt.create("slider",[[-9,20],[9,20],[-5,-5,5]],{name:"x",snapWidth:1,precision:0,fillColor:"white",strokeColor:"green",postLabel:"",label:{fontSize:20,strokeColor:"red",cssStyle:"margin-left: 15px; margin-top: 10px;"},baseline:{strokeColor:"green",strokeWidth:3,opacity:.4},highline:{strokeColor:"green",strokeWidth:5}}),it=tt.create("slider",[[-9,17],[9,17],[-5,-5,5]],{name:"y",snapWidth:1,fillColor:"white",strokeColor:"green",postLabel:"",precision:0,label:{fontSize:20,strokeColor:"red",cssStyle:"margin-left: 15px; margin-top: 10px;"},baseline:{strokeColor:"green",strokeWidth:3,opacity:.4},highline:{strokeColor:"green",strokeWidth:5}}),nt=tt.create("slider",[[-9,15],[9,15],[0,90,360]],{name:"θ",snapWidth:1,fillColor:"white",strokeColor:"green",postLabel:"°",precision:0,label:{fontSize:20,strokeColor:"red",cssStyle:"margin-left: 15px; margin-top: 10px;"},baseline:{strokeColor:"green",strokeWidth:3,opacity:.4},highline:{strokeColor:"green",strokeWidth:5}});var st,at,lt,ot,ct,ut,ht,dt,pt,ft,gt,mt=()=>{at&&tt.removeObject(at),lt&&tt.removeObject(lt),st&&tt.removeObject(st),ot&&tt.removeObject(ot),ct&&tt.removeObject(ct),ut&&tt.removeObject(ut),ht&&tt.removeObject(ht),dt&&tt.removeObject(dt),pt&&tt.removeObject(dt),ft&&tt.removeObject(ft),gt&&tt.removeObject(gt),st=tt.create("point",[rt.Value(),it.Value()],{name:"P(x, y)",visible:!0,strokeColor:"black",strokeWidth:1,fillColor:"gray",size:3}),ot=tt.create("point",[0,0],{name:"C",visible:!0,strokeColor:"black",strokeWidth:1,fillColor:"gray",size:3}),dt=tt.create("segment",[ot,st],{visible:!0,strokeColor:"blue",strokeWidth:1});const At=st.X(),yt=st.Y(),xt=Math.atan2(yt,At)*180/Math.PI,vt=xt+nt.Value();ft=tt.create("point",[function(){return ot.X()+Math.cos(vt*Math.PI/180)},function(){return ot.Y()+Math.sin(vt*Math.PI/180)}],{name:"C",visible:!1}),ct=tt.create("line",[ot,ft],{visible:!1,strokeColor:"black",strokeWidth:1}),ut=tt.create("circle",[ot,st],{visible:!1,strokeColor:"black",strokeWidth:1}),ht=tt.create("intersection",[ct,ut,0],{name:"P'(x', y')",visible:!0,strokeColor:"black",strokeWidth:1,fillColor:"gray",size:3}),pt=tt.create("segment",[ot,ht],{visible:!0,strokeColor:"blue",strokeWidth:1}),gt=tt.create("arc",[ot,st,ht],{dash:2,strokeWidth:.5,strokeColor:"blue",size:1}),tt.create("angle",[st,ot,ht],{name:"θ",radius:2,fillColor:"green",fillOpacity:0,strokeColor:"green",strokeWidth:2,label:{fontSize:25,strokeColor:"green",cssStyle:""}}),at=tt.create("image",[_e,[st.X(),st.Y()],[-4,-6]]),at.setAttribute({rotate:xt}),lt=tt.create("image",[_e,[ht.X(),ht.Y()],[-4,-6]]),lt.setAttribute({rotate:vt})};rt.on("drag",mt),it.on("drag",mt),nt.on("drag",mt),mt(),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$c=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"Rotation"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$c,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}};function distance(tt,_e){return Number((Math.sqrt((tt.X()-_e.X())**2+(tt.Y()-_e.Y())**2)/10).toFixed(1)).toString()}function calculate_angle(tt,_e,rt){var it=Math.sqrt(Math.pow(_e.X()-tt.X(),2)+Math.pow(_e.Y()-tt.Y(),2)),nt=Math.sqrt(Math.pow(_e.X()-rt.X(),2)+Math.pow(_e.Y()-rt.Y(),2)),st=Math.sqrt(Math.pow(rt.X()-tt.X(),2)+Math.pow(rt.Y()-tt.Y(),2)),at=Math.acos((nt*nt+it*it-st*st)/(2*nt*it));return Math.round(at*180/Math.PI)}let logicJS$b=tt=>{tt.suspendUpdate();var _e="../images/fish.png",rt="../images/tekville_logo.png",it=tt.create("point",[-20,0],{name:"",fixed:!0,visible:!1}),nt=tt.create("point",[10,10],{name:"",strokeColor:"green",strokeWidth:2,fillColor:"#00CC00",size:3}),st=tt.create("point",[0,0],{name:"",fixed:!0,visible:!1});tt.create("segment",[it,nt],{name:()=>"c = "+distance(it,nt)+" m",strokeColor:"black",strokeWidth:2,withLabel:!0,label:{fontSize:20,cssStyle:"margin-left: -50px"}});var at=tt.create("line",[st,it],{name:"",visible:!1}),lt=tt.create("perpendicularpoint",[nt,at],{name:"",visible:!1});tt.create("segment",[nt,lt],{name:()=>"a = "+distance(nt,lt)+" m",dash:2,strokeColor:"black",strokeWidth:1,withLabel:!0,label:{fontSize:20,cssStyle:"margin-left: 10px; margin-top: 25px"}}),tt.create("segment",[it,lt],{name:()=>"b = "+distance(it,lt)+" m",strokeColor:"blue",strokeWidth:2,withLabel:!0,label:{fontSize:20,color:"blue",cssStyle:"margin-top: 35px"}}),tt.create("image",[_e,[()=>lt.X()-.5,()=>lt.Y()-3.5],[4,4]]),tt.create("angle",[lt,it,nt],{name:()=>calculate_angle(lt,it,nt)+"°",radius:2,fillColor:"green",fillOpacity:.2,strokeColor:"green",strokeWidth:1,label:{fontSize:20,strokeColor:"green",cssStyle:""}}),tt.create("angle",[nt,lt,it],{name:" ",radius:2,fillColor:"green",fillOpacity:.2,strokeColor:"green",strokeWidth:1,label:{fontSize:20,strokeColor:"green",cssStyle:""}});var ot=tt.create("point",[()=>it.X()-10,()=>it.Y()],{name:"",fixed:!0,visible:!1}),ct=tt.create("point",[()=>ot.X(),()=>ot.Y()-50],{name:"",fixed:!0,visible:!1}),ut=tt.create("point",[()=>lt.X()+50,()=>lt.Y()],{name:"",fixed:!0,visible:!1}),ht=tt.create("point",[()=>ut.X(),()=>ut.Y()-50],{name:"",fixed:!0,visible:!1});tt.create("polygon",[ot,ut,ht,ct],{name:"",strokeColor:"green",strokeWidth:2,fillColor:"#1565C0"}),tt.create("image",[rt,[()=>it.X()-2.5,()=>it.Y()],[3,5]]),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$b=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각비"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$b,boardAttributes:{boundingBox:[-12,12,12,-12],zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS$a=tt=>{tt.suspendUpdate();var _e=tt.create("point",[0,0],{name:"",withValue:!1,visible:!1,strokeColor:"black",strokeWidth:1,size:3}),rt=tt.create("point",[-5,5],{name:"",withValue:!1,visible:!0,strokeColor:"black",fillColor:"blue",strokeWidth:1,size:5}),it=tt.create("slider",[[-20,15],[-10,15],[0,2,10]],{name:"ratio",snapWidth:1,fillColor:"white",strokeColor:"green",postLabel:"",precision:0,label:{fontSize:20,strokeColor:"red",cssStyle:"margin-left: 15px; margin-top: 10px;"},baseline:{strokeColor:"green",strokeWidth:3,opacity:.4},highline:{strokeColor:"green",strokeWidth:5}}),nt=tt.create("point",[0,2],{name:"",withValue:!1,visible:!0,strokeColor:"black",strokeWidth:1,size:3}),st=tt.create("point",[-2,0],{name:"",withValue:!1,visible:!0,strokeColor:"black",strokeWidth:1,size:3}),at=tt.create("point",[2,0],{name:"",withValue:!1,visible:!0,strokeColor:"black",strokeWidth:1,size:3});tt.create("point",[function(){return(nt.X()+st.X())/2},function(){return(nt.Y()+st.Y())/2}],{name:"",withValue:!1,visible:!0,fillColor:"black",strokeColor:"black",strokeWidth:1,size:4.5}),tt.create("point",[function(){return(nt.X()+at.X())/2},function(){return(nt.Y()+at.Y())/2}],{name:"",withValue:!1,visible:!0,fillColor:"black",strokeColor:"black",strokeWidth:1,size:4.5}),tt.create("circle",[_e,st],{strokeColor:"#0099FF",strokeWidth:1,fillColor:"pink"}),it.Value(),tt.create("line",[_e,rt],{strokeColor:"black",strokeWidth:3,visible:!1});var lt=tt.create("point",[function(){return rt.X()+it.Value()*(_e.X()-rt.X())},function(){return rt.Y()+it.Value()*(_e.Y()-rt.Y())}],{name:"",withValue:!1,visible:!1,strokeColor:"black",strokeWidth:1,size:3});tt.create("line",[rt,st],{strokeColor:"black",strokeWidth:3,visible:!1});var ot=tt.create("point",[function(){return rt.X()+it.Value()*(st.X()-rt.X())},function(){return rt.Y()+it.Value()*(st.Y()-rt.Y())}],{name:"",withValue:!1,visible:!0,strokeColor:"black",strokeWidth:1,size:3});tt.create("line",[rt,nt],{strokeColor:"black",strokeWidth:3,visible:!1});var ct=tt.create("point",[function(){return rt.X()+it.Value()*(nt.X()-rt.X())},function(){return rt.Y()+it.Value()*(nt.Y()-rt.Y())}],{name:"",withValue:!1,visible:!0,strokeColor:"black",strokeWidth:1,size:3}),ut=tt.create("point",[function(){return rt.X()+it.Value()*(at.X()-rt.X())},function(){return rt.Y()+it.Value()*(_e.Y()-rt.Y())}],{name:"",withValue:!1,visible:!0,strokeColor:"black",strokeWidth:1,size:3});tt.create("segment",[rt,ot],{strokeWidth:3,dash:2,strokeColor:"red"}),tt.create("segment",[rt,ct],{strokeWidth:3,dash:2,strokeColor:"red"}),tt.create("segment",[rt,ut],{strokeWidth:3,dash:2,strokeColor:"red"}),tt.create("circle",[lt,ot],{strokeColor:"#0099FF",strokeWidth:1,fillColor:"pink"}),tt.create("circle",[lt,function(){return it.Value()/1.5}],{strokeColor:"#FF6699",strokeWidth:1,fillColor:"#FF6699"});var ht=tt.create("point",[function(){return(ot.X()+ct.X())/2},function(){return(ot.Y()+ct.Y())/2}],{name:"",withValue:!1,visible:!1,strokeColor:"black",strokeWidth:1,size:function(){return it.Value()}});tt.create("circle",[ht,function(){return it.Value()/3}],{strokeColor:"black",strokeWidth:1,fillColor:"black"});var dt=tt.create("point",[function(){return(ct.X()+ut.X())/2},function(){return(ct.Y()+ut.Y())/2}],{name:"",withValue:!1,visible:!1,strokeColor:"black",strokeWidth:1,size:function(){return it.Value()}});tt.create("circle",[dt,function(){return it.Value()/3}],{strokeColor:"black",strokeWidth:1,fillColor:"black"}),tt.create("circle",[_e,.6667],{strokeColor:"#FF6699",strokeWidth:1,fillColor:"#FF6699"}),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$a=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"Dilation"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$a,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS$9=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[5,20],[15,20],[1,5,10]],{name:"ratio",fillColor:"white",strokeColor:"green",postLabel:"",precision:1,label:{fontSize:20,strokeColor:"red",cssStyle:"margin-left: 15px; margin-top: 10px;"},baseline:{strokeColor:"green",strokeWidth:3,opacity:.4},highline:{strokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[0,0],{name:"",visible:!1}),it=tt.create("point",[function(){return _e.Value()*2},function(){return _e.Value()*2}],{name:"",visible:!0,strokeColor:"black",strokeWidth:1,size:3}),nt=tt.create("point",[-5,-5],{name:"",visible:!0,strokeColor:"black",strokeWidth:1,size:8,highlight:!0,highlightStrokeColor:"red",highlightStrokeWidth:3}),st=tt.create("segment",[it,nt],{visible:!1}),at=tt.create("midpoint",[it,nt],{visible:!1}),lt=tt.create("perpendicular",[st,at],{visible:!1}),ot=tt.create("point",[function(){return _e.Value()*2},0],{name:"",visible:!0,strokeColor:"black",strokeWidth:1,size:3}),ct=tt.create("point",[0,function(){return _e.Value()*2}],{name:"",visible:!0,strokeColor:"black",strokeWidth:1,size:3}),ut=tt.create("segment",[it,ot],{strokeColor:"black",strokeWidth:2,visible:!0}),ht=tt.create("segment",[it,ct],{strokeColor:"black",strokeWidth:2,visible:!0}),dt=tt.create("segment",[rt,ct],{strokeColor:"black",strokeWidth:2,visible:!0}),pt=tt.create("segment",[rt,ot],{strokeColor:"black",strokeWidth:2,visible:!0}),ft=tt.create("intersection",[lt,ht,0],{name:"",visible:!1}),gt=tt.create("intersection",[lt,ut,0],{name:"",visible:!1}),mt=tt.create("intersection",[lt,pt,0],{name:"",visible:!1}),At=tt.create("intersection",[lt,dt,0],{name:"",visible:!1}),yt=tt.create("perpendicularpoint",[ct,lt],{visible:!1}),bt=tt.create("reflection",[ct,lt],{name:"",withLabel:!1,visible:!1}),xt=tt.create("perpendicularpoint",[ot,lt],{visible:!1}),vt=tt.create("reflection",[ot,lt],{name:"",withLabel:!1,visible:!1}),_t=tt.create("perpendicularpoint",[rt,lt],{visible:!1}),Ct=tt.create("reflection",[rt,lt],{name:"",withLabel:!1,visible:!1});tt.create("polygon",[nt,bt,At,mt,vt],{fillColor:"#FF6699",fillOpacity:5,borders:{visible:!1},highlightFillColor:"#FF6699",highlightFillOpacity:1});var St,Et,Tt,Mt,Rt,It,Ot,Bt,Nt,zt,Dt,Ft,Ut;Mt=tt.create("segment",[At,bt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Rt=tt.create("segment",[bt,nt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Ot=tt.create("segment",[vt,nt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),It=tt.create("segment",[mt,vt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Bt=tt.create("segment",[At,mt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Ut=tt.create("segment",[At,rt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("segment",[mt,rt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),nt.on("drag",function(){tt.removeObject(ft),tt.removeObject(gt),tt.removeObject(mt),tt.removeObject(At),tt.removeObject(yt),tt.removeObject(bt),tt.removeObject(xt),tt.removeObject(vt),tt.removeObject(_t),tt.removeObject(Ct),St&&tt.removeObject(St),Et&&tt.removeObject(Et),Tt&&tt.removeObject(Tt),Mt&&tt.removeObject(Mt),Rt&&tt.removeObject(Rt),It&&tt.removeObject(It),Ot&&tt.removeObject(Ot),Bt&&tt.removeObject(Bt),Nt&&tt.removeObject(Nt),zt&&tt.removeObject(zt),Dt&&tt.removeObject(Dt),Ft&&tt.removeObject(Ft),Ut&&tt.removeObject(Ut),ft=tt.create("intersection",[lt,ht,0],{name:"",visible:!1}),gt=tt.create("intersection",[lt,ut,0],{name:"",visible:!1}),mt=tt.create("intersection",[lt,pt,0],{name:"",visible:!1}),At=tt.create("intersection",[lt,dt,0],{name:"",visible:!1}),yt=tt.create("perpendicularpoint",[ct,lt],{visible:!1}),bt=tt.create("reflection",[ct,lt],{name:"",visible:!1}),xt=tt.create("perpendicularpoint",[ot,lt],{name:"",visible:!1}),vt=tt.create("reflection",[ot,lt],{name:"",visible:!1}),_t=tt.create("perpendicularpoint",[rt,lt],{name:"O1",visible:!1}),Ct=tt.create("reflection",[rt,lt],{name:"",visible:!1}),nt.X()<=it.X()&&nt.Y()<=it.Y()&&(ft.X()>=0&&(St=tt.create("segment",[nt,ft],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Nt=tt.create("segment",[ct,ft],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Dt=tt.create("segment",[ct,rt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("polygon",[rt,ct,ft],{fillColor:"pink",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"pink"})),gt.Y()>=0&&(Et=tt.create("segment",[nt,gt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),zt=tt.create("segment",[gt,ot],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Ft=tt.create("segment",[ot,rt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("polygon",[rt,gt,ot],{fillColor:"pink",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"pink"})),ft.X()>=0&&gt.Y()>=0?(Tt=tt.create("segment",[ft,gt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("polygon",[rt,gt,ft],{fillColor:"pink",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"pink"}),tt.create("polygon",[nt,gt,ft],{fillColor:"#FF6699",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"#FF6699"})):(ft.X()<0&&gt.Y()>0&&(Bt=tt.create("segment",[gt,At],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Ut=tt.create("segment",[At,rt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("polygon",[rt,At,gt],{fillColor:"pink",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"pink"}),tt.create("polygon",[nt,At,gt],{fillColor:"#FF6699",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"#FF6699"})),ft.X()>0&&gt.Y()<0&&(Bt=tt.create("segment",[ft,mt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("segment",[mt,rt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("polygon",[rt,ft,mt],{fillColor:"pink",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"pink"}),tt.create("polygon",[nt,ft,mt],{fillColor:"#FF6699",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"#FF6699"})),ft.X()<0&&(Mt=tt.create("segment",[At,bt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Rt=tt.create("segment",[bt,nt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("polygon",[nt,bt,At],{fillColor:"#FF6699",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"#FF6699"})),gt.Y()<0&&(It=tt.create("segment",[mt,vt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Ot=tt.create("segment",[vt,nt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("polygon",[nt,vt,mt],{fillColor:"#FF6699",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"#FF6699"}))),ft.X()<0&&gt.Y()<0&&(Bt=tt.create("segment",[At,mt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),Ut=tt.create("segment",[At,rt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("segment",[mt,rt],{strokeColor:"blue",strokeWidth:2,visible:!0,highlight:!0,highlightStrokeColor:"blue"}),tt.create("polygon",[nt,At,mt],{fillColor:"#FF6699",fillOpacity:1,borders:{visible:!1},highlightFillOpacity:1,highlightFillColor:"#FF6699"})))}),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$9=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"선대칭 도형 대칭축 찾기"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$9,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS$8=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[2,-3],[5,-3],[0,2,5]],{name:"r",fillColor:"white",strokeColor:"blue",highlightFillColor:"white",highlightStrokeColor:"blue",postLabel:"",precision:2,label:{fontSize:20,strokeColor:"red",cssStyle:"margin-left: 15px; margin-top: 10px;"},baseline:{strokeColor:"blue",highlightStrokeColor:"blue",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"blue",highlightStrokeColor:"blue",strokeWidth:5}});tt.create("point",[0,0],{visible:!1}),tt.create("point",[0,function(){return 5-_e.Value()}],{visible:!1});var rt=tt.create("functiongraph",[function(yt){return tt.select("B").Y()*yt*yt*.25},-20,20],{strokeColor:"black",strokeWidth:1,highlightStrokeColor:"black",highlightStrokeWidth:1}),it=tt.create("glider",[2,2,rt],{name:"C",size:2,color:"green",highlightFillColor:"green",highlightStrokeColor:"green"});tt.create("tangent",[it],{strokeColor:"red",strokeWidth:1,highlightStrokeColor:"red",highlightStrokeWidth:1});var nt={headWidth:2,headLength:3,strokeWidth:2,indent:.1},st=[0,0],at,lt,ot,ct,ut,ht,dt,pt=tt.create("axis",[[0,0],[1,0]],{name:"x",withLabel:!1,visible:!1}),ft=tt.unitX,gt=tt.unitY,mt=function(yt,bt){var xt=[bt[0]-yt[0],bt[1]-yt[1]],vt=Math.sqrt(xt[0]*xt[0]*ft*ft+xt[1]*xt[1]*gt*gt),_t=nt.headWidth*nt.strokeWidth/vt,Ct=nt.headLength*nt.strokeWidth/vt,St=[bt[0]-Ct*xt[0],bt[1]-Ct*xt[1]],Et=[_t/2*ft*xt[0],_t/2*gt*xt[1]],Tt=[St[0]+Et[1]/ft,St[1]-Et[0]/gt],Mt=[St[0]-Et[1]/ft,St[1]+Et[0]/gt],Rt=nt.indent,It=[(1-Rt)*St[0]+Rt*bt[0],(1-Rt)*St[1]+Rt*bt[1]],Ot=[NaN,yt[0],bt[0],Tt[0],It[0],Mt[0],bt[0],NaN],Bt=[NaN,yt[1],bt[1],Tt[1],It[1],Mt[1],bt[1],NaN],Nt=tt.create("curve",[Ot,Bt],{strokeColor:"black",fillColor:"black",highlightStrokeColor:"black",highlightFillColor:"black",highlightStrokeWidth:1});return Nt},At=()=>{at&&tt.removeObject(at),lt&&tt.removeObject(lt),ot&&tt.removeObject(ot),ct&&tt.removeObject(ct),ut&&tt.removeObject(ut),ht&&tt.removeObject(ht),dt&&tt.removeObject(dt);var yt=[it.X(),it.Y()];at=mt(st,yt);var bt=_e.Value();yt=[0,bt],lt=mt(st,yt),ct=tt.create("point",[0,-bt],{withLabel:!1,name:"D",size:2,color:"blue",visible:!1}),ut=tt.create("point",[0,-it.Y()],{name:"-C",size:2,color:"black",visible:!0,fixed:!0}),ht=tt.create("segment",[it,[0,it.Y()]],{size:1,color:"black",visible:!0,dash:1}),dt=tt.create("point",[0,it.Y()],{withLabel:!0,name:"C'",size:2,color:"black",visible:!0,fixed:!0}),ot=tt.create("parallel",[pt,ct],{withLabel:!1,strokeColor:"blue",strokeWidth:1,highlightStrokeColor:"blue",highlightStrokeWidth:1})};it.on("drag",function(){At()}),_e.on("drag",function(){At()}),At(),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$8=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"포물선과 포물선 위의 점에서의 접선의 벡터 방정식"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$8,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:1.5,zoomY:1.5},style:{border:"1px solid black"}})]})}},logicJS$7=tt=>{tt.suspendUpdate();var _e=tt.create("point",[-20,0],{name:"A",size:2,color:"black",visible:!0,fixed:!0}),rt=tt.create("point",[-14,0],{name:"B",size:2,color:"black",visible:!0}),it=tt.create("point",[-20,6],{name:"C",size:2,color:"black",visible:!0}),nt=tt.create("segment",[_e,rt],{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,fixed:!0});tt.create("segment",[_e,it],{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,fixed:!0});var st=tt.create("arc",[_e,rt,it],{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,fixed:!0}),at=tt.create("glider",[-17,3,st],{name:"P",size:5,fillColor:"white",strokeColor:"#0099FF",visible:!0});tt.create("angle",[rt,_e,at],{name:"θ",radius:2,fillColor:"green",fillOpacity:0,strokeColor:"green",strokeWidth:2,label:{fontSize:25,strokeColor:"green",cssStyle:""}});var lt=tt.create("segment",[_e,at],{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,fixed:!0}),ot=tt.create("perpendicular",[rt,nt],{strokeColor:"black",dash:2,strokeWidth:1,highlightStrokeColor:"gray",highlightStrokeWidth:1,fixed:!0}),ct=tt.create("intersection",[lt,ot,0],{name:"R",size:5,fillColor:"white",strokeColor:"red",visible:!0}),ut=tt.create("segment",[_e,ct],{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,fixed:!0}),ht=tt.create("circle",[_e,ct],{visible:!1,strokeColor:"black",dash:2,strokeWidth:1,highlightStrokeColor:"gray",highlightStrokeWidth:1,fixed:!0}),dt=tt.create("circle",[ct,_e],{visible:!1,strokeColor:"black",dash:2,strokeWidth:1,highlightStrokeColor:"gray",highlightStrokeWidth:1,fixed:!0}),pt=tt.create("intersection",[ht,dt,0],{name:"S",size:5,color:"gray",visible:!1});tt.create("arc",[pt,ct,_e],{strokeColor:"black",strokeWidth:2,dash:2});var ft=tt.create("circle",[ct,rt],{visible:!1,strokeColor:"black",dash:2,strokeWidth:1,highlightStrokeColor:"gray",highlightStrokeWidth:1,fixed:!0}),gt=tt.create("circle",[rt,ct],{visible:!1,strokeColor:"black",dash:2,strokeWidth:1,highlightStrokeColor:"gray",highlightStrokeWidth:1,fixed:!0}),mt=tt.create("intersection",[ft,gt,0],{name:"T",size:2,color:"gray",visible:!1});tt.create("arc",[mt,rt,ct],{strokeColor:"black",strokeWidth:2,dash:2});var At=tt.create("circle",[_e,rt],{visible:!1,strokeColor:"black",dash:2,strokeWidth:1,highlightStrokeColor:"gray",highlightStrokeWidth:1,fixed:!0}),yt=tt.create("circle",[rt,_e],{visible:!1,strokeColor:"black",dash:2,strokeWidth:1,highlightStrokeColor:"gray",highlightStrokeWidth:1,fixed:!0}),bt=tt.create("intersection",[At,yt,1],{name:"U",size:2,color:"gray",visible:!1});tt.create("arc",[bt,_e,rt],{strokeColor:"black",strokeWidth:2,dash:2});var xt=tt.create("point",[-12,0],{name:"D",size:2,color:"visible: fail",visible:!0}),vt=tt.create("perpendicular",[xt,nt],{strokeColor:"black",dash:2,strokeWidth:1,highlightStrokeColor:"black",highlightStrokeWidth:1,fixed:!0}),_t=tt.create("intersection",[vt,ut,0],{name:"V",size:2,color:"black",visible:!0});tt.create("polygon",[_e,xt,_t],{visible:!0,strokeColor:"red",fillColor:"#FFA64D",highlightFillColor:"#FFA64D",strokeWidth:5,highlightStrokeColor:"black",highlightStrokeWidth:5}),tt.create("segment",[rt,ct],{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,fixed:!0}),tt.clickLeftArrow(),tt.clickLeftArrow(),tt.clickLeftArrow(),tt.clickLeftArrow(),tt.clickLeftArrow(),tt.clickDownArrow(),tt.clickDownArrow(),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$7=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"예각의 삼각비"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$7,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:1,zoomY:1},style:{border:"1px solid black"}})]})}},logicJS$6=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[2,5],[4,5],[0,30,360]],{name:"θ",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{fontSize:20,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -10px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}});tt.create("point",[0,1],{name:"1",withLabel:!0,visible:!0,fillColor:"gray",strokeColor:"black",strokeWidth:1,size:2,label:{fontSize:20,strokeColor:"black",cssStyle:"margin-left: 5px; margin-top: 10px;"}}),tt.create("point",[0,-1],{name:"-1",withLabel:!0,visible:!0,fillColor:"gray",strokeColor:"black",strokeWidth:1,size:2,label:{fontSize:20,strokeColor:"black",cssStyle:"margin-left: 5px; margin-top: 10px;"}});var rt=tt.create("point",[-2,0],{name:"A",withLabel:!0,visible:!0,fillColor:"gray",strokeColor:"black",strokeWidth:1,size:2}),it=tt.create("point",[-1,0],{visible:!1});tt.create("circle",[rt,it],{strokeColor:"black",strokeWidth:1});var nt=tt.create("point",[function(){return Math.cos(_e.Value()*Math.PI/180)-2},function(){return Math.sin(_e.Value()*Math.PI/180)}],{name:"D",withLabel:!0,visible:!0,fillColor:"blue",strokeColor:"black",strokeWidth:1,size:2});tt.create("angle",[it,rt,nt],{name:function(){return _e.Value().toString()+"°"},radius:.4,fillColor:"green",strokeColor:"green",strokeWidth:2,label:{fontSize:15,strokeColor:"green",cssStyle:"margin-top: -5px"}}),tt.create("segment",[rt,nt],{strokeColor:"black",strokeWidth:1});var st=tt.create("point",[function(){return it.X()},function(){return Math.tan(_e.Value()*Math.PI/180)}],{name:"E",withLabel:!0,visible:!0,fillColor:"gray",strokeColor:"black",strokeWidth:1,size:2});tt.create("segment",[it,st],{strokeColor:"red",strokeWidth:2}),tt.create("segment",[rt,st],{strokeColor:"black",strokeWidth:1}),tt.create("functiongraph",[function(ht){return Math.tan(ht)}],{strokeColor:"#468E46",highlightStrokeColor:"#468E46",strokeWidth:2});var at=tt.create("point",[function(){return _e.Value()*Math.PI/180},function(){return Math.tan(_e.Value()*Math.PI/180)}],{name:"F",withLabel:!0,visible:!0,fillColor:"gray",strokeColor:"black",strokeWidth:1,size:2}),lt=tt.create("point",[function(){return _e.Value()*Math.PI/180},0],{visible:!1});tt.create("segment",[at,lt],{strokeColor:"red",strokeWidth:2});var ot=tt.create("line",[[0,0],[1,0]],{strokeColor:"black",strokeWidth:2});tt.create("line",[[0,0],[0,1]],{strokeColor:"black",strokeWidth:2});var ct=tt.create("point",[function(){return Math.PI/2},0],{visible:!1});tt.create("perpendicular",[ct,ot],{strokeColor:"black",strokeWidth:1,dash:2});var ut=tt.create("point",[function(){return Math.PI*3/2},0],{visible:!1});tt.create("perpendicular",[ut,ot],{strokeColor:"black",strokeWidth:1,dash:2}),tt.clickDownArrow(),tt.clickDownArrow(),tt.clickRightArrow(),tt.clickRightArrow(),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$6=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각함수 탄젠트함수"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$6,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!1,zoomX:2,zoomY:2},style:{border:"1px solid black"}})]})}},logicJS$5=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[2,11],[10,11],[0,180,180]],{name:"θ",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{fontSize:10,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: 0px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("slider",[[2,9],[10,9],[0,180,180]],{name:"θ",snapWidth:1,fillColor:"white",strokeColor:"blue",highlightFillColor:"white",highlightStrokeColor:"blue",postLabel:"",precision:0,label:{fontSize:10,strokeColor:"blue",cssStyle:"margin-left: -55px; margin-top: 0px;"},baseline:{strokeColor:"blue",highlightStrokeColor:"blue",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"blue",highlightStrokeColor:"blue",strokeWidth:5}}),it=tt.create("point",[0,-3],{name:"A",size:2,color:"black",label:{fontSize:15,strokeColor:"blue",cssStyle:"margin-left: 0px; margin-top: 5px"}}),nt=tt.create("point",[-3,5],{name:"B",size:2,color:"black",label:{fontSize:15,strokeColor:"blue",cssStyle:"margin-left: 0px; margin-top: 5px"}}),st=tt.create("point",[10,5],{name:"C",size:2,color:"black",label:{fontSize:15,strokeColor:"blue",cssStyle:"margin-left: 0px; margin-top: 5px"}});tt.create("angle",[it,nt,st],{name:"β",radius:1.5,fillColor:"#8E1EFF",strokeColor:"#8E1EFF",strokeWidth:2,label:{fontSize:15,strokeColor:"#8E1EFF",cssStyle:"margin-right: -15px; margin-bottom: 10px"}}),tt.create("angle",[st,it,nt],{name:"α",radius:1.5,fillColor:"green",strokeColor:"green",strokeWidth:2,label:{fontSize:15,strokeColor:"green",cssStyle:"margin-left: 0px; margin-bottom: -15px"}}),tt.create("angle",[nt,st,it],{name:"γ",radius:1.5,fillColor:"red",strokeColor:"red",strokeWidth:2,label:{fontSize:15,strokeColor:"red",cssStyle:"margin-left: 10px; margin-bottom: -15px"}});var at=tt.create("segment",[it,nt],{name:"AB",color:"black",highlightStrokeColor:"black",fixed:!0}),lt=tt.create("segment",[it,st],{name:"AC",color:"black",highlightStrokeColor:"black",fixed:!0});tt.create("segment",[nt,st],{name:"BC",color:"black",highlightStrokeColor:"black",fixed:!0});var ot=tt.create("midpoint",[at],{visible:!1}),ct=tt.create("midpoint",[lt],{visible:!1});const ut=tt.create("point",[function(){return ct.X()+(st.X()-ct.X())*Math.cos(_e.Value()*Math.PI/180)-(st.Y()-ct.Y())*Math.sin(_e.Value()*Math.PI/180)},function(){return ct.Y()+(st.X()-ct.X())*Math.sin(_e.Value()*Math.PI/180)+(st.Y()-ct.Y())*Math.cos(_e.Value()*Math.PI/180)}],{name:""}),ht=tt.create("point",[function(){return ct.X()+(it.X()-ct.X())*Math.cos(_e.Value()*Math.PI/180)-(it.Y()-ct.Y())*Math.sin(_e.Value()*Math.PI/180)},function(){return ct.Y()+(it.X()-ct.X())*Math.sin(_e.Value()*Math.PI/180)+(it.Y()-ct.Y())*Math.cos(_e.Value()*Math.PI/180)}],{name:""}),dt=tt.create("point",[function(){return ct.X()+(nt.X()-ct.X())*Math.cos(_e.Value()*Math.PI/180)-(nt.Y()-ct.Y())*Math.sin(_e.Value()*Math.PI/180)},function(){return ct.Y()+(nt.X()-ct.X())*Math.sin(_e.Value()*Math.PI/180)+(nt.Y()-ct.Y())*Math.cos(_e.Value()*Math.PI/180)}],{name:""});tt.create("angle",[dt,ut,ht],{name:"γ",radius:1.5,fillColor:"red",strokeColor:"red",strokeWidth:2,label:{fontSize:15,strokeColor:"red",cssStyle:"margin-left: 10px; margin-bottom: -15px"},fixed:!0}),tt.create("polygon",[ht,dt,ut],{name:"",fillColor:"white",fixed:!0,withLines:!0,highlightFillColor:"white",vertices:{visible:!1},borders:{strokeColor:"black",dash:2,highlightStrokeColor:"black"}});const pt=tt.create("point",[function(){return ot.X()+(st.X()-ot.X())*Math.cos(rt.Value()*Math.PI/180)-(st.Y()-ot.Y())*Math.sin(rt.Value()*Math.PI/180)},function(){return ot.Y()+(st.X()-ot.X())*Math.sin(rt.Value()*Math.PI/180)+(st.Y()-ot.Y())*Math.cos(rt.Value()*Math.PI/180)}],{name:""}),ft=tt.create("point",[function(){return ot.X()+(it.X()-ot.X())*Math.cos(rt.Value()*Math.PI/180)-(it.Y()-ot.Y())*Math.sin(rt.Value()*Math.PI/180)},function(){return ot.Y()+(it.X()-ot.X())*Math.sin(rt.Value()*Math.PI/180)+(it.Y()-ot.Y())*Math.cos(rt.Value()*Math.PI/180)}],{name:""}),gt=tt.create("point",[function(){return ot.X()+(nt.X()-ot.X())*Math.cos(rt.Value()*Math.PI/180)-(nt.Y()-ot.Y())*Math.sin(rt.Value()*Math.PI/180)},function(){return ot.Y()+(nt.X()-ot.X())*Math.sin(rt.Value()*Math.PI/180)+(nt.Y()-ot.Y())*Math.cos(rt.Value()*Math.PI/180)}],{name:""});tt.create("angle",[ft,gt,pt],{name:"β",radius:1.5,fillColor:"#8E1EFF",strokeColor:"#8E1EFF",strokeWidth:2,label:{fontSize:15,strokeColor:"#8E1EFF",cssStyle:"margin-right: -15px; margin-bottom: 10px"}}),tt.create("polygon",[ft,gt,pt],{name:"",fillColor:"white",fixed:!0,withLines:!0,highlightFillColor:"white",vertices:{visible:!1},borders:{strokeColor:"black",dash:2,highlightStrokeColor:"black"}}),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$5=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"삼각형 내각의 합"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$5,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!1,zoomX:.7,zoomY:.7},style:{border:"1px solid black"}})]})}};var tree_data={tree:[]};let logicJS$4=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[10,-10],[20,-10],[0,0,6]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[5,5],{visible:!0,name:"A",size:2,color:"black",fixed:!0}),it=tt.create("point",[-5,5],{visible:!0,name:"B",size:2,color:"black",fixed:!0}),nt=tt.create("point",[-5,-5],{visible:!0,name:"C",size:2,color:"black",fixed:!0}),st=tt.create("point",[5,-5],{visible:!0,name:"D",size:2,color:"black",fixed:!0});tt.create("polygon",[rt,it,nt,st],{fillColor:"red",fillOpacity:1,strokeColor:"red",strokeWidth:2,borders:{strokeColor:"red",strokeWidth:2,highlightStrokeColor:"red",highlightStrokeWidth:2,highlightStrokeOpacity:.4}});var at="#"+Math.floor(Math.random()*16777215).toString(16),lt=[],ot=[],ct=[],ut=[],ht=[],dt=[],pt=[];fetch(".././tree_data.json").then(gt=>{if(!gt.ok)throw new Error("Network response was not ok");return gt.json()}).then(gt=>{tree_data={tree:[]},tree_data=gt}).catch(gt=>{console.error("There has been a problem with your fetch operation:",gt)}),_e.on("drag",function(){var gt=_e.Value();if(gt==0){for(var mt=0;mt<lt.length;mt++)lt[mt].setAttribute({visible:!1});for(var mt=0;mt<ot.length;mt++)ot[mt].setAttribute({visible:!1});for(var mt=0;mt<ct.length;mt++)ct[mt].setAttribute({visible:!1});for(var mt=0;mt<ut.length;mt++)ut[mt].setAttribute({visible:!1});for(var mt=0;mt<ht.length;mt++)ht[mt].setAttribute({visible:!1});for(var mt=0;mt<dt.length;mt++)dt[mt].setAttribute({visible:!1});for(var mt=0;mt<pt.length;mt++)pt[mt].setAttribute({visible:!1})}if(gt==1){if(lt.length>0)for(var mt=0;mt<lt.length;mt++)lt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});lt.push(At)}}for(var mt=0;mt<ot.length;mt++)ot[mt].setAttribute({visible:!1});for(var mt=0;mt<ct.length;mt++)ct[mt].setAttribute({visible:!1});for(var mt=0;mt<ut.length;mt++)ut[mt].setAttribute({visible:!1});for(var mt=0;mt<ht.length;mt++)ht[mt].setAttribute({visible:!1});for(var mt=0;mt<dt.length;mt++)dt[mt].setAttribute({visible:!1});for(var mt=0;mt<pt.length;mt++)pt[mt].setAttribute({visible:!1})}if(gt==2){if(lt.length>0)for(var mt=0;mt<lt.length;mt++)lt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});lt.push(At)}}if(ot.length>0)for(var mt=0;mt<ot.length;mt++)ot[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ot.push(At)}}for(var mt=0;mt<ct.length;mt++)ct[mt].setAttribute({visible:!1});for(var mt=0;mt<ut.length;mt++)ut[mt].setAttribute({visible:!1});for(var mt=0;mt<ht.length;mt++)ht[mt].setAttribute({visible:!1});for(var mt=0;mt<dt.length;mt++)dt[mt].setAttribute({visible:!1});for(var mt=0;mt<pt.length;mt++)pt[mt].setAttribute({visible:!1})}if(gt==3){if(lt.length>0)for(var mt=0;mt<lt.length;mt++)lt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});lt.push(At)}}if(ot.length>0)for(var mt=0;mt<ot.length;mt++)ot[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ot.push(At)}}if(ct.length>0)for(var mt=0;mt<ct.length;mt++)ct[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ct.push(At)}}for(var mt=0;mt<ut.length;mt++)ut[mt].setAttribute({visible:!1});for(var mt=0;mt<ht.length;mt++)ht[mt].setAttribute({visible:!1});for(var mt=0;mt<dt.length;mt++)dt[mt].setAttribute({visible:!1});for(var mt=0;mt<pt.length;mt++)pt[mt].setAttribute({visible:!1})}if(gt==4){if(lt.length>0)for(var mt=0;mt<lt.length;mt++)lt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});lt.push(At)}}if(ot.length>0)for(var mt=0;mt<ot.length;mt++)ot[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ot.push(At)}}if(ct.length>0)for(var mt=0;mt<ct.length;mt++)ct[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ct.push(At)}}if(ut.length>0)for(var mt=0;mt<ut.length;mt++)ut[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ut.push(At)}}for(var mt=0;mt<ht.length;mt++)ht[mt].setAttribute({visible:!1});for(var mt=0;mt<dt.length;mt++)dt[mt].setAttribute({visible:!1});for(var mt=0;mt<pt.length;mt++)pt[mt].setAttribute({visible:!1})}if(gt==5){if(lt.length>0)for(var mt=0;mt<lt.length;mt++)lt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});lt.push(At)}}if(ot.length>0)for(var mt=0;mt<ot.length;mt++)ot[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ot.push(At)}}if(ct.length>0)for(var mt=0;mt<ct.length;mt++)ct[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ct.push(At)}}if(ut.length>0)for(var mt=0;mt<ut.length;mt++)ut[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ut.push(At)}}if(ht.length>0)for(var mt=0;mt<ht.length;mt++)ht[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ht.push(At)}}for(var mt=0;mt<dt.length;mt++)dt[mt].setAttribute({visible:!1});for(var mt=0;mt<pt.length;mt++)pt[mt].setAttribute({visible:!1})}if(gt==6){if(lt.length>0)for(var mt=0;mt<lt.length;mt++)lt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});lt.push(At)}}if(ot.length>0)for(var mt=0;mt<ot.length;mt++)ot[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ot.push(At)}}if(ct.length>0)for(var mt=0;mt<ct.length;mt++)ct[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ct.push(At)}}if(ut.length>0)for(var mt=0;mt<ut.length;mt++)ut[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ut.push(At)}}if(ht.length>0)for(var mt=0;mt<ht.length;mt++)ht[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ht.push(At)}}if(dt.length>0)for(var mt=0;mt<dt.length;mt++)dt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});dt.push(At)}}for(var mt=0;mt<pt.length;mt++)pt[mt].setAttribute({visible:!1})}if(gt==7){if(lt.length>0)for(var mt=0;mt<lt.length;mt++)lt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});lt.push(At)}}if(ot.length>0)for(var mt=0;mt<ot.length;mt++)ot[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ot.push(At)}}if(ct.length>0)for(var mt=0;mt<ct.length;mt++)ct[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ct.push(At)}}if(ut.length>0)for(var mt=0;mt<ut.length;mt++)ut[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ut.push(At)}}if(ht.length>0)for(var mt=0;mt<ht.length;mt++)ht[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});ht.push(At)}}if(dt.length>0)for(var mt=0;mt<dt.length;mt++)dt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});dt.push(At)}}if(pt.length>0)for(var mt=0;mt<pt.length;mt++)pt[mt].setAttribute({visible:!0});else{const yt=tree_data.tree.filter(bt=>bt.depth==gt).flatMap(bt=>bt.polygons);for(var mt=0;mt<yt.length;mt++){at="#"+Math.floor(Math.random()*16777215).toString(16);var At=tt.create("polygon",[yt[mt].A,yt[mt].B,yt[mt].C,yt[mt].D],{fillColor:at,fillOpacity:1,strokeColor:at,strokeWidth:2,vertices:{visible:!1},borders:{visible:!1}});pt.push(At)}}}}),tt.clickDownArrow(),tt.clickDownArrow(),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$4=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"피타고라스 나무(Pythagoras tree)"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$4,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:.3,zoomY:.3},style:{border:"1px solid black"}})]})}};function degrees_to_radians$1(tt){var _e=Math.PI;return tt*(_e/180)}let logicJS$3=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[5,10],[10,10],[0,0,90]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"#00FF01",highlightFillColor:"white",highlightStrokeColor:"#00FF01",postLabel:"°",precision:0,label:{visible:!1,fontSize:15,strokeColor:"#00FF01",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"#00FF01",highlightStrokeColor:"#00FF01",highlightStrokeOpacity:.7,strokeWidth:5,opacity:.7},highline:{strokeColor:"#00FF01",highlightStrokeColor:"#00FF01",strokeWidth:7}}),rt=tt.create("slider",[[5,9],[10,9],[0,0,90]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"#00FFFF",highlightFillColor:"white",highlightStrokeColor:"#00FFFF",postLabel:"°",precision:0,label:{visible:!1,fontSize:15,strokeColor:"#00FFFF",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"#00FFFF",highlightStrokeColor:"#00FFFF",highlightStrokeOpacity:.7,strokeWidth:5,opacity:.7},highline:{strokeColor:"#00FFFF",highlightStrokeColor:"#00FFFF",strokeWidth:7}}),it=tt.create("slider",[[5,8],[10,8],[0,0,90]],{name:"n",snapWidth:1,fillColor:"white",strokeColor:"#FFDD02",highlightFillColor:"white",highlightStrokeColor:"#FFDD02",postLabel:"°",precision:0,label:{visible:!1,fontSize:15,strokeColor:"#FFDD02",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"#FFDD02",highlightStrokeColor:"#FFDD02",highlightStrokeOpacity:.7,strokeWidth:5,opacity:.7},highline:{strokeColor:"#FFDD02",highlightStrokeColor:"#FFDD02",strokeWidth:7}}),nt=tt.create("point",[-5,-5],{visible:!1,name:"A",size:2,color:"black",fixed:!0}),st=tt.create("point",[5,-5],{visible:!1,name:"B",size:2,color:"black",fixed:!0}),at=tt.create("segment",[nt,st],{visible:!1,name:"segAB",size:2,color:"black",fixed:!0}),lt=tt.create("midpoint",[nt,st],{visible:!1,name:"midAB",size:2,color:"black",fixed:!0}),ot=tt.create("circle",[lt,st],{visible:!1,strokeColor:"black",strokeWidth:1}),ct=tt.create("perpendicular",[lt,at],{visible:!1,name:"perpAB",size:1,strokeWidth:.5,color:"black",fixed:!0}),ut=tt.create("intersection",[ct,ot,1],{visible:!1,name:"E",size:2,color:"black",fixed:!0}),ht=tt.create("arc",[lt,ut,nt],{visible:!1,strokeColor:"blue",strokeWidth:2,fixed:!0}),dt=tt.create("glider",[-2,-2,ht],{visible:!0,name:"F",size:9,fillColor:"#FF00FF",strokeColor:"black",highlightFillColor:"#FF00FF",highlightStrokeColor:"black"}),pt=tt.create("point",[-5,5],{visible:!1,name:"D",size:2,color:"black",fixed:!0}),ft=tt.create("point",[5,5],{visible:!1,name:"C",size:2,color:"black",fixed:!0}),gt=tt.create("segment",[nt,pt],{visible:!1,name:"segAD",size:2,color:"black",fixed:!0});tt.create("segment",[st,ft],{visible:!1,name:"segBC",size:2,color:"black",fixed:!0});var mt=tt.create("segment",[ft,pt],{visible:!1,name:"segCD",size:2,color:"black",fixed:!0}),At=tt.create("segment",[nt,dt],{visible:!1,strokeColor:"black",strokeWidth:2}),yt=tt.create("intersection",[At,mt,1],{visible:!1,name:"G",size:2,color:"black",fixed:!0}),bt=tt.create("segment",[nt,yt],{visible:!1,name:"segAG",size:2,color:"black",fixed:!0});tt.create("segment",[st,dt],{visible:!1,name:"segBF",size:2,color:"black",fixed:!0});var xt=tt.create("perpendicular",[pt,bt],{visible:!1,name:"perpAG",size:1,strokeWidth:.5,color:"black",fixed:!0}),vt=tt.create("intersection",[xt,bt,1],{visible:!1,name:"H",size:2,color:"black",fixed:!0}),_t=tt.create("circle",[vt,pt],{visible:!1,strokeColor:"black",strokeWidth:1}),Ct=tt.create("intersection",[_t,bt,1],{visible:!1,name:"I",size:2,color:"black",fixed:!0}),St=tt.create("perpendicular",[Ct,bt],{visible:!1,name:"perpBC",size:1,strokeWidth:.5,color:"black",fixed:!0}),Et=tt.create("intersection",[St,gt,1],{visible:!1,name:"J",size:2,color:"black",fixed:!0}),Tt=tt.create("polygon",[st,dt,yt,ft],{fillColor:"#FF7F00",fillOpacity:1,strokeColor:"black",highlightFillColor:"#FF7F00",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}}),Mt=tt.create("point",[nt.X(),nt.Y()],{visible:!1,name:"A1",size:2,color:"black",fixed:!0}),Rt=tt.create("point",[st.X(),st.Y()],{visible:!1,name:"B1",size:2,color:"black",fixed:!0}),It=tt.create("point",[dt.X(),dt.Y()],{visible:!1,name:"F1",size:2,color:"black",fixed:!0}),Ot=[Mt,Rt,It],Bt=tt.create("polygon",Ot,{fillColor:"#00FF00",fillOpacity:1,strokeColor:"black",highlightFillColor:"#00FF00",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}}),Nt=tt.create("point",[yt.X(),yt.Y()],{visible:!1,name:"G1",size:2,color:"black",fixed:!0}),zt=tt.create("point",[vt.X(),vt.Y()],{visible:!1,name:"H1",size:2,color:"black",fixed:!0}),Dt=tt.create("point",[pt.X(),pt.Y()],{visible:!1,name:"D1",size:2,color:"black",fixed:!0}),Ft=[Nt,zt,Dt],Ut=tt.create("polygon",Ft,{fillColor:"#FFDD02",fillOpacity:1,strokeColor:"black",highlightFillColor:"#FFDD02",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}}),$t=tt.create("polygon",[vt,Ct,Et,pt],{fillColor:"#7D7DFF",fillOpacity:1,strokeColor:"black",highlightFillColor:"#7D7DFF",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}}),Vt=tt.create("point",[Et.X(),Et.Y()],{visible:!1,name:"J1",size:2,color:"black",fixed:!0}),Zt=tt.create("point",[Ct.X(),Ct.Y()],{visible:!1,name:"I1",size:2,color:"black",fixed:!0}),qt=tt.create("point",[nt.X(),nt.Y()],{visible:!1,name:"A2",size:2,color:"black",fixed:!0}),sr=[Vt,Zt,qt],er=tt.create("polygon",sr,{fillColor:"#00FFFF",fillOpacity:1,strokeColor:"black",highlightFillColor:"#00FFFF",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}}),ir=_e.Value(),ur=()=>{var nr=degrees_to_radians$1(ir-_e.Value()),mr=st;Ot.forEach(Sr=>{const Er=Sr.X()-mr.X(),Nr=Sr.Y()-mr.Y(),wr=Er*Math.cos(nr)-Nr*Math.sin(nr)+mr.X(),kr=Er*Math.sin(nr)+Nr*Math.cos(nr)+mr.Y();Sr.setPositionDirectly(JXG.COORDS_BY_USER,[wr,kr])}),ir=_e.Value()},ar=rt.Value(),lr=()=>{var nr=pt,mr=degrees_to_radians$1(rt.Value()-ar);sr.forEach(Sr=>{const Er=Sr.X()-nr.X(),Nr=Sr.Y()-nr.Y(),wr=Er*Math.cos(mr)-Nr*Math.sin(mr)+nr.X(),kr=Er*Math.sin(mr)+Nr*Math.cos(mr)+nr.Y();Sr.setPositionDirectly(JXG.COORDS_BY_USER,[wr,kr])}),ar=rt.Value()},gr=it.Value(),Yt=()=>{var nr=pt,mr=degrees_to_radians$1(it.Value()-gr)*3;Ft.forEach(Sr=>{const Er=Sr.X()-nr.X(),Nr=Sr.Y()-nr.Y(),wr=Er*Math.cos(mr)-Nr*Math.sin(mr)+nr.X(),kr=Er*Math.sin(mr)+Nr*Math.cos(mr)+nr.Y();Sr.setPositionDirectly(JXG.COORDS_BY_USER,[wr,kr])}),gr=it.Value()};_e.on("drag",function(){ur()}),_e.coords.on("update",function(){ur()}),rt.on("drag",function(){lr()}),rt.coords.on("update",function(){lr()}),it.on("drag",function(){Yt()}),it.coords.on("update",function(){Yt()}),dt.on("drag",function(){_e.setValue(0),rt.setValue(0),it.setValue(0),tt.removeObject(Tt),Tt=tt.create("polygon",[st,dt,yt,ft],{fillColor:"#FF7F00",fillOpacity:1,strokeColor:"black",highlightFillColor:"#FF7F00",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}});for(var nr=0;nr<Ot.length;nr++)tt.removeObject(Ot[nr]);Ot=[],tt.removeObject(Bt),Mt=tt.create("point",[nt.X(),nt.Y()],{visible:!1,name:"A1",size:2,color:"black",fixed:!0}),Rt=tt.create("point",[st.X(),st.Y()],{visible:!1,name:"B1",size:2,color:"black",fixed:!0}),It=tt.create("point",[dt.X(),dt.Y()],{visible:!1,name:"F1",size:2,color:"black",fixed:!0}),Ot=[Mt,Rt,It],Bt=tt.create("polygon",Ot,{fillColor:"#00FF00",fillOpacity:1,strokeColor:"black",highlightFillColor:"#00FF00",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}});for(var nr=0;nr<Ft.length;nr++)tt.removeObject(Ft[nr]);Ft=[],tt.removeObject(Ut),Nt=tt.create("point",[yt.X(),yt.Y()],{visible:!1,name:"G1",size:2,color:"black",fixed:!0}),zt=tt.create("point",[vt.X(),vt.Y()],{visible:!1,name:"H1",size:2,color:"black",fixed:!0}),Dt=tt.create("point",[pt.X(),pt.Y()],{visible:!1,name:"D1",size:2,color:"black",fixed:!0}),Ft=[Nt,zt,Dt],Ut=tt.create("polygon",Ft,{fillColor:"#FFDD02",fillOpacity:1,strokeColor:"black",highlightFillColor:"#FFDD02",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}}),tt.removeObject($t),$t=tt.create("polygon",[vt,Ct,Et,pt],{fillColor:"#7D7DFF",fillOpacity:1,strokeColor:"black",highlightFillColor:"#7D7DFF",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}});for(var nr=0;nr<sr.length;nr++)tt.removeObject(sr[nr]);sr=[],tt.removeObject(er),Vt=tt.create("point",[Et.X(),Et.Y()],{visible:!1,name:"J1",size:2,color:"black",fixed:!0}),Zt=tt.create("point",[Ct.X(),Ct.Y()],{visible:!1,name:"I1",size:2,color:"black",fixed:!0}),qt=tt.create("point",[nt.X(),nt.Y()],{visible:!1,name:"A2",size:2,color:"black",fixed:!0}),sr=[Vt,Zt,qt],er=tt.create("polygon",sr,{fillColor:"#00FFFF",fillOpacity:1,strokeColor:"black",highlightFillColor:"#00FFFF",strokeWidth:1,borders:{strokeColor:"black",strokeWidth:2,highlightStrokeColor:"black",highlightStrokeWidth:2,highlightStrokeOpacity:.4}})}),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$3=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"조각맞추기 - 한 눈에 보이는 피타고라스 정리"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$3,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:1,zoomY:1},style:{border:"1px solid black"}})]})}};function degrees_to_radians(tt){var _e=Math.PI;return tt*(_e/180)}let logicJS$2=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-25,25],[-5,25],[1,1,8766]],{name:"hour",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[0,0],{name:"태양",size:4,fillColor:"blue",strokeColor:"black",fixed:!0,label:{visible:!0,fontSize:20,strokeColor:"red",cssStyle:"margin-left: -5px; margin-top: 45px;"}}),it=tt.create("point",[function(){return 10*Math.cos(degrees_to_radians(_e.Value()*360/8766))},function(){return 10*Math.sin(degrees_to_radians(_e.Value()*360/8766))}],{name:"지구",size:4,fillColor:"blue",strokeColor:"black",fixed:!0,label:{visible:!0,fontSize:20,strokeColor:"red",cssStyle:"margin-left: -5px; margin-top: 45px;"}}),nt=tt.create("circle",[it,5],{strokeColor:"black",fillColor:"white",fillOpacity:.5,highlightFillColor:"black",highlightStrokeColor:"black",highlightFillOpacity:.5,strokeWidth:1,dash:2,fixed:!0}),st=tt.create("segment",[rt,it],{strokeColor:"black",strokeWidth:2,fixed:!0}),at=tt.create("perpendicular",[st,it],{visible:!1}),lt=tt.create("intersection",[at,nt,0],{withLabel:!1,name:"B1",size:4,color:"black",fixed:!0}),ot=tt.create("intersection",[at,nt,1],{withLabel:!1,name:"B3",size:4,color:"black",fixed:!0});tt.create("intersection",[st,nt,0],{withLabel:!0,name:"B0",size:4,color:"black",fixed:!0}),tt.create("intersection",[st,nt,1],{withLabel:!1,name:"B2",size:4,color:"black",fixed:!0});var ct=tt.create("bisector",[rt,it,lt],{visible:!1});tt.create("intersection",[ct,nt,0],{withLabel:!1,name:"B4",size:4,color:"black",fixed:!0}),tt.create("intersection",[ct,nt,1],{withLabel:!1,name:"B5",size:4,color:"black",fixed:!0});var ut=tt.create("bisector",[rt,it,ot],{visible:!1});tt.create("intersection",[ut,nt,0],{withLabel:!1,name:"B6",size:4,color:"black",fixed:!0}),tt.create("intersection",[ut,nt,1],{withLabel:!1,name:"B7",size:4,color:"black",fixed:!0});var ht=tt.create("point",[function(){return it.X()+3*Math.cos(degrees_to_radians(_e.Value()*360/710))},function(){return it.Y()+3*Math.sin(degrees_to_radians(_e.Value()*360/710))}],{name:"M",size:4,fillColor:"#FF7F00",fixed:!0,strokeColor:"black",strokeWidth:1,label:{visible:!0,fontSize:15,strokeColor:"#FF7F00",cssStyle:"margin-left: -5px; margin-top: -5px;"}}),dt=tt.create("segment",[it,ht],{strokeColor:"black",strokeWidth:2,fixed:!0}),pt=tt.create("circle",[ht,1.2],{strokeColor:"black",fillColor:"white",fillOpacity:.5,highlightFillColor:"black",highlightStrokeColor:"black",highlightFillOpacity:.5,strokeWidth:1,fixed:!0}),ft=tt.create("perpendicular",[dt,ht],{visible:!0,strokeColor:"black",strokeWidth:1,dash:2,fixed:!0}),gt=tt.create("intersection",[ft,pt,0],{visible:!1}),mt=tt.create("intersection",[ft,pt,1],{visible:!1}),At=tt.create("intersection",[dt,pt,0],{visible:!1});tt.create("circumcirclearc",[gt,At,mt],{strokeColor:"black",fillColor:"gray",strokeWidth:1,fixed:!0}),tt.clickDownArrow(),tt.clickDownArrow(),tt.clickLeftArrow(),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$2=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"조각맞추기 - 한 눈에 보이는 피타고라스 정리"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$2,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!0,zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS$1=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-20,20],[-10,20],[0,0,100]],{name:"distance",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"%",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -55px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("point",[0,0],{name:"O",size:9,color:"black",fixed:!0}),it=tt.create("point",[10,0],{name:"",size:9,fillColor:"white",strokeColor:"black"}),nt=tt.create("line",[[0,0],[1,0]],{visible:!1}),st=tt.create("circle",[rt,it],{visible:!0,strokeColor:"black",strokeWidth:2,fillColor:"#FFEFD5",highlightFillColor:"#FFEFD5",fillColorOpacity:.5}),at=tt.create("intersection",[nt,st,0],{visible:!1}),lt=tt.create("glider",[-10,-10,st],{visible:!1,name:"",size:9,fillColor:"#FF6699",strokeColor:"black",trace:!1}),ot=tt.create("segment",[rt,lt],{visible:!1}),ct=tt.create("point",[at.X()*_e.Value()/100,0],{visible:!1}),ut=tt.create("circle",[rt,ct],{visible:!1}),ht=tt.create("intersection",[ut,ot,0],{visible:!1}),dt=tt.create("segment",[rt,ht],{strokeColor:"#800200",strokeWidth:4,fixed:!0});_e.on("drag",function(){tt.removeObject(ct),ct=tt.create("point",[at.X()*_e.Value()/100,0],{visible:!1}),tt.removeObject(ut),ut=tt.create("circle",[rt,ct],{visible:!1}),tt.removeObject(ht),ht=tt.create("intersection",[ut,ot,0],{visible:!1}),_e.Value()==100?(lt.setAttribute({visible:!0}),lt.setAttribute({trace:!0}),st.setAttribute({visible:!1}),it.setAttribute({visible:!1})):(lt.setAttribute({visible:!1}),lt.setAttribute({trace:!1}),st.setAttribute({visible:!0}),it.setAttribute({visible:!0})),tt.removeObject(dt),dt=tt.create("segment",[rt,ht],{strokeColor:"#800200",strokeWidth:4,fixed:!0})}),tt.resizeContainer(800,800),tt.unsuspendUpdate()},JSXGraphComponent$1=class extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"원과 구의 정의"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS$1,boardAttributes:{boundingBox:[-12,12,12,-12],axis:!1,zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}},logicJS=tt=>{tt.suspendUpdate();var _e=tt.create("slider",[[-25,25],[-10,25],[1,1,9]],{name:"",snapWidth:1,fillColor:"white",strokeColor:"green",highlightFillColor:"white",highlightStrokeColor:"green",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"green",cssStyle:"margin-left: -5px; margin-top: -5px;"},baseline:{strokeColor:"green",highlightStrokeColor:"green",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"green",highlightStrokeColor:"green",strokeWidth:5}}),rt=tt.create("slider",[[-25,20],[-25,5],[1,1,9]],{name:"",snapWidth:1,fillColor:"white",strokeColor:"red",highlightFillColor:"white",highlightStrokeColor:"red",postLabel:"",precision:0,label:{visible:!0,fontSize:15,strokeColor:"red",cssStyle:"margin-left: -20px;"},baseline:{strokeColor:"red",highlightStrokeColor:"red",highlightStrokeOpacity:.4,strokeWidth:3,opacity:.4},highline:{strokeColor:"red",highlightStrokeColor:"red",strokeWidth:5}}),it=tt.create("point",[-20,20],{name:"P",size:4,color:"green",strokeColor:"black",strokeWidth:1,fixed:!0}),nt=tt.create("point",[-20+_e.Value()*5,20-rt.Value()*5],{name:"Q",size:4,color:"green",strokeColor:"black",strokeWidth:1,fixed:!0}),st=[],at=[],lt=[],ot=tt.unitX,ct=tt.unitY,ut={headWidth:2,headLength:3,strokeWidth:5,indent:.1},ht=(pt,ft,gt)=>{var mt=[pt.X(),pt.Y()],At=[ft.X(),ft.Y()],yt=[At[0]-mt[0],At[1]-mt[1]],bt=Math.sqrt(yt[0]*yt[0]*ot*ot+yt[1]*yt[1]*ct*ct),xt=ut.headWidth*ut.strokeWidth/bt,vt=ut.headLength*ut.strokeWidth/bt,_t=[At[0]-vt*yt[0],At[1]-vt*yt[1]],Ct=[xt/2*ot*yt[0],xt/2*ct*yt[1]],St=[_t[0]+Ct[1]/ot,_t[1]-Ct[0]/ct],Et=[_t[0]-Ct[1]/ot,_t[1]+Ct[0]/ct],Tt=ut.indent,Mt=[(1-Tt)*_t[0]+Tt*At[0],(1-Tt)*_t[1]+Tt*At[1]],Rt=[NaN,mt[0],At[0],St[0],Mt[0],Et[0],At[0],NaN],It=[NaN,mt[1],At[1],St[1],Mt[1],Et[1],At[1],NaN],Ot=tt.create("curve",[Rt,It],{strokeWidth:2,strokeColor:gt,fillColor:gt,highlightStrokeColor:gt,highlightFillColor:gt,highlightStrokeWidth:2});st.push(Ot)},dt=()=>{for(var pt=0;pt<st.length;pt++)tt.removeObject(st[pt]);for(var pt=0;pt<at.length;pt++)tt.removeObject(at[pt]);for(var pt=0;pt<lt.length;pt++)tt.removeObject(lt[pt]);at=[],st=[],lt=[];for(var ft=_e.Value(),gt=rt.Value(),pt=0;pt<=ft;pt++){var vt=[-20+pt*5,20],mt=[-20+pt*5,20-gt*5],At=tt.create("point",vt,{name:"",size:0,color:"blue",fixed:!0}),yt=tt.create("point",mt,{name:"",size:0,color:"blue",fixed:!0});at.push(At),at.push(yt),lt.push(tt.create("segment",[At,yt],{strokeWidth:.5,strokeColor:"black"}))}for(var pt=0;pt<=gt;pt++){var vt=[-20,20-pt*5],mt=[-20+ft*5,20-pt*5],At=tt.create("point",vt,{name:"",size:0,color:"blue",fixed:!0}),yt=tt.create("point",mt,{name:"",size:0,color:"blue",fixed:!0});at.push(At),at.push(yt),lt.push(tt.create("segment",[At,yt],{strokeWidth:.5,strokeColor:"black"}))}for(var bt=[];ft!=0||gt!=0;){var xt=Math.floor(Math.random()*2);xt==0?ft==0?(bt.push("down"),gt-=1):(bt.push("right"),ft-=1):gt==0?(bt.push("right"),ft-=1):(bt.push("down"),gt-=1)}for(var vt=[it.X(),it.Y()],pt=0;pt<bt.length;pt++)if(bt[pt]=="right"){var _t=[vt[0]+5,vt[1]],At=tt.create("point",vt,{name:"",size:0,color:"blue",fixed:!0}),Ct=tt.create("point",_t,{name:"",size:0,color:"blue",fixed:!0});at.push(Ct),at.push(At),ht(At,Ct,"blue"),vt=_t}else{var _t=[vt[0],vt[1]-5],At=tt.create("point",vt,{name:"",size:0,color:"blue",fixed:!0}),Ct=tt.create("point",_t,{name:"",size:0,color:"blue",fixed:!0});at.push(Ct),at.push(At),ht(At,Ct,"red"),vt=_t}};dt(),_e.on("drag",function(){nt!=null&&tt.removeObject(nt),nt=tt.create("point",[-20+_e.Value()*5,20-rt.Value()*5],{name:"Q",size:4,color:"green",strokeColor:"black",strokeWidth:1,fixed:!0}),dt()}),rt.on("drag",function(){nt!=null&&tt.removeObject(nt),nt=tt.create("point",[-20+_e.Value()*5,20-rt.Value()*5],{name:"Q",size:4,color:"green",strokeColor:"black",strokeWidth:1,fixed:!0}),dt()}),tt.resizeContainer(600,600),tt.unsuspendUpdate()};class JSXGraphComponent extends reactExports.Component{render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h2",{children:"최단 거리로 가는 경우의 수와 파스칼의 삼각형"})}),jsxRuntimeExports.jsx(JXGBoard,{logic:logicJS,boardAttributes:{boundingBox:[-15,15,15,-15],axis:!1,zoomX:.5,zoomY:.5},style:{border:"1px solid black"}})]})}}const path=new CatmullRomCurve3([new Vector3(0,0,0),new Vector3(1,1,0),new Vector3(2,0,0)]);new BoxGeometry,new SphereGeometry(.785398),new DodecahedronGeometry(.785398),new TubeGeometry(path,64,.1,8,!1);function toTrianglesDrawMode(tt,_e){if(_e===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),tt;if(_e===TriangleFanDrawMode||_e===TriangleStripDrawMode){let rt=tt.getIndex();if(rt===null){const at=[],lt=tt.getAttribute("position");if(lt!==void 0){for(let ot=0;ot<lt.count;ot++)at.push(ot);tt.setIndex(at),rt=tt.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),tt}const it=rt.count-2,nt=[];if(_e===TriangleFanDrawMode)for(let at=1;at<=it;at++)nt.push(rt.getX(0)),nt.push(rt.getX(at)),nt.push(rt.getX(at+1));else for(let at=0;at<it;at++)at%2===0?(nt.push(rt.getX(at)),nt.push(rt.getX(at+1)),nt.push(rt.getX(at+2))):(nt.push(rt.getX(at+2)),nt.push(rt.getX(at+1)),nt.push(rt.getX(at)));nt.length/3!==it&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const st=tt.clone();return st.setIndex(nt),st.clearGroups(),st}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_e),tt}class GLTFLoader extends Loader{constructor(_e){super(_e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(rt){return new GLTFMaterialsClearcoatExtension(rt)}),this.register(function(rt){return new GLTFTextureBasisUExtension(rt)}),this.register(function(rt){return new GLTFTextureWebPExtension(rt)}),this.register(function(rt){return new GLTFTextureAVIFExtension(rt)}),this.register(function(rt){return new GLTFMaterialsSheenExtension(rt)}),this.register(function(rt){return new GLTFMaterialsTransmissionExtension(rt)}),this.register(function(rt){return new GLTFMaterialsVolumeExtension(rt)}),this.register(function(rt){return new GLTFMaterialsIorExtension(rt)}),this.register(function(rt){return new GLTFMaterialsEmissiveStrengthExtension(rt)}),this.register(function(rt){return new GLTFMaterialsSpecularExtension(rt)}),this.register(function(rt){return new GLTFMaterialsIridescenceExtension(rt)}),this.register(function(rt){return new GLTFMaterialsAnisotropyExtension(rt)}),this.register(function(rt){return new GLTFLightsExtension(rt)}),this.register(function(rt){return new GLTFMeshoptCompression(rt)}),this.register(function(rt){return new GLTFMeshGpuInstancing(rt)})}load(_e,rt,it,nt){const st=this;let at;this.resourcePath!==""?at=this.resourcePath:this.path!==""?at=this.path:at=LoaderUtils.extractUrlBase(_e),this.manager.itemStart(_e);const lt=function(ct){nt?nt(ct):console.error(ct),st.manager.itemError(_e),st.manager.itemEnd(_e)},ot=new FileLoader(this.manager);ot.setPath(this.path),ot.setResponseType("arraybuffer"),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(this.withCredentials),ot.load(_e,function(ct){try{st.parse(ct,at,function(ut){rt(ut),st.manager.itemEnd(_e)},lt)}catch(ut){lt(ut)}},it,lt)}setDRACOLoader(_e){return this.dracoLoader=_e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_e){return this.ktx2Loader=_e,this}setMeshoptDecoder(_e){return this.meshoptDecoder=_e,this}register(_e){return this.pluginCallbacks.indexOf(_e)===-1&&this.pluginCallbacks.push(_e),this}unregister(_e){return this.pluginCallbacks.indexOf(_e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_e),1),this}parse(_e,rt,it,nt){let st;const at={},lt={},ot=new TextDecoder;if(typeof _e=="string")st=JSON.parse(_e);else if(_e instanceof ArrayBuffer)if(ot.decode(new Uint8Array(_e,0,4))===BINARY_EXTENSION_HEADER_MAGIC){try{at[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(_e)}catch(ht){nt&&nt(ht);return}st=JSON.parse(at[EXTENSIONS.KHR_BINARY_GLTF].content)}else st=JSON.parse(ot.decode(_e));else st=_e;if(st.asset===void 0||st.asset.version[0]<2){nt&&nt(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const ct=new GLTFParser(st,{path:rt||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ct.fileLoader.setRequestHeader(this.requestHeader);for(let ut=0;ut<this.pluginCallbacks.length;ut++){const ht=this.pluginCallbacks[ut](ct);lt[ht.name]=ht,at[ht.name]=!0}if(st.extensionsUsed)for(let ut=0;ut<st.extensionsUsed.length;++ut){const ht=st.extensionsUsed[ut],dt=st.extensionsRequired||[];switch(ht){case EXTENSIONS.KHR_MATERIALS_UNLIT:at[ht]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:at[ht]=new GLTFDracoMeshCompressionExtension(st,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:at[ht]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:at[ht]=new GLTFMeshQuantizationExtension;break;default:dt.indexOf(ht)>=0&&lt[ht]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ht+'".')}}ct.setExtensions(at),ct.setPlugins(lt),ct.parse(it,nt)}parseAsync(_e,rt){const it=this;return new Promise(function(nt,st){it.parse(_e,rt,nt,st)})}}function GLTFRegistry(){let tt={};return{get:function(_e){return tt[_e]},add:function(_e,rt){tt[_e]=rt},remove:function(_e){delete tt[_e]},removeAll:function(){tt={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _e=this.parser,rt=this.parser.json.nodes||[];for(let it=0,nt=rt.length;it<nt;it++){const st=rt[it];st.extensions&&st.extensions[this.name]&&st.extensions[this.name].light!==void 0&&_e._addNodeRef(this.cache,st.extensions[this.name].light)}}_loadLight(_e){const rt=this.parser,it="light:"+_e;let nt=rt.cache.get(it);if(nt)return nt;const st=rt.json,ot=((st.extensions&&st.extensions[this.name]||{}).lights||[])[_e];let ct;const ut=new Color$1(16777215);ot.color!==void 0&&ut.fromArray(ot.color);const ht=ot.range!==void 0?ot.range:0;switch(ot.type){case"directional":ct=new DirectionalLight(ut),ct.target.position.set(0,0,-1),ct.add(ct.target);break;case"point":ct=new PointLight(ut),ct.distance=ht;break;case"spot":ct=new SpotLight(ut),ct.distance=ht,ot.spot=ot.spot||{},ot.spot.innerConeAngle=ot.spot.innerConeAngle!==void 0?ot.spot.innerConeAngle:0,ot.spot.outerConeAngle=ot.spot.outerConeAngle!==void 0?ot.spot.outerConeAngle:Math.PI/4,ct.angle=ot.spot.outerConeAngle,ct.penumbra=1-ot.spot.innerConeAngle/ot.spot.outerConeAngle,ct.target.position.set(0,0,-1),ct.add(ct.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+ot.type)}return ct.position.set(0,0,0),ct.decay=2,assignExtrasToUserData(ct,ot),ot.intensity!==void 0&&(ct.intensity=ot.intensity),ct.name=rt.createUniqueName(ot.name||"light_"+_e),nt=Promise.resolve(ct),rt.cache.add(it,nt),nt}getDependency(_e,rt){if(_e==="light")return this._loadLight(rt)}createNodeAttachment(_e){const rt=this,it=this.parser,st=it.json.nodes[_e],lt=(st.extensions&&st.extensions[this.name]||{}).light;return lt===void 0?null:this._loadLight(lt).then(function(ot){return it._getNodeRef(rt.cache,lt,ot)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_e,rt,it){const nt=[];_e.color=new Color$1(1,1,1),_e.opacity=1;const st=rt.pbrMetallicRoughness;if(st){if(Array.isArray(st.baseColorFactor)){const at=st.baseColorFactor;_e.color.fromArray(at),_e.opacity=at[3]}st.baseColorTexture!==void 0&&nt.push(it.assignTexture(_e,"map",st.baseColorTexture,SRGBColorSpace))}return Promise.all(nt)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_e,rt){const nt=this.parser.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=nt.extensions[this.name].emissiveStrength;return st!==void 0&&(rt.emissiveIntensity=st),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];if(at.clearcoatFactor!==void 0&&(rt.clearcoat=at.clearcoatFactor),at.clearcoatTexture!==void 0&&st.push(it.assignTexture(rt,"clearcoatMap",at.clearcoatTexture)),at.clearcoatRoughnessFactor!==void 0&&(rt.clearcoatRoughness=at.clearcoatRoughnessFactor),at.clearcoatRoughnessTexture!==void 0&&st.push(it.assignTexture(rt,"clearcoatRoughnessMap",at.clearcoatRoughnessTexture)),at.clearcoatNormalTexture!==void 0&&(st.push(it.assignTexture(rt,"clearcoatNormalMap",at.clearcoatNormalTexture)),at.clearcoatNormalTexture.scale!==void 0)){const lt=at.clearcoatNormalTexture.scale;rt.clearcoatNormalScale=new Vector2(lt,lt)}return Promise.all(st)}}class GLTFMaterialsIridescenceExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];return at.iridescenceFactor!==void 0&&(rt.iridescence=at.iridescenceFactor),at.iridescenceTexture!==void 0&&st.push(it.assignTexture(rt,"iridescenceMap",at.iridescenceTexture)),at.iridescenceIor!==void 0&&(rt.iridescenceIOR=at.iridescenceIor),rt.iridescenceThicknessRange===void 0&&(rt.iridescenceThicknessRange=[100,400]),at.iridescenceThicknessMinimum!==void 0&&(rt.iridescenceThicknessRange[0]=at.iridescenceThicknessMinimum),at.iridescenceThicknessMaximum!==void 0&&(rt.iridescenceThicknessRange[1]=at.iridescenceThicknessMaximum),at.iridescenceThicknessTexture!==void 0&&st.push(it.assignTexture(rt,"iridescenceThicknessMap",at.iridescenceThicknessTexture)),Promise.all(st)}}class GLTFMaterialsSheenExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[];rt.sheenColor=new Color$1(0,0,0),rt.sheenRoughness=0,rt.sheen=1;const at=nt.extensions[this.name];return at.sheenColorFactor!==void 0&&rt.sheenColor.fromArray(at.sheenColorFactor),at.sheenRoughnessFactor!==void 0&&(rt.sheenRoughness=at.sheenRoughnessFactor),at.sheenColorTexture!==void 0&&st.push(it.assignTexture(rt,"sheenColorMap",at.sheenColorTexture,SRGBColorSpace)),at.sheenRoughnessTexture!==void 0&&st.push(it.assignTexture(rt,"sheenRoughnessMap",at.sheenRoughnessTexture)),Promise.all(st)}}class GLTFMaterialsTransmissionExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];return at.transmissionFactor!==void 0&&(rt.transmission=at.transmissionFactor),at.transmissionTexture!==void 0&&st.push(it.assignTexture(rt,"transmissionMap",at.transmissionTexture)),Promise.all(st)}}class GLTFMaterialsVolumeExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];rt.thickness=at.thicknessFactor!==void 0?at.thicknessFactor:0,at.thicknessTexture!==void 0&&st.push(it.assignTexture(rt,"thicknessMap",at.thicknessTexture)),rt.attenuationDistance=at.attenuationDistance||1/0;const lt=at.attenuationColor||[1,1,1];return rt.attenuationColor=new Color$1(lt[0],lt[1],lt[2]),Promise.all(st)}}class GLTFMaterialsIorExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const nt=this.parser.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=nt.extensions[this.name];return rt.ior=st.ior!==void 0?st.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];rt.specularIntensity=at.specularFactor!==void 0?at.specularFactor:1,at.specularTexture!==void 0&&st.push(it.assignTexture(rt,"specularIntensityMap",at.specularTexture));const lt=at.specularColorFactor||[1,1,1];return rt.specularColor=new Color$1(lt[0],lt[1],lt[2]),at.specularColorTexture!==void 0&&st.push(it.assignTexture(rt,"specularColorMap",at.specularColorTexture,SRGBColorSpace)),Promise.all(st)}}class GLTFMaterialsAnisotropyExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(_e){const it=this.parser.json.materials[_e];return!it.extensions||!it.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_e,rt){const it=this.parser,nt=it.json.materials[_e];if(!nt.extensions||!nt.extensions[this.name])return Promise.resolve();const st=[],at=nt.extensions[this.name];return at.anisotropyStrength!==void 0&&(rt.anisotropy=at.anisotropyStrength),at.anisotropyRotation!==void 0&&(rt.anisotropyRotation=at.anisotropyRotation),at.anisotropyTexture!==void 0&&st.push(it.assignTexture(rt,"anisotropyMap",at.anisotropyTexture)),Promise.all(st)}}class GLTFTextureBasisUExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(_e){const rt=this.parser,it=rt.json,nt=it.textures[_e];if(!nt.extensions||!nt.extensions[this.name])return null;const st=nt.extensions[this.name],at=rt.options.ktx2Loader;if(!at){if(it.extensionsRequired&&it.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return rt.loadTextureImage(_e,st.source,at)}}class GLTFTextureWebPExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_e){const rt=this.name,it=this.parser,nt=it.json,st=nt.textures[_e];if(!st.extensions||!st.extensions[rt])return null;const at=st.extensions[rt],lt=nt.images[at.source];let ot=it.textureLoader;if(lt.uri){const ct=it.options.manager.getHandler(lt.uri);ct!==null&&(ot=ct)}return this.detectSupport().then(function(ct){if(ct)return it.loadTextureImage(_e,at.source,ot);if(nt.extensionsRequired&&nt.extensionsRequired.indexOf(rt)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return it.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const rt=new Image;rt.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",rt.onload=rt.onerror=function(){_e(rt.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(_e){this.parser=_e,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_e){const rt=this.name,it=this.parser,nt=it.json,st=nt.textures[_e];if(!st.extensions||!st.extensions[rt])return null;const at=st.extensions[rt],lt=nt.images[at.source];let ot=it.textureLoader;if(lt.uri){const ct=it.options.manager.getHandler(lt.uri);ct!==null&&(ot=ct)}return this.detectSupport().then(function(ct){if(ct)return it.loadTextureImage(_e,at.source,ot);if(nt.extensionsRequired&&nt.extensionsRequired.indexOf(rt)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return it.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const rt=new Image;rt.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",rt.onload=rt.onerror=function(){_e(rt.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(_e){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=_e}loadBufferView(_e){const rt=this.parser.json,it=rt.bufferViews[_e];if(it.extensions&&it.extensions[this.name]){const nt=it.extensions[this.name],st=this.parser.getDependency("buffer",nt.buffer),at=this.parser.options.meshoptDecoder;if(!at||!at.supported){if(rt.extensionsRequired&&rt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return st.then(function(lt){const ot=nt.byteOffset||0,ct=nt.byteLength||0,ut=nt.count,ht=nt.byteStride,dt=new Uint8Array(lt,ot,ct);return at.decodeGltfBufferAsync?at.decodeGltfBufferAsync(ut,ht,dt,nt.mode,nt.filter).then(function(pt){return pt.buffer}):at.ready.then(function(){const pt=new ArrayBuffer(ut*ht);return at.decodeGltfBuffer(new Uint8Array(pt),ut,ht,dt,nt.mode,nt.filter),pt})})}else return null}}class GLTFMeshGpuInstancing{constructor(_e){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=_e}createNodeMesh(_e){const rt=this.parser.json,it=rt.nodes[_e];if(!it.extensions||!it.extensions[this.name]||it.mesh===void 0)return null;const nt=rt.meshes[it.mesh];for(const ct of nt.primitives)if(ct.mode!==WEBGL_CONSTANTS.TRIANGLES&&ct.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&ct.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&ct.mode!==void 0)return null;const at=it.extensions[this.name].attributes,lt=[],ot={};for(const ct in at)lt.push(this.parser.getDependency("accessor",at[ct]).then(ut=>(ot[ct]=ut,ot[ct])));return lt.length<1?null:(lt.push(this.parser.createNodeMesh(_e)),Promise.all(lt).then(ct=>{const ut=ct.pop(),ht=ut.isGroup?ut.children:[ut],dt=ct[0].count,pt=[];for(const ft of ht){const gt=new Matrix4,mt=new Vector3,At=new Quaternion,yt=new Vector3(1,1,1),bt=new InstancedMesh(ft.geometry,ft.material,dt);for(let xt=0;xt<dt;xt++)ot.TRANSLATION&&mt.fromBufferAttribute(ot.TRANSLATION,xt),ot.ROTATION&&At.fromBufferAttribute(ot.ROTATION,xt),ot.SCALE&&yt.fromBufferAttribute(ot.SCALE,xt),bt.setMatrixAt(xt,gt.compose(mt,At,yt));for(const xt in ot)xt!=="TRANSLATION"&&xt!=="ROTATION"&&xt!=="SCALE"&&ft.geometry.setAttribute(xt,ot[xt]);Object3D.prototype.copy.call(bt,ft),this.parser.assignFinalMaterial(bt),pt.push(bt)}return ut.isGroup?(ut.clear(),ut.add(...pt),ut):pt[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(_e){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const rt=new DataView(_e,0,BINARY_EXTENSION_HEADER_LENGTH),it=new TextDecoder;if(this.header={magic:it.decode(new Uint8Array(_e.slice(0,4))),version:rt.getUint32(4,!0),length:rt.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const nt=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,st=new DataView(_e,BINARY_EXTENSION_HEADER_LENGTH);let at=0;for(;at<nt;){const lt=st.getUint32(at,!0);at+=4;const ot=st.getUint32(at,!0);if(at+=4,ot===BINARY_EXTENSION_CHUNK_TYPES.JSON){const ct=new Uint8Array(_e,BINARY_EXTENSION_HEADER_LENGTH+at,lt);this.content=it.decode(ct)}else if(ot===BINARY_EXTENSION_CHUNK_TYPES.BIN){const ct=BINARY_EXTENSION_HEADER_LENGTH+at;this.body=_e.slice(ct,ct+lt)}at+=lt}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(_e,rt){if(!rt)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=_e,this.dracoLoader=rt,this.dracoLoader.preload()}decodePrimitive(_e,rt){const it=this.json,nt=this.dracoLoader,st=_e.extensions[this.name].bufferView,at=_e.extensions[this.name].attributes,lt={},ot={},ct={};for(const ut in at){const ht=ATTRIBUTES[ut]||ut.toLowerCase();lt[ht]=at[ut]}for(const ut in _e.attributes){const ht=ATTRIBUTES[ut]||ut.toLowerCase();if(at[ut]!==void 0){const dt=it.accessors[_e.attributes[ut]],pt=WEBGL_COMPONENT_TYPES[dt.componentType];ct[ht]=pt.name,ot[ht]=dt.normalized===!0}}return rt.getDependency("bufferView",st).then(function(ut){return new Promise(function(ht){nt.decodeDracoFile(ut,function(dt){for(const pt in dt.attributes){const ft=dt.attributes[pt],gt=ot[pt];gt!==void 0&&(ft.normalized=gt)}ht(dt)},lt,ct)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(_e,rt){return(rt.texCoord===void 0||rt.texCoord===_e.channel)&&rt.offset===void 0&&rt.rotation===void 0&&rt.scale===void 0||(_e=_e.clone(),rt.texCoord!==void 0&&(_e.channel=rt.texCoord),rt.offset!==void 0&&_e.offset.fromArray(rt.offset),rt.rotation!==void 0&&(_e.rotation=rt.rotation),rt.scale!==void 0&&_e.repeat.fromArray(rt.scale),_e.needsUpdate=!0),_e}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(_e,rt,it,nt){super(_e,rt,it,nt)}copySampleValue_(_e){const rt=this.resultBuffer,it=this.sampleValues,nt=this.valueSize,st=_e*nt*3+nt;for(let at=0;at!==nt;at++)rt[at]=it[st+at];return rt}interpolate_(_e,rt,it,nt){const st=this.resultBuffer,at=this.sampleValues,lt=this.valueSize,ot=lt*2,ct=lt*3,ut=nt-rt,ht=(it-rt)/ut,dt=ht*ht,pt=dt*ht,ft=_e*ct,gt=ft-ct,mt=-2*pt+3*dt,At=pt-dt,yt=1-mt,bt=At-dt+ht;for(let xt=0;xt!==lt;xt++){const vt=at[gt+xt+lt],_t=at[gt+xt+ot]*ut,Ct=at[ft+xt+lt],St=at[ft+xt]*ut;st[xt]=yt*vt+bt*_t+mt*Ct+At*St}return st}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(_e,rt,it,nt){const st=super.interpolate_(_e,rt,it,nt);return _q.fromArray(st).normalize().toArray(st),st}}const WEBGL_CONSTANTS={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(tt){return tt.DefaultMaterial===void 0&&(tt.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),tt.DefaultMaterial}function addUnknownExtensionsToUserData(tt,_e,rt){for(const it in rt.extensions)tt[it]===void 0&&(_e.userData.gltfExtensions=_e.userData.gltfExtensions||{},_e.userData.gltfExtensions[it]=rt.extensions[it])}function assignExtrasToUserData(tt,_e){_e.extras!==void 0&&(typeof _e.extras=="object"?Object.assign(tt.userData,_e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_e.extras))}function addMorphTargets(tt,_e,rt){let it=!1,nt=!1,st=!1;for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(ht.POSITION!==void 0&&(it=!0),ht.NORMAL!==void 0&&(nt=!0),ht.COLOR_0!==void 0&&(st=!0),it&&nt&&st)break}if(!it&&!nt&&!st)return Promise.resolve(tt);const at=[],lt=[],ot=[];for(let ct=0,ut=_e.length;ct<ut;ct++){const ht=_e[ct];if(it){const dt=ht.POSITION!==void 0?rt.getDependency("accessor",ht.POSITION):tt.attributes.position;at.push(dt)}if(nt){const dt=ht.NORMAL!==void 0?rt.getDependency("accessor",ht.NORMAL):tt.attributes.normal;lt.push(dt)}if(st){const dt=ht.COLOR_0!==void 0?rt.getDependency("accessor",ht.COLOR_0):tt.attributes.color;ot.push(dt)}}return Promise.all([Promise.all(at),Promise.all(lt),Promise.all(ot)]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];return it&&(tt.morphAttributes.position=ut),nt&&(tt.morphAttributes.normal=ht),st&&(tt.morphAttributes.color=dt),tt.morphTargetsRelative=!0,tt})}function updateMorphTargets(tt,_e){if(tt.updateMorphTargets(),_e.weights!==void 0)for(let rt=0,it=_e.weights.length;rt<it;rt++)tt.morphTargetInfluences[rt]=_e.weights[rt];if(_e.extras&&Array.isArray(_e.extras.targetNames)){const rt=_e.extras.targetNames;if(tt.morphTargetInfluences.length===rt.length){tt.morphTargetDictionary={};for(let it=0,nt=rt.length;it<nt;it++)tt.morphTargetDictionary[rt[it]]=it}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(tt){let _e;const rt=tt.extensions&&tt.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(rt?_e="draco:"+rt.bufferView+":"+rt.indices+":"+createAttributesKey(rt.attributes):_e=tt.indices+":"+createAttributesKey(tt.attributes)+":"+tt.mode,tt.targets!==void 0)for(let it=0,nt=tt.targets.length;it<nt;it++)_e+=":"+createAttributesKey(tt.targets[it]);return _e}function createAttributesKey(tt){let _e="";const rt=Object.keys(tt).sort();for(let it=0,nt=rt.length;it<nt;it++)_e+=rt[it]+":"+tt[rt[it]]+";";return _e}function getNormalizedComponentScale(tt){switch(tt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(tt){return tt.search(/\.jpe?g($|\?)/i)>0||tt.search(/^data\:image\/jpeg/)===0?"image/jpeg":tt.search(/\.webp($|\?)/i)>0||tt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(_e={},rt={}){this.json=_e,this.extensions={},this.plugins={},this.options=rt,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let it=!1,nt=!1,st=-1;typeof navigator<"u"&&(it=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,nt=navigator.userAgent.indexOf("Firefox")>-1,st=nt?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||it||nt&&st<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_e){this.extensions=_e}setPlugins(_e){this.plugins=_e}parse(_e,rt){const it=this,nt=this.json,st=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(at){return at._markDefs&&at._markDefs()}),Promise.all(this._invokeAll(function(at){return at.beforeRoot&&at.beforeRoot()})).then(function(){return Promise.all([it.getDependencies("scene"),it.getDependencies("animation"),it.getDependencies("camera")])}).then(function(at){const lt={scene:at[0][nt.scene||0],scenes:at[0],animations:at[1],cameras:at[2],asset:nt.asset,parser:it,userData:{}};addUnknownExtensionsToUserData(st,lt,nt),assignExtrasToUserData(lt,nt),Promise.all(it._invokeAll(function(ot){return ot.afterRoot&&ot.afterRoot(lt)})).then(function(){_e(lt)})}).catch(rt)}_markDefs(){const _e=this.json.nodes||[],rt=this.json.skins||[],it=this.json.meshes||[];for(let nt=0,st=rt.length;nt<st;nt++){const at=rt[nt].joints;for(let lt=0,ot=at.length;lt<ot;lt++)_e[at[lt]].isBone=!0}for(let nt=0,st=_e.length;nt<st;nt++){const at=_e[nt];at.mesh!==void 0&&(this._addNodeRef(this.meshCache,at.mesh),at.skin!==void 0&&(it[at.mesh].isSkinnedMesh=!0)),at.camera!==void 0&&this._addNodeRef(this.cameraCache,at.camera)}}_addNodeRef(_e,rt){rt!==void 0&&(_e.refs[rt]===void 0&&(_e.refs[rt]=_e.uses[rt]=0),_e.refs[rt]++)}_getNodeRef(_e,rt,it){if(_e.refs[rt]<=1)return it;const nt=it.clone(),st=(at,lt)=>{const ot=this.associations.get(at);ot!=null&&this.associations.set(lt,ot);for(const[ct,ut]of at.children.entries())st(ut,lt.children[ct])};return st(it,nt),nt.name+="_instance_"+_e.uses[rt]++,nt}_invokeOne(_e){const rt=Object.values(this.plugins);rt.push(this);for(let it=0;it<rt.length;it++){const nt=_e(rt[it]);if(nt)return nt}return null}_invokeAll(_e){const rt=Object.values(this.plugins);rt.unshift(this);const it=[];for(let nt=0;nt<rt.length;nt++){const st=_e(rt[nt]);st&&it.push(st)}return it}getDependency(_e,rt){const it=_e+":"+rt;let nt=this.cache.get(it);if(!nt){switch(_e){case"scene":nt=this.loadScene(rt);break;case"node":nt=this._invokeOne(function(st){return st.loadNode&&st.loadNode(rt)});break;case"mesh":nt=this._invokeOne(function(st){return st.loadMesh&&st.loadMesh(rt)});break;case"accessor":nt=this.loadAccessor(rt);break;case"bufferView":nt=this._invokeOne(function(st){return st.loadBufferView&&st.loadBufferView(rt)});break;case"buffer":nt=this.loadBuffer(rt);break;case"material":nt=this._invokeOne(function(st){return st.loadMaterial&&st.loadMaterial(rt)});break;case"texture":nt=this._invokeOne(function(st){return st.loadTexture&&st.loadTexture(rt)});break;case"skin":nt=this.loadSkin(rt);break;case"animation":nt=this._invokeOne(function(st){return st.loadAnimation&&st.loadAnimation(rt)});break;case"camera":nt=this.loadCamera(rt);break;default:if(nt=this._invokeOne(function(st){return st!=this&&st.getDependency&&st.getDependency(_e,rt)}),!nt)throw new Error("Unknown type: "+_e);break}this.cache.add(it,nt)}return nt}getDependencies(_e){let rt=this.cache.get(_e);if(!rt){const it=this,nt=this.json[_e+(_e==="mesh"?"es":"s")]||[];rt=Promise.all(nt.map(function(st,at){return it.getDependency(_e,at)})),this.cache.add(_e,rt)}return rt}loadBuffer(_e){const rt=this.json.buffers[_e],it=this.fileLoader;if(rt.type&&rt.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+rt.type+" buffer type is not supported.");if(rt.uri===void 0&&_e===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const nt=this.options;return new Promise(function(st,at){it.load(LoaderUtils.resolveURL(rt.uri,nt.path),st,void 0,function(){at(new Error('THREE.GLTFLoader: Failed to load buffer "'+rt.uri+'".'))})})}loadBufferView(_e){const rt=this.json.bufferViews[_e];return this.getDependency("buffer",rt.buffer).then(function(it){const nt=rt.byteLength||0,st=rt.byteOffset||0;return it.slice(st,st+nt)})}loadAccessor(_e){const rt=this,it=this.json,nt=this.json.accessors[_e];if(nt.bufferView===void 0&&nt.sparse===void 0){const at=WEBGL_TYPE_SIZES[nt.type],lt=WEBGL_COMPONENT_TYPES[nt.componentType],ot=nt.normalized===!0,ct=new lt(nt.count*at);return Promise.resolve(new BufferAttribute(ct,at,ot))}const st=[];return nt.bufferView!==void 0?st.push(this.getDependency("bufferView",nt.bufferView)):st.push(null),nt.sparse!==void 0&&(st.push(this.getDependency("bufferView",nt.sparse.indices.bufferView)),st.push(this.getDependency("bufferView",nt.sparse.values.bufferView))),Promise.all(st).then(function(at){const lt=at[0],ot=WEBGL_TYPE_SIZES[nt.type],ct=WEBGL_COMPONENT_TYPES[nt.componentType],ut=ct.BYTES_PER_ELEMENT,ht=ut*ot,dt=nt.byteOffset||0,pt=nt.bufferView!==void 0?it.bufferViews[nt.bufferView].byteStride:void 0,ft=nt.normalized===!0;let gt,mt;if(pt&&pt!==ht){const At=Math.floor(dt/pt),yt="InterleavedBuffer:"+nt.bufferView+":"+nt.componentType+":"+At+":"+nt.count;let bt=rt.cache.get(yt);bt||(gt=new ct(lt,At*pt,nt.count*pt/ut),bt=new InterleavedBuffer(gt,pt/ut),rt.cache.add(yt,bt)),mt=new InterleavedBufferAttribute(bt,ot,dt%pt/ut,ft)}else lt===null?gt=new ct(nt.count*ot):gt=new ct(lt,dt,nt.count*ot),mt=new BufferAttribute(gt,ot,ft);if(nt.sparse!==void 0){const At=WEBGL_TYPE_SIZES.SCALAR,yt=WEBGL_COMPONENT_TYPES[nt.sparse.indices.componentType],bt=nt.sparse.indices.byteOffset||0,xt=nt.sparse.values.byteOffset||0,vt=new yt(at[1],bt,nt.sparse.count*At),_t=new ct(at[2],xt,nt.sparse.count*ot);lt!==null&&(mt=new BufferAttribute(mt.array.slice(),mt.itemSize,mt.normalized));for(let Ct=0,St=vt.length;Ct<St;Ct++){const Et=vt[Ct];if(mt.setX(Et,_t[Ct*ot]),ot>=2&&mt.setY(Et,_t[Ct*ot+1]),ot>=3&&mt.setZ(Et,_t[Ct*ot+2]),ot>=4&&mt.setW(Et,_t[Ct*ot+3]),ot>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return mt})}loadTexture(_e){const rt=this.json,it=this.options,st=rt.textures[_e].source,at=rt.images[st];let lt=this.textureLoader;if(at.uri){const ot=it.manager.getHandler(at.uri);ot!==null&&(lt=ot)}return this.loadTextureImage(_e,st,lt)}loadTextureImage(_e,rt,it){const nt=this,st=this.json,at=st.textures[_e],lt=st.images[rt],ot=(lt.uri||lt.bufferView)+":"+at.sampler;if(this.textureCache[ot])return this.textureCache[ot];const ct=this.loadImageSource(rt,it).then(function(ut){ut.flipY=!1,ut.name=at.name||lt.name||"",ut.name===""&&typeof lt.uri=="string"&&lt.uri.startsWith("data:image/")===!1&&(ut.name=lt.uri);const dt=(st.samplers||{})[at.sampler]||{};return ut.magFilter=WEBGL_FILTERS[dt.magFilter]||LinearFilter,ut.minFilter=WEBGL_FILTERS[dt.minFilter]||LinearMipmapLinearFilter,ut.wrapS=WEBGL_WRAPPINGS[dt.wrapS]||RepeatWrapping,ut.wrapT=WEBGL_WRAPPINGS[dt.wrapT]||RepeatWrapping,nt.associations.set(ut,{textures:_e}),ut}).catch(function(){return null});return this.textureCache[ot]=ct,ct}loadImageSource(_e,rt){const it=this,nt=this.json,st=this.options;if(this.sourceCache[_e]!==void 0)return this.sourceCache[_e].then(ht=>ht.clone());const at=nt.images[_e],lt=self.URL||self.webkitURL;let ot=at.uri||"",ct=!1;if(at.bufferView!==void 0)ot=it.getDependency("bufferView",at.bufferView).then(function(ht){ct=!0;const dt=new Blob([ht],{type:at.mimeType});return ot=lt.createObjectURL(dt),ot});else if(at.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_e+" is missing URI and bufferView");const ut=Promise.resolve(ot).then(function(ht){return new Promise(function(dt,pt){let ft=dt;rt.isImageBitmapLoader===!0&&(ft=function(gt){const mt=new Texture(gt);mt.needsUpdate=!0,dt(mt)}),rt.load(LoaderUtils.resolveURL(ht,st.path),ft,void 0,pt)})}).then(function(ht){return ct===!0&&lt.revokeObjectURL(ot),ht.userData.mimeType=at.mimeType||getImageURIMimeType(at.uri),ht}).catch(function(ht){throw console.error("THREE.GLTFLoader: Couldn't load texture",ot),ht});return this.sourceCache[_e]=ut,ut}assignTexture(_e,rt,it,nt){const st=this;return this.getDependency("texture",it.index).then(function(at){if(!at)return null;if(it.texCoord!==void 0&&it.texCoord>0&&(at=at.clone(),at.channel=it.texCoord),st.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const lt=it.extensions!==void 0?it.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(lt){const ot=st.associations.get(at);at=st.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(at,lt),st.associations.set(at,ot)}}return nt!==void 0&&(at.colorSpace=nt),_e[rt]=at,at})}assignFinalMaterial(_e){const rt=_e.geometry;let it=_e.material;const nt=rt.attributes.tangent===void 0,st=rt.attributes.color!==void 0,at=rt.attributes.normal===void 0;if(_e.isPoints){const lt="PointsMaterial:"+it.uuid;let ot=this.cache.get(lt);ot||(ot=new PointsMaterial,Material.prototype.copy.call(ot,it),ot.color.copy(it.color),ot.map=it.map,ot.sizeAttenuation=!1,this.cache.add(lt,ot)),it=ot}else if(_e.isLine){const lt="LineBasicMaterial:"+it.uuid;let ot=this.cache.get(lt);ot||(ot=new LineBasicMaterial,Material.prototype.copy.call(ot,it),ot.color.copy(it.color),ot.map=it.map,this.cache.add(lt,ot)),it=ot}if(nt||st||at){let lt="ClonedMaterial:"+it.uuid+":";nt&&(lt+="derivative-tangents:"),st&&(lt+="vertex-colors:"),at&&(lt+="flat-shading:");let ot=this.cache.get(lt);ot||(ot=it.clone(),st&&(ot.vertexColors=!0),at&&(ot.flatShading=!0),nt&&(ot.normalScale&&(ot.normalScale.y*=-1),ot.clearcoatNormalScale&&(ot.clearcoatNormalScale.y*=-1)),this.cache.add(lt,ot),this.associations.set(ot,this.associations.get(it))),it=ot}_e.material=it}getMaterialType(){return MeshStandardMaterial}loadMaterial(_e){const rt=this,it=this.json,nt=this.extensions,st=it.materials[_e];let at;const lt={},ot=st.extensions||{},ct=[];if(ot[EXTENSIONS.KHR_MATERIALS_UNLIT]){const ht=nt[EXTENSIONS.KHR_MATERIALS_UNLIT];at=ht.getMaterialType(),ct.push(ht.extendParams(lt,st,rt))}else{const ht=st.pbrMetallicRoughness||{};if(lt.color=new Color$1(1,1,1),lt.opacity=1,Array.isArray(ht.baseColorFactor)){const dt=ht.baseColorFactor;lt.color.fromArray(dt),lt.opacity=dt[3]}ht.baseColorTexture!==void 0&&ct.push(rt.assignTexture(lt,"map",ht.baseColorTexture,SRGBColorSpace)),lt.metalness=ht.metallicFactor!==void 0?ht.metallicFactor:1,lt.roughness=ht.roughnessFactor!==void 0?ht.roughnessFactor:1,ht.metallicRoughnessTexture!==void 0&&(ct.push(rt.assignTexture(lt,"metalnessMap",ht.metallicRoughnessTexture)),ct.push(rt.assignTexture(lt,"roughnessMap",ht.metallicRoughnessTexture))),at=this._invokeOne(function(dt){return dt.getMaterialType&&dt.getMaterialType(_e)}),ct.push(Promise.all(this._invokeAll(function(dt){return dt.extendMaterialParams&&dt.extendMaterialParams(_e,lt)})))}st.doubleSided===!0&&(lt.side=DoubleSide);const ut=st.alphaMode||ALPHA_MODES.OPAQUE;if(ut===ALPHA_MODES.BLEND?(lt.transparent=!0,lt.depthWrite=!1):(lt.transparent=!1,ut===ALPHA_MODES.MASK&&(lt.alphaTest=st.alphaCutoff!==void 0?st.alphaCutoff:.5)),st.normalTexture!==void 0&&at!==MeshBasicMaterial&&(ct.push(rt.assignTexture(lt,"normalMap",st.normalTexture)),lt.normalScale=new Vector2(1,1),st.normalTexture.scale!==void 0)){const ht=st.normalTexture.scale;lt.normalScale.set(ht,ht)}return st.occlusionTexture!==void 0&&at!==MeshBasicMaterial&&(ct.push(rt.assignTexture(lt,"aoMap",st.occlusionTexture)),st.occlusionTexture.strength!==void 0&&(lt.aoMapIntensity=st.occlusionTexture.strength)),st.emissiveFactor!==void 0&&at!==MeshBasicMaterial&&(lt.emissive=new Color$1().fromArray(st.emissiveFactor)),st.emissiveTexture!==void 0&&at!==MeshBasicMaterial&&ct.push(rt.assignTexture(lt,"emissiveMap",st.emissiveTexture,SRGBColorSpace)),Promise.all(ct).then(function(){const ht=new at(lt);return st.name&&(ht.name=st.name),assignExtrasToUserData(ht,st),rt.associations.set(ht,{materials:_e}),st.extensions&&addUnknownExtensionsToUserData(nt,ht,st),ht})}createUniqueName(_e){const rt=PropertyBinding.sanitizeNodeName(_e||"");return rt in this.nodeNamesUsed?rt+"_"+ ++this.nodeNamesUsed[rt]:(this.nodeNamesUsed[rt]=0,rt)}loadGeometries(_e){const rt=this,it=this.extensions,nt=this.primitiveCache;function st(lt){return it[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(lt,rt).then(function(ot){return addPrimitiveAttributes(ot,lt,rt)})}const at=[];for(let lt=0,ot=_e.length;lt<ot;lt++){const ct=_e[lt],ut=createPrimitiveKey(ct),ht=nt[ut];if(ht)at.push(ht.promise);else{let dt;ct.extensions&&ct.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?dt=st(ct):dt=addPrimitiveAttributes(new BufferGeometry,ct,rt),nt[ut]={primitive:ct,promise:dt},at.push(dt)}}return Promise.all(at)}loadMesh(_e){const rt=this,it=this.json,nt=this.extensions,st=it.meshes[_e],at=st.primitives,lt=[];for(let ot=0,ct=at.length;ot<ct;ot++){const ut=at[ot].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",at[ot].material);lt.push(ut)}return lt.push(rt.loadGeometries(at)),Promise.all(lt).then(function(ot){const ct=ot.slice(0,ot.length-1),ut=ot[ot.length-1],ht=[];for(let pt=0,ft=ut.length;pt<ft;pt++){const gt=ut[pt],mt=at[pt];let At;const yt=ct[pt];if(mt.mode===WEBGL_CONSTANTS.TRIANGLES||mt.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||mt.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||mt.mode===void 0)At=st.isSkinnedMesh===!0?new SkinnedMesh(gt,yt):new Mesh(gt,yt),At.isSkinnedMesh===!0&&At.normalizeSkinWeights(),mt.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?At.geometry=toTrianglesDrawMode(At.geometry,TriangleStripDrawMode):mt.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(At.geometry=toTrianglesDrawMode(At.geometry,TriangleFanDrawMode));else if(mt.mode===WEBGL_CONSTANTS.LINES)At=new LineSegments(gt,yt);else if(mt.mode===WEBGL_CONSTANTS.LINE_STRIP)At=new Line(gt,yt);else if(mt.mode===WEBGL_CONSTANTS.LINE_LOOP)At=new LineLoop(gt,yt);else if(mt.mode===WEBGL_CONSTANTS.POINTS)At=new Points(gt,yt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+mt.mode);Object.keys(At.geometry.morphAttributes).length>0&&updateMorphTargets(At,st),At.name=rt.createUniqueName(st.name||"mesh_"+_e),assignExtrasToUserData(At,st),mt.extensions&&addUnknownExtensionsToUserData(nt,At,mt),rt.assignFinalMaterial(At),ht.push(At)}for(let pt=0,ft=ht.length;pt<ft;pt++)rt.associations.set(ht[pt],{meshes:_e,primitives:pt});if(ht.length===1)return st.extensions&&addUnknownExtensionsToUserData(nt,ht[0],st),ht[0];const dt=new Group;st.extensions&&addUnknownExtensionsToUserData(nt,dt,st),rt.associations.set(dt,{meshes:_e});for(let pt=0,ft=ht.length;pt<ft;pt++)dt.add(ht[pt]);return dt})}loadCamera(_e){let rt;const it=this.json.cameras[_e],nt=it[it.type];if(!nt){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return it.type==="perspective"?rt=new PerspectiveCamera(MathUtils.radToDeg(nt.yfov),nt.aspectRatio||1,nt.znear||1,nt.zfar||2e6):it.type==="orthographic"&&(rt=new OrthographicCamera(-nt.xmag,nt.xmag,nt.ymag,-nt.ymag,nt.znear,nt.zfar)),it.name&&(rt.name=this.createUniqueName(it.name)),assignExtrasToUserData(rt,it),Promise.resolve(rt)}loadSkin(_e){const rt=this.json.skins[_e],it=[];for(let nt=0,st=rt.joints.length;nt<st;nt++)it.push(this._loadNodeShallow(rt.joints[nt]));return rt.inverseBindMatrices!==void 0?it.push(this.getDependency("accessor",rt.inverseBindMatrices)):it.push(null),Promise.all(it).then(function(nt){const st=nt.pop(),at=nt,lt=[],ot=[];for(let ct=0,ut=at.length;ct<ut;ct++){const ht=at[ct];if(ht){lt.push(ht);const dt=new Matrix4;st!==null&&dt.fromArray(st.array,ct*16),ot.push(dt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',rt.joints[ct])}return new Skeleton(lt,ot)})}loadAnimation(_e){const rt=this.json,it=this,nt=rt.animations[_e],st=nt.name?nt.name:"animation_"+_e,at=[],lt=[],ot=[],ct=[],ut=[];for(let ht=0,dt=nt.channels.length;ht<dt;ht++){const pt=nt.channels[ht],ft=nt.samplers[pt.sampler],gt=pt.target,mt=gt.node,At=nt.parameters!==void 0?nt.parameters[ft.input]:ft.input,yt=nt.parameters!==void 0?nt.parameters[ft.output]:ft.output;gt.node!==void 0&&(at.push(this.getDependency("node",mt)),lt.push(this.getDependency("accessor",At)),ot.push(this.getDependency("accessor",yt)),ct.push(ft),ut.push(gt))}return Promise.all([Promise.all(at),Promise.all(lt),Promise.all(ot),Promise.all(ct),Promise.all(ut)]).then(function(ht){const dt=ht[0],pt=ht[1],ft=ht[2],gt=ht[3],mt=ht[4],At=[];for(let yt=0,bt=dt.length;yt<bt;yt++){const xt=dt[yt],vt=pt[yt],_t=ft[yt],Ct=gt[yt],St=mt[yt];if(xt===void 0)continue;xt.updateMatrix&&(xt.updateMatrix(),xt.matrixAutoUpdate=!0);const Et=it._createAnimationTracks(xt,vt,_t,Ct,St);if(Et)for(let Tt=0;Tt<Et.length;Tt++)At.push(Et[Tt])}return new AnimationClip(st,void 0,At)})}createNodeMesh(_e){const rt=this.json,it=this,nt=rt.nodes[_e];return nt.mesh===void 0?null:it.getDependency("mesh",nt.mesh).then(function(st){const at=it._getNodeRef(it.meshCache,nt.mesh,st);return nt.weights!==void 0&&at.traverse(function(lt){if(lt.isMesh)for(let ot=0,ct=nt.weights.length;ot<ct;ot++)lt.morphTargetInfluences[ot]=nt.weights[ot]}),at})}loadNode(_e){const rt=this.json,it=this,nt=rt.nodes[_e],st=it._loadNodeShallow(_e),at=[],lt=nt.children||[];for(let ct=0,ut=lt.length;ct<ut;ct++)at.push(it.getDependency("node",lt[ct]));const ot=nt.skin===void 0?Promise.resolve(null):it.getDependency("skin",nt.skin);return Promise.all([st,Promise.all(at),ot]).then(function(ct){const ut=ct[0],ht=ct[1],dt=ct[2];dt!==null&&ut.traverse(function(pt){pt.isSkinnedMesh&&pt.bind(dt,_identityMatrix)});for(let pt=0,ft=ht.length;pt<ft;pt++)ut.add(ht[pt]);return ut})}_loadNodeShallow(_e){const rt=this.json,it=this.extensions,nt=this;if(this.nodeCache[_e]!==void 0)return this.nodeCache[_e];const st=rt.nodes[_e],at=st.name?nt.createUniqueName(st.name):"",lt=[],ot=nt._invokeOne(function(ct){return ct.createNodeMesh&&ct.createNodeMesh(_e)});return ot&&lt.push(ot),st.camera!==void 0&&lt.push(nt.getDependency("camera",st.camera).then(function(ct){return nt._getNodeRef(nt.cameraCache,st.camera,ct)})),nt._invokeAll(function(ct){return ct.createNodeAttachment&&ct.createNodeAttachment(_e)}).forEach(function(ct){lt.push(ct)}),this.nodeCache[_e]=Promise.all(lt).then(function(ct){let ut;if(st.isBone===!0?ut=new Bone:ct.length>1?ut=new Group:ct.length===1?ut=ct[0]:ut=new Object3D,ut!==ct[0])for(let ht=0,dt=ct.length;ht<dt;ht++)ut.add(ct[ht]);if(st.name&&(ut.userData.name=st.name,ut.name=at),assignExtrasToUserData(ut,st),st.extensions&&addUnknownExtensionsToUserData(it,ut,st),st.matrix!==void 0){const ht=new Matrix4;ht.fromArray(st.matrix),ut.applyMatrix4(ht)}else st.translation!==void 0&&ut.position.fromArray(st.translation),st.rotation!==void 0&&ut.quaternion.fromArray(st.rotation),st.scale!==void 0&&ut.scale.fromArray(st.scale);return nt.associations.has(ut)||nt.associations.set(ut,{}),nt.associations.get(ut).nodes=_e,ut}),this.nodeCache[_e]}loadScene(_e){const rt=this.extensions,it=this.json.scenes[_e],nt=this,st=new Group;it.name&&(st.name=nt.createUniqueName(it.name)),assignExtrasToUserData(st,it),it.extensions&&addUnknownExtensionsToUserData(rt,st,it);const at=it.nodes||[],lt=[];for(let ot=0,ct=at.length;ot<ct;ot++)lt.push(nt.getDependency("node",at[ot]));return Promise.all(lt).then(function(ot){for(let ut=0,ht=ot.length;ut<ht;ut++)st.add(ot[ut]);const ct=ut=>{const ht=new Map;for(const[dt,pt]of nt.associations)(dt instanceof Material||dt instanceof Texture)&&ht.set(dt,pt);return ut.traverse(dt=>{const pt=nt.associations.get(dt);pt!=null&&ht.set(dt,pt)}),ht};return nt.associations=ct(st),st})}_createAnimationTracks(_e,rt,it,nt,st){const at=[],lt=_e.name?_e.name:_e.uuid,ot=[];PATH_PROPERTIES[st.path]===PATH_PROPERTIES.weights?_e.traverse(function(dt){dt.morphTargetInfluences&&ot.push(dt.name?dt.name:dt.uuid)}):ot.push(lt);let ct;switch(PATH_PROPERTIES[st.path]){case PATH_PROPERTIES.weights:ct=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:ct=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:default:switch(it.itemSize){case 1:ct=NumberKeyframeTrack;break;case 2:case 3:ct=VectorKeyframeTrack;break}break}const ut=nt.interpolation!==void 0?INTERPOLATION[nt.interpolation]:InterpolateLinear,ht=this._getArrayFromAccessor(it);for(let dt=0,pt=ot.length;dt<pt;dt++){const ft=new ct(ot[dt]+"."+PATH_PROPERTIES[st.path],rt.array,ht,ut);ut==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(ft),at.push(ft)}return at}_getArrayFromAccessor(_e){let rt=_e.array;if(_e.normalized){const it=getNormalizedComponentScale(rt.constructor),nt=new Float32Array(rt.length);for(let st=0,at=rt.length;st<at;st++)nt[st]=rt[st]*it;rt=nt}return rt}_createCubicSplineTrackInterpolant(_e){_e.createInterpolant=function(it){const nt=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new nt(this.times,this.values,this.getValueSize()/3,it)},_e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function computeBounds(tt,_e,rt){const it=_e.attributes,nt=new Box3;if(it.POSITION!==void 0){const lt=rt.json.accessors[it.POSITION],ot=lt.min,ct=lt.max;if(ot!==void 0&&ct!==void 0){if(nt.set(new Vector3(ot[0],ot[1],ot[2]),new Vector3(ct[0],ct[1],ct[2])),lt.normalized){const ut=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[lt.componentType]);nt.min.multiplyScalar(ut),nt.max.multiplyScalar(ut)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const st=_e.targets;if(st!==void 0){const lt=new Vector3,ot=new Vector3;for(let ct=0,ut=st.length;ct<ut;ct++){const ht=st[ct];if(ht.POSITION!==void 0){const dt=rt.json.accessors[ht.POSITION],pt=dt.min,ft=dt.max;if(pt!==void 0&&ft!==void 0){if(ot.setX(Math.max(Math.abs(pt[0]),Math.abs(ft[0]))),ot.setY(Math.max(Math.abs(pt[1]),Math.abs(ft[1]))),ot.setZ(Math.max(Math.abs(pt[2]),Math.abs(ft[2]))),dt.normalized){const gt=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[dt.componentType]);ot.multiplyScalar(gt)}lt.max(ot)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}nt.expandByVector(lt)}tt.boundingBox=nt;const at=new Sphere;nt.getCenter(at.center),at.radius=nt.min.distanceTo(nt.max)/2,tt.boundingSphere=at}function addPrimitiveAttributes(tt,_e,rt){const it=_e.attributes,nt=[];function st(at,lt){return rt.getDependency("accessor",at).then(function(ot){tt.setAttribute(lt,ot)})}for(const at in it){const lt=ATTRIBUTES[at]||at.toLowerCase();lt in tt.attributes||nt.push(st(it[at],lt))}if(_e.indices!==void 0&&!tt.index){const at=rt.getDependency("accessor",_e.indices).then(function(lt){tt.setIndex(lt)});nt.push(at)}return assignExtrasToUserData(tt,_e),computeBounds(tt,_e,rt),Promise.all(nt).then(function(){return _e.targets!==void 0?addMorphTargets(tt,_e.targets,rt):tt})}function Model3D({percentage:tt,..._e}){const rt=reactExports.useRef(),{scene:it,animations:nt}=useLoader(GLTFLoader,_e.model);new MeshBasicMaterial({color:"red",wireframe:!1});const st=new MeshStandardMaterial({color:_e.color,flatShading:!0});it.traverse(ot=>{ot.isMesh&&(ot.material=st)});const at=reactExports.useRef([]);rt.current=new AnimationMixer(it);for(const ot of nt){const ct=rt.current.clipAction(ot);ct.play(),ct.paused=!0,at.current.push({clip:ot,action:ct})}const lt=ot=>{for(const{clip:ct,action:ut}of at.current)ut.time=ot*ct.duration};return useFrame((ot,ct)=>{rt.current.update(ct)}),lt(tt),jsxRuntimeExports.jsx("primitive",{object:it,scale:2})}function useAnimationControls(){const{percentage:tt}=useControls({percentage:{value:.01,min:.01,max:.99,step:.01}});return tt}const models=["../box3d0.gltf","../box3d1.gltf","../box3d2.gltf","../dagiac1.gltf","../Cone_solid  BAKED 100fps.glb","../Cylinder_solid_BAKED_100fps.glb"],button_positions=[[3.8,.2,2.5],[.1,.2,2.5],[.1,.2,2.8],[-.1,.2,3.8],[.1,.2,2.8],[2,.2,2.8]];function Box3D(){let tt=useAnimationControls(),_e=0;const rt=useParams().box_id;rt===void 0?_e=0:_e=parseInt(rt),_e==0?(_e=useControls({box_style:{options:{"Style 01":0,"Style 02":1,"Style 03":2},onChange:lt=>{_e=lt},transient:!1}}).box_style,_e===void 0&&(_e=0)):_e==1?_e=4:_e==2?_e=5:_e=3;const it=models[_e],nt=button_positions[_e],st={visible:!0,position:{x:3.3,y:1,z:4.4},castShadow:!0};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Canvas$1,{camera:{position:[-10,10,10],fov:60},children:jsxRuntimeExports.jsxs(XR,{children:[jsxRuntimeExports.jsx(Sky,{sunPosition:[0,1,0]}),jsxRuntimeExports.jsx("ambientLight",{}),jsxRuntimeExports.jsx("directionalLight",{visible:st.visible,position:[st.position.x,st.position.y,st.position.z],castShadow:st.castShadow}),jsxRuntimeExports.jsx(Button3D,{position:nt,text:"tekville.com"}),jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:null,children:[jsxRuntimeExports.jsx(Model3D,{percentage:tt,model:it,color:15630622}),jsxRuntimeExports.jsx(OrbitControls,{}),jsxRuntimeExports.jsx(Stats,{})]})]})})})}const App=()=>{const tt=()=>(window.location.href="./1.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),_e=()=>(window.location.href="./6.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),rt=()=>(window.location.href="./7.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),it=()=>(window.location.href="./4.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),nt=()=>(window.location.href="./7.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),st=()=>(window.location.href="./9.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),at=()=>(window.location.href="./10.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),lt=()=>(window.location.href="./10.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),ot=()=>(window.location.href="./9.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),ct=()=>(window.location.href="./8.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),ut=()=>(window.location.href="./6.html",jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}));return jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{exact:!0,path:"/",element:jsxRuntimeExports.jsx(VRApp,{})}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/VRApp",element:jsxRuntimeExports.jsx(VRApp,{})}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/1",element:jsxRuntimeExports.jsx(tt,{})}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/2",Component:JSXGraphComponent$2}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/3",Component:JSXGraphComponent$a}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/4",Component:JSXGraphComponent$9}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/5",Component:JSXGraphComponent$d}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/6",element:jsxRuntimeExports.jsx(_e,{})}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/7",element:jsxRuntimeExports.jsx(rt,{})}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/8",Component:JSXGraphComponent$c}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/9",Component:JSXGraphComponent$p}),jsxRuntimeExports.jsx(Route,{path:"/Transformation/10",Component:JSXGraphComponent$h}),jsxRuntimeExports.jsx(Route,{path:"/Construction/1",Component:JSXGraphComponent$w}),jsxRuntimeExports.jsx(Route,{path:"/Construction/2",Component:JSXGraphComponent$v}),jsxRuntimeExports.jsx(Route,{path:"/Construction/3",Component:JSXGraphComponent$u}),jsxRuntimeExports.jsx(Route,{path:"/Construction/4",Component:JSXGraphComponent$t}),jsxRuntimeExports.jsx(Route,{path:"/Construction/5",Component:JSXGraphComponent$n}),jsxRuntimeExports.jsx(Route,{path:"/Construction/6",Component:JSXGraphComponent$m}),jsxRuntimeExports.jsx(Route,{path:"/Construction/7",Component:JSXGraphComponent$g}),jsxRuntimeExports.jsx(Route,{path:"/Construction/8",Component:JSXGraphComponent$f}),jsxRuntimeExports.jsx(Route,{path:"/Construction/9",Component:JSXGraphComponent$e}),jsxRuntimeExports.jsx(Route,{path:"/Construction/10",Component:JSXGraphComponent$i}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/Geometry/:box_id",element:jsxRuntimeExports.jsx(Box3D,{})}),jsxRuntimeExports.jsx(Route,{path:"/Geo/6",element:jsxRuntimeExports.jsx(ut,{})}),jsxRuntimeExports.jsx(Route,{path:"/Geo/7",Component:JSXGraphComponent$1}),jsxRuntimeExports.jsx(Route,{path:"/Geo/8",element:jsxRuntimeExports.jsx(ct,{})}),jsxRuntimeExports.jsx(Route,{path:"/Geo/9",element:jsxRuntimeExports.jsx(ot,{})}),jsxRuntimeExports.jsx(Route,{path:"/Geo/10",element:jsxRuntimeExports.jsx(lt,{})}),jsxRuntimeExports.jsx(Route,{path:"/Vector/1",Component:JSXGraphComponent$l}),jsxRuntimeExports.jsx(Route,{path:"Vector/2",Component:JSXGraphComponent$k}),jsxRuntimeExports.jsx(Route,{path:"/Vector/3",Component:JSXGraphComponent$j}),jsxRuntimeExports.jsx(Route,{path:"/Vector/4",Component:JSXGraphComponent$8}),jsxRuntimeExports.jsx(Route,{path:"/Vector/5",element:jsxRuntimeExports.jsx(it,{})}),jsxRuntimeExports.jsx(Route,{path:"/Vector/6",Component:JSXGraphComponent$q}),jsxRuntimeExports.jsx(Route,{path:"/Vector/7",Component:JSXGraphComponent$o}),jsxRuntimeExports.jsx(Route,{path:"/Vector/8",element:jsxRuntimeExports.jsx(nt,{})}),jsxRuntimeExports.jsx(Route,{path:"/Vector/9",element:jsxRuntimeExports.jsx(st,{})}),jsxRuntimeExports.jsx(Route,{path:"/Vector/10",element:jsxRuntimeExports.jsx(at,{})}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/1",Component:JSXGraphComponent$b}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/3",Component:JSXGraphComponent$3}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/4",Component:JSXGraphComponent$7}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/5",Component:JSXGraphComponent$s}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/6",Component:JSXGraphComponent$r}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/7",Component:JSXGraphComponent$6}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/8",Component:JSXGraphComponent$4}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/9",Component:JSXGraphComponent$5}),jsxRuntimeExports.jsx(Route,{path:"/Trigonometry/10",Component:JSXGraphComponent})]})})},index="";client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.Fragment,{children:jsxRuntimeExports.jsx(App,{})}))});export default v1();
